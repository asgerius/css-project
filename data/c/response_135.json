[{"tags": ["c", "gcc", "assembly", "visual-c++"], "comments": [{"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 4, "creation_date": 1502321780, "post_id": 45602107, "comment_id": 78163810, "body": "The main problem you have is that this is for linux thread local storage.  Windows thread local storage is completely different, so even if you could get that assembly to work with your compiler, it would not run on windows."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 1, "creation_date": 1502322124, "post_id": 45602107, "comment_id": 78163897, "body": "Depends entirely on what you are trying to do.  Rewrite the code to use <code>thread_local</code> if you don&#39;t mind being dependent on C11."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1502324334, "post_id": 45602107, "comment_id": 78164387, "body": "The inline assembly in your &quot;original assembly&quot; example is unnecessarily complex. Only the first assembly statement needs to be in inline assembly, the last two statements could&#39;ve been coded in plain C. The third statement also don&#39;t match the comment given on the same line."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1502324337, "post_id": 45602107, "comment_id": 78164388, "body": "Actually, to clarify, when I said &quot;gcc&quot; I meant MinGW, and it seems that GS is used for thread local storage on win_amd64. Are you sure that this wouldn&#39;t operate correctly on windows? I don&#39;t think MinGW would be advanced enough to rewrite assembly."}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1502324503, "post_id": 45602107, "comment_id": 78164427, "body": "Do you know whether the original code actually works on Windows?  It looks like whoever wrote it didn&#39;t quite know what they were doing."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "reply_to_user": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1502324517, "post_id": 45602107, "comment_id": 78164432, "body": "@RossRidge I mean it&#39;s supposedly written by Google&#39;s finest. I&#39;m just trying to port it."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1502324539, "post_id": 45602107, "comment_id": 78164436, "body": "And yes it does work with the MinGW (gcc) compiler."}, {"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1502324779, "post_id": 45602107, "comment_id": 78164502, "body": "Here&#39;s the full version: <a href=\"https://github.com/golang/go/blob/master/src/runtime/cgo/gcc_windows_amd64.c\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/runtime/cgo/&hellip;</a>   I of course truncated it to limit the scope of the question."}], "answers": [{"comments": [{"owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "edited": false, "score": 0, "creation_date": 1502327364, "post_id": 45602886, "comment_id": 78165126, "body": "Thanks very much for this. I was not looking forward to managing external assembly files."}], "tags": [], "owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "is_accepted": true, "score": 2, "last_activity_date": 1502327232, "creation_date": 1502327232, "answer_id": 45602886, "question_id": 45602107, "link": "https://stackoverflow.com/questions/45602107/converting-gcc-inline-assembly-to-ml64/45602886#45602886", "title": "converting gcc inline assembly to ml64", "body": "<p>You don't need to use assembly at all to port this code to Microsoft C++. You can use the <a href=\"https://msdn.microsoft.com/en-us/library/529bay7a.aspx\" rel=\"nofollow noreferrer\"><code>__writegsqword</code></a> intrinsic to replace the first assembly instruction and then use plain C to replace the last two assembly instructions. For example: </p>\n\n<pre><code>__writegsqword(0x28, (unsigned long long) ts.tls);\n*(void **)ts.tls = (void *) ts.g;\n</code></pre>\n\n<p>Note that depending on the types of <code>ts.tls</code> and <code>ts.g</code> you might be better off with different casts or can avoid them altogether.</p>\n\n<p>You can use the same code with GCC and Microsoft C++ by adding a function like this:</p>\n\n<pre><code>#ifdef __GNUC__\nstatic inline void\n__writegsqword(unsigned long long offset, unsigned long long value) {\n    asm(\"movq %0,%%gs:%1\" :: \"re\" (value), \"m\" (*(int *)offset));\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 7300, "user_id": 195644, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e1a2ac3e1eba0c0d26672b2a55948b77?s=128&d=identicon&r=PG", "display_name": "xaav", "link": "https://stackoverflow.com/users/195644/xaav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 45602886, "answer_count": 1, "score": 0, "last_activity_date": 1502327232, "creation_date": 1502321021, "question_id": 45602107, "link": "https://stackoverflow.com/questions/45602107/converting-gcc-inline-assembly-to-ml64", "title": "converting gcc inline assembly to ml64", "body": "<p>As part of attempting to implement msvc support for cgo, I found that I needed to port some inline gcc assembly to ml64. Here is the original assembly:</p>\n\n<pre><code>ts = *(ThreadStart*)v;\n\n/*\n * Set specific keys in thread local storage.\n */\n__asm {\n      \"movq %0, %%gs:0x28\\n\"    // MOVL tls0, 0x28(GS)\n      \"movq %%gs:0x28, %%rax\\n\" // MOVQ 0x28(GS), tmp\n      \"movq %1, 0(%%rax)\\n\" // MOVQ g, 0(GS)\n      :: \"r\"(ts.tls), \"r\"(ts.g) : \"%rax\"\n}\n</code></pre>\n\n<p>And here is the external assembler file that I have created:</p>\n\n<pre><code>PUBLIC msvc_windows_amd64_threadentry\n\n.CODE\n    msvc_windows_amd64_threadentry PROC\n\n        MOV gs:[0x28], ts.tls\n        MOV rax, gs:[0x28]\n        MOV gs:[0], ts.g\n\n        ret\n    msvc_windows_amd64_threadentry ENDP\nEND\n</code></pre>\n\n<p>Obviously there are some problems. For one, I have no idea at this time how to let the assembler know the structure of <code>ts</code>; gcc obviously knows about it because it's in the file that is being compiled but msvc doesn't support amd64 inline assembly. Another is I think that I will just be able to call <code>msvc_windows_amd64_threadentry</code> just like any other <code>extern</code> function, but I am not completely sure. Honestly I have never had to deal with assembly much so I've never had these problems before.</p>\n"}, {"tags": ["c", "arrays", "rust", "ffi"], "comments": [{"owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "edited": false, "score": 0, "creation_date": 1502318824, "post_id": 45601652, "comment_id": 78162978, "body": "while the answer was similar, the question was not anywhere close to being the same."}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1502319704, "post_id": 45601652, "comment_id": 78163264, "body": "Does that mean that you read the linked duplicates and solved your problem? That you cannot return a <code>CString</code> across the FFI boundary?"}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1502319909, "post_id": 45601652, "comment_id": 78163332, "body": "For beginner FFI questions, I highly recommend reading my <a href=\"http://jakegoulding.com/rust-ffi-omnibus/string_return/\" rel=\"nofollow noreferrer\">Rust FFI Omnibus</a>."}, {"owner": {"reputation": 269529, "user_id": 155423, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/419218774d04a581476ea1887a0921e0?s=128&d=identicon&r=PG", "display_name": "Shepmaster", "link": "https://stackoverflow.com/users/155423/shepmaster"}, "edited": false, "score": 0, "creation_date": 1502320623, "post_id": 45601652, "comment_id": 78163534, "body": "Your general method of returning the array is just fine, therefore any answer to the question you <i>asked</i> would be &quot;do exactly what you are doing&quot;. You didn&#39;t reduce your question enough to the core of the problem \u2014 returning <code>CString</code> instead of <code>* const c_char</code>. And yes, you always have to free Rust allocations back in Rust land. You will need to reconstitute the <code>Vec</code> and then let it drop."}], "owner": {"reputation": 6509, "user_id": 356011, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/d17ff41be1044be6fb5ef186b83efb20?s=128&d=identicon&r=PG", "display_name": "marathon", "link": "https://stackoverflow.com/users/356011/marathon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 766, "favorite_count": 0, "closed_date": 1502318613, "answer_count": 0, "score": 2, "last_activity_date": 1502321452, "creation_date": 1502318192, "last_edit_date": 1502321452, "question_id": 45601652, "link": "https://stackoverflow.com/questions/45601652/how-to-set-an-array-of-c-strings-on-an-out-parameter-of-a-rust-ffi-function", "closed_reason": "Duplicate", "title": "How to set an array of C strings on an out-parameter of a Rust FFI function?", "body": "<p>I would like create a Rust FFI function that takes an out-parameter for arrays, analogous to this C function:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>size_t arr_out_c(char ***out) {\n    char *msg = \"the quick brown fox\";\n    size_t STR_LEN = strlen(msg) +1;\n    size_t count = 3;\n    char** arr = calloc( count,  sizeof(char*));\n    for (int i = 0; i &lt; count; i++) {\n        arr[i] = calloc(STR_LEN,  sizeof(char));\n        strncpy(arr[i], msg, STR_LEN * sizeof(char));\n    }\n    *out = arr;\n    return count;\n}\n</code></pre>\n\n<p>Usage:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char** test;\nsize_t count = arr_out_c(&amp;test);\nfor (int i = 0; i &lt; count; i++) {\n    printf(\"item: %s\", test[i]);\n}\n</code></pre>\n\n<p>I've gotten close with this:</p>\n\n<pre><code>#[no_mangle]\npub extern fn arr_out_rust(strings_out: *mut *mut *mut ::std::os::raw::c_char) -&gt; usize {\n    unsafe {\n        let s1 = ::std::ffi::CString::new(\"the quick brown fox\").unwrap();\n        let s2 = ::std::ffi::CString::new(\"the quick brown fox\").unwrap();\n        let mut strs = vec![s1, s2];\n        let len = strs.len();\n\n        let mut boxed_slice = strs.into_boxed_slice();\n        *strings_out = boxed_slice.as_mut_ptr() as *mut *mut ::std::os::raw::c_char;\n        mem::forget(boxed_slice);\n        len\n    }\n}\n</code></pre>\n\n<p>It works for the first item in the array, attempting to access the 2nd item results in a SEGV.   Perhaps the <code>CString</code>s are not getting packed in a contiguous block of memory... or maybe the <code>len</code> data in <code>slice</code> is part of that memory?   </p>\n\n<p>Also, to free this memory, can I just call the C <code>free</code> function on it in C space, or do I need to send it back into Rust space and call <code>drop</code>?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char** test;\nsize_t count = arr_out_rust(&amp;test);\nfor (int i = 0; i &lt; count; i++) {\n    printf(\"item: %s\", test[i]);\n}\n</code></pre>\n\n<p>will print a single <code>the quick brown fox</code>, then crash.</p>\n\n<hr>\n\n<p>While this question has some similarities to questions asking about <strong>returning</strong> strings to C, it's pretty unique in that it is asking about out-bound pointers in FFI.  Marking it as a duplicate and closing it would go against the spirit of Stack Overflow as a repository of unique answers.</p>\n"}, {"tags": ["c", "string", "data-structures"], "comments": [{"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1502317136, "post_id": 45601311, "comment_id": 78162406, "body": "Does your problem lie in understanding the encoding or formulating a decoder in the particular scripting language? In C you would do something along the lines of <code>unsigned c, v = 0, b = 0; do v |= (c = Read()) &amp; 0x7F) &lt;&lt; b; while(b += 7, c &amp; 0x80);</code>. Whether or how that translates to a parser script for you HEX editor I do not know, but given the C tag I suppose it might be a starting point."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502318229, "post_id": 45601311, "comment_id": 78162762, "body": "What is your problem?"}, {"owner": {"reputation": 863, "user_id": 785111, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/0fxS1.png?s=128&g=1", "display_name": "Hannobo", "link": "https://stackoverflow.com/users/785111/hannobo"}, "edited": false, "score": 0, "creation_date": 1502495832, "post_id": 45601311, "comment_id": 78249683, "body": "I think I understand the encoding, but neither am I familar with C nor with bit manipulation and pointer operations. I think I could transfer a pure C solution into the editor&#39;s scripting language if it doesn&#39;t use too many unsupported features. Pointers for example are not supported, but a null-terminated &quot;string&quot; type exists instead..."}], "answers": [{"comments": [{"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 1, "creation_date": 1502321692, "post_id": 45601856, "comment_id": 78163785, "body": "The encoder in the sample code looks to be little-endian though, and despite the tag I gather that it is to be implemented in a scripting language with a C-like syntax."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 0, "last_activity_date": 1502319378, "creation_date": 1502319378, "answer_id": 45601856, "question_id": 45601311, "link": "https://stackoverflow.com/questions/45601311/010-editor-template-parsing-7-bit-encoded-int-for-length-prefixed-string/45601856#45601856", "title": "010 Editor template: Parsing 7-bit encoded int for length-prefixed string", "body": "<p>I think you need a function that does two things: (1) extract the content length; (2) give you a pointer to where the \"real\" content starts.\nSee the following code, which should fulfill these two requirements:</p>\n\n<pre><code>int getLength(const unsigned char *str, int *content_offset)\n{\n    int result = 0, moreBytes=0, pos=0;\n    do\n    {\n        unsigned char value7Bit = str[pos];\n        result = (result &lt;&lt; 7) | (value7Bit &amp; 0x7F);\n        moreBytes = value7Bit &amp; 0x80;\n        pos++;\n    }\n    while (moreBytes);\n\n    if(content_offset)\n        *content_offset = pos;\n\n    return result;\n}\n\n\nint main() {\n\n    unsigned char str[] = \"\\x81\\x01teststring, which should contain 129 characters.....\";\n\n    int content_offset=0;\n    int length = getLength(str, &amp;content_offset);\n\n    printf(\"length: %d; content: '%s'\\n\", length, str+content_offset);\n    return 0;    \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 12893008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b540a123d92e4c200237b2163ff0282?s=128&d=identicon&r=PG&f=1", "display_name": "Sabresaurus", "link": "https://stackoverflow.com/users/12893008/sabresaurus"}, "is_accepted": true, "score": 1, "last_activity_date": 1581605353, "creation_date": 1581605353, "answer_id": 60210526, "question_id": 45601311, "link": "https://stackoverflow.com/questions/45601311/010-editor-template-parsing-7-bit-encoded-int-for-length-prefixed-string/60210526#60210526", "title": "010 Editor template: Parsing 7-bit encoded int for length-prefixed string", "body": "<p>This is a rough way of handling parsing .net binary strings as an 010 Editor Binary Template, it handles 1 and 2 byte length prefixes, but it should be straightforward to expand it to longer strings with a loop. I had previously been parsing strings with a byte hardcoded as string length but as soon as I had a string that was 128 in length that failed, but this seems to work:</p>\n\n<pre><code>typedef struct\n{    \n    ubyte stringLength;\n    local int stringLengthLocal = stringLength;\n    if(stringLength &gt; 127)\n    {\n        stringLengthLocal = (ubyte)stringLength &amp; (ubyte)127;\n        ubyte stringLength2;\n        stringLengthLocal += stringLength2 * 128;\n    }\n\n    char stringValue[stringLengthLocal] &lt;optimize=false&gt;;\n} String;\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 785111, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/0fxS1.png?s=128&g=1", "display_name": "Hannobo", "link": "https://stackoverflow.com/users/785111/hannobo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 60210526, "answer_count": 2, "score": 0, "last_activity_date": 1581605353, "creation_date": 1502316137, "question_id": 45601311, "link": "https://stackoverflow.com/questions/45601311/010-editor-template-parsing-7-bit-encoded-int-for-length-prefixed-string", "title": "010 Editor template: Parsing 7-bit encoded int for length-prefixed string", "body": "<p>In a <em>010 Editor</em> template (C/C++ like syntax) I want to parse a string that was written with Microsoft .Net's <code>BinaryWriter</code> class like so:</p>\n\n<pre><code>myBinaryWriter.Write(\"hello\");\n</code></pre>\n\n<p>This writes out a length-prefixed string, where the length is encoded with <code>Write7BitEncodedInt</code>. Here is the .Net source for writing the length, for reference:</p>\n\n<pre><code>// Write out an int 7 bits at a time.  The high bit of the byte, \n// when on, tells reader to continue reading more bytes. \nuint v = (uint) value;   // support negative numbers\nwhile (v &gt;= 0x80) { \n    Write((byte) (v | 0x80));\n    v &gt;&gt;= 7;\n}\nWrite((byte)v); \n</code></pre>\n\n<p>How would a struct definition in a 010 Editor template syntax look like to parse a string encoded like that?</p>\n"}, {"tags": ["python", "c", "linux", "bluetooth", "bluez"], "comments": [{"owner": {"reputation": 900, "user_id": 3930651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eqI1G.jpg?s=128&g=1", "display_name": "vookimedlo", "link": "https://stackoverflow.com/users/3930651/vookimedlo"}, "edited": false, "score": 0, "creation_date": 1502394485, "post_id": 45601302, "comment_id": 78204211, "body": "If I remember well, BlueZ uses the socket abstraction, so I would say that the file descriptor is the opened socket."}], "answers": [{"tags": [], "owner": {"reputation": 1198, "user_id": 2857080, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5d0f4f0ae12b79d0ade03125b433da59?s=128&d=identicon&r=PG&f=1", "display_name": "zeus_masta_funk", "link": "https://stackoverflow.com/users/2857080/zeus-masta-funk"}, "is_accepted": true, "score": 1, "last_activity_date": 1502483864, "creation_date": 1502483864, "answer_id": 45643410, "question_id": 45601302, "link": "https://stackoverflow.com/questions/45601302/operate-on-bluez-provided-file-descriptor-in-c/45643410#45643410", "title": "Operate on BlueZ provided file descriptor in C", "body": "<p>My issue ended up being with the <code>gdbus-codegen</code> tool I was using. When using that tool, each fd parameter is actually an index to a <code>GUnixFDList</code> (documentation on that object <a href=\"https://developer.gnome.org/gio/stable/GUnixFDList.html\" rel=\"nofollow noreferrer\">here</a>). In order to have the <code>GUnixFDList</code> passed with the method <code>NewConnection</code>, I had to annotate the method in xml as <code>org.gtk.GDBus.C.UnixFD</code>. Annotation documentation can be found <a href=\"https://developer.gnome.org/gio/stable/gdbus-codegen.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 1198, "user_id": 2857080, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/5d0f4f0ae12b79d0ade03125b433da59?s=128&d=identicon&r=PG&f=1", "display_name": "zeus_masta_funk", "link": "https://stackoverflow.com/users/2857080/zeus-masta-funk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 1, "accepted_answer_id": 45643410, "answer_count": 1, "score": 1, "last_activity_date": 1502483864, "creation_date": 1502316071, "last_edit_date": 1502330841, "question_id": 45601302, "link": "https://stackoverflow.com/questions/45601302/operate-on-bluez-provided-file-descriptor-in-c", "title": "Operate on BlueZ provided file descriptor in C", "body": "<p>I am attempting to work with the <code>org.bluez.Profile1</code> in <code>BlueZ 5.44</code>. When connecting with a new device via the <code>NewConnection</code> DBus method, we get a file descriptor to work with. I am fairly confused on what state this file descriptor is in, and what I need to do in order to read/write from it. Simply calling <code>read</code>/<code>write</code> does not behave as expected for me.</p>\n\n<p>In the file <a href=\"https://git.kernel.org/pub/scm/bluetooth/bluez.git/tree/test/test-profile?h=5.44\" rel=\"nofollow noreferrer\">test/test-profile</a>, I see this line of python code:</p>\n\n<pre><code>self.fd = fd.take()\n</code></pre>\n\n<p>I am struggling to find the Linux C equivalent to the <code>take</code> method. Any advice on how to configure this fd in C code so I can read/write with the fd would be very helpful!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502316165, "post_id": 45601288, "comment_id": 78162048, "body": "what does it mean <code>reshape</code>?"}, {"owner": {"reputation": 562, "user_id": 4920521, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da5bf694a8abd194543f2c2f5f0b4d35?s=128&d=identicon&r=PG", "display_name": "Mano-Wii", "link": "https://stackoverflow.com/users/4920521/mano-wii"}, "reply_to_user": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1502316232, "post_id": 45601288, "comment_id": 78162074, "body": "@DavideSpataro, reshape a flat array of x*x element to a 2d array with [x] by [x] elementes"}, {"owner": {"reputation": 562, "user_id": 4920521, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da5bf694a8abd194543f2c2f5f0b4d35?s=128&d=identicon&r=PG", "display_name": "Mano-Wii", "link": "https://stackoverflow.com/users/4920521/mano-wii"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502316293, "post_id": 45601288, "comment_id": 78162099, "body": "@PeterJ, reshape: Gives a new shape to an array without changing its data (numpy definition)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502316700, "post_id": 45601288, "comment_id": 78162252, "body": "Give or take a cast, what you&#39;ve got should work.  What&#39;s the problem?"}, {"owner": {"reputation": 562, "user_id": 4920521, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da5bf694a8abd194543f2c2f5f0b4d35?s=128&d=identicon&r=PG", "display_name": "Mano-Wii", "link": "https://stackoverflow.com/users/4920521/mano-wii"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502316885, "post_id": 45601288, "comment_id": 78162320, "body": "@JonathanLeffler, The message that appears is: the expression must have a constant value"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502317217, "post_id": 45601288, "comment_id": 78162441, "body": "Well, you do need a C11 (or C99) compiler, not a C89 compiler.  The only reason to get that message is that you are using a compiler without support for variable-length arrays, which were added as a mandatory feature of C99 and were made into an optional feature in C11."}], "answers": [{"tags": [], "owner": {"reputation": 1312, "user_id": 1033326, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/544e259be531876393970779b7c25f28?s=128&d=identicon&r=PG", "display_name": "sancelot", "link": "https://stackoverflow.com/users/1033326/sancelot"}, "is_accepted": false, "score": 0, "last_activity_date": 1502316948, "creation_date": 1502316948, "answer_id": 45601464, "question_id": 45601288, "link": "https://stackoverflow.com/questions/45601288/how-to-reshape-a-flat-array-into-a-2d-in-c/45601464#45601464", "title": "How to reshape a flat array into a 2d in C?", "body": "<p>this should do it :</p>\n\n<pre><code>int m,n;\ntypedef int myarray_t[x][x];\nmyarray_t *myarray;\nmyarray = (myarray_t *) flat_array;\n\nfor (m=0;m&lt;x;m++)\n   for (n=0;n&lt;x;n++)\n       printf(\"[%d][%d] : %d\\n\",m,n,(*myarray)[m][n]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502316978, "creation_date": 1502316978, "answer_id": 45601469, "question_id": 45601288, "link": "https://stackoverflow.com/questions/45601288/how-to-reshape-a-flat-array-into-a-2d-in-c/45601469#45601469", "title": "How to reshape a flat array into a 2d in C?", "body": "<p>if original was malloced and I understand what reshape means</p>\n\n<pre><code>#define MIN(x,y) ((x) &gt; (y) ? (y) : (x))\n\nint *reshape(int *src, int srcRows, int srcCols, int newRows, int newColums)\n{\n    int *newarray = (*src != NULL &amp;&amp; newRows &gt; 0 &amp;&amp; newColums &gt; 0) ? malloc(newRows * newColums) : NULL;\n\n    if (newarray != NULL)\n    {\n        for (int row = 0; row &lt; MIN(srcRows, newRows); row++)\n            for (int col = 0; col &lt; MIN(srcCols, newColums); col++)\n                *(newarray + row * newColums + col) = *(src + row * srcCols + col);\n        free(src);\n    }\n    return newarray;\n}\n</code></pre>\n\n<p>If new array is smaller some data will be lost.</p>\n"}, {"comments": [{"owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 0, "creation_date": 1502317826, "post_id": 45601546, "comment_id": 78162646, "body": "What&#39;s commalist?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "edited": false, "score": 1, "creation_date": 1502318149, "post_id": 45601546, "comment_id": 78162738, "body": "@DavideSpataro: <code>commalist</code> is a moderately complex shell script wrapping an awk script that generates a list of comma-separated values from its input.  Currently 165 lines of shell (including moderately copious comments), of which about 50 lines is Awk.  The options say &quot;print 5 values per line of output, and start each line with 8 blanks&quot;.  Shout if you&#39;re interested \u2014 see my profile.  (The <code>random</code> program is also my own homebrew.  It&#39;s not quite as polished as I&#39;d like, though for generating 25 numbers between 10 and 99, it&#39;s perfectly clean.)"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1502317501, "creation_date": 1502317501, "answer_id": 45601546, "question_id": 45601288, "link": "https://stackoverflow.com/questions/45601288/how-to-reshape-a-flat-array-into-a-2d-in-c/45601546#45601546", "title": "How to reshape a flat array into a 2d in C?", "body": "<p>This code works for me.  Note that it uses a C99 (and C11) <em>variable length array</em> (VLA).  It won't compile with a C89/C90 compiler.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstatic void func(const unsigned int x, const int *flat_array)\n{\n    const int (*reshaped)[x] = (void *)flat_array;\n    for (unsigned int i = 0; i &lt; x; i++)\n    {\n        for (unsigned int j = 0; j &lt; x; j++)\n            printf(\"%3d\", reshaped[i][j]);\n        putchar('\\n');\n    }\n}\n\nint main(void)\n{\n    int flat[] =\n    {\n        /* random -n 25 10 99 | commalist -n 5 -b '        ' */\n        73, 34, 76, 48, 17,\n        25, 71, 11, 87, 74,\n        18, 87, 11, 47, 32,\n        33, 62, 41, 55, 90,\n        90, 28, 69, 58, 29,\n    };\n\n    for (int i = 0; i &lt; 5; i++)\n    {\n        printf(\"R[%d]\", i);\n        for (int j = 0; j &lt; 5; j++)\n            printf(\" [%d] = %2d\", j, flat[i * 5 + j]);\n        putchar('\\n');\n    }\n\n    func(5, flat);\n    return 0;\n}\n</code></pre>\n\n<p>Compiled without warnings on a Mac running macOS Sierra 10.12.6 using GCC 7.1.0 with the compilation options:</p>\n\n<pre><code>$ gcc -O3 -g -std=c11 -Wall -Wextra -Werror -Wmissing-prototypes \\\n      -Wstrict-prototypes rs37.c -o rs37\n$\n</code></pre>\n\n<p>Without the cast (to <code>void *</code>) in the function, I get the error:</p>\n\n<pre><code>initialization from incompatible pointer type [-Werror=incompatible-pointer-types]\n</code></pre>\n\n<p>The <code>void *</code> cast is an effective way to deal with the problem \u2014 but it could be misused very easily.  You could also write:</p>\n\n<pre><code>    const int (*reshaped)[x] = (int (*)[x])flat_array;\n</code></pre>\n\n<p>That explicitly casts direct to the correct type \u2014 pointer to array of integers of row width <code>x</code>.  You could add a <code>const</code> into the cast if you wanted to.</p>\n\n<p>Output:</p>\n\n<pre><code>R[0] [0] = 73 [1] = 34 [2] = 76 [3] = 48 [4] = 17\nR[1] [0] = 25 [1] = 71 [2] = 11 [3] = 87 [4] = 74\nR[2] [0] = 18 [1] = 87 [2] = 11 [3] = 47 [4] = 32\nR[3] [0] = 33 [1] = 62 [2] = 41 [3] = 55 [4] = 90\nR[4] [0] = 90 [1] = 28 [2] = 69 [3] = 58 [4] = 29\n 73 34 76 48 17\n 25 71 11 87 74\n 18 87 11 47 32\n 33 62 41 55 90\n 90 28 69 58 29\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 0, "last_activity_date": 1502348425, "creation_date": 1502348425, "answer_id": 45606600, "question_id": 45601288, "link": "https://stackoverflow.com/questions/45601288/how-to-reshape-a-flat-array-into-a-2d-in-c/45606600#45606600", "title": "How to reshape a flat array into a 2d in C?", "body": "<p>Assuming that the pointer does point at an array, that is - a chunk of adjacent items of the same type, then you can safely cast the pointer type:</p>\n\n<pre><code>const int (*reshaped)[x] = (const int(*)[x])flat_array;\n</code></pre>\n\n<p>This is guaranteed to work because the type aliasing rules in C are only concerned of the nature of the pointed-at data and not so much about the pointer types involved. (See the concept of <em>effective type</em>, 6.5/6).</p>\n"}], "owner": {"reputation": 562, "user_id": 4920521, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/da5bf694a8abd194543f2c2f5f0b4d35?s=128&d=identicon&r=PG", "display_name": "Mano-Wii", "link": "https://stackoverflow.com/users/4920521/mano-wii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1433, "favorite_count": 0, "accepted_answer_id": 45601546, "answer_count": 4, "score": 0, "last_activity_date": 1502348425, "creation_date": 1502315961, "question_id": 45601288, "link": "https://stackoverflow.com/questions/45601288/how-to-reshape-a-flat-array-into-a-2d-in-c", "title": "How to reshape a flat array into a 2d in C?", "body": "<p>I have an array with x * x elements defined as a pointer.</p>\n\n<p>I wanted to do something like this:</p>\n\n<pre><code>void func(const unsigned int x, const int *flat_array)\n{\n    const int (*reshaped)[x] = flat_array;\n    ...\n}\n</code></pre>\n\n<p>but how?</p>\n"}, {"tags": ["c", "cs50"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1502313841, "post_id": 45600806, "comment_id": 78161034, "body": "<code>printf(&quot;%s\\n&quot;,cipherKey);</code> --&gt; <code>printf(&quot;%.*s\\n&quot;, n, cipherKey);</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502320342, "post_id": 45600806, "comment_id": 78163446, "body": "It is good to terminate the string with zero. Otherwise I am really surprised that you have only one letter more printed :)"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8441872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638b49e1b56f7e15bc79e422106f0f4c?s=128&d=identicon&r=PG&f=1", "display_name": "AKD92929", "link": "https://stackoverflow.com/users/8441872/akd92929"}, "edited": false, "score": 0, "creation_date": 1502314384, "post_id": 45600860, "comment_id": 78161284, "body": "Thank you so much! I had been struggling all day with this."}, {"owner": {"reputation": 9, "user_id": 8441872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638b49e1b56f7e15bc79e422106f0f4c?s=128&d=identicon&r=PG&f=1", "display_name": "AKD92929", "link": "https://stackoverflow.com/users/8441872/akd92929"}, "edited": false, "score": 0, "creation_date": 1502314494, "post_id": 45600860, "comment_id": 78161340, "body": "May I copy and paste your answer to this thread? <a href=\"https://www.reddit.com/r/cs50/comments/6so665/vigenere_lowercasing_script_inserts_extra/\" rel=\"nofollow noreferrer\">reddit.com/r/cs50/comments/6so665/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 8441872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638b49e1b56f7e15bc79e422106f0f4c?s=128&d=identicon&r=PG&f=1", "display_name": "AKD92929", "link": "https://stackoverflow.com/users/8441872/akd92929"}, "edited": false, "score": 0, "creation_date": 1502314928, "post_id": 45600860, "comment_id": 78161519, "body": "It looks like it also works to simply make the <code>&lt;</code> a <code>&lt;=</code> in the for loop, because the nth character in the string that is being lowercased is also <code>\\0</code>. That looks a little cleaner to me. :)"}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 9, "user_id": 8441872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638b49e1b56f7e15bc79e422106f0f4c?s=128&d=identicon&r=PG&f=1", "display_name": "AKD92929", "link": "https://stackoverflow.com/users/8441872/akd92929"}, "edited": false, "score": 0, "creation_date": 1502315261, "post_id": 45600860, "comment_id": 78161654, "body": "Yes, it will work with <code>&lt;=n</code> as well, leading to a call to `tolower(&#39;\\0&#39;)&#39;; Not sure if it is cleaner; I personally prefer to make things (in this case string termination) explicit; but it&#39;s clearly just a personal preference."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1502315868, "post_id": 45600860, "comment_id": 78161908, "body": "@StephanLechner As you like explicit: <code>tolower(some_char)</code> can be <i>undefined behavior</i> with <code>some_char &lt; 0</code>.  Use <code>tolower((unsigned char) some_char)</code> to avoid that problem."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 2, "last_activity_date": 1502316543, "last_edit_date": 1502316543, "creation_date": 1502313894, "answer_id": 45600860, "question_id": 45600806, "link": "https://stackoverflow.com/questions/45600806/vigenere-string-lowercasing-program-is-appending-character-for-some-inputs/45600860#45600860", "title": "&quot;Vigenere&quot; : String lowercasing program is appending character for some inputs", "body": "<p>You need to allocate space for the string termination character, and you need to terminate your string. Otherwise, you leave your string unterminated, <code>printf</code> may read out of the string's bounds yielding undefined behaviour (e.g. in form of \"weired\" output). You could correct this as follows:</p>\n\n<pre><code>    int n = strlen(argv[1]);\n    char cipherKey[n+1];\n    for (int i=0;i&lt;n;i++){\n        cipherKey[i]=tolower((unsigned char)argv[1][i]);\n    }\n    cipherKey[n]='\\0';\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8441872, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638b49e1b56f7e15bc79e422106f0f4c?s=128&d=identicon&r=PG&f=1", "display_name": "AKD92929", "link": "https://stackoverflow.com/users/8441872/akd92929"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502316543, "creation_date": 1502313605, "question_id": 45600806, "link": "https://stackoverflow.com/questions/45600806/vigenere-string-lowercasing-program-is-appending-character-for-some-inputs", "title": "&quot;Vigenere&quot; : String lowercasing program is appending character for some inputs", "body": "<p>I'm finding that my very basic code to lowercase a string is sometimes outputting an extra character. If I run <em>vigenere</em> with some inputs, it works correctly:</p>\n\n<pre><code>~/workspace/pset2/vigenere/ $ ./vigenere tweedDLed\ntweeddled\n</code></pre>\n\n<p>But for other inputs, it inserts an extra character at the end:</p>\n\n<pre><code>~/workspace/pset2/vigenere/ $ ./vigenere tweedDLedf\ntweeddledfB\n</code></pre>\n\n<p>or...</p>\n\n<pre><code>~/workspace/pset2/vigenere/ $ ./vigenere bkls33bf\nbkls33bfW\n</code></pre>\n\n<p>What is going on here? I am not finding anything with the debugger as the character array is not displayed. This is my code:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;cs50.h&gt;\n\nint main(int argc, string argv[]){\n    if (argc!=2){\n        return 1;\n    }\n    else{\n\n        int n = strlen(argv[1]);\n        char cipherKey[n];\n        for (int i=0;i&lt;n;i++){\n            cipherKey[i]=tolower(argv[1][i]);\n        }\n\n\n        printf(\"%s\\n\",cipherKey);\n\n\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "warnings"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1502347183, "post_id": 45600963, "comment_id": 78171122, "body": "I guess this works for VS IDE, not so sure about the Keil IDE !"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "edited": false, "score": 0, "creation_date": 1502351283, "post_id": 45600963, "comment_id": 78173710, "body": "it works in the eclipse as well. Keil is a specific case and code is barely portable."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502315732, "last_edit_date": 1502315732, "creation_date": 1502314416, "answer_id": 45600963, "question_id": 45600617, "link": "https://stackoverflow.com/questions/45600617/multi-c-compiler-warning-message/45600963#45600963", "title": "Multi C compiler #warning message", "body": "<p>I would not use warnings for it. As I see you use IDE so it is much easier to use comment tokens for example TODO. It is transparent to the compilers, does not mess in the source code and IMO is more convenient. You have some predefined tokens and you can create your own ones.</p>\n\n<p><strong>warnings</strong> should be left for warnings</p>\n\n<p><a href=\"https://i.stack.imgur.com/hCebG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hCebG.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 57, "user_id": 3314691, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3e64639f6ea0563f125d93d6236c2178?s=128&d=identicon&r=PG&f=1", "display_name": "user3314691", "link": "https://stackoverflow.com/users/3314691/user3314691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502315732, "creation_date": 1502312674, "question_id": 45600617, "link": "https://stackoverflow.com/questions/45600617/multi-c-compiler-warning-message", "title": "Multi C compiler #warning message", "body": "<p>I have some code which I am developing to compile on both MS Visual C 2010 compiler and an Embedded ARM compiler. Also I want to print some warnings at compile time to remind me that I have some testing code in place. Unfortunately MS do messages with #pragma instead of #warning so I can't just use the same pre-processor directive in both compilers.</p>\n\n<p>I could do this every where:</p>\n\n<pre><code>#ifdef _MSC_VER\n #pragma message(\"Something to say....\")\n#else\n #warning \"Something to say....\"\n#endif\n</code></pre>\n\n<p>But it would be nicer to have a macro encapsulate this, eg:</p>\n\n<pre><code>#define ccWarnMessage(m)   \\\n    #ifdef _MSC_VER \\\n     #pragma message(m) \\\n    #else \\\n     #warning m \\\n    #endif\n</code></pre>\n\n<p>This does not work but is there a way to do it in a neat way ?</p>\n"}, {"tags": ["c", "bit-manipulation", "c99"], "comments": [{"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502313054, "post_id": 45600305, "comment_id": 78160739, "body": "Sure, I can edit it. generic wasn&#39;t the actual name of the type in the assignment, I just changed it quickly so as to indicate its meaning. Sorry for the confusion."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502313273, "post_id": 45600305, "comment_id": 78160818, "body": "How is <code>g_int</code> defined in the  .h file?  It is always the same throughout a build?  It may impact how <code>flip_bit()</code> can be used."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502313392, "post_id": 45600305, "comment_id": 78160870, "body": "Yeah, sorry. I meant that when my code is tested, there are a bunch of different .h files that test it with the same name, tested one at a time, with all of these different integer types for each one. My method has to work for each of them."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502313854, "post_id": 45600305, "comment_id": 78161042, "body": "1) The trick is how, in a  large project, how would one .c file use <code>flip_bit()</code> with one type and another .c file use it with another?  There are ways to do this.  Yet if the goal is only <i>one</i> type for the entire build, no problem with what you have. 2) I see no advantage of using <code>uint8_t i</code> vs. <code>unsigned i</code>, yet some minor disadvantages - although neither is central to the <code>1 &lt;&lt;</code> issue."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502313948, "post_id": 45600305, "comment_id": 78161082, "body": "There&#39;s a .h file that declares this function as well. Actually, the typedef that defines <code>g_int</code> is the same one that holds this <code>flip_bit()</code> method."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1502311537, "post_id": 45600306, "comment_id": 78159998, "body": "The only correction is that shifting beyond the width of the integer is <i>undefined behavior</i> (not zero). <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.7p4\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#6.5.7p4</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1502313695, "post_id": 45600306, "comment_id": 78160978, "body": "<i>undefined behaviour</i> is different to &quot;undefined value&quot;. Anything could happen at all, not just an unexpected value."}, {"owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "edited": false, "score": 0, "creation_date": 1502313762, "post_id": 45600306, "comment_id": 78160999, "body": "My bad, I just changed it quickly. I&#39;ll fix it."}], "tags": [], "owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "is_accepted": true, "score": 5, "last_activity_date": 1502313823, "last_edit_date": 1502313823, "creation_date": 1502311352, "answer_id": 45600306, "question_id": 45600305, "link": "https://stackoverflow.com/questions/45600305/shifting-with-uint64-t-not-working-as-expected/45600306#45600306", "title": "Shifting with uint64_t not working as expected", "body": "<p>This problem is caused by the type of 1, which is int (which has 32 bits on a reasonable machine). This means that performing the shift <code>(1&lt;&lt;i)</code> for values of  i greater than or equal to 32 will result in undefined behavior.</p>\n\n<p>This can be fixed simply by casting 1 to type <code>g_int</code> before performing the shift:</p>\n\n<pre><code>g_int flip_bit(g_int b, uint8_t i){\n    g_int flipped = b ^ (((g_int)1)&lt;&lt;i);\n    return flipped;\n}\n</code></pre>\n"}], "owner": {"reputation": 855, "user_id": 7563901, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XOeAX.jpg?s=128&g=1", "display_name": "Lavaman65", "link": "https://stackoverflow.com/users/7563901/lavaman65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 45600306, "answer_count": 1, "score": 2, "last_activity_date": 1502382481, "creation_date": 1502311352, "last_edit_date": 1502382481, "question_id": 45600305, "link": "https://stackoverflow.com/questions/45600305/shifting-with-uint64-t-not-working-as-expected", "title": "Shifting with uint64_t not working as expected", "body": "<p>For part of a larger task, I was asked to implement a function that flips an arbitrary bit in an integer. The catch is that the \"integer\" could be any of the default integer types in c, from int8_t to uint64_t, and I don't know which one it will be. (In fact, my code has been tested on all of these types)</p>\n\n<p>This was my attempt at the problem:</p>\n\n<pre><code>//NOTE: g_int is the generic integer, it's typedef'd in a .h file\ng_int flip_bit(g_int b, uint8_t i){\n    //Code that makes sure i is a valid amount to shift by, there's a macro\n    //that defines the upper bound of i in a .h file.\n    g_int flipped = b ^ (1&lt;&lt;i);\n    return flipped;\n}\n</code></pre>\n\n<p>This code xors the <code>i</code>th bit in <code>b</code> with 1, and the other bits in <code>b</code> with 0. This should flip the <code>i</code>th bit while leaving the rest unchanged. Satisfied with this, I tested my code on all of these different integer sizes, and then turned it in. However, I must not have tested enough, as my code failed on both int64_t and uint64_t. </p>\n\n<p>What did I do wrong for int64_t and uint64_t, and is there something I can do to make my method work without changing it entirely?</p>\n"}, {"tags": ["c++", "c", "arduino"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1502311090, "post_id": 45600202, "comment_id": 78159814, "body": "Pleasse show a consistent piece of code. I.e. get as close as you can to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> please."}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502313475, "post_id": 45600202, "comment_id": 78160903, "body": "So sorry, I&#39;ll do"}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502325654, "post_id": 45600202, "comment_id": 78164730, "body": "I did. Thank you."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502353203, "post_id": 45600202, "comment_id": 78174930, "body": "Are you sure? I do not see an edit by you in the change log. I only see a change by KeineLust, who kindly improved the  markdown."}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502376232, "post_id": 45600202, "comment_id": 78192746, "body": "Ho I put it as answer, not as comment. Sorry. I am going to add it here if needed."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502317278, "post_id": 45600885, "comment_id": 78162462, "body": "I actually reading data byte-by-byte from the serial. But precisely, I would like to send the 4 bytes to the next serial (no choice for serial), and keep a trace of thoses informations in tables (10 maybe)... sketch is following"}, {"owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502317386, "post_id": 45600885, "comment_id": 78162495, "body": "so since you have 10 bits, write it as two bytes with a union and read it that way."}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502317641, "post_id": 45600885, "comment_id": 78162586, "body": "Thank you for your answer. however, I would like to keep as minimum possible size of the members, and this is why I try to stick to bits."}, {"owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502317897, "post_id": 45600885, "comment_id": 78162665, "body": "ok, well, good luck! trying to do something not aligned to byte boundaries is quite tricky."}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502318265, "post_id": 45600885, "comment_id": 78162772, "body": "now I am more interested. Please would you mind to precise your formulation"}, {"owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502318507, "post_id": 45600885, "comment_id": 78162849, "body": "do the details i added help? Or what were you looking for?"}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502318656, "post_id": 45600885, "comment_id": 78162902, "body": "&quot;doing something not aligned to byte boundaries&quot;. I am sorry I don&#39;t understand this point, and I would like you precise this point. If that is possible."}, {"owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502318735, "post_id": 45600885, "comment_id": 78162933, "body": "Ah, I just mean if you want to store an array of your <code>structTable</code> then it is hard to do that without wasting the extra six bits (from 10-&gt;16 bits). Most computer architectures are pretty inefficient at accessing non-aligned data."}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502319165, "post_id": 45600885, "comment_id": 78163081, "body": "thank you. this is why I am confuse in the process. should (if possible)  to cast the char (in hex) to a struct in my union, then write in struct of bit?"}, {"owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502376066, "post_id": 45600885, "comment_id": 78192636, "body": "Probably the other answer is more elegant!"}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502377055, "post_id": 45600885, "comment_id": 78193450, "body": "right now I am on the fog for this process, please, which answer you are talking about? thank you"}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502378450, "post_id": 45600885, "comment_id": 78194533, "body": "Thank you for your good help Sol Arnu, It seems I cannot post the result of your code, so I will ask a new question that follow this thread. Thank you"}, {"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502482610, "post_id": 45600885, "comment_id": 78245732, "body": "&quot;From Sol Arnu: I just mean if you want to store an array of your structTable then it is hard to do that without wasting the extra six bits (from 10-&gt;16 bits)&quot;.  Why a table could not be considered as slignment of strings in the table and just take each adress folling each other? Thank you"}], "tags": [], "owner": {"reputation": 197, "user_id": 1521611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/230ed18c5635ed65d03a1b44b3d7361c?s=128&d=identicon&r=PG", "display_name": "Sol Arnu", "link": "https://stackoverflow.com/users/1521611/sol-arnu"}, "is_accepted": false, "score": 1, "last_activity_date": 1502317853, "last_edit_date": 1502317853, "creation_date": 1502314025, "answer_id": 45600885, "question_id": 45600202, "link": "https://stackoverflow.com/questions/45600202/arduino-how-to-feed-a-struct-from-a-serial-read/45600885#45600885", "title": "Arduino - how to feed a struct from a serial.read()?", "body": "<p>According to the Arduino reference I just looked up <a href=\"https://www.arduino.cc/en/Serial/Read\" rel=\"nofollow noreferrer\">Serial::read</a>, the code returns data byte-by-byte (eight bits at a time). So probably you should just read the data one byte (eight bits at a time) and do your unpacking after the fact.</p>\n\n<p>In fact you might want to use a <code>union</code> (see e.g. <a href=\"https://stackoverflow.com/questions/2468708/converting-bit-field-to-int\">this other stackoverflow post</a> on how to use a <code>union</code>) so that you can get the best of both worlds. Specifically, if you define a <code>union</code> of your definition with the bits broken out and a second part of the <code>union</code> as one or two bytes, you can send the data as bytes and then decode it in the bits you are interested in.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is an attempt at some more details. There are a lot of caveats about unions - they aren't portable, they are compiler dependent, etc. But this might be worth trying.</p>\n\n<pre><code>typedef struct {\n  unsigned int page:1; // (0,1)\n  unsigned int cric:4; // 10 choices (4 bits)\n  unsigned int crac:3; // 5 choices (3 bits)\n  unsigned int croc:2; // 3 choices (2 bits)\n} structTable;\n\ntypedef union {\n  structTable a;\n  uint16_t b;\n} u_structTable;\n\nserial.Read(val1);\nserial.Read(val2);\n\nu_structTable x;\nx.b = val1 | (val2&lt;&lt;8);\nprintf(\"page is %d\\n\", x.a.page);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502378311, "post_id": 45603281, "comment_id": 78194444, "body": "thank you  much Michael Roy. I will try this and ask a new question that follow this post."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "edited": false, "score": 0, "creation_date": 1502379018, "post_id": 45603281, "comment_id": 78194995, "body": "Just make sure you use the same packed struct in the program at the other end to send/receive data.  This way of sending/receiving data is very common, This is the same technique used by the IP stack, for example.."}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": true, "score": 1, "last_activity_date": 1502331497, "last_edit_date": 1502331497, "creation_date": 1502330561, "answer_id": 45603281, "question_id": 45600202, "link": "https://stackoverflow.com/questions/45600202/arduino-how-to-feed-a-struct-from-a-serial-read/45603281#45603281", "title": "Arduino - how to feed a struct from a serial.read()?", "body": "<p>You can only send full bytes over the serial port.  But you can also send raw data directly. </p>\n\n<pre><code>void send (const structTable* table)\n{\n    Serial.write((const char*)table, sizeof(structTable));  // 2 bytes.\n}\n\nbool receive(structTable* table)\n{\n    return (Serial.readBytes((char*)table, sizeof(structTable)) == sizeof(structTable));\n}\n</code></pre>\n\n<p>You also have to be aware that sizeof(int) is not the same on all CPUS</p>\n\n<p>A word about endianness.  The definition for your struct for the program at the other end of the serial link, if running on a CPU with a different endianness would become:</p>\n\n<pre><code>struct structTable {\n  unsigned short int croc:2; // 3 choices (2 bits)\n  unsigned short int crac:3; // 5 choices (3 bits)\n  unsigned short int cric:4; // 10 choices (4 bits)\n  unsigned short int page:1; // (0,1)\n};\n</code></pre>\n\n<p>Note the use of short int, which you can also use in the arduino code to be more precise.  The reason is that short int is 16 bits on most CPUs, while int may be 16,32 or even 64 bits.</p>\n"}], "owner": {"reputation": 13, "user_id": 8425305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331713e4b470bc2ea83744a12390cc59?s=128&d=identicon&r=PG&f=1", "display_name": "patatos", "link": "https://stackoverflow.com/users/8425305/patatos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5015, "favorite_count": 0, "accepted_answer_id": 45603281, "answer_count": 2, "score": 1, "last_activity_date": 1502520514, "creation_date": 1502310945, "last_edit_date": 1502520514, "question_id": 45600202, "link": "https://stackoverflow.com/questions/45600202/arduino-how-to-feed-a-struct-from-a-serial-read", "title": "Arduino - how to feed a struct from a serial.read()?", "body": "<p>I am a beginner and I am trying to feed a struct table with 4 members typed BIN with a pointer, then send them to another one, serial2. I fail to do so.</p>\n\n<p>I receive 4 chars from <code>serial1.read()</code>, for example 'A' '10' '5' '3'. \nTo decrease the size of the data, I want to use a struct:</p>\n\n<pre><code>struct structTable {\n  unsigned int page:1; // (0,1)\n  unsigned int cric:4; // 10 choices (4 bits)\n  unsigned int crac:3; // 5 choices (3 bits)\n  unsigned int croc:2; // 3 choices (2 bits)\n};\n</code></pre>\n\n<p>I declare and set: instance and pointer</p>\n\n<pre><code>struct structTable structTable;\nstruct structTable *PtrstructTable; \nPtrstructTable = &amp;structTable;\n</code></pre>\n\n<p>Then I try to feed like this:</p>\n\n<pre><code>for(int i = 0; i&lt;=4; i++) {\n  if(i == 1) {\n    (*PtrProgs).page = Serial.read();\n  if(i == 2) {\n    (*PtrProgs).cric = Serial.read();\n</code></pre>\n\n<p>And so on. But it's not working...</p>\n\n<p>I tried to feed a first char table and tried to cast the result:</p>\n\n<pre><code>(*PtrProgs).page = PtrT[1], BIN;\n</code></pre>\n\n<p>And now, I realize I can not feed 3 bits in one time! doh! All this seems very weak, and certainly a too long process for just 4 values. (I wanted to keep this kind of struct table for more instances).</p>\n\n<p>Please, could you help me to find a simpler way to feed my table?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 5, "creation_date": 1502307223, "post_id": 45599155, "comment_id": 78157927, "body": "<code>i = (int)strlen(result);                 result[i - 1] = &#39;\\0&#39;;</code> what if string has 0 length? why null terminating a string in the middle of it?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502307373, "post_id": 45599155, "comment_id": 78158021, "body": "what does this function actually do? What is the idea?"}, {"owner": {"reputation": 8038, "user_id": 304748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a40ced265d8fde3bd35d5689c4181?s=128&d=identicon&r=PG", "display_name": "Brian Walker", "link": "https://stackoverflow.com/users/304748/brian-walker"}, "edited": false, "score": 3, "creation_date": 1502307392, "post_id": 45599155, "comment_id": 78158033, "body": "You are returning a pointer to an object on the stack - which will get overwritten. My compiler won&#39;t compile this because the definition of result cannot be allocated because the size is not constant."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502307502, "post_id": 45599155, "comment_id": 78158094, "body": "@PeterJ The function should split a string by a string, f.ex. splitStringByString(&quot;Hellosamigos&quot;, &quot;llosa&quot;) should return &quot;migos&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user820304"}, "reply_to_user": {"reputation": 8038, "user_id": 304748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a40ced265d8fde3bd35d5689c4181?s=128&d=identicon&r=PG", "display_name": "Brian Walker", "link": "https://stackoverflow.com/users/304748/brian-walker"}, "edited": false, "score": 3, "creation_date": 1502307564, "post_id": 45599155, "comment_id": 78158128, "body": "@BrianWalker you&#39;re compiling this as <code>C</code> <b>not</b> <code>C++</code> yeah? Mine seems to compile it fine."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502307615, "post_id": 45599155, "comment_id": 78158156, "body": "@Jean-Fran&#231;ois Fabre what do you mean with terminating it in the middle? The last character should be &#39;\\0&#39;."}, {"owner": {"reputation": 8038, "user_id": 304748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a40ced265d8fde3bd35d5689c4181?s=128&d=identicon&r=PG", "display_name": "Brian Walker", "link": "https://stackoverflow.com/users/304748/brian-walker"}, "edited": false, "score": 0, "creation_date": 1502307819, "post_id": 45599155, "comment_id": 78158237, "body": "@Thebluefish I get the compiler error for C++ or C. The problem with the code is that it is returning the address of a stack array that can be overwritten once the function returns - which would explain strange characters showing up in the data."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1502307819, "post_id": 45599155, "comment_id": 78158238, "body": "<code>i = (int)strlen(result)</code>: if the last character isn&#39;t 0 then <code>strlen</code> doesn&#39;t work..."}, {"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 2, "creation_date": 1502307978, "post_id": 45599155, "comment_id": 78158317, "body": "@Jean-Fran&#231;oisFabre Well that&#39;s absolutely true, haven&#39;t thought about it.Thanks!"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 8038, "user_id": 304748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc0a40ced265d8fde3bd35d5689c4181?s=128&d=identicon&r=PG", "display_name": "Brian Walker", "link": "https://stackoverflow.com/users/304748/brian-walker"}, "edited": false, "score": 3, "creation_date": 1502308593, "post_id": 45599155, "comment_id": 78158602, "body": "@BrianWalker: C.1999 has a feature called VLA (variable length array). Not all compilers are C.1999 compliant. C.2011 made VLA an optional feature."}], "answers": [{"comments": [{"owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 0, "creation_date": 1502308428, "post_id": 45599419, "comment_id": 78158523, "body": "That&#39;s basically it ;-) Didn&#39;t remember that strstr does not only return NULL if a string is not found but also the exact position otherwise. Thanks a lot. Why don&#39;t you understand my code and do you know what I did wrong?"}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1502309019, "post_id": 45599419, "comment_id": 78158817, "body": "@T.Meyer: In your code, you return <code>result</code>, which is a local array. When an array name is used in most expressions, the name decays to the address of the first array member. Thus, your code returns the address of a object that was local to the function. However, a local object become invalid once it is no longer in scope. Retuning from a function invalidates all of its local objects. When you return a value from a <code>int</code> variable, you get a copy of the value, but you don&#39;t get that behavior from arrays."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1502309441, "post_id": 45599419, "comment_id": 78159019, "body": "@T.Meyer - my advice - try to split problems into a smaller bits. Write function which will find the occurrence of one string in another - it is easier and separates the logic. Then having this one it is extremely easy to sort out your problem. Having to sort out both puzzles you just got lost."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "edited": false, "score": 1, "creation_date": 1502309903, "post_id": 45599419, "comment_id": 78159232, "body": "@T.Meyer you do not have any memory leaks as you do not allocate any memory. Memory leak is if memory is allocated but not freed and it gets lost to the program / system. You just have a lots of UBs (like returning pointers to not existing objects, strlen-ing the not null terminated memory locations, then writing something to the memory in the random locations etc)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 2, "last_activity_date": 1502308449, "last_edit_date": 1502308449, "creation_date": 1502307973, "answer_id": 45599419, "question_id": 45599155, "link": "https://stackoverflow.com/questions/45599155/c-split-string-function-returns-377-at-the-end-of-string-instead-of-0-why/45599419#45599419", "title": "C split string function returns \\377 at the end of string instead of \\0. Why?", "body": "<p>I do not understand your code but to do what you mention in the comment</p>\n\n<pre><code>char *splitSstring(char *haystack, char *separator)\n{\n    char *result = (haystack == NULL || separator == NULL || !strlen(haystack) || !strlen(separator)) ? NULL : haystack;\n\n    if (result != NULL)\n    {\n        result = strstr(haystack, separator);\n        if (result != NULL) result += strlen(separator);\n    }\n    return result;\n}\n</code></pre>\n\n<p>or if you want to have it in the separate string</p>\n\n<pre><code>char *splitSstring(char *haystack, char *separator, char *res)\n{\n    char *result = (haystack == NULL || separator == NULL || !strlen(haystack) || !strlen(separator)) ? NULL : haystack;\n\n    if (result != NULL)\n    {\n        result = strstr(haystack, separator);\n        if (result != NULL)\n        {\n            result = result + strlen(separator);\n            if(res == NULL) res = malloc(strlen(result) + 1);\n            if(res != NULL) strcpy(res, result);\n            result = res;\n        }\n    }\n    return result;\n}\n</code></pre>\n\n<p>you can provide your own buffer to the function or if you pass NULL it will be allocated for you. But you need to remember to free it;</p>\n"}], "owner": {"reputation": 1440, "user_id": 7973906, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/54a6d0e27146b174dd6a6c3cb5e54392?s=128&d=identicon&r=PG&f=1", "display_name": "j3141592653589793238", "link": "https://stackoverflow.com/users/7973906/j3141592653589793238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 45599419, "answer_count": 1, "score": 2, "last_activity_date": 1502308449, "creation_date": 1502306981, "last_edit_date": 1502307261, "question_id": 45599155, "link": "https://stackoverflow.com/questions/45599155/c-split-string-function-returns-377-at-the-end-of-string-instead-of-0-why", "title": "C split string function returns \\377 at the end of string instead of \\0. Why?", "body": "<p>I tried to implement a small splitStringByString() function in C, this is how I have come so far: </p>\n\n<pre><code>char* splitStringByString(char* string, char* delimiter){\n    int i = 0, j = 0, k = 0;\n    while(*(string + i) != '\\0'){\n        j = i;\n        while((*(string + j) == *(delimiter + k)) &amp;&amp; (*(string + j) != '\\0')){\n            if(*(delimiter + k + 1) == '\\0'){\n                // return string from here.\n                char result[(strlen(string) - strlen(delimiter) + 1)];  // + 1 for '\\0'\n                i = 0;\n                j++;\n                while(*(string + j) != '\\0'){\n                    result[i] = *(string + j);\n                    i += 1;\n                    j++;\n                }\n                i = (int)strlen(result);\n                result[i - 1] = '\\0';\n                return result;\n            }\n            k++;\n            j++;\n        }\n        i++;\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p>So it works more or less; \nthe function returns the string after the delimiter as wanted, but at the end of this string (the last character) is always \\377. \nI already found something that said this is an octal number or so (<a href=\"https://stackoverflow.com/questions/13830338/377-character-in-c\">stackoverflow</a>), but it is not very clear for me. Could you help me and give me some advice about what I did wrong?</p>\n\n<p>Thanks a lot! :-)</p>\n"}, {"tags": ["c", "pointers", "function-pointers"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1502306011, "post_id": 45598857, "comment_id": 78157298, "body": "This is a function returning a pointer. No function pointers here."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1502306321, "post_id": 45598857, "comment_id": 78157462, "body": "Believe if you&#39;ve never used/seen a function pointer, seeing one for the first time will look far more bizarre than what you have here."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502306481, "post_id": 45598857, "comment_id": 78157543, "body": "The idea of code challenge sites (whether a formal competition or not) is to solve the problem by yourself or by research (but not by copying code from &quot;tell&quot; sites). &quot;I somehow copied some code&quot; but the idea is to write your own code, not ask how to solve your bad plagiarism. Please ask a specific question about C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502306532, "post_id": 45598857, "comment_id": 78157564, "body": "I&#39;m voting to close this question as off-topic because you don&#39;t understand code you have ripped off."}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502307325, "post_id": 45598857, "comment_id": 78157998, "body": "@WeatherVane My question was not about solving the challenge. It was specifically about C. I am not primarily interested to solve the challenge. I am interested to understand the things I asked. Have I asked &quot;how to solve the challenge?&quot;? I use the challenges because I want to learn and sometimes I do not know what should I learn. I do not learn because I want to solve these challenges. I am voting this question to be answered. Does SO have an own way of learning and the one used by me in this case is wrong? Let me know. Thank you!"}, {"owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1502359021, "post_id": 45598857, "comment_id": 78179172, "body": "@WhozCraig Please recommend me a good introductory book or course to function pointers and functions returning pointers in C."}], "answers": [{"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 2, "last_activity_date": 1502306044, "creation_date": 1502306044, "answer_id": 45598908, "question_id": 45598857, "link": "https://stackoverflow.com/questions/45598857/function-returning-a-pointer-in-c/45598908#45598908", "title": "Function returning a pointer in C", "body": "<p>There is nothing about function pointer here. <code>solve</code> is a function which returns an <code>int *</code> (pointer to <code>int</code>) type. </p>\n\n<blockquote>\n  <p>And why do I must use static array?  </p>\n</blockquote>\n\n<p>Returning a pointer to an automatic local variable leads to undefined behavior, therefore <code>static</code> is used to make it static variable.  </p>\n\n<p>Other way around is to allocate space dynamically in function <code>solve</code>  </p>\n\n<pre><code>int *ar = malloc(sizeof (int) * 2);\nmemset(ar, 0, sizeof(ar));\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8279871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/260659577b24d6b3446173d786d8927a?s=128&d=identicon&r=PG&f=1", "display_name": "Barani", "link": "https://stackoverflow.com/users/8279871/barani"}, "is_accepted": false, "score": 2, "last_activity_date": 1502306566, "creation_date": 1502306566, "answer_id": 45599040, "question_id": 45598857, "link": "https://stackoverflow.com/questions/45598857/function-returning-a-pointer-in-c/45599040#45599040", "title": "Function returning a pointer in C", "body": "<p>static variables are life-timed until the program is terminated. This is a function returning pointer to integer. So the program executes without issues. While the semantics are slightly changed when the static variables are under a shared object,the above example is a plain vanilla flavor.</p>\n"}], "owner": {"reputation": 713, "user_id": 7369189, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/zRaoJ.png?s=128&g=1", "display_name": "Tim\u0298tei", "link": "https://stackoverflow.com/users/7369189/tim%ca%98tei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1502306764, "creation_date": 1502305844, "last_edit_date": 1502306764, "question_id": 45598857, "link": "https://stackoverflow.com/questions/45598857/function-returning-a-pointer-in-c", "title": "Function returning a pointer in C", "body": "<p>I solved the next challenge on hacker rank. I searched the internet and found something about function pointers (which I thought will help me to solve the challenge), but I could not solve it. I looked in the discussion on the site and I have found a way to solve the problem. It did not pass all the test cases on the site, but it worked for 5 out of 7. I somehow copied some code, ran it, made some change, ran it and so on until I got the following version. The thing is that I still do not understand how and why does it work and if this approach is the best used in this case. This is my code:</p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;stdbool.h&gt;\n\nint* solve(int a0, int a1, int a2, int b0, int b1, int b2, int *result_size){\n    static int ar[2] = {0, 0};\n    *result_size = 2;\n    ar[0] += a0 &gt; b0;\n    ar[0] += a1 &gt; b2;\n    ar[0] += a2 &gt; b2;\n    ar[1] += b0 &gt; a0;\n    ar[1] += b1 &gt; a1;\n    ar[1] += b2 &gt; a2;\n    return ar;\n}\n\nint main() {\n    int a0; \n    int a1; \n    int a2; \n    scanf(\"%d %d %d\", &amp;a0, &amp;a1, &amp;a2);\n    int b0; \n    int b1; \n    int b2; \n    scanf(\"%d %d %d\", &amp;b0, &amp;b1, &amp;b2);\n    int result_size;\n    int* result = solve(a0, a1, a2, b0, b1, b2, &amp;result_size);\n    for(int result_i = 0; result_i &lt; result_size; result_i++) {\n        if(result_i) {\n            printf(\" \");\n        }\n        printf(\"%d\", result[result_i]);\n    }\n    puts(\"\");\n\n\n    return 0;\n}\n</code></pre>\n\n<p>This is the link to the problem: <a href=\"https://www.hackerrank.com/challenges/compare-the-triplets/problem/%22Compare%20the%20triplets%22\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/compare-the-triplets/problem</a>.</p>\n\n<p>What I do not understand is that <code>int *solve</code>. How does that work? I read the question about function pointers on SO, but I didn't get it. And why must I use <code>static</code> array? If the array is not static my compiler (gcc) says that I can't return address of local variable. Also in main shouldn't <code>int* solve</code> have memory allocated?</p>\n\n<p>(Should I add the \"text\" of the problem here instead of adding the link?)</p>\n"}, {"tags": ["c", "windows", "assembly", "64-bit"], "comments": [{"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1502305199, "post_id": 45598583, "comment_id": 78156850, "body": "Putting bitwise operations and modulo at the same level makes me wonder what you are looking for. Anyway, I usually use 16 byte LUT with <code>&#39;0123456789ABCDEF</code> string, per each nibble (4 bits). It&#39;s a bit longer (binary size, including the LUT) than pure-code solution, but simpler to write in a hurry. //// edit: and you are converting [binary] value into hexadecimal string... there&#39;s nothing &quot;hexa&quot; about your source value, except you picked hexa formatting for your example. (formatting is not part of value)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502305327, "post_id": 45598583, "comment_id": 78156920, "body": "I can see how you go from hex <code>0xF05C1E3A</code> to <code>0x4630354331453341</code> which doubles the length 8 to 16 (without the <code>0x</code>) , but not how you go from dec <code>4032568890</code> to <code>5057600944242766657</code> which goes from length 10 to length 19."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502305450, "post_id": 45598583, "comment_id": 78156992, "body": "@WeatherVane it&#39;s just the same value shown in both formattings."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1502305628, "post_id": 45598583, "comment_id": 78157088, "body": "@Ped7g It&#39;s not encryption if that&#39;s what you mean. I&#39;m not sure what you mean by LUT? Yes, you&#39;re right, I&#39;ll edit that."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1502305721, "post_id": 45598583, "comment_id": 78157137, "body": "&quot;Look Up Table&quot;, as shown in the first comment from @Ped7g where you index an ASCII array by a 4-bit nibble value."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502305795, "post_id": 45598583, "comment_id": 78157174, "body": "@WeatherVane I like that"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1502310153, "post_id": 45598583, "comment_id": 78159349, "body": "Note this is not hex to ... this is binary to ....   I assume you mean the decimal values are in ASCII as in a string, you are not being very clear as to what your input and output are.  now if you really have  string of hex values, 0x30, 0x31, etc, then by showing us 0xABCD is misleading, do you have the ASCII string 0x30 then &#39;x&#39; then 0x41, 0x42 etc?  Or is it the binary value 0xABCDEF?  If the former then you need to convert from an ascii string of hex values to binary then convert from binary to as ascii string representing the number in decimal."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1502310361, "post_id": 45598583, "comment_id": 78159455, "body": "I assume you know how to convert 12345 seconds into 3:25:45?  it is exactly the same as that instead of base 10 to base 60 you are going from base 2 to base 10 or perhaps since your question is vague from base 16 to base 2 (trivial), then from base 2 to base 10 (like the 10 to 60 conversion above).  The only time there is a trick is if the base you are converting to/from is a power of the other base (hex to binary, octal to binary)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1502310504, "post_id": 45598583, "comment_id": 78159521, "body": "on  top of this you also have maybe a from and sounds like a to ASCII mixed in this as well, do that first and last as needed, decimal to/from ascii is trivial, hex to/from is mostly trivial has a conditional in there or use a look up table."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1502311563, "post_id": 45598583, "comment_id": 78160008, "body": "@old_timer I have edited the question to clear up confusion. I&#39;m leaving the hexadecimal values in the question because they were helpful while writing it - I was using it as a LUT."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502314499, "post_id": 45598583, "comment_id": 78161345, "body": "&quot; This means the result will be twice the size; &quot; --&gt; close.  A <i>string</i> has a <i>null character</i>, so the size of the string will be 2*N + 1."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502320268, "post_id": 45598583, "comment_id": 78163425, "body": "@chux it&#39;s not a string, it&#39;s an integer that contains a character code in every 8 bits."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502331266, "post_id": 45598583, "comment_id": 78166060, "body": "@MarkRansom Perhaps OP does not want what was asked as a <i>string</i> was requested,  a &quot;regular string&quot;."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502331471, "post_id": 45598583, "comment_id": 78166123, "body": "@chux you could be right. But as asked, it certainly <i>looks</i> like they&#39;re expecting a single number, especially when inquiring about bit manipulation methods."}], "answers": [{"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502306304, "post_id": 45598735, "comment_id": 78157455, "body": "I wasn&#39;t aware of PDEP so I had to <a href=\"https://en.wikipedia.org/wiki/Bit_Manipulation_Instruction_Sets#Parallel_bit_deposit_and_extract\" rel=\"nofollow noreferrer\">look it up</a>. Very interesting, but not universally available."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502306376, "post_id": 45598735, "comment_id": 78157491, "body": "@MarkRansom not universally fast either, it&#39;s pretty slow on Ryzen. But I thought it would be interesting."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502330229, "post_id": 45598735, "comment_id": 78165779, "body": "I figured out a way to spread the bytes without PDEP, have a look at my answer."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502491032, "post_id": 45598735, "comment_id": 78248643, "body": "You have a bug in this code - you want to add 0x41 but you also need to subtract 10 at the same time, so 10-&gt;&#39;A&#39; rather than 0-&gt;&#39;A&#39;. I considered fixing it for you but I&#39;ll let you do the honors."}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502491175, "post_id": 45598735, "comment_id": 78248681, "body": "@MarkRansom right thanks, I&#39;ve changed that constant"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1609673531, "post_id": 45598735, "comment_id": 115890633, "body": "<a href=\"https://stackoverflow.com/q/53823756\">How to convert a binary integer number to a hex string?</a> has some x86 asm SIMD versions, SSE2 through AVX512VBMI.  (Your SIMD link is dead, perhaps <a href=\"http://0x80.pl/articles/convert-to-hex.html\" rel=\"nofollow noreferrer\">0x80.pl/articles/convert-to-hex.html</a>? ).  There&#39;s also an implementation in an old version of Agner Fog&#39;s VCL using conditional add instead of a <code>pshufb</code> LUT: <a href=\"https://github.com/darealshinji/vectorclass/blob/master/special/decimal.h#L828\" rel=\"nofollow noreferrer\">github.com/darealshinji/vectorclass/blob/master/special/&hellip;</a>"}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": false, "score": 4, "last_activity_date": 1609675068, "last_edit_date": 1609675068, "creation_date": 1502305314, "answer_id": 45598735, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45598735#45598735", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>Spreading out the nibbles to bytes is easy with <code>pdep</code>:</p>\n<pre><code>spread = _pdep_u64(raw, 0x0F0F0F0F0F0F0F0F);\n</code></pre>\n<p>Now we'd have to add 0x30 to bytes in the range 0-9 and 0x41 to higher bytes. This could be done by SWAR-subtracting 10 from every byte and then using the sign to select which number to add, such as (not tested)</p>\n<pre><code>H = 0x8080808080808080;\nten = 0x0A0A0A0A0A0A0A0A\ncmp = ((spread | H) - (ten &amp;~H)) ^ ((spread ^~ten) &amp; H); // SWAR subtract\nmasks = ((cmp &amp; H) &gt;&gt; 7) * 255;\n// if x-10 is negative, take 0x30, else 0x41\nadd = (masks &amp; 0x3030303030303030) | (~masks &amp; 0x3737373737373737);\nasString = spread + add;\n</code></pre>\n<p>That SWAR compare can probably be optimized since you shouldn't need a full subtract to implement it.</p>\n<p>There are some different suggestions here, including SIMD: <a href=\"http://0x80.pl/articles/convert-to-hex.html\" rel=\"nofollow noreferrer\">http://0x80.pl/articles/convert-to-hex.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 1, "last_activity_date": 1502305603, "creation_date": 1502305603, "answer_id": 45598809, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45598809#45598809", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<ol>\n<li><code>Decimal -&gt; Hex</code></li>\n</ol>\n\n<p>Just iterate throught string and every character convert to <code>int</code>, then you can do</p>\n\n<pre><code>printf(\"%02x\", c);\n</code></pre>\n\n<p>or use <code>sprintf</code> for saving to another variable</p>\n\n<ol start=\"2\">\n<li><code>Hex -&gt; Decimal</code></li>\n</ol>\n\n<p>Code</p>\n\n<pre><code>printf(\"%c\",16 * hexToInt('F') + hexToInt('0'));\n\n\nint hexToInt(char c)\n{\n    if(c &gt;= 'a' &amp;&amp; c &lt;= 'z')\n        c = c - ('a' - 'A');\n\n    int sum;\n\n    sum = c / 16 - 3;\n    sum *= 10;\n    sum += c % 16;\n\n    return (sum &gt; 9) ? sum - 1 : sum;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502307040, "post_id": 45599076, "comment_id": 78157833, "body": "Links do no make a good answer, because they are not <i>your</i> answer, and because they may vanish. More of a comment."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1502307172, "post_id": 45599076, "comment_id": 78157902, "body": "And converting binary value into hexadecimal string through ordinary math arithmetic is horrible, as the 4-bit groups directly map to single hexadecimal digit, so there&#39;s no math involved at all. I.e. conversion to hexa is nowhere similar to conversion to decimal, which is much more tough problem for computers. Hexa is just &quot;remapping&quot; bits without any [serious] calculation."}], "tags": [], "owner": {"reputation": 522, "user_id": 7906900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff7b0c58dbfaacf8f68a9644a71a493f?s=128&d=identicon&r=PG&f=1", "display_name": "Gryphon", "link": "https://stackoverflow.com/users/7906900/gryphon"}, "is_accepted": false, "score": 1, "last_activity_date": 1502320765, "last_edit_date": 1502320765, "creation_date": 1502306684, "answer_id": 45599076, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45599076#45599076", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>The articles below compare different methods of converting digits to string, hex numbers are not covered but it seems not a big problem to switch from dec to hex</p>\n\n<p><a href=\"https://translate.google.com/translate?sl=ru&amp;tl=en&amp;js=y&amp;prev=_t&amp;hl=ru&amp;ie=UTF-8&amp;u=http%3A%2F%2Fwe.easyelectronics.ru%2FSoft%2Fpreobrazuem-v-stroku-chast-1-celye-chisla.html&amp;edit-text=&amp;act=url\" rel=\"nofollow noreferrer\">Integers</a></p>\n\n<p><a href=\"https://translate.google.com/translate?hl=ru&amp;sl=ru&amp;tl=en&amp;u=http%3A%2F%2Fwe.easyelectronics.ru%2FSoft%2Fpreobrazuem-v-stroku-chast-2-chisla-s-fiksirovannoy-i-plavayuschey-tochkoy.html\" rel=\"nofollow noreferrer\">Fixed and floating point</a></p>\n\n<p>@EDIT\nThank you for pointing that the answer above is not relevant.\nCommon way with no LUT is to split integer into nibbles and map them to ASCII</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;string.h&gt;\n\n#define HI_NIBBLE(b) (((b) &gt;&gt; 4) &amp; 0x0F)\n#define LO_NIBBLE(b) ((b) &amp; 0x0F)\n\nvoid int64_to_char(char carr[], int64_t val){\n    memcpy(carr, &amp;val, 8);\n}\n\nuint64_t inp = 0xF05C1E3A;\nchar tmp_st[8];\n\nint main()\n{\n    int64_to_char(tmp_st,inp);\n    printf(\"Sample: %x\\n\", inp);\n    printf(\"Result: 0x\");\n    for (unsigned int k = 8; k; k--){\n        char tmp_ch = *(tmp_st+k-1);\n        char hi_nib = HI_NIBBLE(tmp_ch);\n        char lo_nib = LO_NIBBLE(tmp_ch);\n        if (hi_nib || lo_nib){\n            printf(\"%c%c\",hi_nib+((hi_nib&gt;9)?55:48),lo_nib+((lo_nib&gt;9)?55:48));\n        }\n     }\n     printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Another way is to use Allison's Algorithm. I am total noob in ASM, so I post the code in the form I googled it.</p>\n\n<p>Variant 1:</p>\n\n<pre><code>ADD AL,90h\nDAA\nADC AL,40h\nDAA\n</code></pre>\n\n<p>Variant 2:</p>\n\n<pre><code>CMP  AL, 0Ah\nSBB  AL, 69h\nDAS\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502310524, "post_id": 45599400, "comment_id": 78159536, "body": "come on! It is not C as tagged"}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "edited": false, "score": 0, "creation_date": 1502311242, "post_id": 45599400, "comment_id": 78159876, "body": "You&#39;re right it is much easier to code. I like this!"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502313369, "post_id": 45599400, "comment_id": 78160860, "body": "@PeterJ ups, sorry, I&#39;m usually checking just assembly questions on SO, and then whether the C or C++ is added doesn&#39;t matter that much for me. To OP: but in C you have this beautiful thing like clib, which has for example <code>*printf(&quot;%08x&quot;, ...)</code>. Unless you really have measurable (!) performance bottleneck in formatting, it&#39;s always safer to use already well tested solution. Also if you have problem to convert this C++ into C, let me know, but then the question arises, how you want the output be done (C++ streams are reasonable general interface how to write output idea simply)."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502313563, "post_id": 45599400, "comment_id": 78160934, "body": "@Ped7g I use both so you don&#39;t have to proof that C++ is a very decent language :). I am not taking the part in this religious war. OP wanted C so probably he does not know C++."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "edited": false, "score": 0, "creation_date": 1502314707, "post_id": 45599400, "comment_id": 78161432, "body": "Either is fine, I can understand your answer."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502314969, "post_id": 45599400, "comment_id": 78161540, "body": "@PeterJ added also C example (the algorithm is actually without any change in both languages, it&#39;s just about output), and link to third variant, how to do it without LUT just in code, plus it&#39;s a real world example how overall tailor-fit architecture can speed up code several times."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502315747, "post_id": 45599400, "comment_id": 78161857, "body": "@Ped7g I have added my one as well (more universal any base &lt; 255 and negative numbers as well)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502316031, "post_id": 45599400, "comment_id": 78161982, "body": "@Ped7g I think you have made a mistake :). Your string has the reverse order of digits. And actually it is an UB as you forgot the trailing zero as well"}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502316172, "post_id": 45599400, "comment_id": 78162052, "body": "@PeterJ no, and no. The C variant is converting array of bytes, not <code>dwords</code>. And it doesn&#39;t add zero terminator on purpose, in case it&#39;s just part of output, or written into file. As documented in the comment about the function. I have seen your universal converter, looks quite good. For binary -&gt; hex it&#39;s a bit slow, but the any-base feature makes that worth in some cases. ... EDIT: thinking more about the wording of question, the trailing zero would be maybe closer to OP intention. It&#39;s difficult to work for me without accurate specs, as I tend to abuse every tiny detail ;)"}], "tags": [], "owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "is_accepted": false, "score": 2, "last_activity_date": 1502314563, "last_edit_date": 1502314563, "creation_date": 1502307906, "answer_id": 45599400, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45599400#45599400", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>A LUT (lookup table) C++ variant. I didn't check the actual machine code produced, but I believe any modern C++ compiler can catch the idea and compile it well.</p>\n\n<pre><code>static const char nibble2hexChar[] { \"0123456789ABCDEF\" };\n     // 17B in total, because I'm lazy to init it per char\n\nvoid byteToHex(std::ostream &amp; out, const uint8_t value) {\n    out &lt;&lt; nibble2hexChar[value&gt;&gt;4] &lt;&lt; nibble2hexChar[value&amp;0xF];\n}\n\n// this one is actually written more toward short+simple source, than performance\nvoid dwordToHex(std::ostream &amp; out, uint32_t value) {\n    int i = 8;\n    while (i--) {\n        out &lt;&lt; nibble2hexChar[value&gt;&gt;28];\n        value &lt;&lt;= 4;\n    }\n}\n</code></pre>\n\n<hr>\n\n<p>EDIT: For C code you have just to switch from <code>std::ostream</code> to some other output means, unfortunately your question lacks any details, what you are actually trying to achieve and why you don't use the built-in <code>printf</code> family of C functions.</p>\n\n<p>For example C like this can write to some <code>char*</code> output buffer, converting arbitrary amount of bytes:</p>\n\n<pre><code>/**\n * Writes hexadecimally formatted \"n\" bytes array \"values\" into \"outputBuffer\".\n * Make sure there's enough space in output buffer allocated, and add zero\n * terminator yourself, if you plan to use it as C-string.\n * \n * @Returns: pointer after the last character written.\n */\nchar* dataToHex(char* outputBuffer, const size_t n, const unsigned char* values) {\n    for (size_t i = 0; i &lt; n; ++i) {\n        *outputBuffer++ = nibble2hexChar[values[i]&gt;&gt;4];\n        *outputBuffer++ = nibble2hexChar[values[i]&amp;0xF];\n    }\n    return outputBuffer;\n}\n</code></pre>\n\n<p>And finally, I did help once somebody on code review, as he had performance bottleneck exactly with hexadecimal formatting, but I did there the code variant conversion, without LUT, also the whole process and other answer + performance measuring may be instructional for you, as you may see that the fastest solution doesn't just blindly convert result, but actually mix up with the main operation, to achieve better performance overall. So that's why I'm wonder what you are trying to solve, as the whole problem may often allow for more optimal solution, if you just ask about conversion, <code>printf(\"%x\",..)</code> is safe bet.</p>\n\n<p>Here is that another approach for \"to hex\" conversion:\n<a href=\"https://codereview.stackexchange.com/a/133840/110284\">fast C++ XOR Function</a></p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502327284, "post_id": 45600479, "comment_id": 78165101, "body": "You don&#39;t special-case base10 or base16, so the compiler will use an actual <code>div</code> instruction per digit.  That&#39;s going to really suck compared to <a href=\"https://stackoverflow.com/questions/41183935/why-does-gcc-use-multiplication-by-a-strange-number-in-implementing-integer-divi\">what it can do for a compile-time-constant division by 10</a>.  Or especially for div / mod by 16 or 8, which is just a shift or mask."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502330126, "post_id": 45600479, "comment_id": 78165756, "body": "Also, it would be faster to decrement a pointer starting from the end of a <code>char tmp[sizeof(long long)*CHAR_BIT]</code> local buffer, and then memcpy from that to the right position in <code>buff</code> (the start, or after a leading <code>-</code>).  Then you don&#39;t have to reverse.  You also don&#39;t have to <code>strlen()</code> when you already have that information."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502330302, "post_id": 45600479, "comment_id": 78165804, "body": "This is broken for <code>LLONG_MIN</code> on 2&#39;s complement machines, because <code>-LLONG_MIN</code> is still negative."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502349760, "post_id": 45600479, "comment_id": 78172791, "body": "@Peter Cordes 1. It is universal one for the forum. One can make it as optimal as he onts by adding special cases or changing the  number type. 2. No. As you do not know converted string length and you do not know the buff size. 3. Yes it is. But works in the rest 18446744073709551615 cases"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350407, "post_id": 45600479, "comment_id": 78173194, "body": "<code>sizeof(long long) * CHAR_BIT</code> is always enough space for just the digits.  There&#39;s a very low upper-bound on that, usually 64, so creating an automatic storage array of that size should always be fine.  You already check that <code>base&gt;=2</code>, so you know for certain that there are at most <code>sizeof(long long) * CHAR_BIT</code> digits (any base higher than 2 will take fewer digits).  This is why I suggested a tmp buffer with automatic storage, rather than <code>memmove</code> inside inside the caller&#39;s destination, because <i>that</i>&#39;s the only thing you can&#39;t do."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350543, "post_id": 45600479, "comment_id": 78173273, "body": "re: point 1: the question title says &quot;efficient&quot;.  You&#39;re giving up <i>massive</i> amounts of efficiency by generalizing this for any base."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350546, "post_id": 45600479, "comment_id": 78173275, "body": "It does not make too much sanse as buff may be shorter. This is the <b>correct</b> way of doing it."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350628, "post_id": 45600479, "comment_id": 78173324, "body": "Of course buff may be shorter.  That&#39;s why you only copy as many non-zero digits as you actually produce, not the whole <code>tmp</code>.  <code>tmp[]</code> just has to be big enough for the worst-case, to avoid making it variable-sized."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350856, "post_id": 45600479, "comment_id": 78173446, "body": "Anyway, this is a potentially-useful answer for someone, but it doesn&#39;t belong on this question.  I&#39;m not going to downvote it, since it&#39;s at least mostly correct, just answering a different question."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502350955, "post_id": 45600479, "comment_id": 78173496, "body": "@Peter Cordes you should point it to the standard library authors as well. It is an incorrect approach in the general case."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502351478, "post_id": 45600479, "comment_id": 78173851, "body": "efficiency is a quite broad term - efficient in speed, memory, size? I tool a look how the standard library functions look like - same as mine. report to <a href=\"https://gcc.gnu.org/bugzilla/\" rel=\"nofollow noreferrer\">gcc.gnu.org/bugzilla</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502351821, "post_id": 45600479, "comment_id": 78174041, "body": "The OP here is clearly looking for execution speed, given that it&#39;s tagged assembly.  If the standard library implementations are slow, that&#39;s probably why this question got asked in the first place.  Which C library function did you look at?  Part of sprintf?  Can you link the source you were looking at?  (I am actually curious about this part, not just arguing with you). The variable-base functions like <code>strtol</code> all for converting in the other direction, where you multiply by the base."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502352237, "post_id": 45600479, "comment_id": 78174296, "body": "depending on your compiler and platform google for example &quot;arm gcc ltoa source code&quot;, download the latest build of the toolchain and see the sources- you have a lots of options. I intentionally do not give you a particular one - as you may say that I have chosen one to proof my point"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502353709, "post_id": 45600479, "comment_id": 78175259, "body": "On modern platforms idiv or sdiv instructuions are very fast and the overhead compating to and-ing and shifting is marginal. If you are on 32 bit platform just change the <code>long long</code> to <code>long</code> and on many platforms you will get the same execution time as with shifts."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502354161, "post_id": 45600479, "comment_id": 78175548, "body": "glibc internally uses an <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=stdio-common/_itoa.c;hb=68dc02d1dcbfb37ee22327d6a3c43f528d593035#l162\" rel=\"nofollow noreferrer\"><code>_itoa_word</code> function</a> which takes a variable base, but it does both of the optimizations I suggested: it uses <code>switch(base)</code> to special-case bases 8, 10, and 16, and it counts backward from the end of the caller&#39;s buffer (which is what the caller passes).  <code>objdump -drwC -Mintel &#47;lib&#47;libc.so.6 | less</code> on my desktop shows asm that looks exactly like that function, and there are calls to it from other glibc functions."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1502354675, "post_id": 45600479, "comment_id": 78175939, "body": "<code>idiv r64</code> is one of the slowest x86 integer instructions.  See <a href=\"https://stackoverflow.com/a/40355466/224132\">stackoverflow.com/a/40355466/224132</a>, where I went into more detail about performance.  The latency is 32-96 cycles on Intel Haswell, and throughput almost as bad.  A shift or AND each have 1 cycle latency, and can run two or four per clock cycle, respectively.  ARM may be different.  <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0460d/Cfahhdji.html\" rel=\"nofollow noreferrer\">infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0460&zwnj;&#8203;d/&hellip;</a> says the latency is high for small divisors, like x86.  Are you sure your test didn&#39;t inline into a caller with a compile-time-constant base?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 2, "last_activity_date": 1502312888, "last_edit_date": 1502312888, "creation_date": 1502312015, "answer_id": 45600479, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45600479#45600479", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>A bit more decent conversion from the the integer to the string any base from 2 to length of the digits</p>\n\n<pre><code>char *reverse(char *);\n\nconst char digits[] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nchar *convert(long long number, char *buff, int base)\n{\n    char *result = (buff == NULL || base &gt; strlen(digits) || base &lt; 2) ? NULL : buff;\n    char sign = 0;\n\n    if (number &lt; 0)\n    {\n         sign = '-';\n        number = -number;\n    }\n    if (result != NULL)\n    {\n        do\n        {\n            *buff++ = digits[number % base];\n            number /= base;\n        } while (number);\n        if(sign) *buff++ = sign;\n        *buff = 0;\n        reverse(result);\n    }\n    return result;\n}\n\n\nchar *reverse(char *str)\n{\n    char tmp;\n    int len;\n\n    if (str != NULL)\n    {\n        len = strlen(str);\n        for (int i = 0; i &lt; len / 2; i++)\n        {\n            tmp = *(str + i);\n            *(str + i) = *(str + len - i - 1);\n            *(str + len - i - 1) = tmp;\n\n        }\n    }\n    return str;\n}\n</code></pre>\n\n<p>example - counting from -50 to 50 decimal in base 23</p>\n\n<blockquote>\n<pre><code>-24     -23     -22     -21     -20     -1M     -1L     -1K     -1J     -1I     -1H     -1G     -1F     -1E     -1D\n-1C     -1B     -1A     -19     -18     -17     -16     -15     -14     -13     -12     -11     -10     -M      -L\n-K      -J      -I      -H      -G      -F      -E      -D      -C      -B      -A      -9      -8      -7      -6\n-5      -4      -3      -2      -1      0       1       2       3       4       5       6       7       8       9\nA       B       C       D       E       F       G       H       I       J       K       L       M       10      11\n12      13      14      15      16      17      18      19      1A      1B      1C      1D      1E      1F      1G\n1H      1I      1J      1K      1L      1M      20      21      22      23      24\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502331737, "post_id": 45601966, "comment_id": 78166183, "body": "Good use of <code>LL</code> (although it is not truly needed here) along with some &quot;magic&quot;."}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502332159, "post_id": 45601966, "comment_id": 78166293, "body": "@chux it depends on the compiler. I&#39;m used to Microsoft&#39;s, which still considers <code>long</code> to be only 32 bits."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502332488, "post_id": 45601966, "comment_id": 78166378, "body": "All <i>integer constants</i> are positive, at least since C99 - regardless of <code>int&#47;long</code> length.  The <code>uint64_t &amp; _hexadecimal constant_</code> will convert the <i>hexadecimal constant</i> to <code>uint64_t</code> even those that lack an <code>LL</code>. If anything a <code>U</code> is valuable.  IAC, a worthy answer"}, {"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502334758, "post_id": 45601966, "comment_id": 78166885, "body": "@chux perhaps C++ is different in that regard? That too is what I&#39;m used to. I&#39;m glad you&#39;re here to add some clarifying remarks."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "edited": false, "score": 0, "creation_date": 1502473413, "post_id": 45601966, "comment_id": 78241463, "body": "I like all the answers, but this takes the biscuit. Thank you!"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502498701, "post_id": 45601966, "comment_id": 78250143, "body": "@MarkRansom:  I think I found a slightly simpler version ;-)"}], "tags": [], "owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "is_accepted": true, "score": 5, "last_activity_date": 1502328759, "last_edit_date": 1502328759, "creation_date": 1502320130, "answer_id": 45601966, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45601966#45601966", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>Here's a solution with nothing but shifts, and/or, and add/subtract. No loops either.</p>\n\n<pre><code>uint64_t x, m;\nx = 0xF05C1E3A;\nx = ((x &amp; 0x00000000ffff0000LL) &lt;&lt; 16) | (x &amp; 0x000000000000ffffLL);\nx = ((x &amp; 0x0000ff000000ff00LL) &lt;&lt; 8)  | (x &amp; 0x000000ff000000ffLL);\nx = ((x &amp; 0x00f000f000f000f0LL) &lt;&lt; 4)  | (x &amp; 0x000f000f000f000fLL);\nx += 0x0606060606060606LL;\nm = ((x &amp; 0x1010101010101010LL) &gt;&gt; 4) + 0x7f7f7f7f7f7f7f7fLL;\nx += (m &amp; 0x2a2a2a2a2a2a2a2aLL) | (~m &amp; 0x3131313131313131LL);\n</code></pre>\n\n<p>Above is the simplified version I came up with after a little time to reflect. Below is the original answer.</p>\n\n<pre><code>uint64_t x, m;\nx = 0xF05C1E3A;\nx = ((x &amp; 0x00000000ffff0000LL) &lt;&lt; 16) | (x &amp; 0x000000000000ffffLL);\nx = ((x &amp; 0x0000ff000000ff00LL) &lt;&lt; 8) | (x &amp; 0x000000ff000000ffLL);\nx = ((x &amp; 0x00f000f000f000f0LL) &lt;&lt; 4) | (x &amp; 0x000f000f000f000fLL);\nx += 0x3636363636363636LL;\nm = (x &amp; 0x4040404040404040LL) &gt;&gt; 6;\nx += m;\nm = m ^ 0x0101010101010101LL;\nx -= (m &lt;&lt; 2) | (m &lt;&lt; 1);\n</code></pre>\n\n<p>See it in action: <a href=\"http://ideone.com/nMhJ2q\" rel=\"nofollow noreferrer\">http://ideone.com/nMhJ2q</a></p>\n"}, {"comments": [{"owner": {"reputation": 269328, "user_id": 5987, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/2a1f9f4986b58015691eb2014e78869f?s=128&d=identicon&r=PG", "display_name": "Mark Ransom", "link": "https://stackoverflow.com/users/5987/mark-ransom"}, "edited": false, "score": 0, "creation_date": 1502511131, "post_id": 45645466, "comment_id": 78251822, "body": "Yes, it&#39;s simpler."}, {"owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "edited": false, "score": 0, "creation_date": 1502540400, "post_id": 45645466, "comment_id": 78258731, "body": "This is good too!"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1502499000, "last_edit_date": 1502499000, "creation_date": 1502498633, "answer_id": 45645466, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string/45645466#45645466", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>A slightly simpler version based on Mark Ransom's:</p>\n\n<pre><code>uint64_t x = 0xF05C1E3A;\nx = ((x &amp; 0x00000000ffff0000LL) &lt;&lt; 16) | (x &amp; 0x000000000000ffffLL);\nx = ((x &amp; 0x0000ff000000ff00LL) &lt;&lt; 8)  | (x &amp; 0x000000ff000000ffLL);\nx = ((x &amp; 0x00f000f000f000f0LL) &lt;&lt; 4)  | (x &amp; 0x000f000f000f000fLL);\nx =  (x + 0x3030303030303030LL) +\n   (((x + 0x0606060606060606LL) &amp; 0x1010101010101010LL) &gt;&gt; 4) * 7;\n</code></pre>\n\n<p>And if you want to avoid the multiplication:</p>\n\n<pre><code>uint64_t m, x = 0xF05C1E3A;\nx = ((x &amp; 0x00000000ffff0000LL) &lt;&lt; 16) | (x &amp; 0x000000000000ffffLL);\nx = ((x &amp; 0x0000ff000000ff00LL) &lt;&lt; 8)  | (x &amp; 0x000000ff000000ffLL);\nx = ((x &amp; 0x00f000f000f000f0LL) &lt;&lt; 4)  | (x &amp; 0x000f000f000f000fLL);\nm =  (x + 0x0606060606060606LL) &amp; 0x1010101010101010LL;\nx =  (x + 0x3030303030303030LL) + (m &gt;&gt; 1) - (m &gt;&gt; 4);\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 4500064, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AuTln.jpg?s=128&g=1", "display_name": "xvk3", "link": "https://stackoverflow.com/users/4500064/xvk3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1251, "favorite_count": 0, "closed_date": 1502575802, "accepted_answer_id": 45601966, "answer_count": 7, "score": -2, "last_activity_date": 1609675068, "creation_date": 1502304832, "last_edit_date": 1502360846, "question_id": 45598583, "link": "https://stackoverflow.com/questions/45598583/efficient-conversion-of-a-binary-number-to-hexadecimal-string", "closed_reason": "Needs details or clarity", "title": "Efficient Conversion of a Binary Number to Hexadecimal String", "body": "<p>I am writing a program that converts a binary value's hexadecimal representation to a regular string. So each character in the hex representation would convert to two hexadecimal characters in the string. This means the result will be twice the size; a hexadecimal representation of 1 byte would need two bytes in a string.</p>\n\n<p>Hexadecimal Characters</p>\n\n<pre><code>0123456789                    ;0x30 - 0x39\nABCDEF                        ;0x41 - 0x46\n</code></pre>\n\n<p>Example</p>\n\n<pre><code>0xF05C1E3A                    ;hex\n4032568890                    ;dec\n</code></pre>\n\n<p>would become</p>\n\n<pre><code>0x4630354331453341            ;hex\n5057600944242766657           ;dec\n</code></pre>\n\n<p>Question?</p>\n\n<p><strong>Are there any elegant/alternative(/interesting) methods for converting between these states, other than a lookup table, (bitwise operations, shifts, modulo, etc)?</strong>\nI'm not looking for a function in a library, but rather how one would/should be implemented. Any ideas?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 3, "creation_date": 1502303882, "post_id": 45598080, "comment_id": 78156090, "body": "You should not get any unreachable warnings from doing that unless you are using a old compiler (The -Wunreachable-code was removed from gcc about 3 years ago as well, the flag is just silently accepted but does nothing)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502304566, "post_id": 45598080, "comment_id": 78156481, "body": "See <a href=\"https://stackoverflow.com/questions/1644868\">C <code>#define</code> macro for debug printing</a>."}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502305678, "post_id": 45598080, "comment_id": 78157119, "body": "You need to note your clang version and the compiler flags you use. At least some clang versions (e.g., clang 3.8 in Debian stretch) do not issue a warning for <code>if</code> statements with constant conditions where the constant comes from a macro."}, {"owner": {"reputation": 3952, "user_id": 2152957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/7wZ6n.jpg?s=128&g=1", "display_name": "tay10r", "link": "https://stackoverflow.com/users/2152957/tay10r"}, "edited": false, "score": 0, "creation_date": 1510501440, "post_id": 45598080, "comment_id": 81451468, "body": "Have you considered ditching the if statement and using a debug statement? See <a href=\"https://stackoverflow.com/questions/1941307/c-debug-print-macros\">stackoverflow.com/questions/1941307/c-debug-print-macros</a>"}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": false, "score": 3, "last_activity_date": 1502304667, "last_edit_date": 1502304667, "creation_date": 1502303287, "answer_id": 45598154, "question_id": 45598080, "link": "https://stackoverflow.com/questions/45598080/clang-gcc-disable-unused-code-warning-as-a-result-of-conditional-macro/45598154#45598154", "title": "Clang/GCC disable unused code warning as a result of conditional macro", "body": "<p>You could use a pre-proccessor condition instead of a runtime condition:</p>\n\n<pre><code>#if DEBUG == 1\n  printf(\"debug string!\\n\");\n#endif\n</code></pre>\n\n<p>Thereby, the complete debug-code is \"eliminated\" without leaving \"empty\" code blocks. This is much cleaner than letting any debug code, which under changed conditions could behave differently and influence the rest of the code, in production.</p>\n\n<p>Alternatively, if for some reason you must not use pre-processor conditions, you can introduce a <code>log</code>- or <code>trace</code>-function, usually in a separate translation unit. Then you can either react on <code>DEBUEG</code>-state therein. You could even provide two library implementations, an \"empty\" one for production and a \"working\" one for deubug, and configure your build to choose the right implementation.</p>\n\n<p>But - as stated above - even the call of an \"empty\" function could influence compile time optimizations or runtime behaviour. So I'd really suggest to go the pre-processor way.</p>\n"}, {"tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1502304011, "creation_date": 1502304011, "answer_id": 45598348, "question_id": 45598080, "link": "https://stackoverflow.com/questions/45598080/clang-gcc-disable-unused-code-warning-as-a-result-of-conditional-macro/45598348#45598348", "title": "Clang/GCC disable unused code warning as a result of conditional macro", "body": "<p>I'm only getting the warning on clang (if -Wunreachable-code is on), not gcc.\nA switch silences the warning. Alternatively, pragmas do too (and you can use a _Pragma keyword if you're only against pragma directives).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define DEBUG 0\nint main()\n{\n#if 1\n    switch(!!DEBUG){\n    case 1: puts(\"hello world\");\n    case 0:;\n    }\n#else\n    _Pragma(\"gcc diagnostic push(\\\"-Wno-unreachable_code\\\")\")\n    if(DEBUG){\n        puts(\"hello world\");\n    }\n    _Pragma(\"gcc diagnostic pop\")\n#endif\n\n}\n</code></pre>\n"}], "owner": {"reputation": 468, "user_id": 4897973, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6456b100cee8d79866ebeac9a587eec?s=128&d=identicon&r=PG&f=1", "display_name": "beeselmane", "link": "https://stackoverflow.com/users/4897973/beeselmane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1514731122, "creation_date": 1502303052, "question_id": 45598080, "link": "https://stackoverflow.com/questions/45598080/clang-gcc-disable-unused-code-warning-as-a-result-of-conditional-macro", "title": "Clang/GCC disable unused code warning as a result of conditional macro", "body": "<p>I'm writing a program which has debug code which can be disabled by a macro, <code>DEBUG</code>. When set to <code>1</code>, the debug code should be compiled into the binary, and when set to <code>0</code>, the debug code should not be.</p>\n\n<p>I am compiling with -Wunreachable-code enabled, and my question results from compiling code such as this:</p>\n\n<pre><code>if (DEBUG) {\n    printf(\"debug string!\\n\");\n}\n</code></pre>\n\n<p>When debugging is enabled, this will compile fine, as the condition will always evaluate to 1 (true). However, when debugging is disabled (<code>DEBUG=0</code>), I get an unreachable code warning on the <code>printf</code> call on the second line. I am aware this can be solved with the <code>#ifdef/#endif</code> preprocessor directives, however I don't like filling the body of my program with preprocessor directives if it can be avoided.</p>\n\n<p>I am wondering if there is any way I can leave my code with c-style conditionals without using diagnostic pragmas (<code>#pragma GCC diagnostic</code>). Any help would be appreciated, thank you!</p>\n"}, {"tags": ["c", "function", "scanf"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502300546, "post_id": 45597246, "comment_id": 78154162, "body": "<code>int convert(char hex[]){ ... }</code> move this to outside of <code>main</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502300682, "post_id": 45597246, "comment_id": 78154234, "body": "<code>convert(input[validLength])</code> --&gt; <code>convert(input)</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502300780, "post_id": 45597246, "comment_id": 78154300, "body": "<code>scanf(&quot;%c&quot;, input);</code> --&gt; <code>scanf(&quot; %4c&quot;, input);</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502300889, "post_id": 45597246, "comment_id": 78154375, "body": "<code>input[j] &gt; 48</code> --&gt; <code>input[j] &gt;= &#39;0&#39;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502301093, "post_id": 45597246, "comment_id": 78154494, "body": "Should <code>if(input[j] &gt; 48 &amp;&amp; input[j] &lt; 58)</code> be <code>if(input[j] &gt;= &#39;0&#39; &amp;&amp; input[j] &lt;= &#39;9&#39;)</code>? Your code was not accepting <code>&#39;0&#39;</code> and it still does not accept <code>&#39;A&#39;</code> to <code>&#39;F&#39;</code> or <code>&#39;a&#39;</code> to <code>&#39;f&#39;</code> in a hexadecimal string."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502301220, "post_id": 45597246, "comment_id": 78154572, "body": "<code>for(t=0; t &lt; validLength; t++)             result= result+ hex[t]*(pow(16,(validLength-t)));</code> --&gt; <code>for(result = t = 0; t &lt; validLength; t++)             result = result*16 + hex[t]-&#39;0&#39;;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502302577, "post_id": 45597246, "comment_id": 78155335, "body": "<a href=\"http://ideone.com/gPmVrq\" rel=\"nofollow noreferrer\">fixed code</a>"}, {"owner": {"reputation": 29, "user_id": 7801261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QgWk.png?s=128&g=1", "display_name": "kubicwerke", "link": "https://stackoverflow.com/users/7801261/kubicwerke"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502350622, "post_id": 45597246, "comment_id": 78173320, "body": "@WeatherVane I&#39;ve tried this:    <code>if(input[i] &gt;= &#39;0&#39; &amp;&amp; input[i] &lt;= &#39;9&#39; || input[i] &gt;= &#39;a&#39; &amp;&amp; input[i] &lt;= &#39;f&#39; || input[i] &gt;= &#39;A&#39; &amp;&amp; input[i] &lt;= &#39;F&#39;)</code> but not function as I wish. Doesnt prevent other characters."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502369636, "post_id": 45597246, "comment_id": 78187028, "body": "<a href=\"http://ideone.com/Ihac6s\" rel=\"nofollow noreferrer\">include A-F(a-f) ver.</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502381401, "post_id": 45597246, "comment_id": 78196640, "body": "@KubilayCanDEM\u0130R I tested that and it does work, maybe your implementation was faulty. But as BLUEPIXY uses in his code <code>isxdigit</code> is there in <code>ctype.h</code> for you."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1502300921, "last_edit_date": 1502300921, "creation_date": 1502300499, "answer_id": 45597349, "question_id": 45597246, "link": "https://stackoverflow.com/questions/45597246/how-to-solve-undefined-reference-error-in-c/45597349#45597349", "title": "how to solve undefined reference error in C?", "body": "<p>This is invalid:</p>\n\n<pre><code>scanf(\"%c\", input);\n</code></pre>\n\n<p>The <code>%c</code> format specifier will only read a single character.  If you want to read a string, you need to use <code>%s</code>.  Also, you should put a length modifier on this field to specify the maximum number of characters to read:</p>\n\n<pre><code>scanf(\"%4s\", input);\n</code></pre>\n\n<p>You'll need to make <code>input</code> one element larger to have room for the terminating null byte.</p>\n\n<p>Also, you attempted to define your <code>convert</code> function inside of your <code>main</code> function.  Nested functions are not supported in standard C.</p>\n\n<p>You need to move the definition of <code>convert</code> outside of <code>main</code>:</p>\n\n<pre><code>int convert (char hex[]);\nint result,validLength,j;\nchar input[LENGTH+1];\n\nint convert(char hex[]){\n\n    int t;\n\n    for(t=0; t &lt; validLength; t++)\n        result= result+ hex[t]*(pow(16,(validLength-t)));\n\n    return result;\n\n}\n\nint main(){\n\n    while(1){\n\n        printf(\"Please enter valid hexadecimal number %d length:\",LENGTH);\n        scanf(\"%4s\", input);  //reading to char array\n\n        // initialize validLength, otherwise you increment an uninitialized value\n        validLength = 0;\n        for(j=0;j&lt;LENGTH;j++)   // buffer\n            if(input[j] &gt; 48 &amp;&amp; input[j] &lt; 58)\n                validLength++; \n\n        // null terminate after the invalid characters\n        input[validLength] = 0;\n\n        printf(\"Here is the decimal result: %d\", convert(input));\n\n        validLength=0;\n\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1812, "user_id": 5945883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17f8de79f057abb63afb9ce7bee0ca51?s=128&d=identicon&r=PG&f=1", "display_name": "R2RT", "link": "https://stackoverflow.com/users/5945883/r2rt"}, "is_accepted": false, "score": 0, "last_activity_date": 1502300673, "creation_date": 1502300673, "answer_id": 45597404, "question_id": 45597246, "link": "https://stackoverflow.com/questions/45597246/how-to-solve-undefined-reference-error-in-c/45597404#45597404", "title": "how to solve undefined reference error in C?", "body": "<p>You have defined <code>convert</code> inside of main function - move it outside and it fix the error.</p>\n\n<p>Also, in order to store <code>scanf</code> result of lenght 4 your <code>input</code> should be 5, since so called C-string is terminated with NULL. (E.g. when you type A0CD, values in input will be <code>{'A', '0', 'C', 'D', 0}</code></p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 1, "last_activity_date": 1502301171, "last_edit_date": 1502301171, "creation_date": 1502300703, "answer_id": 45597414, "question_id": 45597246, "link": "https://stackoverflow.com/questions/45597246/how-to-solve-undefined-reference-error-in-c/45597414#45597414", "title": "how to solve undefined reference error in C?", "body": "<p>1] You cant have nested function. Move it out of the body.</p>\n\n<p>2] Here</p>\n\n<pre><code>printf(\"Here is the decimal result: %d\", convert(input[validLength]));\n</code></pre>\n\n<p>You are passing an <code>char</code>, but <code>convert</code> function expect's <code>char*</code>. Correct:</p>\n\n<pre><code>printf(\"Here is the decimal result: %d\", convert(input));\n</code></pre>\n\n<p>3] <code>%c</code> specifier is for character's, use <code>%s</code> and better with how many chars to read <code>%4s</code>. Dont forget to check return value e.g.</p>\n\n<pre><code>if(scanf(\"%4s\", input) != 1)\n{\n    // Fail\n}\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 7801261, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0QgWk.png?s=128&g=1", "display_name": "kubicwerke", "link": "https://stackoverflow.com/users/7801261/kubicwerke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1595, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1502301171, "creation_date": 1502300177, "last_edit_date": 1502300420, "question_id": 45597246, "link": "https://stackoverflow.com/questions/45597246/how-to-solve-undefined-reference-error-in-c", "title": "how to solve undefined reference error in C?", "body": "<p>I'm very new to C programming and studying on K&amp;R C Programming Language book. I'm trying to write a program converts hexadecimal numbers to decimal numbers repeatedly and want to use a function in my code. There are some problems prevent me from understanding C. I've read about them but not clearly understand.</p>\n\n<p>I want to read input with length max 4, but as I understand scanf() doesn't limit length although the length of char array is 4. So I tried to eliminate non-integer characters with a for loop. Is this ok? What is the proper way of getting input from users? I don't want to use <code>while((cr=getchar())!=EOF)</code>.</p>\n\n<p>When I run the program, I get an error message:\"undefined reference to 'convert'\". How should I define functions?</p>\n\n<p>I use Code::Blocks 16.01 and MinGW. </p>\n\n<p>Here is my try:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include&lt;math.h&gt;\n\n#define LENGTH 4\n\nint convert (char hex[]);\nint result,validLength,j;\nchar input[LENGTH];\n\nint main(){\n\n    while(1){\n\n        printf(\"Please enter valid hexadecimal number %d length:\",LENGTH);\n        scanf(\"%c\", input);  //reading to char array\n\n        for(j=0;j&lt;LENGTH;j++)   // buffer\n            if(input[j] &gt; 48 &amp;&amp; input[j] &lt; 58)\n                validLength++; \n\n\n        printf(\"Here is the decimal result: %d\", convert(input[validLength]));\n\n        validLength=0;\n\n    }\n\n    int convert(char hex[]){\n\n        int t;\n\n        for(t=0; t &lt; validLength; t++)\n            result= result+ hex[t]*(pow(16,(validLength-t)));\n\n        return result;\n\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["python", "c", "swig"], "answers": [{"tags": [], "owner": {"reputation": 131156, "user_id": 235698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KjvlE.png?s=128&g=1", "display_name": "Mark Tolonen", "link": "https://stackoverflow.com/users/235698/mark-tolonen"}, "is_accepted": true, "score": 0, "last_activity_date": 1502387203, "creation_date": 1502387203, "answer_id": 45620342, "question_id": 45597115, "link": "https://stackoverflow.com/questions/45597115/swig-memory-issue-of-allocating-array-inside-a-struct/45620342#45620342", "title": "SWIG memory issue of allocating array inside a struct", "body": "<p>You have to call delete when the array is no longer needed.  If you don't do it before the <code>foo</code> object reference count goes to zero and is destroyed, you have a memory leak.</p>\n"}], "owner": {"reputation": 3, "user_id": 8419297, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aCAispEcRTI/AAAAAAAAAAI/AAAAAAAAAEU/C4bBf-2DaeE/photo.jpg?sz=128", "display_name": "Zheng Wang", "link": "https://stackoverflow.com/users/8419297/zheng-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 45620342, "answer_count": 1, "score": 0, "last_activity_date": 1502387203, "creation_date": 1502299722, "question_id": 45597115, "link": "https://stackoverflow.com/questions/45597115/swig-memory-issue-of-allocating-array-inside-a-struct", "title": "SWIG memory issue of allocating array inside a struct", "body": "<p>Suppose I have a C struct like this</p>\n\n<pre><code>struct foo {\n    int sz;\n    struct bar **arr;\n};\n</code></pre>\n\n<p>In my SWIG file, I use \"carrays.i\" to give me control of the array inside this struct. Here I use</p>\n\n<pre><code>%module mdl\n%include \"carrays.i\"\n%array_functions(struct bar*, barArray)\n</code></pre>\n\n<p>Then I allocate memory for this array in python.</p>\n\n<pre><code>a = mdl.foo()\na.arr = mdl.new_barArray(sz)\n</code></pre>\n\n<p>My question is, should I free the memory of the allocated array by calling</p>\n\n<pre><code>mdl.delete_barArray(a.arr)\n</code></pre>\n\n<p>before I exit the current function, or SWIG will automatically do this for me so I don't need to worry about it?</p>\n"}, {"tags": ["c", "contiki"], "answers": [{"tags": [], "owner": {"reputation": 6567, "user_id": 2435820, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/J6uQT.png?s=128&g=1", "display_name": "kfx", "link": "https://stackoverflow.com/users/2435820/kfx"}, "is_accepted": true, "score": 0, "last_activity_date": 1502302987, "creation_date": 1502302987, "answer_id": 45598048, "question_id": 45596769, "link": "https://stackoverflow.com/questions/45596769/contiki-print-data-received-using-rime/45598048#45598048", "title": "Contiki: print data received using Rime", "body": "<p>One way is to use <code>packetbuf_dataptr()</code> function to access the contents.</p>\n\n<pre><code>int var;\nmemcpy(&amp;var, packetbuf_dataptr(), sizeof(var));\nprintf(\"var=%d\\n\", var);\n</code></pre>\n\n<p>Your sending code has a bug related to the size of <code>var</code>. It's either 2, 4, or 8 bytes depending on the platform. It's never 5, so this is wrong:</p>\n\n<pre><code>packetbuf_copyfrom(&amp;var, 5); // Undefined behavior!\n</code></pre>\n\n<p>Always use <code>int16_t / uint16_t</code> or <code>int32_t / uint32_t</code> if the size matters! They are typedef'd in  header that is effectively included in each  Contiki file.</p>\n"}], "owner": {"reputation": 51, "user_id": 6093781, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/aAWDS.jpg?s=128&g=1", "display_name": "vrizz", "link": "https://stackoverflow.com/users/6093781/vrizz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 483, "favorite_count": 1, "accepted_answer_id": 45598048, "answer_count": 1, "score": 1, "last_activity_date": 1502302987, "creation_date": 1502298465, "last_edit_date": 1502302691, "question_id": 45596769, "link": "https://stackoverflow.com/questions/45596769/contiki-print-data-received-using-rime", "title": "Contiki: print data received using Rime", "body": "<p>How can I print the received data in the <code>recv_uc</code> function? In this case is the value of var. I used <code>packetbuf_copyfrom(&amp;var, 5)</code> to put <code>var</code> in the sent packet.</p>\n\n<pre><code>PROCESS(sending_rand, \"Sending rand\");\nAUTOSTART_PROCESSES(&amp;sending_rand);\n\nstatic void\nrecv_uc(struct unicast_conn *c, const rimeaddr_t *from)\n{\n    printf(\"unicast message received from %d.%d\\nreceived data: %d\\n\",\n            from-&gt;u8[0], from-&gt;u8[1], /* print data received */);\n}\n\nstatic const struct unicast_callbacks unicast_call = {recv_uc};\nstatic struct unicast_conn unicast;\n\nPROCESS_THREAD(sending_rand, ev, data)\n{\n    static struct etimer et;//oggetto di tipo etimer\n    int var;  \n\n    PROCESS_EXITHANDLER(unicast_close(&amp;unicast);)\n\n    PROCESS_BEGIN();\n\n    unicast_open(&amp;unicast, 129, &amp;unicast_call);\n\n    while(1) {\n\n        /* Delay 2-4 seconds */\n        etimer_set(&amp;et, CLOCK_SECOND * 4 + random_rand() % (CLOCK_SECOND * 4));\n\n        PROCESS_WAIT_EVENT_UNTIL(etimer_expired(&amp;et));\n\n        var = random_rand();\n\n        packetbuf_copyfrom(&amp;var, 5);\n        addr.u8[0] = 1;\n        addr.u8[1] = 0;\n        if(!rimeaddr_cmp(&amp;addr, &amp;rimeaddr_node_addr)) {\n            unicast_send(&amp;unicast, &amp;addr);\n        }\n\n        printf(\"unicast message sent\\n\");\n    }\n\n    PROCESS_END();\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "lua"], "comments": [{"owner": {"reputation": 5108, "user_id": 5675002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b0aaa2c9904c7543220c849d6a29d3?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5675002/vlad"}, "edited": false, "score": 0, "creation_date": 1502347276, "post_id": 45596493, "comment_id": 78171182, "body": "&gt;If I push user data after the lua_getglobal then call to my lua routine fail with a message that complain that I try to call a user_data. &lt;br&gt;You must put the function first, and arguments afterwards. If you get that error, that means the arguments given to lua_pcall() is incorrect. Probably you didn&#39;t pass correct number of Lua function&#39;s arguments on Lua stack."}, {"owner": {"reputation": 515, "user_id": 3986849, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ebc216f00c3bf01673e077da59eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Fulup", "link": "https://stackoverflow.com/users/3986849/fulup"}, "reply_to_user": {"reputation": 5108, "user_id": 5675002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b0aaa2c9904c7543220c849d6a29d3?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/5675002/vlad"}, "edited": false, "score": 0, "creation_date": 1502439403, "post_id": 45596493, "comment_id": 78219503, "body": "I also found out that you need to push argument after lua_getglobal. What surprise me is that many example on the web do the opposite??? I found a solution passing a extra argument with lua_pushlightuserdata. If is not really what I wanted because the handle is visible from LUA script but at least it works :) My code is available here <a href=\"https://github.com/iotbzh/audio-bindings/blob/fulup-dev/Controler-afb/ctl-lua.c\" rel=\"nofollow noreferrer\">github.com/iotbzh/audio-bindings/blob/fulup-dev/Controler-af&zwnj;&#8203;b/&hellip;</a>"}], "owner": {"reputation": 515, "user_id": 3986849, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/65ebc216f00c3bf01673e077da59eadc?s=128&d=identicon&r=PG&f=1", "display_name": "Fulup", "link": "https://stackoverflow.com/users/3986849/fulup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1502297438, "creation_date": 1502297438, "question_id": 45596493, "link": "https://stackoverflow.com/questions/45596493/lua-using-lua-newuserdata-from-lua-pcall", "title": "LUA using lua_newuserdata from lua_pcall", "body": "<p>I fail to properly call a lua routine from C while setting an opaque handle before lua_pcall. (note: <em>Environment: Linux/OpenSuse42.2 with LUA-5.3 and GCC-5</em>)</p>\n\n<p>The sequence I'm looking for. </p>\n\n<ul>\n<li>Start from C (not from LUA). In C create opaque handle (lua_newuserdata + luaL_setmetatable)</li>\n<li>set routine to call lua_getglobal(luaState, func);</li>\n<li>call lua func from C with lua_pcall (in my script Adjust_Volume_Speed)</li>\n<li>call back C from LUA (in my script  AFB_sucess). Note: the call works and LUA receive correctly arguments</li>\n<li>Back in C</li>\n<li>I can get my lua routine arguments but not my opaque handle\nFail (luaL_checktype(luaState,1, LUA_TUSERDATA);</li>\n</ul>\n\n<p>You can check my LUA code here after. When calling AFB_sucess from LUA I cannot retreive my userdata. </p>\n\n<p>It seems that:</p>\n\n<ul>\n<li>if I push user_data before my  lua_getglobal(luaState, lua_func_name); then user_data is not used. </li>\n<li>If I push user data after the lua_getglobal then call to my lua routine fail with a message that complain that I try to call a user_data.</li>\n</ul>\n\n<p>Question: when using lua_pcall, how to implement user_data in such a way that I may retrieve my opaque handle when LUA will reach a callback that happen to be implemented in C ?</p>\n\n<p>The key lines involved in this are.</p>\n\n<p><strong>Routine used to create/retrieve the opaque handle</strong></p>\n\n<pre><code>STATIC LuaAfbContextT *LuaCtxCheck (lua_State *luaState, int index) {\n  LuaAfbContextT *afbContext;\n  luaL_checktype(luaState, index, LUA_TUSERDATA);\n  afbContext = (LuaAfbContextT *)luaL_checkudata(luaState, index, CTX_TOKEN);\n  if (afbContext == NULL &amp;&amp; afbContext-&gt;ctxMagic != CTX_MAGIC) {\n      luaL_error(luaState, \"Fail to retrieve user data context=%s\", CTX_TOKEN);\n      AFB_ERROR (\"afbContextCheck error retrieving afbContext\");\n      return NULL;\n  }\n  return afbContext;\n}\n\nSTATIC LuaAfbContextT *LuaCtxPush (lua_State *luaState, afb_req request, const char* info) {\n  LuaAfbContextT *afbContext = (LuaAfbContextT *)lua_newuserdata(luaState, sizeof(LuaAfbContextT));\n  if (!afbContext) {\n      AFB_ERROR (\"LuaCtxPush fail to allocate user data context\");\n      return NULL;\n  }\n  luaL_setmetatable(luaState, CTX_TOKEN);\n  afbContext-&gt;ctxMagic=CTX_MAGIC;\n  afbContext-&gt;info=strdup(info);\n  afbContext-&gt;request= request;\n  return afbContext;\n}\n</code></pre>\n\n<p><strong>The Creation of LUA routine from C uses</strong></p>\n\n<pre><code> // Push AFB client context on the stack\n        LuaAfbContextT *afbContext= LuaCtxPush(luaState, request, func);\n        if (!afbContext) goto OnErrorExit;\n\n        // load function (should exist in CONTROL_PATH_LUA\n        lua_getglobal(luaState, func);\n\n        // push arguments on the stack\n        if (json_object_get_type(args) != json_type_array) { \n            count= LuaPushArgument (args);\n        } else {\n            for (int idx=0; idx&lt;json_object_array_length(args); idx++)  {\n                count += LuaPushArgument (json_object_array_get_idx(args, idx));\n                if (err) break;\n            }\n        } \n</code></pre>\n\n<p><strong>The routine to call LUA from C</strong></p>\n\n<pre><code> static const luaL_Reg afbFunction[] = {\n    {\"notice\" , LuaPrintNotice},\n    {\"warning\", LuaPrintWarning},\n    {\"service\", LuaAfbService},\n    {\"success\", LuaAfbSuccess},\n    {\"fail\"   , LuaAfbFail},\n    {NULL, NULL}  /* sentinel */\n};\n\n// Create Binding Event at Init\nPUBLIC int LuaLibInit () {\n    int err, index;\n\n    // search for default policy config file\n    json_object *luaScriptPathJ = ScanForConfig(CONTROL_PATH_LUA , \"onload\", \"lua\");\n\n    // open a new LUA interpretor\n    luaState = luaL_newstate();\n    if (!luaState)  {\n        AFB_ERROR (\"LUA_INIT: Fail to open lua interpretor\");\n        goto OnErrorExit;\n    }\n\n    // load auxiliary libraries\n    luaL_openlibs(luaState);\n\n    // redirect print to AFB_NOTICE    \n    luaL_newlib(luaState, afbFunction);\n    lua_setglobal(luaState, \"AFB\");\n\n\n// Push AFB client context on the stack\n        LuaAfbContextT *afbContext= LuaCtxPush(luaState, request, func);\n        if (!afbContext) goto OnErrorExit;\n\n        // load function (should exist in CONTROL_PATH_LUA\n        lua_getglobal(luaState, func);\n\n        // push arguments on the stack\n        if (json_object_get_type(args) != json_type_array) { \n            count= LuaPushArgument (args);\n        } else {\n            for (int idx=0; idx&lt;json_object_array_length(args); idx++)  {\n                count += LuaPushArgument (json_object_array_get_idx(args, idx));\n                if (err) break;\n            }\n        } \n</code></pre>\n\n<p>My LUA script</p>\n\n<pre><code>-- Adjust Volume function of vehicle speed\nfunction Adjust_Volume_Speed (speed_meters_second)\n\n  AFB:notice(\"In Adjust_Volume_Speed\")\n\n   print (string.format(\"***** Adjust_Volume_Speed speed=%d count=%d\", speed_meters_second, count));\n\n   -- compute volume\n   volume = speed_meters_second * 2\n   count=count+1\n\n  AFB:success (1234, volume, count, 5678) \nend\n</code></pre>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1502297178, "post_id": 45596374, "comment_id": 78152234, "body": "I don&#39;t like the looks of this: <code>(long long)&amp;buf;</code> casting a pointer to a long long"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502297831, "post_id": 45596374, "comment_id": 78152598, "body": "Especially as it is the signed value. Not very suitable for pointers"}], "answers": [{"tags": [], "owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "is_accepted": false, "score": 1, "last_activity_date": 1502297609, "last_edit_date": 1502297609, "creation_date": 1502297232, "answer_id": 45596440, "question_id": 45596374, "link": "https://stackoverflow.com/questions/45596374/stack-smashing-detected-after-calling-msgrcv-function/45596440#45596440", "title": "Stack smashing detected after calling msgrcv function", "body": "<pre><code>msgrcv (message_queue_id, (struct msgbuf*)&amp;msg, sizeof(msg) - 4, 6, IPC_NOWAIT);\n</code></pre>\n\n<p>The third parameter to <code>msgrcv</code> should be the size of the buffer stored in the message structure. When doing the calculation <code>sizeof(msg) - 4</code>, you seem to be assuming that the size of <code>long</code> is always 4, which is incorrect. Instead, you should simply use <code>sizeof(msg.text)</code>.</p>\n\n<p>You also have the same error in the sender. Because the size of <code>long</code> in 64-bit linux is 8 bytes and not 4, your code will write past the end of the <code>msg</code> variable, causing a buffer overflow.</p>\n"}], "owner": {"reputation": 1, "user_id": 7091498, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d04b3a7d8ebde575cd97e531a1e53aae?s=128&d=identicon&r=PG&f=1", "display_name": "BlackHawk", "link": "https://stackoverflow.com/users/7091498/blackhawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 546, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502297609, "creation_date": 1502297038, "question_id": 45596374, "link": "https://stackoverflow.com/questions/45596374/stack-smashing-detected-after-calling-msgrcv-function", "title": "Stack smashing detected after calling msgrcv function", "body": "<p>I have written two programs one to send message using msgsnd and other to receive with msgrcv. I have been using these functions for quite a while, but I can't figure out \"stack smashing detected\" error in receiving file. In that file I try to copy one part of file to one char array and second part into second array. I get stack smashing detected after receiving program completion if msgrcv is ever called in a file. At the end of a file I call printf function to print two arrays. From my point arr1 and arr2 should contain complete message, while only arr1 contains message and arr2 is empty. But the biggest problem is stack smashing detected error. I place code for two files below:</p>\n\n<p>Sending file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;stdint.h&gt;\n\ntypedef struct message {\n  long type;\n  char text[128];\n} message;\n\nint main (int argc, char **argv) {\n  if (argc == 3 &amp;&amp; strcmp (argv [1], \"-m\") == 0) {\n    key_t key = (key_t) atoi (argv[2]);\n    message msg;\n    int message_queue_id = msgget (key, IPC_CREAT | 0666);\n    int semaphore_set_id = semget (key, 1, IPC_CREAT | 0666);\n    struct semid_ds buf;\n    struct sembuf sb;\n    long long buf_address = (long long)&amp;buf;\n    long long sb_address = (long long)&amp;sb;\n    // sending message\n    msg.type = 6;\n    memset (msg.text, 0, 128);\n    printf (\"%p %p\\n\", (void*)&amp;buf, (void*)&amp;sb);\n    sprintf (msg.text, \"%lld %lld\", buf_address, sb_address);\n    printf (\"msg: %s\\n\", msg.text);\n    void* ptr = (void*)buf_address;\n    printf (\"ptr = %p\\n\", ptr);\n    msgsnd(message_queue_id, (struct msgbuf*)&amp;msg, sizeof (msg) - 4, 0);\n    sleep (1000);\n  }\n}\n</code></pre>\n\n<p>Receiving file (without headers):</p>\n\n<pre><code>typedef struct message {\n  long type;\n  char text[128];\n} message;\n\nint main (int argc, char **argv) {\n  if (argc == 3 &amp;&amp; strcmp (argv [1], \"-m\") == 0) {\n    key_t key = (key_t) atoi (argv[2]);\n    int message_queue_id = msgget (key, IPC_CREAT | 0666);;\n    int semaphore_set_id = semget (key, 1, IPC_CREAT | 0666);\n    message msg;\n    struct semid_ds buf;\n    struct sembuf sb;\n    msgrcv (message_queue_id, (struct msgbuf*)&amp;msg, sizeof(msg) - 4, 6, IPC_NOWAIT);\n    printf (\"msg = %s\\n\", msg.text);\n    char arr1[32] = \"\\0\", arr2[32] = \"\\0\";\n    int i = 0;\n    while (msg.text[i] != ' ') {\n      arr1[i] = msg.text[i];\n      i++;\n    }\n    i++;\n    while (msg.text[i]) {\n      arr2[i] = msg.text[i];\n      i++;\n    }\n    printf (\"arr1 = %s, arr2 = %s\\n\", arr1, arr2);\n    printf (\"sizeof(long) = %d\\n\", (int)sizeof(long));\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "recursion", "trie"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1502295664, "post_id": 45595907, "comment_id": 78151366, "body": "Why are you freeing it twice? <code>freeSpace(trie);          if(freeSpace(trie))...</code>"}, {"owner": {"reputation": 5417, "user_id": 7607970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3K8Ke.png?s=128&g=1", "display_name": "Psi", "link": "https://stackoverflow.com/users/7607970/psi"}, "edited": false, "score": 0, "creation_date": 1502295684, "post_id": 45595907, "comment_id": 78151374, "body": "Why do you call <code>freeSpace</code> <b>twice</b> in your <code>unload</code> function? The second time, you <i>will</i> receive a segfault, of course"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1502295785, "post_id": 45595907, "comment_id": 78151446, "body": "Should <code>bool freeSpace(node* child)</code> be <code>bool freeSpace(node* trie)</code>? Otherwise, it doesn&#39;t seem to make sense."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502295856, "post_id": 45595907, "comment_id": 78151485, "body": "Why does <code>freeSpace</code> need to return a value at all?"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1502295962, "post_id": 45595907, "comment_id": 78151539, "body": "@IanAbbott <code>trie</code> is global variable, so <code>child</code> is redundant variable here."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502296024, "post_id": 45595907, "comment_id": 78151574, "body": "Well.. That&#39;s <i>very</i> bad then. You are passing children to it hoping it will free them, and not the global variable. This is not how recursion works... Update @FilipKo\u010dica wait.. you are not the OP..."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502296133, "post_id": 45595907, "comment_id": 78151644, "body": "Haha got you. Kidding, it is wrote that <code>trie</code> and <code>root</code> are global variables."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502296470, "post_id": 45595907, "comment_id": 78151849, "body": "@FilipKo\u010dica It shouldn&#39;t matter what the parameter of <code>freeSpace</code> is called as it will override a global variable of the same name."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1502296527, "post_id": 45595907, "comment_id": 78151891, "body": "@IanAbbott I know iam just saying that variable <code>child</code> is redundant becouse isnt used in function <code>freeSpace</code>. :-)"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1502296767, "post_id": 45595907, "comment_id": 78152022, "body": "You <i>do</i> know that it is perfectly legal to pass <code>NULL</code> to <code>free()</code>? As in, your <code>freeSpace()</code> function can be rewritten to be quite a bit simpler?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502303774, "post_id": 45595907, "comment_id": 78156034, "body": "Why does <code>freeSpace()</code> return a value when the only value it returns is <code>true</code>?  It would be better and simpler if the function had a return type of <code>void</code>.  Then calling code wouldn&#39;t test the return value, only to find it is never false.  If there&#39;s nothing to return, a function shouldn&#39;t return anything.  (Also think about how you&#39;d document the correct use of the function \u2014 it returns a boolean: what does that mean, and how do you test the result and what do you do when it is false, and when it is true?)"}], "answers": [{"tags": [], "owner": {"reputation": 325120, "user_id": 501557, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/e4bac7ebd5f5a06c716f508af656e24b?s=128&d=identicon&r=PG", "display_name": "templatetypedef", "link": "https://stackoverflow.com/users/501557/templatetypedef"}, "is_accepted": false, "score": 1, "last_activity_date": 1502296869, "creation_date": 1502296869, "answer_id": 45596322, "question_id": 45595907, "link": "https://stackoverflow.com/questions/45595907/freeing-trie-structure-in-c-recursively/45596322#45596322", "title": "Freeing TRIE structure in C recursively", "body": "<p>Look closely at your code. Do you actually use the parameter to the function anywhere? You're actually always looking at the global trie pointer at each iteration, which isn't want you want to do.</p>\n\n<p>To fix this, change your code so that you look at the node passed in as an argument and its children rather than the global trie pointer.</p>\n\n<p>You have another issue to watch out for, and that's how you handle null pointers. Right now, you assume the argument pointer isn't null and then inspect each child to see whether it's non-null before recurring. But what if the trie itself is null to begin with? I'd consider creating a base case that checks if the trie is null and, if so, doesn't do anything. You can then eliminate the checks before the recursive calls you make and now properly guard against another edge case.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 8346224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zo04x.jpg?s=128&g=1", "display_name": "Lucas Cazeto", "link": "https://stackoverflow.com/users/8346224/lucas-cazeto"}, "edited": false, "score": 0, "creation_date": 1502298155, "post_id": 45596348, "comment_id": 78152758, "body": "This looks so much better! I&#39;ll give it a try and see how it goes! Thx  My main issue here was I got overloaded with parameters and variables names and mix them all up. Now I see the rookie mistake I was doing.   As per the true / false matter, yes, it was a big mess. Thanks again!"}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 4, "last_activity_date": 1502296945, "creation_date": 1502296945, "answer_id": 45596348, "question_id": 45595907, "link": "https://stackoverflow.com/questions/45595907/freeing-trie-structure-in-c-recursively/45596348#45596348", "title": "Freeing TRIE structure in C recursively", "body": "<p>Here is a modified version of your code snippet that makes more sense:</p>\n\n<pre><code>/*\nFrees node by node recursively\n*/\n\nvoid freeSpace(node* t)\n{   \n    for (int i = 0; i &lt; 27; i++)\n    {\n        if(t-&gt;children[i] != NULL)\n        {\n            freeSpace(t-&gt;children[i]);\n        }\n    }\n    free(t);\n}\n\n/**\n * Unloads dictionary from memory. Returns true if successful else false.\n */ \nbool unload()\n{\n\n    if(root != NULL)\n    {\n        trie = root;\n        freeSpace(trie);\n        return true;\n    }\n    else\n    {\n        return false;\n    }\n\n}\n</code></pre>\n\n<p>The <code>freeSpace</code> function has been changed to use the parameter as the base of the trie to be freed.  Your original version had an unused parameter <code>child</code> and used global variable <code>trie</code> instead, which didn't make sense.</p>\n\n<p>There is no need for <code>freeSpace</code> to return a value as all it does is free stuff, and it was only returning a fixed value <code>true</code>. I changed its return type to <code>void</code>.</p>\n\n<p>Your <code>unload</code> function was calling <code>freeSpace</code> twice on the same object, so I removed one of the calls.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 8346224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zo04x.jpg?s=128&g=1", "display_name": "Lucas Cazeto", "link": "https://stackoverflow.com/users/8346224/lucas-cazeto"}, "edited": false, "score": 0, "creation_date": 1502297972, "post_id": 45596387, "comment_id": 78152676, "body": "Ohh... I was for such a long time looking into this and implementing my whole program that I failed to notice I was not calling the structure I wanted inside the function and instead calling the value I was passing."}, {"owner": {"reputation": 94, "user_id": 5130314, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f76b169f2c0c154dc985791bc56d1d9?s=128&d=identicon&r=PG&f=1", "display_name": "srishti sharma", "link": "https://stackoverflow.com/users/5130314/srishti-sharma"}, "reply_to_user": {"reputation": 81, "user_id": 8346224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zo04x.jpg?s=128&g=1", "display_name": "Lucas Cazeto", "link": "https://stackoverflow.com/users/8346224/lucas-cazeto"}, "edited": false, "score": 1, "creation_date": 1502369634, "post_id": 45596387, "comment_id": 78187025, "body": "No problem. It happens. Just a quick suggestion, if you are comfortable with particular variable names then try to use that for parameters otherwise this happens. All the best."}], "tags": [], "owner": {"reputation": 94, "user_id": 5130314, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f76b169f2c0c154dc985791bc56d1d9?s=128&d=identicon&r=PG&f=1", "display_name": "srishti sharma", "link": "https://stackoverflow.com/users/5130314/srishti-sharma"}, "is_accepted": false, "score": 2, "last_activity_date": 1502303588, "last_edit_date": 1502303588, "creation_date": 1502297097, "answer_id": 45596387, "question_id": 45595907, "link": "https://stackoverflow.com/questions/45595907/freeing-trie-structure-in-c-recursively/45596387#45596387", "title": "Freeing TRIE structure in C recursively", "body": "<p>I think your freeSpace() function should use <strong>child parameter</strong>  instead of trie. This is how it should look like.</p>\n\n<pre><code>bool freeSpace(node* child){   \n    for (int i = 0; i &lt; 27; i++)\n    {\n        if(child-&gt;children[i] != NULL)\n        {\n            freeSpace(child-&gt;children[i]);\n        }\n    }\n    free(child);\n    return true;\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8346224, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Zo04x.jpg?s=128&g=1", "display_name": "Lucas Cazeto", "link": "https://stackoverflow.com/users/8346224/lucas-cazeto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 791, "favorite_count": 0, "accepted_answer_id": 45596348, "answer_count": 3, "score": 1, "last_activity_date": 1502303588, "creation_date": 1502295489, "question_id": 45595907, "link": "https://stackoverflow.com/questions/45595907/freeing-trie-structure-in-c-recursively", "title": "Freeing TRIE structure in C recursively", "body": "<p>I'm currently trying, to no avail, to successfully free a <code>TRIE structure</code> using a <code>recursive function</code>, but I'm seeing memory loss.</p>\n\n<p>The trie structure is defined as:</p>\n\n<pre><code>typedef struct node\n{\n    bool is_word;\n    struct node* children[27];\n}\nnode;\n</code></pre>\n\n<p>and I have the following Node* declared globally:</p>\n\n<pre><code>node* trie = NULL;\nnode* root = NULL;\n</code></pre>\n\n<p>The second is used only to keep track of the root node and first one is receiving words from a file. To this point I was getting no errors when compiling my program without freeing the heap memory, other than memory loss.</p>\n\n<p>After implementing an unload( ) function, I started coming across <code>Segmentation Fault</code> errors.</p>\n\n<p>See a snippet of my code:</p>\n\n<pre><code>/*\nFrees node by node recursively\n*/\n\nbool freeSpace(node* child)\n{   \n    for (int i = 0; i &lt; 27; i++)\n    {\n        if(trie-&gt;children[i] != NULL)\n        {\n            freeSpace(trie-&gt;children[i]);\n        }\n    }\n    free(trie);\n    return true;\n}\n\n/**\n * Unloads dictionary from memory. Returns true if successful else false.\n */ \nbool unload()\n{\n\n    if(root != NULL)\n    {\n        trie = root;\n        freeSpace(trie);\n\n        if(freeSpace(trie))\n            return true;\n        else\n            return false;\n    }\n    else\n    {\n        return false;\n    }\n\n}\n</code></pre>\n\n<p>Maybe my code is not very smart at the returning values and validation, but my main issue now is guaranteeing the recursion works as intended and no memory is leaking or segmentation fault is occurring. Any advices?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 2, "creation_date": 1502295218, "post_id": 45595793, "comment_id": 78151089, "body": "<code>arr</code> is ultimately not an lvalue (since it&#39;s the result of decay), and you can only use the modifying increment operators on lvalues. There&#39;s no such restriction on addition (e.g. it&#39;s valid to say <code>1 + 1</code>)."}, {"owner": {"reputation": 1123, "user_id": 4355191, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e11e92b2aaebb8dd68608198b18dea2c?s=128&d=identicon&r=PG&f=1", "display_name": "laolux", "link": "https://stackoverflow.com/users/4355191/laolux"}, "edited": false, "score": 1, "creation_date": 1502295239, "post_id": 45595793, "comment_id": 78151097, "body": "post an entire program that others can compile and test."}, {"owner": {"reputation": 85822, "user_id": 597607, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jCzJi.png?s=128&g=1", "display_name": "Bo Persson", "link": "https://stackoverflow.com/users/597607/bo-persson"}, "edited": false, "score": 0, "creation_date": 1502333880, "post_id": 45595793, "comment_id": 78166696, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/1641957/is-an-array-name-a-pointer\">Is an array name a pointer?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502296217, "post_id": 45595855, "comment_id": 78151696, "body": "actually <code>arr+4;</code> does nothing. Is syntacticaly correct but it is a statement with no effect and will just be ignored"}, {"owner": {"reputation": 1, "user_id": 7465326, "user_type": "registered", "profile_image": "https://graph.facebook.com/851258091681238/picture?type=large", "display_name": "Damini Sao", "link": "https://stackoverflow.com/users/7465326/damini-sao"}, "edited": false, "score": 0, "creation_date": 1502296273, "post_id": 45595855, "comment_id": 78151732, "body": "Thanks .I got it.Nice explanation."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1502295734, "last_edit_date": 1502295734, "creation_date": 1502295314, "answer_id": 45595855, "question_id": 45595793, "link": "https://stackoverflow.com/questions/45595793/interpreting-lvalue-and-rvalue-with-notation-arr4-and-arr/45595855#45595855", "title": "Interpreting lvalue and rvalue with notation arr+4 and arr++", "body": "<p>When you use <code>arr</code> it can naturally <em>decay</em> to a pointer to its first element, i.e. it's equivalent to <code>&amp;arr[0]</code>.</p>\n\n<p>When you do <code>arr++</code> you attempt to modify this pointer (effectively doing <code>arr = arr + 1</code>). This is not possible, since the location of the array is fixed and can not be modified.</p>\n\n<p>With <code>arr + 4</code> you're doing <em>pointer arithmetic</em>. Here you add <code>4</code> to the decayed pointer, but you do not attempt to modify the pointer itself. This is equal to <code>&amp;arr[4]</code> in fact.</p>\n\n<hr>\n\n<p>There is another small problem in the code you show. I say small but I mean <em>big</em>.</p>\n\n<p>With </p>\n\n<pre><code>printf(\"%u\", arr);\n</code></pre>\n\n<p>you let the array decay to a pointer. Then you attempt to print this pointer using the <code>\"%u\"</code> format specifier. <em>But</em> that format specifier is to print <code>int</code>, not pointers. Mismatching format specifier and argument types leads to <em>undefined behavior</em>.</p>\n\n<p>To pint a generic (<code>void *</code>) pointer you need to use the <code>\"%p\"</code> format, and cast the pointer to <code>void *</code>:</p>\n\n<pre><code>printf(\"%p\", (void *) arr);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7465326, "user_type": "registered", "profile_image": "https://graph.facebook.com/851258091681238/picture?type=large", "display_name": "Damini Sao", "link": "https://stackoverflow.com/users/7465326/damini-sao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": -8, "last_activity_date": 1502303316, "creation_date": 1502295128, "last_edit_date": 1502303316, "question_id": 45595793, "link": "https://stackoverflow.com/questions/45595793/interpreting-lvalue-and-rvalue-with-notation-arr4-and-arr", "title": "Interpreting lvalue and rvalue with notation arr+4 and arr++", "body": "<pre><code>   int arr[5];\n\n   arr++;                                                        \n   arr+4;                  //compile with only this \n   printf(\"%u\", arr);\n</code></pre>\n\n<p>Why is the C language compiler not able to compile with <code>arr++</code> saying \"lvalue required\" but can\ncompile successfully with <code>arr+4</code>?  What is the lvalue concept with <code>arr++</code> notation?</p>\n"}, {"tags": ["c++", "c", "abi"], "answers": [{"tags": [], "owner": {"reputation": 15140, "user_id": 241776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/nqobx.jpg?s=128&g=1", "display_name": "linuxbuild", "link": "https://stackoverflow.com/users/241776/linuxbuild"}, "is_accepted": true, "score": 1, "last_activity_date": 1502807114, "creation_date": 1502807114, "answer_id": 45694918, "question_id": 45595723, "link": "https://stackoverflow.com/questions/45595723/what-is-the-extended-option-in-abi-compliance-checker-used-for/45694918#45694918", "title": "What is the extended option in abi-compliance-checker used for?", "body": "<p>By default the tool checks data types that are used (as parameter, return value or field of parameter or return value, etc.) by exported symbols of the analyzed binary. Unused data types are not checked by default. In <code>-extended</code> mode the tool will check all data types including unused.</p>\n\n<p>In your example I see that the number of checked symbols is different in the extended mode, but it should be the same according to the description of the option. Detection of added/removed <code>_SymbolDefinedInStaticInitOnly*</code> looks like a regression bug in the tool for me.</p>\n\n<p>For now, the <code>-extended</code> option enables the -headers-only option implicitly, that enables analysis of all inline symbols in headers. I think we should not enable -headers-only option in this case.</p>\n\n<p>Looks like <code>-extended</code> option doesn't work as expected for now. We need to fix it.</p>\n"}], "owner": {"reputation": 401, "user_id": 413238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/869deec4e42e0404fb8ccbf8b7b01d4f?s=128&d=identicon&r=PG", "display_name": "Gunee", "link": "https://stackoverflow.com/users/413238/gunee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 1, "accepted_answer_id": 45694918, "answer_count": 1, "score": 1, "last_activity_date": 1511983477, "creation_date": 1502294905, "last_edit_date": 1511983477, "question_id": 45595723, "link": "https://stackoverflow.com/questions/45595723/what-is-the-extended-option-in-abi-compliance-checker-used-for", "title": "What is the extended option in abi-compliance-checker used for?", "body": "<p>abi-compliance-checker is a perl program that can check ABI of libraries on linux (<a href=\"https://lvc.github.io/abi-compliance-checker/\" rel=\"nofollow noreferrer\">https://lvc.github.io/abi-compliance-checker/</a>)</p>\n\n<p>The tool has a <code>-extended</code> option, and here is what the manual says about it:</p>\n\n<blockquote>\n  <p>If  your library A is supposed to be used by other library B and              you want to control the ABI of B, then you  should  enable  this option.  The tool will check for changes in all data types, even if they are not used by any function in the library A. Such data types  are  not  part of the A library ABI, but may be a part of the ABI of the B library.\n  The short scheme is:\n                app C (broken) -> lib B (broken ABI) -> lib A (stable ABI)</p>\n</blockquote>\n\n<p>Even after trying checking ABI with and without the option, I still don't really understand the meaning option and how it changes the results I get.</p>\n\n<p>Here is a snippet of the results I have without the option:</p>\n\n<pre><code>Test Results\nTotal Header Files  177\nTotal Libraries 1\nTotal Symbols / Types   96 / 57\nCompatibility   100%\n\nAdded Symbols  1 \ndemangle.h, libtoolbox.so.16.0.0.27\nnamespace mdw\ndemangle ( std::__cxx11::string const&amp; iMangledString )\n\nProblems with Symbols, Low Severity  1 \nBufferMgr.h\nnamespace toolbox\n[+] kDefaultMaxBufferSize [data]  1 \n</code></pre>\n\n<p>And here are the results with the option activated:</p>\n\n<pre><code>Test Results\nTotal Header Files  177\nTotal Symbols / Types   158 / 375\nCompatibility   99.8%\n\nAdded Symbols  2 \ndemangle.h\nnamespace mdw\ndemangle ( std::__cxx11::string const&amp; iMangledString )\n\nStaticInit.h\nnamespace toolbox\n_SymbolDefinedInStaticInitOnly_StaticInit ( )\n\nRemoved Symbols  1 \nStaticInit.h\nnamespace toolbox\n_SymbolDefinedInStaticInitOnly ( )\n\nProblems with Symbols, Low Severity  1 \nBufferMgr.h\nnamespace toolbox\n[+] kDefaultMaxBufferSize [data]  1 \n</code></pre>\n\n<p>Is anyone able to explain what this option means, and what the differences in the output mean from an ABI standpoint?</p>\n"}, {"tags": ["c", "alsa"], "answers": [{"comments": [{"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1502462903, "post_id": 45599963, "comment_id": 78235427, "body": "That helps but what does the &quot;timestamp of the last pointer update&quot; mean? I have retrieved some samples using snd_pcm_readn(). The &#39;pointer&#39; is something internal to ALSA. Is this the time that my call unblocked and returned (i.e. the read pointer moved because I read something)? or when the buffer last got new audio (the write pointer moved)? I want to associate the samples I&#39;ve read with a time-stamp matching when the audio reached the mic (allowing a small fixed offset). What I don&#39;t want to know is to when I last got data as that data could have been buffered for a variable period of time."}, {"owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 0, "creation_date": 1502465551, "post_id": 45599963, "comment_id": 78237145, "body": "Also should we assume snd_pcm_status_get_tstamp() is undefined behaviour if snd_pcm_sw_params_set_tstamp_mode() is not set?"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "reply_to_user": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "edited": false, "score": 1, "creation_date": 1502471386, "post_id": 45599963, "comment_id": 78240356, "body": "The hardware pointer is the position in the buffer where samples are read or written by the hardware. It is updated after each period, or when you ask for the status."}], "tags": [], "owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "is_accepted": false, "score": 3, "last_activity_date": 1502310008, "creation_date": 1502310008, "answer_id": 45599963, "question_id": 45595290, "link": "https://stackoverflow.com/questions/45595290/determining-the-time-stamp-of-sampled-audio/45599963#45599963", "title": "determining the time-stamp of sampled audio", "body": "<p>Timestamping must be enabled in the software params by calling <code>snd_pcm_sw_params_set_tstamp_mode()</code> with <code>SND_PCM_TSTAMP_NONE</code>/<code>ENABLE</code>.</p>\n\n<p>Timestamps can use different clocks; select one by calling <code>snd_pcm_sw_params_set_tstamp_type()</code> with <code>SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY</code>/<code>MONOTONIC</code>/<code>MONOTONIC_RAW</code>.</p>\n\n<p>The timestamp of the last time the stream was started or stopped can be retrieved with <code>snd_pcm_status_get_trigger_tstamp()</code>. The timestamp of the last pointer update can be retrieved with <code>snd_pcm_status_get_tstamp()</code>. (The corresponding pointer position, with <code>snd_pcm_status_get_avail()</code>.)</p>\n\n<p><code>snd_pcm_status_t</code> is a hidden type because it can have different sizes in different library versions.\nIt must be allocated dynamically; see <a href=\"https://stackoverflow.com/questions/30861021/can-i-set-timestamp-in-alsa\">this example</a>.</p>\n"}], "owner": {"reputation": 3365, "user_id": 1569204, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/bd0db7459f9940095b1518fa7ec32a72?s=128&d=identicon&r=PG", "display_name": "Bruce Adams", "link": "https://stackoverflow.com/users/1569204/bruce-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1502474556, "creation_date": 1502293632, "last_edit_date": 1502474556, "question_id": 45595290, "link": "https://stackoverflow.com/questions/45595290/determining-the-time-stamp-of-sampled-audio", "title": "determining the time-stamp of sampled audio", "body": "<p>I have inherited an application which samples audio using <code>snd_pcm_readn()</code>.\n<strong>What is the most reliable way to determine the time-stamp that should be associated with each sample retrieved?</strong></p>\n\n<p>Presumably there will be some kind of buffering going on with ALSA or the capture card itself meaning clock_gettime() could have a variable error\n(especially as this is a multi-threaded application).</p>\n\n<p>It looks to me like it ought to be something like:</p>\n\n<pre><code>if((alsa_result = snd_pcm_readn(card-&gt;capture_handle,\n         card-&gt;capture_buff,\n         card-&gt;buffer_size)) == 0)\n{\n\n    snd_pcm_status_t pcm_status;\n    snd_timestamp_t  snd_timestamp; //actually a struct timeval under the hood\n    if (snd_pcm_status(card-&gt;capture_handle, &amp;pcm_status) == 0)\n    {\n       snd_pcm_status_get_tstamp(&amp;pcm_status, &amp;snd_timestamp);\n       // translate timeval into milliseconds\n       const uint64_t millis = (snd_timestamp.tv_sec * (uint64_t)1000) + (snd_timestamp.tv_usec / 1000);\n    }\n</code></pre>\n\n<p>}</p>\n\n<p>However, to what time does snd_timestamp refer? Is it the first sample retrieved or the last one and do we need to account for samples that might have been captured since snd_pcm_readn() returned?</p>\n\n<p>The ALSA documentation I have found is sketchy on the details. Is it even valid to use <code>snd_pcm_status_get_tstamp()</code> if time-stamps are not enabled (e.g. see <a href=\"https://www.kernel.org/doc/html/v4.10/sound/designs/timestamping.html\" rel=\"nofollow noreferrer\">https://www.kernel.org/doc/html/v4.10/sound/designs/timestamping.html</a>).</p>\n\n<p>Bonus points for references to good (preferably online) ALSA related reading material.</p>\n\n<hr>\n\n<p>Related to this I cannot currently get the code above to compile as it says: </p>\n\n<pre><code>error: storage size of \u2018pcm_status\u2019 isn\u2019t known\n  snd_pcm_status_t pcm_status;\n</code></pre>\n\n<p>I have <code>#include &lt;alsa/pcm.h&gt;</code> and:</p>\n\n<pre><code>&gt;grep -r _snd_pcm_status /usr/include/\n/usr/include/alsa/pcm.h: typedef struct _snd_pcm_status snd_pcm_status_t;\n</code></pre>\n\n<p>but there seems to be no definition of <code>_snd_pcm_status</code> in an obvious location.</p>\n\n<hr>\n\n<p>Update 11-Aug-2017</p>\n\n<p>As pointed out snd_pcm_status_t is opaque and must be allocated by ALSA.\nI still cannot quite get <code>snd_pcm_status_get_tstamp</code> to return the 'right' time-stamp:</p>\n\n<pre><code>//setup code...\nif ((alsa_error = snd_pcm_sw_params_malloc(&amp;sw_params)) &lt; 0)\n{\n   //handle error\n}\nif ((alsa_error = snd_pcm_sw_params_set_tstamp_mode(card-&gt;capture_handle, sw_params, SND_PCM_TSTAMP_ENABLE)) &lt; 0)\n{\n   //handle error\n}\nif ((alsa_error = snd_pcm_sw_params_set_tstamp_mode(card-&gt;capture_handle, sw_params, SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY)) &lt; 0)\n{\n   //handle error\n}\nsnd_pcm_sw_params_free(sw_params);\n\n\n// later on\nif((alsa_result = snd_pcm_readn(card-&gt;capture_handle,\n     card-&gt;capture_buff,\n     card-&gt;buffer_size)) == 0)\n{   \n   time_t timeStamp = 0;\n   snd_timestamp_t  snd_timestamp = {0,0}; //actually a struct timeval\n   if (snd_pcm_status(card-&gt;capture_handle, card-&gt;status) == 0)\n   {\n       snd_pcm_status_get_tstamp(card-&gt;status, &amp;snd_timestamp);\n       timeStamp = snd_timestamp.tv_sec;\n   }\n}\n</code></pre>\n\n<p>timeStamp appears to be the monotonic clock rather than get time of day like I thought I was asking for (the ALSA docs do not specify).</p>\n\n<p>I just got \"1970-01-11T08:33:42: 894822\"\nwhich accords with:</p>\n\n<p>cat /proc/timer_list | grep now\n   now at 894831565155289 nsecs</p>\n\n<p>I could just get a base time of <code>now - monotonic</code> but that seems wrong for a clock claiming to be SND_PCM_TSTAMP_TYPE_GETTIMEOFDAY. So I conclude my setup code or understanding is at fault somehow.</p>\n\n<p>And is that the time-stamp of the samples I just readn() anyway?</p>\n"}, {"tags": ["c", "audio", "gnuplot"], "comments": [{"owner": {"reputation": 3626, "user_id": 7932936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88294cbc3a02c75cfbb906658ad85e15?s=128&d=identicon&r=PG", "display_name": "user8153", "link": "https://stackoverflow.com/users/7932936/user8153"}, "edited": false, "score": 1, "creation_date": 1502296985, "post_id": 45595274, "comment_id": 78152128, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5890499/pcm-audio-amplitude-values\">PCM audio amplitude values?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502315488, "post_id": 45597907, "comment_id": 78161747, "body": "Curious  Any particular reason for <code>-65536</code> in <code>#define NO_SAMPLE -65536</code> vs maybe <code>#define NO_SAMPLE INT_MIN</code>?"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502315766, "post_id": 45597907, "comment_id": 78161865, "body": "@chux: No reason. Good suggestion; applied. Thanks!"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 4, "last_activity_date": 1502315720, "last_edit_date": 1502315720, "creation_date": 1502302447, "answer_id": 45597907, "question_id": 45595274, "link": "https://stackoverflow.com/questions/45595274/gnuplot-physical-dimension-on-axis/45597907#45597907", "title": "gnuplot - physical dimension on axis", "body": "<p>Issues:</p>\n\n<ol>\n<li><p>That is not a CSV file, it is just a text file.</p></li>\n<li><p>Your code does not look like that. It is far from being compilable, and you made mistakes copying the \"relevant parts\" to this question.</p>\n\n<p>In particular, you used <code>n</code> as the loop variable, but <code>cont</code> in accessing the buffer. If your code was actually that, you'd only see a single pair of values, duplicated, in the output.</p></li>\n<li><p>You do not define the sample rate.</p></li>\n</ol>\n\n<p>Consider the following counter-example:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;limits.h&gt;\n#include &lt;string.h&gt;\n#include &lt;endian.h&gt;\n#include &lt;stdio.h&gt;\n\n#ifndef   SAMPLE_RATE\n#define   SAMPLE_RATE  48000\n#endif\n\n#define  NO_SAMPLE  INT_MIN\n\n#if (__BYTE_ORDER-0 == __BIG_ENDIAN-0)\n\n/* Use big-endian samples */\n\n#define  SAMPLE_FORMAT  \"s16be\"\nstatic inline int read_sample(FILE *source)\n{\n    int16_t sample;\n\n    if (fread(&amp;sample, sizeof sample, 1, source) == 1)\n        return (int)sample;\n    else\n        return NO_SAMPLE;\n}\n\n#elif (__BYTE_ORDER-0 == __LITTLE_ENDIAN-0) || (__BYTE_ORDER-0 == __PDP_ENDIAN-0)\n\n/* Use little-endian samples */\n\n#define  SAMPLE_FORMAT  \"s16le\"\nstatic inline int read_sample(FILE *source)\n{\n    int16_t sample;\n\n    if (fread(&amp;sample, sizeof sample, 1, source) == 1)\n        return (int)sample;\n    else\n        return NO_SAMPLE;\n}\n\n#else\n\n/* Use little-endian (two's complement) samples, but\n   read them byte-by-byte. */\n\n#define  SAMPLE_FORMAT  \"s16le\"\nstatic inline int16_t read_sample(FILE *source)\n{\n    unsigned char  bytes[2];\n    int            sample;\n    if (fread(bytes, 2, 1, source) != 2)\n        return NO_SAMPLE;\n\n    sample = bytes[0] + 256*bytes[1];\n    if (sample &gt; 32767)\n        return sample - 65536;\n    else\n        return sample;\n}\n#endif\n\nint main(void)\n{\n    const double   sample_rate = SAMPLE_RATE;\n    FILE          *in;\n    unsigned long  i;\n    int            sample;\n\n    in = popen(\"ffmpeg -i test1.wav -v -8 -nostats -f \" SAMPLE_FORMAT \" -ac 1 -\", \"r\");\n    if (!in)\n        return EXIT_FAILURE;\n\n    i = 0u;\n    while ((sample = read_sample(in)) != NO_SAMPLE) {\n        printf(\"%.6f %9.6f\\n\", (double)i / sample_rate, (double)sample / 32768.0);\n        i++;\n    }\n\n    pclose(in);\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>It assumes the sample rate is 48,000 samples per second (you could use <code>ffmpeg</code> to find out the sample rate first), then prints out each sample, one sample per line, with time in the first column, and sample value (-1.0 to just under +1.0) in the second column.</p>\n\n<p>In the physics sense, the first column reflects the time dimension of the sample, and the second column the relative pressure change at that moment in the sensor -- however, neither the sign or the linearity of the pressure change is really known for sure, as it depends on the exact microphone, amplification, and ADC used.</p>\n\n<p>Let's say you compile and run the above, redirecting the output to <code>test1.out</code>:</p>\n\n<pre><code>gcc -Wall -O2 example.c -o example\n./example &gt; test1.out\n</code></pre>\n\n<p>You can draw this in Gnuplot easily. Start <code>gnuplot</code>, and tell it</p>\n\n<pre><code>set xlabel \"Time [seconds]\"\nset ylabel \"Relative pressure change [f((P-P0)/Pmax)]\"\nplot \"test1.out\" u 1:2 notitle w lines\n</code></pre>\n\n<p>For the vertical axis, <code>P</code> is the pressure at the moment indicated on the horizontal axis, <code>P0</code> is the ambient pressure, <code>Pmax</code> is the maximum pressure change the microphone can detect, and <code>f()</code> is the inverse of the nonlinearity of the microphone, microphone amplifier, and analog-to-digital converter circuitry used. (Both <code>f()</code> and <code>Pmax</code> likely depend on the ambient pressure <code>P0</code>, too.)</p>\n"}], "owner": {"reputation": 61, "user_id": 5450076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/20cc09b680b6b5318d6f7f519d9d7e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Niccol&#242; Cirone", "link": "https://stackoverflow.com/users/5450076/niccol%c3%b2-cirone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 45597907, "answer_count": 1, "score": 0, "last_activity_date": 1502315720, "creation_date": 1502293593, "last_edit_date": 1502298727, "question_id": 45595274, "link": "https://stackoverflow.com/questions/45595274/gnuplot-physical-dimension-on-axis", "title": "gnuplot - physical dimension on axis", "body": "<p>I wrote a code that supposedly should read an audio file as an input in order to write a csv file containing every sample. This is the code:</p>\n\n<pre><code>FILE *pipein;\n          pipein = popen(\"ffmpeg -i test1.wav -f s16le -ac 1 -\", \"r\");\n          fread(buf, 2, sample_number, pipein);\n          pclose(pipein);\n\n          // Print the sample values in the buffer to a CSV file\n          FILE *csvfile;\n          csvfile = fopen(\"samples.csv\", \"w\");\n\n          while (n&lt;=sample_number) {\n\n            //if (buf[n]!=0) {\n\n                    fprintf(csvfile, \"%d %f\\n\", buf[cont], Sam_freq*cont);\n                    cont++;\n\n         //  }\n\n             n++;\n\n          }\n\n          fclose(csvfile);\n</code></pre>\n\n<p>This is how the csv file looks like after running the code:</p>\n\n<pre><code>10 43.150544\n-36 43.150567\n11 43.150590\n30 43.150612\n-29 43.150635\n61 43.150658\n13 43.150680\n46 43.150703\n121 43.150726\n61 43.150748\n144 43.150771\n128 43.150794\n130 43.150816\n131 43.150839\n</code></pre>\n\n<p>I tried to plot the data of samples.csv using gnuplot but I don't understand which physical dimension is represented on y axis.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AJeT7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AJeT7.png\" alt=\"waveform plot\"></a>\nI read on other posts that values on y axis represent the deformation of the membrane in the microphone. Does anyone know a mathematical relation in order to extract from these values the physical dimension I need?</p>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 6, "creation_date": 1502293574, "post_id": 45595245, "comment_id": 78150077, "body": "Take care of <code>&#39;\\n&#39;</code> character."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502293604, "post_id": 45595245, "comment_id": 78150096, "body": "Aside: <code>getchar()</code> returns <code>int</code> not <code>char</code> (and <code>&#39;x&#39;</code> is also of type <code>int</code> and not <code>char</code>)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502294222, "post_id": 45595245, "comment_id": 78150502, "body": "Add a <code>getchar();</code> after your <code>c = getchar();</code> or a <code>scanf(&quot; &quot;);</code>"}, {"owner": {"reputation": 10359, "user_id": 1216776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/504692de390dabd9ca22fd716e178993?s=128&d=identicon&r=PG", "display_name": "stark", "link": "https://stackoverflow.com/users/1216776/stark"}, "edited": false, "score": 0, "creation_date": 1502294224, "post_id": 45595245, "comment_id": 78150503, "body": "You are printing after you get the character, but before you have tested its value."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502294583, "post_id": 45595245, "comment_id": 78150728, "body": "Why didn&#39;t you try to print it yourself. You would get the answer in no time."}], "answers": [{"comments": [{"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502295300, "post_id": 45595738, "comment_id": 78151133, "body": "OP is getting the print messages twice every iteration when he enters anything other than <code>x</code>. What you have mentioned in unrelated."}], "tags": [], "owner": {"reputation": 94, "user_id": 5130314, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7f76b169f2c0c154dc985791bc56d1d9?s=128&d=identicon&r=PG&f=1", "display_name": "srishti sharma", "link": "https://stackoverflow.com/users/5130314/srishti-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1502294941, "creation_date": 1502294941, "answer_id": 45595738, "question_id": 45595245, "link": "https://stackoverflow.com/questions/45595245/unexpected-output-with-getchar/45595738#45595738", "title": "unexpected output with getchar()", "body": "<p>I think the problem is in the way logic is applied. You print <strong>before you check the condition.</strong> See this for explanation:   </p>\n\n<p>loop 1: getchar() executed say for value 'a'.<br>\n printf() executed.<br>\nloop 2: Because c='a', condition is true. Now, getchar() is executed with 'x' value.\nprintf() is again executed.<br>\nloop 3: Condition is evaluated false. Loop is terminated.</p>\n\n<p>So basically you should change your logic a little bit.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502302385, "post_id": 45595817, "comment_id": 78155220, "body": "<code>scanf(&quot; &quot;);</code> will discard all whites-space, as you say, yet it will also not return until a non-white-space is entered.  This may provide for unexpected code flow should some code exist between that and <code>getchar()</code>."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502303196, "post_id": 45595817, "comment_id": 78155725, "body": "@chux, I agree. A <code>scanf(&quot;%*[ ]&quot;);</code> would work better?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502303377, "post_id": 45595817, "comment_id": 78155817, "body": "<code>scanf(&quot;%*[ ]&quot;);</code> would have a similar issue: &quot;not return until a non-space is entered.&quot;.  Perhaps <code>char ch; if (scanf(&quot; %c&quot;, &amp;ch) == 1) ...;</code> instead of <code>scanf(&quot; &quot;); int ch = getchar();</code> to keep the input function call indivisible."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502303781, "post_id": 45595817, "comment_id": 78156036, "body": "@chux, I just tried it and just <code>scanf(&quot; &quot;);</code> worked <a href=\"http://ideone.com/3CDqv5\" rel=\"nofollow noreferrer\">here</a>, when there is no whitespace between the two characters."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502304352, "post_id": 45595817, "comment_id": 78156357, "body": "Try <code>puts(&quot;1st&quot;); fflush(stdout);     int a = getchar();     scanf(&quot; &quot;);     puts(&quot;2nd&quot;); fflush(stdout);     int b = getchar();     printf(&quot;%c,%c&quot;, a,b);</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502304481, "post_id": 45595817, "comment_id": 78156432, "body": "@chux tried on same link. Same output. Is it some console pecularity?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502304503, "post_id": 45595817, "comment_id": 78156449, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/151534/discussion-between-chux-and-ajay-brahmakshatriya\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 2, "last_activity_date": 1502306226, "last_edit_date": 1502306226, "creation_date": 1502295204, "answer_id": 45595817, "question_id": 45595245, "link": "https://stackoverflow.com/questions/45595245/unexpected-output-with-getchar/45595817#45595817", "title": "unexpected output with getchar()", "body": "<p>The simple issue here is that the console (input) sends the text to the <code>stdin</code> only when it encounters a enter key or <code>ctr+d</code>.</p>\n\n<p>As a result an extra <code>\\n</code> goes into your input stream. This causes your program to read that character in the next iteration.</p>\n\n<p>A simple solution would be to read all white space characters in the stream. </p>\n\n<p>This can be done in multiple ways - </p>\n\n<p>If you need to discard any whitespace characters (including space, tabs, vtabs, newline), you can add</p>\n\n<pre><code>scanf(\" \");\n</code></pre>\n\n<p>before the <code>getchar();</code></p>\n\n<p>If you need to discard only the newlines which come as a result of pressing enter, you can add</p>\n\n<pre><code>scanf(\"%*[\\n]\")\n</code></pre>\n\n<p>before the <code>getchar();</code></p>\n\n<p>This will eat up all the <code>\\n</code> that come before the next character. But will not eat spaces.</p>\n\n<p>Finally if you want to discard only 1 <code>\\n</code></p>\n\n<p>You can do </p>\n\n<pre><code>scanf(\"%*1[\\n]\");\n</code></pre>\n\n<p><strong>Remember</strong> though, in all the cases the <code>scanf</code> should be immediately before the <code>getchar()</code> because <code>scanf</code> would wait till it finds the next non white space character. </p>\n\n<p>All cases figured out with the help of comments from @chux.</p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 2, "last_activity_date": 1502295660, "creation_date": 1502295660, "answer_id": 45595968, "question_id": 45595245, "link": "https://stackoverflow.com/questions/45595245/unexpected-output-with-getchar/45595968#45595968", "title": "unexpected output with getchar()", "body": "<p>If you tried to debug your program (its best way to learn to code), you would spot that the second value is everytime <code>10</code>. In ASCII table you would find that is code for new line. Which you are pressing after the every character. Then by fast &amp; simple searching you would find this <a href=\"https://stackoverflow.com/questions/37100201/how-is-the-getchar-function-able-to-take-multiple-characters-as-input\">THREAD</a>. Where is the problem described and you would easily solve it.</p>\n\n<pre><code>char c = ' ';\nwhile(c != 'x')\n{\n    printf(\"threadFuncParam = %u\\n\", (char)c);\n    fflush(stdout);\n    if (scanf(\" %c\",&amp;c) != 1)\n    {\n        // failed\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 544, "user_id": 1039936, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/fO39L.jpg?s=128&g=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/1039936/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 45595817, "answer_count": 3, "score": -1, "last_activity_date": 1502348300, "creation_date": 1502293504, "last_edit_date": 1502348300, "question_id": 45595245, "link": "https://stackoverflow.com/questions/45595245/unexpected-output-with-getchar", "title": "unexpected output with getchar()", "body": "<pre><code>char c = ' ';\nwhile(c != 'x')\n{       \n    c = getchar();\n    printf(\"threadFuncParam = %u\\n\", threadFuncParam);\n}\n</code></pre>\n\n<p>In the above code snippet the print is printing threadFuncParam value twice every time I enter a character where as I expect it to print only once.\nAs per my understanding very first  time it enters while as condition is true and and then wait for user input at getchar call on entering a character it shall print the value and then if input character is not x it shall wait for another input at getchar call, but whenever i enter a character i see 2 prints ion screen for each input. I am not able to understand why?</p>\n\n<p>What i'm trying to do here is that in main thread i am taking single char input from user and in worker thread i am incrementing a counter which gets incremented every second, i print the value everytime user input a char input until user enters 'x' character.</p>\n"}, {"tags": ["c", "pointers", "memory-management", "alignment"], "comments": [{"owner": {"reputation": 6356, "user_id": 1109725, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ab7e17981e19525fe1bed0878d0d2cc9?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1109725/joe"}, "edited": false, "score": 0, "creation_date": 1502292191, "post_id": 45594731, "comment_id": 78149079, "body": "The structs are packed and the data is aligned correctly, yeah?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502292242, "post_id": 45594731, "comment_id": 78149121, "body": "What&#39;s <code>us</code> ? Why it can be printed? Also I see some missing parentheses."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1502292409, "post_id": 45594731, "comment_id": 78149245, "body": "Yes. I packed the file in python using little-endian (it is for a little endian processor). Before, I had it working with new memory allocations but decided to get rid of that."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1502292492, "post_id": 45594731, "comment_id": 78149291, "body": "@ Eugene Sh &quot;us&quot; in an unsigned short, sorry I missed a parentheses on the printf while copyng the data (the code compiles)"}, {"owner": {"reputation": 1636, "user_id": 3370124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f73352b4adb282c092738f34883488dd?s=128&d=identicon&r=PG&f=1", "display_name": "Richard Critten", "link": "https://stackoverflow.com/users/3370124/richard-critten"}, "edited": false, "score": 0, "creation_date": 1502292510, "post_id": 45594731, "comment_id": 78149307, "body": "In C++ it&#39;s undefined behaviour, use <code>std::memcpy</code> instead.  It might also be UB in C you will need to check the standard."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1502292638, "post_id": 45594731, "comment_id": 78149409, "body": "@ Richard Critten How would extract the array from _pack_dynamic (it has m_number_of_indexes elements) and paste it on l_all_indexes) without allocating new more memory?"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502293240, "post_id": 45594731, "comment_id": 78149845, "body": "Its not possible"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502293558, "post_id": 45594731, "comment_id": 78150060, "body": "what type of pointer is <code>_pack_dynamic</code>? Looks like this violates <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">strict aliasing rules</a>"}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502293734, "post_id": 45594731, "comment_id": 78150185, "body": "@yano the type is void *"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502294156, "post_id": 45594731, "comment_id": 78150460, "body": "you can use a <code>union</code> to associate the pointers together, something like <code>union{ void* _pack_dynamic; us* _pack_dynamic_us; };</code>, then use the <code>us*</code> when you need it,, I think that will correct your UB. If you&#39;re still crashing after that obviously there&#39;s other problems."}, {"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1502294498, "post_id": 45594731, "comment_id": 78150668, "body": "@ yano Didn&#180;t know you could do that, thanks for the tip! I have a bunch of different types (not only us) so I guess it would have to go back to memory allocation and memcpy"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502294985, "post_id": 45594731, "comment_id": 78150962, "body": "Sure,, take a look at the strict aliasing link in my previous comment and do some googling for &quot;type punning&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502303169, "post_id": 45594731, "comment_id": 78155708, "body": "&quot;extract all&quot; --&gt; <code>us extract[m_number_of_indexes]; memcpy(extract, _pack_dynamic, sizeof *extract * m_number_of_indexes);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "edited": false, "score": 0, "creation_date": 1502293601, "post_id": 45595181, "comment_id": 78150095, "body": "ok, thanks for the explanation, I guess I will have to go back to previous version and allocate new memory and use memcpy instead."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": false, "score": 0, "last_activity_date": 1502293736, "last_edit_date": 1502293736, "creation_date": 1502293326, "answer_id": 45595181, "question_id": 45594731, "link": "https://stackoverflow.com/questions/45594731/pointer-alignment-issue/45595181#45595181", "title": "Pointer alignment issue", "body": "<p>Accessing <code>_pack_dynamic</code> as if it contained <code>us</code> object(s) has undefined behaviour unless it actually does contain such objects (this is a slight simplification, but a good rule of thumb. An array of <code>char</code> certainly cannot be interpreted as <code>short</code>).</p>\n\n<p>The <code>memcpy</code> way into a proper <code>us</code> object is the only standard way to interpret memory as an object. Another approach for integers is to read char by char and shift-mask-or them together. This approach allows assuming a particular endianness instead of native.</p>\n\n<p>A system dependent way that might work is to make sure that <code>_pack_dynamic</code> is aligned to the boundary required by <code>us</code>. But even then, standard gives you no guarantees about behaviour.</p>\n\n<p>\"Allocating\" an automatic variable has hardly any runtime overhead. Allocating a few bytes for a <code>short</code> is usually insignificant.</p>\n"}], "owner": {"reputation": 71, "user_id": 8440657, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/c0c54df687648b253c2bf6ce2c36612e?s=128&d=identicon&r=PG&f=1", "display_name": "Walrfi", "link": "https://stackoverflow.com/users/8440657/walrfi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1502293736, "creation_date": 1502292104, "last_edit_date": 1502293344, "question_id": 45594731, "link": "https://stackoverflow.com/questions/45594731/pointer-alignment-issue", "title": "Pointer alignment issue", "body": "<p>I have the content of a file already loaded in memory and I want to assign the data from the file to a convenient set of structs, and I don\u00b4t want to allocate new memory.</p>\n\n<p>So I have the pointer of the memory where the data from the file starts, from there I work down this pointer assigning the values to different structs but then I reach a point where the program crashes.</p>\n\n<pre><code>//_pack_dynamic is the pointer to the data in memory\nus *l_all_indexes = (us *) _pack_dynamic; //us is an unsigned short\n\nprintf(\"Index 0:%d\", l_all_indexes[0]); //here is where the program crashes\n\n_pack_dynamic += sizeof(us) * m_number_of_indexes;\n</code></pre>\n\n<p>The data, at least for the first element, is there, I can get it out like so:</p>\n\n<pre><code>us temp;\nmemcpy(&amp;temp, _pack_dynamic, sizeof(us));\n</code></pre>\n\n<p>Any idea how I could extract all the indexes (<strong>m_number_of_indexes</strong>) from <strong>_pack_dynamic</strong> and assign them to <strong>l_all_indexes</strong> without allocating new memory?</p>\n"}, {"tags": ["c", "opengl", "glsl"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7065213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8197205cab768c1ec38ac24364336fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Coding OnMyCouch", "link": "https://stackoverflow.com/users/7065213/coding-onmycouch"}, "edited": false, "score": 0, "creation_date": 1502301736, "post_id": 45595269, "comment_id": 78154855, "body": "Thank you so much! This is the answer I needed :]"}], "tags": [], "owner": {"reputation": 393, "user_id": 7696994, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17784fe0e324ef1766fa03e14ea9bd2f?s=128&d=identicon&r=PG&f=1", "display_name": "k.krol.27", "link": "https://stackoverflow.com/users/7696994/k-krol-27"}, "is_accepted": true, "score": 2, "last_activity_date": 1502295281, "last_edit_date": 1502295281, "creation_date": 1502293580, "answer_id": 45595269, "question_id": 45594676, "link": "https://stackoverflow.com/questions/45594676/how-to-store-a-texture-in-memory-and-render-a-small-portion-of-it/45595269#45595269", "title": "How to store a texture in memory and render a small portion of it", "body": "<p>If you only wanted to render of the portion of the loaded texture simply adjust your texture coordinates in a VBO accordingly.</p>\n\n<p>Texture coordinates passed to the <code>texture(...)</code> function in a shader program map the bottom left corner as <code>(0,0)</code> and the top right corner as <code>(1,1)</code>. So if we would like to map only the top right corner of a texture to a flat quad, our texture coordinates would consist of <code>(0.5,0.5)</code>, <code>(0.5,1.0)</code>, <code>(1.0,1.0)</code>, and <code>(1.0,0.5)</code>.</p>\n\n<hr>\n\n<p>Here would be the vertex and texture coordinate VBO data:</p>\n\n<pre><code>float[] vertices = {\n      0.5,  0.5, 0.0,     // upper left triangle\n     -0.5,  0.5, 0.0,\n     -0.5, -0.5, 0.0,\n\n      0.5,  0.5, 0.0,     // lower right triangle\n     -0.5, -0.5, 0.0,\n      0.5, -0.5, 0.0\n};\n\nfloat[] textureCoords = {\n     1.0, 1.0,\n     0.5, 1.0,\n     0.5, 0.5,\n\n     1.0, 1.0,\n     0.5, 0.5,\n     1.0, 0.5\n};\n</code></pre>\n\n<p>Once you have your data load <code>vertices</code> to a VAO as attribute 1 and <code>textureCoords</code> as attribute 2. Then your shader should look something like this:</p>\n\n<p>Vertex Shader:</p>\n\n<pre><code>in vec3 vertex;\nin vec2 textureCoords;\n\nout vec2 interpolatedCoords;\n\nvoid main(void) {\n\n     interpolatedCoords = textureCoords;\n\n     gl_Position = vertex; // You transform these coordinates or whatever you'd like here\n\n}\n</code></pre>\n\n<p>Fragment Shader:</p>\n\n<pre><code>in vec2 interpolatedCoords;\n\nout vec4 out_color;\n\nuniform sampler2D texture;\n\nvoid main(void) {\n\n     out_color = texture(texture, interpolatedCoords);\n\n}\n</code></pre>\n\n<p>That would be the most bare bones example of mapping some portion of a texture onto a simple 2D quad.</p>\n"}], "owner": {"reputation": 25, "user_id": 7065213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8197205cab768c1ec38ac24364336fc2?s=128&d=identicon&r=PG&f=1", "display_name": "Coding OnMyCouch", "link": "https://stackoverflow.com/users/7065213/coding-onmycouch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 45595269, "answer_count": 1, "score": 0, "last_activity_date": 1502560952, "creation_date": 1502291958, "last_edit_date": 1502560952, "question_id": 45594676, "link": "https://stackoverflow.com/questions/45594676/how-to-store-a-texture-in-memory-and-render-a-small-portion-of-it", "title": "How to store a texture in memory and render a small portion of it", "body": "<p>I have a texture that I would like to store in memory. Then I would like to render a portion of this texture onto an OpenGL context. I would like to know how to do this.</p>\n\n<p>So far I've set up my vertex data.</p>\n\n<pre><code>GLfloat texture[] =\n{\n    -0.5f, 0.5f, 0.0f,      0.1f, 0.0f, 0.0f,    1.0f, 1.0f,  // top rght\n     0.5f, 0.5f, 0.0f,      0.0f, 0.1f, 0.0f,    1.0f, 0.0f,  // bottom right\n     0.5f, -0.5f, 0.0,      0.0f, 0.0f, 0.1f,    0.0f, 0.0f,  // bottom left\n    -0.5f, -0.5f, 0.0f,     0.0f, 0.0f, 0.0f,    0.0f, 1.0f,  // top left\n};\n</code></pre>\n\n<p>I then go through the usual steps of creating a VBO, and using the OpenGL functions</p>\n\n<pre><code>GLuint indices[] =\n{\n    0, 1, 3, //First triangle\n    1, 2, 3  //Second triangle\n};\n\nGLuint VBO, VAO, EBO;\nglGenVertexArrays(1, &amp;VAO);\nglGenBuffers(1,&amp; VBO);\nglGenBuffers(1, &amp;EBO);\n\nglBindVertexArray(VAO);\nglBindBuffer(GL_ARRAY_BUFFER, VB);\nglBufferData(GL_ARRAY_BUFFER, sizeof(texture), texture, GL_STATIC_DRAW);\nglBindBuffer(GL_ELEMENT_ARRAY_BUFFER, EBO);\nglBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(indices), indices, GL_STATIC_DRAW);\n//position attributes\nglVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(GLfloat), (GLvoid*)0);\nglEnableVertexAttribArray(0);\n//colour attributes\nglVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 8 * sizeof(GLfloat), (GLvoid*)(3 * sizeof(GLfloat)));\nglEnableVertexAttribArray(1);\n//TexCoord attribute\nglVertexAttribPointer(2, 2, GL_FLOAT, GL_FALSE, 8 * sizeof(GLfloat), (GLvoid*)(6 * sizeof(GLfloat)));\nglEnableVertexAttribArray(2);\nglBindVertexArray(0); //unbind VAO\n</code></pre>\n\n<p>load and create a texture:</p>\n\n<pre><code>GLuint texture0;\n\nint width, height;\nunsigned char* image[1];\n\nglGenTextures(1, &amp;texture0);\nglBindTexture(GL_TEXTURE_2D, texture0); \nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);//set texture wrapping to GL_REPEAT (usually basic wrapping method)\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);\nglTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);\nimage[0] = SOIL_load_image(\"Textures/texture.png\", &amp;width, &amp;height, 0, SOIL_LOAD_RGB);\nglTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, width, height, 0, GL_RGB, GL_UNSIGNED_BYTE, image[0]);\nglGenerateMipmap(GL_TEXTURE_2D);\nSOIL_free_image_data(image[0]);\nglBindTexture(GL_TEXTURE_2D, texture0); \n</code></pre>\n\n<p>I then use a while loop to activate the shader and then draw the texture. However want I now want to do is store this texture in memory and render only a small portion of it. Do I use a Renderbuffer object or a PBO, or is there some other way of achieving this?</p>\n"}, {"tags": ["c", "stack", "call"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1502289987, "post_id": 45593854, "comment_id": 78147294, "body": "that&#39;s the most portable way to do useful things ;)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1502290137, "post_id": 45593854, "comment_id": 78147410, "body": "Notice also that on many architectures arguments are partially passed in registers, so there is no stack you could modify..."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502290934, "post_id": 45593854, "comment_id": 78148109, "body": "@Mahkoe <code>Is this kind of trickery available?</code> of course it is. Use inline assembly. You can do any trick you want. Is it portable - I think you should answer yourself if you consider it portable"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502291461, "post_id": 45593854, "comment_id": 78148500, "body": "<i>C call stack</i> is a non term!"}], "owner": {"reputation": 692, "user_id": 2737696, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ec50c6bbe7ed72e2a56ea6f7cccee5df?s=128&d=identicon&r=PG&f=1", "display_name": "Marco Merlini", "link": "https://stackoverflow.com/users/2737696/marco-merlini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "closed_date": 1502289849, "answer_count": 0, "score": 0, "last_activity_date": 1502289755, "creation_date": 1502289755, "question_id": 45593854, "link": "https://stackoverflow.com/questions/45593854/direct-manipulation-of-c-call-stack", "closed_reason": "Duplicate", "title": "Direct manipulation of C call stack", "body": "<p>Is it possible to directly access the call stack in C?</p>\n\n<p>For example, could I do something like </p>\n\n<pre><code>pushInt(5);\npushInt(6);\nprintf(\"%d %d\\n\");\n</code></pre>\n\n<p>Although the paramaters (5 and 6) are not in the printf call, in theory I have pushed them on the stack. </p>\n\n<p>Is this kind of trickery available? Is it portable?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1502288882, "post_id": 45593493, "comment_id": 78146372, "body": "What are you expecting the content to be?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1502288959, "post_id": 45593493, "comment_id": 78146441, "body": "This is wrong for two reasons: <code>if(campo[row][col] = &quot; - &quot;){</code>. First, the comparison operator is <code>==</code>, not <code>=</code>. Second, you can&#39;t compare strings with <code>==</code>, you have to use <code>strcmp()</code>."}, {"owner": {"reputation": 135, "user_id": 8203930, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10213616584395883/picture?type=large", "display_name": "Filippo Auletta", "link": "https://stackoverflow.com/users/8203930/filippo-auletta"}, "edited": false, "score": 0, "creation_date": 1502289112, "post_id": 45593493, "comment_id": 78146569, "body": "Content should be &quot;-&quot; as it is right when I type campo [3] [1]"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1502289177, "post_id": 45593493, "comment_id": 78146624, "body": "Don&#39;t store an array of strings. Store something simple like numbers in the array, and convert them to/from strings in your input/output functions."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502289306, "post_id": 45593493, "comment_id": 78146735, "body": "<code>char* campo[NUM_CASELLE][NUM_CASELLE];</code> and &quot;At the beginning of the program each element of the matrix is initialized with &quot;-&quot;.&quot; is inconsistent.  The code performs no <i>initialization</i>, yet the post says initialization is occurring."}, {"owner": {"reputation": 135, "user_id": 8203930, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10213616584395883/picture?type=large", "display_name": "Filippo Auletta", "link": "https://stackoverflow.com/users/8203930/filippo-auletta"}, "edited": false, "score": 0, "creation_date": 1502289463, "post_id": 45593493, "comment_id": 78146870, "body": "Initialization takes place in another function that I did not post because I&#39;m sure the function does what it has to do."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502289484, "post_id": 45593493, "comment_id": 78146889, "body": "The actual error is that you assign the <code>row</code> from <b>char</b>. It is the ASCII code of the row number, not a small integer but 48-57..."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502289536, "post_id": 45593493, "comment_id": 78146927, "body": "Then you hide your mistake by using <code>%c</code> in <code>printf</code> when you should use <code>%d</code>."}, {"owner": {"reputation": 135, "user_id": 8203930, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10213616584395883/picture?type=large", "display_name": "Filippo Auletta", "link": "https://stackoverflow.com/users/8203930/filippo-auletta"}, "edited": false, "score": 0, "creation_date": 1502289774, "post_id": 45593493, "comment_id": 78147117, "body": "Antti Haapala you are right. The error is there. How do I convert char to integer? I have not been able to find a way to do it in c."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502290463, "post_id": 45593493, "comment_id": 78147680, "body": "@FilippoAuletta Detail: In C, <i>initialization</i> has a specific meaning where an initial value is defined in the objects <i>definition</i> like <code>int x = 42;</code>.  <code>int x; ... x = 42;</code> is not initialization, but an <i>assignment</i>, even if it is the first assignment."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502290577, "post_id": 45593493, "comment_id": 78147774, "body": "Basically, this is not how strings work in C. I would recommend reading the chapter about strings in your beginner-level C book. The linked duplicates may also contain good reading."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502289708, "post_id": 45593599, "comment_id": 78147068, "body": "any comment if you downvote"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502289812, "post_id": 45593599, "comment_id": 78147150, "body": "Not my downvote, but it was probably downvoted because the first version of your answer was too short and didn&#39;t actually answer the question."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1502290306, "last_edit_date": 1502290306, "creation_date": 1502289075, "answer_id": 45593599, "question_id": 45593493, "link": "https://stackoverflow.com/questions/45593493/if-i-use-variables-as-indexes-to-access-a-char-the-content-of-the-eleme/45593599#45593599", "title": "If I use variables as indexes to access a char * [] [], the content of the elements is (null)", "body": "<p>Yes. It is correct. Your table is two dimensional array of pointers. And it can't store anything else but the pointers.</p>\n\n<p>The cell can point to something valid if you:</p>\n\n<ol>\n<li><p>Allocate the memory and then store something in that allocated memory</p>\n\n<pre><code>campo[x][y] = malloc(size);\nstrcpy(campo[x][y], \"Hello.\");\n</code></pre></li>\n<li><p>Assign the cell with the valid pointer</p>\n\n<pre><code>char str[] = \"hello\";\nchar *str1 = \"HELLO\";\ncampo[x][y] = str;\ncampo[n][n] = str1;\ncampo[a][b] = \"Hello Again\";\n</code></pre></li>\n<li><p>If you have already assigned the pointer with the address of the valid string, there is nothing in like string comparition operator</p></li>\n</ol>\n\n<p><code>if(campo[row][col] = \" - \")</code> - will assign campo[row][col] with the address of the string literal \" - \" and <code>if</code> will consider it as the truth as the valid pointer always cast to non zero integer (but you get the warning)</p>\n\n<p><code>if(campo[row][col] == \" - \")</code> will compare the pointer campo[row][col] with the address of string literal \" - \"</p>\n\n<p><code>if(!strcmp(campo[row][col] , \" - \"))</code> will check if both string are equal</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1502290592, "last_edit_date": 1502290592, "creation_date": 1502289734, "answer_id": 45593841, "question_id": 45593493, "link": "https://stackoverflow.com/questions/45593493/if-i-use-variables-as-indexes-to-access-a-char-the-content-of-the-eleme/45593841#45593841", "title": "If I use variables as indexes to access a char * [] [], the content of the elements is (null)", "body": "<p><code>if(campo[row][col] = \" - \"){</code> is an assignment and then a test, not a string nor pointer compare <a href=\"https://stackoverflow.com/users/1491895/barmar\">@barmar</a>.</p>\n\n<p>Likely code should use <code>strcmp()</code> to compare strings.</p>\n\n<pre><code>if(strcmp(campo[row][col], \" - \") == 0) {\n</code></pre>\n\n<hr>\n\n<p>OP says \"matrix is initialized with \"-\".\"  This differs from the above compare target.</p>\n\n<pre><code>// This is not initialization, only a defintion without initialization    \nchar* campo[NUM_CASELLE][NUM_CASELLE];\n\n...\n// potential unposted \"initialization\" code, needed for each campo[row][col] \ncampo[row][col] = \"-\";  // this will not compare as above\ncampo[row][col] = \" - \";  // this will compare as above\n</code></pre>\n\n<hr>\n\n<p>I suspect unposted code has trouble with <code>campo[row][col]</code> and other issues.</p>\n"}, {"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 1, "last_activity_date": 1502290044, "last_edit_date": 1502290044, "creation_date": 1502289749, "answer_id": 45593850, "question_id": 45593493, "link": "https://stackoverflow.com/questions/45593493/if-i-use-variables-as-indexes-to-access-a-char-the-content-of-the-eleme/45593850#45593850", "title": "If I use variables as indexes to access a char * [] [], the content of the elements is (null)", "body": "<p><strong>1.</strong></p>\n\n<pre><code>case 'f':\n    ret = 6;\n    break;\ncase 'F':\n    ret = 6;\n    break;\n</code></pre>\n\n<p>easier</p>\n\n<pre><code>case 'F':\ncase 'f':\n    ret = 6;\nbreak;\n</code></pre>\n\n<p><strong>2.</strong>\nCannot compare string's with <code>==</code>.\nYou have to use <code>strcmp()</code>.</p>\n\n<pre><code>strcmp(campo[row][col], \"-\")\n</code></pre>\n\n<p><strong>3.</strong>\nYou should write program's in american english, especially if you are pasting them somewhere.</p>\n\n<p><strong>4.</strong>\nDont forget to <strong>check return value's</strong>.</p>\n\n<p><strong>5.</strong></p>\n\n<pre><code>char* campo[NUM_CASELLE][NUM_CASELLE];\n</code></pre>\n\n<p>is pointer to double array, change it to</p>\n\n<pre><code>char campo[NUM_CASELLE][NUM_CASELLE];\n</code></pre>\n\n<p>so you can do <code>campo[x][x]</code> now.</p>\n\n<p><strong>6.</strong></p>\n\n<pre><code>row = pos[1];\n</code></pre>\n\n<p>Here you are assigning ascii value of character, do</p>\n\n<pre><code>row = pos[1] - '0';\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 8203930, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/10213616584395883/picture?type=large", "display_name": "Filippo Auletta", "link": "https://stackoverflow.com/users/8203930/filippo-auletta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1502290496, "accepted_answer_id": 45593850, "answer_count": 3, "score": -2, "last_activity_date": 1502290592, "creation_date": 1502288795, "question_id": 45593493, "link": "https://stackoverflow.com/questions/45593493/if-i-use-variables-as-indexes-to-access-a-char-the-content-of-the-eleme", "closed_reason": "Duplicate", "title": "If I use variables as indexes to access a char * [] [], the content of the elements is (null)", "body": "<p>I'm writing a program to play battleship. \nI have a string matrix representing the battlefield.</p>\n\n<pre><code>#define NUM_CASELLE 6\n\nchar* campo[NUM_CASELLE][NUM_CASELLE];\n</code></pre>\n\n<p>At the beginning of the program each element of the matrix is initialized with \"-\".</p>\n\n<p>I noticed that I have problems accessing the matrix elements so I did some debugging to better understand what the problem was and I noticed this: if I write</p>\n\n<pre><code>printf(\"The content is %s\\n\", campo[3][1]);\n</code></pre>\n\n<p>the result is</p>\n\n<blockquote>\n  <p>The content is  - </p>\n</blockquote>\n\n<p>and that's right.</p>\n\n<p>But if I enter coordinates from stdin and memorize them in variables,  </p>\n\n<pre><code>printf(\"row is %c\\n\", row);\nprintf(\"col is %d\\n\", col);\nprintf(\"The content is %s\\n\", campo[row][col]);\n</code></pre>\n\n<p>the result is as follows:</p>\n\n<blockquote>\n  <p>The content is (null)</p>\n</blockquote>\n\n<p>Where am I wrong?</p>\n\n<p>Anyway, I post the whole code because maybe the error is elsewhere.\nIn fact, the coordinates are entered as they are in battleship, for example, a3 or b5 or f1 etc .. and then I convert the letter to the respective row index.</p>\n\n<pre><code>#define NUM_CASELLE 6\n#define NUM_NAVI    7\n\nint pos_size = 256;\n\nchar* campo[NUM_CASELLE][NUM_CASELLE];\n\nvoid posizionaNavi(){\n    char pos[pos_size];\n    int i = 0;\n    int col;\n    int row;\n\n    printf(\"Scegli dove posizionare le navi...\\n\");\n\n    while(i &lt; NUM_NAVI){\n        printf(\"Posizionare nave numero %d...\\n\", i + 1);\n        fgets(pos, pos_size, stdin);\n\n        col = isCommandValid(pos); \n        row = pos[1];\n\n        if(col == -1){\n            printf(\"\\n\");\n            printf(\"&gt;&gt; ATTENZIONE: formato errato.\\n\");\n            printf(\"&gt;&gt; Le colonne vanno dalla lettera A alla lettera F\\n\");\n            printf(\"&gt;&gt; Le righe vanno dal numero 1 al numero 6\\n\");\n            printf(\"&gt;&gt; Esempi di comando valido: a3 - b6 - f1\\n\");\n            printf(\"\\n\");\n        }\n        else{\n            printf(\"row is %c\\n\", row);\n            printf(\"col is %d\\n\", col);\n            printf(\"The content is %s\\n\", campo[row][col]);\n            printf(\"The content is %s\\n\", campo[3][1]);\n\n            if(campo[row][col] = \" - \"){\n                campo[row][col] = \" x \";\n                printf(\"Nave %d posizionata in %s\\n\", i + 1, pos);\n                i++;\n            }\n            else{\n                printf(\"&gt;&gt; ATTENZIONE: casella gi\u00e0 occupata da una nave.\");\n                printf(\"&gt;&gt; Riprovare...\\n\");\n                printf(\"\\n\");\n            }\n        }\n    }\n}\n\nint isCommandValid(char* pos){\n    int ret;\n\n    if(strlen(pos) != 3 || pos[1] &gt; '6' || pos[1] &lt; '1')\n        return -1;\n\n    switch(pos[0]){\n        case 'a':\n            ret = 1;\n            break;\n        case 'A':\n            ret = 1;\n            break;\n        case 'b':\n            ret = 2;\n            break;\n        case 'B':\n            ret = 2;\n            break;\n        case 'c':\n            ret = 3;\n            break;\n        case 'C':\n            ret = 3;\n            break;\n        case 'd':\n            ret = 4;\n            break;\n        case 'D':\n            ret = 4;\n            break;\n        case 'e':\n            ret = 5;\n            break;\n        case 'E':\n            ret = 5;\n            break;\n        case 'f':\n            ret = 6;\n            break;\n        case 'F':\n            ret = 6;\n            break;\n        default:\n            ret = -1;\n            break;\n    }\n\n    return ret;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502288042, "post_id": 45593139, "comment_id": 78145647, "body": "Who is supposed to &quot;print&quot; the error? Of course it is runtime error as the denominator can get different values in the runtime."}, {"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 1, "creation_date": 1502288067, "post_id": 45593139, "comment_id": 78145667, "body": "The title doesn&#39;t match the question in the post. What exactly are you asking?"}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1502288071, "post_id": 45593139, "comment_id": 78145669, "body": "Dividing by zero is <i>undefined behavior</i> (for integer types or floating point numbers in non-IEEE environments) - the standard doesn&#39;t say it raises an exception"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502288169, "post_id": 45593139, "comment_id": 78145752, "body": "Strictly speaking, there are no runtime errors in C. Whatever can be compiled can run, but if it invokes <i>undefined behavior</i>, anything could happen"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502288174, "post_id": 45593139, "comment_id": 78145757, "body": "Please copy/paste the output of the program into your question. In other words: what exactly does your program print when the runtime error happends?"}, {"owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 0, "creation_date": 1502288417, "post_id": 45593139, "comment_id": 78145966, "body": "This is not a duplicate, OP&#39;s question is about why the sentence is not showing up. Read more carefully guys."}], "answers": [{"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 0, "creation_date": 1502288784, "post_id": 45593255, "comment_id": 78146276, "body": "@Fabien now it is"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 0, "creation_date": 1502289078, "post_id": 45593255, "comment_id": 78146541, "body": "@Fabien the main question is that which is in title: is the division by zero a runtime error or compile-time error."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 0, "creation_date": 1502289090, "post_id": 45593255, "comment_id": 78146553, "body": "Great answer, but I agree that OP is confused about missing prints, rather than <i>how exactly division by zero is handled</i>."}, {"owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 0, "creation_date": 1502289155, "post_id": 45593255, "comment_id": 78146604, "body": "Yeah I just saw that the title is really confusing and not matching the content of the question. I will remove my DV."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502290881, "post_id": 45593255, "comment_id": 78148063, "body": "&quot;The standard output is line-buffered by default&quot; --&gt; I have not found where C specifies this.  Any citation for this common practice?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502342443, "post_id": 45593255, "comment_id": 78169019, "body": "@chux implementation-specified but OP is clearly using such a system"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 5, "last_activity_date": 1502342476, "last_edit_date": 1502342476, "creation_date": 1502288145, "answer_id": 45593255, "question_id": 45593139, "link": "https://stackoverflow.com/questions/45593139/divison-by-zero-is-it-a-run-time-error-or-compile-time-error/45593255#45593255", "title": "divison by zero; is it a run time error or compile time error?", "body": "<p>The standard output is line-buffered by default <em>on your implementation</em>. <code>printf(\"zero division error\");</code> wrote the characters into the buffer, but the buffer wasn't flushed yet. Add a new-line <code>\\n</code> there or flush the output with <code>fflush(stdout);</code>. If the output is not flushed before your application crashes, the contents of the buffer are lost.</p>\n\n<hr>\n\n<p>As for the error, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.5p5\" rel=\"nofollow noreferrer\">C11 6.5.5p5</a>: </p>\n\n<blockquote>\n  <p>The result of the <code>/</code> operator is the quotient from the division of the first operand by the second; the result of the <code>%</code> operator is the remainder. In both operations, if the value of the second operand is zero, the <strong>behavior is undefined.</strong></p>\n</blockquote>\n\n<p>Some examples of what might happen are given in the standard (<a href=\"http://port70.net/~nsz/c/c11/n1570.html#3.4.3\" rel=\"nofollow noreferrer\">C11 3.4.3</a>):</p>\n\n<blockquote>\n  <p>2 NOTE Possible undefined behavior ranges from <strong>ignoring the situation completely with unpredictable results</strong>, to <strong>behaving during translation or program execution in a documented manner</strong> characteristic of the environment (with or without the issuance of a diagnostic message), to <strong>terminating</strong> a translation or <strong>execution (with the issuance of a diagnostic message)</strong>. </p>\n</blockquote>\n\n<p>So terminating execution with a diagnostic message (which you did) is just one possibility. The C compiler can also refuse to compile the program, or the program when run can set the result to 0, or 42; or ignore the calculation altogether.</p>\n\n<p>When I run the program, I get</p>\n\n<pre><code>% ./a.out \nzsh: floating point exception (core dumped)  ./a.out\n</code></pre>\n\n<p>This corresponds to the program terminating with <code>SIGFPE</code>; while it stands for SIGnal, Floating-Point Exception, the standard says that <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.14p3\" rel=\"nofollow noreferrer\"><code>SIGFPE</code></a> could be raised upon</p>\n\n<blockquote>\n  <p>an erroneous arithmetic operation, such as <strong>zero divide</strong> or an operation\n                     resulting in overflow</p>\n</blockquote>\n\n<p>At the moment when the signal handler is called, it is no longer known what the actual operation was, and so no other diagnostics is printed.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502288809, "post_id": 45593318, "comment_id": 78146305, "body": "The reason for downvotes is incorrect claims like <i>this will crash</i>. Of course, the part about buffering was correct."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502288965, "post_id": 45593318, "comment_id": 78146447, "body": "&quot;\\n will flush the string on stdout&quot; --&gt; <code>&#39;\\n&#39;</code> often flushes a buffer, yet <code>stdout</code> is not specified to be <i>line</i> buffered.  Best to use <code>fflush(stdout);</code>"}, {"owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 0, "creation_date": 1502289021, "post_id": 45593318, "comment_id": 78146500, "body": "In his context, the application receives an unhandled signal, so it will crash :-/ He even states that it crashes. the answer cannot be too general. I removed that part to satisfy reviewers."}], "tags": [], "owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "is_accepted": false, "score": 2, "last_activity_date": 1502288638, "last_edit_date": 1502288638, "creation_date": 1502288317, "answer_id": 45593318, "question_id": 45593139, "link": "https://stackoverflow.com/questions/45593139/divison-by-zero-is-it-a-run-time-error-or-compile-time-error/45593318#45593318", "title": "divison by zero; is it a run time error or compile time error?", "body": "<p>Everybody downvote like crazy, without even taking time to read your question, so I repost and hope that people will take time to read better, both question and answers.</p>\n\n<p>Your question is why the sentence <code>zero divison error</code> does not show, because you <code>printf()</code> it before dividing by zero.</p>\n\n<p><strong>The answer is:</strong></p>\n\n<p>Data sent to stdout are buffered, and you did not provide any newline character at end of string so the line stayed buffered before the application crash.</p>\n\n<p>Use <code>fflush(stdout);</code> to flush <code>stdout</code> before dividing by zero, or add a <code>\\n</code> and it will show up correctly.</p>\n\n<p><strong>Code reviewed:</strong></p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int p=0;int a=2;\n    // This will show: the \\n will flush the string on stdout\n    printf(\"zero divison error\\n\");\n    // This might not show, the operation can fail before the call to printf()\n    printf(\"%d\",a/p);\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8163609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/244e161bc0b064ff29697210bd902521?s=128&d=identicon&r=PG&f=1", "display_name": "Maverick_284", "link": "https://stackoverflow.com/users/8163609/maverick-284"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3858, "favorite_count": 2, "closed_date": 1502289408, "answer_count": 2, "score": -3, "last_activity_date": 1502342476, "creation_date": 1502287868, "last_edit_date": 1502288749, "question_id": 45593139, "link": "https://stackoverflow.com/questions/45593139/divison-by-zero-is-it-a-run-time-error-or-compile-time-error", "closed_reason": "Duplicate", "title": "divison by zero; is it a run time error or compile time error?", "body": "<p>While running this code I am getting a floating point exception.</p>\n\n<p>Why was the text <code>zero divison error</code> not printed? It should have been printed because <code>printf(\"zero divison error\")</code> is executed <em>before</em> the division by zero happens.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int p=0;int a=2;\n    printf(\"zero divison error\");\n    printf(\"%d\",a/p);\n    // why zero divison error is not printed? \n    // i am getting floating point exception(core dumped).\n}\n</code></pre>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 712, "user_id": 4009370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b92c9a656d5274db5b46d2341ea468?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sprague", "link": "https://stackoverflow.com/users/4009370/chris-sprague"}, "edited": false, "score": 2, "creation_date": 1502287332, "post_id": 45592896, "comment_id": 78145049, "body": "Don&#39;t forget to free the memory you used... <code>if (num) free(num);</code> at the end of your function <code>f</code> might be useful."}, {"owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "reply_to_user": {"reputation": 712, "user_id": 4009370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b92c9a656d5274db5b46d2341ea468?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sprague", "link": "https://stackoverflow.com/users/4009370/chris-sprague"}, "edited": false, "score": 0, "creation_date": 1502287397, "post_id": 45592896, "comment_id": 78145103, "body": "@ChrisSprague at end of function call?"}, {"owner": {"reputation": 712, "user_id": 4009370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b92c9a656d5274db5b46d2341ea468?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sprague", "link": "https://stackoverflow.com/users/4009370/chris-sprague"}, "reply_to_user": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "edited": false, "score": 0, "creation_date": 1502287465, "post_id": 45592896, "comment_id": 78145169, "body": "@Steephen sure, I think it fits right after the line <code>int x = num-&gt;B;</code> since we&#39;re done using <code>num</code> there, right?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1502287858, "post_id": 45592896, "comment_id": 78145491, "body": "You can not pass a member (identifier) name as a function argument. Instead, use a macro function or pass a relative address with <code>offsetof</code>. In addition, the structure definition must be outside the function."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1502287923, "post_id": 45592896, "comment_id": 78145543, "body": "<a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">Read this</a>. I think you are trying to solve the wrong problem."}, {"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 0, "creation_date": 1502288263, "post_id": 45592896, "comment_id": 78145838, "body": "You can - with macros, some dirty pointer arithmetic, and ugly typecasts. Not recommended, however. Can you tell us in which context you would this function? Maybe there&#39;s a cleaner workaround."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "reply_to_user": {"reputation": 712, "user_id": 4009370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b92c9a656d5274db5b46d2341ea468?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sprague", "link": "https://stackoverflow.com/users/4009370/chris-sprague"}, "edited": false, "score": 0, "creation_date": 1502288370, "post_id": 45592896, "comment_id": 78145927, "body": "@ChrisSprague - You do not need the if - <code>free</code> works when NULL is passed to it"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502288397, "post_id": 45592896, "comment_id": 78145951, "body": "Why do you want to do this? This looks like an <a href=\"http://xyproblem.info\" rel=\"nofollow noreferrer\">XY Problem</a> to me"}, {"owner": {"reputation": 712, "user_id": 4009370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b92c9a656d5274db5b46d2341ea468?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Sprague", "link": "https://stackoverflow.com/users/4009370/chris-sprague"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1502288445, "post_id": 45592896, "comment_id": 78145989, "body": "@EdHeal true, though technically <code>num</code> should have been checked immediately after the call to <code>malloc</code>... :p"}, {"owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502289102, "post_id": 45592896, "comment_id": 78146563, "body": "Sorry for being unclear. I just want f() to be reusable."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1502290385, "post_id": 45592896, "comment_id": 78147609, "body": "Why are you using a struct and why can&#39;t you use enums? What is the actual problem you are trying to solve?"}, {"owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502294339, "post_id": 45592896, "comment_id": 78150566, "body": "Thanks everybody, the problem is solved."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1502288280, "post_id": 45593238, "comment_id": 78145851, "body": "But this is a really bad idea, instead <code>int z = get_b(struct_instance);</code> and it would be clear an simple. I think the OP wants to do something else that is not related to this question."}, {"owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1502288427, "post_id": 45593238, "comment_id": 78145971, "body": "The OP obviously posted a example that is simpler than his actual code. This code structure is useful for introspection."}, {"owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502293751, "post_id": 45593238, "comment_id": 78150200, "body": "Thank you. Your solution is helpful to me"}], "tags": [], "owner": {"reputation": 5362, "user_id": 2430669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2656586be6c90ef0666a391f1114628b?s=128&d=identicon&r=PG", "display_name": "Micha&#235;l Roy", "link": "https://stackoverflow.com/users/2430669/micha%c3%abl-roy"}, "is_accepted": false, "score": 0, "last_activity_date": 1502288327, "last_edit_date": 1502288327, "creation_date": 1502288107, "answer_id": 45593238, "question_id": 45592896, "link": "https://stackoverflow.com/questions/45592896/access-struct-member-by-an-argument-of-function-in-c/45593238#45593238", "title": "Access struct member by an argument of function in C", "body": "<p>Yes.  you need to define some way to access to member desired, this is usually done with constants, or an enum.  As an aside, you should always check the pointer returned by malloc() before using it.</p>\n\n<pre><code>#define  GET_A (0)\n#define  GET_B (1)\n\nint f(int selector){\n\n    struct NUMBER {     \n        int A;\n        int B;     \n    };\n\n    int result;\n    struct NUMBER *num = malloc(sizeof(struct NUMBER));\n    if (!num)\n        return -1;  // or some other error code...    \n\n    num -&gt; A = 1;\n    num -&gt; B = 2;\n\n    switch(selector)\n    {\n    case GET_A: result = num-&gt;A; break;\n    case GET_B: result = num-&gt;B; break;\n    // etc... if you have more members in your struct.\n    default:    result = -1; break;      // some error code.\n    }\n\n    free(num)\n    return result;\n}\n\nint main(){\n\n    int z = f(GET_B);\n    printf(  \"%d\\n\" , f(GET_B));\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502293736, "post_id": 45593330, "comment_id": 78150187, "body": "Thank you. Your solution is helpful to me."}, {"owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "reply_to_user": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502296000, "post_id": 45593330, "comment_id": 78151560, "body": "I&#39;m very glad to help!"}], "tags": [], "owner": {"reputation": 13866, "user_id": 54200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6261c8ab215b8069e8290516c80445d8?s=128&d=identicon&r=PG", "display_name": "KevinDTimm", "link": "https://stackoverflow.com/users/54200/kevindtimm"}, "is_accepted": true, "score": 2, "last_activity_date": 1502288349, "creation_date": 1502288349, "answer_id": 45593330, "question_id": 45592896, "link": "https://stackoverflow.com/questions/45592896/access-struct-member-by-an-argument-of-function-in-c/45593330#45593330", "title": "Access struct member by an argument of function in C", "body": "<p>Not at all elegant, but I think it shows you what you need to do/know.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct NUMBER {\n    int A;\n    int B;\n};\n\nstruct NUMBER extNumber = {1, 2};\n\nint f(int offset) {\n\n    int iRet = -1;\n\n    if (offset == offsetof(struct NUMBER, A)) {\n        iRet = extNumber.A;\n    } else if (offset == offsetof(struct NUMBER, B)) {\n        iRet = extNumber.B;\n    }\n\n    return iRet;\n}\n\nint main (int argc, char **argv) {\n\n    struct NUMBER number;\n\n    int iVal;\n\n    iVal = f(offsetof(struct NUMBER, A));\n    printf (\"A : %d\\n\", iVal);\n    iVal = f(offsetof(struct NUMBER, B));\n    printf (\"B : %d\\n\", iVal);\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "edited": false, "score": 0, "creation_date": 1502293756, "post_id": 45594064, "comment_id": 78150204, "body": "Thank you. Your solution is helpful to me"}], "tags": [], "owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1502290256, "creation_date": 1502290256, "answer_id": 45594064, "question_id": 45592896, "link": "https://stackoverflow.com/questions/45592896/access-struct-member-by-an-argument-of-function-in-c/45594064#45594064", "title": "Access struct member by an argument of function in C", "body": "<p>As far as I understand your problem, the cleanest and most \"C-like\" solution is to pass a pointer to your struct to f(), where you populate it:</p>\n\n<pre><code>typedef struct _NUMBER\n    {\n    int A;\n    int B;\n    }\nNUMBER;\n\nvoid f (NUMBER* pvNumber)\n    {\n    pvNumber-&gt;A = 1;\n    pvNumber-&gt;B = 2;\n    return;\n    }\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>int main ()\n    {\n    NUMBER vNumber;\n    int    z;\n\n    f (&amp;vNumber);\n    z = vNumber.A; // or vNumber.B\n    return 0;\n    }\n</code></pre>\n\n<p>So you don't select the desired member inside f(), but outside of it.</p>\n"}, {"tags": [], "owner": {"reputation": 322, "user_id": 1974707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a271d991e6b79402cdfc7be10e9c441?s=128&d=identicon&r=PG", "display_name": "Vikas Yadav", "link": "https://stackoverflow.com/users/1974707/vikas-yadav"}, "is_accepted": false, "score": 2, "last_activity_date": 1510888697, "last_edit_date": 1510888697, "creation_date": 1502293899, "answer_id": 45595385, "question_id": 45592896, "link": "https://stackoverflow.com/questions/45592896/access-struct-member-by-an-argument-of-function-in-c/45595385#45595385", "title": "Access struct member by an argument of function in C", "body": "<blockquote>\n  <p>Can I access struct member by an argument of function?</p>\n</blockquote>\n\n<p>I think you are also assuming struct is not visible outside the function. Now if the person who wrote main does not have visibility into the function (say it is part of a library), then the answer is NO.</p>\n\n<p>Otherwise if author of main can see internals of the function, then: Can someone come up with a fancy way to access struct member inside the function via function argument? Towards that lets think what does f(A) mean? Here, A is a name of struct member, so do you mean passing char A to f and translating that to struct member inside f [e.g. <code>result = *(int *)num+(inchar-'A')</code> where <code>inchar</code> is aninput parameter to the function of type char]. Similarly, one can imagine other ways.</p>\n"}], "owner": {"reputation": 33, "user_id": 5033474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BxdnM.jpg?s=128&g=1", "display_name": "Rocky Tseng", "link": "https://stackoverflow.com/users/5033474/rocky-tseng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 45593330, "answer_count": 4, "score": 2, "last_activity_date": 1510888697, "creation_date": 1502287218, "last_edit_date": 1502331358, "question_id": 45592896, "link": "https://stackoverflow.com/questions/45592896/access-struct-member-by-an-argument-of-function-in-c", "title": "Access struct member by an argument of function in C", "body": "<pre><code>int f(){\n    struct NUMBER {     \n        int A;\n        int B;     \n    };\n\n    struct NUMBER *num = malloc(sizeof(struct NUMBER));\n\n    num-&gt;A = 1;\n    num-&gt;B = 2;\n\n    int x = num-&gt;B;\n\n    return x;\n}\n\n\nint main(){\n    int z = f();\n    printf(\"%d\\n\", z);   \n}\n</code></pre>\n\n<p>Obviously, ./a.out will show <code>2</code>.</p>\n\n<p>My question: Can I access struct member by an argument of function? i.e. <code>f(A)</code> return <code>1</code>, and <code>f(B)</code> return <code>2</code>. Thanks a lot.</p>\n"}, {"tags": ["c", "go"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 7, "last_activity_date": 1502287799, "last_edit_date": 1502287799, "creation_date": 1502287153, "answer_id": 45592870, "question_id": 45592817, "link": "https://stackoverflow.com/questions/45592817/how-to-send-a-slice-to-a-function-in-go/45592870#45592870", "title": "How to send a slice to a function in Go?", "body": "<p>The parameters that specify a length (e.g. <code>[SharedKeyBytes]byte</code>) are arrays, not slices; therefor, you cannot pass a slice, hence the type mismatch error. You can either:</p>\n\n<ul>\n<li>Change the parameter type to slice (<code>[]byte</code>)</li>\n<li>Copy the slice to an appropriately-sized array prior to calling the function, then pass the array to the function instead of the slice (<a href=\"https://play.golang.org/p/KEr23NVvUo\" rel=\"noreferrer\">playground example</a>)</li>\n</ul>\n"}], "owner": {"reputation": 3242, "user_id": 6360938, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/ae1e709f8e8beb1d09db43a881c97610?s=128&d=identicon&r=PG&f=1", "display_name": "typos", "link": "https://stackoverflow.com/users/6360938/typos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 45592870, "answer_count": 1, "score": 0, "last_activity_date": 1502287799, "creation_date": 1502287032, "question_id": 45592817, "link": "https://stackoverflow.com/questions/45592817/how-to-send-a-slice-to-a-function-in-go", "title": "How to send a slice to a function in Go?", "body": "<p>I'm rewriting some C code in Go. And in my C code I have stuff like this:</p>\n\n<pre><code>static void sharedb(unsigned char *sharedkey, unsigned char *send,\n                    const unsigned char *received) {\n    unsigned char krq[96]; \n    unsigned char buf[64];\n    // rest removed for brevity\n\n    indcpa_enc(send, buf, received, krq + 32);\n}\n</code></pre>\n\n<p>Where <code>indcpa_enc</code> function is defined like this:</p>\n\n<pre><code>static void indcpa_enc(unsigned char *c,\n                       const unsigned char *m,\n                       const unsigned char *pk,\n                       const unsigned char *coins)\n</code></pre>\n\n<p>So, in my Go code instead of using <code>char</code> arrays I used <code>byte</code> arrays. Where I have something like this:</p>\n\n<pre><code>func SharedB(sharedKey, send, received []byte) {\n    var krq [96]byte\n    var buf [64]byte\n\n    // rest removed for brevity\n\n    INDCPAEnc(send[:], buf[:SharedKeyBytes], received[:], krq[32:32+CoinBytes])\n}\n</code></pre>\n\n<p>Where <code>INDCPAEnc</code> function is defined like this:</p>\n\n<pre><code>func INDCPAEnc(c []byte, m [SharedKeyBytes]byte, pk []byte, coins [CoinBytes]byte) \n</code></pre>\n\n<p>Though, this function call in Go gives me an array, regarding type mismatch. How can I convert a C code like above to a proper Go code? Also, should I use the pointer notation <code>*</code> for my Go function parameters as in C?</p>\n"}, {"tags": ["c", "linux", "unix", "filesystems", "disk"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502286155, "post_id": 45592354, "comment_id": 78144038, "body": "<code>du &#47;dev&#47;sdb</code> should say <b>0</b>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502286192, "post_id": 45592354, "comment_id": 78144076, "body": "Remember that disk-sizes are usually in multiples of 1000, while file-sizes are in multiples of 1024. Have you checked for that discrepancy?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502286295, "post_id": 45592354, "comment_id": 78144170, "body": "@Someprogrammerdude pebkac error."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502286374, "post_id": 45592354, "comment_id": 78144226, "body": "@Someprogrammerdude Those 2.4% are peanuts. There would still be a factor of &gt;20 between 20GB of available disk space and 945MB of writable data."}], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "edited": false, "score": 0, "creation_date": 1502287203, "post_id": 45592505, "comment_id": 78144938, "body": "Then what about <code>cat</code> failing? and how to access the disk practically? Amusing after I cleanup the file /dev/sdb and reboot and see the RAW disk at /dev/sdb and <code>du</code> returns <code>0</code>"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "edited": false, "score": 0, "creation_date": 1502287544, "post_id": 45592505, "comment_id": 78145229, "body": "&quot;what about cat failing&quot; The partition where <code>&#47;dev</code> resides had 945 MiB free space. When you <code>cat &gt;</code> into it, the file is first truncated to size 0, then 945 MiB is written and you run out of space."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 1, "last_activity_date": 1502287875, "last_edit_date": 1502287875, "creation_date": 1502286277, "answer_id": 45592505, "question_id": 45592354, "link": "https://stackoverflow.com/questions/45592354/c-write-fails-while-writing-to-a-raw-disk-after-specific-size-limit-reached/45592505#45592505", "title": "C : write() fails while writing to a RAW disk after specific size limit reached", "body": "<p><code>du /dev/sdb</code> should say <strong>0</strong> if <code>/dev/sdb</code> is a block device. Try also <code>blockdev --report /dev/sdb</code>.</p>\n\n<p>What happened is that <strong>in the begining you didn't have a device file named <code>/dev/sdb</code> at all</strong>, and you created a <em>regular</em> file named <code>/dev/sdb</code>,\ncopied 945 MiB into it. This filled the partition on which <code>/dev/</code> is located, and thus you get the error. <code>fdisk</code> just reads the partition table that is contained in the first 945 MiB and thinks it sees a hard disk of 20 GiB.</p>\n\n<p>When you do <code>cat mylargefile &gt; /dev/sdb</code>, the <em>file</em> <code>/dev/sdb</code> is first truncated to size 0, so there is now 945 MiB free space again that <code>cat</code> will proceed to fill.</p>\n\n<hr>\n\n<p>To avoid this: make sure that you open a device by its correct name. In C open the device <em>without</em> <code>O_CREAT</code>.</p>\n"}], "owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 45592505, "answer_count": 1, "score": -2, "last_activity_date": 1502287875, "creation_date": 1502285910, "question_id": 45592354, "link": "https://stackoverflow.com/questions/45592354/c-write-fails-while-writing-to-a-raw-disk-after-specific-size-limit-reached", "title": "C : write() fails while writing to a RAW disk after specific size limit reached", "body": "<p>I am using a C program <code>open(), close(), read(), write()</code> technique to copy a large file to RAW disk. The disk size is 20 GB and the file size is 17 GB but, every time  after around writing 945 MB <code>write()</code> throws <code>No space left on device</code> error.</p>\n\n<p>I have run <code>fdisk -l /dev/sdb</code> and returns 20.5 GB and <code>du /dev/sdb</code> says <code>945126569</code></p>\n\n<p>Then I tried, <code>cat mylargefile &gt; /dev/sdb</code> it too throws same <code>No space left on device</code> error and then I do <code>cat /dev/sdb &gt; /tmp/sdb.img</code> it completes normally. Then I do <code>ls -ld /tmp/sdb.img</code> it responds <code>945126569</code></p>\n\n<p>I can use the same disk to create <code>ext4</code> file system and format it without any issues, so disk error is improbable. (I guess ...)</p>\n\n<p>I am using Ubuntu 16.04 LTS amd64 OS with latest GCC to build my program.</p>\n\n<p>Can anyone suggest where am I going wrong or what needs to be done to avoid this?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1502284868, "post_id": 45591891, "comment_id": 78142888, "body": "You are setting your <code>i</code> to <code>0</code> in <i>each</i> iteration."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1502284876, "post_id": 45591891, "comment_id": 78142894, "body": "Surely the <code>i = 0</code>should go outside the loop, no?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1502284896, "post_id": 45591891, "comment_id": 78142915, "body": "Rest of the logic is weird too."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1502284915, "post_id": 45591891, "comment_id": 78142936, "body": "Why are you taking <code>a</code> as a parameter if you just overwrite it in the first line with <code>scanf</code> anyway?"}, {"owner": {"reputation": 11, "user_id": 8440047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a895212c09c1f36d3659f74d627e643b?s=128&d=identicon&r=PG&f=1", "display_name": "I. M.", "link": "https://stackoverflow.com/users/8440047/i-m"}, "edited": false, "score": 0, "creation_date": 1502284973, "post_id": 45591891, "comment_id": 78142998, "body": "oh that&#39;s so helpful! I put it outside the loop, and while the code still isn&#39;t working, I think I&#39;m heading in the right direction!"}, {"owner": {"reputation": 1611, "user_id": 3048431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08562dbbcdff327f66323f3eeea69b0?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz", "link": "https://stackoverflow.com/users/3048431/oguz"}, "edited": false, "score": 0, "creation_date": 1502284987, "post_id": 45591891, "comment_id": 78143018, "body": "Index starts with 0 so if you add 0 to your array, everything will be normal. array[11] = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "reply_to_user": {"reputation": 1611, "user_id": 3048431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08562dbbcdff327f66323f3eeea69b0?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz", "link": "https://stackoverflow.com/users/3048431/oguz"}, "edited": false, "score": 1, "creation_date": 1502285126, "post_id": 45591891, "comment_id": 78143141, "body": "@Oguz: That will certainly give you an &quot;excess elements in initializer&quot; warning. <code>:)</code> (Plus you can&#39;t initialize VLAs.)"}, {"owner": {"reputation": 1611, "user_id": 3048431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08562dbbcdff327f66323f3eeea69b0?s=128&d=identicon&r=PG&f=1", "display_name": "Oguz", "link": "https://stackoverflow.com/users/3048431/oguz"}, "edited": false, "score": 0, "creation_date": 1502285253, "post_id": 45591891, "comment_id": 78143245, "body": "Ugh, you are definitely right. I corrected it. :)"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502285556, "post_id": 45591891, "comment_id": 78143509, "body": "like <a href=\"http://ideone.com/GnQB5U\" rel=\"nofollow noreferrer\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 0, "creation_date": 1502286266, "post_id": 45591937, "comment_id": 78144143, "body": "If the entered size is 0, you&#39;ll write past the array."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1502286402, "last_edit_date": 1502286402, "creation_date": 1502284906, "answer_id": 45591937, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45591937#45591937", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>First and foremost, the print statement</p>\n\n<pre><code> printf(\"Resulting array is %d\", array[a]);\n</code></pre>\n\n<p>is wrong!! That's not how you print an array. You need to loop over the index, get the individual elements and print them.</p>\n\n<p>Moreover, when you try using <code>array[a]</code>, think of the value for <code>a</code>. That's surely <em>not</em> what you want.</p>\n\n<p>That said, there are other issues, like setting <code>i</code> to <code>0</code> in each iteration of <code>do...while</code> loop. That will lose the previously calculated value and start over. Move the initial assignment outside the loop body.</p>\n\n<p>A slightly modified version, follow the comments</p>\n\n<pre><code>#include  &lt;stdio.h&gt;\n\nint count (void)                 // no need for parameter if you're asking user for size\n{\n   int size = 0;                 //define size\n   int ret = scanf(\"%d\", &amp;size); //read it\n\n   if ( (ret != 1) || ( size &lt; 1) ) return -1;      //error check\n\n   int i = 0;                    //initialize local variables\n\n   int array[size];              //note: this is VLA\n\n   do\n   {\n       array[i] = i+1;           //start populating elements\n       i++;\n   }\n   while (size &gt; i);             //go on unless you've reached the given size\n\n   puts (\"Resulting array is\");   // start printing ....\n\n   for (i = 0; i &lt; size; i++)\n   {\n       printf(\"%d\\t\", array[i]);   //...them one by one\n   }\n\n   return 0;\n}\n\nint main(void)\n{\n    (void)count();  //call the function\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 193, "user_id": 7127559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acb0b3fa135001026043216781f724d0?s=128&d=identicon&r=PG&f=1", "display_name": "colmlg", "link": "https://stackoverflow.com/users/7127559/colmlg"}, "is_accepted": false, "score": 3, "last_activity_date": 1502285156, "creation_date": 1502285156, "answer_id": 45592044, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592044#45592044", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>You should use a for loop to create your array.</p>\n\n<pre><code>int i;\nint array[a];\nfor(i = 0; i &lt; a; i++) {\n  array[i] = i + 1;\n}\n\nreturn 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "edited": false, "score": 1, "creation_date": 1502285378, "post_id": 45592051, "comment_id": 78143353, "body": "I think it would be best if the logic from printing was separated from the logic of generation the array."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1502285585, "post_id": 45592051, "comment_id": 78143529, "body": "<code>return array;</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 5, "creation_date": 1502285742, "post_id": 45592051, "comment_id": 78143676, "body": "This is just wrong, the pointer returned will be meaningless and trying to use it will be <b>undefined behavior</b>."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 0, "creation_date": 1502285767, "post_id": 45592051, "comment_id": 78143703, "body": "And that&#39;s not the signature of the original function anyway"}, {"owner": {"reputation": 5703, "user_id": 4899193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b65fc5fb7ab727d1f770206d6b5325?s=128&d=identicon&r=PG", "display_name": "Usagi Miyamoto", "link": "https://stackoverflow.com/users/4899193/usagi-miyamoto"}, "edited": false, "score": 0, "creation_date": 1502285837, "post_id": 45592051, "comment_id": 78143767, "body": "Well, creating an array inside a function, then not using or returning it, seems somewhat unnecessary..."}, {"owner": {"reputation": 609, "user_id": 7690030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11846ade17a8760f2501ab72fcc1f37?s=128&d=identicon&r=PG", "display_name": "Martin Chekurov", "link": "https://stackoverflow.com/users/7690030/martin-chekurov"}, "edited": false, "score": 0, "creation_date": 1502286092, "post_id": 45592051, "comment_id": 78143986, "body": "int array[a]; won&#39;t compile everywhere so i think using malloc is better"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502286205, "post_id": 45592051, "comment_id": 78144092, "body": "@UsagiMiyamoto still you can&#39;t return it: returning arrays in C is not possible, a pointer will be returned instead. And as it has <i>automatic</i> storage duration, it&#39;s <b>gone</b> after your function exits, so the pointer doesn&#39;t point to anything usable (it&#39;s an invalid pointer)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502286329, "post_id": 45592051, "comment_id": 78144197, "body": "@UsagiMiyamoto there are several ways around this, the <b>worst</b> would be to give the array <i>static</i> storage duration by writing a <code>static</code> in front of the declaration. Then it lives for the whole execution time. but that means there&#39;s only one instance ever, so calling the function again modifies the same array. Threading will lead to concurrent accesses."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502286356, "post_id": 45592051, "comment_id": 78144214, "body": "@UsagiMiyamoto the idiomatic C way is to let the caller provide the array and only write to it (you need a means to pass the size to the function for this to work)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502286387, "post_id": 45592051, "comment_id": 78144243, "body": "@UsagiMiyamoto the last option is to create the array with <code>malloc()</code>, this must be explicitly <code>free()</code>d when done, so the caller has to eventually call <code>free()</code> on it."}, {"owner": {"reputation": 609, "user_id": 7690030, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c11846ade17a8760f2501ab72fcc1f37?s=128&d=identicon&r=PG", "display_name": "Martin Chekurov", "link": "https://stackoverflow.com/users/7690030/martin-chekurov"}, "edited": false, "score": 0, "creation_date": 1502286460, "post_id": 45592051, "comment_id": 78144299, "body": "@Felix Palmen isn&#39;t the malloc the right way to do it here since what he have done won&#39;t compile everywhere"}, {"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 0, "creation_date": 1502286664, "post_id": 45592051, "comment_id": 78144500, "body": "...but maybe the array is needed only in the context of this function? In this case it&#39;s ok to use a local variable and throw it away on exit. IMHO we&#39;re thinking too much about a silly example..."}], "tags": [], "owner": {"reputation": 5703, "user_id": 4899193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b65fc5fb7ab727d1f770206d6b5325?s=128&d=identicon&r=PG", "display_name": "Usagi Miyamoto", "link": "https://stackoverflow.com/users/4899193/usagi-miyamoto"}, "is_accepted": false, "score": 0, "last_activity_date": 1502285627, "last_edit_date": 1502285627, "creation_date": 1502285174, "answer_id": 45592051, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592051#45592051", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>Try something like this:</p>\n\n<pre><code>int* count(int a)\n{\n   int array[a];\n   for (int i = 0; i &lt; a; ++i)\n   {\n      array[i] = i + 1;\n   }\n   for (int i = 0; i &lt; a; ++i)\n   {\n      printf(\"%d, \", i + 1);\n   }\n   return array;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 2, "last_activity_date": 1502285454, "last_edit_date": 1502285454, "creation_date": 1502285211, "answer_id": 45592068, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592068#45592068", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>Your <code>do while</code> loop could simply be replaced by the following <code>for</code> loop:</p>\n\n<pre><code>for (i = 0; i &lt; a; i++)\n  array[i] = i + 1;\n</code></pre>\n\n<p>Similarly, for displaying each element in <code>array</code>, you can iterate over the elements of <code>array</code> by means of a <code>for</code> loop:</p>\n\n<pre><code>for (i = 0; i &lt; a; i++) \n  printf(\"Element at %2d is %d\\n\", i, array[i]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "is_accepted": false, "score": 0, "last_activity_date": 1502285299, "creation_date": 1502285299, "answer_id": 45592103, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592103#45592103", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>Just use a simple \"for\" loop:</p>\n\n<pre><code>for (i = 0; i &lt; a; i++)\n    {\n    array [i] = i + 1;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6751, "user_id": 1417063, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mwy5e.jpg?s=128&g=1", "display_name": "Davide Spataro", "link": "https://stackoverflow.com/users/1417063/davide-spataro"}, "is_accepted": false, "score": 0, "last_activity_date": 1502285653, "creation_date": 1502285653, "answer_id": 45592253, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592253#45592253", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<ul>\n<li>You don't really need the <code>a</code> parameter. You can use a local</li>\n<li>the <code>do,while</code> is broken because you set <code>i</code> to <code>0</code> at each iteration and its overly complicated. You can achieve the same result in a much easier way. An element at location <code>i</code> has to have value <code>i+1</code>, easy as it sounds.</li>\n<li>You have to loop over the element of the array to print them all. A single <code>printf</code> prints only <code>1</code> element of the array. If you want them all, then you have to iterate over all of them.</li>\n</ul>\n\n<p>What about something like the following?</p>\n\n<pre><code>void count(){\n   int a,i=0;\n   scanf(\"%d\", &amp;a);\n   int array[a];\n   while(i&lt;a){\n    array[i]=i+1;\n    i++\n   }\n\n   //now print it\n   i=0;\n   while(i&lt;a)\n    printf(\" %d \", array[i++]);\n\n}\n</code></pre>\n\n<hr>\n\n<p>As an aside, note that you are using VLAs. That means there's a limit on the size of the array you can create which depends on your machine+compiler.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 8427358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985f5da043ac26dcb46c1d81ae89ed92?s=128&d=identicon&r=PG&f=1", "display_name": "Vipul Bhardwaj", "link": "https://stackoverflow.com/users/8427358/vipul-bhardwaj"}, "is_accepted": false, "score": 0, "last_activity_date": 1502286161, "creation_date": 1502286161, "answer_id": 45592453, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592453#45592453", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>So there are a few bugs here . One that if you are accepting 'a' as a arg to function , why are you scanning it then. It just over writes the value you collected. Two the way you are trying to print the array is wrong as specified above and you should use a loop.  Three , you can save a few lines like , </p>\n\n<pre><code>for(int i =0; i&lt;a ; i++) \n{ \narr[i]=i+1;\n }\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 4, "last_activity_date": 1502286229, "creation_date": 1502286229, "answer_id": 45592479, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592479#45592479", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>An idiomatic C way would be to define a function that <em>fills</em> an existing array:</p>\n\n<pre><code>void count(int *array, int max)\n{\n    for (int i = 0; i &lt; max; ++i)\n    {\n        array[i] = i+1;\n    }\n}\n</code></pre>\n\n<p>You can call it e.g. like this:</p>\n\n<pre><code>int arr[10];\ncount(arr, 10);\nfor (int i = 0; i &lt; 10; ++i)\n{\n    printf(\"%d \", arr[i]);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1502287730, "last_edit_date": 1502287730, "creation_date": 1502287339, "answer_id": 45592928, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c/45592928#45592928", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<blockquote>\n  <p>I'm trying to code a function that will make an array of consecutive\n  numbers from 1 up to a number n.</p>\n</blockquote>\n\n<p>In C++ there is already such a function that is named <code>iota</code> and declared in the header <code>&lt;numeric&gt;</code>.</p>\n\n<p>In C such a function can look the following way</p>\n\n<pre><code>void iota(int a[], size_t n, int value)\n{\n    for (size_t i = 0; i &lt; n; i++) a[i] = value++;\n}\n</code></pre>\n\n<p>Here is a demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid iota(int a[], size_t n, int value)\n{\n    for (size_t i = 0; i &lt; n; i++) a[i] = value++;\n}\n\nint main(void) \n{\n    size_t n = 1;\n\n    scanf( \"%zu\", &amp;n );\n\n    int a[n];\n\n    iota( a, n, 1 );\n\n    for ( size_t i =0; i &lt; n; i++ ) printf( \"%d \", a[i] );\n    putchar( '\\n' );\n\n    return 0;\n}\n</code></pre>\n\n<p>If to enter <code>10</code> then the output will look like</p>\n\n<pre><code>1 2 3 4 5 6 7 8 9 10\n</code></pre>\n\n<p>As for your program then in this loop</p>\n\n<pre><code>do\n{\n    i = 0;\n    a = a - i;\n    array[a - 1] = a;\n    i++;\n}\nwhile (a &gt; 0);\n</code></pre>\n\n<p>the variable <code>a</code> is not being changed because in the beginning of each iteration the variable <code>i</code> is set to 0.</p>\n\n<p>You could write the loop like</p>\n\n<pre><code>i = 0;\ndo\n{\n    array[a - i - 1] = a - i;\n    i++;\n} while ( i != a );\n</code></pre>\n\n<p>Take into account that this statement</p>\n\n<pre><code>printf(\"Resulting array is %d\", array[a]);\n</code></pre>\n\n<p>does not make sense. If you are going to output an array element by element you have to use a loop as for example it is shown in the demonstrative program above.</p>\n"}], "owner": {"reputation": 11, "user_id": 8440047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a895212c09c1f36d3659f74d627e643b?s=128&d=identicon&r=PG&f=1", "display_name": "I. M.", "link": "https://stackoverflow.com/users/8440047/i-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6373, "favorite_count": 0, "answer_count": 9, "score": 1, "last_activity_date": 1502287730, "creation_date": 1502284796, "last_edit_date": 1502285895, "question_id": 45591891, "link": "https://stackoverflow.com/questions/45591891/create-an-array-of-consecutive-numbers-from-1-to-n-in-c", "title": "Create an array of consecutive numbers from 1 to n in C?", "body": "<p>I'm trying to code a function that will make an array of consecutive numbers from <code>1</code> up to a number <code>n</code>. For example, I would expect <code>array[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}</code>. My code doesn't seem to be running but I don't exactly know why. </p>\n\n<pre><code>int count (int a)\n{\n   scanf(\"%d\", &amp;a);\n   int i;\n   int array[a];\n   do\n   {\n      i = 0;\n      a = a - i;\n      array[a - 1] = a;\n      i++;\n   }\n   while (a &gt; 0);\n   printf(\"Resulting array is %d\", array[a]);\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "visual-studio", "dll"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502283995, "post_id": 45591525, "comment_id": 78142155, "body": "Are you using an IDE (like Visual Studio or similar)? Then add the files as source files like any other source file in your project."}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502285257, "post_id": 45591525, "comment_id": 78143252, "body": "I tried that, but with no references to the functions, the resulting .dll is just empty."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502285332, "post_id": 45591525, "comment_id": 78143309, "body": "Do you <i>export</i> the functions that the API in the DLL provides? Perhaps you should read a few tutorials about creating a DLL first?"}, {"owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502290151, "post_id": 45591525, "comment_id": 78147423, "body": "OK, that seems to work (using __declspec( dllimport )  ).  (Not many tutorials using C."}, {"owner": {"reputation": 1031, "user_id": 6763393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c44926355c84effac26e3a3f1582405a?s=128&d=identicon&r=PG&f=1", "display_name": "stanthomas", "link": "https://stackoverflow.com/users/6763393/stanthomas"}, "edited": false, "score": 1, "creation_date": 1502291963, "post_id": 45591525, "comment_id": 78148888, "body": "See <a href=\"https://stackoverflow.com/questions/39358641\">stackoverflow.com/questions/39358641</a> for a discussion of __declspec(dllimport) and __declspec(dllexport). Classes or functions, c++ or c, the directive works the just the same."}], "owner": {"reputation": 4974, "user_id": 2587816, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d0ec5b10cbc8a9a5b707ea67ea60f84d?s=128&d=identicon&r=PG", "display_name": "Jiminion", "link": "https://stackoverflow.com/users/2587816/jiminion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502283904, "creation_date": 1502283904, "question_id": 45591525, "link": "https://stackoverflow.com/questions/45591525/how-do-you-source-a-c-dll-using-two-source-files-with-visual-studio", "title": "How do you source a C .dll using two source files with Visual Studio?", "body": "<p>I have two source files that contain routines I want in my .dll.\nI can build the .dll, but I have to do something like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"routines1.h\"\n#include \"routines2.h\"\n#include \"routines1.c\"\n#include \"routines2.c\"\n</code></pre>\n\n<p>This works, but it is very ugly and I am sure it must be wrong.  I am more familiar with building libraries in Linux wherein adding files together is less problematic.  I am working in C.</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1502283269, "post_id": 45591248, "comment_id": 78141555, "body": "Put the characters into a buffer and display the whole buffer and the end. There are no other options AFAIK"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1502283345, "post_id": 45591248, "comment_id": 78141620, "body": "A fix that doesn&#39;t require changing the program is to write your input to a text file and then redirect that to your program as input, e.g. <code>a.out &lt; input.txt</code>. That has the advantage that you don&#39;t have to retype the input when you test your program."}, {"owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1502283500, "post_id": 45591248, "comment_id": 78141748, "body": "@MOehm Yeah, it is working fine without any extra space, but is it possible to do stuff using terminal itself?"}, {"owner": {"reputation": 2946, "user_id": 1254880, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/88115806b7eaa034f2040704798fd481?s=128&d=identicon&r=PG", "display_name": "Tarc", "link": "https://stackoverflow.com/users/1254880/tarc"}, "edited": false, "score": 2, "creation_date": 1502283661, "post_id": 45591248, "comment_id": 78141873, "body": "This has to do with buffering. Check this: <a href=\"https://stackoverflow.com/q/1798511/1254880\">stackoverflow.com/q/1798511/1254880</a>"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502284270, "post_id": 45591418, "comment_id": 78142384, "body": "Don&#39;t write plain <code>main()</code>; it should be <code>int main()</code> at minimum and <code>int main(void)</code> for preference. That&#39;s been a standard requirement for all of this millennium."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502284326, "post_id": 45591418, "comment_id": 78142433, "body": "@JonathanLeffler Though OP is reading a book from the last millennium..."}], "tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 1, "last_activity_date": 1502284309, "last_edit_date": 1502284309, "creation_date": 1502283593, "answer_id": 45591418, "question_id": 45591248, "link": "https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline/45591418#45591418", "title": "Delay output till EOF rather than newline", "body": "<p>As already mentioned <a href=\"https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline#comment78141555_45591248\">in the comments</a>: put the characters into a buffer and display the whole buffer at the end:</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n\n #define BUF_SIZE 1024\n\n int main()\n {\n      char str[BUF_SIZE]; // the buffer\n      int c, i = 0;\n\n      while (i &lt; BUF_SIZE-1 &amp;&amp; (c = getchar()) != EOF)\n         str[i++] = (char) c;\n\n      str[i] = '\\0';\n\n      printf(\"%s\\n\", str); // display the contents of the buffer\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502283801, "post_id": 45591433, "comment_id": 78141991, "body": "Work fine as long as <code>c</code> is not 0.  Likely OK for OP."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502283909, "post_id": 45591433, "comment_id": 78142089, "body": "This code also outputs an extra <code>\\n</code> every 1023 bytes, and an extra one at the very end."}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 2, "last_activity_date": 1502283948, "last_edit_date": 1502283948, "creation_date": 1502283630, "answer_id": 45591433, "question_id": 45591248, "link": "https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline/45591433#45591433", "title": "Delay output till EOF rather than newline", "body": "<p>You need to store these character's to buffer, <strong>control indexes where are you writing</strong> and when you receive <code>EOF</code> just print that buffer via <code>printf</code>.</p>\n\n<p>If you cant solve it you can inspire here</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define BUFFER_SIZE 1024\n\nint main()\n{\n    int c, i = 0;\n    char buffer[BUFFER_SIZE];\n\n    while ((c = getchar()) != EOF)\n    {\n        if (i &lt; BUFFER_SIZE - 1)\n        {\n            buffer[i] = c;\n            i++;\n        }\n        else\n        {\n            buffer[BUFFER_SIZE - 1] = '\\0';\n            printf(\"%s\", buffer);\n            i = 0;\n        }\n    }\n\n    buffer[i] = '\\0';\n    printf(\"%s\", buffer);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502284185, "post_id": 45591469, "comment_id": 78142313, "body": "That&#39;s okay if the file is smaller than the buffer size. Files are sometimes big."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502284695, "post_id": 45591469, "comment_id": 78142730, "body": "I guess the world may have changed. Classically, <code>BUFSIZ</code> was usually 512. Even 8192 isn&#39;t all that big, though it&#39;s much bigger than I tend to think of."}, {"owner": {"reputation": 13578, "user_id": 1328439, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CuI4k.jpg?s=128&g=1", "display_name": "Dmitri Chubarov", "link": "https://stackoverflow.com/users/1328439/dmitri-chubarov"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502285383, "post_id": 45591469, "comment_id": 78143357, "body": "@JonathanLeffler since 1996 BUFSIZ in GNU/linux is 8192. Should be enough for interactive input from the terminal in most cases. I agree, to correctly implement the spec, we need to grow the buffer dynamically."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502299251, "post_id": 45591469, "comment_id": 78153393, "body": "Note: per C11 &quot;<code>BUFSIZ</code> shall be at least 256&quot;.  Smaller values occur these days in many an embedded processor."}], "tags": [], "owner": {"reputation": 13578, "user_id": 1328439, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/CuI4k.jpg?s=128&g=1", "display_name": "Dmitri Chubarov", "link": "https://stackoverflow.com/users/1328439/dmitri-chubarov"}, "is_accepted": false, "score": 1, "last_activity_date": 1502285505, "last_edit_date": 1502285505, "creation_date": 1502283744, "answer_id": 45591469, "question_id": 45591248, "link": "https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline/45591469#45591469", "title": "Delay output till EOF rather than newline", "body": "<p>You could set buffer to <code>stdout</code> with <code>setvbuf(3)</code>.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nmain()\n{\n        int c;\n        char buf[BUFSIZ];\n        setvbuf(stdout,buf,_IOFBF,BUFSIZ);\n        while ((c=getchar())!=EOF)\n                putchar(c);\n}\n</code></pre>\n\n<p>The key here is the fully buffered mode specified with the <code>_IOFBF</code> constant.\nThe size of the buffer is set to <code>BUFSIZ</code> which usually equals 8192.</p>\n\n<p>As was correctly pointed in the comments by Jonathan Leffler the limited size of the buffer may cause the program to suddenly spit out its contents garbling the terminal. To avoid that one could track the utilization of the buffer and extend its size when it gets filled.</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502284242, "post_id": 45591613, "comment_id": 78142359, "body": "You can start with a big <code>size_t</code> value and divide by 2 until it is successful :D"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502284442, "post_id": 45591613, "comment_id": 78142519, "body": "@AnttiHaapala: yes, I could write <code>for (size_t size = ~(size_t)0 &gt;&gt; 1; size; size &gt;&gt;= 1) { if (!setvbuf(stdout, NULL, _IOFBF, size) break; }</code> but that would be too cryptic for the OP&#39;s skill level."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 0, "creation_date": 1502287053, "post_id": 45591613, "comment_id": 78144828, "body": "What about if you dont know how big buffer you need but need program to be efficient ? Allocating amount of bytes doesnt sound very efficient. :-)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502287401, "post_id": 45591613, "comment_id": 78145107, "body": "Buffering the output is just a quick fix that does not provide a full solution to the OP&#39;s problem.  Since it is unlikely he/she would input more than 32K bytes by hand in the terminal, it fits the purpose, but a complete solution would require allocating and reallocating a buffer as input keeps coming and potentially using a temporary file on disk if input exceeds available memory..."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1502287236, "last_edit_date": 1502287236, "creation_date": 1502284120, "answer_id": 45591613, "question_id": 45591248, "link": "https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline/45591613#45591613", "title": "Delay output till EOF rather than newline", "body": "<p>An easy, albeit sloppy and partial solution is to configure <code>stdout</code> to fully buffered with a large buffer:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    int c;\n\n    setvbuf(stdout, NULL, _IOFBF, 32767);\n    while ((c = getchar()) != EOF) {\n        putchar(c);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li>On a 32- or 64-bit system, you could make the buffer ridiculously large.</li>\n<li>Passing <code>NULL</code> to <code>setvbuf</code> lets it allocate the buffer with <code>malloc()</code>.</li>\n</ul>\n"}], "owner": {"reputation": 607, "user_id": 2700041, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/ccf6b1ecad451f2b85c4f23560ce2bed?s=128&d=identicon&r=PG&f=1", "display_name": "hanugm", "link": "https://stackoverflow.com/users/2700041/hanugm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1502287236, "creation_date": 1502283164, "last_edit_date": 1502284227, "question_id": 45591248, "link": "https://stackoverflow.com/questions/45591248/delay-output-till-eof-rather-than-newline", "title": "Delay output till EOF rather than newline", "body": "<p>I am writing a program that copies input to output character by character on Linux terminal. The code is as follows (from Dennis Ritchie's C book)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n/* copy input to output; 2nd version*/\n\nmain()\n{\n   int c;\n   while ((c = getchar()) != EOF)\n      putchar(c);\n}\n</code></pre>\n\n<p>The program and its execution works fine. But I want a slight modification.</p>\n\n<p>The output appears on terminal for each new line character (when I press enter). I want to delay the output till I signal the end of file by pressing <kbd>Ctrl + D</kbd>. What modifications I have to do for the program in-order to delay my output on terminal.</p>\n\n<p>Sample output I am getting is as follows:</p>\n\n<pre><code>abcd (enter)\nabcd\nllefn;elnf(enter)\nllefn;elnf\n(ctrl+d)\n</code></pre>\n\n<p>Sample output I wants to get is as follows:</p>\n\n<pre><code>abcd(enter)\nllefn;elnf(ctrl+d)\nabcd\nllefn;elnf\n</code></pre>\n"}, {"tags": ["javascript", "c", "mariadb", "cryptojs", "crypt"], "comments": [{"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1502282627, "post_id": 45590205, "comment_id": 78141013, "body": "I won&#39;t post it as an answer because I&#39;m not sure, but I suspect crypt(3) uses the <a href=\"https://en.wikipedia.org/wiki/Base64#Radix-64_applications_not_compatible_with_Base64\" rel=\"nofollow noreferrer\">B64 Encoding</a> (see first linked bullet-point). So, in order from 0-63: <code>[.&#47;A-Za-z]</code>, without padding. Converting to and from &quot;the&quot; Base64 is then a simple <code>tr</code> (or equivalent), and adding (or removing) padding."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1502283258, "post_id": 45590205, "comment_id": 78141544, "body": "The encoding <i>isn&#39;t</i> SHA-512 either. It is SHA-based iterated one. SHA alone cannot be used for any kind of secure password hashing at al, salted or not, so <a href=\"https://en.wikipedia.org/wiki/Key_stretching\" rel=\"nofollow noreferrer\">key stretching by iteration is used</a>."}, {"owner": {"reputation": 1252, "user_id": 1970775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/esOOK.png?s=128&g=1", "display_name": "Daniel C", "link": "https://stackoverflow.com/users/1970775/daniel-c"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502286037, "post_id": 45590205, "comment_id": 78143937, "body": "@Tim\u010cas that looks like a very good lead. Seems very likely it is B64 encoding (in no way confusing!). I haven&#39;t fiigured out the necessary transposition but if I take it you right it ought to also be possible to generate the Hex value from the B64."}, {"owner": {"reputation": 1252, "user_id": 1970775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/esOOK.png?s=128&g=1", "display_name": "Daniel C", "link": "https://stackoverflow.com/users/1970775/daniel-c"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502294704, "post_id": 45590205, "comment_id": 78150796, "body": "@Tim\u010cas Source code says you&#39;re right: <a href=\"https://github.com/lattera/glibc/blob/master/crypt/sha512-crypt.c\" rel=\"nofollow noreferrer\">github.com/lattera/glibc/blob/master/crypt/sha512-crypt.c</a>"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 1, "creation_date": 1502367479, "post_id": 45590205, "comment_id": 78185319, "body": "@DanielC: I would say that (if anything) this is a flaw in Base64, not in crypt(3). I can find documentation <a href=\"http://minnie.tuhs.org/cgi-bin/utree.pl?file=V7/usr/man/man3/crypt.3\" rel=\"nofollow noreferrer\">dating 1979 (Version 7 Unix)</a> referencing the B64 encoding --- meaning, B64 most likely predates Base64. Here is a dated source: <a href=\"http://web.cuzuco.com/~cuzuco/v7/v7vol1.pdf\" rel=\"nofollow noreferrer\">PDF version of the manual</a>."}, {"owner": {"reputation": 1252, "user_id": 1970775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/esOOK.png?s=128&g=1", "display_name": "Daniel C", "link": "https://stackoverflow.com/users/1970775/daniel-c"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502382556, "post_id": 45590205, "comment_id": 78197376, "body": "@Tim\u010cas yes absolutely. I&#39;ve just got so used to Base64 that it took me by surprise. Sadly I haven&#39;t got time at the moment to bridge that gap, but I don&#39;t actually have to. I just found it interesting."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502447310, "post_id": 45590205, "comment_id": 78224670, "body": "@DanielC: In Javascript, you can try the approach <a href=\"https://stackoverflow.com/a/10726800/485088\">provided here</a>. A faster approach might be to have a lookup array instead of an object, that is: <code>var mapping = [..., &#39;.&#39;, &#39;&#47;&#39;, &#39;A&#39;, ...];</code> so that <code>mapping[&#39;A&#39;.charCodeAt(0)] == &#39;.&#39;</code>, <code>mapping[&#39;B&#39;.charCodeAt(0)] == &#39;&#47;&#39;</code>, etc. But as usual: when in doubt, profile."}, {"owner": {"reputation": 1252, "user_id": 1970775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/esOOK.png?s=128&g=1", "display_name": "Daniel C", "link": "https://stackoverflow.com/users/1970775/daniel-c"}, "reply_to_user": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502451970, "post_id": 45590205, "comment_id": 78227823, "body": "@Tim\u010cas but since Base64 has padding won&#39;t there have to be a bit of jiggery pokery to handle that?"}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502488912, "post_id": 45590205, "comment_id": 78248068, "body": "@DanielC: Yes, but it&#39;s trivial. The amount of padding required depends only on the <i>length</i> of the Base64 string (not its contents), and can be computed with this formula: <code>(4 - base64_str.length % 4) % 4</code> (n.b.: while this can <i>technically</i> result in 3 characters of padding, it never will, as Base64 never has the length required to do so). For completeness, the formula based on the <i>source</i> length: <code>(3 - source_str.length % 3) % 3</code>."}, {"owner": {"reputation": 9020, "user_id": 485088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d4c2e26c21ecd1e0565915687b8c092?s=128&d=identicon&r=PG", "display_name": "Tim \u010cas", "link": "https://stackoverflow.com/users/485088/tim-%c4%8cas"}, "edited": false, "score": 0, "creation_date": 1502488985, "post_id": 45590205, "comment_id": 78248096, "body": "@DanielC: In other words: <code>base64_str += &#39;=&#39;.repeat((4 - base64_str.length % 4) % 4);</code>. Note, however, that padding is optional (or even forbidden) in some contexts. Also, feel free to use <code>x &amp; 3</code> instead of <code>x % 4</code>."}], "owner": {"reputation": 1252, "user_id": 1970775, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/esOOK.png?s=128&g=1", "display_name": "Daniel C", "link": "https://stackoverflow.com/users/1970775/daniel-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 293, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1502296966, "creation_date": 1502280307, "last_edit_date": 1502296966, "question_id": 45590205, "link": "https://stackoverflow.com/questions/45590205/different-outputs-from-crypt3-and-cryptojs", "title": "Different outputs from Crypt(3) and CryptoJS", "body": "<p>I am hashing passwords in MariaDB using:</p>\n\n<p><code>ENCRYPT('password', CONCAT('$6$', SUBSTRING(SHA(RAND()), -16))</code></p>\n\n<p>Which produces something like:</p>\n\n<p><code>$6$3b502db443d64283$BNSYWsf3T0e4xT23GJW/QPpKvzLidio5zk9v7kCE.wk4dtNo4avMzBxvqoWc0Y5ihj/zVwtGCwZRfTFur0BnI1</code></p>\n\n<p>The format here is <code>$6</code> meaning SHA512, then the <code>$salt$</code> and then the computed password hash. So the computed hash alone is </p>\n\n<p><code>BNSYWsf3T0e4xT23GJW/QPpKvzLidio5zk9v7kCE.wk4dtNo4avMzBxvqoWc0Y5ihj/zVwtGCwZRfTFur0BnI1</code></p>\n\n<p>As I understand it this uses crypt(3) in the background. If I write a short bit of C such as:</p>\n\n<pre><code>#define _GNU_SOURCE\n#include &lt;crypt.h&gt;\n#include &lt;stdio.h&gt;\n\nint main() {\n  char * blah = crypt(\"password\", \"$6$3b502db443d64283\");\n  puts(blah);\n}\n</code></pre>\n\n<p>Taking care to put in the same random salt as the <code>RAND()</code> function generated for MySQL and prepending the <code>$6</code> to use SHA512, then I do indeed get the same result:</p>\n\n<p><code>$6$3b502db443d64283$BNSYWsf3T0e4xT23GJW/QPpKvzLidio5zk9v7kCE.wk4dtNo4avMzBxvqoWc0Y5ihj/zVwtGCwZRfTFur0BnI1</code></p>\n\n<p>Again the computed hash itself is:</p>\n\n<p><code>BNSYWsf3T0e4xT23GJW/QPpKvzLidio5zk9v7kCE.wk4dtNo4avMzBxvqoWc0Y5ihj/zVwtGCwZRfTFur0BnI1</code></p>\n\n<p>Now if I use CryptoJS and wanted to compare that Hash in JS code rather than in the DB (or in - heaven forfend! - C), then I find that I have a problem. For example here is my CryptoJS code:</p>\n\n<pre><code>var CryptoJS = require('crypto-js');\nvar SHA512 = require('crypto-js/sha512');\n  console.log(SHA512(\"3b502db443d64283password\")).toString();\n</code></pre>\n\n<p>I prepend the salt to the password as this function takes only a single argument. The result is:</p>\n\n<p><code>105865ba5bf0649410927131204a1228260e59e95b1b53942001b98835dca4aedfe7039a00060fdba8531c44c83cd3b7bec4864865915938d2ed7ed477254f61</code></p>\n\n<p>Ok. So I recognise that that is a Hex encoding of the Hashed password. So I'll change the encoding...but to what? I'll try Base64:</p>\n\n<pre><code>  `console.log(SHA512(\"3b502db443d64283password\")).toString(CryptoJS.enc.Base64);`\n</code></pre>\n\n<p>The output is:</p>\n\n<p><code>EFhlulvwZJQQknExIEoSKCYOWelbG1OUIAG5iDXcpK7f5wOaAAYP26hTHETIPNO3vsSGSGWRWTjS7X7UdyVPYQ==</code></p>\n\n<p>I'm starting to see a problem here. The encoding used by crypt(3) isn't base64. What is it? I look in the man page:</p>\n\n<blockquote>\n  <p>The characters in \"salt\" and \"encrypted\" are drawn from the set\n  [a-zA-Z0-9./].</p>\n</blockquote>\n\n<p>So I'm left with these questions:</p>\n\n<ol>\n<li><p>What is the encoding used by crypt(3)? Is it a standard or just a chosen character set.</p></li>\n<li><p>Is there any way to compare hashes generated with two different character sets like this? I mean is there an underlying representation they share of the hashed password? Can I access it?</p></li>\n<li><p>How do I know how many rounds each function is making? Is there any way to know without examining the source code?</p></li>\n<li><p>Is my assumption that I prepend the salt correct when using CryptoJS?</p></li>\n</ol>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1502280110, "post_id": 45590032, "comment_id": 78138912, "body": "Please elaborate on the &quot;doesn&#39;t work&quot; part. <i>How</i> does it not work? What output did you expect? What output did you get? If you haven&#39;t <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a> yet, then please do so. Also please read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert, and learn how to use a debugger."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502280279, "post_id": 45590032, "comment_id": 78139039, "body": "<code>source[i] || cible[i]</code> is just calculating the logical OR between two ASCII codes, this doesn&#39;t really make sense. Same goes for <code>source[i] &amp;&amp; cible[i])</code> which calcul&#226;tes the logical AND."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502280285, "post_id": 45590032, "comment_id": 78139044, "body": "@Some programmer dude in this particular case it is quite obvious what does not work"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502280354, "post_id": 45590032, "comment_id": 78139088, "body": "@PeterJ Yes, but the OP still needs to spell it out. It might be obvious for us in this case, but what if in the next question it <i>isn&#39;t</i>? Good habits needs to start early."}, {"owner": {"reputation": 723, "user_id": 5411341, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/GvPNW.png?s=128&g=1", "display_name": "Slimane amiar", "link": "https://stackoverflow.com/users/5411341/slimane-amiar"}, "edited": false, "score": 0, "creation_date": 1502280508, "post_id": 45590032, "comment_id": 78139228, "body": "i edited it, i mean i expect to get for exemple &quot;a&quot; &amp;&amp; &quot;a&quot; == 1 and &quot;a&quot; &amp;&amp; &quot;b&quot; == 0"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 2, "creation_date": 1502280512, "post_id": 45590032, "comment_id": 78139229, "body": "He thinks that the C natively supports the algebra of sets"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502280557, "post_id": 45590032, "comment_id": 78139251, "body": "@aslimane Then perhaps you should use <i>comparison</i> instead? Because <code>&#39;a&#39; == &#39;a&#39;</code> will be <code>1</code>, and <code>&#39;a&#39; == &#39;b&#39;</code> will be <code>0</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502280707, "post_id": 45590032, "comment_id": 78139364, "body": "@Some programmer dude No - as the result of set &quot;Sel&quot; (OR) set &quot;Salam&quot; shold be set &quot;Salame&quot;."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502280925, "post_id": 45590032, "comment_id": 78139564, "body": "Apart from all the above mentioned points, your jaccard index might still be wrong because  you are not looking at sets (uniqueness of elements)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502281023, "post_id": 45590032, "comment_id": 78139647, "body": "Also, you are only comparing the corresponding elements. But the set remains the same even if shuffled. Perhaps a unique sort and then comparison might yield appropriate results. Comparison still won&#39;t be how you are doing now. You will need two separate indices. If you have only alpha numeric characters, just maintain a bit map."}, {"owner": {"reputation": 723, "user_id": 5411341, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/GvPNW.png?s=128&g=1", "display_name": "Slimane amiar", "link": "https://stackoverflow.com/users/5411341/slimane-amiar"}, "edited": false, "score": 0, "creation_date": 1502281098, "post_id": 45590032, "comment_id": 78139723, "body": "i will try to simulate the union and intersection of sets using equality comparison"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502281098, "post_id": 45590032, "comment_id": 78139724, "body": "@aslimane you still didn&#39;t tell us what output exactly you expect from your program. Give us some examples of different <code>source</code> and <code>cible</code>and what output you expect for each of them."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502281158, "post_id": 45590032, "comment_id": 78139788, "body": "You see, in the link you pasted, they are operating on the bit map <code>B</code>. So there the <code>||</code> and <code>&amp;&amp;</code> make sense."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502281182, "post_id": 45590032, "comment_id": 78139814, "body": "C is not the bast language for it. You should use more high level ones. APL, Matlab, Analitica, R - but on this forum are better specialists"}, {"owner": {"reputation": 723, "user_id": 5411341, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/GvPNW.png?s=128&g=1", "display_name": "Slimane amiar", "link": "https://stackoverflow.com/users/5411341/slimane-amiar"}, "edited": false, "score": 0, "creation_date": 1502281983, "post_id": 45590032, "comment_id": 78140490, "body": "i need it in c to use it in cython (to do parallel operation with no gil) ,to speed up the process of iterating over a huge lists of string,"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502280025, "creation_date": 1502280025, "answer_id": 45590101, "question_id": 45590032, "link": "https://stackoverflow.com/questions/45590032/jaccard-distance-implementation-in-c/45590101#45590101", "title": "Jaccard distance implementation in C", "body": "<pre><code>    un += (source[i] || cible[i]);  // allways true you can replace it with un++\n    in += (source[i] &amp;&amp; cible[i]);  // allways true you can replace it with in++\n</code></pre>\n\n<p>In the C every value != 0 is true and zero if the false.</p>\n\n<p>So the <code>source[i] || cible[i]</code> is always true as source[i] and cible[i] is allways != 0 \nsame <code>source[i] &amp;&amp; cible[i]</code> is always true as both sides of the expression are non zero</p>\n"}, {"tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": true, "score": 3, "last_activity_date": 1502281413, "creation_date": 1502281413, "answer_id": 45590631, "question_id": 45590032, "link": "https://stackoverflow.com/questions/45590032/jaccard-distance-implementation-in-c/45590631#45590631", "title": "Jaccard distance implementation in C", "body": "<p>You picked up the logic for set intersection and union but you didn't convert the input into the representation they use the logic on.</p>\n\n<p>You can't directly act on the input string. You need to operate on a bit map.</p>\n\n<p>Following logic can help you get a bitmap from a string.</p>\n\n<pre><code>uint8_t Bitmap1[256] = {0};\nuint8_t Bitmap2[256] = {0};\n\nfor (i=0;input1[i];i++){\n    Bitmap1[input1[i]] = 1;\n}\nfor (i=0;input2[i];i++){\n    Bitmap2[input2[i]] = 1;\n}\n</code></pre>\n\n<p>Now you can use the logic to count set union and intersection.</p>\n\n<pre><code>in = 0;\nun = 0;\n\n\nfor(i=0;i&lt;256;i++){\n    in+=Bitmap1[i] &amp;&amp; Bitmap2[i];\n    un+=Bitmap1[i] || Bitmap2[i];\n}\n\n// Rest of the logic\n</code></pre>\n\n<p>Here is the <a href=\"http://ideone.com/wQMm26\" rel=\"nofollow noreferrer\">DEMO</a> with valid result on your input.</p>\n"}], "owner": {"reputation": 723, "user_id": 5411341, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/GvPNW.png?s=128&g=1", "display_name": "Slimane amiar", "link": "https://stackoverflow.com/users/5411341/slimane-amiar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1308, "favorite_count": 0, "accepted_answer_id": 45590631, "answer_count": 2, "score": 0, "last_activity_date": 1502284772, "creation_date": 1502279863, "last_edit_date": 1502284772, "question_id": 45590032, "link": "https://stackoverflow.com/questions/45590032/jaccard-distance-implementation-in-c", "title": "Jaccard distance implementation in C", "body": "<p>Here is my code, why the intersection and union between a letter and an other   always equal to one, I extracted the code from here <a href=\"https://datadryad.org/bitstream/handle/10255/dryad.70383/Smith-Patten_Patten_C_Program.pdf?sequence=1\" rel=\"nofollow noreferrer\">jaccard</a>, as I know the Jaccard similarity between two sets A and B it is the ration of cardinality of A \u2229 B and A \u222a B , I would like to consider a string as a set of character </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nvoid main() {\n    char source[5] = \"salam\";\n    char cible[5] = \"Salam\";\n    int i, in = 0, un = 0;\n    float Jaccard = 0;\n    for (i = 0; i &lt; 5; ++i) {\n        un += (source[i] || cible[i]);\n        in += (source[i] &amp;&amp; cible[i]);\n    }\n\n    printf(\"un :: %d\\n\", un);\n    printf(\"in :: %d\\n\", in);\n\n    Jaccard = (float)in / un * 100.0;\n    printf(\"jaccard :: %f\\n\", Jaccard);\n}\n</code></pre>\n"}, {"tags": ["java", "c", "encryption", "cryptography", "aes"], "comments": [{"owner": {"reputation": 530, "user_id": 4861910, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e890abfe12533d8490a4b4d507e523e9?s=128&d=identicon&r=PG&f=1", "display_name": "rootExplorr", "link": "https://stackoverflow.com/users/4861910/rootexplorr"}, "edited": false, "score": 1, "creation_date": 1502279066, "post_id": 45589595, "comment_id": 78138142, "body": "Are you receiving any error by running this ?"}, {"owner": {"reputation": 5711, "user_id": 1398418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30a1570b27c1389f4decdd649ebe9d9?s=128&d=identicon&r=PG", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1398418/oleg"}, "edited": false, "score": 1, "creation_date": 1502279087, "post_id": 45589595, "comment_id": 78138153, "body": "What is the problem? What is the question?"}, {"owner": {"reputation": 488, "user_id": 8064710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a552c8b10cd5a3225d1b44caa0347ab3?s=128&d=identicon&r=PG", "display_name": "Ranjani", "link": "https://stackoverflow.com/users/8064710/ranjani"}, "edited": false, "score": 0, "creation_date": 1502279225, "post_id": 45589595, "comment_id": 78138258, "body": "Yes,i cannot decrypt messages on server side which is sent from the client.I&#39;m getting some junk characters after decrypting it."}, {"owner": {"reputation": 5711, "user_id": 1398418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30a1570b27c1389f4decdd649ebe9d9?s=128&d=identicon&r=PG", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1398418/oleg"}, "edited": false, "score": 1, "creation_date": 1502280095, "post_id": 45589595, "comment_id": 78138891, "body": "What did you to do to identify where the problem is?"}, {"owner": {"reputation": 488, "user_id": 8064710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a552c8b10cd5a3225d1b44caa0347ab3?s=128&d=identicon&r=PG", "display_name": "Ranjani", "link": "https://stackoverflow.com/users/8064710/ranjani"}, "reply_to_user": {"reputation": 5711, "user_id": 1398418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30a1570b27c1389f4decdd649ebe9d9?s=128&d=identicon&r=PG", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1398418/oleg"}, "edited": false, "score": 0, "creation_date": 1502280802, "post_id": 45589595, "comment_id": 78139448, "body": "@Oleg I am using same cipher algorithm, same key and same IV in both server and client sides and still can&#39;t decrypt it on server side.I&#39;m using mcrypt.h library in client and built in java library in server side.The code is looking fine for me, but I don&#39;t know what goes wrong."}, {"owner": {"reputation": 5711, "user_id": 1398418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30a1570b27c1389f4decdd649ebe9d9?s=128&d=identicon&r=PG", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1398418/oleg"}, "edited": false, "score": 0, "creation_date": 1502280936, "post_id": 45589595, "comment_id": 78139572, "body": "Instead of looking at the code check what it does."}, {"owner": {"reputation": 5711, "user_id": 1398418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30a1570b27c1389f4decdd649ebe9d9?s=128&d=identicon&r=PG", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1398418/oleg"}, "edited": false, "score": 1, "creation_date": 1502283002, "post_id": 45589595, "comment_id": 78141336, "body": "&quot;<i>mostly</i>&quot; is useless. If your code doesn&#39;t do what it needs to do there is a mismatch between your understanding of it and what it actually does. If you want to know what it actually does you need to debug it. Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> if you don&#39;t know how. How can I know what you have done wrong? What exactly do you expect from me or anybody else who is capable of helping you? Do you want me to debug your code for you? What makes you think that this is a reasonable expectation? Also see <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502283399, "post_id": 45589595, "comment_id": 78141664, "body": "It&#39;s a networked system.   I suggest that you start with wireshark, or similar, to find out if the problem is at the server. client, or both.   If you have a complex problem, you have to split it up."}, {"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 2, "creation_date": 1502285186, "post_id": 45589595, "comment_id": 78143188, "body": "<b>Moderator Note:</b> <a href=\"http://stackoverflow.com/help/be-nice\">Be Nice</a>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502294657, "post_id": 45589595, "comment_id": 78150770, "body": "First things first. 1.  Can the C code decrypt the message it encrypts?  Can the Java code decrypt the message it encrypts?  If not, fix them so they can each decrypt what they encrypt. 2.  Does the receiving program receive exactly the byte stream that the sender sends?  Make sure you know what is supposed to be sent and what is sent are the same, and that what&#39;s received is what was sent.  If this fails, resolve this problems.  With those steps resolved, you can compare the message received with the same message encrypted locally.  You should then be in business."}], "answers": [{"tags": [], "owner": {"reputation": 14257, "user_id": 820127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81f8fffeec4f2ba3e75aebe941e4e5dd?s=128&d=identicon&r=PG", "display_name": "rossum", "link": "https://stackoverflow.com/users/820127/rossum"}, "is_accepted": false, "score": 1, "last_activity_date": 1502289966, "creation_date": 1502289966, "answer_id": 45593940, "question_id": 45589595, "link": "https://stackoverflow.com/questions/45589595/cryptography-aes-ctr-decryption/45593940#45593940", "title": "Cryptography : AES/CTR Decryption", "body": "<p>Different systems have different defaults, and any difference will munge up your decryption.  Check that <em>everything</em> is byte-for-byte the same.  Display the hex values on both systems to check: key, nonce/IV, cyphertext bytes, plaintext bytes (not text).</p>\n\n<p>It is probably best not to rely on any defaults, but to explicitly specify everything on both systems.</p>\n\n<p>A common source of error is text to byte conversions, which might affect the initial plaintext and possibly passphrase used as input.</p>\n\n<p>Your junk characters might be whatever was sitting in the C buffer memory when you allocated it.</p>\n"}, {"tags": [], "owner": {"reputation": 205, "user_id": 7158112, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8bf0654a3ef35d2ea5612c70f97c4cb6?s=128&d=identicon&r=PG&f=1", "display_name": "karthi keyan", "link": "https://stackoverflow.com/users/7158112/karthi-keyan"}, "is_accepted": true, "score": 2, "last_activity_date": 1503388045, "creation_date": 1503388045, "answer_id": 45811787, "question_id": 45589595, "link": "https://stackoverflow.com/questions/45589595/cryptography-aes-ctr-decryption/45811787#45811787", "title": "Cryptography : AES/CTR Decryption", "body": "<p>Your client and server looks good,but there is an minor mistake in your UDP packet processing while fetching the data from the packet and decrypting it.Try to change it and i think your code will work. :)</p>\n"}], "owner": {"reputation": 488, "user_id": 8064710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a552c8b10cd5a3225d1b44caa0347ab3?s=128&d=identicon&r=PG", "display_name": "Ranjani", "link": "https://stackoverflow.com/users/8064710/ranjani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 4, "accepted_answer_id": 45811787, "answer_count": 2, "score": 1, "last_activity_date": 1503388045, "creation_date": 1502278680, "last_edit_date": 1502284168, "question_id": 45589595, "link": "https://stackoverflow.com/questions/45589595/cryptography-aes-ctr-decryption", "title": "Cryptography : AES/CTR Decryption", "body": "<p>I have built an server and client application which is used to encrypt and decrypt on AES/CTR algorithm.The client side is built in C language and the server side is built in Java language.But,the encrypted ciphertext cant be decrypted in server and vice versa.</p>\n\n<p>Here is the code :\n(Client)</p>\n\n<p>$ Client(C) :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;mcrypt.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\nint encrypt(\n   void* buffer,\nint buffer_len, /* Because the plaintext could include null bytes*/\nchar* IV, \nchar* key,\nint key_len \n){\n MCRYPT td = mcrypt_module_open(\"rijndael-128\", NULL, \"ctr\", NULL);\n int blocksize = mcrypt_enc_get_block_size(td);\n if( buffer_len % blocksize != 0 ){return 1;}\n mcrypt_generic_init(td, key, key_len, IV);\n mcrypt_generic(td, buffer, buffer_len);\n mcrypt_generic_deinit (td);\n mcrypt_module_close(td);\n return 0;\n}\n\nint decrypt(\n  void* buffer,\n  int buffer_len,\n  char* IV, \n  char* key,\n  int key_len \n){\n  MCRYPT td = mcrypt_module_open(\"rijndael-128\", NULL, \"ctr\", NULL);\n  int blocksize = mcrypt_enc_get_block_size(td);\n  if( buffer_len % blocksize != 0 ){return 1;} \n  mcrypt_generic_init(td, key, key_len, IV);\n  mdecrypt_generic(td, buffer, buffer_len);\n  mcrypt_generic_deinit (td);\n  mcrypt_module_close(td);  \n  return 0;\n }\n\nvoid display(char* ciphertext, int len){\n int v;\n for (v=0; v&lt;len; v++){\n  printf(\"%d \", ciphertext[v]);\n }\n printf(\"\\n\");\n}\n\nint main() {\n  MCRYPT td, td2;\n  char * plaintext = \"test text 123\";\n  char* IV = \"AAAAAAAAAAAAAAAA\";\n  char *key = \"0123456789abcdef\";\n  int keysize = 16; /* 128 bits */\n  char* buffer;\n  int buffer_len = 16;\n  buffer = calloc(1, buffer_len);\n  strncpy(buffer, plaintext, buffer_len);\n  printf(\"==C==\\n\");\n  printf(\"plain:   %s\\n\", plaintext);\n  encrypt(buffer, buffer_len, IV, key, keysize); \n  printf(\"cipher:  \"); display(buffer , buffer_len);\n  decrypt(buffer, buffer_len, IV, key, keysize);\n  printf(\"decrypt: %s\\n\", buffer);\n  return 0;\n  }\n</code></pre>\n\n<p>$ Server(Java) :</p>\n\n<pre><code>import java.security.MessageDigest; \nimport java.util.Arrays;\nimport javax.crypto.KeyGenerator;\nimport javax.crypto.SecretKey;\nimport javax.crypto.spec.SecretKeySpec;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.Cipher;\nimport javax.crypto.spec.IvParameterSpec;\nimport javax.crypto.spec.SecretKeySpec;\nimport java.io.*;\nimport java.util.*;\nimport java.net.*;\n\npublic class AESEnc {\n  static String IV = \"AAAAAAAAAAAAAAAA\";\n  static String encryptionKey = \"Hello World nexg\";\n  public static void main(String [] args) {\n    try {\n    InetAddress IPAddress = InetAddress.getByName(\"192.168.1.7\");\n    DatagramSocket clientSocket = new        DatagramSocket(5038,IPAddress);\n    byte[] data=new byte[2048];\n    DatagramPacket packet = new DatagramPacket(data, 2048);\n    packet.setLength(2048); \n    System.out.println(\"Waiting for packet\");\n    clientSocket.receive(packet);\n    String strMessage=new String(packet.getData(),0,packet.getLength());\n    System.out.println(\"Recieved packet\");\n    System.out.println(\"==Java==\");\n    System.out.println(\"plain:   \" + strMessage);\n    String decrypted = decrypt(strMessage.getBytes(),encryptionKey);\n\n} catch (Exception e) {\n  e.printStackTrace();\n} \n}\n\n  public static byte[] encrypt(String plainText, String encryptionKey) throws Exception {\n    Cipher cipher = Cipher.getInstance(\"AES/CTR/PKCS5Padding\", \"SunJCE\");\n    SecretKeySpec key = new SecretKeySpec(encryptionKey.getBytes(\"UTF-8\"), \"AES\");\n    cipher.init(Cipher.ENCRYPT_MODE, key,new IvParameterSpec(IV.getBytes(\"UTF-8\")));\n    return cipher.doFinal(plainText.getBytes(\"UTF-8\"));\n  }\n\n  public static String decrypt(byte[] cipherText, String encryptionKey) throws Exception{\n    Cipher cipher = Cipher.getInstance(\"AES/CTR/NoPadding\", \"SunJCE\");\n    SecretKeySpec key = new SecretKeySpec(encryptionKey.getBytes(\"UTF-8\"), \"AES\");\n    cipher.init(Cipher.DECRYPT_MODE, key,new IvParameterSpec(IV.getBytes(\"UTF-8\")));\n    return new String(cipher.doFinal(cipherText),\"UTF-8\");\n  }\n}\n</code></pre>\n\n<p>These are my server and client source code,Please let me know if you find an error in it.</p>\n\n<p>Thanks in Advance,</p>\n\n<p>P.S : I am getting some junk characters after decrypting the messages sent from the client side.I am not getting the actual message which is encrypted.</p>\n"}, {"tags": ["c++", "c", "linux", "linker"], "comments": [{"owner": {"reputation": 813, "user_id": 7007547, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98f73030359d42f11fdc0a2893f809b5?s=128&d=identicon&r=PG&f=1", "display_name": "mbieren", "link": "https://stackoverflow.com/users/7007547/mbieren"}, "edited": false, "score": 0, "creation_date": 1502280949, "post_id": 45589322, "comment_id": 78139583, "body": "do you have the 32 Bits in source or just as static binaries"}, {"owner": {"reputation": 11, "user_id": 8439401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c7a08079b409c090407a032cbb3cd?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Gurin", "link": "https://stackoverflow.com/users/8439401/oleg-gurin"}, "reply_to_user": {"reputation": 813, "user_id": 7007547, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98f73030359d42f11fdc0a2893f809b5?s=128&d=identicon&r=PG&f=1", "display_name": "mbieren", "link": "https://stackoverflow.com/users/7007547/mbieren"}, "edited": false, "score": 0, "creation_date": 1502281817, "post_id": 45589322, "comment_id": 78140345, "body": "yep i have all sources"}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1502284626, "post_id": 45589322, "comment_id": 78142659, "body": "one thing you definitely need is to use &#39;g++&#39; at the link command. it will add all needed c++ libraries and qualifiers (unless you want to do it manually). You should also compile and link your code with &#39;-m32&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8439401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c7a08079b409c090407a032cbb3cd?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Gurin", "link": "https://stackoverflow.com/users/8439401/oleg-gurin"}, "edited": false, "score": 0, "creation_date": 1502522161, "post_id": 45590958, "comment_id": 78253822, "body": "thanks for helping, this is my steps to resolve my task:"}, {"owner": {"reputation": 11, "user_id": 8439401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c7a08079b409c090407a032cbb3cd?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Gurin", "link": "https://stackoverflow.com/users/8439401/oleg-gurin"}, "edited": false, "score": 0, "creation_date": 1502522235, "post_id": 45590958, "comment_id": 78253839, "body": "1 compile all cpp libs with -fPIC and -m64 flags"}, {"owner": {"reputation": 11, "user_id": 8439401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c7a08079b409c090407a032cbb3cd?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Gurin", "link": "https://stackoverflow.com/users/8439401/oleg-gurin"}, "edited": false, "score": 0, "creation_date": 1502522389, "post_id": 45590958, "comment_id": 78253874, "body": "3. add into linkage string gcc -shared -xc++ -lstdc++ -shared-libgcc and my static libs"}], "tags": [], "owner": {"reputation": 813, "user_id": 7007547, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/98f73030359d42f11fdc0a2893f809b5?s=128&d=identicon&r=PG&f=1", "display_name": "mbieren", "link": "https://stackoverflow.com/users/7007547/mbieren"}, "is_accepted": false, "score": 0, "last_activity_date": 1502282396, "creation_date": 1502282396, "answer_id": 45590958, "question_id": 45589322, "link": "https://stackoverflow.com/questions/45589322/link-static-library-into-dynamic-labrary-in-gcc-linux/45590958#45590958", "title": "link static library into dynamic labrary in gcc Linux", "body": "<p>This link is usefull for creating the libs :</p>\n\n<pre><code>http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html\n</code></pre>\n\n<p>and this is for mixing C and C++ </p>\n\n<pre><code>https://isocpp.org/wiki/faq/mixing-c-and-cpp\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8439401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/702c7a08079b409c090407a032cbb3cd?s=128&d=identicon&r=PG&f=1", "display_name": "Oleg Gurin", "link": "https://stackoverflow.com/users/8439401/oleg-gurin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502282396, "creation_date": 1502277859, "question_id": 45589322, "link": "https://stackoverflow.com/questions/45589322/link-static-library-into-dynamic-labrary-in-gcc-linux", "title": "link static library into dynamic labrary in gcc Linux", "body": "<p>I have a lot of static libraries that wrote on \"c++\" under 32 bits platform Linux. Now i need to compile \"c\" dynamic library in 64 bits platform Linux with my functionality from c++.\nCan someone tell me the best way to do this. I know that i should put all functions prototypes into <code>extern \"C\"</code> logic but should I have to compile static libraries with <code>\"-fPIC\"</code> key . Which keys i have to use in <code>gcc</code> compiler to link my c++ libraries ? any help will be appreciate </p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["c", "arrays", "algorithm", "zero"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502275792, "post_id": 45588500, "comment_id": 78135830, "body": "<code>int i, j = 0;</code> ...<code>x_upd[j++] = x[i];</code>...<code>for(i=0;i&lt;9;i++)</code> --&gt; <code>for(i = 0; i &lt; j; i++)</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502275831, "post_id": 45588500, "comment_id": 78135856, "body": "In the second loop, where you print the values, what do you think you will print for elements of <code>x_upd</code> that are not initialized? You need to keep track of the new size as well."}, {"owner": {"reputation": 662, "user_id": 8283047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3222cee65d7f8adce79f94d79d0b4894?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoseph", "link": "https://stackoverflow.com/users/8283047/sjoseph"}, "edited": false, "score": 0, "creation_date": 1502276071, "post_id": 45588500, "comment_id": 78136031, "body": "This is something I still don&#39;t fully understand, but would I be printing some reference to the variable address?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502283132, "post_id": 45588500, "comment_id": 78141436, "body": "&quot;I am getting garbage values at the location where the zeros used to be.&quot; --&gt; What value did you expect there in the uninitialized portion of <code>x_upd[]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 19910, "user_id": 8012646, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/T8yOZ.png?s=128&g=1", "display_name": "\u30ed\u30fc\u30a6", "link": "https://stackoverflow.com/users/8012646/%e3%83%ad%e3%83%bc%e3%82%a6"}, "is_accepted": false, "score": 2, "last_activity_date": 1502276581, "last_edit_date": 1502276581, "creation_date": 1502275693, "answer_id": 45588547, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588547#45588547", "title": "Remove zero entries from an array in C", "body": "<p>This problem can be solved by using <strong>two indexes</strong>: one for the <em>source array</em> (<code>x</code>) and another for the <em>destination array</em> (<code>x_upd</code>), which are <code>i</code> and <code>j</code>, respectively, in the code below.</p>\n\n<pre><code>int i, j;\nfor(i=0,j=0; i&lt;9; i++) {\n  if (!x[i]) // is x[i] zero?\n     continue; // then skip this element\n\n  // otherwise copy current element and update destination index\n  x_upd[j++] = x[i];       \n}\n</code></pre>\n\n<p>As you can see, the index <code>j</code> is only being <em>updated</em> (i.e.: incremented by one) when an element from <code>x</code> is being copied to <code>x_upd</code>, whereas the index <code>i</code> is being updated in each iteration of the <code>for</code> loop.</p>\n"}, {"tags": [], "owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "is_accepted": false, "score": 2, "last_activity_date": 1502276115, "last_edit_date": 1502276115, "creation_date": 1502275773, "answer_id": 45588580, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588580#45588580", "title": "Remove zero entries from an array in C", "body": "<p>This</p>\n\n<pre><code>for(i=0;i&lt;9;i++)\n{\n  if(x[i] != 0)\n  {\n      x_upd[i] = x[i]; // if true, populate new array with value\n  }\n}\n</code></pre>\n\n<p>is skipping places in the <code>x_upd</code> array, since <code>i</code> is still being incremented even when you don't insert values in your new array.</p>\n\n<p>You should do this:</p>\n\n<pre><code>int j = 0;\nfor(i=0;i&lt;9;i++)\n{\n  if(x[i] != 0)\n  {\n      x_upd[j++] = x[i]; // if true, populate new array with value\n  }\n}\n</code></pre>\n\n<p>Then, here</p>\n\n<pre><code>for(i=0;i&lt;9;i++)\n{\n  printf(\" Peak updated %d\\t\",x_upd[i]); //\n}\n</code></pre>\n\n<p>You should just count till <code>j</code>:</p>\n\n<pre><code>for(i=0;i&lt;j;i++)\n{\n  printf(\" Peak updated %d\\t\",x_upd[i]); //\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": false, "score": 2, "last_activity_date": 1502275780, "creation_date": 1502275780, "answer_id": 45588581, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588581#45588581", "title": "Remove zero entries from an array in C", "body": "<p>The trick in this situation, is to use a different variable to index into your other array.</p>\n\n<p>So instead of this:</p>\n\n<pre><code>x_upd[i] = x[i];\n</code></pre>\n\n<p>You could have another variable <code>j</code> that only increments when you assign a value to <code>x_upd</code></p>\n\n<pre><code>x_upd[j++] = x[i];\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502278748, "post_id": 45588600, "comment_id": 78137912, "body": "2nd <code>i&lt;9</code> --&gt; <code>i&lt;j</code>"}], "tags": [], "owner": {"reputation": 340, "user_id": 5481533, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6187f0b4e1ee3afd24b05530d136baf1?s=128&d=identicon&r=PG&f=1", "display_name": "urielSilva", "link": "https://stackoverflow.com/users/5481533/urielsilva"}, "is_accepted": false, "score": 3, "last_activity_date": 1502283077, "last_edit_date": 1502283077, "creation_date": 1502275820, "answer_id": 45588600, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588600#45588600", "title": "Remove zero entries from an array in C", "body": "<p>You should use separate counter variables, otherwise you will \"skip\" the indexes where the original array contains zeroes when assigning to the new array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int x[] = { 0, 0, 1, 2, 3, 0, 0, 7, 8 };\n    int i;\n    int j = 0;\n    int x_upd[100];\n    for (i = 0; i &lt; 9; i++) {\n        if (x[i] != 0) {\n            x_upd[j++] = x[i]; // if true, populate new array with value\n        }\n    }\n    for (i = 0; i &lt; j; i++) {\n          printf(\" Peak updated %d\\t\", x_upd[i]); //\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1502276060, "post_id": 45588618, "comment_id": 78136024, "body": "Maybe he needs to keep the original array."}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1502276170, "post_id": 45588618, "comment_id": 78136109, "body": "He didn&#39;t explicitly say what does he need, with respect that he is the beginner i think he used second array just becouse he didnt know how to do it with one."}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": false, "score": 2, "last_activity_date": 1502275861, "creation_date": 1502275861, "answer_id": 45588618, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588618#45588618", "title": "Remove zero entries from an array in C", "body": "<p>No need to create a new array, see the working code with one array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    int x[] = { 0, 0, 1, 2, 3, 0, 0, 7, 8 };\n    int i, n;\n\n    for (i = 0, n = 0; i&lt;9; i++)\n    {\n        if (x[i] != 0)\n        {\n            x[n++] = x[i];\n        }\n    }\n\n    for (i = 0; i&lt;n; i++)\n    {\n        printf(\"%d,\", x[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>OUTPUT:</strong></p>\n\n<pre><code>1,2,3,7,8,\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1951, "user_id": 6768585, "user_type": "registered", "accept_rate": 82, "profile_image": "https://lh3.googleusercontent.com/-p6a_zY9VHR0/AAAAAAAAAAI/AAAAAAAAAKw/e4Eg6291IAA/photo.jpg?sz=128", "display_name": "Farhan Yaseen", "link": "https://stackoverflow.com/users/6768585/farhan-yaseen"}, "is_accepted": false, "score": 1, "last_activity_date": 1502275925, "creation_date": 1502275925, "answer_id": 45588643, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588643#45588643", "title": "Remove zero entries from an array in C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\nint x[] = {0,0,1,2,3,0,0,7,8};\nint i;\nint count = 0;\nint x_upd[100];\nfor(i=0;i&lt;9;i++)\n    {\n      if(x[i] != 0)\n      {\n          x_upd[count] = x[i]; // if true, populate new array with value\n          count++;\n      }\n    }\n\nfor(i=0;i&lt;count;i++)\n    {\n      printf(\" Peak updated %d\\t\",x_upd[i]); //\n    }\nreturn 0;\n}\n</code></pre>\n\n<p><strong>Output</strong></p>\n\n<pre><code>Peak updated 1  Peak updated 2  Peak updated 3  Peak updated 7  Peak updated 8 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 7742025, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6086d7d0f71cca1f6d14b065b7808419?s=128&d=identicon&r=PG&f=1", "display_name": "LLDevLab", "link": "https://stackoverflow.com/users/7742025/lldevlab"}, "is_accepted": false, "score": 2, "last_activity_date": 1502284060, "last_edit_date": 1502284060, "creation_date": 1502275961, "answer_id": 45588655, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588655#45588655", "title": "Remove zero entries from an array in C", "body": "<p>You should increment x_upd array index separately. Something like:</p>\n\n<pre><code>int y = 0;\nfor(i=0;i&lt;9;i++)\n{\n  if(x[i] != 0)\n  {\n      x_upd[y] = x[i]; // if true, populate new array with value\n      y++;\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 970, "user_id": 7931009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa3ed11dc33a4b1e9dadab14cd80d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub D\u0105bek", "link": "https://stackoverflow.com/users/7931009/jakub-d%c4%85bek"}, "edited": false, "score": 0, "creation_date": 1502278799, "post_id": 45588656, "comment_id": 78137947, "body": "I think <code>position</code> makes more sense, but <code>counter</code> also conveys what I meant. Of course I forgot to change everything, edited now. <i>This was a response to an earlier comment</i>"}], "tags": [], "owner": {"reputation": 970, "user_id": 7931009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa3ed11dc33a4b1e9dadab14cd80d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub D\u0105bek", "link": "https://stackoverflow.com/users/7931009/jakub-d%c4%85bek"}, "is_accepted": false, "score": 3, "last_activity_date": 1502278694, "last_edit_date": 1502278694, "creation_date": 1502275969, "answer_id": 45588656, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45588656#45588656", "title": "Remove zero entries from an array in C", "body": "<p>You go through the values 0-9 once, in order, and you skip values that are <code>0</code>, so you get <code>{garbage, garbage, 1, 2, 3, garbage, garbage, 7, 8}</code>. You'd have to keep a separate counter for the number of values that aren't <code>0</code>:</p>\n\n<pre><code>int position = 0;\nfor(i = 0; i &lt; 9; i++)\n{\n    if(x[i] != 0)\n    {\n        x_upd[position] = x[i]; // if true, populate new array with value\n        position++;\n    }\n}\n\n//loop until you get to counter\nfor(i = 0; i &lt; position; i++)\n{\n    printf(\" Peak updated %d\\t\", x_upd[i]); \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 4, "creation_date": 1502277837, "post_id": 45589074, "comment_id": 78137270, "body": "This <code>int result = (src == NULL || dest == NULL || size == 0) * -1;</code> does not suite well an <b><i>educational</b> example</i>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1502278125, "post_id": 45589074, "comment_id": 78137466, "body": "@alk I know what you mean - explained it in the comment :)"}, {"owner": {"reputation": 970, "user_id": 7931009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9aa3ed11dc33a4b1e9dadab14cd80d9f?s=128&d=identicon&r=PG&f=1", "display_name": "Jakub D\u0105bek", "link": "https://stackoverflow.com/users/7931009/jakub-d%c4%85bek"}, "edited": false, "score": 0, "creation_date": 1502278222, "post_id": 45589074, "comment_id": 78137537, "body": "Usually I think you should put comments above the line you&#39;re commenting on. The function declaration looks disjointed if you put a comment between <code>int populate(int *src, int *dest, int size)</code> and <code>{</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502283577, "post_id": 45589074, "comment_id": 78141813, "body": "Why not just return <code>0</code> when <code>size == 0</code>?  Why not simply write: <code>if (src == NULL || dest == NULL) return -1;</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502283768, "post_id": 45589074, "comment_id": 78141966, "body": "@chqrlie I do not like functions with more than 1 return points for many reasons which I have explained here many times"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502284589, "post_id": 45589074, "comment_id": 78142634, "body": "@PeterJ: I suspected some such local coding rule.  The solution you have come up with to avoid a simple <code>return -1;</code> illustrates how counter-productive it can be ;-)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502284962, "post_id": 45589074, "comment_id": 78142988, "body": "@chqrlie counter productive? Compile both. You probably did not code for the car or aviation industry :). Having more than one makes code review a real challenge (and you want to be paid :))"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502285355, "post_id": 45589074, "comment_id": 78143326, "body": "@PeterJ: I say <i>counter-productive</i> as it leads to unreadable code with questionable corner cases (such as why do you return -1 for size == 0). I am perfectly aware of the Misra-C coding conventions but I don&#39;t believe blind application of these rules lead to safer code. As a matter of fact, I have seen pretty bad code written for the car industry and worse even for security companies.  Do what you must to keep your job and get paid, but please take a break from this non-sense here on SO as you are contributing for free anyway ;-)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502286028, "post_id": 45589074, "comment_id": 78143927, "body": "@chqrlie it is only your personal opinion, not the valid standard. I will definitely not change my coding style to your liking. So please do not say what is the non sense and what is not. This function returns -1 if size is zero because <b><i>I</i></b> decided that is invalid."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502287037, "post_id": 45589074, "comment_id": 78144814, "body": "@PeterJ: indeed it is my personal opinion and experience regarding this specific Misra-C coding rule, no offense, I am just suggesting that it would make sense to return <code>0</code> for <code>size == 0</code>, conversely, passing a negative <code>size</code> should definitely be considered invalid."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502287211, "post_id": 45589074, "comment_id": 78144947, "body": "@chqrlie I have right opposite opinion. If size == 0 is valid or invalid is in the coders discretion and program requirements. I can imagine results from the sensor - if no data received - it means something has gone wrong and some action from the program is needed"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502287677, "post_id": 45589074, "comment_id": 78145346, "body": "@PeterJ: it should really be part of program requirements, which in real life are always incomplete. I agree with you that lack of data from a sensor is a problem, but removing <code>0</code> values from an empty array does not seem to be open to interpretation. Returning 0 is consistent with similar situations in the C library: <code>memcpy(p, q, 0)</code> and <code>memset(p, c, 0)</code> do nothing successfully, <code>strstr(&quot;abc&quot;, &quot;&quot;)</code> returns the first argument and <code>memcmp(p, q, 0)</code> returns <code>0</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502288128, "post_id": 45589074, "comment_id": 78145717, "body": "@chqrlie special amendment for you :). Zero is not good indicator as table may contain only zeroes."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502288019, "last_edit_date": 1502288019, "creation_date": 1502277155, "answer_id": 45589074, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45589074#45589074", "title": "Remove zero entries from an array in C", "body": "<p>no indexes needed</p>\n\n<pre><code>int populate(int *src, int *dest, int size)\n//usage: - src - source table\n//src - source table\n//dest - destination table\n//size of the source table - source table\n//Return: -1 if pointers are null, -2 if source table has zero elements, or number of non zero elements copied\n{\n    int result = (src == NULL || dest == NULL) * -1;\n    // it an equivalen of:\n    // int result;    \n    // if(src == NULL || dest == NULL)\n    //     result = -1;\n    // else\n    //     result = 0;\n    if(size == 0) result = -2;\n    if (!result)\n    {\n        while(size--)\n            if (*src)\n            {\n                *dest++ = *src;\n                result++;\n            }\n        src++;\n    }\n    return result;\n}\n\n\n\nint main()\n{\n    int x[] = { 0,0,1,2,3,0,0,7,8 };\n    int x_upd[100];\n\n    int result = populate(x,x_upd, sizeof(x) / sizeof(x[0]))\n    for (int i = 0; i&lt;result; i++)\n    {\n        printf(\" Peak updated %d\\t\", x_upd[i]); //\n    }\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1569920759, "post_id": 45589647, "comment_id": 102742889, "body": "There is one peculiar thing in the <code>remove_copy</code> - you can pass in the <i>same</i> pointer for both arguments and it will work in-place."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1569920934, "post_id": 45589647, "comment_id": 102743001, "body": "@AnttiHaapala It is wrong. Accordfing to the C++ the ranges shall not overlap."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1569921003, "post_id": 45589647, "comment_id": 102743032, "body": "The <i>C</i> version that you wrote. I do not care about C++ :D"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 5, "last_activity_date": 1502279284, "last_edit_date": 1502279284, "creation_date": 1502278824, "answer_id": 45589647, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45589647#45589647", "title": "Remove zero entries from an array in C", "body": "<p>There is already such a function in C++. It is named <code>remove_copy</code>. In C such a function can look the following way as it is shown in the demonstrative program below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint * remove_copy(const int *in, size_t n, int *out, int value)\n{\n    for (size_t i = 0; i != n; i++)\n    {\n        if (in[i] != value) *out++ = in[i];\n    }\n\n    return out;\n}\n\nint main( void )\n{\n    int a[] = { 0, 0, 1, 2, 3, 0, 0, 7, 8 };\n    int b[sizeof(a) / sizeof(*a)];\n    const size_t N = sizeof(a) / sizeof(*a);\n\n    int *last = remove_copy(a, N, b, 0);\n\n    for (int *first = b; first != last; ++first)\n    {\n        printf(\"%d \", *first);\n    }\n\n    putchar('\\n');\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>1 2 3 7 8\n</code></pre>\n\n<p>Or the function can return the number of the copied values</p>\n\n<pre><code>size_t remove_copy(const int *in, size_t n, int *out, int value)\n{\n    size_t m = 0;\n\n    for (size_t i = 0; i != n; i++)\n    {\n        if (in[i] != value) out[m++] = in[i];\n    }\n\n    return m;\n}\n</code></pre>\n\n<p>As for your code then you need to use an additional variable that will keep the index in the destination array. For example</p>\n\n<pre><code>int m = 0;\n\nfor ( i = 0; i &lt; sizeof( x ) / sizeof( *x ); i++ )\n{\n    if ( x[i] != 0 )\n    {\n        x_upd[m++] = x[i]; // if true, populate new array with value\n    }\n}\n\nfor ( i = 0; i &lt; m; i++ )\n{\n    printf(\" Peak updated %d\\t\", x_upd[i] ); //\n}\n</code></pre>\n\n<p>In fact the first loop corresponds to the second function implementation shown above.</p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 3201142, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/96062ca1b7a9246b9adc750b2a5e6d1d?s=128&d=identicon&r=PG&f=1", "display_name": "xerocool", "link": "https://stackoverflow.com/users/3201142/xerocool"}, "is_accepted": false, "score": 2, "last_activity_date": 1502280044, "creation_date": 1502280044, "answer_id": 45590109, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c/45590109#45590109", "title": "Remove zero entries from an array in C", "body": "<p>The problem lies here:</p>\n\n<pre><code>for(i=0;i&lt;9;i++)\n{\n  if(x[i] != 0)\n  {\n      x_upd[i] = x[i]; // if true, populate new array with value\n  }\n}\n</code></pre>\n\n<p>and </p>\n\n<pre><code>for(i=0;i&lt;9;i++) {\n   printf(\" Peak updated %d\\t\",x_upd[i]); //\n}\n</code></pre>\n\n<p>You need to maintain separate index for x and x_upd, since they will be of different size(x_upd wont have the '0').</p>\n\n<p>Try this:</p>\n\n<pre><code>int j;\nfor(i=0,j=0;i&lt;9;i++) {\n  if(x[i] != 0)\n  {\n      x_upd[j] = x[i]; // if true, populate new array with value\n      j++;             // index for values inserted \n\n  }\n}\n</code></pre>\n\n<p>and to print, use the correct count, obtained from the above code:</p>\n\n<pre><code>int k;\nfor(k=0;k&lt;=j;k++) {\n   printf(\" Peak updated %d\\t\",x_upd[k]); //\n}\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 8283047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3222cee65d7f8adce79f94d79d0b4894?s=128&d=identicon&r=PG&f=1", "display_name": "Sjoseph", "link": "https://stackoverflow.com/users/8283047/sjoseph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7381, "favorite_count": 0, "accepted_answer_id": 45589647, "answer_count": 11, "score": 3, "last_activity_date": 1502288019, "creation_date": 1502275588, "last_edit_date": 1502286236, "question_id": 45588500, "link": "https://stackoverflow.com/questions/45588500/remove-zero-entries-from-an-array-in-c", "title": "Remove zero entries from an array in C", "body": "<p>I have an array of values <code>x = {0,0,1,2,3,0,0,7,8}</code> and I want to remove the zero entries using C. </p>\n\n<p><strong>Attempt:</strong></p>\n\n<p>I am attempting to loop through each value in the array and check if the entry is not equal to zero. If this condition is true, then I am attempting to populate a new array with original array value.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main() {\n    int x[] = { 0, 0, 1, 2, 3, 0, 0, 7, 8 };\n    int i;\n    int x_upd[100];\n    for (i = 0; i &lt; 9; i++) {\n        if (x[i] != 0) {\n            x_upd[i] = x[i]; // if true, populate new array with value\n        }\n    }\n    for (i = 0; i &lt; 9; i++) {\n        printf(\" Peak updated %d\\t\", x_upd[i]); //\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The output is not giving me the values <code>{1,2,3,7,8}</code> as desired. Instead, I am getting garbage values at the location where the zeros used to be.</p>\n\n<p>Any advice on what I am doing wrong here? Do I need an else statement?</p>\n"}, {"tags": ["c", "printf", "language-lawyer", "conversion-specifier"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502275713, "post_id": 45588405, "comment_id": 78135781, "body": "What exactly is not clear here?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 0, "creation_date": 1502275923, "post_id": 45588405, "comment_id": 78135932, "body": "@tilz0R as I said...&quot;until advised otherwise&quot;. If you can see a dupe targeting to this discussion, please mark it. I am just confirming my understanding here, as spec words can be tricky at times."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1502275939, "post_id": 45588405, "comment_id": 78135944, "body": "the second case should throw up a warning or error"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1502275990, "post_id": 45588405, "comment_id": 78135979, "body": "@ChrisTurner Well, it should, but here, I&#39;m targeting the &quot;categorization&quot; more, please notice LL tag. :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502275992, "post_id": 45588405, "comment_id": 78135981, "body": "I&#39;m no expert, but I think your understanding is correct."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502276767, "post_id": 45588405, "comment_id": 78136531, "body": "I think the operating word here is &quot;corresponding&quot;. The first sentence says that if in the string exists a specifier which is not valid. If not, then each specifier is matched with its corresponding argument. Then the second statement says about type matching. So <b>I think</b>, your interpretation is correct."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502276841, "post_id": 45588405, "comment_id": 78136578, "body": "@AjayBrahmakshatriya Thank you (not for agreeing to my view, but for explaining in your own words, appreciate the effort!!)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502277077, "post_id": 45588405, "comment_id": 78136744, "body": "I think the second example does not lie in the first category because &quot;corresponding&quot; is not used."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 1, "creation_date": 1502278109, "post_id": 45588405, "comment_id": 78137453, "body": "@AjayBrahmakshatriya I copied your words in my rejoinder. :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502297736, "post_id": 45588405, "comment_id": 78152549, "body": "Interesting.  A missing aspect of the question is that this post focuses on <code>*printf()</code> - without saying that.  I could see a different answer for <code>*scanf()</code>.  E.g.  does the format need to be &quot;correct/matching&quot; if the specifier is not reached as part of the scan? Hmmmm.  (I think it does)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502298481, "post_id": 45588405, "comment_id": 78152965, "body": "&quot;A statement like printf(&quot;%S&quot;, str); belong to the first sentence, there exist no CS as %S (UPPERCASE)&quot; deserve qualification.  A compliant compiler may add <code>&quot;%S&quot;</code> as a valid conversion specification and is therefore not invalid, but valid - for that compiler."}], "answers": [{"tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 9, "last_activity_date": 1502286344, "last_edit_date": 1592644375, "creation_date": 1502276068, "answer_id": 45588691, "question_id": 45588405, "link": "https://stackoverflow.com/questions/45588405/what-is-exactly-an-invalid-conversion-specification/45588691#45588691", "title": "What is exactly an &quot;invalid conversion specification&quot;?", "body": "<p>The &quot;validity&quot; of a conversion specification is determined by the standard paragraphs above the one you quoted:</p>\n<p><a href=\"http://port70.net/%7Ensz/c/c11/n1570.html#7.21.6.1p4\" rel=\"noreferrer\"><strong>7.21.6.1 - p4 to p8</strong></a></p>\n<blockquote>\n<p>Each conversion specification is introduced by the character %. After the %, the following appear in sequence: ...</p>\n<p>The flag characters and their meanings are: ...</p>\n<p>The conversion specifiers and their meanings are: ...</p>\n</blockquote>\n<p>This here means that any conversion specification that is composed from the elements in the above lists is valid, all others are not in the eyes of the standard. That's why the paragraph in your code mentions two causes of UB. One is a specification that is not according to the grammar, and the other is specification and type mismatch.</p>\n<p>The comment you linked to seems to use &quot;invalid&quot; colloquially. I.e. both uses of the conversion specifications are &quot;invalid&quot;, since they lead to UB. But only the first is &quot;invalid&quot; from a language lawyer standpoint.</p>\n"}, {"comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1502281923, "post_id": 45589379, "comment_id": 78140442, "body": "OK, a downvote to the question and my answer at the same time. I guess it shows disagreement. may I please ask to chime in instead of staying silent so that I (and probably others, too) can gain some more knowledge / insight? Thank you . :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1502286125, "last_edit_date": 1502286125, "creation_date": 1502278041, "answer_id": 45589379, "question_id": 45588405, "link": "https://stackoverflow.com/questions/45588405/what-is-exactly-an-invalid-conversion-specification/45589379#45589379", "title": "What is exactly an &quot;invalid conversion specification&quot;?", "body": "<p><kbd><b>To support my understanding (and probably to reasonify the understanding in first place), let me add my two cents.</b></kbd></p>\n\n<p>For a minute, let's see the footnote 282, as mentioned in quote. It says,</p>\n\n<blockquote>\n  <p>See \u2018\u2018future library directions\u2019\u2019 (7.31.11).</p>\n</blockquote>\n\n<p>and in \u00a77.31.11</p>\n\n<blockquote>\n  <p>Lowercase letters may be added to the conversion specifiers and length modifiers in\n  <code>fprintf</code> and <code>fscanf</code>. Other characters may be used in extensions.</p>\n</blockquote>\n\n<p>Which mentions nothing about the relation between a CS and its argument (if any). So, the \"validity\" of a CS is not dependent on the supplied argument.</p>\n\n<p>Now, that said, couple of more pointers</p>\n\n<ul>\n<li><p><strong>Point 1 :: Please note</strong> the mention of the phrase \"conversion specification\", <strong>not</strong>  conversion specifier, in the quote. As per chapter \u00a77.21.6.1/P4, </p>\n\n<blockquote>\n  <p>Each conversion specification is introduced by the character <code>%</code>. After the <code>%</code>, the following\n  appear in sequence:</p>\n  \n  <ul>\n  <li><p>Zero or more flags [...]</p></li>\n  <li><p>An optional minimum field width [...]</p></li>\n  <li><p>An optional precision [...]</p></li>\n  <li><p>An optional length modifier [...]</p></li>\n  <li><p>A conversion specifier character [...]</p></li>\n  </ul>\n</blockquote>\n\n<p>and we have definitive lists for all the elements mentioned in</p>\n\n<ul>\n<li>P5, field width and precision </li>\n<li>P6, flags</li>\n<li>P7, length modifier</li>\n<li>P8, conversion specifier</li>\n</ul>\n\n<p>Thereby, there is (or should be) no relation with the supplied argument to identify the \"validity\" of the conversion specification.</p>\n\n<p>To complement this understanding, borrowing words from the <a href=\"https://stackoverflow.com/questions/45588405/what-is-exactly-an-invalid-conversion-specifier/45588691#comment78136744_45588405\">comment by Ajay Brahmakshatriya</a></p>\n\n<blockquote>\n  <p><em>\"I think the operating word here is \"corresponding\". The first sentence says that if in the string exists a specifier which is not valid. If not, then each specifier is matched with its corresponding argument. Then the second statement says about type matching.....I think the second example does not lie in the first category because \"corresponding\" is not used\"</em></p>\n</blockquote></li>\n<li><p><strong>Point 2 ::</strong> On the other hand, spec is quite distinct and clear about a \"mismatch\" between the CS and the supplied corresponding argument type. So, that is a different case altogether.</p></li>\n</ul>\n\n<p>Now, for example, in case, both the cases are combined, it's hard to tell <em>which</em> condition causes the UB, but it's UB, for more than one reason, for sure. </p>\n\n<p>Example:</p>\n\n<pre><code>   printf(\"%D\", str);\n</code></pre>\n\n<p>following the question.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1502281899, "last_edit_date": 1502281899, "creation_date": 1502281425, "answer_id": 45590637, "question_id": 45588405, "link": "https://stackoverflow.com/questions/45588405/what-is-exactly-an-invalid-conversion-specification/45590637#45590637", "title": "What is exactly an &quot;invalid conversion specification&quot;?", "body": "<p>The footnote 282 points to <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.31.11p1\" rel=\"nofollow noreferrer\">Future library directions C11 7.31.11p1</a>:</p>\n\n<blockquote>\n  <p>Lowercase letters may be added to the conversion specifiers and length modifiers in fprintf and fscanf. Other characters may be used in extensions.</p>\n</blockquote>\n\n<p>so it too hints that invalid conversion specifiers mean those conversion specifications that are <em>not</em> in the list, and of those, <em>lowercase letters</em> might be used by a future C version; and extensions are free to use other letters.</p>\n\n<hr>\n\n<p>And while non-normative, the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">C11 Appendix J.2.</a> contains the following:</p>\n\n<blockquote>\n  <ul>\n  <li>An invalid conversion specification is found in the format for one of the formatted input/output functions, or the <code>strftime</code> or <code>wcsftime</code> function (7.21.6.1, 7.21.6.2, 7.27.3.5, 7.29.2.1, 7.29.2.2, 7.29.5.1). </li>\n  </ul>\n</blockquote>\n\n<p>i.e. an invalid conversion specification to <code>*printf</code> is here paired with invalid conversion specification to <code>strftime</code> - which does not take variable arguments, and the invalidity cannot arise from mismatch between the conversion specification and the corresponding argument;</p>\n\n<p>This can be contrasted with</p>\n\n<blockquote>\n  <ul>\n  <li>There are insufficient arguments for the format in a call to one of the formatted input/output functions, or an argument does not have an appropriate type (7.21.6.1, 7.21.6.2, 7.29.2.1, 7.29.2.2).</li>\n  </ul>\n</blockquote>\n\n<p>which discusses the mismatch between the arguments and the conversion specifiers, without mentioning the word invalid.</p>\n"}], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2188, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1502286344, "creation_date": 1502275312, "last_edit_date": 1502286024, "question_id": 45588405, "link": "https://stackoverflow.com/questions/45588405/what-is-exactly-an-invalid-conversion-specification", "title": "What is exactly an &quot;invalid conversion specification&quot;?", "body": "<p>As per <code>C11</code>, chapter \u00a77.21.6.1, P9</p>\n\n<blockquote>\n  <p>If a conversion specification is invalid, the behavior is undefined.<sup>282)</sup> If any argument is\n  not the correct type for the corresponding conversion specification, the behavior is\n  undefined.</p>\n</blockquote>\n\n<p>Till time, my understanding was, for</p>\n\n<pre><code>  char str [] = \"Sourav\";\n</code></pre>\n\n<ul>\n<li>A statement like <code>printf(\"%S\", str);</code> belong to the first sentence, there exist no CS as <code>%S</code> (UPPERCASE)</li>\n<li>A statement like <code>printf(\"%d\", str);</code> belongs to the second sentence (mismatch between CS and argument type, but the <code>%d</code> is <strong>not</strong> an \"invalid\" CS, anyway)</li>\n</ul>\n\n<p><a href=\"https://stackoverflow.com/a/45587424/2173917\">until advised otherwise</a> by a recent comment thread. </p>\n\n<p>Is my understanding wrong? Can the second statement <em>also</em> be categorized as \"invalid\" (PS- not \"wrong\") conversion specifier?</p>\n\n<hr>\n\n<p><sub>Update: The answer and the comment thread is deleted, <a href=\"https://i.stack.imgur.com/CbATv.jpg\" rel=\"nofollow noreferrer\">here's a snap</a> for &lt;10K users.</sub></p>\n"}, {"tags": ["c", "dynamic-programming"], "comments": [{"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 1, "creation_date": 1502276306, "post_id": 45588379, "comment_id": 78136213, "body": "<code>linux</code> / <code>windows</code> ?"}, {"owner": {"reputation": 1633, "user_id": 3022712, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eadc29ffebbca6135b8e45373d159112?s=128&d=identicon&r=PG&f=1", "display_name": "yar", "link": "https://stackoverflow.com/users/3022712/yar"}, "edited": false, "score": 0, "creation_date": 1502276879, "post_id": 45588379, "comment_id": 78136598, "body": "do not use C for this, if you don&#39;t really have to!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 2, "creation_date": 1502276930, "post_id": 45588379, "comment_id": 78136633, "body": "write a <code>compar()</code> function for <code>qsort()</code>."}, {"owner": {"reputation": 739, "user_id": 8281970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/abHXs.jpg?s=128&g=1", "display_name": "Ketan Mukadam", "link": "https://stackoverflow.com/users/8281970/ketan-mukadam"}, "edited": false, "score": 1, "creation_date": 1502282588, "post_id": 45588379, "comment_id": 78140984, "body": "You can check <a href=\"https://stackoverflow.com/questions/612097/how-can-i-get-the-list-of-files-in-a-directory-using-c-or-c\">this</a> for listing files in a directory, then check <a href=\"https://stackoverflow.com/questions/9342789/how-to-get-file-modification-time-in-c-under-multiple-os\">this</a> to get modification time of file and finally check <a href=\"https://stackoverflow.com/questions/22003586/delete-files-from-a-specific-folder-in-c\">this</a> to delete files."}], "owner": {"reputation": 29, "user_id": 7820502, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/89fb278be8ffb5bf98c60393feee3c0a?s=128&d=identicon&r=PG&f=1", "display_name": "vishwa", "link": "https://stackoverflow.com/users/7820502/vishwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 804, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502286022, "creation_date": 1502275265, "last_edit_date": 1502286022, "question_id": 45588379, "link": "https://stackoverflow.com/questions/45588379/sorting-of-files-list-in-directory-based-on-modifaction-date-in-c-programming", "title": "Sorting of files list in directory based on modifaction date in C programming", "body": "<p>I am trying to figure out how to apply a C program function to sort the file lists of the sub-folders inside my parent directory with modification date.  For instance, if I have 12 files inside a directory called foo, I'd like to sort them by modification date and then remove the oldest 6. How should I approach this?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 46073, "user_id": 3002139, "user_type": "moderator", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/tYIVC.png?s=128&g=1", "display_name": "Baum mit Augen", "link": "https://stackoverflow.com/users/3002139/baum-mit-augen"}, "edited": false, "score": 4, "creation_date": 1502275332, "post_id": 45588357, "comment_id": 78135484, "body": "<i>&quot;I was experimenting the behaviors of pointer in C&quot;</i> Don&#39;t do that, that will not teach you anything useful. Read a good book instead; preferably one not from the 90s when <code>main</code> without a return type used to be legal."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502275486, "post_id": 45588357, "comment_id": 78135614, "body": "You cannot get the address of the address of <code>int a</code> because <code>&amp;a</code> might not even <i>be</i> in memory - it could be in a register."}, {"owner": {"reputation": 381, "user_id": 5200533, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LrL0t.jpg?s=128&g=1", "display_name": "biswasJUCSE", "link": "https://stackoverflow.com/users/5200533/biswasjucse"}, "edited": false, "score": 1, "creation_date": 1502275775, "post_id": 45588357, "comment_id": 78135821, "body": "I know I cannot get the address of the address. My question is about the error given. What is the meaning of <code>label \u2018a\u2019 used but not defined</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502276390, "post_id": 45588357, "comment_id": 78136283, "body": "Because <code>a</code> is a variable, not a label (GCC extension)?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502299617, "post_id": 45588357, "comment_id": 78153595, "body": "Use <code>printf(&quot;%p\\n&quot;, &amp; &amp;a);</code> to attempt the address of an address."}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 6, "last_activity_date": 1502297427, "last_edit_date": 1502297427, "creation_date": 1502275348, "answer_id": 45588417, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable/45588417#45588417", "title": "Address of address of a variable", "body": "<p><code>&amp;&amp;</code> is real <code>gcc</code> extension, but not for variables. Its for labels.</p>\n\n<p><code>&amp;&amp;a</code> is used to <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">get the address of a label defined in the current function</a>.</p>\n\n<p>In your case compiler deduced that <code>a</code>, followed by <code>&amp;&amp;</code> operator, is <code>label</code>, but you haven't any <code>label</code> <code>a</code> defined in your code, so that is the error.</p>\n"}, {"tags": [], "owner": {"reputation": 814, "user_id": 6263041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ir86i.png?s=128&g=1", "display_name": "The Techel", "link": "https://stackoverflow.com/users/6263041/the-techel"}, "is_accepted": false, "score": 2, "last_activity_date": 1502275365, "creation_date": 1502275365, "answer_id": 45588423, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable/45588423#45588423", "title": "Address of address of a variable", "body": "<p>You are not allowed to take the address of an rvalue-temporary returned by the address operator. &amp;&amp; is a gcc-extension:\n<a href=\"https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Labels-as-Values.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 815, "user_id": 7568923, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/HXr7L.jpg?s=128&g=1", "display_name": "Malek Zarkouna", "link": "https://stackoverflow.com/users/7568923/malek-zarkouna"}, "is_accepted": false, "score": 0, "last_activity_date": 1502275599, "creation_date": 1502275599, "answer_id": 45588507, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable/45588507#45588507", "title": "Address of address of a variable", "body": "<p>&amp; is just to get the adresse of the memory box try to use pointers .</p>\n\n<p><a href=\"https://www.tutorialspoint.com/cprogramming/c_pointers.htm\" rel=\"nofollow noreferrer\">https://www.tutorialspoint.com/cprogramming/c_pointers.htm</a></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502300060, "post_id": 45589637, "comment_id": 78153852, "body": "&quot;Where is where is my car?&quot; --&gt; &quot;There, there&quot; ;-)"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 4, "last_activity_date": 1502278784, "creation_date": 1502278784, "answer_id": 45589637, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable/45589637#45589637", "title": "Address of address of a variable", "body": "<p>This isn't really a direct answer to your question.  It's more for anyone reading wondering why you can't take an address of an address when such things as <code>char **ptr;</code> can be defined.</p>\n\n<p>An address doesn't <em>have</em> an address.  Only actual variables in memory have an address.  You can put an address in a pointer variable (as noted in other answers here), and then the <em>pointer variable</em> will have an address, but the address value held in the pointer doesn't inherently have its own address.</p>\n\n<p>An address is effectively \"where something is\".  Trying to find the address of an address is like trying to ask \"Where is where is my car?\"</p>\n\n<p>So <code>char **ptr;</code> isn't the address of an address, it's a variable that contains the address of a pointer <em>variable</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502279330, "creation_date": 1502279330, "answer_id": 45589827, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable/45589827#45589827", "title": "Address of address of a variable", "body": "<p>it quite logical the address is not something which exists somewhere physical in the memory - so it cant have the address itself. That is the reason the <code>&amp;&amp;</code> operator could be used for other purposes.</p>\n\n<p>if you try </p>\n\n<pre><code>int x ;\nprintf(\"%d\\n\", &amp;x); // valid\nprintf(\"%d\\n\", &amp;(&amp;x));  // error lvalue required as the address is not the object\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 5200533, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LrL0t.jpg?s=128&g=1", "display_name": "biswasJUCSE", "link": "https://stackoverflow.com/users/5200533/biswasjucse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 1, "accepted_answer_id": 45588417, "answer_count": 5, "score": 3, "last_activity_date": 1502297427, "creation_date": 1502275203, "last_edit_date": 1592644375, "question_id": 45588357, "link": "https://stackoverflow.com/questions/45588357/address-of-address-of-a-variable", "title": "Address of address of a variable", "body": "<p>I was experimenting the behaviors of pointer in C. I wrote the following program:</p>\n<pre><code>#include &lt;stdio.h&gt;\nmain(){\n    int a = 1;\n    printf(&quot;%p\\n&quot;, &amp;&amp;a);\n}\n</code></pre>\n<p>I knew that this program would give error. Because an address of address would be ambiguous and this would become extremely recursive. But when I tried to compile the program, it gave an error which I couldn't understand.</p>\n<blockquote>\n<p>error: label \u2018a\u2019 used but not defined</p>\n<p>printf(&quot;%p\\n&quot;, &amp;&amp;a);</p>\n</blockquote>\n<p>What does it mean by <code>label \u2018a\u2019 used but not defined</code>?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502274847, "post_id": 45588183, "comment_id": 78135110, "body": "1) no 2) yes 3) no"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502274868, "post_id": 45588183, "comment_id": 78135120, "body": "Document it, <i>well</i>, and let the caller free the memory. That of course means you can not call it like that, just discarding the pointer once it done being used in the <code>printf</code> call."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1502274895, "post_id": 45588183, "comment_id": 78135137, "body": "Another option is to pass in a buffer (and its max-size) as argument to the function and use that buffer, again letting the caller handle it."}, {"owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "edited": false, "score": 0, "creation_date": 1502275012, "post_id": 45588183, "comment_id": 78135219, "body": "fix your indentation, it is hard to read your code"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8415905"}, "edited": false, "score": 0, "creation_date": 1502277249, "post_id": 45588696, "comment_id": 78136868, "body": "The options you showed and especially answer number 3 were what I was looking for. I would love if you could elaborate on answer 1: would declaring and freeing &quot;visname&quot; in main will also free the memory from &quot;visname&quot; in &quot;fun&quot; function? For reference, I&#39;d like to point out that since I want a char of variable length - that is impossible to implement without freeing it later."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502277469, "post_id": 45588696, "comment_id": 78137024, "body": "I do not understand what you mean. But I understand it corectly : You cant free memory and use it somewhere else (unless you have copied its content to another allocated location before freeing). It is the same as with the cake :)"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502276428, "last_edit_date": 1502276428, "creation_date": 1502276076, "answer_id": 45588696, "question_id": 45588183, "link": "https://stackoverflow.com/questions/45588183/returning-strings-from-external-function-while-preventing-memory-leaks/45588696#45588696", "title": "Returning strings from external function while preventing memory leaks", "body": "<ol>\n<li><p>No you need to free it outside the function.</p></li>\n<li><p>You can printf it if you have allocated the memory for it (and have a valid string there) as printf does not change its parameters.</p></li>\n<li><p>No as the the local variable will invalidate on the function exit and you will return the pointer to the non existing (in the non this function scope) object.</p>\n\n<pre><code>int main() {\n   ...\n   char *ptr;\n   for (int n=0; n&lt;ips; n++) {\n       printf(\"%s\\n\", (ptr = fun(ip[n])) );\n       free(ptr);\n    }\n    return 0;\n}\n</code></pre></li>\n</ol>\n\n<p>After your edit;</p>\n\n<pre><code>    int main() {\n       ...\n       char ptr[MAXHOSTNAMESIZE +1];\n       for (int n=0; n&lt;ips; n++) {\n           printf(\"%s\\n\", (fun(ip[n], ptr)) );\n        }\n        return 0;\n    }\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    int main() {\n       ...\n       char *ptr = malloc(MAXHOSTNAMESIZE +1);\n       for (int n=0; n&lt;ips; n++) {\n           printf(\"%s\\n\", (fun(ip[n], ptr)) );\n        }\n        free(ptr)\n        return 0;\n    }\n\nchar *fun(char *ip, char *buff) {\n    struct addrinfo* res;\n    int error;\n\n    ///......\n    error = getnameinfo(res-&gt;ai_addr, res-&gt;ai_addrlen, buff, NI_MAXHOST, NULL, 0, 0);\n    if (error != 0) {\n        fprintf(stderr, \"error in getnameinfo: %s\\n\", gai_strerror(error));\n    }\n    //....\n    return buff;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8415905"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1504882884, "creation_date": 1502274717, "last_edit_date": 1504882884, "question_id": 45588183, "link": "https://stackoverflow.com/questions/45588183/returning-strings-from-external-function-while-preventing-memory-leaks", "title": "Returning strings from external function while preventing memory leaks", "body": "<p>I'm trying to pass a string of variable length through getaddrinfo function, my code is basically:</p>\n\n<pre><code>char *fun(char *ip) {\n    struct addrinfo* res;\n    int error;\n\n    // resolve the domain name into a list of addresses \n    error = getaddrinfo(ip, NULL, NULL, &amp;res);\n    if (error != 0) {   \n       if (error == EAI_SYSTEM) {\n          perror(\"getaddrinfo\");\n       } else {\n          fprintf(stderr, \"error in getaddrinfo: %s\\n\", gai_strerror(error));\n       }   \n       exit(EXIT_FAILURE);\n    }\n\n    // go over returned result and do inverse lookup\n    char hostname[NI_MAXHOST];\n    error = getnameinfo(res-&gt;ai_addr, res-&gt;ai_addrlen, hostname, NI_MAXHOST, NULL, 0, 0); \n    if (error != 0) {\n       fprintf(stderr, \"error in getnameinfo: %s\\n\", gai_strerror(error));\n    }\n\n    // here I use a pointer in order to pass the string without gcc complain about passing a local var\n    char *visname = strdup(hostname);\n\n    /* if I uncomment the below then string is passed correctly */\n    // printf(\"%s\\n\", hostname);\n\n    freeaddrinfo(res);\n    return visname;\n }\n\nint main() {\n    ...\n    for (int n=0; n&lt;ips; n++) {\n       printf(\"%s\\n\", fun(ip[n]) );\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Now here's the thing:</p>\n\n<ol>\n<li>If I use strdup to copy \"hostname\" to \"visname\" then I'm pretty sure I need to free visname somehow, however since I'm passing it through return my question is whether freeing it after return (inside \"fun\" function) is ok?</li>\n<li>If I print \"hostname\" or \"visname\" inside \"fun\" and then pass it - that also seems to work, though my assumption is it might be due to \"undefined behavior\"?</li>\n<li>Since char *visname is a pointer to the local variable \"hostname\", shouldn't simply: char *visname = hostname work (i.e. return the hostname string)?</li>\n</ol>\n\n<h2>Edit</h2>\n\n<p>I'm pretty sure I can pass a string as a parameter to fun function and then return it, but since it's of variable length then that mean I'll need to keep freeing it every time.</p>\n\n<p>So my preference is to somwhow pass the hostname through the function and then I'll handle it inside main...</p>\n"}, {"tags": ["c#", "c", "winapi", "structure", "unions"], "comments": [{"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1502275135, "post_id": 45588143, "comment_id": 78135326, "body": "Are you aware what a C <code>union</code> is?"}, {"owner": {"reputation": 145, "user_id": 3874443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8dfbcec147bae630c9e89f1c7d306fa?s=128&d=identicon&r=PG&f=1", "display_name": "IceTrailer", "link": "https://stackoverflow.com/users/3874443/icetrailer"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1502275208, "post_id": 45588143, "comment_id": 78135383, "body": "I tried to understand"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 3874443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8dfbcec147bae630c9e89f1c7d306fa?s=128&d=identicon&r=PG&f=1", "display_name": "IceTrailer", "link": "https://stackoverflow.com/users/3874443/icetrailer"}, "edited": false, "score": 0, "creation_date": 1502276205, "post_id": 45588576, "comment_id": 78136129, "body": "Thank you! I did not know the possibility to only write <code>ulong</code> instead. It now works!"}], "tags": [], "owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "is_accepted": false, "score": 2, "last_activity_date": 1502276557, "last_edit_date": 1502276557, "creation_date": 1502275757, "answer_id": 45588576, "question_id": 45588143, "link": "https://stackoverflow.com/questions/45588143/use-win32api-unions-within-structures-generate-typeloadexception/45588576#45588576", "title": "Use Win32API: unions within structures generate TypeLoadException", "body": "<p>There's really no point in trying to declare this as a union. It's an unsigned 64 bit type. Just use <code>ulong</code> instead of the struct. </p>\n\n<p>If you never need to display the address, then you would need to pick out just the first 6 bytes of that <code>ulong</code>. A Bluetooth address is a 48 bit value, hence 6 bytes. </p>\n\n<p>But for your purposes there's nothing to be gained by trying to express that nuance in the type used for interop. Which is why I would recommend working with <code>ulong</code> for the interop and picking out the meaningful bytes if necessary as a separate action. </p>\n"}, {"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1502353741, "post_id": 45592362, "comment_id": 78175277, "body": "This is really the wrong way to solve the problem. If you want to enable the access of the meaningful 6 bytes, do that with access methods. Unsafe code, explicit layout, fixed, all needless complexity for no gain."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1502446002, "post_id": 45592362, "comment_id": 78223820, "body": "@DavidHeffernan True, as I mentioned in the answer, OP is probably better off avoiding the unsafe code, but it&#39;s still reasonable to make corrections to errors in the OP&#39;s original attempt to translate the C union members into a C# struct. There are also endianness issues with treating a bluetooth address as a <code>ulong</code> value when it is really a sequence of 6 bytes."}], "tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": true, "score": 1, "last_activity_date": 1502286293, "last_edit_date": 1502286293, "creation_date": 1502285933, "answer_id": 45592362, "question_id": 45588143, "link": "https://stackoverflow.com/questions/45588143/use-win32api-unions-within-structures-generate-typeloadexception/45592362#45592362", "title": "Use Win32API: unions within structures generate TypeLoadException", "body": "<p>To help you understand the error, note the following:</p>\n\n<ol>\n<li><p>All members of a C union type have overlapping storage that begins at offset 0, so the offset of member <code>rgBytes</code> in your C# struct should use <code>[FieldOffset(0)]</code>, not <code>[FieldOffset(2)]</code>.</p></li>\n<li><p>The type of the <code>rgBytes</code> member in the C union is a fixed array of 6 bytes. In your C# struct it is a <code>byte[]</code> array type.  A (normal) array type in C# is a \"reference type\", which can be thought of as being like a C pointer.  That is, the object just holds a reference (pointer) to a value on the heap.</p></li>\n<li><p>You can create a fixed array using the <code>fixed</code> keyword as follows:</p>\n\n<p><code>fixed byte rgBytes[6];</code></p>\n\n<p>Fixed arrays are unsafe code, so the above needs to be declared <code>unsafe</code>. It is also declared <code>public</code> in your struct, so the full declaration of the <code>rgBytes</code> member can be as follows:</p>\n\n<p><code>public unsafe fixed byte rgBytes[6];</code></p></li>\n</ol>\n\n<p>Putting it all together gives the following C# declaration for <code>BLUETOOTH_ADDRESS</code>:</p>\n\n<pre><code>[StructLayout(LayoutKind.Explicit, Size = 8)]\npublic struct BLUETOOTH_ADDRESS\n{\n    [FieldOffset(0)]\n    public ulong ullLong;\n\n    [FieldOffset(0)]\n    public unsafe fixed byte rgBytes[6];\n};\n</code></pre>\n\n<p>You can probably leave out the <code>Size = 8</code> part.</p>\n\n<p>As per David Heffernan's answer, you are probably better off just using a <code>ulong</code>, especially as that will avoid any \"unsafe\" code.</p>\n"}], "owner": {"reputation": 145, "user_id": 3874443, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8dfbcec147bae630c9e89f1c7d306fa?s=128&d=identicon&r=PG&f=1", "display_name": "IceTrailer", "link": "https://stackoverflow.com/users/3874443/icetrailer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 45592362, "answer_count": 2, "score": 0, "last_activity_date": 1502286293, "creation_date": 1502274616, "last_edit_date": 1502275445, "question_id": 45588143, "link": "https://stackoverflow.com/questions/45588143/use-win32api-unions-within-structures-generate-typeloadexception", "title": "Use Win32API: unions within structures generate TypeLoadException", "body": "<p>I'd like to import an extern function of Win32API.</p>\n\n<p>The Code from the API (in C) looks like this:</p>\n\n<pre><code>typedef struct _BLUETOOTH_ADDRESS {\n  union {\n    BTH_ADDR ullLong;\n    BYTE     rgBytes[6];\n  };\n} BLUETOOTH_ADDRESS;\n</code></pre>\n\n<p>My C# implementation looks like this:</p>\n\n<pre><code>[StructLayout(LayoutKind.Explicit, Size = 8)]\npublic struct BLUETOOTH_ADDRESS\n{\n    [FieldOffset(0)]\n    public ulong ullLong;\n\n    [FieldOffset(2)]\n    public byte[] rgBytes;\n};\n</code></pre>\n\n<p>The problem is: As soon as I create the struct, it throws me a TypeLoadException, error Code:\nSystem.TypeLoadException: \"Could not load type 'BLUETOOTH_ADDRESS' from assembly 'BleLab, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' because it contains an object field at offset 2 that is incorrectly aligned or overlapped by a non-object field.\"</p>\n\n<p>Do you have any idea to fix this or where the problem is?</p>\n\n<p>Best regards</p>\n\n<p><strong>Edit:</strong>\nForgot to provide the way of calling:</p>\n\n<pre><code>var ba = new Win32API.BLUETOOTH_ADDRESS();\nba.rgBytes = new byte[6];\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1502274596, "post_id": 45588116, "comment_id": 78134912, "body": "<code>&#47;&#47; what&#39;s the output of following code and why ?</code>...did you atleast try running and understanding the output?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502274605, "post_id": 45588116, "comment_id": 78134921, "body": "Well, what <b>is</b> the output? Run it and tell us (end especially tell us what confuses you about it)"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1502274606, "post_id": 45588116, "comment_id": 78134922, "body": "What output do you expect and what output do you get, please edit your question and make that clear."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502274702, "post_id": 45588116, "comment_id": 78134992, "body": "My guess it&#39;s about <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-buffer\">this issue</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502274704, "post_id": 45588116, "comment_id": 78134996, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-buffer\">scanf() leaves the new line char in buffer?</a>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502274759, "post_id": 45588116, "comment_id": 78135036, "body": "Is it about output of the program or &quot;unusal output&quot; of the compiler? Please be more precise."}, {"owner": {"reputation": 3, "user_id": 7570131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HQ5N8O0B2FA/AAAAAAAAAAI/AAAAAAAAAKc/uB7yrj0mYLE/photo.jpg?sz=128", "display_name": "Vikas Rathod", "link": "https://stackoverflow.com/users/7570131/vikas-rathod"}, "edited": false, "score": 0, "creation_date": 1502274794, "post_id": 45588116, "comment_id": 78135062, "body": "Enter First char:a Enter Second char:Enter Third char:c  it shows the above output. i am not getting why?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1502274835, "post_id": 45588116, "comment_id": 78135103, "body": "@VikasRathod please <a href=\"https://stackoverflow.com/posts/45588116/edit\">edit</a> your question and put clarifications <i>there</i>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502275060, "post_id": 45588116, "comment_id": 78135268, "body": "... as <i>text</i> not image please. You can read the duplicate question linked for an explanation and <a href=\"https://stackoverflow.com/a/5240807/4142924\">solution</a>."}, {"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 1, "creation_date": 1502275757, "post_id": 45588116, "comment_id": 78135811, "body": "Basic debug (printing a, b and c) would have answered this question before it was even posted...  Possible duplicate of <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-buffer\">scanf() leaves the new line char in buffer?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502275624, "post_id": 45588382, "comment_id": 78135721, "body": "The trailing space in <code>&quot;%c &quot;</code> is not advised, the leading space is good."}], "tags": [], "owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "is_accepted": true, "score": 0, "last_activity_date": 1502275267, "creation_date": 1502275267, "answer_id": 45588382, "question_id": 45588116, "link": "https://stackoverflow.com/questions/45588116/whats-the-output-of-following-program-which-shows-the-unusual-output-and-why/45588382#45588382", "title": "What&#39;s the output of following program which shows the unusual output and why?", "body": "<p>First time you type <code>1</code> and hit <code>Enter</code> (<code>Enter</code> is interpreted as newline character)</p>\n\n<p>The first scanf reads <code>'1'</code>.</p>\n\n<p>The second scanf reads <code>'\\n'</code>.</p>\n\n<p>Then you type <code>2</code> and click <code>Enter</code>.  The third scanf reads <code>'2'</code>.</p>\n\n<p>Probably you need to read <code>\"%c \"</code> or <code>\" %c\"</code>, since <code>' '</code> in format string skips all whitespaces.</p>\n"}], "owner": {"reputation": 3, "user_id": 7570131, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HQ5N8O0B2FA/AAAAAAAAAAI/AAAAAAAAAKc/uB7yrj0mYLE/photo.jpg?sz=128", "display_name": "Vikas Rathod", "link": "https://stackoverflow.com/users/7570131/vikas-rathod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 45588382, "answer_count": 1, "score": -1, "last_activity_date": 1502293252, "creation_date": 1502274538, "last_edit_date": 1502293252, "question_id": 45588116, "link": "https://stackoverflow.com/questions/45588116/whats-the-output-of-following-program-which-shows-the-unusual-output-and-why", "title": "What&#39;s the output of following program which shows the unusual output and why?", "body": "<p><a href=\"https://i.stack.imgur.com/oX1w8.png\" rel=\"nofollow noreferrer\">see the ouput image</a></p>\n\n<p>What's the output of following code and why?</p>\n\n<p>I am curious to know why c compiler shows the unusual output.</p>\n\n<p>What happens behind the scene?</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    char a,b,c;\n\n    printf(\"Enter First char:\");\n    scanf(\"%c\",&amp;a);\n\n    printf(\"Enter Second char:\");\n    scanf(\"%c\",&amp;b);\n\n    printf(\"Enter Third char:\");\n    scanf(\"%c\",&amp;c);\n\n    return 1;\n}\n\n\nEnter First char:a\nEnter Second char:Enter Third char:c\n</code></pre>\n\n<p>see above output, its not taking 2nd input and directly asking third one!</p>\n"}, {"tags": ["c++", "c", "gtkmm", "gtkmm3"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502273506, "post_id": 45587310, "comment_id": 78134076, "body": "C is not C++. Please don&#39;t spam with unrelated language tags."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502273698, "post_id": 45587310, "comment_id": 78134239, "body": "How many threads do you use? Is this loop executed in the main thread that is also responsible for UI updates?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502643449, "post_id": 45587310, "comment_id": 78283104, "body": "Any updates here?"}], "answers": [{"tags": [], "owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "is_accepted": false, "score": 0, "last_activity_date": 1502280183, "creation_date": 1502280183, "answer_id": 45590155, "question_id": 45587310, "link": "https://stackoverflow.com/questions/45587310/progressbar-with-gtkmm-in-c/45590155#45590155", "title": "ProgressBar with Gtkmm in c++", "body": "<p>When you want to use a progress bar (or spinner, etc.) that should actually change its appearance, you need to ensure that the main thread gets some time to update the UI accordingly.</p>\n\n<p>If you have a loop in main thread that sets new values and blocks the thread in <code>getchar()</code>, this thread cannot update the UI to reflect the new state of any widget.</p>\n\n<p>To see your updates you should move the loop calling <code>getchar</code> in some other thread and only do the <code>gtk_*</code> function call in the main thread. This can be achieved by enqueing an update-function via <code>g_idle_add()</code>.</p>\n\n<p>Then the UI can be updated while your thread is blocked.</p>\n\n<p>If you replace <code>getchar</code> by some other action that takes some time, this other activity will also prevent the thread from updating the UI unless you move it in some other thread.</p>\n\n<p>You might also think about other mechanisms to return control back to the main thread between updating the widget's state.</p>\n"}], "owner": {"reputation": 81, "user_id": 8382015, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/65d199d20a6a3a075237cd01efcf3c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Norman Wildermuth", "link": "https://stackoverflow.com/users/8382015/norman-wildermuth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502280183, "creation_date": 1502272438, "question_id": 45587310, "link": "https://stackoverflow.com/questions/45587310/progressbar-with-gtkmm-in-c", "title": "ProgressBar with Gtkmm in c++", "body": "<p>Hello I know how to create a progressBar with Gtkmm. I know also with a button how when I click on the button the progressBar increase of 10% for instance. But I don't know how to implement a progressBar which increase automatically I mean like this :</p>\n\n<pre><code>for(int i = 0; i&lt;=10; i++){\n\n        double percentage(progressBar.get_fraction() + 0.1);\n        progressBar.set_fraction(percentage);\n        getchar();\n} \n</code></pre>\n\n<p>But I don't see when the progressBar increases... I just see when the progressBAr is full...</p>\n\n<p>Thank you for your help !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502270194, "post_id": 45586385, "comment_id": 78131674, "body": "<b>1.</b> <code>checksumTablesResponse</code> is a pointer, is it not <code>NULL</code>? <b>2.</b> <code>(...)-&gt;entry</code> is an array, does it have at least size of 1? <b>3.</b> <code>(...)-&gt;entry[0]</code> is a pointer, is it not <code>NULL</code>?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1502270225, "post_id": 45586385, "comment_id": 78131694, "body": "are (not) you missing couple of <code>typedef</code>s, at least?"}, {"owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "reply_to_user": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "edited": false, "score": 0, "creation_date": 1502270296, "post_id": 45586385, "comment_id": 78131749, "body": "@AndreKampling i updated the question"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502270303, "post_id": 45586385, "comment_id": 78131754, "body": "What are the contents of <code>checksumTablesResponse</code> and <code>checksumTablesResponse-&gt;entry[0]</code> when you step to your function in GDB?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502270379, "post_id": 45586385, "comment_id": 78131806, "body": "&quot;7 values dispalyed&quot; Maybe <code>(...)-&gt;entry[7]</code> is <code>NULL</code> but <code>(..)-&gt;n_entry</code> is larger than 7?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502270417, "post_id": 45586385, "comment_id": 78131833, "body": "did you allocate the memory for  the <code>entry *</code> values?"}, {"owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502270449, "post_id": 45586385, "comment_id": 78131854, "body": "@PeterJ I dont think so, the program is working for display, it&#39;s not mine, it display properly, so entries has memeory allocated I guesss"}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 2, "last_activity_date": 1502357874, "last_edit_date": 1502357874, "creation_date": 1502270938, "answer_id": 45586743, "question_id": 45586385, "link": "https://stackoverflow.com/questions/45586385/correctly-affect-value-of-stuct-pointer/45586743#45586743", "title": "Correctly affect value of stuct pointer", "body": "<p>IMO you have UBs as you do not allocate any memory, and you random results as UB means - <em>everything may happen</em></p>\n\n<pre><code>Protocol__ChecksumTable *checksumTablesResponse;\n</code></pre>\n\n<p>then alloc the memory for the structure and some inits</p>\n\n<pre><code>checksumTablesResponse = malloc(sizeof Protocol__ChecksumTable);\nchecksumTablesResponse -&gt; entry = NULL;\nchecksumTablesResponse -&gt; n_entry = 0;\n</code></pre>\n\n<p>when you add the <em>entry</em></p>\n\n<pre><code>checksumTablesResponse -&gt; entry = realloc(checksumTablesResponse -&gt; entry, sizeof(Protocol__ChecksumEntry *) * (checksumTablesResponse -&gt; n_entry  + 1);\n</code></pre>\n\n<p>then you can add the entry </p>\n\n<pre><code>checksumTablesResponse -&gt; entry[checksumTablesResponse -&gt; n_entry++] = .......\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 45586743, "answer_count": 1, "score": 0, "last_activity_date": 1502357874, "creation_date": 1502270042, "last_edit_date": 1502357808, "question_id": 45586385, "link": "https://stackoverflow.com/questions/45586385/correctly-affect-value-of-stuct-pointer", "title": "Correctly affect value of stuct pointer", "body": "<p>I have the current structures</p>\n\n<pre><code>struct  Protocol__ChecksumTable\n{\n   ProtobufCMessage base;\n   uint32_t tableindex;\n   size_t n_entry;\n   Protocol__ChecksumEntry **entry;\n};\n\nstruct  Protocol__ChecksumEntry\n{\n   ProtobufCMessage base;\n   uint32_t index;\n   uint32_t value;\n};\n</code></pre>\n\n<p>now I declared a <code>Protocol__ChecksumTable*</code> structure filled by a function which return a <code>Protocol__ChecksumTable*</code></p>\n\n<pre><code>Protocol__ChecksumTable *\n   protocol__checksum_tables_response__unpack(void);\n\n...\n\nProtocol__ChecksumTable * checksumTablesResponse;\nchecksumTablesResponse = protocol__checksum_tables_response__unpack();\n</code></pre>\n\n<hr>\n\n<p>And now I want to modify the field entry on <code>Protocol__ChecksumEntry</code> like this:</p>\n\n<pre><code>checksumTablesResponse-&gt;entry[0]-&gt;value = value;\n</code></pre>\n\n<p>the returned value is not null, as I can log it correctly:</p>\n\n<pre><code>for (index = 0; index &lt; checksumTablesResponse-&gt;n_entry; index ++) {\n   LOG(\"checksumTablesResponse-&gt;entry[index]-&gt;value);\n}\n</code></pre>\n\n<p>7 values will be displayed:</p>\n\n<pre><code>3054867360\n3054867360\n379899191\n4128997118\n3185498542\n1736976844\n2545413521\n</code></pre>\n\n<p>But then the program crashes!<br>\nWhat's wrong?</p>\n"}, {"tags": ["c++", "c", "class", "embedded", "mbed"], "comments": [{"owner": {"reputation": 9219, "user_id": 979325, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b513c9edd4da1688c05ba041820011c7?s=128&d=identicon&r=PG", "display_name": "Jepessen", "link": "https://stackoverflow.com/users/979325/jepessen"}, "edited": false, "score": 1, "creation_date": 1502270081, "post_id": 45586344, "comment_id": 78131583, "body": "Create a free function as interface to that class, and use <code>extern &quot;C&quot;</code>. <a href=\"https://stackoverflow.com/questions/1041866/in-c-source-what-is-the-effect-of-extern-c\" title=\"in c source what is the effect of extern c\">stackoverflow.com/questions/1041866/&hellip;</a>"}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 2, "creation_date": 1502270122, "post_id": 45586344, "comment_id": 78131618, "body": "You can not directly use C++ stuff in C. You need to write a C interface wrappers for C++ code first."}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "reply_to_user": {"reputation": 9219, "user_id": 979325, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/b513c9edd4da1688c05ba041820011c7?s=128&d=identicon&r=PG", "display_name": "Jepessen", "link": "https://stackoverflow.com/users/979325/jepessen"}, "edited": false, "score": 0, "creation_date": 1502270211, "post_id": 45586344, "comment_id": 78131681, "body": "@Jepessen but that doesn&#39;t work for classes I thought"}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "reply_to_user": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1502270378, "post_id": 45586344, "comment_id": 78131805, "body": "@VTT and those wrappers are in C++ yes?"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1502270409, "post_id": 45586344, "comment_id": 78131826, "body": "@homeGrown: you may need more than one free function; typically one per member. (including constructor and destructor)."}, {"owner": {"reputation": 32078, "user_id": 7860670, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/LH36y.png?s=128&g=1", "display_name": "user7860670", "link": "https://stackoverflow.com/users/7860670/user7860670"}, "edited": false, "score": 0, "creation_date": 1502270674, "post_id": 45586344, "comment_id": 78132018, "body": "Yes, those wrappers are in C++. But they only expose C stuff."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1502282948, "post_id": 45586344, "comment_id": 78141283, "body": "While C and C++ are inter-operable, if you cannot use C++ at all, then you cannot use the class - since first of all it <i>is</i> C++, and you need to implement the C-linkage wrapper in C++.  Why are you &quot;limited to C&quot;? That makes little sense."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1502270627, "post_id": 45586558, "comment_id": 78131982, "body": "<i>Theoretically</i> you could instantiate and use a C++ class with pure C if you knew the mangled names of the members. If it used any standard containers or other libraries, though, then it would probably fail spectacularly."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1502271234, "post_id": 45586558, "comment_id": 78132441, "body": "@Bartek Banachewicz - Bartek - it is a hack not the sane solution"}, {"owner": {"reputation": 1669, "user_id": 7508077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b4193888717f50e77805498af1435b9?s=128&d=identicon&r=PG&f=1", "display_name": "EsmaeelE", "link": "https://stackoverflow.com/users/7508077/esmaeele"}, "edited": false, "score": 0, "creation_date": 1502306805, "post_id": 45586558, "comment_id": 78157719, "body": "can anyone express how to compile these codes with gcc and g++?"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 6, "last_activity_date": 1502284092, "last_edit_date": 1502284092, "creation_date": 1502270492, "answer_id": 45586558, "question_id": 45586344, "link": "https://stackoverflow.com/questions/45586344/use-c-class-in-a-c-file/45586558#45586558", "title": "Use C++ class in a c file", "body": "<blockquote>\n  <p>How can I use for example a SPI class in a c file.</p>\n</blockquote>\n\n<p>You cannot use a class<sup>\u2020</sup> in C.</p>\n\n<blockquote>\n  <p>From looking online to use C++ classes you should create a wrapper function in C++</p>\n</blockquote>\n\n<p>This is correct.</p>\n\n<blockquote>\n  <p>is their another way around this?</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>but as stated I can't use C++</p>\n</blockquote>\n\n<p>Then you're out of options (as far as the standards are concerned). A C++ API (with classes and everything) cannot be used in C. It is possible to create a wrapper interface that uses only features shared by both languages (which excludes all OOP stuff).</p>\n\n<p>That wrapper interface can only be implemented in C++, because it has to interact with the interface that it is wrapping. If the wrapper could be implemented in C, then there would be no need for it. Once that wrapper interface is implemented, it can be used from C.</p>\n\n<p>Some other points:</p>\n\n<ul>\n<li>If a library uses C++, then <code>main</code> must be implemented in C++. That <code>main</code> can also be a trivial wrapper for a C function, which can be called from C++ without fuss.</li>\n<li>You must link the dependencies of the C++ library, which may include the C++ standard library</li>\n</ul>\n\n<hr>\n\n<p>Example:</p>\n\n<p>C++ API</p>\n\n<pre><code>// interface.hpp\nclass C {\npublic:\n    std::string str;\n};\n</code></pre>\n\n<p>C wrapper for the API</p>\n\n<pre><code>// wrapper.h\nstruct C;\nstruct C* makeC();\nvoid freeC(struct C*);\nvoid setStr(struct C*, char*);\nconts char* getStr(struct C*);\n</code></pre>\n\n<p>Implementation of the wrapper (in C++)</p>\n\n<pre><code>extern \"C\" {\n   #include \"wrapper.h\"\n}\n#include \"interface.hpp\"\n\nC* makeC()                   { return new C; }\nvoid freeC(C* c)             { delete c; }\nvoid setStr(C* c, char* str) { c-&gt;str = str; }\nconst char* getStr(C* c)     { return c-&gt;str.c_str(); }\n</code></pre>\n\n<p>Usage in C</p>\n\n<pre><code>struct C* c = makeC();\nsetStr(c, \"test\");\nputs(getStr(c));\nfreeC(c);\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup>Except when the class definition and all of its sub objects use no C++ features whatsoever. Then it is compatible with an identical C struct.</p>\n"}, {"comments": [{"owner": {"reputation": 4147, "user_id": 6654077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afa3deaf30afffe58c663f22106e4fe9?s=128&d=identicon&r=PG&f=1", "display_name": "Fabien", "link": "https://stackoverflow.com/users/6654077/fabien"}, "edited": false, "score": 2, "creation_date": 1502272611, "post_id": 45587043, "comment_id": 78133449, "body": "&quot;There is no other way&quot; is erroneous. And the answer provides no example whatsoever, so it&#39;s practically useless."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1502271711, "creation_date": 1502271711, "answer_id": 45587043, "question_id": 45586344, "link": "https://stackoverflow.com/questions/45586344/use-c-class-in-a-c-file/45587043#45587043", "title": "Use C++ class in a c file", "body": "<p>Answer is simply - using <strong>mbed</strong> involves using C++.</p>\n\n<p>If you have to program in C forget about <strong>mbed</strong> and write your own SPI library or use one of the many available libraries (frameworks) for your target hardware.</p>\n\n<p>There is no other way</p>\n"}, {"tags": [], "owner": {"reputation": 28, "user_id": 7225914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608d2812f9e439bb5943eee809ee7c88?s=128&d=identicon&r=PG&f=1", "display_name": "Mikolaj", "link": "https://stackoverflow.com/users/7225914/mikolaj"}, "is_accepted": false, "score": -1, "last_activity_date": 1502282692, "creation_date": 1502282692, "answer_id": 45591065, "question_id": 45586344, "link": "https://stackoverflow.com/questions/45586344/use-c-class-in-a-c-file/45591065#45591065", "title": "Use C++ class in a c file", "body": "<p>If you are limited to use C... just use C and compile it as a C++ file. Most code shall be compatible.</p>\n"}, {"comments": [{"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "edited": false, "score": 0, "creation_date": 1502373573, "post_id": 45608808, "comment_id": 78190562, "body": "Looks like exactly what I need. Is their any examples of how to get up and running with this on an arm board (st)"}, {"owner": {"reputation": 24757, "user_id": 107642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/672b033bf66f18d40cff3278f12f8f90?s=128&d=identicon&r=PG", "display_name": "Jan Jongboom", "link": "https://stackoverflow.com/users/107642/jan-jongboom"}, "reply_to_user": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "edited": false, "score": 0, "creation_date": 1502378035, "post_id": 45608808, "comment_id": 78194238, "body": "<code>spi_t spi; spi_init(&amp;spi, SPI_MOSI, SPI_MISO, SPI_SCK, SPI_NSS); spi_frequency(&amp;spi, 4000000); &#47;* etc. *&#47;</code> The right implementation for your board is automatically loaded."}, {"owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "edited": false, "score": 0, "creation_date": 1502378198, "post_id": 45608808, "comment_id": 78194356, "body": "How is it automatically loaded?"}, {"owner": {"reputation": 24757, "user_id": 107642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/672b033bf66f18d40cff3278f12f8f90?s=128&d=identicon&r=PG", "display_name": "Jan Jongboom", "link": "https://stackoverflow.com/users/107642/jan-jongboom"}, "reply_to_user": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "edited": false, "score": 0, "creation_date": 1502439131, "post_id": 45608808, "comment_id": 78219350, "body": "The HAL automatically includes the right implementation for the board. For example, <a href=\"https://github.com/ARMmbed/mbed-os/blob/master/targets/TARGET_STM/TARGET_STM32F4/spi_api.c\" rel=\"nofollow noreferrer\">here is the HAL for STM32F4</a> (and this is loaded through <code>#define</code>&#39;s. If you export a project to makefile then you can see all of them in there.)"}], "tags": [], "owner": {"reputation": 24757, "user_id": 107642, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/672b033bf66f18d40cff3278f12f8f90?s=128&d=identicon&r=PG", "display_name": "Jan Jongboom", "link": "https://stackoverflow.com/users/107642/jan-jongboom"}, "is_accepted": false, "score": 0, "last_activity_date": 1502355017, "creation_date": 1502355017, "answer_id": 45608808, "question_id": 45586344, "link": "https://stackoverflow.com/questions/45586344/use-c-class-in-a-c-file/45608808#45608808", "title": "Use C++ class in a c file", "body": "<p>The mbed HAL is written in C, so you can use that without the C++ wrappers. E.g. here is <a href=\"https://github.com/ARMmbed/mbed-os/blob/master/hal/spi_api.h\" rel=\"nofollow noreferrer\">hal/spi_api.h</a>.</p>\n"}], "owner": {"reputation": 335, "user_id": 5151559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/0004195da11fb0300f7f0b028997aca7?s=128&d=identicon&r=PG&f=1", "display_name": "homeGrown", "link": "https://stackoverflow.com/users/5151559/homegrown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 1, "accepted_answer_id": 45586558, "answer_count": 4, "score": -2, "last_activity_date": 1502355017, "creation_date": 1502269940, "question_id": 45586344, "link": "https://stackoverflow.com/questions/45586344/use-c-class-in-a-c-file", "title": "Use C++ class in a c file", "body": "<p>I need to use the <a href=\"https://docs.mbed.com/docs/mbed-os-api-reference/en/latest/APIs/interfaces/digital/SPI/\" rel=\"nofollow noreferrer\">mbed api</a> but limited to using C. How can I use for example a SPI class in a c file. From looking online to use C++ classes you should create a wrapper function in C++ but as stated I can't use C++, is their another way around this?</p>\n"}, {"tags": ["c", "realloc", "corrupt-data"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1502270050, "post_id": 45586293, "comment_id": 78131554, "body": "Two things you need to look out for: First of all <a href=\"http://en.cppreference.com/w/c/io/fgetc\" rel=\"nofollow noreferrer\"><code>getc</code></a> returns an <code>int</code>. This is important for the <code>EOF</code> check. Secondly I recommend you read <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a>. When you fixed those problems then I recommend you to read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">How to debug small programs</a> by Eric Lippert, and learn how to use a debugger."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1502270112, "post_id": 45586293, "comment_id": 78131610, "body": "<code>&#39;\\0&#39;</code> must be included in the <code>size</code>(<code>len</code>)."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1502270316, "post_id": 45586293, "comment_id": 78131763, "body": "<code>symbole = realloc(s, sizeof(char) * (size += 1));</code> - Please make this two lines of code. Makes debugging easier and the code more readable"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502270418, "post_id": 45586293, "comment_id": 78131835, "body": "Hasn&#39;t a very similar question with very similar source code been asked recently?"}, {"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1502271181, "post_id": 45586293, "comment_id": 78132401, "body": "<code>sizeof(char) * (size += 1)</code> -- oh come on."}, {"owner": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1502271455, "post_id": 45586293, "comment_id": 78132597, "body": "@Groo i changed it to <code>sizeof(char) * (size *= 2)</code> but i still get the same error"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "edited": false, "score": 0, "creation_date": 1502270518, "post_id": 45586509, "comment_id": 78131893, "body": "I defined EOFP like this #define EOFP ((void *)1). Is this correct ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "edited": false, "score": 1, "creation_date": 1502270729, "post_id": 45586509, "comment_id": 78132061, "body": "@NabilaK <code>#define EOFP ((char *)1)</code> would be better, but it&#39;s still a bit hacky."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "edited": false, "score": 2, "creation_date": 1502270806, "post_id": 45586509, "comment_id": 78132117, "body": "@NabilaK: Such a definition is not recommended, you could either return <code>NULL</code> for both end of file and any error condition, as <code>fgets()</code> does too, or you could define <code>EOFP</code> as a global <code>char EOFP[1];</code>"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1502272131, "post_id": 45586509, "comment_id": 78133093, "body": "@EdHeal: not really. <code>char EOFP[1];</code> defines an array whose address is different from anything else, whereas <code>char *EOFP = &quot;&quot;;</code> defines a pointer whose value may be identical to that of other empty strings in the program (although different from any allocated object returned by <code>read_string()</code>)."}, {"owner": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "edited": false, "score": 0, "creation_date": 1502273899, "post_id": 45586509, "comment_id": 78134385, "body": "I have a question : why didn&#39;t you shrink the symbol before returning it ?"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "edited": false, "score": 0, "creation_date": 1502280788, "post_id": 45586509, "comment_id": 78139433, "body": "@NabilaK: I do: <code>s = realloc(symbol, len + 1); return s ? s : symbol;</code> If <code>realloc()</code> succeeds, I return <code>s</code> and if it fails I return <code>symbol</code> which is still valid."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1594628139, "last_edit_date": 1594628139, "creation_date": 1502270361, "answer_id": 45586509, "question_id": 45586293, "link": "https://stackoverflow.com/questions/45586293/realloc-corrupted-data-returned/45586509#45586509", "title": "realloc : corrupted data returned", "body": "<p>There are multiple issues in your code:</p>\n<ul>\n<li><p><code>char car = 0;</code> is incorrect: you must define <code>car</code> as <code>int</code> to correctly distinguish all values returned by <code>getc()</code>, especially <code>EOF</code>.</p>\n</li>\n<li><p><code>while (feof(fichier) == 0)</code> is always wrong. Learn why there: <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">Why is \u201cwhile ( !feof (file) )\u201d always wrong?</a></p>\n</li>\n<li><p><code>EOFP</code> is not defined, you should probably use <code>NULL</code> instead for more clarity.</p>\n</li>\n<li><p>the final <code>realloc()</code> to <em>shrink</em> the allocated block is one byte too short. You must keep <code>len+1</code> bytes for <code>len</code> characters <strong>plus</strong> the null terminator.</p>\n</li>\n</ul>\n<p>Here is a simplified and corrected version:</p>\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nchar EOFP[1];   /* special value used to signal end of file */\n\nchar *read_string(FILE *file) {\n    int c;\n    size_t size, len;\n    char *symbol;\n    char *s;\n\n    while ((c = getc(file)) != '&quot;') {\n        if (c == EOF)\n            return EOFP;\n    }\n    size = 16;\n    len = 0;\n    symbol = malloc(size);\n    if (symbol == NULL) {\n        /* allocation failure */\n        return NULL;\n    }\n    while ((c = getc(file)) != '&quot;') {\n        if (c == EOF) {\n            /* premature end of file in the middle of a string */\n            free(symbol);\n            return EOFP;\n        }\n        if (len + 2 &lt; size) {\n            size += size;\n            s = realloc(symbol, size);\n            if (s == NULL) {\n                /* allocation failure */\n                free(symbol);\n                return NULL;\n            }\n            symbol = s;\n        }\n        symbol[len++] = c;\n    }\n    symbol[len] = '\\0';\n    s = realloc(symbol, len + 1);\n    return s ? s : symbol;\n}\n\nint main(int argc, char *argv[]) {\n\n    FILE *file = fopen(&quot;C:/Users/Nabila K/Documents/test.json&quot;, &quot;r&quot;);\n    if (file != NULL)) {\n        char *test;\n        while ((test = read_string(file)) != EOFP) {\n            if (test == NULL) {\n                printf(&quot;test == NULL\\n&quot;);\n                exit(1);\n            } else {\n                printf(&quot;%s\\n&quot;, test);\n                free(test);\n            }\n        } \n        fclose(file);   \n    } else {\n        exit(EXIT_FAILURE);\n    }\n    return 0;\n}\n</code></pre>\n<p>Notes:</p>\n<ul>\n<li>Parsing the full JSON syntax for strings would be required if the strings can contain escaped characters such as <code>\\&quot;</code> or <code>\\n</code>, <code>\\\\</code> etc.</li>\n</ul>\n"}], "owner": {"reputation": 27, "user_id": 8438708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c0aea3ff883b291cd44a0857d55eab?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8438708/nabila-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 45586509, "answer_count": 1, "score": 1, "last_activity_date": 1594628139, "creation_date": 1502269805, "last_edit_date": 1502271513, "question_id": 45586293, "link": "https://stackoverflow.com/questions/45586293/realloc-corrupted-data-returned", "title": "realloc : corrupted data returned", "body": "<p>I'm trying to read from a file using C and after shrinking the size using <code>realloc</code> I get corrupted data. I don't really see what the problem could be.</p>\n\n<p>Here's the function that returns the string : </p>\n\n<pre><code>char *read_string(FILE *fichier) {\n    char car = 0;\n    size_t size = 1;\n    char *symbole = realloc(NULL, sizeof(char) * size);\n    char *s; \n    size_t len = 0;\n    if (!symbole)\n        return symbole;\n    else\n        s = symbole; \n    do {\n        car = getc(fichier);\n    } while (car != '\"' &amp;&amp; car != EOF);\n    if (car == EOF)\n        return EOFP; \n    else {\n        car = getc(fichier);\n        while (car != '\"' ) {\n            s[len] = car;\n            car = getc(fichier);\n            len++;\n            if (len == size) {\n                symbole = realloc(s, sizeof(char) * (size += 1));\n                if (!symbole)\n                    return symbole;\n                else\n                    s = symbole; \n            }\n        }\n        s[len] = '\\0' ;\n        symbole = realloc(s, sizeof(char) * len);\n        if (!symbole) {\n            printf(\"WTF\");\n            return symbole;\n        } else\n            s = symbole;  \n        return s;\n    }\n}\n</code></pre>\n\n<p>My <code>main</code> function is:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n\n    FILE *fichier = NULL;\n    fichier = fopen(\"C:/Users/Nabila K/Documents/test.json\", \"r\");\n\n    if ((fichier != NULL)) {\n        while (feof(fichier) == 0) {\n            char *test = read_string(fichier);\n            if (test == NULL) {\n                printf(\"test == NULL\\n\");\n                exit(1);\n            } else\n            if (test == EOFP) {\n            } else {\n                printf(\"%s\\n\", test);\n                free(test);\n            } \n        } \n        fclose(fichier);   \n    } else {\n        exit(EXIT_FAILURE);\n    }\n    return 0;\n}\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>My json file looks something like this :     </p>\n\n<pre><code>{\n    \"KARIM BENNI\" : {\n       \"2017-08-07 09:50:50\" : {\n          \"Anomalie\" : {\n            \"description\" : \"Test\",\n            \"theme\" : \"Engins mobiles\"\n          },\n          \"date\" : \"2017-08-07\",\n          \"date_now\" : \"2017-08-07 09:50:50\",\n          \"entite\" : \"USINE LAMINAGE A FROID\",\n          \"etat\" : \"Cree\",\n          \"nb_personne\" : 2,\n          \"temps\" : 5,\n          \"visiteur\" : \"KARIM BENNI\",\n          \"visite\" : \"AHMED RABII\",\n          \"zone\" : \"COUPE\"\n       }\n    }\n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "floating-point", "ieee-754", "blackfin"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 5, "creation_date": 1502269604, "post_id": 45586128, "comment_id": 78131265, "body": "Could the difference be not in the memory representation but in how the values are handled? I.e. more of a speed-optimisation config than of a memory content config?"}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1502269932, "post_id": 45586128, "comment_id": 78131468, "body": "What if you add <code>100</code> to <code>tt.hello</code>? Strict IEE-754 32bit should give you <code>100.0012359619140625</code> as a result."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1502272566, "post_id": 45586128, "comment_id": 78133413, "body": "ISTM that @Yunnosch is right. The representation doesn&#39;t have t be different, but I guess the algorithms handling (emulating) the math are different. Probably, one is more accurate and 100% IEEE compliant, the other is faster but cuts some corners and is therefore slightly less accurate than IEEE conformity requires."}, {"owner": {"reputation": 2605, "user_id": 1235291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/77a089d834e26344c1eaafd1728c08c2?s=128&d=identicon&r=PG", "display_name": "Q-bertsuit", "link": "https://stackoverflow.com/users/1235291/q-bertsuit"}, "edited": false, "score": 0, "creation_date": 1502272726, "post_id": 45586128, "comment_id": 78133515, "body": "Thanks for your input guys. You are probably right!"}, {"owner": {"reputation": 2605, "user_id": 1235291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/77a089d834e26344c1eaafd1728c08c2?s=128&d=identicon&r=PG", "display_name": "Q-bertsuit", "link": "https://stackoverflow.com/users/1235291/q-bertsuit"}, "reply_to_user": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1502272758, "post_id": 45586128, "comment_id": 78133544, "body": "@YSC I think IEEE-754 can represent 100 exactly? Try here: <a href=\"https://www.h-schmidt.net/FloatConverter/IEEE754.html\" rel=\"nofollow noreferrer\">h-schmidt.net/FloatConverter/IEEE754.html</a>"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1502273147, "post_id": 45586128, "comment_id": 78133815, "body": "@Q-bertsuit: It can (only needs 7 bits). The problem is <code>0.00123456789</code> which needs an infinite number of bits."}, {"owner": {"reputation": 34185, "user_id": 5470596, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BITFt.jpg?s=128&g=1", "display_name": "YSC", "link": "https://stackoverflow.com/users/5470596/ysc"}, "edited": false, "score": 0, "creation_date": 1502276377, "post_id": 45586128, "comment_id": 78136273, "body": "@Q-bertsuit but not 100 + 0.00123456789 ;)"}, {"owner": {"reputation": 2605, "user_id": 1235291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/77a089d834e26344c1eaafd1728c08c2?s=128&d=identicon&r=PG", "display_name": "Q-bertsuit", "link": "https://stackoverflow.com/users/1235291/q-bertsuit"}, "edited": false, "score": 0, "creation_date": 1502281256, "post_id": 45586128, "comment_id": 78139872, "body": "Sorry, didn&#39;t see <i>Add</i> 100 ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 2605, "user_id": 1235291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/77a089d834e26344c1eaafd1728c08c2?s=128&d=identicon&r=PG", "display_name": "Q-bertsuit", "link": "https://stackoverflow.com/users/1235291/q-bertsuit"}, "edited": false, "score": 0, "creation_date": 1502272959, "post_id": 45587032, "comment_id": 78133693, "body": "Thank you for clarifying!"}], "tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": true, "score": 4, "last_activity_date": 1502272656, "last_edit_date": 1502272656, "creation_date": 1502271676, "answer_id": 45587032, "question_id": 45586128, "link": "https://stackoverflow.com/questions/45586128/ieee-floating-point-and-fast-floating-point-representation-in-memory/45587032#45587032", "title": "IEEE floating point and fast floating point representation in memory", "body": "<p>The document you reference discusses a User-Defined <code>fastfloat16</code> type. You use the native <code>float</code> type here. I don't think they're equivalent, regardless of the VisualDSP settings.</p>\n\n<p>\"Strict IEEE compliance\" is usually interpreted as \"even the edge cases are handled correctly\". Edge cases for IEE754 are things like denormals, division by zero, infinities, Not-a-Number etc. One example, in IEEE754 <code>NaN != NaN</code>. This means you can't do a fast 32 bits comparison. Another example is that IEEE754 mandates that the basic math operations are exact to the last bit. There's a significant speedup achievable by using the IEEE754 float layout, but not IEEE754 math.</p>\n"}], "owner": {"reputation": 2605, "user_id": 1235291, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/77a089d834e26344c1eaafd1728c08c2?s=128&d=identicon&r=PG", "display_name": "Q-bertsuit", "link": "https://stackoverflow.com/users/1235291/q-bertsuit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 45587032, "answer_count": 1, "score": 2, "last_activity_date": 1502272656, "creation_date": 1502269364, "question_id": 45586128, "link": "https://stackoverflow.com/questions/45586128/ieee-floating-point-and-fast-floating-point-representation-in-memory", "title": "IEEE floating point and fast floating point representation in memory", "body": "<p>The BFF-533 processor from Analog Devices does not offer native floating point support but does offer floating point emulation.</p>\n\n<p>Using the IDE VisualDSP++, the user is allowed to select between High Performing floating point and strict IEEE compliance.</p>\n\n<p>From what I understand, <a href=\"http://www.analog.com/media/en/technical-documentation/application-notes/EE.185.Rev.4.08.07.pdf\" rel=\"nofollow noreferrer\">the difference between these two</a> result in a different representation of a floating point value in memory, so I did the following test:</p>\n\n<pre><code>union TestType\n{\n    float hello;\n    char test[4];   \n};\n\nTestType tt;\ntt.hello = 0.00123456789;\n</code></pre>\n\n<p>I compiled and ran this with both options, expecting to see a different value in the test array, but I got the same each run:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WNaBZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WNaBZ.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can someone explain why I'm seeing what appears to be the IEEE representation in both runs?</p>\n"}, {"tags": ["c", "macros"], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502269384, "creation_date": 1502269384, "answer_id": 45586135, "question_id": 45585903, "link": "https://stackoverflow.com/questions/45585903/c-macros-how-to-map-another-macro-to-variadic-arguments/45586135#45586135", "title": "C Macros: How to map another macro to variadic arguments?", "body": "<p>IMO impossible unless you use horrible tricks and hacks like this</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/comp.std.c/d-6Mj5Lko_s\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/comp.std.c/d-6Mj5Lko_s</a></p>\n\n<p>And as I see it calls the same function so the type of the parameter is known - why you do not use <code>stdarg</code> instead.</p>\n"}, {"comments": [{"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 1, "creation_date": 1502372036, "post_id": 45586169, "comment_id": 78189131, "body": "<code>FIRST</code> as shown here relies on non-standard gnu extensions.  This implementation, per the standard, requires two arguments; your use of it requires <code>FIRST</code> to accept one argument.  <code>#define FIRST(...) FIRST_(__VA_ARGS__,)</code> <code>#define FIRST_(x, ...) x</code> is a fix.  Similar with <code>SECOND</code>."}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1502372440, "post_id": 45586169, "comment_id": 78189519, "body": "Also, <code>HAS_ARGS</code> is at best poorly named; it&#39;s not really testing if it is passed no arguments.  Rather, it&#39;s testing whether its first argument is empty."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1502372611, "post_id": 45586169, "comment_id": 78189676, "body": "@HWalters: Thank you! As I said it&#39;s mostly copied from the source I&#39;ve mentioned in the answer. I didn&#39;t get why <code>FIRST</code> should not work for all compiler/preprocessors and why your version is a fix for that? &quot;My version&quot; just throws aways the <code>__VA_ARGS__</code> why this is an gnu extension?"}, {"owner": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 1, "creation_date": 1502372823, "post_id": 45586169, "comment_id": 78189880, "body": "Specifically, 6.10.3p4: &quot;Otherwise [the identifier-list ends in a ...] there shall be more arguments in the invocation than there are parameters in the macro definition (excluding the ...)&quot;.  (I know you asked for a link, but the text fits in a comment).  <code>FIRST(a, ...)</code> thus requires at least two arguments.  Accepting 1 is a gnu extension tied to its comma elision feature."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1502373383, "post_id": 45586169, "comment_id": 78190383, "body": "@HWalters: Thank you very much got it and changed it! @ZhaoxiongCui: There was also another little error as it expanded to: <code>f(a); , f(b); , f(c);</code> with commas in between before. Now the expansion works and it expands to: <code>f(a); f(b); f(c);</code>."}, {"owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "reply_to_user": {"reputation": 2336, "user_id": 3936002, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/utGjG.png?s=128&g=1", "display_name": "H Walters", "link": "https://stackoverflow.com/users/3936002/h-walters"}, "edited": false, "score": 0, "creation_date": 1502865340, "post_id": 45586169, "comment_id": 78371084, "body": "Hi @Xhaoxiong if this or any answer has solved your question please consider <a href=\"https://meta.stackexchange.com/q/5234/179419\">accepting it</a> by clicking the check-mark. This indicates to the wider community that you&#39;ve found a solution and gives some reputation to both the answerer and yourself. There is no obligation to do this."}], "tags": [], "owner": {"reputation": 4827, "user_id": 8051589, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8VNG6.png?s=128&g=1", "display_name": "Andre Kampling", "link": "https://stackoverflow.com/users/8051589/andre-kampling"}, "is_accepted": false, "score": 4, "last_activity_date": 1502373811, "last_edit_date": 1502373811, "creation_date": 1502269470, "answer_id": 45586169, "question_id": 45585903, "link": "https://stackoverflow.com/questions/45585903/c-macros-how-to-map-another-macro-to-variadic-arguments/45586169#45586169", "title": "C Macros: How to map another macro to variadic arguments?", "body": "<p>The code below is working for what you've asked for with up to 1024 arguments and <strong>without</strong> using additional stuff like boost. It defines an <code>EVAL(...)</code> and also a <code>MAP(m, first, ...)</code> macro to do recursion and to use for each iteration the macro <code>m</code> with the next parameter <code>first</code>.</p>\n\n<p>With the use of that, your <code>apply(...)</code> looks like: <code>#define apply(...) EVAL(MAP(apply_, __VA_ARGS__))</code>.</p>\n\n<p>It is mostly copied from <a href=\"http://jhnet.co.uk/articles/cpp_magic\" rel=\"nofollow noreferrer\">C Pre-Processor Magic</a>. It is also great explained there. You can also download these helper macros like <code>EVAL(...)</code> at this <a href=\"https://github.com/18sg/uSHET/blob/master/lib/cpp_magic.h\" rel=\"nofollow noreferrer\">git repository</a>, there are also a lot of explanation in the actual code. It is variadic so it takes the number of arguments you want.</p>\n\n<p>But I changed the <code>FIRST</code> and the <code>SECOND</code> macro as it uses a Gnu extension like it is in the source I've copied it from. This is said in the comments below by @<a href=\"https://stackoverflow.com/users/3936002/h-walters\">HWalters</a>:</p>\n\n<blockquote>\n  <p>Specifically, 6.10.3p4: \"Otherwise [the identifier-list ends in a ...] there shall be more arguments in the invocation than there are parameters in the macro definition (excluding the ...)\".</p>\n</blockquote>\n\n<p><strong>Main function part:</strong></p>\n\n<pre><code>int main()\n{\n   int a, b, c;\n   apply(a, b, c) /* Expands to: f(a); f(b); f(c); */\n\n   return 0;\n}\n</code></pre>\n\n<p><strong>Macro definitions:</strong></p>\n\n<pre><code>#define FIRST_(a, ...) a\n#define SECOND_(a, b, ...) b\n\n#define FIRST(...) FIRST_(__VA_ARGS__,)\n#define SECOND(...) SECOND_(__VA_ARGS__,)\n\n#define EMPTY()\n\n#define EVAL(...) EVAL1024(__VA_ARGS__)\n#define EVAL1024(...) EVAL512(EVAL512(__VA_ARGS__))\n#define EVAL512(...) EVAL256(EVAL256(__VA_ARGS__))\n#define EVAL256(...) EVAL128(EVAL128(__VA_ARGS__))\n#define EVAL128(...) EVAL64(EVAL64(__VA_ARGS__))\n#define EVAL64(...) EVAL32(EVAL32(__VA_ARGS__))\n#define EVAL32(...) EVAL16(EVAL16(__VA_ARGS__))\n#define EVAL16(...) EVAL8(EVAL8(__VA_ARGS__))\n#define EVAL8(...) EVAL4(EVAL4(__VA_ARGS__))\n#define EVAL4(...) EVAL2(EVAL2(__VA_ARGS__))\n#define EVAL2(...) EVAL1(EVAL1(__VA_ARGS__))\n#define EVAL1(...) __VA_ARGS__\n\n#define DEFER1(m) m EMPTY()\n#define DEFER2(m) m EMPTY EMPTY()()\n\n#define IS_PROBE(...) SECOND(__VA_ARGS__, 0)\n#define PROBE() ~, 1\n\n#define CAT(a,b) a ## b\n\n#define NOT(x) IS_PROBE(CAT(_NOT_, x))\n#define _NOT_0 PROBE()\n\n#define BOOL(x) NOT(NOT(x))\n\n#define IF_ELSE(condition) _IF_ELSE(BOOL(condition))\n#define _IF_ELSE(condition) CAT(_IF_, condition)\n\n#define _IF_1(...) __VA_ARGS__ _IF_1_ELSE\n#define _IF_0(...)             _IF_0_ELSE\n\n#define _IF_1_ELSE(...)\n#define _IF_0_ELSE(...) __VA_ARGS__\n\n#define HAS_ARGS(...) BOOL(FIRST(_END_OF_ARGUMENTS_ __VA_ARGS__)())\n#define _END_OF_ARGUMENTS_() 0\n\n#define MAP(m, first, ...)           \\\n  m(first)                           \\\n  IF_ELSE(HAS_ARGS(__VA_ARGS__))(    \\\n    DEFER2(_MAP)()(m, __VA_ARGS__)   \\\n  )(                                 \\\n    /* Do nothing, just terminate */ \\\n  )\n#define _MAP() MAP\n\n#define apply_(x) f(x);\n#define apply(...) EVAL(MAP(apply_, __VA_ARGS__))\n</code></pre>\n\n<hr>\n\n<p>To test macro expansion it is useful to use gcc with the command line argument <code>-E</code>:</p>\n\n<pre><code>$ gcc -E srcFile.c\n</code></pre>\n\n<p>because your're getting concrete error messages and understand what's going on.</p>\n"}, {"comments": [{"owner": {"reputation": 5405, "user_id": 4619958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cVA9W.png?s=128&g=1", "display_name": "ch271828n", "link": "https://stackoverflow.com/users/4619958/ch271828n"}, "edited": false, "score": 0, "creation_date": 1570601573, "post_id": 45587428, "comment_id": 102958749, "body": "may use <code>do{...}while(0)</code> when defining apply."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 5405, "user_id": 4619958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cVA9W.png?s=128&g=1", "display_name": "ch271828n", "link": "https://stackoverflow.com/users/4619958/ch271828n"}, "edited": false, "score": 0, "creation_date": 1570602352, "post_id": 45587428, "comment_id": 102959036, "body": "@fzyzcjy Depends on the context. If the aim is to produce high quality C code, then no - high quality C code doesn&#39;t use <code>if() x(); else</code> without braces <code>{}</code> and allowing such code is the only purpose of do-while(0). If the aim is create some portable lib that can be used by all manner of users with diverse code quality standards, then do-while(0) should be used."}, {"owner": {"reputation": 5405, "user_id": 4619958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cVA9W.png?s=128&g=1", "display_name": "ch271828n", "link": "https://stackoverflow.com/users/4619958/ch271828n"}, "edited": false, "score": 0, "creation_date": 1570605694, "post_id": 45587428, "comment_id": 102960661, "body": "Thank you! I have seldom heard of this kind of explanation"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 5405, "user_id": 4619958, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/cVA9W.png?s=128&g=1", "display_name": "ch271828n", "link": "https://stackoverflow.com/users/4619958/ch271828n"}, "edited": false, "score": 1, "creation_date": 1570609354, "post_id": 45587428, "comment_id": 102962533, "body": "@fzyzcjy This is the reason why MISRA-C dropped the requirement of using do-while(0). It was required for function-like macros in older versions of MISRA, but they dropped the rule in the latest version, because MISRA-C already got the requirement that we must always use braces after all control and loop statements."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1502272756, "creation_date": 1502272756, "answer_id": 45587428, "question_id": 45585903, "link": "https://stackoverflow.com/questions/45585903/c-macros-how-to-map-another-macro-to-variadic-arguments/45587428#45587428", "title": "C Macros: How to map another macro to variadic arguments?", "body": "<p>Everything is possible in C if you throw enough ugly macros at it. For example, you can have an ugly function-like macro:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint f (int a)\n{\n  printf(\"%d\\n\", a);\n}\n\n#define SIZEOF(arr) (sizeof(arr) / sizeof(*arr))\n\n#define apply(...)                    \\\n{                                     \\\n  int arr[] = {__VA_ARGS__};          \\\n  for(size_t i=0; i&lt;SIZEOF(arr); i++) \\\n  {                                   \\\n    f(arr[i]);                        \\\n  }                                   \\\n}\n\nint main (void)\n{\n  apply(1, 2, 3);\n}\n</code></pre>\n\n<p>Notice that 1) This would be much better off as a variadic <em>function</em>, and 2) it would be even better if you get rid of the variadic nonsense entirely and simply make a function such as </p>\n\n<pre><code>int f (size_t n, int array[n])\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8332771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761453f1405ff3596afeef5a792c254d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffion", "link": "https://stackoverflow.com/users/8332771/jeffion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1201, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1502373811, "creation_date": 1502268785, "question_id": 45585903, "link": "https://stackoverflow.com/questions/45585903/c-macros-how-to-map-another-macro-to-variadic-arguments", "title": "C Macros: How to map another macro to variadic arguments?", "body": "<p>I'd like to know how to apply a unary function (or another macro) to variadic arguments of a macro, like</p>\n\n<pre><code>int f(int a);\n\n#define apply(args...) &lt;the magic&gt;\napply(a, b, c)\n</code></pre>\n\n<p>which unrolls</p>\n\n<pre><code>f(a)\nf(b)\nf(c)\n</code></pre>\n\n<p>Note that the number of arguments is unknown.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 29577, "user_id": 58129, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/MBBRu.jpg?s=128&g=1", "display_name": "Anthony Kong", "link": "https://stackoverflow.com/users/58129/anthony-kong"}, "edited": false, "score": 0, "creation_date": 1502268860, "post_id": 45585883, "comment_id": 78130700, "body": "You can totally do <code>hex0 = [0x00, 0x00, 0x18, 0x00, 0x5F, 0x00, ...</code> in python. Some simple python code (<code>readlines</code>, <code>re</code> etc) can convert this string in header file to python code."}, {"owner": {"reputation": 5868, "user_id": 3270037, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6HVI4.png?s=128&g=1", "display_name": "Nick", "link": "https://stackoverflow.com/users/3270037/nick"}, "edited": false, "score": 0, "creation_date": 1502269268, "post_id": 45585883, "comment_id": 78131015, "body": "Open the source in some text editor and do the following find/replace alls, &quot;const unsigned char &quot;, with &quot;&quot;, &quot;[8820]&quot; with &quot;&quot;, &quot;{&quot; with &quot;[&quot; and &quot;}&quot; with &quot;]&quot;"}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1502269322, "post_id": 45585883, "comment_id": 78131060, "body": "you can copy-paste it manually...."}, {"owner": {"reputation": 49793, "user_id": 4014959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GdqQJ.jpg?s=128&g=1", "display_name": "PM 2Ring", "link": "https://stackoverflow.com/users/4014959/pm-2ring"}, "edited": false, "score": 0, "creation_date": 1502269826, "post_id": 45585883, "comment_id": 78131407, "body": "Everything except the first &amp; last line is valid Python, so you can easily turn it into a string representing a list, or a list of lists, and parse that string efficiently using <code>ast.literal_eval</code>."}], "owner": {"reputation": 365, "user_id": 6081551, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0a9215d7764e1d4ff2a6c4d08b2aa38c?s=128&d=identicon&r=PG&f=1", "display_name": "Andrey Mazur", "link": "https://stackoverflow.com/users/6081551/andrey-mazur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502268687, "creation_date": 1502268687, "question_id": 45585883, "link": "https://stackoverflow.com/questions/45585883/get-list-from-c-array-from-h-file", "title": "Get list from C array from .h file", "body": "<p>I have C header file, with 16 const unsigned char arrays with the size of 8820 bytes.</p>\n\n<pre><code>const unsigned char hex0[8820] = {\n0x00, 0x00, 0x18, 0x00, 0x5F, 0x00, 0xCF, 0x00, 0x65, 0x01, 0x15, 0x02,\n0xD8, 0x02, 0x9C, 0x03, 0x5C, 0x04, 0x07, 0x05, 0x91, 0x05, 0xF3, 0x05,\n... \n}\n</code></pre>\n\n<p>I need to convert this to Python's lists, what is the best way to do that? Is there some tool for that? Or shall I parse it with regular expressions?</p>\n"}, {"tags": ["java", "c", "command-line-arguments"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1502268680, "post_id": 45585841, "comment_id": 78130586, "body": "You need to first compile your C program, <i>then</i> run the generated executable."}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 3558507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/w8rNR.png?s=128&g=1", "display_name": "Kaushali de silva", "link": "https://stackoverflow.com/users/3558507/kaushali-de-silva"}, "edited": false, "score": 0, "creation_date": 1502269224, "post_id": 45585956, "comment_id": 78130979, "body": "Thank you very much for your quick answer.I have executed C program. And changed the line. But still its returning -1"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "reply_to_user": {"reputation": 72, "user_id": 3558507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/w8rNR.png?s=128&g=1", "display_name": "Kaushali de silva", "link": "https://stackoverflow.com/users/3558507/kaushali-de-silva"}, "edited": false, "score": 0, "creation_date": 1502269322, "post_id": 45585956, "comment_id": 78131062, "body": "try to execute your executable file, go to <code>&#47;home&#47;lclab&#47;Desktop&#47;jni</code>, open terminal here and write <code>.&#47;test param1</code>, did it run correct?"}, {"owner": {"reputation": 72, "user_id": 3558507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/w8rNR.png?s=128&g=1", "display_name": "Kaushali de silva", "link": "https://stackoverflow.com/users/3558507/kaushali-de-silva"}, "edited": false, "score": 0, "creation_date": 1502269423, "post_id": 45585956, "comment_id": 78131131, "body": "yes its executing. lclab@lclab:~/Desktop/jni$ g++ test.c -o test lclab@lclab:~/Desktop/jni$ ./test param1 The argument supplied is param1"}], "tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 2, "last_activity_date": 1502270142, "last_edit_date": 1502270142, "creation_date": 1502268917, "answer_id": 45585956, "question_id": 45585841, "link": "https://stackoverflow.com/questions/45585841/call-to-c-program-with-command-line-argument-from-java/45585956#45585956", "title": "call to C program with command line argument from java", "body": "<p>Compile C source code, you will have executable file.</p>\n\n<pre><code>g++ test.c -o test\n</code></pre>\n\n<p>Change this line</p>\n\n<pre><code>new ProcessBuilder(\"gcc\", \"/home/lclab/Desktop/jni/test.c\", \"param1\");\n</code></pre>\n\n<p>Paste executable filename instead of <code>test.c</code></p>\n\n<pre><code>new ProcessBuilder(\"gcc\", \"/home/lclab/Desktop/jni/test\", \"param1\");\n</code></pre>\n\n<p>Or use <a href=\"https://en.wikipedia.org/wiki/Java_Native_Interface\" rel=\"nofollow noreferrer\">Java native interface</a></p>\n\n<p>EDIT:</p>\n\n<pre><code>public static void CompileCprog(String filename){\n\n        File dir = new File(\"C://Users//JohnDoe//workspace//Project\");\n\n        try {  \n            String exeName = filename.substring(0, filename.length() - 2);\n            Process p = Runtime.getRuntime().exec(\"cmd /C gcc \" + filename + \" -o \" + exeName, null, dir);  \n            Process p = Runtime.getRuntime().exec(\"cmd /C dir\", null, dir);  \n            BufferedReader in = new BufferedReader(new InputStreamReader(p.getInputStream()));  \n            String line = null;  \n            while ((line = in.readLine()) != null) {  \n                System.out.println(line);  \n            }  \n        } catch (IOException e) {  \n            e.printStackTrace();  \n        }   \n    }\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 3558507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/w8rNR.png?s=128&g=1", "display_name": "Kaushali de silva", "link": "https://stackoverflow.com/users/3558507/kaushali-de-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 3, "accepted_answer_id": 45585956, "answer_count": 1, "score": 0, "last_activity_date": 1502270142, "creation_date": 1502268542, "question_id": 45585841, "link": "https://stackoverflow.com/questions/45585841/call-to-c-program-with-command-line-argument-from-java", "title": "call to C program with command line argument from java", "body": "<p>I want to pass the parameters from my java program to C program which is execute as command line argument. This is my C program,</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n\nint main( int argc, char *argv[] )  {\n\n   if( argc == 2 ) {\n      printf(\"The argument supplied is %s\\n\", argv[1]);\n   }\n   else if( argc &gt; 2 ) {\n      printf(\"Too many arguments supplied.\\n\");\n   }\n   else {\n      printf(\"One argument expected.\\n\");\n   }\n}\n</code></pre>\n\n<p>This is output I got when I compiled it from terminal.</p>\n\n<pre><code>lclab@lclab:~/Desktop/jni$ ./a.out param1\nThe argument supplied is param1\n</code></pre>\n\n<p>I want to pass parameters(param1) to this program from my java program. How can I do that? I tried with java process builder but it always return -1.</p>\n\n<pre><code>try {\n                ProcessBuilder processBuilder =\n                        new ProcessBuilder(\"gcc\", \"/home/lclab/Desktop/jni/test.c\", \"param1\");\n                Process proc = processBuilder.start();\n                System.out.println(proc.getInputStream().read());\n                return proc.getInputStream().read();\n            } catch (IOException e) {\n                e.printStackTrace();\n                return 99;\n            }\n</code></pre>\n\n<p>My machine is ubuntu.  </p>\n"}, {"tags": ["c", "gcc", "arm", "embedded"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502267674, "post_id": 45585031, "comment_id": 78129881, "body": "It is not a good idea to imitate OP in the C.. Use C++ instead or write in C. Mixing makes code difficult to read, error prone, full of conditional compilations ec"}, {"owner": {"reputation": 24, "user_id": 5046868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibNPU.jpg?s=128&g=1", "display_name": "Chungkil Kim", "link": "https://stackoverflow.com/users/5046868/chungkil-kim"}, "edited": false, "score": 0, "creation_date": 1502267886, "post_id": 45585031, "comment_id": 78130014, "body": "see the following link <a href=\"https://stackoverflow.com/questions/4306186/structure-padding-and-packing\" title=\"structure padding and packing\">stackoverflow.com/questions/4306186/&hellip;</a>"}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268037, "post_id": 45585031, "comment_id": 78130130, "body": "@PeterJ True, but as mentioned by Jay Atkinson <a href=\"https://electronics.stackexchange.com/a/3036/92508\">here</a>, C++ is a very very powerful tool much like a two-edged sword that can cut both your arm and leg off if not educated and disciplined properly. I am afraid it would be more complicated to train my coworker than stick to a language they know already."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268095, "post_id": 45585031, "comment_id": 78130178, "body": "@nowox so write in C and do not try to imitate C++"}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 24, "user_id": 5046868, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ibNPU.jpg?s=128&g=1", "display_name": "Chungkil Kim", "link": "https://stackoverflow.com/users/5046868/chungkil-kim"}, "edited": false, "score": 0, "creation_date": 1502268124, "post_id": 45585031, "comment_id": 78130199, "body": "@ChungkilKim I don&#39;t really mind about structure alignment, I simply would like to remove the unused symbols in that structure during the linking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 3, "creation_date": 1502268271, "post_id": 45585031, "comment_id": 78130291, "body": "@PeterJ I <b>strongly</b> disagree, there are a lot of projects using OOP principles in C. The best-known is probably glib/gtk, but even the win32 API is largely object-oriented, still C."}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268294, "post_id": 45585031, "comment_id": 78130314, "body": "@PeterJ I am writing C, structures are part of C as function pointers are. The mangling is much worse because you will need to use a lot of pass-through defines such as <code>#define HAL_FOO modulea_foo</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502268346, "post_id": 45585031, "comment_id": 78130350, "body": "@nowox I&#39;m not sure I understand your question. Is your problem that your &quot;interface&quot; sometimes needs fewer functions? Then separate into several interfaces. If you need inheritance, make the &quot;parent&quot; interface the first member of the derived one."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268349, "post_id": 45585031, "comment_id": 78130351, "body": "STM32 project? (HAL......)"}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1502268409, "post_id": 45585031, "comment_id": 78130400, "body": "@FelixPalmen My issue is not really solved in C++ either. An interface or a class with unused members will never be simplified by the compiler either. So with C++ I am falling in the same trap."}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268446, "post_id": 45585031, "comment_id": 78130418, "body": "@PeterJ Multi Architecture nRF51/nRF52/STM32/MSP430"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502268453, "post_id": 45585031, "comment_id": 78130425, "body": "@nowox then don&#39;t declare unused members, see my comment above. You have to define interfaces according to the single responsibility principle."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268518, "post_id": 45585031, "comment_id": 78130466, "body": "@Felix Palmen yes they are. Is it the evidence that imitating is the best?   IMO if one writes OOP is best to use OO language."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268563, "post_id": 45585031, "comment_id": 78130487, "body": "@FelixPalmen I believe he understands that removind the declaration would reduce the size. But I think he wants some optimization pass to figure out the unused members/"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268627, "post_id": 45585031, "comment_id": 78130546, "body": "@PeterJ there are a lot of good reasons to use C and there are a lot of problems best solved with OOP. What&#39;s the best approach depends on a lot of constraints, but C allows for some good OOP styles, so please just respect what the OP wants."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502268663, "post_id": 45585031, "comment_id": 78130574, "body": "@nowox  <code>So with C++ I am falling in the same trap</code> - definitely not."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268781, "post_id": 45585031, "comment_id": 78130646, "body": "@AjayBrahmakshatriya with a sensible design, there&#39;s no reason to do so. If you have a module implementing A and a module implementing B, which is a superset of A, you typically use inheritance, and that&#39;s not too complicated with C structs. But I have to admit, from the question it&#39;s not entirely clear to me whether this is the exact problem."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268803, "post_id": 45585031, "comment_id": 78130663, "body": "@nowox it is generally not a good idea on the compiler to remove unused members from both structs or classes because it doesn&#39;t know in a translation unit what other modules are using the same struct. Yes, if it can statically prove that pointers to this type are never passed out, maybe! But with types like <code>void*</code> it is very difficult to reason."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268902, "post_id": 45585031, "comment_id": 78130735, "body": "@FelixPalmen <i>My issue is not really solved in C++ either. An interface or a class with unused members will never be simplified by the compiler either. So with C++ I am falling in the same trap</i> this hints a bit towards the real problem."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268942, "post_id": 45585031, "comment_id": 78130762, "body": "@AjayBrahmakshatriya yes, that&#39;s the reason I suggest to design the interfaces properly (aka more fine-grained)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502268994, "post_id": 45585031, "comment_id": 78130805, "body": "@FelixPalmen ofcourse! These things should be controlled by the programmer and not left to the compiler to optimize."}, {"owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "edited": false, "score": 0, "creation_date": 1502269095, "post_id": 45585031, "comment_id": 78130890, "body": "I&#39;ve edited my question to include C++"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1502271858, "post_id": 45585031, "comment_id": 78132903, "body": "You need to explain why you need to use function pointers as struct members. There should only be 2 reasons: either because they are callbacks, or because you are implementing some manner of polymorphism. Is either of this true? If not, then note that <code>x.func(y)</code> is not &quot;more OO&quot; than <code>func(x, y)</code>, it is only language syntax and has nothing to do with OO program design."}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1502290554, "post_id": 45585031, "comment_id": 78147754, "body": "inherintance never works from large to small or complex to simple, it&#39;s the other way round. You always start with the most simple, most generic (yet useful) interface you can think of and derive/inherit from there; to stay with your accelerometer class example, you would define a &quot;class&quot; (real or mimiced) with one accelerometer and have derived classes with more of them. The same applies for member variables and -functions. No waste of space."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1502270452, "creation_date": 1502270452, "answer_id": 45586538, "question_id": 45585031, "link": "https://stackoverflow.com/questions/45585031/how-to-eliminate-unused-elements-in-structures/45586538#45586538", "title": "How to eliminate unused elements in structures?", "body": "<p>Let me first show you a possible approach regarding your edit, where your current interface has three functions, but sometimes you would need only one of them. You could define two interfaces:</p>\n\n<pre><code>typedef struct I1DAccel\n{\n    double (*read)(void);\n} I1DAccel;\n\ntypedef struct I3DAccel\n{\n    union\n    {\n        I1DAccel x;\n        struct\n        {\n            double (*read_x)(void);\n        };\n    };\n\n    union\n    {\n        I1DAccel y;\n        struct\n        {\n            double (*read_y)(void);\n        };\n    };\n\n    union\n    {\n        I1DAccel z;\n        struct\n        {\n            double (*read_z)(void);\n        };\n    };\n} I3DAccel;\n</code></pre>\n\n<p>Then you can make the implementation of the Accelerometer do this:</p>\n\n<pre><code>I1DAccel accel_x = { read_x_acc };\nI1DAccel accel_y = { read_y_acc };\nI1DAccel accel_z = { read_z_acc };\nI3DAccel accel =\n{\n    .read_x = read_x_acc,\n    .read_y = read_y_acc,\n    .read_z = read_z_acc,\n};\n</code></pre>\n\n<p>With proper link-time optimizations, the compiler could then throw away any of these global structs that isn't used by application code.</p>\n\n<p>Of course, you will consume <strong>more</strong> memory if one part of your code requires only <code>accel_x</code> while another part requires the whole <code>accel</code>. You would have to hunt down these cases manually.</p>\n\n<hr>\n\n<p>Of course, using \"interface\" <code>struct</code>s, you will <strong>always</strong> consume more memory than without them, the pointers have to be stored <em>somewhere</em>. Therefore, the typical approach is indeed to just prepend the module name to the functions and call them directly, like e.g. in case of such an accelerometer:</p>\n\n<pre><code>typedef int acchndl; // if you need more than one accelerometer\n\ndouble Accel_read_x(acchndl accel);\ndouble Accel_read_y(acchndl accel);\ndouble Accel_read_z(acchndl accel);\n</code></pre>\n\n<p>This is conceptually similar to what you would do in e.g. C++:</p>\n\n<pre><code>class Accel\n{\n    double read_x();\n    double read_y();\n    double read_z();\n};\n\ndouble Accel::read_x()\n{\n    // implementation here\n}\n</code></pre>\n\n<p>With the plain C above, instead of an <em>instance pointer</em>, you can use any other type of \"object handle\", like demonstrated with the <code>typedef</code> to <code>int</code>, which is often an advantage for embedded code.</p>\n"}, {"tags": [], "owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "is_accepted": false, "score": 1, "last_activity_date": 1502316021, "last_edit_date": 1502316021, "creation_date": 1502293907, "answer_id": 45595388, "question_id": 45585031, "link": "https://stackoverflow.com/questions/45585031/how-to-eliminate-unused-elements-in-structures/45595388#45595388", "title": "How to eliminate unused elements in structures?", "body": "<blockquote>\n  <p>This solution looks nice but I might waste a lot of memory because the compiler doesn't know how to chop off structures and only keep what it really needs to.<br/>\n  ...<br/>\n  Is there a way to get the advantages of both solutions? Said differently, is there a way to tell the compiler to be smarter?</p>\n</blockquote>\n\n<p>One problem is 'C' compiles things as a module (compilation unit) and there is often no easy way to know what will and will not be used in a structure.  Consider the structure can be passed from module to module as you propose.  When compiling one module, there is no context/information to know that some other module will use the structure or not.</p>\n\n<p>Okay, so that leads to some possible solutions.  <code>gcc</code> has the option <code>-fwhole-program</code> <sup>See: <a href=\"https://gcc.gnu.org/onlinedocs/gcc-4.6.2/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">-fipa-struct-reorg</a> </sup> as well as <code>gold</code> and <strong>LTO</strong>.  Here you must structure your makefile so that the compiler (code generator) has all of the information available to know if it may remove structure members.  This is not to say that these options will do what you want with a current <code>gcc</code>, just that they are a requirement to get things to work.</p>\n\n<hr>\n\n<h2>C++</h2>\n\n<p>You can do most anything in 'C' that you can in C++; just not as programmer efficiently.  See: <a href=\"https://stackoverflow.com/questions/3417413/operator-overloading-in-c/15421178#15421178\">Operator overloading in 'C'</a>.  So how might a 'C' compiler implement your virtual functions?  Your C++ virtuals might look like this underneath,</p>\n\n<pre><code>struct foo_ts_virtual_table {\n    int my_type /* RTTI value for polymorphism. */\n    int (*do_foo)(int);\n    int (*do_bar)(int);\n} foo_vtable = {.my_type = ENUM_FOO_TS; .do_foo = foo};\n\nstruct foo_ts {\n    void * vtable; /* a foo_ts_virtual_table pointer */\n    int storage;\n} foo = {.vtable = foo_vtable};\n</code></pre>\n\n<p>This is a win memory wise if you have multiple <code>foo_ts</code> structures.  A down side of this is that a function pointer is difficult to in-line.  <strong>Often a simple functions body maybe less than the call overhead on an ARM CPU.</strong>  This results in more code memory and slower execution.</p>\n\n<p>C++ compilers will be geared to eliminate these extraneous functions, just because this is a common issue in C++. A 'C' compilers analysis is confounded by your custom code/notation and the language definition of structure and compilation units.</p>\n\n<hr>\n\n<p>Other possibilities are to wrap the function calls in macros and emit data to a non-linked section.  You can examine the non-linked section to see whether or not to include a function (and pointer) in the final link.  What is a win or not depends on lots of different design objectives.  It is certainly going to complicate the build process and confound other developers.</p>\n\n<p>As well, the <a href=\"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/arm/include/asm/glue-proc.h\" rel=\"nofollow noreferrer\">ARM Linux <em>MULTI_CPU</em></a> maybe of interest.  This is only to eliminate function pointers if only one 'type' is needed at run time.</p>\n\n<p>If you insist on function pointers, there will be occasions where this actually generates more code.  C++ compilers will do book keeping to see when a virtual might be in-lined as well as possibly not emitting unused member functions in a virtual table (and the implementation of the function).  These issues maybe more pronounced than the extra structure overhead.</p>\n"}], "owner": {"reputation": 18883, "user_id": 2612235, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/dpsjq.jpg?s=128&g=1", "display_name": "nowox", "link": "https://stackoverflow.com/users/2612235/nowox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1502316021, "creation_date": 1502266083, "last_edit_date": 1502268987, "question_id": 45585031, "link": "https://stackoverflow.com/questions/45585031/how-to-eliminate-unused-elements-in-structures", "title": "How to eliminate unused elements in structures?", "body": "<h2>Background</h2>\n\n<p>I am working on a modular architecture for embedded devices where different abstraction layers have to communicate  with each others. The current approach is to have plenty of functions, variables and defines mangled with the module name they belong to. </p>\n\n<p>This approach is a bit painful and I would like to define some kind of common interfaces for the API. The key idea is to get a better understanding of what modules share the same HAL interface. </p>\n\n<h2>Proposal</h2>\n\n<p>I would like to use a OOP inspired architecture where I use structures as interfaces. All these structures are populated statically.</p>\n\n<p>This solution looks nice but I might waste a lot of memory because the compiler doesn't know how to chop off structures and only keep what it really needs to. </p>\n\n<p>The following example can be built with or without <code>-DDIRECT</code> and the behavior should be exactly the same. </p>\n\n<h2>Example</h2>\n\n<h3>Source (test.c)</h3>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint do_foo(int a) {\n    return 42 * a;\n}\n\n#ifdef DIRECT\nint (*foo)(int) = do_foo;\nint (*bar)(int);\nint storage;\n#else\nstruct foo_ts {\n    int (*do_foo)(int);\n    int (*do_bar)(int);\n    int storage;\n} foo = {.do_foo = do_foo};\n#endif\n\nint main(char argc) {\n    #ifdef DIRECT\n    return foo(argc);\n    #else\n    return foo.do_foo(argc);\n    #endif\n}\n</code></pre>\n\n<h3>Makefile</h3>\n\n<pre><code>CFLAGS=-O2 -mthumb -mcpu=cortex-m3 -g --specs=nosys.specs\nCC=arm-none-eabi-gcc\n\nupper=$(shell echo $(1) | tr a-z A-Z)\n\nEXEC=direct.out with_struct.out\n\nall: $(EXEC)\n\n%.out:test.c\n    $(CC) $(CFLAGS) -D$(call upper,$(basename $@)) -o $@ test.c\n    size $@\n</code></pre>\n\n<h3>Output</h3>\n\n<p>One can notice that the memory footprint used with the <code>struct</code> variant is bigger because the compiler doesn't allow itself to remove the unused members. </p>\n\n<pre><code>arm-none-eabi-gcc -O2 -mthumb -mcpu=cortex-m3 -g \\\n                  --specs=nosys.specs -DDIRECT -o direct.out test.c\nsize direct.out\n   text    data     bss     dec     hex filename\n    992    1092      36    2120     848 direct.out\narm-none-eabi-gcc -O2 -mthumb -mcpu=cortex-m3 -g \\\n                  --specs=nosys.specs -DWITH_STRUCT -o with_struct.out test.c\nsize with_struct.out\n   text    data     bss     dec     hex filename\n    992    1100      28    2120     848 with_struct.out\n</code></pre>\n\n<h2>Question</h2>\n\n<p>With this example I demonstrate that using a structure is good for readability and modularity, but it could decrease efficiency and it increases the memory usage. </p>\n\n<p>Is there a way to get the advantages of both solutions? Said differently, is there a way to tell the compiler to be smarter?</p>\n\n<h2>OOP?</h2>\n\n<p>Following the comments on this question, one suggestion is to use C++ instead. Unfortunately, the same issue would occur because a Class with unused members will never be simplified by the compiler. So I am falling in the same trap with both languages. </p>\n\n<p>Another raised point was the reason for unused members in structures. To address this question we can imagine a generic 3-axes accelerometer used in an application where only 1 axis is used. The HAL for this accelerometer could have the methods <code>read_x_acc</code>, <code>read_y_acc</code> and <code>read_z_acc</code> while only <code>read_x_acc</code> is used by the application. </p>\n\n<p>If I declare a class in C++ or a structure in C the function pointers for unused methods/functions will still consume memory for nothing. </p>\n"}, {"tags": ["c", "linux", "pointers", "file-pointer"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1502266107, "post_id": 45585011, "comment_id": 78128893, "body": "Do you understand the need and effect of the <code>static</code> storage class?"}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1502266141, "post_id": 45585011, "comment_id": 78128915, "body": "hehe...that was a mistake..kindly help me in this"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1502266148, "post_id": 45585011, "comment_id": 78128920, "body": "Please <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Then edit your question to include a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>, as well as the actual error messages (in full, complete and without modifications) as text."}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502266218, "post_id": 45585011, "comment_id": 78128971, "body": "yeah..like it will be initialized only once during compilation..i tried normal way intially but even then it was not workin"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502266426, "post_id": 45585011, "comment_id": 78129113, "body": "If the static definition is in <code>a.c</code> and the functions that try to use it are also in <code>a.c</code>, there should be no problem as long as you defined it before you used it.  If you try to use it outside of <code>a.c</code>, it will fail.  The static variable should not be present in the header; that will give trouble.  Please provide an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) and the compilation and linking commands your are using."}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502267515, "post_id": 45585011, "comment_id": 78129792, "body": "thank you for the edit Jonathan..they are in the same file but still I m not able to clear this error.kindly help me in this.."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502266561, "post_id": 45585064, "comment_id": 78129200, "body": "Thank you for the reply...I have removed static but still it is throwing pFile not defined error..I have declared File* pFile in the same a.c under the macros and this file only consists of functions...should i declare it elsewhere?once again thank you for the reply"}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502267666, "post_id": 45585064, "comment_id": 78129874, "body": "Hi..I have added the code which resemble my implementation  for your  kind peruse..should i add in the files calling this function...i m not able to understand as this should be local to this file rite?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502267989, "post_id": 45585064, "comment_id": 78130088, "body": "@Ram show exact compiler output - all errors and warnings"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502268109, "post_id": 45585064, "comment_id": 78130186, "body": "It is of no use to answer these questions that lack a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It just gets the site filled with more c**p."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502268167, "post_id": 45585064, "comment_id": 78130221, "body": "@Ram it is definitely not the complete output"}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502268351, "post_id": 45585064, "comment_id": 78130352, "body": "No peter the only errors i am receiving are these 2 and it stops the compilation and comes out of project directories..."}, {"owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "edited": false, "score": 0, "creation_date": 1502300869, "post_id": 45585064, "comment_id": 78154361, "body": "The error was my makefile was taking the files from build directory and the changes were not getting reflected.Thanks a lot for your help"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1502266883, "last_edit_date": 1502266883, "creation_date": 1502266176, "answer_id": 45585064, "question_id": 45585011, "link": "https://stackoverflow.com/questions/45585011/error-with-file-pointer-not-defined/45585064#45585064", "title": "Error with file pointer not defined", "body": "<p>If you try to use this <code>static FILE* pFile</code> from another compilation units remove the <code>static</code></p>\n\n<p>in other file add:</p>\n\n<pre><code> extern FILE *pfile;\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 3661273, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3ed154f2c2574a93f27590af9991943?s=128&d=identicon&r=PG&f=1", "display_name": "Ram", "link": "https://stackoverflow.com/users/3661273/ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 734, "favorite_count": 0, "accepted_answer_id": 45585064, "answer_count": 1, "score": -2, "last_activity_date": 1515089074, "creation_date": 1502266027, "last_edit_date": 1515089074, "question_id": 45585011, "link": "https://stackoverflow.com/questions/45585011/error-with-file-pointer-not-defined", "title": "Error with file pointer not defined", "body": "<p>I have a file <code>a.c</code>, <code>a.h</code> which acts as a supporting module with functions from other files.</p>\n\n<p>In those functions I have to open a file and do functions like reading data, writing data, closing it.</p>\n\n<p>For these purposes I gave a global declaration for file pointer in <code>a.c</code> by</p>\n\n<pre><code>static FILE* pFile; \n</code></pre>\n\n<p>and used <code>pFile</code> directly.</p>\n\n<p>The error that the compiler was throwing error is like :</p>\n\n<pre><code>\"pFile\" not defined in the function\n</code></pre>\n\n<p>What's wrong here?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define path \"/tmp/diag.log\"\n\nFILE* pFile;\n\nvoid a(bool value) {\n    if (value) {\n            pFile = fopen (path,\"a\");\n      return;\n    }\n    else if (!value) {\n        fclose (pFile);\n    }\n}\n\nvoid b(bool value) {\n  if(value)\n  {\n  fprintf (pFile,\"%s\",message);\n  }\n  }\n</code></pre>\n\n<p>Update: \nThe error was my makefile was taking the files from build directory and the changes were not getting reflected.Thanks a lot for your help</p>\n"}, {"tags": ["c", "linux", "gtk", "raspbian"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1502265038, "post_id": 45584601, "comment_id": 78128199, "body": "Your shell syntax is wrong, it should be <code>export NO_AT_BRIDGE=1</code>. You can&#39;t have spaces around <code>=</code> in shell variable assignments."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1502265207, "post_id": 45584601, "comment_id": 78128301, "body": "You&#39;re missing the type specifictions for the parameters <code>slider_frequency</code> and <code>slider_duty_cycle</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502266732, "post_id": 45584601, "comment_id": 78129330, "body": "While it may work, it is considered bad style to drop paramters from the interface if it is under your control. The most callback functions in GTK have more than one parameter. Assuming that your slider is a gtk_scale, the signal handler schould have 2 parameters: <code>void user_function (GtkRange *range, gpointer  user_data)</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502268160, "post_id": 45584601, "comment_id": 78130215, "body": "<code>gtk-primary-button-warps-slider = flase</code> There is a typo <code>flase</code> -&gt; <code>false</code>"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1502443120, "post_id": 45584601, "comment_id": 78221830, "body": "You modified the content of settings.ini in your question. Did it change something of your &quot;Failed to parse...&quot; message?"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 422, "user_id": 6733654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4366895dfb917950e5c486c7e0d4d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6733654/john"}, "edited": false, "score": 0, "creation_date": 1502265954, "post_id": 45584760, "comment_id": 78128771, "body": "This may fix it. Passing the wrong datatype causes undefined behavior, it could be the reason."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 422, "user_id": 6733654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4366895dfb917950e5c486c7e0d4d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6733654/john"}, "edited": false, "score": 0, "creation_date": 1502267419, "post_id": 45584760, "comment_id": 78129718, "body": "Looks like there&#39;s a problem with your <code>settings.ini</code> file. I doubt that&#39;s related to the program."}, {"owner": {"reputation": 422, "user_id": 6733654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4366895dfb917950e5c486c7e0d4d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6733654/john"}, "edited": false, "score": 0, "creation_date": 1502267606, "post_id": 45584760, "comment_id": 78129847, "body": "What do you think, what should I do to hadle this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 422, "user_id": 6733654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4366895dfb917950e5c486c7e0d4d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6733654/john"}, "edited": false, "score": 0, "creation_date": 1502267727, "post_id": 45584760, "comment_id": 78129912, "body": "I have no idea, I don&#39;t know anything about GTK. Does that file even exist?"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1502265344, "creation_date": 1502265344, "answer_id": 45584760, "question_id": 45584601, "link": "https://stackoverflow.com/questions/45584601/bus-error-on-linuxs-microcomp-used-by-gtk/45584760#45584760", "title": "Bus Error on Linux&#39;s microcomp used by gtk", "body": "<p>You're missing the type declarations for the parameters to your functions, so they're defaulting to <code>int</code>.</p>\n\n<pre><code>void on_slider_frequency_value_changed(GtkAdjustment *slider_frequency){\n    //gtk_main_quit();\n    int value;\n    value = gtk_adjustment_get_value(slider_frequency);\n    //printf(\"%d\\n\",value);\n    pwmSetClock(value);\n}\nvoid on_slider_duty_cycle_value_changed(GtkAdjustment *slider_duty_cycle){\n    //gtk_main_quit();\n    int value;\n    value = gtk_adjustment_get_value(slider_duty_cycle);\n    //printf(\"%d\\n\",value);\n   // pwm_Write(18, value);\n    pwmWrite (18, value);\n}\n</code></pre>\n"}], "owner": {"reputation": 422, "user_id": 6733654, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4366895dfb917950e5c486c7e0d4d5c0?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/6733654/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 45584760, "answer_count": 1, "score": 1, "last_activity_date": 1502268320, "creation_date": 1502264894, "last_edit_date": 1502268320, "question_id": 45584601, "link": "https://stackoverflow.com/questions/45584601/bus-error-on-linuxs-microcomp-used-by-gtk", "title": "Bus Error on Linux&#39;s microcomp used by gtk", "body": "<p>I am running this code on Raspbian machine:</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;wiringPi.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\nGtkAdjustment *slider_frequency;\nGtkAdjustment *slider_duty_cycle;\n//GtkWidget *scale1 (GtkOrientation Horizontal, gdouble 0, gdouble 200, gdouble 1);\nint main(int argc, char *argv[])\n{\n//service.gnome3.at-spi2-core.enable = true;    \n   //NO_AT_BRIDGE =\"1\"; \n   int pin;\n   /*for(pin=0;pin&lt;8;++pin){\n      pinMode(pin, OUTPUT);\n      digitalWrite(pin,LOW);\n   }*/\n   // wiringPiSetup();\n    wiringPiSetupGpio();\n    pinMode(18,PWM_OUTPUT);\n    pwmSetMode(PWM_MODE_MS);\n    pwmSetClock(4);\n    pwmSetRange (200) ;\n  //pwmWrite (18, 30);\n    //scale1-&gt;gtk_scale_set_value_pos();\n    GtkBuilder      *builder; \n    GtkWidget       *window;\n\n    gtk_init(&amp;argc, &amp;argv);\n\n    builder = gtk_builder_new();\n    gtk_builder_add_from_file (builder, \"window_main.glade\", NULL);\n\n    window = GTK_WIDGET(gtk_builder_get_object(builder, \"window_main\"));\n    gtk_builder_connect_signals(builder, NULL);\n\n    g_object_unref(builder);\n\n    gtk_widget_show(window);                \n    gtk_main();\n\n    return 0;\n}\n\n// called when window is closed\nvoid on_window_main_destroy()\n{\n    gtk_main_quit();\n}\n\nvoid on_slider_frequency_value_changed(slider_frequency){\n    //gtk_main_quit();\n    int value;\n    value = gtk_adjustment_get_value(slider_frequency);\n    //printf(\"%d\\n\",value);\n    pwmSetClock(value);\n}\nvoid on_slider_duty_cycle_value_changed(slider_duty_cycle){\n    //gtk_main_quit();\n    int value;\n    value = gtk_adjustment_get_value(slider_duty_cycle);\n    //printf(\"%d\\n\",value);\n   // pwm_Write(18, value);\n    pwmWrite (18, value);\n}\n</code></pre>\n\n<p>Interface was designed in Glade. The code is using side lib named wiringPi and I execute it all by:</p>\n\n<pre><code>sudo gcc -o gladewin pw.c -lwiringPi -Wall `pkg-config --cflags --libs gtk+-3.0` -export-dynamic \nsudo chmod 777 gladewin\n./gladewin\n</code></pre>\n\n<p>and some errors occur. This is output which says that something goes wrong:</p>\n\n<pre><code>pw.c: In function \u2018on_slider_frequency_value_changed\u2019:\npw.c:54:38: warning: passing argument 1 of \u2018gtk_adjustment_get_value\u2019 makes pointer from integer without a cast\n     value = gtk_adjustment_get_value(slider_frequency);\n                                      ^\nIn file included from /usr/include/gtk-3.0/gtk/gtk.h:38:0,\n                 from pw.c:1:\n/usr/include/gtk-3.0/gtk/gtkadjustment.h:96:12: note: expected \u2018struct GtkAdjustment *\u2019 but argument is of type \u2018int\u2019\n gdouble    gtk_adjustment_get_value             (GtkAdjustment   *adjustment);\n            ^\npw.c: In function \u2018on_slider_duty_cycle_value_changed\u2019:\npw.c:61:38: warning: passing argument 1 of \u2018gtk_adjustment_get_value\u2019 makes pointer from integer without a cast\n     value = gtk_adjustment_get_value(slider_duty_cycle);\n                                      ^\nIn file included from /usr/include/gtk-3.0/gtk/gtk.h:38:0,\n                 from pw.c:1:\n/usr/include/gtk-3.0/gtk/gtkadjustment.h:96:12: note: expected \u2018struct GtkAdjustment *\u2019 but argument is of type \u2018int\u2019\n gdouble    gtk_adjustment_get_value             (GtkAdjustment   *adjustment);\n</code></pre>\n\n<p>I do not understand honeslty how else can I proccess signals if not by declaring a pointers named exactly like in glade program and putting them into slots. </p>\n\n<p>But what is much worse sometimes (statistically 1 to 5 maybe) I am getting</p>\n\n<pre><code>bus error \n</code></pre>\n\n<p>or </p>\n\n<pre><code>warning ** error retrieving accessibility bus address \norg.freedesktop.dbus.error.serviceunknown\n</code></pre>\n\n<p>or </p>\n\n<pre><code>WARNING: Couldn't register with accessibility bus: Did not receive a reply.\n</code></pre>\n\n<p>And when it happens my microcomp crushes and stops replying to anything but powerring off manually. \nMany sources (<a href=\"https://github.com/NixOS/nixpkgs/issues/16327\" rel=\"nofollow noreferrer\">this</a> for instance) tell that in this case one should run in terminal</p>\n\n<pre><code>export NO_AT_BRIDGE = 1\n</code></pre>\n\n<p>but nothing helps. So I though that maybe problem is in my code..?\nHow can one avoid this message and can it be caused by my code?</p>\n\n<p><strong>UPDATE ONE</strong></p>\n\n<p>Thanks to Barmar, now I know that shell command should be without spaces\nand it must be </p>\n\n<pre><code>export NO_AT_BRIDGE=1\n</code></pre>\n\n<p>but nevertheless it does not help, after ./gladewin I am getting:</p>\n\n<pre><code>(gladewin:1324): Gtk-WARNING **: Failed to parse /home/pi/.config/gtk-3.0/settings.ini: input/output error\nBus error\n</code></pre>\n\n<p><strong>UPDATE TWO</strong></p>\n\n<p>It all cannot in fixing bus error.. Now I am executing my program after compilation this way:</p>\n\n<pre><code>export NO_AT_BRIDGE=1\n./gladewin\n</code></pre>\n\n<p>and sometimes (not all the time) I am getting this:</p>\n\n<pre><code>(gladewin:1319): Gtk-WARNING **: Failed to parse /home/pi/.config/gtk-3.0/settings.ini: Input/output error\n(gladewin:1319): Gtk-CRITICAL **: _gtk_css_section_to_string: assertion 'section !=NULL' failed \n(gladewin:1319): Gtk-WARNING **: Theme parsing error: (null): Failed to import: Error opening file: Input/output error\nline 3: 1319 Bus error\n</code></pre>\n\n<p><strong>OUTPUT OF /home/pi/.config/gtk-3.0/settings.ini</strong> </p>\n\n<pre><code>[Settings]\ngtk-primary-button-warps-slider = false\n</code></pre>\n"}, {"tags": ["c", "ruby", "api", "segmentation-fault"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3442059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mOY1s.jpg?s=128&g=1", "display_name": "assemblaj", "link": "https://stackoverflow.com/users/3442059/assemblaj"}, "edited": false, "score": 0, "creation_date": 1502279080, "post_id": 45585559, "comment_id": 78138149, "body": "What other data would you need?  Also: rb_CUR_PACKET is received in a call shortly before the code snippet I included.  I made all of the variables used by that function call global and I still have the issue.  Looking into the GIL right now."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": true, "score": 0, "last_activity_date": 1502283511, "last_edit_date": 1502283511, "creation_date": 1502267697, "answer_id": 45585559, "question_id": 45584572, "link": "https://stackoverflow.com/questions/45584572/ruby-c-extension-rb-funcall-causing-segfault/45585559#45585559", "title": "Ruby C Extension: rb_funcall causing segfault", "body": "<p>There's a number of possible causes for the issue and not (it seems) enough data.</p>\n\n<p>One explanation could be that the Ruby objects (i.e <code>rb_CUR_PACKET</code>, <code>rb_READ</code> or <code>rb_PDU_DATA</code>) aren't valid by the time you called the function, since they might have been collected by the GC (Garbage Collector).</p>\n\n<p>If the Objects aren't referenced by a Ruby object, their memory might be freed sooner than you expect.</p>\n\n<p>An easy solution would be to register the Objects as a global objects (they will never be freed) or assign them as variables inside a user's object. </p>\n\n<p>Another possible cause is that you aren't executing your code within the GIL (global instruction lock).</p>\n\n<p>Ruby MRI code must always run within the GIL and within Ruby threads. If you left the GIL or spawned new threads that aren't Ruby threads, your code will crash if you're lucky.</p>\n\n<p>I suspect the GC, but it's a toss.</p>\n\n<p>Good Luck!</p>\n"}], "owner": {"reputation": 5, "user_id": 3442059, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mOY1s.jpg?s=128&g=1", "display_name": "assemblaj", "link": "https://stackoverflow.com/users/3442059/assemblaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 45585559, "answer_count": 1, "score": 0, "last_activity_date": 1502283511, "creation_date": 1502264808, "question_id": 45584572, "link": "https://stackoverflow.com/questions/45584572/ruby-c-extension-rb-funcall-causing-segfault", "title": "Ruby C Extension: rb_funcall causing segfault", "body": "<p>My extension uses a Ruby library  to send and receive command and telemetry packets over an interface and gives them to a C file transfer library for processing. </p>\n\n<p>After receiving a lot of packets, I'll get this segfault. Here's the backtrace from GDB. </p>\n\n<pre><code>            #0  search_method (defined_class_ptr=&lt;synthetic pointer&gt;, id=6177, klass=&lt;optimized out&gt;) at vm_method.c:567\n            #1  rb_method_entry_get_without_cache (klass=19934160, id=6177, defined_class_ptr=0x12c5500) at vm_method.c:592\n            #2  0x00007ffff7aced90 in rb_method_entry (klass=klass@entry=19934160, id=&lt;optimized out&gt;, \n                defined_class_ptr=defined_class_ptr@entry=0x12c5500) at vm_method.c:663\n            #3  0x00007ffff7acee71 in vm_search_method (ci=ci@entry=0x12c54c0, recv=&lt;optimized out&gt;) at vm_insnhelper.c:842\n            #4  0x00007ffff7ad4b3d in vm_exec_core (th=th@entry=0x6035d0, initial=initial@entry=0) at insns.def:1068\n            #5  0x00007ffff7ad951b in vm_exec (th=th@entry=0x6035d0) at vm.c:1440\n            #6  0x00007ffff7adac91 in vm_call0_body (th=th@entry=0x6035d0, ci=ci@entry=0x7fffffffbcb0, argv=0x7fffffffbd60)\n                at vm_eval.c:180\n            #7  0x00007ffff7adb6c6 in vm_call0 (defined_class=&lt;optimized out&gt;, me=&lt;optimized out&gt;, argv=&lt;optimized out&gt;, \n                argc=1, id=14481, recv=22956880, th=0x6035d0) at vm_eval.c:59\n            #8  rb_call0 (recv=recv@entry=22956880, mid=14481, argc=argc@entry=1, argv=argv@entry=0x7fffffffbd60, \n                scope=scope@entry=CALL_FCALL, self=&lt;optimized out&gt;) at vm_eval.c:349\n            #9  0x00007ffff7adbc64 in rb_call (scope=CALL_FCALL, argv=0x7fffffffbd60, argc=1, mid=&lt;optimized out&gt;, \n                recv=22956880) at vm_eval.c:616\n            #10 rb_funcall (recv=recv@entry=22956880, mid=&lt;optimized out&gt;, n=n@entry=1) at vm_eval.c:818\n            #11 0x00007ffff6092b10 in DL_RecvPdu () at CFGroundClient.c:414\n            #12 0x00007ffff6092dbe in method_run (self=&lt;optimized out&gt;) at CFGroundClient.c:302\n            #13 0x00007ffff7ace272 in vm_call_cfunc_with_frame (ci=0x0, reg_cfp=0x7ffff7fd1f70, th=0x6035d0)\n                at vm_insnhelper.c:1380\n            #14 vm_call_cfunc (th=th@entry=0x6035d0, reg_cfp=reg_cfp@entry=0x7ffff7fd1f70, ci=ci@entry=0xa29090)\n                at vm_insnhelper.c:1473\n            #15 0x00007ffff7ae0f6e in vm_call_method (th=0x6035d0, cfp=0x7ffff7fd1f70, ci=0xa29090) at vm_insnhelper.c:1689\n            #16 0x00007ffff7ad4b4b in vm_exec_core (th=th@entry=0x6035d0, initial=initial@entry=0) at insns.def:1069\n            #17 0x00007ffff7ad951b in vm_exec (th=th@entry=0x6035d0) at vm.c:1440\n            #18 0x00007ffff7adaa73 in rb_iseq_eval_main (iseqval=iseqval@entry=10626960) at vm.c:1685\n            #19 0x00007ffff798707d in ruby_exec_internal (n=0xa22790) at eval.c:254\n            #20 0x00007ffff798948d in ruby_exec_node (n=n@entry=0xa22790) at eval.c:319\n            #21 0x00007ffff798bc3e in ruby_run_node (n=0xa22790) at eval.c:311\n            #22 0x000000000040087b in main (argc=3, argv=0x7fffffffde58) at main.c:36\n</code></pre>\n\n<p>Here is the relevant code: </p>\n\n<pre><code>                void DL_RecvPdu() {\n                       .....\n                    /* Segfault coming from here \n                       CUR_PACKET.read(\"PDU_DATA\"); \n                       Reads telemetry item PDU_DATA from packet CUR_PACKET\n                       and returns results. PDU data is an array of bytes \n                       represented as a Ruby string that can contain nulls */\n                    VALUE pdu_data_block = rb_funcall(rb_CUR_PACKET, \n                        rb_READ, 1, \n                        rb_PDU_DATA\n                    );\n                        ....\n                }\n</code></pre>\n\n<p>Does anyone know where this error could come from and how I can fix it? </p>\n"}, {"tags": ["c", "daemon", "netbsd", "inetd"], "comments": [{"owner": {"reputation": 96, "user_id": 3225027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c14347feac5de30eb03f6fe6835bed9?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Schnoebelen", "link": "https://stackoverflow.com/users/3225027/eric-schnoebelen"}, "edited": false, "score": 2, "creation_date": 1502511434, "post_id": 45584334, "comment_id": 78251870, "body": "A bit of clarity:  You&#39;re asking if inetd will kill and restart processes it started before you asked it to reload it&#39;s configuration file?  Short answer, no. New processes will get your new arguments, but existing processes will be unchanged until they exit normally."}, {"owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "reply_to_user": {"reputation": 96, "user_id": 3225027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c14347feac5de30eb03f6fe6835bed9?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Schnoebelen", "link": "https://stackoverflow.com/users/3225027/eric-schnoebelen"}, "edited": false, "score": 0, "creation_date": 1502861140, "post_id": 45584334, "comment_id": 78369355, "body": "@EricSchnoebelen, Thanks for the reply. So, is there a standard way to killing those processes, so that they can restart with the new config"}], "answers": [{"tags": [], "owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "is_accepted": false, "score": 0, "last_activity_date": 1511585538, "creation_date": 1511585538, "answer_id": 47482719, "question_id": 45584334, "link": "https://stackoverflow.com/questions/45584334/restarting-inetd-should-effect-instances-of-all-inetd-controlled-processes/47482719#47482719", "title": "Restarting inetd should effect instances of all inetd controlled processes", "body": "<p>The standard <code>inetd</code> included in NetBSD does not manage the processes it starts (except for single-threaded services, i.e. those with \"<em>wait</em>\" flags) -- it just starts them.  Each child process services one active connection and then exits when done (i.e. when the connection is closed).  In the general case it would be very unwise to kill such processes early without very good reason -- for example consider the case where your current login session (where you tell <code>inetd</code> to reload) was opened to a service controlled by <code>inetd</code> (e.g. <code>sshd</code>).</p>\n\n<p>If you really want to kill processes handling active current connections then you will have to write some helper script of your own to do that, though perhaps <code>pkill</code> will suffice.</p>\n"}], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1511585538, "creation_date": 1502264118, "question_id": 45584334, "link": "https://stackoverflow.com/questions/45584334/restarting-inetd-should-effect-instances-of-all-inetd-controlled-processes", "title": "Restarting inetd should effect instances of all inetd controlled processes", "body": "<p>When I am sending <code>HUP</code> signal to <code>inetd</code> so that it rereads the new <code>inetd.conf</code> file, what I want is, the processes controlled by the inetd process should also restart, so that it can read the new command line parameters added to the <code>inetd.conf</code> file as part of the change.</p>\n\n<p>I know I can search for the running process and kill it, but is there a standard way to do this. I could not find anything over the Internet.</p>\n"}, {"tags": ["c++", "c", "algorithm", "data-structures"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1502264099, "post_id": 45584305, "comment_id": 78127589, "body": "<code>C</code> or <code>C++</code>? The answer may vary significantly..."}, {"owner": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 6, "creation_date": 1502265647, "post_id": 45584305, "comment_id": 78128573, "body": "Don&#39;t bother. 1M users * 8 field/user * 4 Bytes/field = 32 MBytes. On a decent server processor relevant data will be in L3 cache all the time. Any algorithm is an overkill. Write a clean, simple, maintainable code and move on. Better spend time (that you would waste on premature optimizations) on implementing another feature for your users."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 4, "creation_date": 1502266273, "post_id": 45584305, "comment_id": 78129019, "body": "I recommend a simple array with linear search for the items (and align items to 32-byte boundary, so it never crosses a cache-line). Store items in arrival order, if it is full, then remove the first and shift. I don&#39;t think that any complex algorithm will be significantly faster."}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 1, "creation_date": 1502276464, "post_id": 45584305, "comment_id": 78136327, "body": "You may want to clarify a few details. I assume you mean &quot;oldest data item out of the 8 for the given user&quot;. And I don&#39;t know whether you want the age of the insertion, or the age of the last lookup. LR<b>U</b> suggests the latter but your suggested implementation is the former."}, {"owner": {"reputation": 3365, "user_id": 4895359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b12929ef5d2ad7df9f674bcf09b617b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4895359/mark"}, "reply_to_user": {"reputation": 12286, "user_id": 1607442, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/18451ad16ed8ad45b0a18bf70b2aa002?s=128&d=identicon&r=PG", "display_name": "Ivan Aksamentov - Drop", "link": "https://stackoverflow.com/users/1607442/ivan-aksamentov-drop"}, "edited": false, "score": 0, "creation_date": 1502279615, "post_id": 45584305, "comment_id": 78138530, "body": "@drop thanks, I agree. Our current implementation uses linear array but was exploring if there are better possibilities."}], "answers": [{"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1502267038, "post_id": 45584627, "comment_id": 78129508, "body": "Not sure that this will be faster than a brute force linear search and shift, as it&#39;s only 8 32 bit items."}, {"owner": {"reputation": 3365, "user_id": 4895359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b12929ef5d2ad7df9f674bcf09b617b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4895359/mark"}, "edited": false, "score": 0, "creation_date": 1502279519, "post_id": 45584627, "comment_id": 78138452, "body": "Thanks, however as I mentioned, any list or map would be overkill for 8 entries and will not be optimized."}], "tags": [], "owner": {"reputation": 2175, "user_id": 3045171, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/le4e9.jpg?s=128&g=1", "display_name": "shapiro yaacov", "link": "https://stackoverflow.com/users/3045171/shapiro-yaacov"}, "is_accepted": false, "score": 1, "last_activity_date": 1502264939, "creation_date": 1502264939, "answer_id": 45584627, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45584627#45584627", "title": "Least Recently Used (LRU) Cache", "body": "<p>You want to use here a combination of a <code>Hash</code> table and a <code>doubly linked list</code>.<br>\nEach item is accessible via the hash table that holds the key you need plus a pointer to the element in the list.</p>\n\n<p><strong>Algorithm:</strong></p>\n\n<p>Given new item <code>x</code>, do:<br>\n1. Add <code>x</code> to the head of the list, save pointer as <code>ptr</code>.<br>\n2. Add <code>x</code> to the hash table where the data is stored, and add <code>ptr</code>.<br>\n3. If the list is bigger than allowed, take the last element (from the tail of the list) and remove it. Use the key of this element to remove it from the Hash table as well.</p>\n"}, {"tags": [], "owner": {"reputation": 9543, "user_id": 4989284, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/g03Hx.png?s=128&g=1", "display_name": "marvel308", "link": "https://stackoverflow.com/users/4989284/marvel308"}, "is_accepted": false, "score": 1, "last_activity_date": 1502266096, "creation_date": 1502266096, "answer_id": 45585033, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45585033#45585033", "title": "Least Recently Used (LRU) Cache", "body": "<p>If you want a C implementation of LRU cache try this <a href=\"http://www.geeksforgeeks.org/lru-cache-implementation/\" rel=\"nofollow noreferrer\">link</a> <br></p>\n\n<p>The idea is that we use two data structures to implement an LRU Cache. <br></p>\n\n<p>Queue which is implemented using a doubly linked list. The maximum size of the queue will be equal to the total number of frames available (cache size).The most recently used pages will be near front end and least recently pages will be near rear end. <br>\nA Hash with page number as key and address of the corresponding queue node as value. <br>\nWhen a page is referenced, the required page may be in the memory. If it is in the memory, we need to detach the node of the list and bring it to the front of the queue. <br>\nIf the required page is not in the memory, we bring that in memory. In simple words, we add a new node to the front of the queue and update the corresponding node address in the hash. If the queue is full, i.e. all the frames are full, we remove a node from the rear of queue, and add the new node to the front of queue.</p>\n"}, {"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": false, "score": 2, "last_activity_date": 1502341686, "last_edit_date": 1502341686, "creation_date": 1502267450, "answer_id": 45585481, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45585481#45585481", "title": "Least Recently Used (LRU) Cache", "body": "<p>Don Knuth gives several interesting and very efficient approximations in <em>The Art of Computer Proramming.</em></p>\n\n<ol>\n<li>Self-organizing list I: when you find an entry, move it to the head of the list; delete from the end.</li>\n<li><p>Self-organizing list II: when you find an entry, move it up one spot; delete from the end.</p>\n\n<p>[Both the above in Vol. 3 \u00a76.1(A).]</p></li>\n<li><p>Another scheme involves maintaining the list circularly with 1 extra bit per entry, which is set when you find that entry, and cleared when you skip past it to find something else. You always start searching at the last place you stopped, and if you don't find the entry you replace the one with the next clear bit with it, i.e. it hasn't been used since one entire trip around the list.</p>\n\n<p>[Vol. 1 \u00a72.5(G).]</p></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1502276636, "post_id": 45586081, "comment_id": 78136442, "body": "Given that there are only O(8) entries per user, all operations are O(1) anyway. This is not a very large data set, not at all."}, {"owner": {"reputation": 1075, "user_id": 2949645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cv3Kc.jpg?s=128&g=1", "display_name": "Sahib Yar", "link": "https://stackoverflow.com/users/2949645/sahib-yar"}, "reply_to_user": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 0, "creation_date": 1502277047, "post_id": 45586081, "comment_id": 78136721, "body": "@MSalters per user has 8 entries, and the question said there are more than 1M users, so there are 8 x 1M entries. so that&#39;s why I think it has a large data set"}, {"owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "edited": false, "score": 2, "creation_date": 1502278205, "post_id": 45586081, "comment_id": 78137528, "body": "Then your answer is unclear. Do you propose to store 8 million entries in a single Cuckoo Filter? That&#39;s certainly possible, you just give user XYZ the entries XYZ-0 to XYZ-7. And you can timestamp each of them to figure out which of the 8 entries is the oldest, and would need to be replaced. However, this is far from efficient. The memory overhead is enormous, and locality of reference is entirely absent."}, {"owner": {"reputation": 3365, "user_id": 4895359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b12929ef5d2ad7df9f674bcf09b617b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4895359/mark"}, "edited": false, "score": 0, "creation_date": 1502279453, "post_id": 45586081, "comment_id": 78138402, "body": "Thanks Sahib. There are 1M users and they are already in hash map, so once we get user entry, we only need to manage these 8 entries."}], "tags": [], "owner": {"reputation": 1075, "user_id": 2949645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cv3Kc.jpg?s=128&g=1", "display_name": "Sahib Yar", "link": "https://stackoverflow.com/users/2949645/sahib-yar"}, "is_accepted": false, "score": 0, "last_activity_date": 1502341989, "last_edit_date": 1502341989, "creation_date": 1502269231, "answer_id": 45586081, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45586081#45586081", "title": "Least Recently Used (LRU) Cache", "body": "<p>You should use <a href=\"https://www.cs.cmu.edu/~dga/papers/cuckoo-conext2014.pdf\" rel=\"nofollow noreferrer\">Cuckoo's Filter</a> which is a <em>probabilistic data structure</em> that supports fast <a href=\"https://en.wikipedia.org/wiki/Set_(mathematics)\" rel=\"nofollow noreferrer\">set</a> membership testing. It is a <a href=\"https://en.wikipedia.org/wiki/Hash_table\" rel=\"nofollow noreferrer\">hash</a>-based data structure. </p>\n\n<p>Time Complexity of Cuckoo's Filter:</p>\n\n<ol>\n<li>Lookup: <em>O(1)</em></li>\n<li>Deletion: <em>O(1)</em></li>\n<li>Insertion: <em>O(1)</em></li>\n</ol>\n\n<hr>\n\n<p>For reference here is how the cuckoo filter works.</p>\n\n<pre><code>Parameters of the filter\n\n 1. Two Hash Functions: h1 and h2\n 2. An array B with n Buckets. The i-th Bucket will be called B[i]\n\nInput : L, a list of elements to inserted into the cuckoo filter.\n\nAlgorithm:\nwhile L is not empty:\n    Let x be the 1st item in the list L. Remove x from the list.\n    if (B[h1(x)] == empty)\n          place x in B[h1(x)];\n    else if (B[h2(x)] == empty)\n          place x in B[h2(x)];\n    else\n          Let y be the element in B[h2(x)]\n          Prepend y to L\n          place x in B[h2(x)]\n</code></pre>\n\n<p>For LRU you can use time stamping in your hash function by keeping just a local variable.</p>\n\n<p>This is the best approach for very large data sets to date.</p>\n"}, {"tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1502270090, "creation_date": 1502270090, "answer_id": 45586407, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45586407#45586407", "title": "Least Recently Used (LRU) Cache", "body": "<p>I personally would either go with the self organising lists as proposed by EJP or, as we only have eight elements, simply store them together with a timestamp sequentially.</p>\n\n<p>When accessing an element, just update the timestamp, when replacing, replace the one with oldest timestamp (one linear search). This is less efficient on replacements, but more efficient on access (no need to move any elements around). And it might be the easiest to implement...</p>\n\n<p>Modification of self organising lists, if based on some array data structure: Sure, on update, you have to shift several elements (variant I) or at least swap two of them (variant II) - but if you organize the data as ring buffer, on replacement we just replace the last element with the new one and move the buffer's pointer to this new element:</p>\n\n<pre><code>a, b, c, d\n      ^\n</code></pre>\n\n<p>Accessing a:</p>\n\n<pre><code>d, b, a, c\n      ^\n</code></pre>\n\n<p>New element e:</p>\n\n<pre><code>d, e, a, c\n   ^\n</code></pre>\n\n<p>Special case: accessing the oldest element (d in this case) - we then simply can move the pointer, too:</p>\n\n<pre><code>d, e, a, c\n^\n</code></pre>\n\n<p>Just: with only 8 elements, it might not be worth the effort to implement all this...</p>\n"}, {"tags": [], "owner": {"reputation": 159118, "user_id": 15416, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a2b11b9662b5155aada74191fbe7cb9e?s=128&d=identicon&r=PG", "display_name": "MSalters", "link": "https://stackoverflow.com/users/15416/msalters"}, "is_accepted": false, "score": 0, "last_activity_date": 1502277690, "creation_date": 1502277690, "answer_id": 45589257, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache/45589257#45589257", "title": "Least Recently Used (LRU) Cache", "body": "<p>I agree with Drop and Geza's comments. The straightforward implementation will take one cache line read, and cause one cache line write. </p>\n\n<p>The only performance question left is going to be the lookup and update of that 32 bit value in 256 bits. Assuming modern x86, the lookup itself can be two instructions: <code>_mm256_cmp_epi32_mask</code> finds all equal values in parallel, <code>_mm256_lzcnt_epi32</code> counts leading zeroes = number of older non-matching items*32. But even with older SIMD operations, the cache line read/write operations will dominate the execution time. And that's in turn is dominated by finding the right user. Which in turn is dominated by the network I/O involved.</p>\n"}], "owner": {"reputation": 3365, "user_id": 4895359, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8b12929ef5d2ad7df9f674bcf09b617b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/4895359/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1598, "favorite_count": 0, "answer_count": 6, "score": 6, "last_activity_date": 1502341989, "creation_date": 1502264033, "question_id": 45584305, "link": "https://stackoverflow.com/questions/45584305/least-recently-used-lru-cache", "title": "Least Recently Used (LRU) Cache", "body": "<p>I know that I can use various container classes in STL but it's an overkill and expensive for this purpose. </p>\n\n<p>We have over 1M+ users online and per user we need to maintain 8 unrelated 32-bit data items. The goal is to</p>\n\n<ol>\n<li>find if an item exists in the list, </li>\n<li>if not, insert. Remove oldest entry if full. </li>\n</ol>\n\n<p>Brute Force approach would be to maintain a last write pointer and iterate (since only 8 items) but I am looking for inputs to better analyze and implement. </p>\n\n<p>Look forward to some interesting suggestions in  terms of design pattern and algorithm. </p>\n"}, {"tags": ["c", "arrays", "string", "pointers", "char"], "comments": [{"owner": {"reputation": 6681, "user_id": 6024122, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-uiRWa4coXLs/AAAAAAAAAAI/AAAAAAAAJUs/5BxfhSS1bUY/photo.jpg?sz=128", "display_name": "Patrick Trentin", "link": "https://stackoverflow.com/users/6024122/patrick-trentin"}, "edited": false, "score": 1, "creation_date": 1502263078, "post_id": 45583940, "comment_id": 78126933, "body": "remove <code>encrypted[0] = 0</code> and remove <code>if (i &gt; 0)</code>"}, {"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 2, "creation_date": 1502263120, "post_id": 45583940, "comment_id": 78126960, "body": "Please describe <i>in the question</i> the behaviour you are seeing and how that differs from what you expect."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 1, "creation_date": 1502263136, "post_id": 45583940, "comment_id": 78126967, "body": "The first to learn after compiling and running a hello world example in C is to to learn how to use the debugger. With help of your debugger you will be able to find out that c strings are 0 terminated. Due to your line <code>encrypted[0] = 0</code> and the fact that you never change that value in your loop (<code>if(i &gt; 0)...</code>) you see an empty string in your last printf output."}, {"owner": {"reputation": 5, "user_id": 8438188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96514056a8c5fa7749c0ee56c7ee4f5?s=128&d=identicon&r=PG", "display_name": "Aksel", "link": "https://stackoverflow.com/users/8438188/aksel"}, "edited": false, "score": 0, "creation_date": 1502264118, "post_id": 45583940, "comment_id": 78127604, "body": "Thanks everyone for the help! I thought I read I had to initialise the array with a 0 on the first element. After re-reading my C book I now realise I misread that part. Thanks again!"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1502263078, "creation_date": 1502263078, "answer_id": 45584011, "question_id": 45583940, "link": "https://stackoverflow.com/questions/45583940/copying-chars-in-c/45584011#45584011", "title": "Copying chars in C", "body": "<p>It <em>appears</em> to be empty since you have a NUL-terminator as the first element. Did you really want <code>encrypted[0] = 0;</code>, and <code>if (i &gt; 0) {</code>?</p>\n\n<p>So the C-style string output functions will not print any of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 2, "last_activity_date": 1502263091, "creation_date": 1502263091, "answer_id": 45584013, "question_id": 45583940, "link": "https://stackoverflow.com/questions/45583940/copying-chars-in-c/45584013#45584013", "title": "Copying chars in C", "body": "<p>You're not copying the first character of the string (at index 0).  You DO set that character to 0 (NUL), so when you print <code>encrypted</code> as a string, it looks like it has a zero length.</p>\n\n<p>Remove the <code>if (i&gt;0)</code> test and copy the character unconditionally.  You can also remove the <code>encrypted[0] = 0;</code> line as you're going to overwrite it with the first character of the string.</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 0, "last_activity_date": 1502263249, "creation_date": 1502263249, "answer_id": 45584063, "question_id": 45583940, "link": "https://stackoverflow.com/questions/45583940/copying-chars-in-c/45584063#45584063", "title": "Copying chars in C", "body": "<pre><code>if (i&gt;0) {\n              encrypted[i] = input[i];\n</code></pre>\n\n<p>The problem is here and your if should look like this</p>\n\n<pre><code> if (i&gt;=0) {\n             encrypted[i] = input[i];\n</code></pre>\n\n<p>This if has not too much sense</p>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1502263622, "last_edit_date": 1502263622, "creation_date": 1502263271, "answer_id": 45584068, "question_id": 45583940, "link": "https://stackoverflow.com/questions/45583940/copying-chars-in-c/45584068#45584068", "title": "Copying chars in C", "body": "<p>You already got the answer, just to elaborate on the <em>expectation</em> part, let me add my two cents.</p>\n\n<p>Quoting <code>C11</code>, chapter \u00a77.21.6.1, for a <code>%s</code> conversion specifier, with <code>printf()</code>, the expected type of argument is</p>\n\n<blockquote>\n  <p><code>s</code></p>\n  \n  <p>If no <code>l</code> length modifier is present, the argument shall be a pointer to the initial\n  element of an array of character type. Characters from the array are\n  written <strong>up to (but not including) the terminating null character</strong>. [...]</p>\n</blockquote>\n\n<p>So, in case, the first element in null, it stops there.</p>\n\n<p>In other words, the definition of a C-style <em>string</em> is, from <code>C11</code>, chapter \u00a77.1.1</p>\n\n<blockquote>\n  <p>A string is a contiguous sequence of characters terminated by and including the first null\n  character. [....]</p>\n</blockquote>\n\n<p>So, bottom line, whenever you use an array which you expect to be a <em>string</em>, you need to make sure that</p>\n\n<ul>\n<li>There is a null-terminator in the array</li>\n<li>The \"required\" data is present before the null-terminator.</li>\n</ul>\n\n<p>For example, an array with content like \"abc\\0def\\0\" is a perfectly valid <em>string</em> as per definition, but it may not suit your requirement, because the \"def\" part will be processed by no function expecting a <em>string</em>, as there is one null-terminator before that and they stop processing there.</p>\n\n<hr>\n\n<p>Now, while looping over each element, you don't rely on the null-terminator anymore, so (as long as you're within the array bound), you'll get proper value for all the individual elements.</p>\n"}], "owner": {"reputation": 5, "user_id": 8438188, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d96514056a8c5fa7749c0ee56c7ee4f5?s=128&d=identicon&r=PG", "display_name": "Aksel", "link": "https://stackoverflow.com/users/8438188/aksel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 4, "score": -4, "last_activity_date": 1502263847, "creation_date": 1502262864, "last_edit_date": 1502263847, "question_id": 45583940, "link": "https://stackoverflow.com/questions/45583940/copying-chars-in-c", "title": "Copying chars in C", "body": "<p>I'm working on a caesar cipher sort of program to get my hands dirty but I'm stuck with the following piece of code:</p>\n\n<pre><code>char * encrypt(char *input) {\n    int length = strlen(input);\n    char *encrypted;\n\n    encrypted = malloc(length+1);\n    encrypted[0] = 0;\n\n    int i;\n    for(i=0; i &lt; length; i++) {\n        printf(\"%c\\n\", input[i]);\n        if (i&gt;0) {\n            encrypted[i] = input[i];\n        }\n    }\n\n    encrypted[length] = '\\0';\n    printf(\"Encrypted: %s\\n\", encrypted);\n    return encrypted;\n}\n</code></pre>\n\n<p>For now I'm just trying to figure out why I'm unable to copy the input char for char. The encrypted string at the end is shown empty. The <code>printf</code> statement of a <code>char</code> yields the correct value however.</p>\n\n<p>What can be wrong with the code?  </p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502262952, "post_id": 45583824, "comment_id": 78126833, "body": "Not as a decorator. But that macro could be made to expand into the initialization code when required, and placed <i>inside</i> the function. You&#39;d need a pair, however. <code>ZC_PROFILING_STRAT</code> and <code>ZC_PROFILING_FINISH</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502264240, "post_id": 45583824, "comment_id": 78127675, "body": "The only idea I have is to write macro when function is called"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502264996, "post_id": 45583824, "comment_id": 78128172, "body": "@StoryTeller - more details?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502265049, "post_id": 45583824, "comment_id": 78128211, "body": "@PeterJ - Do you really think that he does not know elementary macro directives?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502265215, "post_id": 45583824, "comment_id": 78128307, "body": "So what is the difference between his <code>BeginProfiling</code> and your macro? I think he knows how to compile conditionally and how to wrap it in the macro. @StoryTeller I though that <code>ZC_PROFILE.....</code> is a special mechanism I have never heard before."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502265479, "post_id": 45583824, "comment_id": 78128481, "body": "@PeterJ - There is no difference. It only addresses the minor concern of having the profiling code there at all times (which the OP doesn&#39;t want, and therefore thinks of using macros at all, possibly to conditionally profile). <code>ZC_...</code> is an abbreviation of their name, instead of the reserved <code>__PROFILING__</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502265653, "post_id": 45583824, "comment_id": 78128578, "body": "@StoryTeller maybe it is already the macro and compiles conditionally?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502265690, "post_id": 45583824, "comment_id": 78128603, "body": "@PeterJ - Then the OP is free to ignore my comment, of course."}], "answers": [{"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": 0, "last_activity_date": 1502266039, "creation_date": 1502266039, "answer_id": 45585014, "question_id": 45583824, "link": "https://stackoverflow.com/questions/45583824/c-language-how-to-use-macro-as-a-decorator/45585014#45585014", "title": "C Language: How to use Macro as a decorator?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\n#define PROFILE2(fun, a, b) mkprofile2args(#fun, fun, a, b)\n\ntypedef int (*signature2args) (int, int);\n\nvoid\nprofiler_begin(char const*m)\n{\nprintf(\"START %s\\n\", m);\n}\n\nvoid\nprofiler_end(char const*m)\n{\nprintf(\"END %s\\n\", m);\n}\n\nint\nmkprofile2args(const char* m, signature2args fun, int a, int b)\n{\n  profiler_begin(m);\n  int res = fun(a, b);\n  profiler_end(m);\n  return res;\n}\n\n\nint\nfunction_add(int a, int b)\n{\n  return a+b;\n}\n\n#define function_add(a, b) PROFILE2(function_add, a, b)\n\nvoid\nmain(void)\n{\n  printf(\"%d\\n\", function_add(10, 20));\n}\n\n#undef function_add\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8332771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/761453f1405ff3596afeef5a792c254d?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffion", "link": "https://stackoverflow.com/users/8332771/jeffion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1502270932, "creation_date": 1502262495, "question_id": 45583824, "link": "https://stackoverflow.com/questions/45583824/c-language-how-to-use-macro-as-a-decorator", "title": "C Language: How to use Macro as a decorator?", "body": "<p>I have a handmade profiler for C program running on ARM embedding systems. It's a \"invasive\" one, which means every time I want to profile a function <code>f()</code>, I need to add some code in the very beginning and end of the function, like:</p>\n\n<pre><code>int f(int a, int b) {\n  BeginProfiling(\"f\");\n  ...\n  EndProfiling();\n}\n</code></pre>\n\n<p>I'm wondering if there is a better way? I mean, if I'm using Python I would definitely use a decorator. Is there a better solution using C Macro to have a decorator-like register mechanism? I would like the code as following:</p>\n\n<pre><code>__PROFILING__\nint f(int a, int b) {\n  ...\n}\n</code></pre>\n"}, {"tags": ["c", "posix", "language-lawyer"], "comments": [{"owner": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "edited": false, "score": 0, "creation_date": 1502264247, "post_id": 45583656, "comment_id": 78127680, "body": "Regarding (2) - Why <code>8</code>?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 137011, "user_id": 567292, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b55da07dea89fa675c7e2894c77f8024?s=128&d=identicon&r=PG", "display_name": "ecatmur", "link": "https://stackoverflow.com/users/567292/ecatmur"}, "edited": false, "score": 3, "creation_date": 1502265105, "post_id": 45583656, "comment_id": 78128246, "body": "@ecatmur because for POSIX <code>CHAR_BIT</code> equals 8."}], "answers": [{"comments": [{"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1502307784, "post_id": 45583868, "comment_id": 78158216, "body": "When I wrote <code>INTN_MIN</code>/<code>MAX</code>, I was actually referring to the mathematical values given elsewhere in the standard (i.e. -2^(N-1) to 2^(N-1) - 1), which are what you get with a typical implementation of two&#39;s complement."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1502309147, "post_id": 45583868, "comment_id": 78158888, "body": "@Kevin the C standard gives only 3 possible number formats: sign and magnitude, 1&#39;s complement and 2&#39;s complement. The 2&#39;s complement in POSIX refers to the 2&#39;s complement as defined in C and the &quot;typical&quot; is the only one allowed. But yeah, I&#39;ve noted the number above."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1586446681, "post_id": 45583868, "comment_id": 108136817, "body": "I&#39;m not sure that not having trap representations can be deduced from two&#39;s complement and no padding bits. Only the high bit set could be a trap, but the high bit set and the low bit set could be <code>INT_MIN</code> (or <code>-INT_MAX</code>)."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 9, "last_activity_date": 1502309049, "last_edit_date": 1502309049, "creation_date": 1502262618, "answer_id": 45583868, "question_id": 45583656, "link": "https://stackoverflow.com/questions/45583656/what-does-posix-mean-by-twos-complement-representation-in-stdint-h/45583868#45583868", "title": "What does POSIX mean by &quot;two&#39;s complement representation&quot; in stdint.h?", "body": "<p>TL;DR</p>\n\n<p><strong>1</strong>, <strong>3</strong>, <strong>4</strong> are true on any C99, C11 compiler where <code>intN_t</code> exists. <strong>2</strong> is true on any C11 compiler where <code>int8_t</code> is present - because the presence of <code>int8_t</code> implies that <code>CHAR_BIT</code> is 8. <strong>5</strong> specifically not required by C - behaviour on signed integer overflow is undefined.</p>\n\n<p>POSIX restricts the allowed C implementations so that <code>CHAR_BIT</code> must be 8 and integer representation is two's complement. Therefore a compliant C99/C11 compiler on a POSIX platform must have <code>int8_t</code>, which makes statements <strong>1</strong>, <strong>2</strong>, <strong>3</strong> and <strong>4</strong> true on POSIX. Since POSIX does not say anything about signed integer overflow, it remains undefined, therefore <strong>5</strong> is false.</p>\n\n<hr>\n\n<p>The quoted sentence is taken <em>verbatim</em> from C11 (C99) standard. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.20.1.1p1\" rel=\"nofollow noreferrer\">C11 7.20.1.1p1</a>:</p>\n\n<blockquote>\n  <p>The typedef name <code>intN_t</code> designates a signed integer type with width <code>N</code>, no padding bits, and a <strong>two's complement representation</strong>. Thus, <code>int8_t</code> denotes such a signed integer type with a width of exactly 8 bits.</p>\n</blockquote>\n\n<p><code>int8_t</code> is <em>optional</em> in C, so the mere presence of this fragment in the standard doesn't even require 2's complement representation. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.20.1.1p3\" rel=\"nofollow noreferrer\">C11 7.20.1.1p3</a>:</p>\n\n<blockquote>\n  <p>These types are optional. However, if an implementation provides integer types with widths of 8, 16, 32, or 64 bits, no padding bits, and (for the signed types) that have a two's complement representation, it shall define the corresponding typedef names. </p>\n</blockquote>\n\n<p>Of your original statements,</p>\n\n<ol>\n<li><p>is of course true, but such thing doesn't follow from <strong>two's complement representation</strong>. <code>int</code> ranges from <code>INT_MIN</code> to <code>INT_MAX</code> on any one's complement architecture too. However, what follows from this is that the <code>INTN_MIN</code> has value <img src=\"https://latex.codecogs.com/gif.latex?-2%5E%7BN-1%7D\">.</p></li>\n<li><p><strong>does not</strong> follow from <strong>two's complement representation</strong>. <code>sizeof(intN_t)</code> is <code>N / CHAR_BIT</code>. However, POSIX requires that<code>CHAR_BIT</code> is 8 so <code>sizeof(intN_t)</code> indeed is <code>N / 8</code></p></li>\n<li><p>This is the only thing that follows from <strong>two's complement  representation</strong></p></li>\n<li><p><strong>does not</strong> follow from <strong>a two's complement representation</strong> but the combination of 2's complement and that there are no padding bits.</p></li>\n<li><p><strong>does not</strong> follow from <strong>a two's complement representation</strong>, and is required by <strong>neither C nor POSIX</strong>.</p></li>\n</ol>\n\n<hr>\n\n<p>The type <code>int8_t</code> is not specified by POSIX but the C99, C11 that POSIX adopts and augments. POSIX adds two restrictions:\n  * that <code>CHAR_BIT</code> must be exactly 8 and not greater, even though allowed by the C programming language\n  * that one's complement or the sign and magnitude representations for integer numbers are not allowed, even if they would be allowed by the C programming language</p>\n\n<p>C99, C11 specify that <em>if present</em>, the types <code>intN_t</code> must have exactly so many bits with no padding bits, and 2's complement. If <code>int8_t</code> exists, its <code>sizeof</code> must be 1, because it is a synonym for <code>signed char</code> then and <code>CHAR_BIT</code> is equal to 8.</p>\n\n<p>There will not be a trap representations of <code>intN_t</code> but it doesn't mean that those objects with decidedly <em>indeterminate</em> values must have the same value all over, or that the passing such values to library functions will have defined behaviour. Consider the following fragment:</p>\n\n<pre><code>int32_t *foo = malloc(sizeof(int32_t));\nprintf(PRId32 \"\\n\", *foo);\nprintf(PRId32 \"\\n\", *foo);\nfree(foo);\n</code></pre>\n\n<p>The compiler need not even call <code>malloc</code>; it could compile this to the equivalent of <code>puts(\"42\\n666\");</code> - even though there are no trap values of type <code>int32_t</code>. This  is because <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.22.3.4p2\" rel=\"nofollow noreferrer\"><code>malloc</code></a>:</p>\n\n<blockquote>\n  <p>[...] allocates space for an object whose size is specified by size and <strong>whose value is indeterminate</strong>. </p>\n</blockquote>\n\n<p>And indeterminate really means <a href=\"https://stackoverflow.com/questions/17394907/c-is-an-indeterminate-value-indeterminable\">unstable; indeterminable</a></p>\n\n<hr>\n\n<p>Behaviour on signed integer overflow remains always undefined.</p>\n"}], "owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 45583868, "answer_count": 1, "score": 4, "last_activity_date": 1502309049, "creation_date": 1502261964, "question_id": 45583656, "link": "https://stackoverflow.com/questions/45583656/what-does-posix-mean-by-twos-complement-representation-in-stdint-h", "title": "What does POSIX mean by &quot;two&#39;s complement representation&quot; in stdint.h?", "body": "<p>It's a well-known fact that signed integer overflow invokes undefined behavior, and that bitwise manipulation of signed integers is unreliable at best.  Thus, I found this line in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/stdint.h.html\" rel=\"nofollow noreferrer\">the POSIX standard</a> rather curious:</p>\n\n<blockquote>\n  <p>The typedef name int N _t designates a signed integer type with width N, no padding bits, <strong>and a two's-complement representation.</strong> Thus, int8_t denotes a signed integer type with a width of exactly 8 bits.</p>\n</blockquote>\n\n<p>This is a rather nebulous statement, which could mean any combination of these things:</p>\n\n<ol>\n<li>The range of <code>intN_t</code> is from <code>INTN_MIN</code> to <code>INTN_MAX</code>.</li>\n<li><code>sizeof(intN_t) == N/8</code></li>\n<li>Bitwise operations on <code>intN_t</code> behave as expected for a two's complement representation.  <code>-1 ^ x == ~x</code> for every <code>x</code>, after inserting <code>intN_t</code> casts everywhere.</li>\n<li><code>intN_t</code> cannot have trap representations (and an optimizing compiler must not exploit possible traps).</li>\n<li>Overflow of an <code>intN_t</code> variable is defined behavior (and wraps from <code>INTN_MAX</code> to <code>INTN_MIN</code>).</li>\n</ol>\n\n<p>(1) and (2) both seem pretty obviously true to me, based on the rest of the document.  (1) is explicitly specified by the definition of <code>INTN_MIN</code>/<code>MAX</code>.  (2) is implied by \"no padding bits.\"</p>\n\n<p><strong>Which of (3), (4), and (5) are required by POSIX, if any?</strong></p>\n"}, {"tags": ["c", "matrix", "pass-by-reference"], "comments": [{"owner": {"reputation": 142, "user_id": 5138104, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-1hjNA_9m9ls/AAAAAAAAAAI/AAAAAAAAABQ/VsNojeZPeMg/photo.jpg?sz=128", "display_name": "Eugene Anisiutkin", "link": "https://stackoverflow.com/users/5138104/eugene-anisiutkin"}, "edited": false, "score": 0, "creation_date": 1502261874, "post_id": 45583573, "comment_id": 78126103, "body": "At least one problem is here <code>void fillMatrixValues(int ***matrixA, int lines, int columns)</code>. The matrixA should be <code>int **</code> not <code>int ***</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1502261888, "post_id": 45583573, "comment_id": 78126111, "body": "Generally check the return value of scanf to protect against misunderstandings. In a debug experiment print everything immediatly after you scanfed it. There are many possible mistakes to make with scanf. In short, get your scanf tested and running before attempting to do anything with its result."}], "answers": [{"tags": [], "owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "is_accepted": true, "score": 2, "last_activity_date": 1502262521, "last_edit_date": 1502262521, "creation_date": 1502262111, "answer_id": 45583707, "question_id": 45583573, "link": "https://stackoverflow.com/questions/45583573/pass-matrix-by-reference-and-scan-values/45583707#45583707", "title": "pass matrix by reference and scan values", "body": "<p><code>void main</code> -> undefined behaviour</p>\n\n<p>Use</p>\n\n<pre><code>int main(void)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int main(int argc, char ** argv)\n</code></pre>\n\n<p>You should check return value of <code>scanf</code></p>\n\n<pre><code>if (scanf(\"%d\", matrixA[i][j]) != 1)\n{\n    // failed\n}\n</code></pre>\n\n<p>Next problem</p>\n\n<pre><code>void fillMatrixValues(int ***matrixA, int lines, int columns)\nfillMatrixValues(&amp;matrixA, lines, columns)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>void fillMatrixValues(int **matrixA, int lines, int columns)\nfillMatrixValues(matrixA, lines, columns)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8438058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/451f3655b5433947db63c488950ca3d0?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Goldshtein", "link": "https://stackoverflow.com/users/8438058/dan-goldshtein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 45583707, "answer_count": 1, "score": 0, "last_activity_date": 1502265512, "creation_date": 1502261716, "last_edit_date": 1502265512, "question_id": 45583573, "link": "https://stackoverflow.com/questions/45583573/pass-matrix-by-reference-and-scan-values", "title": "pass matrix by reference and scan values", "body": "<p>I'm trying to scan values into a matrix that is passed by reference to a function and that's not compiled.\nWhat's wrong?\nI think the problem is in line of <code>scanf</code> but I don't know how to fix it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint** initMatrix(int lines, int columns) {\n    int i;\n    int** matrix;\n    matrix = (int**) calloc(lines, sizeof(int*));\n    for (i = 0; i &lt; lines; i++) {\n        matrix[i] = (int*) calloc(columns, sizeof(int));\n    }\n    return matrix;\n}\n\nvoid fillMatrixValues(int*** matrixA, int lines, int columns) {\n    int i, j;\n    for (i = 0; i &lt; lines; i++) {\n        for (j = 0; j &lt; columns; j++) {\n            scanf(\"%d\", matrixA[i][j]);\n        }\n    }\n}\n\nvoid printMatrix(int** matrix, int lines, int columns) {\n    int i, j;\n    for (i = 0; i &lt; lines; i++) {\n        for (j = 0; j &lt; columns; j++) {\n            printf(\"%d\\t\", matrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nvoid main() {\n    int** matrixA;\n    int lines = 2, columns = 2;\n    matrixA = initMatrix(lines, columns);\n    fillMatrixValues(&amp;matrixA, lines, columns);\n    printMatrix(matrixA, lines, columns);\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "timer"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 5344906, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b997d8bcdda9a7acbaf39bb17c411562?s=128&d=identicon&r=PG&f=1", "display_name": "Rohith Mohan", "link": "https://stackoverflow.com/users/5344906/rohith-mohan"}, "edited": false, "score": 0, "creation_date": 1502279309, "post_id": 45582654, "comment_id": 78138303, "body": "Thanks. Yes, I am using a Unix system."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1502258245, "creation_date": 1502258245, "answer_id": 45582654, "question_id": 45582563, "link": "https://stackoverflow.com/questions/45582563/clock-time-h-function-to-implement-timers-in-c-runs-at-double-the-speed-when/45582654#45582654", "title": "clock() (time.h) function to implement timers in C runs at double the speed when executed in a thread", "body": "<p>Be careful because the time measured by two calls to <code>clock</code> measures different things on different platforms. On Unix and Unix-like systems (like for example macOS and Linux) the difference is the process CPU time, while on Windows it's based on the wall-clock.</p>\n\n<p>As for your problem I <em>guess</em> you're on a Unix or Unix-like system. The reason I think that is just because the difference between two <code>clock</code> calls is the elapsed CPU time for a <em>process</em>, and if you use threads then it might seem that the time is speeding up because of that (since the threads run in parallel). This is the same reason you can have a multi-threaded process use more than 100% CPU time.</p>\n\n<p>The solution is to use some other way to measure time, something unrelated to CPU times and threads. For example <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/clock_gettime.html\" rel=\"nofollow noreferrer\"><code>clock_gettime</code></a>.</p>\n"}], "owner": {"reputation": 85, "user_id": 5344906, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b997d8bcdda9a7acbaf39bb17c411562?s=128&d=identicon&r=PG&f=1", "display_name": "Rohith Mohan", "link": "https://stackoverflow.com/users/5344906/rohith-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "closed_date": 1502279342, "answer_count": 1, "score": 2, "last_activity_date": 1502260345, "creation_date": 1502257811, "last_edit_date": 1502260345, "question_id": 45582563, "link": "https://stackoverflow.com/questions/45582563/clock-time-h-function-to-implement-timers-in-c-runs-at-double-the-speed-when", "closed_reason": "Duplicate", "title": "clock() (time.h) function to implement timers in C runs at double the speed when executed in a thread", "body": "<p>I want to implement a timer in C, after a particular time a function is to be called. I want to implement the timer separately using a thread. I observed that the timer runs at twice the speed when it is implemented in a thread as opposed to when it is implemented in the main function.</p>\n\n<p>Why does this happen? How can I fix it?</p>\n\n<p>Code 1(without thread):</p>\n\n<pre><code>int main (){\n    unsigned int x_hours=0;\n    unsigned int x_minutes=0;\n    unsigned int x_seconds=0;\n    unsigned int x_milliseconds=0;\n    unsigned int totaltime=0,count_down_time_in_secs=0,time_left=0, prev_time =10;    \n    clock_t x_startTime,x_countTime;\n    count_down_time_in_secs=20; \n    x_startTime=clock();  // start clock\n    time_left=count_down_time_in_secs-x_seconds;   \n\n    while (time_left&gt;0) \n    {\n        x_countTime=clock(); // update timer difference\n\n        x_milliseconds=x_countTime-x_startTime;\n        x_seconds=(x_milliseconds/(CLOCKS_PER_SEC))-(x_minutes*60);\n        x_minutes=(x_milliseconds/(CLOCKS_PER_SEC))/60;\n        x_hours=x_minutes/60;\n        time_left=count_down_time_in_secs-x_seconds; // subtract to get difference\n        if(time_left-prev_time != 0)\n        { \n            //printf(\"\\nx_countTime = %ju\\n\",x_countTime);\n            prev_time = time_left;\n            //printf( \"\\nYou have %d seconds left ( %d ) count down timer by TopCoder\",time_left,count_down_time_in_secs);\n        }   \n    }\n    printf( \"\\n\\n\\nTime's out\\n\\n\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Code 2(with timer)</p>\n\n<pre><code>void *timerThread(void *param){\n    unsigned int x_hours=0;\n    unsigned int x_minutes=0;\n    unsigned int x_seconds=0;\n    unsigned int x_milliseconds=0;\n    unsigned int totaltime=0,count_down_time_in_secs=0,time_left=0,prev_time =10;\n    clock_t x_startTime,x_countTime;\n    count_down_time_in_secs=20;  \n    x_startTime=clock();  // start clock\n    time_left=count_down_time_in_secs-x_seconds;\n\n    while (time_left&gt;0) \n    {\n        x_countTime=clock(); // update timer difference\n\n        x_milliseconds=x_countTime-x_startTime;\n        x_seconds=(x_milliseconds/(CLOCKS_PER_SEC))-(x_minutes*60);\n        x_minutes=(x_milliseconds/(CLOCKS_PER_SEC))/60;\n        x_hours=x_minutes/60;\n        time_left=count_down_time_in_secs-x_seconds; // subtract to get difference\n        if(time_left-prev_time != 0)\n        { \n            printf(\"\\nx_countTime = %ju\\n\",x_countTime);\n            prev_time = time_left;\n            printf( \"\\nYou have %d seconds left ( %d ) count down timer by TopCoder\",time_left,count_down_time_in_secs);\n        }   \n    }\n    printf( \"\\n\\n\\nTime's out\\n\\n\\n\");\n    exit(1);\n}\n\nint main()\n{\n    pthread_t *thread_id;\n    pthread_create(&amp;thread_id, NULL, timerThread, NULL);\n    while(1);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "memory", "multidimensional-array", "malloc"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1502251210, "post_id": 45581451, "comment_id": 78122145, "body": "In C99 and up, <code>int arr[6][N][N];</code> actually <i>does</i> work, but it also uses a lot of stack space and risks a stack overflow, so <code>malloc</code>ing the array is better. (<code>int ***arr = ...</code> is wrong, though.)"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502251367, "post_id": 45581451, "comment_id": 78122179, "body": "<code>int ***arr = malloc(6 * N * N * sizeof(int));</code> No, this will not work."}, {"owner": {"reputation": 53, "user_id": 8437475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mBSLe.jpg?s=128&g=1", "display_name": "No one", "link": "https://stackoverflow.com/users/8437475/no-one"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1502251387, "post_id": 45581451, "comment_id": 78122182, "body": "@user2357112 if <code>int ***arr = ...</code> is wrong, what is right?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1502251488, "post_id": 45581451, "comment_id": 78122207, "body": "<code>int (*arr)[N][N]</code>"}, {"owner": {"reputation": 53, "user_id": 8437475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mBSLe.jpg?s=128&g=1", "display_name": "No one", "link": "https://stackoverflow.com/users/8437475/no-one"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1502251560, "post_id": 45581451, "comment_id": 78122232, "body": "@user2357112 So <code>int (*arr)[N][N] = malloc(6 * N * N * sizeof(int));</code> would work? And how would I declare <code>arr</code> as an <code>extern</code> variable in a header file?"}, {"owner": {"reputation": 1603, "user_id": 1098479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f99ef88c4eb2e5254835b5a5debe92?s=128&d=identicon&r=PG", "display_name": "bit_cracker007", "link": "https://stackoverflow.com/users/1098479/bit-cracker007"}, "edited": false, "score": 0, "creation_date": 1502251686, "post_id": 45581451, "comment_id": 78122258, "body": "Similarly as you declare other extern variables. Here N should also be an extern variable supposedly."}, {"owner": {"reputation": 53, "user_id": 8437475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mBSLe.jpg?s=128&g=1", "display_name": "No one", "link": "https://stackoverflow.com/users/8437475/no-one"}, "reply_to_user": {"reputation": 1603, "user_id": 1098479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f99ef88c4eb2e5254835b5a5debe92?s=128&d=identicon&r=PG", "display_name": "bit_cracker007", "link": "https://stackoverflow.com/users/1098479/bit-cracker007"}, "edited": false, "score": 0, "creation_date": 1502252008, "post_id": 45581451, "comment_id": 78122336, "body": "@bit_cracker007 <code>extern int (*arr)[N][N];</code> gives <code>error: variably defined &#39;arr&#39; at file scope</code>"}, {"owner": {"reputation": 1603, "user_id": 1098479, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f99ef88c4eb2e5254835b5a5debe92?s=128&d=identicon&r=PG", "display_name": "bit_cracker007", "link": "https://stackoverflow.com/users/1098479/bit-cracker007"}, "edited": false, "score": 0, "creation_date": 1502252632, "post_id": 45581451, "comment_id": 78122514, "body": "Ideally you should put extern just on N. And declare the array where it is actually required."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502260329, "post_id": 45581451, "comment_id": 78125297, "body": "The presence of the keyword <code>extern</code> in a C program is a pretty certain sign that your program design is crap. The only case where it is acceptable to use is when declaring <code>const</code> qualified variables than need to be accessed by more than one translation unit - but even then it is rather questionable practice."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502261889, "post_id": 45581451, "comment_id": 78126112, "body": "@Lundin depends. I agree for typical application code. If you&#39;re writing a single threaded interrupt-driven embedded code, having some <code>extern</code>s can be quite fine."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502263789, "post_id": 45581451, "comment_id": 78127399, "body": "@FelixPalmen Not really. The interrupt callback should be located in the same source file as the code using the results from the interrupt. Shared variables between the ISR and the main program should then be local file scope variables declared as <code>static</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502264094, "post_id": 45581451, "comment_id": 78127586, "body": "@Lundin which would require function calls to access objects of other translation units in more complex code, and you <i>might</i> want to optimize that, knowing that every part of your program works correctly. The uses are still rare, I only know about one single instance in <a href=\"https://github.com/Zirias/shuttercontrol/blob/master/shutterctl_attiny84/eepdata.h\" rel=\"nofollow noreferrer\">my own code</a>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502265505, "post_id": 45581451, "comment_id": 78128496, "body": "@FelixPalmen You can write an inline function, but unfortunately that probably means that you&#39;ll end up having to expose the private variable anyway. If there are such extreme real-time requirements that even a single function call overhead is too much, then that&#39;s a very rare case. In such systems, the correct solution is most likely to pick the right MCU for the task. An 8 bit AVR is a very unlikely candidate for such a system..."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1502265558, "post_id": 45581451, "comment_id": 78128535, "body": "@Noone: <code>6 * N * N * sizeof(int)</code> is problematic because of potential overflow if type <code>int</code> is smaller than <code>size_t</code>, as is common on current 64-bit architectures.  I was humbled some time ago by this very type of problem. For example: <code>int N = 30000;</code> should cause an allocation of about 21 billion bytes, which might fit in memory, but <code>6 * N * N</code> exceeds 32-bit <code>INT_MAX</code> and at best wraps before conversion to <code>size_t</code>, so <code>malloc</code> is passed a much lower value than expected. Always put the <code>sizeof()</code> operator first to avoid this problem."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502265793, "post_id": 45581451, "comment_id": 78128664, "body": "@FelixPalmen Peeking at your project... in your specific case, the awkward Harvard architecture is the very reason why you need that variable to begin with. Von Neumann MCUs would simply read the data straight from the EEPROM with no overhead. So if you <i>must</i> have direct access to that data without setter/getter functions because your real-time spec dictates it, the correct solution would have been to pick another MCU, for example Freescale HCS08, or better yet a modern Cortex M0."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502266394, "post_id": 45581451, "comment_id": 78129094, "body": "@Lundin it&#39;s just an example ;) I don&#39;t have a hard requirement here (the tiny MCU has more than enough power to do what it&#39;s supposed in this project), but I don&#39;t feel it&#39;s necessary to provide accessor functions for everything. In this case, the only thing that could ever change is more elements in the struct, it&#39;s just some configuration table."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1502258962, "post_id": 45581512, "comment_id": 78124669, "body": "I upvoted, but I think <code>malloc(6u * sizeof *arr);</code> would be more idiomatic. Despite the nice demonstration of the &quot;array type&quot;."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502260569, "post_id": 45581512, "comment_id": 78125413, "body": "@StoryTeller I believe that the version posted is more idiomatic, since your version does not necessarily result in a parameter of type <code>size_t</code>, which is what malloc expects. Implicit type conversions should be avoided."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502260639, "post_id": 45581512, "comment_id": 78125453, "body": "@Lundin - Are you familiar with a platform where <code>size_t</code> is of lower rank than unsigned int? <code>6u</code> should be fine."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502260870, "post_id": 45581512, "comment_id": 78125576, "body": "@StoryTeller Nope :) This is just language-lawyer stuff - in practice I very much doubt <code>size_t</code> will ever be smaller than the size of an <code>int</code>. However, there are no guarantees. And regardless, it is quite likely that <code>size_t</code> is <i>larger</i> than unsigned int, in which case you still have an implicit type promotion inside the expression."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502264071, "post_id": 45581512, "comment_id": 78127567, "body": "@StoryTeller: the real problem with <code>malloc(6 * N * N * sizeof(int))</code> is the potential overflow in <code>6 * N * N</code> before conversion to <code>size_t</code>. A more generic and safer alternative would be <code>int (*arr)[N][N] = malloc(sizeof(*arr) * 6);</code>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502264154, "post_id": 45581512, "comment_id": 78127624, "body": "@chqrlie - I suggested <code>6u</code> (note the unsigned suffix) precisely to avoid signed overflow. This leaves the promotion rank of course, but I think it&#39;s a non-issue."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502265807, "post_id": 45581512, "comment_id": 78128676, "body": "@StoryTeller: my bad, your <code>malloc(6u * sizeof *arr);</code> does not have this problem. Another commenter (Noone) used <code>malloc(6 * N * N * sizeof(int));</code>. In your case, there is no compelling reason to use <code>6u</code> instead of <code>6</code>, the unparenthesized <code>sizeof *arr</code> is somewhat confusing for beginners and placing the <code>sizeof</code> first would be a safer habit."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502266056, "post_id": 45581512, "comment_id": 78128838, "body": "@chqrlie - It probably would be better, but a conscious effort is required to break certain habits."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502266061, "post_id": 45581512, "comment_id": 78128848, "body": "@StoryTeller: the only possibility for signed overflow in <code>6 * sizeof(*arr)</code>, is for <code>size_t</code> to be smaller than <code>int</code> by less than 3 bits. I am not sure if it is even allowed by the standard."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502266832, "post_id": 45581512, "comment_id": 78129385, "body": "@StoryTeller I understand why you say <code>malloc(6u * sizeof *arr);</code> is idiomatic. Because usually when we say <code>malloc(sizeof(T))</code> we expect pointer of type T. Here we don&#39;t need a pointer to <code>int[6][N][N]</code> but a pointer to <code>6 int[N][N]</code>. I will add your suggestion to the answer."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502266871, "post_id": 45581512, "comment_id": 78129402, "body": "@StoryTeller it&#39;s just that some one looking for the answer (not going through the comments) might miss why the <code>u</code> after <code>6</code> is important."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502266893, "post_id": 45581512, "comment_id": 78129418, "body": "@AjayBrahmakshatriya - Be sure to take note of chqrlies comments too. They are most prudent."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502267826, "post_id": 45581512, "comment_id": 78129980, "body": "@StoryTeller Yes, I corrected. Could you explain why <code>int[N][N]</code> is not the same type as <code>*arr</code> ? Because of VLAs?"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502268053, "post_id": 45581512, "comment_id": 78130136, "body": "@AjayBrahmakshatriya - It is the same from the POV of <code>sizeof</code>. My issue with it is that one repeats the type. The point of the idiom is to never allow an accidental mismatch between the parameter to sizeof and the type of the pointee. If <code>arr</code> is ever modified to point at <code>int[M][N]</code>, for instance, the call to malloc will stay correct without requiring modification (that a poor careless programmer may forget)."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502268245, "post_id": 45581512, "comment_id": 78130276, "body": "@StoryTeller Yes, that makes sense. I understood your point about not repeating before. It&#39;s just I couldn&#39;t follow why you said they were entirely different types. Thanks for the suggestion!"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1502268562, "post_id": 45581512, "comment_id": 78130486, "body": "@AjayBrahmakshatriya - I meant <code>int[N][N]</code> not being the same as <code>int[6][N][N]</code>. At least the second one is what the OP wanted to have. Less confusion from that standpoint."}], "tags": [], "owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "is_accepted": false, "score": 3, "last_activity_date": 1502267743, "last_edit_date": 1502267743, "creation_date": 1502251489, "answer_id": 45581512, "question_id": 45581451, "link": "https://stackoverflow.com/questions/45581451/allocate-6xnxn-array/45581512#45581512", "title": "Allocate 6xNxN array", "body": "<p>You can allocate your 3-dimensional array on the heap as</p>\n\n<pre><code>int (*arr)[N][N] = malloc(sizeof(int[6][N][N]));\n</code></pre>\n\n<p>After use, you can free as</p>\n\n<pre><code>free(arr);\n</code></pre>\n\n<p>Another way of writing the same as suggested by @StoryTeller is -</p>\n\n<pre><code>int (*arr)[N][N] = malloc(6u * sizeof(*arr));\n</code></pre>\n\n<p>But here you need to be careful about the <code>u</code> after <code>6</code> to prevent signed arithmetic overflow.</p>\n\n<p>Also, there can still be issues on platforms where <code>size_t</code> is smaller in width that <code>int</code> as suggested by @chqrlie, but that won't be the case on \"most\" commonly used platforms and hence you are fine using it. </p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 1, "last_activity_date": 1502261789, "last_edit_date": 1502261789, "creation_date": 1502256015, "answer_id": 45582206, "question_id": 45581451, "link": "https://stackoverflow.com/questions/45581451/allocate-6xnxn-array/45582206#45582206", "title": "Allocate 6xNxN array", "body": "<p>What you want can't work directly. For indexing a multi-dimensional array, all but the very first dimension need to be part of the <strong>type</strong> and here's why:</p>\n\n<p>The indexing operator operates on <strong>pointers</strong> by first adding an index to the pointer and then dereferencing it. The identifier of an array evaluates to a pointer to its first element (except when e.g. used with <code>sizeof</code>, <code>_Alignof</code> and <code>&amp;</code>), so indexing on arrays works as you would expect.</p>\n\n<p>It's very simple in the case of a single-dimension array. With </p>\n\n<pre><code>int a[42];\n</code></pre>\n\n<p><code>a</code> evaluates to a pointer of type <code>int *</code>  and indexing works the following way: <code>a[18] =&gt; *(a + 18)</code>.</p>\n\n<p>Now in a 2-dimensional array, all the elements are stored contiguously (\"row\" after \"row\" if you want to understand it as a matrix), and what's making the indexing \"magic\" work is the <em>types</em> involved. Take for example:</p>\n\n<pre><code>int a[16][42];\n</code></pre>\n\n<p>Here, the <em>elements</em> of <code>a</code> have the type <code>int ()[42]</code> (42-element array of int). According to the rules above, evaluating an expression of this type in most contexts again yields an <code>int *</code> pointer. But what about <code>a</code> itself? Well, it's an <em>array of <code>int ()[42]</code></em> so <code>a</code> will evaluate to a <em>pointer to 42-element array of int</em>: <code>int (*)[42]</code>. Then let's have a look at what the indexing operator does:</p>\n\n<pre><code>a[3][18] =&gt; *(*(a + 3) + 18)\n</code></pre>\n\n<p>With <code>a</code> evaluating to the address of <code>a</code> with type <code>int (*)[42]</code>, this inner addition of <code>3</code> can properly add <code>42 * sizeof(int)</code>. This would be impossible if the <strong>second</strong> dimension wasn't known in the type.</p>\n\n<p>I guess it's simple to deduce the example for the n-dimensional case.</p>\n\n<hr>\n\n<p>In your case, you have two possibilities to achieve something similar to what you want.</p>\n\n<ol>\n<li><p>Use a dynamically allocated <strong>flat</strong> array with size <code>6*N*N</code>. You can calculate the indices yourself if you save <code>N</code> somewhere.</p></li>\n<li><p>Somewhat less efficient, but yielding better readable code, you could use an <em>array of pointers to arrays of pointers to int</em> (multiple indirection). You could e.g. do</p>\n\n<pre><code>int ***a = malloc(6 * sizeof *int);\nfor (size_t i = 0; i &lt; 6; ++i)\n{\n    a[i] = malloc(N * sizeof *(a[i]));\n    for (size_t j = 0; j &lt; N ++j)\n    {\n        a[i][j] = malloc(N* sizeof *(a[i][j]));\n    }\n}\n// add error checking to malloc calls!\n</code></pre>\n\n<p>Then your accesses will look just like those to a normal 3d array, but it's stored internally as many arrays with pointers to the other arrays instead of in a big contiguous block.</p>\n\n<p>I don't think it's worth using this many indirections, just to avoid writing e.g. <code>a[2*N*N+5*N+4]</code> to access the element at <code>2,5,4</code>, so my recommendation would be the first method.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502261637, "post_id": 45583093, "comment_id": 78125965, "body": "Be aware that VLAs are only <i>optional</i> in C11. And of course, they can&#39;t work at file scope, as OP was trying (see comments). Another reason to avoid them is possible stack overflow if you can&#39;t know the size. But of course, I agree about the <i>three-star programmer</i> issue. I&#39;d opt for using a flat allocated array and writing expressions for indexing."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502345833, "post_id": 45583093, "comment_id": 78170392, "body": "@FelixPalmen In practice nobody would use a compiler that supports C11 but not VLA, since VLAs are nowadays idiomatic C. Not so much because of actual VLAs, but because they allow array pointers and function parameter arrays with variable length. A compiler which did not support that would be useless for modern C programming. We need not concern ourselves with portability to useless compilers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502348286, "post_id": 45583093, "comment_id": 78171825, "body": "that&#39;s a very strong opinion, but I don&#39;t follow it. <i>Idiomatic</i> C is still passing pointers and <code>size_t</code> parameters. VLAs received a lot of criticism, e.g. because you can&#39;t recover from OOM conditions. <a href=\"https://groups.google.com/d/msg/comp.std.c/AoB6LFHcd88/BvA4NiBe2mcJ\" rel=\"nofollow noreferrer\">This usenet post</a> (not authorative of course) has a nice list."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502356542, "post_id": 45583093, "comment_id": 78177367, "body": "@FelixPalmen Modern, idiomatic C is for example: <code>void func (size_t n, int array[n])</code>. It is not <code>void func(int* array, size_t n)</code>, that&#39;s old style. Modern idiomatic C is <code>int (*arr)[y] = malloc( sizeof(int[x][y] );</code>, it is not <code>int* arr = malloc( x*y*sizeof(int) );</code>, that&#39;s C90 style mangled arrays. And so on. The modern version require that a pointer to VLA type can be used. To not use them is to return to 1990s style C programming."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502524247, "post_id": 45583093, "comment_id": 78254280, "body": "I don&#39;t think so. There are reasons to make VLA optional and very few cases where using VLA really makes for better code. You should at least be aware you&#39;re using an optional feature and make a concious decision about it."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502691293, "post_id": 45583093, "comment_id": 78294173, "body": "@FelixPalmen I really can&#39;t see a reasons. Rather, it seems that the only  reason they are optional is because of some political reason, such as the Microsoft lobby insisting on it. MS were too lazy to implement C99 and still don&#39;t want to do it now, 18 years later."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1502260096, "creation_date": 1502260096, "answer_id": 45583093, "question_id": 45581451, "link": "https://stackoverflow.com/questions/45581451/allocate-6xnxn-array/45583093#45583093", "title": "Allocate 6xNxN array", "body": "<p><code>int arr[6][N][N];</code> will work just fine. You merely need to update your compiler and C knowledge to the year 1999 or later, when variable-length arrays (VLA) were introduced to the language.</p>\n\n<p>(If you have an older version of GCC than 5.0, you must explicitly tell it to not use an ancient version of the C standard, by passing <code>-std=c99</code> or <code>-std=c11</code>.)</p>\n\n<p>Alternatively if you need heap allocation, you can do:</p>\n\n<pre><code>int (*arrptr)[Y][Z] = malloc( sizeof(int[X][Y][Z]) );\n</code></pre>\n\n<p>You cannot do <code>int ***arr = malloc(6 * N * N * sizeof(int));</code> since a <code>int***</code> cannot point at a 3D array. In general, more than two levels of indirection is a certain sign that your program design is completely flawed.</p>\n\n<p>Detailed info here: <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">Correctly allocating multi-dimensional arrays</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7022, "user_id": 7659995, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZH7M.png?s=128&g=1", "display_name": "MD XF", "link": "https://stackoverflow.com/users/7659995/md-xf"}, "is_accepted": true, "score": 0, "last_activity_date": 1507610045, "creation_date": 1507610045, "answer_id": 46658675, "question_id": 45581451, "link": "https://stackoverflow.com/questions/45581451/allocate-6xnxn-array/46658675#46658675", "title": "Allocate 6xNxN array", "body": "<p>Making a simple change to the declaration on this line and keeping the <code>malloc</code> can easily solve your problem.</p>\n\n<pre><code>int ***arr = malloc(6 * N * N * sizeof(int));\n</code></pre>\n\n<p>However, <code>int ***</code> is unnecessary (and wrong). Use a flat array, which is easy to allocate:</p>\n\n<pre><code>int *flatarr = malloc(6 * N * N * sizeof(int));\n</code></pre>\n\n<p>This works for three dimensions, and instead of accessing <code>arr[X][Y][Z]</code> as in the question, you access <code>flatarr[(X*N*N) + (Y*N) + Z]</code>. In fact, you could even write a handy macro:</p>\n\n<pre><code>#define arr(X,Y,Z) flatarr[((X)*N*N) + ((Y)*N) + (Z)]\n</code></pre>\n\n<p>This is basically what I've done in my language <a href=\"//git.io/Cubically\" rel=\"nofollow noreferrer\">Cubically</a> to allow for multiple-size cubes. Thanks to <a href=\"http://ppcg.ga\" rel=\"nofollow noreferrer\">Programming Puzzles &amp; Code Golf</a> user <a href=\"https://codegolf.stackexchange.com/users/12012/dennis\">Dennis</a> for giving me this idea.</p>\n"}], "owner": {"reputation": 53, "user_id": 8437475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mBSLe.jpg?s=128&g=1", "display_name": "No one", "link": "https://stackoverflow.com/users/8437475/no-one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 0, "accepted_answer_id": 46658675, "answer_count": 4, "score": 3, "last_activity_date": 1507610045, "creation_date": 1502251043, "last_edit_date": 1502251278, "question_id": 45581451, "link": "https://stackoverflow.com/questions/45581451/allocate-6xnxn-array", "title": "Allocate 6xNxN array", "body": "<p>I have a variable <code>N</code>. I need a <code>6xNxN</code> array.</p>\n\n<p>Something like this:</p>\n\n<pre><code>int arr[6][N][N];\n</code></pre>\n\n<p>But, obviously, that doesn't work.</p>\n\n<p>I'm not sure how I'd go about allocating this so that I can access, e.g. <code>arr[5][4][4]</code> if <code>N</code> is 5, and <code>arr[5][23][23]</code> if <code>N</code> is 24.</p>\n\n<p>Note that <code>N</code> will never change, so I'll never have to <code>realloc</code>ate <code>arr</code>.</p>\n\n<p>What should I do? Will <code>int ***arr = malloc(6 * N * N * sizeof(int));</code> work?</p>\n"}, {"tags": ["c", "string", "pointers"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1502251057, "post_id": 45581444, "comment_id": 78122110, "body": "<code>input[j]</code> means to select the j-th character out of the array. So you are passing a single character, not an array.   I guess you meant <code>input + j</code>"}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1502251774, "post_id": 45581444, "comment_id": 78122278, "body": "<code>strstr(input, argv[i]) != NULL</code> use of uninitialized string?"}, {"owner": {"reputation": 416, "user_id": 2078482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55ecdb8ff8f2d8b8e0596e1627b1049e?s=128&d=identicon&r=PG", "display_name": "Tisp", "link": "https://stackoverflow.com/users/2078482/tisp"}, "edited": false, "score": 0, "creation_date": 1502252037, "post_id": 45581444, "comment_id": 78122346, "body": "arguments of <code>strcmp</code> are <code>const char *str1, const char *str2</code>, you are using  only a char in <code>input[j]</code>"}, {"owner": {"reputation": 1075, "user_id": 2949645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cv3Kc.jpg?s=128&g=1", "display_name": "Sahib Yar", "link": "https://stackoverflow.com/users/2949645/sahib-yar"}, "edited": false, "score": 0, "creation_date": 1502255515, "post_id": 45581444, "comment_id": 78123339, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/27160073/replacing-words-inside-string-in-c\" title=\"replacing words inside string in c\">stackoverflow.com/questions/27160073/&hellip;</a>"}, {"owner": {"reputation": 1544, "user_id": 7095433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69e608c3fba680f67e2997cae63cf626?s=128&d=identicon&r=PG", "display_name": "landru27", "link": "https://stackoverflow.com/users/7095433/landru27"}, "edited": false, "score": 0, "creation_date": 1561045654, "post_id": 45581444, "comment_id": 99944695, "body": "you might be thinking that you can use <code>input[j]</code> the way that you can / do use <code>argv[i]</code> (in that same function call);  but note that <code>argv[]</code> is a <code>char*</code> and <code>input[]</code> is a <code>char</code>"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6511931, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aa2c58054ee3ca00751913e452def7e?s=128&d=identicon&r=PG&f=1", "display_name": "PareshDhandhukiya", "link": "https://stackoverflow.com/users/6511931/pareshdhandhukiya"}, "is_accepted": false, "score": 0, "last_activity_date": 1502261972, "creation_date": 1502261972, "answer_id": 45583658, "question_id": 45581444, "link": "https://stackoverflow.com/questions/45581444/making-integer-from-a-pointer-without-a-cast/45583658#45583658", "title": "Making integer from a pointer without a cast", "body": "<p>as note in your error mention you are passing char instead of const char*,\nnote: expected \u2018const char *\u2019 but argument is of type \u2018char\u2019 extern int strcmp</p>\n\n<p>here char input[1028]; is array of character . so you need to pass address of array index i.e &amp;input[j] instead of input[j].</p>\n\n<p>strcmp(&amp;input[j], argv[i]) should work in place of </p>\n\n<p>strcmp(input[j], argv[i])</p>\n\n<p>note : here argv[i] is array of char* so you don't need to pass it as &amp;argv[i].Also in array case if you are mentioning array index then you need to add &amp; to pass its address.if you are passing array without mentioning index i.e strcmp(input,argv[i]) in your case then it will pass address of input[0]</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8001286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa64c9326117a3b305d78acc1fd3527f?s=128&d=identicon&r=PG&f=1", "display_name": "DevNP", "link": "https://stackoverflow.com/users/8001286/devnp"}, "is_accepted": false, "score": 1, "last_activity_date": 1502452719, "creation_date": 1502452719, "answer_id": 45634705, "question_id": 45581444, "link": "https://stackoverflow.com/questions/45581444/making-integer-from-a-pointer-without-a-cast/45634705#45634705", "title": "Making integer from a pointer without a cast", "body": "<p>As error suggests, there are two problems in your code.</p>\n\n<ol>\n<li><p>In line 13: input[j] is a character and we should pass char * like &amp;input[j] or (input+j) or input.</p></li>\n<li><p>In line 14: You can not directly copy one string into other by \"=\".</p></li>\n</ol>\n\n<p>You may refer below code for your functionality.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\nint main(int argc, char* argv[])\n{\n    char censor[] = \"CENSORED\";\n    char word[] = \"bad_word\";\n    char input[1028];\n    /* added logic code */\n    for(int i = 1; i &lt; argc; i++) {\n            /* compare if this is bad word */\n            if(strcmp(argv[i], word) == 0) {\n                    // found bad_word\n                    //replace with censor\n                    strcat(input, censor);\n                    strcat(input, \" \");\n            } else {\n                    // no bad word, we can go with the same\n                    strcat(input, argv[i]);\n                    strcat(input, \" \");\n            }\n    }\n    printf(\"%s\", input);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>So run your code from terminal as </p>\n\n<pre><code>./a.out I found bad_word and this is bad_word\n</code></pre>\n\n<p>And it will give output as </p>\n\n<pre><code>I found CENSORED and this is CENSORED\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8437456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/506d425647decb90d2cace43b41da7f6?s=128&d=identicon&r=PG&f=1", "display_name": "Elizabeth", "link": "https://stackoverflow.com/users/8437456/elizabeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1427, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1502452719, "creation_date": 1502251001, "last_edit_date": 1502259156, "question_id": 45581444, "link": "https://stackoverflow.com/questions/45581444/making-integer-from-a-pointer-without-a-cast", "title": "Making integer from a pointer without a cast", "body": "<p>I'm writing a code that will take a word and a text to be examined from stdin and censored the word if it appears in the text. That's my code so far, but when I compile the code it produces error below.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main(int argc, char* argv[])\n{\n    char censor[] = \"CENSORED\";\n    char input[1028];\n\n    for(int i = 1; i &lt; argc; i++){\n        if(strstr(input, argv[i]) != NULL){\n            for(int j = 0; j &lt; strlen(input); j++){\n                if(strcmp(input[j], argv[i]) == 0){\n                    input[j] = censor;\n                }\n            }\n        }\n    }\n\n    printf(\"%s\", input);\n    printf(\"\\n\");\n}\n</code></pre>\n\n<blockquote>\n  <p>censored.c: In function \u2018main\u2019: censored.c:13:15: warning: passing\n  argument 1 of \u2018strcmp\u2019 makes pointer from integer without a cast\n  [-Wint-conversion]\n           if(strcmp(input[j], argv[i]) == 0){\n                     ^ In file included from censored.c:3:0: /usr/include/string.h:140:12: note: expected \u2018const char *\u2019 but\n  argument is of type \u2018char\u2019  extern int strcmp (const char *__s1, const\n  char *__s2)\n                  ^ censored.c:14:15: warning: assignment makes integer from pointer without a cast [-Wint-conversion]\n            input[j] = censor;</p>\n</blockquote>\n\n<p>I'm not sure why they think the char array is an integer, please help, thanks!</p>\n"}, {"tags": ["c", "assembly"], "comments": [{"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 2, "creation_date": 1502250134, "post_id": 45581010, "comment_id": 78121882, "body": "You don&#39;t mention your OS, but this looks like Linux, in which case <i>no</i> functions get implicit <code>_</code>s."}, {"owner": {"reputation": 501, "user_id": 5105943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uScYC.jpg?s=128&g=1", "display_name": "Guofeng Pan", "link": "https://stackoverflow.com/users/5105943/guofeng-pan"}, "reply_to_user": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1502251967, "post_id": 45581010, "comment_id": 78122325, "body": "All functions or just those implemention-ralated functions ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502254117, "post_id": 45581010, "comment_id": 78122902, "body": "no functions..."}], "owner": {"reputation": 501, "user_id": 5105943, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uScYC.jpg?s=128&g=1", "display_name": "Guofeng Pan", "link": "https://stackoverflow.com/users/5105943/guofeng-pan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "closed_date": 1502254195, "answer_count": 0, "score": 0, "last_activity_date": 1502247905, "creation_date": 1502247905, "question_id": 45581010, "link": "https://stackoverflow.com/questions/45581010/why-the-standard-function-libc-start-main-is-not-compiled-with-an-extra-unde", "closed_reason": "Duplicate", "title": "Why the standard function &quot;__libc_start_main&quot; is not compiled with an extra underscore(&quot;_&quot;) prefix?", "body": "<p>I am a programmer using Java and C for a few years, recently I am reading the book <strong>Advanced C and C++ Compiling</strong>, from which I learned that some functions are invoked before the main is called, like the \"_start\", the \"__libc_start_main\". Those details must be explained and answered hundreds of time here by C experts.</p>\n\n<p>But I noticed a very very tiny things that, with the common function invocation conventions in C like the cdecl, when we write a function, its name will be prefixed with an underscore '_' after compiled. That means if you have a function called foo, it will be compiled as _foo in the final assembly text. Inversely, if we found a section called _start in the assembly text, it should having a mapping function called \"start\" in C.</p>\n\n<p>Am I right? If so, the \"__libc_start_main\" in the assembly text should have its function signature as \"_libc_start_main\" (one less underscore prefix) in C ?</p>\n\n<pre><code>080482d0 &lt;_start&gt;:\n80482d0:       31 ed                   xor    %ebp,%ebp\n80482d2:       5e                      pop    %esi\n80482d3:       89 e1                   mov    %esp,%ecx\n80482d5:       83 e4 f0                and    $0xfffffff0,%esp\n80482d8:       50                      push   %eax\n80482d9:       54                      push   %esp\n80482da:       52                      push   %edx\n80482db:       68 50 84 04 08          push   $0x8048450\n80482e0:       68 e0 83 04 08          push   $0x80483e0\n80482e5:       51                      push   %ecx\n80482e6:       56                      push   %esi\n80482e7:       68 d0 83 04 08          push   $0x80483d0\n80482ec:       e8 cf ff ff ff          call   80482c0   &lt;__libc_start_main@plt&gt;\n80482f1:       f4                      hlt\n80482f2:       66 90                   xchg   %ax,%ax\n</code></pre>\n\n<p>I know this is not right obviously because if you google it, hundreds of sites will show you that its signature is exactly same as it is marked and called in assembly. Can any C expert explain this?  </p>\n\n<pre><code>int __libc_start_main(\n    int (*main)(int, char **, char **), int argc, char **argv,\n    int (*init)(int, char **, char **), void (*fini)(void),\n    void (*ldso_fini)(void)) ;\n</code></pre>\n"}, {"tags": ["c++", "c", "floating-point"], "comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1502245200, "post_id": 45580645, "comment_id": 78120682, "body": "Why do you need that <i>specific</i> numeric relationship?"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 1, "creation_date": 1502245297, "post_id": 45580645, "comment_id": 78120701, "body": "left fill with zeroes"}, {"owner": {"reputation": 18530, "user_id": 3344003, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/988af95d5692ee66b1fc2fe725ba738e?s=128&d=identicon&r=PG&f=1", "display_name": "user3344003", "link": "https://stackoverflow.com/users/3344003/user3344003"}, "edited": false, "score": 0, "creation_date": 1502245318, "post_id": 45580645, "comment_id": 78120703, "body": "I have no idea what is bing asked here. How are you converting the float to an array of bytes?"}, {"owner": {"reputation": 12738, "user_id": 131050, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3be77c4c9c91bb4e70ae93a2e23752e?s=128&d=identicon&r=PG", "display_name": "jeffreyveon", "link": "https://stackoverflow.com/users/131050/jeffreyveon"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1502245318, "post_id": 45580645, "comment_id": 78120704, "body": "@RobertHarvey To serialize and store a floating point number and still be able to do comparisons by comparing byte by byte."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 1, "creation_date": 1502245679, "post_id": 45580645, "comment_id": 78120784, "body": "A single-precision floating point is represented by a sign bit, eight bits for the exponent and 23 bits for the mantissa.  It should be a relatively simple matter to arrange those bits so that the numeric ordering is preserved.  It won&#39;t be the relationship you describe in your question, however.  See <a href=\"https://en.wikipedia.org/wiki/Single-precision_floating-point_format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Single-precision_floating-point_format</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502245862, "post_id": 45580645, "comment_id": 78120828, "body": "The <a href=\"https://stackoverflow.com/a/45190635/2410359\">2nd part of this answer</a> addresses OP&#39;s goal."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502246176, "post_id": 45580645, "comment_id": 78120900, "body": "@jeffreyveon Does the linked answer meet your goal?  Otherwise, please detail why this post is using 8 bytes to do something that should only take 4 - the typical size of a <code>float</code>."}, {"owner": {"reputation": 56858, "user_id": 131930, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/91536fe27d32713b8a154a0bf42f6748?s=128&d=identicon&r=PG", "display_name": "Jeremy Friesner", "link": "https://stackoverflow.com/users/131930/jeremy-friesner"}, "edited": false, "score": 1, "creation_date": 1502246231, "post_id": 45580645, "comment_id": 78120915, "body": "I suspect the most robust solution would be to read the bytes back in to a floating-point variable and then compare the floating-point variables in the usual fashion.  Anything &quot;clever&quot; that avoids that step will likely be slower and will also likely give the incorrect result in some cases."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502246324, "post_id": 45580645, "comment_id": 78120938, "body": "@chux: it might take 8 bytes to assure the correct ordering."}, {"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 0, "creation_date": 1502246447, "post_id": 45580645, "comment_id": 78120959, "body": "a modern Intel processor does doubles as fast is ints. Why not just treat the data as doubles when it is on your side of the serialization? even if you have to C cast..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "edited": false, "score": 1, "creation_date": 1502246974, "post_id": 45580645, "comment_id": 78121092, "body": "@lakeweb Many modern embedded process lack FP units and such integer based compares are <i>significantly</i> faster.  Of course OP&#39;s situation  is not well known."}, {"owner": {"reputation": 1727, "user_id": 3166476, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/tU6SH.jpg?s=128&g=1", "display_name": "lakeweb", "link": "https://stackoverflow.com/users/3166476/lakeweb"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502247258, "post_id": 45580645, "comment_id": 78121167, "body": "Hi @chux yes. I&#39;ve written a trig lib in integer form for a small micro. The op will have to chime in about his target..."}], "answers": [{"comments": [{"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1502249458, "post_id": 45581006, "comment_id": 78121688, "body": "This is pretty much what I thought, but I got thrown by the OP&#39;s formula for evaluating order, which doesn&#39;t make sense to me."}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1502281862, "post_id": 45581006, "comment_id": 78140379, "body": "You need bytes because that&#39;s the only <b>portable</b> way to dissect values."}], "tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": true, "score": 3, "last_activity_date": 1502247843, "creation_date": 1502247843, "answer_id": 45581006, "question_id": 45580645, "link": "https://stackoverflow.com/questions/45580645/c-c-converting-a-float-to-byte-array-such-that-bytes-preserve-ordering/45581006#45581006", "title": "C/C++ - converting a float to byte array such that bytes preserve ordering", "body": "<p>If you ignore NANs (which always compare unequal to everything, including themselves), this is simple. Otherwise, it is impossible.</p>\n\n<p>First, convert to a big-endian byte array directly.</p>\n\n<p>The sign bit is the high bit of the first byte. The following bits are the exponent, and then the mantissa.</p>\n\n<p>If the sign bit is not set, set it so that all positive numbers sort after all negative numbers.</p>\n\n<p>Otherwise, apply the <code>~</code> operator to all bytes (or maybe do this while it's all packed in a single integer - why do you need bytes anyway?). This will reverse the sort order within the negative numbers, as well as moving them below the positive numbers.</p>\n\n<p>You may also want to coalesce zeros (if the only bit set anywhere is the sign bit, clear it).</p>\n"}, {"tags": [], "owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "is_accepted": false, "score": 2, "last_activity_date": 1502282243, "creation_date": 1502282243, "answer_id": 45590905, "question_id": 45580645, "link": "https://stackoverflow.com/questions/45580645/c-c-converting-a-float-to-byte-array-such-that-bytes-preserve-ordering/45590905#45590905", "title": "C/C++ - converting a float to byte array such that bytes preserve ordering", "body": "<p>If your floating-point implementation uses IEEE-754 (most do), you can take advantage of a subtle design point: if you treat the bits of an IEEE floating-point value as a sign-magnitude representation of an integral value, the usual ordering comparisons on that value will give <strong>exactly</strong> the same order as the corresponding comparisons on the floating-point value, <strong>and</strong> provide a consistent ordering when NaNs are present (positive NaNs are greater than infinity and negative NaNs are less than -infinity). So check the sign bits: if they're different, the positive one is greater; if they're the same, compare the rest as if they were an integral value.</p>\n"}], "owner": {"reputation": 12738, "user_id": 131050, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f3be77c4c9c91bb4e70ae93a2e23752e?s=128&d=identicon&r=PG", "display_name": "jeffreyveon", "link": "https://stackoverflow.com/users/131050/jeffreyveon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 0, "accepted_answer_id": 45581006, "answer_count": 2, "score": 0, "last_activity_date": 1502282243, "creation_date": 1502244918, "last_edit_date": 1502246154, "question_id": 45580645, "link": "https://stackoverflow.com/questions/45580645/c-c-converting-a-float-to-byte-array-such-that-bytes-preserve-ordering", "title": "C/C++ - converting a float to byte array such that bytes preserve ordering", "body": "<p>Is there a way to convert a <code>float</code> to an <code>unsigned char fbytes[8]</code> such that: </p>\n\n<p>If float value <code>f1 &lt; f2</code>, then <code>fbytes1[i]</code> should NEVER be greater than <code>fbytes2[i]</code> for <code>0 &lt;= i &lt;= 7</code>?</p>\n\n<p>The intention behind this is to serialize and store a floating point number and still be able to do comparisons by comparing byte by byte. E.g. even if the float is stored as raw bytes, I can sort rows by simple byte comparison and still preserve order.</p>\n"}, {"tags": ["c", "parsing"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1502244648, "post_id": 45580598, "comment_id": 78120540, "body": "We&#39;re long past the days where a file the size of an ordinary source code file is expected to be a memory hog."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 2, "creation_date": 1502244761, "post_id": 45580598, "comment_id": 78120574, "body": "There is no defined behavior for errors, so trying to be too informative about what went wrong is for the most part an impossible task. Just do what other parsers do and just point where it is."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1502245187, "post_id": 45580598, "comment_id": 78120677, "body": "You may also want to look at <code>mmap</code>."}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 1, "creation_date": 1502248360, "post_id": 45580598, "comment_id": 78121417, "body": "@Havenard Good error handling is what separates good compilers from bad compilers."}, {"owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "edited": false, "score": 1, "creation_date": 1502270473, "post_id": 45580598, "comment_id": 78131867, "body": "you should take an intro course on compilation, what you need to learn is parsing, to output nice messages there are lots of advanced nontrivial algorithms that guess the good point.  my impression is that you need to start with such a course, for example the book of Dick Grune is a good starting point and Dragon Book is more advanced."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 5076387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7c90800485c4a14b2d61e432934654?s=128&d=identicon&r=PG&f=1", "display_name": "that_individual", "link": "https://stackoverflow.com/users/5076387/that-individual"}, "edited": false, "score": 0, "creation_date": 1502248930, "post_id": 45580963, "comment_id": 78121552, "body": "You make a good point about repeating errors coming from the same files. Reopening them on a need-to basis seems like the right move. Could you recommend me a good starting point to read on threaded interpreters? (I am currently in the &quot;bad one pass compiler&quot; phase)"}, {"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "reply_to_user": {"reputation": 95, "user_id": 5076387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7c90800485c4a14b2d61e432934654?s=128&d=identicon&r=PG&f=1", "display_name": "that_individual", "link": "https://stackoverflow.com/users/5076387/that-individual"}, "edited": false, "score": 0, "creation_date": 1502251678, "post_id": 45580963, "comment_id": 78122256, "body": "See <a href=\"https://en.wikipedia.org/wiki/Threaded_code\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Threaded_code</a>  This is easy to generate from a bad one pass compiler, but is compact and pretty fast."}], "tags": [], "owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "is_accepted": true, "score": 2, "last_activity_date": 1502247482, "creation_date": 1502247482, "answer_id": 45580963, "question_id": 45580598, "link": "https://stackoverflow.com/questions/45580598/should-i-keep-source-files-in-memory-while-parsing/45580963#45580963", "title": "Should I keep source files in memory while parsing?", "body": "<p>When there's an error to report to the user, it hardly matters how long in milliseconds it takes to report it.</p>\n\n<p>I'd keep your tokenized stream in memory to keep your interpreter fast. (Actually, you should switch to a threaded interpreter or even a bad one pass compiler to enhance the execution rate).</p>\n\n<p>When you encounter an error, go to the disk, fetch the line(s) of interest, and show them to the user.    If he doesn't make any errors, this costs you zero.  If he makes a small number of errors, that may be tiny bit inefficient but the user won't know.   If he makes large number of errors, the file content of the files containing errors are going to read by the OS into its local cache, which is likely bigger than your programs anyway, and so access will be more efficient than if you kept the source entirely on the disk.</p>\n"}, {"tags": [], "owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "is_accepted": false, "score": 1, "last_activity_date": 1502248284, "creation_date": 1502248284, "answer_id": 45581071, "question_id": 45580598, "link": "https://stackoverflow.com/questions/45580598/should-i-keep-source-files-in-memory-while-parsing/45581071#45581071", "title": "Should I keep source files in memory while parsing?", "body": "<p>Better idea: <code>mmap</code> your sources in the first place, if you can. Fall back to slurping the whole file if you're reading from a pipe or something.</p>\n\n<p>After parsing, you <em>may</em> want to call <code>madvise(MADV_DONTNEED)</code> (but <em>only</em> if it was originally <code>mmap</code>ed) to advise the kernel to drop it from the cache (but still keep it available for errors) ... but this is probably not necessary, and may even not be a good idea, depending on your compiler design (e.g. are identifiers still pointing, or are they interned to a single, separate, allocation).</p>\n"}], "owner": {"reputation": 95, "user_id": 5076387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c7c90800485c4a14b2d61e432934654?s=128&d=identicon&r=PG&f=1", "display_name": "that_individual", "link": "https://stackoverflow.com/users/5076387/that-individual"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 45580963, "answer_count": 2, "score": 3, "last_activity_date": 1502248284, "creation_date": 1502244503, "question_id": 45580598, "link": "https://stackoverflow.com/questions/45580598/should-i-keep-source-files-in-memory-while-parsing", "title": "Should I keep source files in memory while parsing?", "body": "<p>I'm writing the front-end part of an interpreter and I initially disliked the idea of just dumping all the source files into memory and then referencing that text directly. So the tokenizer reads from a char buffers and builds the token stream.</p>\n\n<p>However, I have reached the parsing side of things and it hit me that because I would want to output nice errors and warnings that show the malformed line of source code. I guess I could put column numbers in the tokens, but then by error messages would be like getting directions by telephone: \"It's in file X, on line Y, column Z, right next to the curly brace, you know the one. If you hit the semicolon, you've gone to far.\"</p>\n\n<p>I seem to have put myself into a situation where I want to have my cake and eat it too. I want nice messages, but I don't want to hog memory.</p>\n\n<p>It there something I'm missing? Or is loading the source in memory the way to go?</p>\n"}, {"tags": ["c", "memory-management", "malloc", "allocation"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1502243933, "post_id": 45580515, "comment_id": 78120391, "body": "Authors choice of words. Do you like &quot;arena&quot; or would you rather take a dip in the &quot;pool&quot;?"}, {"owner": {"reputation": 27492, "user_id": 3773011, "user_type": "moderator", "profile_image": "https://i.stack.imgur.com/Hmfxy.jpg?s=128&g=1", "display_name": "Makyen", "link": "https://stackoverflow.com/users/3773011/makyen"}, "edited": false, "score": 3, "creation_date": 1502244243, "post_id": 45580515, "comment_id": 78120450, "body": "Well, in the arena, you have to fight other programs for memory. In the pool, everyone swims, floats or sinks. But, there&#39;s no lifeguard on duty, so if you get in trouble, you have to deal with it yourself. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 135, "user_id": 7676183, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/867ea290da95aaafe639253eae45ed8d?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/7676183/matthew"}, "is_accepted": true, "score": 5, "last_activity_date": 1502244741, "creation_date": 1502244741, "answer_id": 45580622, "question_id": 45580515, "link": "https://stackoverflow.com/questions/45580515/whats-the-difference-between-a-memory-arena-and-a-memory-pool/45580622#45580622", "title": "What&#39;s the difference between a memory arena and a memory pool?", "body": "<p><a href=\"https://stackoverflow.com/questions/13381123/whats-the-difference-between-a-memory-arena-and-a-memory-allocator\">What&#39;s the difference between a memory arena and a memory allocator?</a></p>\n\n<p>The top answer on this page states:</p>\n\n<blockquote>\n  <p>\"Memory arena\" typically means a large lump (or collection of lumps) of memory from which smaller lumps are allocated. The word \"pool\" is also commonly used for such a thing.</p>\n</blockquote>\n\n<p>So basically: they mean the same thing, they are just different terms used for the same concept.</p>\n"}], "owner": {"reputation": 29662, "user_id": 432509, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/2vl0v.png?s=128&g=1", "display_name": "ideasman42", "link": "https://stackoverflow.com/users/432509/ideasman42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1582, "favorite_count": 0, "accepted_answer_id": 45580622, "answer_count": 1, "score": 3, "last_activity_date": 1502244741, "creation_date": 1502243729, "question_id": 45580515, "link": "https://stackoverflow.com/questions/45580515/whats-the-difference-between-a-memory-arena-and-a-memory-pool", "title": "What&#39;s the difference between a memory arena and a memory pool?", "body": "<p>I've seen both terms used for wrappers to memory allocators, whats the difference between these? (if any)</p>\n"}, {"tags": ["c++", "c", "arrays", "pointers", "ctime"], "comments": [{"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1502238680, "post_id": 45579858, "comment_id": 78119272, "body": "If you are indeed learning C++, don&#39;t bother finding a solution <i>without that if possible</i>. Just use the right tools available, the standard library, and forget about (char) pointers."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "reply_to_user": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1502242458, "post_id": 45579858, "comment_id": 78120060, "body": "@Tas Except <code>ctime</code> is part of the standard library, is the right tool available, and uses char pointers.  Nothing wrong with copying its return value into a std::string, but understanding why that&#39;s necessary will involve learning about char pointers (and static variables, which are the actual point of confusion here)."}, {"owner": {"reputation": 6559, "user_id": 4143855, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Gh4vC.jpg?s=128&g=1", "display_name": "Tas", "link": "https://stackoverflow.com/users/4143855/tas"}, "edited": false, "score": 0, "creation_date": 1502243431, "post_id": 45579858, "comment_id": 78120275, "body": "Sorry, my point was only just &quot;don&#39;t worry about <i>not</i> using <code>std::string</code>&quot;, because it&#39;s the right tool for the job. Ultimately, OP doesn&#39;t need to understand static variables or char* or anything else, because if they&#39;d just had used <code>std::string</code> they wouldn&#39;t be having issues with those things. IMO, simply having <code>std::string time = ctime(&amp;seconds);</code> doesn&#39;t need to be understood"}, {"owner": {"reputation": 9, "user_id": 8436723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159158619675258/picture?type=large", "display_name": "Josh Glazer", "link": "https://stackoverflow.com/users/8436723/josh-glazer"}, "edited": false, "score": 0, "creation_date": 1502244426, "post_id": 45579858, "comment_id": 78120489, "body": "Thanks guys. I wanted to try doing this /before/ getting deeper into C++ because I wanted a break from it and was looking to see how I can write the code with tools I&#39;m mostly familiar with already. Trying to solve the problem highlighted an aspect of pointers I hadn&#39;t fully grasped, and now I know a method of dealing with it in C. Once I get deeper into C++ I&#39;ll definitely be rewriting the code."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 8436723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159158619675258/picture?type=large", "display_name": "Josh Glazer", "link": "https://stackoverflow.com/users/8436723/josh-glazer"}, "edited": false, "score": 0, "creation_date": 1502242458, "post_id": 45579885, "comment_id": 78120059, "body": "Thanks for your reply! But wouldn&#39;t I want to keep the string I copied throughout the program&#39;s runtime? You said it would cause a memory leak, but I want to keep that data until the program decides to stop, send the info to Excel, and close. Unless you you&#39;re envisioning a program that sends data to Excel packet-by-packet rather than all at once...?"}, {"owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "reply_to_user": {"reputation": 9, "user_id": 8436723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159158619675258/picture?type=large", "display_name": "Josh Glazer", "link": "https://stackoverflow.com/users/8436723/josh-glazer"}, "edited": false, "score": 0, "creation_date": 1502243409, "post_id": 45579885, "comment_id": 78120269, "body": "@JoshGlazer If your goal is to keep the data until program termination, then you can <code>strdup</code> until you run out of storage and let the runtime handle cleanup at exit. But document the crap out of what you&#39;ve done so that those who follow know what you&#39;ve done and why and won&#39;t be surprised when they use the code under different circumstances. If this is a school assignment the marker could raise questions about why you&#39;ve deviated from best practices, so it&#39;s still in your best interests to explain the choice well."}], "tags": [], "owner": {"reputation": 28836, "user_id": 4581301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5580eebb22e2c65c9b2325d2276d92a?s=128&d=identicon&r=PG&f=1", "display_name": "user4581301", "link": "https://stackoverflow.com/users/4581301/user4581301"}, "is_accepted": false, "score": 2, "last_activity_date": 1502239869, "last_edit_date": 1592644375, "creation_date": 1502238691, "answer_id": 45579885, "question_id": 45579858, "link": "https://stackoverflow.com/questions/45579858/saving-new-points-in-time-with-ctime-overwrites-the-old-strings/45579885#45579885", "title": "Saving new points in time with ctime overwrites the old strings?", "body": "<p><a href=\"http://en.cppreference.com/w/cpp/chrono/c/ctime\" rel=\"nofollow noreferrer\">From cppreference.com's page on <code>ctime</code></a></p>\n<blockquote>\n<p><strong>Return value</strong></p>\n<p>Pointer to a static null-terminated character string holding the textual representation of date and time. The string may be shared between std::asctime and std::ctime, and may be overwritten on each invocation of any of those functions.</p>\n</blockquote>\n<p>So yes, the next call to <code>ctime</code> or <code>asctime</code> can be expected to overwrite the buffer used by the previous call.</p>\n<pre><code>strcpy(*tracker, ctime(&amp;seconds));\n</code></pre>\n<p>Most likely fails because no storage has been allocated for <code>*tracker</code> to hold the string in.</p>\n<p>You could</p>\n<pre><code>*tracker = strdup(ctime(&amp;seconds));\n</code></pre>\n<p>to allocate and copy, but this leaves you with the problem of keeping track of which elements of <code>tracker</code> you have to manually <code>free</code>. This will get incredibly nasty fast. If you wish to do this with C, you will either have to <code>strdup</code> and <code>free</code> everything, add in a book-keeping structure to tell you whether or not you dynamically allocated storage and thus must <code>free</code>, or do an extensive redesign.</p>\n<p>Since you have tagged C++, follow your friend's advice and use <code>std::vector</code> and <code>std::string</code>.</p>\n<p><a href=\"http://en.cppreference.com/w/c/experimental/dynamic/strdup\" rel=\"nofollow noreferrer\">Documentation on <code>strdup</code>.</a></p>\n<p><a href=\"http://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">Documentation on <code>std::vector</code>.</a></p>\n<p><a href=\"http://en.cppreference.com/w/cpp/string/basic_string\" rel=\"nofollow noreferrer\">Documentation on <code>std::string</code>.</a></p>\n"}], "owner": {"reputation": 9, "user_id": 8436723, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159158619675258/picture?type=large", "display_name": "Josh Glazer", "link": "https://stackoverflow.com/users/8436723/josh-glazer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1502239869, "creation_date": 1502238411, "question_id": 45579858, "link": "https://stackoverflow.com/questions/45579858/saving-new-points-in-time-with-ctime-overwrites-the-old-strings", "title": "Saving new points in time with ctime overwrites the old strings?", "body": "<p>Preface: I've been learning C this past summer and only recently started learning C++ so I don't know very much of it yet.</p>\n\n<p>I've been trying to write a C/C++ program that recognizes right and left mouse clicks in windows and saves which button was clicked and when into an array of pointers to strings <code>char **clicks</code>. I'm organizing it as a sequence like: button, time, button, time...</p>\n\n<p>Whenever a mouseclick is detected, it takes either \"R\" or \"L\" and does this:</p>\n\n<pre><code>void writeClick(char *button) {\n    static char **tracker = clicks;\n    *tracker = button;\n    tracker++;\n    time_t seconds = time(NULL);\n    *tracker = ctime(&amp;seconds);\n    tracker++;\n}\n</code></pre>\n\n<p>My question: The issue you may have noticed is that each array element with the time will be pointing to the same string. The result is that the time will update on each mouse click, but it will only remember the last saved time. I figured I could solve the problem with <code>strcpy</code>, but if I want to save multiple strings then won't I need a new variable for each string? Or a new memory location each time or something? How should I do this?</p>\n\n<p>I tried using <code>strcpy</code> like so:</p>\n\n<pre><code>strcpy(*tracker, ctime(&amp;seconds));\n</code></pre>\n\n<p>But at the second click my program crashes and I'm not sure why.</p>\n\n<p>Other information that may be useful:</p>\n\n<p>I'm planning on sending the data into VBA because I want to turn it into an Excel spreadsheet.</p>\n\n<p>I've yet to write the part of my code that dynamically increases the array whenever it gets full, but at the moment it's large enough (50 elements) to contain the data for a few clicks without crashing, so I know that's probably not the issue.</p>\n\n<p>The part of my code that detects mouseclicks uses a Windows function and aside from that I don't think my code is affected by which OS I'm using. I don't have any issues with click detection (because I solved them all already).</p>\n\n<p>A friend told me she would just use C++ strings and vectors to do the job, but I don't know them yet. I'll look them up but I'm hoping to find a solution without that if possible.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502236849, "post_id": 45579651, "comment_id": 78118910, "body": "It is not as easy"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1502237216, "post_id": 45579651, "comment_id": 78118987, "body": "Amongst other questions, see one from yesterday: <a href=\"https://stackoverflow.com/questions/45554639/\">Is there a way to check if a string can be a float in C?</a>   If you want to check a string, then <code>sscanf()</code> or <code>strtod()</code> are appropriate.  There are almost certainly others that are relevant."}, {"owner": {"reputation": 241, "user_id": 7243379, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/iSlM4.png?s=128&g=1", "display_name": "Kristina", "link": "https://stackoverflow.com/users/7243379/kristina"}, "edited": false, "score": 0, "creation_date": 1502238887, "post_id": 45579651, "comment_id": 78119304, "body": "Please read the question first! After vote it or answer it. There is no same question with this in stack overflow"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1502245529, "post_id": 45579651, "comment_id": 78120744, "body": "Don&#39;t get snippy with those who are trying to help you; it doesn&#39;t help,"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502245705, "post_id": 45579651, "comment_id": 78120789, "body": "What exactly are you trying to find out?  If you want to know whether both conversions succeeded, then you will need to test the value returned by <code>scanf()</code>, as you were told in the first comment.  If you want to check that the rest of the line doesn&#39;t contain anything other than blanks, you have to work harder, as shown in the question linked to from yesterday.  With no check on the result of <code>scanf()</code>, there is nothing you can write in the <code>if</code> clause after it that tells you reliably what happened during the input.  If there&#39;s something else you need to know, you need to explain what it is."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502246739, "post_id": 45579651, "comment_id": 78121023, "body": "<code>&quot;Enter Two number with space:\\n&quot;</code> --&gt; Is a space between the numbers <i>required</i>? Code like <code>scanf(&quot;%f %f&quot;,&amp;a,&amp;b);</code> tolerates a space but does not require it like <code>&quot;123.4-567.8&quot;</code> scans OK"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1502237365, "post_id": 45579709, "comment_id": 78119020, "body": "See also <a href=\"https://stackoverflow.com/a/45555411/15168\">Is there a way to check if a string can be a float in C?</a> where this code previously appeared."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 0, "last_activity_date": 1502237334, "last_edit_date": 1502237334, "creation_date": 1502237109, "answer_id": 45579709, "question_id": 45579651, "link": "https://stackoverflow.com/questions/45579651/how-can-i-check-the-inputs-are-not-int-or-float-in-c/45579709#45579709", "title": "How can I check the inputs are not int or float in C?", "body": "<pre><code>   #define INT_CONVERTED       (1 &lt;&lt; 0)\n    #define FLOAT_CONVERTED     (1 &lt;&lt; 1)\n    int ReadNumber(const char *str, double *db, int *in)\n    {\n\n        int result = (str == NULL || db == NULL || in == NULL) * -1;\n        int len = 0;\n        char *tmp;\n\n        if (result != -1)\n        {\n            tmp = (char *)malloc(strlen(str) + 1);\n            strcpy(tmp, str);\n            for (int i = strlen(str) - 1; i &gt;= 0; i--)\n            {\n                if (isspace(tmp[i]))\n                {\n                    tmp[i] = 0;\n                    continue;\n                }\n                break;\n            }\n            if (strlen(tmp))\n            {\n                if (sscanf(tmp, \"%lf%n\", db, &amp;len) == 1 &amp;&amp; strlen(tmp) == len)\n                {\n                    result |= FLOAT_CONVERTED;\n                }\n                if (sscanf(tmp, \"%d%n\", in, &amp;len) == 1 &amp;&amp; strlen(tmp) == len)\n                {\n                    result |= INT_CONVERTED;\n                }\n            }\n            free(tmp);\n        }\n        return result;\n    }\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 7243379, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/iSlM4.png?s=128&g=1", "display_name": "Kristina", "link": "https://stackoverflow.com/users/7243379/kristina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 45579709, "answer_count": 1, "score": -3, "last_activity_date": 1502246536, "creation_date": 1502236600, "last_edit_date": 1502246536, "question_id": 45579651, "link": "https://stackoverflow.com/questions/45579651/how-can-i-check-the-inputs-are-not-int-or-float-in-c", "title": "How can I check the inputs are not int or float in C?", "body": "<p>I want to write below code with proper <code>if</code> clause.<br>\nMay you please help me?</p>\n\n<pre><code>  int main()\n    {\n        float a,b;\n        printf(\"Enter Two number with space:\\n\");\n        scanf(\"%f %f\",&amp;a,&amp;b);\n        //if(%a || b are char%)\n           printf(\"Not correct format!\")\n        else\n           printf(\"a and b: %.2f %.2f\",a,b);\n\n        return 0;\n    }\n</code></pre>\n"}, {"tags": ["c", "input", "switch-statement"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1502226279, "post_id": 45577956, "comment_id": 78115436, "body": "Your first question should be &quot;Is it possible?&quot;. The answer is &quot;no&quot;."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502226315, "post_id": 45577956, "comment_id": 78115451, "body": "You can&#39;t. You can only switch on integer values.  You&#39;ll have to use if/else and strcmp."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1502226366, "post_id": 45577956, "comment_id": 78115472, "body": "You have no room for <code>whr</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1502226372, "post_id": 45577956, "comment_id": 78115479, "body": "first <code>char whr[] = &quot;&quot;;</code> --&gt; <code>char whr[6&#47;* or more *&#47;] = &quot;&quot;;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502226518, "post_id": 45577956, "comment_id": 78115542, "body": "<a href=\"https://stackoverflow.com/questions/4014827/best-way-to-switch-on-a-string-in-c\">best way to switch on a string in C</a>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502229024, "post_id": 45577956, "comment_id": 78116719, "body": "Note that you should restructure the code so that you have an array of structures so that you can find the appropriate conversion factors with a search, rather than hard-coding the list of currencies and values.  OTOH, that is probably still beyond what you&#39;ve learned, so it isn&#39;t so much of a problem as yet."}], "answers": [{"tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 6, "last_activity_date": 1502228054, "last_edit_date": 1502228054, "creation_date": 1502226328, "answer_id": 45578010, "question_id": 45577956, "link": "https://stackoverflow.com/questions/45577956/c-input-of-switch-case/45578010#45578010", "title": "C INPUT of Switch Case", "body": "<p>There is no way in C to use a \"string\" (an array of characters in your case) in a switch statement's condition or in the label constant expressions as they cannot be converted to an integral value. C requires the condition and the constant expressions to be of integral type (cf., for example, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.8.4.2\" rel=\"nofollow noreferrer\">this online c++ standard draft</a>):</p>\n\n<blockquote>\n  <p><strong>6.8.4.2 The switch statement</strong></p>\n  \n  <p>1 The controlling expression of a switch statement shall have integer\n  type.</p>\n  \n  <p>...</p>\n  \n  <p>3 The expression of each case label shall be an integer constant\n  expression ...</p>\n</blockquote>\n\n<p>To overcome this, you could use cascades of <code>if (strcmp(whr,\"USD\")==0) else if (strcmp(whr, \"YEN\")==0)...</code> or you could introduce an enum that represents the currencies and map the user input to such enums.\nAs the <code>if-else</code>-cascades are straight forward, I just show the second approach. Using enums has the advantage that you can use them easily throughout your program without the need of repeating the <code>if-else</code>-cascades at different places in your code:</p>\n\n<pre><code>typedef enum  {\nUNDEFINED, USD, YEN, POUND\n} CurrencyEnum;\n\nstruct currencyLabel {\n    CurrencyEnum currencyEnum;\n    const char *currencyString;\n} currencyLabels[] = {\n    { USD, \"USD\" },\n    { YEN, \"YEN\" },\n    { POUND, \"POUND\" }\n};\n\nCurrencyEnum getCurrencyByLabel(const char* label) {\n\n    for (int i=0; i&lt; (sizeof(currencyLabels) / sizeof(struct currencyLabel)); i++) {\n        if (strcmp(label, currencyLabels[i].currencyString) == 0)\n            return currencyLabels[i].currencyEnum;  // could use strcasecmp or stricmp, if available, too.\n    }\n    return UNDEFINED;\n}\n\nint main(void) {\n    float usd2 = 0.9117;\n    float yen2 = 0.0073;\n    float pound2 = 1.4137;\n    float eingabe;\n    char whr[10] = \"\";\n\n    printf(\"Bitte Summe in EURO eingeben: \");\n    scanf(\"%f\", &amp;eingabe);\n    printf(\"Die W\u00e4hrungnummer eingeben USD, YEN, POUND: \");\n    scanf(\"%s\", whr);\n    CurrencyEnum currency = getCurrencyByLabel(whr);\n\n    switch(currency) {\n        case USD: printf(\"%.4f EURO es sind dann %.4f USD.\", eingabe, (eingabe/usd2));\n            break;\n        case YEN: printf(\"%.4f EURO es sind dann %.4f YEN.\", eingabe, (eingabe/yen2));\n            break;\n        case POUND: printf(\"%.4f EURO es sind dann %.4f POUND.\", eingabe, (eingabe/pound2));\n            break;\n        default: printf(\"Falsche eingabe.\");\n            break;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>BTW: Note that defining <code>whr</code> as <code>char whr[] = \"\"</code> actually reserves a string with size 1, and using it in <code>scanf</code> yields an overflow (and undefined behaviour). You can define it as <code>char whr[10]</code> or something like that.</p>\n"}, {"comments": [{"owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "edited": false, "score": 0, "creation_date": 1502226814, "post_id": 45578034, "comment_id": 78115674, "body": "@eXme: as many as you want. I&#39;ve added an update to address that."}, {"owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "edited": false, "score": 0, "creation_date": 1502227119, "post_id": 45578034, "comment_id": 78115826, "body": "@eXme: you&#39;ll have to give more detail than that for me to help you. This <i>is</i> how you compare strings in C."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7772660"}, "edited": false, "score": 0, "creation_date": 1502227171, "post_id": 45578034, "comment_id": 78115856, "body": "15\t23\tG:\\data\\owncloud\\Project\\C\\Training\\w&#228;hrung\\1.cpp\t[Err&zwnj;&#8203;or] &#39;strcmp&#39; was not declared in this scope"}, {"owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "edited": false, "score": 1, "creation_date": 1502227219, "post_id": 45578034, "comment_id": 78115882, "body": "@eXme: You need to include the string header."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7772660"}, "edited": false, "score": 0, "creation_date": 1502227225, "post_id": 45578034, "comment_id": 78115885, "body": "But it compiles if I write if(whr == &quot;USD&quot; )  but no effect at the end it just goes to the else.."}, {"owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "edited": false, "score": 0, "creation_date": 1502227301, "post_id": 45578034, "comment_id": 78115922, "body": "@eXme: I&#39;ve added an edit that shows how to include the string header. As I&#39;ve already said in my answer, you can&#39;t use <code>==</code> with a string."}, {"owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "edited": false, "score": 0, "creation_date": 1502227372, "post_id": 45578034, "comment_id": 78115954, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/151440/discussion-between-jacobm001-and-exme\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 3972, "user_id": 1142368, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/818d73588151e0f0adcc4f2d1c6a268b?s=128&d=identicon&r=PG", "display_name": "Jacobm001", "link": "https://stackoverflow.com/users/1142368/jacobm001"}, "is_accepted": false, "score": 5, "last_activity_date": 1502227248, "last_edit_date": 1502227248, "creation_date": 1502226429, "answer_id": 45578034, "question_id": 45577956, "link": "https://stackoverflow.com/questions/45577956/c-input-of-switch-case/45578034#45578034", "title": "C INPUT of Switch Case", "body": "<p><em>C</em> doesn't really have strings as you see in other, higher languages. Rather, C strings are simply arrays of chars. That means that complex operations like comparison doesn't really work on strings natively.</p>\n\n<p>As they are currently designed, switch statements only operate on a single integer value. This can be represented as either a single char or an int which sometimes causes confusion. To do what you want, you'll need to use <code>if</code> and <code>else if</code> statements with the <code>strcmp()</code> function.</p>\n\n<pre><code>if( strcmp(whr, \"foo\") == 0 ) {\n    // do a thing\n}\nelse if( strcmp(whr, \"bar\") == 0 ) {\n    // do a different thing\n}\nelse {\n    // default thing to do\n}\n</code></pre>\n\n<p>Documentation on <a href=\"https://www.techonthenet.com/c_language/standard_library_functions/string_h/strcmp.php\" rel=\"nofollow noreferrer\"><code>strcmp()</code></a> function and <a href=\"https://www.tutorialspoint.com/cprogramming/if_else_statement_in_c.htm\" rel=\"nofollow noreferrer\"><code>if</code></a> statements.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I've demonstrated a simple two condition statement. In reality, the <code>else</code> statement is optional, and you can have as many <code>else if</code> statements as you'd like.</p>\n\n<p>You'll also need to include the string header in your program. Do this at the top of your file where you're including <code>stdio.h</code></p>\n\n<pre><code>#include &lt;string.h&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7772660"}, "is_accepted": false, "score": 0, "last_activity_date": 1502229980, "creation_date": 1502229980, "answer_id": 45578752, "question_id": 45577956, "link": "https://stackoverflow.com/questions/45577956/c-input-of-switch-case/45578752#45578752", "title": "C INPUT of Switch Case", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main(void) {\n    float usd2 = 0.9117;\n    float yen2 = 0.0073;\n    float pound2 = 1.4137;\n    float eingabe;\n    char whr[5] = \"\";\n\n    printf(\"Bitte Summe in EURO eingeben: \");\n    scanf(\"%f\", &amp;eingabe);\n    printf(\"Die W\u00e4hrungnummer eingeben USD, YEN, POUND: \");\n    scanf(\"%s\", &amp;whr);\n\n    if( strcmp(whr, \"USD\") == 0 ) {\n    printf(\"%.4f EURO es sind dann %.4f USD.\", eingabe, (eingabe/usd2));\n    }\n    else if( strcmp(whr, \"YEN\") == 0 ) { // strcmp(1 array, 2 array) wenn die gleich sind gibt der 0 raus, when linke hat weniger char dann negativ und wenn linke gr\u00f6\u00dfer dann positiv\n    printf(\"%.4f EURO es sind dann %.4f YEN.\", eingabe, (eingabe/yen2));\n        }\n    else if( strcmp(whr, \"POUND\") == 0 ) {\n    printf(\"%.4f EURO es sind dann %.4f POUND.\", eingabe, (eingabe/pound2));\n        }\n    else {\n        printf(\"Falsche eingabe.\");\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7772660"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2308, "favorite_count": 0, "accepted_answer_id": 45578010, "answer_count": 3, "score": 1, "last_activity_date": 1502229980, "creation_date": 1502226136, "question_id": 45577956, "link": "https://stackoverflow.com/questions/45577956/c-input-of-switch-case", "title": "C INPUT of Switch Case", "body": "<p>how to input String and use it in the Switch command? Here is the code but I get switch quantity not an integer error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) {\n    float usd2 = 0.9117;\n    float yen2 = 0.0073;\n    float pound2 = 1.4137;\n    float eingabe;\n    char whr[] = \"\";\n\n    printf(\"Bitte Summe in EURO eingeben: \");\n    scanf(\"%f\", &amp;eingabe);\n    printf(\"Die W\u00e4hrungnummer eingeben USD, YEN, POUND: \");\n    scanf(\"%s\", &amp;whr);\n\n    switch(whr) {\n        case \"usd\": printf(\"%.4f EURO es sind dann %.4f USD.\", eingabe, (eingabe/usd2));\n        break;\n        case \"yen\": printf(\"%.4f EURO es sind dann %.4f YEN.\", eingabe, (eingabe/yen2));\n        break;\n        case \"pound\": printf(\"%.4f EURO es sind dann %.4f POUND.\", eingabe, (eingabe/pound2));\n        break;\n        default: printf(\"Falsche eingabe.\");\n        break;\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "multithreading", "pthreads", "redhat"], "comments": [{"owner": {"reputation": 1771, "user_id": 5644874, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/AlXxH.jpg?s=128&g=1", "display_name": "Seek Addo", "link": "https://stackoverflow.com/users/5644874/seek-addo"}, "edited": false, "score": 0, "creation_date": 1502224100, "post_id": 45577403, "comment_id": 78114430, "body": "You can increase the number with this <code>echo new_size &gt; &#47;proc&#47;sys&#47;kernel&#47;threads-max</code>"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502224563, "post_id": 45577403, "comment_id": 78114671, "body": "You need to run the program under <code>strace</code> (or a debugger) to see <i>why</i> the thread creation is failing. With the configured thread size, the limit is suspiciously low."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1502227316, "post_id": 45577403, "comment_id": 78115928, "body": "<i>&quot;while also showing the ability of a system to handle many more pthreads than processes.&quot;</i>. This is not quite correct. linux threads [and pthreads on most modern systems] are synonymous with processes (i.e. there is a one-to-one mapping, and not a one-to-many mapping). To prevent denial-of-service, your servers have the 75 cap set. For more info, see my answer: <a href=\"https://stackoverflow.com/questions/39185134/how-are-user-level-threads-scheduled-created-and-how-are-kernel-level-threads-c/39185831#39185831\" title=\"how are user level threads scheduled created and how are kernel level threads c\">stackoverflow.com/questions/39185134/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 3066489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddfa3f6246ec6294fa0950aeb1a5d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3066489", "link": "https://stackoverflow.com/users/3066489/user3066489"}, "edited": false, "score": 0, "creation_date": 1502416132, "post_id": 45577403, "comment_id": 78211169, "body": "threads-max is currently set to 970007 so that&#39;s not the problem."}, {"owner": {"reputation": 1, "user_id": 3066489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddfa3f6246ec6294fa0950aeb1a5d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3066489", "link": "https://stackoverflow.com/users/3066489/user3066489"}, "edited": false, "score": 0, "creation_date": 1502417027, "post_id": 45577403, "comment_id": 78211360, "body": "The fact that I can get several thousand processes running under VMWare and other versions of Linus indicates that processes and threads are not synonymous.    strace may be a good lead.  Under Redhat 5.11 the pthread_create generates calls to clone.   I need to compare this to the behaviour on other system."}, {"owner": {"reputation": 1, "user_id": 3066489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddfa3f6246ec6294fa0950aeb1a5d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3066489", "link": "https://stackoverflow.com/users/3066489/user3066489"}, "edited": false, "score": 0, "creation_date": 1502463112, "post_id": 45577403, "comment_id": 78235587, "body": "I took another look at my VMWare setups.  The process limit was much higher and when I reduced it I had a similar problem.  So the previous comments appear to be correct - the # of threads is tied to the # of processes."}], "answers": [{"comments": [{"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 1, "creation_date": 1502226318, "post_id": 45577565, "comment_id": 78115453, "body": "<code>ulimit</code> is the Bash/POSIX shell built-in command, but there&#39;s also the external command <a href=\"http://man7.org/linux/man-pages/man1/prlimit.1.html\" rel=\"nofollow noreferrer\"><code>prlimit</code></a>, if one uses a non-Bash, non-POSIX shell."}], "tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": false, "score": 1, "last_activity_date": 1502224439, "creation_date": 1502224439, "answer_id": 45577565, "question_id": 45577403, "link": "https://stackoverflow.com/questions/45577403/pthreads-cant-generate-more-than-70-under-redhat-6-8/45577565#45577565", "title": "pthreads: can&#39;t generate more than 70 under Redhat 6.8", "body": "<p>Yes, under linux, threads and processes are handled very similarly. </p>\n\n<p>If you have set a process limit of 75, that's really a limit on total number of threads for all processes of a user. So this works as it is designed.</p>\n\n<p>A limit of the number of processes is set with the ulimit command or in <a href=\"https://access.redhat.com/solutions/61334\" rel=\"nofollow noreferrer\">/etc/limits.conf</a>\nwhich is applied with the setrlimit() system call,\nFrom its <a href=\"http://man7.org/linux/man-pages/man2/setrlimit.2.html\" rel=\"nofollow noreferrer\">documentation</a></p>\n\n<blockquote>\n  <p><strong>RLIMIT_NPROC</strong>\n                This is the maximum number of processes (or, more precisely on\n                Linux, threads) that can be created for the real user ID of\n                the calling process.</p>\n</blockquote>\n"}], "owner": {"reputation": 1, "user_id": 3066489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ddfa3f6246ec6294fa0950aeb1a5d3?s=128&d=identicon&r=PG&f=1", "display_name": "user3066489", "link": "https://stackoverflow.com/users/3066489/user3066489"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502224439, "creation_date": 1502223745, "question_id": 45577403, "link": "https://stackoverflow.com/questions/45577403/pthreads-cant-generate-more-than-70-under-redhat-6-8", "title": "pthreads: can&#39;t generate more than 70 under Redhat 6.8", "body": "<p>This is likely a setting related matter.</p>\n\n<p>Problem: Unable to generate more than 70 pthreads on our public Redhat environments.  Expectation is several thousand.</p>\n\n<p>The attached program is designed to demonstrate to students the use of mutex semaphores for controlling access to shared data while also showing the ability of a system to handle many more pthreads than processes.   It\u2019s part of a teaching unit on creating a network server program.</p>\n\n<p>Unfortunately the program fails at about 70 pthreads, which indicates the same limit as the number of concurrent processes allowed  on our systems, which is set to a default of 75.   This happens on both our two Enterprise student environments \u2013 one is Redhat 5.11  and the other is Redhat 6.8 .   These are our shared environments which we use to give demos and students do assignments.</p>\n\n<p>On a downloaded version of Redhat 7 as well as on Ubuntu 15.04, both running under VMWare I'm able to generate several thousand threads, which is what I'd expect.    </p>\n\n<p>The problem, when it occurs, becomes evident in the initial <em>for</em> loop in <strong>main</strong>.   </p>\n\n<pre><code>/*\nFile: pthreadDemo2.c\nCourse: CENG320\nAuthor: Prof. Leon King,J230,x4200\nDate: Friday Jun 16, 2017   14:26 PM\n\nIn this demo we list the status of threads and selectively cancel them.\nThe commands are:  list  (list)\nkill  #  kill a thread by number\ninc      have threads increment the counter\nINC   #  increment a specific counter  \nquit     end the program\nshow     show the counter\n\nCompile with the thread library -pthread\nSee also:  http://www.yolinux.com/TUTORIALS/LinuxTutorialPosixThreads.html\n */\n\n\n#include &lt;pthread.h&gt;\n#include &lt;bits/local_lim.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;errno.h&gt;\n/* We have no predefined limit on the number of threads.  */\n#define NUMBER_OF_THREADS 4000 \n\npthread_mutex_t mutex=PTHREAD_MUTEX_INITIALIZER; //Warning! This is a shared global variable!\nlong counter=0;\n\nvoid incrementCounter(int signum)\n{\n    //pthread_mutex_lock(&amp;mutex); \n    int c2;\n    c2=counter;\n    c2=c2+1;\n    counter=c2;\n    //fprintf(stdout,\"Changing a counter\\n\"); \n    /*FILE *log=fopen(\"threadSafeLog.dat\",\"a\");\n      fprintf(log,\"Logging event for thread %u\\n\",(int) pthread_self()); \n      fprintf(log,\"Logging event 2nd write for thread %u\\n\",(int) pthread_self()); \n      fclose(log);\n     */\n    //pthread_mutex_unlock(&amp;mutex);\n}\n\nvoid *threadProcedure(void * arg)\n{\n    int myThreadInfo=(long) arg,\n    threadID=pthread_self();\n    while(1) pause();  \n    pthread_exit(0);  //calling exit() would end all threads &amp; main\n\n}\n\nint main(int argc, char * argv[],char * envp[])\n{\n    pthread_t threadList[NUMBER_OF_THREADS]={0};\n    char cmd[20];\n\n    pthread_mutex_init(&amp;mutex,NULL); \n    pthread_attr_t threadAttributes; \n    pthread_attr_init(&amp;threadAttributes);\n\n    int err1=pthread_attr_setstacksize(&amp;threadAttributes, 16384);\n    if(err1) fprintf(stdout,\"Error in setting the stack size: %d\\n\", err1);\n\n    signal(SIGUSR1,incrementCounter);  \n    fprintf(stdout,\"Hello World. I'm %d\\n\",(int) getpid()); \n    //\n    //Spawn a group of threads\n    //THIS IS THE CORE OF THE PROBLEM\n    //IT CAN GENERATE OVER 6K threads on a Ubuntu 15.04 Release\n    //BUT only 70 threads on Redhat 5.11 and 6.8 Enterprise\n    //The focus question is: How does one increase the limit on the number of threads in Redhat \n    for(int i=0;i&lt;NUMBER_OF_THREADS;i++) \n    {\n    if(!pthread_create(&amp;threadList[i],&amp;threadAttributes,threadProcedure,(void *)i))\n        {\n            pthread_detach(threadList[i]); \n         }\n     else   perror(\"Failure to create a thread\");\n\n    }\n\n    while(1)\n    {\n        fprintf(stdout,\"Commands: list, show, increment, quit\\n\");\n    fscanf(stdin,\"%s\",cmd);\n    switch(cmd[0])\n    {\n\n        case 'l': for(int i=0;i&lt;NUMBER_OF_THREADS;i++)\n              fprintf(stdout,\"thread id of threadlist[%d]: %u\\n\",i,(int) threadList[i]); \n              break;\n\n        case 's':  fprintf(stdout,\"Counter value: %lu\\n\",counter);\n               break;\n\n               break;\n\n        case 'i': fprintf(stdout,\"Initial value of counter: %lu\\n\",counter);     \n              for(int i=0;i&lt;100;i++)\n              {\n                  int error= pthread_kill(threadList[i],SIGUSR1);\n                  if(error) {perror(\"Failed signal\"); errno=0;}\n\n              }\n              fprintf(stdout,\"Final value of Counter? %lu\\n\",counter);  \n              break;\n\n        case 'q':  exit(0); \n\n    }\n\n    }\n\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1502223774, "post_id": 45577352, "comment_id": 78114255, "body": "Try to define <code>windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = ...</code> as <code>static const windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = ...</code> and see what happens."}, {"owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1502224031, "post_id": 45577352, "comment_id": 78114388, "body": "When it is in global scope, I get the same compilation error with &quot;static&quot;, &quot;const&quot;, &quot;static const&quot; or neither of them."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1502224150, "post_id": 45577352, "comment_id": 78114459, "body": "@MadPhysicist stop guessing, this is C, not some C++."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1502224231, "post_id": 45577352, "comment_id": 78114505, "body": "@SteveStrobel <code>const struct</code>s are not compile-time constants. And &quot;even without the static keyword&quot; is because you&#39;re confusing the <code>static</code> storage class with <i>static storage duration</i> :)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1502224277, "post_id": 45577352, "comment_id": 78114532, "body": "repeating the initializer is correct, now write an answer about it and self-accept it. The other cannot be done, ever, at all."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502224345, "post_id": 45577352, "comment_id": 78114571, "body": "@AnttiHaapala. Fair enough. I simply had no clue :) Since you know the answer, why not post it?"}, {"owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502225583, "post_id": 45577352, "comment_id": 78115144, "body": "@AnttiHaapala The root of my question is, &quot;Why does using a const struct as an initializer work with arrays declared as automatic, but not if declared static?&quot;  Not being compile-time constants might explain why they wouldn&#39;t work in either case, but I don&#39;t see how it explains the difference in the two cases."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502225691, "post_id": 45577352, "comment_id": 78115190, "body": "It exactly explains it, the initializer need not be a constant for variables with automatic storage duration."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502225810, "post_id": 45577352, "comment_id": 78115243, "body": "I&#39;d rather close this as a duplicate of <a href=\"https://stackoverflow.com/q/11702629/918959\">this question</a> than write more answers :D"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1502261618, "post_id": 45577352, "comment_id": 78125954, "body": "The reason is that all variables with static storage duration are initialized at some point before main() is called. Meaning they can&#39;t depend on any run-time values. Unfortunately, the C language don&#39;t regard <code>const</code> variables as compile-time constants. It is a known language flaw."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1502227209, "creation_date": 1502227209, "answer_id": 45578210, "question_id": 45577352, "link": "https://stackoverflow.com/questions/45577352/how-can-an-array-of-structs-be-initialized-using-a-const-struct-in-global-scope/45578210#45578210", "title": "How can an array of structs be initialized using a const struct in global scope?", "body": "<p>A <code>const</code> object is not a C <em>constant</em>.  Instead use <em>constants</em> which is required for  non-automatic storage objects.</p>\n\n<p>Define an initializer <code>{ .x = 3, .y = 5 }</code></p>\n\n<pre><code>typedef struct windowStruct_s {\n  int x;\n  int y;\n} windowStruct_t;\n\n#define windowStruct_t_default_initializer { .x = 3, .y = 5 }\n#define NUM_ARRAY_ELEMENTS (2)\n#define REPEAT_NUM_ARRAY_ELEMENTS_TIMES(x) x, x /* no () */\n\nwindowStruct_t windowStruct[NUM_ARRAY_ELEMENTS] = {\n    REPEAT_NUM_ARRAY_ELEMENTS_TIMES(windowStruct_t_default_initializer) };\n\nint someFunction(void) {\n  volatile int x = windowStruct[0].x;\n  return x;\n}\n\nint anotherFunction(void) {\n  volatile int y = windowStruct[1].y;\n  return y;\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4024412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056a0dfe17f83118b195bd3e78bfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Strobel", "link": "https://stackoverflow.com/users/4024412/steve-strobel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 45578210, "answer_count": 1, "score": 2, "last_activity_date": 1502227209, "creation_date": 1502223439, "question_id": 45577352, "link": "https://stackoverflow.com/questions/45577352/how-can-an-array-of-structs-be-initialized-using-a-const-struct-in-global-scope", "title": "How can an array of structs be initialized using a const struct in global scope?", "body": "<p>I want to use code similar to the following (but a lot more complex - this is a simplified example) to initialize an array of structures, but during compilation I get the error \"expression must have a constant value\".</p>\n\n<pre><code>typedef struct\n{\n    int x;\n    int y;\n} windowStruct_t;\n\nstatic const windowStruct_t windowStructInit =\n{\n    .x = 3,\n    .y = 5,\n};\n\n// These get defined differently at times.  This is simplified for the example.\n#define NUM_ARRAY_ELEMENTS (2)\n#define REPEAT_NUM_ARRAY_ELEMENTS_TIMES(x) (x),(x)\n\n// The following line causes the error \"expression must have a constant value\" twice.\nwindowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = \n    { REPEAT_NUM_ARRAY_ELEMENTS_TIMES( windowStructInit ) };\n\nvoid someFunction( void )\n{\n    volatile int x = windowStruct[0].x;\n}\n\nvoid anotherFunction( void )\n{\n    volatile int y = windowStruct[1].y;\n}\n</code></pre>\n\n<p>Manually expanding the macro and replacing the line that causes the error with the following gives the same result:</p>\n\n<pre><code>windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = \n    { windowStructInit, windowStructInit };\n</code></pre>\n\n<p>But this compiles without error:</p>\n\n<pre><code>windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] =\n    { { .x = 3, .y = 5 }, { .x = 3, .y = 5 } };\n</code></pre>\n\n<p>If I move the array declaration inside of function scope, it compiles without errors (I am ignoring the fact that someFunction() and anotherFunction() now access different arrays and that their lifetimes are different):</p>\n\n<pre><code>void someFunction( void )\n{\n    windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = \n        { REPEAT_NUM_ARRAY_ELEMENTS_TIMES( windowStructInit ) };\n\n    volatile int x = windowStruct[0].x;\n}\n\nvoid anotherFunction( void )\n{\n    windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = \n        { REPEAT_NUM_ARRAY_ELEMENTS_TIMES( windowStructInit ) };\n\n    volatile int y = windowStruct[1].y;\n}\n</code></pre>\n\n<p>Leaving the array declarations inside of function scope, if they are declared to be \"static\", the error message comes back:</p>\n\n<pre><code>void someFunction( void )\n{\n    static windowStruct_t windowStruct[ NUM_ARRAY_ELEMENTS ] = \n        { REPEAT_NUM_ARRAY_ELEMENTS_TIMES( windowStructInit ) };\n\n    volatile int x = windowStruct[0].x;\n}\n</code></pre>\n\n<p>So it seems that when the arrays are declared as automatic variables (on the stack) that they can be initialized in a way that isn't allowed when the memory allocation is static (whether inside function scope or in global scope where the allocation is static even without the \"static\" keyword).  Is there a way to initialize the array in global scope using a const struct as in the original example?</p>\n\n<p>I am using C, not C++.  I don't want to use dynamic memory allocation.  The compiler is TI's ARM compiler V16.6.0.STS as included in their Code Composer Studio environment.</p>\n"}, {"tags": ["c#", "c", "streamreader", "streamwriter"], "comments": [{"owner": {"reputation": 1448, "user_id": 5464233, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208326386304302/picture?type=large", "display_name": "Guido Flohr", "link": "https://stackoverflow.com/users/5464233/guido-flohr"}, "edited": false, "score": 0, "creation_date": 1502223912, "post_id": 45577068, "comment_id": 78114329, "body": "If you want a robust solution, you have to write a C parser and extract all function definitions. Even if you fix the bug in your code it will fail on commented out functions, and then later on all other kinds of corner-cases. Do you have to write that in C#? Use a scripting language! They were made for that."}, {"owner": {"reputation": 11, "user_id": 8266585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4542b4e10b6cc06c9b4953b06229df23?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8266585/john"}, "reply_to_user": {"reputation": 1448, "user_id": 5464233, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208326386304302/picture?type=large", "display_name": "Guido Flohr", "link": "https://stackoverflow.com/users/5464233/guido-flohr"}, "edited": false, "score": 0, "creation_date": 1502224113, "post_id": 45577068, "comment_id": 78114437, "body": "I would agree, writing a script seemed like a much easier solution, but the project requires it in C#, its supposed to be a way to learn how to translate C to C#. But thanks for the input. I hadn&#39;t even thought about the issue of comments."}, {"owner": {"reputation": 1448, "user_id": 5464233, "user_type": "registered", "profile_image": "https://graph.facebook.com/10208326386304302/picture?type=large", "display_name": "Guido Flohr", "link": "https://stackoverflow.com/users/5464233/guido-flohr"}, "edited": false, "score": 0, "creation_date": 1502224839, "post_id": 45577068, "comment_id": 78114816, "body": "And you probably forgot quoted strings and you make invalid assumptions about the formatting of the code.  You want to parse C code and that requires a parser for C code and such parsers require thousands of lines of code, no matter which language you are using.  The answer to  your question is: Grab a grammar and a lexer file for C and generate a compiler! Everything else is just a hack with illegal assumptions."}, {"owner": {"reputation": 7435, "user_id": 768865, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/87ff1151d37f4b538f82f325f2b75149?s=128&d=identicon&r=PG", "display_name": "afaolek", "link": "https://stackoverflow.com/users/768865/afaolek"}, "edited": false, "score": 0, "creation_date": 1502225188, "post_id": 45577068, "comment_id": 78114972, "body": "Regexes are probably what you need. Right now, I have no access to my dev system till tomorrow. I&#39;ll see if I can come up with something."}], "answers": [{"tags": [], "owner": {"reputation": 1132, "user_id": 8401618, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-noqhrDqj6bk/AAAAAAAAAAI/AAAAAAAAATo/heT_oywhhVw/photo.jpg?sz=128", "display_name": "nejcs", "link": "https://stackoverflow.com/users/8401618/nejcs"}, "is_accepted": false, "score": 0, "last_activity_date": 1502225285, "creation_date": 1502225285, "answer_id": 45577778, "question_id": 45577068, "link": "https://stackoverflow.com/questions/45577068/trimming-a-function-from-a-file-so-that-the-only-remaining-characters-are-the-fu/45577778#45577778", "title": "Trimming a function from a file so that the only remaining characters are the function name and parameters", "body": "<p>Quick and dirty solution would be something like this:</p>\n\n<pre><code>int bracketLevel = 0;\nint squareBracketLevel = 0;\nvar methods = new List&lt;string&gt;();\nvar isMethodMode = true; // track if we are in method definition or in method body\nvar isMethod = false; // if we have seen parenthesis in definition\nvar builder = new StringBuilder();\n\nfor (int i = 0; i &lt; fin.Length; i++)\n{\n    if (isMethodMode)\n    {\n        switch (fin[i])\n        {\n            case '(':\n                isMethod = true;\n                builder.Append(fin[i]);\n                bracketLevel++;\n                break;\n            case ')':\n                builder.Append(fin[i]);\n                bracketLevel--;\n                break;\n            case '{':\n                if (bracketLevel &gt; 0) continue;\n                if (isMethod)\n                {\n                    methods.Add(builder.ToString().Trim());\n                    builder.Clear();\n                    isMethod = false;\n                }\n                isMethodMode = false;\n                squareBracketLevel++;\n                break;\n            default:\n                builder.Append(fin[i]);\n                break;\n        }\n    }\n    else\n    {\n        switch (fin[i])\n        {\n            case '{':\n                squareBracketLevel++;\n                break;\n            case '}':\n                squareBracketLevel--;\n                if (squareBracketLevel == 0)\n                {\n                    isMethodMode = true;\n                }\n                break;\n        }\n    }\n}\n</code></pre>\n\n<p>Variable <code>fin</code> contains loaded C file. While this works for your example there are couple of assumptions:</p>\n\n<ol>\n<li>C code is valid (no mismatched parenthesis)</li>\n<li>No comments which would contain parenthesis (this includes commented out functions as was already noted in comments)</li>\n<li>Body block does not contain curly braces in string constants</li>\n</ol>\n\n<p>If those assumptions do not hold for you, then you will have to take a look into parser generators which will parse C file and generate abstract syntax tree for you from which you can extract desired information. One example is <a href=\"http://www.antlr.org/\" rel=\"nofollow noreferrer\">ANTLR</a>. C grammar is also available at <a href=\"https://github.com/antlr/grammars-v4/blob/master/c/C.g4\" rel=\"nofollow noreferrer\">C.g4</a>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8266585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4542b4e10b6cc06c9b4953b06229df23?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/8266585/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502225285, "creation_date": 1502222257, "question_id": 45577068, "link": "https://stackoverflow.com/questions/45577068/trimming-a-function-from-a-file-so-that-the-only-remaining-characters-are-the-fu", "title": "Trimming a function from a file so that the only remaining characters are the function name and parameters", "body": "<p>I am writing some code that replaces an old C exe. The original c file would read a file and then trim the contents and put them into two new files, a .c and a .h file. I am doing the same thing, but in C#. I have everything figured out, except for how to trim a function down so that only the function name and parameters are put into the .h file. \nThis is an example of two of the functions:</p>\n\n<pre><code>void\nM_SCP_Msg_ClearNVMemory(\n    Marshal_dataFunc* _argDataFunc_, Marshal_dataFuncArg _argDataFuncArg_, void const* _argSrc_)\n{\n    SCP_Msg_ClearNVMemory const* _src_ = (SCP_Msg_ClearNVMemory const*)_argSrc_;\n\nM_uint8_t(_argDataFunc_, _argDataFuncArg_, &amp;_src_-&gt;operation);\n\n}\n\nvoid\nMA_SCP_Msg_ClearNVMemory(\n    Marshal_dataFunc* argDataFunc, Marshal_dataFuncArg argDataFuncArg,\n    void const* argSrc, unsigned argNSrcElem)\n{\n\nSCP_Msg_ClearNVMemory const* src = (SCP_Msg_ClearNVMemory const*)argSrc;\n\nfor (; argNSrcElem &gt; 0; --argNSrcElem)\n{\n    M_SCP_Msg_ClearNVMemory(argDataFunc, argDataFuncArg, src++);\n}\n}\n</code></pre>\n\n<p>This would be the expected output:</p>\n\n<pre><code>extern void M_SCP_Msg_ClearNVMemory(\n    Marshal_dataFunc* argDataFunc, Marshal_dataFuncArg argDataFuncArg, void const* argSrc);\n\nextern void MA_SCP_Msg_ClearNVMemory(\n    Marshal_dataFunc* argDataFunc, Marshal_dataFuncArg argDataFuncArg,\n    void const* argSrc, unsigned argNSrcElem);\n</code></pre>\n\n<p>Currently, the lines of the original file are read in as strings which are assigned through a streamreader and then that string is later written to a streamwriter, so I thought iterating through and finding any strings containing any functions would be a good place to start, and once I have those strings I could edit them somehow. This is what I have so far, finList being the list of strings and fin being the string I will write to the output file.</p>\n\n<pre><code> List&lt;string&gt; finList = new List&lt;string&gt;();\n finList.AddRange(fin.Split('\\n'));\n     for (int x = 0; x &lt; finList.Count; x++)\n         {\n             if (finList[x] == \"void\" || finList[x] == \"_Bool\" || finList[x] == \"bool\" || finList[x] == \"unsigned\")\n                 {\n                     finList[x] = im not sure what to do here\n                     fin = string.Empty;\n                 }\n         }  \n\n      for (int x = 0; x &lt; finList.Count; x++)\n         {\n             fin += finList[x];\n         }\n</code></pre>\n\n<p>Any direction or help would be much appreciated. I am relatively new to C# and C, so please be patient if I am not using the correct terms for anything. I think ending the string/line of the function at the \")\" is what makes the most sense, but I am unsure how to do this. \nThanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 12, "creation_date": 1502222012, "post_id": 45576986, "comment_id": 78113343, "body": "This is undefined behavior, so anything is possible."}, {"owner": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 1, "creation_date": 1502222020, "post_id": 45576986, "comment_id": 78113347, "body": "Yes, because the values are completly undefined, there is a chance that they will both be equal. The probability is quite low though"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502222032, "post_id": 45576986, "comment_id": 78113352, "body": "Hell might freeze over before it can happen."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502222041, "post_id": 45576986, "comment_id": 78113357, "body": "of course depends on the original state of the auto variables storage location. you&#39;d have better luck with globals :)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 2639, "user_id": 3072566, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jaZNV.png?s=128&g=1", "display_name": "litelite", "link": "https://stackoverflow.com/users/3072566/litelite"}, "edited": false, "score": 2, "creation_date": 1502222139, "post_id": 45576986, "comment_id": 78113410, "body": "@litelite I&#39;d hesitate to state any probability here.  I&#39;d think zeros might be the most likely for both <code>int</code> values. But it&#39;s UB anyway."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502222229, "post_id": 45576986, "comment_id": 78113455, "body": "I would say some weird optimizations might even take place here, so it won&#39;t even read the values and just hardcode some flow."}, {"owner": {"reputation": 559, "user_id": 5661257, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5ea35715e91596140ffa13e3b8863ad8?s=128&d=identicon&r=PG&f=1", "display_name": "R. Kap", "link": "https://stackoverflow.com/users/5661257/r-kap"}, "edited": false, "score": 0, "creation_date": 1502222248, "post_id": 45576986, "comment_id": 78113462, "body": "All right. Thanks for the information!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502222334, "post_id": 45576986, "comment_id": 78113504, "body": "Only if you are in the habit of running code that generated compiler warnings."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1502222610, "post_id": 45576986, "comment_id": 78113652, "body": "@Jean-Fran&#231;oisFabre &quot;you&#39;d have better luck with globals&quot; - only because no part of the conditions in the title, <i>uninitialized local variables</i>, would be true at that point. Globals are neither local, nor uninitialized, so luck would not play a part in the outcome were that the case."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1502222660, "post_id": 45576986, "comment_id": 78113690, "body": "If it weren&#39;t undefined and the values were entirely random with a uniform distribution, and an <code>int</code> is 32 bits, it would print <code>1</code> every 2^64 times on average. Possible, but you&#39;re about 63 billion times more likely to win the Powerball jackpot."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1502222736, "post_id": 45576986, "comment_id": 78113737, "body": "@WhozCraig yeah. But who cares right ? :)"}, {"owner": {"reputation": 559, "user_id": 5661257, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5ea35715e91596140ffa13e3b8863ad8?s=128&d=identicon&r=PG&f=1", "display_name": "R. Kap", "link": "https://stackoverflow.com/users/5661257/r-kap"}, "edited": false, "score": 0, "creation_date": 1502222831, "post_id": 45576986, "comment_id": 78113794, "body": "@Downvoter Was the downvote really needed?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 1, "creation_date": 1502222852, "post_id": 45576986, "comment_id": 78113802, "body": "@molbdnilo Actually it&#39;s &quot;only&quot; <code>1&#47;(2^32)</code>, as it will print <code>1</code> for <i>any</i> pair of equal numbers.."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502223002, "post_id": 45576986, "comment_id": 78113873, "body": "@EugeneSh. Yeah, of course it actually is. And only 14 times on the Powerball."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502232838, "post_id": 45576986, "comment_id": 78117958, "body": "I linked some more questions in, since the original &quot;dupe&quot; didn&#39;t mention DR260"}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502223223, "post_id": 45577142, "comment_id": 78113979, "body": "shame - it was answered in the comments. Plagiarism.  It is the many times duplicate as well."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1502227941, "post_id": 45577142, "comment_id": 78116197, "body": "Comments are not answers. This is an old issue <a href=\"https://meta.stackoverflow.com/q/288847/2410359\">... comment has been reposted as an answer by another user?</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502232641, "post_id": 45577142, "comment_id": 78117901, "body": "@PeterJ site policy is that answers should not be posted in comments. I would upvote anyone who reposted a comment as an answer (if the answer is correct, of course) .  If the commentor wants credit for an answer they should have posted an answer in the first place"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502233109, "post_id": 45577142, "comment_id": 78118052, "body": "Maybe I am getting old, but as I see the honour is not something which has any value today."}], "tags": [], "owner": {"reputation": 543, "user_id": 8431101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb3dba23180ab706c7234b2a0694b2e?s=128&d=identicon&r=PG&f=1", "display_name": "Pinyi Wang", "link": "https://stackoverflow.com/users/8431101/pinyi-wang"}, "is_accepted": false, "score": 3, "last_activity_date": 1502222515, "creation_date": 1502222515, "answer_id": 45577142, "question_id": 45576986, "link": "https://stackoverflow.com/questions/45576986/can-two-separately-declared-yet-uninitialized-local-variables-ever-hold-the-same/45577142#45577142", "title": "Can two separately declared yet uninitialized local variables ever hold the same value?", "body": "<p>The result of reading the value of an uninitialized variable is undefined, meaning that anything could happen. I would say it's possible for the output to be a 1.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 3, "last_activity_date": 1502223644, "creation_date": 1502223644, "answer_id": 45577386, "question_id": 45576986, "link": "https://stackoverflow.com/questions/45576986/can-two-separately-declared-yet-uninitialized-local-variables-ever-hold-the-same/45577386#45577386", "title": "Can two separately declared yet uninitialized local variables ever hold the same value?", "body": "<p>The thing here is that both variables <code>K</code> and <code>Y</code> have <em>automatic storage duration</em>, and its address is never taken - it could have been declared with <code>register</code> <em>storage class</em>, <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p2\" rel=\"nofollow noreferrer\">C11 6.3.2.1p2</a> says that </p>\n\n<blockquote>\n  <p>If the lvalue designates an object of automatic storage duration that could have been declared with the register storage class (never had its address taken), and that object is uninitialized (not declared with an initializer and no assignment to it has been performed prior to use), the behavior is undefined. </p>\n</blockquote>\n\n<hr>\n\n<p>Because the behaviour is undefined anything might happen. In practice this rule exists because <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_338.htm\" rel=\"nofollow noreferrer\">there are computer architectures where the processor registers would be set to \"unset\" upon an entry to a function</a> - accessing such a register would actually trigger a hardware trap that will cause the program to crash.</p>\n\n<p>This rule has then lead to other compilers doing all sorts of wild stuff with these - it might be that no register will be allocated for a variable before it is assigned to, so you might see the value of the variable changing over executions, so it might be that consecutive invocations</p>\n\n<pre><code>printf(\"%d\", K==Y);\nprintf(\"%d\", K==Y);\n</code></pre>\n\n<p>might print different values.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502227427, "post_id": 45577733, "comment_id": 78115978, "body": "Note; I think reading uninitialized local <code>unsigned char</code> has <i>unspecified behavior</i>, not <i>undefined behavior</i>.  The value is not specified, yet it will not cause a crash, exception, etc."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502232734, "post_id": 45577733, "comment_id": 78117933, "body": "@chux according to DR 260, it produces an indeterminate value; operations on indeterminate values produce indeterminate values; and passing indeterminate values to library functions causes undefined behaviour. (All of this holds even if there are no trap representations).  So <code>K==Y</code> is also indeterminate, and trying to printf it causes UB."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1502235899, "post_id": 45577733, "comment_id": 78118699, "body": "@M.M  <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_260.htm\" rel=\"nofollow noreferrer\">DR 260</a> does not discuss the indeterminate-ness of <code>unsigned char</code>, but a pointer to that type after the pointer was free&#39;d.   An uninitialized <code>unsigned char </code> is not of <i>indeterminate value</i>, but <i>unspecified value</i> as it is specified to not have a trap representation."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502236952, "post_id": 45577733, "comment_id": 78118931, "body": "@chux There are no special cases for certain types in DR260.  An uninitialized unsigned char has an indeterminate value, just the same as any other type.  Even if there are no trap representations for the type, having indeterminate value differs from being initially unspecified; e.g. passing indeterminate value to library function is still UB even if the indeterminate value couldn&#39;t be a trap representation. This stuff is all fleshed out in actual answers (e.g. <a href=\"https://stackoverflow.com/a/25074258/1505939\">mine here</a>)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1502245695, "post_id": 45577733, "comment_id": 78120787, "body": "@M.M Good answer, yet I found it before and still now it uses selective cases  for the point - <i>most</i> of which I agree.  Perhaps, at a latter time, rather than here, I will detail my thoughts for your consideration.  Thanks for your professional vigor."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1502225125, "creation_date": 1502225125, "answer_id": 45577733, "question_id": 45576986, "link": "https://stackoverflow.com/questions/45576986/can-two-separately-declared-yet-uninitialized-local-variables-ever-hold-the-same/45577733#45577733", "title": "Can two separately declared yet uninitialized local variables ever hold the same value?", "body": "<p>Reading uninitialized local variables with automatic storage has undefined behavior.  Anything can happen:</p>\n\n<ul>\n<li>the output can be <code>1</code></li>\n<li>the output can be <code>0</code></li>\n<li>the output can be <code>Hello world</code></li>\n<li>there might not be any output</li>\n<li>the computer might go back in time 9 months or so, which would be a handy way to try and correct some historical accidents, or at least monetise them. Alas unlikely to happen.</li>\n</ul>\n"}], "owner": {"reputation": 559, "user_id": 5661257, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5ea35715e91596140ffa13e3b8863ad8?s=128&d=identicon&r=PG&f=1", "display_name": "R. Kap", "link": "https://stackoverflow.com/users/5661257/r-kap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "closed_date": 1502230709, "answer_count": 3, "score": 0, "last_activity_date": 1502232822, "creation_date": 1502221950, "question_id": 45576986, "link": "https://stackoverflow.com/questions/45576986/can-two-separately-declared-yet-uninitialized-local-variables-ever-hold-the-same", "closed_reason": "Duplicate", "title": "Can two separately declared yet uninitialized local variables ever hold the same value?", "body": "<p>For instance, consider the following:</p>\n\n<pre><code>int main(void) {\n    int K;\n    int Y;\n    printf(\"%d\", K==Y);\n    return 0;\n}\n</code></pre>\n\n<p>Is it possible for the output to ever be a <code>1</code>?</p>\n"}, {"tags": ["c", "audio", "ffmpeg"], "answers": [{"tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": true, "score": 5, "last_activity_date": 1502299416, "last_edit_date": 1592644375, "creation_date": 1502227979, "answer_id": 45578370, "question_id": 45576682, "link": "https://stackoverflow.com/questions/45576682/convert-encoded-audio-file-to-text-with-signal-values/45578370#45578370", "title": "Convert encoded audio file to text with signal values", "body": "<p>I just compiled then ran your code ... the output file samples.csv is a vertical column of signed 16 bit integers which represents each of the samples of your input audio curve ... as in :  YMMV</p>\n<pre><code>-20724\n-19681\n-18556\n-17359\n-16096\n-14766\n-13383\n-11940\n-10460\n-8928\n-7371\n-5778\n-4165\n-2536\n-897\n749\n2385\n4019\n5633\n7224\n8793\n10318\n11811\n13251\n14644\n15977\n17247\n</code></pre>\n<p>... so while that raw audio is in your variable <code>buf</code> you can add to your above code to answer your questions</p>\n<p><strong>volume</strong> - audio is a curve so when the curve fails to wobble its silent ... its critical to understand meaning of bit depth when calculating volume ... I suggest you open up output file in a text editor to eyeball every value ... knowing you have a bit depth of 16 bits tells you the number of possible integer values ... on a blank stare <a href=\"https://en.wikipedia.org/wiki/Pulse-code_modulation\" rel=\"nofollow noreferrer\">read up on PCM raw audio</a>  ... to a first approximation the following changes to your code will tell you the volume</p>\n<pre><code>int min_value = 9999;\nint max_value = -9999;\n\nfor (n=0 ; n &lt; N ; ++n) {\n\n    if (buf[n] &lt; min_value)  min_value = buf[n];\n    if (buf[n] &gt; max_value)  max_value = buf[n];\n\n    fprintf(csvfile, &quot;%d\\n&quot;, buf[n]);\n}\n\nfclose(csvfile);\n\nprintf(&quot;min_value %d\\n&quot;, min_value);\nprintf(&quot;max_value %d\\n&quot;, max_value);\n</code></pre>\n<p>knowing the bit depth of your audio, lets say its 16 bits, then you have 2^16 possible distinct integers ... from say 0 to (65536 - 1) to represent the curve of your raw audio ... that is if your data is unsigned ... if its signed integers (as defined in the WAV file headers) then shift that range so its zero centered ... then the range would go from -32768 to (+32768 - 1) or -32768 to +32767 ... so if your audio <code>buf[n]</code> values traverse the full possible range from min to max values then your audio stretch of samples can be said to be at full volume ... now we are in a position to interpret the above measurements :  min_value and max_value ... if  min_value is around -16384 and if  max_value is around +16384 then the volume would be about half the maximum since its only consuming half of the range of possible integer values</p>\n<p>so volume in a range from 0 to 1 ( min to max volume) can be calculated (by oversimplifying) using this formula</p>\n<pre><code>num_possible_ints = 2^bit_depth  // == 65536 for bit depth of 16 bits \nvolume = 1 - ( num_possible_ints - ( max_value - min_value )) / num_possible_ints\n</code></pre>\n<p>why is this oversimplifying ? because without pre-processing your audio buffer [by discarding outlying audio samples which only rarely spike to max or min, if desired]  this approach is prone to giving too high a volume measurement</p>\n<p>there are better measurements of volume yet keep in mind its prone to perceptual biases ...  <a href=\"https://forum.cockos.com/showthread.php?t=100662\" rel=\"nofollow noreferrer\">lookup Root Mean Square to calculate volume with better accuracy ... to quote :</a></p>\n<blockquote>\n<p>RMS is averaging the area displaced by the signal, the area between the waveform and the linear zero line (not 0dB, but the axis).</p>\n<p>As the waveform swings both above (+) and below (-) the centreline, the polarity of the swings has to be disregarded. Luckily, in maths, anything multiplied by itself (squaring) ends up positive. The signal can then be averaged (arithmetic mean over the timeline/window ED mentions or its integration time) as the positive and negative halves won't now cancel each other out -and finally the inverse to squaring is executed -square root.</p>\n<p>RMS just means root-mean-square or the square-root of the arithmetic mean of the square of the signal.</p>\n<p>In reality, what it means is that a signal of high-amplitude, spikey, transient content can have the same RMS value as one of lower amplitude but fatter waveform -because they both have the same energy content. If you put them through a speaker, they should both generate the same acoustical energy output.</p>\n<p>Typical spikey waveforms are things like drum transients, whereas fatter waveforms would be sine waves or even square waves (as fat as you can get), where a much lower peak level would be needed to have the same power (a sine wave of 1.4Vp has the same RMS level as a square wave of 1.0Vp).</p>\n</blockquote>\n<p>... this should get you started</p>\n<p><strong>PS</strong>  <a href=\"http://man7.org/linux/man-pages/man3/popen.3.html\" rel=\"nofollow noreferrer\">popen is doing a stream read from the input file</a></p>\n"}], "owner": {"reputation": 61, "user_id": 5450076, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/20cc09b680b6b5318d6f7f519d9d7e6d?s=128&d=identicon&r=PG&f=1", "display_name": "Niccol&#242; Cirone", "link": "https://stackoverflow.com/users/5450076/niccol%c3%b2-cirone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 894, "favorite_count": 0, "accepted_answer_id": 45578370, "answer_count": 1, "score": 3, "last_activity_date": 1502787648, "creation_date": 1502220806, "last_edit_date": 1502787648, "question_id": 45576682, "link": "https://stackoverflow.com/questions/45576682/convert-encoded-audio-file-to-text-with-signal-values", "title": "Convert encoded audio file to text with signal values", "body": "<p>I've been programming in c for the first time with audio files. I found this code which supposedly should read an audio file and then write a csv file containing several info in order to analyse the audio waves,that in case will be a simple voice: i'm interested in amplitude of the waves, in the timbre of the voice and its hight and extension.        </p>\n\n<pre><code>           main () {   \n           // Create a 20 ms audio buffer (assuming Fs = 44.1 kHz)\n           int16_t buf[N] = {0}; // buffer\n           int n;                // buffer index\n\n          // Open WAV file with FFmpeg and read raw samples via the pipe.\n          FILE *pipein;\n          pipein = popen(\"ffmpeg -i whistle.wav -f s16le -ac 1 -\", \"r\");\n          fread(buf, 2, N, pipein);\n          pclose(pipein);\n\n          // Print the sample values in the buffer to a CSV file\n          FILE *csvfile;\n          csvfile = fopen(\"samples.csv\", \"w\");\n          for (n=0 ; n&lt;N ; ++n) fprintf(csvfile, \"%d\\n\", buf[n]);\n          fclose(csvfile);\n\n       }\n</code></pre>\n\n<p>Could someone explain me in detail how can I read an audio file so that I could extract from it the info I need? Referring to this code, could someone explain me the meaning of the pipe at line 8 </p>\n\n<pre><code>pipein = popen(\"ffmpeg -i whistle.wav -f s16le -ac 1 -\", \"r\");\n</code></pre>\n\n<p>p.s. I already know how to read the header of the audio file, which contains a lot of useful info, but I also want to analyse the entire audio file, sample by sample.</p>\n"}, {"tags": ["c++", "c", "c-preprocessor"], "comments": [{"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 16, "creation_date": 1502220334, "post_id": 45576538, "comment_id": 78112392, "body": "Probably to suppress any &quot;unused variable&quot; compile warnings."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1502220366, "post_id": 45576538, "comment_id": 78112412, "body": "But couldn&#39;t it produce a warning about ignoring a result? I thought the right way to do so was <code>(void) (foo);</code> @FredLarson"}, {"owner": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "reply_to_user": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "edited": false, "score": 0, "creation_date": 1502220409, "post_id": 45576538, "comment_id": 78112437, "body": "@Justin: C and C++ code ignore results all the time, especially in function calls. Such a warning would be extremely unpopular."}, {"owner": {"reputation": 21009, "user_id": 1896169, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/jap8U.png?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/1896169/justin"}, "reply_to_user": {"reputation": 55871, "user_id": 10077, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/be4e820c7af6f3b79cf055d984cda7ff?s=128&d=identicon&r=PG", "display_name": "Fred Larson", "link": "https://stackoverflow.com/users/10077/fred-larson"}, "edited": false, "score": 0, "creation_date": 1502220516, "post_id": 45576538, "comment_id": 78112509, "body": "@FredLarson Yes, but I seem to recall that one should cast it to <code>void</code>. I can&#39;t remember where I got that.... Maybe it was just because if you had something like <code>foo, bar</code>, C++ could have an overloaded <code>operator,</code>, so you&#39;d want to cast to void. I probably just overgeneralized that"}, {"owner": {"reputation": 435637, "user_id": 367273, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/f1ed2b0c87f602ef30229f5c4b04eff6?s=128&d=identicon&r=PG", "display_name": "NPE", "link": "https://stackoverflow.com/users/367273/npe"}, "edited": false, "score": 0, "creation_date": 1502221291, "post_id": 45576538, "comment_id": 78112947, "body": "Thanks. I have to say, that&#39;s one odd macro."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1502221471, "post_id": 45576538, "comment_id": 78113051, "body": "This looks like a macro that declares a bunch of variables &quot;just in case I&#39;m gonna need them&quot; with associated &quot;unused variable&quot; suppression in case they&#39;re not needed. It doesn&#39;t seem very useful other than for obfuscation."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502222708, "post_id": 45576792, "comment_id": 78113716, "body": "it is done to suppress the warning unused variable. But it is done improperly so you can get another one instead (initialized variable ). It shoud be <code>(void)foo;</code>"}], "tags": [], "owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1502221217, "creation_date": 1502221217, "answer_id": 45576792, "question_id": 45576538, "link": "https://stackoverflow.com/questions/45576538/why-would-one-write-a-literal-directly-followed-by-a-semicolon-in-c-c/45576792#45576792", "title": "Why would one write a literal directly followed by a semicolon in c/c++?", "body": "<p>As Fred Larson suggested in the comments, it could be used to suppress compiler warnings. I tried this code:</p>\n\n<pre><code>int foo = 0;\nfoo;\n</code></pre>\n\n<p>I debugged the code and the compiler completely skipped over the second line, so it seems to do nothing of importance. Of course if you are afraid that these lines affect your macro, you can always step through the code with a debugger like I did.</p>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502222690, "post_id": 45576794, "comment_id": 78113704, "body": "it is done to suppress the warning unused variable. But it is done improperly so you can get another one instead (initialized variable). It shoud be <code>(void)foo;</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": false, "score": 0, "last_activity_date": 1502221223, "creation_date": 1502221223, "answer_id": 45576794, "question_id": 45576538, "link": "https://stackoverflow.com/questions/45576538/why-would-one-write-a-literal-directly-followed-by-a-semicolon-in-c-c/45576794#45576794", "title": "Why would one write a literal directly followed by a semicolon in c/c++?", "body": "<p>It might be the result of macro expansion.</p>\n\n<p>It might just be someone being silly.</p>\n\n<p>It could be to suppress compiler warnings.</p>\n\n<p>In any case, statements like that are perfectly legal in the language and have no actual effect on the program.\nAny competent compiler will just remove them during compilation.</p>\n"}], "owner": {"reputation": 371, "user_id": 4923239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ovj73.png?s=128&g=1", "display_name": "MrZoraman", "link": "https://stackoverflow.com/users/4923239/mrzoraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "closed_date": 1502221259, "answer_count": 2, "score": 5, "last_activity_date": 1502221223, "creation_date": 1502220284, "last_edit_date": 1502220916, "question_id": 45576538, "link": "https://stackoverflow.com/questions/45576538/why-would-one-write-a-literal-directly-followed-by-a-semicolon-in-c-c", "closed_reason": "Duplicate", "title": "Why would one write a literal directly followed by a semicolon in c/c++?", "body": "<p>I'm looking at some code and I've come across the following line in a macro:</p>\n\n<pre><code>int foo = 0; (foo);\n</code></pre>\n\n<p>It compiles just fine. In fact, it seems that</p>\n\n<pre><code>0;\n</code></pre>\n\n<p>is a valid line of code in C/C++.</p>\n\n<p>I've taken a look at the produced assembly in debug and release builds (on msvc), and it does not make a difference to the assembly. My test was a simple one though (with and without <code>(foo);</code>):</p>\n\n<pre><code>int main()\n{\n    int foo = 0;\n    (foo);\n    return 0;\n}\n</code></pre>\n\n<p>My question is why would anyone want to do this? I'm sure <code>(foo);</code> is in the macro for a reason, but I'm not sure why.</p>\n\n<p>For context, the macro it is found in looks like this (I've renamed the variables):</p>\n\n<pre><code>#define MY_MACRO int _foo = 0; (_foo); UINT _bar = CP_THREAD_ACP; (_bar); LPCWSTR _baz = NULL; (_baz); LPCSTR _thing = NULL; (_thing)\n</code></pre>\n\n<p>In the code, it is simply called like</p>\n\n<pre><code>MY_MACRO;\n//other code...\n</code></pre>\n"}, {"tags": ["c", "json", "visual-studio-code"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1502220238, "post_id": 45576395, "comment_id": 78112350, "body": "The program should be the .exe, not the c file."}, {"owner": {"reputation": 11, "user_id": 8302025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ngyf1jiE8lU/AAAAAAAAAAI/AAAAAAAAAfc/Y5WiSe_C3FU/photo.jpg?sz=128", "display_name": "DijkstraFTW", "link": "https://stackoverflow.com/users/8302025/dijkstraftw"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1502220902, "post_id": 45576395, "comment_id": 78112722, "body": "@interjay which line please ? Because after trying it an error is gived"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1502221036, "post_id": 45576395, "comment_id": 78112805, "body": "The one which says that  <code>program</code> is a c file."}], "owner": {"reputation": 11, "user_id": 8302025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Ngyf1jiE8lU/AAAAAAAAAAI/AAAAAAAAAfc/Y5WiSe_C3FU/photo.jpg?sz=128", "display_name": "DijkstraFTW", "link": "https://stackoverflow.com/users/8302025/dijkstraftw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1512485564, "creation_date": 1502219716, "last_edit_date": 1512485564, "question_id": 45576395, "link": "https://stackoverflow.com/questions/45576395/debugging-c-with-vs-code", "title": "Debugging C with VS Code", "body": "<p>I've trouble setting up VS Code to debug C though I've followed the instructions here: <a href=\"https://stackoverflow.com/questions/30269449/how-do-i-set-up-vscode-to-compile-c-code?noredirect=1&amp;lq=1\">How do I set up VSCode to compile C++ code?</a> ( mx0's answers ).\nWhile runnig the <code>built.bat</code> task, it shows this in the output:</p>\n\n<blockquote>\n  <p>'Build.bat' is not recognized as an internal command Or external, an\n  executable program or a batch file.</p>\n</blockquote>\n\n<p>Furthermore, debugging fails and it shows this error:</p>\n\n<blockquote>\n  <p>Unknown Error: 0x800700c1</p>\n</blockquote>\n\n<p>My <code>launch.json</code> file looks like this:</p>\n\n<pre><code>{\n    \"name\": \"(Windows) Launch\",\n    \"type\": \"cppvsdbg\",\n    \"request\": \"launch\",\n    \"program\": \"${workspaceRoot}\\\\C\\\\test.c\",\n    \"args\": [],\n    \"stopAtEntry\": false,\n    \"cwd\": \"${workspaceRoot}\",\n    \"environment\": [],\n    \"externalConsole\": true\n},\n{\n    \"name\": \"(Windows) Attach\",\n    \"type\": \"cppvsdbg\",\n    \"request\": \"attach\",\n    \"processId\": \"${command:pickProcess}\"\n}\n</code></pre>\n\n<p>And, my <code>task.json</code> looks like this :</p>\n\n<pre><code>{  \n   // See https://go.microsoft.com/fwlink/?LinkId=733558\n   // for the documentation about the tasks.json format\n   \"version\": \"0.1.0\",\n   \"windows\": {\n      \"command\": \"build.bat\",\n      \"isShellCommand\": true,\n      \"showOutput\": \"always\"\n   }\n}\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["c", "sorting", "gcc", "bubble-sort"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 4, "creation_date": 1502219662, "post_id": 45576316, "comment_id": 78112009, "body": "Aren&#39;t the <code>-O2</code>, <code>-O3</code>, and <code>-O4</code> optimization options (note the upper case <code>O</code>)? So wouldn&#39;t you expect the time to decrease? I&#39;m not sure I understand the question. And I don&#39;t think you did <code>gcc sort -o sort.c</code> as that would attempt to compile <code>sort</code> as a source and write the binary to <code>sort.c</code>. I would think you entered <code>gcc sort.c -o sort</code>?"}, {"owner": {"reputation": 46142, "user_id": 773113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/FKKLW.jpg?s=128&g=1", "display_name": "Mike Nakis", "link": "https://stackoverflow.com/users/773113/mike-nakis"}, "edited": false, "score": 0, "creation_date": 1502219861, "post_id": 45576316, "comment_id": 78112130, "body": "in other words: when it comes to execution time, less is better."}, {"owner": {"reputation": 49, "user_id": 8071150, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bfa49960e81f183ead02de061d32acb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Kumar", "link": "https://stackoverflow.com/users/8071150/sahil-kumar"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1502219867, "post_id": 45576316, "comment_id": 78112136, "body": "@lurker sorry , the question is how do -o2, -o3 work"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1502219960, "post_id": 45576316, "comment_id": 78112190, "body": "<code>-o2</code> tells the compiler to write its output to a file named <code>2</code>. <code>-O2</code> enables optimizations. They&#39;re entirely different options; since gcc&#39;s options are case-sensitive. Also, if you&#39;re really using <code>-o sort.c</code>, then you&#39;re clobbering your source file. Please update your question to make it clear which one you&#39;re actually using; copy-and-paste your exact shell command."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502827240, "post_id": 45576316, "comment_id": 78359506, "body": "Avoid naming a variable <code>l</code> as it looks too similar to <code>1</code>, especially with fixed with fonts used in programmer&#39;s editors."}], "answers": [{"tags": [], "owner": {"reputation": 2622, "user_id": 1834967, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/Fdxei.jpg?s=128&g=1", "display_name": "Felix Guo", "link": "https://stackoverflow.com/users/1834967/felix-guo"}, "is_accepted": false, "score": 2, "last_activity_date": 1502394903, "last_edit_date": 1502394903, "creation_date": 1502219707, "answer_id": 45576392, "question_id": 45576316, "link": "https://stackoverflow.com/questions/45576316/using-o2-decreases-time-of-bubble-sort-c-program/45576392#45576392", "title": "using -O2 decreases time of bubble sort C program", "body": "<p><code>-O</code> stands for <code>optimize</code>, in which <code>gcc</code> will automatically take the steps necessary to optimize your program. You can read more about the specific steps that GCC takes to optimize your program here: <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\" rel=\"nofollow noreferrer\">https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html</a></p>\n\n<p>But essentially, <code>-O2</code> is more optimized than <code>-O1</code>, and <code>-O3</code> more than <code>-O2</code>. This might come with drawbacks in regard to compiled binary size, where the resulting binary could use more space, but run faster, and vice versa. You can actually paste your code into <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">https://godbolt.org/</a>, and write in <code>-O1</code> or any of the optimization options beside the dropdown to choose a compiler, and <code>godbolt</code> will show you what the resulting code looks like. You will be able to see a difference between <code>O1</code> and <code>O2</code>, namely, the <code>O2</code> generated code is probably shorter and will use a lot of shortcuts to do your algorithm.</p>\n"}, {"tags": [], "owner": {"reputation": 893, "user_id": 4204413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wkXjz.png?s=128&g=1", "display_name": "TimD1", "link": "https://stackoverflow.com/users/4204413/timd1"}, "is_accepted": false, "score": 2, "last_activity_date": 1502219750, "creation_date": 1502219750, "answer_id": 45576406, "question_id": 45576316, "link": "https://stackoverflow.com/questions/45576316/using-o2-decreases-time-of-bubble-sort-c-program/45576406#45576406", "title": "using -O2 decreases time of bubble sort C program", "body": "<p>The <code>-O</code> compiler flag controls the amount of compiler optimization that you wish the compiler to perform. In short, building the project will take longer but the resulting executable should be faster. For more information, type <code>man gcc</code> into the command prompt or <code>gcc -c -Q -O3 --help=optimizers</code> for specific information regarding the optimizations performed for a particular flag.</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 8127650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae26ccc457eaa888985c1849092dced4?s=128&d=identicon&r=PG&f=1", "display_name": "drone6502", "link": "https://stackoverflow.com/users/8127650/drone6502"}, "is_accepted": false, "score": 1, "last_activity_date": 1502220157, "creation_date": 1502220157, "answer_id": 45576507, "question_id": 45576316, "link": "https://stackoverflow.com/questions/45576316/using-o2-decreases-time-of-bubble-sort-c-program/45576507#45576507", "title": "using -O2 decreases time of bubble sort C program", "body": "<p>gcc offers a number of optimization flags. You can see what each one does specifically here:</p>\n\n<pre><code>https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html\n</code></pre>\n\n<p>There's always a tradeoff with optimizations, either by increased compile time, increased use of memory, etc...</p>\n\n<p>There are dozens of optimizations enabled by the -o2 flag, so it might not be immediately clear which specific ones affect the sorting. Instead of -o2, you can try each optimization individually, for example using the -falign-loops flag, to see whether that is the one providing the performance increase.</p>\n"}, {"comments": [{"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502227213, "post_id": 45576654, "comment_id": 78115877, "body": "The main GCC frontends do not have an abstract syntax tree (in the sense that there is a tree node for a <code>for</code> statement, or one for an <code>if</code> statement)."}, {"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502315418, "post_id": 45576654, "comment_id": 78161711, "body": "@FlorianWeimer GCC does have an AST, not sure if it is part of what you call the front-end or not, but you can access it through <code>gcc -fdump-tree-vcg -g test.c</code>  Note that the AST is for GCC, not for the language being parsed, so I agree that there isn&#39;t a &quot;C if-node&quot; vs a &quot;Java if-node&quot;.  Rather it is that AST which drives their back-end processes.  I hope this clarifies a point, which in my expression, I see was read the wrong way.  Cheers!"}, {"owner": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502335192, "post_id": 45576654, "comment_id": 78166992, "body": "<code>-fdump-tree-vcg</code> used to dump the CFG, which is not an AST. Both the C and C++ front ends lower control flow constructs to <code>goto</code>s. There isn&#39;t anything which closely resembles the original syntax."}, {"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "reply_to_user": {"reputation": 26934, "user_id": 8316315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d833a8a46fea39d7bfca1540ea9c07?s=128&d=identicon&r=PG&f=1", "display_name": "Florian Weimer", "link": "https://stackoverflow.com/users/8316315/florian-weimer"}, "edited": false, "score": 0, "creation_date": 1502387311, "post_id": 45576654, "comment_id": 78200229, "body": "@FlorianWeimer I didn&#39;t create GCC, but I&#39;ve read a lot of it&#39;s design.  Yes, the AST in GCC is not a language-specific AST, but I&#39;ve never claimed it was.  It is an AST designed such that the single back-end can handle a variety of language front ends.  And if  you ever program in assembly, goto has an analog in the JMP related instructions, which is the way selective flow control is typically done in assembly."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502778573, "post_id": 45576654, "comment_id": 78332647, "body": "Does your last example ever produce code like <code>puts(&quot;3\\n4\\n5&quot;)</code>?"}, {"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502809776, "post_id": 45576654, "comment_id": 78349674, "body": "@chqrlie No, because loop unrolling is a single type of optimization, and that output would require a different type of optimization.  That said, your output would be a valid optimization, because the observable output would be preserved, but whether a compiler would arrive at it is heavily dependent on how much optimization is requested, and if the compiler has a routine to compact constant strings (applied after the loop unrolling)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502816790, "post_id": 45576654, "comment_id": 78354133, "body": "@EdwinBuck: both <code>gcc</code> and <code>clang</code> do optimize <code>printf(&quot;Hello world\\n&quot;);</code> into <code>puts(&quot;Hello world&quot;);</code> and <code>printf(&quot;\\n&quot;);</code> into <code>(putchar)(&#39;\\n&#39;);</code> so combining multiple <code>printf</code> statements into a single <code>puts</code> or handling conversions of constant arguments seems quite easy but for some reason not considered worthwhile."}, {"owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502824251, "post_id": 45576654, "comment_id": 78358030, "body": "@chqrlie Yes, but do that do that in the context of a loop unrolling?  That requires multiple passes of optimization, and I didn&#39;t personally look into where the optimization stops at <code>-O2</code>.  All I said was that in the context of the loop unrolling, contenting strings is a different optimization, one which might be applied."}], "tags": [], "owner": {"reputation": 64564, "user_id": 302139, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1ea13e6d50c94ba30296c4e5326e1634?s=128&d=identicon&r=PG", "display_name": "Edwin Buck", "link": "https://stackoverflow.com/users/302139/edwin-buck"}, "is_accepted": true, "score": 3, "last_activity_date": 1502222041, "last_edit_date": 1502222041, "creation_date": 1502220687, "answer_id": 45576654, "question_id": 45576316, "link": "https://stackoverflow.com/questions/45576316/using-o2-decreases-time-of-bubble-sort-c-program/45576654#45576654", "title": "using -O2 decreases time of bubble sort C program", "body": "<p>Optimization options work between the reading of the source code and the writing of the binary instructions to the CPU.</p>\n\n<p>GCC is a multi-phase compiler, where the phases roughly consist of:</p>\n\n<ol>\n<li>Creating \"tokens\" from the input text.</li>\n<li>Arranging those tokens into abstract syntax tree structure.</li>\n<li>Pruning the abstract syntax tree.</li>\n<li>Creating register based instructions, assuming an infinite number of CPU registers.</li>\n<li>Mapping the registers into the actual registers available.</li>\n<li>Writing the binary information out, in the loader's expected format.</li>\n</ol>\n\n<p>Optimizations can impact a number of locations, typically they become active in the above mentioned steps 3 through 5.  There are many optimizations, including:</p>\n\n<ul>\n<li>Constant folding \u2013 Evaluate constant subexpressions in advance.</li>\n<li>Strength reduction \u2013 Replace slow operations with faster equivalents.</li>\n<li>Null sequences \u2013 Delete useless operations.</li>\n<li>Combine operations \u2013 Replace several operations with one equivalent.</li>\n<li>Algebraic laws \u2013 Use algebraic laws to simplify or reorder instructions.</li>\n<li>Special case instructions \u2013 Use instructions designed for special operand cases.</li>\n<li>Address mode operations \u2013 Use address modes to simplify code.</li>\n<li>Loop unrolling - Replace a loop with equivalent instructions</li>\n<li>Partial loop unrolling - Reduce times a loop is evaluated while preserving overall function.</li>\n</ul>\n\n<p>Note that these are not all the optimizations that might be performed, but it starts to give you an idea.</p>\n\n<p>For example, if the compiler sees </p>\n\n<pre><code>int s = 3;\nwhile (s &lt; 6) {\n   printf(\"%d\\n\", s);\n   s++;\n}\n</code></pre>\n\n<p>and the flags are set to unroll loops, then it might write CPU instructions equivalent to</p>\n\n<pre><code>printf(\"%d\\n\", 3);\nprintf(\"%d\\n\", 4);\nprintf(\"%d\\n\", 5);\n</code></pre>\n\n<p>Those instructions might seem more wordy to us humans, but the CPU commands might be smaller, because there is no need to \"lookup\" the now-erased value of <code>s</code>, nor is there the need to add one to it, or store the new updated value back into RAM.</p>\n\n<p>GCC arranges the optimizations into categories, ranging from \"safe\" to \"risky\".  -O2 is a good compromise between speed and safety.  Higher -O numbers are riskier.</p>\n"}], "owner": {"reputation": 49, "user_id": 8071150, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/bfa49960e81f183ead02de061d32acb1?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil Kumar", "link": "https://stackoverflow.com/users/8071150/sahil-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "accepted_answer_id": 45576654, "answer_count": 4, "score": 0, "last_activity_date": 1502778472, "creation_date": 1502219440, "last_edit_date": 1502778472, "question_id": 45576316, "link": "https://stackoverflow.com/questions/45576316/using-o2-decreases-time-of-bubble-sort-c-program", "title": "using -O2 decreases time of bubble sort C program", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nvoid sort();\n\nint main() {\n    int i;\n    for (i = 0; i &lt; 100000; i++) {\n        sort();\n    }\n}\n\nvoid sort() {\n    int i, j, k, array[100], l = 99, m;\n    for (i = 0; i &lt; 100; i++) {\n        array[i] = rand() % 1000 + 1;\n    }\n    for (k = 0; k &lt; 99; k++) {\n        for (j = 0; j &lt; l; j++) {\n            if (array[j + 1] &gt; array[j]) {\n                int temp = array[j];\n                array[j] = array[j + 1];\n                array[j + 1] = temp;\n            }\n        }\n        l--;\n    }\n    for (m = 0; m &lt; 100; m++) {\n        printf(\"%d \", array[m]);\n    }\n}\n</code></pre>\n\n<p>On the linux shell, <code>gcc sort -o sort.c</code> and then <code>time ./sort &gt;&gt; out</code>.\nHere if I do <code>gcc -o2 sort -o sort.c</code> and similarly <code>o3</code> and <code>o4</code> then the time keeps on decreasing. How does the optimization options work? Please explain in terms of all real time, user time and system time.</p>\n\n<p>PS: The code might be a little inefficient. Kindly ignore that.</p>\n"}, {"tags": ["c", "linux", "pdf-generation", "ghostscript"], "answers": [{"tags": [], "owner": {"reputation": 27865, "user_id": 701996, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hx9ep.jpg?s=128&g=1", "display_name": "KenS", "link": "https://stackoverflow.com/users/701996/kens"}, "is_accepted": false, "score": 0, "last_activity_date": 1502264359, "creation_date": 1502264359, "answer_id": 45584422, "question_id": 45576018, "link": "https://stackoverflow.com/questions/45576018/an-extra-blank-page-is-created-when-merging-two-pcl-with-ghostscript/45584422#45584422", "title": "An extra blank page is created when merging two PCL with ghostscript", "body": "<p>Its not really possible to tell what your problem is without seeing the content of the two files. PCL is a simplistic language, and its possible that there is some aspect of page ejection that is causing a genuine extra page (because the interpreter believes the page is marked) when the input is closed.</p>\n\n<p>A few observations; you should use the current version of GhostPCL (9.21). I would recommend never using PDFSETTINGS, especially when the input is from a different language, stick with the defaults. There is no 'EmbededFonts' switch, there's 'EmbedAllFonts', 'AlwaysEmbed' and 'NeverEmbed'. The latter two take an array of font names which should not be embedded.</p>\n"}], "owner": {"reputation": 3, "user_id": 2844373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba1eb35815f2fcc4a2eb608343589c5?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Omar De Santiago", "link": "https://stackoverflow.com/users/2844373/ivan-omar-de-santiago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502264359, "creation_date": 1502218473, "last_edit_date": 1502219498, "question_id": 45576018, "link": "https://stackoverflow.com/questions/45576018/an-extra-blank-page-is-created-when-merging-two-pcl-with-ghostscript", "title": "An extra blank page is created when merging two PCL with ghostscript", "body": "<p>I am converting two PCL documents to a single PDF document. \nThere are only two pages but the PDF documents ended up with 3. One extra empty page. </p>\n\n<pre><code>snprintf( cmd, sizeof( cmd ) - 1,\n        \"/home/rds/app/src/gpcl919/ghostpcl-9.19-linux-x86/gpcl6-919 \"\n        \"-sDEVICE=pdfwrite -sOutputFile=%s \"\n        \"-dSAFER -dNOPAUSE -dBATCH -sPAPERSIZE=letter -dSusbsetFonts=true \"\n        \"-dEmbededFonts=true -dCompatibilityLevel=\\\"1.3\\\" \"\n        \"-dPDFSETTING=\\\"/printer\\\" %s  %s\", szPdfPath, szPclPath1, szPclPath2 );\n</code></pre>\n"}, {"tags": ["c", "arrays", "flexible-array-member"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1502220062, "post_id": 45575808, "comment_id": 78112238, "body": "FYI, the initialization of a flexible array member as you do above is a compiler extension and not permitted by the standard."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502222318, "post_id": 45575808, "comment_id": 78113495, "body": "It might be easiest to upgrade the compiler.  You could replace the <code>bString</code> FAM with a pointer; it&#39;ll use more space, but you can do as you need \u2014 unless what you need requires contiguous memory in the structure. If that&#39;s the case, you&#39;re stuck.  The &quot;without dynamic memory allocation&quot; requirement leaves you with very few useful options."}, {"owner": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1502222752, "post_id": 45575808, "comment_id": 78113745, "body": "FWIW, I&#39;ve tried several times to make nice, clean C or C++ structures that function as USB string descriptors.  Never had much success, and certainly not enough to justify the hassle of doing it.  In my latest code, I just used <code>asm</code> blocks.  It&#39;s ugly and marginally unportable, but it&#39;s easy, straightforward and clear.  Comment it carefully and move on.  This is not a favorable place to try to use all the great new C++ features to solve an old problem."}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502222965, "post_id": 45575808, "comment_id": 78113850, "body": "@JonathanLeffler Unfortunately &quot;upgrading&quot; is what got me here. I wrote the proof of concept in C99 using gcc, and now I am trying to migrate it to IAR and pass a bunch of static analysis test. I also do require contiguous memory, unless I want to do a <i>significant</i> refactor of my code. which isn&#39;t really worth it right now."}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 1178, "user_id": 1406668, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/T4b1f.jpg?s=128&g=1", "display_name": "Dave M.", "link": "https://stackoverflow.com/users/1406668/dave-m"}, "edited": false, "score": 0, "creation_date": 1502223113, "post_id": 45575808, "comment_id": 78113924, "body": "@DaveM. I&#39;m not surprised, thanks for the input. For now, i did just write out arrays by hand but that makes it a bit hard to modify between different devices."}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1502223185, "post_id": 45575808, "comment_id": 78113960, "body": "@interjay what part is compiler specific? (besides the __flash obviously)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502223210, "post_id": 45575808, "comment_id": 78113971, "body": "You&#39;re on a very sticky wicket.  You were accidentally using a GCC extension in your PoC, and when you need to port to another compiler which doesn&#39;t support the same extension, you are in difficulties.  It is very important to know when you&#39;re using extensions so you can make an informed estimate of the risk involved.  GCC is <i>very</i> bad about letting you know when you&#39;re using extensions (you have to tell it to be <code>-pedantic</code>, and even then \u2026).  FAM technology pretty much assumes dynamic memory allocation.  Are your strings \u2014 the FAM bit \u2014 limited in size?  Can you simply allocate 256 bytes?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502223282, "post_id": 45575808, "comment_id": 78113998, "body": "The part of your code that is compiler specific is the allocation of <code>manufacturer_string</code> without using dynamic memory allocation."}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502223476, "post_id": 45575808, "comment_id": 78114110, "body": "@JonathanLeffler thanks, I had no idea. I actually had pedantic on, but don&#39;t remember any warnings. Maybe I just missed them somehow. I am pretty memory limited, I am just unit testing right now but eventually, it needs to fit into a pretty small bootloader. Allocating some fixed size (probably not 256) and documenting the limitation is probably my best bet if I can spare the room later on."}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502223751, "post_id": 45575808, "comment_id": 78114243, "body": "@JonathanLeffler also... sorry but you lost me on some of the acronyms. What is PoC and FAM? I am trying to read more about this and I am mostly getting results about a mail service in Hawaii which I presume is not what you meant :). Again thanks for explaining, I try to keep away from compiler specific stuff so it is good to know."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502223790, "post_id": 45575808, "comment_id": 78114264, "body": "Use <code>-Werror</code> as well; that makes sure you don&#39;t compile with any warnings (it converts any warning into an error that prevents the compilation completing).  (Acronyms: PoC = Proof of Concept; FAM = flexible array member)  I tried to get your code compiling on a Mac \u2014 the wide string literal caused grief &quot;error: wide character array initialized from incompatible wide string&quot;.  I didn&#39;t get to the point of being pedantic."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502225704, "post_id": 45575808, "comment_id": 78115198, "body": "I got sidetracked by some work \u2014 it happens occasionally.  I&#39;ve got an error: <code>usb97.c:14:22: error: initialization of a flexible array member [-Werror=pedantic]</code> (error because I used <code>-Werror</code>; it would be a warning without that).  I&#39;m using GCC 7.1.0 on macOS Sierra 10.12.6, if it matters (<code>gcc -O3 -g -std=c11 -Wall -Wextra -Werror -pedantic -c usb97.c</code>).  Newer versions of GCC have vastly improved error reporting over older versions."}], "answers": [{"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502222982, "post_id": 45577070, "comment_id": 78113857, "body": "the second approach is wrong as the descriptor which will be transfered over the USB has to have this string as part of the struct, not the pointer to the literal."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502223296, "post_id": 45577070, "comment_id": 78114010, "body": "@PeterJ: right, the second approach will not work if one needs continuous memory. I also assumed that this should be the case, but since the OP did not state this as requirement explicitly, for completeness, I added this approach, too. And actually as the second one because I believe that the first one is more appropriate, too. Will leave a note in the answer..."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502223403, "post_id": 45577070, "comment_id": 78114074, "body": "the name of the defined type is self explanatory I think :)"}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "edited": false, "score": 1, "creation_date": 1502223970, "post_id": 45577070, "comment_id": 78114358, "body": "I think approach #1 is the best approach, thanks. I am size limited but I think I could spare a few extra bytes and then just document the length limitation of product names, etc."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "edited": false, "score": 0, "creation_date": 1502224012, "post_id": 45577070, "comment_id": 78114377, "body": "@CrustyAuklet I think that macros are best here - no overhead. I will pot in the answer as it is difficult to list in the comment"}, {"owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502224663, "post_id": 45577070, "comment_id": 78114725, "body": "@PeterJ your macro answer was interesting but it seems to have disappeared."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "edited": false, "score": 0, "creation_date": 1502225059, "post_id": 45577070, "comment_id": 78114912, "body": "@CrustyAuklet I have done a silly mistake, an instea of edit I have pressed delete. But undeleted it. But leave chosen answer on  Stephan Lechner answer please."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502225349, "post_id": 45577070, "comment_id": 78115048, "body": "@Stephan Lechner not intentional points stealing - sorry - . Asked OP to do not choose my one."}, {"owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502225553, "post_id": 45577070, "comment_id": 78115125, "body": "@PeterJ: Don&#39;t mind! The answer that meets OP&#39;s requirements best shall be accepted. That&#39;s SO :-)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502225627, "post_id": 45577070, "comment_id": 78115165, "body": "@Stephan Lechner Not if I have advertised it in my comment in your answer :)."}], "tags": [], "owner": {"reputation": 33645, "user_id": 2630032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hQF09.jpg?s=128&g=1", "display_name": "Stephan Lechner", "link": "https://stackoverflow.com/users/2630032/stephan-lechner"}, "is_accepted": true, "score": 3, "last_activity_date": 1502223422, "last_edit_date": 1502223422, "creation_date": 1502222263, "answer_id": 45577070, "question_id": 45575808, "link": "https://stackoverflow.com/questions/45575808/alternative-to-flexible-array-member-without-dynamic-memory-allocation/45577070#45577070", "title": "Alternative to flexible array member, without dynamic memory allocation", "body": "<p>I see no way to achieve a struct with flexible size without the use of dynamic memory allocation in a portable way.</p>\n\n<p>However, one of the following two approaches with a fixed size struct might work for you as well:</p>\n\n<ol>\n<li>Define the struct such that <code>bstring</code> is an array of fixed size; If you have only one <code>STR_PRODUCT</code> in your program, you can use it's size. If you have more instances of the struct, define the array with the maximum size you want to allow. </li>\n<li>Define the struct with <code>bstring</code> being a pointer; You can still initialize it with a pointer to a string literal. Note that an object will then not contain all the information in a continuous memory block. If you require continuous memory containing all the information, this approach 2 will not work.</li>\n</ol>\n\n<p>See the following program which demonstrates both approaches:</p>\n\n<pre><code>#define STR_PRODUCT_1   L\"My Cool Product\"\n#define STR_PRODUCT_2   L\"Another Cool Product\"\n#define MAX_PRODUCT_STR  \"012345678901234567890\"\n\n// Approach 1:\ntypedef struct {\n    uint8_t  bLength;\n    uint8_t  bDescriptorType;\n    wchar_t  bString[sizeof(MAX_PRODUCT_STR)];\n} USB_StringDescriptor;\n\nconst USB_StringDescriptor manufacturer_string = {\n    sizeof(STR_PRODUCT_1)+2,\n    0x03,\n    STR_PRODUCT_1\n};\n\nconst USB_StringDescriptor manufacturer_string2 = {\n    sizeof(STR_PRODUCT_2)+2,\n    0x03,\n    STR_PRODUCT_2\n};\n\n// Approach 2:\ntypedef struct {\n    uint8_t  bLength;\n    uint8_t  bDescriptorType;\n    wchar_t  *bString;\n} USB_StringDescriptor_V2;\n\nconst USB_StringDescriptor_V2 manufacturer_string_v2 = {\n    sizeof(STR_PRODUCT_1)+2,\n    0x03,\n    STR_PRODUCT_1\n};\n\nconst USB_StringDescriptor_V2 manufacturer_string_v2_2 = {\n    sizeof(STR_PRODUCT_2)+2,\n    0x03,\n    STR_PRODUCT_2\n};\n\nint main() {\n    wprintf(L\"1: %ls\\n\",manufacturer_string.bString);\n    wprintf(L\"2: %ls\\n\",manufacturer_string2.bString);\n\n    wprintf(L\"1 ptr: %ls\\n\",manufacturer_string_v2.bString);\n    wprintf(L\"2 ptr: %ls\\n\",manufacturer_string_v2_2.bString);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 305, "user_id": 875707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5230fc7d833c19c0a94f4560d9990b3a?s=128&d=identicon&r=PG", "display_name": "Alexander Pruss", "link": "https://stackoverflow.com/users/875707/alexander-pruss"}, "edited": false, "score": 0, "creation_date": 1577888851, "post_id": 45577447, "comment_id": 105275148, "body": "The problem is that bString will then be allocated two extra bytes, for the null terminator in STR_PRODUCT."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502225992, "last_edit_date": 1502225992, "creation_date": 1502223967, "answer_id": 45577447, "question_id": 45575808, "link": "https://stackoverflow.com/questions/45575808/alternative-to-flexible-array-member-without-dynamic-memory-allocation/45577447#45577447", "title": "Alternative to flexible array member, without dynamic memory allocation", "body": "<p>In my opinion if your compiler does not support this type of initialisations the best way is to use macros (I am not the fan of long multiline macros but if there is no other way)</p>\n\n<pre><code>#define STR_PRODUCT  L\"My Cool Product\"\n\n#define USB_desc(name, bL, bD, bS) struct { \\\n    uint8_t  bLength; \\\n    uint8_t  bDescriptorType;  \\\n    wchar_t  bString[]; \\\n} name = {bL, bD, bS}\n\nUSB_desc(manufacturer_string, sizeof(STR_PRODUCT) + 2, 3, STR_PRODUCT);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502225742, "post_id": 45577745, "comment_id": 78115215, "body": "IMO you took a sledgehammer to crack a nut. How many descriptors you have in one device? One, two, maybe three or four as maximum. It does not have to be portable or platform independent :)"}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502226043, "post_id": 45577745, "comment_id": 78115340, "body": "@PeterJ: No, not really; I love my Teensy microcontrollers, which have a native USB interface (no USB-to-serial bridge), so they can become any kind of USB device I want. I also like bare metal coding on them (non-Arduino environment). While the GNU C tools do allow one to construct all the constants needed, it actually is easier to let an external program construct the C sources for those constants. That way, you can easily inspect and verify they are correct (unit testing), while keeping maintenance easy. So, it only <i>looks</i> like a sledgehammer! :)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502226314, "post_id": 45577745, "comment_id": 78115450, "body": "I do almost only the bare metal programming. And your way has a very important drawback. It is very difficult to experiment. Everytime you need to build C files with constant definitions instead of changing one or two lines. @Nominal Animal it is not a problem of course if you are so good that you do need not change anything or test - and your descriptors are correct form the beginning. I am not -  I do mistakes and often need to change something."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502226495, "post_id": 45577745, "comment_id": 78115531, "body": "@PeterJ: I bet I make more errors than you do! That exactly was the reason I included the Makefile snippet. That way, whenever I change anything -- even just the string contents in the <code>constants.in</code> file, <code>make</code> will do all the head-scratching for me, and rebuild and recompile all affected files. (I do need to include a list of generated header files in prerequisites for each target, but at least GNU Make has all the string manipulation commands to make that trivial.)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": false, "score": 2, "last_activity_date": 1502225172, "creation_date": 1502225172, "answer_id": 45577745, "question_id": 45575808, "link": "https://stackoverflow.com/questions/45575808/alternative-to-flexible-array-member-without-dynamic-memory-allocation/45577745#45577745", "title": "Alternative to flexible array member, without dynamic memory allocation", "body": "<p>Other than <a href=\"https://stackoverflow.com/a/45577070/1475978\">Stephen Lechner's answer</a>, you can use an external program to generate the string descriptors (and other similar programs), outputting a C source file to be included by the implementation. This makes sense only if you have lots of constants needing massaging.</p>\n\n<p>Note that rather than a structure, you can use an array of <code>uint16_t</code> for USB string descriptors. (All you need to know is the byte order on the architecture, so that the length-in-bytes byte is the first byte in memory, too: it is the high byte for big-endian architectures, and the low byte for little-endian architectures.)</p>\n\n<p>As an example, consider the following awk script, <strong>constants.awk</strong>:</p>\n\n<pre><code>#!/usr/bin/awk -f\nBEGIN {\n    # 0 = little endian, least significant byte first\n    # 1 = big endian, most significant byte first\n    BYTEORDER = 1\n\n    RS = \"[\\t\\v\\f ]*(\\r\\n|\\n\\r|\\r|\\n)[\\t\\v\\f ]*\"\n    FS = \"[\\t\\v\\f ]+\"\n\n    split(\"\", codepoint)\n    for (i = 1; i &lt; 128; i++)\n        codepoint[sprintf(\"%c\", i)] = i\n    # Note: Could add unicode code points U+00A0 to U+FFFF\n    #       to codepoint[] array.\n\n    printf \"#ifndef   CONSTANTS_H\\n\"\n    printf \"#define   CONSTANTS_H\\n\"\n    printf \"\\n\"\n    printf \"/* Do not edit this file; edit constants.in instead.\\n\"\n    printf \"   This file is automatically generated by constants.awk.\\n\"\n    printf \"*/\\n\\n\"\n}\n\n$1 == \"usb_string_descriptor\" &amp;&amp; NF &gt;= 3 {\n    name = $2\n    value = $0\n    sub(/^[^\"]*\"/, \"\", value)   # Remove everything before first \"\n    sub(/\"[^\"]*$/, \"\", value)   # Remove everything after last \"\n    valuelen = length(value)\n    type = 3\n\n    printf \"#define  %s_size  %d\\n\", name, 2*valuelen + 2\n    printf \"#define  %s_type  %d\\n\", name, type\n    printf \"#define  %s_len   %d\\n\", name, valuelen\n    printf \"static const uint16_t %s[%d] = {\\n\", name, valuelen + 1\n    printf \"    /* \\\"%s\\\" */\\n\", value\n    if (BYTEORDER == 1)\n        printf \"    0x%02x%02x, /* length = %d bytes, type = 0x%02x */\", 2*valuelen + 2, type, 2*valuelen + 2, type\n    else\n        printf \"    0x%02x%02x, /* length = %d bytes, type = 0x%02x */\", type, 2*valuelen + 2, 2*valuelen + 2, type\n    for (i = 1; i &lt;= valuelen; i++) {\n        if ((i % 8) == 1)\n            printf \"\\n    \"\n        printf \"0x%04x, \", codepoint[substr(value, i, 1)]\n    }\n    printf \"\\n};\\n\\n\"\n}\n\nEND {\n    printf \"#endif /* CONSTANTS_H */\\n\"\n}\n</code></pre>\n\n<p>Let's say you have a file, say <code>constants.in</code>, describing some of the constants the above scriptlet should define:</p>\n\n<pre><code>usb_string_descriptor manufacturer_string_1 \"My Cool Product\"\nusb_string_descriptor manufacturer_string_2 \"My Other Cool Product\"\n</code></pre>\n\n<p>Have your build machinery run e.g. <code>awk -f constants.awk constants.in &gt; constants.h</code>. If you use Makefiles, then</p>\n\n<pre><code>AWK := awk\n\nconstants.h: constants.in\n    $(AWK) -f constants.h constants.in &gt; constants.h\n</code></pre>\n\n<p>should do the trick. (It even causes the <code>constant.h</code> header file to be regenerated, if you edit the <code>constants.in</code></p>\n\n<p>In the actual C source file implementation, you just <code>#include \"constants.h\"</code>.</p>\n\n<p>The above will output</p>\n\n<pre><code>#ifndef   CONSTANTS_H\n#define   CONSTANTS_H\n\n/* Do not edit this file; edit constants.in instead.\n   This file is automatically generated by constants.awk.\n*/\n\n#define  manufacturer_string_1_size  32\n#define  manufacturer_string_1_type  3\n#define  manufacturer_string_1_len   15\nstatic const uint16_t manufacturer_string_1[16] = {\n    /* \"My Cool Product\" */\n    0x2003, /* length = 32 bytes, type = 0x03 */\n    0x004d, 0x0079, 0x0020, 0x0043, 0x006f, 0x006f, 0x006c, 0x0020, \n    0x0050, 0x0072, 0x006f, 0x0064, 0x0075, 0x0063, 0x0074, \n};\n\n#define  manufacturer_string_2_size  44\n#define  manufacturer_string_2_type  3\n#define  manufacturer_string_2_len   21\nstatic const uint16_t manufacturer_string_2[22] = {\n    /* \"My Other Cool Product\" */\n    0x2c03, /* length = 44 bytes, type = 0x03 */\n    0x004d, 0x0079, 0x0020, 0x004f, 0x0074, 0x0068, 0x0065, 0x0072, \n    0x0020, 0x0043, 0x006f, 0x006f, 0x006c, 0x0020, 0x0050, 0x0072, \n    0x006f, 0x0064, 0x0075, 0x0063, 0x0074, \n};\n\n#endif /* CONSTANTS_H */\n</code></pre>\n\n<p>(Note: I seem to recall the USB String Descriptors do not need a terminating NUL character (0). I might recall wrong.)</p>\n\n<p>I used awk, because it is available for all platforms in various flavors -- not just GNU awk, but nawk, mawk, and <a href=\"https://en.wikipedia.org/wiki/Awk#Versions_and_implementations\" rel=\"nofollow noreferrer\">many more</a>. You'll want to use a scripting language that yields an easy-to-maintain script; the above version is intended to be extensible to other types besides USB String Descriptors.</p>\n\n<p>I suspect that a Python script may be easier to maintain in the long term, as it is wildly more popular than awk (or Perl, another typical scripting language used for this kind of preprocessing). Plus, Python has the <a href=\"https://docs.python.org/3/library/functions.html#ord\" rel=\"nofollow noreferrer\"><code>ord()</code></a> built-in function you can use, and allow you to use non-ASCII Unicode characters in your USB String Descriptors.</p>\n"}], "owner": {"reputation": 160, "user_id": 5933269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dVvVs.jpg?s=128&g=1", "display_name": "CrustyAuklet", "link": "https://stackoverflow.com/users/5933269/crustyauklet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 554, "favorite_count": 0, "accepted_answer_id": 45577070, "answer_count": 3, "score": 0, "last_activity_date": 1502225992, "creation_date": 1502217744, "last_edit_date": 1502222131, "question_id": 45575808, "link": "https://stackoverflow.com/questions/45575808/alternative-to-flexible-array-member-without-dynamic-memory-allocation", "title": "Alternative to flexible array member, without dynamic memory allocation", "body": "<p>I was using a flexible array member to define a USB-String descriptor:</p>\n\n<pre><code>// defined\ntypedef struct {\n    uint8_t  bLength;\n    uint8_t  bDescriptorType;\n    uint16_t bString[];\n} ATTR_PACKED USB_StringDescriptor;\n\n// declared\n#define STR_PRODUCT  L\"My Cool Product\"\nconst USB_StringDescriptor __flash manufacturer_string = {\n    sizeof(STR_PRODUCT)+2,\n    USB_DTYPE_String,       // 0x03\n    STR_PRODUCT\n};\n</code></pre>\n\n<p>This worked great and allowed the actual string constants to be defined elsewhere for easy changes between projects. But I can no longer use flexible array members because of compiler restrictions. I would like to avoid hardcoding a char array, I basically just need to tack two bytes to the front of a wide character array. Is there any clever way of declaring an array or a pre-processor macro that could accomplish this?</p>\n"}, {"tags": ["c", "data-structures", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "edited": false, "score": 1, "creation_date": 1502217257, "post_id": 45575631, "comment_id": 78110796, "body": "So many questions available, search!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1502217275, "post_id": 45575631, "comment_id": 78110807, "body": "Aside - syntax tip, change <code>(*newNode).data = data;</code> etc. to <code>newNode-&gt;data = data;</code>"}, {"owner": {"reputation": 6172, "user_id": 8254699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b91384172702e29895e620c2b0924ef3?s=128&d=identicon&r=PG&f=1", "display_name": "kocica", "link": "https://stackoverflow.com/users/8254699/kocica"}, "edited": false, "score": 1, "creation_date": 1502217401, "post_id": 45575631, "comment_id": 78110877, "body": "Dont retype return value of <code>malloc</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502217456, "post_id": 45575631, "comment_id": 78110906, "body": "<code>struct list { struct node *head, *tail } aList = {NULL, NULL};append(3, &amp;aList);</code> instead of <code>struct node *head = NULL; struct node *tail = NULL; append(3,head,tail);</code>"}, {"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502217585, "post_id": 45575631, "comment_id": 78110969, "body": "@WeatherVane Yeah thats what I had in the beginning. Just tried this to see if maybe that works"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 2, "creation_date": 1502219004, "post_id": 45575631, "comment_id": 78111680, "body": "There must be a dup for this.  Likely, thousands:("}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1502219516, "post_id": 45575631, "comment_id": 78111943, "body": "You really shouldn&#39;t post a lot of code and then ask people to &quot;find the mistake somewhere in the implementation&quot;. Indicators like &quot;something is not right with my C code&quot; and &quot;I&#39;m not getting the output&quot; don&#39;t narrow it down. Have you used the debugger or other debugging techniques and narrowed it down?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1502305619, "post_id": 45575631, "comment_id": 78157082, "body": "<a href=\"http://ideone.com/nEClB6\" rel=\"nofollow noreferrer\">Combine head and tail in a structure</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "is_accepted": true, "score": 3, "last_activity_date": 1502218062, "creation_date": 1502218062, "answer_id": 45575896, "question_id": 45575631, "link": "https://stackoverflow.com/questions/45575631/linkedlist-implementation-in-c/45575896#45575896", "title": "LinkedList implementation in C", "body": "<p>Your <code>head</code> and <code>tail</code> pointers aren't getting set as you expect.  Everything in <code>c</code> is pass by value, so essentially all arguments passed to functions are local variables that have scope only within that function.  When you pass <code>head</code> and <code>tail</code> to <code>append</code>, local copies of each are made. You make assignments to <code>head</code> and <code>tail</code>, but these assignments are lost once the function exits and the variables go out of scope.  You must pass the address of these pointers to <code>append</code> and dereference them there if you want the assignments to \"stick\" outside of the function.</p>\n\n<pre><code>void append(int data, struct node **head, struct node **tail)\n{\n  struct node *newNode = ((struct node*)malloc(sizeof(struct node)));   \n  (*newNode).data = data;\n  (*newNode).next = NULL;\n  if (head == NULL)\n  {\n    *head = newNode;  // dereference head here so this assignment will persist outside of this function\n    *tail = newNode;\n  }else{\n    (*tail) -&gt; next = newNode;\n    *tail = newNode;\n  }\n}\n\n.....\n\nint main(void)\n{\n  printf(\"Hey linked list \\n\");\n  struct node *head = NULL;\n  struct node *tail = NULL;\n  /* code */\n  append(3,&amp;head,&amp;tail);\n  append(4,&amp;head,&amp;tail);\n  append(5,&amp;head,&amp;tail);\n  traverse(head);\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "edited": false, "score": 0, "creation_date": 1502218981, "post_id": 45575926, "comment_id": 78111661, "body": "thank you man. that helps. coming from java and python , pointers in C is tough to understand"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 3, "last_activity_date": 1502218138, "creation_date": 1502218138, "answer_id": 45575926, "question_id": 45575631, "link": "https://stackoverflow.com/questions/45575631/linkedlist-implementation-in-c/45575926#45575926", "title": "LinkedList implementation in C", "body": "<p>Your code only passes <em>copies</em> of <code>head</code> and <code>tail</code> pointers so the caller's values do not get updated. You need double star arguments in <code>append</code>, and to pass their <em>address</em> so they can be updated, like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node\n{\n    int data;\n    struct node *next;\n};\n\nvoid append(int data, struct node **head, struct node **tail){\n    struct node *newNode = malloc(sizeof(struct node)); \n    newNode-&gt;data = data;\n    newNode-&gt;next = NULL;\n    if (*head == NULL)\n    {\n        *head = newNode;\n        *tail = newNode;\n    }else{\n        (*tail)-&gt;next = newNode;\n        *tail = newNode;\n    }\n}\n\nvoid traverse(struct node *head){\n    struct node *temp = head;\n    while(temp != NULL){\n        printf(\"%d\",(*temp).data);\n        temp = temp-&gt;next;\n    }\n}\n\nint main(void)\n{\n    printf(\"Hey linked list \\n\");\n    struct node *head = NULL;\n    struct node *tail = NULL;\n    append(3, &amp;head, &amp;tail);\n    append(4, &amp;head, &amp;tail);\n    append(5, &amp;head, &amp;tail);\n    traverse(head);\n    return 0;\n}\n</code></pre>\n\n<p>Program output:</p>\n\n<pre>\nHey linked list\n345\n</pre>\n"}], "owner": {"reputation": 1599, "user_id": 7397730, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh6.googleusercontent.com/-ysI7jDMeZ80/AAAAAAAAAAI/AAAAAAAAAjM/kNmyThJcrKc/photo.jpg?sz=128", "display_name": "Sriram R", "link": "https://stackoverflow.com/users/7397730/sriram-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 45575896, "answer_count": 2, "score": -4, "last_activity_date": 1502218138, "creation_date": 1502217127, "last_edit_date": 1502217687, "question_id": 45575631, "link": "https://stackoverflow.com/questions/45575631/linkedlist-implementation-in-c", "title": "LinkedList implementation in C", "body": "<p>So I was starting to learn data structures and I successfully implemented LinkedList in Java and Python with ease. But something is not right with my C code and I am not getting the output. This pointer concept is really bugging me and I would appreciate it if someone could tell me my mistake in this implementation.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct node\n{\n  int data;\n  struct node *next;\n};\n\nvoid append(int data, struct node *head, struct node *tail){\n  struct node *newNode = ((struct node*)malloc(sizeof(struct node)));   \n  (*newNode).data = data;\n  (*newNode).next = NULL;\n  if (head == NULL)\n  {\n    head = newNode;\n    tail = newNode;\n  }else{\n    tail -&gt; next = newNode;\n    tail = newNode;\n  }\n\n}\n\nvoid traverse(struct node *head){\n  struct node *temp = head;\n  while(temp != NULL){\n    printf(\"%d\",(*temp).data);\n    temp = temp-&gt;next;\n  }\n}\n\n\nint main()\n{\n  printf(\"Hey linked list \\n\");\n  struct node *head = NULL;\n  struct node *tail = NULL;\n  /* code */\n  append(3,head,tail);\n  append(4,head,tail);\n  append(5,head,tail);\n  traverse(head);\n  return 0;\n}\n</code></pre>\n\n<p>BTW , like head always points to the first node in the linked list , I have a pointer tail which always points to the last node in the linked list. This way appending data to the list is easy and is constant time.</p>\n\n<p>Thank you guys and I would appreciate an easy to understand answer..</p>\n"}, {"tags": ["c++", "c", "opencl", "opencl-c"], "answers": [{"tags": [], "owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1502274261, "last_edit_date": 1502274261, "creation_date": 1502273815, "answer_id": 45587842, "question_id": 45575072, "link": "https://stackoverflow.com/questions/45575072/opencl-copy-character-from-global-to-local-memory/45587842#45587842", "title": "OpenCL copy character from global to local memory", "body": "<p>OpenCL by default does not allow single-byte access in kernels: memory access needs to be in multiples of 4 bytes, aligned to 4-byte boundaries. If your implementation supports it, you can enable byte-wise memory accesses. This involves the <a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/cl_khr_byte_addressable_store.html\" rel=\"nofollow noreferrer\">cl_khr_byte_addressable_store extension</a>, which you need to check for and explicitly enable in your kernel source. Give that a try and see if it solves your problem.</p>\n\n<p>To use <code>async_work_group_copy</code>, try something like this:</p>\n\n<pre><code>#define LOCAL_MESSAGE_SIZE 64 // or some other suitable size for your workgroup\n__local char local_message[LOCAL_MESSAGE_SIZE];\nevent_t local_message_ready = async_work_group_copy(local_message, message, LOCAL_MESSAGE_SIZE, 0);\n// ...\n\n// Just before you need to use local_message's content:\nwait_group_events(1, &amp;local_message_ready);\n// Use local_message from here onwards\n</code></pre>\n\n<p>Note that <code>async_work_group_copy</code> is not required; you can access global memory directly. Which will be faster depends on your kernel, OpenCL implementation, and hardware.</p>\n\n<p>Another option (the only option if your implementation/hardware do not support cl_khr_byte_addressable_store) is to fetch your data in chunks of at least 4 bytes. Declare your <code>message</code> as a <code>__global uint*</code> and unpack the bytes by shifting and masking:</p>\n\n<pre><code>uint word = message[i];\nchar byte0 = (word &amp; 0xff);\nchar byte1 = ((word &gt;&gt; 8) &amp; 0xff);\nchar byte2 = ((word &gt;&gt; 16) &amp; 0xff);\nchar byte3 = ((word &gt;&gt; 24) &amp; 0xff);\n// use byte0..byte3 in your algorithm\n</code></pre>\n\n<p>Depending on implementation, hardware, etc. you may find this to be faster than bytewise access. (You may want to <a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/clGetDeviceInfo.html\" rel=\"nofollow noreferrer\">check if you need to reverse the unpacking by reading the <code>CL_DEVICE_ENDIAN_LITTLE</code> property using <code>clGetDeviceInfo</code></a> if you're not sure if all your deployment platforms will be little-endian.)</p>\n"}], "owner": {"reputation": 2511, "user_id": 3936476, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/kjSSo.png?s=128&g=1", "display_name": "ventaquil", "link": "https://stackoverflow.com/users/3936476/ventaquil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1502274261, "creation_date": 1502215136, "question_id": 45575072, "link": "https://stackoverflow.com/questions/45575072/opencl-copy-character-from-global-to-local-memory", "title": "OpenCL copy character from global to local memory", "body": "<p>I'm implementing sha512 in OpenCL technology. I have simple definition of kernel function</p>\n\n<pre><code>__kernel void _sha512(__global char *message, const uint length, __global char *hash);\n</code></pre>\n\n<p>On host I have implemented and successfully tested implementation of sha512 algorithm.</p>\n\n<p>I have a problem with copy data from <code>message</code> array to temporary variable called <code>character</code>.</p>\n\n<pre><code>char character = message[i];\n</code></pre>\n\n<p>Where <code>i</code> is a loop variable - in range from 0 to message's size.</p>\n\n<p>When I tried to run my program there I got this errors</p>\n\n<pre><code>0x00007FFD9FA03D54 (0x0000000010CD0F88 0x0000000010CD0F88 0x0000000010BAEE88 0x000000001A2942A0), nvvmCompilerProperty() + 0x26174 bytes(s)\n...\n0x00007FFDDFA70D51 (0x0000000000000000 0x0000000000000000 0x0000000000000000 0x0000000000000000), RtlUserThreadStart() + 0x21 bytes(s)\n0x00007FFDDFA70D51 (0x0000000000000000 0x0000000000000000 0x0000000000000000 0x0000000000000000), RtlUserThreadStart() + 0x21 bytes(s)\n</code></pre>\n\n<p>I readed about <a href=\"https://www.khronos.org/registry/OpenCL/sdk/1.0/docs/man/xhtml/async_work_group_copy.html\" rel=\"nofollow noreferrer\">async_work_group_copy()</a> but I can't understand how to use it - in docs I can't found any example code.</p>\n\n<p>I have tried with <code>char character = (__private char) message[i];</code> but it's not working too.</p>\n\n<p>I don't understand how to pass last parameter into <code>async_work_group_copy()</code> and how to use it to copy data from <code>__global</code> memory into <code>__private</code> memory.</p>\n"}, {"tags": ["c", "io", "seek"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1502215076, "post_id": 45575029, "comment_id": 78109572, "body": "As expensive as adding two numbers..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 3, "creation_date": 1502215113, "post_id": 45575029, "comment_id": 78109595, "body": "well, it <i>might</i> depend on the filesystem as well."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502215155, "post_id": 45575029, "comment_id": 78109621, "body": "Try it! In a loop open the file, start a timer, seek to the end, stop the timer and save the elapsed time, and close the file. Do the loop a million times. Check the accumulated time and the average time for the seek."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1502215177, "post_id": 45575029, "comment_id": 78109638, "body": "Ask yourself another question: What drawbacks does a TOC at the <b>end</b> of the file have? One thing that immediately comes to mind is you can&#39;t support streaming this file over the net, because you need the <b>whole</b> file to make sense of it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502215360, "post_id": 45575029, "comment_id": 78109747, "body": "why are you working with system level functions instead of C buffered IO?"}, {"owner": {"reputation": 10784, "user_id": 620863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Mqgo9PO_taA/AAAAAAAAAAI/AAAAAAAAABM/8h3wY8pcFbg/photo.jpg?sz=128", "display_name": "Anne Quinn", "link": "https://stackoverflow.com/users/620863/anne-quinn"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502215569, "post_id": 45575029, "comment_id": 78109870, "body": "@SergeyA - I need access to +2gb files, and don&#39;t want to use _ftelli64() (seen a few cases of it giving slightly wrong addresses on SO, and I need it to map perfectly byte for byte) and I don&#39;t want to use a library.  Buffering reads and writes wasn&#39;t hard."}, {"owner": {"reputation": 10784, "user_id": 620863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Mqgo9PO_taA/AAAAAAAAAAI/AAAAAAAAABM/8h3wY8pcFbg/photo.jpg?sz=128", "display_name": "Anne Quinn", "link": "https://stackoverflow.com/users/620863/anne-quinn"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502215809, "post_id": 45575029, "comment_id": 78110011, "body": "@Someprogrammerdude - I profiled it and it doesn&#39;t appear to cost anything on my system, so that&#39;s a plus.  My main worry though is that this may not be the general case, since I use an SSD"}, {"owner": {"reputation": 468, "user_id": 4897973, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6456b100cee8d79866ebeac9a587eec?s=128&d=identicon&r=PG&f=1", "display_name": "beeselmane", "link": "https://stackoverflow.com/users/4897973/beeselmane"}, "edited": false, "score": 2, "creation_date": 1502215925, "post_id": 45575029, "comment_id": 78110073, "body": "@Anne Quinn it should theoretically be equivalent to calling <code>stat</code> on the file and then calling <code>lseek</code> with <code>st_size</code> on the open descriptor, so long as it&#39;s a normal file on a disk."}, {"owner": {"reputation": 468, "user_id": 4897973, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6456b100cee8d79866ebeac9a587eec?s=128&d=identicon&r=PG&f=1", "display_name": "beeselmane", "link": "https://stackoverflow.com/users/4897973/beeselmane"}, "edited": false, "score": 0, "creation_date": 1502216250, "post_id": 45575029, "comment_id": 78110234, "body": "@Anne Quinn Additionally, it may be useful to incrementally write the table of contents with <code>pwrite</code>, although I don&#39;t know if that will work in your specific case. (And I don&#39;t know if that&#39;s available on Windows)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 468, "user_id": 4897973, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f6456b100cee8d79866ebeac9a587eec?s=128&d=identicon&r=PG&f=1", "display_name": "beeselmane", "link": "https://stackoverflow.com/users/4897973/beeselmane"}, "edited": false, "score": 1, "creation_date": 1502217444, "post_id": 45575029, "comment_id": 78110899, "body": "@beeselmane <i>so long as it&#39;s a normal file on a disk</i> Indeed.  I can imagine an <a href=\"https://en.wikipedia.org/wiki/Hierarchical_storage_management\" rel=\"nofollow noreferrer\">HSM</a> where seeking to the end of a multi-gigabyte file forces the call to wait for the entire file to be read back from tape.  In that case, such a seek call could be horribly expensive."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502218984, "post_id": 45575029, "comment_id": 78111664, "body": "<i>Posting</i> the <i>code</i> is more clear than <i>describing</i> the code.  For better answers, post what you have done.  In particular, opening the file in binary mode can be less of a performance concern than opening in text mode."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502235896, "post_id": 45575029, "comment_id": 78118698, "body": "Seeking on FAT is in no way simple :D"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502238675, "post_id": 45575029, "comment_id": 78119271, "body": "On classic Unix systems, the seeking would be very inexpensive \u2014 the recorded offset in the data structure identified by the file descriptor would be changed to a new number without touching the disk at all.  The next access (read or write) might be considerably more expensive (though not dreadfully expensive even so \u2014 on classic Unix systems).  The rules on non-Unix file systems might be different. If you&#39;re using <code>lseeki64()</code>, you&#39;re presumably on Windows; heed Antti Haapala&#39;s <a href=\"https://stackoverflow.com/questions/45575029/is-seeking-expensive#comment78118698_45575029\">comment</a>"}], "owner": {"reputation": 10784, "user_id": 620863, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-Mqgo9PO_taA/AAAAAAAAAAI/AAAAAAAAABM/8h3wY8pcFbg/photo.jpg?sz=128", "display_name": "Anne Quinn", "link": "https://stackoverflow.com/users/620863/anne-quinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 188, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1502215240, "creation_date": 1502214999, "last_edit_date": 1502215240, "question_id": 45575029, "link": "https://stackoverflow.com/questions/45575029/is-seeking-with-lseeki64-to-the-end-of-a-file-expensive", "title": "Is seeking with _lseeki64() to the end of a file expensive?", "body": "<p>I'm writing an archive to file and it just so happens that writing the archive's table of contents last is the most simple.  </p>\n\n<p>For a large file (500 - 3000 mb), would seeking from the start of a file (after grabbing the 8byte address of the table) to the very end with <code>_lseeki64()</code> be expensive?  Or does seeking not care about distance all that much?</p>\n\n<p>(If it matters, I perform my own file buffering since I'm not using stdio.h, though I imagine the harddisk may be performing buffering of it's own as well.  Also, the file is opened with _O_SEQUENTIAL set, though I suspect that hint doesn't really do anything to be honest)</p>\n"}, {"tags": ["c", "stm32f4"], "comments": [{"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502217419, "post_id": 45574246, "comment_id": 78110889, "body": "I do know HAL as it is one of the most ridiculous libraries I have seen but, changing this flash location is not too smart."}, {"owner": {"reputation": 3908, "user_id": 1398841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s8gQQ.png?s=128&g=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/1398841/phoenix"}, "edited": false, "score": 0, "creation_date": 1537818317, "post_id": 45574246, "comment_id": 91913994, "body": "See also <a href=\"https://stackoverflow.com/a/28505272/1398841\">Allocating memory in Flash for user data (STM32F4 HAL)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 301, "user_id": 3967408, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/10035ce2ded5cecd8cc9443b30948a62?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M.", "link": "https://stackoverflow.com/users/3967408/alex-m"}, "edited": false, "score": 0, "creation_date": 1502217233, "post_id": 45574415, "comment_id": 78110780, "body": "I have put in the .NbSectors but now it wont run at all. (And yes I am a beginner)"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 301, "user_id": 3967408, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/10035ce2ded5cecd8cc9443b30948a62?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M.", "link": "https://stackoverflow.com/users/3967408/alex-m"}, "edited": false, "score": 0, "creation_date": 1502217284, "post_id": 45574415, "comment_id": 78110810, "body": "Because you erased first sector where actual program is for code execution. @AlexM. I told you, check last statement."}, {"owner": {"reputation": 301, "user_id": 3967408, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/10035ce2ded5cecd8cc9443b30948a62?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M.", "link": "https://stackoverflow.com/users/3967408/alex-m"}, "edited": false, "score": 0, "creation_date": 1502218186, "post_id": 45574415, "comment_id": 78111255, "body": "Haha, thats why I am a beginner. Now it works like a charm, thank you!"}, {"owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "reply_to_user": {"reputation": 301, "user_id": 3967408, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/10035ce2ded5cecd8cc9443b30948a62?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M.", "link": "https://stackoverflow.com/users/3967408/alex-m"}, "edited": false, "score": 0, "creation_date": 1502218353, "post_id": 45574415, "comment_id": 78111351, "body": "@AlexM. If it works for you, mark it as correct answer."}], "tags": [], "owner": {"reputation": 6676, "user_id": 3716664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fN14n.png?s=128&g=1", "display_name": "tilz0R", "link": "https://stackoverflow.com/users/3716664/tilz0r"}, "is_accepted": true, "score": 8, "last_activity_date": 1502218295, "last_edit_date": 1502218295, "creation_date": 1502212747, "answer_id": 45574415, "question_id": 45574246, "link": "https://stackoverflow.com/questions/45574246/hal-drivers-erase-read-write-flash-on-stm32f4-nucleo/45574415#45574415", "title": "HAL drivers erase/read/write flash on STM32F4 nucleo", "body": "<p>I will treat you now as begineer, but will say sorry if you are not.</p>\n\n<p>STM32 devices have flash on <code>0x08000000</code> and by erasing this sector, you did failure on startup because you erased actual part from where CPU loads instructions.</p>\n\n<p>When you tried to erase sectors, you did not specify <em>how many</em> sectors to erase.</p>\n\n<p>Reading of counters is wrong. Since you have <code>uint32_t</code> variable, you have to do 4-bytes between readings, something like:</p>\n\n<pre><code>counter2 = *(__IO uint32_t *)0x08000000;\ncounter3 = *(__IO uint32_t *)0x08000004;\ncounter4 = *(__IO uint32_t *)0x08000008;\n</code></pre>\n\n<p>Correct erasing is shown below.</p>\n\n<pre><code>EraseInitStruct.TypeErase = FLASH_TYPEERASE_SECTORS;\nEraseInitStruct.VoltageRange = FLASH_VOLTAGE_RANGE_3;\nEraseInitStruct.Sector = FLASH_SECTOR_0; //Specify sector number\nEraseInitStruct.NbSectors = 1; //This is also important!\nif(HAL_FLASHEx_Erase(&amp;EraseInitStruct, &amp;SectorError) != HAL_OK) {\n    //Erase error!\n}\n</code></pre>\n\n<p>So, find out how long is your program and do your operations in sector after your program.</p>\n\n<p>You can find example for <em>EraseProgram</em> in STM32CubeF4 package.</p>\n\n<p><code>STM32Cube_FW_F4_V1.16.0\\Projects\\STM324x9I_EVAL\\Examples\\FLASH\\FLASH_EraseProgram\\Src\\main.c</code></p>\n\n<p>Concept will work also on your nucleo, just make sure you set correct address for flash erasing.</p>\n"}, {"comments": [{"owner": {"reputation": 3908, "user_id": 1398841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s8gQQ.png?s=128&g=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/1398841/phoenix"}, "edited": false, "score": 0, "creation_date": 1536256855, "post_id": 45575814, "comment_id": 91369004, "body": "&quot;I suggest a ready made STM eeprom emulation example from the Cube&quot; Would you happen to have a link?"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 3908, "user_id": 1398841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s8gQQ.png?s=128&g=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/1398841/phoenix"}, "edited": false, "score": 0, "creation_date": 1536257015, "post_id": 45575814, "comment_id": 91369054, "body": "google your micto and you will have the link to the Cube on the STM website."}, {"owner": {"reputation": 3908, "user_id": 1398841, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/s8gQQ.png?s=128&g=1", "display_name": "phoenix", "link": "https://stackoverflow.com/users/1398841/phoenix"}, "edited": false, "score": 2, "creation_date": 1536257856, "post_id": 45575814, "comment_id": 91369441, "body": "For future readers, for the STM32F3 series, download the <a href=\"https://www.st.com/en/embedded-software/stm32cubef3.html\" rel=\"nofollow noreferrer\">STM32CubeF3</a> and look in <code>STM32303E_EVAL&#47;Applications&#47;EEPROM&#47;EEPROM_Emulation</code>."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1502217767, "creation_date": 1502217767, "answer_id": 45575814, "question_id": 45574246, "link": "https://stackoverflow.com/questions/45574246/hal-drivers-erase-read-write-flash-on-stm32f4-nucleo/45575814#45575814", "title": "HAL drivers erase/read/write flash on STM32F4 nucleo", "body": "<ol>\n<li><p>The best way is to create the new segment of flash in the linkescriptr and place the data there. It is the safest. </p></li>\n<li><p>If do not know linker scripts create a table of the one segment size, and place it at the end of the flash using your compiler directives.</p></li>\n<li><p>If you do not know both I suggest a ready made STM eeprom emulation example from the Cube</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11598117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbec1d02c2ca7a6cba1d23df8144e3bf?s=128&d=identicon&r=PG&f=1", "display_name": "0x4C70F", "link": "https://stackoverflow.com/users/11598117/0x4c70f"}, "is_accepted": false, "score": 0, "last_activity_date": 1559740344, "last_edit_date": 1559740344, "creation_date": 1559739953, "answer_id": 56461124, "question_id": 45574246, "link": "https://stackoverflow.com/questions/45574246/hal-drivers-erase-read-write-flash-on-stm32f4-nucleo/56461124#56461124", "title": "HAL drivers erase/read/write flash on STM32F4 nucleo", "body": "<p>Thanks to @phoenix!</p>\n\n<p>In Stm32CubF3 reference erasing flash works as follows:</p>\n\n<p>There is to mention how a memory page address is looking:</p>\n\n<pre><code>/* Base address of the Flash sectors */\n#define ADDR_FLASH_PAGE_0   ((uint32_t)0x08000000) /* Base @ of Page 0, 2 Kbytes */\n#define ADDR_FLASH_PAGE_1   ((uint32_t)0x08000800) /* Base @ of Page 1, 2 Kbytes */\n#define ADDR_FLASH_PAGE_2   ((uint32_t)0x08001000) /* Base @ of Page 2, 2 Kbytes */\n#define ADDR_FLASH_PAGE_3   ((uint32_t)0x08001800) /* Base @ of Page 3, 2 Kbytes */\n#define ADDR_FLASH_PAGE_4   ((uint32_t)0x08002000) /* Base @ of Page 4, 2 Kbytes */\n#define ADDR_FLASH_PAGE_5   ((uint32_t)0x08002800) /* Base @ of Page 5, 2 Kbytes */\n#define ADDR_FLASH_PAGE_6   ((uint32_t)0x08003000) /* Base @ of Page 6, 2 Kbytes */\n</code></pre>\n\n<p>So your minimal code looks as follows:</p>\n\n<p>I want to delete my application @ 0x08003000 --> FLASH_PAGE_6. The erasing is done 2kB wise:</p>\n\n<pre><code>/* EEPROM start address in Flash */\n#define EEPROM_START_ADDRESS  ((uint32_t)ADDR_FLASH_PAGE_32) /* EEPROM emulation start address */\n\n/* Pages 0 and 1 base and end addresses */\n#define PAGE0_BASE_ADDRESS    ((uint32_t)(EEPROM_START_ADDRESS + 0x0000))\n#define PAGE0_END_ADDRESS     ((uint32_t)(EEPROM_START_ADDRESS + (PAGE_SIZE - 1)))\n//#define PAGE0_ID               ADDR_FLASH_PAGE_32\n\n\n/* Clear flash flags */\nHAL_FLASH_Unlock();\n__HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP    |\n                       FLASH_FLAG_WRPERR |\n                       FLASH_FLAG_PGERR);\n\n\nuint32_t *flash_ptr = 0x8003000;\nuint32_t page_error = 0;\n\nHAL_StatusTypeDef  flashstatus;\nFLASH_EraseInitTypeDef s_eraseinit;\n/* Fill EraseInit structure*/\ns_eraseinit.TypeErase   = FLASH_TYPEERASE_PAGES;\ns_eraseinit.NbPages     = 1;             // seems to be 1 !!!!\n\n/* I want to delete 54kB in my flash --&gt; 52kB / 2kB (per erase) = 26 iterations\n   After erasing one page, increment page by 0x800 = 2048 byte = 2kB = pagesize */\nfor(int pageCount = 0;  pageCount &lt; 26; pageCount++){\n   s_eraseinit.PageAddress = ADDR_FLASH_PAGE_6 + pageCount * 0x800;\n   flashstatus = HAL_FLASHEx_Erase(&amp;s_eraseinit, &amp;page_error);\n\n}\n</code></pre>\n"}], "owner": {"reputation": 301, "user_id": 3967408, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/10035ce2ded5cecd8cc9443b30948a62?s=128&d=identicon&r=PG&f=1", "display_name": "Alex M.", "link": "https://stackoverflow.com/users/3967408/alex-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18727, "favorite_count": 1, "accepted_answer_id": 45574415, "answer_count": 3, "score": 0, "last_activity_date": 1564833542, "creation_date": 1502212116, "last_edit_date": 1564833542, "question_id": 45574246, "link": "https://stackoverflow.com/questions/45574246/hal-drivers-erase-read-write-flash-on-stm32f4-nucleo", "title": "HAL drivers erase/read/write flash on STM32F4 nucleo", "body": "<pre><code>uint32_t PAGEError = 0;\nFLASH_EraseInitTypeDef EraseInitStruct;\nEraseInitStruct.TypeErase   = FLASH_TYPEERASE_SECTORS ;\nEraseInitStruct.Sector   = FLASH_SECTOR_0;\nEraseInitStruct.VoltageRange = FLASH_VOLTAGE_RANGE_3;\n\nHAL_FLASH_Unlock();\n__HAL_FLASH_CLEAR_FLAG(FLASH_FLAG_EOP | FLASH_FLAG_OPERR | FLASH_FLAG_WRPERR | FLASH_FLAG_PGAERR | FLASH_FLAG_PGPERR | FLASH_FLAG_PGSERR);\nHAL_FLASHEx_Erase(&amp;EraseInitStruct, &amp;PAGEError);\nHAL_FLASH_Program(FLASH_TYPEPROGRAM_WORD, 0x08000000, counter)\nHAL_FLASH_Lock();\n\ncounter2 = *(__IO uint32_t *)0x08000000;\ncounter3 = *(__IO uint32_t *)0x08000001;\ncounter4 = *(__IO uint32_t *)0x08000002;\n\nsprintf(buf, \"%d\", counter2); //gets send to the OLED with I2C\nsprintf(buf2, \"%d\", counter3);\nsprintf(buf3, \"%d\", counter4);\n</code></pre>\n\n<p>I want to write the variable counter to the flash and then read it as <code>counter2</code>.\nThe first flash sector starts at <code>0x08000000</code>.</p>\n\n<p><code>counter2</code>, <code>3</code> and <code>4</code> are display trough an OLED screen. \nDisplaying <code>counter2</code> works and shows me the value of <code>counter-1</code>, but it works only once. If I write again to the flash nothing seems to happen. </p>\n\n<p><code>counter3</code> and <code>counter4</code> don't work at all.</p>\n\n<p>Output on the OLED when <code>counter=0x00000008</code> after I have erased the flash but not written anything:</p>\n\n<pre><code>counter2: 536873624\ncounter3: -652214262\ncounter4: 31006720\n</code></pre>\n\n<p>And after writting and ressetting:</p>\n\n<pre><code>counter2: 8\ncounter3: -654311424\ncounter4: 30998528\n</code></pre>\n\n<p>What is going on here? Can someone tell me why all variables change?\nDo I have to configure the linker?</p>\n"}, {"tags": ["c", "arrays", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1502212022, "post_id": 45574179, "comment_id": 78107895, "body": "You have type-names (aliases) that can be used just like other native types like <code>int</code>. Now, can you define an array of <code>int</code>? Then you can define an array of <code>TABLE_</code> as well."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502212029, "post_id": 45574179, "comment_id": 78107898, "body": "&quot;I want to create array of arrays if the type <code>TABLE_</code>&quot; did you mean &quot;of the type <code>TABLES</code>&quot;?"}, {"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502213003, "post_id": 45574179, "comment_id": 78108436, "body": "@Weather Vane: see: <code>TABLE_ radiation_insolation[7]</code> is array of type TABLE_. So I need array of arrays of type TABLE_"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502213248, "post_id": 45574179, "comment_id": 78108552, "body": "Then why did you mention <code>TABLES</code> at all?"}, {"owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "edited": false, "score": 0, "creation_date": 1502214134, "post_id": 45574179, "comment_id": 78109024, "body": "<code>TABLES tables</code> is a wrapper for the arrays. The code is there for context purposes."}], "answers": [{"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1502212119, "creation_date": 1502212119, "answer_id": 45574247, "question_id": 45574179, "link": "https://stackoverflow.com/questions/45574179/how-to-create-array-of-arrays-of-struct-in-c/45574247#45574247", "title": "How to create Array of arrays of struct in C?", "body": "<p>If you declare a pointer to an array, you need to allocate space for it (e.g. with <code>malloc()</code>) before you can assign to the elements. But there's no need to use a pointer, just declare an array and initialize it as you want.</p>\n\n<pre><code>TABLE_ *table_arrays[] = {\n    tables.radiation_insolation,\n    tables.radiation_radiation,\n    tables.winds,\n    tables.pressure,\n    tables.humidity,\n    tables.temperature\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "is_accepted": false, "score": 0, "last_activity_date": 1502661874, "creation_date": 1502661874, "answer_id": 45665303, "question_id": 45574179, "link": "https://stackoverflow.com/questions/45574179/how-to-create-array-of-arrays-of-struct-in-c/45665303#45665303", "title": "How to create Array of arrays of struct in C?", "body": "<p>Correctly this should be like this:</p>\n\n<pre><code>void initiate(TABLES * tables){\n  tables-&gt;radiation_insolation[0].num = 7; // initiate here\n}\nvoid processTables(TABLES * tables, TABLE_ * table_arrays[]){\n   // do something with the pointer to TABLES or with pointer to TABLES_ array\n}\n\nTABLES tables;\nTABLE_ * table_arrays[6];\ninitiate(&amp;tables);\ntable_arrays[0] = tables.radiation_insolation;\ntable_arrays[1] = tables.radiation_radiation;\ntable_arrays[2] = tables.winds;\ntable_arrays[3] = tables.pressure;\ntable_arrays[4] = tables.humidity;\ntable_arrays[5] = tables.temperature;\nprocessTables(&amp;tables, table_arrays);\n</code></pre>\n"}], "owner": {"reputation": 2996, "user_id": 1141649, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/e6c121a84f18d9512b03b8a21ecae2a7?s=128&d=identicon&r=PG", "display_name": "John Boe", "link": "https://stackoverflow.com/users/1141649/john-boe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 45574247, "answer_count": 2, "score": 0, "last_activity_date": 1502661874, "creation_date": 1502211908, "last_edit_date": 1502661524, "question_id": 45574179, "link": "https://stackoverflow.com/questions/45574179/how-to-create-array-of-arrays-of-struct-in-c", "title": "How to create Array of arrays of struct in C?", "body": "<p>I have declared these two structures:</p>\n\n<pre><code>typedef struct {\n    int skip_lines;\n    int num;\n    int i;\n    char filename[70];\n    char main_directory[16];\n    char submain_directory[100];\n} TABLE_;\n\ntypedef struct {\n    TABLE_ radiation_insolation[7];\n    TABLE_ radiation_radiation[5];\n    TABLE_ winds[9];\n    TABLE_ pressure[1];\n    TABLE_ humidity[1];\n    TABLE_ temperature[4];\n} TABLES;\n</code></pre>\n\n<p>In main function I want to create array of arrays of the type TABLE_.</p>\n\n<pre><code>TABLES tables; // this will be filled with data later\n\n// Now my pseudo-code:\nTABLE_ ** table_arrays;\ntable_arrays[0] = tables.radiation_insolation;\ntable_arrays[1] = tables.radiation_radiation;\ntable_arrays[2] = tables.winds;\ntable_arrays[3] = tables.pressure;\ntable_arrays[4] = tables.humidity;\ntable_arrays[5] = tables.temperature;\n</code></pre>\n\n<p>What I want to do is that first element of table_arrays points to tables.radiation_insolation. The next element to tables.radiation_radiation and so on. I know the way I do it now is wrong, so I ask you how to do it correctly?</p>\n"}, {"tags": ["c", "arrays", "crash"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 9, "creation_date": 1502210662, "post_id": 45573810, "comment_id": 78107097, "body": "Undefined behavior is undefined.  In other words, anything can happen, including <i>appearing</i> to work."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1502210870, "post_id": 45573810, "comment_id": 78107206, "body": "are you sure that&#39;s where the return address is?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1502211499, "post_id": 45573810, "comment_id": 78107573, "body": "Code broke the rules and did not get caught - this time."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1502211601, "post_id": 45573810, "comment_id": 78107636, "body": "C does not stipulate under what the conditions the program will crash."}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1502211687, "post_id": 45573810, "comment_id": 78107690, "body": "In simple terms, you are not supposed to dereference / write beyond the end of space (array) that you own."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1502211776, "post_id": 45573810, "comment_id": 78107749, "body": "<a href=\"https://stackoverflow.com/q/44215510/2371524\">Somewhat related</a> (but <b>not</b> a dupe, showing it only to demonstrate it&#39;s not even a simple thing to have a <b>sure</b> crash, although it&#39;s very simple to have it accidentally ... Disclaimer: my own question)"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1502211847, "post_id": 45573810, "comment_id": 78107796, "body": "@babon OP knows that, it is not what was asked."}, {"owner": {"reputation": 15, "user_id": 6364693, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001481815409/picture?type=large", "display_name": "Tr\u01b0\u01a1ng V\u0103n H\u1ecdc", "link": "https://stackoverflow.com/users/6364693/tr%c6%b0%c6%a1ng-v%c4%83n-h%e1%bb%8dc"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1502212003, "post_id": 45573810, "comment_id": 78107883, "body": "@yano: according to this image <a href=\"https://upload.wikimedia.org/wikipedia/commons/thumb/1/1f/Call-stack-layout.svg/2000px-Call-stack-layout.svg.png\" rel=\"nofollow noreferrer\">upload.wikimedia.org/wikipedia/commons/thumb/1/1f/&hellip;</a> then I was wrong. Still, according to the pic, next to the cData(of main()) is the Crash&#39;s parameter. So if I want to reach the Crash address, I&#39;ll have to plus 260144641 since pointer takes 4 byte... Oh, I tried and successed to crash the app with cData[260144641] = 100;. Is my understanding correct?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 1, "creation_date": 1502212495, "post_id": 45573810, "comment_id": 78108149, "body": "@Tr\u01b0\u01a1ngV\u0103nH\u1ecdc I&#39;m certainly no expert, surely there&#39;s nothing <i>wrong</i> about that image. You&#39;ll have to look at the assembly to see what&#39;s happening; ABI for your system is probably also a factor. Perhaps there&#39;s more space being allocated than you expect, some other things could be getting pushed onto the stack. As already mentioned this is undefined behavior for <code>c</code>, so only the assembly code will tell you what&#39;s happening. <code>cData[bigNumber]</code> segfaults because you&#39;re accessing memory outside of your process space, not b/c you&#39;re overwriting the return address."}, {"owner": {"reputation": 3567, "user_id": 4116239, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ksElS.png?s=128&g=1", "display_name": "Kevin J. Chase", "link": "https://stackoverflow.com/users/4116239/kevin-j-chase"}, "edited": false, "score": 0, "creation_date": 1502218343, "post_id": 45573810, "comment_id": 78111349, "body": "You should <a href=\"https://stackoverflow.com/posts/45573810/edit\">edit</a> your question to include the details from your most recent comment.  They should be part of the question itself, not down here in the comments, where they won&#39;t be seen."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 6364693, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001481815409/picture?type=large", "display_name": "Tr\u01b0\u01a1ng V\u0103n H\u1ecdc", "link": "https://stackoverflow.com/users/6364693/tr%c6%b0%c6%a1ng-v%c4%83n-h%e1%bb%8dc"}, "edited": false, "score": 0, "creation_date": 1502216392, "post_id": 45574201, "comment_id": 78110316, "body": "I did and the app works fine. Maybe, the space next to cData[1](of main()) is space for Crash argument which is a pointer(4 bytes). So in order to reach the return address which locates next to the argumeng space, I&#39;ll have to skip the argument space via the array index which requires me to plus 128^4. That&#39;s just my guess"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 15, "user_id": 6364693, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001481815409/picture?type=large", "display_name": "Tr\u01b0\u01a1ng V\u0103n H\u1ecdc", "link": "https://stackoverflow.com/users/6364693/tr%c6%b0%c6%a1ng-v%c4%83n-h%e1%bb%8dc"}, "edited": false, "score": 0, "creation_date": 1502224567, "post_id": 45574201, "comment_id": 78114673, "body": "@Tr\u01b0\u01a1ngV\u0103nH\u1ecdc: try <code>memset(cData, 0, size)</code> with larger values of <code>size</code> and find the sweet spot with dichotomy."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 1, "last_activity_date": 1502211959, "creation_date": 1502211959, "answer_id": 45574201, "question_id": 45573810, "link": "https://stackoverflow.com/questions/45573810/why-didnt-the-program-crash/45574201#45574201", "title": "Why didn&#39;t the program crash?", "body": "<p>Your program has undefined behavior, which can be anything, including no crash at all and even expected behavior.</p>\n\n<p>In your particular case, there is a chance the array <code>char cData[2] = {1,2};</code> occupies space on the stack that is padded with 2 extra bytes before other important pieces of information such as the return address or the saved stack frame pointer. Modifying one of these bytes would have no noticeable effect.  Try modifying <code>cData[4]</code> or <code>cData[8]</code>, etc. but don't blame me for undesirable side effects.</p>\n"}], "owner": {"reputation": 15, "user_id": 6364693, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001481815409/picture?type=large", "display_name": "Tr\u01b0\u01a1ng V\u0103n H\u1ecdc", "link": "https://stackoverflow.com/users/6364693/tr%c6%b0%c6%a1ng-v%c4%83n-h%e1%bb%8dc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 45574201, "answer_count": 1, "score": 0, "last_activity_date": 1502211959, "creation_date": 1502210619, "question_id": 45573810, "link": "https://stackoverflow.com/questions/45573810/why-didnt-the-program-crash", "title": "Why didn&#39;t the program crash?", "body": "<p>I'm running these code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid Crash(char * cData){\n    cData[2] = 100;\n}\n\nint main() {\n    char cData[2] = {1,2};\n    Crash(&amp;cData[0]);\n    printf(\"%d\\n\",cData[1]);\n    return 0;\n}\n</code></pre>\n\n<p>I expected the program to crash since <code>cData[2] = 100;</code>(of Crash()) will change the return address of Crash function. I believe that the memory position right next to cData[1](of main()) keeps the return address of Crash function. So after the Crash function finished execution, it will take the value in the return address(which is 100 now) and continue to execute other code. So shouldn't doing so suppose to cause the program to crash?</p>\n"}, {"tags": ["c", "windows-10", "driver", "memory-mapping", "kernel-mode"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502209650, "post_id": 45573419, "comment_id": 78106475, "body": "Why not let kernel to work with userspace buffer from the start?"}, {"owner": {"reputation": 31, "user_id": 7977719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2e46d2c371b9a1af46799f804d3707?s=128&d=identicon&r=PG&f=1", "display_name": "Jones", "link": "https://stackoverflow.com/users/7977719/jones"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502209897, "post_id": 45573419, "comment_id": 78106634, "body": "As I understand it, if I allocate a buffer in the user space, there&#39;s no guarantee that it would be continuous in the physical memory (only in the virtual memory of the current process), and I need to reveal an address to a  device located on the PCIe slot, from which it can start writing continuously."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502210167, "post_id": 45573419, "comment_id": 78106793, "body": "perhaps this will be useful: <a href=\"https://stackoverflow.com/questions/7089735/does-zero-copy-exist-in-windows-osm\" title=\"does zero copy exist in windows osm\">stackoverflow.com/questions/7089735/&hellip;</a>  , although on the surface it looks like that&#39;s just dealing with files."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 0, "creation_date": 1502212372, "post_id": 45573419, "comment_id": 78108075, "body": "Have the user process give the userspace <i>virtual</i> address [and length] to your kernel driver. Your <i>driver</i> can/should decide if it can bypass intermediate buffers [or not]. The driver could suspend the process, lock the pages, determine the I/O space physical addresses, and generate a scatter/gather DMA operation [possibly using the I/O MMU]. The key point is that the driver is [probably] better suited to handle all this. You could have the user process request that the driver does the buffer allocation [from contiguous memory] and pass that back to the process."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1502212719, "post_id": 45573419, "comment_id": 78108272, "body": "will you not have a multi-process conflicts on a  single kernel space if you mange to expose it  (without copying)?"}], "answers": [{"comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1502310042, "post_id": 45597435, "comment_id": 78159298, "body": "And be careful with the page locking or your driver will have a memory leak bug. Always annoying to have to reboot Windows because some driver has locked half the RAM."}], "tags": [], "owner": {"reputation": 471, "user_id": 6169408, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rbHif.jpg?s=128&g=1", "display_name": "asynchronos", "link": "https://stackoverflow.com/users/6169408/asynchronos"}, "is_accepted": false, "score": 2, "last_activity_date": 1502300773, "creation_date": 1502300773, "answer_id": 45597435, "question_id": 45573419, "link": "https://stackoverflow.com/questions/45573419/mapping-kernel-space-virtual-address-to-user-space-virtual-address-in-windows-10/45597435#45597435", "title": "Mapping Kernel-Space Virtual Address to User-Space Virtual Address in Windows 10 Driver", "body": "<p>For your (2), how about <a href=\"https://msdn.microsoft.com/en-us/library/windows/hardware/ff554629(v=vs.85).aspx\" rel=\"nofollow noreferrer\">MmMapLockedPagesSpecifyCache()</a> with AccessMode = UserMode.  Note the important caveat, \"The routine returns a user address that is valid in the context of the process in which the driver is running,\" so you'll need to ensure the driver is running in your user-mode app's process when you perform the mapping, i.e. by doing the mapping in the driver code that directly handles a call from the user-mode code, e.g. DeviceIoControl().  Also note, to use this function, you need to supply an MDL describing the physical pages, and those pages must be locked down.</p>\n"}], "owner": {"reputation": 31, "user_id": 7977719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2e46d2c371b9a1af46799f804d3707?s=128&d=identicon&r=PG&f=1", "display_name": "Jones", "link": "https://stackoverflow.com/users/7977719/jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2370, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1502300773, "creation_date": 1502209290, "last_edit_date": 1502209664, "question_id": 45573419, "link": "https://stackoverflow.com/questions/45573419/mapping-kernel-space-virtual-address-to-user-space-virtual-address-in-windows-10", "title": "Mapping Kernel-Space Virtual Address to User-Space Virtual Address in Windows 10 Driver", "body": "<p>I'm writing a kernel mode driver in Windows 10 (64-bit), whose main purpose is to read from a DMA, and I was wondering if instead of copying blocks of memory from the kernel space to buffers allocated in the user space, I could somehow expose an address to the user space (of course not the physical address), and save on the memory copy operation.</p>\n\n<p>Perhaps something like this:</p>\n\n<ol>\n<li><p>Allocating a block of continuous physical memory (and mapping the physical address to a virtual address in the kernel space).</p></li>\n<li><p>Mapping the virtual address in the kernel space to a virtual address in the user space.</p></li>\n</ol>\n\n<p>By the way, since there's only one kernel space, and as many user spaces as there are processes running in the system (is that correct?), I would have to use some kind of a handle to the calling process, in order to get the virtual address in the appropriate process...</p>\n\n<p>Thanks for your time!</p>\n"}, {"tags": ["c", "data-structures", "makefile"], "comments": [{"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1502208868, "post_id": 45573224, "comment_id": 78105998, "body": "<code>undefined reference</code> is a linker error, so there&#39;s nothing syntactically wrong with the code"}, {"owner": {"reputation": 271, "user_id": 8387835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdAnC.jpg?s=128&g=1", "display_name": "Treeston", "link": "https://stackoverflow.com/users/8387835/treeston"}, "edited": false, "score": 4, "creation_date": 1502208882, "post_id": 45573224, "comment_id": 78106001, "body": "Most won&#39;t parse through all the unrelated clutter to find the issue. Have you tried reducing this as much as possible (to a minimal example)?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 271, "user_id": 8387835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdAnC.jpg?s=128&g=1", "display_name": "Treeston", "link": "https://stackoverflow.com/users/8387835/treeston"}, "edited": false, "score": 1, "creation_date": 1502209220, "post_id": 45573224, "comment_id": 78106204, "body": "@Treeston That is good advice, try adding a useful reference e.g. by adding <code>[mcve]</code> to your comment, which gives you <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502209380, "post_id": 45573224, "comment_id": 78106318, "body": "looks like <code>list.o</code> is not making it to the object list. Put <code>$(info OBJECTS = $(OBJECTS))</code> below the object assignment in the makefile and see what prints out"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "edited": false, "score": 0, "creation_date": 1502212494, "post_id": 45573224, "comment_id": 78108144, "body": "Trace the makefile and observe how linking is made, looks like your are not linking with the library."}, {"owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "reply_to_user": {"reputation": 271, "user_id": 8387835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IdAnC.jpg?s=128&g=1", "display_name": "Treeston", "link": "https://stackoverflow.com/users/8387835/treeston"}, "edited": false, "score": 0, "creation_date": 1502219446, "post_id": 45573224, "comment_id": 78111906, "body": "@Treeston you are right, I edited out the code that is not needed."}, {"owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502219451, "post_id": 45573224, "comment_id": 78111907, "body": "Also @yano I tried what you suggested and seems that list.o is in the object list."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502220004, "post_id": 45573224, "comment_id": 78112209, "body": "hmmm. The order of linked objects matters too. All the link errors are referencing functions in <code>link.c</code> from what I could tell, so one way or another that object code isn&#39;t making it to the appropriate place in the linker invocation. I&#39;m no makefile expert... listing the linker commands being run rather than just the errors might be helpful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502222510, "post_id": 45573224, "comment_id": 78113598, "body": "Show the linking command line, for pity&#39;s sake.  That&#39;s what&#39;s causing the trouble \u2014 we need to see it to be able to help you.  But it looks like you aren&#39;t linking the library code."}, {"owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502225051, "post_id": 45573224, "comment_id": 78114907, "body": "@JonathanLeffler I am using the --trace command but I am not making any sense of what I am seeing. Sorry, I am fairly new to this."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502225534, "post_id": 45573224, "comment_id": 78115119, "body": "I&#39;m not sure what <code>--trace</code> has to do with anything (I&#39;ve never needed to use it).  There should be a line (or possibly a few lines) just before the &#39;undefined reference&#39; messages spew forth that contain(s) the command that is executed.  If there is no such line, stop using <code>make -s</code> (silent mode) or <code>.SILENT:</code> directives (always-silent mode), or using <code>@</code> markers before your commands, or \u2026  There are lots of ways to stop <code>make</code> telling you what its doing.  However, you need to know what it is doing."}, {"owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502227341, "post_id": 45573224, "comment_id": 78115942, "body": "@yano I added whatever there was before the errors, is this what you meant?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 2, "creation_date": 1502228457, "post_id": 45573224, "comment_id": 78116444, "body": "yes. My guess is that if you move <code>build&#47;liblcthw.a</code> to the end of the <code>cc -g -O2 -Wall -Wextra -Isrc -rdynamic -DNDEBUG  build&#47;liblcthw.a    tests&#47;list_tests.c   -o tests&#47;list_tests</code> these linker errors will go away, the reason being that <code>list_tests</code> calls functions in that library. Linker order matters. In terms of fixing it in your makefile... I&#39;d need a longer look. I&#39;m certainly no expert in these things"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502228599, "post_id": 45573224, "comment_id": 78116516, "body": "Thank you for including the command line.  That makes it easy.  You have: <code>cc \u2026  build&#47;liblcthw.a  tests&#47;list_tests.c -o tests&#47;list_tests</code>.  You must list the libraries \u2014 especially static libraries with <code>.a</code> suffixes \u2014 after the (source or) object files: <code>cc \u2026 tests&#47;list_tests.c  build&#47;liblcthw.a  -o tests&#47;list_tests</code>.  Yes, the order of the options really matters!  (On some systems, you sometimes get away with listing shared libraries before object files.  On <i>all</i> systems, listing libraries <i>after</i> object files always works.)"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "edited": false, "score": 1, "creation_date": 1502293946, "post_id": 45578610, "comment_id": 78150337, "body": "You are right, this solved my problem. The fix in the <code>makefile</code> was just to change the <code>CFLAGS</code> in the <code>tests: CFLAGS += $(TARGET)</code> with<code>LDLIBS</code>"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 4, "last_activity_date": 1502331745, "last_edit_date": 1502331745, "creation_date": 1502229337, "answer_id": 45578610, "question_id": 45573224, "link": "https://stackoverflow.com/questions/45573224/c-undefined-reference-to-and-collect2-error-ld-returned-1-exit-status/45578610#45578610", "title": "C: &quot;undefined reference to&quot; and collect2: error: ld returned 1 exit status", "body": "<p>You have:</p>\n\n<pre><code>cc \u2026 build/liblcthw.a tests/list_tests.c -o tests/list_tests\n</code></pre>\n\n<p>You must list the libraries \u2014 especially static libraries with <code>.a</code> suffixes \u2014 after the (source or) object files:</p>\n\n<pre><code>cc \u2026 tests/list_tests.c build/liblcthw.a -o tests/list_tests\n</code></pre>\n\n<p>Yes, the order of the library and file options really matters!  (On some systems, you sometimes get away with listing shared libraries before object files.  On <em>all</em> systems, listing libraries <em>after</em> object files <em>always</em> works.  Do what works!)  Some options are more mobile; for example, the <code>-o tests/list_tests</code> option could appear earlier in the command line without problem.  But libraries (<code>-l\u2026</code> options, and also simple references to the library, as in this example) should appear on the command line after object files (or the source file if you don't compile the source to an object file before you link).</p>\n"}], "owner": {"reputation": 45, "user_id": 8435048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed66d1c1b34727e5a9d3750d0288fea3?s=128&d=identicon&r=PG&f=1", "display_name": "Pxcel", "link": "https://stackoverflow.com/users/8435048/pxcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5374, "favorite_count": 0, "accepted_answer_id": 45578610, "answer_count": 1, "score": 1, "last_activity_date": 1502331745, "creation_date": 1502208651, "last_edit_date": 1502227270, "question_id": 45573224, "link": "https://stackoverflow.com/questions/45573224/c-undefined-reference-to-and-collect2-error-ld-returned-1-exit-status", "title": "C: &quot;undefined reference to&quot; and collect2: error: ld returned 1 exit status", "body": "<p>I have trouble trying to compile a double linked list project from a certain programming book. The project is accompanied by some libraries that help with testing.</p>\n\n<p>Here are the tests</p>\n\n<pre><code>#include \"minunit.h\"\n#include &lt;lcthw/list.h&gt;\n#include &lt;assert.h&gt;\n\nstatic List *list = NULL;\nchar *test1 = \"test1 data\";\nchar *test2 = \"test2 data\";\nchar *test3 = \"test3 data\";\n\nchar *test_create()\n{\n    list = List_create();\n    mu_assert(list != NULL, \"Failed to create list.\");\n\n    return NULL;\n}\n\nchar *test_destroy()\n{\n    List_clear_destroy(list);\n\n    return NULL;\n}\n\nchar *test_push_pop()\n{\n    List_push(list, test1);\n    mu_assert(List_last(list) == test1, \"Wrong last value.\");\n\n    List_push(list, test2);\n    mu_assert(list_last(list) == test2, \"Wrong last value\");\n\n    List_push(list, test3);\n    mu_assert(List_last(list) == test3, \"Wrong last value.\");\n    mu_assert(List_count(list) == 3, \"Wrong count on push.\");\n\n    char *val = List_pop(list);\n    mu_assert(val == test3, \"Wrong value on pop.\");\n\n    val = List_pop(list);\n    mu_assert(val == test2, \"Wrong value on pop.\");\n\n    val = List_pop(list);\n    mu_assert(val == test1, \"Wrong value on pop.\");\n    mu_assert(List_count(list) == 0, \"Wrong count after pop.\");\n\n    return NULL;\n}\n\nchar *test_unshift()\n{\n    List_unshift(list, test1);\n    mu_assert(List_first(list) == test1, \"Wrong first value.\");\n\n    List_unshift(list, test2);\n    mu_assert(List_first(list) == test2, \"Wrong first value.\");\n\n    List_unshift(list, test3);\n    mu_assert(List_first(list) == test3, \"Wrong last value.\");\n    mu_assert(List_count(list) == 3, \"Wrong count on unshift.\");\n\n    return NULL;\n}\n\nchar *test_remove()\n{\n    // we only need to test the middle remove case since push/shift\n    // already tests the other cases\n\n    char *val = List_remove(list, list-&gt;first-&gt;next);\n    mu_assert(val == test2, \"Wrong removed element.\");\n    mu_assert(List_count(list) == 2, \"Wrong count after remove.\");\n    mu_assert(List_first(list) == test3, \"Wrong first after remove\");\n    mu_assert(List_last(list) == test1, \"Wrong last after remove.\");\n\n    return NULL;\n}\n\nchar *test_shift()\n{\n    mu_assert(List_count(list) != 0, \"Wrong count before shift.\");\n\n    char *val = List_shift(list);\n    mu_assert(val == test3, \"Wrong value on shift.\");\n\n    val = List_shift(list);\n    mu_assert(val == test1, \"Wrong value on shift.\");\n    mu_assert(List_count(list) == 0, \"Wrong count after shift.\");\n\n    return NULL;\n}\n\nchar *all_tests()\n{\n    mu_suite_start();\n\n    mu_run_test(test_create);\n    mu_run_test(test_push_pop);\n    mu_run_test(test_unshift);\n    mu_run_test(test_remove);\n    mu_run_test(test_shift);\n    mu_run_test(test_destroy);\n\n    return NULL;\n}\n\nRUN_TESTS(all_tests);\n</code></pre>\n\n<p>Also this is the Makefile I used for compiling the whole project:</p>\n\n<pre><code>CFLAGS=-g -O2 -Wall -Wextra -Isrc -rdynamic -DNDEBUG $(OPTFLAGS)\n#LDLIBS=-ldl $(OPTLIBS)\nPREFIX?=/usr/local\n\nSOURCES=$(wildcard src/**/*.c src/*.c)\nOBJECTS=$(patsubst %.c,%.o,$(SOURCES))\n\nTEST_SRC=$(wildcard tests/*_tests.c)\nTESTS=$(patsubst %.c,%,$(TEST_SRC))\n\nTARGET=build/liblcthw.a\nSO_TARGET=$(patsubst %.a,%.so,$(TARGET))\n\n# The Target Build\nall: $(TARGET) $(SO_TARGET) tests\n\ndev: CFLAGS=-g -Wall -Isrc -Wall -Wextra $(OPTFLAGS)\ndev: all\n\n$(TARGET): CFLAGS += -fPIC\n$(TARGET): build $(OBJECTS)\n    ar rcs $@ $(OBJECTS)\n    ranlib $@\n$(SO_TARGET): $(TARGET) $(OBJECTS)\n    $(CC) -shared -o $@ $(OBJECTS)\n\nbuild:\n    @mkdir -p build\n    @mkdir -p bin\n\n# The Unit Tests\n.PHONY: tests\ntests: CFLAGS += $(TARGET)\ntests: $(TESTS)\n    sh ./tests/runtests.sh\n\n# The Cleaner\nclean:\n    rm -rf build $(OBJECTS) $(TESTS)\n    rm -f tests/tests.log\n    find . -name \".gc*\" -exec rm {} \\;\n    rm -rf `find . -name \".dSYM\" -print`\n\n#The Install\ninstall: all\n    install -d $(DESTDIR)/$(PREFIX)/lib/\n    install $(TARGET) $(DESTDIR)/$(PREFIX)/lib/\n\n#The Checker\ncheck:\n    @echo Files with potentially dangerous function.\n    @egrep '[^_.&gt;a-zA-Z0-9](str(n?cpy|n?cat|xfrm|n?dup|str|pbrk|tok|_)\\\n                |stpn?cpy|a?sn?printf|byte_)' $(SOURCES) || true\n</code></pre>\n\n<p>When I run make I get this:</p>\n\n<pre><code>cc -g -O2 -Wall -Wextra -Isrc -rdynamic -DNDEBUG  -fPIC   -c -o src/lcthw/list.o src/lcthw/list.c\nar rcs build/liblcthw.a src/lcthw/list.o\nranlib build/liblcthw.a\ncc -shared -o build/liblcthw.so src/lcthw/list.o\ncc -g -O2 -Wall -Wextra -Isrc -rdynamic -DNDEBUG  build/liblcthw.a    tests/list_tests.c   -o tests/list_tests\nIn file included from tests/list_tests.c:1:0:\ntests/list_tests.c: In function \u2018main\u2019:\ntests/minunit.h:16:38: warning: parameter \u2018argc\u2019 set but not used [-Wunused-but-set-parameter]\n #define RUN_TESTS(name) int main(int argc, char *argv[]) {\\\n                                      ^\ntests/list_tests.c:107:1: note: in expansion of macro \u2018RUN_TESTS\u2019\n RUN_TESTS(all_tests);\n ^\n/tmp/ccFfwxRB.o: In function `test_create':\n/home/pxcel/liblcthw/tests/list_tests.c:12: undefined reference to `List_create'\n/tmp/ccFfwxRB.o: In function `test_destroy':\n/home/pxcel/liblcthw/tests/list_tests.c:20: undefined reference to `List_clear_destroy'\n/tmp/ccFfwxRB.o: In function `test_push_pop':\n/home/pxcel/liblcthw/tests/list_tests.c:27: undefined reference to `List_push'\n/home/pxcel/liblcthw/tests/list_tests.c:30: undefined reference to `List_push'\n/home/pxcel/liblcthw/tests/list_tests.c:33: undefined reference to `List_push'\n/home/pxcel/liblcthw/tests/list_tests.c:37: undefined reference to `List_pop'\n/home/pxcel/liblcthw/tests/list_tests.c:40: undefined reference to `List_pop'\n/home/pxcel/liblcthw/tests/list_tests.c:43: undefined reference to `List_pop'\n/tmp/ccFfwxRB.o: In function `test_unshift':\n/home/pxcel/liblcthw/tests/list_tests.c:52: undefined reference to `List_unshift'\n/home/pxcel/liblcthw/tests/list_tests.c:55: undefined reference to `List_unshift'\n/home/pxcel/liblcthw/tests/list_tests.c:58: undefined reference to `List_unshift'\n/tmp/ccFfwxRB.o: In function `test_remove':\n/home/pxcel/liblcthw/tests/list_tests.c:70: undefined reference to `List_remove'\n/tmp/ccFfwxRB.o: In function `test_shift':\n/home/pxcel/liblcthw/tests/list_tests.c:83: undefined reference to `List_shift'\n/home/pxcel/liblcthw/tests/list_tests.c:86: undefined reference to `List_shift'\n/tmp/ccFfwxRB.o: In function `test_destroy':\n/home/pxcel/liblcthw/tests/list_tests.c:20: undefined reference to `List_clear_destroy'\ncollect2: error: ld returned 1 exit status\n&lt;builtin&gt;: recipe for target 'tests/list_tests' failed\nmake: *** [tests/list_tests] Error 1\n</code></pre>\n\n<p>I have googled the errors that I get and the answers I got thus far are suggesting to check if I have typos or if I haven't linked the files correctly. Could the latter be the case?</p>\n"}, {"tags": ["c", "openssl", "manpage"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1502514436, "post_id": 45573151, "comment_id": 78252324, "body": "Maybe try <code>make install_sw</code> to avoid building the man pages?"}], "answers": [{"comments": [{"owner": {"reputation": 2566, "user_id": 919918, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e8ae3876d248ae26c2dfdb2a41dbcf9d?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/919918/wayne"}, "edited": false, "score": 0, "creation_date": 1502263973, "post_id": 45579804, "comment_id": 78127502, "body": "Thanks Devin, where can I find some info on pod files, how they work and how to make them. For now I just disabled the documentation for the build. Thanks for the help."}, {"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "reply_to_user": {"reputation": 2566, "user_id": 919918, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e8ae3876d248ae26c2dfdb2a41dbcf9d?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/919918/wayne"}, "edited": false, "score": 0, "creation_date": 1502294359, "post_id": 45579804, "comment_id": 78150581, "body": "@Wayne You can find some info on pod2man here: <a href=\"https://perldoc.perl.org/pod2man.html\" rel=\"nofollow noreferrer\">perldoc.perl.org/pod2man.html</a>"}, {"owner": {"reputation": 2566, "user_id": 919918, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e8ae3876d248ae26c2dfdb2a41dbcf9d?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/919918/wayne"}, "edited": false, "score": 0, "creation_date": 1502296527, "post_id": 45579804, "comment_id": 78151890, "body": "Thanks Devin. One more question, Does one type the pod files by hand or do you somehow generate them from source files?"}, {"owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "reply_to_user": {"reputation": 2566, "user_id": 919918, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e8ae3876d248ae26c2dfdb2a41dbcf9d?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/919918/wayne"}, "edited": false, "score": 0, "creation_date": 1502323686, "post_id": 45579804, "comment_id": 78164265, "body": "&quot;pod2man is a front-end for Pod::Man, using it to generate *roff input from POD source.&quot; from the documentation. Looks like you can generate from the source file."}, {"owner": {"reputation": 5181, "user_id": 793172, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2ec2c4d63fb493164e87d386646c2285?s=128&d=identicon&r=PG", "display_name": "Axel Beckert", "link": "https://stackoverflow.com/users/793172/axel-beckert"}, "edited": false, "score": 0, "creation_date": 1511123919, "post_id": 45579804, "comment_id": 81716007, "body": "From where does come the claim &#187;&quot;=item&quot; can only be followed by an option string&#171; <a href=\"http://perldoc.perl.org/perlpod.html\" rel=\"nofollow noreferrer\">perldoc perlpod</a> clearly says: &#187;either use &quot;=item *&quot; for all of them, to produce bullets; or use &quot;=item 1.&quot;, &quot;=item 2.&quot;, etc., to produce numbered lists; or use &quot;=item foo&quot;, &quot;=item bar&quot;, etc.&#171; IMHO this answer does not explain at all why <code>=item 1.</code> causes an error as it is used as officially documented."}], "tags": [], "owner": {"reputation": 386, "user_id": 8242696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30d156727d19a63b70ba89bf028f23e8?s=128&d=identicon&r=PG&f=1", "display_name": "Devin L.", "link": "https://stackoverflow.com/users/8242696/devin-l"}, "is_accepted": true, "score": 0, "last_activity_date": 1502237949, "creation_date": 1502237949, "answer_id": 45579804, "question_id": 45573151, "link": "https://stackoverflow.com/questions/45573151/pod2man-fails-with-expected-text-not-a-number/45579804#45579804", "title": "pod2man fails with expected text not a number", "body": "<p>\"=item\" can only be followed by an option string like in this example:</p>\n\n<pre><code>=item B&lt;--option&gt;\n</code></pre>\n\n<p>and if you want to pass in values to options, you do something like this:</p>\n\n<pre><code>=item B&lt;--option&gt;=I&lt;value&gt; \n</code></pre>\n\n<p>Note that the option string has to be enclosed in B&lt;> and the value string has to be enclosed in I&lt;>.</p>\n"}, {"tags": [], "owner": {"reputation": 5181, "user_id": 793172, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/2ec2c4d63fb493164e87d386646c2285?s=128&d=identicon&r=PG", "display_name": "Axel Beckert", "link": "https://stackoverflow.com/users/793172/axel-beckert"}, "is_accepted": false, "score": 0, "last_activity_date": 1511125547, "creation_date": 1511125547, "answer_id": 47382003, "question_id": 45573151, "link": "https://stackoverflow.com/questions/45573151/pod2man-fails-with-expected-text-not-a-number/47382003#47382003", "title": "pod2man fails with expected text not a number", "body": "<p>It seems that <code>pod2man</code> doesn't dislike numbers in general, but dislikes one specific number: Zero. So try to change all cases of <code>=item 0.</code> to <code>=item 1.</code> and bump potential further <code>=item &lt;some number&gt;</code> by adding 1, too.</p>\n\n<p>Worked fine for me for fixing the same issue in the POD of Net::IRC.</p>\n"}], "owner": {"reputation": 2566, "user_id": 919918, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e8ae3876d248ae26c2dfdb2a41dbcf9d?s=128&d=identicon&r=PG&f=1", "display_name": "Wayne", "link": "https://stackoverflow.com/users/919918/wayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 1, "accepted_answer_id": 45579804, "answer_count": 2, "score": 0, "last_activity_date": 1511125547, "creation_date": 1502208411, "question_id": 45573151, "link": "https://stackoverflow.com/questions/45573151/pod2man-fails-with-expected-text-not-a-number", "title": "pod2man fails with expected text not a number", "body": "<p>I am building a legacy version of openSSL to do some testing,\nbut the build is failing. I have already fixed several things, but now have\ngot a new one, the log is reporting that it fails when installing\nthe man pages.</p>\n\n<pre><code>        created directory `/Users/AuserName/Documents/proj/folderName/folderNameA/OpenSSL/tt/OpenSSL-for-iPhone/bin/iPhoneSimulator10.3-i386.sdk/man'\n        created directory `/Users/AuserName/Documents/proj/folderName/folderNameA/OpenSSL/tt/OpenSSL-for-iPhone/bin/iPhoneSimulator10.3-i386.sdk/man/man1'\n        created directory `/Users/AuserName/Documents/proj/folderName/folderNameA/OpenSSL/tt/OpenSSL-for-iPhone/bin/iPhoneSimulator10.3-i386.sdk/man/man3'\n        created directory `/Users/AuserName/Documents/proj/folderName/folderNameA/OpenSSL/tt/OpenSSL-for-iPhone/bin/iPhoneSimulator10.3-i386.sdk/man/man5'\n        created directory `/Users/AuserName/Documents/proj/folderName/folderNameA/OpenSSL/tt/OpenSSL-for-iPhone/bin/iPhoneSimulator10.3-i386.sdk/man/man7'\n        installing man1/CA.pl.1\n        installing man1/asn1parse.1\n        installing man1/ca.1\n        installing man1/ciphers.1\n        installing man1/cms.1\n        cms.pod around line 457: Expected text after =item, not a number\n        cms.pod around line 461: Expected text after =item, not a number\n        cms.pod around line 465: Expected text after =item, not a number\n        cms.pod around line 470: Expected text after =item, not a number\n        cms.pod around line 474: Expected text after =item, not a number\n        POD document had syntax errors at /usr/bin/pod2man5.18 line 72.\n</code></pre>\n\n<p>The pod files contents in the image so you can see the line numbers:\n<a href=\"https://i.stack.imgur.com/9Yuxu.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9Yuxu.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "ansi-c"], "comments": [{"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1502207662, "post_id": 45572861, "comment_id": 78105243, "body": "ansi-c doesn&#39;t have support for regular expressions. You can use POSIX regexps if you are on Posix system."}, {"owner": {"reputation": 23612, "user_id": 147407, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/65f858d8a973f4ee8d97517a21a17e7d?s=128&d=identicon&r=PG", "display_name": "Andrejs Cainikovs", "link": "https://stackoverflow.com/users/147407/andrejs-cainikovs"}, "edited": false, "score": 1, "creation_date": 1502207730, "post_id": 45572861, "comment_id": 78105289, "body": "You want regex, not string comparison."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502211685, "post_id": 45573352, "comment_id": 78107686, "body": "Maybe <code>&quot;.mat[%19[^]][%19[^]]%1[]]%c&quot;</code>   ( 1 less <code>]</code>)"}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1502212141, "post_id": 45573352, "comment_id": 78107955, "body": "@chux: Amazingly unreadable isn&#39;t it? The third <code>]</code> is needed to match the <code>]</code> in the string. It is not present for the second part because <code>%1[]]</code> matches the second <code>]</code> in the string."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1502212344, "post_id": 45573352, "comment_id": 78108064, "body": "Agree  3 <code>]]]</code>  For somewhat improved readability  <code>#define INDEX &quot;%19[^]]&quot; ... &quot;.mat[&quot; INDEX &quot;][&quot; INDEX &quot;%1[]]%c&quot;</code>"}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 3, "last_activity_date": 1502212356, "last_edit_date": 1502212356, "creation_date": 1502209039, "answer_id": 45573352, "question_id": 45572861, "link": "https://stackoverflow.com/questions/45572861/c-compare-string-format/45573352#45573352", "title": "c | compare string format", "body": "<p>Using the closest thing to regular expression, <code>scanf</code> scan sets, this would work, but it is remarkably ugly:</p>\n\n<pre><code>char row[20], col[20], bracket[2], ignored;\nif (sscanf(input, \".mat[%19[^]]][%19[^]]%1[]]%c\", row, col, bracket, &amp;ignored) == 3) {\n    // row and col contain the corresponding specifications...    \n    // bracket contains \"]\"\n    // %c failed to convert because if the end of string\n    ....\n}\n</code></pre>\n\n<p>Here is the broken down conversion specification for <code>\".mat[r1][r2]\"</code>:</p>\n\n<pre><code>\".mat[\"    // matches .mat[\n\"%19[^]]\"  // matches r1   count=1\n\"][\"       // matches ][\n\"%19[^]]\"  // matches r2   count=2\n\"%1[]]\"    // matches ]    count=3\n\"%c\"       // should not match anything because of the end of string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1502213404, "creation_date": 1502213404, "answer_id": 45574608, "question_id": 45572861, "link": "https://stackoverflow.com/questions/45572861/c-compare-string-format/45574608#45574608", "title": "c | compare string format", "body": "<p>Alternative to <a href=\"https://stackoverflow.com/a/45573352/2410359\">@chqrlie</a> fine answer: This allows for various suffixes and no <code>bracket[2]</code></p>\n\n<p>Use <code>\"%n\"</code> which saves the scan offset.  It will be non-zero if scanning succeeded up to that point</p>\n\n<pre><code>// .mat[something][something]\n#define PREFIX \".mat\"\n#define IDX \"[%19[^]]]\"\n#define SUFFIX \"\"\n\nchar r1[20], r2[20];\nint n = 0;\nsscanf(input, PREFIX INDEX INDEX SUFFIX \"%n\", r1, r2, &amp;n);\n\n// Reached the end and there was no more\nif (n &gt; 0 &amp;&amp; input[n] == '\\0') Success();\nelse Failure();\n</code></pre>\n"}], "owner": {"reputation": 997, "user_id": 7273447, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ej7gq.jpg?s=128&g=1", "display_name": "Elon Salfati", "link": "https://stackoverflow.com/users/7273447/elon-salfati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 519, "favorite_count": 0, "accepted_answer_id": 45573352, "answer_count": 2, "score": 3, "last_activity_date": 1502213404, "creation_date": 1502207516, "last_edit_date": 1502208798, "question_id": 45572861, "link": "https://stackoverflow.com/questions/45572861/c-compare-string-format", "title": "c | compare string format", "body": "<p>I want to find out if there is any simple option to a string is equal to a format string.\nfor example I want this format <code>.mat[something][something]</code> to be equal to using <code>strcmp</code> to <code>.mat[r1][r2]</code> or <code>.mat[4][5]</code></p>\n\n<p>Is there any option to use regular expressions of a sort? or something like <code>strcmp(.mat[%s][%s], .mat[r3][r5])</code>?</p>\n\n<p>BTW I'm using ansi-c\nThanks</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4703, "user_id": 5375464, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3292ca87ff6c766b75dbe4b2ea0831da?s=128&d=identicon&r=PG&f=1", "display_name": "J...S", "link": "https://stackoverflow.com/users/5375464/j-s"}, "edited": false, "score": 5, "creation_date": 1502206874, "post_id": 45572584, "comment_id": 78104729, "body": "<a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/language/operator_precedence</a>"}, {"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 2, "creation_date": 1502206914, "post_id": 45572584, "comment_id": 78104757, "body": "Unrelated side note: When you&#39;ve studied only for 3 days, you might want to focus your efforts to something else other than insignificant trivia like this."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 4, "creation_date": 1502206994, "post_id": 45572584, "comment_id": 78104812, "body": "@JJJ I don&#39;t know if operator precedence can be considered &quot;insignificant trivia&quot;."}, {"owner": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1502207267, "post_id": 45572584, "comment_id": 78104971, "body": "@Carcigenicate That&#39;s not what I said. This isn&#39;t a very good example of operator precedence and about as far removed from reality as you can get. From the past 20 years of programming I can&#39;t recall a single incidence where it made any difference which side of equality comparison was evaluated first."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 3, "creation_date": 1502207329, "post_id": 45572584, "comment_id": 78105014, "body": "Nor do I see how operator precedence has anything to do with the OP&#39;s question. The question isn&#39;t about precedence; its about order of eval. There are <i>seven</i> expressions in that conditional (four of which are arguably trivial). The question is about two of those expressions, and their order of their evaluation."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 0, "creation_date": 1502207371, "post_id": 45572584, "comment_id": 78105040, "body": "@JJJ Understanding that the equality has lower precedence than most operators is important. Of course once you understand that, it&#39;s obvious."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 0, "creation_date": 1502207450, "post_id": 45572584, "comment_id": 78105087, "body": "@JJJ If you didn&#39;t mean that operator precedence is insignificant trivia, sorry for misunderstanding you."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 4, "creation_date": 1502207759, "post_id": 45572584, "comment_id": 78105307, "body": "Not to be picky here, but <code>x % 3</code> will never be calculated in the example. :)"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 1, "creation_date": 1502209467, "post_id": 45572584, "comment_id": 78106378, "body": "There is another option.  The compiler may optimize out the entire expression."}, {"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "reply_to_user": {"reputation": 31483, "user_id": 502381, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/74b99e687909be449e0130a50950eac7?s=128&d=identicon&r=PG&f=1", "display_name": "JJJ", "link": "https://stackoverflow.com/users/502381/jjj"}, "edited": false, "score": 1, "creation_date": 1502209721, "post_id": 45572584, "comment_id": 78106520, "body": "@JJJ already stated it clear. This is neither a question of operator precedence, nor operator associativity. It concerns order of evaluation of operator arguments, which is undefined in C. So this is a bogus problem. The order is implementation dependent and generally not of interest."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1502209889, "post_id": 45572584, "comment_id": 78106627, "body": "BTW Use <code>%%</code> instead of <code>%</code> in the format string of <code>printf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 1, "creation_date": 1502209361, "post_id": 45573307, "comment_id": 78106305, "body": "You&#39;re confusing operator associativity and order of evaluation. The latter is usally undefined in C, so it&#39;s implementation dependent."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "edited": false, "score": 2, "creation_date": 1502210105, "post_id": 45573307, "comment_id": 78106750, "body": "@SBS: order of evaluation is implementation dependent but not implementation defined.  The same compiler may generate code that evaluates the same expression in a different order in different places, at different times, for different runs..."}, {"owner": {"reputation": 696, "user_id": 6060561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1lugp.jpg?s=128&g=1", "display_name": "SBS", "link": "https://stackoverflow.com/users/6060561/sbs"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1502210188, "post_id": 45573307, "comment_id": 78106808, "body": "@chqrlie Exactly."}, {"owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "edited": false, "score": 0, "creation_date": 1502239614, "post_id": 45573307, "comment_id": 78119427, "body": "hi SBS &amp; chqrlie, thanx for raising pertinent questions. i have added clarification accordingly"}], "tags": [], "owner": {"reputation": 1428, "user_id": 6037536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MyRi1.jpg?s=128&g=1", "display_name": "curious", "link": "https://stackoverflow.com/users/6037536/curious"}, "is_accepted": false, "score": -4, "last_activity_date": 1502250846, "last_edit_date": 1502250846, "creation_date": 1502208902, "answer_id": 45573307, "question_id": 45572584, "link": "https://stackoverflow.com/questions/45572584/which-would-be-calculated-first/45573307#45573307", "title": "Which would be calculated first?", "body": "<p>It's a good question Gaurav. Always have that inquisitive mind as that's how you can attain true learning.</p>\n\n<p>As suggested in the comments, this question relates to Operator Precedence and Associativity.</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Order_of_operations\" rel=\"nofollow noreferrer\">Here you can get an idea in general.</a></p>\n\n<p><a href=\"http://en.cppreference.com/w/c/language/operator_precedence\" rel=\"nofollow noreferrer\">Here, it's more specific to your question</a>. As you can see there (point# 3),  for <code>%</code> operator, it is from Left-to-right.</p>\n\n<p>It is important to distinguish here between how equality == works versus the assignment operator = as the later works from right-to-left. As mentioned in that link, for the assignment operators like <code>=</code>, the expression <code>a=b=c</code> is parsed as <code>a=(b=c)</code>, and <strong>not</strong> as <code>(a=b)=c</code> because of right-to-left associativity.</p>\n\n<p>Hope this will clear your doubts!</p>\n\n<p><strong>Additional clarifications:</strong></p>\n\n<p>Based on subsequent discussions in the comment section, I feel it necessary to remove some of the confusions.</p>\n\n<ul>\n<li><p>Confusion about operator associativity and order of evaluation:\n<br/>If two operators are of same precedence, Associativity of operators determines the order in which they execute. The associativity of <code>==</code> is left to right, i.e, the expression on the left is executed first and moves toward the right. So answer to the question of which expression is calculated first in the equation <code>x % 2 == y % 3</code>, the answer would be like this:\n<br/>1. evaluation of <code>x % 2</code>.\n<br/>2. evaluation of <code>y % 3</code>.\n<br/>3. evaluation of <code>==</code></p></li>\n<li><p>Do compilers strictly follow this rule?\n<br/>Not necessarily. The compilers are free to evaluate such expressions in any order, if they can guarantee a consistent result. Only the sequential-evaluation (,), logical-AND (&amp;&amp;), logical-OR (||), conditional-expression (? :), and function-call operators constitute sequence points and therefore guarantee a particular order of evaluation for their operands.</p></li>\n<li>Authentic reference: <a href=\"https://msdn.microsoft.com/en-us/library/2bxt6kc4.aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/2bxt6kc4.aspx</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 3, "last_activity_date": 1502209630, "creation_date": 1502209630, "answer_id": 45573524, "question_id": 45572584, "link": "https://stackoverflow.com/questions/45572584/which-would-be-calculated-first/45573524#45573524", "title": "Which would be calculated first?", "body": "<p>The short answer is: C does not specify which of <code>x % 2</code> and <code>y % 3</code> is computed first, and since there is no side effect in either sub-expression, it does not matter.</p>\n\n<p>The long answer is: Actually, looking at the generated code on <a href=\"https://godbolt.org/g/F5ZYqJ\" rel=\"nofollow noreferrer\">Godbolt Compiler Explorer</a>, the expression may be evaluated at compile time and none of these are computed at runtime.</p>\n\n<p>Very few C operators have a specified order of evaluation:</p>\n\n<ul>\n<li>the comma operator <code>,</code></li>\n<li>the logical and <code>&amp;&amp;</code> and logical or <code>||</code> as well as the ternary operator <code>?</code> <code>:</code> (they actually only evaluate their second or third operand if the first has a specific truth value).</li>\n<li>function arguments are evaluated before the function is called, but their relative order of evaluation is unspecified.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1502220023, "creation_date": 1502220023, "answer_id": 45576467, "question_id": 45572584, "link": "https://stackoverflow.com/questions/45572584/which-would-be-calculated-first/45576467#45576467", "title": "Which would be calculated first?", "body": "<p>I is a tricky question and it was very popular during the interviews some time ago.</p>\n\n<p>If I make it this example a bit less trivial and avoid optimisations:</p>\n\n<pre><code>int comapare(int x, int y) {\n\n  int result;\n  if (result = (x % 2 == y % 3)) {\n    printf(\"Which one x%%2 or y%%3 calculated first\");\n  }\nreturn result;\n}\n</code></pre>\n\n<p>The order of evaluation of this particular is undetermined as only logical operators are guaranteed from the left to the right and evaluate the smallest number of operands needed to determine the result of the expression. Operator <code>==</code> along with all other comparison operators <strong><em>is not</em></strong> the logical operator.</p>\n\n<p>Most interviewed candidates answered that it will be evaluated from the left to the right as it is the logical operation.</p>\n"}], "owner": {"reputation": 23, "user_id": 8435184, "user_type": "registered", "profile_image": "https://graph.facebook.com/1419246461497943/picture?type=large", "display_name": "Gaurav", "link": "https://stackoverflow.com/users/8435184/gaurav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 3, "score": -5, "last_activity_date": 1502250846, "creation_date": 1502206697, "question_id": 45572584, "link": "https://stackoverflow.com/questions/45572584/which-would-be-calculated-first", "title": "Which would be calculated first?", "body": "<p>Only 3 days while learning C. Noticed this in the book:</p>\n\n<pre><code>int main() {\n  int x = 10, y = 15;\n  if (x % 2 == y % 3) {\n    printf(\"Which one x%2 or y%3 calculated first\");\n  }\n}\n</code></pre>\n\n<p>My question is in if condition. Question is which expression is calculated first, x%3 or y%3?</p>\n"}, {"tags": ["c#", "c", "dll", "dllexport"], "comments": [{"owner": {"reputation": 737, "user_id": 5399494, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468499080123573/picture?type=large", "display_name": "Jean-Claude Colette", "link": "https://stackoverflow.com/users/5399494/jean-claude-colette"}, "edited": false, "score": 0, "creation_date": 1502205306, "post_id": 45571905, "comment_id": 78103618, "body": "Like in <a href=\"https://stackoverflow.com/questions/20419415/c-sharp-call-c-dll-passing-pointer-to-pointer-argument\" title=\"c sharp call c dll passing pointer to pointer argument\">stackoverflow.com/questions/20419415/&hellip;</a> Have you tried tu put unsafe before internal static extern and in DllImport: CallingConvention = CallingConvention.Cdecl?"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1502205826, "post_id": 45571905, "comment_id": 78103975, "body": "The stack error usually means the return variable size from calling function doesn&#39;t match the parent return size.  So specify the size in the enumeration : public enum eSSHD_Err : int //or the size from the c++ library."}, {"owner": {"reputation": 23, "user_id": 5810035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l51dU.jpg?s=128&g=1", "display_name": "holyhope", "link": "https://stackoverflow.com/users/5810035/holyhope"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1502206861, "post_id": 45571905, "comment_id": 78104723, "body": "Hi, I  try to compile with unsafe (build option AND before the prototype) I try to use CallingConvention in Cdec, now I try to keep in my code....  @jdweng I have try now in this way:  typedef enum : int { \tSSHD_ERR_NONE = 0, \tSSHD_ERR_INVALID_HANDLE, \tSSHD_ERR_NULL_POINTER, }  but without success... The error remain the same.  I try to call the fnction without expecting return..  So both: eSSHD_Err retProva = Extern_sshdOpen(handle); and Extern_sshdOpen(handle);"}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1502208912, "post_id": 45571905, "comment_id": 78106026, "body": "I don&#39;t think call will work with unsafe code.  Never tried it."}, {"owner": {"reputation": 737, "user_id": 5399494, "user_type": "registered", "profile_image": "https://graph.facebook.com/1468499080123573/picture?type=large", "display_name": "Jean-Claude Colette", "link": "https://stackoverflow.com/users/5399494/jean-claude-colette"}, "edited": false, "score": 0, "creation_date": 1502212738, "post_id": 45571905, "comment_id": 78108281, "body": "Can you get the value of handle after calling Extern_sshdCreate(); ?"}, {"owner": {"reputation": 23, "user_id": 5810035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l51dU.jpg?s=128&g=1", "display_name": "holyhope", "link": "https://stackoverflow.com/users/5810035/holyhope"}, "edited": false, "score": 0, "creation_date": 1502261969, "post_id": 45571905, "comment_id": 78126165, "body": "Hi, yes Handle value is this (I don&#39;t know if it is valid or not): Before: 0x00000000   (all zero)    After:    0x077d2ac0"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5810035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l51dU.jpg?s=128&g=1", "display_name": "holyhope", "link": "https://stackoverflow.com/users/5810035/holyhope"}, "edited": false, "score": 0, "creation_date": 1502266690, "post_id": 45577491, "comment_id": 78129295, "body": "Hi to all! Now work! I use the calling convention and the ref instead char *... Now I write the working code"}], "tags": [], "owner": {"reputation": 2449, "user_id": 500276, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/200bf76976f24add540182f5c3a42788?s=128&d=identicon&r=PG&f=1", "display_name": "Mark Benningfield", "link": "https://stackoverflow.com/users/500276/mark-benningfield"}, "is_accepted": false, "score": 0, "last_activity_date": 1502224154, "creation_date": 1502224154, "answer_id": 45577491, "question_id": 45571905, "link": "https://stackoverflow.com/questions/45571905/c-using-c-library-with-pointer-etc/45577491#45577491", "title": "C# using C library with pointer etc", "body": "<p>Try adding the <code>StructLayoutAttribute</code> to your managed struct declaration. The C# compiler is permitted to re-order\nstruct members for efficiency if it deems it beneficial, so this will prevent that. Since <code>long</code> is <em>usually</em> a 32-bit integer in C, I have changed the field types to <code>uint</code>.</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic class SSHDDateTime {\n  public uint Year { get; set; }     // \n  public uint Month { get; set; }    // 1...12\n  public uint Day { get; set; }      // 1...31\n  public uint Hour { get; set; }  // 0...23\n  public uint Min { get; set; }      // 0...59\n  public uint Sec { get; set; }    // 0...59\n  public uint MilliSec { get; set; } // 0...999\n\n  public SSHDDateTime() {\n    Year = 0;\n    Month = 0;\n    Day = 0;\n    Hour = 0;\n    Min = 0;\n    Sec = 0;\n    MilliSec = 0;\n  }\n}\n</code></pre>\n\n<p>Next, pass a <code>StringBuilder</code> to the <code>Extern_sshdGetDllVersion</code> function. This function is expecting a character\nbuffer, and the managed equivalent of a character buffer is a <code>StringBuilder</code>. The PInvoke marshaler has detailed\nknowledge of the <code>StringBuilder</code> class to handle interop marshaling of strings. You can add the <code>MarshalAsAttribute</code> as a hint to the marshaler that you are dealing with ANSI strings in the native library. Also, the default calling convention for the <code>DllImportAttribute</code> is <code>StdCall</code>, which is <em>likely</em> not what you want here. This revised signature specifies the <code>Cdecl</code> calling convention, which is the standard convention for C programs. If your C library is in fact compiled to use <code>StdCall</code>, then you can take that part out, but I think that is the source of your stack corruption.</p>\n\n<pre><code>    [DllImport(dllPath, EntryPoint = \"sshdGetDllVersion\", CallingConvention = CallingConvention.Cdecl)]\n    internal static extern eSSHD_Err Extern_sshdGetDllVersion([MarshlAs(UnmanagedType.LPStr)]StringBuilder dllVer , Int32 maxLen );\n</code></pre>\n\n<p>The PInvoke signatures for the other functions would be as follows:</p>\n\n<pre><code>[DllImport(dllPath, EntryPoint = \"sshdOpen\", CallingConvention = CallingConvention.Cdecl))]\ninternal static extern eSSHD_Err Extern_sshdOpen();\n\n[DllImport(dllPath, EntryPoint = \"sshdCreate\", CallingConvention = CallingConvention.Cdecl))]\ninternal static extern IntPtr Extern_sshdCreate();\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5810035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l51dU.jpg?s=128&g=1", "display_name": "holyhope", "link": "https://stackoverflow.com/users/5810035/holyhope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 325, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502266980, "creation_date": 1502204653, "last_edit_date": 1502266980, "question_id": 45571905, "link": "https://stackoverflow.com/questions/45571905/c-using-c-library-with-pointer-etc", "title": "C# using C library with pointer etc", "body": "<p>I have a .dll without source code.\nThat library is wrote in C... I have only one .h\nAn extract of the library is this:</p>\n\n<pre><code>typedef enum\n{\n    SSHD_ERR_NONE = 0,\n    SSHD_ERR_INVALID_HANDLE,\n    SSHD_ERR_NULL_POINTER,\n}sshdErr_t;\n\ntypedef struct\n{\n    unsigned long  Year;            // \n    unsigned long  Month;       // 1...12\n    unsigned long  Day;         // 1...31\n\n    unsigned long  Hour;        // 0...23\n    unsigned long  Min;         // 0...59\n    unsigned long  Sec;         // 0...59\n    unsigned long  MilliSec;    // 0...999\n} sshdDateTime_t;\n\n\n    DllExport HANDLE sshdCreate(void);\n    DllExport sshdErr_t sshdGetDllVersion(char *dllVersion, unsigned long dllVersionMaxLen);\n\n    DllExport sshdErr_t sshdOpen(HANDLE rh);\n\nI have write this code:\n\n\n\n      private const String dllPath = @\"D:\\work\\SSHD.dll\";\n\n    [DllImport(dllPath,EntryPoint = \"sshdOpen\")]\n        internal static extern eSSHD_Err Extern_sshdOpen();\n\n\n        [DllImport(dllPath,EntryPoint = \"sshdGetDllVersion\")]\n        //internal static extern string sshdGetDllVersion();\n        internal static extern eSSHD_Err Extern_sshdGetDllVersion(string dllVer , Int32 maxLen );\n\n        [DllImport(dllPath, EntryPoint = \"sshdCreate\")]\n        internal static extern IntPtr Extern_sshdCreate();\n\n    public enum eSSHD_Err {\n        SSHD_ERR_NONE = 0,\n        SSHD_ERR_INVALID_HANDLE,\n        SSHD_ERR_NULL_POINTER,\n    }\n\n  public class SSHDDateTime {\n    public ulong Year { get; set; }     // \n    public ulong Month { get; set; }    // 1...12\n    public ulong Day { get; set; }      // 1...31\n    public ulong Hour { get; set; }  // 0...23\n    public ulong Min { get; set; }      // 0...59\n    public ulong Sec { get; set; }    // 0...59\n    public ulong MilliSec { get; set; } // 0...999\n\n    public SSHDDateTime() {\n      Year = 0;\n      Month = 0;\n      Day = 0;\n      Hour = 0;\n      Min = 0;\n      Sec = 0;\n      MilliSec = 0;\n    }\n  }\n</code></pre>\n\n<p>So I use Dll import, convert enum in enum (C#) and struct in class...</p>\n\n<p>When I try to use I have an error...</p>\n\n<p>Now the code for use the library:</p>\n\n<pre><code>  IntPtr handle;\n  handle = Extern_sshdCreate();\n</code></pre>\n\n<p>this MAYBE work... It means that value of \"handle\" change.... but I really not know if it work!</p>\n\n<p>when I try to use the other function, in this way:</p>\n\n<pre><code>int retProva = (int) (Extern_sshdOpen(handle));\n</code></pre>\n\n<p>or</p>\n\n<pre><code>eSSHD_Err retProva = Extern_sshdOpen(handle);\n</code></pre>\n\n<p>I have an error of stack corrupted...</p>\n\n<p>Using the other function is the same results:</p>\n\n<pre><code>string dllVer=\"xxxxxxxxxxxxxxx\";\nInt32 maxLen = 10;\nExtern_sshdGetDllVersion(dllVer,maxLen);\n</code></pre>\n\n<p>I try to use string or String for the dllVer or to use = \"         \" ...\nI try to store the retruned value and not\nI try to use Int32, string, ulong for maxLen \nnut all try without result...</p>\n\n<p>the error returned, in Italian, is this:</p>\n\n<blockquote>\n  <p>Managed Debugging Assistant 'PInvokeStackImbalance' : 'Una chiamata\n  alla funzione PInvoke\n  'TestSTSWavetronix!TestSTSWavetronix.FormTestWavetronix::Extern_sshdGetDllVersion'\n  ha sbilanciato lo stack. Questo problema pu\u00f2 verificarsi quando la\n  firma PInvoke gestita non corrisponde alla firma di destinazione non\n  gestita. Verificare che la convenzione di chiamata e i parametri della\n  firma PInvoke corrispondano alla firma di destinazione non gestita.'</p>\n</blockquote>\n\n<p>So I ask:\n1. How to use correctly this call?\n2. I transform enum C in enum C#, but for return value, how to adapt?\n3. similar to previous, how to pass struct C to function, if in C# I have class instead?\n4. I have a pointer on C parameter function call... how to manage with him? I suppose that the C code try to modify the string that I pass....</p>\n\n<p>edit:\nother try:\n- use unsafe in compilation proprierties and before prototype \n- use \"enum : int\"  on definition of enum</p>\n\n<p>edit 2:\n********************** WORKING SOLUTION *************</p>\n\n<pre><code>  public enum eSSHD_Err {\n    SSHD_ERR_NONE = 0,\n    SSHD_ERR_INVALID_HANDLE,\n    SSHD_ERR_NULL_POINTER,\n}\n    [DllImport(dllPath,EntryPoint = \"sshdGetDllVersion\",CallingConvention = CallingConvention.Cdecl)]\n    unsafe internal static extern eSSHD_Err Extern_sshdGetDllVersion(ref char dllVer,Int32 maxLen);\nchar[] dllVer = new char[250];\nInt32 maxLen = 250;\nretErrGetDllVer = Extern_sshdGetDllVersion(ref dllVer[0],maxLen);\n</code></pre>\n\n<p>Thanks to all</p>\n\n<p>Massimiliano</p>\n"}, {"tags": ["c", "graphics"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1502204519, "post_id": 45571721, "comment_id": 78103074, "body": "The error is clear: you&#39;re not linking libraries required for the API you&#39;re using. Are you using <a href=\"http://www.codedread.com/boss.php\" rel=\"nofollow noreferrer\">Boss</a> ?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502205722, "post_id": 45571721, "comment_id": 78103906, "body": "Was your program supposed to work on Turbo C++ intially?"}, {"owner": {"reputation": 779, "user_id": 8006192, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/XctU4.jpg?s=128&g=1", "display_name": "Shibin Raju Mathew", "link": "https://stackoverflow.com/users/8006192/shibin-raju-mathew"}, "edited": false, "score": 0, "creation_date": 1502206660, "post_id": 45571721, "comment_id": 78104569, "body": "yes. its worked but not in ubuntu"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 1, "creation_date": 1502275576, "post_id": 45571721, "comment_id": 78135676, "body": "<b>ubuntu</b> is not <b>MS-DOS</b> !!! ... <code>graphics.h</code> is ancient <b>Borland BGI</b> api for <b>MS-DOS</b> so either use <b>MS-DOS</b> or emulator ... there are also windows ports like WinBGI but I do not know of any for <b>linux</b>.... To make BGI work you also need a proper gfx BGI driver at accessible location ...  If you are not bound to <b>BGI</b> do not use it ..."}], "owner": {"reputation": 779, "user_id": 8006192, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/XctU4.jpg?s=128&g=1", "display_name": "Shibin Raju Mathew", "link": "https://stackoverflow.com/users/8006192/shibin-raju-mathew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1349, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1502206697, "creation_date": 1502204212, "last_edit_date": 1502206697, "question_id": 45571721, "link": "https://stackoverflow.com/questions/45571721/setfillstyle-not-working-in-c-graphics-while-compiles-on-ubuntu", "title": "setfillstyle not working in c graphics while compiles on ubuntu", "body": "<p>while writing c graphics program (in ubuntu ) setfillstyle not working.</p>\n\n<pre><code>   setfillstyle(1,RED);\n   circle(50,100,5);\n   floodfill(51,101,WHITE);\n</code></pre>\n\n<p>getting error as </p>\n\n<pre><code>/tmp/ccps2Qkp.o: In function `main':\ndemo.c:(.text+0x77): undefined reference to `setfillstyle'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n\n<p>full code as follows</p>\n\n<pre><code>#include&lt;graphics.h&gt; \nint main()\n{\n   int gd = DETECT,gm;\n   initgraph(&amp;gd,&amp;gm,NULL);\n\n   setfillstyle(1,RED);\n   circle(50,100,5);\n   floodfill(51,101,WHITE); \n\n   delay(50000);\n   closegraph();\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "data-structures", "linked-list"], "comments": [{"owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "edited": false, "score": 2, "creation_date": 1502202628, "post_id": 45571056, "comment_id": 78101528, "body": "<code>if (start=NULL)</code> should be  <code>if (start==NULL)</code>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1502202770, "post_id": 45571056, "comment_id": 78101654, "body": "Is this your actual code? It doesn&#39;t compile at all. (For example, you hve a mix-up between <code>count</code> and <code>option</code> in <code>main</code>, <code>struct *Node</code> is a syntax error and you call some functions without proper arguments. )"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1502203016, "post_id": 45571056, "comment_id": 78101847, "body": "@MOehm The new generation of programmers do not write code. They search for code in internet.:)"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1502203137, "post_id": 45571056, "comment_id": 78101945, "body": "Oh, yes, plenty to find there! But the code has so many errors that I can&#39;t say with confidence where the supposed segmentation fault occurs. (Also -- why should Ctrl-C / Ctrl-V work only from the browser to the text editor / IDE and noct the other way round?)"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1502203292, "post_id": 45571056, "comment_id": 78102052, "body": "<code>start=display();</code> So, there&#39;s these things called <i>parameters</i>. The <code>display</code> function is expecting one: <code>struct Node* display(struct Node* start)</code>. Probably should go ahead and provide one."}, {"owner": {"reputation": 73, "user_id": 7236897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MGLPE8aZz5g/AAAAAAAAAAI/AAAAAAAAABY/v6kEPeIMQmU/photo.jpg?sz=128", "display_name": "zahlen", "link": "https://stackoverflow.com/users/7236897/zahlen"}, "edited": false, "score": 0, "creation_date": 1502203404, "post_id": 45571056, "comment_id": 78102151, "body": "The code is still in making so my mistake between the mix up between <code>count</code> and <code>option</code>."}, {"owner": {"reputation": 73, "user_id": 7236897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MGLPE8aZz5g/AAAAAAAAAAI/AAAAAAAAABY/v6kEPeIMQmU/photo.jpg?sz=128", "display_name": "zahlen", "link": "https://stackoverflow.com/users/7236897/zahlen"}, "edited": false, "score": 0, "creation_date": 1502203520, "post_id": 45571056, "comment_id": 78102246, "body": "The fault was all because of  <code>if(start=NULL)</code>. Now it&#39;s fixed"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1502203662, "post_id": 45571056, "comment_id": 78102366, "body": "A segmentation fault can only occur when the program executes. You can only execute a program when you have compiled it. The code above doesn&#39;t compile, therefore it can&#39;t be used to analyse your problem. You are wasting people&#39;s time here, because you fail to provide the <i>actual</i> code that exhibits the described behaviour."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1502203683, "post_id": 45571056, "comment_id": 78102382, "body": "If you think that&#39;s &quot;the&quot; problem in this code, you seriously need to crank up your warning levels, because there&#39;s <a href=\"http://coliru.stacked-crooked.com/a/5e0ff51d33192268\" rel=\"nofollow noreferrer\">plenty more where that came from</a>."}, {"owner": {"reputation": 73, "user_id": 7236897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MGLPE8aZz5g/AAAAAAAAAAI/AAAAAAAAABY/v6kEPeIMQmU/photo.jpg?sz=128", "display_name": "zahlen", "link": "https://stackoverflow.com/users/7236897/zahlen"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1502203936, "post_id": 45571056, "comment_id": 78102582, "body": "Sorry! I pasted the wrong code. I have edited it now @MOehm"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1502204578, "post_id": 45571056, "comment_id": 78103118, "body": "@zahlen it&#39;s a bit late now - you have already wasted enough effort:(  How do we know that you have not pasted more non-compiling code?"}], "answers": [{"comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1502203686, "post_id": 45571177, "comment_id": 78102386, "body": "It&#39;s not like the OP is even providing an argument to that function from the call in <code>main</code> in the first place. <code>start=display();</code>  Checking for NULL, while good advice, is kind almost an afterthought at that point, as the OP has already shot themselves in the foot."}, {"owner": {"reputation": 73, "user_id": 7236897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MGLPE8aZz5g/AAAAAAAAAAI/AAAAAAAAABY/v6kEPeIMQmU/photo.jpg?sz=128", "display_name": "zahlen", "link": "https://stackoverflow.com/users/7236897/zahlen"}, "edited": false, "score": 0, "creation_date": 1502204785, "post_id": 45571177, "comment_id": 78103286, "body": "i will put it in a <code>if(ptr!=NULL)</code> block"}], "tags": [], "owner": {"reputation": 668, "user_id": 803978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7PIsz.png?s=128&g=1", "display_name": "Code Gorilla", "link": "https://stackoverflow.com/users/803978/code-gorilla"}, "is_accepted": false, "score": 2, "last_activity_date": 1502202823, "creation_date": 1502202823, "answer_id": 45571177, "question_id": 45571056, "link": "https://stackoverflow.com/questions/45571056/creating-linked-list-gives-segmentation-fault-core-dumped-error/45571177#45571177", "title": "Creating Linked List gives Segmentation fault (core dumped) error", "body": "<p>In <code>display()</code> you are assuming that ptr is not null</p>\n\n<pre><code>struct Node* display(struct Node* start)\n{\n    struct Node *ptr;\n    ptr=start;\n    while(ptr-&gt;next!=NULL)\n</code></pre>\n\n<p>If start is NULL then <code>NULL-&gt;next</code> will cause problems.</p>\n\n<p>The error you are seeing is because you do the same in the <code>create_ll()</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "is_accepted": true, "score": 1, "last_activity_date": 1502203840, "last_edit_date": 1502203840, "creation_date": 1502203035, "answer_id": 45571271, "question_id": 45571056, "link": "https://stackoverflow.com/questions/45571056/creating-linked-list-gives-segmentation-fault-core-dumped-error/45571271#45571271", "title": "Creating Linked List gives Segmentation fault (core dumped) error", "body": "<p>I think you have a typo. Change <code>if (start=NULL)</code> to <code>if (start == NULL)</code>. In C, <code>=</code> is the assignment operator and <code>==</code> is used to compare.</p>\n\n<p>When you do <code>if (start=NULL)</code>, the variable <code>start</code> gets assigned to <code>NULL</code> and the <code>if</code> block is not executed as the assignment expression returns whatever is on the right hand side. After that, your <code>ptr</code> becomes <code>NULL</code> and then you dereference <code>ptr</code> in the <code>else</code> block (<code>while(ptr-&gt;next!=NULL)</code>) which causes the segmentation fault.</p>\n"}], "owner": {"reputation": 73, "user_id": 7236897, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-MGLPE8aZz5g/AAAAAAAAAAI/AAAAAAAAABY/v6kEPeIMQmU/photo.jpg?sz=128", "display_name": "zahlen", "link": "https://stackoverflow.com/users/7236897/zahlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 45571271, "answer_count": 2, "score": -1, "last_activity_date": 1503340204, "creation_date": 1502202492, "last_edit_date": 1503340204, "question_id": 45571056, "link": "https://stackoverflow.com/questions/45571056/creating-linked-list-gives-segmentation-fault-core-dumped-error", "title": "Creating Linked List gives Segmentation fault (core dumped) error", "body": "<p>The following code is for creating a Singly Linked List and display it using two functions <strong>create_ll()</strong>  and <strong>display()</strong>. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nstruct Node\n        {\n            int data;\n            struct Node* next;\n\n        };\n\nstruct Node* create_ll(struct Node*);\nstruct Node* display(struct Node*);\nint main(int argc, char *argv[])\n{\n    struct Node* start=NULL;\n    int option=0;\n    do \n    {\n        printf(\"\\t\\t\\t*******MAIN MENU********\");\n        printf(\"\\n\\t1.Create a list\");\n        printf(\"\\n\\t2.Display the list\");\n        printf(\"\\n\\t3.Exit\");\n        scanf(\"%d\",&amp;option);\n        switch(option)\n        {\n            case 1: start=create_ll(start);\n                printf(\"\\nLinked list created\");\n                break;\n            case 2: start=display(start);\n                break;\n        };\n    }while(option!=3);\n\n    return 0;\n\n}\nstruct Node* create_ll(struct Node* start)\n{\n    struct Node *new_node,*ptr;\n    int num;\n    printf(\"Enter -1 to end\");\n    printf(\"\\nEnter data\");\n    scanf(\"%d\",&amp;num);\n    while(num!=-1)\n    {\n        printf(\"Creating Node....\");\n        new_node=(struct Node*)malloc(sizeof(struct Node));\n\n        if(new_node!=NULL)\n        {\n            new_node-&gt;data=num;\n            if (start==NULL)\n            {\n                new_node-&gt;next=NULL;\n                start=new_node;\n            }\n            else\n            {\n                ptr=start;\n                while(ptr-&gt;next!=NULL)\n                    ptr=ptr-&gt;next;\n                ptr-&gt;next=new_node;\n                new_node-&gt;next=NULL;\n            }\n        }\n        else\n        {\n            printf(\"\\nOut of Memory!\");\n        }\n        printf(\"\\nEnter data\");\n        scanf(\"%d\",&amp;num);\n    }\n    return start;\n}\nstruct Node* display(struct Node* start)\n{\n    struct Node *ptr;\n    ptr=start;\n    while(ptr-&gt;next!=NULL)\n    {\n        printf(\"%d\\t\",ptr-&gt;data);\n        ptr=ptr-&gt;next;\n    }\n    return start;\n}\n</code></pre>\n\n<p>It compiles successfully on gcc compiler on Ubuntu without any errors. However, after running it gives segmentation fault (core dumped) error.</p>\n\n<p>gdb shows that the fault is on  line 59:-</p>\n\n<pre><code>$ gdb -q LS.out\nReading symbols from LS.out...done.\n(gdb) run\nStarting program: /home/arpit/Desktop/Ds/LS.out \n            *******MAIN MENU********\n    1.Create a list\n    2.Display the list1\nEnter -1 to end\nEnter data 4\n\nProgram received signal SIGSEGV, Segmentation fault.\n0x00000000004007de in create_ll (start=0x0) at LS.c:59\n59        while(ptr-&gt;next!=NULL)\n</code></pre>\n"}, {"tags": ["c++", "c", "ssh", "pipe", "putty"], "answers": [{"tags": [], "owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "is_accepted": false, "score": 2, "last_activity_date": 1502562200, "creation_date": 1502562200, "answer_id": 45653539, "question_id": 45570990, "link": "https://stackoverflow.com/questions/45570990/communicating-with-putty-via-pipe/45653539#45653539", "title": "Communicating with PuTTY via pipe", "body": "<p>PuTTY is a GUI application. You cannot communicate with it using input/output redirection.</p>\n\n<p>Use <a href=\"https://the.earth.li/~sgtatham/putty/latest/htmldoc/Chapter7.html\" rel=\"nofollow noreferrer\"><code>plink.exe</code> from PuTTY package</a>. It's a console application with the same set of command-line arguments and features as PuTTY.</p>\n\n<p>Though even better, using some C++ SSH library instead.</p>\n"}, {"comments": [{"owner": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1502883612, "post_id": 45712538, "comment_id": 78383001, "body": "So you have effectively implemented Plink. Why?"}, {"owner": {"reputation": 1985, "user_id": 3144560, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/B4e0Y.jpg?s=128&g=1", "display_name": "Mustafa Chelik", "link": "https://stackoverflow.com/users/3144560/mustafa-chelik"}, "reply_to_user": {"reputation": 144837, "user_id": 850848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c287735beca76400cb9b6d08bf591cb9?s=128&d=identicon&r=PG", "display_name": "Martin Prikryl", "link": "https://stackoverflow.com/users/850848/martin-prikryl"}, "edited": false, "score": 0, "creation_date": 1502970739, "post_id": 45712538, "comment_id": 78426356, "body": "Well putty is not the same as plink. Since customer will use my application, I couldn&#39;t restrict user to use plink. Instead customer will be able to use rich putty with my pipe communication and everything will be good."}], "tags": [], "owner": {"reputation": 1985, "user_id": 3144560, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/B4e0Y.jpg?s=128&g=1", "display_name": "Mustafa Chelik", "link": "https://stackoverflow.com/users/3144560/mustafa-chelik"}, "is_accepted": true, "score": 0, "last_activity_date": 1502883411, "creation_date": 1502883411, "answer_id": 45712538, "question_id": 45570990, "link": "https://stackoverflow.com/questions/45570990/communicating-with-putty-via-pipe/45712538#45712538", "title": "Communicating with PuTTY via pipe", "body": "<p>I found out that PuTTY doesn't have pipe for this purpose and since I didn't want to use plink, I modified PuTTY's source code and embedded pipe in it. Now it works as I want.</p>\n"}], "owner": {"reputation": 1985, "user_id": 3144560, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/B4e0Y.jpg?s=128&g=1", "display_name": "Mustafa Chelik", "link": "https://stackoverflow.com/users/3144560/mustafa-chelik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 1, "accepted_answer_id": 45712538, "answer_count": 2, "score": 1, "last_activity_date": 1502883411, "creation_date": 1502202284, "last_edit_date": 1502562241, "question_id": 45570990, "link": "https://stackoverflow.com/questions/45570990/communicating-with-putty-via-pipe", "title": "Communicating with PuTTY via pipe", "body": "<p>I want to capture PuTTY's STDIN and STDOUT pipes. So I open <code>putty.exe</code> via <strong>CreateProcess</strong> with passing created pipes but I can't read anything from pipes. My code works when I run a bat file.</p>\n\n<p>How can I accomplish this?</p>\n\n<p>Thanks</p>\n\n<pre><code>//This code is from MSDN and I edited it a little\n#include &lt;QCoreApplication&gt;\n#include &lt;windows.h&gt;\n#include &lt;tchar.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;strsafe.h&gt;\n#pragma comment(lib, \"user32.lib\")\n#define BUFSIZE 4096\n\nHANDLE g_hChildStd_IN_Rd = NULL;\nHANDLE g_hChildStd_IN_Wr = NULL;\nHANDLE g_hChildStd_OUT_Rd = NULL;\nHANDLE g_hChildStd_OUT_Wr = NULL;\n\nHANDLE g_hInputFile = NULL;\n\nvoid CreateChildProcess(void);\nvoid WriteToPipe(void);\nvoid ReadFromPipe(void);\nvoid ErrorExit(PTSTR);\n\nint main(int argc, char *argv[])\n{\n    SECURITY_ATTRIBUTES saAttr;\n    // Set the bInheritHandle flag so pipe handles are inherited.\n    saAttr.nLength = sizeof(SECURITY_ATTRIBUTES);\n    saAttr.bInheritHandle = TRUE;\n    saAttr.lpSecurityDescriptor = NULL;\n\n    // Create a pipe for the child process's STDOUT.\n    if ( ! CreatePipe(&amp;g_hChildStd_OUT_Rd, &amp;g_hChildStd_OUT_Wr, &amp;saAttr, 0) )\n        ErrorExit((PTSTR)TEXT(\"StdoutRd CreatePipe\"));\n\n    // Ensure the read handle to the pipe for STDOUT is not inherited.\n    if ( ! SetHandleInformation(g_hChildStd_OUT_Rd, HANDLE_FLAG_INHERIT, 0) )\n        ErrorExit((PTSTR)TEXT(\"Stdout SetHandleInformation\"));\n\n    // Create a pipe for the child process's STDIN.\n    if (! CreatePipe(&amp;g_hChildStd_IN_Rd, &amp;g_hChildStd_IN_Wr, &amp;saAttr, 0))\n        ErrorExit((PTSTR)TEXT(\"Stdin CreatePipe\"));\n\n    // Ensure the write handle to the pipe for STDIN is not inherited.\n    if ( ! SetHandleInformation(g_hChildStd_IN_Wr, HANDLE_FLAG_INHERIT, 0) )\n        ErrorExit((PTSTR)TEXT(\"Stdin SetHandleInformation\"));\n\n    // Create the child process: putty\n    CreateChildProcess();\n\n    // read from pipe and printf incoming data\n    ReadFromPipe();\n}\n\n// Read output from the child process's pipe for STDOUT\n// and write to the parent process's pipe for STDOUT.\n// Stop when there is no more data.\nvoid ReadFromPipe(void)\n{\n   DWORD dwRead, dwWritten;\n   CHAR chBuf[BUFSIZE];\n   BOOL bSuccess = FALSE;\n   HANDLE hParentStdOut = GetStdHandle(STD_OUTPUT_HANDLE);\n\n   for (;;)\n   {\n      bSuccess = ReadFile( g_hChildStd_OUT_Rd, chBuf, BUFSIZE, &amp;dwRead, NULL);\n      if( ! bSuccess || dwRead == 0 )\n          break;\n\n      printf(\"received hex:\\n\");\n      for (int i = 0; i &lt; dwRead; i++)\n      {\n          printf(\"%02X\", chBuf[i]);\n      }\n      printf(\"\\nactual string: %s\\n\",chBuf);\n   }\n}\n\nvoid CreateChildProcess()\n// Create a child process that uses the previously created pipes for STDIN and STDOUT.\n{\n    PROCESS_INFORMATION piProcInfo;\n    STARTUPINFO siStartInfo;\n    BOOL bSuccess = FALSE;\n\n    // Set up members of the PROCESS_INFORMATION structure.\n    ZeroMemory( &amp;piProcInfo, sizeof(PROCESS_INFORMATION) );\n\n    // Set up members of the STARTUPINFO structure.\n    // This structure specifies the STDIN and STDOUT handles for redirection.\n\n    ZeroMemory( &amp;siStartInfo, sizeof(STARTUPINFO) );\n    siStartInfo.cb = sizeof(STARTUPINFO);\n    siStartInfo.hStdError = g_hChildStd_OUT_Wr;\n    siStartInfo.hStdOutput = g_hChildStd_OUT_Wr;\n    siStartInfo.hStdInput = g_hChildStd_IN_Rd;\n    siStartInfo.dwFlags |= STARTF_USESTDHANDLES;\n\n    // Create the child process.\n\n    bSuccess = CreateProcess(L\"E:\\\\putty.exe\",\n                            NULL,          // command line\n                            NULL,          // process security attributes\n                            NULL,          // primary thread security attributes\n                            TRUE,          // handles are inherited\n                            0,             // creation flags\n                            NULL,          // use parent's environment\n                            NULL,          // use parent's current directory\n                            &amp;siStartInfo,  // STARTUPINFO pointer\n                            &amp;piProcInfo);  // receives PROCESS_INFORMATION\n\n   // If an error occurs, exit the application.\n   if ( ! bSuccess )\n      ErrorExit((PTSTR)TEXT(\"CreateProcess\"));\n   else\n   {\n      // Close handles to the child process and its primary thread.\n      // Some applications might keep these handles to monitor the status\n      // of the child process, for example.\n\n      CloseHandle(piProcInfo.hProcess);\n      CloseHandle(piProcInfo.hThread);\n   }\n}\n\n// Format a readable error message, display a message box,\n// and exit from the application.\nvoid ErrorExit(PTSTR lpszFunction)\n{\n    LPVOID lpMsgBuf;\n    LPVOID lpDisplayBuf;\n    DWORD dw = GetLastError();\n\n    FormatMessage(\n        FORMAT_MESSAGE_ALLOCATE_BUFFER |\n        FORMAT_MESSAGE_FROM_SYSTEM |\n        FORMAT_MESSAGE_IGNORE_INSERTS,\n        NULL,\n        dw,\n        MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),\n        (LPTSTR) &amp;lpMsgBuf,\n        0, NULL );\n\n    lpDisplayBuf = (LPVOID)LocalAlloc(LMEM_ZEROINIT,\n        (lstrlen((LPCTSTR)lpMsgBuf)+lstrlen((LPCTSTR)lpszFunction)+40)*sizeof(TCHAR));\n    StringCchPrintf((LPTSTR)lpDisplayBuf,\n        LocalSize(lpDisplayBuf) / sizeof(TCHAR),\n        TEXT(\"%s failed with error %d: %s\"),\n        lpszFunction, dw, lpMsgBuf);\n    MessageBox(NULL, (LPCTSTR)lpDisplayBuf, TEXT(\"Error\"), MB_OK);\n\n    LocalFree(lpMsgBuf);\n    LocalFree(lpDisplayBuf);\n    ExitProcess(1);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1502202108, "post_id": 45570860, "comment_id": 78101123, "body": "It&#39;s not because the <code>printf</code> but because of what you are passing to it. And that can be checked using the debuggger"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1502202212, "post_id": 45570860, "comment_id": 78101201, "body": "If you get a segmentation fault on <code>printf(&quot;%s\\n&quot;, test)</code>, you (a) are lucky and (b) have a null pointer, or perhaps a pointer to random address space that isn&#39;t mapped anywhere.  These days, <code>printf()</code> seems to protect itself from null pointers \u2014 I&#39;m not convinced that&#39;s a good thing \u2014 so your pointer is probably out of control.  Maybe uninitialized.  Or, possibly, you have not null terminated your string so <code>printf()</code> is reading data it isn&#39;t supposed to.  That&#39;s all without looking further than the comment about <code>printf(&quot;%s\\n&quot;, test)</code> crashing."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 1, "creation_date": 1502202521, "post_id": 45570860, "comment_id": 78101448, "body": "<code>Lire_string</code> seems to have paths that don&#39;t return at all."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502202577, "post_id": 45570860, "comment_id": 78101486, "body": "In your function, you have <code>car_cour</code> which is, apparently, a global variable \u2014 I don&#39;t see its definition in the function. And <code>Lire_car</code> is presumably a &#39;read character&#39; function, similar to <code>getc()</code> et al. Note that if <code>realloc()</code> fails, the notation <code>symbole = realloc(symbole, sizeof(char)*(size *= 2));</code> guarantees a memory leak \u2014 you no longer have a pointer to the previously allocated memory because you zapped it with the null return. You should always save the pointer into a local variable and test that before changing the main pointer (<code>symbole</code> being the main pointer in this context)."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1502203594, "post_id": 45570860, "comment_id": 78102308, "body": "@JonathanLeffler actually... GCC optimizes <code>printf(&quot;%s\\n&quot;, test)</code> into <code>puts(test)</code> which doesn&#39;t have NULL protection in glibc ;)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502203854, "post_id": 45570860, "comment_id": 78102521, "body": "PeterJ is correct - you&#39;re missing the return statement completely in case the first <code>if</code> condition is false - then <i>use</i> of the return value from a function that explicitly didn&#39;t return anything has undefined behaviour."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502204092, "post_id": 45570860, "comment_id": 78102729, "body": "Usual case of ignoring warnings - <code>they are so annoying</code>"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1502204151, "post_id": 45570860, "comment_id": 78102782, "body": "Put this right after <code>printf(&quot;%s\\n&quot;,test);</code> and test again: <code>if (test == NULL) {printf(&quot;test == NULL, investigate why\\n&quot;); exit(1);}</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1502204344, "post_id": 45570860, "comment_id": 78102937, "body": "This is a good example why using one return point is safer &amp; easier to read,."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1502204937, "post_id": 45570860, "comment_id": 78103374, "body": "@AnttiHaapala: Yes, I still forget that GCC does those sorts of modifications."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502205645, "post_id": 45570860, "comment_id": 78103852, "body": "@PeterJ I don&#39;t necessarily agree with that. As long as you don&#39;t ignore warnings what&#39;s the harm in multiple return points? And in fact I think its easier to read (multiple <code>return</code>s or <code>goto</code> statements) if your function does a bunch of error checking at the beginning... that saves you from a cascade of indented <code>if</code> statements and a lot of horizontal scrolling."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502206257, "post_id": 45570860, "comment_id": 78104282, "body": "@yano you do not have to. Everyone writes code as consider the best way."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502206754, "post_id": 45570860, "comment_id": 78104651, "body": "@PeterJ ah ok, my apologies,, I interpreted your statement as an accepted rule. I have heard of groups that enforce one <code>return</code> statement per function.. never made sense to me. But if that&#39;s the consensus of the group, fine by me"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502206835, "post_id": 45570860, "comment_id": 78104709, "body": "@yano <code>I have heard of groups</code> - aviation &amp; motor industry for example."}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502206930, "post_id": 45570860, "comment_id": 78104776, "body": "@PeterJ one good example there at least :)"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "edited": false, "score": 0, "creation_date": 1502207040, "post_id": 45570860, "comment_id": 78104848, "body": "@yano misra  - good enough example?"}, {"owner": {"reputation": 2445, "user_id": 3476780, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/abf771bddcd864626a0e1499ccfc699b?s=128&d=identicon&r=PG&f=1", "display_name": "yano", "link": "https://stackoverflow.com/users/3476780/yano"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1502207277, "post_id": 45570860, "comment_id": 78104978, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/151417/discussion-between-yano-and-peterj\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 3, "last_activity_date": 1502204021, "last_edit_date": 1502204021, "creation_date": 1502202730, "answer_id": 45571149, "question_id": 45570860, "link": "https://stackoverflow.com/questions/45570860/segmentation-fault-when-using-printf/45571149#45571149", "title": "Segmentation Fault when using printf", "body": "<p>You probably got some warnings as your function returns something only if <code>car_cour == '\"'</code>. Otherwise there is no explicit return expression</p>\n"}], "owner": {"reputation": 21, "user_id": 8356347, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/20634ca21dded93c0a0ac984f51c6bb6?s=128&d=identicon&r=PG&f=1", "display_name": "Nabila K", "link": "https://stackoverflow.com/users/8356347/nabila-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1502204417, "creation_date": 1502201949, "last_edit_date": 1502204417, "question_id": 45570860, "link": "https://stackoverflow.com/questions/45570860/segmentation-fault-when-using-printf", "title": "Segmentation Fault when using printf", "body": "<p>I'm trying to read from a file and print every string read. However i get a segmentation fault when i try to print it. </p>\n\n<p>Debugging tells me that my error is because of the line : <code>printf(\"%s\\n\",test);</code></p>\n\n<p>My function for retrieving the strings is : </p>\n\n<pre><code>char* Lire_string(){\n     size_t size = 10 ;\n     char *symbole ;\n     symbole = realloc(NULL, sizeof(char)*size);\n     size_t len = 0 ;\n     if(!symbole) return symbole ; \n     car_cour = Lire_car(fichier);\n     if (car_cour == '\"'){\n         do {\n            symbole[len] = car_cour ;\n            car_cour = Lire_car(fichier);\n            len++;\n            if(len==size){\n                symbole = realloc(symbole, sizeof(char)*(size *= 2));\n                if(!symbole) return symbole ;\n            }\n         }while(car_cour != '\"' );\n\n         symbole[len] = car_cour ;\n\n         symbole[len++] = '\\0' ;\n\n         return realloc(symbole, sizeof(char)*len) ;\n     }\n}   \n</code></pre>\n\n<p>My main is :    </p>\n\n<pre><code>fichier = fopen(\"export.json\",\"r\");\n\nif ((fichier != NULL)){\n    do {\n       char* test = Lire_string();\n       printf(\"%s\\n\",test);\n       free(test);\n    } while (feof(fichier)==0);\n}\nelse {\n    exit(EXIT_FAILURE);\n}\nreturn 0;\n</code></pre>\n\n<p>I tried looking at similar questions but they didn't resolve my problem. </p>\n"}]