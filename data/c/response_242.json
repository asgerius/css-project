[{"tags": ["c", "header-files", "configure", "autotools"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1567036432, "post_id": 57701192, "comment_id": 101846373, "body": "<code>gcc -MM myfile.c</code>"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1567036886, "post_id": 57701192, "comment_id": 101846438, "body": "@wildplasser that doesn&#39;t take into account any configuration does it?  It seems <code>pkg-config --cflags-only-I</code> would work, but I have to look into how to create the config file I think"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1567038306, "post_id": 57701192, "comment_id": 101846667, "body": "also, it doesn&#39;t account for includes to any non-standard locations that would be found with <code>configure</code>, eg. <code>pkg-config --cflags-only-I cairo</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567039991, "post_id": 57701192, "comment_id": 101846951, "body": "Umm... Try to <code>make</code> and install headers until it works? Usually the project lists its dependencies."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567040169, "post_id": 57701192, "comment_id": 101846981, "body": "I assume that this is an XY problem, and you&#39;re trying to find all the include files needed to compile a project (e.g. emacs) without looking at the dependency list?"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567040348, "post_id": 57701192, "comment_id": 101847013, "body": "I have no problem compiling these projects as they are managed with autotools.  You&#39;re probably familiar with autotools - but it will find and configure paths specific to the site.  I need the site-specific paths (my specific use-case right now is for macroexpansion)"}], "answers": [{"comments": [{"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567042331, "post_id": 57701833, "comment_id": 101847367, "body": "thanks, yes that was what I meant, and this is what I was looking for.  However, this doesn&#39;t help much since the .d files only have local dependencies.  So, I still need to add all system include paths manually (that aren&#39;t in the standard directories)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567052624, "post_id": 57701833, "comment_id": 101849181, "body": "@jenesaisquoi, <code>gcc -MM</code> ignores headers found in system header directories.  This is what distinguishes it from <code>gcc -M</code>, which lists all includes.  I suppose you could modify the makefile after generating it to replace the former with the latter."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567053041, "post_id": 57701833, "comment_id": 101849262, "body": "right, I understand that.  The generated makefiles do already have all the system paths, though, in variables like <code>DBUS_CFLAGS</code> that are determined by <code>configure</code>.  There just doesn&#39;t seem to be a standard way, no target, to list them.  I thought there would be, eg. to generate a <code>pkg-config</code> file -- the <code>pkg-config</code> man page even says the file would probably be generated by <code>configure</code>, but doesn&#39;t expand on that"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567053202, "post_id": 57701833, "comment_id": 101849278, "body": "I believe the autoconf macro is <code>AC_CHECK_MODULES</code> or <code>PKG_CHECK_MODULES</code> that create these standard <code>*_CFLAGS</code> variables"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567053621, "post_id": 57701833, "comment_id": 101849362, "body": "last note, <code>gcc -M</code> isn&#39;t sufficient since it doesn&#39;t find non-standard locations (as <code>configure</code> would using <code>pkg-config</code>), so any system includes it returned would already be found by default anyway"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567054395, "post_id": 57701833, "comment_id": 101849537, "body": "@jenesaisquoi, <code>gcc -M</code> finds the actual resolution of each <code>#include</code> directive processed, subject to the compile flags in effect.  As used in an Automake-based build script, this is done in conjunction with regular compilation, not separately, so what ends up getting written to <code>.deps</code> reflects what is actually used, whether in standard directories or not."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567054818, "post_id": 57701833, "comment_id": 101849632, "body": "@jenesaisquoi, a build system that wants to create a <code>pkg-config</code> file might indeed choose to do so via its <code>configure</code> script, but that&#39;s a general sentiment, not an allusion to any special capability of Autoconf.  It simply happens to be that to do its job, <code>configure</code> has to be written with knowledge of what dependencies need to be accounted for, and it has -- or reasonably can be assigned -- responsibility for locating them.  That makes it well suited for emitting <code>pkg-config</code> data."}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567054889, "post_id": 57701833, "comment_id": 101849656, "body": "yea, I see what you mean -- rebuild the depends entirely using -M.  I don&#39;t know why I interpreted that as running outside the makefile.  It might work, but wouldn&#39;t simplify things, and would make the depends brittle themselves"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567054977, "post_id": 57701833, "comment_id": 101849672, "body": "ok, it still seems like it could be a standard target though.  Configure would know the dependencies the user specified and could output the proper cflags accordingly"}, {"owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "edited": false, "score": 0, "creation_date": 1567055129, "post_id": 57701833, "comment_id": 101849701, "body": "I guess I&#39;ll just accept this isn&#39;t directly supported by autotools and write my own script. Thanks!"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1567041858, "creation_date": 1567041858, "answer_id": 57701833, "question_id": 57701192, "link": "https://stackoverflow.com/questions/57701192/get-list-of-all-includes-for-project-compiled-with-gnu-autotools/57701833#57701833", "title": "Get list of all includes for project compiled with GNU autotools", "body": "<blockquote>\n  <p>For a C project managed and compiled using GNU autotools, eg. emacs,\n  is there a simple way to get a list of all the included headers that\n  <em>were</em> required to compile the project?</p>\n</blockquote>\n\n<p>If by \"were required\" you mean that you want to make the determination after the project is successfully built, then yes.  Unless suppressed, Automake-based makefiles have rules for generating include-dependency lists, which they use on subsequent builds to recognize the need to rebuild unchanged sources on account of changes to dependencies.  You can find these files in the <code>.deps</code> subdirectory.</p>\n\n<p>For what it's worth, when compiling with <code>gcc</code>, the <code>gcc -MM</code> command is used for the purpose.</p>\n"}], "owner": {"reputation": 28248, "user_id": 2415684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e0fb12778bde5d0dddddd3b8b619681b?s=128&d=identicon&r=PG", "display_name": "Rorschach", "link": "https://stackoverflow.com/users/2415684/rorschach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 57701833, "answer_count": 1, "score": -1, "last_activity_date": 1567042193, "creation_date": 1567035056, "last_edit_date": 1567042193, "question_id": 57701192, "link": "https://stackoverflow.com/questions/57701192/get-list-of-all-includes-for-project-compiled-with-gnu-autotools", "title": "Get list of all includes for project compiled with GNU autotools", "body": "<p>For a C project managed and successfully compiled using GNU autotools, eg. emacs, is there a simple way to get a list of all the included headers that <em>were</em> required to compile the project (the site-specific include paths that were found by the <code>configure</code> script during compilation)?</p>\n\n<p>My current approach has just been to </p>\n\n<ol>\n<li>run <code>cpp -C ...</code></li>\n<li>look at the error for a missing header</li>\n<li>manually add the path to the required header to my command</li>\n<li>repeat until there are no more errors.</li>\n</ol>\n\n<p>Obviously, this is a pain.  I would think a project compiled using <code>configure</code> would have this information somewhere.  Does it?</p>\n"}, {"tags": ["c", "warnings"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1567030520, "post_id": 57700641, "comment_id": 101845248, "body": "The format expects an integer and a double (<code>%d</code> and <code>%.2f</code>); you pass ta double (the expression <code>MOVE_FORWARD * i</code> is a floating point number), an integer (<code>i</code>)  and a double (<code>MOVE_FORWARD</code>).  Decide what you&#39;re really trying to print and adjust the format string and/or the the other arguments accordingly.  You might need <code>&quot;%.2f | %.2d | %2.f\\n&quot;</code>, for example.  Spaces before newlines are rarely desirable."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 1, "creation_date": 1567030705, "post_id": 57700641, "comment_id": 101845279, "body": "You&#39;re passing too many arguments for your format string.  It <i>looks</i> like you meant to write <code>printf(&quot;%d      |%.2f \\n&quot;, i, MOVE_FORWARD * i);</code> - IOW, the value on the left of the <code>|</code> is the row number (<code>i</code>), and the value on the right is the movement for that row (<code>MOVE_FORWARD * i)</code>."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1567033049, "post_id": 57700641, "comment_id": 101845763, "body": "@Harman The comment above yours shows the fix."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 2, "creation_date": 1567034544, "post_id": 57700641, "comment_id": 101846036, "body": "You can&#39;t print an <code>int</code> with <code>%f</code>.  You can&#39;t print a <code>float</code> or a <code>double</code> with <code>%d</code>.  Simple as that."}], "answers": [{"tags": [], "owner": {"reputation": 274, "user_id": 11643854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UgDE.jpg?s=128&g=1", "display_name": "arvind", "link": "https://stackoverflow.com/users/11643854/arvind"}, "is_accepted": false, "score": 3, "last_activity_date": 1567086157, "last_edit_date": 1567086157, "creation_date": 1567059878, "answer_id": 57704166, "question_id": 57700641, "link": "https://stackoverflow.com/questions/57700641/warnings-data-format-specifies/57704166#57704166", "title": "Warnings Data/Format specifies", "body": "<p>In the line</p>\n\n<pre><code>printf(\"%d      |%.2f \\n\", MOVE_FORWARD * i, i, MOVE_FORWARD);\n</code></pre>\n\n<p>You are doing three things wrong:</p>\n\n<p>i) You used more arguments than format specifiers, you have 2 format specifiers and used 3 arguments namely (MOVE_FORWARD *i), (i) and MOVE_FORWARD \n, you used printf to print only 2.</p>\n\n<p>ii) You used wrong specifiers, MOVE_FORWARD * i is of type double, not integer.</p>\n\n<p>iii) i is of type integer not double.</p>\n\n<p>The correct way should be:</p>\n\n<pre><code> printf(\"%f      |%d \\n\", MOVE_FORWARD * i, i);\n</code></pre>\n\n<p>if you want to print those two.</p>\n"}], "owner": {"reputation": 15, "user_id": 11991491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7364663a203f3d623fea2b1d66346d02?s=128&d=identicon&r=PG&f=1", "display_name": "Harman", "link": "https://stackoverflow.com/users/11991491/harman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1568754340, "answer_count": 1, "score": 2, "last_activity_date": 1568730980, "creation_date": 1567030201, "last_edit_date": 1568730980, "question_id": 57700641, "link": "https://stackoverflow.com/questions/57700641/warnings-data-format-specifies", "closed_reason": "Not suitable for this site", "title": "Warnings Data/Format specifies", "body": "<p>I got some warning in my code. Is there someone who can help me?\nI tried to change %d to %f but the program will then not work as I want to, like with the warnings.</p>\n"}, {"tags": ["c", "fpga", "mmap"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11990986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea795c7abc8742dc0ec01bce3b5de714?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko123", "link": "https://stackoverflow.com/users/11990986/jacko123"}, "edited": false, "score": 0, "creation_date": 1567097303, "post_id": 57700686, "comment_id": 101871219, "body": "Thank you for your quick response, how do I find out the correct page? And where you say I need to mmap the correct page would that mean changing the DDR_RAM_PHYS from current value to a new defined value? Or do I add the \u2018&amp;\u2019 sign after like this map = mmap(0, MAPPED_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED, _fdmem, DDR_RAM_PHYS &amp; -pagesize);? Do you know of any good sources of information I can read regarding this topic?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 11, "user_id": 11990986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea795c7abc8742dc0ec01bce3b5de714?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko123", "link": "https://stackoverflow.com/users/11990986/jacko123"}, "edited": false, "score": 0, "creation_date": 1567099036, "post_id": 57700686, "comment_id": 101871974, "body": "@Jacko123: Exactly what you wrote there in the comment. The <code>&amp;</code> masks off bits, and since <code>PAGESIZE</code> is a power of 2 (typically <code>0x1000</code>), <code>-PAGESIZE</code> is a mask to remove all the lower bits - assuming unsigned 64-bit type and 4k pages, <code>-PAGESIZE</code> is <code>0xfffffffffffff000</code>. If <code>PAGESIZE</code> is not constant for the arch, you get it via <code>sysconf(_SC_PAGESIZE)</code>."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1567030542, "creation_date": 1567030542, "answer_id": 57700686, "question_id": 57700606, "link": "https://stackoverflow.com/questions/57700606/mmap-keeps-returning-map-failed-whe-trying-to-read-or-write-to-a-pio-address-o/57700686#57700686", "title": "mmap() keeps returning MAP_FAILED whe trying to read or write to a PIO address on cyclone V FPGA", "body": "<p><code>0xff205010</code> is not a valid <code>mmap</code> offset: it's not page-aligned. Also, adding <code>0xff205010</code> to map would not be valid even if it were; map would already refer to that physical address.</p>\n\n<p>Instead, You need to <code>mmap</code> the correct page (<code>0xff205010 &amp; -PAGESIZE</code>) then use (<code>0xff205010 % PAGESIZE</code>) as the offset into the mapping.</p>\n"}], "owner": {"reputation": 11, "user_id": 11990986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea795c7abc8742dc0ec01bce3b5de714?s=128&d=identicon&r=PG&f=1", "display_name": "Jacko123", "link": "https://stackoverflow.com/users/11990986/jacko123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567059594, "creation_date": 1567029983, "last_edit_date": 1567059594, "question_id": 57700606, "link": "https://stackoverflow.com/questions/57700606/mmap-keeps-returning-map-failed-whe-trying-to-read-or-write-to-a-pio-address-o", "title": "mmap() keeps returning MAP_FAILED whe trying to read or write to a PIO address on cyclone V FPGA", "body": "<p>I am trying to write an integer (1114129) from my HPS on <strong>Cyclone V Altera FPGA</strong> from a <strong>PUTTY</strong> window to a 32bit PIO on the FPGA side via lightweight axis interface. I am using mmap() and cannot get it to work, have been trying for months. </p>\n\n<p>I have set up the hardware side correctly because I was able to read from another 32bit PIO at the address 0xff205000, this works fine but I can't read or write to the second PIO. I have tried multiple different addresses as well and it doesn't seem to make a difference.</p>\n\n<p>Here is the error I get, which is because of mmap returns <code>MAP_FAILED</code></p>\n\n<pre><code>open /dev/mem successfully !\nnpheap_alloc(): Invalid argument\n#\n</code></pre>\n\n<p>As you can see above the file is opened correctly and then it fails on the mmap call.</p>\n\n<p>Below is the c code im using. There are no compiling issues.\nIf anyone could help or even point me in the right direction i would be really appreciative its driving me insane.</p>\n\n<pre><code>#define MAPPED_SIZE 4\n\n#define DDR_RAM_PHYS 0xff205010\n\nint main(void)\n\n\n{\n\n        int _fdmem;\n        void *map;\n\n        const char memDevice[] = \"/dev/mem\";\n        _fdmem = open( memDevice, O_RDWR | O_SYNC );\n\n        if (_fdmem &lt; 0){\n                printf(\"Failed to open the /dev/mem !\\n\");\n                return 0;\n        }\n        else{\n                printf(\"open /dev/mem successfully !\\n\");\n        }\n\n        /* mmap() the opened /dev/mem */\n        map = mmap(0, MAPPED_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED, _fdmem, DDR_RAM_PHYS);\n\n\n\n\n          if (map == MAP_FAILED) { perror(\"npheap_alloc()\"); exit(1); }\n\n        *(unsigned int*)(map+(0xff205010)) = (unsigned short)1114129;\n        //int *q = (int *)map;\n        //*q = 1114129;\n\n\n\n        /* unmap the area &amp; error checking */\n        if (munmap(map,MAPPED_SIZE)==-1){\n               perror(\"Error un-mmapping the file\");\n        }\n\n\n\n        /* close the character device */\n        close(_fdmem);\n}\n</code></pre>\n"}, {"tags": ["c", "memcpy"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1567028581, "post_id": 57700376, "comment_id": 101844760, "body": "I suspect you meant <code>memcpy(Test-&gt;data, buffer, sizeof(buffer))</code> with (no <code>&amp;</code>)."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1567028959, "post_id": 57700376, "comment_id": 101844871, "body": "I&#39;m voting to close this as &quot;simple typographical error&quot;; Remove <code>&amp;</code> and the result should be fine."}, {"owner": {"reputation": 31, "user_id": 8485097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df3d40b570e303e8dff79146e9f5915?s=128&d=identicon&r=PG&f=1", "display_name": "ViperG", "link": "https://stackoverflow.com/users/8485097/viperg"}, "edited": false, "score": 0, "creation_date": 1567029032, "post_id": 57700376, "comment_id": 101844892, "body": "ah yes that&#39;s correct. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8485097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df3d40b570e303e8dff79146e9f5915?s=128&d=identicon&r=PG&f=1", "display_name": "ViperG", "link": "https://stackoverflow.com/users/8485097/viperg"}, "edited": false, "score": 0, "creation_date": 1567029049, "post_id": 57700413, "comment_id": 101844900, "body": "ah yes that is correct"}], "tags": [], "owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "is_accepted": true, "score": 2, "last_activity_date": 1567028620, "creation_date": 1567028620, "answer_id": 57700413, "question_id": 57700376, "link": "https://stackoverflow.com/questions/57700376/memcpy-confusion-overflow-overwriting-with-gcc/57700413#57700413", "title": "memcpy confusion overflow / overwriting with gcc?", "body": "<blockquote>\n  <p><code>memcpy(&amp;Test-&gt;data, buffer, sizeof(buffer));</code></p>\n</blockquote>\n\n<p>You are passing the address of variable <code>data</code>, which is a pointer, and copying to it more bytes than its boundaries, that is why variable <code>data2</code> is modified (as a pointer, <code>Test-&gt;data</code> have 4 or 8 bytes depending on the architecture you are running the code).</p>\n\n<p>You probably want to pass <code>Test-&gt;data</code> to <code>memcpy</code> as its <code>dst</code> parameter, not <code>&amp;Test-&gt;data</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 8485097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3df3d40b570e303e8dff79146e9f5915?s=128&d=identicon&r=PG&f=1", "display_name": "ViperG", "link": "https://stackoverflow.com/users/8485097/viperg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1567033887, "accepted_answer_id": 57700413, "answer_count": 1, "score": 0, "last_activity_date": 1567028620, "creation_date": 1567028368, "question_id": 57700376, "link": "https://stackoverflow.com/questions/57700376/memcpy-confusion-overflow-overwriting-with-gcc", "closed_reason": "Not suitable for this site", "title": "memcpy confusion overflow / overwriting with gcc?", "body": "<p>Not sure what im doing wrong here. Im guessing its memory alignment issue but its confusing as to why that would be occurring. Tested locally with gcc 7.4.0 and onlinegdb.com. (can copy code here and paste / compile to confirm)</p>\n\n<p>Works with converting data types to char/uint8_t but int or short/uint16_t does not work (data2 struct member gets modified). </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nstruct test {\n    int *data;\n    int *data2;\n};\n\nstruct test *Test=NULL;\nint buffer[] = {1,2,3,4,5};\n\nint main()\n{\n    Test = malloc(sizeof(struct test));\n    memset(Test, 0, sizeof(struct test));\n\n    printf(\"Before memcpy %d\\r\\n\", Test-&gt;data2);\n\n    Test-&gt;data = malloc(sizeof(buffer));\n    memcpy(&amp;Test-&gt;data, buffer, sizeof(buffer));\n\n    printf(\"After memcpy %d\\r\\n\", Test-&gt;data2);\n\n    return 0;\n}\n\n\ndata2 struct member is expected to be 0, however the value has changed after the memcpy for struct member data is executed.\n\nOutput:\n\nBefore memcpy 0\nAfter memcpy 3\n</code></pre>\n"}, {"tags": ["c", "assembly", "extern", "libc"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1567025639, "post_id": 57699864, "comment_id": 101843748, "body": "<code>objdump -dR test</code> may be enlightening.  Also, don&#39;t you need a <code>ret</code> in the definition of <code>foo</code>?  Also also, <code>swapcontext</code> has abnormal control flow, you need to take special care to call it safely."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1567025640, "post_id": 57699864, "comment_id": 101843749, "body": "Appears you OBJDUMP&#39;ed an object file that has relocations. Try OBJDUMPing the final executable or OBJDUMP a <code>.o</code> file using the <code>-r</code> option to show relocation entries."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567026190, "post_id": 57699864, "comment_id": 101843945, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, please. This doesn&#39;t reproduce the behavior, and doesn&#39;t work when run."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567026592, "post_id": 57699864, "comment_id": 101844103, "body": "... What&#39;s <code># 200fd0 &lt;swapcontext@GLIBC_2.2.5&gt;</code>, then?"}, {"owner": {"reputation": 95, "user_id": 4059914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe428c524a7e8770edcbf5d8660e57d0?s=128&d=identicon&r=PG&f=1", "display_name": "cradical", "link": "https://stackoverflow.com/users/4059914/cradical"}, "edited": false, "score": 0, "creation_date": 1567027603, "post_id": 57699864, "comment_id": 101844448, "body": "I&#39;ve updated the original example to make it a valid by using puts with the argument to it stored in %rdi. I&#39;ve also indicated the failure when I run it."}, {"owner": {"reputation": 95, "user_id": 4059914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe428c524a7e8770edcbf5d8660e57d0?s=128&d=identicon&r=PG&f=1", "display_name": "cradical", "link": "https://stackoverflow.com/users/4059914/cradical"}, "edited": false, "score": 0, "creation_date": 1567027684, "post_id": 57699864, "comment_id": 101844466, "body": "Interesting - when I add &#39;-no-pie&#39; to the compile argument, it works fine. Any ideas why?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567030123, "post_id": 57699864, "comment_id": 101845151, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52126328/cant-call-c-standard-library-function-on-64-bit-linux-from-assembly-yasm-code\">Can&#39;t call C standard library function on 64-bit Linux from assembly (yasm) code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1567027094, "last_edit_date": 1567027094, "creation_date": 1567026047, "answer_id": 57699984, "question_id": 57699864, "link": "https://stackoverflow.com/questions/57699864/call-libc-function-from-assembly/57699984#57699984", "title": "Call libc function from assembly", "body": "<p>You appear to be disassembling an object file with relocations.</p>\n\n<p>Relocations are stubs for the linker to resolve when the file is loaded.</p>\n\n<p>To properly view the relocations and symbol names, use <code>objdump -dr test</code> or <code>objdump -dR test</code>.</p>\n\n<p>The output will be similar to this:</p>\n\n<pre><code>0000000000000000 &lt;foo&gt;:\n   0:   e8 00 00 00 00          callq  5 &lt;foo+0x5&gt;\n                        1: R_X86_64_PLT32       swapcontext-0x4\n</code></pre>\n\n<p>You may also consider adding a <code>ret</code> instruction at the end of <code>foo</code>, just in case <code>swapcontext</code> errors.</p>\n\n<p>As shown by your <code>objdump -dR</code> output, both of these refer to libc functions:</p>\n\n<pre><code>            670: R_X86_64_PC32  swapcontext@GLIBC_2.2.5-0x4\n        # 200fd0 &lt;swapcontext@GLIBC_2.2.5&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 4059914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe428c524a7e8770edcbf5d8660e57d0?s=128&d=identicon&r=PG&f=1", "display_name": "cradical", "link": "https://stackoverflow.com/users/4059914/cradical"}, "edited": false, "score": 0, "creation_date": 1567028749, "post_id": 57700357, "comment_id": 101844813, "body": "Thank you for those links, those completely explained that concisely!"}, {"owner": {"reputation": 95, "user_id": 4059914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe428c524a7e8770edcbf5d8660e57d0?s=128&d=identicon&r=PG&f=1", "display_name": "cradical", "link": "https://stackoverflow.com/users/4059914/cradical"}, "edited": false, "score": 0, "creation_date": 1567028831, "post_id": 57700357, "comment_id": 101844831, "body": "As for the updating of the original post, I was attempting to create a valid example (as opposed to the one I had originally that invoked swapcontext), and provide not just the disassembled output, but the eventual failure I ran into it as well. Thank you for your patience!"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1567030186, "last_edit_date": 1567030186, "creation_date": 1567028203, "answer_id": 57700357, "question_id": 57699864, "link": "https://stackoverflow.com/questions/57699864/call-libc-function-from-assembly/57700357#57700357", "title": "Call libc function from assembly", "body": "<p>For your updated totally separate question, which replaced your question about disassembling a <code>.o</code>:</p>\n\n<p>semi-related: <a href=\"https://stackoverflow.com/questions/56760086/unexpected-value-of-a-function-pointer-local-variable\">Unexpected value of a function pointer local variable</a> mentions the fact that the linker transforms references to <code>puts</code> to <code>puts@plt</code> for you in a non-PIE (because that lets you get efficient code if statically linking), but not in a PIE.</p>\n\n<p><strong>libc gets mapped more than 2GiB away from the main executable so a <code>call rel32</code> can't reach it.</strong></p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/52126328/cant-call-c-standard-library-function-on-64-bit-linux-from-assembly-yasm-code\">Can&#39;t call C standard library function on 64-bit Linux from assembly (yasm) code</a>, which shows AT&amp;T and NASM syntax for calling libc functions from a PIE executable, either via the PLT <code>call puts@plt</code> or <code>gcc -fno-plt</code> style with <code>call *puts@gotpcrel(%rip)</code>.</p>\n"}], "owner": {"reputation": 95, "user_id": 4059914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe428c524a7e8770edcbf5d8660e57d0?s=128&d=identicon&r=PG&f=1", "display_name": "cradical", "link": "https://stackoverflow.com/users/4059914/cradical"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "accepted_answer_id": 57700357, "answer_count": 2, "score": 0, "last_activity_date": 1567030186, "creation_date": 1567025369, "last_edit_date": 1567029112, "question_id": 57699864, "link": "https://stackoverflow.com/questions/57699864/call-libc-function-from-assembly", "title": "Call libc function from assembly", "body": "<p>I have a function defined in assembly that is calling a libc function (swapcontext). I invoke that function from my C code. For the purpose of creating a reproducible example, I'm using 'puts' instead:</p>\n\n<p>foo.S:</p>\n\n<pre><code>.globl foo \nfoo:\n    call puts\n    ret\n</code></pre>\n\n<p>test.c:</p>\n\n<pre><code>void foo(char *str);\n\nint main() {\n    foo(\"Hello World\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Compile:</p>\n\n<pre><code>gcc test.c foo.S  -o test\n</code></pre>\n\n<p>This compiles fine. Dis-assembling the result binary however shows that a valid call instruction wasn't inserted by the linker:</p>\n\n<p>objdump -dR:</p>\n\n<pre><code>0000000000000671 &lt;foo&gt;:\n 671:   e8 00 00 00 00          callq  676 &lt;foo+0x5&gt;\n            672: R_X86_64_PC32  puts@GLIBC_2.2.5-0x4\n 676:   c3                      retq   \n 677:   66 0f 1f 84 00 00 00    nopw   0x0(%rax,%rax,1)\n 67e:   00 00 \n\n0000000000000530 &lt;puts@plt&gt;:\n 530:   ff 25 9a 0a 20 00       jmpq   *0x200a9a(%rip)        # 200fd0 &lt;puts@GLIBC_2.2.5&gt;\n 536:   68 00 00 00 00          pushq  $0x0\n 53b:   e9 e0 ff ff ff          jmpq   520 &lt;.plt&gt;\n</code></pre>\n\n<p>Execution:</p>\n\n<pre><code>./test1: Symbol `puts' causes overflow in R_X86_64_PC32 relocation\nSegmentation fault\n</code></pre>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["c", "gtk", "cairo"], "comments": [{"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 1, "creation_date": 1567182297, "post_id": 57699050, "comment_id": 101900754, "body": "Why do you want to draw to your window in <code>main()</code>? At this point, your window is most likely not yet visible and any drawing (done on X11) will just be lost. I guess the <code>NULL</code> you get is because there is no <code>GdkWindow</code> yet for your <code>GtkWindow</code>. Please have a look at <a href=\"https://developer.gnome.org/gtk3/stable/ch01s05.html\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/ch01s05.html</a>."}, {"owner": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 1, "creation_date": 1567182370, "post_id": 57699050, "comment_id": 101900793, "body": "Also, per <a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-get-window\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/&hellip;</a>, the only way <code>gtk_widget_get_window</code> returns <code>NULL</code> is if the widget is not yet realized. See also <a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-show\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-sh&zwnj;&#8203;ow</a> and <a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-show-now\" rel=\"nofollow noreferrer\">developer.gnome.org/gtk3/stable/&hellip;</a>."}, {"owner": {"reputation": 712, "user_id": 11970791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f443759c7916eb3c44f6350acb1d118?s=128&d=identicon&r=PG&f=1", "display_name": "Parsa Mousavi", "link": "https://stackoverflow.com/users/11970791/parsa-mousavi"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1568714666, "post_id": 57699050, "comment_id": 102353862, "body": "I just needed a way to create a cairo object to use for drawing and seems &quot;cairo_create()&quot; in that example from gnome website gets the job done.Also I need an alternation to my coding style so that never put all those stuff in main routine.Thanks in advance @Uli Schlachter"}, {"owner": {"reputation": 712, "user_id": 11970791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f443759c7916eb3c44f6350acb1d118?s=128&d=identicon&r=PG&f=1", "display_name": "Parsa Mousavi", "link": "https://stackoverflow.com/users/11970791/parsa-mousavi"}, "reply_to_user": {"reputation": 7642, "user_id": 436275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72a51d31e40d541a9786e0243678029?s=128&d=identicon&r=PG", "display_name": "Uli Schlachter", "link": "https://stackoverflow.com/users/436275/uli-schlachter"}, "edited": false, "score": 0, "creation_date": 1568715141, "post_id": 57699050, "comment_id": 102354099, "body": "And also working directly with cairo is a better practice since there&#39;s no need to worry about gdk and those cumbersome warnings(gdk_cairo_create)."}], "answers": [{"tags": [], "owner": {"reputation": 229, "user_id": 2062604, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/52fdef07948ee8c648517fa76935500f?s=128&d=identicon&r=PG", "display_name": "user2062604", "link": "https://stackoverflow.com/users/2062604/user2062604"}, "is_accepted": false, "score": 0, "last_activity_date": 1567719218, "creation_date": 1567719218, "answer_id": 57813235, "question_id": 57699050, "link": "https://stackoverflow.com/questions/57699050/how-to-create-a-cairo-object-within-a-gtk-window-in-gtk3/57813235#57813235", "title": "How to create a cairo object within a gtk window in GTK+3", "body": "<p>I'm not positive, but I think you're trying to get the GdkWindow before it is ready. I think you need to connect to the window's \"realize\" signal, and only when that signal has been emitted should you try to access the underlying GdkWindow.</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;cairo.h&gt;\n\n\nvoid OnWindowRealize(GtkWidget *pWidget, gpointer data)\n{\n    GdkWindow *pUnderlyingWindow = gtk_widget_get_window(pWidget);\n\n    cairo_region_t *region = cairo_region_create();\n\n    GdkDrawingContext *gc = gdk_window_begin_draw_frame(pUnderlyingWindow, (const cairo_region_t*)&amp;region);\n\n    //etc...\n}\n\n\nvoid main(int argc , char **argv)\n{\n    gtk_init(&amp;argc , &amp;argv);\n\n    GtkWidget *win = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n    g_signal_connect(G_OBJECT(win), \"realize\", OnWindowRealize, NULL);\n\n    //etc...\n}\n\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10263, "user_id": 518853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IjKPw.png?s=128&g=1", "display_name": "liberforce", "link": "https://stackoverflow.com/users/518853/liberforce"}, "is_accepted": false, "score": 1, "last_activity_date": 1568881591, "last_edit_date": 1568881591, "creation_date": 1568640370, "answer_id": 57957888, "question_id": 57699050, "link": "https://stackoverflow.com/questions/57699050/how-to-create-a-cairo-object-within-a-gtk-window-in-gtk3/57957888#57957888", "title": "How to create a cairo object within a gtk window in GTK+3", "body": "<p>In GTK+ 3, you're supposed to do your drawing in response to the <code>draw</code> signal. Doing it in the main makes no sense (the widgets have just been created, but initializing them further in done when running the main event loop).</p>\n\n<p>Please read: <a href=\"https://developer.gnome.org/gtk3/stable/chap-drawing-model.html\" rel=\"nofollow noreferrer\">https://developer.gnome.org/gtk3/stable/chap-drawing-model.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 746, "user_id": 6702598, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZQB0.png?s=128&g=1", "display_name": "DarkTrick", "link": "https://stackoverflow.com/users/6702598/darktrick"}, "is_accepted": true, "score": 3, "last_activity_date": 1573790105, "creation_date": 1573790105, "answer_id": 58870107, "question_id": 57699050, "link": "https://stackoverflow.com/questions/57699050/how-to-create-a-cairo-object-within-a-gtk-window-in-gtk3/58870107#58870107", "title": "How to create a cairo object within a gtk window in GTK+3", "body": "<p>The below is the complete source code to get Cairo working under GTK 3. It should be compilable as is.</p>\n\n<p>As the others already pointed out, you have to use the draw signal to make things work.</p>\n\n<pre><code>    #include &lt;gtk/gtk.h&gt;\n    #include &lt;cairo.h&gt;\n\n    // ------------------------------------------------------------\n\n    gboolean on_draw (GtkWidget *widget,\n                    GdkEventExpose *event,\n                    gpointer data) \n    {\n\n        // \"convert\" the G*t*kWidget to G*d*kWindow (no, it's not a GtkWindow!)\n        GdkWindow* window = gtk_widget_get_window(widget);  \n\n        cairo_region_t * cairoRegion = cairo_region_create();\n\n        GdkDrawingContext * drawingContext;\n        drawingContext = gdk_window_begin_draw_frame (window,cairoRegion);\n\n        { \n            // say: \"I want to start drawing\"\n            cairo_t * cr = gdk_drawing_context_get_cairo_context (drawingContext);\n\n            { // do your drawing\n                cairo_move_to(cr, 30, 30);\n                cairo_set_font_size(cr,15);\n                cairo_show_text(cr, \"hello world\");\n            }\n\n            // say: \"I'm finished drawing\n            gdk_window_end_draw_frame(window,drawingContext);\n        }\n\n        // cleanup\n        cairo_region_destroy(cairoRegion);\n\n        return FALSE;\n    }\n\n    // ------------------------------------------------------------\n\n    int main (int argc, char * argv[]) {\n        gtk_init(&amp;argc, &amp;argv);\n\n        GtkWindow * window; \n        { // window setup\n            window = (GtkWindow*)gtk_window_new(GTK_WINDOW_TOPLEVEL);\n            gtk_window_set_default_size (window, 200, 200);\n            gtk_window_set_position     (window, GTK_WIN_POS_CENTER);\n            gtk_window_set_title        (window, \"Drawing\");\n\n            g_signal_connect(window, \"destroy\", gtk_main_quit, NULL);\n        }  \n\n        // create the are we can draw in\n        GtkDrawingArea* drawingArea;\n        {\n            drawingArea = (GtkDrawingArea*) gtk_drawing_area_new();\n            gtk_container_add(GTK_CONTAINER(window), (GtkWidget*)drawingArea);\n\n            g_signal_connect((GtkWidget*)drawingArea, \"draw\", G_CALLBACK(on_draw), NULL);    \n        }  \n\n\n        gtk_widget_show_all ((GtkWidget*)window);\n        gtk_main();\n\n        return 0;\n    }\n\n\n\n    // ------------------------------------------------------------\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1504, "user_id": 1173521, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e53bbfee240b8cbd7af6e5629968a48b?s=128&d=identicon&r=PG", "display_name": "samvv", "link": "https://stackoverflow.com/users/1173521/samvv"}, "edited": false, "score": 0, "creation_date": 1611689497, "post_id": 61981101, "comment_id": 116530723, "body": "I&#39;m having the same problem. I think cairo_region_create returns a rectanglular region with width 0 and height 0 by default. It&#39;s the only way I can explain why you need to pass in a custom width and height."}], "tags": [], "owner": {"reputation": 91, "user_id": 5371768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a098903c38b84e3fe87998a01e95ee0c?s=128&d=identicon&r=PG", "display_name": "OldUrologist", "link": "https://stackoverflow.com/users/5371768/oldurologist"}, "is_accepted": false, "score": 1, "last_activity_date": 1590289151, "creation_date": 1590289151, "answer_id": 61981101, "question_id": 57699050, "link": "https://stackoverflow.com/questions/57699050/how-to-create-a-cairo-object-within-a-gtk-window-in-gtk3/61981101#61981101", "title": "How to create a cairo object within a gtk window in GTK+3", "body": "<p>The Dark Trick's program is complete.\nHe uses the functions as follows,</p>\n\n<pre><code>GdkWindow* window = gtk_widget_get_window (widget);\ncairo_region_t *cairoRegion = cairo_region_create();\nGdkDrawingContext *drawingContext;\ndrawingContext = gdk_window_begin_draw_frame (window, cairoRegion);\ncairo_t *cr = gdk_drawing_context_get_cairo_context (drawingContext);\n</code></pre>\n\n<p>But I am using the the functions as follows,</p>\n\n<pre><code>GdkWindow *window = gtk_widget_get_window(widget);\ncairo_rectangle_int_t cairoRectangle = {0, 0, 200, 200};\ncairo_region_t *cairoRegion = cairo_region_create_rectangle (&amp;cairoRectangle);\nGdkDrawingContext *drawingContext;\ndrawingContext = gdk_window_begin_draw_frame (window,cairoRegion);\ncairo_t *cr = gdk_drawing_context_get_cairo_context (drawingContext);\n</code></pre>\n\n<p>This worked, but I can not understand the differencies, for I am an OldUrologist.</p>\n"}], "owner": {"reputation": 712, "user_id": 11970791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f443759c7916eb3c44f6350acb1d118?s=128&d=identicon&r=PG&f=1", "display_name": "Parsa Mousavi", "link": "https://stackoverflow.com/users/11970791/parsa-mousavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1483, "favorite_count": 1, "accepted_answer_id": 58870107, "answer_count": 4, "score": 2, "last_activity_date": 1590304244, "creation_date": 1567021103, "last_edit_date": 1590304244, "question_id": 57699050, "link": "https://stackoverflow.com/questions/57699050/how-to-create-a-cairo-object-within-a-gtk-window-in-gtk3", "title": "How to create a cairo object within a gtk window in GTK+3", "body": "<p>I'm trying to use cairo to draw some arcs but gcc warns me that <code>gdk_cairo_create() is deprecated. Use gdk_window_begin_draw_frame() and gdk_drawing_context_get_cairo_context() instead</code>.</p>\n\n<p>To get around this I did some research and found out that for gdk_window_begin_draw_frame() I need \"GdkWindow\".I've always been using GtkWidget for my windows so I need to convert \"GtkWidget\" to \"GdkWindow\", but gtk_widget_get_window() returns NULL and causes segfault.</p>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\n#include &lt;cairo.h&gt;\nvoid main(int argc , char **argv){\n    gtk_init(&amp;argc , &amp;argv);\n    GtkWidget *win;\n    GdkWindow *gdkwin;\n    GdkDrawingContext *dc;\n\n    cairo_region_t *region;\n\n    cairo_t *cr;\n\n\n    win = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n    region = cairo_region_create();\n\n    gdkwin = gtk_widget_get_window(GTK_WIDGET(win));\n\n    //Here gdkwin should contain a GdkWindow but it's NULL.\n\n    gc = gdk_window_begin_draw_frame(gdkwin , (const cairo_region_t*)&amp;region);\n    ...\n    ...\n</code></pre>\n\n<p>Here's the runtime errors:</p>\n\n<pre><code>(a.out:6852): Gdk-CRITICAL **: 23:53:06.042: gdk_window_begin_draw_frame: assertion 'GDK_IS_WINDOW (window)' failed\n\n(a.out:6852): Gdk-CRITICAL **: 23:53:06.042: gdk_drawing_context_get_cairo_context: assertion 'GDK_IS_DRAWING_CONTEXT (context)' failed\nSegmentation fault\n</code></pre>\n\n<p>I want to get a cairo object and use it for cairo_arc().</p>\n\n<p>Thanks.Best regards.</p>\n"}, {"tags": ["c", "windows"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1567019121, "post_id": 57698515, "comment_id": 101841211, "body": "whatever you do use <code>&quot;wb&quot;</code> not <code>&quot;w&quot;</code>. And did you try that as administrator/elevated privileges?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1567019140, "post_id": 57698515, "comment_id": 101841219, "body": "you do not want to truncate the disk either..."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1567019171, "post_id": 57698515, "comment_id": 101841230, "body": "yeah, try reading from it first... and make a backup"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1567019327, "post_id": 57698515, "comment_id": 101841311, "body": "You most probably don&#39;t want to use stdio for disk accesses"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1567019359, "post_id": 57698515, "comment_id": 101841324, "body": "Also, it might be &quot;permission denied&quot;, check <code>errno</code>."}, {"owner": {"reputation": 31, "user_id": 11162169, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwpvTQlydNM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7DE7EVCwPuBAYQL1pLJlN7lfYOA/mo/photo.jpg?sz=128", "display_name": "aw17", "link": "https://stackoverflow.com/users/11162169/aw17"}, "edited": false, "score": 0, "creation_date": 1567110459, "post_id": 57698515, "comment_id": 101876339, "body": "using admin privileges, using <code>&quot;wb&quot;</code>. errno says 22, &quot;Invalid argument&quot;. maybe it has a problem with <code>&quot;\\\\\\\\.\\\\PHYSICALDRIVE0&quot;</code>?"}], "owner": {"reputation": 31, "user_id": 11162169, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-DwpvTQlydNM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc7DE7EVCwPuBAYQL1pLJlN7lfYOA/mo/photo.jpg?sz=128", "display_name": "aw17", "link": "https://stackoverflow.com/users/11162169/aw17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "closed_date": 1567019155, "answer_count": 0, "score": 1, "last_activity_date": 1567021977, "creation_date": 1567018434, "last_edit_date": 1567021977, "question_id": 57698515, "link": "https://stackoverflow.com/questions/57698515/how-can-i-fopen-a-disk-to-write-to-the-last-sector-in-windows", "closed_reason": "Duplicate", "title": "How can I fopen a disk to write to the last sector in Windows?", "body": "<p>I'm trying to open a disk and write to the last sector. On Linux, the code looks like this:</p>\n\n<pre><code>char data[] = \"end of disk\";\nFILE *fp;\nfp = fopen(\"/dev/sda\", \"w\");\nfseek(fp, -4096, SEEK_END);\nfwrite((void*) data, 1, sizeof(data), fp);\nfclose(fp);\n</code></pre>\n\n<p>I tried using this on windows:</p>\n\n<pre><code>char data[] = \"end of disk\";\nFILE *fp;\nfp = fopen(\"\\\\\\\\.\\\\PHYSICALDRIVE0\", \"w\");\nfseek(fp, -4096, SEEK_END);\nfwrite((void*) data, 1, sizeof(data), fp);\nfclose(fp);\n</code></pre>\n\n<p>However, this seems to fail at <code>fopen()</code>. How can I open a disk to write to the last sector in Windows?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 8, "creation_date": 1567017020, "post_id": 57698054, "comment_id": 101840420, "body": "<a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feoffile-always-wrong\"><code>while (!feof(file))</code> is <b>always</b> wrong.</a>"}, {"owner": {"reputation": 367, "user_id": 10930163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a82a32b93373e472ee666e96b00d1b5?s=128&d=identicon&r=PG&f=1", "display_name": "anonmess", "link": "https://stackoverflow.com/users/10930163/anonmess"}, "edited": false, "score": 1, "creation_date": 1567017473, "post_id": 57698054, "comment_id": 101840585, "body": "<a href=\"https://pubs.opengroup.org/onlinepubs/009695399/functions/fscanf.html\" rel=\"nofollow noreferrer\">pubs.opengroup.org/onlinepubs/009695399/functions/fscanf.htm&zwnj;&#8203;l</a> look at the return values for fscanf."}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1567021905, "post_id": 57698054, "comment_id": 101842270, "body": "You are going to have to use dynamic memory (<code>malloc</code>) unless you can place limits on <code>file.txt</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1567026679, "post_id": 57698054, "comment_id": 101844137, "body": "You don&#39;t need the line <code>fscanf(file, &quot; &quot;)</code>.  The next time you call <code>fscanf(file, &quot;%s&quot;, words[i])</code>, the <code>%s</code> will automatically skip any leading whitespace."}], "answers": [{"comments": [{"owner": {"reputation": 46, "user_id": 11972704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hVjOy85y11A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfvMdDOi2ASOat_NekSqTAXnjIo9A/photo.jpg?sz=128", "display_name": "Aaron Derby", "link": "https://stackoverflow.com/users/11972704/aaron-derby"}, "reply_to_user": {"reputation": 9, "user_id": 11943074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6663a8244bf66e133556233f73c0cccd?s=128&d=identicon&r=PG&f=1", "display_name": "user11943074", "link": "https://stackoverflow.com/users/11943074/user11943074"}, "edited": false, "score": 0, "creation_date": 1567020409, "post_id": 57698444, "comment_id": 101841716, "body": "When you tried to implement this, were there whitespace chars?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1567029526, "post_id": 57698444, "comment_id": 101845028, "body": "Note <a href=\"https://stackoverflow.com/questions/19499060/what-is-difference-between-scanfd-and-scanfd\">Trailing white space in a <code>scanf()</code> format string is a UI disaster</a>.  If the input is coming from a file, it isn&#39;t so bad, but from a terminal, it is appalling.  The leading white space is unnecessary (<code>%s</code> skips white space anyway) but harmless."}], "tags": [], "owner": {"reputation": 46, "user_id": 11972704, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hVjOy85y11A/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfvMdDOi2ASOat_NekSqTAXnjIo9A/photo.jpg?sz=128", "display_name": "Aaron Derby", "link": "https://stackoverflow.com/users/11972704/aaron-derby"}, "is_accepted": false, "score": 0, "last_activity_date": 1567020280, "last_edit_date": 1567020280, "creation_date": 1567018105, "answer_id": 57698444, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file/57698444#57698444", "title": "How to fscanf word by word in a file?", "body": "<pre><code>int i=0;\nchar words[50][50];\nwhile(fscanf(file, \" %s \", words[i]) != EOF)\n    i++;\n</code></pre>\n\n<p>I wouldn't entirely recommend doing it this way, because of the unknown amount of words in the file, and the unknown length of a \"word\". Either can be over the size of '50'. Just do it dynamically, instead. Still, this should show you how it works.</p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1567033808, "last_edit_date": 1567033808, "creation_date": 1567021070, "answer_id": 57699047, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file/57699047#57699047", "title": "How to fscanf word by word in a file?", "body": "<p>As mentioned in comments, using <em><a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">feof()</a></em> does not work as would be expected.  And, <em><a href=\"https://stackoverflow.com/a/44532486/645128\">as described in this answer</a></em> unless the content of the file is formatted with very predictable content, using any of the <code>scanf</code> family to parse out the words is overly complicated.  I do not recommend using it for that purpose.</p>\n\n<p>There are many other, better ways to read content of a file, word by word.  My preference is to read each line into a buffer, then parse the buffer to extract the <em>words</em>.  This requires determining those characters that may be in the file, but would not be considered part of a word.  Characters such as <code>\\n</code>,<code>\\t</code>,<code></code> (space), <code>-</code>, etc. should be considered <em>delimiters</em>, and can be used to extract the <em>words</em>. The following is a recipe for extracting words from a file:  (example code for a few of the  items is included below these steps.)</p>\n\n<ol>\n<li>Read file to count words, and get the length of the longest word.  </li>\n<li>Use count, and longest values from 1st step to allocate memory for words.</li>\n<li>Rewind the file.</li>\n<li>Read file line by line into a line buffer using <code>while(fgets(line, size, fp))</code>  </li>\n<li>Parse each new line into words using delimiters and store each word into arrays of step 2.  </li>\n<li>Use resulting array of words as necessary.  </li>\n<li>free all memory allocated when finished with arrays</li>\n</ol>\n\n<p>Some example of code to do <em>some</em> of these tasks:</p>\n\n<pre><code>// Get count of words, and longest word in file\nint longestWord(char *file, int *nWords)\n{\n    FILE *fp=0;\n    int cnt=0, longest=0, numWords=0;\n    int c;\n    fp = fopen(file, \"r\");\n    if(fp)\n    {\n\n     // if((strlen(buf) &gt; 0) &amp;&amp; (buf[0] != '\\t') &amp;&amp; (buf[0] != '\\n') &amp;&amp; (buf[0] != '\\0')&amp;&amp; (buf[0] &gt; 0))\n\n        while ( (c = fgetc(fp) ) != EOF )\n        {\n            if ( isalnum (c) ) cnt++;\n            else if ( ( ispunct (c) ) || ( isspace(c) ) || (c == '\\0' ))\n            {\n                (cnt &gt; longest) ? (longest = cnt, cnt=0) : (cnt=0);\n                numWords++;\n            }\n        }\n        *nWords = numWords;\n        fclose(fp);\n    }\n    else return -1;\n\n    return longest;\n}\n\n// Create indexable memory for word arrays\nchar ** Create2DStr(ssize_t numStrings, ssize_t maxStrLen)\n{\n    int i;\n    char **a = {0};\n    a = calloc(numStrings, sizeof(char *));\n    for(i=0;i&lt;numStrings; i++)\n    {\n      a[i] = calloc(maxStrLen + 1, 1);\n    }\n    return a;\n} \n</code></pre>\n\n<p>Usage: For a file with 25 words, the longest being 80 bytes:  </p>\n\n<pre><code>char **strArray = Create2DStr(25, 80+1);//creates 25 array locations\n                                        //each 80+1 characters long\n                                        //(+1 is room for null terminator.)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 9906416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28790a38b6a223a25e5a1acfcbec2bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/9906416/steven"}, "is_accepted": false, "score": 1, "last_activity_date": 1567021421, "last_edit_date": 1567021421, "creation_date": 1567021119, "answer_id": 57699057, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file/57699057#57699057", "title": "How to fscanf word by word in a file?", "body": "<p>strtok() might be a function that can help you here.</p>\n\n<p>If you know that the words will be separated by whitespace, then calling strtok will return the char pointer to the start of the next word. </p>\n\n<p>Sample code from <a href=\"https://www.systutorials.com/docs/linux/man/3p-strtok/\" rel=\"nofollow noreferrer\">https://www.systutorials.com/docs/linux/man/3p-strtok/</a></p>\n\n<pre><code>#include &lt;string.h&gt;\n...\nchar *token;\nchar *line = \"LINE TO BE SEPARATED\";\nchar *search = \" \";\n\n\n/* Token will point to \"LINE\". */\ntoken = strtok(line, search);\n\n\n/* Token will point to \"TO\". */\ntoken = strtok(NULL, search);\n</code></pre>\n\n<p>In your case, the space character would also act as a delimiter in the line.\nNote that strtok might modify the string passed in, so if you need to you should make a deep copy using something like malloc.</p>\n\n<p>It might also be easier to use fread() to read a block from a file</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1567022673, "creation_date": 1567022673, "answer_id": 57699375, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file/57699375#57699375", "title": "How to fscanf word by word in a file?", "body": "<p>When reading repeated input, you control the input loop with the input function itself (<code>fscanf</code> in your case). While you can also loop continually (e.g. <code>for (;;) { ... }</code>) and check independently whether the return is <code>EOF</code>, whether a <em>matching failure</em> occurred, or whether the return matches the number of conversion specifiers (success), in your case simply checking that the return matches the single <code>\"%s\"</code> conversion specifier is fine (e.g. that the return is <code>1</code>).</p>\n\n<p>Storing each word in an array, you have several options. The most simple is using a 2D array of <code>char</code> with automatic storage. Since the longest non-medical word in the Unabridged Dictionary is 29-characters (requiring a total of 30-characters with the <em>nul-terminating</em> character), a 2D array with a fixed number of rows and fixed number of columns of at least 30 is fine. (dynamically allocating allows you to read and allocate memory for as many words as may be required -- but that is left for later.)</p>\n\n<p>So to set up storage for 128 words, you could do something similar to the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXW  32    /* if you need a constant, #define one (or more) */\n#define MAXA 128\n\nint main (int argc, char **argv) {\n\n    char array[MAXA][MAXW] = {{\"\"}};    /* array to store up to 128 words */\n    size_t n = 0;                       /* word index */\n</code></pre>\n\n<p>Now simply open your filename provided as the first argument to the program (or read from <code>stdin</code> by default if no argument is given), and then <strong><em>validate</em></strong> that your file is open for reading, e.g.</p>\n\n<pre><code>    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n</code></pre>\n\n<p>Now to the crux of your read-loop. Simply loop checking the <strong>return</strong> of <code>fscanf</code> to determine success/failure of the read, adding words to your array and incrementing your index on each successful read. You must also include in your loop-control a check of your index against your array bounds to ensure you do not attempt to write more words to your array than it can hold, e.g.</p>\n\n<pre><code>    while (n &lt; MAXA &amp;&amp; fscanf (fp, \"%s\", array[n]) == 1)\n        n++;\n</code></pre>\n\n<p>That's it, now just close the file and use your words stored in your array as needed. For example just printing the stored words you could do:</p>\n\n<pre><code>    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (size_t i = 0; i &lt; n; i++)\n        printf (\"array[%3zu] : %s\\n\", i, array[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Now just compile it, <em>With Warnings Enabled</em> (e.g. <code>-Wall -Wextra -pedantic</code> for gcc/clang, or <code>/W3</code> on (VS, <code>cl.exe</code>) and then test on your file. The full code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXW  32    /* if you need a constant, #define one (or more) */\n#define MAXA 128\n\nint main (int argc, char **argv) {\n\n    char array[MAXA][MAXW] = {{\"\"}};    /* array to store up to 128 words */\n    size_t n = 0;                       /* word index */\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n\n    while (n &lt; MAXA &amp;&amp; fscanf (fp, \"%s\", array[n]) == 1)\n        n++;\n\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (size_t i = 0; i &lt; n; i++)\n        printf (\"array[%3zu] : %s\\n\", i, array[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Input File</strong></p>\n\n<pre><code>$ cat dat/thefile.txt\nthis is the file\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/fscanfsimple dat/thefile.txt\narray[  0] : this\narray[  1] : is\narray[  2] : the\narray[  3] : file\n</code></pre>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1567031343, "last_edit_date": 1567031343, "creation_date": 1567030683, "answer_id": 57700704, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file/57700704#57700704", "title": "How to fscanf word by word in a file?", "body": "<blockquote>\n  <p>How can I use fscanf to take word by word and put each word in an array of strings? </p>\n</blockquote>\n\n<p>Read each word twice: first to find length via <code>\"%n\"</code>. 2nd time, save it.  (Inefficient yet simple)</p>\n\n<p>Re-size <code>strings</code> as you go.  Again inefficient, yet simple.</p>\n\n<pre><code>// Rough untested sample code - still need to add error checking.\n\nsize_t string_count = 0;\nchar **strings = NULL;\n\nfor (;;) {\n  long pos = ftell(file);\n  int n = 0;\n  fscanf(file, \"%*s%n\", &amp;n);  // record where scanning a \"word\" stopped\n  if (n == 0) break;\n  fseek(file, pos, SEEK_SET); // go back;\n  strings = realloc(strings, sizeof *strings * (string_count+1));// increase array size\n  strings[string_count] = malloc(n + 1u);  // Get enough memory for the word\n  fscanf(file, \"%s \", strings[string_count] );  // read/save word\n}\n\n// use strings[], string_count\n\n// When done, free each strings[] and then strings\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11943074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6663a8244bf66e133556233f73c0cccd?s=128&d=identicon&r=PG&f=1", "display_name": "user11943074", "link": "https://stackoverflow.com/users/11943074/user11943074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 749, "favorite_count": 1, "answer_count": 5, "score": -1, "last_activity_date": 1567033808, "creation_date": 1567016202, "last_edit_date": 1567029761, "question_id": 57698054, "link": "https://stackoverflow.com/questions/57698054/how-to-fscanf-word-by-word-in-a-file", "title": "How to fscanf word by word in a file?", "body": "<p>I have a file with a series of words separated by a white space. For example file.txt contains this: \"this is the file\". How can I use <code>fscanf</code> to take word by word and put each word in an array of strings? </p>\n\n<p>Then I did this but I don't know if it's correct:</p>\n\n<pre><code>char *words[100];\nint i=0;\nwhile(!feof(file)){\n        fscanf(file, \"%s\", words[i]);\n        i++;\n        fscanf(file, \" \");\n}\n</code></pre>\n"}, {"tags": ["c", "pthreads"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567048305, "post_id": 57697886, "comment_id": 101848384, "body": "suggest change: <code>write(2, &quot;flag\\n&quot;, 6);</code> to <code>write(2, &quot;flag\\n&quot;, sizeof( &quot;flag\\n&quot; ));</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 2, "creation_date": 1567048522, "post_id": 57697886, "comment_id": 101848426, "body": "The posted question is about a run-time problem.  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you to debug it."}, {"owner": {"reputation": 358516, "user_id": 9530, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/924800e76876546c5c575c0175e1f434?s=128&d=identicon&r=PG", "display_name": "Adam Rosenfield", "link": "https://stackoverflow.com/users/9530/adam-rosenfield"}, "edited": false, "score": 0, "creation_date": 1567089971, "post_id": 57697886, "comment_id": 101867610, "body": "Is the thread&#39;s cancellation type asynchronous or deferred?  Do note this clause from the pthread_cond_wait man page: &quot;[...] When the cancelability enable state of a thread is set to PTHREAD_CANCEL_DEFERRED, a side effect of acting upon a cancellation request while in a condition wait is that the mutex is (in effect) re-acquired before calling the first cancellation cleanup handler. [...]&quot;.  It&#39;s possible that Valgrind might be failing to correctly emulate that behavior."}], "answers": [{"tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 2, "last_activity_date": 1567030131, "last_edit_date": 1567030131, "creation_date": 1567021192, "answer_id": 57699067, "question_id": 57697886, "link": "https://stackoverflow.com/questions/57697886/valgrind-error-for-sigint-during-pthread-cond-wait/57699067#57699067", "title": "Valgrind error for SIGINT during pthread_cond_wait", "body": "<p>You're mistaken about what happens, but you're also missing relevant code: particularly, what the signal handler does. I'm assuming there is a signal handler, since otherwise the signal would either be causing your program to terminate, or would have to have been ignored or blocked, in which case nothing would happen when you try to interrupt it.</p>\n\n<p>Receipt of <code>SIGINT</code> does not cause <code>pthread_cond_wait</code> to return with the mutex left unlocked. In fact it doesnt' cause <code>pthread_cond_wait</code> to return at all, even if the signal handler is installed as an interrupting (not <code>SA_RESTART</code>) one, since <code>pthread_cond_wait</code> is forbidden from failing due to <code>EINTR</code>. Of course it's still possible that <code>pthread_cond_wait</code> returns spuriously at any time, but whenever it returns, no matter what the reason, the mutex must always be acquired again (internally, by the implementation) before that happens.</p>\n\n<p>It's likely that the cause of your problem is in other code you haven't shown us. Indeed, you've added:</p>\n\n<blockquote>\n  <p>edit: on <code>SIGINT</code>, the thread running function gets canceled</p>\n</blockquote>\n\n<p>This is not sufficient to diagnose the problem, but suggests that you might be calling <code>pthread_cancel</code> from the signal handler. If so, that's almost certainly your problem. <code>pthread_cancel</code> is not async-signal-safe, and thus the only way you can call it from a signal handler is to ensure that the handler can only run in a context where it's not interrupting another function that's not async-signal-safe. This would involve either having a dedicated signal handling thread with the signal blocked in all other threads (but then it's easier to just use <code>sigwaitinfo</code> to receive it), or blocking and unblocking the signal dynamically so that it's blocked whenever you're calling non-AS-safe functions.</p>\n\n<p>Since you're only seeing the problem with valgrind, it's likely that either valgrind perturbs things so that the signal handler ends up running in a different thread (which one it runs in is unspecified among the set that are candidates for receiving it), or that the resulting undefined behavior just happens not to have a visible manifestation (yet) without valgrind running.</p>\n"}], "owner": {"reputation": 464, "user_id": 2696186, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/kyPSG.png?s=128&g=1", "display_name": "DefinitelyNotAPlesiosaur", "link": "https://stackoverflow.com/users/2696186/definitelynotaplesiosaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1567030131, "creation_date": 1567015474, "last_edit_date": 1567022794, "question_id": 57697886, "link": "https://stackoverflow.com/questions/57697886/valgrind-error-for-sigint-during-pthread-cond-wait", "title": "Valgrind error for SIGINT during pthread_cond_wait", "body": "<p>I'm running the following code in Valgrind (<code>valgrind --tool=helgrind ./program_name</code>).</p>\n\n<pre><code>void cleanup(void *mutex) {\n    pthread_mutex_t *m = (pthread_mutex_t *)mutex;\n    pthread_mutex_unlock(m);\n}\n\nvoid function() {\n    pthread_mutex_lock(&amp;some_struct.some_mutex);\n    pthread_cleanup_push(cleanup, &amp;some_struct.some_mutex);\n    while (some_condition) {\n        pthread_cond_wait(&amp;some_struct.some_cond, &amp;some_struct.some_mutex);\n    }\n    pthread_cleanup_pop(1);\n}\n</code></pre>\n\n<p>It runs <code>function</code>, but if I send SIGINT immediately after the function is run, this happens (edit: on SIGINT, the thread running <code>function</code> gets canceled):</p>\n\n<pre><code>==3744== Thread #4 unlocked a not-locked lock at 0x30D300\n==3744==    at 0x483A1D4: ??? (in /usr/lib/x86_64-linux-gnu/valgrind/vgpreload_helgrind-amd64-linux.so)\n==3744==    by 0x10994F: cleanup (some_program.c:193)\n==3744==    by 0x1099A7: function (some_program.c:199)\n</code></pre>\n\n<p>Edit: I modified the code to initialize the mutex as such:</p>\n\n<pre><code>pthread_mutexattr_init(&amp;some_struct.err_chk_attr);\npthread_mutexattr_settype(&amp;some_struct.err_chk_attr, PTHREAD_MUTEX_ERRORCHECK);\npthread_mutex_init(&amp;some_struct.some_mutex, &amp;client_control.err_chk_attr);\n</code></pre>\n\n<p>And added this to <code>cleanup</code>:</p>\n\n<pre><code>if (pthread_mutex_unlock(m)) {\n    write(2, \"flag\\n\", 6);\n}\n</code></pre>\n\n<p>Running this does not print the flag inside or outside valgrind. When I run my code inside valgrind, I still get the valgrind error, but no printout. This seems contradictory, because if I were unlocking a mutex that's already unlocked, I would expect a valgrind error and a printout. As a sanity check, I confirmed that the mutex attribute catches the unlocking and unlocked mutex error by adding another <code>pthread_mutex_unlock(m)</code> immediately after this one with a similar print statement. This gives both a valgrind error and a print statement.</p>\n"}, {"tags": ["c", "parallel-processing", "mpi", "openmpi"], "comments": [{"owner": {"reputation": 17337, "user_id": 83605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a214bcecbc04c7c42696e55cbdea3e17?s=128&d=identicon&r=PG", "display_name": "Aziz", "link": "https://stackoverflow.com/users/83605/aziz"}, "edited": false, "score": 0, "creation_date": 1567022582, "post_id": 57697602, "comment_id": 101842567, "body": "Your code generates a segfault at line 183 (the part where you update <code>resultBufferTwo</code>). It seems that there is a problem in calculating the buffer indices."}], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 10910772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iM9-bu8vqyg/AAAAAAAAAAI/AAAAAAAAAPE/ZItYhUKrCxQ/photo.jpg?sz=128", "display_name": "HemOdd", "link": "https://stackoverflow.com/users/10910772/hemodd"}, "edited": false, "score": 0, "creation_date": 1567049874, "post_id": 57699429, "comment_id": 101848671, "body": "Thank you for your reply. I actually removed the color calculation code only when I pasted the code here because it was all repetitive (I am new to C and decided to repeat the same code instead of using functions for now). I have included the full code now. I would appreciate it if you could look at it again."}], "tags": [], "owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "is_accepted": false, "score": 2, "last_activity_date": 1567024328, "last_edit_date": 1567024328, "creation_date": 1567022974, "answer_id": 57699429, "question_id": 57697602, "link": "https://stackoverflow.com/questions/57697602/processing-blocks-of-an-image-in-open-mpi/57699429#57699429", "title": "Processing blocks of an image in Open MPI", "body": "<blockquote>\n  <p><strong>Q</strong> : <em>what I am doing wrong here?</em></p>\n</blockquote>\n\n<ul>\n<li>the code does not calculate the fractal over complex-plane &amp; just copies constant <code>color[]</code></li>\n<li><code>my_rank == 0</code> processing collects results generated by others ( fractal generator is iterative, thus having different run-times per each <code>[X,iY]</code>-point in complex-plane ) and itself stores, where directed, a constant value from uninitialised / unmodified identical constant value of <code>color[] == [0,0,0]</code> to the whole <code>finalResultBuffer[][]</code></li>\n<li>you do not split the work among P1-P6 as was declared above, but your code splits code-execution paths for three cases - <strong>1)</strong> the <code>my_rank == 0</code> ( the \"master\", which collects results (itself dos not compute a bit of the cmplex iterator, instead stores black dots, where directed) and writes out a file ), <strong>2)</strong> <code>my_rank % 2 == 0</code> ( all nonzero even ranks, none of which does a single step to actually compute the complex fractal iterator and all stores black dots everywhere ), <strong>3)</strong> <code>my_rank % 2 == 1</code> ( all odd ranks, none of which does a single step to actually compute the complex fractal iterator, but all stores black dots everywhere )</li>\n</ul>\n"}], "owner": {"reputation": 414, "user_id": 10910772, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-iM9-bu8vqyg/AAAAAAAAAAI/AAAAAAAAAPE/ZItYhUKrCxQ/photo.jpg?sz=128", "display_name": "HemOdd", "link": "https://stackoverflow.com/users/10910772/hemodd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1567059234, "creation_date": 1567014264, "last_edit_date": 1567059234, "question_id": 57697602, "link": "https://stackoverflow.com/questions/57697602/processing-blocks-of-an-image-in-open-mpi", "title": "Processing blocks of an image in Open MPI", "body": "<p>I am trying to parallelize a C program which draws Mandelbrot set. I am dividing a section of the image for each processor in shape of equal-sized blocks as I have shown in this image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9N2UA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9N2UA.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I have tried to use the solution <a href=\"https://stackoverflow.com/a/42606572/10910772\">here</a> which is almost addressing the same problem. However, I only get a partial image in output: </p>\n\n<p><a href=\"https://i.stack.imgur.com/96kn6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/96kn6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Also for high resolutions of the image (such as 8000x8000 pixels) the application crashes with segmentation fault 11. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;time.h&gt;\n#include \"mpi.h\"\n\n// Main program\nint main(int argc, char* argv[])\n {\n    /* screen ( integer) coordinate */\n    int iX,iY,i,j;\n    const int iXmax = 8000; // default\n    const int iYmax = 8000; // default\n\n    /* world ( double) coordinate = parameter plane*/\n    double Cx, Cy;\n    const double CxMin = -2.5;\n    const double CxMax = 1.5;\n    const double CyMin = -2.0;\n    const double CyMax = 2.0; \n\n    /* */\n    double PixelWidth = (CxMax - CxMin)/iXmax;\n    double PixelHeight = (CyMax - CyMin)/iYmax;\n\n\n    int linePerProcess, remainingLines, processMinY,  processMaxY, lastProcessMaxY, result_offset;\n    int my_rank, processors, iXmaxHalf;\n    int startAlert = 1;\n    int receivedAlert;\n    unsigned char (*resultBuffer)[3] = NULL;\n    unsigned char (*resultBufferTwo)[3] = NULL;\n    unsigned char (*finalResultBuffer)[3] = NULL;\n\n    MPI_Status stat;\n\n\n    /* color component ( R or G or B) is coded from 0 to 255 */\n    /* it is 24 bit color RGB file */\n    const int MaxColorComponentValue = 255; \n    FILE * fp;\n    char *filename = \"Mandelbrot.ppm\";\n    char *comment = \"# \";   /* comment should start with # */\n\n    // RGB color array\n    unsigned char color[3];\n\n    /* Z = Zx + Zy*i;   Z0 = 0 */\n    double Zx, Zy;\n    double Zx2, Zy2; /* Zx2 = Zx*Zx;  Zy2 = Zy*Zy  */\n    /*  */\n    int Iteration;\n    const int IterationMax = 2000; // default\n\n    /* bail-out value , radius of circle ;  */\n    const double EscapeRadius = 400;\n    double ER2 = EscapeRadius * EscapeRadius;\n    double startTime, endTime;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;my_rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;processors);\n\n    linePerProcess = iYmax / (processors/2);\n    iXmaxHalf = iXmax / 2;\n\n    if (my_rank % 2  == 0) {\n        processMinY = (my_rank/2) * linePerProcess;\n    } else {\n        processMinY = ((my_rank - 1)/2) * linePerProcess;\n    }\n\n    processMaxY = processMinY + linePerProcess;\n\n\n    int Rows = iYmax;          // Global array rows\n    int Columns = iXmax; // Global array columns\n    int sizes[2];                     // No of elements in each dimension of the whole array\n    int subSizes[2];                  // No of elements in each dimension of the subarray\n    int startCoords[2];               // Starting coordinates of each subarray\n    MPI_Datatype recvBlock, recvMagicBlock;\n\n        // Create a subarray (a rectangular block) datatype from a regular, 2d array\n    sizes[0] = Rows;\n    sizes[1] = Columns;\n    subSizes[0] = linePerProcess;\n    subSizes[1] = iXmaxHalf;\n    startCoords[0] = 0;\n    startCoords[1] = 0;\n\n    MPI_Type_create_subarray(2, sizes, subSizes, startCoords, MPI_ORDER_C, MPI_UNSIGNED_CHAR, &amp;recvBlock);\n\n    MPI_Type_create_resized(recvBlock, 0, iXmaxHalf * sizeof(color), &amp;recvMagicBlock);\n\n    MPI_Type_commit(&amp;recvMagicBlock);\n\n    if (my_rank == 0) {\n\n\n        // startTime = MPI_Wtime();\n        // for(i=1; i&lt;processors; i++){\n        //  MPI_Send(&amp;startAlert, 1, MPI_INT, i, 0, MPI_COMM_WORLD);\n        // }\n        // printf(\"rank; %d\\n\", my_rank);\n\n        finalResultBuffer = malloc(iXmax * iYmax * sizeof(color));\n\n        for(iY = processMinY; iY &lt; processMaxY; iY++) {\n\n            Cy = CyMin + (iY * PixelHeight);\n            if (fabs(Cy) &lt; (PixelHeight / 2))\n            {\n                Cy = 0.0; /* Main antenna */\n            }\n\n            for(iX = 0; iX &lt; iXmaxHalf; iX++)\n            {\n\n                Cx = CxMin + (iX * PixelWidth);\n                /* initial value of orbit = critical point Z= 0 */\n                Zx = 0.0;\n                Zy = 0.0;\n                Zx2 = Zx * Zx;\n                Zy2 = Zy * Zy;\n\n            /* */\n                for(Iteration = 0; Iteration &lt; IterationMax &amp;&amp; ((Zx2 + Zy2) &lt; ER2); Iteration++)\n                {\n                    Zy = (2 * Zx * Zy) + Cy;\n                    Zx = Zx2 - Zy2 + Cx;\n                    Zx2 = Zx * Zx;\n                    Zy2 = Zy * Zy;\n                };\n\n            /* compute  pixel color (24 bit = 3 bytes) */\n                if (Iteration == IterationMax)\n                {\n                    // Point within the set. Mark it as black\n                    color[0] = 0;\n                    color[1] = 0;\n                    color[2] = 0;\n                }\n                else \n                {\n                    // Point outside the set. Mark it as white\n                    double c = 3*log((double)Iteration)/log((double)(IterationMax) - 1.0);\n                    if (c &lt; 1)\n                    {\n                        color[0] = 0;\n                        color[1] = 0;\n                        color[2] = 255*c;\n                    }\n                    else if (c &lt; 2)\n                    {\n                        color[0] = 0;\n                        color[1] = 255*(c-1);\n                        color[2] = 255;\n                    }\n                    else\n                    {\n                        color[0] = 255*(c-2);\n                        color[1] = 255;\n                        color[2] = 255;\n                    }\n                }\n\n                finalResultBuffer[(iY*iXmaxHalf)+iX][0] = color[0];\n                finalResultBuffer[(iY*iXmaxHalf)+iX][1] = color[1];\n                finalResultBuffer[(iY*iXmaxHalf)+iX][2] = color[2];\n\n\n            }\n        }\n\n        result_offset = 1;\n        for(i=1; i&lt;processors; i++){\n\n            MPI_Recv(finalResultBuffer, 1, recvMagicBlock, i, 0, MPI_COMM_WORLD, &amp;stat);\n            result_offset += 1;\n        }\n\n\n\n    } else if ((my_rank % 2 == 0) &amp;&amp; (my_rank != 0)) {\n\n        // MPI_Recv(&amp;receivedAlert, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, &amp;stat);\n        // printf(\"rank; %d\\n\", my_rank);\n        resultBuffer = malloc(linePerProcess * iXmaxHalf * sizeof(color));\n\n        for(iY = processMinY; iY &lt; processMaxY; iY++) {\n            Cy = CyMin + (iY * PixelHeight);\n            if (fabs(Cy) &lt; (PixelHeight / 2))\n            {\n                Cy = 0.0; /* Main antenna */\n            }\n            for(iX = 0; iX &lt; iXmaxHalf; iX++)\n            {\n\n                Cx = CxMin + (iX * PixelWidth);\n                /* initial value of orbit = critical point Z= 0 */\n                Zx = 0.0;\n                Zy = 0.0;\n                Zx2 = Zx * Zx;\n                Zy2 = Zy * Zy;\n\n            /* */\n                for(Iteration = 0; Iteration &lt; IterationMax &amp;&amp; ((Zx2 + Zy2) &lt; ER2); Iteration++)\n                {\n                    Zy = (2 * Zx * Zy) + Cy;\n                    Zx = Zx2 - Zy2 + Cx;\n                    Zx2 = Zx * Zx;\n                    Zy2 = Zy * Zy;\n                };\n\n            /* compute  pixel color (24 bit = 3 bytes) */\n                if (Iteration == IterationMax)\n                {\n                    // Point within the set. Mark it as black\n                    color[0] = 0;\n                    color[1] = 0;\n                    color[2] = 0;\n                }\n                else \n                {\n                    // Point outside the set. Mark it as white\n                    double c = 3*log((double)Iteration)/log((double)(IterationMax) - 1.0);\n                    if (c &lt; 1)\n                    {\n                        color[0] = 0;\n                        color[1] = 0;\n                        color[2] = 255*c;\n                    }\n                    else if (c &lt; 2)\n                    {\n                        color[0] = 0;\n                        color[1] = 255*(c-1);\n                        color[2] = 255;\n                    }\n                    else\n                    {\n                        color[0] = 255*(c-2);\n                        color[1] = 255;\n                        color[2] = 255;\n                    }\n                }\n\n                resultBuffer[((iY-processMinY)*iXmaxHalf)+iX][0] = color[0];\n                resultBuffer[((iY-processMinY)*iXmaxHalf)+iX][1] = color[1];\n                resultBuffer[((iY-processMinY)*iXmaxHalf)+iX][2] = color[2];\n\n            }\n        }\n        MPI_Send(resultBuffer, linePerProcess * iXmaxHalf, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);\n\n        free(resultBuffer);\n\n    } else {\n\n        // MPI_Recv(&amp;receivedAlert, 1, MPI_INT, 0, 0, MPI_COMM_WORLD, &amp;stat);\n        // printf(\"rank; %d\\n\", my_rank);\n        resultBufferTwo = malloc(linePerProcess * iXmaxHalf * sizeof(color));\n\n        for(iY = processMinY; iY &lt; processMaxY; iY++) {\n            Cy = CyMin + (iY * PixelHeight);\n            if (fabs(Cy) &lt; (PixelHeight / 2))\n            {\n                Cy = 0.0; /* Main antenna */\n            }\n            for(iX = iXmaxHalf; iX &lt; iXmax; iX++)\n            {\n\n                Cx = CxMin + (iX * PixelWidth);\n                /* initial value of orbit = critical point Z= 0 */\n                Zx = 0.0;\n                Zy = 0.0;\n                Zx2 = Zx * Zx;\n                Zy2 = Zy * Zy;\n\n            /* */\n                for(Iteration = 0; Iteration &lt; IterationMax &amp;&amp; ((Zx2 + Zy2) &lt; ER2); Iteration++)\n                {\n                    Zy = (2 * Zx * Zy) + Cy;\n                    Zx = Zx2 - Zy2 + Cx;\n                    Zx2 = Zx * Zx;\n                    Zy2 = Zy * Zy;\n                };\n\n            /* compute  pixel color (24 bit = 3 bytes) */\n                if (Iteration == IterationMax)\n                {\n                    // Point within the set. Mark it as black\n                    color[0] = 0;\n                    color[1] = 0;\n                    color[2] = 0;\n                }\n                else \n                {\n                    // Point outside the set. Mark it as white\n                    double c = 3*log((double)Iteration)/log((double)(IterationMax) - 1.0);\n                    if (c &lt; 1)\n                    {\n                        color[0] = 0;\n                        color[1] = 0;\n                        color[2] = 255*c;\n                    }\n                    else if (c &lt; 2)\n                    {\n                        color[0] = 0;\n                        color[1] = 255*(c-1);\n                        color[2] = 255;\n                    }\n                    else\n                    {\n                        color[0] = 255*(c-2);\n                        color[1] = 255;\n                        color[2] = 255;\n                    }\n                }\n\n\n                resultBufferTwo[((iY-processMinY)*iXmaxHalf)+(iX - iXmaxHalf)][0] = color[0];\n                resultBufferTwo[((iY-processMinY)*iXmaxHalf)+(iX - iXmaxHalf)][1] = color[1];\n                resultBufferTwo[((iY-processMinY)*iXmaxHalf)+(iX - iXmaxHalf)][2] = color[2];\n                // printf(\"rank: %d - value: %u%u%u\\n\", my_rank,resultBufferTwo[((iY-processMinY)*iXmax)+iX][0],resultBufferTwo[((iY-processMinY)*iXmax)+iX][1],resultBufferTwo[((iY-processMinY)*iXmax)+iX][2]);\n\n            }\n        }\n        MPI_Send(resultBufferTwo, iXmaxHalf * linePerProcess, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);\n\n        free(resultBufferTwo);\n\n    }\n\n    if (my_rank == 0) {\n\n        endTime = MPI_Wtime();\n        printf(\"Process time (s): %lf\\n\", endTime - startTime);\n        /*create new file,give it a name and open it in binary mode  */\n        fp = fopen(filename, \"wb\"); /* b -  binary mode */\n\n        /*write ASCII header to the file (PPM file format)*/\n        fprintf(fp,\"P6\\n %s\\n %d\\n %d\\n %d\\n\", comment, iXmax, iYmax, MaxColorComponentValue);\n        for(iY = 0; iY &lt; iYmax; iY++)\n        {\n            for(iX = 0; iX &lt; iXmax; iX++)\n                {\n                    fwrite(finalResultBuffer[(iY*iXmax)+iX], 1, 3, fp);\n                }\n        }\n\n        fclose(fp);\n\n        free(finalResultBuffer);\n    }\n\n    MPI_Finalize();\n    return 0;\n }\n</code></pre>\n\n<p>I would appreciate it if someone could help me out to understand what I am doing wrong here.</p>\n"}, {"tags": ["c", "gcc", "ld"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 1, "creation_date": 1567013846, "post_id": 57697397, "comment_id": 101839200, "body": "See the first comment on that question. In fact, look at the answers. It&#39;s exactly the same problem."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1567013910, "post_id": 57697397, "comment_id": 101839220, "body": "As mentioned in comments on and answers to the question you linked to, you are ignoreing the &quot;undefined references&quot; requirement."}], "answers": [{"tags": [], "owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "is_accepted": false, "score": 1, "last_activity_date": 1567013876, "creation_date": 1567013876, "answer_id": 57697523, "question_id": 57697397, "link": "https://stackoverflow.com/questions/57697397/wrapping-a-function/57697523#57697523", "title": "Wrapping a function", "body": "<p>Like in the answer you mention, you are ignoring the fact that you need to have an <em>undefined reference</em> to <code>f()</code>.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid __wrap_f()\n{\n        puts(\"wrapped\");\n}\n\nvoid f();\n\nint main(void)\n{\n        f();\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 1, "creation_date": 1567013959, "post_id": 57697526, "comment_id": 101839239, "body": "It works with a single TU, since the real <code>f()</code> won&#39;t be called."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 21663, "user_id": 9305398, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cqJvE.png?s=128&g=1", "display_name": "Acorn", "link": "https://stackoverflow.com/users/9305398/acorn"}, "edited": false, "score": 0, "creation_date": 1567014103, "post_id": 57697526, "comment_id": 101839295, "body": "Yeah, I&#39;m kind of eagerly expecting the user to transition to actual wrapping (using <code>__real_f</code>) instead of a simple symbol replacement. Then an actual <code>f</code> will be needed as well."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 2, "last_activity_date": 1567013881, "creation_date": 1567013881, "answer_id": 57697526, "question_id": 57697397, "link": "https://stackoverflow.com/questions/57697397/wrapping-a-function/57697526#57697526", "title": "Wrapping a function", "body": "<p>I don't think this'll work with a single translation unit.\nAFAIK, the <code>f</code> function needs to be in a separate file.</p>\n\n<p>This works for me (prints wrapped):</p>\n\n<pre><code>#!/bin/sh -eu\n\ncat &gt; main.c &lt;&lt;EOF\n#include &lt;stdio.h&gt;\n\nvoid __wrap_f()\n{\n        puts(\"wrapped\");\n}\n\nvoid f();\nint main(void)\n{\n        f();\n}\nEOF\n\ncat &gt; f.c &lt;&lt;EOF\n#include &lt;stdio.h&gt;\nvoid f()\n{\n        puts(\"original\");\n}\nEOF\n\ngcc wrap.c f.c -Wl,--wrap=f &amp;&amp; ./a.out\n</code></pre>\n"}], "owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "closed_date": 1567613098, "answer_count": 2, "score": 1, "last_activity_date": 1567013881, "creation_date": 1567013325, "question_id": 57697397, "link": "https://stackoverflow.com/questions/57697397/wrapping-a-function", "closed_reason": "Duplicate", "title": "Wrapping a function", "body": "<p>As mentioned <a href=\"https://stackoverflow.com/questions/46444052/how-to-wrap-functions-with-the-wrap-option-correctly\">here</a>, we can wrap a function using the <code>-Wl,--wrap</code> switch.\nConsider the following program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid __wrap_f()\n{\n        puts(\"wrapped\");\n}\n\nvoid f()\n{\n        puts(\"original\");\n}\n\nint main(void)\n{\n        f();\n}\n</code></pre>\n\n<p>The program was written to <code>a.c</code> and compiled as <code>gcc -Wl,--wrap=f a.c</code>. When I run the executable (using <code>./a.out</code>), I get <code>original</code> as the output.</p>\n\n<p>My expectation was that on invoking <code>f()</code>, the wrapped version would be called and the program would print <code>wrapped</code>. Please let me know what I am missing here.</p>\n\n<p>GCC version: 9.1.0</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3456014"}, "edited": false, "score": 0, "creation_date": 1567013362, "post_id": 57697332, "comment_id": 101839003, "body": "Hi there, welcome to StackOverflow. Perhaps you could spend some time laying out your code using Markdown -- see this guide for help <a href=\"https://stackoverflow.com/help/formatting\">stackoverflow.com/help/formatting</a>  Also, consider changing all caps to normal text perhaps..."}, {"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 1, "creation_date": 1567014392, "post_id": 57697332, "comment_id": 101839425, "body": "This is not directly related to your question, but it is generally a bad idea to use goto statements in code.  It would be better to check a boolean value in the while statement and set that value in the &#39;q&#39; case."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1567014539, "post_id": 57697332, "comment_id": 101839486, "body": "If the user presses <code>y</code> you still need to enter a menu choice. In fact you&#39;ll need to <i>another loop</i> for key entry because apparently only <code>y</code> or <code>n</code> will be acceptable responses. Keep it simple, and use <code>default</code> to report &quot;invalid response&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1567033120, "post_id": 57699185, "comment_id": 101845779, "body": "Setting <code>end</code> to the value <code>false</code> to quit the program seems counter-intuitive."}, {"owner": {"reputation": 399, "user_id": 2305614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12510965f12ff9b1442ebffc799dfdbb?s=128&d=identicon&r=PG", "display_name": "bk_32", "link": "https://stackoverflow.com/users/2305614/bk-32"}, "reply_to_user": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1567081650, "post_id": 57699185, "comment_id": 101862419, "body": "@HAL9000 I suppose a better name for the variable would be &quot;continue&quot;.  Thank you for the suggestion. I&#39;ll edit it."}, {"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1567083050, "post_id": 57699185, "comment_id": 101863273, "body": "<code>contonue</code> is a keyword, and not a good choice for a variable either. Maybe just scrap the varible, and test for <code>n==&#39;y&#39;</code> in the loop condition"}, {"owner": {"reputation": 399, "user_id": 2305614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12510965f12ff9b1442ebffc799dfdbb?s=128&d=identicon&r=PG", "display_name": "bk_32", "link": "https://stackoverflow.com/users/2305614/bk-32"}, "reply_to_user": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1567084962, "post_id": 57699185, "comment_id": 101864518, "body": "@HAL9000 a much more elegant solution, thank you. Edited to reflect."}], "tags": [], "owner": {"reputation": 399, "user_id": 2305614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12510965f12ff9b1442ebffc799dfdbb?s=128&d=identicon&r=PG", "display_name": "bk_32", "link": "https://stackoverflow.com/users/2305614/bk-32"}, "is_accepted": false, "score": 0, "last_activity_date": 1567084909, "last_edit_date": 1567084909, "creation_date": 1567021762, "answer_id": 57699185, "question_id": 57697332, "link": "https://stackoverflow.com/questions/57697332/can-you-modify-my-program-to-use-y-n-statement-in-c/57699185#57699185", "title": "can you modify my program to use &quot;y/n&quot; statement in c", "body": "<p>If you change the while(1) to a variable, then you can test after every loop whether it's time to exit.  </p>\n\n<p>The changes I made to your code all have comments below:</p>\n\n<pre><code>#include&lt;conio.h&gt;\n#include&lt;stdio.h&gt;\n\nint main()\n{\n   char n, A, B;\n   float kmTOm = 0.621371;\n   float inchesTOfoot = 0.0833333;\n   float cmTOinches = 0.393701;\n   float poundtokg = 0.453592;\n   float inchesTOmeter = 0.0254;\n   float a, b;\n   n = 'y';  //set n to make sure while repeats \n   while (n != 'n') //change while to test \"n\" instead of 1, this way the value of n can be changed and the loop can be exited\n   {\n      printf(\"Enter the input character. q to quit\\n1. kms to miles\\n2. inches to foot\\n3. cms to inches\\n4. po\nund to kgs\\n5. inches to meters\\n\");\n\n      scanf(\" %c\", &amp;n);\n      switch (n)\n      {\n      case 'q':\n         printf(\"Quitting the program...\");\n         return(0); //exit entire program\n         break;\n      case '1':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * kmTOm;\n         printf(\"%.2f Kms is equal to %.2f Miles\\n\\n\\n\", a, b);\n         break;\n      case '2':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * inchesTOfoot;\n         printf(\"%f Inches is equal to %f Foot\\n\", a, b);\n         break;\n      case '3':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * cmTOinches;\n         printf(\"%f Cms is equal to %f Inches\\n\", a, b);\n         break;\n      case '4':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * poundtokg;\n         printf(\"%f Pounds is equal to Kgs %f \\n\", a, b);\n         break;\n      case '5':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * inchesTOmeter;\n         printf(\"%f inches is equal to %f meters \\n\", a, b);\n         break;\n      default:\n         printf(\"In default now\");\n         break;\n      } \n\n        //Ask the user if they want to run again.  The code will exit if the user types 'n', it will repeat if they type anything else (including 'y').\n        printf(\"\\nRun again? y/n:\");\n        scanf(\" %c\",&amp;n);\n\n   } \n\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11914928, "user_type": "registered", "profile_image": "https://graph.facebook.com/982263578793363/picture?type=large", "display_name": "Ankit NOOB", "link": "https://stackoverflow.com/users/11914928/ankit-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1567084909, "creation_date": 1567013022, "last_edit_date": 1567014118, "question_id": 57697332, "link": "https://stackoverflow.com/questions/57697332/can-you-modify-my-program-to-use-y-n-statement-in-c", "title": "can you modify my program to use &quot;y/n&quot; statement in c", "body": "<p>Here, i am writing a c programming code i need help form you guys! I want to modify my program and want to use this in a loop i.e if a user enters \"y\" &amp; if \"n\" will be entered it must end the program, I am trying this with switch case, I tried my best to end the program, it is returning to end but i don't know how to use \"y\" value for running the program again!</p>\n\n<pre><code>#include&lt;conio.h&gt;\n#include&lt;stdio.h&gt;\n\nint main()\n{\n   char n, A, B;\n   float kmTOm = 0.621371;\n   float inchesTOfoot = 0.0833333;\n   float cmTOinches = 0.393701;\n   float poundtokg = 0.453592;\n   float inchesTOmeter = 0.0254;\n   float a, b;\n   while (1)\n   {\n      printf(\"Enter the input character. q to quit\\n1. kms to miles\\n2. inches to foot\\n3. cms to inches\\n4. pound to kgs\\n5. inches to meters\\n\");\n\n      scanf(\" %c\", &amp;n);\n      switch (n)\n      {\n      case 'q':\n         printf(\"Quitting the program...\");\n         goto end;\n         break;\n      case '1':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * kmTOm;\n         printf(\"%.2f Kms is equal to %.2f Miles\\n\\n\\n\", a, b);\n         break;\n      case '2':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * inchesTOfoot;\n         printf(\"%f Inches is equal to %f Foot\\n\", a, b);\n         break;\n      case '3':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * cmTOinches;\n         printf(\"%f Cms is equal to %f Inches\\n\", a, b);\n         break;\n      case '4':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * poundtokg;\n         printf(\"%f Pounds is equal to Kgs %f \\n\", a, b);\n         break;\n      case '5':\n         printf(\"Enter quantity in terms of a unit\\n\");\n         scanf(\"%f\", &amp;a);\n         b = a * inchesTOmeter;\n         printf(\"%f inches is equal to %f meters \\n\", a, b);\n         break;\n      default:\n         printf(\"In default now\");\n         break;\n      }\n   }\nend:\n   return 0;\n}\n</code></pre>\n\n<p>I want a kindful modification from you developers to help me as I am a beginner and learing from a month, I except that the actual output must come like this ----o/p- do you want to quit press \"q\" ,do you want to run again press \"y\"</p>\n"}, {"tags": ["c", "string", "memory-leaks"], "comments": [{"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 1, "creation_date": 1567013448, "post_id": 57697321, "comment_id": 101839037, "body": "Can you know at the time this loop is executed the maximum possible size passed as argument to <code>make_hash</code>?"}, {"owner": {"reputation": 35, "user_id": 7484368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e30c0dfc9fd2e0402c8d1042e19a9a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Gadomski", "link": "https://stackoverflow.com/users/7484368/marcin-gadomski"}, "reply_to_user": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 1, "creation_date": 1567020256, "post_id": 57697321, "comment_id": 101841668, "body": "Thank guys for your time, especially for you @dedecos, as array is not so big I decided to iterate it one more time and get the maximum possible size, allocate memory for variable before loop and free it afterwards  :)"}, {"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 1, "creation_date": 1567020674, "post_id": 57697321, "comment_id": 101841814, "body": "Hope I could help (: You want me to create an answer or you already got it?"}, {"owner": {"reputation": 35, "user_id": 7484368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e30c0dfc9fd2e0402c8d1042e19a9a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Gadomski", "link": "https://stackoverflow.com/users/7484368/marcin-gadomski"}, "edited": false, "score": 1, "creation_date": 1567022207, "post_id": 57697321, "comment_id": 101842394, "body": "Already got it, thank you :)"}, {"owner": {"reputation": 1149, "user_id": 2472827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t5rYY.jpg?s=128&g=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/2472827/neil"}, "edited": false, "score": 1, "creation_date": 1567024261, "post_id": 57697321, "comment_id": 101843201, "body": "If performance is important, <code>malloc</code>/<code>free</code> every time though the loop is probably going to be wasteful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1567025859, "post_id": 57697321, "comment_id": 101843831, "body": "If <code>make_hash()</code> always allocates memory and isn&#39;t changeable, then the code you&#39;ve got is as good as it gets.  If you can modify <code>make_hash()</code> so it is passed some (allocated) memory to use, but it is passed in such a way that the allocation can be changed, then you could reduce the amount of allocation and freeing.  Look at the interface to POSIX <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/getline.html\" rel=\"nofollow noreferrer\"><code>getline()</code></a> for a standard example of how you could do this."}], "answers": [{"comments": [{"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 4, "creation_date": 1567014050, "post_id": 57697487, "comment_id": 101839276, "body": "Checking if argument is <code>NULL</code> is pointless as if <code>NULL</code> is passed to <code>free</code> it will do nothing. However <code>free</code>ing an already freed pointer have undefined behavior (so this can be the cause of the segment fault)."}], "tags": [], "owner": {"reputation": 117, "user_id": 1744589, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b59bf9ffbe4baaaf861087ec63e2cbc8?s=128&d=identicon&r=PG", "display_name": "KKhanye", "link": "https://stackoverflow.com/users/1744589/kkhanye"}, "is_accepted": false, "score": -2, "last_activity_date": 1567013735, "creation_date": 1567013735, "answer_id": 57697487, "question_id": 57697321, "link": "https://stackoverflow.com/questions/57697321/allocating-and-freeing-memory-inside-loop-in-c/57697487#57697487", "title": "Allocating and freeing memory inside loop in C", "body": "<p>The segmentation fault might come from a number of factors, are the arrays the same length, array1, array2 and size. you are also freeing memory without checking if it was allocated.</p>\n\n<p>I will rather have something like this.</p>\n\n<pre><code>if (temporary_value != NULL) {\n    free(temporary_value);\n}\n</code></pre>\n\n<p>It has been long since coding in C but that should help in troubleshooting.</p>\n"}, {"comments": [{"owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 1, "creation_date": 1567033685, "post_id": 57700088, "comment_id": 101845867, "body": "Nitpicking: <code>malloc</code>/<code>free</code> are typically not system calls, but library functions"}, {"owner": {"reputation": 31, "user_id": 9906416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28790a38b6a223a25e5a1acfcbec2bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/9906416/steven"}, "reply_to_user": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "edited": false, "score": 0, "creation_date": 1567036316, "post_id": 57700088, "comment_id": 101846345, "body": "@HAL9000 Thank you for the catch, fixed."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1567097200, "post_id": 57700088, "comment_id": 101871180, "body": "malloc/free are not <i>that</i> expensive -- usually much cheaper than a system call.  realloc is also likely to be more expensive than free+malloc if the size changes by much.  As always, you should strive for clarity before worrying too much about performance, and benchmark your code to find the <i>actual</i> bottlenecks before worrying about optimizing the wrong things."}], "tags": [], "owner": {"reputation": 31, "user_id": 9906416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28790a38b6a223a25e5a1acfcbec2bfb?s=128&d=identicon&r=PG&f=1", "display_name": "Steven", "link": "https://stackoverflow.com/users/9906416/steven"}, "is_accepted": false, "score": 0, "last_activity_date": 1567036274, "last_edit_date": 1567036274, "creation_date": 1567026694, "answer_id": 57700088, "question_id": 57697321, "link": "https://stackoverflow.com/questions/57697321/allocating-and-freeing-memory-inside-loop-in-c/57700088#57700088", "title": "Allocating and freeing memory inside loop in C", "body": "<p>How I would approach this is not freeing within the loop. malloc/free are usually very expensive <s>system</s> calls which you do not want to do if you know that you will have to call malloc again.</p>\n\n<p>The correct way to do this would be malloc once, and then realloc on subsequent calls using the same block of memory, and then free once you're outside the loop.</p>\n"}, {"tags": [], "owner": {"reputation": 1599, "user_id": 9948091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JANyt.png?s=128&g=1", "display_name": "HAL9000", "link": "https://stackoverflow.com/users/9948091/hal9000"}, "is_accepted": true, "score": 2, "last_activity_date": 1567035940, "creation_date": 1567035940, "answer_id": 57701286, "question_id": 57697321, "link": "https://stackoverflow.com/questions/57697321/allocating-and-freeing-memory-inside-loop-in-c/57701286#57701286", "title": "Allocating and freeing memory inside loop in C", "body": "<p>When functions return objects of a known size, it is often better to let the caller handle allocations than the functions themselves, the caller often know what kind of allocation is best (automatic, static, heap, etc..). Just pass the pointer to where you want the result when calling the function.</p>\n\n<p>Hash functions often returns hashes of fixed size, so i would go for this:</p>\n\n<pre><code>for (int i = 0; i &lt; array_size; i++) {\n    char buffer[HASH_SIZE];\n\n    /*\n       `make_hash` writes result into `buffer` and returns `buffer` on success, or\n        `NULL` on error\n    */\n    char* temporary_value = make_hash(buffer, array1[i], array2[i], size[i]);\n    if (is_valid(temporary_value)) {\n       //Code, that doesn't interferate in memory, but uses temporary_value - mostly just compare to it\n    }\n }\n</code></pre>\n\n<p>In case your hash function <em>does not</em> return a fixed-size hash value, and you want the possibility to <code>realloc</code> your buffer, then pass a pointer to a pointer to your buffer, together to a pointer to a variable holding the buffer size:</p>\n\n<pre><code>make_hash(char **buffer, size_t *buffer_size, const char *str1, const char *str2, size_t s)\n{\n   size_t new_size = .....;\n   if (new_size &gt; *buffer_size)\n     {\n        char *tmp = realloc(*buffer, new_size);\n        if (!tmp)\n          return NULL;\n        *buffer = tmp;\n        *buffer_size = new_size;\n     }\n   /* \n      Calculate hash, and store it wherever `b` is pointing\n    */\n    char *b = *buffer;\n    .......\n\n    return b; /* or `NULL` on error */\n}\n\n\nchar *buffer = NULL;\nsize_t buffer_size = 0;\n\nfor (int i = 0; i &lt; array_size; i++) {\n\n    char* temporary_value = make_hash(&amp;buffer, &amp;buffer_size, array1[i], array2[i], size[i]);\n    if (is_valid(temporary_value)) {\n       //Code, that doesn't interferate in memory, but uses temporary_value - mostly just compare to it\n    }\n }\n free(buffer);\n</code></pre>\n\n<p>If you have a cheap way of calculating the hash size, without calling <code>make_hash()</code> you could also go for the first solution together with a variable-length array:</p>\n\n<pre><code>for (int i = 0; i &lt; array_size; i++) {\n    size_t buffer_size = hash_size(.....);\n\n    char buffer[buffer_size];\n\n    /*\n       `make_hash` writes result into `buffer` and returns `buffer` on success, or\n        `NULL` on error\n    */\n    char* temporary_value = make_hash(buffer, array1[i], array2[i], size[i]);\n    if (is_valid(temporary_value)) {\n       //Code, that doesn't interferate in memory, but uses temporary_value - mostly just compare to it\n    }\n }\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7484368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e30c0dfc9fd2e0402c8d1042e19a9a9?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin Gadomski", "link": "https://stackoverflow.com/users/7484368/marcin-gadomski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "closed_date": 1567094268, "accepted_answer_id": 57701286, "answer_count": 3, "score": 1, "last_activity_date": 1567036274, "creation_date": 1567012975, "last_edit_date": 1567025630, "question_id": 57697321, "link": "https://stackoverflow.com/questions/57697321/allocating-and-freeing-memory-inside-loop-in-c", "closed_reason": "Not suitable for this site", "title": "Allocating and freeing memory inside loop in C", "body": "<p>I have a question about how to make a temporary string in C.  What I mean is I would like to create a string on every iteration step and free the variable after it is not useful anymore.\nI have seen question similar to this one, but they differ in significant ways.</p>\n\n<p>So right now I have something similar to this:</p>\n\n<pre><code>for (int i = 0; i &lt; array_size; i++) {\n    //aray1 and array2 are arrays of strings\n    char* temporary_value = make_hash(array1[i], array2[i], size[i]);\n    if (is_valid(temporary_value)) {\n       //Code, that doesn't interferate in memory, but uses temporary_value - mostly just compare to it\n    }\n    free(temporary_value);\n }\n</code></pre>\n\n<p>Where make_hash mallocs the memory depending on size[i].</p>\n\n<p>But it feels so wrong and sometimes returns segment fault.\nMy ideas to improve this are: </p>\n\n<ul>\n<li>Make string array and free it after the loop  </li>\n<li>Put \"make_hash\" code inside the for-loop and just realloc memory during iteration and free the temporary_value after the for-loop  </li>\n</ul>\n\n<p>But these solutions seem to be also bad.  How would you approach this kind of problem?</p>\n"}, {"tags": ["c", "linux", "linux-kernel"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567012734, "post_id": 57697168, "comment_id": 101838736, "body": "Did you terminate all of your jammed scripts or are they still stuck?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1567012994, "post_id": 57697168, "comment_id": 101838849, "body": "As an aside, ifconfig has been deprecated on linux for quite awhile.  I think it was last updated over 15 years ago."}, {"owner": {"reputation": 1, "user_id": 10875877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1078085b94fad42426d82fdab277f5?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh ", "link": "https://stackoverflow.com/users/10875877/santhosh"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1567013436, "post_id": 57697168, "comment_id": 101839032, "body": "@tadman No..it lead to memleak and my system reboots."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10875877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1078085b94fad42426d82fdab277f5?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh ", "link": "https://stackoverflow.com/users/10875877/santhosh"}, "edited": false, "score": 0, "creation_date": 1567013893, "post_id": 57697489, "comment_id": 101839210, "body": "I ran it only once.  I got nothing from ifconfig etho, seems ifconfig is not reaponding  Does zombies block other calls ?"}, {"owner": {"reputation": 429, "user_id": 11940163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fd03e0a47aa014dfd25c7063607192?s=128&d=identicon&r=PG&f=1", "display_name": "bigdataolddriver", "link": "https://stackoverflow.com/users/11940163/bigdataolddriver"}, "reply_to_user": {"reputation": 1, "user_id": 10875877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1078085b94fad42426d82fdab277f5?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh ", "link": "https://stackoverflow.com/users/10875877/santhosh"}, "edited": false, "score": 0, "creation_date": 1567014723, "post_id": 57697489, "comment_id": 101839563, "body": "if you ran script  only once, it is unusual to have more than one instance of  ifconfig_script.sh  post your simplified script here may help us understand the situation more clearly"}, {"owner": {"reputation": 1, "user_id": 10875877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1078085b94fad42426d82fdab277f5?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh ", "link": "https://stackoverflow.com/users/10875877/santhosh"}, "edited": false, "score": 0, "creation_date": 1567014878, "post_id": 57697489, "comment_id": 101839631, "body": "Is there a way kernel brings up the sleeping process multiple times ?"}], "tags": [], "owner": {"reputation": 429, "user_id": 11940163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54fd03e0a47aa014dfd25c7063607192?s=128&d=identicon&r=PG&f=1", "display_name": "bigdataolddriver", "link": "https://stackoverflow.com/users/11940163/bigdataolddriver"}, "is_accepted": false, "score": 1, "last_activity_date": 1567013745, "creation_date": 1567013745, "answer_id": 57697489, "question_id": 57697168, "link": "https://stackoverflow.com/questions/57697168/ifconfig-goes-to-uninterruptible-sleep-state-and-same-process-is-invoked-multipl/57697489#57697489", "title": "Ifconfig goes to uninterruptible sleep state and same process is invoked multiple time with different pid", "body": "<p>did you run script more than one time?</p>\n\n<p>and what is the result of running <code>ifconfig eth0</code> in shell?</p>\n\n<p>it looks like a zombie process in the way</p>\n\n<pre><code>7514 sh z\n</code></pre>\n\n<p>the smallest pid indicates that maybe  first call ifconfig was blocked , </p>\n\n<p>and the zombie process blocked  the latter call</p>\n"}], "owner": {"reputation": 1, "user_id": 10875877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1078085b94fad42426d82fdab277f5?s=128&d=identicon&r=PG&f=1", "display_name": "santhosh ", "link": "https://stackoverflow.com/users/10875877/santhosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "closed_date": 1567094354, "answer_count": 1, "score": -2, "last_activity_date": 1567013745, "creation_date": 1567012258, "last_edit_date": 1567012757, "question_id": 57697168, "link": "https://stackoverflow.com/questions/57697168/ifconfig-goes-to-uninterruptible-sleep-state-and-same-process-is-invoked-multipl", "closed_reason": "Not suitable for this site", "title": "Ifconfig goes to uninterruptible sleep state and same process is invoked multiple time with different pid", "body": "<p>I am using system() command to run my script which inturn calls \"ifconfig eth0 | grep \\\" RUNNING\\\"\".  Seems ifconfig is not responding and my system call blocks on it which moves my script to interruptible sleep state. Why am i seeing my script called multiple times after it goes to S state?</p>\n\n<pre><code>7514 sh z\n7515 ifonfig D\n7576 sh           S\n7577 ifconfig_script.sh S\n7705 ifconfig_script.sh S\n7706 ifconfig D\n7707 grep S\n7720 sh S\n7721 ifconfig_script.sh S\n7795 ifconfig_script.sh S\n7796 ifconfig D\n7797 grep S\n7820 sh S\n7821 ifconfig_script.sh S\n7895 ifconfig_script.sh S\n7896 ifconfig D\n7897 grep S\n........\n........\n........\n........\n</code></pre>\n\n<p>Can anyone help me why i seeing same process called multiple times with different pid?</p>\n"}, {"tags": ["mysql", "c", "linux", "mysql-workbench"], "comments": [{"owner": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1567008675, "post_id": 57696372, "comment_id": 101837067, "body": "Can you add your code to the question?  This will give us a better idea of what you are doing."}, {"owner": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "reply_to_user": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1567008967, "post_id": 57696372, "comment_id": 101837204, "body": "That&#39;s exactly the code in the link. I tried adding case &quot;MYSQL_TYPE_STRING&quot; and &quot;case MYSQL_TYPE_TIME&quot; but it doesn&#39;t work."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "reply_to_user": {"reputation": 1340, "user_id": 7218062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0e0d5a2d3c49c93f1aafd67adaaca59?s=128&d=identicon&r=PG&f=1", "display_name": "jmq", "link": "https://stackoverflow.com/users/7218062/jmq"}, "edited": false, "score": 0, "creation_date": 1567009230, "post_id": 57696372, "comment_id": 101837310, "body": "Trust jmq s recommendation to post code directly here instead of linking. You will encounter people in better mood. Actually the ideal way of doing it is making a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. ( @jmq try typing <code>[mcve]</code> in a comment on better showing code directly here. )"}, {"owner": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567010412, "post_id": 57696372, "comment_id": 101837789, "body": "CANNOT add code here. format problem. Please help me anyway."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567022907, "post_id": 57696991, "comment_id": 101842706, "body": "But that is not the problem. I would like to know how to take STRING variable (out) from the stored procedure."}, {"owner": {"reputation": 6490, "user_id": 1052130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa0e98e2ab917b174073a7e8b6c13b?s=128&d=identicon&r=PG", "display_name": "slaakso", "link": "https://stackoverflow.com/users/1052130/slaakso"}, "reply_to_user": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567024240, "post_id": 57696991, "comment_id": 101843193, "body": "That was the problem according to the error message which you posted (and later deleted). As said, to handle the strings, add the <code>MYSQL_TYPE_STRING</code> to switch and do whatever you want to do with the string there."}, {"owner": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567025646, "post_id": 57696991, "comment_id": 101843750, "body": "I tried but other problems comes after, like using &quot;%s&quot; to print the result is not accepted (warning) and doesn&#39;t show the string."}, {"owner": {"reputation": 6490, "user_id": 1052130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa0e98e2ab917b174073a7e8b6c13b?s=128&d=identicon&r=PG", "display_name": "slaakso", "link": "https://stackoverflow.com/users/1052130/slaakso"}, "reply_to_user": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567025906, "post_id": 57696991, "comment_id": 101843847, "body": "So why not show the actual code that you have problems with and the errors/warnings you are getting? Nobody can quess what the error/warning might be without seeing the code."}, {"owner": {"reputation": 6490, "user_id": 1052130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa0e98e2ab917b174073a7e8b6c13b?s=128&d=identicon&r=PG", "display_name": "slaakso", "link": "https://stackoverflow.com/users/1052130/slaakso"}, "reply_to_user": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "edited": false, "score": 0, "creation_date": 1567095416, "post_id": 57696991, "comment_id": 101870401, "body": "You did not show the error/warning you are getting. You do not show the whole code (where is <code>char_data</code> introduced / initialized). How does your procedure look like?"}], "tags": [], "owner": {"reputation": 6490, "user_id": 1052130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3baa0e98e2ab917b174073a7e8b6c13b?s=128&d=identicon&r=PG", "display_name": "slaakso", "link": "https://stackoverflow.com/users/1052130/slaakso"}, "is_accepted": false, "score": 0, "last_activity_date": 1567011348, "creation_date": 1567011348, "answer_id": 57696991, "question_id": 57696372, "link": "https://stackoverflow.com/questions/57696372/stored-procedure-in-c-problem-with-output-parameter-how-can-i-use-string/57696991#57696991", "title": "Stored procedure in c - problem with output parameter. How can I use string?", "body": "<p>Your code handles only <code>LONG</code>-datatype (<code>case MYSQL_TYPE_LONG</code>), but your call returns <code>BIGINT</code> (<code>MYSQL_TYPE_LONGLONG</code> = 8). Your switch-statement should handle all datatypes you use.</p>\n"}], "owner": {"reputation": 1, "user_id": 11990272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAm7Jf5Xg_1LcGxUYThdnaSB5cd4DJYAjP2TWDRQw=k-s128", "display_name": "Roberto Prete", "link": "https://stackoverflow.com/users/11990272/roberto-prete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1571086898, "creation_date": 1567008482, "last_edit_date": 1571086898, "question_id": 57696372, "link": "https://stackoverflow.com/questions/57696372/stored-procedure-in-c-problem-with-output-parameter-how-can-i-use-string", "title": "Stored procedure in c - problem with output parameter. How can I use string?", "body": "<p>I applied this code <a href=\"https://dev.mysql.com/doc/refman/5.5/en/c-api-prepared-call-statements.html\" rel=\"nofollow noreferrer\">https://dev.mysql.com/doc/refman/5.5/en/c-api-prepared-call-statements.html</a>.</p>\n\n<p>That's all right if I use int output variable. But what to do with MYSQL_TYPE_STRING? Adding this case to others is not enough. Any advice?</p>\n\n<p>I have to manage TIME and STRING MYSQL_TYPE.</p>\n\n<p>What is the code that I have to add, similar to this code?</p>\n\n<pre><code>/* process results until there are no more */\ndo {\n  int i;\n  int num_fields;       /* number of columns in result */\n  MYSQL_FIELD *fields;  /* for result set metadata */\n  MYSQL_BIND *rs_bind;  /* for output buffers */\n\n  /* the column count is &gt; 0 if there is a result set */\n  /* 0 if the result is only the final status packet */\n  num_fields = mysql_stmt_field_count(stmt);\n\n  if (num_fields &gt; 0)\n  {\n    /* there is a result set to fetch */\n    printf(\"Number of columns in result: %d\\n\", (int) num_fields);\n\n    /* what kind of result set is this? */\n    printf(\"Data: \");\n    if(con-&gt;server_status &amp; SERVER_PS_OUT_PARAMS)\n      printf(\"this result set contains OUT/INOUT parameters\\n\");\n    else\n      printf(\"this result set is produced by the procedure\\n\");\n\n    MYSQL_RES *rs_metadata = mysql_stmt_result_metadata(stmt);\n    test_stmt_error(stmt, rs_metadata == NULL);\n\n    fields = mysql_fetch_fields(rs_metadata);\n\n    rs_bind = (MYSQL_BIND *) malloc(sizeof (MYSQL_BIND) * num_fields);\n    if (!rs_bind)\n    {\n      printf(\"Cannot allocate output buffers\\n\");\n      exit(1);\n    }\n    memset(rs_bind, 0, sizeof (MYSQL_BIND) * num_fields);\n\n    /* set up and bind result set output buffers */\n    for (i = 0; i &lt; num_fields; ++i)\n    {\n      rs_bind[i].buffer_type = fields[i].type;\n      rs_bind[i].is_null = &amp;is_null[i];\n\n      switch (fields[i].type)\n      {\n        case MYSQL_TYPE_LONG:\n          rs_bind[i].buffer = (char *) &amp;(int_data[i]);\n          rs_bind[i].buffer_length = sizeof (int_data);\n          break;\n\n    case MYSQL_TYPE_STRING:\n          rs_bind[i].buffer = &amp;(char_data[i]);\n          rs_bind[i].buffer_length = sizeof (char_data);\n          break;\n\n    case MYSQL_TYPE_TIME:\n          rs_bind[i].buffer = (char *) &amp;(char_data[i]);\n          rs_bind[i].buffer_length = sizeof (char_data);\n          break;\n\n        default:\n          fprintf(stderr, \"ERROR: unexpected type: %d.\\n\", fields[i].type);\n          //exit(1);\n      }\n    }\n\n    status = mysql_stmt_bind_result(stmt, rs_bind);\n    test_stmt_error(stmt, status);\n\n    /* fetch and display result set rows */\n    while (1)\n    {\n      status = mysql_stmt_fetch(stmt);\n\n      if (status == 1 || status == MYSQL_NO_DATA)\n        break;\n\n    printf(\"%p,%lld,%s,%m,%m\",rs_bind[0].buffer,rs_bind[1].buffer,rs_bind[2].buffer,rs_bind[3].buffer,rs_bind[4].buffer);\n      for (i = 0; i &lt; num_fields; ++i)\n      {\n        switch (rs_bind[i].buffer_type)\n        {\n          case MYSQL_TYPE_LONG:\n            if (*rs_bind[i].is_null)\n              printf(\" val[%d] = NULL;\", i);\n            else\n              printf(\" val[%d] = %ld;\",\n                     i, (long) *((int *) rs_bind[i].buffer));\n            break;\n\n      case MYSQL_TYPE_STRING:\n            if (*rs_bind[i].is_null)\n              printf(\" val[%d] = NULL;\", i);\n            else\n              printf(\" val[%d] = %s;\",\n                     i, rs_bind[i].buffer);\n            break;\n\n      case MYSQL_TYPE_TIME:\n            if (*rs_bind[i].is_null)\n              printf(\" val[%d] = NULL;\", i);\n            else\n              printf(\" val[%d] = %s;\",\n                     i, rs_bind[i].buffer);\n            break;\n\n          default:\n            printf(\"  unexpected type (%d)\\n\",\n              rs_bind[i].buffer_type);\n        }\n      }\n      printf(\"\\n\");\n    }\n\n    mysql_free_result(rs_metadata); /* free metadata */\n    free(rs_bind);                  /* free output buffers */\n  }\n  else\n  {\n    /* no columns = final status packet */\n    printf(\"End of procedure output\\n\");\n  }\n\n  /* more results? -1 = no, &gt;0 = error, 0 = yes (keep looking) */\n  status = mysql_stmt_next_result(stmt);\n  if (status &gt; 0)\n    test_stmt_error(stmt, status);\n} while (status == 0);\n</code></pre>\n"}, {"tags": ["c", "c-preprocessor", "nameof"], "comments": [{"owner": {"reputation": 1510, "user_id": 5728157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed0956efcbacb4f24eb25437fdb856b?s=128&d=identicon&r=PG&f=1", "display_name": "andresantacruz", "link": "https://stackoverflow.com/users/5728157/andresantacruz"}, "edited": false, "score": 0, "creation_date": 1567008184, "post_id": 57696277, "comment_id": 101836836, "body": "Unfortunately no :("}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1567008205, "post_id": 57696277, "comment_id": 101836843, "body": "<code>#define SOME_CONSTANT_NAME &quot;SOME_CONSTANT&quot;</code> is about as close as you&#39;re going to get."}, {"owner": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 2, "creation_date": 1567008288, "post_id": 57696277, "comment_id": 101836881, "body": "The reason C# has this and C doesn&#39;t is because C# has <a href=\"https://docs.microsoft.com/en-us/dotnet/standard/metadata-and-self-describing-components\" rel=\"nofollow noreferrer\"><i>metadata,</i></a> while C does not.  Once your program has been compiled, the name of the constant is gone."}, {"owner": {"reputation": 23, "user_id": 4145313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iodq6YTXFdA/AAAAAAAAAAI/AAAAAAAAAD8/aRkghGMq2NE/photo.jpg?sz=128", "display_name": "palmis", "link": "https://stackoverflow.com/users/4145313/palmis"}, "reply_to_user": {"reputation": 168120, "user_id": 102937, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/1233ec65168f4aae4d939ae8fe6cde1e?s=128&d=identicon&r=PG", "display_name": "Robert Harvey", "link": "https://stackoverflow.com/users/102937/robert-harvey"}, "edited": false, "score": 0, "creation_date": 1567008659, "post_id": 57696277, "comment_id": 101837056, "body": "I was trying to avoid that @RobertHarvey, but I guess it&#39;s not possible :( Thank you anyway, you both."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 6, "creation_date": 1567009469, "post_id": 57696277, "comment_id": 101837414, "body": "Consider going one step back and asking about help on whatever you are trying to achieve. I think we might be looking at a XY problem. <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a> This is nothing bad, it means that there might actually be a cool easy way to achieve your actual goal."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 3, "creation_date": 1567012663, "post_id": 57696277, "comment_id": 101838702, "body": "You can <code>#define NAMEOF(X) #X</code>, and then <code>NAMEOF(SOME_CONSTANT)</code> will expand to <code>&quot;SOME_CONSTANT&quot;</code>. I&#39;m not sure if that&#39;s what you really want."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1567013388, "post_id": 57696277, "comment_id": 101839016, "body": "... My <code>NAMEOF(X)</code> suggestion is probably not what you want because it isn&#39;t nestable. So after <code>#define NAMEOF(X) #X</code> and <code>#define FOO(X) X</code>, <code>NAMEOF(FOO(SOME_CONSTANT))</code> would expand to <code>&quot;FOO(X)&quot;</code>, which is very unlikely to be what you want. Similarly, after <code>#define NAMEOF(X) #X</code> and <code>#define XFOO(X) X</code> and <code>#define FOO(X) XFOO(X)</code>, <code>NAMEOF(FOO(SOME_CONSTANT))</code> would expand to <code>&quot;FOO(SOME_CONSTANT)&quot;</code>, which may be a slight improvement, but still unlikely to be what you want."}, {"owner": {"reputation": 23, "user_id": 4145313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iodq6YTXFdA/AAAAAAAAAAI/AAAAAAAAAD8/aRkghGMq2NE/photo.jpg?sz=128", "display_name": "palmis", "link": "https://stackoverflow.com/users/4145313/palmis"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1567013848, "post_id": 57696277, "comment_id": 101839201, "body": "@IanAbbott, your NAMEOF(X) #X seems to work exactly as I want because I don&#39;t need it to handle nested stuff, I just have some keywords that I have to match in a file and convert them to int values, now I try it!"}, {"owner": {"reputation": 23, "user_id": 4145313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iodq6YTXFdA/AAAAAAAAAAI/AAAAAAAAAD8/aRkghGMq2NE/photo.jpg?sz=128", "display_name": "palmis", "link": "https://stackoverflow.com/users/4145313/palmis"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1567150669, "post_id": 57696277, "comment_id": 101885592, "body": "@IanAbbott I tested your solution and it works, if you want you can write it as an answer, or I&#39;ll do it myself"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1567151245, "post_id": 57696277, "comment_id": 101885863, "body": "Why write <code>nameof(KEY_A)</code> when you can write <code>&quot;KEY_A&quot;</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1567161213, "post_id": 57696277, "comment_id": 101890440, "body": "@n.m. That&#39;s what I&#39;m wondering too, which is why I&#39;m loath to submit my suggestion as a answer. (The only thing I can think of is that maybe OP is listing the symbols in a file wrapped as a macro call, and <code>#include</code>ing the file more than once with different definitions of the macro.)"}], "owner": {"reputation": 23, "user_id": 4145313, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Iodq6YTXFdA/AAAAAAAAAAI/AAAAAAAAAD8/aRkghGMq2NE/photo.jpg?sz=128", "display_name": "palmis", "link": "https://stackoverflow.com/users/4145313/palmis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567150521, "creation_date": 1567008075, "last_edit_date": 1567150521, "question_id": 57696277, "link": "https://stackoverflow.com/questions/57696277/is-there-something-like-nameof-of-c-in-c-for-define-directive", "title": "Is there something like nameof of C# in C for define directive?", "body": "<p>I have the classic</p>\n\n<pre><code>    #define SOME_CONSTANT value\n</code></pre>\n\n<p>Is there a way to get the string <code>\"SOME_CONSTANT\"</code> like the C# <code>nameof(field)</code>?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I have to parse a file looking for some keyword:</p>\n\n<pre><code>#define KEY_A 1\n#define KEY_B 2\n\nint foo(char *s)\n{\n    if (strcmp(s, nameof(KEY_A)) == 0)\n        return KEY_A;\n    else if (strcmp(s, nameof(KEY_B)) == 0)\n        return KEY_B;\n    else\n        return -1;\n}\n</code></pre>\n\n<p>if i call <code>foo(\"KEY_A\")</code> it should return 1</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 141, "user_id": 11883343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb488758694f1aae503ff9704389e75?s=128&d=identicon&r=PG", "display_name": "Wocket", "link": "https://stackoverflow.com/users/11883343/wocket"}, "edited": false, "score": 4, "creation_date": 1567007997, "post_id": 57696181, "comment_id": 101836725, "body": "The working/not working code should behave identically. A static array is guaranteed to be initialized to all-zeros by the C standard, so if you explicitly initialize it or not shouldn&#39;t make a difference. Maybe time to look at the generated code."}, {"owner": {"reputation": 29, "user_id": 11844226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qi3KgD9yDsM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdiGyWkSKI4lHHtJPXuiL7V8vPy2w/photo.jpg?sz=128", "display_name": "woeh swe", "link": "https://stackoverflow.com/users/11844226/woeh-swe"}, "reply_to_user": {"reputation": 141, "user_id": 11883343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8bb488758694f1aae503ff9704389e75?s=128&d=identicon&r=PG", "display_name": "Wocket", "link": "https://stackoverflow.com/users/11883343/wocket"}, "edited": false, "score": 0, "creation_date": 1567008313, "post_id": 57696181, "comment_id": 101836891, "body": "This chip doesn&#39;t support code-generation. So everything is coded by hand. this is why I cannot belive that a non-initialized static array is identical to an initialized static arry. it apparently making a problem..."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1567008365, "post_id": 57696181, "comment_id": 101836916, "body": "@woehswe &quot;This chip doesn&#39;t support code-generation.&quot; What do you mean by that? There is some compiled code being generated by the compiler."}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 0, "creation_date": 1567008381, "post_id": 57696181, "comment_id": 101836930, "body": "Look at memory map of the linked program (you may need to add command line switch to get it). Does it look ok? How is it different between static and non-static global array?"}, {"owner": {"reputation": 3699, "user_id": 474173, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/18331a42eeb0683a21fe3af6722c04cc?s=128&d=identicon&r=PG", "display_name": "Swanand", "link": "https://stackoverflow.com/users/474173/swanand"}, "edited": false, "score": 0, "creation_date": 1567008388, "post_id": 57696181, "comment_id": 101836933, "body": "Only difference it would make is zero initialsed array will be part of bss memory region. Otherwise, should not be a problem. As it is a very specific problem and you don&#39;t have a debugger, What happens when you say &quot;System dies&quot;? And is it immediately at startup or after some time - fixed or random."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1567008777, "post_id": 57696181, "comment_id": 101837103, "body": "It appears you are saying that <code>static INT8U preErrorInfo[2];</code> works but <code>static INT8U preErrorInfo[9];</code> does not."}, {"owner": {"reputation": 29, "user_id": 11844226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qi3KgD9yDsM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdiGyWkSKI4lHHtJPXuiL7V8vPy2w/photo.jpg?sz=128", "display_name": "woeh swe", "link": "https://stackoverflow.com/users/11844226/woeh-swe"}, "edited": false, "score": 0, "creation_date": 1567008822, "post_id": 57696181, "comment_id": 101837129, "body": "[Initialized] --&gt;  .data.preErrorInfo 0x00000080        0x9 obj/EcuProtectCTR.o                                           [UnInitialized] --&gt;  .bss.preErrorInfo                 0x00000140        0x9 obj/EcuProtectCTR.o"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1567009273, "post_id": 57696181, "comment_id": 101837330, "body": "Perhaps there is something else you are changing too."}, {"owner": {"reputation": 29, "user_id": 11844226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qi3KgD9yDsM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdiGyWkSKI4lHHtJPXuiL7V8vPy2w/photo.jpg?sz=128", "display_name": "woeh swe", "link": "https://stackoverflow.com/users/11844226/woeh-swe"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1567010784, "post_id": 57696181, "comment_id": 101837931, "body": "@Weather Vane Thanks. I got it working. it turned out that it has something to do with overflow."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1567011092, "post_id": 57696181, "comment_id": 101838054, "body": "I recommend deleting the question since the problem is now diagnosed as a &quot;writing out of bounds elsewhere&quot;, which is not something you can make into a succinct SO question."}], "owner": {"reputation": 29, "user_id": 11844226, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Qi3KgD9yDsM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdiGyWkSKI4lHHtJPXuiL7V8vPy2w/photo.jpg?sz=128", "display_name": "woeh swe", "link": "https://stackoverflow.com/users/11844226/woeh-swe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1567012941, "creation_date": 1567007704, "last_edit_date": 1567012941, "question_id": 57696181, "link": "https://stackoverflow.com/questions/57696181/keep-having-an-error-when-using-static-array-which-is-not-initialized", "title": "Keep having an error when using static array which is not initialized", "body": "<p>I am using 16bit microcontroller which uses gcc4.5 compiler, 32kbyte flash/1kbyte ram. compiling is fine without error, memory is reaching to it's limit but it has some vacancy on both flash/ram and works just fine</p>\n\n<p>However, when i define static array without initialization it causes system to die. I cannot use debugger to watch what's going on inside my system. </p>\n\n<p>I didn't even use the array other than define it. so I assume compiler should skip below code but it kept making a problem.</p>\n\n<pre><code>typedef enum\n{\n    PTC_VOLT_ERROR = 0,\n    PTC_LINE_ERROR,\n    PTC_ERROR,  \n    PTC_PCB1TEMP_ERROR,\n    PTC_PCB2TEMP_ERROR, \n    PTC_COMM_ERROR,\n    PTC_SELF_DIAG_ERROR,\n    PTC_PCB1TEMPSSR_ERROR,\n    PTC_PCB2TEMPSSR_ERROR,\n    NUM_OF_PTC_ERROR_TYPE\n}PtcErrorTypeInfo_t;\n(...)\nstatic INT8U preErrorInfo[NUM_OF_PTC_ERROR_TYPE]; // This cause system to die\n//static INT8U preErrorInfo[NUM_OF_PTC_ERROR_TYPE]={0,}; // This is ok\n</code></pre>\n\n<p>Then I tried with non-static global arry and found it was working well.</p>\n\n<pre><code>INT8U preErrorInfo[NUM_OF_PTC_ERROR_TYPE]; // This is ok\nstatic INT8U preErrorInfo[2]; // This is also ok\n\n\nstatic INT8U preErrorInfo[9]; // This is not working\nstatic INT8U preErrorInfo[2]; // This is working\n</code></pre>\n\n<p>I want to know what could make my system down?</p>\n\n<p><strong>\u2192\u2192\u2192 It turned out that it had something to do with overflow and trap error.</strong></p>\n\n<p>first>> when I compile without static, in the map file</p>\n\n<pre><code> .data.g_PtcProtectionState\n                0x0000007e        0x2 obj/EcuProtectCTR.o\n                0x0000007e                _g_PtcProtectionState\n .data.preErrorInfo\n                0x00000080        0x9 obj/EcuProtectCTR.o\n .data.u1_ErrorDeterTmr\n                0x00000089        0x1 obj/EcuProtectCTR.o\n .data.pendingCalibOn\n                0x0000008a        0x6 obj/EcuSsrInputCTR.o\n                0x0000008a                _pendingCalibOn\n\n(...)\n .bss.g_u4_ErrorCntrInfo\n                0x00000144        0x4 obj/EcuProtectCTR.o\n **.bss.g_u1_TmrInt\n                0x00000148        0x1 obj/SchM.o\n                0x00000148                _g_u1_TmrInt**\n .bss.u1_ElapsedTime\n                0x00000149        0x1 obj/SchM.o\n\n\n</code></pre>\n\n<p>it makes preErrorInfo[9] array seats in the data area.</p>\n\n<p>second>> if i compile with 'static'</p>\n\n<pre><code> .bss.g_u4_ErrorCntrInfo\n                0x0000013c        0x4 obj/EcuProtectCTR.o\n .bss.preErrorInfo\n                0x00000140        0x9 obj/EcuProtectCTR.o\n .bss.g_u1_TmrInt\n                0x00000149        0x1 obj/SchM.o\n                0x00000149                _g_u1_TmrInt\n\n</code></pre>\n\n<p>preErrorInfo arry nicely seats on bss area. However, there is a variable 'g_u1_TmrInt' which keeps causing a problem. this timer-interrupt geard variable keeps making an overflow.</p>\n\n<p>since 'static preErrorInfo array' will seat right above 'g_u1_TmrInt' somehow it could be messed up with 'static preErrorInfo array' when overflowing.</p>\n\n<p><strong>But I wonder why it didn't cause a problem when it comes to a case 'first>>' which has a 'g_u4_ErrorCntrInfo' 4byte array seated right above 'g_u1_TmrInt' and it would surely make the same overflow error.</strong></p>\n\n<p>\u203b when I change 'g_u1_TmrInt' type to 16bit(no-overflow and no error), it would look like this and work like charm.</p>\n\n<pre><code> .bss.preErrorInfo\n                0x00000140        0x9 obj/EcuProtectCTR.o\n *fill*         0x00000149        0x1 \n .bss.g_u1_TmrInt\n                0x0000014a        0x2 obj/SchM.o\n                0x0000014a                _g_u1_TmrInt\n .bss.u1_ElapsedTime\n                0x0000014c        0x2 obj/SchM.o\n .bss.SchConfig\n\n</code></pre>\n"}, {"tags": ["c", "blas", "gsl", "cblas"], "answers": [{"tags": [], "owner": {"reputation": 2956, "user_id": 5909388, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uNuNWo_bCHA/AAAAAAAAAAI/AAAAAAAAABg/rciVxcULLHc/photo.jpg?sz=128", "display_name": "Kaveh Vahedipour", "link": "https://stackoverflow.com/users/5909388/kaveh-vahedipour"}, "is_accepted": false, "score": 0, "last_activity_date": 1567449318, "creation_date": 1567449318, "answer_id": 57761423, "question_id": 57693987, "link": "https://stackoverflow.com/questions/57693987/undefined-references-in-cblas-when-testing-gsl-with-cmake/57761423#57761423", "title": "Undefined References in CBLAS when testing GSL with CMake", "body": "<p>Add the following to your CMakeList.txt</p>\n\n<pre><code>find_package(BLAS REQUIRED)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11245996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdd8674c61e65cb00124c916f688e6d3?s=128&d=identicon&r=PG&f=1", "display_name": "Zhiyuan", "link": "https://stackoverflow.com/users/11245996/zhiyuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 134, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567449318, "creation_date": 1567000087, "last_edit_date": 1567003389, "question_id": 57693987, "link": "https://stackoverflow.com/questions/57693987/undefined-references-in-cblas-when-testing-gsl-with-cmake", "title": "Undefined References in CBLAS when testing GSL with CMake", "body": "<p>I've just installed GSL on my Deepin OS(Linux), and for testing my installation I'm trying to compile a testing file. When compiling with <code>gcc</code>, it works properly, but when using CMake, some <code>Undefined Reference</code> error occurs.</p>\n\n<p>I tried compiling the file <code>main.c</code> with <code>gcc</code> :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>gcc main.c -o demo -lm -lgsl -lgslcblas\n./demo\n</code></pre>\n\n<p>and it works properly. But when I tried CMake :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cmake .\nmake\n</code></pre>\n\n<p>with a CMakeLists.txt file that looks like :</p>\n\n<pre><code># CMakeLists.txt\ncmake_minimum_required(VERSION 2.8)\nproject(demo)\n\nset(CMAKE_CXX_STANDARD 11)\nset(CMAKE_CXX_STANDARD_REQUIRED YES)\n\nset(SOURCE_FILES main.c)\nadd_executable(demo ${SOURCE_FILES})\n\nfind_package(GSL REQUIRED)\ntarget_link_libraries(demo GSL::gsl GSL::gslcblas)\n</code></pre>\n\n<p>such error occurs \uff1a</p>\n\n<p><strong>(The output is in Chinese, because of the system language. For example :</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/usr/local/lib/libcblas.a(cblas_srotg.o)\uff1a\u5728\u51fd\u6570\u2018cblas_srotg\u2019\u4e2d\uff1a\ncblas_srotg.c:(.text+0x1)\uff1a\u5bf9\u2018srotg_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n</code></pre>\n\n<p><strong>means :</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>/usr/local/lib/libcblas.a(cblas_srotg.o)\uff1aIn function \u2018cblas_srotg\u2019 \uff1a\ncblas_srotg.c:(.text+0x1)\uff1aUndefined reference to \u2018srotg_\u2019.\n</code></pre>\n\n<p><strong>)</strong></p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>[ 50%] Linking C executable demo\n/usr/local/lib/libcblas.a(cblas_srotg.o)\uff1a\u5728\u51fd\u6570\u2018cblas_srotg\u2019\u4e2d\uff1a\ncblas_srotg.c:(.text+0x1)\uff1a\u5bf9\u2018srotg_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_srotmg.o)\uff1a\u5728\u51fd\u6570\u2018cblas_srotmg\u2019\u4e2d\uff1a\ncblas_srotmg.c:(.text+0x13)\uff1a\u5bf9\u2018srotmg_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_srot.o)\uff1a\u5728\u51fd\u6570\u2018cblas_srot\u2019\u4e2d\uff1a\ncblas_srot.c:(.text+0x3c)\uff1a\u5bf9\u2018srot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_srotm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_srotm\u2019\u4e2d\uff1a\ncblas_srotm.c:(.text+0x21)\uff1a\u5bf9\u2018srotm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_sswap.o)\uff1a\u5728\u51fd\u6570\u2018cblas_sswap\u2019\u4e2d\uff1a\ncblas_sswap.c:(.text+0x21)\uff1a\u5bf9\u2018sswap_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_sscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_sscal\u2019\u4e2d\uff1a\ncblas_sscal.c:(.text+0x28)\uff1a\u5bf9\u2018sscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_scopy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_scopy\u2019\u4e2d\uff1a\ncblas_scopy.c:(.text+0x21)\uff1a\u5bf9\u2018scopy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_saxpy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_saxpy\u2019\u4e2d\uff1a\ncblas_saxpy.c:(.text+0x35)\uff1a\u5bf9\u2018saxpy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(sdotsub.o)\uff1a\u5728\u51fd\u6570\u2018sdotsub_\u2019\u4e2d\uff1a\nsdotsub.f:(.text+0x7)\uff1a\u5bf9\u2018sdot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(sdsdotsub.o)\uff1a\u5728\u51fd\u6570\u2018sdsdotsub_\u2019\u4e2d\uff1a\nsdsdotsub.f:(.text+0x7)\uff1a\u5bf9\u2018sdsdot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(snrm2sub.o)\uff1a\u5728\u51fd\u6570\u2018snrm2sub_\u2019\u4e2d\uff1a\nsnrm2sub.f:(.text+0x7)\uff1a\u5bf9\u2018snrm2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(sasumsub.o)\uff1a\u5728\u51fd\u6570\u2018sasumsub_\u2019\u4e2d\uff1a\nsasumsub.f:(.text+0x7)\uff1a\u5bf9\u2018sasum_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(isamaxsub.o)\uff1a\u5728\u51fd\u6570\u2018isamaxsub_\u2019\u4e2d\uff1a\nisamaxsub.f:(.text+0x7)\uff1a\u5bf9\u2018isamax_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_drotg.o)\uff1a\u5728\u51fd\u6570\u2018cblas_drotg\u2019\u4e2d\uff1a\ncblas_drotg.c:(.text+0x1)\uff1a\u5bf9\u2018drotg_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_drotmg.o)\uff1a\u5728\u51fd\u6570\u2018cblas_drotmg\u2019\u4e2d\uff1a\ncblas_drotmg.c:(.text+0x13)\uff1a\u5bf9\u2018drotmg_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_drot.o)\uff1a\u5728\u51fd\u6570\u2018cblas_drot\u2019\u4e2d\uff1a\ncblas_drot.c:(.text+0x3b)\uff1a\u5bf9\u2018drot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_drotm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_drotm\u2019\u4e2d\uff1a\ncblas_drotm.c:(.text+0x21)\uff1a\u5bf9\u2018drotm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dswap.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dswap\u2019\u4e2d\uff1a\ncblas_dswap.c:(.text+0x21)\uff1a\u5bf9\u2018dswap_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dscal\u2019\u4e2d\uff1a\ncblas_dscal.c:(.text+0x25)\uff1a\u5bf9\u2018dscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dcopy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dcopy\u2019\u4e2d\uff1a\ncblas_dcopy.c:(.text+0x21)\uff1a\u5bf9\u2018dcopy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_daxpy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_daxpy\u2019\u4e2d\uff1a\ncblas_daxpy.c:(.text+0x38)\uff1a\u5bf9\u2018daxpy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(ddotsub.o)\uff1a\u5728\u51fd\u6570\u2018ddotsub_\u2019\u4e2d\uff1a\nddotsub.f:(.text+0x7)\uff1a\u5bf9\u2018ddot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(dsdotsub.o)\uff1a\u5728\u51fd\u6570\u2018dsdotsub_\u2019\u4e2d\uff1a\ndsdotsub.f:(.text+0x7)\uff1a\u5bf9\u2018dsdot_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(dnrm2sub.o)\uff1a\u5728\u51fd\u6570\u2018dnrm2sub_\u2019\u4e2d\uff1a\ndnrm2sub.f:(.text+0x7)\uff1a\u5bf9\u2018dnrm2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(dasumsub.o)\uff1a\u5728\u51fd\u6570\u2018dasumsub_\u2019\u4e2d\uff1a\ndasumsub.f:(.text+0x7)\uff1a\u5bf9\u2018dasum_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(idamaxsub.o)\uff1a\u5728\u51fd\u6570\u2018idamaxsub_\u2019\u4e2d\uff1a\nidamaxsub.f:(.text+0x7)\uff1a\u5bf9\u2018idamax_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cswap.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cswap\u2019\u4e2d\uff1a\ncblas_cswap.c:(.text+0x21)\uff1a\u5bf9\u2018cswap_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cscal\u2019\u4e2d\uff1a\ncblas_cscal.c:(.text+0x17)\uff1a\u5bf9\u2018cscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_csscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_csscal\u2019\u4e2d\uff1a\ncblas_csscal.c:(.text+0x28)\uff1a\u5bf9\u2018csscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ccopy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ccopy\u2019\u4e2d\uff1a\ncblas_ccopy.c:(.text+0x21)\uff1a\u5bf9\u2018ccopy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_caxpy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_caxpy\u2019\u4e2d\uff1a\ncblas_caxpy.c:(.text+0x21)\uff1a\u5bf9\u2018caxpy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cdotcsub.o)\uff1a\u5728\u51fd\u6570\u2018cdotcsub_\u2019\u4e2d\uff1a\ncdotcsub.f:(.text+0xb)\uff1a\u5bf9\u2018cdotc_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cdotusub.o)\uff1a\u5728\u51fd\u6570\u2018cdotusub_\u2019\u4e2d\uff1a\ncdotusub.f:(.text+0xb)\uff1a\u5bf9\u2018cdotu_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(icamaxsub.o)\uff1a\u5728\u51fd\u6570\u2018icamaxsub_\u2019\u4e2d\uff1a\nicamaxsub.f:(.text+0x7)\uff1a\u5bf9\u2018icamax_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zswap.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zswap\u2019\u4e2d\uff1a\ncblas_zswap.c:(.text+0x21)\uff1a\u5bf9\u2018zswap_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zscal\u2019\u4e2d\uff1a\ncblas_zscal.c:(.text+0x17)\uff1a\u5bf9\u2018zscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zdscal.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zdscal\u2019\u4e2d\uff1a\ncblas_zdscal.c:(.text+0x25)\uff1a\u5bf9\u2018zdscal_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zcopy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zcopy\u2019\u4e2d\uff1a\ncblas_zcopy.c:(.text+0x21)\uff1a\u5bf9\u2018zcopy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zaxpy.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zaxpy\u2019\u4e2d\uff1a\ncblas_zaxpy.c:(.text+0x21)\uff1a\u5bf9\u2018zaxpy_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(zdotcsub.o)\uff1a\u5728\u51fd\u6570\u2018zdotcsub_\u2019\u4e2d\uff1a\nzdotcsub.f:(.text+0x7)\uff1a\u5bf9\u2018zdotc_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(zdotusub.o)\uff1a\u5728\u51fd\u6570\u2018zdotusub_\u2019\u4e2d\uff1a\nzdotusub.f:(.text+0x7)\uff1a\u5bf9\u2018zdotu_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(dzasumsub.o)\uff1a\u5728\u51fd\u6570\u2018dzasumsub_\u2019\u4e2d\uff1a\ndzasumsub.f:(.text+0x7)\uff1a\u5bf9\u2018dzasum_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(dznrm2sub.o)\uff1a\u5728\u51fd\u6570\u2018dznrm2sub_\u2019\u4e2d\uff1a\ndznrm2sub.f:(.text+0x7)\uff1a\u5bf9\u2018dznrm2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(izamaxsub.o)\uff1a\u5728\u51fd\u6570\u2018izamaxsub_\u2019\u4e2d\uff1a\nizamaxsub.f:(.text+0x7)\uff1a\u5bf9\u2018izamax_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(scasumsub.o)\uff1a\u5728\u51fd\u6570\u2018scasumsub_\u2019\u4e2d\uff1a\nscasumsub.f:(.text+0x7)\uff1a\u5bf9\u2018scasum_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(scnrm2sub.o)\uff1a\u5728\u51fd\u6570\u2018scnrm2sub_\u2019\u4e2d\uff1a\nscnrm2sub.f:(.text+0x7)\uff1a\u5bf9\u2018scnrm2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_sgemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_sgemv\u2019\u4e2d\uff1a\ncblas_sgemv.c:(.text+0x124)\uff1a\u5bf9\u2018sgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_sger.o)\uff1a\u5728\u51fd\u6570\u2018cblas_sger\u2019\u4e2d\uff1a\ncblas_sger.c:(.text+0xab)\uff1a\u5bf9\u2018sger_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_sger.c:(.text+0xe3)\uff1a\u5bf9\u2018sger_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssymv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssymv\u2019\u4e2d\uff1a\ncblas_ssymv.c:(.text+0xb4)\uff1a\u5bf9\u2018ssymv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssyr.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssyr\u2019\u4e2d\uff1a\ncblas_ssyr.c:(.text+0xa8)\uff1a\u5bf9\u2018ssyr_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssyr2.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssyr2\u2019\u4e2d\uff1a\ncblas_ssyr2.c:(.text+0xb2)\uff1a\u5bf9\u2018ssyr2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_strmv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_strmv\u2019\u4e2d\uff1a\ncblas_strmv.c:(.text+0x141)\uff1a\u5bf9\u2018strmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_strsv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_strsv\u2019\u4e2d\uff1a\ncblas_strsv.c:(.text+0x141)\uff1a\u5bf9\u2018strsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dgemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dgemv\u2019\u4e2d\uff1a\ncblas_dgemv.c:(.text+0x120)\uff1a\u5bf9\u2018dgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dger.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dger\u2019\u4e2d\uff1a\ncblas_dger.c:(.text+0xb3)\uff1a\u5bf9\u2018dger_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_dger.c:(.text+0xeb)\uff1a\u5bf9\u2018dger_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsymv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsymv\u2019\u4e2d\uff1a\ncblas_dsymv.c:(.text+0xb4)\uff1a\u5bf9\u2018dsymv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsyr.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsyr\u2019\u4e2d\uff1a\ncblas_dsyr.c:(.text+0xa6)\uff1a\u5bf9\u2018dsyr_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsyr2.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsyr2\u2019\u4e2d\uff1a\ncblas_dsyr2.c:(.text+0xb0)\uff1a\u5bf9\u2018dsyr2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dtrmv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dtrmv\u2019\u4e2d\uff1a\ncblas_dtrmv.c:(.text+0x141)\uff1a\u5bf9\u2018dtrmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dtrsv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dtrsv\u2019\u4e2d\uff1a\ncblas_dtrsv.c:(.text+0x141)\uff1a\u5bf9\u2018dtrsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cgemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cgemv\u2019\u4e2d\uff1a\ncblas_cgemv.c:(.text+0x205)\uff1a\u5bf9\u2018cgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgemv.c:(.text+0x290)\uff1a\u5bf9\u2018cgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgemv.c:(.text+0x36d)\uff1a\u5bf9\u2018cgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_chemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_chemv\u2019\u4e2d\uff1a\ncblas_chemv.c:(.text+0x219)\uff1a\u5bf9\u2018chemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_chemv.c:(.text+0x2f0)\uff1a\u5bf9\u2018chemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ctrmv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ctrmv\u2019\u4e2d\uff1a\ncblas_ctrmv.c:(.text+0x146)\uff1a\u5bf9\u2018ctrmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ctrmv.c:(.text+0x200)\uff1a\u5bf9\u2018ctrmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ctrsv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ctrsv\u2019\u4e2d\uff1a\ncblas_ctrsv.c:(.text+0x154)\uff1a\u5bf9\u2018ctrsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ctrsv.c:(.text+0x210)\uff1a\u5bf9\u2018ctrsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cgeru.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cgeru\u2019\u4e2d\uff1a\ncblas_cgeru.c:(.text+0xa6)\uff1a\u5bf9\u2018cgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgeru.c:(.text+0xd9)\uff1a\u5bf9\u2018cgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cgerc.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cgerc\u2019\u4e2d\uff1a\ncblas_cgerc.c:(.text+0x13d)\uff1a\u5bf9\u2018cgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgerc.c:(.text+0x18f)\uff1a\u5bf9\u2018cgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgerc.c:(.text+0x1ef)\uff1a\u5bf9\u2018cgerc_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cher.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cher\u2019\u4e2d\uff1a\ncblas_cher.c:(.text+0x10a)\uff1a\u5bf9\u2018cher_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cher.c:(.text+0x1f7)\uff1a\u5bf9\u2018cher_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cher2.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cher2\u2019\u4e2d\uff1a\ncblas_cher2.c:(.text+0x17a)\uff1a\u5bf9\u2018cher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cher2.c:(.text+0x281)\uff1a\u5bf9\u2018cher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cher2.c:(.text+0x2bc)\uff1a\u5bf9\u2018cher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zgemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zgemv\u2019\u4e2d\uff1a\ncblas_zgemv.c:(.text+0x20f)\uff1a\u5bf9\u2018zgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgemv.c:(.text+0x298)\uff1a\u5bf9\u2018zgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgemv.c:(.text+0x37c)\uff1a\u5bf9\u2018zgemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zhemv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zhemv\u2019\u4e2d\uff1a\ncblas_zhemv.c:(.text+0x219)\uff1a\u5bf9\u2018zhemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zhemv.c:(.text+0x2f0)\uff1a\u5bf9\u2018zhemv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ztrmv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ztrmv\u2019\u4e2d\uff1a\ncblas_ztrmv.c:(.text+0x155)\uff1a\u5bf9\u2018ztrmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ztrmv.c:(.text+0x210)\uff1a\u5bf9\u2018ztrmv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ztrsv.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ztrsv\u2019\u4e2d\uff1a\ncblas_ztrsv.c:(.text+0x155)\uff1a\u5bf9\u2018ztrsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ztrsv.c:(.text+0x210)\uff1a\u5bf9\u2018ztrsv_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zgeru.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zgeru\u2019\u4e2d\uff1a\ncblas_zgeru.c:(.text+0xa6)\uff1a\u5bf9\u2018zgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgeru.c:(.text+0xd9)\uff1a\u5bf9\u2018zgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zgerc.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zgerc\u2019\u4e2d\uff1a\ncblas_zgerc.c:(.text+0x13e)\uff1a\u5bf9\u2018zgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgerc.c:(.text+0x18f)\uff1a\u5bf9\u2018zgeru_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgerc.c:(.text+0x1ef)\uff1a\u5bf9\u2018zgerc_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zher.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zher\u2019\u4e2d\uff1a\ncblas_zher.c:(.text+0x14b)\uff1a\u5bf9\u2018zher_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zher.c:(.text+0x1a5)\uff1a\u5bf9\u2018zher_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zher2.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zher2\u2019\u4e2d\uff1a\ncblas_zher2.c:(.text+0x17b)\uff1a\u5bf9\u2018zher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zher2.c:(.text+0x281)\uff1a\u5bf9\u2018zher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zher2.c:(.text+0x2bc)\uff1a\u5bf9\u2018zher2_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_sgemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_sgemm\u2019\u4e2d\uff1a\ncblas_sgemm.c:(.text+0x10f)\uff1a\u5bf9\u2018sgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_sgemm.c:(.text+0x1a7)\uff1a\u5bf9\u2018sgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssymm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssymm\u2019\u4e2d\uff1a\ncblas_ssymm.c:(.text+0xe8)\uff1a\u5bf9\u2018ssymm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssyrk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssyrk\u2019\u4e2d\uff1a\ncblas_ssyrk.c:(.text+0xd7)\uff1a\u5bf9\u2018ssyrk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ssyr2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ssyr2k\u2019\u4e2d\uff1a\ncblas_ssyr2k.c:(.text+0xe5)\uff1a\u5bf9\u2018ssyr2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_strmm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_strmm\u2019\u4e2d\uff1a\ncblas_strmm.c:(.text+0x12a)\uff1a\u5bf9\u2018strmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_strmm.c:(.text+0x1f0)\uff1a\u5bf9\u2018strmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_strsm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_strsm\u2019\u4e2d\uff1a\ncblas_strsm.c:(.text+0x12a)\uff1a\u5bf9\u2018strsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_strsm.c:(.text+0x1f0)\uff1a\u5bf9\u2018strsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dgemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dgemm\u2019\u4e2d\uff1a\ncblas_dgemm.c:(.text+0x10f)\uff1a\u5bf9\u2018dgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_dgemm.c:(.text+0x1a7)\uff1a\u5bf9\u2018dgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsymm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsymm\u2019\u4e2d\uff1a\ncblas_dsymm.c:(.text+0xe8)\uff1a\u5bf9\u2018dsymm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsyrk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsyrk\u2019\u4e2d\uff1a\ncblas_dsyrk.c:(.text+0xd7)\uff1a\u5bf9\u2018dsyrk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dsyr2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dsyr2k\u2019\u4e2d\uff1a\ncblas_dsyr2k.c:(.text+0xe5)\uff1a\u5bf9\u2018dsyr2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dtrmm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dtrmm\u2019\u4e2d\uff1a\ncblas_dtrmm.c:(.text+0x122)\uff1a\u5bf9\u2018dtrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_dtrmm.c:(.text+0x1e0)\uff1a\u5bf9\u2018dtrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_dtrsm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_dtrsm\u2019\u4e2d\uff1a\ncblas_dtrsm.c:(.text+0x122)\uff1a\u5bf9\u2018dtrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_dtrsm.c:(.text+0x1e0)\uff1a\u5bf9\u2018dtrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cgemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cgemm\u2019\u4e2d\uff1a\ncblas_cgemm.c:(.text+0x105)\uff1a\u5bf9\u2018cgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cgemm.c:(.text+0x19d)\uff1a\u5bf9\u2018cgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_csymm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_csymm\u2019\u4e2d\uff1a\ncblas_csymm.c:(.text+0xe6)\uff1a\u5bf9\u2018csymm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_chemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_chemm\u2019\u4e2d\uff1a\ncblas_chemm.c:(.text+0xe6)\uff1a\u5bf9\u2018chemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cherk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cherk\u2019\u4e2d\uff1a\ncblas_cherk.c:(.text+0xd7)\uff1a\u5bf9\u2018cherk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_cher2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_cher2k\u2019\u4e2d\uff1a\ncblas_cher2k.c:(.text+0x108)\uff1a\u5bf9\u2018cher2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_cher2k.c:(.text+0x185)\uff1a\u5bf9\u2018cher2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ctrmm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ctrmm\u2019\u4e2d\uff1a\ncblas_ctrmm.c:(.text+0x118)\uff1a\u5bf9\u2018ctrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ctrmm.c:(.text+0x1d6)\uff1a\u5bf9\u2018ctrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ctrsm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ctrsm\u2019\u4e2d\uff1a\ncblas_ctrsm.c:(.text+0x118)\uff1a\u5bf9\u2018ctrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ctrsm.c:(.text+0x1d6)\uff1a\u5bf9\u2018ctrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_csyrk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_csyrk\u2019\u4e2d\uff1a\ncblas_csyrk.c:(.text+0xd5)\uff1a\u5bf9\u2018csyrk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_csyr2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_csyr2k\u2019\u4e2d\uff1a\ncblas_csyr2k.c:(.text+0xe3)\uff1a\u5bf9\u2018csyr2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zgemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zgemm\u2019\u4e2d\uff1a\ncblas_zgemm.c:(.text+0x105)\uff1a\u5bf9\u2018zgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zgemm.c:(.text+0x19d)\uff1a\u5bf9\u2018zgemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zsymm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zsymm\u2019\u4e2d\uff1a\ncblas_zsymm.c:(.text+0xe6)\uff1a\u5bf9\u2018zsymm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zhemm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zhemm\u2019\u4e2d\uff1a\ncblas_zhemm.c:(.text+0xe6)\uff1a\u5bf9\u2018zhemm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zherk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zherk\u2019\u4e2d\uff1a\ncblas_zherk.c:(.text+0xd7)\uff1a\u5bf9\u2018zherk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zher2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zher2k\u2019\u4e2d\uff1a\ncblas_zher2k.c:(.text+0x109)\uff1a\u5bf9\u2018zher2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_zher2k.c:(.text+0x18d)\uff1a\u5bf9\u2018zher2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ztrmm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ztrmm\u2019\u4e2d\uff1a\ncblas_ztrmm.c:(.text+0x118)\uff1a\u5bf9\u2018ztrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ztrmm.c:(.text+0x1d6)\uff1a\u5bf9\u2018ztrmm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_ztrsm.o)\uff1a\u5728\u51fd\u6570\u2018cblas_ztrsm\u2019\u4e2d\uff1a\ncblas_ztrsm.c:(.text+0x118)\uff1a\u5bf9\u2018ztrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncblas_ztrsm.c:(.text+0x1d6)\uff1a\u5bf9\u2018ztrsm_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zsyrk.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zsyrk\u2019\u4e2d\uff1a\ncblas_zsyrk.c:(.text+0xd5)\uff1a\u5bf9\u2018zsyrk_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\n/usr/local/lib/libcblas.a(cblas_zsyr2k.o)\uff1a\u5728\u51fd\u6570\u2018cblas_zsyr2k\u2019\u4e2d\uff1a\ncblas_zsyr2k.c:(.text+0xe3)\uff1a\u5bf9\u2018zsyr2k_\u2019\u672a\u5b9a\u4e49\u7684\u5f15\u7528\ncollect2: error: ld returned 1 exit status\nCMakeFiles/demo.dir/build.make:96: recipe for target 'demo' failed\nmake[2]: *** [demo] Error 1\nCMakeFiles/Makefile2:67: recipe for target 'CMakeFiles/demo.dir/all' failed\nmake[1]: *** [CMakeFiles/demo.dir/all] Error 2\nMakefile:83: recipe for target 'all' failed \nmake: *** [all] Error 2\n</code></pre>\n\n<p>To determine how is the problem brought up, I also tried reproducing the error message with <code>gcc</code>. When compiling with this command :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc main.c -o demo -lm -lgsl -lcblas -lblas\n</code></pre>\n\n<p>it works well. When trying :</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ gcc main.c -o demo -lm -lgsl -lcblas # Ignoring BLAS library.\n</code></pre>\n\n<p>The error message is reproduced. So I guess the problem occurs when linking the BLAS library.</p>\n\n<p>Here is the file <code>main.c</code></p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// main.c\n#include &lt;stdio.h&gt;\n#include &lt;gsl/gsl_sf_bessel.h&gt;\nint main(void) {\n  double x = 5.0;\n  double y;\n  y = gsl_sf_bessel_J0(x);\n  printf(\"J0(%.4lf) = %.4le\\n\", x, y);\n  return 0;\n}\n</code></pre>\n\n<p>The expected outcome would be :</p>\n\n<pre><code>J0(5.0000) = -1.7760e-01\n</code></pre>\n"}, {"tags": ["c", "hashtable"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 6, "creation_date": 1566999387, "post_id": 57693680, "comment_id": 101831554, "body": "Uh?   name[10] is out-of-bounds."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1566999951, "post_id": 57693680, "comment_id": 101831888, "body": "and: in <code>char data;</code>, <i>data</i> is a single character, not a <i>string</i>."}, {"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "edited": false, "score": 0, "creation_date": 1567000231, "post_id": 57693680, "comment_id": 101832084, "body": "if i make char data into char data[10] i get error: array type &#39;char [10]&#39; is not assignable     newNode-&gt;data = name[10];"}, {"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "edited": false, "score": 0, "creation_date": 1567000461, "post_id": 57693680, "comment_id": 101832236, "body": "Also, I updated size to 10 and still get the same!!!"}, {"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "edited": false, "score": 0, "creation_date": 1567000594, "post_id": 57693680, "comment_id": 101832305, "body": "So now, there should be no reason for it to display this random i character"}, {"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "reply_to_user": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1567000821, "post_id": 57693680, "comment_id": 101832451, "body": "@wildplasser can you explain why that error occurs when i make data into data[10]"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1567001501, "post_id": 57693680, "comment_id": 101832884, "body": "Because, in C,you cannot assign to an array. (in this case,you could use<code>strcpy()</code>)"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1567002100, "post_id": 57693680, "comment_id": 101833270, "body": "&quot;I have correctly set my datatypes to char &quot; Looks like you haven&#39;t. I think you are confusing char, char *, int, strings."}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1567002230, "post_id": 57693680, "comment_id": 101833358, "body": "&quot;So now, there should be no reason for it to display this random i character&quot; as @MartinJames said you are overflowing the array <code>name</code> so basically you are reading bullshit in memory. The ascii value for i is not worse than any other"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1567006555, "post_id": 57693680, "comment_id": 101835945, "body": "When you call <code>add(&quot;Ben&quot;);</code> the <code>name</code> parameter (which is actually <code>char *name</code> because the compiler rewrites array parameters as pointers) points to a 4 <code>char</code> array initialized to <code>{&#39;B&#39;, &#39;e&#39;, &#39;n&#39;, &#39;\\0&#39;}</code>. So only elements up to <code>name[3]</code> are valid. But you are accessing <code>name[10]</code> which is out-of-bounds."}, {"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1567006799, "post_id": 57693680, "comment_id": 101836081, "body": "@IanAbbott how do i remedy this? If i remove the [10] from name, I get warning: incompatible pointer to integer conversion       assigning to &#39;char&#39; from &#39;char *&#39;; dereference with *       [-Wint-conversion]     newNode-&gt;data = name;"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1567007341, "post_id": 57693680, "comment_id": 101836376, "body": "You could access <code>name[0]</code>. That would give you the first letter. If you want more than that, you will need to change the <code>data</code> member into an array of suitable length, or a pointer to dynamically allocated memory. and copy the string using <code>strncpy</code> or something."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "edited": false, "score": 0, "creation_date": 1567007113, "post_id": 57695948, "comment_id": 101836259, "body": "Thank you, I appreciate the answer. So are you suggesting that I do name[0] ?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "reply_to_user": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "edited": false, "score": 0, "creation_date": 1567007798, "post_id": 57695948, "comment_id": 101836607, "body": "It depends what you try to accomplish. <code>add()</code> can even be called with a <code>NULL</code> pointer. Your goal, your design, your choice. ;-)"}], "tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1567006807, "creation_date": 1567006807, "answer_id": 57695948, "question_id": 57693680, "link": "https://stackoverflow.com/questions/57693680/random-i-character-being-printed-into-my-string-hash-table-despite-appropriate-d/57695948#57695948", "title": "Random i character being printed into my string hash table despite appropriate datatypes", "body": "<p>Syntactically your code is good.</p>\n\n<p>The error is, that you call <code>add()</code> like this:</p>\n\n<pre><code>add(\"Ben\");\n</code></pre>\n\n<p>This means that the address of a 4 character array (exactly: the address of its first member) is given to <code>add()</code>. The 4 characters are:</p>\n\n<ol>\n<li>'B'</li>\n<li>'e'</li>\n<li>'n'</li>\n<li>'\\0'</li>\n</ol>\n\n<p>Now in <code>add()</code> you read from the 11th character of the address given, at the offset of 10:</p>\n\n<pre><code>newNode-&gt;data = name[10];\n</code></pre>\n\n<p>This is called \"out of bounds\" and in Java (because you seem to know that) will throw an <code>IndexOutOfBoundsException</code>. But C doesn't have such checks and so the code reads whatever is there. In your example it is an 'i' by accident.</p>\n"}], "owner": {"reputation": 55, "user_id": 11390718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69234772cbe8d38a07adac2ceeda2d21?s=128&d=identicon&r=PG&f=1", "display_name": "Poppo123", "link": "https://stackoverflow.com/users/11390718/poppo123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567006807, "creation_date": 1566999110, "question_id": 57693680, "link": "https://stackoverflow.com/questions/57693680/random-i-character-being-printed-into-my-string-hash-table-despite-appropriate-d", "title": "Random i character being printed into my string hash table despite appropriate datatypes", "body": "<p>Can anybody explain why my hash table program for strings is just printing the letter i in the first array instead of Ben? I do not specify i anywhere so am extremely puzzled as to why this result is showing:</p>\n\n<p>I have correctly set my datatypes to char with the appropriate array lengths specified, so why is it that the string is not recognised?</p>\n\n<p>Code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\n#define size 7\n\nstruct node\n{\n    char data;\n    struct node *next;\n};\n\nstruct node *chain[size];\n\nvoid init()\n{\n    int i;\n    for(i = 0; i &lt; size; i++)\n        chain[i] = NULL;\n}\n\nvoid add(char name[])\n{\n    //create a newnode with value\n    struct node *newNode = malloc(sizeof(struct node));\n    newNode-&gt;data = name[10];\n    newNode-&gt;next = NULL;\n\n    //calculate hash key\n    char key = name[10] % size;\n\n    //check if chain[key] is empty\n    if(chain[key] == NULL)\n        chain[key] = newNode;\n    //collision\n    else\n    {\n        //add the node at the end of chain[key].\n        struct node *temp = chain[key];\n        while(temp-&gt;next)\n        {\n            temp = temp-&gt;next;\n        }\n\n        temp-&gt;next = newNode;\n    }\n}\n\n/*\n * return 1, search found\n * return 0, Otherwise\n */\nint search(int name)\n{\n    char key = name % size;\n    struct node *temp = chain[key];\n    while(temp)\n    {\n        if(temp-&gt;data == name)\n            return 1;\n        temp = temp-&gt;next;\n    }\n    return 0;\n}\n\nvoid print()\n{\n    int i;\n\n    for(i = 0; i &lt; size; i++)\n    {\n        struct node *temp = chain[i];\n        printf(\"chain[%d]--&gt;\",i);\n        while(temp)\n        {\n            printf(\"%c --&gt;\",temp-&gt;data);\n            temp = temp-&gt;next;\n        }\n        printf(\"NULL\\n\");\n    }\n}\n\nint main()\n{\n    //init array of list to NULL\n    init();\n\n    add(\"Ben\");\n\n\n\n    print();\n\n    printf(\"Searching element 10\\n\");\n\n    if(search(10))\n        printf(\"Search Found\\n\");\n    else\n        printf(\"Search Not Found\\n\");\n\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>chain[0]--&gt;i --&gt;NULL\nchain[1]--&gt;NULL\nchain[2]--&gt;NULL\nchain[3]--&gt;NULL\nchain[4]--&gt;NULL\nchain[5]--&gt;NULL\nchain[6]--&gt;NULL\nSearching element 10\nSearch Not Found\n</code></pre>\n"}, {"tags": ["c", "pointers", "undefined-behavior", "strtok", "invalid-pointer"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 3, "creation_date": 1566999163, "post_id": 57693646, "comment_id": 101831409, "body": "<code>strtok</code>&#39;s return values point to the original string. If <code>my_buffer</code> is an allocated object, then it makes sense that this might not fail. However, this is another example of causing undefined behaviour and expecting that you&#39;ll always get errors, just like expecting a segfault when accessing memory outside of any objects. The correct way to handle this is to stop trying to <code>free</code> the return values, and read the documentation on <code>strtok</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566999183, "post_id": 57693646, "comment_id": 101831416, "body": "If anything needs to be <code>free</code>d it would be <code>my_buffer</code> but only if that was dynamically allocated, and only after you finish accessing the tokens. If <code>token_one</code> is the same as <code>my_buffer</code> then that <code>free</code> was valid."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566999287, "post_id": 57693646, "comment_id": 101831492, "body": "In general, you cannot <code>free</code> the result of <code>strtok</code>. You could copy the string returned by <code>strtok</code> to a buffer allocated by <code>malloc</code> (or the non-standard <code>strdup</code> function) for example, and <code>free</code> that buffer."}, {"owner": {"reputation": 45894, "user_id": 271415, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8648256cc53b261c5e1d266380a256fc?s=128&d=identicon&r=PG", "display_name": "jarmod", "link": "https://stackoverflow.com/users/271415/jarmod"}, "edited": false, "score": 1, "creation_date": 1566999302, "post_id": 57693646, "comment_id": 101831503, "body": "You need to understand that strtok modifies your original string, It does not allocate new strings."}, {"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "edited": false, "score": 1, "creation_date": 1567000235, "post_id": 57693646, "comment_id": 101832090, "body": "The contract with malloc+free does not specify that free will detect errors.  It might, sometimes, but you can&#39;t rely on it."}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566999424, "post_id": 57693745, "comment_id": 101831574, "body": "strtok everytime give me the pointer to the next token and put a termination simbol at the end of the token?"}, {"owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "reply_to_user": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566999503, "post_id": 57693745, "comment_id": 101831624, "body": "@user4789408 That&#39;s roughly what its definition says, yes."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "reply_to_user": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 2, "creation_date": 1566999956, "post_id": 57693745, "comment_id": 101831899, "body": "@user4789408 Yes, but that piece of memory is not a new chunk of memory but it is part of the initial string. As soon as you free your first pointer, any access via the second will be illegal because the memory area where it points to is not yours any more."}], "tags": [], "owner": {"reputation": 81300, "user_id": 296974, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e26cfe3ac75cd582ca200fbc6fa0421?s=128&d=identicon&r=PG", "display_name": "glglgl", "link": "https://stackoverflow.com/users/296974/glglgl"}, "is_accepted": true, "score": 5, "last_activity_date": 1566999300, "creation_date": 1566999300, "answer_id": 57693745, "question_id": 57693646, "link": "https://stackoverflow.com/questions/57693646/c-free-variables-used-with-strtok/57693745#57693745", "title": "C free variables used with strtok", "body": "<p>If you look how <code>strtok()</code> works, it becomes immediately clear:</p>\n\n<ol>\n<li>The first call to <code>strtok()</code> returns the given pointer, modifying the string pointed to by it by replacing the next separation character with a NUL byte.</li>\n<li>Any subsequent call, done with <code>NULL</code> as the first argument, operates on the saved pointer from before which points to one after the replaced character.</li>\n</ol>\n\n<p>So the first <code>free()</code> call succeeds iff your <code>my_buffer</code> came from <code>malloc()</code>. The second one fails because, well, why shouldn't it? It doesn't come from <code>malloc()</code> et al., so calling <code>free()</code> on it is undefined behaviour.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1566999758, "last_edit_date": 1566999758, "creation_date": 1566999439, "answer_id": 57693780, "question_id": 57693646, "link": "https://stackoverflow.com/questions/57693646/c-free-variables-used-with-strtok/57693780#57693780", "title": "C free variables used with strtok", "body": "<p>It seems that the pointer <code>my_buffer</code> points to a dynamically allocated character array.</p>\n\n<p>If the string stored in the array does not start from one of this characters <code>\" ,.-\"</code> then the pointer <code>token_one</code> returned from the function <code>strtok</code> will have the same value as the pointer <code>my_buffer</code>. So it can be used to free the allocated memory.</p>\n\n<p>The pointer <code>token_two</code> points to the middle of the string. So its value does not point to the previously allocated memory. So the program after this call</p>\n\n<pre><code>free(token_two);\n</code></pre>\n\n<p>has undefined behavior.</p>\n\n<p>This statement </p>\n\n<pre><code>free(token_two);\n</code></pre>\n\n<p>would be valid if the pointer <code>token_two</code> returned from the call of the function <code>strtok</code> was a null-pointer. But in this case no action will be performed by the call of <code>free</code>.</p>\n\n<p>Consider two examples.</p>\n\n<p>The first one is</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) \n{\n    char *p1  = malloc( 10 );\n    char *p2 = p1;\n\n    free( p2 );\n\n    return 0;\n}\n</code></pre>\n\n<p>You can use the pointer <code>p2</code> to free the memory the address of which initially was stored in the pointer <code>p1</code>.</p>\n\n<p>On the other hand, you may not use the pointer <code>p2</code> to free the allocated memory if its value points to inside the allocated memory</p>\n\n<p>This program is invalid.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) \n{\n    char *p1  = malloc( 10 );\n    char *p2 = p1 + 5;\n\n    free( p2 );\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 57693745, "answer_count": 2, "score": -3, "last_activity_date": 1566999951, "creation_date": 1566999020, "last_edit_date": 1566999951, "question_id": 57693646, "link": "https://stackoverflow.com/questions/57693646/c-free-variables-used-with-strtok", "title": "C free variables used with strtok", "body": "<p>I already saw post similar to this one, but I found a little difference that drive me in the wrong way.</p>\n\n<p>I have this code:</p>\n\n<pre><code>char * token_one = strtok(my_buffer, \" ,.-\");\nchar * token_two = strtok(NULL, \" ,.-\");\n\nfree(token_one);\nfree(token_two);\n</code></pre>\n\n<p>I saw post where people says a <strong>variable used with strtok should not be freed</strong> but why while executing this code I get this:</p>\n\n<p><code>free(token_one)</code> no errors</p>\n\n<p><code>free(token_two)</code> I get \"<strong>invalid pointer</strong>\"</p>\n\n<p>Why don't I get error in <code>free(token_one)</code>? What is the correct way to handle this?</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 5, "creation_date": 1566998573, "post_id": 57693470, "comment_id": 101831016, "body": "What makes you think that they&#39;re not compiled? I&#39;d assume that <code>catkin_make</code> does that."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1566998657, "post_id": 57693470, "comment_id": 101831066, "body": "See the section <i>Building your nodes</i>.  That is where it gets compiled (using cmake, a build system)"}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 2, "creation_date": 1566998809, "post_id": 57693470, "comment_id": 101831161, "body": "btw C and C++ are two different languages. &quot;C/C++&quot; is often used to express the ignorance of the differences between the two, just saying..."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1567007624, "post_id": 57693470, "comment_id": 101836516, "body": "Actually there are interpreters for C that read and evaluate source code. Some of them might be embedded in other applications, allowing you to script in C. One famous example is <a href=\"https://en.wikipedia.org/wiki/Tiny_C_Compiler\" rel=\"nofollow noreferrer\">TCC</a> that compiles into memory and executes thereafter."}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 0, "last_activity_date": 1566998755, "creation_date": 1566998755, "answer_id": 57693564, "question_id": 57693470, "link": "https://stackoverflow.com/questions/57693470/how-and-why-is-uncompiled-c-c-sometimes-used/57693564#57693564", "title": "How and why is uncompiled C/C++ sometimes used?", "body": "<p>The premise of your question is untrue.</p>\n\n<p>The source code will undergo a translation process just as it always is.</p>\n\n<p>The CMakeLists.txt file tells CMake what to do, with help from some items set up when you followed the build instructions. In examples given on the reference page you linked to, we have the common declaration to build a C++ file into an executable:</p>\n\n<pre><code>add_executable(talker src/talker.cpp)\n</code></pre>\n\n<p>&hellip;along with all the ROS-related business that gets performed.</p>\n"}], "owner": {"reputation": 1, "user_id": 11839376, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-gOtbdSzaFRI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re3iXvbpBNrvLjOda4uzNbdivG3Dg/photo.jpg?sz=128", "display_name": "CopiedFromStackoverflow", "link": "https://stackoverflow.com/users/11839376/copiedfromstackoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1566998755, "creation_date": 1566998474, "question_id": 57693470, "link": "https://stackoverflow.com/questions/57693470/how-and-why-is-uncompiled-c-c-sometimes-used", "title": "How and why is uncompiled C/C++ sometimes used?", "body": "<p>I've seen some programs such as ROS use uncompiled C/C++ files (raw code, not yet compiled). In <a href=\"http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29\" rel=\"nofollow noreferrer\">this</a> example, C++ is used but not compiled. Most C/C++ I've learned so far needs to be compiled to run.</p>\n\n<p>My guess here is that either they're compiled by the system every time it runs, or it's interpreted like Python.</p>\n\n<p>How and why exactly are such uncompiled C/C++ files used?</p>\n"}, {"tags": ["c", "ffmpeg", "libav"], "owner": {"reputation": 1751, "user_id": 1025124, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/66cd3dc00b09bf9504c0aebe06202d9f?s=128&d=identicon&r=PG", "display_name": "igal k", "link": "https://stackoverflow.com/users/1025124/igal-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1566999939, "creation_date": 1566997045, "last_edit_date": 1566999939, "question_id": 57692985, "link": "https://stackoverflow.com/questions/57692985/how-to-successfully-decode-ffmpeg-frames-with-http-timeouts-without-parsers", "title": "How to successfully decode ffmpeg frames with http timeouts without parsers", "body": "<p>I'm facing a scenario where connectivity issues cause ffmpeg generate false / messed artifacts(frames) contrary to what the manual states.</p>\n\n<p>We use <code>curl</code> as our http transmitting library and <code>ffmpeg</code> as the processing library. To simulate network timeouts, I place several breakpoints in the <code>AVIOContext</code> which is passed to the <code>AVFormatContext</code></p>\n\n<pre><code>avformat_open_input('http://some.com/1.ts')\nwhile(!eof)\n  av_read_frame\n  av_send_packet\n  while(!av_receive_frame)\n     do_something\nclose\n</code></pre>\n\n<p><code>av_receive_frame</code> should either return <code>0</code> upon success or error <code>-35</code> for cases where additional data is needed.</p>\n\n<p>So after <code>timeout-ing</code> the session, <code>ffmpeg</code> can still somehow extract (<code>av_receive_frame</code>) the first frame even though it hadn't have the chance to download / accumulate enough data.</p>\n\n<p><a href=\"https://i.stack.imgur.com/xQiuI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xQiuI.png\" alt=\"enter image description here\"></a></p>\n\n<p>My question, without using <code>parsers</code> is there a way to validate that the decoder can successfully decode the packet?</p>\n\n<p>\"<em>EDIT</em>\" : i saw that <code>av_read_frame</code> use parsing if <code>AVStream::need_parsing</code> attribute is anything than <code>NONE</code>, any ideas on how setting it up?</p>\n"}, {"tags": ["c", "linux", "mmap", "pci-e"], "comments": [{"owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1567056846, "post_id": 57692950, "comment_id": 101850118, "body": "@jww please check my edit, I have added source code for both RC and EP side. Exact problem is that why I am unable to achieve high data rate using above code while the link supports upto 250MB/s?"}, {"owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1567056971, "post_id": 57692950, "comment_id": 101850153, "body": "After running these processes on both sides, I use <code>iperf</code> to test link speed."}], "owner": {"reputation": 686, "user_id": 1875791, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ce05bb4d7eb8b4f7c2732f51a0496f2e?s=128&d=identicon&r=PG", "display_name": "Arshan", "link": "https://stackoverflow.com/users/1875791/arshan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1567058383, "creation_date": 1566996907, "last_edit_date": 1567058383, "question_id": 57692950, "link": "https://stackoverflow.com/questions/57692950/low-data-rate-between-two-linux-machines-connected-over-pcie", "title": "Low data rate between two Linux machines connected over PCIe", "body": "<p>I am trying to communicate between two Linux based devices (i.e. PowerPC (Big-Endian 32-bit) &amp; ARM (Little-Endian 32-bit)) connected over PCIe. One of the device acts as Root Complex and the other as Endpoint. The devices successfully negotiate to create a PCIe x1 gen-1 link. To communicate between the devices, I have written userspace C applications that make use of <code>mmap()</code> to read/write data to PCIe memory space. </p>\n\n<p>The issue I am facing is that the average data transfer rate is around 5Mb/s which is no way near the theoretical PCIe 1.1 x1 speed (250MB/s). I am unable to find the data rate bottleneck yet and wanted to have some suggestions. Can someone give an idea what might be the reason behind this.  </p>\n\n<p>Please find below C code for both Root Complex (RC) side and Endpoint (EP) side:</p>\n\n<p><strong>RC:</strong></p>\n\n<pre><code>#include &lt;endian.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;signal.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;linux/if.h&gt;\n#include &lt;linux/if_tun.h&gt;\n#include &lt;asm/ioctl.h&gt;\n\n#define MEM_MAP_LEN             0x1000000       //  Map 16-MB of PCIe BAR space\n#define EP_WR_START             0x0             //  EP write region from start of BAR space\n#define EP_SET_DATA_READY       EP_WR_START + 0x0\n#define EP_DATA_LEN_OFFSET      EP_WR_START + 0x4\n#define EP_DATA_OFFSET          EP_WR_START + 0x8\n#define RC_WR_START             0x800000        //  RC write region starts from mid of BAR space\n#define RC_SET_DATA_READY       RC_WR_START + 0x0\n#define RC_DATA_LEN_OFFSET      RC_WR_START + 0x4\n#define RC_DATA_OFFSET          RC_WR_START + 0x8\n\n\nuint32_t sod_id = 0xFFFFAAAA;               // Start of Data ID\n\ntypedef struct\n{\n    int tap_fd;\n    void * pcie_ptr;\n} THREAD_ARGS;\n\nvoid * init_pcie()\n{\n    uint8_t * pcie_file = \"/sys/bus/pci/devices/0000:03:00.0/resource2\";\n\n    int fd = open(pcie_file, O_RDWR | O_SYNC);\n\n    void * res_ptr = NULL;\n    res_ptr = mmap(0, MEM_MAP_LEN, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);\n    close(fd);\n\n    if(res_ptr == MAP_FAILED)\n    {\n        printf(\"Error: Failed to map memory to PCIe resource\\n\");\n        return NULL;\n    }\n\n    return res_ptr;\n}\n\nint write_pcie(volatile void * ptr, unsigned char * buffer, unsigned int buffer_len)\n{\n    uint32_t tmp_flag = htobe32(sod_id);\n    uint32_t tmp_len = htobe32(buffer_len);\n    uint32_t tmp_val;\n\n    memcpy(&amp;tmp_val, ((uint8_t *)ptr + RC_SET_DATA_READY), sizeof(tmp_val));\n    if(tmp_val != htobe32(sod_id))  // check if there's already pending data\n    {\n        memcpy(((uint8_t *)ptr + RC_DATA_LEN_OFFSET), &amp;tmp_len, sizeof(tmp_len));\n        memcpy((uint8_t *)((uint8_t *)ptr + RC_DATA_OFFSET), buffer, buffer_len);\n        memcpy(((uint8_t *)ptr + RC_SET_DATA_READY), &amp;tmp_flag, sizeof(tmp_flag));\n        return 0;\n    }\n    else\n        return -1;\n}\n\nint read_pcie(volatile void * ptr, unsigned char * buffer)\n{\n    uint32_t tmp_val;\n    uint32_t data_len;\n    memcpy(&amp;tmp_val, ((uint8_t *)ptr + EP_SET_DATA_READY), sizeof(tmp_val));\n\n    if ( tmp_val == htobe32(sod_id))\n    {\n        memcpy(&amp;data_len, ((uint8_t *)ptr + EP_DATA_LEN_OFFSET), sizeof(data_len));\n        data_len = be32toh(data_len);\n        memcpy(buffer, (uint8_t *)((uint8_t *)ptr + EP_DATA_OFFSET), data_len);\n        memset(((uint8_t *)ptr + EP_SET_DATA_READY), 0x0, sizeof(uint32_t));\n        return data_len;\n    }\n    else\n    {\n        return -1;\n    }\n}\n\nint tun_alloc(char *dev, int flags) {\n\n    struct ifreq ifr;\n    int fd, err;\n    char *clonedev = \"/dev/net/tun\";\n\n    if ( (fd = open(clonedev, O_RDWR)) &lt; 0 ) {\n        return fd;\n    }\n\n    memset(&amp;ifr, 0, sizeof(ifr));\n\n    ifr.ifr_flags = flags;\n\n    if (*dev) {\n        strncpy(ifr.ifr_name, dev, IFNAMSIZ);\n    }\n\n    if ( (err = ioctl(fd, TUNSETIFF, (void *) &amp;ifr)) &lt; 0 ) {\n        close(fd);\n        return err;\n    }\n\n    strcpy(dev, ifr.ifr_name);\n\n    return fd;\n}\n\nvoid* ethernet_read_task(void * thread_args)\n{\n    THREAD_ARGS args = *(THREAD_ARGS *)thread_args;\n    int tap_fd = args.tap_fd;\n    void * pcie_ptr = args.pcie_ptr;\n    unsigned char tx_buffer[1800] = {0};\n    int ret_val = 0;\n    unsigned int nread = 0;\n\n    while (1)\n    {\n        nread = read(tap_fd, tx_buffer, sizeof(tx_buffer));\n        if (nread &lt; 0) {\n            perror(\"Reading from interface\");\n        }\n        else if (nread &gt; 0)\n        {\n            ret_val = write_pcie(pcie_ptr, tx_buffer, nread);\n        }\n    }\n\n}\n\nint main()\n{\n    unsigned char tap_name[32] = {0};\n    strcpy(tap_name, \"virt0\");\n    int tap_fd = tun_alloc(tap_name, IFF_TAP);  /* tap interface */\n\n    if (tap_fd &lt; 0) {\n        perror(\"Allocating interface\");\n        exit(1);\n    }\n\n    unsigned char rootcomplex_ip[16] = \"192.168.1.1\";\n    unsigned char ipconfig_cmd[128] = {0};\n    sprintf(ipconfig_cmd, \"/sbin/ifconfig %s %s\", tap_name, rootcomplex_ip);\n    system(ipconfig_cmd);\n\n    void *pcie_ptr = init_pcie();\n\n    if(pcie_ptr == NULL)\n    {\n        printf(\"Failed to initialize PCIe mapping. Exiting...\\n\");\n    }\n\n    THREAD_ARGS thread_args;\n    thread_args.tap_fd = tap_fd;\n    thread_args.pcie_ptr = pcie_ptr;\n\n    pthread_t ethernet_read_thread;\n    int err = pthread_create(&amp;ethernet_read_thread, NULL, &amp;ethernet_read_task, &amp;thread_args);\n    if (err != 0)\n    {\n        printf(\"Can't start Ethernet handler thread :[%s]\", strerror(err));\n        return 1;\n    }\n\n    char * buffer;\n    int data_len = 0;\n    int32_t ret = 0;\n\n    unsigned char rx_buffer[1800] = {0};\n\n    while(1)\n    {\n        ret = read_pcie(pcie_ptr, rx_buffer);\n\n        if(ret &gt; 0)\n        {\n            ret = write(tap_fd, rx_buffer, ret);\n            memset(rx_buffer, 0, sizeof(rx_buffer));\n        }\n\n        usleep(1);\n    }\n    munmap(pcie_ptr, MEM_MAP_LEN);\n    return 0;\n}\n\n</code></pre>\n\n<p><strong>EP:</strong></p>\n\n<pre><code>#include &lt;sys/socket.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;linux/if.h&gt;\n#include &lt;linux/if_tun.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;asm/ioctl.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;errno.h&gt;\n\n\n#define PCIE_MAP                            0x7f000000\n#define MAP_SIZE                            0x1000000                   //  Map 16-MB of PCIe BAR space\n#define EP_WR_START                     0x0                         //  EP write region from start of BAR space\n#define EP_SET_DATA_READY           EP_WR_START + 0x0\n#define EP_DATA_LEN_OFFSET      EP_WR_START + 0x4\n#define EP_DATA_OFFSET              EP_WR_START + 0x8\n#define RC_WR_START                     0x800000                        //  RC write region starts from mid of BAR space\n#define RC_SET_DATA_READY           RC_WR_START + 0x0\n#define RC_DATA_LEN_OFFSET      RC_WR_START + 0x4\n#define RC_DATA_OFFSET              RC_WR_START + 0x8\n\n\nuint32_t sod_id = 0xFFFFAAAA;\n\ntypedef struct\n{\n        int tap_fd;\n        void * pcie_ptr;\n}THREAD_ARGS;\n\n\nint tun_alloc(char *dev, int flags) {\n\n    struct ifreq ifr;\n    int fd, err;\n    char *clonedev = \"/dev/net/tun\";\n\n    if ( (fd = open(clonedev, O_RDWR)) &lt; 0 ) {\n        return fd;\n    }\n\n    memset(&amp;ifr, 0, sizeof(ifr));\n\n    ifr.ifr_flags = flags;\n\n    if (*dev) {\n        strncpy(ifr.ifr_name, dev, IFNAMSIZ);\n    }\n\n    if ( (err = ioctl(fd, TUNSETIFF, (void *) &amp;ifr)) &lt; 0 ) {\n        close(fd);\n        return err;\n    }\n\n    strcpy(dev, ifr.ifr_name);\n\n    return fd;\n}\n\nvoid * init_pcie()\n{\n    int fd = open(\"/dev/mem\", O_RDWR);\n\n    /* Map physical memory address specified with PCIE_MAP to virtual address and set it in ptr */\n\n    void* ptr = mmap(NULL, MAP_SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, PCIE_MAP);\n    close(fd);\n\n    if (ptr == MAP_FAILED)\n    {\n        printf(\"Failure mapping: %s\\n\", strerror(errno));\n        return NULL;\n    }\n\n    return ptr;\n}\n\nvoid reset_pcie_space(void * ptr)\n{\n    memset((uint8_t *)ptr, 0xff, MAP_SIZE);\n}\n\nint write_pcie(volatile void * ptr, unsigned char * buffer, unsigned int buffer_len)\n{\n    uint32_t tmp_val;\n    memcpy(&amp;tmp_val, ((uint8_t *)ptr + EP_SET_DATA_READY), sizeof(tmp_val));\n\n    if ( tmp_val != sod_id)\n    {\n        memcpy(((uint8_t *)ptr + EP_DATA_LEN_OFFSET), &amp;buffer_len, sizeof(buffer_len));\n        memcpy((uint8_t *)((uint8_t *)ptr + EP_DATA_OFFSET), buffer, buffer_len);\n        memcpy(((uint8_t *)ptr + EP_SET_DATA_READY), &amp;sod_id, sizeof(sod_id));\n        return 0;\n    }\n    else\n        return -1;\n}\n\nint read_pcie(volatile void * ptr, unsigned char * buffer)\n{\n    uint32_t tmp_val;\n    memcpy(&amp;tmp_val, ((uint8_t *)ptr + RC_SET_DATA_READY), sizeof(tmp_val));\n    if ( tmp_val == sod_id)\n    {\n        memcpy(&amp;tmp_val, ((uint8_t *)ptr + RC_DATA_LEN_OFFSET), sizeof(tmp_val));\n        memcpy(buffer, (uint8_t *)((uint8_t *)ptr + RC_DATA_OFFSET), tmp_val);\n        memset(((uint8_t *)ptr + RC_SET_DATA_READY), 0x0, sizeof(uint32_t));\n        return tmp_val;\n    }\n    else\n        return -1;\n}\n\nvoid* ethernet_read_task(void * thread_args)\n{\n    THREAD_ARGS args = *(THREAD_ARGS *)thread_args; \n    int tap_fd = args.tap_fd;\n    void * pcie_ptr = args.pcie_ptr;\n    unsigned char tx_buffer[1800] = {0};\n    int ret = 0;\n    unsigned int nread = 0;\n\n    while(1)\n    {\n        nread = read(tap_fd, tx_buffer, sizeof(tx_buffer));\n        if (nread &lt; 0) {\n            perror(\"Reading from interface\");\n        }\n        else if(nread &gt; 0)\n        {\n            ret = write_pcie(pcie_ptr, tx_buffer, nread);\n            //memset(tx_buffer, 0, sizeof(tx_buffer));\n        }\n    }\n\n}\n\nint main()\n{\n    char tap_name[32];\n    int nread = 0;\n    unsigned char rx_buffer[1800] = {0};\n    unsigned int rx_len = 0;\n\n    void * pcie_ptr = NULL;\n\n    strcpy(tap_name, \"virt0\");\n    int tap_fd = tun_alloc(tap_name, IFF_TAP);\n\n    if (tap_fd &lt; 0) {\n        perror(\"Allocating interface\");\n        exit(1);\n    }\n\n    unsigned char endpoint_ip[16] = \"192.168.1.100\";\n    unsigned char ipconfig_cmd[128] = {0};\n    sprintf(ipconfig_cmd, \"/sbin/ifconfig %s %s\", tap_name, endpoint_ip);\n    system(ipconfig_cmd);\n\n    pcie_ptr = init_pcie();\n\n    if(pcie_ptr == NULL)\n    {\n        printf(\"Unable to initiazlize PCIe memory map. Exiting...\\n\");\n        exit(1);\n    }\n\n    THREAD_ARGS thread_args;\n    thread_args.tap_fd = tap_fd;\n    thread_args.pcie_ptr = pcie_ptr;\n\n    pthread_t ethernet_read_thread;\n    int err = pthread_create(&amp;ethernet_read_thread, NULL, &amp;ethernet_read_task, &amp;thread_args);\n    if (err != 0)\n    {\n        printf(\"Can't start Ethernet handler thread :[%s]\", strerror(err));\n        return 1;\n    }\n\n    int ret = 0;\n    while (1) {\n\n        ret = read_pcie(pcie_ptr, rx_buffer);\n        if(ret &gt; 0)\n        {  \n            write(tap_fd, rx_buffer, ret);\n            memset(rx_buffer, 0, sizeof(rx_buffer));\n        }\n        usleep(1);\n    }\n}\n\n</code></pre>\n"}, {"tags": ["c", "string", "input", "scanf", "fgets"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566996687, "post_id": 57692831, "comment_id": 101829855, "body": "@Daniele Magr&#236; In the scanf call you have to specify the length of data that will be read."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1566996690, "post_id": 57692831, "comment_id": 101829857, "body": "There are some easy ways to remove the newline added by <code>fgets</code> (see e.g. <a href=\"https://stackoverflow.com/questions/2693776/removing-trailing-newline-character-from-fgets-input\">Removing trailing newline character from fgets() input</a>). And depending on the input and input-format, <code>fgets</code> paired with <code>sscanf</code> is a very good combination, especially since it&#39;s easier to handle errors that way."}, {"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 0, "creation_date": 1566996764, "post_id": 57692831, "comment_id": 101829905, "body": "&quot;Better&quot; along what metric?"}, {"owner": {"reputation": 4398, "user_id": 3697264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/5adc5afbd7a1145fdd762d872b4b43bb?s=128&d=identicon&r=PG", "display_name": "SPlatten", "link": "https://stackoverflow.com/users/3697264/splatten"}, "edited": false, "score": 0, "creation_date": 1566996790, "post_id": 57692831, "comment_id": 101829930, "body": "Depends entirely on the format of the data in the file, if you just want to read the entire string then fgets is simple, however if there is a specific format to the data and you only want part then scanf."}, {"owner": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 0, "creation_date": 1566997054, "post_id": 57692831, "comment_id": 101830085, "body": "You might also consider scanf_s."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 13397, "user_id": 2287576, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/iCua4.jpg?s=128&g=1", "display_name": "Andrew Truckle", "link": "https://stackoverflow.com/users/2287576/andrew-truckle"}, "edited": false, "score": 1, "creation_date": 1566997206, "post_id": 57692831, "comment_id": 101830159, "body": "@AndrewTruckle <i>You might also consider scanf_s</i>  Only if you want non-portable, non-standard code.  And no, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1967.htm\" rel=\"nofollow noreferrer\">Microsoft&#39;s implementation of Annex K is not standards-compliant</a>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566997231, "post_id": 57692831, "comment_id": 101830172, "body": "@MarcoBonelli They are not the same. <code>scanf(&quot;%100s&quot;, string)</code> will skip leading white-space characters and terminate at the next white-space character or after the specified field width."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566997351, "post_id": 57692831, "comment_id": 101830246, "body": "@Someprogrammerdude <i><code>fgets</code> paired with <code>sscanf</code> is a very good combination, especially since it&#39;s easier to handle errors that way.</i>  By &quot;easier&quot;, do you mean &quot;possible&quot;?  A failed <code>scanf()</code> call due to improper input data is just about impossible to recover from if the stream isn&#39;t seekable.  I personally prefer <code>getline()</code> over <code>fgets()</code>, too, just to avoid a line too long for <code>fgets()</code>.  If you get enough bad input to run out of memory, you&#39;re pretty much unable to proceed anyway if the input is supposed to be line-based."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566997708, "post_id": 57692831, "comment_id": 101830482, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17294809/reading-a-line-using-scanf-not-good\">Reading a line using scanf() not good?</a>"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566997911, "post_id": 57692831, "comment_id": 101830592, "body": "due to the current <a href=\"https://meta.stackoverflow.com/questions/388313/experiment-closing-and-reopening-happens-at-3-votes-for-the-next-30-days-until?cb=1\">experiment</a>, the question was closed after only 3 votes - I was hoping for a few more votes for the duplicate, since I don&#39;t agree with the &quot;opinion based&quot; reason"}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566998287, "post_id": 57692831, "comment_id": 101830833, "body": "No, because i asked what to do if I have to use fgets but don&#39;t know the length of the input also. @SanderDeDycker"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566998800, "post_id": 57692831, "comment_id": 101831153, "body": "@iamagro : if you have multiple queries, then create separate questions for each. The title of this question is about which is best. If you also want to know what to do if you don&#39;t know the length in advance, that belongs in a new question. But you need not bother, since there are duplicates for that one as well - eg. <a href=\"https://stackoverflow.com/questions/2879537/how-to-use-fgets-if-you-dont-know-the-number-of-characters-to-be-read\">How to use fgets if you don&#39;t know the number of characters to be read?</a>"}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1567000024, "post_id": 57692831, "comment_id": 101831940, "body": "the main question I wanted to make you understand (obviously I expressed myself badly) was if it was still okay to use scanf if I had an input of unknown length (for convenience) although it is less &quot;safe&quot; than fgets, besides the question more general about which of the two was &quot;better&quot; for the communty. I will edit the post. @SanderDeDycker"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1567000373, "post_id": 57692831, "comment_id": 101832184, "body": "@iamagro : did you read the answer to the question I put forth as a duplicate ? It uses exactly that scenario as an argument <i>for</i> <code>fgets</code> and <i>against</i>  <code>scanf</code>."}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1567001055, "post_id": 57692831, "comment_id": 101832604, "body": "Yes @SanderDeDycker, i did readed it, he uses a &quot;big&quot; array where to store the string. Isn&#39;t that a waste of memory which can be avoided using scanf ? I mean... scanf appear to be more &quot;dynamic&quot;"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1567001139, "post_id": 57692831, "comment_id": 101832660, "body": "In my opinion, if you have a choice, you should never use <code>scanf</code> for anything.  So, yes, definitely prefer <code>fgets</code> for reading whole lines."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1567001650, "post_id": 57692831, "comment_id": 101832975, "body": "@iamagro : I meant the duplicate of the original question (the one I actually voted to close this question with - and still stand by), not the one for the additional question (that I posted in a comment in response to your claim it wasn&#39;t a duplicate)."}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "reply_to_user": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1567002213, "post_id": 57692831, "comment_id": 101833344, "body": "in fact my post contains almost two questions in one but I don&#39;t know if it is necessary to delete it, there would be more information in addition to those posts, we&#39;ll see @SanderDeDycker"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1567002235, "post_id": 57692831, "comment_id": 101833359, "body": "&quot;which one is better to use in case i wanted to read an unknown length string ?&quot;  --&gt; <code>scanf (&quot;%[^\\n]%*c&quot;, string);</code> fails to read anything if user input begins with <code>&#39;\\n&#39;</code> (e.g. user input length &quot;zero&quot;).  The <code>&#39;\\n</code> remains in <code>stdin</code> too.  A corner failing of <code>scanf()</code> approach."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1567002401, "post_id": 57692831, "comment_id": 101833462, "body": "If the input is of unknown length, you have a problem that neither <code>scanf</code> nor <code>fgets</code> can solve.  You might investigate <a href=\"https://linux.die.net/man/3/getline\" rel=\"nofollow noreferrer\"><code>getline</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "edited": false, "score": 0, "creation_date": 1566998002, "post_id": 57693087, "comment_id": 101830654, "body": "With &quot;<i><code>fgets</code> does the work for you</i>&quot;  did you meant that it automatically delete the newline character ? How ? I&#39;ve to know the lenght of the string that i want to read (<b>n</b>) and use <code>fgets (string, n-1, stdin);</code> ?"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "edited": false, "score": 0, "creation_date": 1566998239, "post_id": 57693087, "comment_id": 101830807, "body": "@iamagro - no.  <i>does the work</i> may be too strong.  Maybe I should have said <i>works predictably and repeatably without complicated coding</i>.  <code>fgets</code> reads characters from the input stream into a lineBuffer until end-of-file is encountered, a newline character is read, or (number_ofChars - 1) characters are read. <b><i>The newline character is retained</i></b>.   You just have to read the docs, pick the tool that best meets the specific need.  In general, if I do not want the newline, I will strip it off after the call to read the line."}, {"owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "edited": false, "score": 0, "creation_date": 1566998769, "post_id": 57693087, "comment_id": 101831131, "body": "scant is not safe. You will get a memory scribble if input is more that the size of your buffer."}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "edited": false, "score": 0, "creation_date": 1566998826, "post_id": 57693087, "comment_id": 101831173, "body": "It seems simpler and faster to me using scanf with an unknown size input, the question is if is dangerous using scanf in terms of security ? @ryyker"}, {"owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "edited": false, "score": 0, "creation_date": 1566999131, "post_id": 57693087, "comment_id": 101831386, "body": "Understood, I will use fgets and a few more lines of code to eliminate the newline character and/or for unknown input lengths :) @ryyker"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1567001336, "post_id": 57693087, "comment_id": 101832781, "body": "<i><code>scanf</code> does not allocate in all compilers. It does in <code>gcc</code>/Linux...</i> Huh? <code>scanf</code> never takes care of allocation for you.  You <i>always</i> have the responsibility of assuring sufficient buffer size, on all systems."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1567001990, "post_id": 57693087, "comment_id": 101833195, "body": "Note that <code>&quot;%[^\\n]%*c&quot;</code> has a weakness in that it reads <i>nothing</i> into the buffer if the first character is <code>&#39;\\n&#39;</code>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1567002013, "post_id": 57693087, "comment_id": 101833215, "body": "@SteveSummit - Yes, my statement I think came from some non-standard extensions that I was aware of, such as those spoken about <i><a href=\"https://stackoverflow.com/questions/11926883/scanf-dynamic-allocation\">here</a></i>.  I will remove the comment.  Thanks."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1567002142, "post_id": 57693087, "comment_id": 101833300, "body": "@ryyker Ah.  Never heard of that before, thanks."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 1, "last_activity_date": 1566997645, "last_edit_date": 1566997645, "creation_date": 1566997330, "answer_id": 57693087, "question_id": 57692831, "link": "https://stackoverflow.com/questions/57692831/is-better-to-use-scanf-or-fgets/57693087#57693087", "title": "Is better to use scanf or fgets?", "body": "<p>There is an <em><a href=\"https://stackoverflow.com/a/27327168/645128\">answer here</a></em> that addresses your question about using <code>fgets</code> with unknown size of input.</p>\n\n<p>Because the first part of your post is clearly asking for opinion, I will offer mine:\nFor reading the entire line from <code>stdin</code>, readability, and ease of coding make the statement  </p>\n\n<pre><code>fgets (string, 100, stdin);\n</code></pre>\n\n<p>superior to</p>\n\n<pre><code>scanf (\"%[^\\n]%*c\", string);\n</code></pre>\n\n<p>The <code>\"%[^\\n]%*c\"</code> argument alone is an ugly, (but necessary) requirement to handle newline when using <code>scanf</code>, while <code>fgets</code> does the work for you.</p>\n"}], "owner": {"reputation": 9, "user_id": 10951478, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8zAZ.jpg?s=128&g=1", "display_name": "iamagro", "link": "https://stackoverflow.com/users/10951478/iamagro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "closed_date": 1566997708, "accepted_answer_id": 57693087, "answer_count": 1, "score": -1, "last_activity_date": 1567001205, "creation_date": 1566996512, "last_edit_date": 1567001205, "question_id": 57692831, "link": "https://stackoverflow.com/questions/57692831/is-better-to-use-scanf-or-fgets", "closed_reason": "Opinion-based", "title": "Is better to use scanf or fgets?", "body": "<p>I want to read an entire line from <strong>stdin</strong> (standard input), but which one is better to use in case i wanted to read an unknown lenght string ?</p>\n\n<p>This:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>fgets (string, length, stdin);\n</code></pre>\n\n<p>or this ?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>scanf (\"%[^\\n]%*c\", string);\n</code></pre>\n\n<blockquote>\n  <p>From what i know, <strong><code>fgets</code></strong> should be safer than <strong>scanf</strong> to use, but\n  on the other side, <strong>scanf</strong> will automatically delete the newline\n  character <strong>\\n</strong>. </p>\n  \n  <p>Is it okay to use <strong><code>scanf</code></strong> if I had an input of unknown length (for convenience) although it is less \"safe\" than <strong><code>fgets</code></strong> ? Or should I still use <strong><code>fgets</code></strong>?</p>\n</blockquote>\n"}, {"tags": ["c", "stm32", "firewall"], "answers": [{"tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": true, "score": 3, "last_activity_date": 1567002998, "creation_date": 1567002998, "answer_id": 57694878, "question_id": 57692815, "link": "https://stackoverflow.com/questions/57692815/need-help-understanding-the-call-gate-sequence-for-the-stm32s-firewall/57694878#57694878", "title": "Need Help Understanding the &quot;Call Gate&quot; Sequence for the STM32&#39;s Firewall", "body": "<blockquote>\n  <ol>\n  <li>At what point were these 3 words created?</li>\n  </ol>\n</blockquote>\n\n<p>They are created by the compiler and linker, and written into the on-chip flash.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Do i need to put in some extra code to open the gate?</li>\n  </ol>\n</blockquote>\n\n<p>No. The firewall will be opened by jumping to the second word.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>What are these two call-gate words?</li>\n  </ol>\n</blockquote>\n\n<p>Thumb(-2) machine code instructions at the beginning of the protected function. They must be fetched sequentially, it means that there should be no branch instructions in the second word.</p>\n\n<p>I'd just fill the first and second words with 4 <code>NOP</code> instructions, and put the protected function directly after.</p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>The reference manual mentions that the dummy word is skipped to the 2nd and 3rd words. How do I ensure this happens?</li>\n  </ol>\n</blockquote>\n\n<p>Write your code carefully so it doesn't ever attempt to execute or read the first word.</p>\n\n<blockquote>\n  <ol start=\"5\">\n  <li>To protect the SRAM, the address of the memory location to protect must be known. How do I know where in RAM the data I want to protect will be held?</li>\n  </ol>\n</blockquote>\n\n<p>Define a separate section in the linker definition file (<code>.ld</code>, <code>.sct</code> or <code>.icf</code>, depending on the linker used) to put the protected variables in, aligned according to the firewall requirements, then export a symbol at the beginning and one at the end of the section, like it is done in the <code>.data</code>, <code>.bss</code> and <code>.heap</code> sections.</p>\n"}], "owner": {"reputation": 147, "user_id": 11681090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcbd712770f6d2bc37de2c27ec4ef8ec?s=128&d=identicon&r=PG&f=1", "display_name": "arry_h", "link": "https://stackoverflow.com/users/11681090/arry-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 57694878, "answer_count": 1, "score": 1, "last_activity_date": 1567002998, "creation_date": 1566996454, "question_id": 57692815, "link": "https://stackoverflow.com/questions/57692815/need-help-understanding-the-call-gate-sequence-for-the-stm32s-firewall", "title": "Need Help Understanding the &quot;Call Gate&quot; Sequence for the STM32&#39;s Firewall", "body": "<p>I am trying to use the STM32(l412kb)'s firewall according to to page 146 of this <a href=\"https://www.st.com/content/ccc/resource/technical/document/reference_manual/02/35/09/0c/4f/f7/40/03/DM00083560.pdf/files/DM00083560.pdf/jcr:content/translations/en.DM00083560.pdf\" rel=\"nofollow noreferrer\">reference manual</a>. I understand that to initialise the firewall, you need to set the base address and the length of the segment you want to protect. You then enable the firewall by clearing the FWDIS (firewall disabled) bit in the SYSCFG register. </p>\n\n<p>However I do not understand how the firewall can be opened to execute code. From my understanding there are three words located at the first three 32-bit addresses of the code segment. The first word is a dummy word. The second and third words are two specific 32 bit words called the 'call gate'. </p>\n\n<p>My questions are: </p>\n\n<ol>\n<li><p>At what point were these 3 words created?</p></li>\n<li><p>Do i need to put in some extra code to open the gate?</p></li>\n<li><p>What are these two call-gate words?</p></li>\n<li><p>The reference manual mentions that the dummy word is skipped to the 2nd and 3rd words. How do I ensure this happens?</p>\n\n<ol start=\"5\">\n<li>To protect the SRAM, the address of the memory location to protect must be known. How do I know where in RAM the data I want to protect will be held?</li>\n</ol></li>\n</ol>\n\n<p>Or are these all automatic hardware actions.</p>\n\n<p>Many thanks in advance for your help,</p>\n\n<p>Harry</p>\n"}, {"tags": ["c", "arrays", "pointers", "linked-list"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1566996465, "post_id": 57692679, "comment_id": 101829726, "body": "To do the task there is no need to create an array. Moreover the using the magic number 200 is unclear."}, {"owner": {"reputation": 25, "user_id": 11906366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b579392cdf4c66e6b64491f8d63d7?s=128&d=identicon&r=PG&f=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/11906366/kon"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566996738, "post_id": 57692679, "comment_id": 101829889, "body": "Yea thnx i got the problem the list can be of even bigger size then 200.and Yea i know it is not the best and the optimal solution."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1566997939, "post_id": 57692679, "comment_id": 101830607, "body": "The current code returns the <code>data</code> from the node. Wouldn&#39;t it be more useful to return a pointer to the node (and return <code>NULL</code> if there is no merge point)? You can easily get the <code>data</code> value from the merged node pointer, but going the other way is harder, especially if the <code>data</code> values are not unique."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566998681, "post_id": 57692679, "comment_id": 101831082, "body": "There is no need to create an array (extra space), although this is one of those problems where faster than naive algorithms can be used at the expense of using extra space."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567047224, "post_id": 57692679, "comment_id": 101848211, "body": "OT: regarding: <code>a=(SinglyLinkedListNode**)malloc(200*sizeof(SinglyLinkedList&zwnj;&#8203;Node));</code>  1) In C, the returned type is <code>void*</code> which can be assigned to any pointer.  Casting just clutters the code, making it more difficult to understand, debug, etc.  2)  Always check (!=NULL)  the returned value to assure the operation was successful.  If not successful, call <code>perror( &quot;malloc failed&quot; );</code> to output both your error message and the reason the system thinks the error occurred to <code>stderr</code>."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567047379, "post_id": 57692679, "comment_id": 101848235, "body": "When asking a question about a run time problem, as this question is doing, Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567047665, "post_id": 57692679, "comment_id": 101848273, "body": "regarding: <code>a=(SinglyLinkedListNode**)malloc(200*sizeof(SinglyLinkedList&zwnj;&#8203;Node));</code>.  This does NOT produce a singly linked list rather, it produces an array with room for 200 entries.  Much better to just do: <code>SinglyLinkedListNode **a = NULL;</code> then use <code>realloc()</code> to extend the size as each node is added."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567047833, "post_id": 57692679, "comment_id": 101848298, "body": "regarding: <code>SinglyLinkedListNode *p=head2;      for(int j=0;j&lt;i;j++){         if(a[j]==p){           return p-&gt;data;</code>  This is not producing a &#39;merged&#39; list rather, it is producing a <code>intersection</code> of the lists"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567047934, "post_id": 57692679, "comment_id": 101848316, "body": "why not just walk down to the end of the first linked list, then set the &#39;next&#39; field of the last node to point to the first node in the second list?"}], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "is_accepted": false, "score": 0, "last_activity_date": 1566997336, "last_edit_date": 1566997336, "creation_date": 1566996765, "answer_id": 57692909, "question_id": 57692679, "link": "https://stackoverflow.com/questions/57692679/finding-the-merge-point-of-two-singlylinkedlist-using-an-array-which-stores-the/57692909#57692909", "title": "Finding the merge point of two singlyLinkedlist using an array which stores the address of each Node of linked list", "body": "<pre><code>int findMergeNode(SinglyLinkedListNode* head1, SinglyLinkedListNode* head2)\n{\n    SinglyLinkedListNode *temp = head2;\n        while(head1) {\n            head2 = temp;\n            while(head2) {\n                if(head1 == head2) {\n                    return head2-&gt;data;\n                 }\n                 head2 = head2-&gt;next;\n            }\n            head1 = head1-&gt;next;\n        }\n        return -1;\n    }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1567005481, "last_edit_date": 1567005481, "creation_date": 1567005034, "answer_id": 57695461, "question_id": 57692679, "link": "https://stackoverflow.com/questions/57692679/finding-the-merge-point-of-two-singlylinkedlist-using-an-array-which-stores-the/57695461#57695461", "title": "Finding the merge point of two singlyLinkedlist using an array which stores the address of each Node of linked list", "body": "<p>Addressing only one part of your post here:</p>\n\n<p>The statement </p>\n\n<pre><code>a=(SinglyLinkedListNode**)malloc(200*sizeof(SinglyLinkedListNode));\n</code></pre>\n\n<p>has a couple of potential problems.<br>\n1) If you are expecting this to create memory for an addressable array of arrays it is not be doing what you expect it to do.<br>\n2) casting the return of calloc is not necessary (or recommended) in C.  (in C++, it is)  </p>\n\n<p>Creating an addressable array of arrays of any type variable can be done in many ways, the following is one example:</p>\n\n<pre><code>TYPE ** Create2D(ssize_t numArrays, ssize_t maxArrayLen)\n{\n    int i;\n    TYPE **a = {0};\n    a = calloc(numArrays, sizeof(TYPE *));\n    for(i=0;i&lt;numArrays; i++)\n    {\n      a[i] = calloc(maxArrayLen + 1, 1);\n    }\n    return a;\n}\n</code></pre>\n\n<p>Where TYPE is any C type, such as <code>char</code>, <code>int</code>, <code>float</code>, or in this case <code>SinglyLinkedListNode</code>.  Just replace <em>TYPE</em> with any real type and the function will create an array of arrays, such as:</p>\n\n<pre><code>SinglyLinkedListNode **a;\na = Create2D(20, 200);//create 20 arrays, each with 200 elements\n</code></pre>\n\n<p>each element accessible via array notation: <code>a[i][j]</code></p>\n\n<p>Dont forget to free when done.</p>\n"}], "owner": {"reputation": 25, "user_id": 11906366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/377b579392cdf4c66e6b64491f8d63d7?s=128&d=identicon&r=PG&f=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/11906366/kon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1567005481, "creation_date": 1566996070, "question_id": 57692679, "link": "https://stackoverflow.com/questions/57692679/finding-the-merge-point-of-two-singlylinkedlist-using-an-array-which-stores-the", "title": "Finding the merge point of two singlyLinkedlist using an array which stores the address of each Node of linked list", "body": "<p>Problem is to find the merge point of two linked list using an array which stores the value of address of each node of a linked list.</p>\n\n<p>i have tried increasing the size of address of changing the head pointer but doesnt seems to help for long linked lists.</p>\n\n<pre><code>int findMergeNode(SinglyLinkedListNode* head1, SinglyLinkedListNode* head2) {\n    SinglyLinkedListNode **a;\n    a=(SinglyLinkedListNode**)malloc(200*sizeof(SinglyLinkedListNode));\n    int i=0;\n    while(head1){\n      a[i]=head1;\n      head1=head1-&gt;next;\n      i++;\n    }\n    while(head2){\n     SinglyLinkedListNode *p=head2;\n     for(int j=0;j&lt;i;j++){\n        if(a[j]==p){\n          return p-&gt;data;\n        }\n      }\n      head2=head2-&gt;next;\n    }\n    return -1;\n}\n</code></pre>\n"}, {"tags": ["c", "function-pointers"], "comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1566996454, "post_id": 57692656, "comment_id": 101829716, "body": "1. Dereferencing a pointer to a function doesn&#39;t really do anything to it. 2. Your functions aren&#39;t strings, so don&#39;t use <code>%s</code> to print them."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1566996463, "post_id": 57692656, "comment_id": 101829720, "body": "Because applying <code>*</code> on a function pointer is a no-op. Funny tip: check  <code>printf(&quot;%x&quot;, ***************cat.sound);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": false, "score": 1, "last_activity_date": 1566997223, "creation_date": 1566997223, "answer_id": 57693048, "question_id": 57692656, "link": "https://stackoverflow.com/questions/57692656/reading-a-function-pointer-variable-value/57693048#57693048", "title": "Reading a function pointer variable value", "body": "<p>Like arrays, function designators are automatically converted to pointers to their functions. C 2018 6.3.2.1 4 says:</p>\n\n<blockquote>\n  <p>A <em>function designator</em> is an expression that has function type. Except when it is the operand of the <code>sizeof</code> operator, or the unary <code>&amp;</code> operator, a function designator with type \u201cfunction returning <em>type</em>\u201d is converted to an expression that has type \u201cpointer to function returning <em>type</em>\u201d.</p>\n</blockquote>\n\n<p>Thus the compiler automatically converts <code>cat_sound</code> (which, as the name of a function, designates the function) to <code>&amp;cat_sound</code>.</p>\n\n<p>Also, since <code>cat.sound</code> is a pointer to a function, <code>*cat.sound</code> designates the function. But then, since it is a function designator, it is automatically converted to a pointer to the function, producing <code>&amp;*cat.sound</code>, which is just the address of the function, the same as <code>cat.sound</code>.</p>\n\n<p><code>cat.sound()</code> is a pointer to the data returned by the function because the parentheses, <code>()</code>, cause the function to be called, and the result is the pointer returned by the function.</p>\n"}, {"tags": [], "owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "is_accepted": false, "score": 2, "last_activity_date": 1566998010, "last_edit_date": 1566998010, "creation_date": 1566997398, "answer_id": 57693111, "question_id": 57692656, "link": "https://stackoverflow.com/questions/57692656/reading-a-function-pointer-variable-value/57693111#57693111", "title": "Reading a function pointer variable value", "body": "<p><code>cat.sound()</code> calls the function pointed to by <code>cat.sound</code> and returns its return value, which is a <code>char*</code> pointer to beginning of the string literal <code>\"meow\"</code>. Printing it with <code>%s</code> is fine and gives the expected result <code>meow</code>. Printing it with <code>%x</code> gives an implementation defined representation of the address of the literal or undefined behavior. Better use <code>%p</code> instead, which will remove the possibility of undefined behavior.</p>\n\n<p><code>*cat.sound()</code> dereferences the pointer to the first character of the string literal <code>\"meow\"</code> and therefore gives the char <code>'m'</code> which <code>%c</code> will print directly, while <code>%x</code> will format to its hexadecimal (ascii) representation and print it.</p>\n\n<p><code>cat.sound</code> is a pointer to a function, printing it with <code>%s</code> is undefined behavior. Effectively, as your output suggests, the compiler chose to print the function's object code located at the pointer address until it encountered a null byte.</p>\n\n<p><code>*cat.sound</code> is the same as <code>cat.sound</code>. <code>*</code> applied to a function pointer doesn't really do anything. It yields a function designator, which then the way you are using it decays again to a function pointer. This is different behavior than for non-function pointers. Again printing it with <code>%s</code> is undefined behavior.</p>\n\n<p>Printing the function pointers with <code>%x</code> is also undefined behavior, see <a href=\"https://stackoverflow.com/questions/2741683/how-to-format-a-function-pointer\">this question</a> on how to legally print function pointers.</p>\n"}], "owner": {"reputation": 910, "user_id": 6422591, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/wIpwn.jpg?s=128&g=1", "display_name": "manish ma", "link": "https://stackoverflow.com/users/6422591/manish-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1566998010, "creation_date": 1566996012, "question_id": 57692656, "link": "https://stackoverflow.com/questions/57692656/reading-a-function-pointer-variable-value", "title": "Reading a function pointer variable value", "body": "<p>I have some confusion about reading the value of a function pointer variable.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar* cat_sound()\n{\n    return \"meow\";\n}\n\nchar* dog_sound()\n{\n    return \"hav\";\n}\n\ntypedef char* (*fptr_sound)(void);\n\n\ntypedef struct \n{\n    int age;\n    fptr_sound sound;\n}creature_t;\n\n\nint main()\n{\n    creature_t cat, dog;\n    cat.sound = cat_sound;\n    dog.sound = dog_sound;\n\n    printf(\"cat.sound()= %s, dog.sound()= %s\\n\", cat.sound(), dog.sound());\n    printf(\"cat.sound= %s, dog.sound= %s\\n\", cat.sound, dog.sound);\n    printf(\"*cat.sound= %s, *dog.sound= %s\\n\", *cat.sound, *dog.sound);\n    printf(\"*cat.sound()= %c, *dog.sound()= %c\\n\", *cat.sound(), *dog.sound());\n\n    printf(\"value of cat.sound= %x, dog.sound= %x\\n\", cat.sound, dog.sound);\n    printf(\"value of *cat.sound= %x, *dog.sound= %x\\n\", *cat.sound, *dog.sound);\n    printf(\"value of cat.sound()= %x, dog.sound()= %x\\n\", cat.sound(), dog.sound());\n    printf(\"value of *cat.sound()= %x, *dog.sound()= %x\\n\", *cat.sound(), *dog.sound());\n\n    return 0;\n}\n\n\ncat.sound()= meow, dog.sound()= hav\ncat.sound= U\u2592\u2592]\u2592U\u2592\u2592]\u2592U\u2592\u2592S\u2592\u2592\u2592\u2592 \u2592D$\u2592D$&amp;\u2592D$\u2592\u0409\u00cbD$\u2592\u0409\\\u2592D$\u2592$\u2592\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$\u2592x\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$&lt;\u2592\\\u2592\u2592\u2592\u2592D$\u2592\u2592\u2592, dog.sound= U\u2592\u2592]\u2592U\u2592\u2592S\u2592\u2592\u2592\u2592 \u2592D$\u2592D$&amp;\u2592D$\u2592\u0409\u00cbD$\u2592\u0409\\\u2592D$\u2592$\u2592\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$\u2592x\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$&lt;\u2592\\\u2592\u2592\u2592\u2592D$\u2592\u2592\u2592\n*cat.sound= U\u2592\u2592]\u2592U\u2592\u2592]\u2592U\u2592\u2592S\u2592\u2592\u2592\u2592 \u2592D$\u2592D$&amp;\u2592D$\u2592\u0409\u00cbD$\u2592\u0409\\\u2592D$\u2592$\u2592\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$\u2592x\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$&lt;\u2592\\\u2592\u2592\u2592\u2592D$\u2592\u2592\u2592, *dog.sound= U\u2592\u2592]\u2592U\u2592\u2592S\u2592\u2592\u2592\u2592 \u2592D$\u2592D$&amp;\u2592D$\u2592\u0409\u00cbD$\u2592\u0409\\\u2592D$\u2592$\u2592\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$\u2592x\u2592\u2592\u2592\u2592T$\u2592D$\u2592T\u2592D$\u2592$&lt;\u2592\\\u2592\u2592\u2592\u2592D$\u2592\u2592\u2592\n*cat.sound()= m, *dog.sound()= h\nvalue of cat.sound= 804841c, dog.sound= 8048426\nvalue of *cat.sound= 804841c, *dog.sound= 8048426\nvalue of cat.sound()= 80485f0, dog.sound()= 80485f5\nvalue of *cat.sound()= 6d, *dog.sound()= 68\n</code></pre>\n\n<p>As seen below, cat.sound holds the address of cat_sound function.\nSo how come *cat.sound returns the same value?\n(If comparing to a pointer to integer, de-referencing returns the value of to which it points rather than the value itself.)</p>\n\n<p>And why does cat.sound() point to the value returned from the function rather than the function address itself?</p>\n\n<pre><code>08048430 &lt;main&gt;:\n 8048430:       55                      push   ebp\n 8048431:       89 e5                   mov    ebp,esp\n 8048433:       53                      push   ebx\n 8048434:       83 e4 f0                and    esp,0xfffffff0\n 8048437:       83 ec 20                sub    esp,0x20\n 804843a:       c7 44 24 1c 1c 84 04    mov    DWORD PTR [esp+0x1c],0x804841c\n\n\n\n\n\n0804841c &lt;cat_sound&gt;:\n 804841c:       55                      push   ebp\n 804841d:       89 e5                   mov    ebp,esp\n 804841f:       b8 f0 85 04 08          mov    eax,0x80485f0\n 8048424:       5d                      pop    ebp\n 8048425:       c3                      ret\n\n\n\n\n\n08048426 &lt;dog_sound&gt;:\n 8048426:       55                      push   ebp\n 8048427:       89 e5                   mov    ebp,esp\n 8048429:       b8 f5 85 04 08          mov    eax,0x80485f5\n 804842e:       5d                      pop    ebp\n 804842f:       c3                      ret\n</code></pre>\n"}, {"tags": ["c", "bpf", "ebpf", "tracepoint"], "answers": [{"tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": true, "score": 5, "last_activity_date": 1566996698, "last_edit_date": 1566996698, "creation_date": 1566996291, "answer_id": 57692750, "question_id": 57692547, "link": "https://stackoverflow.com/questions/57692547/why-are-the-first-8-bytes-of-cpumap-enqueue-ctx-not-accessible-by-bpf-code/57692750#57692750", "title": "Why are the first 8 bytes of cpumap_enqueue_ctx not accessible by bpf code?", "body": "<p>From <a href=\"https://www.spinics.net/lists/netdev/msg458701.html\" rel=\"nofollow noreferrer\">this mailing list</a>:</p>\n\n<blockquote>\n  <p>The first 8 bytes of the tracepoint context struct are not accessible by the bpf code.  This is a choice that dates back to the original inclusion of this code.</p>\n  \n  <p>See explaination in: commit 98b5c2c65c29 (\"perf, bpf: allow bpf programs attach to tracepoints\")</p>\n</blockquote>\n\n<p>And from <a href=\"https://github.com/torvalds/linux/commit/98b5c2c65c2951772a8fc661f50d675e450e8bce\" rel=\"nofollow noreferrer\">commit 98b5c2c65c29</a>:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>introduce BPF_PROG_TYPE_TRACEPOINT program type and allow it to be attached\nto the perf tracepoint handler, which will copy the arguments into\nthe per-cpu buffer and pass it to the bpf program as its first argument.\nThe layout of the fields can be discovered by doing\n'cat /sys/kernel/debug/tracing/events/sched/sched_switch/format'\nprior to the compilation of the program with exception that first 8 bytes\nare reserved and not accessible to the program. This area is used to store\nthe pointer to 'struct pt_regs' which some of the bpf helpers will use:\n+---------+\n| 8 bytes | hidden 'struct pt_regs *' (inaccessible to bpf program)\n+---------+\n| N bytes | static tracepoint fields defined in tracepoint/format (bpf readonly)\n+---------+\n| dynamic | __dynamic_array bytes of tracepoint (inaccessible to bpf yet)\n+---------+\n\nNot that all of the fields are already dumped to user space via perf ring buffer\nand broken application access it directly without consulting tracepoint/format.\nSame rule applies here: static tracepoint fields should only be accessed\nin a format defined in tracepoint/format. The order of fields and\nfield sizes are not an ABI.\n</code></pre>\n\n<hr>\n\n<p>So the first 8 bytes are not accessible because they are used to store a pointer to a critical structure used by BPF helpers and therefore need to stay hidden to prevent damage or information leak.</p>\n"}], "owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 57692750, "answer_count": 1, "score": 4, "last_activity_date": 1566998672, "creation_date": 1566995626, "last_edit_date": 1566998672, "question_id": 57692547, "link": "https://stackoverflow.com/questions/57692547/why-are-the-first-8-bytes-of-cpumap-enqueue-ctx-not-accessible-by-bpf-code", "title": "Why are the first 8 bytes of cpumap_enqueue_ctx not accessible by bpf code?", "body": "<p>Reading some ebpf examples which are attached to tracepoints I've noticed that every struct is build starting with a padding like this (from <code>samples/bpf/xdp_redirect_cpu_kern.c</code>)</p>\n\n<pre><code>/* Tracepoint: /sys/kernel/debug/tracing/events/xdp/xdp_cpumap_enqueue/format\n * Code in:         kernel/include/trace/events/xdp.h\n */\nstruct cpumap_enqueue_ctx {\n        u64 __pad;              // First 8 bytes are not accessible by bpf code\n        int map_id;             //      offset:8;  size:4; signed:1;\n        u32 act;                //      offset:12; size:4; signed:0;\n        int cpu;                //      offset:16; size:4; signed:1;\n        unsigned int drops;     //      offset:20; size:4; signed:0;\n        unsigned int processed; //      offset:24; size:4; signed:0;\n        int to_cpu;             //      offset:28; size:4; signed:1;\n};\n</code></pre>\n\n<p>All I found is this comment which says that the first 8 bytes can't be accessed by bpf code, but I don't understand why.</p>\n"}, {"tags": ["c", "shared-libraries", "objdump"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566995400, "post_id": 57692438, "comment_id": 101829082, "body": "Most of the times there is no point in using <code>-fpie</code> as GCC produces PIE by default. Try compiling with <code>-fno-pie</code> instead."}, {"owner": {"reputation": 21, "user_id": 11989169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5506a8766f18e8daf11c8b3fa35fe88?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11989169/josh"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566995429, "post_id": 57692438, "comment_id": 101829099, "body": "but Im trying to see why we still have memory addresses in pie mode"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566995445, "post_id": 57692438, "comment_id": 101829104, "body": "Also, you can tell if an EFL is position independent using the <code>file</code> command: for a position independent ELF it will say <code>ELF Shared Object</code>, for a normal executable it will say <code>ELF Executable</code>."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566995476, "post_id": 57692438, "comment_id": 101829133, "body": "You don&#39;t have memory addresses in PIE mode, those will change when you start the program. What you are seeing are relative addresses."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566995480, "post_id": 57692438, "comment_id": 101829136, "body": "Well there must be a base address for the code to start. Then the &quot;position independent&quot; resolution will be a simple &quot;add offset to all addresses&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11989169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5506a8766f18e8daf11c8b3fa35fe88?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11989169/josh"}, "edited": false, "score": 0, "creation_date": 1566995786, "post_id": 57692560, "comment_id": 101829322, "body": "but they are still virtual memory addresses right? on runtime they get added with a constant offset? and i&#39;m guessing in &quot;no-pie&quot; mode there is no offset and they get loaded at the exact address location?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 21, "user_id": 11989169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5506a8766f18e8daf11c8b3fa35fe88?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11989169/josh"}, "edited": false, "score": 0, "creation_date": 1567100013, "post_id": 57692560, "comment_id": 101872385, "body": "Hi @Josh, if this correctly answered your question, please accept it by clicking the green tick on the top left, so that this post can be marked as solved."}], "tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1566995678, "creation_date": 1566995678, "answer_id": 57692560, "question_id": 57692438, "link": "https://stackoverflow.com/questions/57692438/what-are-the-addresses-on-the-left-when-doing-objdump-on-a-binary-file/57692560#57692560", "title": "What are the addresses on the left when doing objdump on a binary file", "body": "<p>In a PIE (Position Independent Executable), those \"addresses\" are actually just relative offsets from the base virtual address of your program. When the program is launched, it will be loaded into memory by the dynamic loader at some <code>0x&lt;base_addr&gt;</code>, and your <code>__text</code> section in this case will be at <code>0x&lt;base_addr&gt; + 0x100000f40</code>.</p>\n\n<p>Note that the base virtual address will change for every execution if you have ASLR (address space layout randomization) enabled, which on any modern system is enabled by default.</p>\n"}], "owner": {"reputation": 21, "user_id": 11989169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5506a8766f18e8daf11c8b3fa35fe88?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11989169/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566995871, "creation_date": 1566995271, "last_edit_date": 1566995871, "question_id": 57692438, "link": "https://stackoverflow.com/questions/57692438/what-are-the-addresses-on-the-left-when-doing-objdump-on-a-binary-file", "title": "What are the addresses on the left when doing objdump on a binary file", "body": "<p>I have compiled a simple hello world c code with <code>gcc -fpie test.c</code>, and now looking at the binary using <code>objdump</code>:</p>\n\n<pre><code>Disassembly of section __TEXT,__text:\n__text:\n100000f40:  55                      pushq   %rbp\n100000f41:  48 89 e5                movq    %rsp, %rbp\n100000f44:  48 83 ec 10             subq    $16, %rsp\n100000f48:  89 7d fc                movl    %edi, -4(%rbp)\n100000f4b:  8b 75 fc                movl    -4(%rbp), %esi\n100000f4e:  48 8d 3d 5d 00 00 00    leaq    93(%rip), %rdi\n100000f55:  b0 00                   movb    $0, %al\n...\n</code></pre>\n\n<p>Are these virtual (runtime) addresses considering I have compiled with <code>-fpie</code>? what are they used for if code is position independent.</p>\n\n<p>If I remove the <code>fpie</code> I do get the same addresses on the left, and I'm assuming they are virtual addresses where these instructions will be loaded to correct?</p>\n"}, {"tags": ["c", "ternary-operator", "operator-precedence", "assignment-operator", "conditional-operator"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 1, "creation_date": 1566994991, "post_id": 57692277, "comment_id": 101828839, "body": "Why are you using a tristate operator in place of an <code>if</code>? It hurts readability and does not make it any faster nor better."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566995035, "post_id": 57692277, "comment_id": 101828853, "body": "The ternary operator is very much overused, it makes code harder to read and understand and maintain. Use proper <code>if</code> statements instead. If I understand your code correctly what you want is simply <code>if (sign == 0) retv = 1;</code>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 3, "creation_date": 1566995217, "post_id": 57692277, "comment_id": 101828978, "body": "conditional <b>expression</b>: <code>retv=(sign==0)?1:retv;</code>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1566995620, "post_id": 57692277, "comment_id": 101829228, "body": "By the way, your error message doesn&#39;t match the code you show! It&#39;s important to make sure that you show us a proper <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> that replicates the error you get, and show use that code together with the full and complete error output (copy-pasted as text) from that exact code. And please read <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566995084, "post_id": 57692338, "comment_id": 101828892, "body": "<code>retv = 0</code> changes the semantics, I think the purpose is to leave <code>retv</code> unmodified in that case."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1566995155, "post_id": 57692338, "comment_id": 101828933, "body": "I think that was OP&#39;s intention. Given the comment <code>&#47;&#47;ERROR if retv=0</code>, I think he wanted it to be like that, but it wouldn&#39;t compile that way. I could be misunderstanding this, though."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 3, "last_activity_date": 1566994974, "creation_date": 1566994974, "answer_id": 57692338, "question_id": 57692277, "link": "https://stackoverflow.com/questions/57692277/behavior-of-conditional-statement-in-the-body-of-switch-case-c-language/57692338#57692338", "title": "Behavior of conditional statement in the body of switch case (C language)", "body": "<p>That's because the ternary conditional has higher operator precedence than <code>=</code>. It will compile like this:</p>\n\n<pre><code>case mt1: sign == 0 ? (retv = 1) : (retv = 0);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1566995592, "creation_date": 1566995592, "answer_id": 57692539, "question_id": 57692277, "link": "https://stackoverflow.com/questions/57692277/behavior-of-conditional-statement-in-the-body-of-switch-case-c-language/57692539#57692539", "title": "Behavior of conditional statement in the body of switch case (C language)", "body": "<p>There is a difference in defining the conditional operator in C and C++.</p>\n\n<p>In C the operator is defined like</p>\n\n<pre><code>logical-OR-expression ? expression : conditional-expression\n</code></pre>\n\n<p>and the conditional operator has higher precedence then the assignment operator.</p>\n\n<p>Thus this expression statement</p>\n\n<pre><code>sign == 0? retv = 1 : retv = 0;\n</code></pre>\n\n<p>is processed like</p>\n\n<pre><code>( sign == 0? retv = 1 : retv ) = 0;\n</code></pre>\n\n<p>To avoid the error You could rewrite the original expression more simpler as</p>\n\n<pre><code>retv = sign == 0? 1 : 0;\n</code></pre>\n\n<p>or even simpler</p>\n\n<pre><code>retv = sign == 0;\n</code></pre>\n\n<p>In C++ this operator is defined like</p>\n\n<pre><code>logical-or-expression ? expression : assignment-expression\n</code></pre>\n\n<p>So in C++ this expression statement</p>\n\n<pre><code>sign == 0? retv = 1 : retv = 0;\n</code></pre>\n\n<p>will be valid.:)</p>\n"}], "owner": {"reputation": 9, "user_id": 9914941, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ey6OPKImOHs/AAAAAAAAAAI/AAAAAAAAAAA/go1bgl3S9Iw/photo.jpg?sz=128", "display_name": "dts", "link": "https://stackoverflow.com/users/9914941/dts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "closed_date": 1567094417, "answer_count": 2, "score": 0, "last_activity_date": 1566995735, "creation_date": 1566994757, "last_edit_date": 1566995735, "question_id": 57692277, "link": "https://stackoverflow.com/questions/57692277/behavior-of-conditional-statement-in-the-body-of-switch-case-c-language", "closed_reason": "Not suitable for this site", "title": "Behavior of conditional statement in the body of switch case (C language)", "body": "<p>The code snippet below works fine as it is but if I want to assign a value to retv in the second part of the conditional statement it throws a compiler error. I am using GCC C compiler.\nCan anyone explain why?</p>\n\n<p><em>Code</em></p>\n\n<pre><code>typedef enum {\nmt1 = 23,\nmt2 = 43,\nmt3 = 53\n} mts;\n\nint getmt(mts value, int sign) {\n    int retv = -1;\n    switch(value) {\n        case mt1: sign == 0? retv=1 : retv; //ERROR if retv=0 \n                  break;\n        case mt2: break;\n        case mt3: break;\n        default: break;\n    }\n    return retv;\n}\nint main(void)\n{\n    printf(\"val:%d\\n\", getmt(mt1, 0));\n    printf(\"val:%d\\n\", getmt(mt2, 0));\n    return 0;\n}\n</code></pre>\n\n<p><em>Error</em></p>\n\n<pre><code>error: lvalue required as left operand of assignment\n         case mt1: sign == 0? retv=1 : retv=0; break;\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566997669, "post_id": 57692060, "comment_id": 101830459, "body": "Related and IMO not strictly a dupe (this question is about unions, the following question is about structs):  <a href=\"https://stackoverflow.com/questions/119123/why-isnt-sizeof-for-a-struct-equal-to-the-sum-of-sizeof-of-each-member\"><b>Why isn&#39;t sizeof for a struct equal to the sum of sizeof of each member?</b></a>"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1566998240, "post_id": 57692060, "comment_id": 101830808, "body": "Also, <code>printf(&quot;%d&quot;,sizeof(z));</code> is incorrect and undefined behavior.  The <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.21.6.1p7\" rel=\"nofollow noreferrer\">proper format specifier for <code>size_t</code> is <code>%zu</code></a> - <code>z</code> for <code>size_t</code>, <code>u</code> for <code>unsigned</code>."}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 7488992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb292192e1f2bf7b93e379bdb1757e72?s=128&d=identicon&r=PG&f=1", "display_name": "akshay kishore", "link": "https://stackoverflow.com/users/7488992/akshay-kishore"}, "edited": false, "score": 0, "creation_date": 1566994524, "post_id": 57692190, "comment_id": 101828556, "body": "um shouldnt it be 3 x8 =24 plus 7x4 =28, so totaling 52?"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 3, "creation_date": 1566994613, "post_id": 57692190, "comment_id": 101828613, "body": "This answer should add, why it matters (ie. use in arrays)."}, {"owner": {"reputation": 859, "user_id": 7488992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb292192e1f2bf7b93e379bdb1757e72?s=128&d=identicon&r=PG&f=1", "display_name": "akshay kishore", "link": "https://stackoverflow.com/users/7488992/akshay-kishore"}, "edited": false, "score": 0, "creation_date": 1566994629, "post_id": 57692190, "comment_id": 101828625, "body": "I dont get your point, It should make available the space required for both the integer array and the double array right?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "reply_to_user": {"reputation": 859, "user_id": 7488992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb292192e1f2bf7b93e379bdb1757e72?s=128&d=identicon&r=PG&f=1", "display_name": "akshay kishore", "link": "https://stackoverflow.com/users/7488992/akshay-kishore"}, "edited": false, "score": 1, "creation_date": 1566994817, "post_id": 57692190, "comment_id": 101828731, "body": "@akshaykishore A union only stores one of its members at any given time. Its size is that of its largest member, plus padding and alignment adjustments."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 859, "user_id": 7488992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb292192e1f2bf7b93e379bdb1757e72?s=128&d=identicon&r=PG&f=1", "display_name": "akshay kishore", "link": "https://stackoverflow.com/users/7488992/akshay-kishore"}, "edited": false, "score": 0, "creation_date": 1566994926, "post_id": 57692190, "comment_id": 101828792, "body": "@akshaykishore You&#39;re mixing it up with a struct."}, {"owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "edited": false, "score": 0, "creation_date": 1566995586, "post_id": 57692190, "comment_id": 101829200, "body": "&quot;A union only stores one of its members at any given time.&quot; - not necessarily true. The union in this example can store x[0] and y[2] without any conflict. But yes, writing to y[0] will overwrite x[0] and x[1]. I think I know what you meant (treating the entire arrays of x and y as members), but I&#39;m just adding this in case it is helpful to others in understanding unions."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "edited": false, "score": 0, "creation_date": 1566996298, "post_id": 57692190, "comment_id": 101829631, "body": "@CaitLANJenner Isn&#39;t that undefined behavior, even if it seems like it works?"}, {"owner": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566997103, "post_id": 57692190, "comment_id": 101830106, "body": "@JosephSible it isn&#39;t undefined, and there are actually good reasons for it. The bytes of a union are stored contiguously. Using array indices allows you to write to specific groups of bytes. If a union of char[4] and int is size 4 bytes, storing a value into the int portion has a defined impact on the char portion. Each element of the char array will represent whatever the corresponding bytes of the int are. This is more commonly used in union data structures performing tasks such as disassembly, where the union fields are often defined with a specific bit-width."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 2032, "user_id": 5199418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLvUH.jpg?s=128&g=1", "display_name": "h0r53", "link": "https://stackoverflow.com/users/5199418/h0r53"}, "edited": false, "score": 2, "creation_date": 1566998407, "post_id": 57692190, "comment_id": 101830912, "body": "@CaitLANJenner But be careful.  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.2.6.1p6\" rel=\"nofollow noreferrer\">The padding bytes for the <code>struct</code> being written to can be updated</a>: &quot;When a value is stored in an object of structure or union type, including in a member object, <b>the bytes of the object representation that correspond to any padding bytes take unspecified values</b>.&quot;  In this case, assigning a value to <code>y[2]</code> could change the value of <code>x[6]</code> in the example union.  Admittedly that&#39;s only <i>likely</i> to happen when directly assigning <code>struct</code> values themselves."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 10, "last_activity_date": 1566994704, "last_edit_date": 1566994704, "creation_date": 1566994459, "answer_id": 57692190, "question_id": 57692060, "link": "https://stackoverflow.com/questions/57692060/why-is-the-size-of-this-union-larger-than-expected/57692190#57692190", "title": "Why is the size of this union larger than expected?", "body": "<p>Unions, like structs, are padded to agree with the required alignment of their members.</p>\n\n<p><code>double</code> is aligned on a multiple of eight on your platform, and 32 is the smallest multiple of eight that is at least 28.</p>\n"}, {"comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1567023031, "post_id": 57692405, "comment_id": 101842745, "body": "Does this <code>#pragma</code> work with other compilers than Micro$oft&#39;s? For GCC it&#39;s common to use <code>__attribute__((pack))</code>."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1569932351, "post_id": 57692405, "comment_id": 102748854, "body": "@thebusybee - The <code>pragma</code> directive is defined by the C standard, not Microsoft, so it is portable.  Any decent C compiler (including Microsoft&#39;s, GCC, CLANG, etc.) since C99 implements it.  <i><a href=\"https://gcc.gnu.org/onlinedocs/cpp/Pragmas.html\" rel=\"nofollow noreferrer\">There is lots written about it, eg this GCC page.</a></i>  I use 3 different C compilers regularly, and have seen no issues using it in them.  Have you had a problem with the compiler you use?"}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 1, "creation_date": 1569933508, "post_id": 57692405, "comment_id": 102749482, "body": "Thank you very much for providing some source! Most of the projects I worked on had to use a really old version of GCC. Sorry for the noise."}, {"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1569934408, "post_id": 57692405, "comment_id": 102750009, "body": "Well, I was not questioning <code>#pragma</code> but <code>pack</code>. Of course <code>#pragma</code> is known since the old days, but <code>pack</code> is <b>not</b> mentioned in the standard. Each compiler is free to ignore unknown pragmas."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1569935484, "post_id": 57692405, "comment_id": 102750715, "body": "@thebusybee - Well, you of coarse are correct, and I am surprised it is not included.   Nevertheless, <code>pack</code>, although not specifically mentioned in the standard, <i>is</i>  often implemented argument for the <code>pragma</code> directive.  As I have mentioned, I have used it regularly on several compilers.  But nice to know that its availability is not guaranteed."}], "tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 4, "last_activity_date": 1569933201, "last_edit_date": 1569933201, "creation_date": 1566995184, "answer_id": 57692405, "question_id": 57692060, "link": "https://stackoverflow.com/questions/57692060/why-is-the-size-of-this-union-larger-than-expected/57692405#57692405", "title": "Why is the size of this union larger than expected?", "body": "<p>As explained in another answer, <em><a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">padding</a></em> is used to facilitate <em><a href=\"https://www.geeksforgeeks.org/structure-member-alignment-padding-and-data-packing/\" rel=\"nofollow noreferrer\">struct (and union) member alignment</a></em> and is the reason for the unexpected size that you see.  </p>\n\n<p>To see the size you expected (i.e. without padding), you can force the code to to <em>ignore</em> the alignment issue by using a <code>pragma</code> statement.   <code>#pragma pack</code> specifically is used to indicate to the compiler that the <code>struct</code>/<code>union</code> be packed in a specific way, by changing the addressing alignment from the default value to something else.</p>\n\n<p>The following results in a size of 28:</p>\n\n<pre><code>#pragma pack(1) //Sets compiler to align on 1 byte address boundaries\n                //(Effectively removing all padding)\n\nunion U {\n    int x[7];\n    double y[3];\n}z;\n\n#pragma pack() //Set packing back to what it was before\n\nint main(){\n    printf(\"%d\",sizeof(z));\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 6086099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5aad23e770996f8d77dd289e2d3c1951?s=128&d=identicon&r=PG&f=1", "display_name": "Ashikur Rahman", "link": "https://stackoverflow.com/users/6086099/ashikur-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1569933201, "creation_date": 1566994057, "last_edit_date": 1566995264, "question_id": 57692060, "link": "https://stackoverflow.com/questions/57692060/why-is-the-size-of-this-union-larger-than-expected", "title": "Why is the size of this union larger than expected?", "body": "<p>When I type in the following code, I get a result of 32 bytes. It supposed to be 28 bytes, though. Why do I get that result?</p>\n\n<pre><code>//size of union variable\n\nunion U {\n    int x[7];\n    double y[3];\n}z;\n\nint main(){\n    printf(\"%d\",sizeof(z));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "cmake", "zeromq"], "comments": [{"owner": {"reputation": 848, "user_id": 3087555, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/fe453dd9d1b38e7fcc19dc5f71e3cc4a?s=128&d=identicon&r=PG&f=1", "display_name": "ZeppRock", "link": "https://stackoverflow.com/users/3087555/zepprock"}, "edited": false, "score": 0, "creation_date": 1567059083, "post_id": 57691994, "comment_id": 101850786, "body": "That duplicate didn&#39;t answer my question as I still have to add the <code>-lczmq</code> flag when I compile code that uses the library created."}], "answers": [{"comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1567008648, "post_id": 57692211, "comment_id": 101837050, "body": "Variable <code>CMAKE_EXE_LINKER_FLAGS</code> is a <b>wrong place</b> for <code>-l</code> flags: the content of this variable appears <b>before</b> the object file(s) in the linker&#39;s command line, while correct order of <code>-l</code> flags is <b>after</b> the object file(s). Command <code>target_link_libraries</code> should be used instead of <code>CMAKE_EXE_LINKER_FLAGS</code>."}], "tags": [], "owner": {"reputation": 318, "user_id": 11942119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec26748e8c53969f0d2e7d6c819af0cf?s=128&d=identicon&r=PG", "display_name": "fugiefire", "link": "https://stackoverflow.com/users/11942119/fugiefire"}, "is_accepted": false, "score": 0, "last_activity_date": 1566994541, "creation_date": 1566994541, "answer_id": 57692211, "question_id": 57691994, "link": "https://stackoverflow.com/questions/57691994/how-do-i-link-my-library-with-czmq-using-cmake/57692211#57692211", "title": "How do I link my library with czmq using CMake", "body": "<p>Set the <code>CMAKE_EXE_LINKER_FLAGS</code> to whatever options you want the linker to use:</p>\n\n<pre><code>SET(GCC_LINK_FLAGS \"-lczmq\")\n</code></pre>\n\n<p>then append the flags to the CMake variables:</p>\n\n<pre><code>SET(CMAKE_EXE_LINKER_FLAGS  \"${CMAKE_EXE_LINKER_FLAGS} ${GCC_COMPILE_FLAGS}\")\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 3087555, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/fe453dd9d1b38e7fcc19dc5f71e3cc4a?s=128&d=identicon&r=PG&f=1", "display_name": "ZeppRock", "link": "https://stackoverflow.com/users/3087555/zepprock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "closed_date": 1567008417, "answer_count": 1, "score": 1, "last_activity_date": 1566994541, "creation_date": 1566993824, "question_id": 57691994, "link": "https://stackoverflow.com/questions/57691994/how-do-i-link-my-library-with-czmq-using-cmake", "closed_reason": "Duplicate", "title": "How do I link my library with czmq using CMake", "body": "<p>I am having trouble finding a way to linking the czmq library when using CMake. I can compile code using the czmq library with <code>gcc myprog.c -lczmq</code> just fine.</p>\n\n<p>My project structure looks like this:</p>\n\n<pre><code>src/...\ninclude/...\nbuild/...\nCMakeLists.txt\n</code></pre>\n\n<p>The <code>src/</code> folder contains the <code>.c</code> files and corresponding <code>.h</code> files. The <code>include/</code> folder contains the library header. </p>\n\n<p>My current <code>CmakeLists.txt</code> looks like this:</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.10)\n\nproject(mylib)\nset(CMAKE_BUILD_TYPE Release)\n\n#Header\ninclude_directories(include)\n\n#Src files, GLOB allows for wildcard additions\nfile(GLOB SOURCES \"src/*c\")\n\n#Generate the shared library from the sources\nadd_library(mylib SHARED ${SOURCES})\n\n#Set location for the library installation\ninstall(TARGETS mylib DESTINATION .)\n</code></pre>\n"}, {"tags": ["c++", "c", "cmake", "compilation"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566993733, "post_id": 57691811, "comment_id": 101828111, "body": "<code>unrecognised emulation mode: armelf_linux_eabi</code>     <code>Supported emulations: elf_x86_64 elf32_x86_64 elf_i386 elf_iamcu i386linux elf_l1om elf_k1om i386pep i386pe</code>"}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566993774, "post_id": 57691811, "comment_id": 101828146, "body": "@KamilCuk yes, because <code>&#47;bin&#47;ld</code> is being used. Shouldn&#39;t I use another linker (perhaphs llvm) which supports <code>armelf_linux_eabi</code>?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566993851, "post_id": 57691811, "comment_id": 101828198, "body": "Is there a clang linker? <code>set(CMAKE_C_LINK_EXECUTABLE ...)</code>"}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566994165, "post_id": 57691811, "comment_id": 101828361, "body": "@KamilCuk I don&#39;t know. Do you mean llvm?"}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566994556, "post_id": 57691811, "comment_id": 101828573, "body": "@KamilCuk I used <code>set(CMAKE_C_LINK_EXECUTABLE &#47;usr&#47;bin&#47;llvm-link-8)</code> and I got: <code>&#47;usr&#47;bin&#47;llvm-link-8     llvm-link-8: Not enough positional command line arguments specified! </code>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1566997609, "post_id": 57691811, "comment_id": 101830416, "body": "@LucasZanella try specifying <code>&#47;usr&#47;bin&#47;lld</code>"}, {"owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "reply_to_user": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1567005733, "post_id": 57691811, "comment_id": 101835428, "body": "@GuillaumeRacicot <code>&#47;usr&#47;bin&#47;lld     Error running link command: No such file or directory</code>"}, {"owner": {"reputation": 32027, "user_id": 2104697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/22ba5a5469953d6ab315e6c2c02a1ee2?s=128&d=identicon&r=PG", "display_name": "Guillaume Racicot", "link": "https://stackoverflow.com/users/2104697/guillaume-racicot"}, "edited": false, "score": 0, "creation_date": 1567005790, "post_id": 57691811, "comment_id": 101835462, "body": "@LucasZanella you have to install the clang linker then."}], "owner": {"reputation": 305, "user_id": 6655884, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/JBKc9.jpg?s=128&g=1", "display_name": "Lucas Zanella", "link": "https://stackoverflow.com/users/6655884/lucas-zanella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566993712, "creation_date": 1566993224, "last_edit_date": 1566993712, "question_id": 57691811, "link": "https://stackoverflow.com/questions/57691811/cross-compiling-with-clang-on-cmake-linker-does-not-support-armelf-linux-eabi", "title": "Cross compiling with clang on cmake, linker does not support armelf_linux_eabi", "body": "<p>Here's my cmake toolchain file to cross compile for arm linux:</p>\n\n<pre><code>set(CMAKE_SYSTEM_NAME Linux)\nset(CMAKE_SYSTEM_PROCESSOR arm)\n\nset(CLANG_TARGET_TRIPLE arm-linux-gnueabihf)\nset(GCC_ARM_TOOLCHAIN_PREFIX ${CLANG_CLANG_TARGET_TRIPLE})\nset(CMAKE_C_COMPILER clang)\nset(CMAKE_C_COMPILER_TARGET ${CLANG_TARGET_TRIPLE})\nset(CMAKE_CXX_COMPILER clang++)\nset(CMAKE_CXX_COMPILER_TARGET ${CLANG_TARGET_TRIPLE})\nset(CMAKE_ASM_COMPILER clang)\nset(CMAKE_ASM_COMPILER_TARGET ${CLANG_TARGET_TRIPLE})\n</code></pre>\n\n<p>Here's the problem when I execute cmake with it:</p>\n\n<pre><code>CMake Error at /usr/share/cmake-3.10/Modules/CMakeTestCCompiler.cmake:52 (message):\n  The C compiler\n\n    \"/usr/bin/clang\"\n\n  is not able to compile a simple test program.\n\n  It fails with the following output:\n\n    Change Dir: /home/lz/orwell/gtk/build/armlinux/CMakeFiles/CMakeTmp\n\n    Run Build Command:\"/usr/bin/make\" \"cmTC_8132a/fast\"\n    /usr/bin/make -f CMakeFiles/cmTC_8132a.dir/build.make CMakeFiles/cmTC_8132a.dir/build\n    make[1]: Entering directory '/home/lz/orwell/gtk/build/armlinux/CMakeFiles/CMakeTmp'\n    Building C object CMakeFiles/cmTC_8132a.dir/testCCompiler.c.o\n    /usr/bin/clang --target=arm-linux-gnueabihf    -o CMakeFiles/cmTC_8132a.dir/testCCompiler.c.o   -c /home/lz/orwell/gtk/build/armlinux/CMakeFiles/CMakeTmp/testCCompiler.c\n    Linking C executable cmTC_8132a\n    /usr/bin/cmake -E cmake_link_script CMakeFiles/cmTC_8132a.dir/link.txt --verbose=1\n    /usr/bin/clang --target=arm-linux-gnueabihf      -rdynamic CMakeFiles/cmTC_8132a.dir/testCCompiler.c.o  -o cmTC_8132a \n    /usr/bin/ld: unrecognised emulation mode: armelf_linux_eabi\n    Supported emulations: elf_x86_64 elf32_x86_64 elf_i386 elf_iamcu i386linux elf_l1om elf_k1om i386pep i386pe\n    clang: error: linker command failed with exit code 1 (use -v to see invocation)\n    CMakeFiles/cmTC_8132a.dir/build.make:97: recipe for target 'cmTC_8132a' failed\n    make[1]: *** [cmTC_8132a] Error 1\n    make[1]: Leaving directory '/home/lz/orwell/gtk/build/armlinux/CMakeFiles/CMakeTmp'\n    Makefile:126: recipe for target 'cmTC_8132a/fast' failed\n    make: *** [cmTC_8132a/fast] Error 2\n</code></pre>\n\n<p>It looks like it's trying to use <code>/bin/ld</code> instead of clang's linker (is there one?). I know that there exists <a href=\"https://cmake.org/cmake/help/v3.6/variable/CMAKE_LANG_COMPILER_EXTERNAL_TOOLCHAIN.html#variable:CMAKE_%3CLANG%3E_COMPILER_EXTERNAL_TOOLCHAIN\" rel=\"nofollow noreferrer\">CMAKE_LANG_COMPILER_EXTERNAL_TOOLCHAIN</a> but I don't know the path to include and preferably I didn't want to include any paths, I'd like to make it work without path specification.</p>\n\n<p>So, how to specify a compatible linker?</p>\n"}, {"tags": ["c", "operators", "rvalue", "lvalue", "unary-operator"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 3, "creation_date": 1566992754, "post_id": 57691619, "comment_id": 101827549, "body": "<code>&amp;</code> never yields an lvalue.  <code>*</code> always does."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 6982234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8459937c782218a87b7a0b7d6df841ca?s=128&d=identicon&r=PG&f=1", "display_name": "Claim Yang", "link": "https://stackoverflow.com/users/6982234/claim-yang"}, "edited": false, "score": 0, "creation_date": 1566993674, "post_id": 57691923, "comment_id": 101828074, "body": "But in both gcc &amp; clang the expression works fine, why?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 199, "user_id": 6982234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8459937c782218a87b7a0b7d6df841ca?s=128&d=identicon&r=PG&f=1", "display_name": "Claim Yang", "link": "https://stackoverflow.com/users/6982234/claim-yang"}, "edited": false, "score": 0, "creation_date": 1566993781, "post_id": 57691923, "comment_id": 101828153, "body": "@Claim Yang No, it does not work. The compiler issues an error."}, {"owner": {"reputation": 199, "user_id": 6982234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8459937c782218a87b7a0b7d6df841ca?s=128&d=identicon&r=PG&f=1", "display_name": "Claim Yang", "link": "https://stackoverflow.com/users/6982234/claim-yang"}, "edited": false, "score": 0, "creation_date": 1566994091, "post_id": 57691923, "comment_id": 101828322, "body": "Sorry, it seems that something in my question goes wrong. My expression is &quot;&amp;(*&amp;a)&quot;, and the standard 4 in your post answered my question. Thanks."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566995077, "post_id": 57691923, "comment_id": 101828887, "body": "The expression asked about in the question is <code>(*&amp;a)</code>, not <code>*&amp;a</code>."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566997639, "post_id": 57691923, "comment_id": 101830443, "body": "@EricPostpischil The parentheses do not influence on whether the expression is an lvalue or not."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1566997758, "post_id": 57691923, "comment_id": 101830510, "body": "@VladfromMoscow: Sure, but that is not a given. The compiler has to be programmed to behave that way, and the behavior is specified by the C standard. You cannot just take it as automatically true\u2014it is not automatically true, anymore than it is automatically true that <code>*</code> produces an lvalue or <code>+</code> performs addition. These things were all created, and the reasons they behave the way they do have to be explained."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1566998560, "last_edit_date": 1566998560, "creation_date": 1566993569, "answer_id": 57691923, "question_id": 57691619, "link": "https://stackoverflow.com/questions/57691619/is-a-a-lvalue-or-a-rvalue/57691923#57691923", "title": "Is (*&amp;a) a lvalue or a rvalue?", "body": "<p>This expression <code>&amp;(&amp;a)</code> is invalid and will not work.</p>\n\n<p>According to the C Stnadard</p>\n\n<blockquote>\n  <p>1 The operand of the unary &amp; operator shall be either a function\n  designator, the result of a [] or unary * operator, <strong>or an lvalue</strong>\n  that designates an object that is not a bit-field and is not declared\n  with the register storage-class specifier.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>3 The unary &amp; operator yields the address of its operand. If the\n  operand has type \u2018\u2018type\u2019\u2019, the result has type \u2018\u2018pointer to type\u2019\u2019. If\n  the operand is the result of a unary * operator, neither that operator\n  nor the &amp; operator is evaluated and the result is as if both were\n  omitted, except that the constraints on the operators still apply\n  <strong>and the result is not an lvalue.</strong></p>\n</blockquote>\n\n<p>So the result of the expression <code>&amp;a</code> is not an lvalue. So you may not apply the operator <code>&amp;</code> to the expression like <code>&amp;&amp;a</code>.</p>\n\n<p>Here is a demonstrative program.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    int x = 10;\n    &amp;( &amp;x );\n\n    return 0;\n}\n</code></pre>\n\n<p>The compiler gcc 8.3 issues an error</p>\n\n<pre><code>prog.c: In function \u2018main\u2019:\nprog.c:7:2: error: lvalue required as unary \u2018&amp;\u2019 operand\n  &amp;( &amp;x );\n  ^\n</code></pre>\n\n<p>This expression <code>*&amp;a</code> is valid and the result is an lvalue.</p>\n\n<blockquote>\n  <p>4 The unary * operator denotes indirection. If the operand points to a\n  function, the result is a function designator; <strong>if it points to an\n  object, the result is an lvalue designating the object</strong>. If the\n  operand has type \u2018\u2018pointer to type\u2019\u2019, the result has type \u2018\u2018type\u2019\u2019. If\n  an invalid value has been assigned to the pointer, the behavior of the\n  unary * operator is undefined.</p>\n</blockquote>\n\n<p>Bear in mind that parentheses do not influence on whether the enclosed expression is an lvalue or not. </p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 1, "last_activity_date": 1566995059, "creation_date": 1566995059, "answer_id": 57692361, "question_id": 57691619, "link": "https://stackoverflow.com/questions/57691619/is-a-a-lvalue-or-a-rvalue/57692361#57692361", "title": "Is (*&amp;a) a lvalue or a rvalue?", "body": "<p>Per C 2018 6.5.3.2 4 (discussing the <code>unary *</code> operator), the result of unary <code>*</code> is an lvalue:</p>\n\n<blockquote>\n  <p>\u2026 If the operand points to a function, the result is a function designator; if it points to an object, the result is an lvalue designating the object.\u2026</p>\n</blockquote>\n\n<p>This tells us that <code>*&amp;a</code> is an lvalue. However, the expression asked about in the question is <code>(*&amp;a)</code>, so we must consider the effect of the parentheses.</p>\n\n<p>6.3.2.1 2 (discussing automatic conversions) seems to tell us that <code>(*&amp;a)</code> is converted to the value in <code>*&amp;a</code> and is not an lvalue:</p>\n\n<blockquote>\n  <p>Except when it is the operand of the sizeof operator, the unary <code>&amp;</code> operator, the <code>++</code> operator, the <code>--</code> operator, or the left operand of the <code>.</code> operator or an assignment operator, an lvalue that does not have array type is converted to the value stored in the designated object (and is no longer an lvalue); this is called <em>lvalue conversion</em>.</p>\n</blockquote>\n\n<p>However, 6.5.1 5 (discussing parenthesized expressions) contradicts this:</p>\n\n<blockquote>\n  <p>A parenthesized expression is a primary expression. Its type and value are identical to those of the unparenthesized expression. It is an lvalue, a function designator, or a void expression if the unparenthesized expression is, respectively, an lvalue, a function designator, or a void expression.</p>\n</blockquote>\n\n<p>This is a defect in the C standard; 6.5.1 5 and 6.3.2.1 2 contradict each other. It is left to us to understand that 6.5.1 5, which is specifically about parenthesized expressions, takes precedence over the more general 6.3.2.1 2, and this is how all C implementations behave.</p>\n\n<p>Thus <code>(*&amp;a)</code> is an lvalue.</p>\n"}], "owner": {"reputation": 199, "user_id": 6982234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8459937c782218a87b7a0b7d6df841ca?s=128&d=identicon&r=PG&f=1", "display_name": "Claim Yang", "link": "https://stackoverflow.com/users/6982234/claim-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 57692361, "answer_count": 2, "score": 1, "last_activity_date": 1566998560, "creation_date": 1566992560, "last_edit_date": 1566994018, "question_id": 57691619, "link": "https://stackoverflow.com/questions/57691619/is-a-a-lvalue-or-a-rvalue", "title": "Is (*&amp;a) a lvalue or a rvalue?", "body": "<p>First of all, I think it's a <code>rvalue</code>, but the following fact changed my mind.</p>\n\n<p>I tried an expression as <code>&amp;(*&amp;a)</code> and it works fine, but the operator <code>&amp;</code> can just work with a <code>lvalue</code>, so <code>(*&amp;a)</code> is a <code>lvalue</code>, why? </p>\n"}, {"tags": ["c", "hex"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1566991290, "post_id": 57691147, "comment_id": 101826723, "body": "use <code>unsigned char</code>. Also your multiplication is off, it should be <code>1677216</code>, <code>65536</code> and <code>256</code>. And lastly you should use bitshifts instead."}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567005800, "post_id": 57691429, "comment_id": 101835468, "body": "Explanation?..."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1567006292, "post_id": 57691429, "comment_id": 101835774, "body": "You can still <a href=\"https://stackoverflow.com/posts/57691429/edit\">edit your answer</a> and provide more details."}], "tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": true, "score": -1, "last_activity_date": 1566991951, "creation_date": 1566991951, "answer_id": 57691429, "question_id": 57691147, "link": "https://stackoverflow.com/questions/57691147/how-can-i-convert-hexadecimal-bytes-0x00-0x03-0x9e-0x40-to-int-for-calculat/57691429#57691429", "title": "How can I convert hexadecimal bytes {0x00, 0x03, 0x9e, 0x40} to int for calculation in c?", "body": "<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char recv[4] = {0x00, 0x03, 0x9e, 0x40};\n    unsigned int result;\n\n    result = ((unsigned char)recv[0] &lt;&lt; 24) | \n             ((unsigned char)recv[1] &lt;&lt; 16) |\n             ((unsigned char)recv[2] &lt;&lt;  8) |\n             ((unsigned char)recv[3] &lt;&lt;  0);\n\n    printf(\"0x%08X\\n\", result);\n\n    return 0;\n}\n</code></pre>\n\n<h3>Output</h3>\n\n<p>(<a href=\"http://ideone.com/Q6yCOq\" rel=\"nofollow noreferrer\">link</a>)</p>\n\n<pre><code>Success #stdin #stdout 0s 4568KB\n0x00039E40\n</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 6568711, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_KTFW10mcQs/AAAAAAAAAAI/AAAAAAAAAE0/q6IKQa_IV20/photo.jpg?sz=128", "display_name": "steinacoz", "link": "https://stackoverflow.com/users/6568711/steinacoz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "closed_date": 1566991312, "accepted_answer_id": 57691429, "answer_count": 1, "score": 0, "last_activity_date": 1566991951, "creation_date": 1566991011, "question_id": 57691147, "link": "https://stackoverflow.com/questions/57691147/how-can-i-convert-hexadecimal-bytes-0x00-0x03-0x9e-0x40-to-int-for-calculat", "closed_reason": "Duplicate", "title": "How can I convert hexadecimal bytes {0x00, 0x03, 0x9e, 0x40} to int for calculation in c?", "body": "<p>I am having issues converting hexadecimal bytes to int so as to calculate the sum.</p>\n\n<p>I have this hexadecimal bytes in a char array but I am having issues converting them to decimal(int) and summing all of them. here is some lines of code:</p>\n\n<pre><code>int main() {\n\n  char recv[4] = {0x00, 0x03, 0x9e, 0x40};\n\n  int d1 = recv[0] * 256;\n  int d2 = recv[1] * 256;\n  int d3 = recv[2] * 256;\n  int d4 = recv[3] * 1;\n\n  int dt = d1 + d2 + d3 + d4; \n\n  printf(\"d1: %d\\n\", d1);\n  printf(\"d2: %d\\n\", d2);\n  printf(\"d3: %d\\n\", d3);\n  printf(\"d4: %d\\n\", d4);\n\n  printf(\"sum is: %d\\n\", dt);\n\n\n  return 0;\n</code></pre>\n\n<p>This is the result I am getting:</p>\n\n<pre><code>d1: 0\nd2: 768\nd3: -25088\nd4: 64\nsum is: -24256\n</code></pre>\n"}, {"tags": ["c", "rest", "tcp", "arduino", "esp8266"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11903616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7207b845699b546ab271bab5e2b0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/11903616/raphael"}, "edited": false, "score": 0, "creation_date": 1567004008, "post_id": 57692415, "comment_id": 101834409, "body": "Thank you mate! Can you explain to me what does it do? I would like to change it to a POST."}, {"owner": {"reputation": 47, "user_id": 11903616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7207b845699b546ab271bab5e2b0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/11903616/raphael"}, "edited": false, "score": 0, "creation_date": 1567009432, "post_id": 57692415, "comment_id": 101837401, "body": "I think that the big problem is how my url to do the POST is constructed"}], "tags": [], "owner": {"reputation": 366, "user_id": 10993861, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wsfh15C_D14/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQNyxBJQhJ_mrACHmtd184GjR2YFvw/mo/photo.jpg?sz=128", "display_name": "Arun P", "link": "https://stackoverflow.com/users/10993861/arun-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1566995218, "creation_date": 1566995218, "answer_id": 57692415, "question_id": 57690525, "link": "https://stackoverflow.com/questions/57690525/arduino-gets-response-from-server-problem/57692415#57692415", "title": "Arduino gets response from server problem", "body": "<p>Try this code.</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n\nconst byte rxPin = 2;\nconst byte txPin = 3;\n\nSoftwareSerial ESP8266 (rxPin, txPin);\n\nunsigned long lastTimeMillis = 0;\n\nvoid setup() {\n  Serial.begin(9600);   \n  ESP8266.begin(9600);\n  delay(2000);\n}\n\nvoid printResponse() {\n  while (ESP8266.available()) {\n    Serial.println(ESP8266.readStringUntil('\\n')); \n  }\n}\n\nvoid loop() {\n\n  if (millis() - lastTimeMillis &gt; 30000) {\n    lastTimeMillis = millis();\n\n    ESP8266.println(\"AT+CIPMUX=1\");\n    delay(1000);\n    printResponse();\n\n    ESP8266.println(\"AT+CIPSTART=4,\\\"TCP\\\",\\\"192.168.1.19\\\",80\");\n    delay(1000);\n    printResponse();\n\n    String cmd = \"GET /test.html HTTP/1.1\";\n    ESP8266.println(\"AT+CIPSEND=4,\" + String(cmd.length() + 4));\n    delay(1000);\n\n    ESP8266.println(cmd);\n    delay(1000);\n    ESP8266.println(\"\"); \n  }\n\n  if (ESP8266.available()) {\n    Serial.write(ESP8266.read());\n  }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11903616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7207b845699b546ab271bab5e2b0ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Raphael", "link": "https://stackoverflow.com/users/11903616/raphael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566995218, "creation_date": 1566988795, "question_id": 57690525, "link": "https://stackoverflow.com/questions/57690525/arduino-gets-response-from-server-problem", "title": "Arduino gets response from server problem", "body": "<p>I'm using an ESP8266 connected to an Arduino Uno via SoftwareSerial to make a post request to an API. The ESP8266 is able to connect to a WIFI connection. When I try to send some data (temperatures values captured by the module DHT22) to the server I always get a access denied. It always happens when the command <em>\"esp.println(tcpstart)\"</em> is executed and I receive the response <em>\"--> Cannot initiate TCP connection\"</em> in the Serial Monitor thanks to the prints I added. <em>\"tcpstart\"</em> is the AT command <strong><em>\"AT+CIPSTART\"</em></strong>. The Arduino Uno is flashed with the firmware: ai-thinker-0.9.5.2-115200.bin.\nThis is my code:</p>\n\n<pre><code>#include &lt;SoftwareSerial.h&gt;\n#include &lt;DHT.h&gt;;\n#define RX_PIN 2\n#define TX_PIN 3\n#define DHTTYPE DHT22\n#define DHTPIN  7\n\nSoftwareSerial esp(RX_PIN, TX_PIN); // Rx,  Tx\nDHT dht(DHTPIN, DHTTYPE);\nfloat temp;\nString ssid = \"XXXXX\";\nString pass = \"YYYYY\";\n//Complete API URL to do the post: https://api.test.com:bbbb/zzz/zzzz/v2/z?zzzzzzz\nString server = \"https://api.test.com\";\nString ip = \"aa.aaa.aa.aa\";\nint port = bbbb;\nString uri = \"/zzz/zzzz/v2/z?zzzzzzz\";\nbool connection;\nString data;\nString* response;\n\nvoid setup(){\n  Serial.begin(9600);\n  esp.begin(115200);\n  esp.setTimeout(5000);\n  dht.begin();\n}\n\nvoid loop(){\n  reset();\n  readSensors();\n  while(connection == false)\n    connectWifi();\n  connection = false;\n  httppost();\n}\n\nvoid readSensors(){\n  temp = dht.readTemperature();\n  data = String(temp);\n}\n\nvoid reset(){\n  esp.println(\"AT+RST\");\n  delay(300);\n  esp.println(\"AT+CWMODE=1\");\n  delay(300);\n  esp.println(\"AT+RST\");\n  delay(300);\n  esp.println(\"AT+CIPMUX=0\");\n  delay(300);\n}\n\nvoid connectWifi(){\n  String cmd = \"AT+CWJAP=\\\"\" + ssid + \"\\\",\\\"\" + pass + \"\\\"\";\n  delay(300);\n  esp.println(cmd);\n  if(esp.find(\"OK\")){\n    Serial.println(\"Wifi Connected\");\n    connection = true;\n  }else{\n    Serial.println(\"--&gt; Wifi not Connected\");\n    connection = false;\n  }\n}\n\nvoid httppost(){\n  String postRequest =\n        \"POST \" + uri + \" HTTP/1.1\\r\\n\" +\n        \"Host: \" + server + \":\" + port + \"\\r\\n\" +\n        \"Accept: *\" \"/\" \"*\\r\\n\" +\n        \"Content-Length: \" + data.length() + \"\\r\\n\" +\n        \"Content-Type: application/x-www-form-urlencoded\\r\\n\" +\n        \"\\r\\n\" +\n        data;\n  String tcpStart = \"AT+CIPSTART=\\\"TCP\\\",\\\"\" + ip + \"\\\",\" + port;\n  String sendCmd = \"AT+CIPSEND=\" + postRequest.length();\n  esp.println(tcpStart); //start TCP connection\n  delay(300);\n  if(esp.find(\"OK\")){\n    Serial.println(\"TCP connection OK\");\n    esp.println(sendCmd); //send the data over TCP connection\n    delay(300);\n    if(esp.find(\"&gt;\")){\n      Serial.println(\"Sending packet\");\n      esp.println(postRequest);\n      delay(300);\n      if(esp.find(\"SEND OK\")){\n        Serial.println(\"Packet sent\");\n        while(esp.available()){ //number of bytes/char available for reading\n          char tmpResp = esp.read(); //read one char at the time\n          Serial.print(tmpResp);\n          if (tmpResp == '\\0') continue; //terminate the while when end of the data\n        }\n        esp.println(\"AT+CIPCLOSE\"); //close TCP connection\n      }else{\n        Serial.println(\"--&gt; An error occured while sending packet\");\n      }\n    }else{\n        Serial.println(\"--&gt; ESP8266 is not listening for incoming data\");\n    }\n  }else{\n    Serial.println(\"--&gt; Cannot initiate TCP connection\");\n  }\n}\n</code></pre>\n\n<p>Do you have an idea of the problem it might be?</p>\n"}, {"tags": ["c", "include"], "comments": [{"owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "edited": false, "score": 0, "creation_date": 1566986982, "post_id": 57689925, "comment_id": 101824465, "body": "What command are you using to compile?"}, {"owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "edited": false, "score": 0, "creation_date": 1566987104, "post_id": 57689925, "comment_id": 101824528, "body": "Where is <code>board</code> defined in <code>main.c</code>?"}, {"owner": {"reputation": 15754, "user_id": 9835872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PN0Lq.jpg?s=128&g=1", "display_name": "ruohola", "link": "https://stackoverflow.com/users/9835872/ruohola"}, "edited": false, "score": 0, "creation_date": 1566987113, "post_id": 57689925, "comment_id": 101824534, "body": "Where is <code>Board</code> defined?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566989062, "post_id": 57689925, "comment_id": 101825609, "body": "Please read compiler warnings. This would warn you for implicit function declaration."}], "answers": [{"comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1566988080, "post_id": 57690000, "comment_id": 101825044, "body": "When answers are as simple as this, please post as a comment instead. It makes it easier to remove the question later."}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566988143, "post_id": 57690000, "comment_id": 101825076, "body": "@klutt Why would the question be removed later?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566988287, "post_id": 57690000, "comment_id": 101825158, "body": "@trojanfoe Because questions where the problem is a simple typo in general is of no use to future readers. This question is likely to be closed for &quot;simple typographical error&quot;"}, {"owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566988392, "post_id": 57690000, "comment_id": 101825205, "body": "@klutt Well I think referencing a missing symbol because of mis-spelling is of use to future readers, so I am happy if the question remains."}], "tags": [], "owner": {"reputation": 115642, "user_id": 299924, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/71fc84230717311db1410d7106273128?s=128&d=identicon&r=PG", "display_name": "trojanfoe", "link": "https://stackoverflow.com/users/299924/trojanfoe"}, "is_accepted": true, "score": 2, "last_activity_date": 1566987129, "creation_date": 1566987129, "answer_id": 57690000, "question_id": 57689925, "link": "https://stackoverflow.com/questions/57689925/error-linker-command-failed-with-exit-code-1/57690000#57690000", "title": "error: linker command failed with exit code 1", "body": "<p>Typo:</p>\n\n<pre><code>int main(int argc, char *argv[]) {\n    SetVal(board, 1, 0, 6);\n//  ^\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5139592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/511828cf8431233747dbe614d80c8df3?s=128&d=identicon&r=PG&f=1", "display_name": "adif", "link": "https://stackoverflow.com/users/5139592/adif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "closed_date": 1566990248, "accepted_answer_id": 57690000, "answer_count": 1, "score": 0, "last_activity_date": 1566987129, "creation_date": 1566986863, "last_edit_date": 1566986961, "question_id": 57689925, "link": "https://stackoverflow.com/questions/57689925/error-linker-command-failed-with-exit-code-1", "closed_reason": "Not suitable for this site", "title": "error: linker command failed with exit code 1", "body": "<p>I get the error:</p>\n\n<pre><code>ndefined symbols for architecture x86_64:\n  \"_setVal\", referenced from:\n      _main in main.o\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1\n</code></pre>\n\n<p>I looked up other posts but nothing seems so solve the problem.\nI think that I used include properly.</p>\n\n<p>main.c:</p>\n\n<pre><code>#include \"game.h\"\n\nint main(int argc, char *argv[]) {\nsetVal(board, 1, 0, 6);\n}\n</code></pre>\n\n<p>game.h:</p>\n\n<pre><code>#ifndef GAME_H_\n#define GAME_H_\n\nbool SetVal(Board* board, int row, int col, int value);\n\n#endif\n</code></pre>\n\n<p>game.c:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>#include \"game.h\"\n\nbool SetVal(Board* board, int row, int col, int value){\n// code in here\n}\n</code></pre>\n\n<p>What can be cause of the error?\nThank you.</p>\n"}, {"tags": ["python", "c", "ctypes"], "comments": [{"owner": {"reputation": 120, "user_id": 11796570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HmeF1.jpg?s=128&g=1", "display_name": "Akhilesh Sharma", "link": "https://stackoverflow.com/users/11796570/akhilesh-sharma"}, "edited": false, "score": 0, "creation_date": 1566986996, "post_id": 57689875, "comment_id": 101824474, "body": "Memory address formatting in Python is different than that of C. Try reformatting the memory address that you get form SDK"}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1566987104, "post_id": 57689875, "comment_id": 101824527, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52268294/python-ctypes-cdll-loadlibrary-instantiate-an-object-execute-its-method-priva\">Python ctypes cdll.LoadLibrary, instantiate an object, execute its method, private variable address truncated</a>.  Add <code>api.Detect.argtypes = [ctypes.c_void_p]</code>. Also, <i>Detect</i> prototype in <i>C</i> is incorrect. It should be: <code>void Detect(ModelHandle *sdk);</code>"}], "owner": {"reputation": 1, "user_id": 4599673, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ntQE1HTnaLE/AAAAAAAAAAI/AAAAAAAAAC0/CWfshOE1ND4/photo.jpg?sz=128", "display_name": "\u5f20\u9752\u6797", "link": "https://stackoverflow.com/users/4599673/%e5%bc%a0%e9%9d%92%e6%9e%97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566986699, "creation_date": 1566986699, "question_id": 57689875, "link": "https://stackoverflow.com/questions/57689875/why-i-get-wrong-addres-from-c-function-using-ctypes-in-python", "title": "Why I get wrong addres from C function using ctypes in Python", "body": "<p>I call C function in python using ctypes,but Python can't get correct address passed by C function.</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import ctypes\n\nif __name__ == '__main__':\n    api = ctypes.CDLL('path_to_my_so')\n    api.CreateSDK.restype = ctypes.c_void_p\n    context = api.CreateSDK()\n\n    print (context)\n    print (ctypes.c_void_p(context).value)\n    api.Detect(context)\n</code></pre>\n\n<pre><code>#include \"sdk.h\"\n#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass SDK{\npublic:\n    SDK():data(100){};\n    int data;\n};\n\nModelHandle CreateSDK(){\n    ModelHandle sdk = new SDK();\n    cerr &lt;&lt; \"address of sdk to give:\" &lt;&lt; sdk &lt;&lt; endl;\n    return sdk;\n}\n\nvoid Detect(ModelHandle sdk){\n    cerr &lt;&lt; \"address of given sdk:\" &lt;&lt; sdk &lt;&lt; endl;\n    cerr &lt;&lt; static_cast&lt;SDK*&gt;(sdk)-&gt;data &lt;&lt; endl;\n}\n</code></pre>\n\n<pre><code>#pragma once\n\nextern \"C\"{\n    typedef void* ModelHandle;\n\n    ModelHandle CreateSDK();\n\n    void Detect(ModelHandle sdk);\n}\n</code></pre>\n\n<p>I excpet address output by C are the same,but here is the thing I got:</p>\n\n<p>94731076196768</p>\n\n<p>94731076196768</p>\n\n<p>address of sdk to give:0x56284c2559a0</p>\n\n<p>address of given sdk:0x4c2559a0</p>\n"}, {"tags": ["c", "visual-studio-code"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1566986440, "post_id": 57689617, "comment_id": 101824130, "body": "Did you choose &quot;console application&quot; as the project type?"}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": false, "score": 1, "last_activity_date": 1566992858, "creation_date": 1566992858, "answer_id": 57691712, "question_id": 57689617, "link": "https://stackoverflow.com/questions/57689617/error-while-compiling-c-program-in-visual-studio-code/57691712#57691712", "title": "Error while compiling C program in Visual Studio Code", "body": "<p>There is a difference between <strong>console application</strong> and <strong>Win32 application</strong>. You chose the latter but programmed the former.</p>\n\n<p>A console application has a main function called <code>main</code>.</p>\n\n<p>A Win32 application has a main function called <code>WinMain</code>; the linker misses it so it bails out.</p>\n\n<p>Actually a Win32 application has a main function called <code>main</code>, too. But it is provided by the library it is linked with, and it calls <code>WinMain</code> after preparing some Win32 stuff.</p>\n"}], "owner": {"reputation": 9, "user_id": 7268562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70953e3b04e3d3db253629b024e6922a?s=128&d=identicon&r=PG&f=1", "display_name": "Chaitanya", "link": "https://stackoverflow.com/users/7268562/chaitanya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566992858, "creation_date": 1566985963, "last_edit_date": 1566986333, "question_id": 57689617, "link": "https://stackoverflow.com/questions/57689617/error-while-compiling-c-program-in-visual-studio-code", "title": "Error while compiling C program in Visual Studio Code", "body": "<p>I have written a basic program in C language in the editor of Visual Studio Code but I am getting the following error while trying to compile it.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    printf(\"Hello World\");\n    return 0;\n}\n</code></pre>\n\n<p>I am getting the following error message:</p>\n\n<blockquote>\n<pre><code>[Running] cd \"c:\\Users\\Chaitanya\\Documents\\initial\\\" &amp;&amp; gcc pro1.c -o\npro1 &amp;&amp; \"c:\\Users\\Chaitanya\\Documents\\initial\\\"pro1\nc:/mingw/bin/../lib/gcc/mingw32/8.2.0/../../../../mingw32/bin/ld.exe:\nc:/mingw/bin/../lib/gcc/mingw32/8.2.0/../../../libmingw32.a(main.o):(.text.startup+0xb0):\nundefined reference to `WinMain@16' collect2.exe: error: ld returned 1\nexit status\n     [Done] exited with code=1 in 0.198 seconds\n</code></pre>\n</blockquote>\n"}, {"tags": ["c++", "c", "tcl"], "comments": [{"owner": {"reputation": 1125, "user_id": 11042630, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uj0vR.png?s=128&g=1", "display_name": "skratchi.at", "link": "https://stackoverflow.com/users/11042630/skratchi-at"}, "edited": false, "score": 0, "creation_date": 1566984615, "post_id": 57689172, "comment_id": 101823130, "body": "Please have a quick checkup with the articles in the help section and rephrase and format your question. Your question is unreadable, sry"}], "answers": [{"tags": [], "owner": {"reputation": 119001, "user_id": 301832, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/965220a70d38e6a29466f44cdb4f804e?s=128&d=identicon&r=PG", "display_name": "Donal Fellows", "link": "https://stackoverflow.com/users/301832/donal-fellows"}, "is_accepted": true, "score": 1, "last_activity_date": 1566985451, "creation_date": 1566985451, "answer_id": 57689441, "question_id": 57689172, "link": "https://stackoverflow.com/questions/57689172/when-redirecting-output-of-a-command-in-tcl-to-file-file-is-getting-generated-i/57689441#57689441", "title": "When Redirecting output of a command in Tcl to file, file is getting generated in DOS format", "body": "<p>Tcl lets you control the line ending conversion for a channel (file handle, socket, etc.) using the <code>chan configure</code> command (also called <code>fconfigure</code>). In particular, you want to configure the <code>-translation</code> option to be either <code>lf</code> (for use line-feeds) or <code>binary</code> (which sets a few other things as well). Tcl <em>ignores</em> the setting in C stdio, as it accesses the OS directly to do I/O, and the line ending translation isn't done at that point.</p>\n\n<p>Put one of these in your script, depending on what exactly you're doing:</p>\n\n<pre><code>chan configure stdout -translation lf\n</code></pre>\n\n<pre><code>chan configure stdout -translation binary\n</code></pre>\n\n<p>You can also set the channel translation from C:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/* Guess what 'chan configure' is a wrapper around? */\nTcl_SetChannelOption(interp, stdoutChannel, \"-translation\", \"binary\");\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9567390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fa37ec5967b70625137847bb535d566?s=128&d=identicon&r=PG&f=1", "display_name": "mehak", "link": "https://stackoverflow.com/users/9567390/mehak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1567001059, "accepted_answer_id": 57689441, "answer_count": 1, "score": 0, "last_activity_date": 1566985451, "creation_date": 1566984531, "last_edit_date": 1566984642, "question_id": 57689172, "link": "https://stackoverflow.com/questions/57689172/when-redirecting-output-of-a-command-in-tcl-to-file-file-is-getting-generated-i", "closed_reason": "Needs details or clarity", "title": "When Redirecting output of a command in Tcl to file, file is getting generated in DOS format", "body": "<p>I want to develop a command 'redirect' in Tcl, which takes as an argument command to be executed and redirects output of command to the file provided by the user. I am using below code and it is working well. The only problem with  this code is that the file is getting created in DOS format. How do i get rid of this as the format should be Unix style not DOS?</p>\n\n<p>I tried setting :set binary in VI editor and other workarounds as\nvim +\"argdo setlocal ff=unix\" +wqa \nHowever, it could not find any reason why is this file getting created in DOS format. </p>\n\n<pre><code>Tcl_Channel stdoutChannel = Tcl_GetStdChannel(TCL_STDOUT);\n\nTcl_Channel stderrChannel = Tcl_GetStdChannel(TCL_STDERR);\n\nif(stdoutChannel) {\n\n  Tcl_Flush(stdoutChannel);\n\n}\n\nif(stderrChannel) {\n\n  Tcl_Flush(stderrChannel);\n\n}\n\nFILE* filePtr = fopen(filename, \"wb\");\n\nint pfd = fileno(filePtr);\n\nint saved = dup(1);\n\nclose(1);\n\nTcl_Obj* commandResult = Tcl_NewStringObj(command,strlen(command));\n\ndup2(pfd,STDOUT_FILENO);\n\nTcl_EvalObj(TBXslaveInterp,commandResult);\n\nclose(pfd);\n\nfflush(stdout);\n\n// restore it back\n\ndup2(saved, 1);\n\nclose(saved);\n\nreturn TCL_OK;\n</code></pre>\n\n<h2>OUTPUT</h2>\n\n<pre><code>Command executed : \nredirect myfile {puts \"Inside Tcl\"}\n\nViewing File in VI at the bottom shows:\n\n\"myfile\" [dos] 1L, 12C\n\n\n cat myfile \n\n Inside Tcl^M\n</code></pre>\n\n<p>Notice ^M is printed when cat operation performed. This is because of the DOS style format in which the file is saved.</p>\n"}, {"tags": ["c", "character-encoding", "codeblocks"], "comments": [{"owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "edited": false, "score": 0, "creation_date": 1566993038, "post_id": 57689160, "comment_id": 101827714, "body": "Check with another editor what encoding your unmodified source file uses. Then change this to UTF-8, at best this editor can do this. After that I would expect that CodeBlocks will not moan and instead show all characters."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 9071172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eI8I0.jpg?s=128&g=1", "display_name": "Umit Terzi", "link": "https://stackoverflow.com/users/9071172/umit-terzi"}, "is_accepted": false, "score": 0, "last_activity_date": 1577361935, "creation_date": 1577361935, "answer_id": 59488230, "question_id": 57689160, "link": "https://stackoverflow.com/questions/57689160/codeblocks-not-showing-turkish-characters/59488230#59488230", "title": "CodeBlocks not showing Turkish characters", "body": "<p>setlocale(LC_ALL, \"Turkish\");</p>\n\n<p>Denermisin ? </p>\n"}], "owner": {"reputation": 23, "user_id": 11849077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645edc851cd576c22694084786dd3760?s=128&d=identicon&r=PG&f=1", "display_name": "Crazy Programmer", "link": "https://stackoverflow.com/users/11849077/crazy-programmer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1577361935, "creation_date": 1566984496, "last_edit_date": 1567000241, "question_id": 57689160, "link": "https://stackoverflow.com/questions/57689160/codeblocks-not-showing-turkish-characters", "title": "CodeBlocks not showing Turkish characters", "body": "<p>I have changed my IDE DevC++ to CodeBlocks. My project include Turkish characters. When using DevC ++, Turkish characters were display. But I changed my IDE DevC++ to CodeBlocks, Turkish character not showing them. CodeBlocks show error message \"ENCODING CHANGED. The saved document contained characters which were illegal in the selected encoding. The file's encoding has been changed to UTF-8 to prevent you from losing data.\" </p>\n\n<p>Please help me. Thanks :)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n#include &lt;locale.h&gt;\n\nvoid duzenDegistir(char *dizi, int boy){\n    srand(time(NULL));\n    int i,a;\n    char *temp;\n\n    for(i=0;i&lt;boy;i++){\n        a=rand()%boy;\n        *temp=dizi[i];\n        dizi[i]=dizi[a];\n        dizi[a]=*temp;\n    }\n\n    dizi[i+1]='\\0';\n}\n\n\n\nint main(){\n\n    setlocale(LC_ALL, \"\");\n    srand((unsigned int)(time(NULL)));\n    int k_sayi,i,lang;\n    char kucuk_harf[26]=\"abcdefghijklmnoprstuvwxyz\";\n    char buyuk_harf[26]=\"ABCDEFGHIJKLMNOPRSTUVWXYZ\";\n    char sayilar[11]=\"1234567890\";\n    char ozel_karakter[13]=\"!'^+%&amp;/=?_*\";\n    char *pass, *p;\n    char kontrol_buyuk, kontrol_sayi, kontrol_okarakter, secim, duzen;\n\n    printf(\"Please select the language: (en: 1 /tr: 2): \");\n    scanf(\"%d\",&amp;lang);\n\n\n    if(lang==1){\n\n        do{\n\n\n    printf(\"How many characters can the password ?: \");\n    scanf(\"%d\",&amp;k_sayi);\n\n    printf(\"Upper-case letter? (y/n): \");\n    scanf(\" %c\",&amp;kontrol_buyuk);\n\n    printf(\"Numbers? (y/n): \");\n    scanf(\" %c\",&amp;kontrol_sayi);\n\n    printf(\"Special characthers?: \");\n    scanf(\" %c\", &amp;kontrol_okarakter);\n\n    pass=(char *)malloc(k_sayi*sizeof(char));\n\n    if(kontrol_buyuk=='y'&amp;&amp;kontrol_sayi=='y'&amp;&amp;kontrol_okarakter=='y'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n            while(i%2==1){\n                pass[i]=buyuk_harf[rand()%(sizeof buyuk_harf-1)];\n                break;\n            }\n\n            while(i%3==2){\n                pass[i]=sayilar[rand()%(sizeof sayilar-1)];\n                break;\n            }\n\n            while(i%(k_sayi-2)==2){\n                pass[i]=ozel_karakter[rand()%(sizeof ozel_karakter-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='n'&amp;&amp;kontrol_sayi=='y'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n\n            while(i%3==2){\n                pass[i]=sayilar[rand()%(sizeof sayilar-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='y'&amp;&amp;kontrol_sayi=='n'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n            while(i%2==1){\n                pass[i]=buyuk_harf[rand()%(sizeof buyuk_harf-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='n'&amp;&amp;kontrol_sayi=='n'){\n        printf(\"This option will generate a low-security password. You should not forget the upper-case letters and numbers in your passwords ...\\n\");\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n\n    }\n    }\n\n\n\n\n    pass[i]='\\0'; // Son indisteki i\u00e7eri\u011fi NULL'a e\u015fitledim ki dizginin sonunu belirtelim.\n    printf(\"\\n\\n==&gt; Your Password: %s\\n\\n\",pass);\n    printf(\"Would you like to change the password layout? (y/n): \");\n    scanf(\" %c\",&amp;duzen);\n    if(duzen=='y'){\n        while(duzen=='y'){\n            duzenDegistir(pass, k_sayi);\n            printf(\"%s\\n\",pass);\n            printf(\"Would you like to change the password layout again? (y/n): \");\n            scanf(\" %c\",&amp;duzen);\n        }\n\n\n    }\n\n\n    free(pass);\n    printf(\"\\nWould you like to create the new password? (y/n): \");\n    scanf(\" %c\",&amp;secim);\n\n    if(secim=='n'){\n        printf(\"\\n\\nRemember to keep your passwords and change them frequently. See you again...\\n\\n\");\n    }\n\n\n    }while(secim=='y');\n\n    }\n\n\n\n    if(lang==2){\n\n        do{\n\n\n    printf(\"Parola ka\u00e7 karakterli olsun?: \");\n    scanf(\"%d\",&amp;k_sayi);\n\n    printf(\"B\u00fcy\u00fck harf olsun mu? (y/n): \");\n    scanf(\" %c\",&amp;kontrol_buyuk);\n\n    printf(\"Say\u0131 olsun mu? (y/n): \");\n    scanf(\" %c\",&amp;kontrol_sayi);\n\n    printf(\"\u00d6zel karakter olsun mu?: \");\n    scanf(\" %c\", &amp;kontrol_okarakter);\n\n    pass=(char *)malloc(k_sayi*sizeof(char));\n\n    if(kontrol_buyuk=='y'&amp;&amp;kontrol_sayi=='y'&amp;&amp;kontrol_okarakter=='y'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n            while(i%2==1){\n                pass[i]=buyuk_harf[rand()%(sizeof buyuk_harf-1)];\n                break;\n            }\n\n            while(i%3==2){\n                pass[i]=sayilar[rand()%(sizeof sayilar-1)];\n                break;\n            }\n\n            while(i%(k_sayi-2)==2){\n                pass[i]=ozel_karakter[rand()%(sizeof ozel_karakter-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='n'&amp;&amp;kontrol_sayi=='y'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n\n            while(i%3==2){\n                pass[i]=sayilar[rand()%(sizeof sayilar-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='y'&amp;&amp;kontrol_sayi=='n'){\n\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n        if(i&gt;1){\n            while(i%2==1){\n                pass[i]=buyuk_harf[rand()%(sizeof buyuk_harf-1)];\n                break;\n            }\n\n        }\n\n    }\n    }\n\n    if(kontrol_buyuk=='n'&amp;&amp;kontrol_sayi=='n'){\n        printf(\"Bu se\u00e7enek d\u00fc\u015f\u00fck g\u00fcvenlikli parola olu\u015fturacakt\u0131r. Parolalar\u0131n\u0131zda b\u00fcy\u00fck harf ve say\u0131y\u0131 ihmal etmemelisiniz...\\n\");\n        for(i=0;i&lt;k_sayi;i++){\n        pass[i]=kucuk_harf[rand()%(sizeof kucuk_harf-1)];\n\n    }\n    }\n\n\n\n\n    pass[i]='\\0'; // Son indisteki i\u00e7eri\u011fi NULL'a e\u015fitledim ki dizginin sonunu belirtelim.\n    printf(\"\\n\\n==&gt; Parolan\u0131z: %s\\n\\n\",pass);\n    printf(\"Parola d\u00fczenini de\u011fi\u015ftirmek ister misiniz? (y/n): \");\n    scanf(\" %c\",&amp;duzen);\n    if(duzen=='y'){\n        while(duzen=='y'){\n            duzenDegistir(pass, k_sayi);\n            printf(\"%s\\n\",pass);\n            printf(\"Parola d\u00fczenini tekrar de\u011fi\u015ftirmek istermisiniz? (y/n): \");\n            scanf(\" %c\",&amp;duzen);\n        }\n\n\n    }\n\n\n    free(pass);\n    printf(\"\\nYeni parola olu\u015fturmak ister misiniz? (y/n): \");\n    scanf(\" %c\",&amp;secim);\n\n    if(secim=='n'){\n        printf(\"\\n\\nParolalar\u0131n\u0131z\u0131 saklamay\u0131 ve s\u0131k s\u0131k de\u011fi\u015ftirmeyi unutmay\u0131n\u0131z...\\n\\n\");\n    }\n\n\n    }while(secim=='y');\n\n    }\n\n\n\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "scanf", "strlen"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 1, "creation_date": 1566983684, "post_id": 57688887, "comment_id": 101822598, "body": "<code>char inputstring[] = &quot;&quot;;</code> this just sets aside one char of space for the null terminator and nothing else. It&#39;s going to cause undefined behavior when you try to write a string to it with <code>scanf(&quot;%s&quot;, inputstring);</code>."}, {"owner": {"reputation": 1, "user_id": 11988187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db05aaaebe954b2b4ecadafe61b3817d?s=128&d=identicon&r=PG&f=1", "display_name": "Metalhed666", "link": "https://stackoverflow.com/users/11988187/metalhed666"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1566983829, "post_id": 57688887, "comment_id": 101822680, "body": "@Blaze That does indeed work! I missed that. What would be best practice if I don&#39;t know the length of the string so don&#39;t want to put a length. Is that even possible?"}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1566983957, "post_id": 57688887, "comment_id": 101822764, "body": "Also you&#39;re not null terminating the reversed string, put a <code>outputstring[count+1] = &#39;\\0&#39;;</code> after the loop."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11988187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db05aaaebe954b2b4ecadafe61b3817d?s=128&d=identicon&r=PG&f=1", "display_name": "Metalhed666", "link": "https://stackoverflow.com/users/11988187/metalhed666"}, "edited": false, "score": 0, "creation_date": 1566984555, "post_id": 57688961, "comment_id": 101823102, "body": "Makes sense now. Must&#39;ve missed that in the content. Thanks."}], "tags": [], "owner": {"reputation": 109, "user_id": 4814225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0691d361bb1ca47c40565f6de1da1cb?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis W", "link": "https://stackoverflow.com/users/4814225/dennis-w"}, "is_accepted": true, "score": 7, "last_activity_date": 1566983822, "creation_date": 1566983822, "answer_id": 57688961, "question_id": 57688887, "link": "https://stackoverflow.com/questions/57688887/cannot-figure-out-why-strlen-is-corrupting-character-array-in-c/57688961#57688961", "title": "Cannot figure out why strlen is corrupting character array in C", "body": "<p>Arrays in C are not dynamic, and by declaring them like you do:</p>\n\n<pre><code>char inputstring[] = \"\";\nchar outputstring[] = \"\";\n</code></pre>\n\n<p>they are basically fixed size arrays of length 1.\nTry declaring them with a length, e.g.</p>\n\n<pre><code>char inputstring[100] = \"\";\nchar outputstring[100] = \"\";\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11988187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db05aaaebe954b2b4ecadafe61b3817d?s=128&d=identicon&r=PG&f=1", "display_name": "Metalhed666", "link": "https://stackoverflow.com/users/11988187/metalhed666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 57688961, "answer_count": 1, "score": -1, "last_activity_date": 1566984462, "creation_date": 1566983579, "question_id": 57688887, "link": "https://stackoverflow.com/questions/57688887/cannot-figure-out-why-strlen-is-corrupting-character-array-in-c", "title": "Cannot figure out why strlen is corrupting character array in C", "body": "<p>I am learning up on C and I can't figure out why this code doesn't work. I am reversing a string but strlen seems to be corrupting the input.</p>\n\n<p>I know scanf can be troublesome so I tried replacing scanf with fgets (which I'm not meant to know about yet) I get exactly the same output.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char inputstring[] = \"\";\n    char outputstring[] = \"\";\n    unsigned short int count = 0;\n\n    printf(\"Enter a string: \");\n    scanf(\"%s\", inputstring);\n\n    count = strlen(inputstring) - 1;\n\n    printf(\"%s\", inputstring);\n\n    for(int i = 0;i &lt;= count;i++)\n    {\n        outputstring[count-i] = inputstring[i];\n    }\n\n    printf(\"%s\", outputstring);\n\n    return 0;\n}\n</code></pre>\n\n<p>When I compile and execute the code I get:</p>\n\n<p>Enter a string: hello\nh</p>\n\n<p>so the printf displays one character and then garbage.</p>\n\n<p>If I comment out the strlen line, the printf displays correctly:</p>\n\n<p>Enter a string: hello\nhello</p>\n"}, {"tags": ["c", "redis"], "comments": [{"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1566983235, "post_id": 57688673, "comment_id": 101822359, "body": "<code>args[0].reply = redisCommand(args[0].c, &quot;MY-REDIS-COMMAND&quot;);</code> here <code>redisCommand</code> returns a <code>redisReply</code>, but you&#39;re assigning it to a <code>u_char</code>."}, {"owner": {"reputation": 811, "user_id": 9557887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred Balle", "link": "https://stackoverflow.com/users/9557887/alfred-balle"}, "reply_to_user": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "edited": false, "score": 0, "creation_date": 1566984033, "post_id": 57688673, "comment_id": 101822812, "body": "The error refers to <code>redisStuff rs = { reply, c };</code>, sorry if that wasn&#39;t clear."}], "answers": [{"comments": [{"owner": {"reputation": 811, "user_id": 9557887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred Balle", "link": "https://stackoverflow.com/users/9557887/alfred-balle"}, "edited": false, "score": 0, "creation_date": 1566985116, "post_id": 57689242, "comment_id": 101823373, "body": "Ah, ok. How can I easily change this?"}, {"owner": {"reputation": 39, "user_id": 11028214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b04416d6a9d1b77a65fc3effbfdfd3c9?s=128&d=identicon&r=PG&f=1", "display_name": "hyyking", "link": "https://stackoverflow.com/users/11028214/hyyking"}, "reply_to_user": {"reputation": 811, "user_id": 9557887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred Balle", "link": "https://stackoverflow.com/users/9557887/alfred-balle"}, "edited": false, "score": 1, "creation_date": 1566985227, "post_id": 57689242, "comment_id": 101823425, "body": "Either you store the variables as pointers in the struct or you de-reference the pointer when you pass the value &gt;&gt;  typedef struct {     redisReply *reply;     redisContext *c; } redisStuff;  or  redisStuff rs = {*reply, *c}"}, {"owner": {"reputation": 811, "user_id": 9557887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred Balle", "link": "https://stackoverflow.com/users/9557887/alfred-balle"}, "edited": false, "score": 0, "creation_date": 1566988280, "post_id": 57689242, "comment_id": 101825153, "body": "Now I reach <code>outer_function</code> where I get <code>error: use of undeclared identifier reply</code> and <code>error: use of undeclared identifier c</code>."}], "tags": [], "owner": {"reputation": 39, "user_id": 11028214, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b04416d6a9d1b77a65fc3effbfdfd3c9?s=128&d=identicon&r=PG&f=1", "display_name": "hyyking", "link": "https://stackoverflow.com/users/11028214/hyyking"}, "is_accepted": false, "score": 3, "last_activity_date": 1566984785, "creation_date": 1566984785, "answer_id": 57689242, "question_id": 57688673, "link": "https://stackoverflow.com/questions/57688673/pass-variables-to-other-functions-in-c/57689242#57689242", "title": "Pass variables to other functions in C", "body": "<p>Your struct expects values and you are passing a pointer, so the compiler can't assign a pointer as a <code>redisContext</code>.</p>\n\n<pre><code>typedef struct {\n    redisReply reply;  // &lt;- expects value\n    redisContext c;    // &lt;- expects value\n} redisStuff;\n\n...\n\nredisContext *c;\nredisReply *reply;\n\nredisStuff rs = { reply, c };  // &lt;- reply and c are pointers\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567087944, "post_id": 57692159, "comment_id": 101866364, "body": "other than a spelling &#39;oops&#39; between <code>reply</code> and <code>replay</code> this is a good answer"}], "tags": [], "owner": {"reputation": 455, "user_id": 4899025, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGgvb.jpg?s=128&g=1", "display_name": "Ajith C Narayanan", "link": "https://stackoverflow.com/users/4899025/ajith-c-narayanan"}, "is_accepted": false, "score": 1, "last_activity_date": 1567168073, "last_edit_date": 1567168073, "creation_date": 1566994372, "answer_id": 57692159, "question_id": 57688673, "link": "https://stackoverflow.com/questions/57688673/pass-variables-to-other-functions-in-c/57692159#57692159", "title": "Pass variables to other functions in C", "body": "<pre><code>void outer_function(redisContext  *c, redisReply **reply) {\n    *reply = redisCommand(c, \"MY-REDIS-COMMAND\");\n    ...    \n    return;\n}\n\nint main(int argc, char **argv) {\n    ...\n    redisContext *c;\n    redisReply *reply;\n    ...\n    outer_function(c,&amp;replay);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 811, "user_id": 9557887, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alfred Balle", "link": "https://stackoverflow.com/users/9557887/alfred-balle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567168073, "creation_date": 1566982916, "last_edit_date": 1566988694, "question_id": 57688673, "link": "https://stackoverflow.com/questions/57688673/pass-variables-to-other-functions-in-c", "title": "Pass variables to other functions in C", "body": "<p>I have the following code in <code>C</code>:</p>\n\n<pre><code>int main(int argc, char **argv) {\n\n    ...\n\n    redisContext *c;\n    redisReply *reply;\n\n    ...\n\n    outer_function(...)\n\n    return 0;\n\n}\n</code></pre>\n\n<p>I would like to use the <code>Redis</code> variables in the <code>outer_function</code>.</p>\n\n<p>I've tried to add a <code>struct</code> for this before <code>main(...)</code>:</p>\n\n<pre><code>typedef struct {\n    redisReply reply;\n    redisContext c;\n} redisStuff;\n</code></pre>\n\n<p>And in <code>main</code>:</p>\n\n<pre><code>redisContext *c;\nredisReply *reply;\n\nredisStuff rs = { reply, c };\n\n...\n\nouter_function((u_char*)&amp;rs, ...)\n</code></pre>\n\n<p>And finally in my <code>outer_function</code>:</p>\n\n<pre><code>void outer_function(u_char *args, ...) {\n    redisStuff *rs = (redisStuff *) args;\n    reply = redisCommand(c, \"MY-REDIS-COMMAND\");\n    ...    \n    return;\n}\n</code></pre>\n\n<p>But it fails with:</p>\n\n<pre><code>warning: incompatible pointer to integer conversion initializing 'int' with an expression of type 'redisReply *' (aka 'struct redisReply *')\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "manpage", "bpf", "ebpf"], "answers": [{"tags": [], "owner": {"reputation": 7068, "user_id": 6884590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0b52ad2211a26c4e1cefb472e09cbe?s=128&d=identicon&r=PG", "display_name": "pchaigno", "link": "https://stackoverflow.com/users/6884590/pchaigno"}, "is_accepted": false, "score": 2, "last_activity_date": 1615964685, "last_edit_date": 1615964685, "creation_date": 1566982959, "answer_id": 57688691, "question_id": 57688344, "link": "https://stackoverflow.com/questions/57688344/what-is-not-allowed-in-restricted-c-for-ebpf/57688691#57688691", "title": "What is not allowed in restricted C for ebpf?", "body": "<p>Let's go over these:</p>\n<ul>\n<li><strong>Variadic functions, floating-point numbers, and passing structures</strong> as function arguments are still not possible. As far as I know, there is no ongoing work to support these.</li>\n<li><strong>Global variables</strong> should be supported in kernels &gt;=5.2, thanks to a <a href=\"https://patchwork.ozlabs.org/cover/1082746/\" rel=\"nofollow noreferrer\">recent patchset by Daniel Borkmann</a>.</li>\n<li><strong>Unbounded loops</strong> are still unsupported. There is <a href=\"https://lwn.net/Articles/794934/\" rel=\"nofollow noreferrer\">limited support for bounded loops in kernels &gt;=5.3</a>. I'm using &quot;limited&quot; here because a small program may still be rejected if the loop is too large.</li>\n</ul>\n<p>The best way to know what the last versions of Linux allow is to read <a href=\"https://github.com/torvalds/linux/blob/master/kernel/bpf/verifier.c\" rel=\"nofollow noreferrer\">the verifier's code</a> and/or to follow <a href=\"http://vger.kernel.org/vger-lists.html#bpf\" rel=\"nofollow noreferrer\">the bpf mailing list</a> (you might also want to follow the netdev mailing list as some patchsets may still land there). I've also found checking <a href=\"https://patchwork.ozlabs.org/project/netdev/list/?delegate=77147\" rel=\"nofollow noreferrer\">patchwork</a> to be quite efficient as it more clearly outlines the state of each patchset.</p>\n"}, {"tags": [], "owner": {"reputation": 4454, "user_id": 3716552, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/078Ob.jpg?s=128&g=1", "display_name": "Qeole", "link": "https://stackoverflow.com/users/3716552/qeole"}, "is_accepted": true, "score": 3, "last_activity_date": 1566983616, "creation_date": 1566983616, "answer_id": 57688896, "question_id": 57688344, "link": "https://stackoverflow.com/questions/57688344/what-is-not-allowed-in-restricted-c-for-ebpf/57688896#57688896", "title": "What is not allowed in restricted C for ebpf?", "body": "<p>It is not really a matter of what is \u201callowed\u201d in the ELF file itself. This sentence means that once compiled into eBPF instructions, your C code may produce code that would be rejected by the verifier. For example, loops in BPF programs have long been rejected in BPF programs, because there was no guaranty that they would terminate (the only workaround was to unroll them at compile time).</p>\n\n<p>So you can basically use pretty much whatever you want in C and produce successfully an ELF object file. But then you want it to pass the verifier. What components will surely result in the verifier complaining? Let's have a look at the list from man page:</p>\n\n<ul>\n<li><p>Loops: Linux version 5.3 introduces support for bounded loops, so loops now work to some extent. \u201cBounded loops\u201d means loops for which the verifier has a way to tell they will eventually finish: typically, a <code>for (i = 0; i &lt; CONSTANT; i++)</code> kind loop should work (assuming <code>i</code> is not modified in the block).</p></li>\n<li><p>Global variables: There has been some work recently to support global variables, but they are processed in a specific way (as single-entry maps) and I have not really experimented with them, so I don't know how transparent this is and if you can simply have global variables defined in your program. Feel free to experiment :).</p></li>\n<li><p>Variadic functions: Pretty sure this is not supported, I don't see how that would translate in eBPF at the moment.</p></li>\n<li><p>Floating point numbers: Still not supported.</p></li>\n<li><p>Passing structure as function arguments: Not supported, although passing pointers to structs should work I think.</p></li>\n</ul>\n\n<p>If you are interested in this level of details, you should really have a look at <a href=\"http://docs.cilium.io/en/latest/bpf\" rel=\"nofollow noreferrer\">Cilium's documentation on BPF</a>. It is not completely up-to-date (only the very new features are missing), but much more complete and accurate than the man page. In particular, <a href=\"http://docs.cilium.io/en/latest/bpf/#llvm\" rel=\"nofollow noreferrer\">the LLVM section</a> has a list of items that should or should not work in C programs compiled to eBPF. In addition to the aforedmentioned items, they cite:</p>\n\n<ul>\n<li><p>(All function needing to be inlined, no function calls) -> This one is outdated, BPF has function calls.</p></li>\n<li><p>No shared library calls: This is true. You cannot call functions from standard libraries, or functions defined in other BPF programs. You can only call into functions defined in the same BPF programs, or BPF helpers implemented in the kernel, or perform \u201ctail calls\u201d.</p></li>\n<li><p>Exception: LLVM built-in functions for <code>memset()</code>/<code>memcpy()</code>/<code>memmove()</code>/<code>memcmp()</code> are available (I think they're pretty much the only functions you can call, other than BPF helpers and your other BPF functions).</p></li>\n<li><p>No const string or arrays allowed (because of how they are handled in the ELF file): I think this is still valid today?</p></li>\n<li><p>BPF program stack is limited to 512 bytes, so your C program must not result in an executable that attempts to use more.</p></li>\n</ul>\n\n<p>Additional allowed or good-to-know items are listed. I can only encourage you to dive into it!</p>\n"}], "owner": {"reputation": 776, "user_id": 10187988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b241724a6266b0419c754aec2ed261?s=128&d=identicon&r=PG&f=1", "display_name": "Maicake", "link": "https://stackoverflow.com/users/10187988/maicake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1050, "favorite_count": 0, "accepted_answer_id": 57688896, "answer_count": 2, "score": 3, "last_activity_date": 1615964685, "creation_date": 1566981877, "last_edit_date": 1566983285, "question_id": 57688344, "link": "https://stackoverflow.com/questions/57688344/what-is-not-allowed-in-restricted-c-for-ebpf", "title": "What is not allowed in restricted C for ebpf?", "body": "<p>From bpf man page:</p>\n\n<blockquote>\n  <p>eBPF programs can be written in a restricted C that is compiled\n         (using the clang compiler) into eBPF bytecode.  Various features are\n         omitted from this restricted C, such as loops, global variables,\n         variadic functions, floating-point numbers, and passing structures as\n         function arguments.</p>\n</blockquote>\n\n<p>AFAIK the man page it's not updated. I'd like to know what is exactly forbidden when using restricted C to write an eBPF program? Is what the man page says still true?</p>\n"}, {"tags": ["c++", "c", "gstreamer"], "owner": {"reputation": 853, "user_id": 6228450, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b68f4daab93c6c862f563845f8bca540?s=128&d=identicon&r=PG&f=1", "display_name": "Curunir", "link": "https://stackoverflow.com/users/6228450/curunir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1566981768, "creation_date": 1566981768, "question_id": 57688317, "link": "https://stackoverflow.com/questions/57688317/c-gstreamer-empty-pipeline", "title": "C GStreamer empty pipeline", "body": "<p>I am building my pipeline like this:</p>\n\n<pre><code>gst-launch-1.0 -v filesrc location=\" + video_filename + \" ! qtdemux ! queue max-size-buffers=0 max-size-time=0 ! vpudec frame-drop=0 ! queue ! imxv4l2sink device=/dev/video16\n</code></pre>\n\n<p>This is how I stop video playback</p>\n\n<pre><code>    gst_element_set_state (m_gst_pipeline, GST_STATE_NULL);\n    g_main_loop_quit (m_mainloop);\n    gst_object_unref(m_gst_pipeline);\n</code></pre>\n\n<p>The stopping itsself works fine, only issue is that I get the last video frame displayed even when exiting the program. How do I flush the pipeline before destruction so I have a black screen?</p>\n"}, {"tags": ["c", "google-chrome", "cryptoapi"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 9786210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Huynh Viet", "link": "https://stackoverflow.com/users/9786210/huynh-viet"}, "edited": false, "score": 0, "creation_date": 1567669824, "post_id": 57728057, "comment_id": 102033653, "body": "Chrome browser does use Microsoft CAPI ( I just read somewhere). And thanks for your support. My problems come from my csp module.  It&#39;s worked fine now."}], "tags": [], "owner": {"reputation": 314, "user_id": 145016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376cbafc4581d1ec8321836a25d09570?s=128&d=identicon&r=PG", "display_name": "notacat", "link": "https://stackoverflow.com/users/145016/notacat"}, "is_accepted": false, "score": 0, "last_activity_date": 1567173110, "creation_date": 1567173110, "answer_id": 57728057, "question_id": 57688134, "link": "https://stackoverflow.com/questions/57688134/how-to-ssl-tls-client-authentication-on-chrome-using-custom-cryptographic-servic/57728057#57728057", "title": "How to SSL/TLS Client Authentication on Chrome using Custom Cryptographic Service Provider (CSPs)", "body": "<p>Chrome browser does not use Microsoft CAPI (CryptoAPI) for cryptographic services, but it includes the BoringSSL library instead. Hence, Chrome will not have access to your custom CSP module.</p>\n\n<p>You should be able to import the client certificate and private key (Settings -> Advanced -> Privacy and security -> Manage Certificates -> Personal -> Import).</p>\n\n<p>You don't explain why you need a custom CSP to do this with IE as importing the cert and private key into Window's certificate store should also make ssl client certificates work without it. HTH.</p>\n"}], "owner": {"reputation": 61, "user_id": 9786210, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Huynh Viet", "link": "https://stackoverflow.com/users/9786210/huynh-viet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1218, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567173110, "creation_date": 1566981207, "last_edit_date": 1566985474, "question_id": 57688134, "link": "https://stackoverflow.com/questions/57688134/how-to-ssl-tls-client-authentication-on-chrome-using-custom-cryptographic-servic", "title": "How to SSL/TLS Client Authentication on Chrome using Custom Cryptographic Service Provider (CSPs)", "body": "<p>I had already written a CSP module and it worked well. Here is a problems, I use my CSP module to browser to a web page that required ssl client authentication, and it worked on IE, but not for Chrome.\nChrome screen show error\n<strong>This site can't provide a secure connection</strong>\n<strong>ERR_BAD_SSL_CLIENT_AUTH_CERT</strong></p>\n\n<p>I use chrome with enable-logging, and an WARNING occur like <code>WARNING:ssl_platform_key_win.cc(386)] Could not acquire private key: Error (0x13D) while retrieving error. (0xC0000225)</code></p>\n\n<pre><code>HCERTSTORE hStore = NULL;\nCRYPT_KEY_PROV_INFO key_prov_info = { 0 };\nPCCERT_CONTEXT pCertContext = nullptr;\nstd::vector&lt;BYTE&gt; der_encoded_cert;\n\nhStore = CertOpenSystemStore(NULL, L\"MY\");\nif (!hStore)\n{\n    goto Exit;\n}\n\nder_encoded_cert = LoadFromFile();\n\npCertContext = CertCreateCertificateContext(X509_ASN_ENCODING, der_encoded_cert.data(), der_encoded_cert.size());\nif (!pCertContext)\n{\n    goto Exit;\n}\n\nkey_prov_info.dwProvType = MY_PROVIDER_TYPE; // Or YOUR_PROVIDER_TYPE\nkey_prov_info.dwKeySpec = AT_SIGNATURE; // Or AT_KEYEXCHANGE\nkey_prov_info.pwszContainerName = L\"My key name\";\nkey_prov_info.dwFlags = CERT_SET_KEY_PROV_HANDLE_PROP_ID;\nkey_prov_info.cProvParam = L\"My provider Name\";\nkey_prov_info.pwszProvName = nullptr;\nkey_prov_info.rgProvParam = 0;\n\n\nif (!CertSetCertificateContextProperty(pCertContext, CERT_KEY_PROV_INFO_PROP_ID, 0, &amp;key_prov_info))\n{\n    goto Exit;\n}\n\nif (!CertAddCertificateContextToStore(hStore, pCertContext, CERT_STORE_ADD_ALWAYS, NULL))\n{\n    goto Exit;\n}\n</code></pre>\n\n<p>How to detect this problem come from? I can only export chrome logging.</p>\n"}, {"tags": ["c", "function", "elf"], "comments": [{"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566981285, "post_id": 57688048, "comment_id": 101821242, "body": "If your intention is to &quot;obfuscate&quot; the symbol names as that answer suggests, you need need to include <code>heah.h</code> in <code>libdyn.c</code> as well, because otherwise <code>application.c</code> expects a function named <code>abab</code>, while <code>libdyn.c</code> provides it as <code>SecretFunc1</code>. But I don&#39;t see the point of it. Can you clarify? The compiler should also have warned you, that <code>abab</code> is implicitly declared in <code>application.c</code>. You should provide an explicit declaration for it."}, {"owner": {"reputation": 13, "user_id": 11983218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9279f169eb2b89862fa3bf092ca789?s=128&d=identicon&r=PG&f=1", "display_name": "Narza", "link": "https://stackoverflow.com/users/11983218/narza"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566981863, "post_id": 57688048, "comment_id": 101821568, "body": "It&#39;s for the excercise I got. I need to change a specific library symbols names so that you cannot tell what they do, after reading elf tables."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1566982238, "post_id": 57688048, "comment_id": 101821794, "body": "It is unclear what your exercise requires you to achieve specifically. In particular it is unclear what is given to you and what you should submit as a solution."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1567767715, "post_id": 57688048, "comment_id": 102071635, "body": "include <code>&quot;head.h&quot;</code> also in the implementation.... if you don&#39;t you are actually implementing <code>SecretFunction</code>, not <code>abab</code>"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1568112030, "post_id": 57688048, "comment_id": 102162922, "body": "Implementing a shared object with scrambled names is a bet to project crash."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11983218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9279f169eb2b89862fa3bf092ca789?s=128&d=identicon&r=PG&f=1", "display_name": "Narza", "link": "https://stackoverflow.com/users/11983218/narza"}, "edited": false, "score": 0, "creation_date": 1566983292, "post_id": 57688439, "comment_id": 101822395, "body": "Worked, thank you very much for help. Now I understand what was wrong."}], "tags": [], "owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "is_accepted": true, "score": 1, "last_activity_date": 1566982173, "creation_date": 1566982173, "answer_id": 57688439, "question_id": 57688048, "link": "https://stackoverflow.com/questions/57688048/undefined-reference-to-function-while-trying-to-build-a-program-with-header-th/57688439#57688439", "title": "&#39;undefined reference to function&#39; while trying to build a program with header that redefines function names", "body": "<p>After (partial) preprocessing, your <code>application.c</code> would look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    abab();\n    return 0;   \n}\n</code></pre>\n\n<p>This should, first of all, give you a warning, that <code>abab</code> is declared implicitly, which usually is not a good idea. You should declare the function (in a header file shared by <code>application.c</code> and <code>libdyn.c</code>):</p>\n\n<pre><code>int SecretFunc1(void);\n</code></pre>\n\n<p>When compiling to an object file, this object file will have a reference to the symbol <code>abab</code>.</p>\n\n<p>After compiling <code>libdyn.c</code> to an object file, it will provide a symbol named <code>SecretFunc1</code>. Therefore, the linker will not match it to the reference <code>abab</code> in <code>application.o</code>.</p>\n\n<p>You need to rename the function in all files using it, e.g. by including <code>head.h</code> in <code>libdyn.c</code> as well or better putting both the renaming macro and the declaration in a <code>libdyn.h</code> that is included in both <code>libdyn.c</code> and <code>application.c</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 11983218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9279f169eb2b89862fa3bf092ca789?s=128&d=identicon&r=PG&f=1", "display_name": "Narza", "link": "https://stackoverflow.com/users/11983218/narza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "accepted_answer_id": 57688439, "answer_count": 1, "score": 1, "last_activity_date": 1566982173, "creation_date": 1566980853, "question_id": 57688048, "link": "https://stackoverflow.com/questions/57688048/undefined-reference-to-function-while-trying-to-build-a-program-with-header-th", "title": "&#39;undefined reference to function&#39; while trying to build a program with header that redefines function names", "body": "<p>I'm having the exact same problem as a person that asked this question: <a href=\"https://stackoverflow.com/questions/9648655/how-to-hide-the-exported-symbols-name-within-a-shared-library\">How to hide the exported symbols name within a shared library</a></p>\n\n<p>I decided to follow instructions given by Alexander (3rd answer) but after including a generated header to my main program in C, i get the error undefined reference to function</p>\n\n<p>head.h</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define SecretFunc1 abab\n</code></pre>\n\n<p>application.c</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include \"head.h\"\n\nint main(){\n    SecretFunc1();\n    return 0;   \n}\n</code></pre>\n\n<p>libdyn.c</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\nint SecretFunc1(){\n    return 2\n}\n</code></pre>\n\n<p>I've built the dynamic library into <code>.so</code> file, then after trying to build the app with: \n<code>gcc app.c -L&lt;path&gt; -ldyn -o sample</code>\nIn function main undefined reference to abab</p>\n\n<p>I don't really know what to do.</p>\n"}, {"tags": ["c", "gcc", "x86", "inline-assembly"], "comments": [{"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 1, "creation_date": 1566979623, "post_id": 57687660, "comment_id": 101820341, "body": "You&#39;re manually writing the assembly. How do you expect the c compiler to know you&#39;re calling a function?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566979657, "post_id": 57687660, "comment_id": 101820359, "body": "Just don&#39;t write inline assembly. It&#39;s almost <i>never</i> worth it."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566979813, "post_id": 57687660, "comment_id": 101820440, "body": "And what is the <i>actual</i> problem you have, the one you want to solve with the inline assembly? What is the reason you use inline assembly to begin with? Right now this is to much of an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 0, "creation_date": 1566979819, "post_id": 57687660, "comment_id": 101820441, "body": "Also, pushing and popping is on the caller, not on the callee. So it should be done in <code>main_proc</code>, not in <code>proc</code>."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1566979865, "post_id": 57687660, "comment_id": 101820461, "body": "Federico klez Culloca    ok but why still there is no push or pop !!!"}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "edited": false, "score": 2, "creation_date": 1566979895, "post_id": 57687660, "comment_id": 101820476, "body": "Because the C compiler doesn&#39;t interpret the assembly, so it doesn&#39;t know there&#39;s a call in there."}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1566979994, "post_id": 57687660, "comment_id": 101820543, "body": "On x86, the <i>caller</i> is responsible for saving <code>ECX</code>. So your <code>main_proc</code> must assume that after calling <code>proc</code>, <code>ECX</code> has been overwritten, and <code>push</code>/<code>pop</code> it before/after the call. The clobber will only make the compiler not assume the value is kept during the inline assembly; it will <i>not</i> make the compiler save everything in clobbered registers, especially if it hasn&#39;t put any variable in there! The compiler doesn&#39;t know that the other inline assembly blocks require <code>ECX</code> to be saved."}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 3, "creation_date": 1566980183, "post_id": 57687660, "comment_id": 101820630, "body": "No, it isn&#39;t. It&#39;s your duty. The GCC only saves its own data that might have been clobbered; <i>not</i> the data you have put there in inline assembly blocks. How would GCC know that <code>asm volatile (&quot;movl     $55, %%ecx&quot; ::: &quot;ecx&quot;);</code> saves something to <code>ECX</code> that is needed later? It might just overwrite <code>ECX</code> with temporary stuff that isn&#39;t needed ever again."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1566980278, "post_id": 57687660, "comment_id": 101820684, "body": "but still i used &quot;ecx&quot; clobber in calling &quot;proc&quot; function so compiler knows that &quot;ecx&quot; will going to be changed in &quot;proc&quot; function so it&#39;s must takes care about &quot;ecx&quot; pushing !!!!"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566980406, "post_id": 57687660, "comment_id": 101820752, "body": "@Jason what happens if you put the whole body of <code>main</code> inside an <code>asm volatile</code> directive?"}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1566980418, "post_id": 57687660, "comment_id": 101820759, "body": "How should GCC know that <code>proc</code> is called at all? The call happens in inline assembly, so it is invisible to GCC. Also, how would GCC know that the value written to <code>ECX</code> is needed later? There is no indication to GCC that <code>asm volatile (&quot;addl     %%ecx, %0&quot; : &quot;=r&quot; (ret));</code> uses <code>ECX</code> as an <i>input</i>."}, {"owner": {"reputation": 22777, "user_id": 133203, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Fp3hB.jpg?s=128&g=1", "display_name": "Federico klez Culloca", "link": "https://stackoverflow.com/users/133203/federico-klez-culloca"}, "reply_to_user": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1566980552, "post_id": 57687660, "comment_id": 101820827, "body": "I think you&#39;re misunderstanding what clobbering does. You&#39;re just telling gcc that you&#39;re touching those registers, but you&#39;re not telling it how it should transform your hand-written assembly to accommodate this. (On further reading, it&#39;s basically what @Erlkoenig said upthread)."}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 2, "creation_date": 1566980610, "post_id": 57687660, "comment_id": 101820860, "body": "@Jason when you insert your own assembly, GCC has no more responsibilities.  GCC is a C compiler and does not interpret your assembly language.  You are responsible for <i>everything</i>.  If you don&#39;t want to be, write C code instead. :-)"}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1566980631, "post_id": 57687660, "comment_id": 101820874, "body": "Store the 55 in a C variable before the call, do the call as a C function call (otherwise GCC doesn&#39;t know a call that might clobber things happens!), and read it back from the C variable via an input operand. This way, GCC will save the register."}, {"owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "edited": false, "score": 0, "creation_date": 1566980659, "post_id": 57687660, "comment_id": 101820885, "body": "even i use (proc(n)) directly, there will be no push and pop ... i used call asm, to tell the compiler that &quot;ecx&quot; will be changed .... !!!!! even if i add &quot;ecx&quot; clobber to asm (&quot;addl     %%ecx, %0&quot; : &quot;=r&quot; (ret) :: &quot;ecx&quot;);, there is no push and pop !!!!"}, {"owner": {"reputation": 2449, "user_id": 4730685, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8d2d8e67d9c0443c382d1dd80132063?s=128&d=identicon&r=PG&f=1", "display_name": "Erlkoenig", "link": "https://stackoverflow.com/users/4730685/erlkoenig"}, "edited": false, "score": 0, "creation_date": 1566980812, "post_id": 57687660, "comment_id": 101820986, "body": "Of course, the compiler <i>still</i> doesn&#39;t know that <code>ECX</code> contains anything valuable. GCC saves only its own sheep (all C variables), but not what inline assembly puts there. Therefore, save the 55 in a C variable!"}], "answers": [{"tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 3, "last_activity_date": 1566984332, "last_edit_date": 1566984332, "creation_date": 1566982366, "answer_id": 57688498, "question_id": 57687660, "link": "https://stackoverflow.com/questions/57687660/gcc-doesnt-push-registers-around-my-inline-asm-function-call-even-though-i-have/57688498#57688498", "title": "GCC doesn&#39;t push registers around my inline asm function call even though I have clobbers", "body": "<p>You are using inline asm completely wrong.  Your input/output constraints need to fully describe the inputs / outputs of each asm statement.  To get data between asm statements, you have to hold it in C variables between them.</p>\n\n<p>Also, <code>call</code> isn't safe inside inline asm in general, and specifically in x86-64 code for the System V ABI it steps on the red-zone where gcc might have been keeping things.  There's no way to declare a clobber on that.  You could use <code>sub $128, %rsp</code> first to skip past the red zone, or you could make <strong>calls from pure C like a normal person</strong> so the compiler knows about it.  (Remember that <code>call</code> pushes a return address.)  Your inline asm doesn't even make sense; your <code>proc</code> takes an arg but you didn't do anything in the caller to pass one.</p>\n\n<p>The compiler-generated code in <code>proc</code> could have also destroyed any other call-clobbered registers, so you at least need to declare clobbers on those registers.  Or hand-write the whole function in asm so you know what to put in clobbers.</p>\n\n<blockquote>\n  <p>why GCC is not going to use (push) and (pop) for \"ecx\" register ?? i used \"ecx\" clobber too !!!!!</p>\n</blockquote>\n\n<p>An <code>ecx</code> clobber tells GCC that this asm statement destroys whatever <em>GCC</em> had in ECX previously.  <strong>Using an ECX clobber in two separate inline-asm statements doesn't declare any kind of data dependency between them.</strong></p>\n\n<p>It's not equivalent to declaring a register-asm local variable like<br>\n<code>register int foo asm(\"ecx\");</code> that you use as a <code>\"+r\" (foo)</code> operand to the first and last asm statement.  (Or more simply that you use with a <code>\"+c\"</code> constraint to make an ordinary variable pick ECX).</p>\n\n<p>From GCC's point of view, your source means only what the constraints + clobbers tell it.</p>\n\n<pre><code>int main_proc(int n) {\n    asm volatile (\"movl     $55, %%ecx\" ::: \"ecx\");\n      // ^^ black box that destroys ECX and produces no outputs\n    int ret;\n    asm volatile (\"call     proc\" : \"=r\" (ret) : \"r\" (n) : \"ecx\");\n      // ^^ black box that can take `n` in any register, and can produce `ret` in any reg.  And destroys ECX.\n\n    asm volatile (\"addl     %%ecx, %0\" : \"=r\" (ret));\n     // ^^ black box with no inputs that can produce a new value for `ret` in any register\n\n    return ret;\n}\n</code></pre>\n\n<p>I suspect you wanted the last asm statement to be <code>\"+r\"(ret)</code> to read/write the C variable <code>ret</code> instead of telling GCC that it was output-only.  Because your asm uses it as an input as well as output as the destination of an <code>add</code>.</p>\n\n<p>It might be interesting to add comments like <code># %%0 = %0   %%1 = %1</code> inside your 2nd asm statement to see which registers the <code>\"=r\"</code> and <code>\"r\"</code> constraints picked.  On <a href=\"https://godbolt.org/z/7Oj2vN\" rel=\"nofollow noreferrer\"><strong>the Godbolt compiler explorer</strong></a>:</p>\n\n<pre><code># gcc9.2 -O3 \nmain_proc:\n        movl     $55, %ecx\n        call     proc         # %0 = %edi   %1 = %edi\n        addl     %ecx, %eax    # \"=r\" happened to pick EAX,\n                      # which happens to still hold the return value from  proc\n        ret\n</code></pre>\n\n<p>That accident of picking EAX as the add destinatino might not happen after this function inlines into something else. or GCC happens to put some compiler-generated instructions between asm statements.  (<code>asm volatile</code> is barrier to compile-time reordering but not not a strog one.  It only definitely stops optimizing away entirely).</p>\n\n<p>Remember that inline asm templates are purely text substitution; asking the compiler to fill in an operand into a comment is no different from anywhere else in the template string.  (Godbolt strips comment lines by default so sometimes it's handy to tack them onto other instructions, or onto a nop).</p>\n\n<p>As you can see, this is 64-bit code (<code>n</code> arrives in EDI as per the x86-64 SysV calling convention, like how you built your code), so <code>push %ecx</code> wouldn't be encodeable.  <code>push %rcx</code> would be.</p>\n\n<p>Of course if GCC actually wanted to keep a value around past an asm statement with an <code>\"ecx\"</code> clobber, it would have just used <code>mov %ecx, %edx</code> or whatever other call-clobbered register that wasn't in the clobber list.</p>\n"}], "owner": {"reputation": 75, "user_id": 11729009, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aeaab067fd7d266f8e47764ee6e2ad9?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/11729009/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 57688498, "answer_count": 1, "score": -1, "last_activity_date": 1566984332, "creation_date": 1566979495, "last_edit_date": 1566983441, "question_id": 57687660, "link": "https://stackoverflow.com/questions/57687660/gcc-doesnt-push-registers-around-my-inline-asm-function-call-even-though-i-have", "title": "GCC doesn&#39;t push registers around my inline asm function call even though I have clobbers", "body": "<p>I have a function (C) that modifies \"ecx\" (or any other registers)</p>\n\n<pre><code>int proc(int n) {\n    int ret;\n    asm volatile (\"movl %1, %%ecx\\n\\t\" // mov (n) to ecx\n                  \"addl $10, %%ecx\\n\\t\" // add (10) to ecx (n)\n                  \"movl %%ecx, %0\" /* ret = n + 10 */\n                  : \"=r\" (ret) : \"r\" (n) : \"ecx\");\n    return ret;\n}\n</code></pre>\n\n<p>now i want to call this function in another function which that function moves a value in \"ecx\" before calling \"proc\" function</p>\n\n<pre><code>int main_proc(int n) {\n    asm volatile (\"movl     $55, %%ecx\" ::: \"ecx\"); /// mov (55) to ecx\n    int ret;\n    asm volatile (\"call     proc\" : \"=r\" (ret) : \"r\" (n) : \"ecx\"); // ecx is modified in proc function and the value of ecx is not 55 anymore even with \"ecx\" clobber\n\n    asm volatile (\"addl     %%ecx, %0\" : \"=r\" (ret));\n\n    return ret;\n}\n</code></pre>\n\n<p>in this function, (55) is moved into \"ecx\" register and then \"proc\" function is called (which modifies \"ecx\"). in this situation, \"proc\" function Must push \"ecx\" first and pop it at the end but it's not going to happen !!!! \nthis is the assembly source with (-O3) optimiaztion level</p>\n\n<pre><code>proc:\n        movl %edi, %ecx\n        addl $10, %ecx\n        movl %ecx, %eax\n        ret\nmain_proc:\n        movl     $55, %ecx\n        call     proc\n        addl     %ecx, %eax\n        ret\n</code></pre>\n\n<p>why GCC is not going to use (push) and (pop) for \"ecx\" register ?? i used \"ecx\" clobber too !!!!!</p>\n"}, {"tags": ["c", "can-bus"], "comments": [{"owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "edited": false, "score": 0, "creation_date": 1566978050, "post_id": 57686650, "comment_id": 101819562, "body": "Your CAN mask and filter should be 11 Bit (Base frame) or 29 Bit (Extended frame)."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1566978365, "post_id": 57686650, "comment_id": 101819731, "body": "with the intention of learning its reason, where do you use it?"}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "edited": false, "score": 0, "creation_date": 1566980340, "post_id": 57687269, "comment_id": 101820719, "body": "If you don&#39;t mind, can you talk about the FilterMode IDlist description?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "edited": false, "score": 1, "creation_date": 1566981395, "post_id": 57687269, "comment_id": 101821295, "body": "@CKocar It would be best to start a new question. I&#39;m not familiar with the FilterMode IDlist."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 2, "last_activity_date": 1566978370, "last_edit_date": 1566978370, "creation_date": 1566978062, "answer_id": 57687269, "question_id": 57686650, "link": "https://stackoverflow.com/questions/57686650/can-bus-filter-and-mask-logic/57687269#57687269", "title": "Can-bus Filter and Mask Logic", "body": "<p>The CAN bus has 11-bit identifiers (<a href=\"https://en.wikipedia.org/wiki/CAN_bus#Base_frame_format\" rel=\"nofollow noreferrer\">base frame format</a>) and 29-bit identifiers (<a href=\"https://en.wikipedia.org/wiki/CAN_bus#Extended_frame_format\" rel=\"nofollow noreferrer\">extended frame format</a>).</p>\n\n<p>So if <code>FilterIdHigh</code> is 16 bits, and the 11-bit identifier is in the upper bits of the register, then you need to left shift the identifier by 5 bits to put it into the 11 MSBs of the register. That is why the code has the left shift (<code>&lt;&lt; 5</code>) for both the <code>FilterIdHigh</code> and the <code>FilterMaskIdHigh</code>.</p>\n\n<p>The 0x100 value isn't a 9-bit value, it's an 11-bit value <code>001 0000 0000</code>.<br>\nThe mask 0x700 value is also an 11-bit value <code>111 0000 0000</code>.</p>\n\n<p>As a result, the upper three bits of the 11-bit identifier must be 001, and any identifier of the form<br>\n <code>001 xxxx xxxx</code> will pass the filter. So identifiers from 0x100 thru 0x1ff will pass the filter.</p>\n"}], "owner": {"reputation": 535, "user_id": 10024802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/470ad9d816276f1dff22193ac0642b93?s=128&d=identicon&r=PG&f=1", "display_name": "CKocar", "link": "https://stackoverflow.com/users/10024802/ckocar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 940, "favorite_count": 0, "accepted_answer_id": 57687269, "answer_count": 1, "score": 1, "last_activity_date": 1566978370, "creation_date": 1566975699, "last_edit_date": 1566976422, "question_id": 57686650, "link": "https://stackoverflow.com/questions/57686650/can-bus-filter-and-mask-logic", "title": "Can-bus Filter and Mask Logic", "body": "<p>I want to understand below code, why the filter 0x100 between 1xFF address.\nMask value is 1110000000000000 (16 bit) and filter value is 10000000000000. That mean my ids could be <strong>100</strong>100000000000(16bit),<strong>100</strong>00100000000(16 bit) etc. (<strong>100</strong>.. side must be constant all ids. </p>\n\n<p>But the 0x100 value is 100000000 (9 bit) how this possible I can not understand.How it compares 9-bit and 16-bit id ?</p>\n\n<pre><code>HAL_StatusTypeDef CAN_Filter_Init(CAN_HandleTypeDef *hcanxx)\n{\n  CAN_FilterTypeDef can_filter_config;\n  //100 to 1FF in other words block all messages after 0x0200\n  can_filter_config.FilterActivation = CAN_FILTER_ENABLE;\n  can_filter_config.FilterBank = 0;\n  can_filter_config.FilterIdHigh = 0x100 &lt;&lt; 5;\n  // can_filter_config.FilterIdHigh = 0x000;\n\n  can_filter_config.FilterIdLow = 0x0000;\n  can_filter_config.FilterMode = CAN_FILTERMODE_IDMASK;\n  can_filter_config.FilterScale = CAN_FILTERSCALE_32BIT;\n  can_filter_config.FilterMaskIdHigh = 0x700 &lt;&lt; 5;\n  // can_filter_config.FilterMaskIdHigh = 0X000;\n  can_filter_config.FilterMaskIdLow = 0x0000;\n  can_filter_config.FilterFIFOAssignment = CAN_FILTER_FIFO0;\n  can_filter_config.SlaveStartFilterBank = 0;\n\n  if (HAL_CAN_ConfigFilter(hcanxx, &amp;can_filter_config) != HAL_OK)\n  {\n    Error_Handler();\n  }\n  return HAL_OK;\n}\n</code></pre>\n"}, {"tags": ["c", "winapi"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566975303, "post_id": 57686426, "comment_id": 101818354, "body": "A qualified guess is that the printf family of functions use variables with static storage duration internally, and if there&#39;s no CRT, those variables can&#39;t be initialized."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 3, "creation_date": 1566978408, "post_id": 57686426, "comment_id": 101819756, "body": "<i>/entry:wmain</i> - the entry point of <i>exe</i> file must have signature <code>ULONG WINAPI ep(void*)</code> - nobody pass to you <code>(int argc, LPCWSTR argv[])</code> in entry point - so in place argc will be pointer to <i>PEB</i> and in place <code>argv</code> - undefined trash"}, {"owner": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1566980979, "post_id": 57686426, "comment_id": 101821067, "body": "@DavidHeffernan Nowhere in either program is there an attempt to write to the console."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1566982564, "post_id": 57686426, "comment_id": 101821964, "body": "Oops, I misread, sorry"}, {"owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "edited": false, "score": 1, "creation_date": 1567011222, "post_id": 57686426, "comment_id": 101838111, "body": "@Lisbeth FYI, you don&#39;t need <code>wsprintfW()</code> at all in this example code (especially since you are not using it correctly anyway). Just pass the parsed command-line arguments as-is directly to <code>MessageBoxW()</code>, eg: <code>MessageBoxW(0, argv[k], L&quot;from argv&quot;, 0);</code> ... <code>MessageBoxW(0, szArglist[k], L&quot;from CommandLineToArgvW&quot;, 0);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "edited": false, "score": 0, "creation_date": 1566983553, "post_id": 57687830, "comment_id": 101822524, "body": "So ... it&#39;s a no, then?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "edited": false, "score": 1, "creation_date": 1566984050, "post_id": 57687830, "comment_id": 101822827, "body": "@Lisbeth -why no ? of course we can do all without any crt. you can use <code>CommandLineToArgvW</code> if want, you can call <code>GetCommandLineW</code> and then yourself parse command line. can design self format where not space is separator. you can do all. but you need understand - then declare <code>int wmain(int argc, LPCWSTR argv[])</code> as entry point is wrong. you can <code>int wmain()</code> declare if want as entry. or <code>void  __stdcall wmain(void*)</code> etc. but get cmd line not as input parameter in ep"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "edited": false, "score": 1, "creation_date": 1566984470, "post_id": 57687830, "comment_id": 101823050, "body": "@Lisbeth - i simply try explain why your first code snippet is crash - because you use <i>argc, argv</i> despite <i>argc</i> - was not count of arguments but pointer to some data structure (so very big value if interpret it as <i>int</i>) and what in place <i>argv</i> - at all undefined. so you reference random memory and got <code>EXCEPTION_ACCESS_VIOLATION</code> as and must be. but you view that your second example is work (despite wrong and for what ?) <code>wsprintfW</code>"}], "tags": [], "owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "is_accepted": false, "score": 3, "last_activity_date": 1567002762, "last_edit_date": 1567002762, "creation_date": 1566980093, "answer_id": 57687830, "question_id": 57686426, "link": "https://stackoverflow.com/questions/57686426/in-programs-compiled-without-crt-is-it-possible-to-read-command-line-arguments/57687830#57687830", "title": "In programs compiled without CRT, is it possible to read command-line arguments via argv?", "body": "<p>you use <em>/entry:wmain</em> linker option - this mean that your <em>wmain</em> became entry point of <em>exe</em>. but signature of <em>exe</em> entry point must be next:</p>\n\n<p><code>ULONG WINAPI ep(void* peb)</code></p>\n\n<p>this function take from windows 1 argument (pointer to <a href=\"https://technet.microsoft.com/en-us/aa813706(v=vs.90)\" rel=\"nofollow noreferrer\"><code>PEB</code></a> structure). called as <code>__stdcall</code> (so <code>WINAPI</code> or <code>CALLBACK</code> if want) and return value (if you return from ep) used as argument for call <code>ExitThread</code>.</p>\n\n<p>usually we not return from <em>ep</em> but call <code>ExitProcess</code>. but even if we return from <em>exe</em> entry point - we in current implementation can use and some another signature - say</p>\n\n<p><code>int wmainCRTStartup()</code></p>\n\n<p>despite this is wrong signature (stack pointer will be wrong after return on <em>x86</em>) this not play role in current windows implementation, because just after entry point return control - the <code>ExitThread</code> is called and nothing referenced in stack.</p>\n\n<p>also possible have <code>void</code> return type, instead <code>int</code> or <code>ULONG</code> - if we not care about our thread (not process !!) return code. usually this not play any role. especially if we never return from <em>ep</em> but direct call <code>ExitProcess</code> - we can declare and <code>void</code> return type.</p>\n\n<p>but anyway the signature</p>\n\n<p><code>int wmain(int argc, LPCWSTR argv[])</code></p>\n\n<p>is wrong for exe entry point - because it take 1 pointer instead <em>argc, argv</em></p>\n\n<p>so in place <em>argc</em> we will be have pointer to <a href=\"https://technet.microsoft.com/en-us/aa813706(v=vs.90)\" rel=\"nofollow noreferrer\"><code>PEB</code></a> and in place <em>argv</em> - undefined trash.</p>\n\n<p>when you use <em>CRT</em> and default linker settings - the <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/entry-entry-point-symbol?view=vs-2019\" rel=\"nofollow noreferrer\"><code>/entry:wmainCRTStartup</code></a> (also note that msdn if wrong here <em>The parameters and return value depend on if the program is a console application, a windows application</em> - this is false - not depend on this)</p>\n\n<p>the <code>wmainCRTStartup</code> already call your <code>wmain</code> with <em>argc, argv</em></p>\n\n<p>and finally about \"arguments\" of command line - what is arguments - this is already interpretation only. exist command line string, returned by <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processenv/nf-processenv-getcommandlinew\" rel=\"nofollow noreferrer\"><code>GetCommandLineW</code></a>. how interpret this string - already we absolute free here. </p>\n\n<hr>\n\n<p>as alternative solution if you not want use standard c/c++ CRT but want use <code>wmain</code> we can use <em>NT.LIB</em>  and <em>bufferoverflowU.lib</em> from <em>WDK</em></p>\n\n<p>in this case you need set <strong><code>/entry:NtProcessStartupW</code></strong> or <strong><code>/entry:NtProcessStartup</code></strong> - depend from are you want use Unicode or Ansi version and implement </p>\n\n<pre><code>extern \"C\"\nint __cdecl wmain(int argc, wchar_t *argv[ ], wchar_t *envp[ ], ULONG DebugFlags );\n</code></pre>\n\n<p>so real exe entry point will be <code>NtProcessStartup[W]</code> which call your <code>[w]main</code> with standard parse command line</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "edited": false, "score": 0, "creation_date": 1566998100, "post_id": 57693106, "comment_id": 101830712, "body": "Thanks for the explanation. Is the function signature <code>void __stdcall ExeEntrypoint()</code> (un)officially documented anywhere, or obtained via disassembly?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566998171, "post_id": 57693106, "comment_id": 101830752, "body": "when function no arguments - no different (except decoration name) which calling convention use (__stdcall, __cdecl, __fastcall - all will be have the same effect). by fact system pass 1 agrument to entry point, so <code>int __stdcall ExeEntrypoint(void*);</code> more exactly, but because after <code>ExeEntrypoint</code> return control (if at all return) just <code>ExitThread</code> called - no mistakes due incorrect stack pointer after return (on <i>x86</i>)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "edited": false, "score": 0, "creation_date": 1566998228, "post_id": 57693106, "comment_id": 101830799, "body": "@Lisbeth - formal <code>void __stdcall ExeEntrypoint()</code> this is wrong signature, correct <code>ULONG__stdcall ExeEntrypoint(void*)</code> but on practice no difference"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566998514, "post_id": 57693106, "comment_id": 101830982, "body": "@RbMm do you have a source to back up this claim of returning ULONG? And either way, returning might not end the process so it is not great advice. And yes, with no arguments the calling convention does not matter but the linker documentation on MSDN says stdcall! (This is only important for DllMain)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566998696, "post_id": 57693106, "comment_id": 101831089, "body": "no, i have no src, but i view windows code - <a href=\"https://i.imgur.com/nsqILi2.png\" rel=\"nofollow noreferrer\">i.imgur.com/nsqILi2.png</a> - this is from xp how minimum up to the latest win10. the same on x64 (here simply not visible calling convention) can belive me or check yourself. but what i say about entry point is 100%"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566998911, "post_id": 57693106, "comment_id": 101831219, "body": "@Anders - about <code>returning ULONG</code> - the returned value used as argument in call <a href=\"https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitthread\" rel=\"nofollow noreferrer\"><code>ExitThread</code></a> (ok - <code>RtlExitThread</code> if want be more exactly). so this is ulong (or int if want). but i not say that we must return from EP. really process can not terminate if we not call <code>ExitProcess</code> direct. but i say about formal signature only. EP have 1 parameter (pointer to PEB) and return valur formal used"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566999105, "post_id": 57693106, "comment_id": 101831369, "body": "@RbMm It would be more interesting to go back and see what Win95 and NT3 are doing. And even if they do pass a PEB pointer, I would still be nervous about using it in a real program."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566999108, "post_id": 57693106, "comment_id": 101831370, "body": "x64 variant - <a href=\"https://i.imgur.com/vSzSo7E.png\" rel=\"nofollow noreferrer\">i.imgur.com/vSzSo7E.png</a> - but src - i not responsible for windows documentation :)"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1566999280, "post_id": 57693106, "comment_id": 101831489, "body": "@Anders - but i not say that we need <b>use</b> it. i simply say that 1 argument passed to function. we can treat it as opaque. simply in usual case between <code>int __stdcall fn(void*)</code> and <code>int fn()</code> exist critical difference in usual case on x86 - 4 byte esp will be different after return. but because just <code>ExitThread</code> called - nothing affected"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567000007, "post_id": 57693106, "comment_id": 101831931, "body": "also if want - look this <a href=\"https://i.imgur.com/e6a7z1v.png\" rel=\"nofollow noreferrer\">i.imgur.com/e6a7z1v.png</a>. in wdk exist <i>nt.lib</i> lib file (designed for use in boot execute apps i think) here mini crt if want and entry point of application here named as <code>_NtProcessStartupW@4</code> and <code>_NtProcessStartup@4</code> (2 entry for unicode and ansi) - are lib from microsoft wdk - this is src for claim ?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567000231, "post_id": 57693106, "comment_id": 101832085, "body": "so can search in google for &quot;NtProcessStartupW&quot; &quot;NtProcessStartup&quot; - i dont know why all this not documented (reason), may be you understand this, but by fact 1 argument is present in exe entry point"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1567074541, "post_id": 57693106, "comment_id": 101858447, "body": "More information: <a href=\"https://devblogs.microsoft.com/oldnewthing/20110525-00/?p=10573\" rel=\"nofollow noreferrer\">WinMain is just the conventional name for the Win32 process entry point</a>."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567075726, "post_id": 57693106, "comment_id": 101859089, "body": "@RbMm See the link in the previous post, stdcall and &quot;The operating system calls the function with no parameters&quot; which is probably as close to documentation as we are going to get."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567076109, "post_id": 57693106, "comment_id": 101859324, "body": "@Anders - yes, i read this. but this is false (mistake ?) if you know asm (x86/x64) - you can easy look from where and how exe entry point is called. if want - can found this info in windows internals book.. what i say - simply fact. exist 1 parameter in call. and note - i do not suggest using it, i do not suggest return from entry point (when say that this have ULONG return value) - i simply say about formal and correct <b>signature</b>. you know - documentation not always correct. here i say how is in real word."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567077202, "post_id": 57693106, "comment_id": 101859870, "body": "sorry for question, i just really interested in your opinion, are you view itself that really 1 parameter used in call exe entry point ? despite what writtent in msdn, or how wmainCRTStartup() is declared. in practice, there are no differences even on x86 because just after EP return (if at all return) - call ExitThread and no matter already esp value, but formally 1 parameter really passed (checked from xp how minimum up to latest)."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567077834, "post_id": 57693106, "comment_id": 101860256, "body": "@RbMm I&#39;ll try to check Win95 tonight or tomorrow, then we can form an opinion whether this is a Win32 thing or a NT thing. I agree that it does not matter how the function is declared when <code>&#47;entry</code> is used. If <code>&#47;entry</code> is not used and you use <code>&#47;nodefaultlibs</code> it might matter though."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567078139, "post_id": 57693106, "comment_id": 101860440, "body": "but Win95 if i not mistake at all not compatible with all this. sorry but i never view this system and dont know it. but i think no any sense check here (on win95) - because another os, not compatible. assume that you write very basic app, used only ExitProcess call (without crt) - are such exe at all will be run on 95 ? check on win2000 and nt4 - already exist sense. but i only describe current state (from xp to win10)"}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "edited": false, "score": 0, "creation_date": 1567078981, "post_id": 57693106, "comment_id": 101860919, "body": "Of course Win95 matters, if 9x does not pass a PEB pointer (9x does not technically have a PEB but it does have a process struct pointed to by the TIB(TEB)) then you can&#39;t claim that this is a Win32 feature, that would make it a NT feature. The PE format and NT4/Win95 are mostly compatible except for missing security and some other minor differences when you code to the documented Win32 API."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567090720, "post_id": 57693106, "comment_id": 101868042, "body": "i not claim that this is win32 (or nt) feature. i claim (not more or less) that in [win xp, win10] exe entry point called and used as  <code>ULONG __stdcall ep(void* )</code> - called as __stdcall function with 1 argument (on practice this is pointer to PEB but i not suggest use it. simple note this fact) and return value (if ep returm but again - i not suggest return from ep) used in call <code>RtlExitUserThread</code> this is how now . i think that in win2000 also the same situation, but have not it and not view sense install this too old system."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567090870, "post_id": 57693106, "comment_id": 101868119, "body": "about 95 - dont know. i even dont know if take simply modern exe with minimal import (for not use new api) - are it at all can be run on win95. in PE exist in optional header major/minor operation system versions. even dont know what need set for 95 for run. less than 4.0 i think.."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567093911, "post_id": 57693106, "comment_id": 101869703, "body": "@rbm: The return value is not part of the signature."}, {"owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1567112441, "post_id": 57693106, "comment_id": 101877066, "body": "@RbMm Did you actually test on WinXP? See my picture in the updated answer. And just for the record, Win95 uses a normal PE header and the OS version is 4.0."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1567113733, "post_id": 57693106, "comment_id": 101877444, "body": "@Anders - oops. sorry i mistake. on xp really we have <code>ULONG ep()</code> signature - <a href=\"https://i.imgur.com/GWtURSf.png\" rel=\"nofollow noreferrer\">i.imgur.com/GWtURSf.png</a> on vista i not look, but on win7 already exist one parameter (pointer to PEB) - <a href=\"https://i.imgur.com/RT25246.png\" rel=\"nofollow noreferrer\">i.imgur.com/RT25246.png</a>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 1, "creation_date": 1567113968, "post_id": 57693106, "comment_id": 101877508, "body": "as side note <i>you become responsible for the initialization of argv &amp; argc</i> yes. another question for what reason not use c/c++ CRT. if not use it - also exist variant  link with <i>nt.lib</i> from <i>wdk</i> - in this case small entry point from this lib <code>NtProcessStartup[W]</code> initialize for us argc, argv and env and call <code>[w]main</code>"}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 3, "last_activity_date": 1567112336, "last_edit_date": 1567112336, "creation_date": 1566997385, "answer_id": 57693106, "question_id": 57686426, "link": "https://stackoverflow.com/questions/57686426/in-programs-compiled-without-crt-is-it-possible-to-read-command-line-arguments/57693106#57693106", "title": "In programs compiled without CRT, is it possible to read command-line arguments via argv?", "body": "<p>The C standard defines the behavior of <code>main</code> and its arguments. Windows does no such thing!</p>\n\n<p>The official PE specification says nothing about the entrypoint function. You should assume that it is simply <code>void __stdcall ExeEntrypoint();</code>.</p>\n\n<p>When using the Microsoft compiler, linker and run-time library the <a href=\"https://docs.microsoft.com/en-us/cpp/build/reference/entry-entry-point-symbol?view=vs-2019\" rel=\"nofollow noreferrer\">linker defaults the entrypoint</a> to a function named <code>[w]mainCRTStartup</code> in console programs.</p>\n\n<blockquote>\n  <p>By default, the starting address is a function name from the C run-time library. The linker selects it according to the attributes of the program, as shown in the following table.</p>\n</blockquote>\n\n<p><code>wmainCRTStartup</code> calls <code>GetCommandLineW</code> and parses the result into the <code>argc</code> &amp; <code>argv</code> pair which it uses when it calls your <code>main</code> function.</p>\n\n<p>When linking with <code>/entry:wmain</code> you remove <code>wmainCRTStartup</code> from the equation and <strong>you</strong> become responsible for the initialization of <code>argv</code> &amp; <code>argc</code> and all the other tasks performed by the function (initialize globals, <code>atexit</code> etc.).</p>\n\n<p>And just to lay this parameter issue to rest, I went back and tested some ancient versions and it seems you cannot trust it to be anything useful on older versions of Windows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dBVmQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBVmQ.png\" alt=\"95,NT4,98,XP,8\"></a></p>\n\n<p>It is possible that some time after WinXP it was finalized to point to the PEB but it is not part of any official specification.</p>\n"}], "owner": {"reputation": 129, "user_id": 10556799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/noxON.png?s=128&g=1", "display_name": "Lisbeth", "link": "https://stackoverflow.com/users/10556799/lisbeth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "accepted_answer_id": 57693106, "answer_count": 2, "score": 1, "last_activity_date": 1567112336, "creation_date": 1566974735, "question_id": 57686426, "link": "https://stackoverflow.com/questions/57686426/in-programs-compiled-without-crt-is-it-possible-to-read-command-line-arguments", "title": "In programs compiled without CRT, is it possible to read command-line arguments via argv?", "body": "<p>I've written a program to print out the command-line arguments it receives in a message box. </p>\n\n<pre><code>#include &lt;Windows.h&gt;\n\n#pragma comment(lib, \"user32.lib\")\n\nint wmain(int argc, LPCWSTR argv[])\n{\n    for (int k = 0; k &lt; argc; k++)\n    {\n        WCHAR szTemp[100];\n        wsprintfW(szTemp, argv[k]); // Yes, this is unsafe. Moving on...\n        MessageBoxW(0, szTemp, L\"from argv\", 0);\n        SecureZeroMemory(szTemp, 100);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>I then build it with the following commands:</p>\n\n<p><code>cl.exe /nologo /c /Zl /W4 /MT /GS- /wd4100 test.cpp</code></p>\n\n<p>and</p>\n\n<p><code>link.exe /nologo /subsystem:CONSOLE /entry:wmain /OUT:args.exe test.obj</code></p>\n\n<p>Upon execution, the program runs for some time and then terminates. No message box appears.</p>\n\n<p>I've verified that the analogous code using <code>CommandLineToArgvW</code> works as expected:</p>\n\n<pre><code>LPWSTR *szArglist;\nint nArgs;\n\nszArglist = CommandLineToArgvW(GetCommandLineW(), &amp;nArgs);\n\n// Error checking and cleanup elided here\nfor (int k = 0; k &lt; nArgs; k++)\n{\n    WCHAR szTemp[100];\n    wsprintfW(szTemp, szArglist[k]);\n    MessageBoxW(0, szTemp, L\"from CommandLineToArgvW\", 0);\n    SecureZeroMemory(szTemp, 100);\n}\n</code></pre>\n\n<p>In my debugger I can see that the program does enter the loop, but then it seems to hit an <code>EXCEPTION_ACCESS_VIOLATION</code> inside the <code>wsprintfW</code> function. What am I missing?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1566974834, "post_id": 57686357, "comment_id": 101818141, "body": "Please explain what you mean by &quot;rotate&quot;. Manipulate the matrix so that it has its values in different places? Output the matrix column-by-column instead row-by-row but not change it in any way? Please show desired result or output."}, {"owner": {"reputation": 41, "user_id": 11982132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9269ac2c1dc8e3e5a2e0a4d6c3c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "AlexUnskilled", "link": "https://stackoverflow.com/users/11982132/alexunskilled"}, "edited": false, "score": 0, "creation_date": 1566975089, "post_id": 57686357, "comment_id": 101818258, "body": "Just specified what exactly i want. sorry :)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 2, "creation_date": 1566975331, "post_id": 57686357, "comment_id": 101818365, "body": "@AlexUnskilled Are you aware that your program does <b>not</b> rotate any matrix? It simply prints two <b>different</b> matrix variables that are initialized in different ways."}, {"owner": {"reputation": 41, "user_id": 11982132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9269ac2c1dc8e3e5a2e0a4d6c3c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "AlexUnskilled", "link": "https://stackoverflow.com/users/11982132/alexunskilled"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1566975442, "post_id": 57686357, "comment_id": 101818412, "body": "@4386427 yes, i am aware of that. I just switched the x and y variables in the 2nd one. I couldn&#39;t think of a way to actually rotate it."}, {"owner": {"reputation": 41, "user_id": 11982132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9269ac2c1dc8e3e5a2e0a4d6c3c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "AlexUnskilled", "link": "https://stackoverflow.com/users/11982132/alexunskilled"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566975838, "post_id": 57686357, "comment_id": 101818588, "body": "@Lundin alright, then I&#39;ll try to figure something out myself. o/"}, {"owner": {"reputation": 1820, "user_id": 7209631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2ad26cdac82ab360fb4fd572febf351?s=128&d=identicon&r=PG&f=1", "display_name": "Baris Yakut", "link": "https://stackoverflow.com/users/7209631/baris-yakut"}, "edited": false, "score": 0, "creation_date": 1566976350, "post_id": 57686357, "comment_id": 101818809, "body": "Have a look at this: <a href=\"https://stackoverflow.com/questions/30647682/c-matrix-rotation\">stackoverflow.com/questions/30647682/c-matrix-rotation</a>"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1566977269, "post_id": 57686357, "comment_id": 101819225, "body": "Might I ask, what do you intend to do with the &quot;rotated&quot; matrix?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566977925, "post_id": 57686357, "comment_id": 101819508, "body": "Sadly @Lundin there are folk on this site who will do exactly that."}], "answers": [{"tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": false, "score": 4, "last_activity_date": 1566976485, "last_edit_date": 1566976485, "creation_date": 1566976169, "answer_id": 57686757, "question_id": 57686357, "link": "https://stackoverflow.com/questions/57686357/how-do-i-rotate-a-matrix-c/57686757#57686757", "title": "How do I rotate a matrix? C", "body": "<p>80% of work is declaring your functions and understanding what the declarations mean. You can start like this:</p>\n\n<pre><code>#define x 5\n#define y 7\n\nvoid build(int output[y][x]);\n</code></pre>\n\n<p>This declares a function <code>build</code>, which receives a matrix, and fills it with the needed data. Note: it doesn't return anything (i.e. returns <code>void</code>); instead of returning the data, it receives the pointer which it should write to. This is standard practice in C, because you cannot return arrays from functions.</p>\n\n<p>I didn't write the code for it yet because it would distract you from understanding the flow of information in your program:</p>\n\n<pre><code>int main()\n{\n    int matrix_before_rotation[y][x];\n    build(matrix_before_rotation);\n}\n</code></pre>\n\n<p>This hypothetical program fills a matrix with values, using your function. It doesn't print it, but you could see the values if you used e.g. a debugger.</p>\n\n<p>To declare a function which does the rotation:</p>\n\n<pre><code>void turn(int input[y][x], int output[x][y]);\n</code></pre>\n\n<p>Note the difference in dimensions, and the fact that the function receives two arguments - one for input, and one for output. You need to allocate two matrices in your main program:</p>\n\n<pre><code>int main()\n{\n    int matrix_before_rotation[y][x];\n    int matrix_after_rotation[x][y];\n    build(matrix_before_rotation);\n    turn(matrix_before_rotation, matrix_after_rotation);\n}\n</code></pre>\n\n<p>Given this code structure, it's easy to fill in the implementation details.</p>\n\n<p>You might want to add a function for printing a matrix while you are debugging your program:</p>\n\n<pre><code>#define x 5\n#define y 7\n\nvoid build(int output[y][x]);\nvoid turn(int input[y][x], int output[x][y]);\nvoid print(int height, int width, int input[height][width]);\n\nint main()\n{\n    int matrix_before_rotation[y][x];\n    int matrix_after_rotation[x][y];\n    build(matrix_before_rotation);\n    print(y, x, matrix_before_rotation);\n    turn(matrix_before_rotation, matrix_after_rotation);\n    print(x, y, matrix_after_rotation);\n}\n</code></pre>\n\n<p>Note: the printing function is more generic than the generating and the rotating functions - it knows how to work with matrices of any dimensions. You need it because you need at least two types of matrices in your new program - [7][5] and [5][7]. You can use this idea to generalize your rotating function so it could work with matrices of any dimensions.</p>\n"}, {"tags": [], "owner": {"reputation": 274, "user_id": 11643854, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1UgDE.jpg?s=128&g=1", "display_name": "arvind", "link": "https://stackoverflow.com/users/11643854/arvind"}, "is_accepted": true, "score": 1, "last_activity_date": 1566977507, "creation_date": 1566977507, "answer_id": 57687106, "question_id": 57686357, "link": "https://stackoverflow.com/questions/57686357/how-do-i-rotate-a-matrix-c/57687106#57687106", "title": "How do I rotate a matrix? C", "body": "<p>Just a little modification to your code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define x 3 \n#define y 4\nint build() {\n    int i = 0, k = 0;\n    int matrix[x][y];\n\n    for (i = 0; i &lt; x; ++i) {\n            for (k = 0; k &lt; y; ++k) {\n                    matrix[i][k] = i;\n            }\n    }\n    for (i = 0; i &lt; x; ++i) {\n            for (k = 0; k &lt; y; ++k) {\n                    printf(\"\\t%d\", matrix[i][k]);\n            }\n            printf(\"\\n\");\n    }\n    return matrix[i][k];} \n//for right turn you will have to modify the loop like this\nint r_turn() \n{\n\n    int i = 0, k = 0;\n    int matrix[x][y];\n    for(i=0; i&lt;y; i++)     //for outer loop, take y, because you're rotating \n                           //loop , and y will come before x\n    {\n            for(k=x-1; k&gt;=0; k--)    //thereby, x goes after y \n            {\n                    matrix[k][i] = k;\n            } \n    }\n    for(i=0; i&lt;y; i++)          //printing matrix in the same way we wrote\n    {\n            for(k=x-1; k&gt;=0; k--)         //here, k will start from k because \n                                          //index starts from 0\n            {\n                    printf(\"\\t%d\", matrix[k][i]);\n            }\n            printf(\"\\n\");\n    }\n}\nint main()\n{\n    build();\n    printf(\"\\t\\n\");\n    r_turn();\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11982132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9269ac2c1dc8e3e5a2e0a4d6c3c1369a?s=128&d=identicon&r=PG&f=1", "display_name": "AlexUnskilled", "link": "https://stackoverflow.com/users/11982132/alexunskilled"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "closed_date": 1566978155, "accepted_answer_id": 57687106, "answer_count": 2, "score": 1, "last_activity_date": 1566977507, "creation_date": 1566974370, "last_edit_date": 1566975053, "question_id": 57686357, "link": "https://stackoverflow.com/questions/57686357/how-do-i-rotate-a-matrix-c", "closed_reason": "Needs more focus", "title": "How do I rotate a matrix? C", "body": "<p>I want a matrix to rotate right. It's working for a square matrix, but i should also work for non square matrix.</p>\n\n<p>I tried rotating it, but i couldn't think of a way to get it to work for non square matrix.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define x 7\n#define y 7\n\nint build() {\n    int i = 0, k = 0;\n    int matrix[x][y];\n\n    for (i = 0; i &lt; x; ++i) {\n        for (k = 0; k &lt; y; ++k) {\n            matrix[i][k] = i;\n        }\n    }\n    for (i = 0; i &lt; x; ++i) {\n        for (k = 0; k &lt; y; ++k) {\n            printf(\"\\t%d\", matrix[k][i]);\n        }\n        printf(\"\\n\");\n    }\n    return matrix[i][k];\n}\n\nint turn() \n{\n    int i = 0, k = 0;\n    int matrix[x][y];\n\n    for (i = 0; i &lt; x; ++i) {\n        for (k = 0; k &lt; y; ++k) {\n            matrix[i][k] = i;\n        }\n    }\n    for (i = 0; i &lt; x; ++i) {\n        for (k = 0; k &lt; y; ++k) {\n            printf(\"\\t%d\", matrix[i][k]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nint main()\n{\n    build();\n    printf(\"\\t\\n\");\n    turn();\n}\n</code></pre>\n\n<p>i want it to work for diffrent variables like x=5 and y=7.</p>\n\n<p>My thought was to rotate the matrix by 90 degrees.</p>\n\n<p>from </p>\n\n<p>0 0 0 0</p>\n\n<p>1 1 1 1</p>\n\n<p>2 2 2 2</p>\n\n<p>to </p>\n\n<p>2 1 0</p>\n\n<p>2 1 0</p>\n\n<p>2 1 0</p>\n\n<p>2 1 0</p>\n"}, {"tags": ["c", "mpi"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 1, "creation_date": 1566972852, "post_id": 57685788, "comment_id": 101817402, "body": "<code>memcpy( rowsPerProcess + 2, oneRow, sizeof(oneRow) );</code> is fishy. And so is the fact that only 4 <code>MPI_UNSIGNED_CHAR</code> are sent but 20 are received."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567046329, "post_id": 57685788, "comment_id": 101848038, "body": "this question is a run-time problem  Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can help you debug it.  BTW: include the <code>#include</code> statements so we know which headers you included"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567046700, "post_id": 57685788, "comment_id": 101848116, "body": "regarding: <code>std.id = 105;                     std.age = 18;                 } else {                     std.id = 100;                     std.age = 20;</code>  the values are no (generally) ascii printable characters.  Strongly suggest using something like: <code>printf(&quot;first student&#39;s ID: %u\\n&quot;, allRows[0].id);</code>  (notice the format specifier <code>%u</code>  To print those unsigned values"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567046871, "post_id": 57690407, "comment_id": 101848159, "body": "OT: the name <code>send</code> is a well known function from the C library.  It is a very bad idea to name variables the same as C library functions."}, {"owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567064351, "post_id": 57690407, "comment_id": 101853106, "body": "Changed the variable name."}, {"owner": {"reputation": 43, "user_id": 7722821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2102eb6a3a3125022a31a043b827e9?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/7722821/thomas"}, "edited": false, "score": 0, "creation_date": 1567066205, "post_id": 57690407, "comment_id": 101854133, "body": "Thank you for your answer! I&#39;ve understand quite a lot from your explanation but what I&#39;m also trying to do is to accumulate the array from rank1 in the array from rank 0. meaning my array in rank 0 will be like [ {id: 2, age: 18}, {id: 3, age:19}, {id: 4, age:20}, {id: 5, age:21} ] . Id 2 and 3 is being generated in rank 0 and Id 4 and 5 will be generated in rank 1 but rank 1 will send its array to rank 0 then rank 0 will take the data and append to its own array resulting to have the final array like this."}, {"owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "edited": false, "score": 0, "creation_date": 1567072807, "post_id": 57690407, "comment_id": 101857481, "body": "So you have a structure array <code>allRows</code> which stores own values and receives the values from others. Also each individual process has a <code>oneRow</code> which stores its own value.So, your goal is to send the data in struct of <code>oneRow</code> from all processes to rank 0.  To do that, all processes can send its own values using using <code>MPI_Send(oneRow,...)</code>  and use a loop inside rank 0 to receive from n process. While receiving  <code>MPI_Recv(&amp;allRows[i],..,MPI_ANY_SOURCE,..) </code>, you can append the values at struct  <code>allRows </code> in the desired index by using  <code>&amp;allRows[i] </code>."}], "tags": [], "owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "is_accepted": false, "score": 1, "last_activity_date": 1567064301, "last_edit_date": 1567064301, "creation_date": 1566988357, "answer_id": 57690407, "question_id": 57685788, "link": "https://stackoverflow.com/questions/57685788/how-to-send-receive-an-array-of-structure-to-from-other-processor/57690407#57690407", "title": "How to send/receive an array of structure to/from other processor?", "body": "<p>In the sample code provided by you, you don't need to use <code>memcpy</code> at all to achieve the desired objective. You can directly send the structure elements from the object <code>oneRow</code> itself. The outer loop is also unnecessary. So the below code will make the send and receive work. Also, you are sending <code>4</code> characters and receiving <code>20</code>.</p>\n\n<pre><code>if(rank != 0) {\n            for (int x = 0; x &lt; 2; x++) {\n                if (x == 0) {\n                    std.id = 'a';\n                    std.age = 'b';\n                } else {\n                    std.id = 'c';\n                    std.age = 'd';\n                }\n                   oneRow[x] = std;\n        }\n        MPI_Send(oneRow, 4, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);\n       } else {\n        MPI_Recv(oneRow, 4, MPI_UNSIGNED_CHAR, 1, 0, MPI_COMM_WORLD, &amp;stat);\n        printf(\"first student's ID: %c\\n\", oneRow[0].id);\n        printf(\"first student's age: %c\\n\", oneRow[0].age);\n        printf(\"second student's ID: %c\\n\", oneRow[1].id);\n        printf(\"second student's age: %c\\n\", oneRow[1].age);\n\n    }\n</code></pre>\n\n<p>To send structures in MPI, the best way to do is to create <strong>derived data type</strong> using <code>MPI_Type_create_struct</code>. If the two characters are aligned in a contiguous memory area (i.e., like in the above example.), you don't need a <code>derived datatype</code>. </p>\n\n<p>For a struct:</p>\n\n<pre><code>   typedef  struct student_t {\n        int  id;\n        int age;\n    }student;\n</code></pre>\n\n<p>You can create a derived data type in MPI using the following:</p>\n\n<pre><code>/* create a type for struct student */\nconst int nitems=2; // Number of Elements in struct\nint blocklengths[2] = {1,1};\nMPI_Datatype types[2] = {MPI_INT, MPI_INT}; // data type of struct elements\nMPI_Datatype mpi_std_type; //derived type name\nMPI_Aint     offsets[2]; // offset of the variable\n\noffsets[0] = offsetof(student, age);\noffsets[1] = offsetof(student, id);\n\nMPI_Type_create_struct(nitems, blocklengths, offsets, types, &amp;mpi_std_type);\nMPI_Type_commit(&amp;mpi_std_type);\n</code></pre>\n\n<p>You can then create the array of struct as <code>student send[2]</code> and send it using <code>MPI_Send()</code> as <code>MPI_Send(&amp;send,   2, mpi_std_type, dest, tag, MPI_COMM_WORLD);</code> using the derived data type (<code>mpi_std_type</code>) as the type of the data. Similarly also in the receiver side.</p>\n\n<p>So the resulting program will look like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;mpi.h&gt;\n#include &lt;stddef.h&gt;\n\n   typedef  struct student_t {\n        int  id;\n        int age;\n    }student;\n\nint main(int argc, char **argv) {\n\n    const int tag = 13;\n    int size, rank;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n\n    /* create a type for struct student */\n    const int nitems=2;\n    int          blocklengths[2] = {1,1};\n    MPI_Datatype types[2] = {MPI_INT, MPI_INT};\n    MPI_Datatype mpi_std_type;\n    MPI_Aint     offsets[2];\n\n    offsets[0] = offsetof(student, age);\n    offsets[1] = offsetof(student, id);\n\n    MPI_Type_create_struct(nitems, blocklengths, offsets, types, &amp;mpi_std_type);\n    MPI_Type_commit(&amp;mpi_std_type);\n\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    if (rank == 0) {\n        student send_struct[2];\n        send_struct[0].id = 1;\n        send_struct[0].age = 2;\n\n        send_struct[1].id = 3;\n        send_struct[1].age = 4;\n        const int dest = 1;\n        MPI_Send(&amp;send_struct,   2, mpi_std_type, dest, tag, MPI_COMM_WORLD);\n\n        printf(\"Rank %d: sent structure student\\n\", rank);\n    }\n    if (rank == 1) {\n        MPI_Status status;\n        const int src=0;\n\n        student recv_struct[2];\n\n        MPI_Recv(&amp;recv_struct,   2, mpi_std_type, src, tag, MPI_COMM_WORLD, &amp;status);\n        printf(\"Rank %d: Received: id = %d age = %d \\n\", rank,\n                 recv_struct[0].id, recv_struct[0].age);\n\n        printf(\"Rank %d: Received: id = %d age = %d \\n\", rank,\n                 recv_struct[1].id, recv_struct[1].age);\n    }\n\n    MPI_Type_free(&amp;mpi_std_type);\n    MPI_Finalize();\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "edited": false, "score": 0, "creation_date": 1567071915, "post_id": 57694971, "comment_id": 101856993, "body": "Following the above steps won&#39;t fix the problem. From my run, It will only print 0 instead of an empty space. Have you tried it on your system?"}, {"owner": {"reputation": 368, "user_id": 8510405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b0a5cd56bd96dfbfd2c73ffeea411c?s=128&d=identicon&r=PG&f=1", "display_name": "Amila Senadheera", "link": "https://stackoverflow.com/users/8510405/amila-senadheera"}, "reply_to_user": {"reputation": 1898, "user_id": 10911932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iZ5XI.gif?s=128&g=1", "display_name": "j23", "link": "https://stackoverflow.com/users/10911932/j23"}, "edited": false, "score": 0, "creation_date": 1567235023, "post_id": 57694971, "comment_id": 101911042, "body": "Yes, it prints the expected values not zeros."}], "tags": [], "owner": {"reputation": 368, "user_id": 8510405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b0a5cd56bd96dfbfd2c73ffeea411c?s=128&d=identicon&r=PG&f=1", "display_name": "Amila Senadheera", "link": "https://stackoverflow.com/users/8510405/amila-senadheera"}, "is_accepted": false, "score": 1, "last_activity_date": 1567003338, "creation_date": 1567003338, "answer_id": 57694971, "question_id": 57685788, "link": "https://stackoverflow.com/questions/57685788/how-to-send-receive-an-array-of-structure-to-from-other-processor/57694971#57694971", "title": "How to send/receive an array of structure to/from other processor?", "body": "<p>You can get to log what you need by following steps,</p>\n\n<p>1) You need to change <code>count</code> to be the same amount. So replace <code>20</code> with <code>4</code>.</p>\n\n<p>2) Replace <code>%c</code> to <code>%d</code> to see the integer values. Otherwise you will see useless character symbols.   </p>\n"}], "owner": {"reputation": 43, "user_id": 7722821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2102eb6a3a3125022a31a043b827e9?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/7722821/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1567064301, "creation_date": 1566971280, "question_id": 57685788, "link": "https://stackoverflow.com/questions/57685788/how-to-send-receive-an-array-of-structure-to-from-other-processor", "title": "How to send/receive an array of structure to/from other processor?", "body": "<p>I'm trying to store structures into an array and use MPI to send it to other processor(rank 0) but when I receive it at rank 0, I can't seem to read the data as it doesn't output it when I want to print. Let's say there are only 2 processors. I'm very new in C. </p>\n\n<p>This my code:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n\n    int rank, size;\n\n    MPI_Init(&amp;argc, &amp;argv);\n    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);\n    MPI_Comm_size(MPI_COMM_WORLD, &amp;size);\n    MPI_Status stat;\n\n    struct student {\n        unsigned char id;\n        unsigned char age;\n    };\n\n    struct student *ptrA;\n    struct student std;\n    struct student oneRow[10];\n    struct student rowsPerProcess[30];\n    struct student allRows[50];\n\n\n    if(rank != 0) {\n\n        for (int y = 0; y &lt; 2; y++) {\n            for (int x = 0; x &lt; 2; x++) {\n\n                if (x == 0) {\n                    std.id = 105;\n                    std.age = 18;\n                } else {\n                    std.id = 100;\n                    std.age = 20;\n                }\n\n                oneRow[x] = std;\n            }\n            memcpy( rowsPerProcess + 2, oneRow, sizeof(oneRow) );\n        }\n\n        MPI_Send(rowsPerProcess, 4, MPI_UNSIGNED_CHAR, 0, 0, MPI_COMM_WORLD);\n\n    } else {\n        MPI_Recv(allRows, 20, MPI_UNSIGNED_CHAR, 1, 0, MPI_COMM_WORLD, &amp;stat);\n        printf(\"first student's ID: %c\\n\", allRows[0].id);\n        printf(\"first student's age: %c\\n\", allRows[0].age);\n\n        printf(\"second student's ID: %c\\n\", allRows[1].id);\n        printf(\"second student's age: %c\\n\", allRows[1].age);\n\n    }\n\n    MPI_Finalize();\n    return 0;\n\n}\n</code></pre>\n\n<p>This is my output, I can print the strings but not the data (eg: <code>allRows[0].id</code>):</p>\n\n<pre><code>first student's ID:\nfirst student's age: \nsecond student's ID: \nsecond student's age:\n</code></pre>\n"}, {"tags": ["python", "c", "linux", "ubuntu", ".so"], "answers": [{"tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1566976408, "creation_date": 1566976408, "answer_id": 57686811, "question_id": 57685663, "link": "https://stackoverflow.com/questions/57685663/how-to-load-so-libraryes-in-my-python-app-that-is-running-on-ubuntu/57686811#57686811", "title": "How to load .so libraryes in my Python app that is running on Ubuntu", "body": "<p>You can use <code>ctypes</code> for that, it's quite simple.</p>\n\n<p>Say that you have a <code>my-library.so</code> with the following C function exported:</p>\n\n<pre><code>void say_hello(char *name) {\n    printf(\"Hello, %s!\\n\", name);\n}\n</code></pre>\n\n<p>You would load the library and call the function from Python like this:</p>\n\n<pre><code>&gt;&gt;&gt; from ctypes import cdll\n&gt;&gt;&gt; mylib = cdll.LoadLibrary('./my-library.so')\n&gt;&gt;&gt; mylib.say_hello(\"world\")\nHello, world!\n&gt;&gt;&gt;\n</code></pre>\n\n<p>Note that the leading <code>./</code> is important, otherwise <code>LoadLibrary</code> will look in the default library path and not the current folder.</p>\n\n<p>Fore more information refer to <a href=\"https://docs.python.org/3.5/library/ctypes.html#module-ctypes\" rel=\"nofollow noreferrer\">the documentation for <code>ctypes</code></a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6532119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36daa532ba427a87eef078bd47c33774?s=128&d=identicon&r=PG&f=1", "display_name": "anjuli", "link": "https://stackoverflow.com/users/6532119/anjuli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566976770, "creation_date": 1566970616, "last_edit_date": 1566976770, "question_id": 57685663, "link": "https://stackoverflow.com/questions/57685663/how-to-load-so-libraryes-in-my-python-app-that-is-running-on-ubuntu", "title": "How to load .so libraryes in my Python app that is running on Ubuntu", "body": "<p>I have some shared object files (.so libs) that I need to load in my python project that will run on Ubuntu platform.</p>\n\n<p>The goal is that I have some libraries that have already been converted into .so files and now I need to load them in my python project.</p>\n\n<p>Can anyone share the detailed steps for this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 130214, "user_id": 772035, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/jAEqI.jpg?s=128&g=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/772035/paul"}, "edited": false, "score": 1, "creation_date": 1566959831, "post_id": 57684322, "comment_id": 101814580, "body": "It&#39;s perfectly valid to have an array of chars that doesn&#39;t end in a <code>\\0</code>, it&#39;s just not called a string then, and it would be unsafe to use the <code>str*</code> functions in <code>string.h</code>."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1566961689, "post_id": 57684322, "comment_id": 101814863, "body": "the null-terminator is just needed for C-string functions like strlen, strcpy... If you use it as an array then obviously no null-termination is needed"}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1567054995, "post_id": 57684322, "comment_id": 101849676, "body": "What hasn&#39;t been mentioned is that you can null-terminate the string at any point in the array, not just at the last element, so that you can store strings of varying lengths. Knowing the array length doesn&#39;t actually tell you how long the string is."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566960792, "post_id": 57684357, "comment_id": 101814723, "body": "thanks for this explanation. Why, then, is that not required of non-char arrays? How does C detect the end of a non-char array?"}, {"owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "edited": false, "score": 0, "creation_date": 1566961119, "post_id": 57684357, "comment_id": 101814778, "body": "@Shared C does not detect the end of the non-char array. you may declare an array of a single element and try to access any element, getting back some data or Segmentation Fault of you go too far. You basically have to control the size of the arrays yourself using <code>sizeof(arr)&#47;sizeof(*arr)</code> construction or dropping arrays altogether and switching to much easier to use <code>vector</code> from STL library."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1566963248, "post_id": 57684357, "comment_id": 101815081, "body": "@Shared, C does not detect the end of arrays of <i>any</i> type, including <code>char</code>.  It detects the end of <i>strings</i>, which is a form that part or all of the <i>contents</i> of a <code>char</code> array may take.  <code>char</code> arrays do not inherently need to be null terminated, and sometimes they (intentionally) aren&#39;t."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1566959864, "creation_date": 1566959864, "answer_id": 57684357, "question_id": 57684322, "link": "https://stackoverflow.com/questions/57684322/terminating-character-arrays/57684357#57684357", "title": "Terminating character arrays", "body": "<p>Strings in C are a special case of arrays.  Specifically, they are arrays of <code>char</code> that are null terminated.</p>\n\n<p>In this case:</p>\n\n<pre><code>char v2[] = \"hello\";\n</code></pre>\n\n<p>The array <code>v2</code> is initialized with the string constant <code>\"hello\"</code>.  The size of this constant is 6, so the size of the array is 6.  This also means that the array contains a string and it can be passed to functions that expect a string.</p>\n\n<p>For this:</p>\n\n<pre><code>char v3[] = {'h', 'e', 'l', 'l', 'o'}\n</code></pre>\n\n<p><code>v3</code> is an array of <code>char</code> of size 5 because it is initialized with 5 elements.   It is <strong>not</strong>  however a string because it is not null terminated.</p>\n"}, {"tags": [], "owner": {"reputation": 21554, "user_id": 1329296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1026699dbf4140d3fc7262842428e808?s=128&d=identicon&r=PG", "display_name": "lenik", "link": "https://stackoverflow.com/users/1329296/lenik"}, "is_accepted": false, "score": 2, "last_activity_date": 1566960211, "creation_date": 1566960211, "answer_id": 57684394, "question_id": 57684322, "link": "https://stackoverflow.com/questions/57684322/terminating-character-arrays/57684394#57684394", "title": "Terminating character arrays", "body": "<p>There's concept of <code>strings</code> in C, because it's convenient for the text processing. By the common agreement, strings in C end up with '\\0' byte to mark the end of the string. Strings can be declared as:</p>\n\n<pre><code>char str[] = {'h', 'e', 'l', 'l', 'o', '\\0'}\n</code></pre>\n\n<p>but to make life easier, there's a commonly used short form of the same:</p>\n\n<pre><code>char str[] = \"hello\";\n</code></pre>\n\n<p>You may think of the latter being just an easier to type version of the former.</p>\n"}, {"tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": true, "score": 4, "last_activity_date": 1566992855, "last_edit_date": 1566992855, "creation_date": 1566960948, "answer_id": 57684469, "question_id": 57684322, "link": "https://stackoverflow.com/questions/57684322/terminating-character-arrays/57684469#57684469", "title": "Terminating character arrays", "body": "<p>The question is not what the array does or doesn't contain, or what the compiler \"knows\" about the array size.  The question is simply: how will we use the array once it's created, and in particular, how will <em>we</em> remember (how will the code we write and use know) how big the array is?</p>\n\n<p>Although the compiler always knows, as it compiles the code, exactly how big each array is, that's a compile-time thing, not a run-time thing.  There's no mechanism provided by the language that will tell us, at run time, how big an arbitrary array is.  So it's up to us (so to speak) to figure it out.</p>\n\n<p>And that's where null termination comes in.  It's a convention in C (but a very important one!) that when you have an array of type <code>char</code>, and when you're using that array as a \"string', that the string must always be terminated by <code>\\0</code>.  Every C function that deals with strings -- the predefined ones in the standard C library, along with any string-manipulating functions we might write -- every function depends on this convention.  If you have an array of <code>char</code> that's not null-terminated, and if you hand it to a string-processing function, the function will sail right off the end when it tries to figure out how big the string is, with variously undefined results.</p>\n\n<p>By contrast to using a \"sentinel value\" like <code>\\0</code> to terminate an array, the other principal way to keep track of an array's size is with a separate \"count\" variable off to the side.  That's how we'd probably keep track of your array <code>v1</code>, either by using</p>\n\n<pre><code>int v1size = 3;\n</code></pre>\n\n<p>or maybe</p>\n\n<pre><code>int v1size = sizeof(v1) / sizeof(v1[0]);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>How does c \"know\" when v1 ends, but it needs the '\\0' in the character array to know when that ends?</p>\n</blockquote>\n\n<p>The compiler is fully aware of how big each array is.  (It's the compiler that <em>adds</em> the <code>\\0</code> to <code>v2</code>, so it <em>has</em> to know!)  The real question is, how does <em><code>printf</code></em> know?</p>\n\n<blockquote>\n  <p>what would happen if... it was written as <code>char v3[] = {'h', 'e', 'l', 'l', 'o'}</code> (other than getting out-of-bounds when I use a for-loop to detect the end of it).</p>\n</blockquote>\n\n<p>Nothing would happen, except that you (and <code>printf</code>, and <code>strlen</code>, and <code>strcpy</code>, and everybody else) would get get out-of-bounds errors (or the equivalent) when they tried to detect the end of it.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/4418708\">What's the rationale for null terminated strings?</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 3, "last_activity_date": 1566975157, "creation_date": 1566975157, "answer_id": 57686518, "question_id": 57684322, "link": "https://stackoverflow.com/questions/57684322/terminating-character-arrays/57686518#57686518", "title": "Terminating character arrays", "body": "<p>When the C language was made, they made a design decision not to automatically store array sizes in the generated executable. That's the root of all this.</p>\n\n<p>You are mixing up what the compiler knows and what the run-time libraries know. In all your 3 examples, the compiler knows exactly how large each array is and how many elements it contains - it can be determined at compile-time.</p>\n\n<p>However, that information remains internal to the compiler and the size of arrays are not stored in the executable. And so the array size can't get automatically passed on to run-time libraries like <code>string.h</code>, because it isn't stored anywhere. </p>\n\n<p>Instead the library functions get a <code>char*</code>, which is just a pointer to the first element of the array, with no other information provided. In order to know where the valid data ends, a null terminator is therefore needed.</p>\n\n<p>Similarly, if you would swap the array syntax for a pointer, <code>char* p = \"hello\";</code>, then the compiler wouldn't be able to know the size of what <code>p</code> points to either. If you'd use <code>sizeof(p)</code> you would merely get the size of the pointer and not the array it points at.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 57684469, "answer_count": 4, "score": 0, "last_activity_date": 1566992855, "creation_date": 1566959461, "question_id": 57684322, "link": "https://stackoverflow.com/questions/57684322/terminating-character-arrays", "title": "Terminating character arrays", "body": "<p>I'm trying to understand c arrays and why some types (such as chars) require a null terminator but other types do not. Take the the following three arrays</p>\n\n<pre><code>int v1[] = {1, 2, 3};\nchar v2[] = \"hello\";\nchar v3[] = {'h', 'e', 'l', 'l', 'o', '\\0'}\n</code></pre>\n\n<p>How does c \"know\" when v1 ends, but it needs the '\\0' in the character array to know when that ends? What makes the character different than a number in requiring a sort of fake-character at the end to tell the program it's completed? For example, what would happen, if instead of writing <code>char v3[] = {'h', 'e', 'l', 'l', 'o', '\\0'}</code>, it was written as <code>char v3[] = {'h', 'e', 'l', 'l', 'o'}</code> (other than getting out-of-bounds when I use a for-loop to detect the end of it).</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 4, "creation_date": 1566959265, "post_id": 57684259, "comment_id": 101814496, "body": "Wait. You wrote this code, but you&#39;re asking why it was written this way?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566959498, "post_id": 57684259, "comment_id": 101814533, "body": "Test the row number before the column number because it is a simpler test.  You might even be able to measure the difference, though it is probably dwarfed by the cost of the I/O."}, {"owner": {"reputation": 513, "user_id": 3745692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e6e91b4d19ab46d2283dee26d7d5f60?s=128&d=identicon&r=PG", "display_name": "Ale", "link": "https://stackoverflow.com/users/3745692/ale"}, "edited": false, "score": 0, "creation_date": 1566987821, "post_id": 57684259, "comment_id": 101824905, "body": "You can always rewrite an OR-expression as an AND-expression by negating each term as well as the result, and vice-versa.  Can also apply distributive laws."}], "answers": [{"tags": [], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "is_accepted": false, "score": 1, "last_activity_date": 1566959529, "creation_date": 1566959529, "answer_id": 57684330, "question_id": 57684259, "link": "https://stackoverflow.com/questions/57684259/why-using-operator-or-logical-operator-in-if-else-why-not-using-and-logcial/57684330#57684330", "title": "Why using operator OR (logical operator) in if-else, why not using AND (logcial operator) in if-else", "body": "<ul>\n<li><code>column==1 || column==2</code> will be true when <code>column</code> is <code>1</code> OR when <code>column</code> is <code>2</code></li>\n<li><code>column==1 &amp;&amp; column==2</code> will be true when <code>column</code> is <code>1</code> AND when <code>column</code> is <code>2</code>. That can never happen as a variable cannot be <code>1</code> and <code>2</code> at the same time, so this condition will always be false.</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11131215, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-26biUX7yxyc/AAAAAAAAAAI/AAAAAAAAAB0/6Skd7jsNjg4/photo.jpg?sz=128", "display_name": "Alja Yadi", "link": "https://stackoverflow.com/users/11131215/alja-yadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "closed_date": 1566971883, "answer_count": 1, "score": -5, "last_activity_date": 1566959529, "creation_date": 1566958729, "question_id": 57684259, "link": "https://stackoverflow.com/questions/57684259/why-using-operator-or-logical-operator-in-if-else-why-not-using-and-logcial", "closed_reason": "Needs details or clarity", "title": "Why using operator OR (logical operator) in if-else, why not using AND (logcial operator) in if-else", "body": "<p>I made the alphabet with the appearance of using stars to form the alphabet, but I was confused as to why to use the OR operation instead of the AND operation on if-else?</p>\n\n<pre><code>int row,column;\nfor(row=1;row&lt;=4;row++){\n    for(column=1;column&lt;=7;column++){\n        if((column==1 || column==2 || column==3 || column==5 || column==6 || column==7) &amp;&amp; (row==1))\n            printf(\" \");\n        else if((column==1 || column==2 || column==4 || column==6 || column==7) &amp;&amp; (row==2))\n            printf(\" \");\n        else if((column==1 || column==7) &amp;&amp; (row==3))\n            printf(\" \");\n        else if((column==2 || column==3 || column==4 || column==5 || column==6) &amp;&amp; (row==4))\n            printf(\" \");\n        else\n            printf(\"*\");\n    } printf(\"\\n\");\n}\n</code></pre>\n\n<p>Why using operator || in if-else? why not using operator &amp;&amp; in if-else for condition column...</p>\n"}, {"tags": ["c", "ssl", "mqtt", "paho"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566975747, "post_id": 57684044, "comment_id": 101818546, "body": "That is not an SSL error. Read it."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1566975917, "post_id": 57684044, "comment_id": 101818621, "body": "I would suggest running your program with <code>strace -e trace=open,openat,stat,fstat -s200 .&#47;yourprogram</code> and looking specially at the <code>open()</code> or <code>openat()</code> calls that return <code>ENOENT</code> (which is &quot;No such file or directory&quot;). You will see which file the program is trying to access in the arguments of the function that failed."}, {"owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567007941, "post_id": 57684044, "comment_id": 101836698, "body": "@MarcoBonelli I tried that but did not see any <code>ENOENT</code> on the trace."}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567008029, "post_id": 57684044, "comment_id": 101836746, "body": "It may be forking, add an -f to follow child processes. That&#39;s not an easy problem to debug with such little poece of code. Try to make your example concise but complete so that the problem can be reproduced."}, {"owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567008414, "post_id": 57684044, "comment_id": 101836945, "body": "Sorry for providing limited code but that is all I can at this point. However, I found it: <code>[pid 14172] openat(AT_FDCWD, &quot;&#47;dev&#47;srandom&quot;, O_RDONLY) = -1 ENOENT (No such file or directory)</code> This paho MQTT library does use OpenSSL and I am not sure what exactly will be trying to open <code>&#47;dev&#47;srandom&#47;</code>"}, {"owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567009100, "post_id": 57684044, "comment_id": 101837251, "body": "OpenSSL documentation: <a href=\"https://wiki.openssl.org/index.php/Random_fork-safety\" rel=\"nofollow noreferrer\">wiki.openssl.org/index.php/Random_fork-safety</a>  It&#39;s probably trying to read from <code>&#47;dev&#47;srandom</code> @MarcoBonelli - I am using Ubuntu 18.04 LTS, do you have any comments or tips on how to fix this?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567009362, "post_id": 57684044, "comment_id": 101837376, "body": "Is that the only ENOENT? It doesn&#39;t seem like it should be a problem. OpenSSL only tries to use srandom, it should use random or urandom if that&#39;s not found. That file is used to read random data to feed to some cryptographic function. I don&#39;t know much more about OpenSSL though, sorry."}, {"owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "reply_to_user": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1567009492, "post_id": 57684044, "comment_id": 101837422, "body": "@MarcoBonelli Thanks for your help with <code>strace</code> though. Yes this is the only ENOENT I can see through the trace."}], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "is_accepted": false, "score": 0, "last_activity_date": 1567029000, "creation_date": 1567029000, "answer_id": 57700464, "question_id": 57684044, "link": "https://stackoverflow.com/questions/57684044/ssl-error-while-connecting-to-mqtt-broker/57700464#57700464", "title": "SSL Error while connecting to MQTT Broker", "body": "<p>I installed the kernel module for <code>srandom</code> and all the errors went away.</p>\n\n<p><a href=\"https://github.com/josenk/srandom\" rel=\"nofollow noreferrer\">https://github.com/josenk/srandom</a></p>\n"}], "owner": {"reputation": 127, "user_id": 5400204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2d0e4bb07978679c4f268dcc6d3f71?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Khatri", "link": "https://stackoverflow.com/users/5400204/prateek-khatri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2853, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1567029000, "creation_date": 1566956444, "last_edit_date": 1567008068, "question_id": 57684044, "link": "https://stackoverflow.com/questions/57684044/ssl-error-while-connecting-to-mqtt-broker", "title": "SSL Error while connecting to MQTT Broker", "body": "<p>I am trying to connect an MQTT Client to an MQTT Broker using TLS. The library I am using is Paho MQTT C library: <a href=\"https://github.com/eclipse/paho.mqtt.c\" rel=\"nofollow noreferrer\">https://github.com/eclipse/paho.mqtt.c</a></p>\n\n<p>However, the connection between the broker and the client doesn't succeed and hence I need more clarification and help to solve this issue.</p>\n\n<p>According to the Paho MQTT C documentation for SSL Options:\n<a href=\"https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/struct_m_q_t_t_async___s_s_l_options.html\" rel=\"nofollow noreferrer\">https://www.eclipse.org/paho/files/mqttdoc/MQTTAsync/html/struct_m_q_t_t_async___s_s_l_options.html</a></p>\n\n<p>I need to fill this structure with the correct file handles and configuration and pass it to Connection Options structure.</p>\n\n<p>I have a mosquitto broker running on my machine(localhost).\nHere is the configuration file:</p>\n\n<pre><code># =================================================================\n# Default listener\n# =================================================================\n\n# IP address/hostname to bind the default listener to. If not\n# given, the default listener will not be bound to a specific\n# address and so will be accessible to all network interfaces.\n# bind_address ip-address/host name\n#bind_address\n\n# Port to use for the default listener.\nport 8883\n\n# -----------------------------------------------------------------\n# Certificate based SSL/TLS support\n# -----------------------------------------------------------------\n# The following options can be used to enable SSL/TLS support for\n# this listener. Note that the recommended port for MQTT over TLS\n# is 8883, but this must be set manually.\n#\n# See also the mosquitto-tls man page.\n\n# At least one of cafile or capath must be defined. They both\n# define methods of accessing the PEM encoded Certificate\n# Authority certificates that have signed your server certificate\n# and that you wish to trust.\n# cafile defines the path to a file containing the CA certificates.\n# capath defines a directory that will be searched for files\n# containing the CA certificates. For capath to work correctly, the\n# certificate files must have \".crt\" as the file ending and you must run\n# \"openssl rehash &lt;path to capath&gt;\" each time you add/remove a certificate.\n#capath\ncafile /etc/mosquitto/ca_certificates/mqttRSACA.crt\n\n# Path to the PEM encoded server certificate.\ncertfile /etc/mosquitto/certs/mqttrsabroker.crt\n\n# Path to the PEM encoded keyfile.\nkeyfile /etc/mosquitto/certs/mqttrsabroker.key\n\n# If you have require_certificate set to true, you can create a certificate\n# revocation list file to revoke access to particular client certificates. If\n# you have done this, use crlfile to point to the PEM encoded revocation file.\n#crlfile\n\n# If you wish to control which encryption ciphers are used, use the ciphers\n# option. The list of available ciphers can be obtained using the \"openssl\n# ciphers\" command and should be provided in the same format as the output of\n# that command.\n# If unset defaults to DEFAULT:!aNULL:!eNULL:!LOW:!EXPORT:!SSLv2:@STRENGTH\n#ciphers DEFAULT:!aNULL:!eNULL:!LOW:!EXPORT:!SSLv2:@STRENGTH\n\n# To allow the use of ephemeral DH key exchange, which provides forward\n# security, the listener must load DH parameters. This can be specified with\n# the dhparamfile option. The dhparamfile can be generated with the command\n# e.g. \"openssl dhparam -out dhparam.pem 2048\"\n#dhparamfile\n\n# By default a TLS enabled listener will operate in a similar fashion to a\n# https enabled web server, in that the server has a certificate signed by a CA\n# and the client will verify that it is a trusted certificate. The overall aim\n# is encryption of the network traffic. By setting require_certificate to true,\n# the client must provide a valid certificate in order for the network\n# connection to proceed. This allows access to the broker to be controlled\n# outside of the mechanisms provided by MQTT.\n#require_certificate false\n\n# This option defines the version of the TLS protocol to use for this listener.\n# The default value allows all of v1.3, v1.2 and v1.1. The valid values are\n# tlsv1.3 tlsv1.2 and tlsv1.1.\ntls_version tlsv1.2\n</code></pre>\n\n<p>I followed this link:\n<a href=\"http://www.steves-internet-guide.com/mosquitto-tls/\" rel=\"nofollow noreferrer\">http://www.steves-internet-guide.com/mosquitto-tls/</a></p>\n\n<p>I have an mqtt client with the following configuration:</p>\n\n<pre><code>    conn_opts.keepAliveInterval = 20;\n    conn_opts.cleansession = 1;\n    conn_opts.onSuccess = onConnect;\n    conn_opts.onFailure = onConnectFailure;\n    conn_opts.context = (void*)&amp;mqtt_ctx;\n    conn_opts.ssl = &amp;ssl_opts;\n\n    // Set SSL options\n    ssl_opts.struct_version = 1;\n    ssl_opts.keyStore = key_store_file;\n    ssl_opts.trustStore = trust_store_file;\n    ssl_opts.sslVersion = MQTT_SSL_VERSION_TLS_1_2;\n</code></pre>\n\n<p>The <code>key_store_file</code> and <code>trust_store_file</code> are read by environment variables pointing to:\n<code>key_store_file: mqttrsaclient.key</code>\n<code>trust_store_file: mqttrsaclient.crt</code></p>\n\n<p>Both files are in PEM format.</p>\n\n<p>I have set <code>MQTT_C_CLIENT_TRACE=ON</code> and this is what I observe:</p>\n\n<pre><code>Starting Up!\nBroker IP: ssl://127.0.0.1:8883\n=========================================================\n                   Trace Output\nProduct name: Eclipse Paho Asynchronous MQTT C Client Library\nVersion: 1.3.0\nBuild level: Wed Jul 31 15:23:35 PDT 2019\nOpenSSL version: OpenSSL 1.1.1  11 Sep 2018\nOpenSSL flags: compiler: gcc -fPIC -pthread -m64 -Wa,--noexecstack -Wall -Wa,--noexecstack -g -O2 -fdebug-prefix-map=/build/openssl-cn9tZy/openssl-1.1.1=. -fstack-protector-strong -Wformat -Werror=format-security -DOPENSSL_USE_NODELETE -DL_ENDIAN -DOPENSSL_PIC -DOPENSSL_CPUID_OBJ -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DKECCAK1600_ASM -DRC4_ASM -DMD5_ASM -DAES_ASM -DVPAES_ASM -DBSAES_ASM -DGHASH_ASM -DECP_NISTZ256_ASM -DX2\nOpenSSL build timestamp: built on: Thu Jun 20 17:36:28 2019 UTC\nOpenSSL platform: platform: debian-amd64\nOpenSSL directory: OPENSSLDIR: \"/usr/lib/ssl\"\n/proc/version: Linux version 4.15.0-55-generic (buildd@lcy01-amd64-029) (gcc version 7.4.0 (Ubuntu 7.4.0-1ubuntu1~18.04.1)) #60-Ubuntu SMP Tue Jul 2 18:22:20 UTC 2019\n\n=========================================================\n19691231 160000.000 (299804416)  (1)&gt; Socket_outInitialize:131\n19691231 160000.000 (299804416)   (2)&gt; SocketBuffer_initialize:94\n19691231 160000.000 (299804416)   (2)&lt; SocketBuffer_initialize:98\n19691231 160000.000 (299804416)  (1)&lt; Socket_outInitialize:144\n19691231 160000.000 (299804416)  (1)&gt; SSLSocket_initialize:443\n19691231 160000.000 (299804416)   (2)&gt; SSL_create_mutex:343\n19691231 160000.000 (299804416)   (2)&lt; SSL_create_mutex:349 (0)\n19691231 160000.000 (299804416)   (2)&gt; SSL_create_mutex:343\n19691231 160000.000 (299804416)   (2)&lt; SSL_create_mutex:349 (0)\n19691231 160000.000 (299804416)  (1)&lt; SSLSocket_initialize:487 (1)\n19691231 160000.000 (299804416)  (1)&gt; MQTTStrncpy:848\n19691231 160000.000 (299804416)  (1)&lt; MQTTStrncpy:858\n19691231 160000.000 (299804416)  (1)&gt; MQTTStrncpy:848\n19691231 160000.000 (299804416)  (1)&lt; MQTTStrncpy:858\n19691231 160000.000 (299804416)  (1)&gt; MQTTPersistence_create:52\n19691231 160000.000 (299804416)  (1)&lt; MQTTPersistence_create:98 (0)\n19691231 160000.000 (299804416)  (1)&gt; MQTTPersistence_initialize:113\n19691231 160000.000 (299804416)  (1)&lt; MQTTPersistence_initialize:121 (0)\n19691231 160000.000 (299804416)  (1)&gt; MQTTAsync_restoreCommands:936\n20190827 183834.980 0 commands restored for client am65x-ti-0\n20190827 183834.980 (299804416)  (1)&lt; MQTTAsync_restoreCommands:974 (0)\n20190827 183834.980 (299804416)  (1)&gt; MQTTPersistence_restoreMessageQueue:714\n20190827 183834.980 0 queued messages restored for client am65x-ti-0\n20190827 183834.980 (299804416)  (1)&lt; MQTTPersistence_restoreMessageQueue:753 (0)\n20190827 183834.980 (299804416) (0)&lt; MQTTAsync_createWithOptions:593 (0)\n20190827 183834.980 (299804416) (0)&gt; MQTTAsync_setCallbacks:2426\n20190827 183834.980 (299804416) (0)&lt; MQTTAsync_setCallbacks:2440 (-1)\n20190827 183834.980 (299804416) (0)&gt; MQTTAsync_connect:2738\n20190827 183834.980 (299804416)  (1)&gt; Thread_start:69\n20190827 183834.980 (299804416)  (1)&lt; Thread_start:79\n20190827 183834.980 (299804416)  (1)&gt; Thread_start:69\n20190827 183834.980 (291411712) (0)&gt; MQTTAsync_sendThread:1784\n20190827 183834.980 (299804416)  (1)&lt; Thread_start:79\n20190827 183834.980 (283019008) (0)&gt; MQTTAsync_receiveThread:2064\n20190827 183834.980 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183834.980 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183834.980 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183834.980 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183834.980 (299804416)  (1)&gt; MQTTStrncpy:848\n20190827 183834.981 (299804416)  (1)&lt; MQTTStrncpy:858\n20190827 183834.981 (291411712)  (1)&gt; Thread_wait_cond:411\n20190827 183834.981 (299804416)  (1)&gt; MQTTStrncpy:848\n20190827 183834.981 (299804416)  (1)&lt; MQTTStrncpy:858\n20190827 183834.981 (299804416)  (1)&gt; MQTTAsync_addCommand:984\n20190827 183834.981 (299804416)   (2)&gt; Thread_signal_cond:393\n20190827 183834.981 (299804416)   (2)&lt; Thread_signal_cond:398 (0)\n20190827 183834.981 (299804416)  (1)&lt; MQTTAsync_addCommand:1018 (0)\n20190827 183834.981 (299804416) (0)&lt; MQTTAsync_connect:3039 (0)\nConnection Attempt Return Code: 0\n20190827 183834.981 (291411712)  (1)&lt; Thread_wait_cond:419 (0)\n20190827 183834.981 (291411712)  (1)&gt; MQTTAsync_checkTimeouts:1730\n20190827 183834.981 (291411712)  (1)&lt; MQTTAsync_checkTimeouts:1778\n20190827 183834.981 (291411712)  (1)&gt; MQTTAsync_processCommand:1324\n20190827 183834.981 Connecting to serverURI 127.0.0.1:8883 with MQTT version 4\n20190827 183834.981 (291411712)   (2)&gt; MQTTProtocol_connect:114\n20190827 183834.981 (291411712)    (3)&gt; MQTTProtocol_addressPort:58\n20190827 183834.981 (291411712)    (3)&lt; MQTTProtocol_addressPort:90\n20190827 183834.981 (291411712)    (3)&gt; Socket_new:668\n20190827 183834.981 New socket 3 for 127.0.0.1:8883, port 8883\n20190827 183834.981 (291411712)     (4)&gt; Socket_addSocket:173\n20190827 183834.981 (291411712)      (5)&gt; Socket_setnonblocking:85\n20190827 183834.981 (291411712)      (5)&lt; Socket_setnonblocking:90 (0)\n20190827 183834.981 (291411712)     (4)&lt; Socket_addSocket:196 (0)\n20190827 183834.981 Connect pending\n20190827 183834.981 (291411712)    (3)&lt; Socket_new:785 (115)\n20190827 183834.981 (291411712)   (2)&lt; MQTTProtocol_connect:156 (115)\n20190827 183834.981 (291411712)   (2)&gt; MQTTProperties_free:366\n20190827 183834.981 (291411712)   (2)&lt; MQTTProperties_free:389\n20190827 183834.981 (291411712)  (1)&lt; MQTTAsync_processCommand:1660 (1)\n20190827 183834.981 (291411712)  (1)&gt; Thread_wait_cond:411\n20190827 183834.981 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183834.981 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183834.981 (283019008)    (3)&gt; MQTTProtocol_keepalive:608\n20190827 183834.981 (283019008)    (3)&lt; MQTTProtocol_keepalive:641\n20190827 183834.981 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183834.981 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183834.981 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183834.981 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183834.981 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183834.981 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.081 (283019008)    (3)&gt; Socket_continueWrites:928\n20190827 183835.081 (283019008)    (3)&lt; Socket_continueWrites:952 (0)\n20190827 183835.081 (283019008)    (3)&gt; isReady:213\n20190827 183835.081 (283019008)    (3)&lt; isReady:218 (1)\n20190827 183835.081 (283019008)   (2)&lt; Socket_getReadySocket:309 (3)\n20190827 183835.081 m-&gt;c-&gt;connect_state = 1\n20190827 183835.081 (283019008)   (2)&gt; MQTTAsync_connecting:3513\n20190827 183835.081 (283019008)    (3)&gt; MQTTProtocol_addressPort:58\n20190827 183835.081 (283019008)    (3)&lt; MQTTProtocol_addressPort:90\n20190827 183835.081 (283019008)    (3)&gt; SSLSocket_setSocketForSSL:647\n20190827 183835.081 (283019008)     (4)&gt; SSLSocket_createContext:521\n20190827 183835.081 (283019008)      (5)&gt; SSLSocket_error:97\n20190827 183835.081 SSLSocket error (151584876) in SSL_CTX_use_certificate_chain_file for socket 3 rc 0 errno 2 No such file or directory\n\n20190827 183835.081 (283019008)      (5)&lt; SSLSocket_error:117 (151584876)\n20190827 183835.081 (283019008)     (4)&lt; SSLSocket_createContext:637 (0)\n20190827 183835.081 (283019008)    (3)&lt; SSLSocket_setSocketForSSL:686 (0)\n20190827 183835.081 (283019008)    (3)&gt; nextOrClose:1667\n20190827 183835.081 (283019008)     (4)&gt; MQTTAsync_checkConn:467\n20190827 183835.081 (283019008)     (4)&lt; MQTTAsync_checkConn:470 (1)\n20190827 183835.081 (283019008)     (4)&gt; MQTTAsync_closeOnly:2559\n20190827 183835.082 (283019008)      (5)&gt; MQTTProtocol_checkPendingWrites:1138\n20190827 183835.082 (283019008)      (5)&lt; MQTTProtocol_checkPendingWrites:1155\n20190827 183835.082 (283019008)      (5)&gt; WebSocket_close:397\n20190827 183835.082 (283019008)      (5)&lt; WebSocket_close:450\n20190827 183835.082 (283019008)      (5)&gt; SSLSocket_close:852\n20190827 183835.082 (283019008)       (6)&gt; SSLSocket_destroyContext:839\n20190827 183835.082 (283019008)       (6)&lt; SSLSocket_destroyContext:843\n20190827 183835.082 (283019008)      (5)&lt; SSLSocket_close:864 (1)\n20190827 183835.082 (283019008)      (5)&gt; Socket_close:613\n20190827 183835.082 (283019008)       (6)&gt; Socket_close_only:587\n20190827 183835.082 (283019008)       (6)&lt; Socket_close_only:601 (0)\n20190827 183835.082 (283019008)       (6)&gt; Socket_abortWrite:895\n20190827 183835.082 (283019008)       (6)&lt; Socket_abortWrite:913 (0)\n20190827 183835.082 (283019008)       (6)&gt; SocketBuffer_cleanup:136\n20190827 183835.082 (283019008)       (6)&lt; SocketBuffer_cleanup:148\n20190827 183835.082 Removed socket 3\n20190827 183835.082 (283019008)      (5)&lt; Socket_close:640\n20190827 183835.082 (283019008)     (4)&lt; MQTTAsync_closeOnly:2581\n20190827 183835.082 Connect failed, more to try\n20190827 183835.082 (283019008)     (4)&gt; MQTTAsync_addCommand:984\n20190827 183835.082 (283019008)      (5)&gt; Thread_signal_cond:393\n20190827 183835.082 (283019008)      (5)&lt; Thread_signal_cond:398 (0)\n20190827 183835.082 (283019008)     (4)&lt; MQTTAsync_addCommand:1018 (0)\n20190827 183835.082 (283019008)    (3)&lt; nextOrClose:1720\n20190827 183835.082 (283019008)   (2)&lt; MQTTAsync_connecting:3652 (-1)\n20190827 183835.082 m-&gt;c-&gt;connect_state = 0\n20190827 183835.082 CONNECT sent, *rc is -1\n20190827 183835.082 (291411712)  (1)&lt; Thread_wait_cond:419 (0)\n20190827 183835.082 (291411712)  (1)&gt; MQTTAsync_checkTimeouts:1730\n20190827 183835.082 (291411712)  (1)&lt; MQTTAsync_checkTimeouts:1778\n20190827 183835.082 (291411712)  (1)&gt; MQTTAsync_processCommand:1324\n20190827 183835.082 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.082 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.082 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.082 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.082 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.082 Connecting to serverURI 127.0.0.1:8883 with MQTT version 3\n20190827 183835.082 (291411712)   (2)&gt; MQTTProtocol_connect:114\n20190827 183835.082 (291411712)    (3)&gt; MQTTProtocol_addressPort:58\n20190827 183835.082 (291411712)    (3)&lt; MQTTProtocol_addressPort:90\n20190827 183835.083 (291411712)    (3)&gt; Socket_new:668\n20190827 183835.083 New socket 3 for 127.0.0.1:8883, port 8883\n20190827 183835.083 (291411712)     (4)&gt; Socket_addSocket:173\n20190827 183835.083 (291411712)      (5)&gt; Socket_setnonblocking:85\n20190827 183835.083 (291411712)      (5)&lt; Socket_setnonblocking:90 (0)\n20190827 183835.083 (291411712)     (4)&lt; Socket_addSocket:196 (0)\n20190827 183835.083 Connect pending\n20190827 183835.083 (291411712)    (3)&lt; Socket_new:785 (115)\n20190827 183835.083 (291411712)   (2)&lt; MQTTProtocol_connect:156 (115)\n20190827 183835.083 (291411712)   (2)&gt; MQTTProperties_free:366\n20190827 183835.083 (291411712)   (2)&lt; MQTTProperties_free:389\n20190827 183835.083 (291411712)  (1)&lt; MQTTAsync_processCommand:1660 (1)\n20190827 183835.083 (291411712)  (1)&gt; Thread_wait_cond:411\n20190827 183835.083 Error from MQTTAsync_cycle() - removing socket 3\n20190827 183835.083 (283019008)  (1)&gt; nextOrClose:1667\n20190827 183835.083 (283019008)   (2)&gt; MQTTAsync_checkConn:467\n20190827 183835.083 (283019008)   (2)&lt; MQTTAsync_checkConn:470 (0)\n20190827 183835.083 (283019008)   (2)&gt; MQTTAsync_closeSession:2587\n20190827 183835.083 (283019008)    (3)&gt; MQTTAsync_closeOnly:2559\n20190827 183835.083 (283019008)     (4)&gt; MQTTProtocol_checkPendingWrites:1138\n20190827 183835.083 (283019008)     (4)&lt; MQTTProtocol_checkPendingWrites:1155\n20190827 183835.083 (283019008)     (4)&gt; WebSocket_close:397\n20190827 183835.083 (283019008)     (4)&lt; WebSocket_close:450\n20190827 183835.083 (283019008)     (4)&gt; SSLSocket_close:852\n20190827 183835.083 (283019008)      (5)&gt; SSLSocket_destroyContext:839\n20190827 183835.083 (283019008)      (5)&lt; SSLSocket_destroyContext:843\n20190827 183835.083 (283019008)     (4)&lt; SSLSocket_close:864 (1)\n20190827 183835.083 (283019008)     (4)&gt; Socket_close:613\n20190827 183835.083 (283019008)      (5)&gt; Socket_close_only:587\n20190827 183835.083 (283019008)      (5)&lt; Socket_close_only:601 (0)\n20190827 183835.083 (283019008)      (5)&gt; Socket_abortWrite:895\n20190827 183835.083 (283019008)      (5)&lt; Socket_abortWrite:913 (0)\n20190827 183835.083 (283019008)      (5)&gt; SocketBuffer_cleanup:136\n20190827 183835.083 (283019008)      (5)&lt; SocketBuffer_cleanup:148\n20190827 183835.083 Removed socket 3\n20190827 183835.083 (283019008)     (4)&lt; Socket_close:640\n20190827 183835.083 (283019008)    (3)&lt; MQTTAsync_closeOnly:2581\n20190827 183835.083 (283019008)    (3)&gt; MQTTAsync_cleanSession:2616\n20190827 183835.083 (283019008)     (4)&gt; MQTTPersistence_clear:160\n20190827 183835.083 (283019008)     (4)&lt; MQTTPersistence_clear:164 (0)\n20190827 183835.084 (283019008)     (4)&gt; MQTTProtocol_emptyMessageList:809\n20190827 183835.084 (283019008)     (4)&lt; MQTTProtocol_emptyMessageList:818\n20190827 183835.084 (283019008)     (4)&gt; MQTTProtocol_emptyMessageList:809\n20190827 183835.084 (283019008)     (4)&lt; MQTTProtocol_emptyMessageList:818\n20190827 183835.084 (283019008)     (4)&gt; MQTTAsync_emptyMessageQueue:1820\n20190827 183835.084 (283019008)     (4)&lt; MQTTAsync_emptyMessageQueue:1834\n20190827 183835.084 (283019008)     (4)&gt; MQTTAsync_removeResponsesAndCommands:1844\n20190827 183835.084 0 responses removed for client am65x-ti-0\n20190827 183835.084 0 commands removed for client am65x-ti-0\n20190827 183835.084 (283019008)     (4)&lt; MQTTAsync_removeResponsesAndCommands:1929\n20190827 183835.084 (283019008)    (3)&lt; MQTTAsync_cleanSession:2632 (0)\n20190827 183835.084 (283019008)   (2)&lt; MQTTAsync_closeSession:2594\n20190827 183835.084 Calling connect failure for client am65x-ti-0\nConnect failed, rc -1\n20190827 183835.084 (283019008)  (1)&lt; nextOrClose:1720\n20190827 183835.084 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.084 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.084 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.084 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.084 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.084 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.184 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.184 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.184 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.184 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.184 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.184 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.184 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.184 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.184 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.184 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.184 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.184 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.184 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.184 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.184 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.184 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.184 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.184 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.184 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.184 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.385 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.385 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.385 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.385 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.385 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.385 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.385 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.385 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.385 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.385 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.385 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.385 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.385 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.385 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.385 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.385 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.385 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.385 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.385 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.385 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.585 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.585 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.585 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.585 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.585 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.585 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.585 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.585 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.585 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.585 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.585 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.585 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.585 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.585 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.585 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.585 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.585 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.585 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.585 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.585 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.786 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.786 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.786 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.786 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.786 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.786 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.786 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.786 (283019008)   (2)&gt; MQTTAsync_sleep:420\n20190827 183835.786 (283019008)   (2)&lt; MQTTAsync_sleep:426\n20190827 183835.786 (283019008)   (2)&gt; MQTTAsync_retry:3495\n20190827 183835.786 (283019008)    (3)&gt; MQTTProtocol_retry:727\n20190827 183835.786 (283019008)    (3)&lt; MQTTProtocol_retry:746\n20190827 183835.786 (283019008)   (2)&lt; MQTTAsync_retry:3505\n20190827 183835.786 (283019008)  (1)&lt; MQTTAsync_cycle:3810 (-1)\n20190827 183835.786 (283019008)  (1)&gt; MQTTAsync_cycle:3663\n20190827 183835.786 (283019008)   (2)&gt; Socket_getReadySocket:237\n20190827 183835.786 (283019008)   (2)&lt; Socket_getReadySocket:309 (0)\n20190827 183835.786 (283019008)   (2)&gt; MQTTAsync_sleep:420\n</code></pre>\n\n<p>Looking specifically at this line:</p>\n\n<pre><code>20190827 183835.081 SSLSocket error (151584876) in SSL_CTX_use_certificate_chain_file for socket 3 rc 0 errno 2 No such file or directory\n</code></pre>\n\n<p>And on the broker side:</p>\n\n<pre><code>1566956315: New connection from 127.0.0.1 on port 8883.\n1566956315: Socket error on client &lt;unknown&gt;, disconnecting.\n</code></pre>\n\n<p>I am not exactly sure what I am missing.</p>\n\n<p>An insight into setting up the SSL Options correctly would be greatly helpful.</p>\n\n<p>-----------------EDIT---------------</p>\n\n<p>As suggested by Marco in comments I ran <code>strace -e trace=open,openat,stat,fstat -s200 ./mqttTest</code>\n`\nI tried it with your suggested command and here is the output (I turned off the trace for MQTT).</p>\n\n<pre><code>openat(AT_FDCWD, \"/etc/ld.so.cache\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=148012, ...}) = 0\nopenat(AT_FDCWD, \"/lib/x86_64-linux-gnu/libpthread.so.0\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0755, st_size=144976, ...}) = 0\nopenat(AT_FDCWD, \"/usr/local/lib/libpaho-mqtt3as.so.1\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=609680, ...}) = 0\nopenat(AT_FDCWD, \"/lib/x86_64-linux-gnu/libc.so.6\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0755, st_size=2030544, ...}) = 0\nopenat(AT_FDCWD, \"/usr/lib/x86_64-linux-gnu/libssl.so.1.1\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=577312, ...}) = 0\nopenat(AT_FDCWD, \"/usr/lib/x86_64-linux-gnu/libcrypto.so.1.1\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=2917216, ...}) = 0\nopenat(AT_FDCWD, \"/lib/x86_64-linux-gnu/libdl.so.2\", O_RDONLY|O_CLOEXEC) = 3\nfstat(3, {st_mode=S_IFREG|0644, st_size=14560, ...}) = 0\nfstat(1, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 1), ...}) = 0\nStarting Up!\nBroker IP: ssl://127.0.0.1:8883\nConnection Attempt Return Code: 0\nConnect failed, rc -1\n</code></pre>\n"}, {"tags": ["c", "compilation", "static-libraries"], "comments": [{"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566956702, "post_id": 57684039, "comment_id": 101814068, "body": "@uneven_mark Should I create a library everytime? ar rvs--- with commons, then do it again with level1 and again with level2?"}, {"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566956811, "post_id": 57684039, "comment_id": 101814089, "body": "@uneven_mark if you could post the shell command to compile these files correctly I will understand and mark the solution. I am a little bit lost"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566956812, "post_id": 57684039, "comment_id": 101814091, "body": "Are <code>commons</code>, <code>level1</code> and <code>level2</code> supposed to be compiled into one static/dynamic library, one executable, or multiple libraries?"}, {"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566956908, "post_id": 57684039, "comment_id": 101814106, "body": "@uneven_mark all the files will be used for just one executable, which is level2"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566957068, "post_id": 57684039, "comment_id": 101814134, "body": "<code>gcc commons.c level1.c level2.c -o my_executable</code> does not work?"}, {"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566957453, "post_id": 57684039, "comment_id": 101814201, "body": "@uneven_mark maybe I or you missunderstood, I edited the post"}, {"owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566957563, "post_id": 57684039, "comment_id": 101814221, "body": "Your last line of the edit has a typo, <code>-c</code> is missing. Afterwards you call <code>gcc common.o level1.o level2.o -o my_executable</code> to link the object files to an executable."}, {"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "reply_to_user": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "edited": false, "score": 0, "creation_date": 1566957737, "post_id": 57684039, "comment_id": 101814248, "body": "@uneven_mark this isn&#39;t a typo, level2 contains the main(). I have error when I try to compile level2 which is the source code of the &quot;real&quot; executable"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566974764, "post_id": 57684039, "comment_id": 101818105, "body": "Presumably, <code>level1.c</code> includes <code>level1.h</code> to ensure that the features declared in <code>level1.h</code> match those defined in <code>level1.c</code>, and similarly with <code>level2.c</code> and <code>level2.h</code>.  If those implementation files do not include the corresponding headers, your naming conventions or your coding conventions (or both) leave much to be desired.  See also <a href=\"https://stackoverflow.com/a/1804719/15168\">Should I use <code>#include</code> in headers?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566958830, "post_id": 57684203, "comment_id": 101814436, "body": "I completely missunderstood &quot;linking&quot; and &quot;library&quot;. Solved, marked as solution."}], "tags": [], "owner": {"reputation": 20522, "user_id": 11941443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f27a880243178eedf3abdab24898b335?s=128&d=identicon&r=PG&f=1", "display_name": "walnut", "link": "https://stackoverflow.com/users/11941443/walnut"}, "is_accepted": true, "score": 2, "last_activity_date": 1566958078, "creation_date": 1566958078, "answer_id": 57684203, "question_id": 57684039, "link": "https://stackoverflow.com/questions/57684039/c-how-to-use-library-with-multiple-header-tree/57684203#57684203", "title": "C how to use library with multiple header tree", "body": "<p>Your last line should also use the <code>-c</code> flag in order to compile <code>level2.c</code> to an object file <code>level2.o</code>.</p>\n\n<p>Afterwards the object files should be linked to create an executable, which is done via</p>\n\n<pre><code>gcc common.o level1.o level2.o -o my_executable\n</code></pre>\n\n<p>Alternatively you can directly supply all the source files to <code>gcc</code> without the <code>-c</code> flag, in which case it will perform all of the compilation and linking steps at once:</p>\n\n<pre><code>gcc common.c level1.c level2.c -o my_executable\n</code></pre>\n\n<p>Your error is currently caused, because you are instructing <code>gcc</code> without the <code>-c</code> option to compile and link the source file <code>level2.c</code> alone, but of course it can not be linked alone as it is missing symbols from the other source files.</p>\n\n<p>The fact that <code>level2.c</code> contains <code>main</code> does not change anything about this. <code>main</code> is handled like any other function, only that it has a special meaning in the final executable as entry point.</p>\n"}], "owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 57684203, "answer_count": 1, "score": 0, "last_activity_date": 1566958078, "creation_date": 1566956422, "last_edit_date": 1566957424, "question_id": 57684039, "link": "https://stackoverflow.com/questions/57684039/c-how-to-use-library-with-multiple-header-tree", "title": "C how to use library with multiple header tree", "body": "<p>I am not understanding how I should compile with gcc the following .c and library.</p>\n\n<p>example:</p>\n\n<p>Files: <code>\"commons.h\"</code> and <code>\"commons.c\"</code> (the .c defines function etc...)</p>\n\n<p>Files: <code>\"level1.h\"</code> and <code>\"level1.c\"</code>, <code>level1.c</code> includes <code>\"commons.h\"</code></p>\n\n<p>Files: <code>\"level2.h\"</code> and <code>\"level2.c\"</code>, <code>level2.c</code> includes <code>\"commons.h\"</code> and <code>\"level1.h\"</code></p>\n\n<p>I tried this and got \"undefined reference to  x\" (where x is a function inside level1):</p>\n\n<pre><code>gcc commons.c -c -o commons.o    (OK)\ngcc level1.c -c -o level1.o      (OK)\ngcc level2.c -o level2.o   (error, undefined reference to x)\n</code></pre>\n\n<p>I expect to have level2 to be execute, I will only execute this.</p>\n\n<p>How should I compile? Which order? (an example with command line will help me understand)</p>\n"}, {"tags": ["c", "pthreads", "posix"], "answers": [{"comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1566958274, "post_id": 57684048, "comment_id": 101814345, "body": "And, of course, there&#39;s nothing particularly difficult with storing thread state information (such as whether it has already been cancelled, detached, or joined) along with the <code>pthread_t</code>. You can&#39;t really share a resource without having safely-shared state information about that resource. Note that passing a <code>pthread_t</code> that you are not sure is valid to any function like <code>pthread_join</code> or <code>pthread_cancel</code> is UB. So anything could happen."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 2, "creation_date": 1566958338, "post_id": 57684048, "comment_id": 101814357, "body": "This is the correct answer. The relevant text is in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_09_02\" rel=\"nofollow noreferrer\">XSH 2.9.2 <i>Thread IDs</i></a>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1566958633, "post_id": 57684048, "comment_id": 101814396, "body": "But of course, <i>yes</i>, the thread could have been canceled, detached, or joined. In which case, using its ID has undefined behavior.  And that could indeed manifest as canceling a different thread."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1566962939, "post_id": 57684048, "comment_id": 101815034, "body": "@JohnBollinger I don&#39;t see any reason that canceling a thread that&#39;s already been canceled (but not detached or joined) would be a problem."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1566964251, "post_id": 57684048, "comment_id": 101815264, "body": "Yes, @JosephSible, I was a bit overeager.  Whether the thread originally identified by the ID has been cancelled affects the matter only indirectly, via the likelihood of that thread having since been joined.  But that nevertheless leaves this answer incomplete -- the question is asking about the thread-safety of <code>pthread_cancel</code>, particularly with respect to race conditions, and this answer essentially says that you don&#39;t have to worry about a race if you avoid situations where a race could occur.  That&#39;s true, but of limited usefulness."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 5, "last_activity_date": 1566956477, "creation_date": 1566956477, "answer_id": 57684048, "question_id": 57684031, "link": "https://stackoverflow.com/questions/57684031/is-it-possible-that-pthread-cancel-terminates-another-unintended-thread/57684048#57684048", "title": "Is it possible that pthread_cancel() terminates another unintended thread?", "body": "<p>The value can't be \"recycled\" until the thread is detached or joined. As long as you didn't do either of those things, it's safe to call pthread_cancel, even if the thread already terminated.</p>\n"}, {"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1582159633, "post_id": 57685425, "comment_id": 106685617, "body": "You&#39;re reading the quoted passage wrong. The lifetime of a joinable thread&#39;s id does not end when <code>pthread_join</code> or <code>pthread_detach</code> is called. Only when two conditions have both been met: (1) <code>pthread_join</code> or <code>pthread_detach</code> has been called, and (2) the thread has exited. IOW the conditions in the quoted text are not <code>(A &amp;&amp; B) || C</code> but <code>A &amp;&amp; (B || C)</code>. You absolutely can call <code>pthread_cancel</code> on a thread while another thread is already waiting to join it as long as you have a way of knowing (e.g. because you hold a lock that it needs to take before it can exit) that it hasn&#39;t exited."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1582203315, "post_id": 57685425, "comment_id": 106701549, "body": "Perhaps the wording of the standard is particularly poor here, @R..GitHubSTOPHELPINGICE, but <i>as written</i> it does not support the interpretation you assert.  Perhaps <i>in practice</i>, one may continue to use a thread ID under the circumstances you describe, but that&#39;s not supported by the text of the standard."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1582205441, "post_id": 57685425, "comment_id": 106702812, "body": "Are you claiming there&#39;s some reason your choice of precedence for and vs or in the quoted text is right and mine is wrong? Because that&#39;s all the matter seems to rest on."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1582253201, "post_id": 57685425, "comment_id": 106722366, "body": "There is no &quot;and&quot; in the quoted text, @R..GitHubSTOPHELPINGICE.  On further reflection, I think you must want to interpret the sentence as (A after X) (if B or if C or D) as opposed to (A) (after X if B) (or if C or D).  That&#39;s a viable alternative, but not more so than the other, grammatically.  I am prepared to accept that the text is even more open to interpretation than the answer already describes, but I prefer the latter parsing because it seems less awkward to me in this instance.  Also, writing code that conforms to the latter parsing is the more conservative choice."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1582255931, "post_id": 57685425, "comment_id": 106722835, "body": "Indeed I wasn&#39;t referring to a literal word &quot;and&quot; but the equivalent logical construct in the grammar. I agree it&#39;s grammatically ambiguous, but the way you chose to interpret it does not make sense semantically. The lack of parallel construct in the grammar under your interpretation also suggests it&#39;s not the intent; &quot;after...or if&quot; vs &quot;if...or if&quot;."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1566992970, "last_edit_date": 1566992970, "creation_date": 1566969056, "answer_id": 57685425, "question_id": 57684031, "link": "https://stackoverflow.com/questions/57684031/is-it-possible-that-pthread-cancel-terminates-another-unintended-thread/57685425#57685425", "title": "Is it possible that pthread_cancel() terminates another unintended thread?", "body": "<p>The question is about race conditions involving <code>pthread_cancel()</code>.  POSIX requires that function to be thread safe in the specific, limited sense in which it uses that term, but that doesn't really speak to the question at hand.  The key details are specified in <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/V2_chap02.html#tag_15_09_02\" rel=\"nofollow noreferrer\">XSH 2.9.2</a>, as @R.. observed earlier in a comment.  In particular:</p>\n\n<blockquote>\n  <p>The lifetime of a thread ID ends after the thread terminates if it was\n  created with the <code>detachstate</code> attribute set to <code>PTHREAD_CREATE_DETACHED</code>\n  or if <code>pthread_detach()</code> or <code>pthread_join()</code> has been called for that\n  thread. A conforming implementation is free to reuse a thread ID after\n  its lifetime has ended. If an application attempts to use a thread ID\n  whose lifetime has ended, the behavior is undefined.</p>\n</blockquote>\n\n<p>So an application is permitted to re-use thread IDs whose lifetime has ended, but that's really a side issue because if you attempt to use a stale one then the behavior is undefined, whether the ID has been reused or not.  And of course, one of the innumerable possible manifestations of UB that could ensue in the case described is indeed that a different thread is cancelled than the one you meant to cancel, regardless of whether the thread ID has been reused.</p>\n\n<p>The lifetime of a thread ID ends when the thread it identifies terminates if that thread was created detached, or when it is passed to either <code>pthread_detach</code> or <code>pthread_join</code> if the thread was created joinable.  It is entirely possible to have a race between that and the execution of <code>pthread_cancel</code>.  If the thread was created joinable then you need at least three threads total for that, but if it was created detached then you don't need any other than the one calling <code>pthread_cancel</code> and a separate one being cancelled.  Either way <code>pthread_cancel</code> is risky.</p>\n\n<p>The accepted answer to the question you linked is misleading, at best, but @DavidSchwartz's comment on it is much more useful, even if I don't think it accurately reflects the specification in every detail.  Here is how I would put it:</p>\n\n<ol>\n<li><p>It is safe to cancel a thread with <code>pthread_cancel</code> if one of these cases holds:</p>\n\n<ul>\n<li>the thread was created joinable, and it is certain that it cannot have been detached or joined before the <code>pthread_cancel</code> call completes, or</li>\n<li>the thread was created detached, and it is certain that it cannot have terminated, nor have been passed to <code>pthread_join</code> or <code>pthread_attach</code> (regardless of the success of these calls) before the <code>pthread_cancel</code> call completes.</li>\n</ul></li>\n<li><p>It is <strong>not</strong> safe (<em>i.e.</em> it risks UB) to attempt to cancel</p>\n\n<ul>\n<li><p>a thread that was created joinable, via the thread ID provided by <code>pthread_create</code>, if it is possible for that thread to be detached or joined before the <code>pthread_cancel</code> call completes, or</p></li>\n<li><p>a thread that was created detached, if it is possible for that thread to terminate or have <code>pthread_join</code> or <code>pthread_detach</code> called on it before the <code>pthread_cancel</code> call completes.</p></li>\n</ul></li>\n<li><p>It is unclear whether it is safe to cancel a thread that was created joinable and later detatched, via a thread ID obtained from <code>pthread_self()</code> after the detachment, if it is certain that neither <code>pthread_join</code> nor <code>pthread_detach</code> can have been called on that thread ID before the `pthread_cancel completes.<sup>*</sup></p></li>\n</ol>\n\n<hr>\n\n<p><sup>*</sup>One could interpret the specifications to imply that under those circumstances, <code>pthread_self</code> returns a thread ID whose lifetime has already ended, so that the cancellation would definitely produce UB.  But there are at least a couple different contrary interpretations, and under any of those, there is no defined condition under which the lifetime of the thread ID from <code>pthread_self</code> ends before the end of the program, leaving it safe to cancel the thread via that ID at any time.</p>\n"}], "owner": {"reputation": 1515, "user_id": 6156470, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/acc632c41c1f25791da16ca3093e80f8?s=128&d=identicon&r=PG&f=1", "display_name": "John Z. Li", "link": "https://stackoverflow.com/users/6156470/john-z-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 57685425, "answer_count": 2, "score": 1, "last_activity_date": 1566992970, "creation_date": 1566956328, "question_id": 57684031, "link": "https://stackoverflow.com/questions/57684031/is-it-possible-that-pthread-cancel-terminates-another-unintended-thread", "title": "Is it possible that pthread_cancel() terminates another unintended thread?", "body": "<p>My question is similar to <a href=\"https://stackoverflow.com/q/7235392/6156470\">this one</a>. But after viewing all its answers, I still don't know what kind of safety guarantee one can get with pthread_cancel(). So I would like to ask a more specific question:</p>\n\n<p>Say that pthread_cancel() is called on a pthread_t variable, named my_thread, is it possible that by the time pthread_cancel(my_thread) is executed, the actual thread corresponding to my_thread has already been terminated somehow, and the kernel recycled the value of my_thread for another newly created thread, such that by executing pthread_cancel(my_thread), another unintended thread gets killed?</p>\n"}, {"tags": ["c", "regex"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7322017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977cfa2b1753256bc3423569eee132ec?s=128&d=identicon&r=PG&f=1", "display_name": "dodo", "link": "https://stackoverflow.com/users/7322017/dodo"}, "edited": false, "score": 0, "creation_date": 1566958273, "post_id": 57684063, "comment_id": 101814344, "body": "Thanks for the link. And thank you for your comment. It allowed me to solve my problem. Since I thought the end of the pattern was the problem, I didn&#39;t check that my pattern was broken before (I had ([-\\._][[:alnum:]])* instead of ([-\\._[:alnum:]])* )."}], "tags": [], "owner": {"reputation": 33687, "user_id": 9624435, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h44B4.jpg?s=128&g=1", "display_name": "Code Maniac", "link": "https://stackoverflow.com/users/9624435/code-maniac"}, "is_accepted": true, "score": 1, "last_activity_date": 1566956611, "creation_date": 1566956611, "answer_id": 57684063, "question_id": 57683990, "link": "https://stackoverflow.com/questions/57683990/detect-string-at-the-end-of-pattern/57684063#57684063", "title": "detect string at the end of pattern", "body": "<p>You need to use <a href=\"https://www.regular-expressions.info/anchors.html\" rel=\"nofollow noreferrer\"><code>$ end of string anchor</code></a></p>\n\n<pre><code>char * pattern = \"[[:alnum:]!--_]+\\.(mystring)$\";\n</code></pre>\n\n<p>Also no need to of capture group here</p>\n\n<pre><code>char * pattern = \"[[:alnum:]!--_]+\\.mystring$\";\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7322017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977cfa2b1753256bc3423569eee132ec?s=128&d=identicon&r=PG&f=1", "display_name": "dodo", "link": "https://stackoverflow.com/users/7322017/dodo"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "closed_date": 1566975855, "accepted_answer_id": 57684063, "answer_count": 1, "score": -1, "last_activity_date": 1566956611, "creation_date": 1566955970, "question_id": 57683990, "link": "https://stackoverflow.com/questions/57683990/detect-string-at-the-end-of-pattern", "closed_reason": "Duplicate", "title": "detect string at the end of pattern", "body": "<p>I want to detect a string at the end of a pattern using C regex lib.</p>\n\n<p>I'm looking for a string like \".mystring\" with the litteral dot.</p>\n\n<p>I expect the following to work : </p>\n\n<pre><code>char * pattern = \"[[:alnum:]!--_]+\\.(mystring)\";\n</code></pre>\n\n<p>But it doesn't. What am I doing wrong here ?</p>\n"}, {"tags": ["c", "shared-libraries", "position-independent-code"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11986555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f914dcfd6f24c440c116773e081b514a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11986555/josh"}, "edited": false, "score": 0, "creation_date": 1566955440, "post_id": 57683891, "comment_id": 101813886, "body": "Thank you, so there are address spaces outside of virtual memory where every process has access to? or its still virtual memory but shared between all processec?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 11, "user_id": 11986555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f914dcfd6f24c440c116773e081b514a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11986555/josh"}, "edited": false, "score": 0, "creation_date": 1566956384, "post_id": 57683891, "comment_id": 101814010, "body": "@Josh: Whether it&#39;s PIE has nothing to do with whether the memory is shared (read-only mappings of program text/data are always shared)."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1566956563, "post_id": 57683891, "comment_id": 101814040, "body": "They&#39;re not &quot;offsets in the file&quot;, though they may happen to be equal to offsets in the file. They&#39;re virtual (not runtime-virtual, rather ELF load mapping virtual) addresses in the <code>PT_LOAD</code> segments of the ELF file. For PIC/PIE these generally start at 0, but could start at something arbitrary and nonzero. At runtime they&#39;re shifted by a constant offset equal to whatever address the PIC/PIE shared library or program gets loaded at minus the base virtual address in the ELF load map. Address references in initialized global data have to be adjusted by this offset; ..."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1566956592, "post_id": 57683891, "comment_id": 101814047, "body": "...program text does not need to be adjusted because it does not contain any absolute addresses, only relative ones, which don&#39;t change regardless of where it&#39;s loaded."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 11, "user_id": 11986555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f914dcfd6f24c440c116773e081b514a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11986555/josh"}, "edited": false, "score": 0, "creation_date": 1566993116, "post_id": 57683891, "comment_id": 101827764, "body": "@Josh Sort of.. The shared library is mapped into every process that uses it."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 1, "last_activity_date": 1566993204, "last_edit_date": 1566993204, "creation_date": 1566954803, "answer_id": 57683891, "question_id": 57683867, "link": "https://stackoverflow.com/questions/57683867/are-pie-files-given-virtual-memory-address-during-linking/57683891#57683891", "title": "Are PIE files given virtual memory address during linking?", "body": "<p>Those are not addresses. What you should be looking at are the PC-relative offsets:</p>\n\n<pre><code>leaq    93(%rip), %rdi\n</code></pre>\n\n<p>These signify that the code is PIC/PIE.</p>\n\n<p>Shared libraries are mapped into every running process that uses them.<br>\nThese libraries, however, need to be relocated (to fit the address space constraints of the program), and so are compiled with PIC (position-independent code, a.k.a. usually with PC-relative offsets).</p>\n"}], "owner": {"reputation": 11, "user_id": 11986555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f914dcfd6f24c440c116773e081b514a?s=128&d=identicon&r=PG&f=1", "display_name": "Josh", "link": "https://stackoverflow.com/users/11986555/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1566993204, "creation_date": 1566954531, "question_id": 57683867, "link": "https://stackoverflow.com/questions/57683867/are-pie-files-given-virtual-memory-address-during-linking", "title": "Are PIE files given virtual memory address during linking?", "body": "<p>I have compiled a simple <code>hello world</code> c code with <code>gcc -fpie test.c</code>,\nand now looking at the binary using <code>objdump</code>:</p>\n\n<pre><code>Disassembly of section __TEXT,__text:\n__text:\n100000f40:  55  pushq   %rbp\n100000f41:  48 89 e5    movq    %rsp, %rbp\n100000f44:  48 83 ec 10     subq    $16, %rsp\n100000f48:  89 7d fc    movl    %edi, -4(%rbp)\n100000f4b:  8b 75 fc    movl    -4(%rbp), %esi\n100000f4e:  48 8d 3d 5d 00 00 00    leaq    93(%rip), %rdi\n100000f55:  b0 00   movb    $0, %al\n\n...\n</code></pre>\n\n<p>We can clearly see memory addresses are still calculated by the linker on the left. Aren't <code>pie</code> files supposed to have no memory addresses associated to them statically?</p>\n\n<p>My second question is, how are <code>pic</code> files (like shared libraries) loaded in memory? do they have their own virtual address space? if so why do they need to be position independent? or are they loaded into a processes address space? </p>\n"}, {"tags": ["c", "bit"], "comments": [{"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1566959966, "post_id": 57683704, "comment_id": 101814597, "body": "<a href=\"https://stackoverflow.com/q/26200961/995714\">What&#39;s the fastest way to pack 32 0/1 values into the bits of a single 32-bit variable?</a>, <a href=\"https://stackoverflow.com/q/52098873/995714\">How to efficiently convert an 8-bit bitmap to array of 0/1 integers with x86 SIMD</a>"}, {"owner": {"reputation": 1701, "user_id": 5836577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/931236857b09c3b0aea0f29fb5a23cbc?s=128&d=identicon&r=PG&f=1", "display_name": "Guillaume Petitjean", "link": "https://stackoverflow.com/users/5836577/guillaume-petitjean"}, "edited": false, "score": 0, "creation_date": 1566980277, "post_id": 57683704, "comment_id": 101820683, "body": "It&#39;s not an answer to your question, but are you sure you need to do this ? I mean that you could very well use a bit mask every time you need to access a bit, instead of copying each bit in a different variable. Some thing like <code>if ( status_register &amp; Mask_for_bit_i ) do_something();</code> will not be more complicated than <code>if (bits[i]) do_something();</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 2, "last_activity_date": 1566954872, "last_edit_date": 1566954872, "creation_date": 1566953247, "answer_id": 57683749, "question_id": 57683704, "link": "https://stackoverflow.com/questions/57683704/best-way-to-move-8-bits-into-8-individual-bytes/57683749#57683749", "title": "Best way to move 8 bits into 8 individual bytes", "body": "<p>Here's basically what you're trying to do. It uses bitwise operators and a <code>uint8_t</code> array to make each bit an individual byte:</p>\n\n<pre><code>void bits_to_bytes(uint8_t status, uint8_t bits[8])\n{\n    int ctr;\n    for( ctr = 0; ctr &lt; 8; ctr++ )\n    {\n        bits[ctr] = (status &gt;&gt; ctr) &amp; 1;\n    }\n}\n</code></pre>\n\n<p>OK, so a little more in-depth:</p>\n\n<p>This code loops through the bits in a byte and then assigns <code>bits[bit_number]</code> to the <code>bit_number</code>th bit of <code>status</code>.  </p>\n\n<p>If you want to reverse the order the bits are stored in, simply change <code>bits[ctr]</code> to <code>bits[(8-1)-ctr]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566953947, "post_id": 57683751, "comment_id": 101813677, "body": "Why would you need that when you could use <code>(status &gt;&gt; n) &amp; 1</code>? It&#39;s simpler, and doesn&#39;t use unnecessary screaming."}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566954450, "post_id": 57683751, "comment_id": 101813752, "body": "@JL2210: Just because the shifted values here are constants rather than using a variable shift.  Often you&#39;ll have those <code>(1 &lt;&lt; n)</code> values as defined constants for the various flags anyway since they likely each have their own name.  It all depends on whether you&#39;re dealing with 8 individually named independent flags or a set of analogous numbered flags (an example of the latter might be 8 free/busy flags for 8 numbered buffers)."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566954928, "post_id": 57683751, "comment_id": 101813820, "body": "True, in fact, I use those myself."}], "tags": [], "owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "is_accepted": false, "score": 0, "last_activity_date": 1566954337, "last_edit_date": 1566954337, "creation_date": 1566953256, "answer_id": 57683751, "question_id": 57683704, "link": "https://stackoverflow.com/questions/57683704/best-way-to-move-8-bits-into-8-individual-bytes/57683751#57683751", "title": "Best way to move 8 bits into 8 individual bytes", "body": "<p>You can use a double invocation of the <code>!</code> operator to squash a zero/non-zero value to zero/one.  Using this, the extracted value of bit <code>n</code> in <code>status</code> is <code>!!(status &amp; (1 &lt;&lt; n))</code>.</p>\n\n<p>If you only have eight flags you might just create constants for the 8 values of <code>1 &lt;&lt; n</code> (<code>0x1</code>, <code>0x2</code>, <code>0x4</code>, <code>0x8</code>, <code>0x10</code>, <code>0x20</code>, <code>0x40</code>, <code>0x80</code>).  This works particularly well if your flags all have individual names rather than numbers, so that you might have in a header file somewhere:</p>\n\n<pre><code>#define FLAG_FROB 0x01\n#define FLAG_FOO  0x02\n#define FLAG_BAR  0x04\n#define FLAG_BAZ  0x08\n#define FLAG_QUUX 0x10\n</code></pre>\n\n<p>Then in the code you'd just extract them as</p>\n\n<pre><code>flag_frob = !!(status &amp; FLAG_FROB);\nflag_foo = !!(status &amp; FLAG_FOO);\nflag_bar = !!(status &amp; FLAG_BAR);\nflag_baz = !!(status &amp; FLAG_BAZ);\nflag_quux = !!(status &amp; FLAG_QUUX);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566953408, "post_id": 57683752, "comment_id": 101813578, "body": "Isn&#39;t this a tad too complicated?"}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566953475, "post_id": 57683752, "comment_id": 101813594, "body": "@JL2210: complicated in what way exactly? It does exactly what the question asks for and the calling of the function is relatively simple."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566953541, "post_id": 57683752, "comment_id": 101813602, "body": "But couldn&#39;t you just use bit-shifts and <code>&amp; 1</code>, like in my solution?"}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "edited": false, "score": 0, "creation_date": 1566953590, "post_id": 57683752, "comment_id": 101813609, "body": "It seems backwards to expectation, the least significant bit is conventionally numbered zero but this places it into <code>outputBytes[7]</code>."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566953629, "post_id": 57683752, "comment_id": 101813621, "body": "@JL2210: yes, but I prefer a function based solution so that it doesn&#39;t clutter up the code. I also have a natural need for the bytes to echo the bits in a left-to-right sense but that&#39;s probably more of a sytle thing :-)"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "edited": false, "score": 0, "creation_date": 1566953636, "post_id": 57683752, "comment_id": 101813622, "body": "@caf My answer or paxdiablo&#39;s?"}, {"owner": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566953706, "post_id": 57683752, "comment_id": 101813639, "body": "@JL2210: This one - yours puts bit 0 in <code>bits[0]</code> as I would expect."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 215710, "user_id": 134633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc6be45ddcfd038ba5e1e5fca319c7fa?s=128&d=identicon&r=PG", "display_name": "caf", "link": "https://stackoverflow.com/users/134633/caf"}, "edited": false, "score": 1, "creation_date": 1566953945, "post_id": 57683752, "comment_id": 101813676, "body": "@caf, have added an addendum for that preference but I still prefer the current way :-)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566955457, "post_id": 57683752, "comment_id": 101813892, "body": "<i>you should be using <code>uint8_t</code> for eight-bit bit collections since <code>char</code> is fundamentally non-portable</i>  Given <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.20.1.1p3\" rel=\"nofollow noreferrer\"><b>7.20.1.1 Exact-width integer types</b>, paragraph 3</a>.  I suspect there&#39;s not much <i>de facto</i> difference in portability between the two.  The most portable would be <code>uint_least8_t</code>."}, {"owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1566956917, "post_id": 57683752, "comment_id": 101814107, "body": "@Andrew, if uint8_t can be represented by an implementation, it must be. The problem with the <code>least</code> types is that you have to ensure nothing &quot;leaks&quot; into the bit positions above <code>b7</code>, lest checks like <code>&gt; 127</code> will not work (in other words, you&#39;ll probably need to mask those bits to zero). If you don&#39;t <i>have</i> <code>uint8_t</code> then, yes, <code>least</code> is probably better (with a little extra work). Even <code>unsigned char</code> is workable with some more effort but I would totally steer clear of <code>char</code> just because of its signedness problems."}], "tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 1, "last_activity_date": 1566954322, "last_edit_date": 1566954322, "creation_date": 1566953297, "answer_id": 57683752, "question_id": 57683704, "link": "https://stackoverflow.com/questions/57683704/best-way-to-move-8-bits-into-8-individual-bytes/57683752#57683752", "title": "Best way to move 8 bits into 8 individual bytes", "body": "<p>For a start, you should be using <code>uint8_t</code> for eight-bit bit collections since <code>char</code> is fundamentally non-portable unless you add a lot of extra code for checking its size and signedness.</p>\n\n<p>Something like this should suffice for your needs:</p>\n\n<pre><code>void BitsToBytes(uint8_t bits, uint8_t *bytes) {\n    for (int i = 0; i &lt; 8; ++i) {     // The type has exactly eight bits.\n        *bytes++ = (bits &gt; 127);      // 1 if high bit set, else 0.\n        bits = (bits &amp; 0x7f) &lt;&lt; 1;    // Shift left to get next bit.\n    }\n}\n:\n// Call with:\nuint8_t inputBits = 0x42;\nuint8_t outputBytes[8];\nBitsToBytes(inputBits, outputBytes);\n</code></pre>\n\n<p>This takes a type with eight bits and a buffer of eight bytes, then places the individual bits into each byte of the array:</p>\n\n<pre><code>              MSB  LSB\n             +--------+\ninputBits:   |abcdefgh|\n             +--------+\n             +---+---+---+---+---+---+---+---+\noutputBytes: | a | b | c | d | e | f | g | h |\n             +---+---+---+---+---+---+---+---+\n</code></pre>\n\n<p>If you want it to go the other way (where the LSB of the input is in element 0 of the array), you can simply change the body of the loop to:</p>\n\n<pre><code>*bytes++ = bits &amp; 1; // 1 if low bit set, else 0.\nbits = bits &gt;&gt; 1;    // Shift right to get next bit.\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11922589, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3_r7hyREheE/AAAAAAAAAAI/AAAAAAAAABc/lF7iHqMOgOw/photo.jpg?sz=128", "display_name": "Micheal Double", "link": "https://stackoverflow.com/users/11922589/micheal-double"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "closed_date": 1566986929, "answer_count": 3, "score": 1, "last_activity_date": 1566954872, "creation_date": 1566952857, "last_edit_date": 1566953241, "question_id": 57683704, "link": "https://stackoverflow.com/questions/57683704/best-way-to-move-8-bits-into-8-individual-bytes", "closed_reason": "Duplicate", "title": "Best way to move 8 bits into 8 individual bytes", "body": "<p>I have a status register with 8 bits. I would like to move each individual bit to a byte for further processing. Seems like it should be easy but every solution I come up with is convoluted. I was thinking about iterating through the bits with a for next loop and dumping them into an array but my solution way too messy.</p>\n"}, {"tags": ["c", "string", "algorithm", "optimization"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 6, "creation_date": 1566942086, "post_id": 57682576, "comment_id": 101811590, "body": "It&#39;s mixed case as soon as you&#39;ve found one character in each case, which could be as few as two characters in total. So if you iterate over the whole string, you may be wasting a lot of time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 0, "creation_date": 1566942167, "post_id": 57682576, "comment_id": 101811612, "body": "@jonrsharpe -- thanks for the suggestion, I&#39;ve updated it with the break."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1566942530, "post_id": 57682576, "comment_id": 101811713, "body": "Get the case of the first character. Then use <code>strspn()</code> to search for a character in the opposite case."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1566942588, "post_id": 57682576, "comment_id": 101811726, "body": "If your strings had explicit length, this would be very easy to vectorize, which in turn will cause the code to max out cache/memory bandwidth on reasonable machines."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566942628, "post_id": 57682576, "comment_id": 101811739, "body": "<code>strspn()</code> should be optimized as well as possible."}, {"owner": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1566942646, "post_id": 57682576, "comment_id": 101811745, "body": "Can&#39;t you just compare the string to lowercase and uppercase versions of itself, and if neither matches then it&#39;s mixed case."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1566942648, "post_id": 57682576, "comment_id": 101811747, "body": "<code>(c &gt;=&#39;a&#39; &amp;&amp; c &lt;= &#39;z&#39;)</code> is not portable.  Use <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.4.1.11\" rel=\"nofollow noreferrer\"><code>isupper()</code></a> and <a href=\"https://port70.net/~nsz/c/c11/n1570.html#7.4.1.7\" rel=\"nofollow noreferrer\"><code>islower()</code></a>."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "reply_to_user": {"reputation": 1192, "user_id": 1744727, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8d02d3ecefb127c4467e9328308ffb12?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/1744727/david"}, "edited": false, "score": 0, "creation_date": 1566942759, "post_id": 57682576, "comment_id": 101811773, "body": "@David how would that be faster?"}, {"owner": {"reputation": 97299, "user_id": 41360, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bd2e50770e937761cfc3811a332bccc?s=128&d=identicon&r=PG", "display_name": "Vilx-", "link": "https://stackoverflow.com/users/41360/vilx"}, "edited": false, "score": 2, "creation_date": 1566943894, "post_id": 57682576, "comment_id": 101812036, "body": "Also... What <a href=\"https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/\" rel=\"nofollow noreferrer\">character set</a> are we talking about? Things get reeeeally hairy with Unicode... ;)"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1566944115, "post_id": 57682576, "comment_id": 101812096, "body": "If you know you&#39;re dealing only with ASCII letters, the fastest way to check case is just <code>&amp; 0x20</code>, and you can trivially vectorize that using larger-size integers (<code>memcpy</code> will prevent UB while generating the same code). Note also that you can just check whether the parity is even/odd like the low bit of the length. (<i>Should</i> you do this? That&#39;s a whole different question)."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1575044257, "post_id": 57682576, "comment_id": 104447795, "body": "possible duplicate: <a href=\"https://stackoverflow.com/q/15171740/995714\">C programming: How to check whether the input string contains combination of uppercase and lowercase</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1566943979, "post_id": 57682789, "comment_id": 101812061, "body": "Shame there isn&#39;t a <code>charclassify()</code> like there is a <code>fpclassify()</code>, because then you could do <code>cc = charclassfy(*str); hasX |= (ISX &amp; cc); hasY |= (ISY &amp; cc);</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566945066, "post_id": 57682789, "comment_id": 101812306, "body": "@Andrew -- thanks for this answer. From a comment above (<code>If you know you&#39;re dealing only with ASCII letters, the fastest way to check case is just &amp; 0x20</code>), does the <code>islower</code> / <code>isupper</code> use the bitwise operation? I guess my question is how is the <code>islower</code> better than the naive implementation I&#39;ve used in the question above?"}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566945402, "post_id": 57682789, "comment_id": 101812383, "body": "@Shared The C standard does not specify ASCII encoding.  The functions defined by <code>ctypes.h</code> will be properly portable to however the characters are encoded."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1566946367, "post_id": 57682789, "comment_id": 101812527, "body": "@Shared - in general you will find that most compiler implementations of any given function will be far more optimized and far less error prone than what you come up with on the fly. (especially for long strings where many library functions cast to the dereferenced string to unsigned in order to be able to check 4-bytes per-iteration rather than one). A good test is to dump to assembly and then compare from an instruction standpoint."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566976107, "post_id": 57682789, "comment_id": 101818705, "body": "You could improve the micro-efficiency of the code on mixed alpha and non-alpha strings by testing, for example, <code>if (hasUpper) return 1;</code> in the <code>if (islower((unsigned char)*str)</code> code block, before the assignment to <code>hasLower</code>.  This saves unnecessary testing when the character is non-alpha.  Also, the question asks for &#39;all upper&#39; vs &#39;all lower&#39; vs &#39;mixed&#39; (and implicitly &#39;no alpha&#39;)."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 2, "last_activity_date": 1566943697, "last_edit_date": 1566943697, "creation_date": 1566943376, "answer_id": 57682789, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57682789#57682789", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>This should be fairly efficient - it checks the minimum number of characters necessary.  This assumes a bias towards lower-case characters, so checking for lower-case first should be slightly more efficient:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\nint ismixed( const unsigned char *str )\n{\n    int hasUpper = 0;\n    int hasLower = 0;\n\n    while ( *str )\n    {\n        // can't be both upper and lower case\n        // but it can be neither\n        if ( islower( *str ) )\n        {\n            hasLower = 1;\n        }\n        else if ( isupper( *str ) )\n        {\n            hasUpper = 1;\n        }\n\n        // return true as soon as we hit\n        // both upper and lower case\n        if ( hasLower &amp;&amp; hasUpper )\n        {\n            return( 1 );\n        }\n\n        str++;\n    }\n\n    return( 0 );\n}\n</code></pre>\n\n<p>Depending on whether your input is biased to lower or upper case, checking <code>isupper()</code> first might be better.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566945641, "post_id": 57683029, "comment_id": 101812425, "body": "that&#39;s an interesting approach, but yes I suppose a file could be named something like FileVersion-1.txt so it could have non-letters (added an example to the question)."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1566946774, "post_id": 57683029, "comment_id": 101812611, "body": "@Shared Updated with another version that should handle non-alphabetical strings.  Not sure how it would stack up efficiency-wise versus a more traditional approach."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1566951044, "post_id": 57683029, "comment_id": 101813262, "body": "<code>islower(str[i]) ^ islower(str[j])</code> is not certainly correct.  <code>islower()</code> results in an <code>int</code>, non-zero value when lower case.  Yet the value returned by <code>islower(str[i])</code> may differ from <code>islower(str[j])</code> even though both are lower case.  <code>^</code> does a bit-wise exclusive OR here and what is needed is a logical exclusive OR.  Suggest <code>!islower(str[i]) ^ !islower(str[j])</code> to effect a logical exclusive OR."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1567003730, "post_id": 57683029, "comment_id": 101834248, "body": "@chux Good catch.  Updated."}], "tags": [], "owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "is_accepted": false, "score": 1, "last_activity_date": 1567003720, "last_edit_date": 1567003720, "creation_date": 1566945564, "answer_id": 57683029, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57683029#57683029", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>Is said string guaranteed to only contain letters?  If so, could check to see if any two consecutive characters are different cases.  </p>\n\n<pre><code>#include &lt;ctype.h&gt;\n#include &lt;errno.h&gt;\nint mixed_case(const char *str) {\n   if(!str){\n      // sanity check\n      errno = EINVAL;\n      return -1;\n   }\n\n   // can't be mixed-case without more than one letter\n   if(str[0] == '\\0' || str[1] == '\\0'){\n      return 0;\n   }\n\n   for(int i = 1; str[i] != '\\0' ; ++i) {\n      if (!islower(str[i]) ^ !islower(str[i-1])) {\n         // if two letter next to each other are not the same case, it's mixed case\n         return 1;\n      }\n   }\n   // didn't find any mismatches, so not mixed case\n   return 0;\n}\n</code></pre>\n\n<p>Taking a similar approach, but instead of checking consecutive characters, it will find the first alphabetical character and check it against any other alphabetical characters found.  This should be able to handle strings with non-alphabetical characters.</p>\n\n<pre><code>int mixed_case(const char *str) {\n   if(!str){\n      // sanity check\n      errno = EINVAL;\n      return -1;\n   }\n\n   // can't be mixed-case without more than one letter\n   if(str[0] == '\\0' || str[1] == '\\0'){\n      return 0;\n   }\n\n   // find the first alphabetical character and store its index at 'i'\n   int i = 0;\n   for(;!isalpha(str[i]) || str[i] == '\\0'; ++i);\n\n   if(str[i] == '\\0') {\n      // no alphabetical characters means you can't have mixed cases\n      return 0;\n   }\n\n   // See if any of the other alphabetical characters differ from the case of the first one\n   for(int j = i+1; str[j] != '\\0' ; ++j) {\n      if(isalpha(str[j]) &amp;&amp; (!islower(str[i]) ^ !islower(str[j]))) {\n         return 1;\n      }\n   }\n   // didn't find any mismatches, so not mixed case\n   return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1566958260, "post_id": 57683107, "comment_id": 101814342, "body": "Why not use bit-wise operations instead of counting?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1566961961, "post_id": 57683107, "comment_id": 101814892, "body": "@m69 Should all/near all <i>uppercase</i> and all/near all <i>lowercase</i> dominate use cases, then simply  adding is most efficient.  On review I think <a href=\"https://stackoverflow.com/a/57683472/2410359\">this</a> most generally efficient."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1566946649, "last_edit_date": 1566946649, "creation_date": 1566946298, "answer_id": 57683107, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57683107#57683107", "title": "Most efficient way to find if a string is mixedCase", "body": "<p><strong>If</strong> we assume ASCII </p>\n\n<p><strong>If</strong> we assume all alpha,</p>\n\n<p>Then code only needs to count the \"case\" bits.  Is the sum 0, same as string length or otherwise?</p>\n\n<pre><code>void test_case(const char *s) {\n  const char *start = s;\n  size_t sum = 0;\n  size_t mask = 'A' ^ 'a';\n  while (*s) {\n    sum += *s++ &amp; mask;\n  }\n  ptrdiff_t len = s - start;\n  sum /= mask;\n  if (len == 0) puts(\"Empty string\");\n  else if (sum == 0) puts(\"All UC\");   \n  else if (sum == len) puts(\"All LC\");\n  else puts(\"Mixed\");\n}\n</code></pre>\n\n<p>Note: with slight mods, will work for EBCIDIC too.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566975831, "post_id": 57683472, "comment_id": 101818586, "body": "The examples in the question start with non-alpha and contain non-alpha characters, but can be mixed case, upper case or lower case."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1566997847, "post_id": 57683472, "comment_id": 101830557, "body": "@JonathanLeffler Good point  - yet that is due to OP edit.  Will review."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1566998469, "last_edit_date": 1566998469, "creation_date": 1566950350, "answer_id": 57683472, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57683472#57683472", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>Another approach that does not assume ASCII nor all alpha.</p>\n\n<p>Assess the first <code>char</code> and then perform one of 2 optimized loops.</p>\n\n<p>This quits the loops on the first mis-match.  Since the <code>while()</code> loops are only doing a single test, this leads to optimal performance.</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n\nvoid case_test(const char *s) {\n  if (*s == '\\0') {\n    puts(\"Empty string\");\n    return;\n  }\n\n  unsigned char *us = (unsigned char *)s; // use unsigned char with is***() functions.\n  if (islower(*us)) {\n    while (islower(*us)) {\n      us++;\n    }\n    if (*us) {\n      puts(\"Mixed or not alpha\");\n    } else {\n      puts(\"All lower\");\n    }\n  } else if (isupper(*us)) {\n    while (isupper(*us)) {\n      us++;\n    }\n    if (*us) {\n      puts(\"Mixed case or not alpha\");\n    } else {\n      puts(\"All upper\");\n    }\n  } else {\n    puts(\"Not alpha\");\n  }\n}\n</code></pre>\n\n<p>OP added cases including non-alpha.  The below promptly handles that.</p>\n\n<pre><code>void case_test_with_non_letters(const char *s) {\n  unsigned char *us = (unsigned char *)s; // use unsigned char with is***() functions.\n\n  //  Find first alpha or null character\n  while (!isalpha(*us) &amp;&amp; *us) {\n    us++;\n  }\n\n  if (*us == '\\0') {\n    puts(\"Empty string\");\n    return;\n  }\n\n  if (islower(*us)) {\n    while (!isupper(*us) &amp;&amp; *us) {\n      us++;\n    }\n    if (isupper(*us)) {\n      puts(\"Mixed\");\n    } else {\n      puts(\"All letters lower\");\n    }\n  } else if (isupper(*us)) {\n    while (!islower(*us) &amp;&amp; *us) {\n      us++;\n    }\n    if (*us) {\n      puts(\"Mixed case\");\n    } else {\n      puts(\"All letters upper\");\n    }\n  } else {\n    puts(\"Not alpha\");\n  }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566956257, "post_id": 57683560, "comment_id": 101813992, "body": "could you please explain a bit what&#39;s going on in the code above? I don&#39;t really understand  how it works, etc."}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 0, "creation_date": 1566958623, "post_id": 57683560, "comment_id": 101814394, "body": "@Shared For every character (I&#39;ve assumed 8-bit extended ASCII here) you store a value of 1 if it is uppercase, 2 if it is lowercase, or 0 if it is a non-alphabetical character. Then, to check a string, you look up the value for each character, and OR it with the variable <code>cases</code>, which was set to 0 at the start. When you encounter the first letter, <code>cases</code> will be set to 1 or 2, depending on the case. If you later encounter a letter of the other case, <code>cases</code> will be set to 3, and you know the string has mixed case."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566958905, "post_id": 57683560, "comment_id": 101814448, "body": "@mr69 -- wow that&#39;s a really cool approach. I&#39;d be interested to see if this would outperform using the standard lower/upper on tons of strings of text input."}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "edited": false, "score": 1, "creation_date": 1566959191, "post_id": 57683560, "comment_id": 101814487, "body": "@Shared Often the performance of look-up tables depends a lot on their size. You may find strange jumps in timing if you add or remove a handful of elements. If you don&#39;t care about extended characters and reduce the table to 128 characters, or skip the first 32 control characters and use <code>*s++ -32</code> that may improve the speed. It&#39;s all about low-level optimizations that the compiler can do."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1566999093, "post_id": 57683560, "comment_id": 101831359, "body": "This is a good idea, yet can be improved. Change <code>alphabet[0] = 4;</code>  then <code>(*s &amp;&amp; cases != 3)</code> to <code>(cases &lt; 3)</code>.  This eliminates the repeated <code>*s</code> test.  Then <code>return cases &amp; 3;</code>."}, {"owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1567010819, "post_id": 57683560, "comment_id": 101837946, "body": "@chux Good call. Every instruction is one too many when micro-optimizing :-)"}], "tags": [], "owner": {"reputation": 10914, "user_id": 4907604, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qowl9.png?s=128&g=1", "display_name": "m69 &#39;&#39;snarky and unwelcoming&#39;&#39;", "link": "https://stackoverflow.com/users/4907604/m69-snarky-and-unwelcoming"}, "is_accepted": true, "score": 5, "last_activity_date": 1567218988, "last_edit_date": 1567218988, "creation_date": 1566951251, "answer_id": 57683560, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57683560#57683560", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>If you know the character encoding that's going to be used (I've used <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-15\" rel=\"nofollow noreferrer\">ISO/IEC 8859-15</a> in the code example), a look-up table may be the fastest solution. This also allows you to decide which characters from the extended character set, such as \u00b5 or &szlig;, you'll count as upper case, lower case or non-alphabetical.  </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char test_case(const char *s) {\n    static const char alphabet[] = {\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,  //  ABCDEFGHIJKLMNO\n        1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,  // PQRSTUVWXYZ\n        0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,  //  abcdefghijklmno\n        2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,  // pqrstuvwxyz\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n        0,0,0,0,0,0,0,1,0,2,0,2,0,0,0,0,  //        \u0160 \u0161 \u00aa\n        0,0,0,0,0,1,2,0,0,2,0,2,0,1,2,1,  //      \u017d\u00b5  \u017e \u00ba \u0152\u0153\u0178\n        1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,  // \u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u00c6\u00c7\u00c8\u00c9\u00ca\u00cb\u00cc\u00cd\u00ce\u00cf\n        1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,  // \u00d0\u00d1\u00d2\u00d3\u00d4\u00d5\u00d6 \u00d8\u00d9\u00da\u00db\u00dc\u00dd\u00de\u00df\n        2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,  // \u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u00e6\u00e7\u00e8\u00e9\u00ea\u00eb\u00ec\u00ed\u00ee\u00ef\n        2,2,2,2,2,2,2,0,2,2,2,2,2,2,2,2}; // \u00f0\u00f1\u00f2\u00f3\u00f4\u00f5\u00f6 \u00f8\u00f9\u00fa\u00fb\u00fc\u00fd\u00fe\u00ff\n    char cases = 0;\n    while (*s &amp;&amp; cases != 3) {\n        cases |= alphabet[(unsigned char) *s++];\n    }\n    return cases; // 0 = none, 1 = upper, 2 = lower, 3 = mixed\n}\n</code></pre>\n\n<p>As suggested in a comment by <em>chux</em>, you can set the value of <code>alphabet[0]</code> to 4, and then you need only one condition <code>cases &lt; 3</code> in the while loop.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11978762"}, "is_accepted": false, "score": -1, "last_activity_date": 1566999915, "creation_date": 1566999915, "answer_id": 57693935, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase/57693935#57693935", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>97 = a = 1100001\n65 = A = 0100001</p>\n\n<p>You have just to test the bit number 6.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 1, "accepted_answer_id": 57683560, "answer_count": 6, "score": 6, "last_activity_date": 1567218988, "creation_date": 1566941998, "last_edit_date": 1566968815, "question_id": 57682576, "link": "https://stackoverflow.com/questions/57682576/most-efficient-way-to-find-if-a-string-is-mixedcase", "title": "Most efficient way to find if a string is mixedCase", "body": "<p>Suppose I have very long strings and I want to see if a column is allLower, allUpper, or mixedCase. For example with the following column</p>\n\n<pre><code>text\n\"hello\"\n\"New\"\n\"items\"\n\"iTem12\"\n\"-3nXy\"\n</code></pre>\n\n<p>The text would be <code>mixedCase</code>. A naive algorithm to determine this might be:</p>\n\n<pre><code>int is_mixed_case, is_all_lower, is_all_upper;\nint has_lower = 0;\nint has_upper = 0;\n// for each row...for each column...\nfor (int i = 0; (c=s[i]) != '\\0'; i++) {\n    if (c &gt;='a' &amp;&amp; c &lt;= 'z') {\n        has_lower = 1;\n        if (has_upper) break;\n    }\n    else if (c &gt;='A' &amp;&amp; c &lt;= 'Z') {\n        has_upper = 1;\n        if (has_lower) break;\n    }\n}\n\nis_all_lower = has_lower &amp;&amp; !has_upper;\nis_all_upper = has_upper &amp;&amp; !has_lower;\nis_mixed_case = has_lower &amp;&amp; has_upper;\n</code></pre>\n\n<p>I'm sure there would be a more performant way to do this, however. What might be the most efficient way to do this algorithm/calculation?</p>\n"}, {"tags": ["c", "struct", "compiler-errors", "include"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567089106, "post_id": 57682210, "comment_id": 101867121, "body": "this struct definition: <code>struct test_struct{    int a; }</code> is missing the trailing semicolon: <code>;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566940085, "post_id": 57682244, "comment_id": 101810957, "body": "this solved. Why do I have problem without typedef?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566940158, "post_id": 57682244, "comment_id": 101810990, "body": "Because that&#39;s how the C language works. Defining a structure doesn&#39;t create a new type name, you have to use <code>typedef</code> to create a type that&#39;s a synonym for the structure type."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 1, "creation_date": 1566940190, "post_id": 57682244, "comment_id": 101810999, "body": "If you&#39;re used to C++, it does this automatically, but C doesn&#39;t work the same."}, {"owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "edited": false, "score": 0, "creation_date": 1566940260, "post_id": 57682244, "comment_id": 101811023, "body": "I missunderstood the meaning of &quot;new type&quot;, now I got it"}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 1, "last_activity_date": 1566939815, "creation_date": 1566939815, "answer_id": 57682244, "question_id": 57682210, "link": "https://stackoverflow.com/questions/57682210/c-struct-type-not-found-including-library-error-unknown-type-name/57682244#57682244", "title": "C struct type not found including library, error &quot;unknown type name&quot;", "body": "<p>Your header file only defines <code>struct test_struct</code>, not <code>test_struct</code>. You need a <code>typedef</code> so you can refer to it without saying <code>struct</code> first.</p>\n\n<pre><code>typedef struct test_struct {\n    int a;\n} test_struct;\n</code></pre>\n\n<p>Or change <code>work.c</code> to use <code>struct</code>.</p>\n\n<pre><code>void myfunction(struct test_struct this_is_a_test) {\n    //...\n}\n</code></pre>\n"}], "owner": {"reputation": 1166, "user_id": 4789408, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/cff1770f7ddafa271e11c30a1c0cbf17?s=128&d=identicon&r=PG&f=1", "display_name": "user4789408", "link": "https://stackoverflow.com/users/4789408/user4789408"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 57682244, "answer_count": 1, "score": 0, "last_activity_date": 1566950742, "creation_date": 1566939649, "last_edit_date": 1566950742, "question_id": 57682210, "link": "https://stackoverflow.com/questions/57682210/c-struct-type-not-found-including-library-error-unknown-type-name", "title": "C struct type not found including library, error &quot;unknown type name&quot;", "body": "<p>I didn't find a solution to a very simple problem.</p>\n\n<p>File \"commons.h\":</p>\n\n<pre><code>struct test_struct{\n   int a;\n}\n</code></pre>\n\n<p>File \"work.c\":</p>\n\n<pre><code>#include \"commons.h\"\nvoid myfunction(test_struct this_is_a_test){\n// ....\n}\n</code></pre>\n\n<p>what I do:</p>\n\n<pre><code>gcc commons.c -c -o commons.o    (no errors)\ngcc work.c -c -o work.o ( \"unknown type name \"test_struct\")\n</code></pre>\n\n<p>What am I doing wrong? </p>\n\n<p>I have also another .c which include \"commons.h\" and while compiling everything is fine, only with work.c I get error.</p>\n"}, {"tags": ["c", "file", "parsing"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566939162, "post_id": 57682090, "comment_id": 101810697, "body": "You can read some ideas in <a href=\"https://www.eskimo.com/~scs/cclass/notes/sx10h.html\" rel=\"nofollow noreferrer\">these class notes</a>."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1566939800, "post_id": 57682090, "comment_id": 101810882, "body": "How likely is bad input?  You may find it better to grab a known line of input with something like <code>getline()</code> and then parse each line separately with <code>sscanf()</code>.  That way one bad line won&#39;t ruin the parsing of the rest of the input.  Recovering from a botched <code>fscanf()</code> is hard - you don&#39;t really know where you are in your input stream, and if the stream isn&#39;t seekable it&#39;s almost impossible to recover."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1566940768, "post_id": 57682090, "comment_id": 101811207, "body": "Why not <code>while (fscanf(party_data, &quot;%s %s %s&quot;, name, last, id) == 3) { &#47;* do your stuff *&#47; }</code> (or better read with <code>fgets()</code> then use <code>sscanf()</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 0, "creation_date": 1566940594, "post_id": 57682151, "comment_id": 101811147, "body": "what is <code>isspace</code>?"}, {"owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "reply_to_user": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "edited": false, "score": 1, "creation_date": 1566940710, "post_id": 57682151, "comment_id": 101811183, "body": "@vesii: it&#39;s a function declared in <code>&lt;ctype.h&gt;</code> that will return true (non-zero) for a character that&#39;s white-space (space, tab,vertical tab, new-line) and false (zero) otherwise."}], "tags": [], "owner": {"reputation": 435402, "user_id": 179910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8962238339d771f0348967be6f97b1b?s=128&d=identicon&r=PG", "display_name": "Jerry Coffin", "link": "https://stackoverflow.com/users/179910/jerry-coffin"}, "is_accepted": false, "score": 2, "last_activity_date": 1566940804, "last_edit_date": 1566940804, "creation_date": 1566939327, "answer_id": 57682151, "question_id": 57682090, "link": "https://stackoverflow.com/questions/57682090/spliting-each-line-by-spaces-in-c/57682151#57682151", "title": "Spliting each line by spaces in C", "body": "<p>A single space character in a format string for <code>scanf</code> (or its cousins such as <code>fscanf</code>, <code>sscanf</code>, <code>vfscanf</code>, and so on) can match an arbitrary amount of white space in the input (including not just spaces, but also tabs, vertical tabs, and new-lines), so your <code>fscanf</code> call is probably fine as it stands now. Oh, except for one detail: you generally want to avoid a bare <code>%s</code> conversion, and use something like:</p>\n\n<pre><code>char dest[16];\nscanf(\"%15s\", dest);\n</code></pre>\n\n<p>That is, you always want to specify the maximum size, which should be one smaller than the size of buffer you're supplying.</p>\n\n<p>If you don't want to use <code>scanf</code> and company, you have a couple of choices. You could start with <code>strspn</code> and <code>strcspn</code>, or you could just use while loops with <code>isspace</code>:</p>\n\n<pre><code>char *line = /* whatever*/;\n\nwhile (!isspace(*line))\n   *first++ = *line++;\n*first = '\\0';\n\nwhile (isspace(*line))\n    ++line;\n\nwhile (*isspace(*line))\n    *second++ = *line++;\n*second = '\\0';\n\nwhile (isspace(*line))\n    ++line;\n\nwhile (*isspace(*line))\n    *third++ = *line++;\n*third = '\\0';\n</code></pre>\n\n<p>In real use, you'd also want to keep track of the length of the destination buffer, and only copy as much into it as it can actually hold (or else figure up the size each needs, and allocate accordingly).</p>\n\n<p>Oh, and one other minor detail: when you call <code>isspace</code>, you should really cast its operand to <code>unsigned char</code>. Without casting, using it for some non-English characters (e.g., with accents, unlauts, etc.) can give undefined behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1566944384, "last_edit_date": 1566944384, "creation_date": 1566942862, "answer_id": 57682699, "question_id": 57682090, "link": "https://stackoverflow.com/questions/57682090/spliting-each-line-by-spaces-in-c/57682699#57682699", "title": "Spliting each line by spaces in C", "body": "<p>This is one of the most fundamental things you must do in any language:</p>\n\n<ol>\n<li>read data from a file, and</li>\n<li>parse that data into needed information.</li>\n</ol>\n\n<p>In your case you have whitespace separate names and an ID in your input file. While you can use <code>fscanf</code> directly, it is horribly fragile. If a single line does not match your <em>format string</em>, your read will fail with a <em>matching failure</em>, character extraction from the stream ceases, and you are then left with the remainder of the line in your input buffer to deal with before you can move forward.</p>\n\n<p>For that reason, a better approach is the read each line into a buffer with <code>fgets</code> and a sufficiently sized buffer (or using POSIX <code>getline</code>) to consume an entire line of input with every read. The you can parse the needed information from the line stored in the buffer without affecting your read operation. This also provides the benefit of being able to independently validate your (1) read, and (2) the parse of information.</p>\n\n<p>There are many ways to parse the needed information from the buffer. You can use <code>sscanf</code> reading from the buffer (much like you would have used <code>fscanf</code> on the input itself), you can walk-a-pair-of-pointers down the buffer, bracketing each word and then <code>memcpy</code> and <em>nul-terminate</em>, you can use <code>strtok</code> (but it modifies the original buffer), or you can use a combination of <code>strspn</code> and <code>strcspn</code> to bracket each word similar to walking the pointers.</p>\n\n<p>In your case let's just use <code>sscanf</code> since for a fixed format, it is just as easy. To store your 3-strings worth of <code>name, last, id</code>, create a struct with those members, then you can create an array of struct (we will leave the dynamic array, or linked-list for later), and you can store all names and IDs you read, for example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXID  16   /* if you need a constant, #define one (or more) */\n#define MAXNM  32\n#define MAXPN 128\n#define MAXC 1024\n\ntypedef struct {\n    char name[MAXNM],\n         last[MAXNM],\n         id[MAXID];\n} typeperson;\n</code></pre>\n\n<p>You now have a struct (with a convenient <code>typedef</code> to <code>typeperson</code> you can use to create an array of struct (with each array initialized all zero), e.g.</p>\n\n<pre><code>int main (int argc, char **argv) {\n\n    char buf[MAXC];\n    size_t n = 0;\n    typeperson person[MAXPN] = {{\"\", \"\", \"\"}};\n</code></pre>\n\n<p>You now have an array of <code>MAXPN</code> (<code>128</code>) person to fill. Now simply open your file using the name provided as the first argument to your program (or read from <code>stdin</code> by default if no argument is given) and <strong><em>validate</em></strong> the file is open for reading:</p>\n\n<pre><code>    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n</code></pre>\n\n<p>With your file open and <strong><em>validated</em></strong>, you can now read each line into <code>buf</code> and then parse <code>name, last, id</code> from <code>buf</code> using <code>sscanf</code> (all conversion specifiers except for <code>\"%c\"</code> and <code>\"%[..]\"</code> (and technically <code>\"%n\"</code>, but that doesn't extract from the buffer) skip all leading whitespace allowing you to separate your <code>name, last, id</code> regardless of the amount of whitespace between them:</p>\n\n<pre><code>    /* protect array bounds and read each line into struct */\n    while (n &lt; MAXPN &amp;&amp; fgets (buf, MAXC, fp)) {\n        if (sscanf (buf, \"%s %s %s\", \n                    person[n].name, person[n].last, person[n].id) == 3)\n        n++;\n    }\n</code></pre>\n\n<p>(<strong>note:</strong> the test of <code>n &lt; MAXPN</code> that protects your array bounds and prevents you from writing more elements than you have storage for)</p>\n\n<p>What happens if the line has the wrong format? How do you recover? Simple. By consuming a line with each read, any line that doesn't match your <code>sscanf</code> <em>format string</em> is quietly ignore and does not cause you any problem.</p>\n\n<p>All that remains is closing the file and using your data in any way you need. Putting it together in a short example, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXID  16   /* if you need a constant, #define one (or more) */\n#define MAXNM  32\n#define MAXPN 128\n#define MAXC 1024\n\ntypedef struct {\n    char name[MAXNM],\n         last[MAXNM],\n         id[MAXID];\n} typeperson;\n\nint main (int argc, char **argv) {\n\n    char buf[MAXC];\n    size_t n = 0;\n    typeperson person[MAXPN] = {{\"\", \"\", \"\"}};\n    /* use filename provided as 1st argument (stdin by default) */\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        perror (\"file open failed\");\n        return 1;\n    }\n    /* protect array bounds and read each line into struct */\n    while (n &lt; MAXPN &amp;&amp; fgets (buf, MAXC, fp)) {\n        if (sscanf (buf, \"%s %s %s\", \n                    person[n].name, person[n].last, person[n].id) == 3)\n        n++;\n    }\n    if (fp != stdin) fclose (fp);   /* close file if not stdin */\n\n    for (size_t i = 0; i &lt; n; i++)  /* output the resutls */\n        printf (\"person[%3zu] : %-20s %-20s %s\\n\",\n                i, person[i].name, person[i].last, person[i].id);\n}\n</code></pre>\n\n<p><strong>Example Input File</strong></p>\n\n<p>With an intentional line that does not match the format (e.g. <code>\"...\"</code>):</p>\n\n<pre><code>$ cat dat/peopleid.txt\nGeorge      Washington          1\nJohn        Adams               2\nThomas      Jefferson           3\nJames       Madison             4\n...\nRoyal       Embarrasment        45\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<pre><code>$ ./bin/struct_person &lt; dat/peopleid.txt\nperson[  0] : George               Washington           1\nperson[  1] : John                 Adams                2\nperson[  2] : Thomas               Jefferson            3\nperson[  3] : James                Madison              4\nperson[  4] : Royal                Embarrasment         45\n</code></pre>\n\n<p>Look things over and let me know if you have any further questions.</p>\n"}], "owner": {"reputation": 1811, "user_id": 9808098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d9c44d685cabf03d0555543896b4ba1?s=128&d=identicon&r=PG&f=1", "display_name": "vesii", "link": "https://stackoverflow.com/users/9808098/vesii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1566944384, "creation_date": 1566939018, "question_id": 57682090, "link": "https://stackoverflow.com/questions/57682090/spliting-each-line-by-spaces-in-c", "title": "Spliting each line by spaces in C", "body": "<p>I have a file with lines of the format:</p>\n\n<pre><code>&lt;string&gt;&lt;spaces&gt;&lt;string&gt;&lt;spaces&gt;&lt;string&gt;\n</code></pre>\n\n<p>I don't know the number of spaces between each string. I would like to parse the line and insert each string into a variable (the first string represents a name, the second last name, and the third id). I saw that I can use <code>strtok</code> but I prefer not to use it, rather a loop which iterates over the line.</p>\n\n<p>I also found out that I can use:</p>\n\n<pre><code>if(fscanf(party_data,\"%s %s %s\",name,last,id) != 3){\n   break;\n}\n</code></pre>\n\n<p>but I think a while loop is better. The problem with the while loop is the fact I don't know the amount of spaces between each string. My goal is to create a function <code>parseLine</code> which gets three pointers (name, last and id) and parses the line. How should the function look like?</p>\n"}, {"tags": ["c", "algorithm", "performance", "boyer-moore"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1566937076, "post_id": 57681697, "comment_id": 101809983, "body": "C and C++ are distinct languages. It&#39;s not relevant to tag C++ for a question about C."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1566937076, "post_id": 57681697, "comment_id": 101809984, "body": "There&#39;s no particular general implementation for <code>strstr</code>."}, {"owner": {"reputation": 194, "user_id": 11450331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be921af36dfe82792c48cfc90d74989c?s=128&d=identicon&r=PG&f=1", "display_name": "omri", "link": "https://stackoverflow.com/users/11450331/omri"}, "edited": false, "score": 1, "creation_date": 1566937152, "post_id": 57681697, "comment_id": 101810006, "body": "I&#39;ve found a post that might be of use to you: <a href=\"https://stackoverflow.com/questions/3183582/what-is-the-fastest-substring-search-algorithm\" title=\"what is the fastest substring search algorithm\">stackoverflow.com/questions/3183582/&hellip;</a>"}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 3, "creation_date": 1566937182, "post_id": 57681697, "comment_id": 101810015, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/3183582/what-is-the-fastest-substring-search-algorithm\">What is the fastest substring search algorithm?</a>"}, {"owner": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1566937253, "post_id": 57681697, "comment_id": 101810042, "body": "A billion very long strings? Like, 100 GB of data? You definitely need something better than linear search..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "reply_to_user": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1566937255, "post_id": 57681697, "comment_id": 101810043, "body": "@ggorlen sure, I&#39;ve taken a look at that -- that&#39;s where I got the above link. My question is more is (re)implementing a Boyer-Moore vs. using <code>strstr</code> -- do I need to re-do the Boyer-Moore or does the strstr already do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "reply_to_user": {"reputation": 50126, "user_id": 1717300, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/81b91f602ce8acea8cbeb29f62725627?s=128&d=identicon&r=PG", "display_name": "hyde", "link": "https://stackoverflow.com/users/1717300/hyde"}, "edited": false, "score": 1, "creation_date": 1566937618, "post_id": 57681697, "comment_id": 101810172, "body": "@hyde -- a bit less, maybe about 10GB or so."}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 0, "creation_date": 1566937786, "post_id": 57681697, "comment_id": 101810249, "body": "Any linear search will be more &quot;ish&quot; than &quot;fast&quot;.  Seriously, create an index.  See <a href=\"https://stackoverflow.com/questions/9452701/ukkonens-suffix-tree-algorithm-in-plain-english/9513423#9513423\" title=\"ukkonens suffix tree algorithm in plain english\">stackoverflow.com/questions/9452701/&hellip;</a> to understand how you would do so efficiently."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1566938092, "post_id": 57681697, "comment_id": 101810359, "body": "@Shared <a href=\"https://stackoverflow.com/a/4208218/6243352\">This comment</a> from the other thread states that the asker had no problem outperforming <code>strstr</code>."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566938273, "post_id": 57681697, "comment_id": 101810408, "body": "It kind of depends on how often you&#39;re going to do this. If you need to do it once, then <code>strstr</code> is just fine. If you start it now, you&#39;ll have results before you can code up something faster. If you need to do this often, then I&#39;d suggest implementing something like the <a href=\"https://en.wikipedia.org/wiki/Aho%E2%80%93Corasick_algorithm\" rel=\"nofollow noreferrer\">Aho-Corasick string search algorithm</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566939162, "post_id": 57681697, "comment_id": 101810698, "body": "@JimMischel thanks for the suggestion. Why would you say (in the above case) using Aho-Corasick would be better than something like BM?"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566942931, "post_id": 57681697, "comment_id": 101811821, "body": "For some reason I thought you were wanting to search for multiple strings. If you only want to search for a single string, then the Boyer-Moore algorithm is probably the way to go. Aho-Corasick excels when there are multiple search strings."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "reply_to_user": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1566969696, "post_id": 57681697, "comment_id": 101816460, "body": "@JimMischel -- well, actually the answer is a bit more complex. It depends...The user could search for &quot;myfile&quot; or they could also search for &quot;mov mydir myfile archive&quot;, in which case it would be multiple strings. In that case, does the implementation change a bit?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1566973432, "post_id": 57681697, "comment_id": 101817609, "body": "<i>&quot;a filepath&quot;</i> is not a long string. On Linux that is generally less than 4096 characters (e.g. <code>PATH_MAX</code> characters), on windows that is 512 characters. Calling <code>strstr</code> a billion times on such strings will be just about as efficient as anything else (and a whole lot less error-prone than something you write yourself)"}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 0, "creation_date": 1567002468, "post_id": 57681697, "comment_id": 101833506, "body": "The Aho-Corasick algorithm excels when you&#39;re searching for &quot;foo&quot; or &quot;bar&quot; or &quot;scooby-doo&quot;. You can find all occurrences of all strings in a single pass."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566940265, "post_id": 57682236, "comment_id": 101811026, "body": "I see, thanks for this suggestion. So in the case of the above, where we don&#39;t want to use indexes (at least to start with), what type of algorithmic search would you suggest? Is <code>strstr</code> as good as it would get on small strings?"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1566940640, "post_id": 57682236, "comment_id": 101811163, "body": "Yes, I would just use strstr()--even thinking of anything else is seriously premature optimization. You can consider changing it when you have profiling data that shows it as a bottleneck, which I highly doubt it will ever be."}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "edited": false, "score": 2, "creation_date": 1566941072, "post_id": 57682236, "comment_id": 101811304, "body": "No.  Boyer-Moore precomputes its lookup table from the string that you are searching FOR, not the one you are searching IN.  This is how searching for a string of length <code>m</code> in a string of length <code>n</code> can take time <code>O(n&#47;m)</code>.  Therefore you could indeed use that.  It just won&#39;t help you enough with gigabytes of data to search through."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 1, "creation_date": 1566942172, "post_id": 57682236, "comment_id": 101811613, "body": "I did word that badly, and I&#39;ll fix. But the answer stands. The size of the BM lookup table, for example, is the size of the character set, which is probably 256 bytes for 8-bit characters and more for Unicode. Building a table that size from even a small string to be searched for is overhead that would overwhelm the tiny size of a pathname to be searched."}, {"owner": {"reputation": 121669, "user_id": 56778, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/34b152ef95a49568ce45df38cd87e54b?s=128&d=identicon&r=PG", "display_name": "Jim Mischel", "link": "https://stackoverflow.com/users/56778/jim-mischel"}, "edited": false, "score": 1, "creation_date": 1566943090, "post_id": 57682236, "comment_id": 101811857, "body": "Except that he&#39;s searching multiple strings, so the cost of initializing the lookup table is amortized. Across a billion strings, the per-search cost of building that lookup table is essentially zero."}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 0, "creation_date": 1566943196, "post_id": 57682236, "comment_id": 101811884, "body": "Actually, the question makes it unclear whether the &quot;billion strings&quot; are needles or haystacks. If needles, then yes, Aho-Corasick might be useful."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566945181, "post_id": 57682236, "comment_id": 101812333, "body": "@LeeDanielCrocker to clarify -- imagine a billion files, one search string (find myfile.mov in this database/filesystem)"}, {"owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "edited": false, "score": 2, "creation_date": 1566948988, "post_id": 57682236, "comment_id": 101812966, "body": "Ah, well then that is a good candidate for Boyer-Moore. That&#39;s not at all how I read the question the first time."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "edited": false, "score": 0, "creation_date": 1566969859, "post_id": 57682236, "comment_id": 101816501, "body": "@LeeDanielCrocker thanks for pointing out the confusion in how I worded the question. I&#39;ve updated it with a couple concrete examples."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": true, "score": 2, "last_activity_date": 1566942167, "last_edit_date": 1566942167, "creation_date": 1566939790, "answer_id": 57682236, "question_id": 57681697, "link": "https://stackoverflow.com/questions/57681697/searching-a-substring-in-c/57682236#57682236", "title": "Searching a substring in C", "body": "<p>Advanced search algorithms like Boyer-Moore and Aho-Corasick work by precomputing lookup tables from the string(s) to be searched for, which incurs a large start-up time. It's very unlikely that searching something as small as a pathname would be able to make up for that high overhead. You really have to be searching something like multi-page documents before those algorithms show their value.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11954200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 57682236, "answer_count": 1, "score": 0, "last_activity_date": 1566969832, "creation_date": 1566936978, "last_edit_date": 1566969832, "question_id": 57681697, "link": "https://stackoverflow.com/questions/57681697/searching-a-substring-in-c", "title": "Searching a substring in C", "body": "<p>Suppose I have a very long string, such as a filepath, and I want to search for something in it. For example, something like the <code>$ find</code> command. It seems like a basic implementation of this would be along the lines of:</p>\n\n<pre><code>if(strstr(sent, word) != NULL) {\n    return 1;\n}\n</code></pre>\n\n<p>Would there be any performance difference between doing that and something like <a href=\"https://chromium.googlesource.com/v8/v8.git/+/d123f30b6df5507b2acda8e85ad63e05de8ca8a7/src/string-search.h#428\" rel=\"nofollow noreferrer\">Boyer Moore</a>? Or does <code>strstr</code> already do something just as efficient?</p>\n\n<p>Basically, I have about a billion very long strings, and I'm looking to do a fast(ish) find on them (without any indexing), based on the most efficient substring implementation. What should I use?</p>\n\n<hr>\n\n<p><strong>Update</strong>: To give a more concrete example, let's say I have a billion filepaths I want to search through:</p>\n\n<pre><code>/archive/1002/myfile.txt\n/archive/1002/newer.mov\n/user/tom/local_2014version1.mov\n</code></pre>\n\n<p>And from this I would search either one or more strings. Example samples would be:</p>\n\n<pre><code>\"1002\" // would return the first two fileds\n\"mov version tom\" // would return the first row\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault", "switch-statement", "text-segmentation"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1566935230, "post_id": 57681305, "comment_id": 101809255, "body": "What is <code>expr</code>, <code>i</code>, <code>pop</code> and <code>Stack</code>?"}, {"owner": {"reputation": 1651, "user_id": 635822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd51a3c79639c315af5864adc731298?s=128&d=identicon&r=PG", "display_name": "Jason", "link": "https://stackoverflow.com/users/635822/jason"}, "edited": false, "score": 0, "creation_date": 1566936224, "post_id": 57681305, "comment_id": 101809648, "body": "^ and a debugger will likely point you to the cause of the segfault."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1567088264, "post_id": 57681305, "comment_id": 101866570, "body": "The posted code calls &#39;pop()` twice for each switch case.  Strongly suggest not modifying the &#39;stack&#39; at all."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 11985795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ca95ab41defe0188afacf602b5c519?s=128&d=identicon&r=PG&f=1", "display_name": "jackheckerhatesc", "link": "https://stackoverflow.com/users/11985795/jackheckerhatesc"}, "edited": false, "score": 0, "creation_date": 1566935510, "post_id": 57681347, "comment_id": 101809361, "body": "yes yes yes thank you!!!! This solved my problem completely hope you have a nice day thank you you lightened up my day"}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566935856, "post_id": 57681347, "comment_id": 101809488, "body": "@Barmar:  added example solution, but it assumes pop() and push() semantics (so it might not work directly)."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566936095, "post_id": 57681347, "comment_id": 101809587, "body": "It probably <i>should</i> pop the stack if the top is the correct balancing bracket."}, {"owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1566936861, "post_id": 57681347, "comment_id": 101809891, "body": "@Barmar:  Yeah, <i>probably</i>.  Need to see more code to be sure."}], "tags": [], "owner": {"reputation": 53754, "user_id": 198536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9edaf4c1c1b89b5d39c40528d0017509?s=128&d=identicon&r=PG", "display_name": "wallyk", "link": "https://stackoverflow.com/users/198536/wallyk"}, "is_accepted": false, "score": 2, "last_activity_date": 1566935780, "last_edit_date": 1566935780, "creation_date": 1566935308, "answer_id": 57681347, "question_id": 57681305, "link": "https://stackoverflow.com/questions/57681305/how-to-fix-this-segmentation-fault-11-for-this-switch-function/57681347#57681347", "title": "How to fix this &quot;segmentation fault 11&quot; for this switch function?", "body": "<p>I doubt the <em>switch</em> is causing the segfault.  It is more likely to be the use of <code>pop()</code>.</p>\n\n<p>Is <em>pop</em> changing the stack?  If so, <em>pop</em> is twice being evaluated in:</p>\n\n<pre><code> case ')':\n    if (pop(&amp;Stack) == '{'  ||  pop(&amp;Stack) =='[')\n</code></pre>\n\n<p>when the character is <code>)</code> and the matching value popped is <code>(</code>.</p>\n\n<p>To fix, restructure this area of code like this (depending on how <em>pop</em> interacts):</p>\n\n<pre><code>/*\n *  Have a peek at the top of stack without disrupting content\n */\nchar top_of_stack = pop (&amp;Stack);\npush (&amp;Stack, top_of_stack); // put it back\n\nswitch (expr[i]) \n{ \ncase ')':\n     if (top_of_stack == '{' || top_of_stack == '[')\n            return 0;\n     break; \n\ncase '}':\n     if (top_of_stack == '(' || top_of_stack == '[')\n            return 0;\n     break; \n\ncase ']':\n     if (top_of_stack == '{' || top_of_stack == '(')\n            return 0;\n      break; \n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11985795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8ca95ab41defe0188afacf602b5c519?s=128&d=identicon&r=PG&f=1", "display_name": "jackheckerhatesc", "link": "https://stackoverflow.com/users/11985795/jackheckerhatesc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1566935780, "creation_date": 1566935074, "last_edit_date": 1566935328, "question_id": 57681305, "link": "https://stackoverflow.com/questions/57681305/how-to-fix-this-segmentation-fault-11-for-this-switch-function", "title": "How to fix this &quot;segmentation fault 11&quot; for this switch function?", "body": "<p>I'm new to c and am writing a switch function that whenever the passed in string is ), }, ], it returns false when the popped out expression isn't the matching open parentheses. (yes, it's the balanced parentheses problem...)</p>\n\n<p>I can be sure that the segmentation fault only comes from this switch statement, and the code works perfectly fine without it. </p>\n\n<p>my code is:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nswitch (expr[i]) \n        { \n        case ')': if (pop(&amp;Stack) == '{' || pop(&amp;Stack) =='[') { \n                  return 0;}\n            break; \n\n        case '}': if (pop(&amp;Stack) == '(' || pop(&amp;Stack) =='[') {\n                  return 0; }\n            break; \n\n        case ']': if (pop(&amp;Stack) == '{' || pop(&amp;Stack) =='(') {\n                  return 0; }\n            break; \n        } \n</code></pre>\n\n<p>It gives me \"Segmentation fault: 11\".</p>\n"}, {"tags": ["c", "atomic", "c11"], "comments": [{"owner": {"reputation": 4586, "user_id": 1507014, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ca563ac151770f5ae24c741970401c81?s=128&d=identicon&r=PG", "display_name": "Bentoy13", "link": "https://stackoverflow.com/users/1507014/bentoy13"}, "edited": false, "score": 1, "creation_date": 1566981691, "post_id": 57681154, "comment_id": 101821466, "body": "From the doc you are linking: &quot;type-name - any type other than array or function.&quot; So yes, you can use _Atomic for structs."}], "answers": [{"tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": true, "score": 3, "last_activity_date": 1566980301, "last_edit_date": 1566980301, "creation_date": 1566979890, "answer_id": 57687787, "question_id": 57681154, "link": "https://stackoverflow.com/questions/57681154/atomic-structure-in-c/57687787#57687787", "title": "Atomic structure in C?", "body": "<p>Yes, you are allowed to use the <code>_Atomic</code> qualifier for structures. </p>\n\n<p>With these structures you then basically only have the restricted possibilities of access through the <code>atomic_...</code> type generic functions (or by structure assignment), you can't access the individual fields. The most useful of these functions is probably <code>atomic_compare_exchange_weak</code>.</p>\n\n<p>If your structure does not fit into a wide register, platforms usually implement these atomic types by using some kind of lock that is stored outside of your structure. If it does, they use the native capacities of the platform. Such properties may depend on your compiler options, in particular  you'd have to ensure that these are the same for all your compiled objects.</p>\n\n<p>For <code>gcc</code> usually <code>-march=native</code> triggers the best features for that, for example the use of 128 bit native atomics if they are available.</p>\n"}], "owner": {"reputation": 14214, "user_id": 476410, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a2eca89d3f5a16ae846f501d0596116c?s=128&d=identicon&r=PG", "display_name": "tarabyte", "link": "https://stackoverflow.com/users/476410/tarabyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 57687787, "answer_count": 1, "score": 1, "last_activity_date": 1566980452, "creation_date": 1566934328, "last_edit_date": 1566980452, "question_id": 57681154, "link": "https://stackoverflow.com/questions/57681154/atomic-structure-in-c", "title": "Atomic structure in C?", "body": "<p>I want to make the entire contents of a small C structure <code>atomic</code>, but <a href=\"https://en.cppreference.com/w/c/atomic\" rel=\"nofollow noreferrer\">the documentation</a> appears to show that only primitive data types as fields within the struct can be made atomic.</p>\n\n<p>For example, I want to do:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdatomic.h&gt;\n\ntypedef struct my_obj_s {\n  int16_t a;\n  int16_t b;\n  bool is_initialized;\n} my_obj_t;\n\n_Atomic my_obj_t my_atomic_object;\n</code></pre>\n\n<p>but only appear to be able to do:</p>\n\n<pre><code>typedef struct my_obj_s {\n  atomic_char16_t a;\n  atomic_char16_t b;\n  atomic_bool is_initialized;\n} my_obj_t;\n</code></pre>\n\n<p>Is there no way to achieve atomicity on anything larger than a primitive data type (short of bracketing reads/writes in locks/mutexes/etc)?</p>\n"}, {"tags": ["c", "linux", "filesystems", "linux-df"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 11286381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd2ffc4653496e286780db3b32ce3f5?s=128&d=identicon&r=PG&f=1", "display_name": "bicup", "link": "https://stackoverflow.com/users/11286381/bicup"}, "edited": false, "score": 0, "creation_date": 1566934789, "post_id": 57680954, "comment_id": 101809080, "body": "<code>f_bavail</code> indeed fixes &quot;Available&quot;, but messes up &quot;Used&quot; which remained <code>n_1k_blocks - avail</code>"}], "tags": [], "owner": {"reputation": 3574, "user_id": 5793987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a057299226b268d59f2faa0b3f1d1112?s=128&d=identicon&r=PG", "display_name": "gudok", "link": "https://stackoverflow.com/users/5793987/gudok"}, "is_accepted": false, "score": 1, "last_activity_date": 1566933354, "creation_date": 1566933354, "answer_id": 57680954, "question_id": 57680644, "link": "https://stackoverflow.com/questions/57680644/available-blocks-with-df/57680954#57680954", "title": "Available blocks with `df`", "body": "<p>(938464504-889636296)/959863856 = .05</p>\n\n<p>The difference in number of available blocks is 5%. This number most likely comes from the reserved blocks, i.e. standard df excludes reserved blocks from the output as they are not available for ordinary users.</p>\n\n<p>For example, explanation from mkfs.ext4(8):</p>\n\n<blockquote>\n  <p>-m reserved-blocks-percentage Specify the percentage of the filesystem blocks reserved for the super-user. This avoids fragmentation, and allows root-owned daemons, such as syslogd(8), to continue to function correctly after non-privileged processes are prevented from writing to the filesystem. The default percentage is 5%.</p>\n</blockquote>\n\n<p>EDIT: you should use <code>f_bavail</code> instead of <code>f_bfree</code> if you want to get the same results as standard <code>df</code> utility.</p>\n"}], "owner": {"reputation": 185, "user_id": 11286381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bd2ffc4653496e286780db3b32ce3f5?s=128&d=identicon&r=PG&f=1", "display_name": "bicup", "link": "https://stackoverflow.com/users/11286381/bicup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1566934503, "creation_date": 1566931803, "last_edit_date": 1566934503, "question_id": 57680644, "link": "https://stackoverflow.com/questions/57680644/available-blocks-with-df", "title": "Available blocks with `df`", "body": "<p>I'm using <code>statvfs</code> to have an extremely simple in-house <code>df</code> command.</p>\n\n<p>Other than not knowing how to get the file system device path, my main issue is that the available 1K blocks differ in my implementation and the <code>df</code> output.</p>\n\n<p>Here's mine:</p>\n\n<pre><code>Filesystem       1K-blocks            Used       Available           Use%      Mounted on\n/dev/x           959863856        21399352       938464504               2      /\n</code></pre>\n\n<p><code>df</code>'s:</p>\n\n<pre><code>Filesystem     1K-blocks     Used Available Use% Mounted on\n/dev/sda2      959863856 21399352 889636296   3% /\n</code></pre>\n\n<p>\"Used\" and \"Available\" are both in 1K-blocks units. The percentage could be due to rounding. How do I get the available space?</p>\n\n<p>Here's my implementation:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int main(int argc, char *argv[]) {\n    struct statvfs stats;\n    statvfs(argv[1], &amp;stats);\n\n    unsigned long n_1k_blocks = stats.f_blocks * stats.f_frsize / 1024;\n    unsigned long avail = stats.f_bfree * stats.f_frsize / 1024;\n    unsigned long used = n_1k_blocks - avail;\n    printf(\"%-*s\\t%*lu\\t%*lu\\t%*lu\\t%*.0f\\t%s\\n\", \n        spaces, \"/dev/x\", \n        spaces, n_1k_blocks,\n        spaces, used, \n        spaces, avail,\n        spaces, 100 - (float)stats.f_bfree * 100.0 / stats.f_blocks,\n        argv[1] // e.g. \" / \"\n    );\n    return 0;\n}\n</code></pre>\n\n<p>I call it as: <code>./a.out /</code> for the filesystem mounted at <code>/</code></p>\n\n<p>Side note: looking around, I read busybox's <a href=\"https://elixir.bootlin.com/busybox/0.39/source/df.c\" rel=\"nofollow noreferrer\">df source</a>; coreutils is a bit way too complicated for me now</p>\n"}, {"tags": ["c", "arguments", "output"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566929175, "post_id": 57680056, "comment_id": 101806910, "body": "Evidently related to <a href=\"https://stackoverflow.com/questions/57674081/declaring-a-n-argument-to-accept-an-integer-in-the-command-line-c\">this question</a>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566929254, "post_id": 57680056, "comment_id": 101806941, "body": "What&#39;s that strange computation <code>n-(2*n)</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566929265, "post_id": 57680056, "comment_id": 101806944, "body": "Well done for posting the code."}, {"owner": {"reputation": 49, "user_id": 11980136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDg2-o3Szcx9hOOQtHU9Ke6umu3MmWMHt1bVyLEJg=k-s128", "display_name": "deezy", "link": "https://stackoverflow.com/users/11980136/deezy"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566929311, "post_id": 57680056, "comment_id": 101806969, "body": "@SteveSummit It&#39;s just to get negative n. And yeah my previous post got put on hold, so being new I have no idea how this site works fully yet so I thought best start a new one with my updated problem."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 4, "creation_date": 1566929379, "post_id": 57680056, "comment_id": 101806988, "body": "When you call <code>read</code> to read characters, always capture the return value: <code>r = read(...)</code>.  If <code>r</code> is less than 0, there&#39;s been an error.  If <code>r</code> is 0, you&#39;ve reached end-of-file.  If <code>r</code> is greater than 0, you&#39;ve read some characters, but you should then do something with <code>r</code> number of characters, not <code>sizeof(buf)</code> (and certainly not <code>sizeof(buf)-1</code>).  I suspect that&#39;s why you&#39;re getting strange characters, but you&#39;re ignoring `read&#39;s attempt to tell you something&#39;s wrong."}, {"owner": {"reputation": 49, "user_id": 11980136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDg2-o3Szcx9hOOQtHU9Ke6umu3MmWMHt1bVyLEJg=k-s128", "display_name": "deezy", "link": "https://stackoverflow.com/users/11980136/deezy"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566929736, "post_id": 57680056, "comment_id": 101807145, "body": "Thank you so much @SteveSummit . It is working perfectly now. It does however display the next command line in the terminal on the same line as the output. Any advice would be great thank you."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1566930839, "post_id": 57680056, "comment_id": 101807549, "body": "If the last character in the file is <i>not</i> a newline, then you&#39;ll need to output a newline before exiting the program.  BTW, <code>exit(0)</code> and <code>return(0)</code> do the same thing (in <code>main</code>) so you only need one of them."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1566930988, "post_id": 57680056, "comment_id": 101807604, "body": "...and <code>return 0;</code> is usual. Note that unlike <code>exit(0)</code> the <code>return 0;</code> isn&#39;t a function."}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 0, "last_activity_date": 1567109677, "last_edit_date": 1567109677, "creation_date": 1567103350, "answer_id": 57715979, "question_id": 57680056, "link": "https://stackoverflow.com/questions/57680056/how-to-print-characters-from-text-file-using-arguments-in-c/57715979#57715979", "title": "How to print characters from text file, using arguments, in C?", "body": "<p>Note: this answer is an adaptation of the original answer to the <em><a href=\"https://stackoverflow.com/questions/57674081/declaring-a-n-argument-to-accept-an-integer-in-the-command-line-c\">first version of this question</a></em> (now on hold)</p>\n\n<p><em>I need to set an integer n using an argument -n</em>.    </p>\n\n<p>Assuming the command line would look similar to <code>prog.exe -n 4</code>, the arguments of <code>main(int argc, char* argv[])</code> will be populated as:</p>\n\n<pre><code>argc == 3\nargv[] == {\"programName.exe\", \"-n\", \"4\"}\n</code></pre>\n\n<p><code>argc</code> could be reduced to 2 by either combining <code>-n</code> and <code>4</code>:  <code>-n4</code>, or eliminating the <code>-n</code> altogether, and just recognizing in the code that argv[1] (the 2nd argument) is a string representation of the value you need, and convert it to an <code>int</code> type.</p>\n\n<p>Example:  </p>\n\n<pre><code>programName.exe 3\n</code></pre>\n\n<p>Then code it like this:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    char *dummy;\n    int val;\n    if(argc != 2)\n    {\n        printf(\"Usage: prog.exe &lt;n&gt; where &lt;n&gt; is a positive integer value.\\nProgram will now exit\");\n        return 0;\n    }\n    // Resolve value of 2nd argument:\n    val = strtol(argv[1], &amp;dummy, 10);\n    if (dummy == argv[1] || ((val == LONG_MIN || val == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n            //handle error\n    }\n    //use val to read desired content from file\n    ...\n\n    return 0;\n}\n</code></pre>\n\n<p>Some other general suggestions:</p>\n\n<p>User input in general needs to be kept as predictable as possible.  Be explicit when requesting what is acceptable for the user to enter, and reject anything that does not comply.  Example, if a program is expecting a single digit argument, then force it to be just that, and reject everything else.  Given user input that does not comply:</p>\n\n<blockquote>\n  <p>prog.exe 3 4 5</p>\n</blockquote>\n\n<p>detect in in the code:</p>\n\n<pre><code>int main(int argc, char *argv[]) \n{\n    int val = 0;\n    char *dummy = NULL;\n\n    if(argc != 2)\n    {\n        printf(\"Usage: prog.exe &lt;n&gt; - Where &lt;n&gt; is an integer with value &gt; 0\\n Program will now exit.\");\n        return 0;\n    }\n    val = strtol(argv[1], &amp;dummy, 10);\n    if (dummy == argv[1] || ((val == LONG_MIN || val == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n        printf(\"Usage: prog.exe &lt;n&gt; - Where &lt;n&gt; is an integer with value &gt; 0\\n Program will now exit.\");\n        return 0;\n\n    }\n\n    ...\n</code></pre>\n\n<p>Using portable functions (replacing <code>lseek</code> with <code>fseek</code>, and <code>open</code> with <code>fopen</code>, etc.)  (read <em><a href=\"https://stackoverflow.com/questions/1658476/c-fopen-vs-open\">this for an example of the reason why</a></em>) here is an adaptation of your code that does what you described you needed it to do, including using the <code>prog.exe -n &lt;n&gt;</code> argument, ( <code>argv == 3</code> ).</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    char *dummy;\n    char buf[1000]; \n    int n;    \n\n\n    //initialising n to zero\n    n = 0;\n\n    //checking if the program run call is greater than one argument\n    if(argc != 3)\n    {\n        printf(\"Usage: prog.exe -n &lt;n&gt; - Where &lt;n&gt; is an integer with value &gt; 0\\n Program will now exit.\");\n       return 0;\n    }\n    n = strtol(argv[2], &amp;dummy, 10);\n    if (dummy == argv[2] || ((n == LONG_MIN || n == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n        printf(\"Usage: prog.exe &lt;n&gt; - Where &lt;n&gt; is an integer with value &gt; 0\\n Program will now exit.\");\n        return 0;\n\n    }\n\n\n    // open the file for read only \n    FILE *fd = fopen(\".\\\\data.txt\", \"r\");\n\n    //Check if it can open and subsequent error handling\n    if(!fd)\n    {\n        char err[] = \"Could not open the file\";\n        fputs(err, stdout);\n        return 0;\n    }\n\n    //use lseek to place pointer n characters from the end of file and then use read to write it to the buffer\n    fseek(fd, (n-(2*n)), SEEK_END);\n    if(fgets(buf, n, fd))\n    {\n        //write out to the standard output\n        fwrite(buf, 1, n, stdout);\n    }\n    else \n    {\n        ;//handle error\n    }\n\n    //close the file fd and exit normally with code 0\n    fclose(fd);\n\n    return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11980136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDg2-o3Szcx9hOOQtHU9Ke6umu3MmWMHt1bVyLEJg=k-s128", "display_name": "deezy", "link": "https://stackoverflow.com/users/11980136/deezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1567109677, "creation_date": 1566929029, "question_id": 57680056, "link": "https://stackoverflow.com/questions/57680056/how-to-print-characters-from-text-file-using-arguments-in-c", "title": "How to print characters from text file, using arguments, in C?", "body": "<p>I need to set an integer <code>n</code> using an argument <code>-n</code> that will be set as the amount of characters to print from the end of a given <code>.txt</code> file. This needs to be done without the <code>&lt;stdio.h&gt;</code> library as it is a homework piece about system calls.</p>\n\n<p>I have a program that is able to accept the argument <code>-n</code> and prints the amount of characters as specified by the user. It however prints an unreadable list of characters and <code>NULLS</code> after the required output and causes my terminal to malfunction. </p>\n\n<pre><code>#include &lt;sys/types.h&gt; \n#include &lt;fcntl.h&gt; \n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char* argv[]) \n{ \n    //declaration of variables\n    char buf[1000]; \n    int fd;\n    int n;\n\n    //initialising n to zero\n    n = 0;\n\n    //checking if the program run call is greater than one argument\n    if(argc &gt; 1){\n    //if the second argument is equal to '-n' then take the 3rd argument (the int) and put it into n using stroll (string to long)\n        if(!strncmp(argv[1], \"-n\", 2)){\n    n = atoi(argv[2]);\n    }\n\n    //if n has no set value from -n, set it to 200\n    if(n == 0){\n    n = 200;}\n\n    // open the file for read only \n    fd = open(\"logfile.txt\", O_RDONLY); \n    //Check if it can open and subsequent error handling\n    if(fd == -1){\n        char err[] = \"Could not open the file\";\n        write(STDERR_FILENO, err, sizeof(err)-1);\n        exit(1);\n    }\n\n    //use lseek to place pointer n characters from the end of file and then use read to write it to the buffer\n    lseek(fd, (n-(2*n)), SEEK_END);\n    read(fd, buf, n);\n\n    //write out to the standard output\n    write(STDOUT_FILENO, buf, sizeof(buf)-1);\n\n    //close the file fd and exit normally with code 0\n    close(fd);\n    exit(0);\n    return(0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 6, "creation_date": 1566928485, "post_id": 57679937, "comment_id": 101806646, "body": "Why would you expect <code>%f</code> to print anything reasonable? It doesn&#39;t match either of the types in your union, and in any case, there&#39;s no mechanism which could possibly perform the necessary conversion."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566928659, "post_id": 57679937, "comment_id": 101806705, "body": "See also <a href=\"https://stackoverflow.com/questions/7480097/what-happens-to-a-float-variable-when-d-is-used-in-a-printf/57645470#57645470\">this answer</a> to a <a href=\"https://stackoverflow.com/questions/7480097\">similar question</a>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1566928879, "post_id": 57679937, "comment_id": 101806797, "body": "<code>a.y = 60; a.x = 12;</code> is contradictory. In a <code>union</code> it can&#39;t be both. A <code>union</code> is not a <code>struct</code>."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566928922, "post_id": 57679937, "comment_id": 101806813, "body": "Also, when you put 12 into <code>.x</code> and pull a char value out of <code>.y</code>, it&#39;s not guaranteed to be 12, either (that is, not even if you print it with <code>%d</code>, it&#39;s just not even guaranteed to be the char value 12 at all)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566929076, "post_id": 57679937, "comment_id": 101806860, "body": ".. only if little-endian."}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": false, "score": 1, "last_activity_date": 1566931130, "last_edit_date": 1566931130, "creation_date": 1566929990, "answer_id": 57680278, "question_id": 57679937, "link": "https://stackoverflow.com/questions/57679937/union-behaving-differently-on-using-different-format-specifier/57680278#57680278", "title": "Union behaving differently on using different format specifier", "body": "<p><code>a.y</code> is a char but here</p>\n\n<pre><code>printf(\"%f \",a.y);\n</code></pre>\n\n<p>you print it as if it is a <code>double</code>. That is undefined behaviour, i.e. you can get any kind of output.</p>\n\n<p>Always use the correct format specifier.</p>\n\n<p>Make sure to observe compiler warnings! For gcc I get</p>\n\n<pre><code>main.cpp: In function 'main':\nmain.cpp:12:10: warning: format '%f' expects argument of type 'double', but argument 2 has type 'int' [-Wformat=]\n   12 | printf(\"%f \",a.y);\n      |         ~^   ~~~\n      |          |    |\n      |          |    int\n      |          double\n      |         %d\n</code></pre>\n\n<p>which tells that something is all wrong.</p>\n\n<p>If you change the code to</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nunion p{\n    int x;\n    char y;\n    float z;\n};\n\nint main(){\n    union p a;\n    a.y = 60;\n    a.x = 12;\n    printf(\"%.200f \",a.z);\n    printf(\"%d \",a.y);\n    printf(\"%d\",a.x);\n}\n</code></pre>\n\n<p>the code becomes valid C code and gives this result:</p>\n\n<pre><code>0.00000000000000000000000000000000000000000001681558157189780485108475499947899357536314330251818926108481940667749299223032721783965826034545898437500000000000000000000000000000000000000000000000000000 12 12\n</code></pre>\n\n<p>on most little endian machines.</p>\n"}], "owner": {"reputation": 1, "user_id": 11808824, "user_type": "registered", "profile_image": "https://graph.facebook.com/696642310800400/picture?type=large", "display_name": "Mayank Mendiruttam", "link": "https://stackoverflow.com/users/11808824/mayank-mendiruttam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "closed_date": 1567075628, "answer_count": 1, "score": 0, "last_activity_date": 1566931130, "creation_date": 1566928429, "question_id": 57679937, "link": "https://stackoverflow.com/questions/57679937/union-behaving-differently-on-using-different-format-specifier", "closed_reason": "Not suitable for this site", "title": "Union behaving differently on using different format specifier", "body": "<pre><code>#include &lt;stdio.h&gt;\nunion p{\nint x;\nchar y;\n};\nint main(){\nunion p a;\na.y = 60;\na.x = 12;\nprintf(\"%f \",a.y);\nprintf(\"%d \",a.y);\nprintf(\"%d\",a.x);\n}\n</code></pre>\n\n<p>In above output is 0.000000 and 12 and 12 but i think it must be 12 and 12 and 12  can someone explain.</p>\n"}, {"tags": ["c", "embedded", "pic", "mplab", "lcd"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1566928954, "post_id": 57679890, "comment_id": 101806823, "body": "Is <code>LCD_Initialize()</code> a library function, or one you define in your code?   (Same question for  <code>SYSTEM_Initialize()</code>)  At what point in your code do you see the <i>random</i> characters on the LCD?  Are there return values you should be checking on the two function I asked about?  If so, I would start by looking at those values."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566931489, "post_id": 57679890, "comment_id": 101807775, "body": "Why are you using a different function with <code>LCDPutChar(&quot;test1&quot;);</code> as with <code>LCDPutStr(&quot;test2&quot;);</code> when they both are passed a string? Wasn&#39;t there a compiler warning about <code>LCDPutChar</code>? It is possible that the <i>address</i> passed to <code>LCDPutChar()</code> is considered as some kind of configuration, instead of the printable character that is expected."}, {"owner": {"reputation": 7, "user_id": 11984801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0b580d58b8af3aa188cd252e0606e?s=128&d=identicon&r=PG&f=1", "display_name": "AfricaOMM", "link": "https://stackoverflow.com/users/11984801/africaomm"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1566938111, "post_id": 57679890, "comment_id": 101810363, "body": "@ryyker <code>LCD_Initialize()</code> is a library function and <code>SYSTEM_Initialize ()</code> is a default function automatically generated by MPLAB <code>LCD_Initialize()</code> refers to the function <code>void LCD_Initialize()</code> located in the lcd.c file.  I see random characters once I have written the code in main.c, otherwise nothing is displayed on LCD."}, {"owner": {"reputation": 7, "user_id": 11984801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0b580d58b8af3aa188cd252e0606e?s=128&d=identicon&r=PG&f=1", "display_name": "AfricaOMM", "link": "https://stackoverflow.com/users/11984801/africaomm"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1566938558, "post_id": 57679890, "comment_id": 101810510, "body": "@WeatherVane it&#39;s an inattention on my part to have published the code using both functions. But initially the code was compiled with only <code>LCDPutStr</code> function, for a similar result."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10085080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a79e26083ea7b8473578d079ecc11c2d?s=128&d=identicon&r=PG&f=1", "display_name": "Dan1138", "link": "https://stackoverflow.com/users/10085080/dan1138"}, "is_accepted": false, "score": 0, "last_activity_date": 1567315408, "creation_date": 1567315408, "answer_id": 57743411, "question_id": 57679890, "link": "https://stackoverflow.com/questions/57679890/lcd-shows-random-characters-mplab/57743411#57743411", "title": "LCD shows random characters (MPLAB)", "body": "<p>@AfricaOMM,</p>\n\n<p>It would appear that your code may be based on code from this <a href=\"http://www.studentcompanion.co.za/wp-content/uploads/2013/05/LCD_Library.zip\" rel=\"nofollow noreferrer\">link</a>. </p>\n\n<p>Because you posted only fragments it is impossible to determine just how bad the code you are trying to work from is.</p>\n\n<p>The code at link I found has a Microchip copyright but it is of poor quality with bugs that will cause you several problems.</p>\n\n<p>You would benefit in the long run by sorting out this mess on your own.</p>\n\n<p>My best advise is to put LEDs on the signal lines that connect to your LCD module and verify that your PIC16F1937 sets each line to the correct state when the initialization code runs.</p>\n\n<p>I suspect you have errors in wiring along with errors in your code.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 11984801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0b580d58b8af3aa188cd252e0606e?s=128&d=identicon&r=PG&f=1", "display_name": "AfricaOMM", "link": "https://stackoverflow.com/users/11984801/africaomm"}, "is_accepted": false, "score": 0, "last_activity_date": 1567517661, "creation_date": 1567517661, "answer_id": 57772843, "question_id": 57679890, "link": "https://stackoverflow.com/questions/57679890/lcd-shows-random-characters-mplab/57772843#57772843", "title": "LCD shows random characters (MPLAB)", "body": "<p>Problem solved! </p>\n\n<p>The problem was related to the library.\nThe library that Microchip provides is full of malfunctions, so when executing commands, the PIC do not receive the supposed informations it should receive, that's why the LCD shows random characters. </p>\n\n<p>I suggest you use the <a href=\"https://electrosome.com/lcd-pic-mplab-xc8/\" rel=\"nofollow noreferrer\">library developed by electrosome</a> : I confirm that it is 100% operational, thanks to them!</p>\n\n<p>Another thing: to solve the contrast problem, it will ideally be necessary to connect the VO port of the LCD to a potentiometer.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12597219, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAxCk-TMx4CfMY8DuwCVmV580bUHeoo5VWg2Itncw=k-s128", "display_name": "LEARN TO STAND", "link": "https://stackoverflow.com/users/12597219/learn-to-stand"}, "is_accepted": false, "score": 0, "last_activity_date": 1606133689, "last_edit_date": 1606133689, "creation_date": 1577306915, "answer_id": 59481745, "question_id": 57679890, "link": "https://stackoverflow.com/questions/57679890/lcd-shows-random-characters-mplab/59481745#59481745", "title": "LCD shows random characters (MPLAB)", "body": "<p>When we send a msg on LCD it shows funny characters or some weird symbols because the hardware requires some time to get refreshed. You can try to give some sleep time.after this line</p>\n<pre><code>LCDPutStr(&quot;test2&quot;).   Put above sleep time\nLCD.sleep(5)\n\n</code></pre>\n<p>It worked in my case.   It worked in my case.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12597219, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAxCk-TMx4CfMY8DuwCVmV580bUHeoo5VWg2Itncw=k-s128", "display_name": "LEARN TO STAND", "link": "https://stackoverflow.com/users/12597219/learn-to-stand"}, "is_accepted": false, "score": 0, "last_activity_date": 1577328127, "last_edit_date": 1577328127, "creation_date": 1577307220, "answer_id": 59481775, "question_id": 57679890, "link": "https://stackoverflow.com/questions/57679890/lcd-shows-random-characters-mplab/59481775#59481775", "title": "LCD shows random characters (MPLAB)", "body": "<p>When we send a msg on LCD it shows funny characters or some weird symbols because the hardware requires some time to get refreshed. You can try to give some sleep time.after this line</p>\n\n<pre><code>LCDPutStr(\"test2\").   Put above sleep time\nLCD.sleep(5)\n</code></pre>\n\n<p>It worked in my case.</p>\n"}], "owner": {"reputation": 7, "user_id": 11984801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14d0b580d58b8af3aa188cd252e0606e?s=128&d=identicon&r=PG&f=1", "display_name": "AfricaOMM", "link": "https://stackoverflow.com/users/11984801/africaomm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1606133767, "creation_date": 1566928224, "last_edit_date": 1606133767, "question_id": 57679890, "link": "https://stackoverflow.com/questions/57679890/lcd-shows-random-characters-mplab", "title": "LCD shows random characters (MPLAB)", "body": "<p>I'm trying to connect my LCD screen (16x02 QAPASS) to my PIC16F1937 on MPLAB, but it displays random characters (in this case Chinese characters, question marks and slash) instead of alphanumeric. However, all PIN connections have been declared in the library and correctly connected to the PIC. I use an XC8 compiler.</p>\n\n<p>Here are the connections:</p>\n\n<p>VSS --> GND<br>\nVDD --> 5V<br>\nVO --> 680\u03a9 resistance<br>\nEN --> RD1<br>\nRW --> RD6<br>\nRS --> RD0<br>\nLCD_D4 --> RD2<br>\nLCD_D5 --> RD3<br>\nLCD_D6 --> RD4<br>\nLCD_D7 --> RD5<br>\nAnode --> 5V<br>\nCathode --> GND  </p>\n\n<p>The global project is a sensor that detects the distance of an object and displays this same distance on the LCD. The fact that the LCD does not display the character compromises the rest of the project because I cannot set up the mathematical calculations if the LCD fails.</p>\n\n<p>1) Library Code : lcd.h (Header Files) This is the code provided by Microchip for the LCD library and I added the PIN-LCD connections: </p>\n\n<pre><code>// single bit for selecting command register or data register \n#define instr 0 #define data 1\n\n// These #defines create the pin connections to the LCD in case they \nare changed on a future demo board\n#define LCD_PORT     PORTD\n#define LCD_PWR      PORTDbits.RD7   // LCD power pin\n#define LCD_EN       PORTDbits.RD1   // LCD enable\n#define LCD_RW       PORTDbits.RD6   // LCD read/write line\n#define LCD_RS       PORTDbits.RD0   \n#define LCD_D4       PORTDbits.RD2\n#define LCD_D5       PORTDbits.RD3\n#define LCD_D6       PORTDbits.RD4\n#define LCD_D7       PORTDbits.RD5\n\n// LCD register select line\n\n#define NB_LINES    2   // Number of display lines\n#define NB_COL      16  // Number of \ncharacters per line\n</code></pre>\n\n<p>2) Library Code 2 : lcd.c (Source Files) Contains the commands related to the LCD</p>\n\n<p>3) Main Code : main.c (Source Files)</p>\n\n<pre><code>#include \"mcc_generated_files/mcc.h\"\n#include \"lcd.h\"\n#define _XTAL_FREQ 4000000\n\n void main(void)\n {\n // initialize the device\n SYSTEM_Initialize();\n\n // initialize LCD\n LCD_Initialize();\n\nLCDGoto(4, 1);           // go to column 4, row 1\nLCDPutChar(\"test1\");\nLCDGoto(3, 2);           // go to column 3, row 2\nLCDPutStr(\"test2\");\n\nwhile (1)\n{\n\n}\n}\n</code></pre>\n"}, {"tags": ["c", "function", "function-pointers"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1566925681, "post_id": 57679311, "comment_id": 101805472, "body": "Welcome to Stack Overflow. Please <a href=\"https://stackoverflow.com/posts/57679311/edit\">edit</a> your question to include the entire error message. Also indicate which line causes the error."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1566925751, "post_id": 57679311, "comment_id": 101805497, "body": "Finally, make your code example so that we can compile it and get the same error. In particular, add <code>main()</code> and all necessary variable declarations."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1566925830, "post_id": 57679311, "comment_id": 101805535, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for tips on debugging your code. In particular, check the value of <code>Mod</code> to be sure it is in fact either -1 or 1."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 3, "creation_date": 1566926437, "post_id": 57679311, "comment_id": 101805768, "body": "<code>float (*calcMethod)(float , float) = &amp;calcEU;     }</code> the variable stops existing after <code>}</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1566926501, "post_id": 57679311, "comment_id": 101805796, "body": "You are declaring and initializing two different <code>calcMethod</code> variables inside two different <code>if</code> blocks. Neither declaration is in scope when you call it in the code you showed. If you declare a single <code>calcMethod</code> variable (above the first <code>if</code> statement) and assign to the designed value within each <code>if</code> statement, then it should work."}, {"owner": {"reputation": 3, "user_id": 9119271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513d5692c9840ed3a60b55c969393d3b?s=128&d=identicon&r=PG&f=1", "display_name": "CTryinghard", "link": "https://stackoverflow.com/users/9119271/ctryinghard"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1566927248, "post_id": 57679311, "comment_id": 101806131, "body": "@Code-Apprentice I&#39;ve posted the entire code."}, {"owner": {"reputation": 3, "user_id": 9119271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513d5692c9840ed3a60b55c969393d3b?s=128&d=identicon&r=PG&f=1", "display_name": "CTryinghard", "link": "https://stackoverflow.com/users/9119271/ctryinghard"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1566927346, "post_id": 57679311, "comment_id": 101806173, "body": "@Kamil Cuk I just tried in other file that you said, and in really doesn&#39;t get recognized outside if statement block."}, {"owner": {"reputation": 3, "user_id": 9119271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513d5692c9840ed3a60b55c969393d3b?s=128&d=identicon&r=PG&f=1", "display_name": "CTryinghard", "link": "https://stackoverflow.com/users/9119271/ctryinghard"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566927451, "post_id": 57679311, "comment_id": 101806214, "body": "@Ian Abbott Could you help this defining the pointer for &quot;calcMethod&quot; function?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566927960, "post_id": 57679311, "comment_id": 101806409, "body": "Unrelated to your main problem, but: if you want a 2-letter response from the user, do <i>not</i> declare an array of size 2 to hold it, and even more importantly, never ever use <code>gets()</code> to read it! (1) The size needed to hold a string of length 2 is 3. (2) Using an array just barely big enough to hold the expected string is error-prone and pointless, since it doesn&#39;t prevent the user from trying to type something longer.  (3) The <code>gets</code> function is pathologically dangerous and has been removed from the C language standard and should never be used."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1566934128, "post_id": 57679311, "comment_id": 101808825, "body": "<code>float *calcMethod ;</code> this isn&#39;t a function pointer."}], "answers": [{"tags": [], "owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "is_accepted": false, "score": 0, "last_activity_date": 1566928615, "last_edit_date": 1566928615, "creation_date": 1566927479, "answer_id": 57679738, "question_id": 57679311, "link": "https://stackoverflow.com/questions/57679311/why-function-pointer-isnt-seen-as-point-to-function/57679738#57679738", "title": "Why function pointer isn&#39;t seen as point to function?", "body": "<p>The main problem is that you declaring different <code>calcMethod</code> variables in nested blocks and changing the wrong one. Also, the outer <code>calcMethod</code> variable you are trying to call isn't even a function pointer:</p>\n\n<pre><code>float *calcMethod ;\n\n//assigning the pointer to function\n//this subprogram is nested in main\nif(Mod == 1) //Mod is just a variable\n    {\n        strcpy(metricUnitH, \"me\");\n        strcpy(metricUnitM, \"kg\");\n\n        // N.B. This is a different calcMethod variable!\n        float (*calcMethod)(float , float) = &amp;calcEU;\n    } // N.B. calcMethod variable in previous block no longer exists!\n\nif(Mod == -1)\n    {\n        strcpy(metricUnitH, \"in\");\n        strcpy(metricUnitM, \"lb\");\n\n        // N.B. This is a different calcMethod variable!\n        float (*calcMethod)(float , float) = &amp;calcUS;\n    } // N.B. calcMethod variable in previous block no longer exists!\n\n//the calcMethod is called\n//this is nested in 2 for(s) and an if\n\n// N.B. the calcMethod variable in this block is uninitialized, and\n// it is not even a function pointer (it is a pointer to float) so\n// this will not even compile....\nBMIndex = (*calcMethod)(massRow , heightColumn);\n</code></pre>\n\n<p>The solution is to declare the outer <code>calcMethod</code> variable as a function pointer, and change the inner blocks to assign to the outer block's <code>calcMethod</code> variable instead of declaring a new one:</p>\n\n<pre><code>float (*calcMethod)(float, float) = calcUS;  // default to \"US\"\n\n//assigning the pointer to function\n//this subprogram is nested in main\nif(Mod == 1) //Mod is just a variable\n    {\n        strcpy(metricUnitH, \"me\");\n        strcpy(metricUnitM, \"kg\");\n        calcMethod = calcEU;\n    }\nif(Mod == -1)\n    {\n        strcpy(metricUnitH, \"in\");\n        strcpy(metricUnitM, \"lb\");\n        calcMethod = calcUS;\n    }\n\n//the calcMethod is called\n//this is nested in 2 for(s) and an if\nBMIndex = (*calcMethod)(massRow , heightColumn);\n</code></pre>\n\n<p>I initialized the <code>calcMethod</code> to <code>calcUS</code> in case it has not been set by one of the <code>if</code> statements.  Alternatively, you could it initialize it to <code>NULL</code> and check for this as an error condition before you call <code>calcMethod</code>:</p>\n\n<pre><code>float (*calcMethod)(float, float) = NULL; // default to not set\n\n// ...\n\nif (calcMethod == NULL)\n    {\n        /* ERROR: calcMethod hasn't been set. */\n        /* DO SOMETHING! */\n    }\nelse\n    {\n        BMIndex = (*calcMethod)(massRow , heightColumn);\n    }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9119271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513d5692c9840ed3a60b55c969393d3b?s=128&d=identicon&r=PG&f=1", "display_name": "CTryinghard", "link": "https://stackoverflow.com/users/9119271/ctryinghard"}, "edited": false, "score": 0, "creation_date": 1566931091, "post_id": 57679979, "comment_id": 101807632, "body": "Thanks, it helps a lot."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 2, "last_activity_date": 1566933174, "last_edit_date": 1566933174, "creation_date": 1566928659, "answer_id": 57679979, "question_id": 57679311, "link": "https://stackoverflow.com/questions/57679311/why-function-pointer-isnt-seen-as-point-to-function/57679979#57679979", "title": "Why function pointer isn&#39;t seen as point to function?", "body": "<p>The problem is that you declare <code>float *calcMethod;</code> -- a pointer to a float, not a pointer to a function.  You then redeclare it as a function pointer in your inner blocks, but that is just in those blocks -- where you try to call it you're trying to call the float pointer.</p>\n\n<p>The fix is to declare it as a function pointer in the first place:</p>\n\n<pre><code>float (*calcMethod)(float, float);\n</code></pre>\n\n<p>then when you decide which to use, don't redeclare it, just assign it:</p>\n\n<pre><code>calcMethod = calcUS;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>calcMethod = calcEU;\n</code></pre>\n\n<p>You also don't need the <code>*</code> to call through the pointer -- you can use just</p>\n\n<pre><code>BMIndex = calcMethod(massRow , heightColumn);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "is_accepted": false, "score": 1, "last_activity_date": 1566928843, "creation_date": 1566928843, "answer_id": 57680023, "question_id": 57679311, "link": "https://stackoverflow.com/questions/57679311/why-function-pointer-isnt-seen-as-point-to-function/57680023#57680023", "title": "Why function pointer isn&#39;t seen as point to function?", "body": "<p>You have three <code>calcMethod</code>variables in the <code>main()</code> function. Thsi first one is a pointer to a float variable (which is obviously not a function pointer). The other two are function pointers, but they only exists inside their block of code.</p>\n\n<p>If you define <code>calcMethod</code> only once as a function pointer, regardeless of other bugs in your code, that will work.</p>\n\n<p>Here are the three changes :</p>\n\n<pre><code>int main()\n{\n    float BMIndex , inputMass , inputHeight;\n    float heightColumn, massRow;\n    float (*calcMethod)(float , float); // ****** CHANGE #1 HERE\n    int Mod = 0;\n    int countRow , countColumn;\n    char unitStandard[2] , metricUnitH[2] , metricUnitM[2];\n\n    printf(\"Your measure units? EU (kg, m) or US (lb, in) \\n\");\n    gets(unitStandard);\n\n    if(strcmp(unitStandard, \"EU\") == 0)\n    {\n        Mod = 1;\n        strcpy(metricUnitH, \"me\");\n        strcpy(metricUnitM, \"kg\");\n        calcMethod = &amp;calcEU; // ****** CHANGE #2 HERE\n    }\n        else if (strcmp(unitStandard, \"US\") == 0)\n        {\n            Mod = -1;\n            strcpy(metricUnitH, \"in\");\n            strcpy(metricUnitM, \"lb\");\n            calcMethod = calcUS; // ****** CHANGE #3 HERE\n        }\n            else\n            {\n                printf(\"Wrong Input\");\n                exit(-1);\n            }\n\n    printf(\"Introduce your body mass:\\n\");\n    scanf(\"%f\", &amp;inputMass);\n\n    printf(\"Introduce your height:\\n\");\n    scanf(\"%f\", &amp;inputHeight);\n\n    printf(\"\\n\");\n\n    for(countRow = 0; countRow &lt;= 5; countRow++)\n    {\n        for(countColumn = 0; countColumn &lt;= 5; countColumn++)\n        {\n            heightColumn = inputHeight - 0.1 * (3 - countRow);\n            massRow = inputMass - 1 * (3 - countColumn);\n\n            if(countRow == 0 &amp;&amp; countColumn == 0)  printf(\"H / M|\");\n            if(countRow == 0 &amp;&amp; countColumn != 0)  printf(\"%.0f%s |\", massRow , metricUnitM);\n            if(countColumn == 0 &amp;&amp; countRow != 0)  printf(\"%.1f%s |\", heightColumn , metricUnitH);\n\n            if(countRow != 0 &amp;&amp; countColumn !=0)\n            {\n                BMIndex = (*calcMethod)(massRow , heightColumn);\n                printf(\"%.2f |\", BMIndex);\n            }\n        }\n        printf(\"\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9119271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513d5692c9840ed3a60b55c969393d3b?s=128&d=identicon&r=PG&f=1", "display_name": "CTryinghard", "link": "https://stackoverflow.com/users/9119271/ctryinghard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57679979, "answer_count": 3, "score": -1, "last_activity_date": 1566933174, "creation_date": 1566925420, "last_edit_date": 1566927040, "question_id": 57679311, "link": "https://stackoverflow.com/questions/57679311/why-function-pointer-isnt-seen-as-point-to-function", "title": "Why function pointer isn&#39;t seen as point to function?", "body": "<p>Can't get to function through function pointer.</p>\n\n<p>I'm writing a program that acts based on input(Body Mass Index calculator) for US and EU standards.\nMy point is to calculate BMIndex using one function\"calcMethod\", but trying to assign a pointer of other function to this one, leads to an error \"called object isn't a function or function pointer\". Any help is appreciated.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;conio.h&gt;\n\nfloat calcEU(float inputMass, float inputHeight)\n{\n    float BMIndexF;\n    BMIndexF = inputMass / (inputHeight * inputHeight);\n    return BMIndexF;\n}\n\nfloat calcUS(float inputMass, float inputHeight)\n{\n    float BMIndexF;\n    BMIndexF = 703 * inputMass / (inputHeight * inputHeight);\n    return BMIndexF;\n}\n\nint main()\n{\n    float BMIndex , inputMass , inputHeight;\n    float heightColumn, massRow;\n    float *calcMethod ;\n    int Mod = 0;\n    int countRow , countColumn;\n    char unitStandard[2] , metricUnitH[2] , metricUnitM[2];\n\n    printf(\"Your measure units? EU (kg, m) or US (lb, in) \\n\");\n    gets(unitStandard);\n\n    if(strcmp(unitStandard, \"EU\") == 0)\n    {\n        Mod = 1;\n        strcpy(metricUnitH, \"me\");\n        strcpy(metricUnitM, \"kg\");\n        float (*calcMethod)(float , float) = &amp;calcEU;\n    }\n        else if (strcmp(unitStandard, \"US\") == 0)\n        {\n            Mod = -1;\n            strcpy(metricUnitH, \"in\");\n            strcpy(metricUnitM, \"lb\");\n            float (*calcMethod)(float , float) = &amp;calcUS;\n        }\n            else\n            {\n                printf(\"Wrong Input\");\n                exit(-1);\n            }\n\n    printf(\"Introduce your body mass:\\n\");\n    scanf(\"%f\", &amp;inputMass);\n\n    printf(\"Introduce your height:\\n\");\n    scanf(\"%f\", &amp;inputHeight);\n\n    printf(\"\\n\");\n\n    for(countRow = 0; countRow &lt;= 5; countRow++)\n    {\n        for(countColumn = 0; countColumn &lt;= 5; countColumn++)\n        {\n            heightColumn = inputHeight - 0.1 * (3 - countRow);\n            massRow = inputMass - 1 * (3 - countColumn);\n\n            if(countRow == 0 &amp;&amp; countColumn == 0)  printf(\"H / M|\");\n            if(countRow == 0 &amp;&amp; countColumn != 0)  printf(\"%.0f%s |\", massRow , metricUnitM);\n            if(countColumn == 0 &amp;&amp; countRow != 0)  printf(\"%.1f%s |\", heightColumn , metricUnitH);\n\n            if(countRow != 0 &amp;&amp; countColumn !=0)\n            {\n                //this line causes error\n                BMIndex = (*calcMethod)(massRow , heightColumn);\n                printf(\"%.2f |\", BMIndex);\n            }\n\n\n\n        }\n\n        printf(\"\\n\");\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>The commented line causes error: called object is not a function or function pointer </p>\n\n<p>Expect it doesn't throw an error and work as intended.</p>\n"}, {"tags": ["c", "file", "linked-list"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1566944946, "post_id": 57679274, "comment_id": 101812271, "body": "regarding: <code>scanf(&quot;%s&quot;, file);</code>   This will NOT read in the whole file.  The input format specifier: <code>%s</code> stops when any white space is encountered.  So, only the first word will be read.  Also, the specifier: <code>%s</code> doesn&#39;t know anything about the input buffer length and does append a NUL byte to the input.   (in this case) any returned value other than 1 indicates an error occurred.  Therefore, The code should look similar to: <code>if( scanf(scanf(&quot;%99s&quot;, file) != 1 ) { fprintf( stderr, &quot;scanf to read word from file failed\\n&quot; );</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1566945110, "post_id": 57679274, "comment_id": 101812314, "body": "regarding: <code>Element *delete_word(Element *head, char letter)</code>  the second parameter will be the address of the array <code>word[]</code>, not a character"}], "answers": [{"tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": true, "score": 3, "last_activity_date": 1567001725, "last_edit_date": 1567001725, "creation_date": 1566925691, "answer_id": 57679378, "question_id": 57679274, "link": "https://stackoverflow.com/questions/57679274/removing-an-element-of-the-linked-list-that-contains-a-letter-that-user-inputs/57679378#57679378", "title": "Removing an element of the linked list that contains a letter that user inputs", "body": "<p>Your <code>delete_word()</code> function is declared as:</p>\n\n<pre><code>Element *delete_word(Element *head, char letter);\n</code></pre>\n\n<p>But you call it with a <code>char*</code>:</p>\n\n<pre><code>char word[100];\nhead = delete_word(head, word);\n</code></pre>\n\n<p>The menu option says <code>Delete words that contain a letter</code> but when the user selects that option, he/she is instructed to <code>Input a word:</code> (confusing).</p>\n\n<p>You then send the address of the first <code>char</code> in <code>word</code> to the function. From that address one <code>char</code> is picked. It'll be random at best and it will most probably corrupt the stack (since you, by picking one <code>char</code> only, probably pick 1 byte out of 4 or 8).</p>\n\n<p>You could make it work like this:</p>\n\n<pre><code>    case 4:\n    {\n        char word[100];\n\n        printf(\"Input characters: \");\n\n        if(scanf(\"%s\", word)==1) {\n            int len = strlen(word);\n            for(int i=0; i&lt;len; ++i) {\n                head = delete_word(head, word[i]);\n            }\n        }\n\n        printList(head);\n\n        break;\n    }\n</code></pre>\n\n<p>This would allow the user to enter some characters and all words containing any of those would be removed.</p>\n"}], "owner": {"reputation": 103, "user_id": 11958375, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TYKRUaUWWG0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf1llVlpbZu5UQj3bMPCnJkemwA2g/photo.jpg?sz=128", "display_name": "igor", "link": "https://stackoverflow.com/users/11958375/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57679378, "answer_count": 1, "score": 0, "last_activity_date": 1567001725, "creation_date": 1566925218, "last_edit_date": 1566925866, "question_id": 57679274, "link": "https://stackoverflow.com/questions/57679274/removing-an-element-of-the-linked-list-that-contains-a-letter-that-user-inputs", "title": "Removing an element of the linked list that contains a letter that user inputs", "body": "<p>I need to make a function that removes elements of a linked list (elements of the list are words) that contain a letter the user inputs. Basically, I have a .txt file that has random words in it, after loading the words into the linked list, I need to make several functions (this post is only dedicated for the 4th function from the menu), one of which is the function I'm having trouble with. </p>\n\n<p>My idea was to make a separate function that will send 1 if the word contains the letter and 0 if it does not, then I made a function that goes through my linked list and using the first function checks if that element of the list contains the word, if it does then I remove it and move onto the next element.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct Element Element;\n\nstruct Element\n{\n    char word[50];\n    Element *next;\n};\n\nElement *load_file(Element *head)\n{\n    char file[500];\n    scanf(\"%s\", file);\n\n    Element *temp = head;\n\n    FILE* fp = fopen(file, \"r\");\n\n    if(fp == NULL)\n    {\n        printf(\"Error while loading file.\");\n        return 0;\n    }\n\n    while(!feof(fp))\n    {\n        Element *newE = (Element*)malloc(sizeof(Element));\n\n        fscanf(fp, \"%s\", newE-&gt;word);\n\n        newE-&gt;next =  NULL;\n\n        if(!temp)\n        {\n            head = temp = newE;\n        }\n        else\n        {\n            temp-&gt;next = newE;\n            temp = newE;\n        }\n\n    }\n\n    fclose(fp);\n    printf(\"\\nFile loaded successfully\\n\");\n\n    return head;\n}\n\nint frequency(Element *head, char *word)\n{\n    Element *temp = head;\n    int counter = 0;\n\n    while(temp != NULL)\n    {\n        if(strcmp(temp-&gt;word, word) == 0)\n        {\n            counter++;\n        }\n\n        temp = temp-&gt;next;\n    }\n\n    return counter;\n}\n\nint contains(char word[], char letter)\n{\n    int end = strlen(word);\n    int flag = 0;\n\n    for(int i = 0; i &lt; end-1; i++)\n    {\n        if(letter == word[i])\n        {\n            flag = 1;\n            break;\n        }\n    }\n\n    return flag;\n}\n\nElement *delete_word(Element *head, char letter)\n{\n    Element *temp = head;\n    Element *before = NULL;\n    Element *newHead = head;\n\n    while(temp != NULL)\n    {\n        if(contains(temp-&gt;word, letter))\n        {\n            if(before == NULL)\n            {\n                newHead = temp-&gt;next;\n                free(temp);\n                temp = newHead;\n            }\n            else\n            {\n                before-&gt;next = temp-&gt;next;\n                free(temp);\n                temp = before-&gt;next;\n            }\n\n        }\n        else\n        {\n            before = temp;\n            temp = temp-&gt;next;\n        }\n    }\n    return newHead;\n}\n\nvoid printElement(Element *element)\n{\n    printf(\"%s \\n\", element-&gt;word);\n}\n\nvoid printList(Element *head)\n{\n    Element *temp = head;\n\n    while(temp != NULL)\n    {\n        printElement(temp);\n        temp = temp-&gt;next;\n    }\n}\n\nvoid meni()\n{\n    printf(\"************** MENI **************\\n\");\n    printf(\"1. Loading text from file \\n\");\n    printf(\"2. Print all elements of the list \\n\");\n    printf(\"3. Frequency of a certain word \\n\");\n    printf(\"4. Delete words that contain a letter \\n\");\n    printf(\"5. Load the list into a file \\n\");\n    printf(\"6. Exit \\n\\n\");\n}\n\nint main()\n{\n    Element *head = NULL;\n\n    int option;\n\n    while(1)\n    {\n        meni();\n\n        scanf(\"%d\", &amp;option);\n\n        switch(option)\n        {\n            case 1:\n            {\n                printf(\"Input a name of the file: \\n\");\n                head = load_file(head);\n                break;\n            }\n            case 2:\n            {\n                printList(head);\n                break;\n            }\n            case 3:\n            {\n                char word[100];\n\n                printf(\"Input a word: \");\n\n                scanf(\"%s\", word);\n\n                int num = frequency(head, word);\n\n                printf(\"%d\\n\", num);\n                break;\n            }\n            case 4:\n            {\n                char word[100];\n\n                printf(\"Input a word: \");\n\n                scanf(\"%s\", word);\n\n                head = delete_word(head, word);\n\n                printList(head);\n\n                break;\n            }\n            case 5:\n            {\n\n            }\n            case 6:\n            {\n                return 0;\n            }\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>For some reason, it makes no changes on the list whatsoever.</p>\n"}, {"tags": ["c", "scanf", "newline", "fgets", "c-strings"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1566924901, "post_id": 57679180, "comment_id": 101805160, "body": "Where does 21 come from?"}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1566924946, "post_id": 57679180, "comment_id": 101805172, "body": "maximum size of name can only be 20. Size 21 because for adding <code>\\0</code>."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 2, "creation_date": 1566925034, "post_id": 57679180, "comment_id": 101805213, "body": "when you print add some distinguishing mark, eg <code>printf(&quot;==&gt; %s&quot;, array[i]);</code>, or <code>&quot;**%s**&quot;</code>, .... Or also print the loop variable: <code>printf(&quot;%d ==&gt; %s&quot;, i, array[i]);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 4, "last_activity_date": 1566929375, "last_edit_date": 1566929375, "creation_date": 1566925451, "answer_id": 57679320, "question_id": 57679180, "link": "https://stackoverflow.com/questions/57679180/fgets-not-accepting-last-value/57679320#57679320", "title": "fgets not accepting last value?", "body": "<p>The first <code>scanf(\"%d\", &amp;n);</code> left a newline in the input stream so your first string read by <code>fgets</code> is just a newline. You need to remove that newline before reading the names.</p>\n\n<p>If you change</p>\n\n<pre><code>for(i = 0; i &lt; n; i++)\n{\n    printf(\"%s\", array[i]); // printing those values.\n}\n</code></pre>\n\n<p>to</p>\n\n<pre><code>for(i = 0; i &lt; n; i++)\n{\n    printf(\"String %d : |%s|\", i, array[i]); // printing those values.\n}\n</code></pre>\n\n<p>it is easy to see...</p>\n\n<p>You'll get the output:</p>\n\n<pre><code>String 0 : |\n|String 1 : |raj\n|String 2 : |chris\n|String 3 : |ben\n|String 4 : |abhay\n|\n</code></pre>\n\n<p>Notice how the first string is just a newline...</p>\n\n<p>My usual advice is... Don't use <code>scanf</code>(for reading the number). It seems to be a very simple function but it's really very difficult to use and causes a lot of bugs. Instead use <code>fgets</code> followed by <code>sscanf</code>. Also you should check that <code>sscanf</code>/<code>scanf</code> actually returns 1.</p>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1566927191, "post_id": 57679491, "comment_id": 101806099, "body": "@snr It is de-facto a standard approach to remove the new line character from a string. It is not a bad coding. It is a normal coding.  It seems simply that you do not have enough knowledge of standard C string functions. So my answer is very useful for you."}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "edited": false, "score": 0, "creation_date": 1566927370, "post_id": 57679491, "comment_id": 101806185, "body": "I learn many new things while reading your code. Thanks for writing."}, {"owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "edited": false, "score": 0, "creation_date": 1566927729, "post_id": 57679491, "comment_id": 101806319, "body": "@VladfromMoscow I could not understand the line <code>s[i][strcspn( s[i], &quot;\\n&quot; )] = &#39;\\0&#39;;</code> in your code."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1566977182, "post_id": 57679491, "comment_id": 101819186, "body": "@VladfromMoscow if I didn&#39;t know its meaning, I&#39;d speak up, no worry. Anyway, it still is &quot;bad coding practicing&quot; in my regard."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "edited": false, "score": 0, "creation_date": 1566987998, "post_id": 57679491, "comment_id": 101824996, "body": "@SwarnimKhosla fgets appends the new line character to an entered string. To delete it from a string you find the position of the new line character using the function strcspn and set the corresponding character to &#39;\\0&#39;."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1566926202, "creation_date": 1566926202, "answer_id": 57679491, "question_id": 57679180, "link": "https://stackoverflow.com/questions/57679180/fgets-not-accepting-last-value/57679491#57679491", "title": "fgets not accepting last value?", "body": "<p>In the input buffer there is stored the new line character <code>'\\n'</code> after the call</p>\n\n<pre><code>scanf(\"%d\", &amp;n);\n</code></pre>\n\n<p>Before using <code>fgets</code> you have to remove this character from the input buffer.</p>\n\n<p>You can do it using this call</p>\n\n<pre><code>scanf( \"%*[ \\t\\n]\" );\n</code></pre>\n\n<p>Take also into account that fgets in turn can append a string with a new line character that in general should be removed from a string as it is shown in the demonstrative program below.</p>\n\n<p>Here is the demonstrative program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) \n{\n    enum { STRING_SIZE = 21 };\n\n    size_t n;\n\n    scanf( \"%zu\", &amp;n );\n\n    scanf( \"%*[ \\t\\n]\" );\n\n    char **s = malloc( n * sizeof( char * ) );\n\n    for ( size_t i = 0; i &lt; n; i++ ) s[i] = malloc( STRING_SIZE );\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        fgets( s[i], STRING_SIZE, stdin );\n        s[i][strcspn( s[i], \"\\n\" )] = '\\0';\n    }\n\n    for ( size_t i = 0; i &lt; n; i++ ) puts( s[i] );\n\n    for ( size_t i = 0; i &lt; n; i++ ) free( s[i] );\n    free( s );\n\n    return 0;\n}\n</code></pre>\n\n<p>Its output is as expected</p>\n\n<pre><code>raj\nchris\nben\nabhay\ngautam\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 10912105, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ariwmaXAKfY/AAAAAAAAAAI/AAAAAAAAGAU/Tnmw-ZGCKD0/photo.jpg?sz=128", "display_name": "Swarnim Khosla", "link": "https://stackoverflow.com/users/10912105/swarnim-khosla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 57679320, "answer_count": 2, "score": 2, "last_activity_date": 1566929375, "creation_date": 1566924703, "last_edit_date": 1566927318, "question_id": 57679180, "link": "https://stackoverflow.com/questions/57679180/fgets-not-accepting-last-value", "title": "fgets not accepting last value?", "body": "<p>I have a homework problem in which: -</p>\n\n<blockquote>\n  <p>1) User will input the number of names he wants to input.</p>\n  \n  <p>2) He will then input those names.</p>\n  \n  <p>3) We have to print those names.</p>\n</blockquote>\n\n<p>This is the code I wrote for the above problem: -</p>\n\n<pre><code># include &lt;stdio.h&gt;\n# include &lt;stdlib.h&gt;\n# include &lt;stdbool.h&gt;\n\nint main()\n{\n    int n; // number of names user wants to input.\n    scanf(\"%d\", &amp;n);\n\n    char *array[n]; //creating an array of pointers.\n\n    int i;\n    for(i = 0; i &lt; n; i++)\n    {\n        array[i] = malloc(21*sizeof(char)); // allocating memory to each pointer.\n    }\n\n    for(i = 0; i &lt; n; i++)\n    {\n        fgets(array[i], 21, stdin); //getting the values.\n    }\n\n    for(i = 0; i &lt; n; i++)\n    {\n        printf(\"%s\", array[i]); // printing those values.\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The problem with the above code is that it is not printing the last value inputted by the user.</p>\n\n<p>Example: \nSample Input: -</p>\n\n<pre><code>5\nraj\nchris\nben\nabhay\ngautam\n</code></pre>\n\n<p>Expected Output: -</p>\n\n<pre><code>raj\nchris\nben\nabhay\ngautam\n</code></pre>\n\n<p>My Output: -</p>\n\n<pre><code>raj\nchris\nben\nabhay\n</code></pre>\n\n<p>Edit:</p>\n\n<p>After changing this line: -</p>\n\n<p><code>scanf(\"%d\", &amp;n);</code></p>\n\n<p>to </p>\n\n<p><code>scanf(\"%d \", &amp;n);</code></p>\n\n<p>it is working normally.</p>\n"}, {"tags": ["c", "linux", "ipc", "semaphore"], "comments": [{"owner": {"reputation": 12087, "user_id": 1121249, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/LkDcL.png?s=128&g=1", "display_name": "rkosegi", "link": "https://stackoverflow.com/users/1121249/rkosegi"}, "edited": false, "score": 0, "creation_date": 1566924586, "post_id": 57679064, "comment_id": 101805047, "body": "maybe <code>man lsipc</code> is good starting point."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 3, "creation_date": 1566924661, "post_id": 57679064, "comment_id": 101805083, "body": "There are <i>several</i> kinds of semaphores - you should find out <i>what kind of</i> semaphores you actually need to use..."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566924739, "post_id": 57679064, "comment_id": 101805105, "body": "General rule: Unless it&#39;s a resource constrained by <code>ulimit</code> or <code>sysctl</code> it&#39;s usually only constrained by available memory or disk space. Some &quot;IPC objects&quot; are just locations in memory, so they&#39;re unconstrained. Others, like shared memory, are tightly constrained."}, {"owner": {"reputation": 33, "user_id": 10878337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4Ahnl3PMPTI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZcsydqwMO_l5ArewV5eKXL7fI-7A/mo/photo.jpg?sz=128", "display_name": "roberto gjokaj", "link": "https://stackoverflow.com/users/10878337/roberto-gjokaj"}, "edited": false, "score": 0, "creation_date": 1566926952, "post_id": 57679064, "comment_id": 101805989, "body": "thanks to all the people that answered."}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 10878337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4Ahnl3PMPTI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZcsydqwMO_l5ArewV5eKXL7fI-7A/mo/photo.jpg?sz=128", "display_name": "roberto gjokaj", "link": "https://stackoverflow.com/users/10878337/roberto-gjokaj"}, "is_accepted": true, "score": 0, "last_activity_date": 1566926735, "creation_date": 1566926735, "answer_id": 57679580, "question_id": 57679064, "link": "https://stackoverflow.com/questions/57679064/how-many-semaphores-can-a-system-store/57679580#57679580", "title": "How many Semaphores can a system store?", "body": "<p>I solved the problem. Every system has obliviously a different maximum number of semaphore sets that can be stored. \nUsing those command:</p>\n\n<pre><code>              ipcs -ls\n\n                 OR\n\n       cat /proc/sys/kernel/sem\n</code></pre>\n\n<p>you can see your system limits.</p>\n\n<p>I find the answer in this page (Chapter 8 talks about my problem)\n<a href=\"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html-single/tuning_and_optimizing_red_hat_enterprise_linux_for_oracle_9i_and_10g_databases/index#chap-Oracle_9i_and_10g_Tuning_Guide-Setting_Shared_Memory\" rel=\"nofollow noreferrer\">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/5/html-single/tuning_and_optimizing_red_hat_enterprise_linux_for_oracle_9i_and_10g_databases/index#chap-Oracle_9i_and_10g_Tuning_Guide-Setting_Shared_Memory</a></p>\n"}], "owner": {"reputation": 33, "user_id": 10878337, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-4Ahnl3PMPTI/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZcsydqwMO_l5ArewV5eKXL7fI-7A/mo/photo.jpg?sz=128", "display_name": "roberto gjokaj", "link": "https://stackoverflow.com/users/10878337/roberto-gjokaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 57679580, "answer_count": 1, "score": 2, "last_activity_date": 1566926735, "creation_date": 1566924120, "last_edit_date": 1566924704, "question_id": 57679064, "link": "https://stackoverflow.com/questions/57679064/how-many-semaphores-can-a-system-store", "title": "How many Semaphores can a system store?", "body": "<p>Every system has a maximum number of IPC objects that can be \"stored\". I have to create a set of semaphores that contains hundreds of semaphores. Now I have 2 questions:\n1) are those semaphores counted as distinct IPC objects or a set of semaphores is counted by the system as a unique IPC object? \n2) how many semaphores can a set of semaphores contain?</p>\n"}, {"tags": ["c", "timer", "stm32", "keil"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566924079, "post_id": 57678028, "comment_id": 101804847, "body": "&quot;Not working&quot; is not a sufficiently technical description of the problem. What other diagnostics can you give?"}, {"owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566931857, "post_id": 57678028, "comment_id": 101807909, "body": "I was trying a lot of to configure it but I didn&#39;t get any replay from this timer. I was trying to generate pwm or blink led after time."}, {"owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566932369, "post_id": 57678028, "comment_id": 101808143, "body": "I have added photo from debuger"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566938853, "post_id": 57678028, "comment_id": 101810591, "body": "That&#39;s not a problem so much as it is a screenshot of some values. You&#39;re going to need to do more diagnostics here."}, {"owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1566944442, "post_id": 57678028, "comment_id": 101812164, "body": "There&#39;s the datasheet my microcontroler <a href=\"https://www.st.com/resource/en/datasheet/stm32f303vc.pdf\" rel=\"nofollow noreferrer\">st.com/resource/en/datasheet/stm32f303vc.pdf</a>  on page 36 is information about pin who I can configure as tim3 and it&#39;s PE2 and PE3 but in the next page is the same for PA6 and PA7. What&#39;s pin is default set to work as timer input? Should I make something like remapping or turn on any register?"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "edited": false, "score": 0, "creation_date": 1566975944, "post_id": 57678028, "comment_id": 101818626, "body": "You don&#39;t need any I/O pins to generate an interrupt on the update (overflow) event. Later, if you&#39;d like to use timer I/O, load the board in STM32CubeMX to let it pick a usable pin for you. There is no default, any one of PA6, PC6 or PE2 can be assigned to TIM3_CH1, none is preferred over the other as far as the MCU is concerned. You should however pick one that is not connected to something else, CubeMX takes this into account."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "edited": false, "score": 0, "creation_date": 1567020133, "post_id": 57687562, "comment_id": 101841624, "body": "TIM2 and TIM3  don&#39;t have united register (TIM3-&gt;SMCR and TIM2-&gt;SMCR its not the same). They are conifigurating independly. Im sure the TIM2 works propertly because I saw the changing counter in debug mode while I was rotating my encoder. What else I will try to set TIM3 in another empty project with this configuration and it&#39;s still not working :/"}, {"owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "reply_to_user": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "edited": false, "score": 0, "creation_date": 1567021868, "post_id": 57687562, "comment_id": 101842258, "body": "Sorry, it looks like I&#39;ve missed the bit about the encoders."}], "tags": [], "owner": {"reputation": 6873, "user_id": 5131711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z5oP7.png?s=128&g=1", "display_name": "followed Monica to Codidact", "link": "https://stackoverflow.com/users/5131711/followed-monica-to-codidact"}, "is_accepted": false, "score": 1, "last_activity_date": 1567021817, "last_edit_date": 1567021817, "creation_date": 1566979126, "answer_id": 57687562, "question_id": 57678028, "link": "https://stackoverflow.com/questions/57678028/stm32f303vc-discovery-tim3-is-not-working/57687562#57687562", "title": "Stm32f303vc discovery tim3 is not working", "body": "<p><strike><strong>Set <code>SMCR</code> to <code>0</code></strong></p>\n\n<p>Your code sets both timers to encoder mode 1, see the description of the <code>SMCR</code> register in the reference manual.</p>\n\n<blockquote>\n  <p>0001: Encoder mode 1 - Counter counts up/down on TI1FP1 edge depending on TI2FP2 level.</p>\n</blockquote>\n\n<p>In this mode, the timer counter is incremented or decremented by the signals on then CH1 and CH2 input, instead of the internal clock. There must be some other component on the board, or line noise when they are unconnected, that managed to trigger TIM2 a few times.</strike></p>\n\n<p><strong>PE2 is connected to an output of another IC</strong></p>\n\n<p>Check the schematics in the board user manual. PE2 is connected to the DRDY <strong>output</strong> of the onboard accelerometer.</p>\n\n<p>You can use the CubeMX tool to find available pins for TIM3. Select your board in the Board Selector screen, it will show that PE2 and PE3 are already connected to something.</p>\n\n<p>Set TIM3 combined channels to encoder mode, it will assign some free pins to the timer. You can then hold down <kbd>CTRL</kbd> and click on the pin to see alternatives (they will blink in blue), and you can drag the pin assignments with the mouse.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "is_accepted": false, "score": 0, "last_activity_date": 1567021236, "creation_date": 1567021236, "answer_id": 57699073, "question_id": 57678028, "link": "https://stackoverflow.com/questions/57678028/stm32f303vc-discovery-tim3-is-not-working/57699073#57699073", "title": "Stm32f303vc discovery tim3 is not working", "body": "<p>Ok, I find a solution :) \nIf I assign TIM3 CH1 to PB4 and CH2 to PB5 it's work good, but I don't understand why, can someone explain it ?</p>\n"}], "owner": {"reputation": 11, "user_id": 11325288, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-sJ6lE6yReuU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc8Ijxzvd60ixDDNhVrtdfOXmwQJw/mo/photo.jpg?sz=128", "display_name": "Nes87", "link": "https://stackoverflow.com/users/11325288/nes87"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1567021817, "creation_date": 1566919825, "last_edit_date": 1566932280, "question_id": 57678028, "link": "https://stackoverflow.com/questions/57678028/stm32f303vc-discovery-tim3-is-not-working", "title": "Stm32f303vc discovery tim3 is not working", "body": "<p>I would like to configure tim3 ch1 ch2 as encoder mode, I have the same code on tim2( it's also general purpose timer) and it's working good. \nMaybe there's another bits should I set but I cant find them.</p>\n\n<p>I was trying to configure this timer to work without any outputs, just generate interrupt after set period of time but it's not working as well.</p>\n\n<pre><code>    //TIM2 CH1 PA0 CH2 PA1 AF1\n    //TIM3 CH1 PE2 CH2 PE3 AF2\n\n    RCC-&gt;APB1ENR |= RCC_APB1ENR_TIM2EN | RCC_APB1ENR_TIM3EN ;\n    RCC-&gt;AHBENR |= RCC_AHBENR_GPIOAEN | RCC_AHBENR_GPIOEEN;\n\n    GPIOA-&gt;MODER |= GPIO_MODER_MODER0_1 |  GPIO_MODER_MODER1_1;\n    GPIOE-&gt;MODER |= GPIO_MODER_MODER2_1 |  GPIO_MODER_MODER3_1;\n\n    GPIOA-&gt;AFR[0] |= 0X00000011;\n    GPIOE-&gt;AFR[0] |= 0X00002200;\n\n\n    TIM2-&gt;SMCR = TIM_SMCR_SMS_0;\n    TIM2-&gt;CCMR1 = TIM_CCMR1_CC1S_0|TIM_CCMR1_CC2S_0;\n    TIM2-&gt;ARR = 24;\n    TIM2-&gt;DIER = TIM_DIER_UIE;\n    TIM2-&gt;CR1= TIM_CR1_CEN;\n\n    TIM3-&gt;SMCR = TIM_SMCR_SMS_0 ;\n    TIM3-&gt;CCMR1 = TIM_CCMR1_CC1S_0 | TIM_CCMR1_CC2S_0;\n    TIM3-&gt;ARR = 24;\n    TIM3-&gt;DIER = TIM_DIER_UIE;\n    TIM3-&gt;CR1= TIM_CR1_CEN ;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/hlBeH.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["c", "fflush"], "comments": [{"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 7, "creation_date": 1566919828, "post_id": 57677993, "comment_id": 101802870, "body": "On a healthy exit, the buffer is flushed anyways."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 5, "creation_date": 1566919887, "post_id": 57677993, "comment_id": 101802911, "body": "The buffer is automatically flushed under several circumstances: (1) when the buffer is full, (2) when you print a <code>\\n</code> character and the output is going to a &quot;terminal&quot; (e.g. is not being redirected to a file), (3) when the program exits, and (4) under some systems, at least, when the program is waiting for input (meaning it&#39;s good if any prompts get flushed).  You only need the explicit call to <code>fflush(stdout)</code> if none of those is true."}, {"owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920017, "post_id": 57677993, "comment_id": 101802979, "body": "@SteveSummit Thanks for your comment, so the examples which are mentioning that using printf without fflush(stdout) will output error is partially correct? (of course they are emphasizing on using fflush)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920128, "post_id": 57677993, "comment_id": 101803031, "body": "I&#39;m sorry, I don&#39;t quite understand your question.  I&#39;m not sure which examples you&#39;re talking about, and I&#39;m not sure what &quot;will output error&quot; means."}, {"owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920241, "post_id": 57677993, "comment_id": 101803092, "body": "@SteveSummit the link is here : <a href=\"https://www.quora.com/Why-do-we-use-the-functions-fflush-stdin-and-fflush-stdout-in-c\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a>"}, {"owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920279, "post_id": 57677993, "comment_id": 101803113, "body": "@SteveSummit &quot; students often have problems like \u201cmy prompt doesn&#39;t appear!\u201d quite not seems to be right, because it works in my case."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566920469, "post_id": 57677993, "comment_id": 101803222, "body": "@jwkoo The problem students often have is that they write &quot;printf(&quot;Enter a number: &quot;); scanf(&quot;%d&quot;, &amp;number)`, and they wonder why their prompt doesn&#39;t appear.  (Because, I guess, not all systems implement #4 in my list above.)"}, {"owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920558, "post_id": 57677993, "comment_id": 101803282, "body": "@SteveSummit using scanf after printf also does work fine"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920649, "post_id": 57677993, "comment_id": 101803322, "body": "On many systems, yes.  But perhaps not on all."}, {"owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566920732, "post_id": 57677993, "comment_id": 101803358, "body": "@SteveSummit Thanks for your big help."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1566925519, "post_id": 57677993, "comment_id": 101805406, "body": "When you think about it, there is some magic going on behind the scenes on those systems that flush the <code>stdout</code> stream when waiting for input on the <code>stdin</code> stream. Not all systems have this magic."}], "owner": {"reputation": 1488, "user_id": 7321961, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b8c1a12e677622cb5818e155f6190c4c?s=128&d=identicon&r=PG&f=1", "display_name": "jwkoo", "link": "https://stackoverflow.com/users/7321961/jwkoo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1439, "favorite_count": 1, "closed_date": 1566922162, "answer_count": 0, "score": 1, "last_activity_date": 1566922178, "creation_date": 1566919681, "question_id": 57677993, "link": "https://stackoverflow.com/questions/57677993/no-need-of-fflushstdout-with-printf-in-c", "closed_reason": "Duplicate", "title": "No need of fflush(stdout) with printf in C?", "body": "<p>Until now, I used <code>fflush(stdout)</code> when using <code>printf</code> without <code>\\n</code>, since we have to flush the buffer.</p>\n\n<p>But I found that the below code also works fine.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n    printf(\"hello world\");\n    // without fflush(stdout)\n}\n\n// output: \"hello world\"\n</code></pre>\n\n<p>Is the outcome differs with the compiler? or am I misunderstand something?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566919853, "post_id": 57677976, "comment_id": 101802887, "body": "Have you tried to <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">debug your program</a>? What if you use a variable to store the <i>index</i> of the max element (instead of a pointer) will that index be correct? Does the code work using the index instead?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1566919904, "post_id": 57677976, "comment_id": 101802923, "body": "And a small hint: After the inner loop, what is the value of <code>max</code>? Where do you <i>reset</i> it? That should be <i>very</i> easy to find out with a little debugging."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1566920084, "post_id": 57677976, "comment_id": 101803014, "body": "That the function modifies the input array would be very surprising to most users."}, {"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1566921118, "post_id": 57677976, "comment_id": 101803532, "body": "@molbdnilo how does it modifies? If I make some sorting - then would be the array modified, but in my example, i make &#39;auxiliary&#39; array <code>max_arr</code> and store the max values in there, so that i dont mofidy the input array <code>arr</code> - so it does the opposite of what you said."}, {"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566921487, "post_id": 57677976, "comment_id": 101803706, "body": "@Someprogrammerdude the value of max int is everytime something different - in both loops - as it is shown - <code>if(arr[i]&gt;max) max = arr[i]</code> - and again if something is bigger then the max in that array afterward - then it becomes max. every single cycle. Thats the reason, why it is stored in function space - not inside loops"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566922915, "post_id": 57677976, "comment_id": 101804330, "body": "OT:  regarding: <code>int main (int argc, char** argv)</code>  The two parameters are not used.  This will cause the compiler to output two warning messages.  Suggest using the signature: <code>int main( void )</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1566923470, "post_id": 57677976, "comment_id": 101804564, "body": "@PatrikPatanPastyyr <code>pi</code> points into <code>arr</code>\u2013 <code>pi = (arr + i)</code> \u2013 and then you write into it with <code>*pi = 0;</code>. If you print your array afterwards in <code>main</code> you will see that it has become <code>{1,5,9,12,0,14}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566920755, "post_id": 57678096, "comment_id": 101803367, "body": "unfortunally still getting <code>48</code> instead of <code>42</code>. I think, regardless if i make the value in max = 0, it is still in the array <code>arr</code> (the max value - e.g. <code>16</code> - in my specific exapmle), so i have to delete (aka make it zero) the <code>max</code> in that array - therefor trying to point to that addaress."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 1, "creation_date": 1566921088, "post_id": 57678096, "comment_id": 101803518, "body": "@PatrikPatanPastyyr I can not reproduce the problem. Your code outputs 42."}, {"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1566922314, "post_id": 57678096, "comment_id": 101804064, "body": "@VladfromMoscow neither I do, but as i just add one row  <code>max = 0;</code> after row <code>max_arr[j] = max;</code> - it printed 48."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566923068, "post_id": 57678096, "comment_id": 101804396, "body": "@PatrikPatanPastyyr As I already wrote I can reproduce this result."}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 1, "last_activity_date": 1566920166, "creation_date": 1566920166, "answer_id": 57678096, "question_id": 57677976, "link": "https://stackoverflow.com/questions/57677976/my-pointer-in-an-array-doesnt-work-as-it-supposed-to/57678096#57678096", "title": "My pointer in an array doesn&#39;t work as it supposed to", "body": "<p>Your <code>if</code> statement:</p>\n\n<pre><code>if (arr[i] &gt; max)\n</code></pre>\n\n<p>isn't going to be entered after the first time you find <code>max</code> (<em>i.e.</em> when <code>j &gt; 0</code>).</p>\n\n<p>You need to zero it after:</p>\n\n<pre><code>max_arr[j] = max;\nmax = 0;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566929017, "post_id": 57679146, "comment_id": 101806841, "body": "but the difference is that my function volume is something about 30 rows, but youts is maybe 110 (havent counted it). And - moreover - the bublesort is one of the most depricated sorts, since is difficulty is x^2. Anyway if i wanted to make a sort, i would use qsort() implemented function, but that wasnt the purpose."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566931014, "post_id": 57679146, "comment_id": 101807610, "body": "what do you mean by: <code>function volume</code>?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566931085, "post_id": 57679146, "comment_id": 101807629, "body": "The <code>bubble sort</code> is (about) the best when the number of entries to sort is less than 10."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566931336, "post_id": 57679146, "comment_id": 101807720, "body": "A bubble sort does not &#39;scale&#39; well, however, the OP did not mention anything about a much larger array.  AND if it were a much larger array, then the function: <code>qsort()</code> would be an appropriate function"}, {"owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566931349, "post_id": 57679146, "comment_id": 101807726, "body": "volume - number of rows"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "edited": false, "score": 0, "creation_date": 1566931427, "post_id": 57679146, "comment_id": 101807758, "body": "&#39;number of rows&#39;?  Perhaps you meant number of C statements.  In general, less statements doesn&#39;t mean more efficient"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1566924473, "creation_date": 1566924473, "answer_id": 57679146, "question_id": 57677976, "link": "https://stackoverflow.com/questions/57677976/my-pointer-in-an-array-doesnt-work-as-it-supposed-to/57679146#57679146", "title": "My pointer in an array doesn&#39;t work as it supposed to", "body": "<p>The following proposed code:</p>\n\n<ol>\n<li>performs the desired functionality</li>\n<li>is very straight forward in its' algorithm</li>\n<li>incorporates a bubble sort for selecting the top three entries in the array</li>\n<li>eliminates the 'magic' number 6</li>\n<li>modifies the second parameter to type <code>size_t</code> as that is the type returned by <code>sizeof()</code></li>\n<li>the expression: <code>sizeof(arr)/sizeof(arr[0])</code> lets compiler calculate number of entries in array</li>\n<li>the statement: <code>int arr[] = {1,5,9,12,16,14};</code> lets compiler allocate room for array</li>\n<li>avoids modifying the original array, when sorting</li>\n</ol>\n\n<p>and now, the proposed code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;  // memcpy()\n\n\nvoid swap(int *xp, int *yp) \n{ \n    int temp = *xp; \n    *xp = *yp; \n    *yp = temp; \n} \n\n\n// A function to implement bubble sort \nvoid bubbleSort(int arr[], size_t n) \n{ \n    size_t i;\n    size_t j; \n    for (i = 0; i &lt; n-1; i++)  \n    {     \n       // Last i elements are already in place    \n       for (j = 0; j &lt; n-i-1; j++)  \n       {\n            if (arr[j] &gt; arr[j+1]) \n            {\n              swap(&amp;arr[j], &amp;arr[j+1]); \n            }\n        }\n    }\n} \n\n\nint max_3(int arr[], size_t asize)\n{ \n    int localArray[ asize ];\n    memcpy( localArray, arr, asize*sizeof( int ) );\n    // sort array\n    bubbleSort( localArray, asize );\n\n    // calculate sum of max 3 entries\n    int sum = localArray[asize-1] + localArray[asize-2] + localArray[asize-3];\n    return sum;\n}   \n\n\nint main ( void ) \n{\n   int arr[] = {1,5,9,12,16,14};\n   printf( \"%i\\n\", max_3( arr, sizeof(arr)/sizeof(arr[0])) );\n   return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>a run of the proposed code results in:</p>\n\n<pre><code>42\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 0, "last_activity_date": 1566982204, "last_edit_date": 1566982204, "creation_date": 1566974380, "answer_id": 57686359, "question_id": 57677976, "link": "https://stackoverflow.com/questions/57677976/my-pointer-in-an-array-doesnt-work-as-it-supposed-to/57686359#57686359", "title": "My pointer in an array doesn&#39;t work as it supposed to", "body": "<p>After the very first iteration of the outer loop (the loop <code>for(int j=0; j&lt;3; j++)</code>) the value of <code>max</code> and <code>pi</code> will never change.</p>\n\n<p>In that first iteration of the outer loop, you will find that the fifth element in the array will be largest, <code>max</code> will be equal to <code>16</code> and <code>pi</code> will point to that element. You set <code>max_arr[0]</code> to <code>16</code> and set <code>*pi</code> to zero. Then the outer loop starts over with <code>max</code> still being equal to <code>16</code>. And now there will be no value in the array that will be equal or larger than that. So you set <code>max_arr[1]</code> to <code>16</code> as well, and set <code>*pi</code> (where <code>pi</code> is still pointing to the fifth element) to zero <em>again</em>. And the same thing the next iteration.</p>\n\n<p>The natural solution would be to define <code>max</code> and <code>pi</code> <em>inside</em> the outer loop:</p>\n\n<pre><code>for(int j=0; j&lt;3; j++)\n{\n    // The variables will be redefined and reinitialized each iteration of the loop\n    int max = 0;\n    int *pi;\n\n    for(int i =0; i&lt;asize;i++)\n    {\n        if(arr[i] &gt; max)\n        {\n            max = arr[i];\n            pi = (arr + i); // to know the address of the max int of 'i' cycle\n        }\n    }\n    max_arr[j] = max;\n    *pi = 0; // make the max int = 0 so that the next 'i' cycle doesnt have the previous max in it\n             //(so it can look for another max value - the second one)\n}\n</code></pre>\n\n<p>There are a few other problems with the code, like for example the possibility that <code>pi</code> will never be initialized. I leave it as an exercise to the reader to figure when that will happen and how to solve it.</p>\n"}], "owner": {"reputation": 47, "user_id": 11863248, "user_type": "registered", "profile_image": "https://graph.facebook.com/2309857845933043/picture?type=large", "display_name": "Patrik Patan Pastyyr", "link": "https://stackoverflow.com/users/11863248/patrik-patan-pastyyr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1566982204, "creation_date": 1566919603, "last_edit_date": 1566919827, "question_id": 57677976, "link": "https://stackoverflow.com/questions/57677976/my-pointer-in-an-array-doesnt-work-as-it-supposed-to", "title": "My pointer in an array doesn&#39;t work as it supposed to", "body": "<p>I wanted to create a function, that would accept an 1:array_of_int, and 2:size_of_array, then return sum of the 3 biggest int. Code follows:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint max_3(int arr[], int asize)\n{ \n   int max_arr[3];\n   int max =0; \n   int sum = 0;\n   int* pi; \n\n   for(int j=0; j&lt;3; j++)\n   {   \n      for(int i =0; i&lt;asize;i++)\n      {   \n         if(arr[i] &gt; max)\n         {\n           max = arr[i];\n           pi = (arr + i); // to know the address of the max int of 'i' cycle\n         }\n      }   \n      max_arr[j] = max;\n      *pi = 0; // make the max int = 0 so that the next 'i' cycle doesnt have the previous max in it \n               //(so it can look for another max value - the second one)\n   }   \n\n   for(int i=0; i&lt;3; i++)\n      sum += max_arr[i];\n\n   return sum;\n}\n\n\nint main (int argc, char** argv) {\n   int arr[6] = {1,5,9,12,16,14};\n   printf(\"%i\\n\",max_3(arr, 6));\n   return (EXIT_SUCCESS);\n}\n</code></pre>\n\n<p>The pointer <code>pi</code> doesn't make the value of the current <code>max</code> value 0, and the next cycle in <code>for (int i..)</code> make the biggest one again as from the previous. So instead of returning max val1 + val2 + val3, it returned 3 * val1 (the biggest one) -- in my particular example - it printed out <code>48</code> instead of <code>42</code> (12 + 16 + 14) - as it should. But how when I make the value of address (which my pointer point to) as <code>0</code>? I do not understand that properly.</p>\n"}, {"tags": ["c", "arrays", "string", "sizeof"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 4, "creation_date": 1566918419, "post_id": 57677572, "comment_id": 101802103, "body": "The last character of <code>c</code> is <code>&#39;\\045&#39;</code> i.e. <code>%</code>, not a <code>&#39;5&#39;</code> that follows <code>&#39;\\0&#39;</code> and <code>4</code>!"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566918810, "post_id": 57677572, "comment_id": 101802300, "body": "In other words, if you had used <code>char c[] = {&quot;ab\\0de&quot;};</code>, you would have gotten the result you expected."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 3, "creation_date": 1566935586, "post_id": 57677572, "comment_id": 101809390, "body": "Unrelatedly, <code>\\099</code> is not a valid octal escape.  The octal escape corresponding to ASCII R is <code>\\122</code>."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1566974813, "post_id": 57677572, "comment_id": 101818125, "body": "@zwol : that is not unrelated - that is exactly the problem."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1566981141, "post_id": 57677572, "comment_id": 101821174, "body": "<a href=\"https://stackoverflow.com/q/27296011/995714\">size_t must be printed out using <code>%zu</code></a>. Using the wrong format specifier invokes UB"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1566993261, "post_id": 57677572, "comment_id": 101827843, "body": "@Clifford Unrelated to the previous two comments, I meant."}], "answers": [{"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1566975636, "last_edit_date": 1566975636, "creation_date": 1566975436, "answer_id": 57686595, "question_id": 57677572, "link": "https://stackoverflow.com/questions/57677572/sizeof-strlen-with-implict-null-character/57686595#57686595", "title": "sizeof() &amp; strlen() with implict null character", "body": "<p><code>'9'</code> is not a valid octal digit.  The string <code>\"\\099\"</code> is a <code>'\\0'</code> followed by two <code>'9'</code> characters. Hence a string length of 2 and an array length of 6.  The <code>'\\0'</code> being a string terminator.</p>\n\n<p>The initialisation of <code>d[]</code> is equivalent to:</p>\n\n<pre><code>char e[] = { '1','2','\\0','9','9','\\0' } ;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "is_accepted": false, "score": 0, "last_activity_date": 1566979006, "last_edit_date": 1566979006, "creation_date": 1566978543, "answer_id": 57687393, "question_id": 57677572, "link": "https://stackoverflow.com/questions/57677572/sizeof-strlen-with-implict-null-character/57687393#57687393", "title": "sizeof() &amp; strlen() with implict null character", "body": "<p>At first, you need to know a minute math before coding, that is, to know meaning of <code>octal</code>.</p>\n\n<blockquote>\n  <p>The octal numeral system, or oct for short, is the base-8 number\n  system, and uses the digits <code>0</code> to <code>7</code>. - Wikipedia</p>\n</blockquote>\n\n<p>So, how do you think to present a digit greater than <code>7</code> as octal? That's why your intention is wrong.</p>\n\n<p>Additionaly, you need to be cognizant of characters/escape sequences corresponding to right mapping being used.</p>\n\n<p>For example, glance at ascii table's oct values.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BTCbq.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BTCbq.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 65, "user_id": 7939629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6576ba1adee3e5ea13b7ac2f19947ce0?s=128&d=identicon&r=PG&f=1", "display_name": "SRIKANTH", "link": "https://stackoverflow.com/users/7939629/srikanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1566979006, "creation_date": 1566918225, "last_edit_date": 1566975933, "question_id": 57677572, "link": "https://stackoverflow.com/questions/57677572/sizeof-strlen-with-implict-null-character", "title": "sizeof() &amp; strlen() with implict null character", "body": "<p>If I am right, in the array <code>c</code> <code>\\045</code> is being treated as single octal, whose corresponding ASCII character is <code>%</code>. Hence the <code>sizeof(c)</code> is 4.</p>\n\n<p>Similarly in the array <code>d</code> <code>\\099</code> should be treated as single octal value, whose corresponding ASCII character is <code>R</code> and the <code>sizeof(d)</code> should be 4, but it is not.</p>\n\n<p>Can you please elaborate on what is happening in case of <code>sizeof(d)</code> and <code>sizeof(e)</code>?</p>\n\n<p>Code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main(void)\n{\n    char      a[] = {\"12345\"};\n    char      b[] = {\"12345\\0\"};\n\n    char      c[] = {\"12\\045\"};\n    char      d[] = {\"12\\099\"};\n    char      e[] = {\"12\\0133\"};\n\n    printf(\"\\ta         = %s  \\n\", a);\n    printf(\"\\tsizeof(a) = %ld \\n\", sizeof(a));\n    printf(\"\\tstrlen(a) = %ld \\n\", strlen(a));\n\n    printf(\"\\n\");\n\n    printf(\"\\tb         = %s  \\n\", b);\n    printf(\"\\tsizeof(b) = %ld \\n\", sizeof(b));\n    printf(\"\\tstrlen(a) = %ld \\n\", strlen(b));\n\n    printf(\"\\n\");\n    printf(\"\\tc         = %s  \\n\", c);\n    printf(\"\\tsizeof(c) = %ld \\n\", sizeof(c));\n    printf(\"\\tstrlen(c) = %ld \\n\", strlen(c));\n\n    printf(\"\\n\");\n\n    printf(\"\\td         = %s  \\n\", d);\n    printf(\"\\tsizeof(d) = %ld \\n\", sizeof(d));\n    printf(\"\\tstrlen(d) = %ld \\n\", strlen(d));\n\n    printf(\"\\n\");\n\n    printf(\"\\te         = %s  \\n\", e);\n    printf(\"\\tsizeof(e) = %ld \\n\", sizeof(e));\n    printf(\"\\tstrlen(e) = %ld \\n\", strlen(e));\n\n    return (0);\n}\n</code></pre>\n\n<p>Actual Results:</p>\n\n<pre><code>    a         = 12345  \n    sizeof(a) = 6 \n    strlen(a) = 5 \n\n    b         = 12345  \n    sizeof(b) = 7 \n    strlen(a) = 5 \n\n    c         = 12%  \n    sizeof(c) = 4 \n    strlen(c) = 3 \n\n    d         = 12  \n    sizeof(d) = 6 \n    strlen(d) = 2 \n\n    e         = 12\n                      3  \n    sizeof(e) = 5 \n    strlen(e) = 4\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 3, "creation_date": 1566918237, "post_id": 57677544, "comment_id": 101801997, "body": "You need an array of 4 <code>char</code>s to read 3 characters, because of the 0-terminator at the end of the string."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 4, "creation_date": 1566918241, "post_id": 57677544, "comment_id": 101802002, "body": "You can&#39;t use <code>strcmp</code> to compare a single character, there&#39;s no <code>NUL</code> terminating character. Use a regular <code>==</code> comparison."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566918383, "post_id": 57677544, "comment_id": 101802086, "body": "It seems you might need to take a few steps back, and start over with (or at least refresh) the basics of characters and strings."}, {"owner": {"reputation": 356, "user_id": 144185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423a1a4f867f2773f553579fa721552c?s=128&d=identicon&r=PG", "display_name": "Twirrim", "link": "https://stackoverflow.com/users/144185/twirrim"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1566918395, "post_id": 57677544, "comment_id": 101802094, "body": "@mch good point.  Doesn&#39;t change behaviour here, though."}, {"owner": {"reputation": 356, "user_id": 144185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423a1a4f867f2773f553579fa721552c?s=128&d=identicon&r=PG", "display_name": "Twirrim", "link": "https://stackoverflow.com/users/144185/twirrim"}, "reply_to_user": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 0, "creation_date": 1566918555, "post_id": 57677544, "comment_id": 101802176, "body": "@ThomasJager that&#39;s undefined behaviour (based on compiler warnings), but it did make me revisit my use of <code>strcmp</code> there, and I should be using <code>strncmp</code>, which seems to fix the code entirely."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1566918644, "post_id": 57677544, "comment_id": 101802226, "body": "Why not <code>if (&#39;A&#39; == input)</code>? There&#39;s really no need for string comparisons, bounded or not."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1566918679, "post_id": 57677544, "comment_id": 101802240, "body": "@Twirrim There is no reason whatsoever to use string-based functions here. You&#39;re comparing a single character."}, {"owner": {"reputation": 356, "user_id": 144185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423a1a4f867f2773f553579fa721552c?s=128&d=identicon&r=PG", "display_name": "Twirrim", "link": "https://stackoverflow.com/users/144185/twirrim"}, "edited": false, "score": 0, "creation_date": 1566918895, "post_id": 57677544, "comment_id": 101802356, "body": "To quote the compiler when warnings are enabled:  <code>warning: comparison with string literal results in unspecified behavior [-Waddress]</code>  So far as I can see, using <code>strncmp</code> is the only way to do it reliably."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1566918928, "post_id": 57677544, "comment_id": 101802374, "body": "Remember the difference between <code>&quot;A&quot;</code> and <code>&#39;A&#39;</code>! To reiterate myself, why not use <code>if (&#39;A&#39; == input)</code>? Why are you so hung up on using string comparison where it&#39;s not needed?"}, {"owner": {"reputation": 356, "user_id": 144185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423a1a4f867f2773f553579fa721552c?s=128&d=identicon&r=PG", "display_name": "Twirrim", "link": "https://stackoverflow.com/users/144185/twirrim"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1566919750, "post_id": 57677544, "comment_id": 101802835, "body": "@Someprogrammerdude Gah.  You&#39;re right, forgot about the difference betwee single vs double quotes.  Most of my programming has been in languages where that isn&#39;t the case.  I wouldn&#39;t say I&#39;m hung up on it, I was getting a compiler warning about the unspecified behaviour, which I&#39;m aware is dangerous to rely on.  When I started reading around on string comparisons, I kept coming back to <code>strcmp</code> and <code>strncmp</code>, which both worked (well.. kinda in the first case), and did the task at hand."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566920054, "post_id": 57677544, "comment_id": 101803000, "body": "Sorry for maybe being a little pushy or something. But it helped you get to that &quot;Doh!&quot; moment which are so important for learning :)"}], "answers": [{"tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 4, "last_activity_date": 1566920199, "last_edit_date": 1566920199, "creation_date": 1566918707, "answer_id": 57677724, "question_id": 57677544, "link": "https://stackoverflow.com/questions/57677544/not-sure-why-optimizer-is-optimizing-my-method-incorrectly/57677724#57677724", "title": "Not sure why optimizer is optimizing my method incorrectly", "body": "<pre><code>char input[3];\n</code></pre>\n\n<p>but you wrote three characters to it. Need 1 more for null terminator.</p>\n\n<pre><code>char input[4];\n</code></pre>\n\n<p>And here we have</p>\n\n<pre><code>fprintf(stderr, \"Asked to compare: %s\\n\", &amp;input);\n</code></pre>\n\n<p>No. That's a character not a string so we want</p>\n\n<pre><code>fprintf(stderr, \"Asked to compare: %c\\n\", input);\n</code></pre>\n\n<p>and we also have</p>\n\n<pre><code>strcmp(\"A\", &amp;input) == 0\n</code></pre>\n\n<p>but input is a <code>char</code> so we want</p>\n\n<pre><code>'A' == input\n</code></pre>\n\n<p>and the same for 'B'</p>\n"}], "owner": {"reputation": 356, "user_id": 144185, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/423a1a4f867f2773f553579fa721552c?s=128&d=identicon&r=PG", "display_name": "Twirrim", "link": "https://stackoverflow.com/users/144185/twirrim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1566920199, "creation_date": 1566918122, "last_edit_date": 1566918311, "question_id": 57677544, "link": "https://stackoverflow.com/questions/57677544/not-sure-why-optimizer-is-optimizing-my-method-incorrectly", "title": "Not sure why optimizer is optimizing my method incorrectly", "body": "<p>I'm new to C (so there's every good chance I'm doing something fundamentally wrong or bad), and working on a kattis problem, <a href=\"https://open.kattis.com/problems/abc\" rel=\"nofollow noreferrer\">https://open.kattis.com/problems/abc</a>.</p>\n\n<p>I'm running in to fun with what appears to be the GCC optimiser and I'm trying to understand why or what I'm doing wrong.  Here's the simplest replication case I can come up with:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint lookup(char input){\n    // This will return 2 on invalid input.  Not ideal, but we don't have to worry about invalid inputs like that\n    fprintf(stderr, \"Asked to compare: %s\\n\", &amp;input);\n    if (strcmp(\"A\", &amp;input) == 0){\n        //fprintf(stderr, \"It's an A\\n\");\n        return 0;\n    } else if (strcmp(\"B\", &amp;input) == 0){\n        //fprintf(stderr, \"It's a B\\n\");\n        return 1;\n    } else {\n        return 2;\n    };\n}\n\nint main(void){\n    char input[3];\n    if (scanf(\"%3s\", input) != 1){\n        fprintf(stderr, \"Something went wrong reading input\\n\");\n        return -1;\n    };\n    printf(\"Desired Order: %s\\n\", input);\n    printf(\"%d %d %d\\n\", lookup(input[0]),\n        lookup(input[1]),\n        lookup(input[2])\n    );\n}\n</code></pre>\n\n<p>An example input file for triggering this bug has a single line:</p>\n\n<pre><code>CAB\n</code></pre>\n\n<p>If I compile with without optimisations:</p>\n\n<pre><code>$ cc -std=gnu11 -static -lm simple.c -o simple &amp;&amp; cat input | ./simple\nDesired Order: CAB\nAsked to compare: B\nAsked to compare: A\nAsked to compare: C\n2 0 1\n</code></pre>\n\n<p>With optimisations enabled, note it's falling through to the else section:</p>\n\n<pre><code>$ cc -O2 -std=gnu11 -static -lm simple.c -o simple &amp;&amp; cat input | ./simple\nDesired Order: CAB\nAsked to compare: B\nAsked to compare: A\nAsked to compare: C\n2 2 2\n</code></pre>\n\n<p>Things I've noticed so far:</p>\n\n<ul>\n<li>If I uncomment the <code>fprintf</code> after the <code>strcmp(\"A\", &amp;input)</code>, the code works fine even with optimisations enabled (that's what got me wondering about optimisations breaking my code in the first place).</li>\n<li>If I uncomment the <code>fprintf</code> after the <code>strcmp(\"B\", &amp;input)</code> the code fails when optimised.</li>\n<li>If I comment out the \"Desired Order:\" <code>printf</code>, the code works fine even with optimisations.</li>\n</ul>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1566916985, "post_id": 57677138, "comment_id": 101801250, "body": "For trailing 0&#39;s you better use string type."}, {"owner": {"reputation": 3, "user_id": 11984448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAfRN4-i3F1MUhj85NQg6I-QZfMKEaBE3EwJ_ucrQ=k-s128", "display_name": "Daniel Z", "link": "https://stackoverflow.com/users/11984448/daniel-z"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1566917053, "post_id": 57677138, "comment_id": 101801297, "body": "yes of course, but I can only think about a lot of if&#39;s... if ID.length &lt; 1.. and on and on"}, {"owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "edited": false, "score": 0, "creation_date": 1566917286, "post_id": 57677138, "comment_id": 101801422, "body": "oh ok, that makes matters a lot easier actually"}, {"owner": {"reputation": 3, "user_id": 11984448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAfRN4-i3F1MUhj85NQg6I-QZfMKEaBE3EwJ_ucrQ=k-s128", "display_name": "Daniel Z", "link": "https://stackoverflow.com/users/11984448/daniel-z"}, "edited": false, "score": 0, "creation_date": 1566917300, "post_id": 57677138, "comment_id": 101801429, "body": "I can use string library, sorry I edited."}, {"owner": {"reputation": 90101, "user_id": 2509, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/79ed928ca8b1ab9a637720bf0fb20732?s=128&d=identicon&r=PG&f=1", "display_name": "dmckee --- ex-moderator kitten", "link": "https://stackoverflow.com/users/2509/dmckee-ex-moderator-kitten"}, "edited": false, "score": 1, "creation_date": 1566917301, "post_id": 57677138, "comment_id": 101801430, "body": "The <code>printf</code> family of functions is so flexible that introductory treatment always only skim over the surface. But if you are actually going to use c you should read the full description."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11984448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAfRN4-i3F1MUhj85NQg6I-QZfMKEaBE3EwJ_ucrQ=k-s128", "display_name": "Daniel Z", "link": "https://stackoverflow.com/users/11984448/daniel-z"}, "edited": false, "score": 0, "creation_date": 1566917947, "post_id": 57677399, "comment_id": 101801828, "body": "thank you! a lot easier than a couple of if&#39;s"}], "tags": [], "owner": {"reputation": 2607, "user_id": 300783, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1bdb02890bca18e87940fe8f1de52264?s=128&d=identicon&r=PG&f=1", "display_name": "tfeldmann", "link": "https://stackoverflow.com/users/300783/tfeldmann"}, "is_accepted": true, "score": 0, "last_activity_date": 1566917655, "creation_date": 1566917655, "answer_id": 57677399, "question_id": 57677138, "link": "https://stackoverflow.com/questions/57677138/putting-0-before-id-number-that-the-user-input/57677399#57677399", "title": "putting &#39;0&#39; before ID number that the user input", "body": "<p>You can use <code>printf</code> for this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main () {\n   printf(\"%09d\\n\", 12345);\n   return(0);\n}\n</code></pre>\n\n<p><a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_printf.htm\" rel=\"nofollow noreferrer\">Documentation</a></p>\n"}, {"tags": [], "owner": {"reputation": 763, "user_id": 10656609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67a018f0678dafb31664d25e08c716d?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/10656609/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1572073917, "last_edit_date": 1572073917, "creation_date": 1566917965, "answer_id": 57677494, "question_id": 57677138, "link": "https://stackoverflow.com/questions/57677138/putting-0-before-id-number-that-the-user-input/57677494#57677494", "title": "putting &#39;0&#39; before ID number that the user input", "body": "<p>There is an easy solution in here.</p>\n\n<p>But if you want a hard solution, where you juggle around with strings and such, you can do the following:</p>\n\n<ul>\n<li><p>convert your id into a string (if it isn't already one, but argv should a string by default)</p></li>\n<li><p>calculate the number of zeros you need, by doing 9-idString Length</p></li>\n<li><p>create a \"buffer\" string variable</p></li>\n<li><p>for loop from 0 to 9-idString and use strcat to add \"0\"s to your buffer string.</p></li>\n<li><p>add your id to your buffer string using strcat</p></li>\n</ul>\n\n<p>Example code would be something like this:</p>\n\n<pre><code>int id = 12345;\n\nchar idstring[10];\nchar buffer[10];\n\nsprintf(idstring, \"%d\", id);\n\nint missingZerosCount = 9 - strlen(idstring);\n\nstrcpy(buffer, \"\");\n\nwhile (missingZerosCount &gt; 0) {\n    strcat(buffer, \"0\");\n    missingZerosCount--;\n}\nstrcat(buffer, idstring);\n</code></pre>\n\n<p>argv variant:</p>\n\n<pre><code>char idstring[10];\nchar buffer[10];\n\nsprintf(idstring, \"%s\", argv[1]);\n\nint missingZerosCount = 9 - strlen(idstring);\n\nstrcpy(buffer, \"\");\n\nwhile (missingZerosCount &gt; 0) {\n    strcat(buffer, \"0\");\n    missingZerosCount--;\n}\nstrcat(buffer, idstring);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11984448, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAfRN4-i3F1MUhj85NQg6I-QZfMKEaBE3EwJ_ucrQ=k-s128", "display_name": "Daniel Z", "link": "https://stackoverflow.com/users/11984448/daniel-z"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1566917623, "accepted_answer_id": 57677399, "answer_count": 2, "score": 0, "last_activity_date": 1572073917, "creation_date": 1566916909, "last_edit_date": 1566917273, "question_id": 57677138, "link": "https://stackoverflow.com/questions/57677138/putting-0-before-id-number-that-the-user-input", "closed_reason": "Needs more focus", "title": "putting &#39;0&#39; before ID number that the user input", "body": "<p>I'm a new c programmer.\nI was asked to get an ID number as an input and if the ID length &lt; 9 I need to put '0' before the number.\nexample:\ninput: 12345\noutput: 000012345</p>\n\n<p>I can use the libraries: stdio, stdlib, string, math and time.</p>\n"}, {"tags": ["c", "function", "struct", "variable-assignment", "standard-library"], "comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 1, "creation_date": 1566915277, "post_id": 57676531, "comment_id": 101800288, "body": "There is not, you have to do something, like giving -1 to height/length/width and then test it (in place of your is_present function). Or you can do an opaque struct and have a get/set function. This way, you know."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1566916030, "post_id": 57676531, "comment_id": 101800712, "body": "Why would you allow an invalid instance of <code>cube</code> to exist ? Why not just avoid this issue by checking for missing fields <i>before</i> you create it ?"}], "answers": [{"tags": [], "owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "is_accepted": false, "score": 0, "last_activity_date": 1566915659, "last_edit_date": 1566915659, "creation_date": 1566915324, "answer_id": 57676657, "question_id": 57676531, "link": "https://stackoverflow.com/questions/57676531/how-to-work-out-if-a-member-of-a-struct-was-set-or-not/57676657#57676657", "title": "How to work out if a member of a struct was set or not?", "body": "<p>First you have to clearly define what \"<code>a value was given</code>\" means to your domain. A member initialized to 0 means no value was given?</p>\n\n<p>A simple solution is to initialize your struct with 0 (for example), and just compare each member against it. Example:</p>\n\n<pre><code>struct cube shape = {0};\nshape.width = 3;\nif (shape.width != 0)\n    printf(\"width was set\");\n</code></pre>\n\n<p>Or simpler:</p>\n\n<pre><code>struct cube shape = {2,0,3};\nif (shape.width != 0)\n    printf(\"width was set\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": true, "score": 3, "last_activity_date": 1566915836, "last_edit_date": 1566915836, "creation_date": 1566915457, "answer_id": 57676696, "question_id": 57676531, "link": "https://stackoverflow.com/questions/57676531/how-to-work-out-if-a-member-of-a-struct-was-set-or-not/57676696#57676696", "title": "How to work out if a member of a struct was set or not?", "body": "<p>You should initialize your fields to something that is out of the domain of the possible values. For example, for such dimensions, which are positive numbers, a negative value could act as a \"not assigned\" value. </p>\n\n<p>Also, I reordered your <code>if</code> statements: the one checking for all the fields should be the first.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define NOT_PRESENT -1\n#define is_present(x) ((x) != NOT_PRESENT)\n\nstruct cube {  \n    int height;\n    int length;\n    int width;\n};\n\nint calculate(struct cube);\n\nint main() {\n    struct cube shape = {\n        .height = NOT_PRESENT,\n        .length = NOT_PRESENT,\n        .width = NOT_PRESENT,\n    };\n\n    shape.height = 2;\n    shape.width = 3;\n\n    printf(\"Area: %d\\n\", calculate(shape)); // Prints 6\n\n    shape.length = 4;\n    printf(\"Volume: %d\\n\", calculate(shape)); // Prints 24\n\n    return 0;\n}\n\nint calculate(struct cube nums) {\n    if (is_present(nums.height) &amp;&amp; is_present(nums.width) &amp;&amp; is_present(nums.length)) {\n        return nums.height * nums.width * nums.length;\n    } else if (is_present(nums.height) &amp;&amp; is_present(nums.width)) {\n        return nums.height * nums.width;\n    } else {\n        return -1; // Error\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8884, "user_id": 8372104, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/72UbV.png?s=128&g=1", "display_name": "Simon", "link": "https://stackoverflow.com/users/8372104/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 57676696, "answer_count": 2, "score": 0, "last_activity_date": 1566916065, "creation_date": 1566914929, "last_edit_date": 1566916065, "question_id": 57676531, "link": "https://stackoverflow.com/questions/57676531/how-to-work-out-if-a-member-of-a-struct-was-set-or-not", "title": "How to work out if a member of a struct was set or not?", "body": "<p>Say I have the following struct:</p>\n\n<pre><code>struct cube {  \n    int height;\n    int length;\n    int width;\n};\n</code></pre>\n\n<p>I need to create a library that allows the user to enter values into the struct and then pass it into a function, which will determine whether the user wants either the <code>area</code> or the <code>volume</code> from the values provided.</p>\n\n<p>For example:</p>\n\n<pre><code>int main() {\n    struct cube shape;\n\n    shape.height = 2;\n    shape.width = 3;\n\n    printf(\"Area: %d\", calculate(shape)); // Prints 6\n\n    shape.length = 4;\n    printf(\"Volume: %d\", calculate(shape)); // Prints 24\n\n    return 0;\n}\n\nint calculate(struct cube nums) {\n    if (is_present(nums.height, nums) &amp;&amp; is_present(nums.width, nums)) {\n        return nums.height * nums.width;\n    }\n\n    else if (is_present(nums.height, nums) &amp;&amp; is_present(nums.width, nums) &amp;&amp; is_present(nums.length, nums)) {\n        return nums.height * nums.width * nums.length;\n    }\n    else {\n        return -1; // Error\n    }\n}\n</code></pre>\n\n<p>This should work, if I can use a function (like <code>is_present()</code>, which I just made up) to work out if a value was given to a member of a struct.</p>\n\n<p>Is there such a function and if not, how could this be implemented?</p>\n"}, {"tags": ["c", "fatfs", "stm32f1"], "comments": [{"owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1566950093, "post_id": 57676424, "comment_id": 101813125, "body": "First thing to try is to force mount with <code>res = f_mount(&amp;SDFatFS, OtherPath, 1);</code> -- with option <code>0</code> the call is effectively a no-op, and is guaranteed to succeed -- and see the error. Meanwhile, how <code>SDPath</code> and <code>OtherPath</code> are initialized?"}, {"owner": {"reputation": 15, "user_id": 6104277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jrlAgWTPq8o/AAAAAAAAAAI/AAAAAAAAACU/65z2b7oq7XM/photo.jpg?sz=128", "display_name": "Jipolie01", "link": "https://stackoverflow.com/users/6104277/jipolie01"}, "reply_to_user": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "edited": false, "score": 0, "creation_date": 1567007104, "post_id": 57676424, "comment_id": 101836251, "body": "Using the immediate mount options still produces FR_OK&#39;s for both mounts. In the example that I used SDPath are initialized within the linkdriver and otherPath nowhere (so maybe the second FR_OK is a result of undefined behaviour). I&#39;ll put an update of some of my findings in the original post"}], "owner": {"reputation": 15, "user_id": 6104277, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jrlAgWTPq8o/AAAAAAAAAAI/AAAAAAAAACU/65z2b7oq7XM/photo.jpg?sz=128", "display_name": "Jipolie01", "link": "https://stackoverflow.com/users/6104277/jipolie01"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1567014690, "creation_date": 1566914599, "last_edit_date": 1567014690, "question_id": 57676424, "link": "https://stackoverflow.com/questions/57676424/accessing-existing-partitions-on-sdhc-card-using-fatfs", "title": "Accessing existing partitions on SDHC card using FatFs", "body": "<p>I've been trying to transfer all my code from the STM32 Arduino library to ST Hal library, but I've been running into a problem with the SD-card. I'm using a SDHC sd card that has two partitions (one for factory reset and the other for normal settings)\nThey show up on my PC as drive D and E. </p>\n\n<p>So when setting up FATFS for my STM32F1 chip everything worked fine when using SD Bus one bit mode. Using standard code I could write into the factory reset partition:</p>\n\n<pre><code>  FRESULT res = f_open(&amp;SDFile, (const TCHAR *)\"Test2.txt\", FA_CREATE_ALWAYS | FA_WRITE);\n  if(res == FR_OK){\n    HAL_GPIO_WritePin(DASH_LED_1_GPIO_Port, DASH_LED_1_Pin, GPIO_PIN_SET);\n    res = f_putc('S', &amp;SDFile);\n    if(res != -1){\n      HAL_GPIO_WritePin(DASH_LED_2_GPIO_Port, DASH_LED_2_Pin, GPIO_PIN_SET);\n    }\n    res = f_write(&amp;SDFile, (const void*)buffer, sizeof(buffer), &amp;byteswritten );\n    if(res == FR_OK){\n      HAL_GPIO_WritePin(DASH_LED_3_GPIO_Port, DASH_LED_3_Pin, GPIO_PIN_SET);\n\n    }\n    f_close(&amp;SDFile);\n  }\n\n</code></pre>\n\n<p>When initializing the code and mounting a drive everything seemed fine, even when I wanted to mount the second partitions (i'm not really sure if thats what i'm doing with the code) the returns in my debugger were all FR_OK:</p>\n\n<pre><code>uint8_t retSD;    /* Return value for SD */\nchar SDPath[4];   /* SD logical drive path */\nchar OtherPath[4];\nFATFS SDFatFS;    /* File system object for SD logical drive */\nFIL SDFile;       /* File object for SD */\n\n/* USER CODE BEGIN Variables */\nPARTITION VolToPart[2] = {\n  {0,0},\n  {0,1}\n};\n/* USER CODE END Variables */    \n\nvoid MX_FATFS_Init(void) \n{\n  /*## FatFS: Link the SD driver ###########################*/\n  retSD = FATFS_LinkDriver(&amp;SD_Driver, SDPath);\n\n  /* USER CODE BEGIN Init */\n  FRESULT res = f_mount(&amp;SDFatFS, SDPath, 0 );\n  if(res != FR_OK){\n    Error_Handler();\n  }\n  res = f_mount(&amp;SDFatFS, OtherPath, 0);\n  if(res != FR_OK){\n    Error_Handler();\n  }\n\n  /* additional user code for init */     \n  /* USER CODE END Init */\n}\n\n</code></pre>\n\n<p>I will admit that even though I did my research I found the mounting and the subsequent VolToPart array that you apparently need to be a little bit vague.  </p>\n\n<p>After debugging the code while mounting twice (see code above), I tested the code using the drive identifiers (I turned on _FS_RPATH, which I don't think has an effect, but just to be sure) I could write Hello World to 0:Test2.txt but got an invalid drive error for 1:Test2.txt.</p>\n\n<p>I want to be able to switch between drives, but I feel like I'm missing something that I need to initiliaze or do. At this moment I'm not sure if FatFs can see the SDCard partitions and I'm just not initializing it or if its a completely seperate drive that the SD card cannot see. I hope someone it able to help me with this, let me know if you need more info.</p>\n\n<p>Edit: I found out some stuff after debugging for a while: \nSDPath is getting defined as \"0:/\"in link driver, so it makes sense for that this drive works. Other path does not get defined (as far as I can tell, and just gets the default value of \"0:/\", which means I'm doing the same mount twice. When I tried to add a seperate driver and intialize that one, it still ended up being an invalid disk error. </p>\n\n<pre><code>extern Diskio_drvTypeDef  SD_Driver;\nextern Diskio_drvTypeDef  Other_Driver;\n</code></pre>\n\n<pre><code>const Diskio_drvTypeDef  SD_Driver =\n{\n  SD_initialize,\n  SD_status,\n  SD_read, \n#if  _USE_WRITE == 1\n  SD_write,\n#endif /* _USE_WRITE == 1 */\n\n#if  _USE_IOCTL == 1\n  SD_ioctl,\n#endif /* _USE_IOCTL == 1 */\n};\n\nconst Diskio_drvTypeDef  Other_Driver =\n{\n  SD_initialize,\n  SD_status,\n  SD_read, \n#if  _USE_WRITE == 1\n  SD_write,\n#endif /* _USE_WRITE == 1 */\n\n#if  _USE_IOCTL == 1\n  SD_ioctl,\n#endif /* _USE_IOCTL == 1 */\n};\n</code></pre>\n\n<p>I then ran link driver twice and received a FR_INVALID_DRIVE message on the second mount. I tried this both with the same FATFS object and different ones. </p>\n\n<pre><code>uint8_t retSD;    /* Return value for SD */\nchar SDPath[4];   /* SD logical drive path */\nchar OtherPath[4];\nFATFS SDFatFS;    /* File system object for SD logical drive */\nFATFS OtherFatFS;\nFIL SDFile;       /* File object for SD */\n\n/* USER CODE BEGIN VolToPart */\n/* Volume - Partition resolution table should be user defined in case of Multiple partition */\n/* When multi-partition feature is enabled (1), each logical drive number is bound to arbitrary physical drive and partition\nlisted in the VolToPart[] */\nPARTITION VolToPart[] = {\n  {0,0},\n  {1,0}\n};\n/* USER CODE END VolToPart */  \n\n/* USER CODE BEGIN Variables */\n/* USER CODE END Variables */    \n\nvoid MX_FATFS_Init(void) \n{\n  /*## FatFS: Link the SD driver ###########################*/\n  retSD = FATFS_LinkDriver(&amp;SD_Driver, SDPath);\n  retSD = FATFS_LinkDriver(&amp;Other_Driver, OtherPath);\n  /* USER CODE BEGIN Init */\n  FRESULT res = f_mount(&amp;SDFatFS, SDPath, 1 );\n  if(res != FR_OK){\n    Error_Handler();\n  }\n  res = f_mount(&amp;SDFatFS, OtherPath, 1);\n  if(res != FR_OK){\n    Error_Handler();\n  }\n</code></pre>\n"}, {"tags": ["c", "operating-system", "exec"], "comments": [{"owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "edited": false, "score": 2, "creation_date": 1566913065, "post_id": 57675898, "comment_id": 101798931, "body": "AFAIK, unless execlp fail, there is no way that this printf to be reached."}, {"owner": {"reputation": 4187, "user_id": 5567382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d204353cb4fa94da57ddf180e108cd1b?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Jager", "link": "https://stackoverflow.com/users/5567382/thomas-jager"}, "edited": false, "score": 2, "creation_date": 1566913118, "post_id": 57675898, "comment_id": 101798965, "body": "The <code>exec</code> family replace the current process with the new executable image. Upon successful execution of the <code>execlp</code>, whatever follows no longer exists. The child is completely replaced. That&#39;s the point of <code>fork</code>ing; so that the new program can be started without replacing the existing program."}, {"owner": {"reputation": 2385, "user_id": 10306503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c5d6c9b08dd045f4876591d703bda6?s=128&d=identicon&r=PG", "display_name": "mosvy", "link": "https://stackoverflow.com/users/10306503/mosvy"}, "edited": false, "score": 0, "creation_date": 1566913518, "post_id": 57675898, "comment_id": 101799238, "body": "btw, never use <code>NULL</code> as the last pointer argument of a variadic function; always convert it to the expected type (eg. <code>(char*)0</code> or (void*)0<code>). </code>NULL` can be defined as simply <code>0</code>, in which case an <code>int</code> shorter than a pointer will be passed."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566914800, "post_id": 57675898, "comment_id": 101800009, "body": "No, you can&#39;t do this, and you&#39;ve stated the reason why:  because when the <code>execlp</code> system call executes successfully, it will not return back to the calling process."}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 1, "last_activity_date": 1566924904, "creation_date": 1566924904, "answer_id": 57679210, "question_id": 57675898, "link": "https://stackoverflow.com/questions/57675898/how-to-print-the-line-after-execlp-system-call/57679210#57679210", "title": "How to print the line after execlp system call", "body": "<p>regarding:</p>\n\n<pre><code>execlp(\"/bin/ls\",\"ls\", \"-lrth\", NULL); \nprintf(\"In Child after execlp call\\n\");\n</code></pre>\n\n<p>The function: <code>execlp()</code> never returns, if successful.  Also, the child process no longer exists when (in this case) the <code>ls</code> exits.</p>\n\n<p>So the correct thing to do would be handling the case where the call to <code>execlp()</code> fails.  In the case of failure the correct code would be:</p>\n\n<pre><code>perror( \"execlp failed\" );\nexit( EXIT_FAILURE );\n</code></pre>\n\n<p>Note: the call to <code>perror()</code> outputs your error message AND the reason the system thinks the error occurred to <code>stderr</code></p>\n"}], "owner": {"reputation": 114, "user_id": 4036405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f09172a38eba3035207878fef8c221e9?s=128&d=identicon&r=PG&f=1", "display_name": "renga_in_stack", "link": "https://stackoverflow.com/users/4036405/renga-in-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 57679210, "answer_count": 1, "score": 1, "last_activity_date": 1566924904, "creation_date": 1566912968, "question_id": 57675898, "link": "https://stackoverflow.com/questions/57675898/how-to-print-the-line-after-execlp-system-call", "title": "How to print the line after execlp system call", "body": "<p>I know that when execlp system call executed successfully it will not return back to the calling process. Is there any way to make a return and print the line after the call to execlp.</p>\n\n<pre><code>int main() \n{ \n    pid_t pid;\n    /* fork a child process */ \n    pid = fork();\n    if (pid &lt; 0)\n    { \n        /* error occurred */ \n        fprintf(stderr, \"Fork Failed\"); \n        return 1; \n    } \n    else if (pid == 0) \n    { \n        /* child process */ \n        execlp(\"/bin/ls\",\"ls\", \"-lrth\", NULL); \n        printf(\"In Child after execlp call\\n\"); \n    } \n    else \n    { \n        /* parent process */ \n        /* parent will wait for the child to complete */ \n        wait(NULL); \n        printf(\"Child Complete\"); \n    } \n    return 0;\n}\n</code></pre>\n\n<p>I wanted to see the print \"In Child after execlp call\".\nHow to make it happen.</p>\n"}, {"tags": ["c", "gcc", "openssl", "mingw32", "rc4-cipher"], "comments": [{"owner": {"reputation": 823, "user_id": 6699414, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/7e32082597c5678a976d298d91eba29e?s=128&d=identicon&r=PG&f=1", "display_name": "PhoenixBlue", "link": "https://stackoverflow.com/users/6699414/phoenixblue"}, "edited": false, "score": 1, "creation_date": 1566912064, "post_id": 57675115, "comment_id": 101798311, "body": "Can you translate that error message in english?"}], "answers": [{"tags": [], "owner": {"reputation": 5397, "user_id": 11294831, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M9BL5.png?s=128&g=1", "display_name": "the busybee", "link": "https://stackoverflow.com/users/11294831/the-busybee"}, "is_accepted": true, "score": 0, "last_activity_date": 1566982489, "creation_date": 1566982489, "answer_id": 57688539, "question_id": 57675115, "link": "https://stackoverflow.com/questions/57675115/fatal-error-openssl-opensslconf-h-no-such-file-or-directory/57688539#57688539", "title": "fatal error: openssl/opensslconf.h: No such file or directory", "body": "<p>I'm using MinGW64 because that's what is installed here. I'm aware of the tag \"mingw32\", hoping it's OK.</p>\n\n<p><strong>1. Compiling</strong></p>\n\n<p>The header file <code>rc4.h</code> lives in the path <code>&lt;path-of-installation&gt;/&lt;version&gt;/mingw64/opt/include</code>, so this has to be given as an argument to <code>-I</code>:</p>\n\n<pre><code>i586-mingw32msvc-gcc -c -I \"&lt;path-of-installation&gt;/&lt;version&gt;/mingw64/opt/include\" rc-4.c -o rc-4.o\n</code></pre>\n\n<p>You could as well set <code>CPATH</code> or <code>C_INCLUDE_PATH</code>, see <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Environment-Variables.html#Environment-Variables\" rel=\"nofollow noreferrer\">The C Preprocessor: Environment Variables</a>.</p>\n\n<p><strong>2. Linking</strong></p>\n\n<p><em>Note: Because you didn't provide enough source code I could not try this.</em></p>\n\n<p>The library file <code>libcrypto.a</code> lives in the path <code>&lt;path-of-installation&gt;/&lt;version&gt;/mingw64/opt/lib</code>, so this has to be given as an argument to <code>-L</code>:</p>\n\n<pre><code>i586-mingw32msvc-gcc -L \"&lt;path-of-installation&gt;/&lt;version&gt;/mingw64/opt/lib\" rc-4.o -lcrypto -o test.exe\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11692476, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-IMv-2QEFIyE/AAAAAAAAAAI/AAAAAAAAAM0/QR_j_oExMOQ/photo.jpg?sz=128", "display_name": "Silky ", "link": "https://stackoverflow.com/users/11692476/silky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2215, "favorite_count": 0, "accepted_answer_id": 57688539, "answer_count": 1, "score": -1, "last_activity_date": 1566982489, "creation_date": 1566910234, "last_edit_date": 1566956116, "question_id": 57675115, "link": "https://stackoverflow.com/questions/57675115/fatal-error-openssl-opensslconf-h-no-such-file-or-directory", "title": "fatal error: openssl/opensslconf.h: No such file or directory", "body": "<p>I try to compile a C file which decrypts and executes an rc-4 encryped shellcode with virtual alloc.</p>\n\n<p>Now I get an error:</p>\n\n<blockquote>\n  <p>\"In file included from rc-4.c:2: rc4.h:62:11: fatal error:\n  openssl/opensslconf.h: No such file or directory\n   #include &lt;openssl/opensslconf.h&gt;/* OPENSSL_NO_RC4, RC4_INT */\"</p>\n</blockquote>\n\n<p>My compile command is: \ni586-mingw32msvc-gcc rc-4.c -o test.exe -lcrypto</p>\n\n<p>At first mingw32 gave me the error that rc-4.h could not be found. \nI fixed this by copying the rc-4.h in my current directory and included it with  #include \"rc-4.h\"</p>\n\n<p>the first two lines of the code</p>\n\n<pre><code>```\n#include &lt;windows.h&gt;\n#include \"rc4.h\"\n```\n</code></pre>\n\n<p>how the rc-4 shellcode should be decrypted and executed: </p>\n\n<pre><code>int lpBufSize = sizeof(int) * PAYLOADSIZE;\n        LPVOID lpBuf = VirtualAlloc(NULL, lpBufSize, MEM_COMMIT, 0x04);\n        memset(lpBuf, '\\0', lpBufSize);\n        RC4(RC4KEY, payload, (char*) lpBuf, PAYLOADSIZE);\n        MessageBox(NULL, (char*) lpBuf, \"Test\", MB_OK);\n        return 0;\n</code></pre>\n\n<p>the expected output should be the compiled test.exe file</p>\n"}, {"tags": ["c", "tcc"], "comments": [{"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "edited": false, "score": 0, "creation_date": 1566909732, "post_id": 57674904, "comment_id": 101796872, "body": "If my expression is not clear enough, welcome to ask me."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1566909774, "post_id": 57674904, "comment_id": 101796907, "body": "<a href=\"https://github.com/antlr/grammars-v4/tree/master/tinyc\" rel=\"nofollow noreferrer\">ANTLR has one</a>. From the comments on that page: <code>The grammar and examples are copied directory from the comments at the top of the TinyC source code.</code>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566910179, "post_id": 57674904, "comment_id": 101797182, "body": "Questions about where to find source code, documentation and other off-site resources are unfortunately off-topic."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566910301, "post_id": 57674904, "comment_id": 101797260, "body": "If you want the formal C grammar you have to read the C specification."}, {"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "reply_to_user": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1566910844, "post_id": 57674904, "comment_id": 101797602, "body": "@500-InternalServerError   Many thanks for your reply! But the link is about Tiny C rather than  TCC. What I wanted was the LL(1) grammar of the C language used in Tiny C Compiler coding. Tiny C Compiler supports complete C syntax."}, {"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "edited": false, "score": 0, "creation_date": 1566911098, "post_id": 57674904, "comment_id": 101797738, "body": "@Ludin So sorry"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566911334, "post_id": 57674904, "comment_id": 101797860, "body": "After a quick glance of the TCC source, it seems to be a standard top-down recursive-descent parser. If you want to extract the grammar from that you have to do it from the source."}, {"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566911888, "post_id": 57674904, "comment_id": 101798218, "body": "@Someprogrammerdude Yes, it is a standard top-down recursive-descent parser. I&#39;m trying to do it, but I&#39;m afraid I won&#39;t be able to complete it without errors, so I wonder if anyone has ever done it. Thank for your reply!"}, {"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "edited": false, "score": 0, "creation_date": 1566912189, "post_id": 57674904, "comment_id": 101798372, "body": "@Ludin I&#39;m a rookie on stack overflow. I would like to ask which type my question can be forwarded to on stack overflow, or is there no type on stack overflow that supports this kind of question?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566912407, "post_id": 57674904, "comment_id": 101798538, "body": "In order for it to be on-topic, you would have to ask about a specific technical problem. For example you could post a certain snippet or function from the compiler source and ask about how the part you don&#39;t understand works. It needs to be a specific, narrowed-down problem."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1566912443, "post_id": 57674904, "comment_id": 101798563, "body": "As a beginner here on SO, please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. Lastly please read <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "edited": false, "score": 0, "creation_date": 1566912665, "post_id": 57674904, "comment_id": 101798697, "body": "OK! Thank you so much!"}], "owner": {"reputation": 21, "user_id": 11592830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb65982a0265f83be716bd8ae8cb29e?s=128&d=identicon&r=PG&f=1", "display_name": "Zhou", "link": "https://stackoverflow.com/users/11592830/zhou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 195, "favorite_count": 0, "closed_date": 1566910814, "answer_count": 0, "score": 2, "last_activity_date": 1566909834, "creation_date": 1566909539, "last_edit_date": 1566909834, "question_id": 57674904, "link": "https://stackoverflow.com/questions/57674904/how-to-find-the-formal-grammar-definition-about-tiny-c-compiler", "closed_reason": "Not suitable for this site", "title": "How to find the formal grammar definition about Tiny C Compiler", "body": "<p>Where can I find the LL(1) grammar used in TCC?</p>\n\n<p>Fabrice Bellard's TCC is admirable. I wanted to learn more about its source code.\n Its parsing is done by hand, not automatically. Now I have found decl() function is related to parsing. Can someone who has studied TCC tell me how to find the documents about LL (1) grammar in TCC? Thank you so much!</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 2, "creation_date": 1566907394, "post_id": 57674194, "comment_id": 101795536, "body": "Try having <code>init_current</code> return a <code>char *</code> instead, and then copy that into <code>ainpath</code> in <code>current_live_read</code> instead of just setting character 33 of that string. (it doesn&#39;t have anything to do with freeing memory - memory of locals is freed automatically)."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 2, "creation_date": 1566907866, "post_id": 57674194, "comment_id": 101795802, "body": "@Pukacza This statement ainpath[33]=init_current(); does not make sense."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1566908973, "post_id": 57674194, "comment_id": 101796424, "body": "If you want to modify a string buffer in C you have to pass the buffer as an argument."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566909467, "post_id": 57674194, "comment_id": 101796729, "body": "There&#39;s just too many basic mistakes. First of all you need to read compiler warnings and fix all the bugs it points out. Then you need to study scope of variables as shown in the linked duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566911373, "post_id": 57674775, "comment_id": 101797884, "body": "It works fine, thank you so much. But there is still another problem. In the second call of: &quot;fscanf(file, &quot;%4d&quot;, &amp;curr);&quot; i have error No source available for &quot;__isoc99_fscanf() at 0x1cf80&quot;. That&#39;s beacouse in the &quot;FILE *file = fopen(ainpath, &quot;r&quot;);&quot; the pointer *file is 0 in the second call of that function. I putted the free(file) but it isn&#39;t work."}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "reply_to_user": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566912052, "post_id": 57674775, "comment_id": 101798303, "body": "@Pukacza: Probably because fopen() is failing. The file may not exist or may be open from another thread. You also need to check <code>file</code> for NULL before calling fscanf. Updated the code."}, {"owner": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566912620, "post_id": 57674775, "comment_id": 101798674, "body": "Yes that&#39;s true the file is giving NULL. So should I somehow close the file in that case or what?"}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "reply_to_user": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566913288, "post_id": 57674775, "comment_id": 101799088, "body": "@Pukacza If open fails, there&#39;s nothing much you can do except flag an error and exit. What you need to do is find out why it fails. Make sure no other instances of your application is running, keeping that file open. Also make sure that the file actually exists."}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "reply_to_user": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566913563, "post_id": 57674775, "comment_id": 101799268, "body": "@Pukacza <code>printf(&quot;Error opening file: %s\\n&quot;, strerror(errno));</code> should give you an error msg that gives some clue."}, {"owner": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566915644, "post_id": 57674775, "comment_id": 101800495, "body": "I see that every run the function fread (buffer, 1, length-1, f); adds me to the end the value of define AIN which is 5 and I don&#39;t know why. I&#39;m cleaning the buffer every time. My bash script gives me path without 5 on the end."}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "reply_to_user": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566915927, "post_id": 57674775, "comment_id": 101800653, "body": "@Pukacza try setting <code>buffer[length-1] = 0;</code> immediately after the <code>fread()</code> call."}, {"owner": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566918057, "post_id": 57674775, "comment_id": 101801893, "body": "This solution works, thank you. But I have another problem. While it&#39;s 7th run of function init_current(); I get the error: &quot;No source available for &quot;_int_malloc() at 0x25f92&quot;&quot; for the function: &quot; fseek (f, 0, SEEK_END);&quot; but the *f giving me proper path, then I don&#39;t know why this have no source. The file from the path in Linux os have the 777."}, {"owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "reply_to_user": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "edited": false, "score": 0, "creation_date": 1566920756, "post_id": 57674775, "comment_id": 101803369, "body": "@Pukacza &quot;No source available&quot; probably means that the debugger cannot find the source code for the function, which it obviously can&#39;t for <code>malloc</code> since it is in a library. The actual error is somewhere else, which you probably have missed."}], "tags": [], "owner": {"reputation": 1939, "user_id": 3214247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f1c6ec676d1a5661ff13305b99f23e3?s=128&d=identicon&r=PG&f=1", "display_name": "th33lf", "link": "https://stackoverflow.com/users/3214247/th33lf"}, "is_accepted": true, "score": 0, "last_activity_date": 1566911973, "last_edit_date": 1566911973, "creation_date": 1566909085, "answer_id": 57674775, "question_id": 57674194, "link": "https://stackoverflow.com/questions/57674194/free-char-memory/57674775#57674775", "title": "Free Char memory", "body": "<p>There are quite a few things going wrong here.</p>\n\n<pre><code>return(ainpath);\n</code></pre>\n\n<p>You are returning the pointer to a local array, which is going to get destroyed on function exit. Instead, allocate more memory:</p>\n\n<pre><code>buffer =  malloc(length+10); // I don't know what AIN is, but it has to fit!\n</code></pre>\n\n<p>Then write into <code>buffer</code>, not <code>ainpath</code> and return that, because it persists across function calls.</p>\n\n<pre><code>if (buffer)\n{\n    sprintf(buffer, \"%s%d\", buffer, AIN);\n}\n\nreturn buffer; // return the malloc'd buffer here\n</code></pre>\n\n<p>Since we are returning a pointer, <code>init_current</code> should be defined as (note the <code>*</code>):</p>\n\n<pre><code>char *init_current(void)\n{\n...\n</code></pre>\n\n<p>Finally,</p>\n\n<pre><code>ainpath[33]=init_current();\n</code></pre>\n\n<p>does not do what you think it does. It takes the value returned by <code>init_current()</code> which is a pointer, and stores it to the 34th character in <code>ainpath</code>, which is probably not what you want. Use a pointer instead:</p>\n\n<pre><code>int current_live_read(int *current)\n{\n\n    char* ainpath;\n    ainpath=init_current();\n\n    int curr;\n\n    FILE *file = fopen(ainpath, \"r\");\n    free(ainpath); // Free when you are done using the buffer\n\n    if(!file)\n        return -1;\n\n    fscanf(file, \"%4d\", &amp;curr);\n    if(!feof (file))\n    {\n\n    }\n    fclose(file);\n\n    *current=curr;\n    return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11455060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b64cb78974cbc0f13609eea35703327a?s=128&d=identicon&r=PG&f=1", "display_name": "Pukacza", "link": "https://stackoverflow.com/users/11455060/pukacza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "closed_date": 1566909323, "accepted_answer_id": 57674775, "answer_count": 1, "score": 0, "last_activity_date": 1566911973, "creation_date": 1566907083, "question_id": 57674194, "link": "https://stackoverflow.com/questions/57674194/free-char-memory", "closed_reason": "Duplicate", "title": "Free Char memory", "body": "<p>I have problem with multiple calling the function that is returning the char value.\nI want to reassign the returning value from that function to the char variable in another function.\nHere is the code of function where I'm calling the function init_current():</p>\n\n<pre><code>int current_live_read(int *current)\n{\n\n    char ainpath[33];\n    ainpath[33]=init_current();\n\n    char *filename = ainpath;\n    int curr;\n\n    FILE *file = fopen(filename, \"r\");\n    fscanf(file, \"%4d\", &amp;curr);\n    if(!feof (file))\n    {\n\n    }\n    fclose(file);\n\n    *current=curr;\n    return(0);\n}\n</code></pre>\n\n<p>In this function I'm calling the function init_current(). When I'm calling it for the first time I have proper return value of ainpath[33] variable. But when I'm calling the current_live_read(int *current) for the second time I have error in fscanf couse the variable ainpath[33] after second call is \"<em>Name : ainpath\n    Details:'\\0' , \"\\027\u00ce\\001\\0T\u00fa\u00ff\u00be\\0\\037\u00e3\\225r.16\\0\\0\\b\\0\"\n    Default:0xbefffa28\n    Decimal:-1090520536</em>\" which is not correct for sure. I think that i need to free somehow the array ainpath[33] but I don't know how.</p>\n\n<p>Here is the code of init_current():</p>\n\n<pre><code>char init_current(void)\n{\n    system(\"sudo echo cape-bone-iio &gt; /sys/devices/bone_capemgr.*/slots\");  //Init ADC\n    system(AINpath);\n\n    //int file;\n    char ainpath[33];\n    char *filename = \"/root/LED_Tester_V1/CurrentRead/pathbuf\";\n    char * buffer = 0;\n    long length;\n    FILE * f = fopen (filename, \"rb\");\n\n    if (f)\n    {\n      fseek (f, 0, SEEK_END);\n      length = ftell (f);\n      fseek (f, 0, SEEK_SET);\n      buffer = malloc (length);\n      if (buffer)\n      {\n        fread (buffer, 1, length-1, f);\n      }\n      fclose (f);\n    }\n\n    if (buffer)\n    {\n      sprintf(ainpath, \"%s%d\", buffer, AIN);\n\n    }\n    return(ainpath);\n}\n</code></pre>\n"}, {"tags": ["c", "arguments", "command-line-arguments"], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566912261, "post_id": 57674132, "comment_id": 101798422, "body": "I was assuming the OP wants <code>-n&lt;number&gt;</code>, not <code>-n &lt;number&gt;</code>,"}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 1, "last_activity_date": 1566917358, "last_edit_date": 1566917358, "creation_date": 1566906839, "answer_id": 57674132, "question_id": 57674081, "link": "https://stackoverflow.com/questions/57674081/declaring-a-n-argument-to-accept-an-integer-in-the-command-line-c/57674132#57674132", "title": "Declaring a -n argument to accept an integer in the command line - C", "body": "<p>To do that, you can use <code>strncmp</code> and <code>strtol</code>:</p>\n\n<pre><code>int main(int argc, char* argv[])\n{\n     int n = 0;\n     if(argc &gt; 1)\n     {\n        if(!strncmp(argv[1], \"-n\", 2))\n        {\n            n = strtoll(argv[1]+2, NULL, 10);\n        }\n     }\n     if(n == 0) /* fail */;\n     /* do stuff */\n}\n</code></pre>\n\n<p>This checks if <code>argv</code> has more than just one argument (the name of the program) and then checks for <code>-n</code>, and, if it finds it, converts the number directly after <code>-n</code> to an integer (i.e. <code>-n3</code> is converted to three).</p>\n\n<p>If you want to accept one argument only and fail otherwise, change <code>argc &gt; 1</code> to <code>argc == 2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": false, "score": 1, "last_activity_date": 1566911717, "last_edit_date": 1566911717, "creation_date": 1566907510, "answer_id": 57674312, "question_id": 57674081, "link": "https://stackoverflow.com/questions/57674081/declaring-a-n-argument-to-accept-an-integer-in-the-command-line-c/57674312#57674312", "title": "Declaring a -n argument to accept an integer in the command line - C", "body": "<p><em>and I only need the one -n argument</em>.  You will need at least 3 arguments if you require the <code>-n</code> argument.  (meaning <code>argc</code> - <em>argument count</em> will be 3.)</p>\n\n<p>... This is assuming the <code>-n</code> argument will be followed by an integer value to indicate how many characters are to be read.  If the number of characters to be read from your file is 3, it would be called on the command line for example as:  </p>\n\n<pre><code>programName.exe -n 3 \n</code></pre>\n\n<p>This results in the arguments of <code>main(int argc, char* argv[])</code> being populated as:</p>\n\n<pre><code>argc == 3\nargv[] == {\"programName.exe\", \"-n\", \"3\"}\n</code></pre>\n\n<p>So yes, the C <code>main</code> signature <code>int main(int argc, char* argv[])</code> will accommodate 1 to many arguments, but that does not exclude it from being used to create a program that will accept only 2 arguments.  (The first <em>argument</em> listed by convention is always the executable name of the program the code is compiled into.)    </p>\n\n<p>If you would like to have only the one additional argument (which would result in a count of 2 actual arguments), skip including the '-n' and define your <em>Usage</em> as requiring a singe positive digit following the program name:  </p>\n\n<pre><code>programName.exe 3\n</code></pre>\n\n<p>Then code it like this:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\n    char *dummy;\n    int val;\n    if(argc != 2)\n    {\n        printf(\"Usage: prog.exe &lt;n&gt; where &lt;n&gt; is a positive integer value.\\nProgram will now exit\");\n        return 0;\n    }\n    // Resolve value of 2nd argument:\n    val = strtol(argv[1], &amp;dummy, 10);\n    if (dummy == argv[1] || ((val == LONG_MIN || val == LONG_MAX) &amp;&amp; errno == ERANGE))\n    {\n            //handle error\n    }\n    //use val to read desired content from file\n    ...\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 11980136, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDg2-o3Szcx9hOOQtHU9Ke6umu3MmWMHt1bVyLEJg=k-s128", "display_name": "deezy", "link": "https://stackoverflow.com/users/11980136/deezy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1566913542, "accepted_answer_id": 57674132, "answer_count": 2, "score": -2, "last_activity_date": 1566917358, "creation_date": 1566906652, "last_edit_date": 1566917292, "question_id": 57674081, "link": "https://stackoverflow.com/questions/57674081/declaring-a-n-argument-to-accept-an-integer-in-the-command-line-c", "closed_reason": "Not suitable for this site", "title": "Declaring a -n argument to accept an integer in the command line - C", "body": "<p>I am writing a program to print the last <code>n</code> characters of a <code>.txt</code> file. I wish to add the ability to run the program from the command line with a <code>-n</code> argument to input the amount of characters to print.</p>\n\n<p>I have tried declaring <code>int main(int argc, char* argv[])</code> but that seems to accept any amount of arguments and I only need the one <code>-n</code> argument.</p>\n"}, {"tags": ["c", "service", "fork", "popen"], "comments": [{"owner": {"reputation": 1, "user_id": 3913365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa4e03fd0b0e660bedb1ecfd4d75f05?s=128&d=identicon&r=PG&f=1", "display_name": "edvsk", "link": "https://stackoverflow.com/users/3913365/edvsk"}, "edited": false, "score": 0, "creation_date": 1566905893, "post_id": 57673828, "comment_id": 101794654, "body": "acReplacedcommand: /bin/ping -c 1 -W 15 seraph | /bin/grep &quot;1 packets transmitted&quot; | /usr/bin/awk &#39;{print $4}&#39;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1566906093, "post_id": 57673828, "comment_id": 101794767, "body": "If the command in your comment is relevant to the question you should add it to the question. You can edit your question to include missing information"}, {"owner": {"reputation": 1, "user_id": 3913365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa4e03fd0b0e660bedb1ecfd4d75f05?s=128&d=identicon&r=PG&f=1", "display_name": "edvsk", "link": "https://stackoverflow.com/users/3913365/edvsk"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1566992694, "post_id": 57673828, "comment_id": 101827519, "body": "I would have done if I could have saved the additional parts:  &quot;It looks like your post is mostly code; please add some more details.&quot;"}], "owner": {"reputation": 1, "user_id": 3913365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aa4e03fd0b0e660bedb1ecfd4d75f05?s=128&d=identicon&r=PG&f=1", "display_name": "edvsk", "link": "https://stackoverflow.com/users/3913365/edvsk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566992926, "creation_date": 1566905746, "last_edit_date": 1566992926, "question_id": 57673828, "link": "https://stackoverflow.com/questions/57673828/executable-using-popen-pclose-runs-well-as-executable-but-fails-as-service", "title": "Executable using popen / pclose runs well as executable but fails as service", "body": "<p>If I run a executable using popen()/pclose() runs well, but installed as a service it fails.</p>\n\n<pre><code>[Unit]\nDescription=Accessibility check\nAfter=network.target\nStartLimitIntervalSec=0\n\n[Service]\nType=forking\nRestart=always\nRestartSec=1\nUser=root\nWorkingDirectory=/tmp\nExecStart=/usr/local/bin/mx_qracc /etc/acc/mx_qracc_seraph.cnf\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<ul>\n<li>including path in called executables</li>\n<li>including TYPE=forking in service unit</li>\n<li>increased timeout</li>\n<li>...</li>\n</ul>\n\n<p>&nbsp;</p>\n\n<pre><code>int pingUrl(Text acHost, Text acCommand, int iCommandtimeout, pAccessibilitytype peAccessibility)\n{\n    int                 iRet = 0;\n    Text                acTmp;\n    Text                acReplacedcommand;\n    FILE *              fileIn = NULL;\n    Time                tWaitFor;\n\n    ... \n            /** preset internal timeout */\n            tWaitFor = time(NULL) + iCommandtimeout + 2;\n            /** open query pipe */\n            if ((fileIn = popen(acReplacedcommand, \"re\")) == NULL) {\n                snprintf(acTmp, sText, \"mx_cmdln.pingUrl.popen: %s:\", strerror(errno));\n                iRet = writeSyslog(eSlogError, acTmp, errno, 6);\n                if (isTraceingenabled() == eTrue) {\n                    snprintf(acTmp, sText, \"mx_cmdln.pingUrl.popen: open pipe failed [command %s].\", acReplacedcommand);\n                    writeTracefile(acTmp);\n                }\n            }\n            if (iRet == 0) {\n                /** wait until command finished or internal timeout occurred */\n                do {\n                    /** check for output of query pipe */\n                    if (fgets(acTmp, sText, fileIn) == NULL) {\n                        sleep(1);\n                    }\n                    else {\n                        if (acTmp[0] == '1') {\n                            /** set accessibility state to online */\n                            *peAccessibility = eAccess;\n                        }\n                        else if (acTmp[0] == '0') {\n                            /** set accessibility state to offline */\n                            *peAccessibility = eNoaccesstype;\n                        }\n                        else {\n                            /** command failed */\n                            snprintf(acTmp, sText, \"mx_cmdln.pingUrl.fgets: [result length %d result %s].\", strlen(acTmp), acTmp);\n                            iRet = writeSyslog(eSlogError, acTmp, 7, 7);\n                            /** set accessibility state to undefined */\n                            *peAccessibility = eUnknownaccess;\n                        }\n                        break;\n                    }\n                } while (tWaitFor &lt; time(NULL));\n                /** close pipe */\n                if ((iRet = pclose(fileIn)) == -1) {\n                    snprintf(acTmp, sText, \"mx_cmdln.pingUrl.pclose: %s:\", strerror(errno));\n                    iRet = writeSyslog(eSlogError, acTmp, errno, 8);\n                }\n            }\n    ...\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>... seraph mx_qracc: SLOG_ERR    : mx_cmdln.pingUrl.pclose: No child processes: [code: 10 at pos: 8]\n</code></pre>\n\n<p>Inserted from comment:</p>\n\n<pre><code>acReplacedcommand: /bin/ping -c 1 -W 15 seraph | /bin/grep \"1 packets transmitted\" | /usr/bin/awk '{print $4}'\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 3, "creation_date": 1566904268, "post_id": 57673364, "comment_id": 101793733, "body": "Unclear what you are trying to do, <code>struct wall walls</code> is a local variable which doesn&#39;t exist after <code>setup</code> function returns to main. You might want to look at <a href=\"https://en.wikipedia.org/wiki/C_dynamic_memory_allocation\" rel=\"nofollow noreferrer\">dynamic memory allocation in C</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1566904868, "post_id": 57673364, "comment_id": 101794063, "body": "You would have the same problem if the variable were of any other type. I think you need to study some more about variable scope and how to write, and use, functions before adding the complications of arrays."}], "answers": [{"comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566904874, "post_id": 57673445, "comment_id": 101794067, "body": "Probably <code>COUNT</code> was just an example."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566906509, "post_id": 57673445, "comment_id": 101795026, "body": "How likely is it that the OP will just copy your code and leave (i.e. not look at it at all)?"}, {"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566906582, "post_id": 57673445, "comment_id": 101795074, "body": "@JL2210 that&#39;s a really good question. I ask that to myself in my sleep every now and then."}], "tags": [], "owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1566904918, "last_edit_date": 1566904918, "creation_date": 1566904316, "answer_id": 57673445, "question_id": 57673364, "link": "https://stackoverflow.com/questions/57673364/how-to-pass-array-of-structs-that-is-within-one-function-to-another-function-thr/57673445#57673445", "title": "How to pass array of structs that is within one function to another function through main", "body": "<p>Assuming the following:</p>\n\n<blockquote>\n  <p>The struct array isn't declared globally because its size is not known until the <code>setup()</code> function runs.</p>\n</blockquote>\n\n<p>Then your only option seems to be dynamically allocating such array using <code>malloc()</code> and returning it to the caller, like this:</p>\n\n<pre><code>struct wall *setup (void) {\n    struct wall *walls;\n\n    size_t needed;\n\n    /* Calculate the needed size... */\n\n    // Allocate the array:\n    walls = malloc(needed * sizeof(struct wall));\n\n    /* Fill the array with a loop... */\n\n    // Return it:\n    return walls;\n}\n\nint main() {\n    struct wall *x;\n\n    x = setup();\n    setup_bar(x, COUNT_LINES);\n\n    /* whatever else... */\n\n    // Remember to free the allocated array once you're done using it:\n    free(x);\n\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>By the way, the fact that you say that the size is not known until <code>setup()</code> is run, together with this declaration:</p>\n\n<pre><code>struct wall walls[COUNT];\n</code></pre>\n\n<p>really makes me wonder which one of the two statements is wrong... did you use <code>COUNT</code> here just as an example or what? If you use a <code>#define</code> or other global variable then the size <strong>is</strong> known before <code>setup()</code> is run.</p>\n"}, {"comments": [{"owner": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 0, "creation_date": 1566906369, "post_id": 57673481, "comment_id": 101794933, "body": "sizeof pointer? probably meant <code>struct wall</code>"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "reply_to_user": {"reputation": 11762, "user_id": 6530695, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/53a7a617c8e419f2562f0b00e6be10b1?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/6530695/tony"}, "edited": false, "score": 1, "creation_date": 1566906457, "post_id": 57673481, "comment_id": 101794993, "body": "@Tony Nope, I meant what I wrote. This dereferences <code>walls</code> and then takes the size of <code>struct wall</code> (indirectly). Never use a type name for <code>sizeof</code> in <code>malloc</code>."}], "tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 0, "last_activity_date": 1566904929, "last_edit_date": 1566904929, "creation_date": 1566904434, "answer_id": 57673481, "question_id": 57673364, "link": "https://stackoverflow.com/questions/57673364/how-to-pass-array-of-structs-that-is-within-one-function-to-another-function-thr/57673481#57673481", "title": "How to pass array of structs that is within one function to another function through main", "body": "<p>You can't. This is a limitation of a thing called <em>storage duration</em>.</p>\n\n<p>Basically, once <code>setup</code> exits, <code>wall</code> is destroyed. You cannot access it again.</p>\n\n<p>To get around this, create two static global variables, <code>wall</code> and <code>wall_size</code>:</p>\n\n<pre><code>static struct wall *walls;\nstatic size_t wall_size;\n</code></pre>\n\n<p>and then allocate them in <code>setup</code>:</p>\n\n<pre><code>walls = malloc(COUNT*sizeof(*walls));\nwall_size = COUNT;\n</code></pre>\n\n<p>That way, <code>walls</code> will be available to all functions in the translation unit (basically the <code>.c</code> file you're using). You can then traverse <code>walls</code> using <code>wall_size</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1566905540, "last_edit_date": 1566905540, "creation_date": 1566905133, "answer_id": 57673645, "question_id": 57673364, "link": "https://stackoverflow.com/questions/57673364/how-to-pass-array-of-structs-that-is-within-one-function-to-another-function-thr/57673645#57673645", "title": "How to pass array of structs that is within one function to another function through main", "body": "<p>Your problem with the code is that you are using a wrong pattern.</p>\n\n<p>Define the function <code>setup</code> the following way</p>\n\n<pre><code>void setup( struct wall * walls, size_t n)\n{\n        // It is then filled using a loop\n}\n</code></pre>\n\n<p>and in main write</p>\n\n<pre><code>int main( void )\n{\n    struct wall walls[COUNT_LINES];\n\n    setup( walls, COUNT_LINES );\n    setup_bar( walls, COUNT_LINES );\n    //...\n\n    return 0;\n}\n</code></pre>\n\n<p>Another approach is the following that is to allocate dynamically an array of structures in the function setup. In this case the functions can look like</p>\n\n<pre><code>size_t setup_bar( struct wall **walls )\n{\n    *walls = malloc( COUNT, sizeof( struct wall ) );\n\n    size_t n = *walls == NULL ? 0 : COUNT;\n\n    if ( n != 0 )\n    {\n        // It is then filled using a loop\n    }\n\n    return n;\n}\n\nint main( void )\n{\n    struct wall *walls = NULL;\n\n    size_t n = setup( &amp;walls );\n\n    if ( n != 0 )\n    {\n        setup_bar( walls, n );\n    }\n    //...\n    free( walls );\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11320760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27c728dc7ee0dd9707b29b997e1134b7?s=128&d=identicon&r=PG&f=1", "display_name": "testesttest", "link": "https://stackoverflow.com/users/11320760/testesttest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1566910451, "answer_count": 3, "score": 0, "last_activity_date": 1566906553, "creation_date": 1566904025, "last_edit_date": 1566906553, "question_id": 57673364, "link": "https://stackoverflow.com/questions/57673364/how-to-pass-array-of-structs-that-is-within-one-function-to-another-function-thr", "closed_reason": "Needs details or clarity", "title": "How to pass array of structs that is within one function to another function through main", "body": "<p>Hey so I have this function called setup and in this function, an array of structs is declared and filled.</p>\n\n<pre><code>void setup (void){\n\n        struct wall walls[COUNT]\n        // It is then filled using a loop\n}\n</code></pre>\n\n<p>However, within the <code>main()</code> function I have another function setup like this:</p>\n\n<pre><code>int main(){\n    setup_bar(walls, COUNT_LINES);\n    return 0;\n}\n</code></pre>\n\n<p>But it is saying it cant access walls within <code>setup_bar()</code>. I'm trying to pass the walls array from one function to another that is in main. The struct array isn't declared globally because its size is not known until the <code>setup()</code> function runs. Is there a way around this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1566902297, "post_id": 57672846, "comment_id": 101792710, "body": "Why do you need that? That looks like code you would get fired for writing. :)"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1566902303, "post_id": 57672846, "comment_id": 101792715, "body": "Unfortunately your question is unclear: What do you not understand?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1566902380, "post_id": 57672846, "comment_id": 101792750, "body": "Lookup ASCII value of <code>&#39;9&#39;</code>, same for <code>&#39;5&#39;</code>; plug them in."}, {"owner": {"reputation": 1345, "user_id": 4554967, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/3e7affacfbfa560a3f2ca86204fb5b84?s=128&d=identicon&r=PG&f=1", "display_name": "zappy", "link": "https://stackoverflow.com/users/4554967/zappy"}, "edited": false, "score": 0, "creation_date": 1566902585, "post_id": 57672846, "comment_id": 101792833, "body": "Re-format your question after reading this  <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566904440, "post_id": 57672846, "comment_id": 101793833, "body": "Did you leave something out of your post?  What value do you expect <code>i</code> to have?"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1566903901, "post_id": 57672885, "comment_id": 101793543, "body": "@AnttiHaapala: Yeah that added confusion and there&#39;s no need to go into all the exceptions; I&#39;ve trimmed the text."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1566903869, "last_edit_date": 1566903869, "creation_date": 1566902334, "answer_id": 57672885, "question_id": 57672846, "link": "https://stackoverflow.com/questions/57672846/need-to-understand-this-if-statement/57672885#57672885", "title": "Need to understand this If statement", "body": "<p>Formally the behaviour of your code is <em>undefined</em> as you are reading the uninitialised variable <code>i</code>.</p>\n\n<p><code>'9'</code>, 256, and <code>'5'</code> are <em>all</em> <code>int</code> types in C. So the right hand side is evaluated in <code>int</code> arithmetic, with the potential for overflow (it will not overflow with ASCII encoding).</p>\n\n<p><code>i</code> will be converted to an <code>int</code> type prior to the comparison.</p>\n"}], "owner": {"reputation": 19, "user_id": 10977964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBYBX.jpg?s=128&g=1", "display_name": "Ahmed Elsenbawy", "link": "https://stackoverflow.com/users/10977964/ahmed-elsenbawy"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1566903786, "answer_count": 1, "score": -5, "last_activity_date": 1566904206, "creation_date": 1566902213, "last_edit_date": 1566904206, "question_id": 57672846, "link": "https://stackoverflow.com/questions/57672846/need-to-understand-this-if-statement", "closed_reason": "Needs details or clarity", "title": "Need to understand this If statement", "body": "<p>I need to understand more about this if condition the two sides of comparison and how it is compared:</p>\n\n<pre><code>int main()\n{\n    unsigned short i;\n    if (i == '9' * 256 + '5')\n    {\n        /* Do stuff */\n    }\n}\n</code></pre>\n\n<p>How are these compared?</p>\n"}, {"tags": ["c", "macos", "http", "tcp"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566903284, "post_id": 57672705, "comment_id": 101793238, "body": "It works just fine on my Mac.  You might be having a firewall problem."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 4, "creation_date": 1566903428, "post_id": 57672705, "comment_id": 101793308, "body": "Your link is garbage, and there is no such thing as a &#39;simple HTTP server&#39;. You need a good knowledge of RFC 2616 and successors to implement HTTP, and you also need to know that it is all based on the Telnet line definition, in which lines are terminated by <code>\\r\\n</code>, not <code>\\n</code>, which the author of your link doesn&#39;t appear to know."}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566903483, "post_id": 57672705, "comment_id": 101793340, "body": "Most likely you have a network problem."}, {"owner": {"reputation": 47, "user_id": 11983167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7b02fd8892b025d47fb9f051031f7c?s=128&d=identicon&r=PG&f=1", "display_name": "H.Potter", "link": "https://stackoverflow.com/users/11983167/h-potter"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566905047, "post_id": 57672705, "comment_id": 101794152, "body": "@SteveSummit really? I should check &quot;firewall problem&quot;. Can you tell me what is it btw?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566906321, "post_id": 57672705, "comment_id": 101794902, "body": "Go to System Preferences, the Security &amp; Privacy dialog, the Firewall tab.  Turning off the firewall might help.  (But remember to turn it back on when you&#39;re done playing.)"}, {"owner": {"reputation": 47, "user_id": 11983167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7b02fd8892b025d47fb9f051031f7c?s=128&d=identicon&r=PG&f=1", "display_name": "H.Potter", "link": "https://stackoverflow.com/users/11983167/h-potter"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1566906572, "post_id": 57672705, "comment_id": 101795071, "body": "@SteveSummit I checked it but by Firewall is set &quot;off&quot; at the very beginning... :( what would be the problem then..?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566906919, "post_id": 57672705, "comment_id": 101795250, "body": "I don&#39;t know.  Another thing to try would be connecting to <code>http:&#47;&#47;127.0.0.1:8080&#47;</code> instead of localhost.  Another thing that sometimes makes a difference (although I wouldn&#39;t expect it to in this case) is whether you have an active network connection.  (No, you shouldn&#39;t need a network connection to connect to your own machine, but I&#39;ve had problems with this.)"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1566914372, "post_id": 57672705, "comment_id": 101799752, "body": "Also, per the comment from @user207421 , definitely change all <code>\\n</code>&#39;s in your <code>hello</code> string to <code>\\r\\n</code>."}, {"owner": {"reputation": 4299, "user_id": 5329717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NOuLF.png?s=128&g=1", "display_name": "Kamil.S", "link": "https://stackoverflow.com/users/5329717/kamil-s"}, "edited": false, "score": 1, "creation_date": 1566918336, "post_id": 57672705, "comment_id": 101802061, "body": "You can check against <code>python -m SimpleHTTPServer 8000</code> (typed in terminal of course) which should work out of the box on MacOS to potentially narrow down the domain of your problem."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1566925495, "post_id": 57672705, "comment_id": 101805392, "body": "OT: regarding: <code>char *hello = &quot;HTTP&#47;1.1 200 OK\\nContent-Type: text&#47;plain\\nContent-Length: 12\\n\\nHello world!&quot;;</code> 1) for ease of readability, honor the right hand margin (usually at column 72 or 80)  2) use the correct line breaks &quot;\\r\\n&quot; not &#39;\\n&#39;, including the last line.  Suggest: <code>char *hello = &quot;HTTP&#47;1.1 200 OK\\r\\n&quot; newline &quot;Content-Type: text&#47;plain\\r\\n&quot; newline &quot;Content-Length: 12\\r\\n\\r\\n&quot; newline &quot;Hello world!\\r\\n&quot;;</code>"}], "owner": {"reputation": 47, "user_id": 11983167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7b02fd8892b025d47fb9f051031f7c?s=128&d=identicon&r=PG&f=1", "display_name": "H.Potter", "link": "https://stackoverflow.com/users/11983167/h-potter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 536, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1566901738, "creation_date": 1566901738, "question_id": 57672705, "link": "https://stackoverflow.com/questions/57672705/simple-http-server-c-code-doesnt-work-on-my-mac-os-x", "title": "Simple HTTP Server C code doesn&#39;t work on my Mac OS X", "body": "<p>I am trying to implement a very simple HTTP server C code, and while doing that I search this on the web :\n<a href=\"https://medium.com/from-the-scratch/http-server-what-do-you-need-to-know-to-build-a-simple-http-server-from-scratch-d1ef8945e4fa\" rel=\"nofollow noreferrer\">https://medium.com/from-the-scratch/http-server-what-do-you-need-to-know-to-build-a-simple-http-server-from-scratch-d1ef8945e4fa</a></p>\n\n<p>And I copy-and-paste the code which is shown below.(also the code in the link up there)</p>\n\n<p>And I build it and run it on my MacBook, \nand it runs on my computer, so I typed \"localhost:8080\" on Safari.</p>\n\n<p>And I have this result only.</p>\n\n<p><strong>Safari Can't Connect to the Server\nSafari can't open the page \"localhost:8080\" because Safari can't connect to the server \"localhost\".</strong></p>\n\n<p>I have no idea why this is not working. According to that site, It should work, so I am now frustrated.</p>\n\n<p>Anyone please help me?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// Server side C program to demonstrate HTTP Server programming\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;string.h&gt;\n\n#define PORT 8080\nint main(int argc, char const *argv[])\n{\n    int server_fd, new_socket; long valread;\n    struct sockaddr_in address;\n    int addrlen = sizeof(address);\n\n    // Only this line has been changed. Everything is same.\n    char *hello = \"HTTP/1.1 200 OK\\nContent-Type: text/plain\\nContent-Length: 12\\n\\nHello world!\";\n\n    // Creating socket file descriptor\n    if ((server_fd = socket(AF_INET, SOCK_STREAM, 0)) == 0)\n    {\n        perror(\"In socket\");\n        exit(EXIT_FAILURE);\n    }\n\n\n    address.sin_family = AF_INET;\n    address.sin_addr.s_addr = INADDR_ANY;\n    address.sin_port = htons( PORT );\n\n    memset(address.sin_zero, '\\0', sizeof address.sin_zero);\n\n\n    if (bind(server_fd, (struct sockaddr *)&amp;address, sizeof(address))&lt;0)\n    {\n        perror(\"In bind\");\n        exit(EXIT_FAILURE);\n    }\n    if (listen(server_fd, 10) &lt; 0)\n    {\n        perror(\"In listen\");\n        exit(EXIT_FAILURE);\n    }\n    while(1)\n    {\n        printf(\"\\n+++++++ Waiting for new connection ++++++++\\n\\n\");\n        if ((new_socket = accept(server_fd, (struct sockaddr *)&amp;address, (socklen_t*)&amp;addrlen))&lt;0)\n        {\n            perror(\"In accept\");\n            exit(EXIT_FAILURE);\n        }\n\n        char buffer[30000] = {0};\n        valread = read( new_socket , buffer, 30000);\n        printf(\"%s\\n\",buffer );\n        write(new_socket , hello , strlen(hello));\n        printf(\"------------------Hello message sent-------------------\");\n        close(new_socket);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "struct", "eof", "fread"], "comments": [{"owner": {"reputation": 9, "user_id": 11635212, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QEbjnk36Has/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6TyQfck7m0a5AhsQwTigp3duznA/mo/photo.jpg?sz=128", "display_name": "Hugh", "link": "https://stackoverflow.com/users/11635212/hugh"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566901073, "post_id": 57672446, "comment_id": 101792136, "body": "I read that - however, I could not implement those methods into mine in a way that would work - that is with the use of structs"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566901513, "post_id": 57672446, "comment_id": 101792352, "body": "You should take some time and create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1566902503, "post_id": 57672446, "comment_id": 101792803, "body": "<code>feof</code> does not tell whether a next read can be made. It tells whether the previous read encountered EOF."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 0, "last_activity_date": 1566903073, "last_edit_date": 1566903073, "creation_date": 1566902299, "answer_id": 57672874, "question_id": 57672446, "link": "https://stackoverflow.com/questions/57672446/looping-through-fread-statements/57672874#57672874", "title": "Looping through fread statements", "body": "<p>The check of <code>eof()</code> occurs after <code>fread</code>. </p>\n\n<pre><code>while(!feof(fptr)){\n    fread(&amp;input.business, sizeof(float), 1, fptr);\n    //...\n    printf(\"%f \", input.business);\n    //... \n}\n</code></pre>\n\n<p>So a call of <code>fread</code> can end unsuccessfully and the previous value of the corresponding argument will be outputted by a call of <code>printf</code>.</p>\n\n<p>From the C Standard (7.21.8.1 The fread function)</p>\n\n<blockquote>\n  <p>3 The fread function returns the number of elements successfully read,\n  which may be less than nmemb if a read error or end-of-file is\n  encountered. If size or nmemb is zero, fread returns zero and the\n  contents of the array and the state of the stream remain unchanged</p>\n</blockquote>\n\n<p>I can suggest the following approach to your task.</p>\n\n<pre><code>enum { N = 16 }; // number of fread calls\nsize_t n = 0, prev_n = 0;\n\ndo\n{\n    switch ( n )\n    {\n    case 0:\n        n += fread( &amp;input.business, sizeof(float), 1, fptr );\n        break;\n    case 1:     \n        n += fread(&amp;input.jellyfish, sizeof(char), 1, fptr );\n        break;\n    case 2:\n        n += fread(&amp;input.death, sizeof(input.death), 1, fptr );\n        break;\n    // ...\n    }\n} while ( prev_n != n &amp;&amp; ( prev_n = n ) &lt; N );\n\nfor ( size_t i = 0; i &lt; n; i++ )\n{\n    switch ( i )\n    {\n    case 0:         \n        printf(\"%f \", input.business);\n        break;\n    case 1:         \n        printf(\"%c \", input.jellyfish);\n        break;\n    case 2:         \n        printf(\"%d \", input.death);\n        break;\n    //...           \n    }\n}       \n</code></pre>\n\n<p>Here is a demonstrative program that shows the approach in action.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    enum { N = 3 };\n    int a[N];\n    size_t n = 0, prev_n = 0;\n\n    do\n    {\n        switch ( n )\n        {\n        case 0:\n            n += scanf( \"%d\", a + n );\n            break;\n        case 1:     \n            n += scanf( \"%d\", a + n );\n            break;\n        case 2:\n            n += scanf( \"%d\", a + n );\n            break;\n        }\n        // ...\n    } while ( prev_n != n &amp;&amp; ( prev_n = n ) &lt; N );\n\n    for ( size_t i = 0; i &lt; n; i++ )\n    {\n        switch ( i )\n        {\n        case 0:         \n            printf( \"%d \", a[i] );\n            break;\n        case 1:         \n            printf( \"%d \", a[i] );\n            break;\n        case 2:         \n            printf( \"%d \", a[i] );\n            break;\n        //...           \n        }\n    }       \n\n    return 0;\n}\n</code></pre>\n\n<p>if the input is </p>\n\n<pre><code>1 2 3\n</code></pre>\n\n<p>then the output is also</p>\n\n<pre><code>1 2 3\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11635212, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QEbjnk36Has/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd6TyQfck7m0a5AhsQwTigp3duznA/mo/photo.jpg?sz=128", "display_name": "Hugh", "link": "https://stackoverflow.com/users/11635212/hugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1566913626, "accepted_answer_id": 57672874, "answer_count": 1, "score": -1, "last_activity_date": 1566903073, "creation_date": 1566900837, "last_edit_date": 1566902670, "question_id": 57672446, "link": "https://stackoverflow.com/questions/57672446/looping-through-fread-statements", "closed_reason": "Duplicate", "title": "Looping through fread statements", "body": "<p>Need to loop through the fread statements and print each one. However feof is printing an extra line at the end </p>\n\n<p>The code works (as in is getting the right output) just need to not have that extra line</p>\n\n<p>a\na\na\na\na\na\na\na\na\na\na\na\na\na\na\na\na</p>\n\n<p>a</p>\n\n<pre><code>struct item input;\n\n FILE *fptr;\n fptr = fopen(argv[1], \"rb\");\nif(!fptr){\n  FILE *fpOut = fopen(argv[1], \"w\");\n int c;\n}\n\n if(fptr == NULL){\n  fprintf(stderr, \"\\nError opening file\\n\");\n  exit(1);\n\n fseek(fptr, 0, SEEK_SET);\n}\nwhile(!feof(fptr)){\n\n\n fread(&amp;input.business, sizeof(float), 1, fptr);\n fread(&amp;input.jellyfish, sizeof(char), 1, fptr);\n fread(&amp;input.death, sizeof(input.death), 1, fptr);\n fread(&amp;input.love, sizeof(input.love),1,fptr);\n fread(&amp;input.ornament, sizeof(input.ornament), 1, fptr);\n fread(&amp;input.taste, sizeof(input.taste),1,fptr);\n fread(&amp;input.cloth, sizeof(input.cloth),1,fptr);\n fread(&amp;input.name, sizeof(input.name),1,fptr);\n fread(&amp;input.camera, sizeof(input.camera),1,fptr);\n fread(&amp;input.attraction, sizeof(input.attraction),1,fptr);\n fread(&amp;input.bottle, sizeof(input.bottle),1,fptr);\n fread(&amp;input.stage, sizeof(input.stage),1,fptr);\n fread(&amp;input.square, sizeof(input.square),1,fptr);\n fread(&amp;input.bushes, sizeof(input.bushes),1,fptr);\n fread(&amp;input.heat, sizeof(input.heat),1,fptr);\n fread(&amp;input.fly, sizeof(input.fly),1,fptr);\n printf(\"%f \", input.business);\n printf(\"%c \", input.jellyfish);\n printf(\"%d \", input.death);\n printf(\"%c, \", input.love);\n printf(\"%d, \", input.ornament);\n printf(\"%f, \", input.taste);\n printf(\"%ld, \", input.cloth);\n printf(\"%d, \", input.name);\n printf(\"%d, \", input.camera);\n printf(\"%d, \", input.attraction);\n printf(\"%d, \", input.bottle);\n printf(\"%u, \", input.stage);\n printf(\"%f, \", input.square);\n printf(\"%d, \", input.bushes);\n printf(\"%s, \", input.heat);`\n printf(\"%d \\n\", input.fly);\n</code></pre>\n"}, {"tags": ["c", "xcode10"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566898565, "post_id": 57671660, "comment_id": 101790750, "body": "For professional use, you should rather copy/paste the source header required by your internal coding standard, instead of some auto-generated goo. Proper source documentation matters a lot."}, {"owner": {"reputation": 1, "user_id": 11982361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAiP1p70hBgfix94G7vQM0Prz9fvf5YeQJc38qxdw=k-s128", "display_name": "Nevo Raz", "link": "https://stackoverflow.com/users/11982361/nevo-raz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566898855, "post_id": 57671660, "comment_id": 101790907, "body": "I actually need for commenting in the code itself, do describe functions for example."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566899018, "post_id": 57671660, "comment_id": 101790997, "body": "In a professional project, you would have templates for function documentation as well."}, {"owner": {"reputation": 1, "user_id": 11982361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAiP1p70hBgfix94G7vQM0Prz9fvf5YeQJc38qxdw=k-s128", "display_name": "Nevo Raz", "link": "https://stackoverflow.com/users/11982361/nevo-raz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1566911948, "post_id": 57671660, "comment_id": 101798249, "body": "when coding it helps to comment and uncomment parts of the code"}], "answers": [{"tags": [], "owner": {"reputation": 17, "user_id": 15095129, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gg2cH0a_C1OxmJaQuFDWt7X3LFN07lIucOtKJkB=k-s128", "display_name": "Vehement_Py", "link": "https://stackoverflow.com/users/15095129/vehement-py"}, "is_accepted": false, "score": 0, "last_activity_date": 1612978477, "last_edit_date": 1612978477, "creation_date": 1612968925, "answer_id": 66139311, "question_id": 57671660, "link": "https://stackoverflow.com/questions/57671660/xcode-10-on-macbook-how-to-comment-with-keyboard-shortcut/66139311#66139311", "title": "Xcode 10 on macbook- How to comment /* */ with keyboard shortcut?", "body": "<p>Select the block of code you want to comment and press <code>CTRL + Shift + /</code> for Windows or <code>Control + Shift + /</code> for Macintosh.</p>\n<p>For uncommenting, use <code>CTRL + Shift + \\</code> for Windows, or <code>Control + Shift + \\</code> for Macintosh.</p>\n"}], "owner": {"reputation": 1, "user_id": 11982361, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAiP1p70hBgfix94G7vQM0Prz9fvf5YeQJc38qxdw=k-s128", "display_name": "Nevo Raz", "link": "https://stackoverflow.com/users/11982361/nevo-raz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612978477, "creation_date": 1566898260, "question_id": 57671660, "link": "https://stackoverflow.com/questions/57671660/xcode-10-on-macbook-how-to-comment-with-keyboard-shortcut", "title": "Xcode 10 on macbook- How to comment /* */ with keyboard shortcut?", "body": "<p>I'm using Xcode 10 on macbook for writing C program. How can I make a block of comment with keyboard shotcut like this example:</p>\n\n<pre><code>/*\n * class.c\n *\n *  Created on: Jul 30, 2019\n *      Author: abbn\n */\n</code></pre>\n\n<p>I know how to comment with: cmd + / but it creates comments with // and not /*</p>\n"}, {"tags": ["c", "clang", "abstract-syntax-tree", "volatile"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566904107, "post_id": 57671475, "comment_id": 101793654, "body": "Is that your <i>exact</i> code? Because both would, in normal circumstances, be anonymous structs (i.e. they don&#39;t have a name after <code>struct</code>)."}, {"owner": {"reputation": 478, "user_id": 3164467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/93873cc5cef796dd7664584251130f48?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/3164467/sagi"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566905092, "post_id": 57671475, "comment_id": 101794182, "body": "This is an example taken from a real code. As I understand, and it is as you mentioned, I thought that both structs are anonymous, but as we can see in the AST dump from clang only the &#39;new_struct_t_1&#39; which is also defined as volatile is marked as anonymous."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566905179, "post_id": 57671475, "comment_id": 101794234, "body": "Does it happen if you remove <code>volatile</code>?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1566909856, "post_id": 57671475, "comment_id": 101796960, "body": "At a guess, the simple typedef doesn&#39;t need any entry, because it can use the typedef namer as a fully descriptive &quot;sugar&quot; entry, and this is common C parlance, while the volatile needs a root entry from which to hang the &quot;volatile&quot; qualifier. It would be strange to attach the volatile tag to the named typedef."}, {"owner": {"reputation": 478, "user_id": 3164467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/93873cc5cef796dd7664584251130f48?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/3164467/sagi"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566911393, "post_id": 57671475, "comment_id": 101797904, "body": "@JL2210, the reason I&#39;ve put the 2 structures is to show that without volatile AST dump does not add the anonymous tag while having it, AST dump prints anonymous"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566917424, "post_id": 57671475, "comment_id": 101801505, "body": "@sagi I know, but it may have to do with the two structures being sequential."}, {"owner": {"reputation": 478, "user_id": 3164467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/93873cc5cef796dd7664584251130f48?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/3164467/sagi"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1566920026, "post_id": 57671475, "comment_id": 101802986, "body": "@JL2210 I&#39;ve split the structs into 2 different files and got the same result"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1566920223, "post_id": 57671475, "comment_id": 101803081, "body": "I don&#39;t know, then. File a bug and see what the maintainers respond with."}], "owner": {"reputation": 478, "user_id": 3164467, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/93873cc5cef796dd7664584251130f48?s=128&d=identicon&r=PG&f=1", "display_name": "sagi", "link": "https://stackoverflow.com/users/3164467/sagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1566905253, "creation_date": 1566897663, "last_edit_date": 1566905253, "question_id": 57671475, "link": "https://stackoverflow.com/questions/57671475/typedef-volatile-struct-is-recognized-as-anonymous-in-clang-ast", "title": "typedef volatile struct is recognized as anonymous in clang ast", "body": "<p>I have the following C code:</p>\n\n<pre><code>typedef volatile struct\n{\n   unsigned short   field1;    \n   unsigned int     field2;        \n} new_struct_t_1;\n\ntypedef struct\n{\n   unsigned short   field1;    \n   unsigned int     field2;        \n} new_struct_t_2;\n</code></pre>\n\n<p>When running clang to generate AST dump for this code I get that the struct with the qualifier <code>volatile</code> is anonymous while the one without is not marked as anonymous.</p>\n\n<p>I'm running the following command:</p>\n\n<pre><code>clang-8 -Xclang -ast-dump -fsyntax-only /tmp/2.c\n</code></pre>\n\n<p>and the result is:</p>\n\n<pre><code>|-RecordDecl 0x401c6e8 &lt;/tmp/2.c:1:18, line:5:1&gt; line:1:18 struct definition\n| |-FieldDecl 0x40794d0 &lt;line:3:4, col:21&gt; col:21 field1 'unsigned short'\n| `-FieldDecl 0x4079530 &lt;line:4:4, col:21&gt; col:21 field2 'unsigned int'\n|-TypedefDecl 0x40795d8 &lt;line:1:1, line:5:3&gt; col:3 new_struct_t_1 'volatile struct (anonymous struct at /tmp/2.c:1:18)':'volatile struct (anonymous at /tmp/2.c:1:18)'\n| `-QualType 0x4079584 'volatile struct (anonymous struct at /tmp/2.c:1:18)' volatile\n|   `-ElaboratedType 0x4079580 'struct (anonymous struct at /tmp/2.c:1:18)' sugar\n|     `-RecordType 0x401c760 'struct (anonymous at /tmp/2.c:1:18)'\n|       `-Record 0x401c6e8 ''\n|-RecordDecl 0x4079640 &lt;line:7:9, line:11:1&gt; line:7:9 struct definition\n| |-FieldDecl 0x40796f8 &lt;line:9:4, col:21&gt; col:21 field1 'unsigned short'\n| `-FieldDecl 0x4079758 &lt;line:10:4, col:21&gt; col:21 field2 'unsigned int'\n`-TypedefDecl 0x40797f8 &lt;line:7:1, line:11:3&gt; col:3 new_struct_t_2 'struct new_struct_t_2':'new_struct_t_2'\n  `-ElaboratedType 0x40797a0 'struct new_struct_t_2' sugar\n    `-RecordType 0x40796c0 'new_struct_t_2'\n      `-Record 0x4079640 ''\n</code></pre>\n\n<p>Does anyone can explain why the addition of the qualifier <code>volatile</code> causes the AST to recognize this struct as anonymous?</p>\n"}, {"tags": ["c", "misra", "pc-lint"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1566897775, "post_id": 57671422, "comment_id": 101790315, "body": "Simply read rule 20.5, it&#39;s self-explanatory."}, {"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 2, "creation_date": 1566897794, "post_id": 57671422, "comment_id": 101790323, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/11665031/why-do-the-misra-rules-prohibit-the-use-of-undef\">Why do the MISRA rules prohibit the use of &#39;#undef&#39;?</a>"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1566897898, "post_id": 57671422, "comment_id": 101790394, "body": "@P.W Nah that post is outdated since MISRA-C:2012 had not been released. The rule about <code>#undef</code> was relaxed in 2012."}, {"owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "edited": false, "score": 0, "creation_date": 1566899486, "post_id": 57671422, "comment_id": 101791256, "body": "related question - <a href=\"https://stackoverflow.com/questions/47769783/misra-c-2012-rule-20-5-undef-should-not-be-used\" title=\"misra c 2012 rule 20 5 undef should not be used\">stackoverflow.com/questions/47769783/&hellip;</a>"}, {"owner": {"reputation": 366, "user_id": 2902091, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ec3df205ffc08b775f9ec7987e8676?s=128&d=identicon&r=PG&f=1", "display_name": "Lars Ljung", "link": "https://stackoverflow.com/users/2902091/lars-ljung"}, "edited": false, "score": 0, "creation_date": 1566925160, "post_id": 57671422, "comment_id": 101805268, "body": "Use int ssCmd = com[2]; instead, and enclose the whole thing in {} to limit the scope of the variable."}], "answers": [{"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1567431101, "last_edit_date": 1567431101, "creation_date": 1567061370, "answer_id": 57704527, "question_id": 57671422, "link": "https://stackoverflow.com/questions/57671422/use-of-undef-is-discouraged-sscmd-misra-2012-rule-20-5-advisory/57704527#57704527", "title": "use of &#39;#undef&#39; is discouraged: &#39;ssCmd&#39; [MISRA 2012 Rule 20.5, advisory]", "body": "<p>Yes, MISRA Rule 20.5 says that <code>#undef</code> should not be used. It's an advisory rule. </p>\n\n<p><code>#undef</code> should not normally be needed. Its use can lead to confusion with respect to the existence or meaning of a macro when it is used in the code.</p>\n"}], "owner": {"reputation": 1567, "user_id": 555911, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/531a798e41fe010eac238329693a916d?s=128&d=identicon&r=PG", "display_name": "kapilddit", "link": "https://stackoverflow.com/users/555911/kapilddit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 57704527, "answer_count": 1, "score": 1, "last_activity_date": 1567431101, "creation_date": 1566897513, "last_edit_date": 1566897817, "question_id": 57671422, "link": "https://stackoverflow.com/questions/57671422/use-of-undef-is-discouraged-sscmd-misra-2012-rule-20-5-advisory", "title": "use of &#39;#undef&#39; is discouraged: &#39;ssCmd&#39; [MISRA 2012 Rule 20.5, advisory]", "body": "<p>I am defining some macro - <code>#define</code> temporary inside code, which I have <code>#undef</code> after being used. </p>\n\n<p>Is it not allowed to <code>#undef</code> MACRO? </p>\n\n<pre><code>void c_cmd(unsinged char *com)\n{ \n\nint abc = com[0];\nint res = 0;\n\nswitch(abc)\n{\n    case 1:\n             #define ssCmd                 com[2]  /* SRT or STP*/\n             res = abc + ssCmd;     \n             /* part of some functionality */          \n\n             #undef ssCmd \n             break;\n\n    default:\n             break;\n\n}\n\n}\n</code></pre>\n\n<p>Observed warning:</p>\n\n<blockquote>\n  <p>use of '#undef' is discouraged: 'ssCmd' [MISRA 2012 Rule 20.5,\n  advisory]</p>\n</blockquote>\n"}, {"tags": ["c", "xcode", "process", "fork", "wait"], "comments": [{"owner": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897432, "post_id": 57671327, "comment_id": 101790116, "body": "i&#39;ve just tested your code and it works"}, {"owner": {"reputation": 19, "user_id": 10843760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a4eb8465fa6d408a8d87042da9479d?s=128&d=identicon&r=PG&f=1", "display_name": "Osmion", "link": "https://stackoverflow.com/users/10843760/osmion"}, "reply_to_user": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897661, "post_id": 57671327, "comment_id": 101790231, "body": "not to me, and i really don&#39;t know why"}, {"owner": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897682, "post_id": 57671327, "comment_id": 101790244, "body": "how are you compiling your code?"}, {"owner": {"reputation": 19, "user_id": 10843760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a4eb8465fa6d408a8d87042da9479d?s=128&d=identicon&r=PG&f=1", "display_name": "Osmion", "link": "https://stackoverflow.com/users/10843760/osmion"}, "reply_to_user": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897740, "post_id": 57671327, "comment_id": 101790281, "body": "XCode, run button. Do you think i should use gcc command?"}, {"owner": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897781, "post_id": 57671327, "comment_id": 101790317, "body": "yes, try this: gcc yourfile.c -o test"}, {"owner": {"reputation": 19, "user_id": 10843760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a4eb8465fa6d408a8d87042da9479d?s=128&d=identicon&r=PG&f=1", "display_name": "Osmion", "link": "https://stackoverflow.com/users/10843760/osmion"}, "reply_to_user": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566897965, "post_id": 57671327, "comment_id": 101790440, "body": "and it works... But why?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1566897990, "post_id": 57671327, "comment_id": 101790447, "body": "You might be missing the necessary includes for <code>wait</code>!"}, {"owner": {"reputation": 99, "user_id": 10329726, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rSC4j.png?s=128&g=1", "display_name": "DanielGS", "link": "https://stackoverflow.com/users/10329726/danielgs"}, "edited": false, "score": 0, "creation_date": 1566898008, "post_id": 57671327, "comment_id": 101790459, "body": "try to find how XCode is compiling your code"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 2, "creation_date": 1566898200, "post_id": 57671327, "comment_id": 101790549, "body": "Read the compiler warnings."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566904242, "post_id": 57671327, "comment_id": 101793724, "body": "It works perfectly for me (using clang), and I don&#39;t see anything wrong with it.  I can&#39;t imagine why it&#39;s not working for you under XCode.  I didn&#39;t get any warnings, either -- @klutt, what sort of warnings did you have in mind?"}, {"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "reply_to_user": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1566912398, "post_id": 57671327, "comment_id": 101798530, "body": "@SteveSummit Then it&#39;s something wrong with your compiler. I get <code>warning: implicit declaration of function &#39;wait&#39; is invalid in C99</code>"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "reply_to_user": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566913297, "post_id": 57671327, "comment_id": 101799094, "body": "@klutt Ah. Got it.  (Compiler is fine, though.  Perhaps it&#39;s something &quot;wrong&quot; with my copy of <code>&lt;unistd.h&gt;</code>, then.)"}], "answers": [{"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1566927023, "creation_date": 1566927023, "answer_id": 57679644, "question_id": 57671327, "link": "https://stackoverflow.com/questions/57671327/why-does-wait-function-always-return-1/57679644#57679644", "title": "Why does &#39;wait&#39; function always return -1?", "body": "<p>the header file: <code>unistd.h</code> does NOT contain the prototype for <code>wait()</code>.  </p>\n\n<p>That prototype is exposed via the header file combination: </p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;`\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10843760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a4eb8465fa6d408a8d87042da9479d?s=128&d=identicon&r=PG&f=1", "display_name": "Osmion", "link": "https://stackoverflow.com/users/10843760/osmion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 428, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1566927023, "creation_date": 1566897205, "last_edit_date": 1566902768, "question_id": 57671327, "link": "https://stackoverflow.com/questions/57671327/why-does-wait-function-always-return-1", "title": "Why does &#39;wait&#39; function always return -1?", "body": "<p>I can't understand why the function wait always return -1 intead of the child process pid</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\nint main (void) {\n    pid_t pid;\n    int status;\n    pid = fork ();\n    if (pid &lt; 0) {\n        perror(\"fork\");\n        exit(2);\n    }\n    if ( pid == 0 ) {\n        printf (\"I am the child\\n\");\n        exit(0);\n    }\n    else if(pid &gt; 0){\n        printf (\"I am the parent, i'll wait\\n\");\n        pid = wait(&amp;status);\n        printf (\"I waited the child: %d\\n\"\n                , pid);\n    }\n\n    exit(0);\n}\n</code></pre>\n\n<p>EXPECTED \"I waited the child: 1234\"\nACTUAL \"I waited the child: -1\"</p>\n"}, {"tags": ["c", "type-conversion", "undefined-behavior", "implicit-conversion", "integer-promotion"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 0, "creation_date": 1566898040, "post_id": 57670902, "comment_id": 101790476, "body": "Use <code>-Wall</code> and <code>-Wextra</code> when you compile"}], "answers": [{"comments": [{"owner": {"reputation": 225, "user_id": 11459841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb666bb5d0845d7bf806ca186164351?s=128&d=identicon&r=PG&f=1", "display_name": "thatmarkdude", "link": "https://stackoverflow.com/users/11459841/thatmarkdude"}, "edited": false, "score": 2, "creation_date": 1566896133, "post_id": 57670945, "comment_id": 101789414, "body": "Wow, thank you ! Yes, if I typecast <code>(signed int)a - 1</code> to <code>signed long long int</code>, then I get my expected result."}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1566895864, "creation_date": 1566895864, "answer_id": 57670945, "question_id": 57670902, "link": "https://stackoverflow.com/questions/57670902/question-on-usual-arithmetic-conversions-gcc-compiler/57670945#57670945", "title": "Question on Usual Arithmetic Conversions - GCC Compiler", "body": "<p>It's <em>undefined behaviour</em> due to <code>%lld</code> being the inappropriate format specifier for an <code>int</code> type.</p>\n\n<p>Yes indeed <code>(signed int)a - 1</code> is an <code>int</code> type with value <code>-1</code>, but the <code>printf</code> call is the undefined part.  There's nothing in the C standard to suggest that a conversion to <code>long long</code> occurs.</p>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1566897463, "creation_date": 1566897463, "answer_id": 57671401, "question_id": 57670902, "link": "https://stackoverflow.com/questions/57670902/question-on-usual-arithmetic-conversions-gcc-compiler/57671401#57671401", "title": "Question on Usual Arithmetic Conversions - GCC Compiler", "body": "<blockquote>\n  <p>Within printf statement, value -1 is retained within the conversion to long long int</p>\n</blockquote>\n\n<p>There's no such conversion taking place. <code>printf</code> (family of functions) is dumb and needs a format string that corresponds to the types of the argument list. </p>\n\n<p><code>printf</code> does <em>not</em> work like an ordinary function <code>void f (long long int x)</code>, which would have forced an implicit conversion to the type of the parameter (\"as per assignment\"/\"lvalue conversion\"). This would have given you the expected \"sign extension\".</p>\n\n<p>Notably, there's a another kind of specialized implicit conversion going on here called <em>the default argument promotions</em>, that only applies to variable argument functions and functions with no prototype.</p>\n\n<p>C17 6.5.2.2/6</p>\n\n<blockquote>\n  <p>If the expression that denotes the called function has a type that does not include a\n  prototype, the integer promotions are performed on each argument, and arguments that\n  have type <code>float</code> are promoted to <code>double</code>. These are called the <em>default argument\n  promotions</em>.</p>\n</blockquote>\n\n<p>C17 6.5.2.2/7 regarding variable argument functions:</p>\n\n<blockquote>\n  <p>The ellipsis notation in a function prototype declarator causes argument type conversion to stop after the last declared parameter. The default argument\n  promotions are performed on trailing arguments.</p>\n</blockquote>\n\n<p>In practice this means: </p>\n\n<ul>\n<li><code>float</code> passed to <code>printf</code> gets implicitly converted to <code>double</code> during function call.</li>\n<li>Small integer types passed to <code>printf</code> get implicitly converted during function call as per integer promotions, most likely ending up as <code>int</code>.</li>\n<li>Other types passed to <code>printf</code> do not get implicitly promoted during the function call.</li>\n</ul>\n\n<p>And then the passed and potentially converted argument gets treated internally as if it was the type specified by the conversion specifier. If that one doesn't match the actual type, the code has undefined behavior.</p>\n\n<p>In your case you pass an <code>int</code>, it doesn't get implicitly promoted, but as <code>printf</code> treats it as a <code>long long</code>, you get undefined behavior. </p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 1, "last_activity_date": 1566898620, "creation_date": 1566898620, "answer_id": 57671746, "question_id": 57670902, "link": "https://stackoverflow.com/questions/57670902/question-on-usual-arithmetic-conversions-gcc-compiler/57671746#57671746", "title": "Question on Usual Arithmetic Conversions - GCC Compiler", "body": "<p>Here you can consider yourself lucky. <code>a</code> is a <code>short int</code> that undergoes usual arithmetic conversions to a `signed int', even despite the cast, so </p>\n\n<pre><code>unsigned short int a = 0;\nprintf(\"\\n%d\", (signed int)a - 1);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>unsigned short int a = 0;\nprintf(\"\\n%d\", a - 1);\n</code></pre>\n\n<p>would have the same behaviour, <em>if</em> all values of <code>unsigned short</code> are representable in <code>int</code> (as they are in your case). The result of the conversion is an <code>int</code>. Now, for the variable arguments, the default argument promotions are applied and any integers smaller than an <code>int</code> is converted to <code>int</code> if representable, otherwise <code>unsigned int</code>. But <code>lld</code> expects a <em><code>signed long long int</code></em> which is 8 bytes wide. Default argument promotions do not promote <code>int</code> implicitly to <code>long long int</code>.</p>\n\n<p>Now comes the luck part - you did get a <em>wrong</em> value. See, since the <strong>behaviour is undefined</strong> you could have gotten the value that you're <em>expecting</em>, <em>this time</em> - after all it is completely feasible on a 64-bit processor!</p>\n"}], "owner": {"reputation": 225, "user_id": 11459841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ccb666bb5d0845d7bf806ca186164351?s=128&d=identicon&r=PG&f=1", "display_name": "thatmarkdude", "link": "https://stackoverflow.com/users/11459841/thatmarkdude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 57670945, "answer_count": 3, "score": 2, "last_activity_date": 1566900503, "creation_date": 1566895752, "last_edit_date": 1566900503, "question_id": 57670902, "link": "https://stackoverflow.com/questions/57670902/question-on-usual-arithmetic-conversions-gcc-compiler", "title": "Question on Usual Arithmetic Conversions - GCC Compiler", "body": "<p>I'm trying to understand implicit datatype conversions in C. I thought that I had understood this topic, but yet the following code example is still confusing me. </p>\n\n<p>Specifically, I have read about Usual Arithmetic Conversions and Integer Promotion previously from drafts of the C Standard.</p>\n\n<pre><code>    unsigned short int a = 0;\n    printf(\"\\n%lld\", (signed int)a - 1);\n</code></pre>\n\n<p>I am compiling using GCC.</p>\n\n<p><code>unsigned short int</code> is 2 bytes.\n<code>int</code> is 4 bytes.</p>\n\n<p>When I run this code, I get the following result: <strong><em>4294967295</em></strong></p>\n\n<p>I expected the result <strong><em>-1</em></strong>. </p>\n\n<p>This is what I expected to happen:</p>\n\n<ol>\n<li><p>Typecast takes precedence, and LHS of <code>-</code> becomes <code>signed int</code>.</p></li>\n<li><p><code>-</code> operation is carried out. No integer promotion or implicit conversions occur here, as LHS and RHS are already both <code>signed int</code>. The result of the operation is -1 with datatype <code>signed int</code>.</p></li>\n<li><p>Within <code>printf</code> statement, value -1 is retained within the conversion to <code>long long int</code>, and -1 is displayed as the result.</p></li>\n</ol>\n\n<p>Can someone please explain where the flaw in my logic is?</p>\n"}, {"tags": ["c", "performance", "x86-64", "intel", "avx512"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566897128, "post_id": 57670764, "comment_id": 101789962, "body": "Can you explain in words what your microbenchmark is measuring?  I think inter-thread latency, but you&#39;re pinning to some specific cores?  You&#39;re spinning on a load and branch, it seems, without <code>_mm_pause()</code>?  I guess <code>barrier()</code> is something like <code>asm(&quot;&quot;:::&quot;memory&quot;)</code> but you don&#39;t show a definition."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566897573, "post_id": 57670764, "comment_id": 101790184, "body": "@PeterCordes for this example, I&#39;m trying to measure inter-cpu latency. Even this shows me a proof of slowness, the systems are exactly the same In the real code, I&#39;m using SIMD/AVX512 for math operations as well and in the field working application, there is an incredible difference for the same systems. How can this happen? barrier is asm(&quot;&quot;:::&quot;memory&quot;)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566897951, "post_id": 57670764, "comment_id": 101790432, "body": "Both of those things would be good edits for the question."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566902748, "post_id": 57670764, "comment_id": 101792916, "body": "Ok, <code>_mm_pause()</code> just made both versions about the same amount slower, I think.  That&#39;s good, I guess.  Is the <code>continue;</code> in the reader ever reached?  That skips the <code>pause</code>.  But I think that&#39;s not where it spends most of its time waiting; I didn&#39;t take the time to fully sort out that logic and there are no comments."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566969630, "post_id": 57670764, "comment_id": 101816441, "body": "IMO you should be showing the <i>median</i>, not mean.  Your results all had huge spikes on the first iteration (cold cache, thread startup?) which you shouldn&#39;t be counting.  And occasional other spikes, probably from interrupts or other contention."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566971241, "post_id": 57670764, "comment_id": 101816897, "body": "The code ignores the first iteration, so the mean is ok. I exceeded the maximum character limit, so I had to remove the other parts."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1566971886, "post_id": 57670764, "comment_id": 101817096, "body": "There are still a few spikes like 2540 mixed in with the 430 +- 15 or so numbers in your first output.  I&#39;d print the mean + minimum at least (because that&#39;s easy), and ideally the median. You don&#39;t really need 2 copies of your source code in the question.  You could shortlink to <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> for one of them, or link to a previous revision of your question for the original version.  But I guess it&#39;s basically fine the way it is."}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1566945373, "post_id": 57671472, "comment_id": 101812373, "body": "@PeterCorder The content is true, different cpus have different inter-cpu latency. But still one of the same systems is 25% slower than the other in all case. I updated the question according to your answer."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 1, "creation_date": 1566972279, "post_id": 57671472, "comment_id": 101817232, "body": "@AliVolkanATLI: updated with some ideas.  IDK if the microcode version difference is significant.  Maybe try installing the <code>intel-microcode</code> package in your Linux distro so that both your CPUs get updated to the same latest microcode on each boot.  (You can always remove it again and reboot if it makes your fast CPU slower.  And if you read the release notes and decide there aren&#39;t any critical-for-you CPU bug fixes you&#39;d be missing.  e.g. local side-channel vulnerabilities might not be relevant if you trust all the users with access.)"}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 1, "creation_date": 1566998878, "post_id": 57671472, "comment_id": 101831200, "body": "@PeterCorder, I think, It depends on AVX512 because I don&#39;t see the same effect with scalar loads. The measured values are similar without AVX512."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1566999011, "post_id": 57671472, "comment_id": 101831288, "body": "@AliVolkanATLI - that makes me suspicious of microcode.  Maybe full-cache-line stores can use some special optimization like skipping an RFO.  But maybe microcode disabled that after finding a bug of some sort?  Or maybe full-line stores are affected differently by mesh topology for some reason, so my hypothesis might still be valid."}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1567187742, "post_id": 57671472, "comment_id": 101902791, "body": "you were right, I just updated the slow system&#39;s microcode and now the measured results are almost similar."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1567187868, "post_id": 57671472, "comment_id": 101902824, "body": "@ali oh perfect, I was assuming ucode update would slow down the faster system"}, {"owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "edited": false, "score": 0, "creation_date": 1567187969, "post_id": 57671472, "comment_id": 101902853, "body": "I did not touch the faster system, I updated the slower, they are still not the same but it seems there was a problem in the intermediate version"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 4, "last_activity_date": 1566972173, "last_edit_date": 1566972173, "creation_date": 1566897656, "answer_id": 57671472, "question_id": 57670764, "link": "https://stackoverflow.com/questions/57670764/different-inter-core-latency-measured-on-two-identical-skylake-xeon-gold-6154-sy/57671472#57671472", "title": "Different inter-core latency measured on two identical Skylake Xeon Gold 6154 systems", "body": "<p><strong>My guess</strong>: different <a href=\"https://ark.intel.com/content/www/us/en/ark/products/120495/intel-xeon-gold-6154-processor-24-75m-cache-3-00-ghz.html\" rel=\"nofollow noreferrer\">Xeon Gold 6154</a> chips (18c 36t) have <strong>different cores fused off</strong> for defects, so you have a <strong>different mesh network path</strong> between the two cores you pin to and/or the slice of L3 cache that your cache line ends up being mapped to.  This affects the inter-core latency between those two cores.</p>\n\n<p>According to Wikichip, it's <a href=\"https://en.wikichip.org/wiki/Category:microprocessor_models_by_intel_based_on_skylake_extreme_core_count_die\" rel=\"nofollow noreferrer\">based on the \"Extreme Core Count die\" for SKX</a>, which has 28 physical cores on it, the core count of the <a href=\"https://en.wikichip.org/wiki/intel/xeon_platinum/8176\" rel=\"nofollow noreferrer\">Xeon Platinum 8176</a> based on the same die.</p>\n\n<p>So 10 cores are disabled on your die, but possibly a different 10.  This can mean some of the cores are more hops away from each other (maybe)?  And/or it could mean cores are enumerated in a different order so same hard-coded core numbers mean different mesh locations.</p>\n\n<p><a href=\"https://en.wikichip.org/wiki/intel/mesh_interconnect_architecture\" rel=\"nofollow noreferrer\">https://en.wikichip.org/wiki/intel/mesh_interconnect_architecture</a></p>\n\n<hr>\n\n<p><strong>Your update shows new data from all pairs of cores.</strong>  It seems one CPU is slower for most but not all pairs.  (Although I don't fully trust that data if you're using the mean without discarding outliers.)  That's still plausibly explained by a different mesh layout, possibly with significantly worse distances between most cores.</p>\n\n<p>It's a 2D mesh presumably mirroring the physical layout of the cores.  Maybe the fast CPU mostly has cores around the outside disabled so the active ones are fairly densely packed into a smaller grid.  But maybe the slower one had defects in more \"interior\" cores in the grid.</p>\n\n<blockquote>\n  <p>I just realized that the slow CPU has extra <code>md_clear</code> CPU feature flag.</p>\n</blockquote>\n\n<p>According to <a href=\"https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling\" rel=\"nofollow noreferrer\">https://software.intel.com/security-software-guidance/insights/deep-dive-intel-analysis-microarchitectural-data-sampling</a>, the <code>md_clear</code> flag indicates microcode support for workarounds for L1TF / microarchitectural data sampling via the <code>verw</code> instruction, etc.</p>\n\n<p>Perhaps the newer microcode version also has an another change that hurts performance in this microbenchmark (and maybe overall).  Or maybe that's a coincidence.</p>\n\n<p>More data from more Xeon Gold CPUs with older vs. newer microcode might shed some light.  If we still see this much variation between CPUs even with identical microcode, that would support my hypothesis that it's a consequence of which physical cores are fused off to sell as 28-core die as an 18-working-core CPU.</p>\n\n<p>Also testing on a Xeon based on a smaller die, like the 14-core HCC die with all 14 cores enabled, might show better worst-case-pair inter-core latency.  Might need to control for different RDTSC vs turbo vs uncore frequencies, unless the mesh clock scales with reference core clock.</p>\n\n<hr>\n\n<p><strong>That explanation doesn't depend on AVX512 at all.  Do you see the same effect with scalar loads or not?</strong></p>\n\n<p><s>Also, possibly a small timing difference happens to have a worse effect on one than the other without <code>_mm_pause</code>; maybe one core is seeing a pipeline nuke (<code>machine_clears.memory_ordering</code> perf event) and the other isn't?</s></p>\n\n<p>Your update with <code>_mm_pause()</code> mostly rules out amplifying a small difference in true latency.  Whatever the cause is, the difference does seem to be that big.</p>\n\n<hr>\n\n<p>Your CPU is new enough that it's safe to assume that the TSC is synced between cores, and presumably that both are already running at max turbo.  (One of the named CPU features, <code>constant_tsc</code> or <code>invariant_tsc</code> explicitly guarantees that, but I forget which one.  The other one means it ticks at a fixed reference frequency regardless of the core clock frequency.  <code>nonstop_tsc</code> means it doesn't stop when the core is asleep.)</p>\n\n<p>(TL:DR: I think your microbenchmark looks sane, and you are measuring inter-core latency in a reasonable way, without huge measurement error.)</p>\n\n<hr>\n\n<blockquote>\n  <p>What should I do to solve this problem?</p>\n</blockquote>\n\n<p>You can't.</p>\n\n<p>If low inter-core latency is critical for one application, try a few different CPUs until you find one with lower latencies than average.</p>\n\n<p>Run other applications on the Xeons with worse latency.</p>\n\n<p>Or if my hypothesis is right, maybe get a 14-core Xeon Gold based on the High Core Count die.  With all 14 cores enabled, that should be best case.  But those Xeons only have 1 AVX512 FMA unit.</p>\n\n<blockquote>\n  <p>Which tool can help?</p>\n</blockquote>\n\n<p>If there are only a few threads that need tight coupling, find a cluster of physical cores that have the lowest latency from each other on the CPU you have.  Pin the most latency-sensitive threads to those cores.</p>\n\n<p>If that works for your application, <strong>maybe consider a Zen or Zen2 microarchitecture based on CCX units of 4 physical cores with low latency inside that cluster</strong>, but significantly worse latency across clusters.  AMD does have some many-core chips, but only Zen2 has full 256-bit SIMD width in its load/store and execution units.  (It still doesn't do AVX512, but if your application can make heavy use of SIMD then at least full-speed AVX2+FMA is probably what you want).</p>\n\n<blockquote>\n  <p>How can I understand the performance difference?</p>\n</blockquote>\n\n<p>If my hypothesis is correct, it's an intrinsic property of the CPU as manufactured and sold.  Intel designs a die with <code>n</code> physical cores.  If manufacturing defects ruin some of those cores, they can still sell it as a lower core-count SKU.  (They burn away a physical fuse so the disabled core doesn't waste power).  Presumably its mesh node still has to work, unless they can short-circuit past a whole node to tighten up the mesh?</p>\n\n<p>When yields are above demand for the highest core-count SKUs at the price-point they want to sell at, they will disable some working cores as well as defective cores on a chip.  But this is usually physical with a laser fuse, not just firmware like in old GPUs where you could sometimes just hack the firmware to activate the disabled cores.  So there's nothing you can actually do about it.</p>\n\n<p>Buying a chip with all cores on die enabled (e.g. 28 cores for the \"Extreme\" core count Xeons) would mean no fused-off cores.  That might give us some interesting test data as far as worst-case pair for inter-core latency.</p>\n\n<p><strong>A lower core-count die with all the cores enabled might also be interesting.</strong>  The <a href=\"https://en.wikichip.org/wiki/Category:microprocessor_models_by_intel_based_on_skylake_high_core_count_die\" rel=\"nofollow noreferrer\">https://en.wikichip.org/wiki/Category:microprocessor_models_by_intel_based_on_skylake_high_core_count_die</a> page shows the \"high\" core count (HCC) SKX die has 14 cores (half the ECC die).  The top model using that die is <a href=\"https://en.wikichip.org/wiki/intel/xeon_gold/5120\" rel=\"nofollow noreferrer\">Xeon Gold 5120</a>, a 14c/28t model.  (With 1x 512-bit FMA unit per core, not 2).  <a href=\"https://ark.intel.com/content/www/us/en/ark/products/120474/intel-xeon-gold-5120-processor-19-25m-cache-2-20-ghz.html\" rel=\"nofollow noreferrer\">Intel Ark confirms</a>.</p>\n\n<p>I wouldn't be surprised if the HCC die only has 1 FMA unit per core, unlike the ECC die which includes the extra port-5 512-bit FMA unit.  That would save die area for all the mid-range SKUs Intel sells, and having a 2nd FMA unit only helps for AVX512 code.  A lot of code doesn't make any use of AVX512.  (AVX2 and AVX512 256-bit FMA throughput is still 2/clock on port 0 / port 1 on those CPUs.)</p>\n"}], "owner": {"reputation": 522, "user_id": 2079418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5f71ffcff2882c688d067a128c31c0?s=128&d=identicon&r=PG", "display_name": "avatli", "link": "https://stackoverflow.com/users/2079418/avatli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 57671472, "answer_count": 1, "score": 4, "last_activity_date": 1566984456, "creation_date": 1566895211, "last_edit_date": 1566984456, "question_id": 57670764, "link": "https://stackoverflow.com/questions/57670764/different-inter-core-latency-measured-on-two-identical-skylake-xeon-gold-6154-sy", "title": "Different inter-core latency measured on two identical Skylake Xeon Gold 6154 systems", "body": "<p>We have been using two same Skylake servers with completely the same softwares, Centos 7 OS and BIOS settings. Everything is the same, except the latency performance. Our software is using AVX512. </p>\n\n<p>In tests, I noticed that AVX512 slows down performance (increasing latency) in the one of the systems each time. There is a significant performance difference. I checked everything, all are the same. </p>\n\n<p>What should I do to solve this problem? Which tool can help?</p>\n\n<p>Thanks in advance..</p>\n\n<pre><code>sudo lshw -class cpu\n  *-cpu:0                   \n       description: CPU\n       product: Intel(R) Xeon(R) Gold 6154 CPU @ 3.00GHz\n       vendor: Intel Corp.\n       vendor_id: GenuineIntel\n       physical id: 400\n       bus info: cpu@0\n       version: Intel(R) Xeon(R) Gold 6154 CPU @ 3.00GHz\n       slot: CPU1\n       size: 3GHz\n       capacity: 4GHz\n       width: 64 bits\n       clock: 1010MHz\n       capabilities: lm fpu fpu_exception wp vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp x86-64 constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 intel_ppin intel_pt ssbd mba ibrs ibpb stibp tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts pku ospke md_clear spec_ctrl intel_stibp flush_l1d\n       configuration: cores=18 enabledcores=18 threads=18\n  *-cpu:1 DISABLED\n       description: CPU [empty]\n       physical id: 401\n       slot: CPU2\n</code></pre>\n\n<p><strong>Update:</strong> After Peter's comment(s), I added the following sample code as an example.</p>\n\n<pre><code>#include &lt;emmintrin.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;immintrin.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CACHE_LINE_SIZE             64\n\n/**\n * Copy 64 bytes from one location to another,\n * locations should not overlap.\n */\nstatic inline __attribute__((always_inline)) void\nmov64(uint8_t *dst, const uint8_t *src)\n{\n        __m512i zmm0;\n\n        zmm0 = _mm512_load_si512((const void *)src);\n        _mm512_store_si512((void *)dst, zmm0);\n}\n\n#define likely(x)    __builtin_expect((x), 1)\n#define unlikely(x)  __builtin_expect((x), 0)\n\nstatic inline uint64_t rdtsc(void)\n{\n    union {\n        uint64_t tsc_64;\n        __extension__\n        struct {\n            uint32_t lo_32;\n            uint32_t hi_32;\n        };\n    } tsc;\n\n    __asm__ volatile(\"rdtsc\" :\n            \"=a\" (tsc.lo_32),\n            \"=d\" (tsc.hi_32));\n    return tsc.tsc_64;\n}\nunion levels {\n    __m512i zmm0;\n    struct {\n        uint32_t x1;\n        uint64_t x2;\n        uint64_t x3;\n        uint32_t x4;\n        uint32_t x5;\n        uint32_t x6;\n        uint32_t x7;\n    };\n} __attribute__((aligned(CACHE_LINE_SIZE)));\n\nunion levels g_shared;\n\nvoid *worker_loop(void *param)\n{\n    cpu_set_t cpuset;\n    CPU_ZERO(&amp;cpuset);\n    CPU_SET(16, &amp;cpuset);\n\n    pthread_t thread = pthread_self();\n\n    pthread_setaffinity_np(thread, sizeof(cpu_set_t), &amp;cpuset);\n\n    union levels lshared;\n    uint32_t old_x1 = 0;\n    lshared.x1 = 0;\n    while (1) {\n        __asm__ (\"\" ::: \"memory\");\n\n        lshared.zmm0 = _mm512_load_si512((const void *)&amp;g_shared);\n\n        if (unlikely(lshared.x1 &lt;= old_x1)) {\n            continue;\n        } else if (unlikely(lshared.x1 != lshared.x7)) {\n            // printf(\"%u %u %u %u %u %u\\n\", lshared.x1, lshared.x3, lshared.x4, lshared.x5, lshared.x6, lshared.x7);\n            exit(EXIT_FAILURE);\n        } else {\n            uint64_t val = rdtsc();\n            if (val &gt; lshared.x2) {\n                printf(\"&gt; (%u) %lu - %lu = %lu\\n\", lshared.x1, val, lshared.x2, val - lshared.x2);\n            } else {\n                printf(\"&lt; (%u) %lu - %lu = %lu\\n\", lshared.x1, lshared.x2, val, lshared.x2 - val);\n            }\n        }\n        old_x1 = lshared.x1;\n\n        _mm_pause();\n    }\n\n    return NULL;\n}\n\nint main(int argc, char *argv[])\n{\n    cpu_set_t cpuset;\n    CPU_ZERO(&amp;cpuset);\n    CPU_SET(15, &amp;cpuset);\n\n    pthread_t thread = pthread_self();\n\n    memset(&amp;g_shared, 0, sizeof(g_shared));\n\n    pthread_setaffinity_np(thread, sizeof(cpu_set_t), &amp;cpuset);\n\n    pthread_t worker;\n    pthread_create(&amp;worker, NULL, worker_loop, NULL);\n\n    uint32_t val = 1;\n    union levels lshared;\n\n    while (1) {\n        lshared.x1 = val;\n        lshared.x2 = rdtsc();\n        lshared.x3 = val;\n        lshared.x4 = val;\n        lshared.x5 = val;\n        lshared.x6 = val;\n        lshared.x7 = val;\n        _mm512_store_si512((void *)&amp;g_shared, lshared.zmm0);\n        __asm__ (\"\" ::: \"memory\");\n\n        usleep(100000);\n\n        val++;\n\n        _mm_pause();\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>The slower system's output:</p>\n\n<pre><code>&gt; (1) 4582365777844442 - 4582365777792564 = 51878\n&gt; (2) 4582366077239290 - 4582366077238806 = 484\n&gt; (3) 4582366376674782 - 4582366376674346 = 436\n&gt; (4) 4582366676044526 - 4582366676041890 = 2636\n&gt; (5) 4582366975470562 - 4582366975470134 = 428\n&gt; (6) 4582367274899258 - 4582367274898828 = 430\n&gt; (7) 4582367574328446 - 4582367574328022 = 424\n&gt; (8) 4582367873757956 - 4582367873757532 = 424\n&gt; (9) 4582368173187886 - 4582368173187466 = 420\n&gt; (10) 4582368472618418 - 4582368472617958 = 460\n&gt; (11) 4582368772049720 - 4582368772049236 = 484\n&gt; (12) 4582369071481018 - 4582369071480594 = 424\n&gt; (13) 4582369370912760 - 4582369370912284 = 476\n&gt; (14) 4582369670344890 - 4582369670344212 = 678\n&gt; (15) 4582369969776826 - 4582369969776400 = 426\n&gt; (16) 4582370269209462 - 4582370269209024 = 438\n&gt; (17) 4582370568642626 - 4582370568642172 = 454\n&gt; (18) 4582370868076202 - 4582370868075764 = 438\n&gt; (19) 4582371167510016 - 4582371167509594 = 422\n&gt; (20) 4582371466944326 - 4582371466943892 = 434\n&gt; (21) 4582371766379206 - 4582371766378734 = 472\n&gt; (22) 4582372065814804 - 4582372065814344 = 460\n&gt; (23) 4582372365225608 - 4582372365223068 = 2540\n&gt; (24) 4582372664652112 - 4582372664651668 = 444\n&gt; (25) 4582372964080746 - 4582372964080314 = 432\n&gt; (26) 4582373263510732 - 4582373263510308 = 424\n&gt; (27) 4582373562940116 - 4582373562939676 = 440\n&gt; (28) 4582373862370284 - 4582373862369860 = 424\n&gt; (29) 4582374161800632 - 4582374161800182 = 450\n</code></pre>\n\n<p>The faster system's output:</p>\n\n<pre><code>&gt; (1) 9222001841102298 - 9222001841045386 = 56912\n&gt; (2) 9222002140513228 - 9222002140512908 = 320\n&gt; (3) 9222002439970702 - 9222002439970330 = 372\n&gt; (4) 9222002739428448 - 9222002739428114 = 334\n&gt; (5) 9222003038886492 - 9222003038886152 = 340\n&gt; (6) 9222003338344884 - 9222003338344516 = 368\n&gt; (7) 9222003637803702 - 9222003637803332 = 370\n&gt; (8) 9222003937262776 - 9222003937262404 = 372\n&gt; (9) 9222004236649320 - 9222004236648932 = 388\n&gt; (10) 9222004536101876 - 9222004536101510 = 366\n&gt; (11) 9222004835554776 - 9222004835554378 = 398\n&gt; (12) 9222005135008064 - 9222005135007686 = 378\n&gt; (13) 9222005434461868 - 9222005434461526 = 342\n&gt; (14) 9222005733916416 - 9222005733916026 = 390\n&gt; (15) 9222006033370968 - 9222006033370640 = 328\n&gt; (16) 9222006332825872 - 9222006332825484 = 388\n&gt; (17) 9222006632280956 - 9222006632280570 = 386\n&gt; (18) 9222006931736548 - 9222006931736178 = 370\n&gt; (19) 9222007231192376 - 9222007231191986 = 390\n&gt; (20) 9222007530648868 - 9222007530648486 = 382\n&gt; (21) 9222007830105642 - 9222007830105270 = 372\n&gt; (22) 9222008129562750 - 9222008129562382 = 368\n&gt; (23) 9222008429020310 - 9222008429019944 = 366\n&gt; (24) 9222008728478336 - 9222008728477970 = 366\n&gt; (25) 9222009027936696 - 9222009027936298 = 398\n&gt; (26) 9222009327395716 - 9222009327395342 = 374\n&gt; (27) 9222009626854876 - 9222009626854506 = 370\n&gt; (28) 9222009926282324 - 9222009926281936 = 388\n&gt; (29) 9222010225734832 - 9222010225734442 = 390\n&gt; (30) 9222010525187748 - 9222010525187366 = 382\n</code></pre>\n\n<p><strong>Update 2:</strong> After Peter's answer, I added the following sample code as an example to measure latency for different mesh network paths on the same die, and the answer's content is true, different cpus have different inter-cpu latency. But still one of the same systems is 25% slower than the other in all case. </p>\n\n<p>Also I don't know if it will affect it, but I just realized that the slow CPU has extra <strong>md_clear</strong> flag. </p>\n\n<p>In conclusion, What should I do to solve this problem? Which tool can help? How can I understand the performance difference?</p>\n\n<pre><code>#include &lt;emmintrin.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;immintrin.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CACHE_LINE_SIZE             64\n\n/**\n * Copy 64 bytes from one location to another,\n * locations should not overlap.\n */\nstatic inline __attribute__((always_inline)) void\nmov64(uint8_t *dst, const uint8_t *src)\n{\n        __m512i zmm0;\n\n        zmm0 = _mm512_load_si512((const void *)src);\n        _mm512_store_si512((void *)dst, zmm0);\n}\n\n#define likely(x)    __builtin_expect((x), 1)\n#define unlikely(x)  __builtin_expect((x), 0)\n\nstatic inline uint64_t rdtsc(void)\n{\n    union {\n        uint64_t tsc_64;\n        __extension__\n        struct {\n            uint32_t lo_32;\n            uint32_t hi_32;\n        };\n    } tsc;\n\n    __asm__ volatile(\"rdtsc\" :\n            \"=a\" (tsc.lo_32),\n            \"=d\" (tsc.hi_32));\n    return tsc.tsc_64;\n}\nunion levels {\n    __m512i zmm0;\n    struct {\n        uint32_t x1;\n        uint64_t x2;\n        uint64_t x3;\n        uint32_t x4;\n        uint32_t x5;\n        uint32_t x6;\n        uint32_t x7;\n    };\n} __attribute__((aligned(CACHE_LINE_SIZE)));\n\nunion levels g_shared;\n\nuint32_t g_main_cpu;\nuint32_t g_worker_cpu;\n\nvoid *worker_loop(void *param)\n{\n    _mm_mfence();\n\n    cpu_set_t cpuset;\n    CPU_ZERO(&amp;cpuset);\n    CPU_SET(g_worker_cpu, &amp;cpuset);\n\n    pthread_t thread = pthread_self();\n\n    pthread_setaffinity_np(thread, sizeof(cpu_set_t), &amp;cpuset);\n\n    union levels lshared;\n    uint32_t old_x1 = 1;\n\n    uint64_t min = 10000, max = 0, sum = 0;\n\n    int i = 0;\n    while (i &lt; 300) {\n        __asm__ (\"\" ::: \"memory\");\n        lshared.zmm0 = _mm512_load_si512((const void *)&amp;g_shared);\n\n        if (unlikely(lshared.x1 &lt;= old_x1)) {\n            continue;\n        } else if (unlikely(lshared.x1 != lshared.x7)) {\n            exit(EXIT_FAILURE);\n        } else {\n            uint64_t val = rdtsc();\n            uint64_t diff = val - lshared.x2;\n            sum += diff;\n            if (min &gt; diff)\n                min = diff;\n\n            if (diff &gt; max)\n                max = diff;\n\n            i++;\n        }\n        old_x1 = lshared.x1;\n\n        _mm_pause();\n    }\n\n    printf(\"(M=%u-W=%u) min=%lu max=%lu mean=%lu\\n\", g_main_cpu, g_worker_cpu, min, max, sum / 300);\n\n    return NULL;\n}\n\nint main(int argc, char *argv[])\n{\n    for (int main_cpu = 2; main_cpu &lt;= 17; ++main_cpu) {\n        for (int worker_cpu = 2; worker_cpu &lt;= 17; ++worker_cpu) {\n            if (main_cpu == worker_cpu) {\n                continue;\n            }\n            _mm_mfence();\n\n            g_main_cpu = main_cpu;\n            g_worker_cpu = worker_cpu;\n\n            cpu_set_t cpuset;\n            CPU_ZERO(&amp;cpuset);\n            CPU_SET(g_main_cpu, &amp;cpuset);\n\n            pthread_t thread = pthread_self();\n\n            memset(&amp;g_shared, 0, sizeof(g_shared));\n\n            pthread_setaffinity_np(thread, sizeof(cpu_set_t), &amp;cpuset);\n\n            pthread_t worker;\n            pthread_create(&amp;worker, NULL, worker_loop, NULL);\n\n            uint32_t val = 0;\n            union levels lshared;\n\n            for (int i = 0; i &lt; 350; ++i) {\n                lshared.x1 = val;\n                lshared.x2 = rdtsc();\n                lshared.x3 = val;\n                lshared.x4 = val;\n                lshared.x5 = val;\n                lshared.x6 = val;\n                lshared.x7 = val;\n                _mm512_store_si512((void *)&amp;g_shared, lshared.zmm0);\n                __asm__ (\"\" ::: \"memory\");\n\n                usleep(100000);\n\n                val++;\n\n                _mm_pause();\n            }\n\n            pthread_join(worker, NULL);\n        }\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Both system's output: (2-17 are isolated cpus)</p>\n\n<pre><code>            slow cpu    fast cpu\n------------------------------------                \n\n(M=2-W=3)   mean=580    mean=374\n(M=2-W=4)   mean=463    mean=365\n(M=2-W=5)   mean=449    mean=391\n(M=2-W=6)   mean=484    mean=345\n(M=2-W=7)   mean=430    mean=386\n(M=2-W=8)   mean=439    mean=369\n(M=2-W=9)   mean=445    mean=376\n(M=2-W=10)  mean=480    mean=354\n(M=2-W=11)  mean=440    mean=392\n(M=2-W=12)  mean=475    mean=324\n(M=2-W=13)  mean=453    mean=373\n(M=2-W=14)  mean=474    mean=344\n(M=2-W=15)  mean=445    mean=384\n(M=2-W=16)  mean=468    mean=372\n(M=2-W=17)  mean=462    mean=373\n(M=3-W=2)   mean=447    mean=392\n(M=3-W=4)   mean=556    mean=386\n(M=3-W=5)   mean=418    mean=409\n(M=3-W=6)   mean=473    mean=372\n(M=3-W=7)   mean=397    mean=400\n(M=3-W=8)   mean=408    mean=403\n(M=3-W=9)   mean=412    mean=413\n(M=3-W=10)  mean=447    mean=389\n(M=3-W=11)  mean=412    mean=423\n(M=3-W=12)  mean=446    mean=399\n(M=3-W=13)  mean=427    mean=407\n(M=3-W=14)  mean=445    mean=390\n(M=3-W=15)  mean=417    mean=448\n(M=3-W=16)  mean=438    mean=386\n(M=3-W=17)  mean=435    mean=396\n(M=4-W=2)   mean=463    mean=368\n(M=4-W=3)   mean=433    mean=401\n(M=4-W=5)   mean=561    mean=406\n(M=4-W=6)   mean=468    mean=378\n(M=4-W=7)   mean=416    mean=387\n(M=4-W=8)   mean=425    mean=386\n(M=4-W=9)   mean=425    mean=415\n(M=4-W=10)  mean=464    mean=379\n(M=4-W=11)  mean=424    mean=404\n(M=4-W=12)  mean=456    mean=369\n(M=4-W=13)  mean=441    mean=395\n(M=4-W=14)  mean=460    mean=378\n(M=4-W=15)  mean=427    mean=405\n(M=4-W=16)  mean=446    mean=369\n(M=4-W=17)  mean=448    mean=391\n(M=5-W=2)   mean=447    mean=382\n(M=5-W=3)   mean=418    mean=406\n(M=5-W=4)   mean=430    mean=397\n(M=5-W=6)   mean=584    mean=386\n(M=5-W=7)   mean=399    mean=399\n(M=5-W=8)   mean=404    mean=386\n(M=5-W=9)   mean=408    mean=408\n(M=5-W=10)  mean=446    mean=378\n(M=5-W=11)  mean=411    mean=407\n(M=5-W=12)  mean=440    mean=385\n(M=5-W=13)  mean=424    mean=402\n(M=5-W=14)  mean=442    mean=381\n(M=5-W=15)  mean=411    mean=411\n(M=5-W=16)  mean=433    mean=398\n(M=5-W=17)  mean=429    mean=395\n(M=6-W=2)   mean=486    mean=356\n(M=6-W=3)   mean=453    mean=388\n(M=6-W=4)   mean=471    mean=353\n(M=6-W=5)   mean=452    mean=388\n(M=6-W=7)   mean=570    mean=360\n(M=6-W=8)   mean=444    mean=377\n(M=6-W=9)   mean=450    mean=376\n(M=6-W=10)  mean=485    mean=335\n(M=6-W=11)  mean=451    mean=410\n(M=6-W=12)  mean=479    mean=353\n(M=6-W=13)  mean=463    mean=363\n(M=6-W=14)  mean=479    mean=359\n(M=6-W=15)  mean=450    mean=394\n(M=6-W=16)  mean=473    mean=364\n(M=6-W=17)  mean=469    mean=373\n(M=7-W=2)   mean=454    mean=365\n(M=7-W=3)   mean=418    mean=410\n(M=7-W=4)   mean=443    mean=370\n(M=7-W=5)   mean=421    mean=407\n(M=7-W=6)   mean=456    mean=363\n(M=7-W=8)   mean=527    mean=380\n(M=7-W=9)   mean=417    mean=392\n(M=7-W=10)  mean=460    mean=361\n(M=7-W=11)  mean=421    mean=402\n(M=7-W=12)  mean=447    mean=354\n(M=7-W=13)  mean=430    mean=381\n(M=7-W=14)  mean=449    mean=375\n(M=7-W=15)  mean=420    mean=393\n(M=7-W=16)  mean=442    mean=352\n(M=7-W=17)  mean=438    mean=367\n(M=8-W=2)   mean=463    mean=382\n(M=8-W=3)   mean=434    mean=411\n(M=8-W=4)   mean=452    mean=372\n(M=8-W=5)   mean=429    mean=402\n(M=8-W=6)   mean=469    mean=368\n(M=8-W=7)   mean=416    mean=418\n(M=8-W=9)   mean=560    mean=418\n(M=8-W=10)  mean=468    mean=385\n(M=8-W=11)  mean=429    mean=394\n(M=8-W=12)  mean=460    mean=378\n(M=8-W=13)  mean=439    mean=392\n(M=8-W=14)  mean=459    mean=373\n(M=8-W=15)  mean=429    mean=383\n(M=8-W=16)  mean=452    mean=376\n(M=8-W=17)  mean=449    mean=401\n(M=9-W=2)   mean=440    mean=368\n(M=9-W=3)   mean=410    mean=398\n(M=9-W=4)   mean=426    mean=385\n(M=9-W=5)   mean=406    mean=403\n(M=9-W=6)   mean=447    mean=378\n(M=9-W=7)   mean=393    mean=427\n(M=9-W=8)   mean=408    mean=368\n(M=9-W=10)  mean=580    mean=392\n(M=9-W=11)  mean=408    mean=387\n(M=9-W=12)  mean=433    mean=381\n(M=9-W=13)  mean=418    mean=444\n(M=9-W=14)  mean=441    mean=407\n(M=9-W=15)  mean=408    mean=401\n(M=9-W=16)  mean=427    mean=376\n(M=9-W=17)  mean=426    mean=383\n(M=10-W=2)  mean=478    mean=361\n(M=10-W=3)  mean=446    mean=379\n(M=10-W=4)  mean=461    mean=350\n(M=10-W=5)  mean=445    mean=373\n(M=10-W=6)  mean=483    mean=354\n(M=10-W=7)  mean=428    mean=370\n(M=10-W=8)  mean=436    mean=355\n(M=10-W=9)  mean=448    mean=390\n(M=10-W=11) mean=569    mean=350\n(M=10-W=12) mean=473    mean=337\n(M=10-W=13) mean=454    mean=370\n(M=10-W=14) mean=474    mean=360\n(M=10-W=15) mean=441    mean=370\n(M=10-W=16) mean=463    mean=354\n(M=10-W=17) mean=462    mean=358\n(M=11-W=2)  mean=447    mean=384\n(M=11-W=3)  mean=411    mean=408\n(M=11-W=4)  mean=433    mean=394\n(M=11-W=5)  mean=413    mean=428\n(M=11-W=6)  mean=455    mean=383\n(M=11-W=7)  mean=402    mean=395\n(M=11-W=8)  mean=407    mean=418\n(M=11-W=9)  mean=417    mean=424\n(M=11-W=10) mean=452    mean=395\n(M=11-W=12) mean=577    mean=406\n(M=11-W=13) mean=426    mean=402\n(M=11-W=14) mean=442    mean=412\n(M=11-W=15) mean=408    mean=411\n(M=11-W=16) mean=435    mean=400\n(M=11-W=17) mean=431    mean=415\n(M=12-W=2)  mean=473    mean=352\n(M=12-W=3)  mean=447    mean=381\n(M=12-W=4)  mean=461    mean=361\n(M=12-W=5)  mean=445    mean=366\n(M=12-W=6)  mean=483    mean=322\n(M=12-W=7)  mean=431    mean=358\n(M=12-W=8)  mean=438    mean=340\n(M=12-W=9)  mean=448    mean=409\n(M=12-W=10) mean=481    mean=334\n(M=12-W=11) mean=447    mean=351\n(M=12-W=13) mean=580    mean=383\n(M=12-W=14) mean=473    mean=359\n(M=12-W=15) mean=441    mean=385\n(M=12-W=16) mean=463    mean=355\n(M=12-W=17) mean=462    mean=358\n(M=13-W=2)  mean=450    mean=385\n(M=13-W=3)  mean=420    mean=410\n(M=13-W=4)  mean=440    mean=396\n(M=13-W=5)  mean=418    mean=402\n(M=13-W=6)  mean=461    mean=385\n(M=13-W=7)  mean=406    mean=391\n(M=13-W=8)  mean=415    mean=382\n(M=13-W=9)  mean=421    mean=402\n(M=13-W=10) mean=457    mean=376\n(M=13-W=11) mean=422    mean=409\n(M=13-W=12) mean=451    mean=381\n(M=13-W=14) mean=579    mean=375\n(M=13-W=15) mean=430    mean=402\n(M=13-W=16) mean=440    mean=408\n(M=13-W=17) mean=439    mean=394\n(M=14-W=2)  mean=477    mean=330\n(M=14-W=3)  mean=449    mean=406\n(M=14-W=4)  mean=464    mean=355\n(M=14-W=5)  mean=450    mean=389\n(M=14-W=6)  mean=487    mean=342\n(M=14-W=7)  mean=432    mean=380\n(M=14-W=8)  mean=439    mean=360\n(M=14-W=9)  mean=451    mean=405\n(M=14-W=10) mean=485    mean=356\n(M=14-W=11) mean=447    mean=398\n(M=14-W=12) mean=479    mean=338\n(M=14-W=13) mean=455    mean=382\n(M=14-W=15) mean=564    mean=383\n(M=14-W=16) mean=481    mean=361\n(M=14-W=17) mean=465    mean=351\n(M=15-W=2)  mean=426    mean=409\n(M=15-W=3)  mean=395    mean=424\n(M=15-W=4)  mean=412    mean=427\n(M=15-W=5)  mean=395    mean=425\n(M=15-W=6)  mean=435    mean=391\n(M=15-W=7)  mean=379    mean=405\n(M=15-W=8)  mean=388    mean=412\n(M=15-W=9)  mean=399    mean=432\n(M=15-W=10) mean=432    mean=389\n(M=15-W=11) mean=397    mean=432\n(M=15-W=12) mean=426    mean=393\n(M=15-W=13) mean=404    mean=407\n(M=15-W=14) mean=429    mean=412\n(M=15-W=16) mean=539    mean=391\n(M=15-W=17) mean=414    mean=397\n(M=16-W=2)  mean=456    mean=368\n(M=16-W=3)  mean=422    mean=406\n(M=16-W=4)  mean=445    mean=384\n(M=16-W=5)  mean=427    mean=397\n(M=16-W=6)  mean=462    mean=348\n(M=16-W=7)  mean=413    mean=408\n(M=16-W=8)  mean=419    mean=361\n(M=16-W=9)  mean=429    mean=385\n(M=16-W=10) mean=463    mean=369\n(M=16-W=11) mean=426    mean=404\n(M=16-W=12) mean=454    mean=391\n(M=16-W=13) mean=434    mean=378\n(M=16-W=14) mean=454    mean=412\n(M=16-W=15) mean=424    mean=416\n(M=16-W=17) mean=578    mean=378\n(M=17-W=2)  mean=460    mean=402\n(M=17-W=3)  mean=419    mean=381\n(M=17-W=4)  mean=446    mean=394\n(M=17-W=5)  mean=424    mean=422\n(M=17-W=6)  mean=468    mean=369\n(M=17-W=7)  mean=409    mean=401\n(M=17-W=8)  mean=418    mean=405\n(M=17-W=9)  mean=428    mean=414\n(M=17-W=10) mean=459    mean=369\n(M=17-W=11) mean=424    mean=387\n(M=17-W=12) mean=451    mean=372\n(M=17-W=13) mean=435    mean=382\n(M=17-W=14) mean=459    mean=369\n(M=17-W=15) mean=426    mean=401\n(M=17-W=16) mean=446    mean=371\n</code></pre>\n"}, {"tags": ["c", "string", "capitalize"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1566895077, "post_id": 57670697, "comment_id": 101788818, "body": "If you hit a space, you&#39;re gonna convert the <i>next character</i>. Then the loop proceeds to the next character, and converts it again. This is probably not what you want."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 4, "creation_date": 1566895162, "post_id": 57670697, "comment_id": 101788868, "body": "<code>&quot;i am a boy&quot;</code> is a <b>string literal</b> and it is &quot;read-only&quot;. Try <code>char tmp[] = &quot;i am a boy&quot;; LetterCapitalizer(tmp);</code> because the contents of <code>tmp</code> can be changed"}, {"owner": {"reputation": 61, "user_id": 10752744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uBo4vJZ7ig0/AAAAAAAAAAI/AAAAAAAAADE/PdR0mwodCnU/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/10752744/samuel"}, "edited": false, "score": 0, "creation_date": 1566895526, "post_id": 57670697, "comment_id": 101789053, "body": "I want to changed parameter, but I can&#39;t. I can only use char*str in parameter."}, {"owner": {"reputation": 26704, "user_id": 1202830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd22084046f375b15ff56ffae8237b0?s=128&d=identicon&r=PG", "display_name": "Michael Geary", "link": "https://stackoverflow.com/users/1202830/michael-geary"}, "edited": false, "score": 2, "creation_date": 1566895714, "post_id": 57670697, "comment_id": 101789151, "body": "One problem is you don&#39;t know how to use a debugger. Instead of guessing or asking on SO, learn how to use the excellent debugger built into Visual Studio. Try this: start your program with the F11 key (Step In). Then use F10 (Step Over) to step through your program. It will display your variable values at each step. Keep stepping and looking and you will find at least some of your bugs right away."}], "answers": [{"tags": [], "owner": {"reputation": 1145, "user_id": 11783812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LFwV3.jpg?s=128&g=1", "display_name": "cocool97", "link": "https://stackoverflow.com/users/11783812/cocool97"}, "is_accepted": false, "score": 1, "last_activity_date": 1566895621, "creation_date": 1566895621, "answer_id": 57670866, "question_id": 57670697, "link": "https://stackoverflow.com/questions/57670697/how-can-i-access-memory/57670866#57670866", "title": "How can I access memory?", "body": "<p>Two small things to improve your programm :<br>\nFirst, as @pmg said, replace the <code>LetterCapitalizer(\"i am a boy\");</code> by </p>\n\n<pre><code>char tmp[] = \"i am a boy\";\nLetterCapitalizer(tmp);\n</code></pre>\n\n<p>This will allow you not to write into a <code>read-only</code> string litteral.<br></p>\n\n<p>Secondly, if you string contains a <code>space</code>, you will convert <strong>the next caracter</strong>... In this case you could just skip the current iteration and go to the next one.<br>\nFinally, if you don't have any restrictions on C-functions call, there is a function <code>toupper()</code> which takes a caracter and converts it into upper case !</p>\n"}, {"comments": [{"owner": {"reputation": 1145, "user_id": 11783812, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LFwV3.jpg?s=128&g=1", "display_name": "cocool97", "link": "https://stackoverflow.com/users/11783812/cocool97"}, "edited": false, "score": 1, "creation_date": 1566895693, "post_id": 57670869, "comment_id": 101789141, "body": "In your example, it gives a segmentation fault as you free the &#39;strCopy&#39; variable before printing it..."}, {"owner": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 1, "creation_date": 1566895909, "post_id": 57670869, "comment_id": 101789265, "body": "I typically avoid allocation inside a function that returns <code>void</code> because there&#39;s typically no way to get an error out (if the <code>malloc()</code> fails) without crashing the program."}, {"owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "reply_to_user": {"reputation": 38064, "user_id": 683080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69ad2af1f028b1b7e76c14f83bdf26cb?s=128&d=identicon&r=PG", "display_name": "John Szakmeister", "link": "https://stackoverflow.com/users/683080/john-szakmeister"}, "edited": false, "score": 0, "creation_date": 1566896032, "post_id": 57670869, "comment_id": 101789335, "body": "@JohnSzakmeister good point. I posted a version without additional memory allocation to show how that could look like."}], "tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": false, "score": 2, "last_activity_date": 1566895968, "last_edit_date": 1566895968, "creation_date": 1566895626, "answer_id": 57670869, "question_id": 57670697, "link": "https://stackoverflow.com/questions/57670697/how-can-i-access-memory/57670869#57670869", "title": "How can I access memory?", "body": "<p>This method with <code>convertCapital</code> isn't portable, for instance it didn't work on my machine (I had to subtract 32, not add 32). Use <code>toupper</code> instead:</p>\n\n<pre><code>#include &lt;ctype.h&gt;\n....\nstr[0] = toupper(str[0]);\n</code></pre>\n\n<p>And also</p>\n\n<pre><code>str[i + 1] = toupper(str[i + 1]);\n</code></pre>\n\n<p>Furthermore, this here</p>\n\n<pre><code>if(i == emptySpace)\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>if(str[i] == emptySpace)\n</code></pre>\n\n<p>But about your actual problem: <code>\"i am a boy\"</code> can't be modified, but you can do this instead:</p>\n\n<pre><code>char string[] = \"i am a boy\";\nLetterCapitalizer(string);\n</code></pre>\n\n<p>Or you can duplicate the string inside your <code>LetterCapitalizer</code> function:</p>\n\n<pre><code>void LetterCapitalizer(char* str)\n{\n    char *strCopy = malloc(strlen(str) + 1); // make a mutable copy of the string\n    strcpy(strCopy, str);\n    const int convertCapital = 32;\n    const char emptySpace = ' ';\n\n    strCopy[0] = toupper(strCopy[0]);\n\n    for (int i = 0; strCopy[i] != '\\0'; ++i)\n    {\n        if (strCopy[i] == emptySpace)\n            strCopy[i + 1] = toupper(strCopy[i + 1]);\n    }\n    printf(\"%s\", strCopy);\n    free(strCopy); // free the memory again\n}\n</code></pre>\n\n<hr>\n\n<p>If you want, you can avoid allocating more memory altogether like this:</p>\n\n<pre><code>void LetterCapitalizer(char* str)\n{\n    const char emptySpace = ' ';\n    putchar(toupper(str[0]));\n\n    for (int i = 1; str[i] != '\\0'; ++i)\n    {\n        putchar(str[i]);\n        if (str[i] == emptySpace) {\n            putchar(toupper(str[i + 1]));\n            i++;\n        }   \n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 120, "user_id": 11796570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HmeF1.jpg?s=128&g=1", "display_name": "Akhilesh Sharma", "link": "https://stackoverflow.com/users/11796570/akhilesh-sharma"}, "edited": false, "score": 0, "creation_date": 1566896411, "post_id": 57671072, "comment_id": 101789578, "body": "You need to import <code>&lt;stdbool.h&gt;</code> for <code>bool</code> and <code>string.h</code> for <code>strlen()</code> function"}, {"owner": {"reputation": 120, "user_id": 11796570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HmeF1.jpg?s=128&g=1", "display_name": "Akhilesh Sharma", "link": "https://stackoverflow.com/users/11796570/akhilesh-sharma"}, "edited": false, "score": 0, "creation_date": 1566896667, "post_id": 57671072, "comment_id": 101789722, "body": "Also, you need to subtract 32 because in ASCII, captial letters come before small so their ASCII code is 32 letters behind. You can see the full ASCII table <a href=\"http://www.asciitable.com/\" rel=\"nofollow noreferrer\">here</a>"}], "tags": [], "owner": {"reputation": 120, "user_id": 11796570, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HmeF1.jpg?s=128&g=1", "display_name": "Akhilesh Sharma", "link": "https://stackoverflow.com/users/11796570/akhilesh-sharma"}, "is_accepted": false, "score": 0, "last_activity_date": 1566896309, "creation_date": 1566896309, "answer_id": 57671072, "question_id": 57670697, "link": "https://stackoverflow.com/questions/57670697/how-can-i-access-memory/57671072#57671072", "title": "How can I access memory?", "body": "<p>You can use a flag for indicating that next non-space character is to be capitalized. You can store the result string in another string. and then return that result string. I have corrected the code. Please vote up if this helped you. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\nvoid LetterCapitalizer(char* str)\n{\n    const int convertCapital = 32;\n    const char emptySpace = ' ';\n    bool flag = true;\n    char str2[strlen(str)]; \n    for (int i = 0; str[i] != '\\0'; ++i)\n    {\n        if(flag) {\n            str2[i] = str[i] - convertCapital;\n            flag = false;\n        }\n        else {\n            str2[i] = str[i];\n        }\n        if(str[i] == emptySpace)\n            flag = true;\n    }\n\n    printf(\"%s\", str2);\n}\n\nint main(void)\n{\n    LetterCapitalizer(\"i am a boy\");\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10752744, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uBo4vJZ7ig0/AAAAAAAAAAI/AAAAAAAAADE/PdR0mwodCnU/photo.jpg?sz=128", "display_name": "Samuel", "link": "https://stackoverflow.com/users/10752744/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1569584979, "creation_date": 1566894978, "last_edit_date": 1569584979, "question_id": 57670697, "link": "https://stackoverflow.com/questions/57670697/how-can-i-access-memory", "title": "How can I access memory?", "body": "<p>I made a method which changed small letter to capital letter. For example, when I input 'i love c language' in method, then it outputs 'I Love C Language'. </p>\n\n<p>Finally, I made whole method, but it had error. I don't know the reason why it couldn't operate... Help me..!</p>\n\n<p>I already build this code in Visual Studio 2019. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid LetterCapitalizer(char* str)\n{\n    const int convertCapital = 32;\n    const char emptySpace = ' ';\n\n    str[0] = str[0] + convertCapital;\n\n    for (int i = 0; str[i] != '\\0'; ++i)\n    {\n        if(i == emptySpace)\n            str[i+1] = str[i+1] + convertCapital;\n    }\n\n    printf(\"%s\", str);\n}\n\nint main(void)\n{\n    LetterCapitalizer(\"i am a boy\");\n\n    return 0;\n}\n</code></pre>\n\n<p>I want to print I Am A Boy in console window, but it doesn't appeared.</p>\n"}]