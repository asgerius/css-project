[{"tags": ["c"], "comments": [{"owner": {"reputation": 11664, "user_id": 207791, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/c9ffc6f77d7f8ee002acd0e9ebc872f2?s=128&d=identicon&r=PG", "display_name": "Victor Sergienko", "link": "https://stackoverflow.com/users/207791/victor-sergienko"}, "edited": false, "score": 1, "creation_date": 1557962463, "post_id": 56158798, "comment_id": 98946271, "body": "You need sleep function: <a href=\"https://linux.die.net/man/3/sleep\" rel=\"nofollow noreferrer\">linux.die.net/man/3/sleep</a>. It is a part of so called POSIX standard (you will hear a lot about it all the time), so should be available on any system."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557963168, "post_id": 56158798, "comment_id": 98946394, "body": "When using <code>clock()</code> please use <code>CLOCKS_PER_SEC</code> not <code>1000</code>. Milliseconds are system-specific. So <code>clock_t ticks = CLOCKS_PER_SEC * number_of_seconds;</code>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557965460, "post_id": 56158798, "comment_id": 98946827, "body": "Adding to Weather Vane\u2019s comment, <code>CLOCKS_PER_SEC</code> is 1,000,000 on my system, so your code would wait 5,000 microseconds or 5 milliseconds. Also, do not do this; it makes the CPU run continuously during the delay, which is wasteful. Use <code>sleep</code> or other methods to ask the system to wake your process after time has passed."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557965750, "post_id": 56158798, "comment_id": 98946889, "body": "You call an operating system function to sleep  , the answer depends on your OS."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1557967129, "post_id": 56158798, "comment_id": 98947099, "body": "Not sure why this question was downvoted. It&#39;s a perfectly valid question with an attempt by OP"}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1557982913, "post_id": 56158798, "comment_id": 98950011, "body": "Also don&#39;t do this beacause clock() only counls time while the CPU is running your code,  if you ran 20 copies sumultanously and only had 10 cores, you&#39;d find that most would wait for about 10 seconds."}], "answers": [{"comments": [{"owner": {"reputation": 2685, "user_id": 293023, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/96ae36cc4310f8658e2ef09730ac191d?s=128&d=identicon&r=PG&f=1", "display_name": "niry", "link": "https://stackoverflow.com/users/293023/niry"}, "edited": false, "score": 1, "creation_date": 1557964923, "post_id": 56158834, "comment_id": 98946746, "body": "There is also <code>usleep()</code> if you need higher resolution."}, {"owner": {"reputation": 10217, "user_id": 471930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tds8p.png?s=128&g=1", "display_name": "Jasen", "link": "https://stackoverflow.com/users/471930/jasen"}, "edited": false, "score": 0, "creation_date": 1557982686, "post_id": 56158834, "comment_id": 98949956, "body": "also <code>nanosleep()</code>"}], "tags": [], "owner": {"reputation": 311, "user_id": 2473475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f34c910cc0777383b087661047763925?s=128&d=identicon&r=PG", "display_name": "Julio P.C.", "link": "https://stackoverflow.com/users/2473475/julio-p-c"}, "is_accepted": true, "score": 3, "last_activity_date": 1557962493, "creation_date": 1557962493, "answer_id": 56158834, "question_id": 56158798, "link": "https://stackoverflow.com/questions/56158798/how-do-you-make-a-function-that-waits-an-x-amount-of-seconds-in-c/56158834#56158834", "title": "How do you make a function that &quot;waits&quot; an x amount of seconds in C?", "body": "<p>There's a \"sleep\" function, on unistd.h</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n\n//something your code\n\nsleep(seconds);\n</code></pre>\n\n<p>Hope that helps</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10621144"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56158834, "answer_count": 1, "score": 0, "last_activity_date": 1557962493, "creation_date": 1557962164, "question_id": 56158798, "link": "https://stackoverflow.com/questions/56158798/how-do-you-make-a-function-that-waits-an-x-amount-of-seconds-in-c", "title": "How do you make a function that &quot;waits&quot; an x amount of seconds in C?", "body": "<p>I'm trying to make the terminal wait an x numbers of seconds before printing something on screen. I literally copied the code from somewhere else online but my terminal just doesn't wait any time at all and executes everything altogether as it normally would.\nDo you guys know why this happens?</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>\nfor(int i = 0; i &lt; 5; i++){\n    delay(5);\n    printf(\". \");\n}\n\nvoid delay(int number_of_seconds)\n{\n    // Converting time into milli_seconds\n    int milli_seconds = 1000 * number_of_seconds;\n\n    // Stroing start time\n    clock_t start_time = clock();\n\n    // looping till required time is not acheived\n    while (clock() &lt; start_time + milli_seconds)\n        ;\n}\n</code></pre>\n"}, {"tags": ["c", "unix", "terminal"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1557961764, "post_id": 56158738, "comment_id": 98946163, "body": "Step 1: <code>while (parsed != NULL)</code> --&gt; <code>while (parsed != NULL &amp;&amp; index &lt; (8-1))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11502804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff35d8cc11af600d7869d97058b03af?s=128&d=identicon&r=PG&f=1", "display_name": "Gulkbag", "link": "https://stackoverflow.com/users/11502804/gulkbag"}, "edited": false, "score": 0, "creation_date": 1557967643, "post_id": 56159175, "comment_id": 98947171, "body": "Those are declared in my code it&#39;s just stackoverflow has a dumb thing where it won&#39;t let me post the whole code so i had to trim it alot"}, {"owner": {"reputation": 1, "user_id": 11502804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff35d8cc11af600d7869d97058b03af?s=128&d=identicon&r=PG&f=1", "display_name": "Gulkbag", "link": "https://stackoverflow.com/users/11502804/gulkbag"}, "edited": false, "score": 0, "creation_date": 1557968223, "post_id": 56159175, "comment_id": 98947258, "body": "Also i tried this code and it does not work it still gives me &quot;Address out of bounds error&quot;"}], "tags": [], "owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "is_accepted": false, "score": 0, "last_activity_date": 1557965559, "creation_date": 1557965559, "answer_id": 56159175, "question_id": 56158738, "link": "https://stackoverflow.com/questions/56158738/address-out-of-bounds-in-c-problems-with-making-an-ls-command/56159175#56159175", "title": "Address out of bounds in C, problems with making an ls command", "body": "<p>There were many undeclared variables in your code snippets. You also need to fetch the hostname, it isn't a global variable. It's also a best practice to declare your functions before using them.</p>\n\n<p>This works fine:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;readline/readline.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nchar **get_input(char *input) {\n    char **command = malloc(8 * sizeof(char *));\n    char *separator = \" \";\n    int index = 0;\n\n    char *parsed = strtok(input, separator);\n    while (parsed != NULL &amp;&amp; index &lt; 8) { // you need to make sure the index does not overflow the array\n        command[index] = parsed;\n        index++;\n\n        parsed = strtok(NULL, separator);\n    }\n\n    command[index] = NULL;\n    return command;\n}\n\nint main() {\n    printf(\"\\033[1;33mWelcome To Crisp Bacon Shell\\n\");\n    while (1) {\n        // hostname does not exist, you need to fetch it\n        char hostname[1024];\n        gethostname(hostname, 1023); // POSIX only\n        printf(\"\\033[0m%s $\", hostname);\n        char *input = readline(NULL);\n        char **command = get_input(input);\n\n        pid_t child_pid = fork();\n        if (child_pid &lt; 0) {\n            perror(\"Fork failed\");\n            exit(1);\n        } else if (child_pid == 0) {\n            /* Never returns if the call is successful */\n            execvp(command[0], command);\n            printf(\"This won't be printed if execvp is successul\\n\");\n        } else {\n            waitpid(child_pid, NULL, WUNTRACED); // since you don't use the middle argument, no need to point to valid data\n        }\n\n        free(input);\n        free(command);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11502804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff35d8cc11af600d7869d97058b03af?s=128&d=identicon&r=PG&f=1", "display_name": "Gulkbag", "link": "https://stackoverflow.com/users/11502804/gulkbag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557965559, "creation_date": 1557961614, "last_edit_date": 1557961924, "question_id": 56158738, "link": "https://stackoverflow.com/questions/56158738/address-out-of-bounds-in-c-problems-with-making-an-ls-command", "title": "Address out of bounds in C, problems with making an ls command", "body": "<p>I am trying to make a some what shell in C but I am having problems with making the <code>ls</code> command.  <code>mkdir</code>, and <code>cd</code> work fine but with <code>ls</code> it gives me</p>\n\n<blockquote>\n  <p>\"Address out of bounds segmentation error\"</p>\n</blockquote>\n\n<p>Hope somebody can help me. Here's my code.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;readline/readline.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main() {\n    printf(\"\\033[1;33mWelcome To Crisp Bacon Shell\\n\");\n    while (1) {\n        printf(\"\\033[0m%s $\", hostname);\n        input = readline(\"\");\n        command = get_input(input);\n\n        child_pid = fork();\n         if (child_pid &lt; 0) {\n            perror(\"Fork failed\");\n            exit(1);\n        }else if (child_pid == 0) {\n            /* Never returns if the call is successful */\n            execvp(command[0], command);\n            printf(\"This won't be printed if execvp is successul\\n\");\n        } else {\n            waitpid(child_pid, &amp;stat_loc, WUNTRACED);\n        }\n\n        free(input);\n        free(command);\n    }\n    return 0;\n}\n\nchar **get_input(char *input) {\n    char **command = malloc(8 * sizeof(char *));\n    char *separator = \" \";\n    char *parsed;\n    int index = 0;\n\n    parsed = strtok(input, separator);\n    while (parsed != NULL) {\n        command[index] = parsed;\n        index++;\n\n        parsed = strtok(NULL, separator);\n    }\n\n    command[index] = NULL;\n    return command;\n}\n</code></pre>\n\n<p>The only thing I understand it has something to do with memory and references or pointers but I tried changing everything from &amp; refrencing to pointers and it just gave me more errors what do I do?</p>\n"}, {"tags": ["c", "exception", "struct", "malloc", "strcpy"], "comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557961813, "post_id": 56158665, "comment_id": 98946170, "body": "In the <code>fgets</code> call, <code>strlen(tempArtist[counter])</code> is the length of the string currently in <code>tempArtist[counter]</code>. But <code>tempArtist[counter]</code> has no defined contents, because you have not initialized it. You want to tell <code>fgets</code> how much memory is available there, not what the length of the string currently there is. Use <code>sizeof tempArtist[counter]</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557961983, "post_id": 56158665, "comment_id": 98946195, "body": "<code>int getSongInfo(struct songInfo *pFillInfo, char artistName, char songName)</code> passes only a single character for <code>artistName</code> and a single character for <code>songName</code>. These characters are passed by value, so the addresses of the characters in the <code>main</code> routine are not passed. When <code>getSongInfo</code> uses <code>&amp;artistName</code>, it gets the address of its parameter, which is not what you want. Change the function declaration to <code>int getSongInfo(struct songInfo *pFillInfo, char *artistName, char *songName)</code>. This will require corresponding changes in the function body and in <code>main</code>."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557962049, "post_id": 56158665, "comment_id": 98946203, "body": "In <code>getSongInfo</code>, do not free the memory you just allocated. This memory should be retained until the data it contains is no longer needed. It would be freed by a separate routine called when the program is disposing of the saved data (or could be left to be reclaimed by the operating system when the program exits)."}, {"owner": {"reputation": 191, "user_id": 10771982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e786500272d4ba527c65e8e0370bd70b?s=128&d=identicon&r=PG&f=1", "display_name": "RocktheFries", "link": "https://stackoverflow.com/users/10771982/rockthefries"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557967206, "post_id": 56158665, "comment_id": 98947111, "body": "@EricPostpischil I have updated the code to reflect these changes, is there a reason why it is only saving the first entry to fillPtr? It wont record the following 9. Thanks!"}, {"owner": {"reputation": 191, "user_id": 10771982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e786500272d4ba527c65e8e0370bd70b?s=128&d=identicon&r=PG&f=1", "display_name": "RocktheFries", "link": "https://stackoverflow.com/users/10771982/rockthefries"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557968117, "post_id": 56158665, "comment_id": 98947238, "body": "@EricPostpischil I double checked index 0-10 through the array and I was wrong, it is storing all 10, but I&#39;m having issues printing the struct, maybe you have some insight, the function is added to the code above, thanks!"}], "owner": {"reputation": 191, "user_id": 10771982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e786500272d4ba527c65e8e0370bd70b?s=128&d=identicon&r=PG&f=1", "display_name": "RocktheFries", "link": "https://stackoverflow.com/users/10771982/rockthefries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557967131, "creation_date": 1557961032, "last_edit_date": 1557967131, "question_id": 56158665, "link": "https://stackoverflow.com/questions/56158665/using-strcpy-to-copy-a-string-into-a-struct-when-memory-is-allocated-using-ma", "title": "Using strcpy() to copy a string into a struct, when memory is allocated using malloc()", "body": "<p>Currently in my program I have the user enter both a Song Title, and Artist Title for some songs. Each string is stored in an array. I am then trying to use those entered strings in a function to allocate memory by using malloc(), then use strcopy to copy the strings into a multi dimensional array variable of my struct. I've copied the code below. I keep getting a \"Exception thrown: write access violation.\" error when my function uses malloc, and cant seem to figure out why. Any help would be appreciated. It is expected that the strings will be no more than than a size of 30, and there will be 10 arrays of the struct variable to store 10 different songs with their artist.</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#pragma warning(disable:4996)\n\nint getSongInfo(struct songInfo *pFillInfo, char *artistName, char *songName);\nint printSongInfo(struct songInfo *songList[]);\n\nstruct songInfo {\n\n    char *songArtist;\n    char *songTitle;\n};\n\nint main(void)\n{\n    struct songInfo *fillPtr, songList[10];\n    fillPtr = &amp;songList[0];\n\n    char tempArtist[30][10];\n    char tempSong[30][10];\n\n    int i = 0;\n    int counter = 0;\n    int arrayCounter = 0;\n    while (counter != 10)\n    {\n        printf(\"Please enter the artist name: \");\n        fgets(tempArtist[counter], sizeof(tempArtist[counter]), stdin);\n        printf(\"Please enter the song name: \");\n        fgets(tempSong[counter], sizeof(tempSong[counter]), stdin);\n\n        getSongInfo(&amp;fillPtr[arrayCounter], tempArtist[counter], tempSong[counter]);\n\n        printf(\"Song and Artist Captured! \\n\");\n        counter++;\n        arrayCounter++;\n    }\n\n    printSongInfo(&amp;fillPtr);\n}\n\nint getSongInfo(struct songInfo *pFillInfo, char *artistName, char *songName)\n{\n    pFillInfo-&gt;songArtist = (char*)malloc(strlen(artistName) + 1);\n    pFillInfo-&gt;songTitle = (char*)malloc(strlen(songName) + 1);\n\n    strcpy(pFillInfo-&gt;songArtist, artistName);\n    strcpy(pFillInfo-&gt;songTitle, songName);\n\n\n\n    return 1;\n}\n\nint printSongInfo(struct songInfo *songList[])\n{\n    int counter = 0;\n\n    while (counter != 10)\n    {\n        printf(\"%-35s%-35s\", &amp;songList[counter]-&gt;songArtist, &amp;songList[counter]-&gt;songTitle);\n        counter++;\n    }\n\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "x86", "inline-assembly", "osdev"], "comments": [{"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557957605, "post_id": 56158104, "comment_id": 98945235, "body": "Q1: Compiler knows which instructions have dependency. You can expect dependant ones to stay in order. Q2: Same as Q1."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557958645, "post_id": 56158104, "comment_id": 98945503, "body": "@rAndom69: Do you have an authoritative source for the statement that GCC knows which instructions have dependencies and will not reorder them?"}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557959491, "post_id": 56158104, "comment_id": 98945703, "body": "@EricPostpischil  Not really. However this is the way it works since ancient times. inline assembly block is translated into intermediate language which is optimized by both optimization step and linker. Meaning of which it&#39;s &quot;equal&quot; to compiler generated intermediate code."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557960074, "post_id": 56158104, "comment_id": 98945826, "body": "@rAndom69: In general, inline assembly cannot be translated into intermediate language. The \u201cassembly\u201d content can be arbitrary text, which is inserted into the assembly output verbatim. And manufacturers add new instructions regularly, so one would need to match the architecture specification of the instructions they are using to the compiler statement. This general unauthenticated statement about compiler knowledge of dependencies should not be trusted."}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557960737, "post_id": 56158104, "comment_id": 98945956, "body": "@EricPostpischil then you claim <a href=\"https://stackoverflow.com/questions/11986411/why-is-clang-optimization-breaking-my-inline-assembly-code\" title=\"why is clang optimization breaking my inline assembly code\">stackoverflow.com/questions/11986411/&hellip;</a> etc. are bugs in compiler? (Yes they are however as there is no definition how inline assembly should work - please post link) it&#39;s essentially UB. Even VC in v6 used to rearange inline assembly while it was not NASM unit. When working in terms of UB current state is &quot;draft&quot;."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 2, "creation_date": 1557961091, "post_id": 56158104, "comment_id": 98946037, "body": "@rAndom69: The question you link to appears to be an example of the compiler not automatically recognizing dependencies, which is in line with what I have written and which is inconsistent with the statement that the compiler recognizes dependencies. It is not a compiler bug unless the compiler specification says the compiler will recognize these dependencies."}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557961677, "post_id": 56158104, "comment_id": 98946145, "body": "@EricPostpischil as I said (and You ignored) there is little definition how of how inline assembly should work. One block is optimized in terms of this block (if compiler/linker feels like). Once again please point to definition if there is any. Otherwise inline assemby should stay what it is, lions there. What is stated was personal experiece with compilers, which is error on my side."}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557962110, "post_id": 56158104, "comment_id": 98946212, "body": "Eh, It took time but I see. You have issue with original statement that compilers do know. They do know, however they <i>might</i> give a <i>fuck</i> about inline assembly. UB."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1558010556, "post_id": 56158104, "comment_id": 98964153, "body": "@MichaelPetch: An alternative to separate <code>asm()</code> statements might be to have macros that expand to just a string literal, to be used inside an like <code>asm(cli()  outb(0xe9, &#39;M&#39;)  sti());</code>  Probably with each macro on a separate line.  C string-literal concatenation takes care of joining it up into one big asm template.  (Only works for compile-time-constant inputs, though; this doesn&#39;t give a mechanism for generating constraints for Extended asm.)"}], "answers": [{"comments": [{"owner": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 3, "creation_date": 1557962226, "post_id": 56158767, "comment_id": 98946230, "body": "+1 &quot;not consecutive&quot; != &quot;reordered&quot;, and it&#39;s worth mentioning that <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Basic-Asm.html#Basic-Asm\" rel=\"nofollow noreferrer\">all basic asm blocks are implicitly volatile</a>."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 45685, "user_id": 69809, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/yCVF0.jpg?s=128&g=1", "display_name": "Groo", "link": "https://stackoverflow.com/users/69809/groo"}, "edited": false, "score": 0, "creation_date": 1557962354, "post_id": 56158767, "comment_id": 98946256, "body": "@groo : I&#39;m aware that the any block that has no output constraint (which includes basic inline assembly). I only add them into the comments to ensure people know they are volatile (some don&#39;t know the volatile rule)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1557962911, "post_id": 56158767, "comment_id": 98946349, "body": "I had quickly commented and then deleted it (but not fast enough). I then upvoted and accepted the answer as it became clear that I was in fact overnalayzing what consecutive implied.I appreciate the answer!"}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1557963585, "post_id": 56158767, "comment_id": 98946493, "body": "@MichaelPetch: People are volatile so I guess that&#39;s invalid comment :P"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1558010199, "post_id": 56158767, "comment_id": 98963912, "body": "@MichaelPetch: I&#39;m glad you posted this question; I&#39;ve seen you claim that <code>asm volatile</code> statements can get reordered before, and I&#39;d always wondered what basis you had for that surprising claim.  Glad to know it was just this wording in the docs; I think we now agree in our understandings of what GNU C inline asm does/doesn&#39;t guarantee and how to use it correctly (in the rare cases where it can&#39;t be avoided)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558010341, "post_id": 56158767, "comment_id": 98964005, "body": "@Chris: Worth pointing out that there&#39;s <i>no</i> guarantee that register contents lives across separate <code>asm</code> statements.  The example in the question correctly puts <code>mov $imm8, %al</code> in the same statement as <code>outb</code>, which is necessary for correctness.  But I&#39;ve seen code that <i>doesn&#39;t</i> do that, and that&#39;s a bug waiting to bite you."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558010940, "post_id": 56158767, "comment_id": 98964423, "body": "@PeterCordes : Years ago when I was doing arm development this issue cropped up and there is information out there that has suggested asm volatile reordering (not just consecutive). What is even worse is that &quot;perfectly consecutive&quot; may imply something different than &quot;consecutive&quot;. The concept of asm volatile reordering shows up on GCC bug reports occasionally. A couple of years ago it showed up again: <a href=\"https://gcc.gnu.org/ml/gcc-help/2017-10/msg00063.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/ml/gcc-help/2017-10/msg00063.html</a> . The problem is that many years ago the docs didn&#39;t even touch on these matters very well."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 1, "creation_date": 1558011016, "post_id": 56158767, "comment_id": 98964487, "body": "It may have been a different story if my journey with asm volatile was a more recent one, but when you live through years where there were real questions it leaves you wondering what the documents are suggesting since in the past it did appear asm volatile could be re-ordered  on arm targets."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1558014193, "post_id": 56158767, "comment_id": 98966610, "body": "@PeterCordes : In the original question (now slightly altered) I had put the mov and the out in the same statement which is okay (as you say). It was meant as a quick example but I only noticed after I neglected to add the &quot;EAX&quot; clobber on there. As well I cleaned up the question to make the use of volatile consistent between examples."}, {"owner": {"reputation": 2978, "user_id": 904148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf9d0b9f5d61826525247bd5b79cdc0?s=128&d=identicon&r=PG", "display_name": "Timothy Baldwin", "link": "https://stackoverflow.com/users/904148/timothy-baldwin"}, "edited": false, "score": 0, "creation_date": 1558043887, "post_id": 56158767, "comment_id": 98980671, "body": "It is the execution order that is guaranteed, assembly source order and memory address order may change."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 7, "last_activity_date": 1557962614, "last_edit_date": 1557962614, "creation_date": 1557961913, "answer_id": 56158767, "question_id": 56158104, "link": "https://stackoverflow.com/questions/56158104/understanding-inline-assembly-in-a-pre-processor-macro-vs-inline-assembly-in-a-f/56158767#56158767", "title": "Understanding Inline assembly in a pre-processor macro vs Inline assembly in a function", "body": "<blockquote>\n  <p><strong>Do not expect a sequence of asm statements to remain perfectly consecutive after compilation, even when you are using the volatile qualifier.</strong> If certain instructions need to remain consecutive in the output, put them in a single multi-instruction asm statement.</p>\n</blockquote>\n\n<p>You're actually misreading this (or overreading it).  It is NOT saying that volatile asm statements can be reordered; they can't be reordered or removed -- that's the whole point of volatile.  What it is saying is that other (non-volatile) things can be reordered with respect to the asm statements, and, in particular, might be moved in between any two of these asm statements.  So they might not be <strong>consecutive</strong> after the optimizer gets through with them, but they will still be in order.</p>\n\n<p>Note that this only applies to <code>volatile</code> asm blocks (which includes all block with no outputs -- they're implicitly volatile).  Any other non-volatile asm blocks or statements might be moved between the volatile asm blocks, if otherwise allowed.</p>\n"}], "owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 567, "favorite_count": 0, "accepted_answer_id": 56158767, "answer_count": 1, "score": 6, "last_activity_date": 1558013887, "creation_date": 1557957042, "last_edit_date": 1558013887, "question_id": 56158104, "link": "https://stackoverflow.com/questions/56158104/understanding-inline-assembly-in-a-pre-processor-macro-vs-inline-assembly-in-a-f", "title": "Understanding Inline assembly in a pre-processor macro vs Inline assembly in a function", "body": "<p>GGC's inline assembly can be difficult to implement properly and easy to get wrong<sup><a href=\"https://stackoverflow.com/q/56142479/3857942\">1</a></sup>. From a higher level perspective inline assembly has some rules that have to be considered outside of what instructions an inline assembly statement may emit.</p>\n\n<p>The <em>C</em>/<em>C++</em> standards consider <a href=\"https://en.cppreference.com/w/cpp/language/asm\" rel=\"nofollow noreferrer\"><code>asm</code></a> to be an option and implementation defined. Implementation defined behaviour is <a href=\"https://gcc.gnu.org/onlinedocs/gcc-6.1.0/gcc/Extended-Asm.html\" rel=\"nofollow noreferrer\">documented in GCC</a> to include this:</p>\n\n<blockquote>\n  <p><strong>Do not expect a sequence of <em>asm</em> statements to remain perfectly consecutive after compilation, even when you are using the volatile qualifier</strong>. If certain instructions need to remain consecutive in the output, put them in a single multi-instruction asm statement.</p>\n</blockquote>\n\n<p>Basic inline assembly, or extended inline assembly without any output constraints are implicitly <code>volatile</code>. The documentation says that being volatile doesn't guarantee that successive statements will be ordered as the appear in the source code. This code would not have a guaranteed order:</p>\n\n<pre><code>asm (\"cli\");\nasm (\"mov $'M', %%al; out %%al, $0xe9\" ::: \"eax\");\nasm (\"mov $'D', %%al; out %%al, $0xe9\" ::: \"eax\");\nasm (\"mov $'P', %%al; out %%al, $0xe9\" ::: \"eax\");\nasm (\"sti\");\n</code></pre>\n\n<p>If the intention is to use <em>CLI</em> and <em>STI</em> to turn off (and turn back on) external interrupts and output some letters in the order <code>MDP</code> to the QEMU debug console (port 0xe9) then this isn't guaranteed. You can place all of them in a single inline assembly statement or you could use extended inline assembly templates to pass a dummy dependency to each statement guaranteeing ordering.</p>\n\n<p>To make things more manageable OS developers in particular are known to create convenient wrappers around such code. Some developers do it as C pre-processor macros. In theory this looks useful:</p>\n\n<pre><code>#define outb(port, value) \\\n        asm (\"out %0, %1\" \\\n             : \\\n             : \"a\"((uint8_t)value), \"Nd\"((uint16_t)port))\n\n#define cli() asm (\"cli\")\n\n#define sti() asm (\"sti\")\n</code></pre>\n\n<p>You can then use them like this:</p>\n\n<pre><code>cli ();\noutb (0xe9, 'M');\noutb (0xe9, 'D');\noutb (0xe9, 'P');\nsti ();\n</code></pre>\n\n<p>Of course the C pre-processor is done first before the <em>C</em> compiler begins to process the code itself. The pre-processor will generate these statements all in a row which is also not guaranteed to be emitted in a particular order by the code generator:</p>\n\n<pre><code>asm (\"cli\");\nasm (\"out %0, %1\" : : \"a\"((uint8_t)'M'), \"Nd\"((uint16_t)0xe9));\nasm (\"out %0, %1\" : : \"a\"((uint8_t)'D'), \"Nd\"((uint16_t)0xe9));\nasm (\"out %0, %1\" : : \"a\"((uint8_t)'P'), \"Nd\"((uint16_t)0xe9));\nasm (\"sti\");\n</code></pre>\n\n<hr>\n\n<h2>My Questions</h2>\n\n<p>Some developers have taken it upon themselves to use macros that place the inline assembly statements inside a compound statement like this:</p>\n\n<pre><code>#define outb(port, value) ({ \\\n        asm (\"out %0, %1\" \\\n             : \\\n             : \"a\"((uint8_t)value), \"Nd\"((uint16_t)port)); \\\n    })\n\n#define cli() ({ \\\n        asm (\"cli\"); \\\n    })\n\n#define sti() ({ \\\n        asm (\"sti\"); \\\n    })\n</code></pre>\n\n<p>Using these macros as we did before would have the <em>C</em> pre-processor generating this code:</p>\n\n<pre><code>({ asm (\"cli\"); });\n({ asm (\"out %0, %1\" : : \"a\"((uint8_t)'M'), \"Nd\"((uint16_t)0xe9)); });\n({ asm (\"out %0, %1\" : : \"a\"((uint8_t)'D'), \"Nd\"((uint16_t)0xe9)); });\n({ asm (\"out %0, %1\" : : \"a\"((uint8_t)'P'), \"Nd\"((uint16_t)0xe9)); });\n({ asm (\"sti\"); });\n</code></pre>\n\n<p><strong>Question 1</strong>: Does placing <code>asm</code> statements inside a compound statement guarantee ordering? My view has been that I don't believe so, but I'm actually unsure. It is one of the reasons I avoid using pre-processor macros to generate inline assembly that I may use in a sequence like this.</p>\n\n<hr>\n\n<p>For years I have used <code>static inline</code> functions in headers for inline assembly statements. Functions provide type checking, but I also believed that inline assembly in functions does guarantee that the side effects (including inline assembly) are emitted by the next sequence point (the <code>;</code> on the end of a function call). </p>\n\n<p>If I were to call actual functions my expectation is that each of these functions would have the inline assembly statements generated in order relative to one another:</p>\n\n<pre><code>cli ();\noutb (0xe9, 'M');\noutb (0xe9, 'D');\noutb (0xe9, 'P');\nsti ();\n</code></pre>\n\n<p><strong>Question 2</strong> : Does placing the inline assembly statements in actual functions (whether external linkage or inlined) guarantee the order? My feeling is that if this weren't the case that code like:</p>\n\n<pre><code>printf (\"hello \");\nprintf (\"world \");\n</code></pre>\n\n<p>Could be output as <code>hello world</code> or <code>world hello</code>. <em>C</em>'s <a href=\"https://en.cppreference.com/w/cpp/language/as_if\" rel=\"nofollow noreferrer\">as-if rule</a> suggests that optimizations can't alter observable behaviour. I believed the compiler wouldn't be able to assume that inline assembly actually had altered observable behaviour or not, so the compiler wouldn't be permitted to emit the inline assembly of the functions in another order.</p>\n"}, {"tags": ["c", "gcc", "assembly", "mingw", "gnu-assembler"], "comments": [{"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 4, "creation_date": 1557956772, "post_id": 56157900, "comment_id": 98945005, "body": "The first code is 32 bit. The convention is to use <code>st0</code> for returning floats. Second code is 64 bit, windows convention (not surprising since mingw is for windows)."}, {"owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1557956925, "post_id": 56157900, "comment_id": 98945055, "body": "Thanks, why the second wrong? @Jester"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1557956982, "post_id": 56157900, "comment_id": 98945069, "body": "It&#39;s not wrong. How do you think it is wrong? You do know that windows uses different convention from linux/sysv, right?"}, {"owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1557957053, "post_id": 56157900, "comment_id": 98945087, "body": "It crashes my program on the line <code>&lt;+  224&gt;   movd   %xmm0,%eax</code>. But float args goes to xmm registers and returns from xmm anyway, or not?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 2, "creation_date": 1557957186, "post_id": 56157900, "comment_id": 98945124, "body": "That&#39;s not the code I am talking about. <b>Your</b> function (which I count as third code) is broken as it&#39;s not following the calling convention. Also the fault can not be at <code>+224</code> because that instruction can not fault."}, {"owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1557957764, "post_id": 56157900, "comment_id": 98945283, "body": "Can you say how to fix code?"}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1557957948, "post_id": 56157900, "comment_id": 98945323, "body": "Use code from the second example to multiply the arguments. That is <code>movaps  (%rdx), %xmm0; mulps  (%rcx), %xmm0</code>"}, {"owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "reply_to_user": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 0, "creation_date": 1557958545, "post_id": 56157900, "comment_id": 98945484, "body": "now crash at <code>movaps (%rdx),%xmm0</code>. Maybe better I will post full code? @Jester"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557978284, "post_id": 56157900, "comment_id": 98948981, "body": "It would improve the question to give exact versions and builds of the compiler, rather than just saying &quot;different mingw versions&quot;"}, {"owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557982658, "post_id": 56157900, "comment_id": 98949943, "body": "There are already in the assembly code examples <code>GCC: (MinGW.org GCC-6.3.0-1) 6.3.0</code> and <code>GCC: (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 7.3.0</code> @M.M"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557982773, "post_id": 56157900, "comment_id": 98949977, "body": "OK. mingw.org is old and unmaintained, you should use mingw-w64"}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "is_accepted": true, "score": 0, "last_activity_date": 1579370565, "creation_date": 1579370565, "answer_id": 59803385, "question_id": 56157900, "link": "https://stackoverflow.com/questions/56157900/wrong-calling-conventions-with-float-values-with-mingw/59803385#59803385", "title": "Wrong calling conventions with float values with MinGW", "body": "<p>Wrong to compare mingw 32bit and mingw 64bit binary, so when compiled with newest mingw-w64 all calling-conventions became as expected.</p>\n"}], "owner": {"reputation": 93, "user_id": 9173835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0HPLl.png?s=128&g=1", "display_name": "Jackalope", "link": "https://stackoverflow.com/users/9173835/jackalope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 59803385, "answer_count": 1, "score": 2, "last_activity_date": 1579370565, "creation_date": 1557955907, "last_edit_date": 1557956803, "question_id": 56157900, "link": "https://stackoverflow.com/questions/56157900/wrong-calling-conventions-with-float-values-with-mingw", "title": "Wrong calling conventions with float values with MinGW", "body": "<p>I am trying to use my assembly functions work with C code and found that MinGw doesn't follow calling conventions for floating-point values, and this differ from versions of mingw.</p>\n\n<p>Test file with single function test.c</p>\n\n<pre><code>#include &lt;xmmintrin.h&gt;\n\nfloat vector_dot(__m128 v1, __m128 v2)\n{\n     __m128 resp = _mm_mul_ps(v1, v2);\n     float res;\n     _mm_store_ss(&amp;res, resp);\n     return res;\n};\n</code></pre>\n\n<p>compiled to assembly</p>\n\n<pre><code>gcc -O -S test.c -msse4.1\n</code></pre>\n\n<pre><code>    .file   \"test.c\"\n    .text\n    .globl  _vector_dot\n    .def    _vector_dot;    .scl    2;  .type   32; .endef\n_vector_dot:\nLFB503:\n    .cfi_startproc\n    pushl   %ebp\n    .cfi_def_cfa_offset 8\n    .cfi_offset 5, -8\n    movl    %esp, %ebp\n    .cfi_def_cfa_register 5\n    andl    $-16, %esp\n    subl    $16, %esp\n    mulps   %xmm1, %xmm0\n    movss   %xmm0, 12(%esp)\n    flds    12(%esp)\n    leave\n    .cfi_restore 5\n    .cfi_def_cfa 4, 4\n    ret\n    .cfi_endproc\nLFE503:\n    .ident  \"GCC: (MinGW.org GCC-6.3.0-1) 6.3.0\"\n</code></pre>\n\n<p>float result stores to ST0 register, not xmm0, as it does on linux</p>\n\n<p>But in different version of MinGW:</p>\n\n<pre><code>    .file   \"test.c\"\n    .text\n    .globl  vector_dot\n    .def    vector_dot; .scl    2;  .type   32; .endef\n    .seh_proc   vector_dot\nvector_dot:\n    .seh_endprologue\n    movaps  (%rdx), %xmm0\n    mulps   (%rcx), %xmm0\n    ret\n    .seh_endproc\n    .ident  \"GCC: (x86_64-posix-seh-rev0, Built by MinGW-W64 project) 7.3.0\"\n</code></pre>\n\n<p>just 2 instructions, args in xmm0, xmm1 and result in xmm0, as expected.</p>\n\n<p>BUT, with this mingw, function calls from C code has wrong args, in rax and rdx registers</p>\n\n<p>My assemble</p>\n\n<pre><code>vector_dot: /* vector xmm0, vector xmm1 -&gt; float xmm0 */\n  mulps  %xmm1,%xmm0 \n\nvector_horizontal_sum: /* vector xmm0 -&gt; float xmm0 (0 + 1 + 2 + 3) */\n   movshdup  %xmm0, %xmm1\n   addps        %xmm1, %xmm0\n   movhlps     %xmm0, %xmm1\n   addss        %xmm1, %xmm0\n   ret\n</code></pre>\n\n<p>Function header in C</p>\n\n<pre><code>extern float vector_dot(__m128 vector_1, __m128 vector_2) asm(\"vector_dot\");\n</code></pre>\n\n<p>Calling my function</p>\n\n<pre><code>    float values1[] __attribute__((aligned(16))) = { 1.3f, 5.4f, -4.f, 5. } ;\n    __m128 vec1 = _mm_load_ps(values1);\n\n    float values2[] __attribute__((aligned(16))) = {0.5f, -43.5f, 0, 0 };\n    __m128 vec2 = _mm_load_ps(values2);\n\n    float dot = vector_dot(vec1, vec2);\n</code></pre>\n\n<p>Function call assembly, compiler not used xmm registers for args, cause to crash my program</p>\n\n<pre><code>0x401614  &lt;+  180&gt;        0f 28 45 e0                 movaps -0x20(%rbp),%xmm0\n0x401618  &lt;+  184&gt;        0f 29 85 40 ff ff ff        movaps %xmm0,-0xc0(%rbp)\n0x40161f  &lt;+  191&gt;        0f 28 45 d0                 movaps -0x30(%rbp),%xmm0\n0x401623  &lt;+  195&gt;        0f 29 85 30 ff ff ff        movaps %xmm0,-0xd0(%rbp)\n0x40162a  &lt;+  202&gt;        48 8d 95 30 ff ff ff        lea    -0xd0(%rbp),%rdx\n0x401631  &lt;+  209&gt;        48 8d 85 40 ff ff ff        lea    -0xc0(%rbp),%rax\n0x401638  &lt;+  216&gt;        48 89 c1                    mov    %rax,%rcx\n0x40163b  &lt;+  219&gt;        e8 d4 29 00 00              callq  0x404014 &lt;vector_dot&gt;\n0x401640  &lt;+  224&gt;        66 0f 7e c0                 movd   %xmm0,%eax\n0x401644  &lt;+  228&gt;        89 45 cc                    mov    %eax,-0x34(%rbp)\n</code></pre>\n\n<p>What is wrong with my code, is it MinGW compiler fault?</p>\n"}, {"tags": ["c++", "c", "visual-studio"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1557955198, "post_id": 56157726, "comment_id": 98944516, "body": "If there is a &quot;way&quot; that someone else has already fathomed, it&#39;s probably just a block of <code>#define</code> statements to copy and paste into your code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557955241, "post_id": 56157726, "comment_id": 98944526, "body": "By not using Visual C? What could be easier than adding the definitions to the source code?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1557955325, "post_id": 56157726, "comment_id": 98944556, "body": "Suck it up. You can&#39;t have <i>that</i> many projects for <code>_CRT_SECURE_NO_WARNINGS</code> addition to be that much of a headache? It&#39;s how the toolset works I&#39;m afraid."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1557955357, "post_id": 56157726, "comment_id": 98944567, "body": "<code>Using the safe variants of the functions isn&#39;t an option for me.</code> care to elaborate?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557955443, "post_id": 56157726, "comment_id": 98944589, "body": "They aren&#39;t all safer - because it is widely misunderstood how to use them. Such as the even more dangerous <code>scanf_s</code> when using <code>%c</code> and <code>%s</code> and <code>%[]</code>"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1557955453, "post_id": 56157726, "comment_id": 98944592, "body": "I sympathize with you. When I was working with VS, I had a check list of about 10 things I needed to do every time I created a new project. _CRT_SECURE_NO_WARNINGS was definitely on the list."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557955628, "post_id": 56157726, "comment_id": 98944656, "body": "My standard definitions are <code>#define _CRT_SECURE_NO_WARNINGS</code> and <code>#define _CRT_SECURE_NO_DEPRECATE</code> and <code>#define _CRT_NONSTDC_NO_DEPRECATE</code> (and <code>#define _USE_MATH_DEFINES</code>). I use a standard framework that contains them. Extra work: NULL."}, {"owner": {"reputation": 87, "user_id": 8319548, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQtW8DDYLIE/AAAAAAAAAAI/AAAAAAAAADM/AlOJOwc6Y5Y/photo.jpg?sz=128", "display_name": "LightningShock", "link": "https://stackoverflow.com/users/8319548/lightningshock"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557955843, "post_id": 56157726, "comment_id": 98944733, "body": "@WeatherVane doing nothing after setting it up once is the easiest. Also definitions are not an option for me either."}, {"owner": {"reputation": 87, "user_id": 8319548, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQtW8DDYLIE/AAAAAAAAAAI/AAAAAAAAADM/AlOJOwc6Y5Y/photo.jpg?sz=128", "display_name": "LightningShock", "link": "https://stackoverflow.com/users/8319548/lightningshock"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1557955878, "post_id": 56157726, "comment_id": 98944752, "body": "@SergeyA I&#39;m doing school projects and I&#39;m obligated to have the code portable and use certain standard libraries."}, {"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1557955969, "post_id": 56157726, "comment_id": 98944778, "body": "@LightningShock The <code>#define</code> statements won&#39;t break compatibility with other compilers"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557956013, "post_id": 56157726, "comment_id": 98944788, "body": "It is easier to start from <i>somewhere</i> rather than retyping everything. Mine has those <code>#define</code> definitions and a list of <code>#include</code> files. It&#39;s easier to remove those not needed than to keep typing them in in every project, and the task is no different with those definitions as well as the <code>#include</code> headers."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 8319548, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQtW8DDYLIE/AAAAAAAAAAI/AAAAAAAAADM/AlOJOwc6Y5Y/photo.jpg?sz=128", "display_name": "LightningShock", "link": "https://stackoverflow.com/users/8319548/lightningshock"}, "edited": false, "score": 0, "creation_date": 1573752303, "post_id": 56158600, "comment_id": 103995880, "body": "This one does it for me, thanks, but instead I just added my preprocessor definition on an empty C++ project and saved it as a template and it works wonders!"}], "tags": [], "owner": {"reputation": 14821, "user_id": 5743288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ea16526477fd6f1d4cc57f976af38d0?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Sanders", "link": "https://stackoverflow.com/users/5743288/paul-sanders"}, "is_accepted": true, "score": 2, "last_activity_date": 1557960457, "creation_date": 1557960457, "answer_id": 56158600, "question_id": 56157726, "link": "https://stackoverflow.com/questions/56157726/how-to-disable-deprecation-warnings-for-c-c-compiler-globally-in-visual-studio/56158600#56158600", "title": "How to disable deprecation warnings for C/C++ compiler globally in Visual Studio 2019?", "body": "<p>You can create custom project templates in Visual Studio, so you should be able to create one of these with whatever <code>#defines</code> you want pre-configured in the properties page.</p>\n\n<p>MS documentation is <a href=\"https://docs.microsoft.com/en-us/visualstudio/ide/how-to-create-project-templates?view=vs-2019\" rel=\"nofollow noreferrer\">here</a> and a guy called Srinivasa Rao Dhulipalla has blogged about it <a href=\"https://www.ecanarys.com/Blogs/ArticleID/180/Create-custom-project-templates-in-Visual-Studio\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 87, "user_id": 8319548, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uQtW8DDYLIE/AAAAAAAAAAI/AAAAAAAAADM/AlOJOwc6Y5Y/photo.jpg?sz=128", "display_name": "LightningShock", "link": "https://stackoverflow.com/users/8319548/lightningshock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 895, "favorite_count": 0, "accepted_answer_id": 56158600, "answer_count": 1, "score": -1, "last_activity_date": 1557960457, "creation_date": 1557954919, "question_id": 56157726, "link": "https://stackoverflow.com/questions/56157726/how-to-disable-deprecation-warnings-for-c-c-compiler-globally-in-visual-studio", "title": "How to disable deprecation warnings for C/C++ compiler globally in Visual Studio 2019?", "body": "<p>I want to have deprecation warnings(C4996, the ones caused by calling functions like strcpy) disabled by default in all C/C++ projects in Visual Studio 2019.</p>\n\n<p>There are several ways on the internet on how to do it, but they are all on a per-project basis, the most straightforward way is to add _CRT_SECURE_NO_WARNINGS to the preprocessor definitions. But I want to achieve this effect automatically, without having to fiddle with the project setting each time I make a new project.</p>\n\n<p>I know there must be a way. I don't care how \"hacky\" the method is. Using the safe variants of the functions isn't an option for me.</p>\n"}, {"tags": ["python", "c"], "comments": [{"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558018489, "post_id": 56157725, "comment_id": 98969282, "body": "<i>The actual array passed is ...</i>. Where in above code is that array passed? and where is it printed? BTW: the <code>&lt;</code> redirection is normally interpreted at shell level, not by the command, so I wander how the C program finds something to read..."}, {"owner": {"reputation": 324, "user_id": 6499614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/124e72315edcf08d379f261f53a46469?s=128&d=identicon&r=PG&f=1", "display_name": "shaifali Gupta", "link": "https://stackoverflow.com/users/6499614/shaifali-gupta"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558018636, "post_id": 56157725, "comment_id": 98969381, "body": "bb is that array. The received array is printed through C program."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558018790, "post_id": 56157725, "comment_id": 98969485, "body": "You should try to give enough code for others to reproduce, that is what is called a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Without that I cannot guess what exactly you do, nor what you would want."}, {"owner": {"reputation": 324, "user_id": 6499614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/124e72315edcf08d379f261f53a46469?s=128&d=identicon&r=PG&f=1", "display_name": "shaifali Gupta", "link": "https://stackoverflow.com/users/6499614/shaifali-gupta"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558018872, "post_id": 56157725, "comment_id": 98969538, "body": "This itself is the full code. I have not written further C code yet. Right now, I am testing how to pass numpy arrayas or matrices to C from python."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558019268, "post_id": 56157725, "comment_id": 98969805, "body": "What is the Python code that passes the array? <code>communicate</code> passes just nothing here!"}, {"owner": {"reputation": 324, "user_id": 6499614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/124e72315edcf08d379f261f53a46469?s=128&d=identicon&r=PG&f=1", "display_name": "shaifali Gupta", "link": "https://stackoverflow.com/users/6499614/shaifali-gupta"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558019443, "post_id": 56157725, "comment_id": 98969907, "body": "The two lines mentioned above is the ony python code. Perhaps what you mentioned could be the problem. I am not familiar with the syntax. Can you please specify what to pass using communicate?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558019721, "post_id": 56157725, "comment_id": 98970058, "body": "My question is just <i>where on earth can come <code>b&#39;0.0000000.0000000.0000000.0000000.0000000.0000000.0000000.&zwnj;&#8203;0000000.0000000.0000&zwnj;&#8203;00&#39;</code>?</i> because nothing in shown code can print that. Is there at least a <code>print stdout</code> or anything else. If you do not want to answer, I will not be able to help..."}, {"owner": {"reputation": 324, "user_id": 6499614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/124e72315edcf08d379f261f53a46469?s=128&d=identicon&r=PG&f=1", "display_name": "shaifali Gupta", "link": "https://stackoverflow.com/users/6499614/shaifali-gupta"}, "reply_to_user": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 0, "creation_date": 1558019835, "post_id": 56157725, "comment_id": 98970129, "body": "Yes, this is print stdout"}], "answers": [{"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1558020793, "creation_date": 1558020793, "answer_id": 56172055, "question_id": 56157725, "link": "https://stackoverflow.com/questions/56157725/issue-with-passing-array-to-subprocess-module-while-calling-c-program-from-pytho/56172055#56172055", "title": "Issue with passing array to subprocess module while calling c program from python", "body": "<p>The only channels between a process and its subprocess are pipes, that is simple streams of bytes.</p>\n\n<p>The C programs receives an empty stdin stream through <code>communicate</code>, which is the same as reading from an empty file. It reads 10 values from that (and finds nothing) so every <code>scanf</code> returns -1 and does not change the original value of <code>rhs[i]</code> which just happens to be <code>0.</code>. Then it prints that on its stdout channel, that is 10 <code>0.</code> double value if <code>%f</code> format.</p>\n\n<p>And the Python script receives that byte string in its <code>stdout</code> variable. The initial <code>b</code> is just the marker that <code>stdout</code> is a byte string and not an unicode string.</p>\n\n<p>If that matters, there is no way to pass complex objects between a process and its subprocess: everything must be serialized at a string of bytes by the sender and deserialized by the receiver. The Python <code>struct</code> module is specifically good at serializing simple types in a portable way so that they can be easily deserialized in C.</p>\n"}], "owner": {"reputation": 324, "user_id": 6499614, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/124e72315edcf08d379f261f53a46469?s=128&d=identicon&r=PG&f=1", "display_name": "shaifali Gupta", "link": "https://stackoverflow.com/users/6499614/shaifali-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1558042248, "answer_count": 1, "score": 0, "last_activity_date": 1558030458, "creation_date": 1557954917, "last_edit_date": 1558030458, "question_id": 56157725, "link": "https://stackoverflow.com/questions/56157725/issue-with-passing-array-to-subprocess-module-while-calling-c-program-from-pytho", "closed_reason": "Needs details or clarity", "title": "Issue with passing array to subprocess module while calling c program from python", "body": "<p>I am using this code to call a C script from Python:</p>\n\n<pre><code>subprocess.check_output([\"./s_cg\",str(10),str(bb)])\n</code></pre>\n\n<p>The C script has code:</p>\n\n<pre><code>int main(int argc, char *argv[])\n{\nint order;\nint i,j;\norder = atoi(argv[1]);\n\ndouble* rhs = malloc(order * sizeof(double));\nfor (i = 0; i &lt; order; i++) {\n              scanf(\"%lf\", &amp;rhs[i])\n\n          }\n\n\n for(i=0;i&lt;order;i++)\n  {\n    printf(\"%lf\",rhs[i]);\n  }\n\n    return 0;\n</code></pre>\n\n<p>}</p>\n\n<p>The actual array bb passed is: <code>array([1., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</code></p>\n\n<p>But the printed array is: </p>\n\n<blockquote>\n  <p>b'0.0000000.0000000.0000000.0000000.0000000.0000000.0000000.0000000.0000000.000000'</p>\n</blockquote>\n"}, {"tags": ["c", "eof", "fseek", "ftell"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557954969, "post_id": 56157698, "comment_id": 98944429, "body": "The newline might be taking <b>two</b> characters in the file."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1557955630, "post_id": 56157698, "comment_id": 98944658, "body": "&#255; is special, character code 0xff.  Easiest way to get it is casting or printf-ing EOF to char."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1557955756, "creation_date": 1557955756, "answer_id": 56157874, "question_id": 56157698, "link": "https://stackoverflow.com/questions/56157698/y-with-umlaut-in-file/56157874#56157874", "title": "y with umlaut in file", "body": "<p>The outputs are different because your loop reads two characters from <code>fp</code> per iteration.</p>\n\n<p>For example, in the first iteration <code>i</code> is <code>1</code> and so <code>fseek</code> sets the current file position of <code>fp</code> just before the last byte:</p>\n\n<pre><code>...\nThese are all palindromes\n                        ^\n</code></pre>\n\n<p>Then <code>printf(\"%c\",fgetc(fp));</code> reads a byte (<code>s</code>) and prints it to the console. Having read the <code>s</code>, the file position is now</p>\n\n<pre><code>...\nThese are all palindromes\n                         ^\n</code></pre>\n\n<p>i.e. we're at the end of the file.</p>\n\n<p>Then <code>fputc(fgetc(fp),fnew);</code> attempts to read another byte from <code>fp</code>. This fails and <code>fgetc</code> returns <code>EOF</code> (a negative value, usually <code>-1</code>) instead. However, your code is not prepared for this and blindly treats <code>-1</code> as a character code. Converted to a byte, <code>-1</code> corresponds to <code>255</code>, which is the character code for <code>\u00ff</code> in the ISO-8859-1 encoding. This byte is written to your file.</p>\n\n<p>In the next iteration of the loop we seek back to the <code>e</code>:</p>\n\n<pre><code>...\nThese are all palindromes\n                       ^\n</code></pre>\n\n<p>Again the loop reads two characters: <code>e</code> is written to the console, and <code>s</code> is written to the file.</p>\n\n<p>This continues backwards until we reach the beginning of the input file:</p>\n\n<pre><code>redivider\n^\n</code></pre>\n\n<p>Yet again the loop reads two characters: <code>r</code> is written to the console, and <code>e</code> is written to the file.</p>\n\n<p>This ends the loop. The end result is that your output file contains one character that doesn't exist (from the attempt to read past the end of the input file) and never sees the first character.</p>\n\n<p>The fix is to only call <code>fgetc</code> once per loop:</p>\n\n<pre><code>while(i &lt; endNum+1)\n{\n    fseek(fp,-i,SEEK_END);\n    int c = fgetc(fp);\n    if (c == EOF) {\n        perror(\"error reading from mainText.txt\");\n        exit(EXIT_FAILURE);\n    }\n    printf(\"%c\", c);\n    fputc(c, fnew);\n    i++;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557971366, "post_id": 56158667, "comment_id": 98947776, "body": "Yeah, <code>ftell</code> isn&#39;t required to return file offsets in text mode. It could theoretically just return arbitrary values that <code>fseek</code> understands (but that do not allow any meaningful arithmetic)."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1557961044, "creation_date": 1557961044, "answer_id": 56158667, "question_id": 56157698, "link": "https://stackoverflow.com/questions/56157698/y-with-umlaut-in-file/56158667#56158667", "title": "y with umlaut in file", "body": "<p>In addition to <a href=\"https://stackoverflow.com/a/56157874/2410359\">@melpomene</a> correction about using only 1 <code>fgetc()</code> per loops, other issues exist.</p>\n\n<p><strong><code>fseek(questionable_offset)</code></strong></p>\n\n<p><code>fopen(\"mainText.txt\",\"r\");</code> opens the file in <em>text</em> mode and not <em>binary</em> mode.  Thus the using <code>fseek(various_values)</code> as a valid offset into the file is prone to troubles.  Usually not a problem in *nix systems.</p>\n\n<p>I do not have a simple alternative.</p>\n\n<p><strong><code>ftell()</code> return type</strong></p>\n\n<p><code>ftell()</code> return <code>long</code>.  Use <code>long</code> instead of <code>int i, endNum</code>.  (Not a concern with small files)</p>\n\n<p><strong>Check return values</strong></p>\n\n<p><code>ftell()</code> and <code>fseek()</code> can fail.  Test for error returns.</p>\n"}], "owner": {"reputation": 137, "user_id": 9420077, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U7yYy.jpg?s=128&g=1", "display_name": "Karl", "link": "https://stackoverflow.com/users/9420077/karl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 56157874, "answer_count": 2, "score": 1, "last_activity_date": 1557961044, "creation_date": 1557954764, "question_id": 56157698, "link": "https://stackoverflow.com/questions/56157698/y-with-umlaut-in-file", "title": "y with umlaut in file", "body": "<p>I'm working on an example problem where I have to reverse the text in a text file using fseek() and ftell(). I was successful, but printing the same output to a file, I had some weird results.\nThe text file I input was the following:</p>\n\n<p>redivider<br>\nracecar<br>\nkayak<br>\ncivic<br>\nlevel<br>\nrefer<br>\nThese are all palindromes</p>\n\n<p>The result in the command line works great. In the text file that I create however, I get the following:</p>\n\n<p>\u00ffsemordnilap lla era esehTT<br>\nreferr<br>\nlevell<br>\ncivicc<br>\nkayakk<br>\nracecarr<br>\nredivide  </p>\n\n<p>I am aware from the answer to <a href=\"https://stackoverflow.com/questions/1738139/what-does-y-in-the-output-stand-for-in-c\">this question</a> says that this corresponds to the text file version of EOF in C. I'm just confused as to why the command line and text file outputs are different.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/**********************************\nThis program is designed to read in a text file and then reverse the order \nof the text.\nThe reversed text then gets output to a new file.\nThe new file is then opened and read.\n**********************************/\n\nint main()\n{\n    //Open our files and check for NULL\n    FILE *fp = NULL;\n    fp = fopen(\"mainText.txt\",\"r\");\n    if (!fp)\n        return -1;\n\n    FILE *fnew = NULL;\n    fnew = fopen(\"reversedText.txt\",\"w+\");\n    if (!fnew)\n        return -2;\n\n    //Go to the end of the file so we can reverse it\n    int i = 1;\n    fseek(fp, 0, SEEK_END);\n    int endNum = ftell(fp);\n    while(i &lt; endNum+1)\n    {\n        fseek(fp,-i,SEEK_END);\n        printf(\"%c\",fgetc(fp));\n        fputc(fgetc(fp),fnew);\n        i++;\n    }\n\n    fclose(fp);\n    fclose(fnew);\n    fp = NULL;\n    fnew = NULL;\n\n    return 0;\n}\n</code></pre>\n\n<p>No errors, I just want identical outputs.</p>\n"}, {"tags": ["c", "fopen"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1557952637, "post_id": 56157242, "comment_id": 98943571, "body": "Check the <code>errno</code> after <code>fopen</code>. Use <code>perror</code> to print a descriptive message. My bet would be that the working directory is not what you think and it simply can&#39;t find this file."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1557953356, "post_id": 56157242, "comment_id": 98943835, "body": "Try an absolute path to the file, like <code>&#47;Users&#47;ashepherd&#47;myfolder&#47;inName.dat</code>. If that works, it supports the hypothesis that the working directory is different in the IDE than in the Terminal, as is quite likely."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1557956408, "post_id": 56157242, "comment_id": 98944908, "body": "How are you running your program in the terminal? What&#39;s the exact command you&#39;re using?"}, {"owner": {"reputation": 11, "user_id": 11506296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578f40ba111f62e83ce8d8ea9f919c61?s=128&d=identicon&r=PG&f=1", "display_name": "A.Shepherd", "link": "https://stackoverflow.com/users/11506296/a-shepherd"}, "edited": false, "score": 0, "creation_date": 1558009417, "post_id": 56157242, "comment_id": 98963418, "body": "Problem solved.  I had the file in the same directory as my executable code - which had always worked in the past.  Using the absolute path revealed where it was actually looking for the file - which was in fact in a different directory.  No idea why it was looking there - but it solved my problem.  Thanks!"}], "owner": {"reputation": 11, "user_id": 11506296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/578f40ba111f62e83ce8d8ea9f919c61?s=128&d=identicon&r=PG&f=1", "display_name": "A.Shepherd", "link": "https://stackoverflow.com/users/11506296/a-shepherd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557952526, "creation_date": 1557952526, "question_id": 56157242, "link": "https://stackoverflow.com/questions/56157242/in-c-fopen-is-working-from-ide-xcode-but-wont-open-file-in-terminal-mac", "title": "In C, fopen() is working from IDE (Xcode), but won&#39;t open file in Terminal (Mac)", "body": "<p>I'm new and learning C.  My code works perfectly when running in IDE (Xcode).  fopen() opens the file inName.dat - parses the characters - and outputs to the two outName files and stdout - as expected.</p>\n\n<p>But when I try to run the program from Terminal (I use a Mac) - the file inName.dat won't open.  </p>\n\n<p>I've tried replacing the pointer in the fopen() call with a direct file name \"inName.dat\" - but it still won't open - when run in Terminal.</p>\n\n<p>All three files inName.dat, outName1.dat and outName.dat2 exist and are in the same file as the application files.</p>\n\n<p>I know the error is at the point the file is being opened - I've added the printed error message there to be sure.</p>\n\n<pre><code>/* My main application */\n\nint main() {\n    char *inFileName;\n    char *outFileName1 = \"outName1.dat\";\n    char *outFileName2 = \"outName2.dat\";\n\n    if((inFileName = calloc(25, sizeof(char))) == NULL) {\n        fprintf(stderr, \"Failure allocating memory\\n\");\n        return EXIT_FAILURE;\n    }\n\n    printf(\"Enter filename to split: \\n\");\n    scanf(\"%s\", inFileName);\n\n    split(inFileName, outFileName1, outFileName2);\n\n    return EXIT_SUCCESS;\n}\n\n/* My implementation file */\n\nint split(const char* inName, const char* outName1, const char*\n    outName2) {\n    FILE *inFile;\n    FILE *outFile1;\n    FILE *outFile2;\n    char *inBuffer;\n    char *outBuffer1;\n    char *outBuffer2;\n    char *stdoutBuff;\n    int out1, out2, outstd;\n\n    /* open three files */\n    if((inFile = fopen(inName, \"r\")) == NULL) {\n        printf(\"The error is here\"); /* Prints, then app ends */\n        return 0;\n    }\n    if((outFile1 = fopen(outName1, \"w\")) == NULL) {\n        fclose(inFile);\n        return 0;\n    }\n    if((outFile2 = fopen(outName2, \"w\")) == NULL) {\n        fclose(inFile);\n        fclose(outFile1);\n        return 0;\n    }\n\n    /* allocate memory to buffers */\n    if((inBuffer = calloc(500, sizeof(char))) == NULL) {\n        fprintf(stderr, \"Inbuffer memory allocation error\\n\");\n        return EXIT_FAILURE;\n    }\n    if((outBuffer1 = calloc(500, sizeof(char))) == NULL) {\n        fprintf(stderr, \"Outbuffer1 memory allocation error\\n\");\n        return EXIT_FAILURE;\n    }\n    if((outBuffer2 = calloc(500, sizeof(char))) == NULL) {\n        fprintf(stderr, \"Outbuffer2 memory allocation error\\n\");\n        return EXIT_FAILURE;\n    }\n    if((stdoutBuff = calloc(500, sizeof(char))) == NULL) {\n        fprintf(stderr, \"Stdoutbuffer memory allocation error\\n\");\n        return EXIT_FAILURE;\n    }\n\n    /* read in from input file to inBuffer */\n    if(fgets(inBuffer, 500, inFile) == NULL) {\n        fprintf(stderr, \"Input from file error\\n\");\n        return EXIT_FAILURE;\n    }\n\n    /* sort each letter to out buffers as lower/uppercase/other */\n    for(out1 = 0, out2 = 0, outstd = 0; *inBuffer; inBuffer++) {\n        if(islower(inBuffer[0])) {\n            outBuffer1[out1] = inBuffer[0];\n            out1++;\n        } else if(isupper(inBuffer[0])) {\n            outBuffer2[out2] = inBuffer[0];\n            out2++;\n        } else {\n            stdoutBuff[outstd] = inBuffer[0];\n            outstd++;\n        }\n    }\n\n    /* print the out buffers to file 1,2 and stdout */\n    if(fputs(outBuffer1, outFile1) == EOF) {\n        return 0;\n    }\n    if(fputs(outBuffer2, outFile2) == EOF) {\n        return 0;\n    }\n    printf(\"Non lower / uppercase letters from file:\\n\");\n    if(fputs(stdoutBuff, stdout) == EOF) {\n        return 0;\n    }  \n    return 1;\n}\n</code></pre>\n\n<p>No crash or error message - it just prints my line \"The error is here\", then returns 0 to main, which ends the program.</p>\n"}, {"tags": ["c", "gcc", "sizeof"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557949351, "post_id": 56156513, "comment_id": 98942222, "body": "This is probably helpful, but it&#39;s not an answer itself:  <a href=\"https://en.wikipedia.org/wiki/64-bit_computing\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/64-bit_computing</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557950628, "post_id": 56156513, "comment_id": 98942735, "body": "To the best of my knowledge, all versions of GCC use 8-byte <code>long int</code>s when compiling Linux x86_64 binaries.  On the other hand, they all use 4-byte <code>long int</code>s when compiling Linux x86 binaries.  It&#39;s not about the form or host of the compiler, it&#39;s about the <i>target</i>."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1557952251, "post_id": 56156513, "comment_id": 98943402, "body": "I&#39;m guessing that Windows is probably used with GCC 7. Windows has the LLP64 data model, which defines <code>long</code> as 32-bit (4 bytes)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1557961418, "post_id": 56156513, "comment_id": 98946090, "body": "The C standard also requires <code>sizeof(char) == 1</code>, <code>sizeof(short)*CHAR_BIT &gt;= 16</code>,  <code>sizeof(int)*CHAR_BIT &gt;= 16</code>,  <code>sizeof(long)*CHAR_BIT &gt;= 32</code>."}], "answers": [{"comments": [{"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1557949368, "post_id": 56156532, "comment_id": 98942226, "body": "This is a good answer, but I would like to know more about why the same compiler uses different sizes on the same arhitecture with the same Compiler. If the operating system is 64BIT I can not understand the difference."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1557949395, "post_id": 56156532, "comment_id": 98942241, "body": "Changing trends. People used to be a lot more sensitive about making <code>long int</code> 64-bits back when computers had less memory, but now it&#39;s no big deal. 64-bit CPUs have been around long enough that 128MB used to be a ton of memory. Over time a lot of things have gotten bigger because there&#39;s less pressure to shave bytes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557949520, "post_id": 56156532, "comment_id": 98942285, "body": "<i>The compiler calls all the shots.</i>  Not really.  Data sizes are specified by the <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">ABI</a>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557949545, "post_id": 56156532, "comment_id": 98942296, "body": "It&#39;s worth noting that more modern C code often uses different constants to avoid ambiguity, such as <a href=\"https://en.cppreference.com/w/c/types/integer\" rel=\"nofollow noreferrer\">those introduced in C99</a> like <code>int64_t</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557949581, "post_id": 56156532, "comment_id": 98942311, "body": "@tadman it is not the truth of course. If you compile to run on the 64 bit system long will be 8 bits. If you compile to be run on the 32 bits system - it will be 4,\\ This (and much more) is called ABI to let compiler know how to generate the code.,"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557949612, "post_id": 56156532, "comment_id": 98942321, "body": "@AndrewHenle True, but that&#39;s often dictated by what the compiler does, since in the case of Linux it&#39;s an ouroboros, compiler compiling the ABI, and the ABI constraining the compiler."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 1, "creation_date": 1557949693, "post_id": 56156532, "comment_id": 98942367, "body": "@tadman ABI is not constraining the compiler. Obeying the ABI makes the program runable on the particular system"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557949770, "post_id": 56156532, "comment_id": 98942403, "body": "@P__J__ I&#39;m speaking here to how Linux, as one example, has been hugely influenced in its design by GCC and its capabilities."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1557949803, "post_id": 56156532, "comment_id": 98942419, "body": "@tadman Pedantically, a compiler produces binaries compatible with the target ABI.  But since ABIs and compilers tend to come from the same people at the same time (one without the other isn&#39;t very useful unless you like assembler), it&#39;s <i>de facto</i>  more of a chicken-and-egg problem to say which comes first and which one &quot;rules&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557949833, "post_id": 56156532, "comment_id": 98942430, "body": "@AndrewHenle Said it much better than I did. Thanks."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "reply_to_user": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1557949910, "post_id": 56156532, "comment_id": 98942465, "body": "@P__J__ See also Microsoft Windows and Microsoft&#39;s C++ compiler, SunOS and Sun&#39;s C compiler, IRIX and SGI&#39;s C compiler, HP/UX and HP&#39;s C compiler and I could list like a hundred more. There&#39;s a symbiotic relationship here as Andrew did a good job of explaining."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 2, "creation_date": 1557950064, "post_id": 56156532, "comment_id": 98942518, "body": "@Michi: Re \u201cI would like to know more about why the same compiler uses different sizes on the same arhitecture with the same Compiler. If the operating system is 64BIT I can not understand the difference.\u201d: The operating system can only control how software interfaces with it. If there is an operating system routine that needs to be passed a 32-bit integer, then you have to pass it a 32-bit integer. But, inside the program, the program (and the compiler) can do anything they want. If a compiler wants to call a 32-bit integer an <code>int</code> and call a 48-bit integer a <code>gromitz</code>, then it can."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "edited": false, "score": 0, "creation_date": 1557950191, "post_id": 56156532, "comment_id": 98942570, "body": "@Michi: Think about writing software. You can use a lot of different code to implement effectively the same loop. Similarly, the compiler can generate whatever instructions it needs to make integers or other types behave the way it wants. It is a computer\u2014a general purpose computer\u2014so it can be programmed in practically infinitely many different ways. When writing the compiler, we can make the <code>char</code>, <code>short</code>, <code>int</code>, and <code>long</code> types in a program behave any way we want, just by writing the right programming."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557952570, "post_id": 56156532, "comment_id": 98943543, "body": "The driver for different implementations for the same target to name their types the same way is not ABI, as @EricPostpischil has said several times now.  It is the desire for <i>interoperability</i> and <i>binary compatibility</i>.  Implementations must agree about how they name their types, else it is difficult for code (e.g. libraries) built by or intended for use with one to be used with another.  That is, however, a quality of implementation issue, not any kind of requirement."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 6, "last_activity_date": 1557949210, "creation_date": 1557949210, "answer_id": 56156532, "question_id": 56156513, "link": "https://stackoverflow.com/questions/56156513/what-defines-the-size-of-a-type/56156532#56156532", "title": "What defines the size of a type?", "body": "<p>The compiler calls all the shots. The operating system just runs the resulting binary.</p>\n\n<p>That being said, the compiler will normally make an executable the operating system can use, so there's some interplay here. Since things like the size of <code>int</code> don't really matter <em>so long as they're consistent</em>, you will see variation.</p>\n\n<p>In other words, if the kernel expects <code>long int</code> to be 8 bytes because of how it was compiled, then you'll want to compile that way to match or your compiled code won't match and none of the shared libraries will work.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557949910, "post_id": 56156629, "comment_id": 98942467, "body": "The compiler decides the mapping from its type names to the types in the ABI."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557950056, "post_id": 56156629, "comment_id": 98942513, "body": "@EricPostpischil  Feel free to edit.  I suspect you know a lot more about this than I do.  ;-)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557950233, "post_id": 56156629, "comment_id": 98942588, "body": "@EricPostpischil I just changed my answer to a community wiki.  It&#39;s all yours to improve."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557950234, "post_id": 56156629, "comment_id": 98942589, "body": "<a href=\"https://stackoverflow.com/a/56156532/298225\">tadman\u2019s answer</a> is correct."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557950393, "post_id": 56156629, "comment_id": 98942653, "body": "@EricPostpischil But that just means the compiler is using types provided by the ABI.  The choices a compiler has are constrained, so the ABI can&#39;t be ignored."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 4, "creation_date": 1557950780, "post_id": 56156629, "comment_id": 98942816, "body": "The ABI (which, by the way, is voluntary) can only specify how to pass integers of 8, 16, 32, or other numbers of bits, how to pass floating-point objects of various sizes, how to pass structures, and so on. It cannot control what they are called in the programming language. If <code>long</code> is a 32-bit integer in the programming language, it will be passed as a 32-bit integer in the ABI. If <code>long</code> is a 64-bit integer in the programming language, it will be passed as a 64-bit integer in the ABI. The ABI never sees the name. The compiler decides what the name means."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 4, "last_activity_date": 1557949685, "creation_date": 1557949685, "answer_id": 56156629, "question_id": 56156513, "link": "https://stackoverflow.com/questions/56156513/what-defines-the-size-of-a-type/56156629#56156629", "title": "What defines the size of a type?", "body": "<p>The <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">Application Binary Interface</a> for an operating system/architecture specifies the sizes of basic types:</p>\n\n<p>ABIs cover details such as (bolding mine):</p>\n\n<blockquote>\n  <ul>\n  <li>a processor instruction set (with details like register file structure, stack organization, memory access types, ...)</li>\n  <li><strong>the sizes, layouts, and alignments of basic data types that the processor can directly access</strong></li>\n  <li>the calling convention, which controls how functions' arguments are passed and return values are retrieved; for example, whether all\n  parameters are passed on the stack or some are passed in registers,\n  which registers are used for which function parameters, and whether\n  the first function parameter passed on the stack is pushed first or\n  last onto the stack</li>\n  <li>how an application should make system calls to the operating system and, if the ABI specifies direct system calls rather than procedure\n  calls to system call stubs, the system call numbers</li>\n  <li>and in the case of a complete operating system ABI, the binary format of object files, program libraries and so on.</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 3, "last_activity_date": 1557951933, "last_edit_date": 1557951933, "creation_date": 1557951357, "answer_id": 56156990, "question_id": 56156513, "link": "https://stackoverflow.com/questions/56156513/what-defines-the-size-of-a-type/56156990#56156990", "title": "What defines the size of a type?", "body": "<p>This is left to the discretion of the implementation.</p>\n\n<p>It's the <em>implementation</em> (compiler and standard library) that defines the size of <code>long</code>, <code>int</code>, and all other types.</p>\n\n<p>As long as they fit the constraints given by the standard, the implementation can make all the decisions as to what sizes the types are (possibly with the exception of pointers).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1557961646, "post_id": 56157861, "comment_id": 98946139, "body": "Note: Standard also requires <code>sizeof(char)==1</code> in addition to various type range requirements."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 2, "last_activity_date": 1557955721, "creation_date": 1557955721, "answer_id": 56157861, "question_id": 56156513, "link": "https://stackoverflow.com/questions/56156513/what-defines-the-size-of-a-type/56157861#56157861", "title": "What defines the size of a type?", "body": "<p><strong>TL/DR</strong> - the exact size is up the compiler.</p>\n\n<hr>\n\n<p>The Standard requires that a type be able to represent a minimum <em>range of values</em> - for example, an <code>unsigned char</code> must be able to represent <em>at least</em> the range <code>[0..255]</code>, an <code>int</code> must be able to represent <em>at least</em> the range <code>[-32767...32767]</code>, etc.  </p>\n\n<p>That minimum range defines a minimum number of bits - you need <em>at least</em> 16 bits to represent the range <code>[-32767..32767]</code> (some systems may use padding bits or parity bits that are part of the word, but not used to represent the value).  </p>\n\n<p>Other architectural considerations come into play - <code>int</code> is <em>usually</em> set to be the same size as the native word size.  So on a 16-bit system, <code>int</code> would (usually) be 16 bits, while on a 32-bit system it would be 32 bits.  So, ultimately, it comes down the the compiler.  </p>\n\n<p>However, it's possible to have one compiler on a 32-bit system use a 16-bit <code>int</code>, while another uses a 32-bit <code>int</code>.  That led to a wasted afternoon back in the mid-90s where I had written some code that assumed a 32-bit <code>int</code> that worked fine under one compiler but <em>broke the world</em> under a different compiler on the same hardware.  </p>\n\n<p>So, lesson learned - never <em>assume</em> that a type can represent values outside of the <em>minimum</em> guaranteed by the Standard.  Either check against the contents of <code>limits.h</code> and <code>float.h</code> to see if the type is big enough, or use one of the sized types from <code>stdint.h</code> (<code>int32_t</code>, <code>uint8_t</code>, etc.).  </p>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 56156532, "answer_count": 4, "score": 5, "last_activity_date": 1557988889, "creation_date": 1557949079, "last_edit_date": 1557962196, "question_id": 56156513, "link": "https://stackoverflow.com/questions/56156513/what-defines-the-size-of-a-type", "title": "What defines the size of a type?", "body": "<p>The ISO C standard says that:</p>\n\n\n\n<pre><code>sizeof(char) &lt;= sizeof(short) &lt;= sizeof(int) &lt;= sizeof(long)\n</code></pre>\n\n<p>I am using GCC-8 on BIT Linux mint (19.1) and the size of <code>long int</code> is <code>8</code>.</p>\n\n<p>I am using an app which uses GCC 7 and the compiler is 64-bit.\nThe size of <code>long int</code> is <code>4</code>.\nDoes the compiler or the operating system define the size of a <code>long int</code>?</p>\n"}, {"tags": ["c", "pointers", "struct", "free"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1557948490, "post_id": 56156369, "comment_id": 98941869, "body": "<code>list-&gt;storage[pos] = (char*)malloc(strlen(string) * sizeof(char));     list-&gt;storage[pos] = string;</code> is nonsense."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1557948548, "post_id": 56156369, "comment_id": 98941900, "body": "Perhaps you meant to do the equivalent of <code>strdup</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1557948742, "post_id": 56156369, "comment_id": 98941974, "body": "<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">don&#39;t cast malloc</a>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1557948784, "post_id": 56156369, "comment_id": 98941994, "body": "You need to add 1 to <code>strlen(string)</code>, to add space for the trailing null byte."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557948806, "post_id": 56156369, "comment_id": 98942001, "body": "You have to use <code>strcpy()</code> to copy the string into the allocated space."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1557949056, "post_id": 56156369, "comment_id": 98942100, "body": "Why are you passing a <code>List **</code> to <code>delete_list</code> rather than just a <code>List *</code>?  The extra level of indirection seems pointless."}, {"owner": {"reputation": 111, "user_id": 11303552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c561a86a58846e1e41d5cf3265308a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias M.", "link": "https://stackoverflow.com/users/11303552/tobias-m"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1557951799, "post_id": 56156369, "comment_id": 98943213, "body": "@AnttiHaapala  yes you absolute right, this was standing there first, but with some testing i tried it also only copy it."}, {"owner": {"reputation": 111, "user_id": 11303552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c561a86a58846e1e41d5cf3265308a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias M.", "link": "https://stackoverflow.com/users/11303552/tobias-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557951802, "post_id": 56156369, "comment_id": 98943217, "body": "@Barmar thanks for this tip, i have deleted the cast&#39;s and also to add +1 to the strlen"}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 11303552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c561a86a58846e1e41d5cf3265308a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias M.", "link": "https://stackoverflow.com/users/11303552/tobias-m"}, "edited": false, "score": 0, "creation_date": 1557951410, "post_id": 56156451, "comment_id": 98943056, "body": "thanks for your fast and great answer. And also for your usefull tips.  But i have a further question: then the storage is to small, i will douple it. For example it has size two and two elements are in it. Then i want to add a third item, it should be reallocated with size 4. I done this with the line: &#39;list-&gt;storage = realloc(list-&gt;storage, size * 2);&#39;  it seem to work so far, but then i want to free this memory i get an error. Make i were something wrong?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "reply_to_user": {"reputation": 111, "user_id": 11303552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c561a86a58846e1e41d5cf3265308a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias M.", "link": "https://stackoverflow.com/users/11303552/tobias-m"}, "edited": false, "score": 0, "creation_date": 1557982673, "post_id": 56156451, "comment_id": 98949950, "body": "@TobiasM. You probably need <code>size * 2 * sizeof(char*)</code>"}], "tags": [], "owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "is_accepted": true, "score": 1, "last_activity_date": 1557949474, "last_edit_date": 1557949474, "creation_date": 1557948715, "answer_id": 56156451, "question_id": 56156369, "link": "https://stackoverflow.com/questions/56156369/deallocationg-char-inside-a-struct/56156451#56156451", "title": "Deallocationg char** inside a struct", "body": "<p>This allocation is wrong:</p>\n\n<pre><code>listptr-&gt;storage = (char**)malloc(size * sizeof(char));\n                                                ^^^^^\n</code></pre>\n\n<p>As <code>storage</code> is a <code>char**</code> the sizeof should be <code>sizeof(char*)</code>. When you only use <code>sizeof(char)</code> you end up with too little memory and later you write outside the allocated memory.</p>\n\n<p>Also this line:</p>\n\n<pre><code>list-&gt;storage[pos] = string;\n</code></pre>\n\n<p>seems wrong. </p>\n\n<p>Here you probably need a <code>strcpy</code> like:</p>\n\n<pre><code>strcpy(list-&gt;storage[pos], string)\n</code></pre>\n\n<p>and also add 1 to the malloc for the string termination, i.e. </p>\n\n<pre><code>malloc((1 + strlen(string)) * sizeof(char));\n</code></pre>\n\n<p>but notice that <code>sizeof(char)</code> is always 1 so</p>\n\n<pre><code>malloc(1 + strlen(string));\n</code></pre>\n\n<p>is fine.</p>\n\n<p>BTW: A good way of getting your malloc correct is to use \"sizeof what_the_variable_points_to\". Like:</p>\n\n<pre><code>char** x = malloc(size * sizeof *x);\n                                ^^\n                        Use *x instead of sizeof(char*)\n</code></pre>\n\n<p>in this way you always get the correct size and avoid bugs due to simple typos.</p>\n\n<p>As an example from your code:</p>\n\n<pre><code>List* listptr = malloc(sizeof(List));     // works but\nList* listptr = malloc(sizeof *listptr);  // this is less error prone\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 11303552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c561a86a58846e1e41d5cf3265308a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias M.", "link": "https://stackoverflow.com/users/11303552/tobias-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56156451, "answer_count": 1, "score": -1, "last_activity_date": 1557949474, "creation_date": 1557948377, "question_id": 56156369, "link": "https://stackoverflow.com/questions/56156369/deallocationg-char-inside-a-struct", "title": "Deallocationg char** inside a struct", "body": "<p><a href=\"https://stackoverflow.com/questions/21495330/free-a-char-array-that-is-inside-a-struct-in-c\">This</a> problem is similar to mine.<br>\nBut deliver no solution for me.</p>\n\n<p>This is only a simplified code for testing and better understanding.<br>\nI know that this code doesn't care of problems after the malloc functions.</p>\n\n<p>The code is for saving words in a struct called List, within a char** storage that used as array.</p>\n\n<p>To create the list and add an item works fine.<br>\nBut the deletion of the list makes problems.</p>\n\n<p>Here is the code:</p>\n\n<p>Declaration of the list:</p>\n\n<pre><code>typedef struct {\n    char** storage;\n} List;\n</code></pre>\n\n<p>Main:</p>\n\n<pre><code>int main(){\n    int size = 2;\n    List* list;\n    list = new_list(2);\n    add(list, \"Hello\", 0);\n    add(list, \"World\", 1);\n    printf(\"\\nlist-&gt;storage[0]: %s\", list-&gt;storage[0]);\n    printf(\"\\nlist-&gt;storage[1]: %s\",  list-&gt;storage[1]);\n\n    delete_list(&amp;list,size);\n\n    return 0;\n}\n</code></pre>\n\n<p>Make a new list:</p>\n\n<pre><code>List* new_list(size) {\n    List* listptr = malloc(sizeof(List));\n    listptr-&gt;storage = (char**)malloc(size * sizeof(char));\n    return listptr;\n}\n</code></pre>\n\n<p>Add a string to the list:</p>\n\n<pre><code>void add(List* list, char* string, int pos) {\n    list-&gt;storage[pos] = (char*)malloc(strlen(string) * sizeof(char));\n    list-&gt;storage[pos] = string;\n}\n</code></pre>\n\n<p>Delete the list, with all members:</p>\n\n<pre><code>void delete_list(List** list, int size) {\n    int a = 0;\n    for (a = 0; a &lt; size; a++)\n        free((*list)-&gt;storage[a]);\n\n    free((*list)-&gt;storage);\n    free(*list);\n}\n</code></pre>\n\n<p>Here I get an error in the for loop, at the line 'free((*list)->storage[a])'.<br>\nThe goal is here to delete every allocated string.<br>\nIf the list has no members, therefore the code run not in the for loop and the 'delte_list' function work well.</p>\n\n<p>So that is my mistake in the line:\n'free((*list)->storage[a])'</p>\n"}, {"tags": ["c", "linux", "pthreads"], "comments": [{"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1557948559, "post_id": 56156321, "comment_id": 98941904, "body": "Just a note, you need locking around shared data, such as part. Otherwise, you have a race, and UB."}, {"owner": {"reputation": 41, "user_id": 9229736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50fd940d7186bd0d0188be8d382df84e?s=128&d=identicon&r=PG&f=1", "display_name": "kirios kavouris", "link": "https://stackoverflow.com/users/9229736/kirios-kavouris"}, "reply_to_user": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1557948815, "post_id": 56156321, "comment_id": 98942006, "body": "@ErikAlap&#228;&#228; Thank you for the recommendation. More specifically, where else should I place mutex locking other than where I already have? I am new in this and I don&#39;t fully understand it yet!"}, {"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 0, "creation_date": 1557948932, "post_id": 56156321, "comment_id": 98942056, "body": "Sorry, I read the code too quickly. Compiling and checking it now, but someone else may beat me to the conclusion :)"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1557949531, "post_id": 56156321, "comment_id": 98942289, "body": "It is too much for stack if it allocated on stack."}], "answers": [{"tags": [], "owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "is_accepted": false, "score": 1, "last_activity_date": 1557953495, "last_edit_date": 1557953495, "creation_date": 1557951740, "answer_id": 56157075, "question_id": 56156321, "link": "https://stackoverflow.com/questions/56156321/using-pthreads-i-get-segmentation-fault-core-dumped-only-in-big-values/56157075#56157075", "title": "Using pthreads I get &quot;Segmentation fault (core dumped)&quot; only in big values", "body": "<p>Kiran Biradar is correct. I get correct results with ulimit -s 80000 (I ran as root to set high ulimit) for this hacked version of your program. Alternatively, allocating the array on the heap or as static should also avoid the stack size problem, as mentioned by another commenter.</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\nint part = 0;\nint local_elements = 0;\n\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\nvoid* square_sum(void* arg) {\n\n    int* local_sum = (int*)malloc(sizeof(int));\n\n\n\n    int *element_array = (int *) arg;\n\n    //--- Start of critical section ---                                                                                                                                                                                                                                                    \n    pthread_mutex_lock(&amp;mutex);\n\n    //Each thread computes its part                                                                                                                                                                                                                                                        \n    int thread_part = part++;\n\n    for (int i = thread_part*local_elements; i &lt;\n             (thread_part+1)*local_elements; i++) {\n        *local_sum += element_array[i] * element_array[i];\n        //printf(\"Thread %d says -- element %d is: %d \\n\", thread_part, i,                                                                                                                                                                                                                 \n        //element_array[i]);                                                                                                                                                                                                                                                               \n    }\n    pthread_mutex_unlock(&amp;mutex);\n//--- End of critical section ---                                                                                                                                                                                                                                                          \n\n\n    return local_sum;\n\n}\n\n\nint main()\n{\n    int threads, total_elements;\n    int i;\n    int* loc_sum;\n    long long total_sum = 0;\n\n\n    printf(\"Give the number of threads: \");\n    scanf(\"%d\", &amp;threads);\n\n\n    /*-----Fixed big size array-----*/\n    total_elements = 2000000; // &lt;--- If this value gets big I get that error                                                                                                                                                                                                              \n    local_elements = total_elements/threads;\n    int element_array[total_elements];\n\n    for (int i=0; i&lt;total_elements; i++) {\n        //Filling all the positions with 1s                                                                                                                                                                                                                                                \n        element_array[i] = 1;\n    }\n\n    //Creating the threads                                                                                                                                                                                                                                                                 \n    pthread_t newthread[threads];\n    for (int i=0; i&lt;threads; i++) {\n        //The thread function gets the element array                                                                                                                                                                                                                                       \n        pthread_create(&amp;newthread[i], NULL, square_sum, element_array);\n    }\n\n\n    //Waiting for each thread to finish and creating the total_sum                                                                                                                                                                                                                         \n    for (int i=0; i&lt;threads; i++) {\n        pthread_join(newthread[i], (void**)&amp;loc_sum);\n        printf(\"Thread %d returned the local_sum: %d \\n\", i, *loc_sum);\n        total_sum += *(int*)loc_sum;\n        free(loc_sum);\n        printf(\"loc_sum %d\\n\", *loc_sum);\n    }\n\n    printf(\"\\nThe total square sum of the array is: %lld\\n\", total_sum);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 1, "creation_date": 1557952461, "post_id": 56157200, "comment_id": 98943496, "body": "No. 2 million ints is typically 8 MB, you are off by a factor of a thousand."}, {"owner": {"reputation": 62, "user_id": 3422072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c1c5855c8e341e3e3d4bf73bd107cce7?s=128&d=identicon&r=PG&f=1", "display_name": "MrParrot", "link": "https://stackoverflow.com/users/3422072/mrparrot"}, "reply_to_user": {"reputation": 2315, "user_id": 4030223, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/1eoit.png?s=128&g=1", "display_name": "Erik Alap&#228;&#228;", "link": "https://stackoverflow.com/users/4030223/erik-alap%c3%a4%c3%a4"}, "edited": false, "score": 1, "creation_date": 1557952599, "post_id": 56157200, "comment_id": 98943554, "body": "Indeed. In this case the <code>static</code> keyword will fix his problem."}], "tags": [], "owner": {"reputation": 62, "user_id": 3422072, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c1c5855c8e341e3e3d4bf73bd107cce7?s=128&d=identicon&r=PG&f=1", "display_name": "MrParrot", "link": "https://stackoverflow.com/users/3422072/mrparrot"}, "is_accepted": false, "score": 0, "last_activity_date": 1557952736, "last_edit_date": 1557952736, "creation_date": 1557952284, "answer_id": 56157200, "question_id": 56156321, "link": "https://stackoverflow.com/questions/56156321/using-pthreads-i-get-segmentation-fault-core-dumped-only-in-big-values/56157200#56157200", "title": "Using pthreads I get &quot;Segmentation fault (core dumped)&quot; only in big values", "body": "<p>Your problem is that </p>\n\n<pre><code>int element_array[total_elements];\n</code></pre>\n\n<p>is too big to be allocated in the in the stack. 2.000.000 positions requires 8Mb of memory, and Linux's default stack size is 8Mb, as can be seen by running <code>ulimit -s</code>. To fix it, you can use <code>malloc</code> to allocate it in the heap, or use the <code>static</code> keyword, as it will allocate the array in the <code>.data</code> segment, which usually has a 4Gb limit in <code>amd64</code> machines.</p>\n"}], "owner": {"reputation": 41, "user_id": 9229736, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50fd940d7186bd0d0188be8d382df84e?s=128&d=identicon&r=PG&f=1", "display_name": "kirios kavouris", "link": "https://stackoverflow.com/users/9229736/kirios-kavouris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557953495, "creation_date": 1557948192, "question_id": 56156321, "link": "https://stackoverflow.com/questions/56156321/using-pthreads-i-get-segmentation-fault-core-dumped-only-in-big-values", "title": "Using pthreads I get &quot;Segmentation fault (core dumped)&quot; only in big values", "body": "<p>This is a program to make the (square) sum of an array using threads. It works fine if the array elements are up to about 2.000.000 but after that I get a \"Segmentation fault (core dumped)\" error. Could it be because I am using ubuntu in a virtual machine and I have allocated 4GB of RAM in it?</p>\n\n<p>Thank you for your time!</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint part = 0;\nint local_elements = 0;\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\n\nvoid* square_sum(void* arg);\n\nint main()\n{\n    int threads, total_elements;\n    int i;\n    void *loc_sum = NULL;\n    long long total_sum = 0;\n\n\n    printf(\"Give the number of threads: \");\n    scanf(\"%d\", &amp;threads);\n\n\n    /*-----Fixed big size array-----*/\n    total_elements = 2000000; // &lt;--- If this value gets big I get that error\n    local_elements = total_elements/threads;\n    int element_array[total_elements];\n\n    for (int i=0; i&lt;total_elements; i++) {\n        //Filling all the positions with 1s\n        element_array[i] = 1;\n    }\n\n    //Creating the threads\n    pthread_t newthread[threads];\n    for (int i=0; i&lt;threads; i++) {\n        //The thread function gets the element array\n        pthread_create(&amp;newthread[i], NULL, square_sum, (void *)element_array);\n    }\n\n\n    //Waiting for each thread to finish and creating the total_sum\n    for (int i=0; i&lt;threads; i++) {\n        pthread_join(newthread[i], (void*) &amp;loc_sum);\n        printf(\"Thread %d returned the local_sum: %d \\n\", i, (int)loc_sum);\n        total_sum += (int)loc_sum;  \n    }\n\n    printf(\"\\nThe total square sum of the array is: %lld\\n\", total_sum);\n\n    return 0;\n}\n\n\nvoid* square_sum(void* arg) {\n\n    intptr_t local_sum = 0;\n\n\n\n    int *element_array = (int *) arg;\n\n    //--- Start of critical section ---\n    pthread_mutex_lock(&amp;mutex);\n\n    //Each thread computes its part\n    int thread_part = part++;\n\n    for (int i = thread_part*local_elements; i &lt; (thread_part+1)*local_elements; i++) {\n        local_sum += element_array[i] * element_array[i];\n        //printf(\"Thread %d says -- element %d is: %d \\n\", thread_part, i, element_array[i]);\n\n    }\n\n\n    pthread_mutex_unlock(&amp;mutex);\n    //--- End of critical section ---\n\n\n    return ((void*)local_sum);\n\n\n}\n</code></pre>\n"}, {"tags": ["c", "loops"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1557947801, "post_id": 56156235, "comment_id": 98941574, "body": "<code>1&lt;i&lt;6</code> and <code>6&lt;=i&lt;=20</code> doesn&#39;t do what you think it does"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557947805, "post_id": 56156235, "comment_id": 98941576, "body": "Are you sure about what this <code>if(1&lt;i&lt;6)</code> does? <code>i&lt;6</code> will be <code>0</code> or <code>1</code> so <code>1</code> is never less than that."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1557947891, "post_id": 56156235, "comment_id": 98941622, "body": "too much python made you think that C also had operator chaining but it does not :)"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1557947934, "post_id": 56156235, "comment_id": 98941643, "body": "@Jean-Fran&#231;oisFabre Or maybe too much maths"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1557947992, "post_id": 56156235, "comment_id": 98941657, "body": "that&#39;s where python is just awesome because this operator chaining feature is super intuitive (and sometimes causes disasters in python too)"}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1557947817, "creation_date": 1557947817, "answer_id": 56156255, "question_id": 56156235, "link": "https://stackoverflow.com/questions/56156235/why-is-my-output-wrong-at-these-two-test-cases/56156255#56156255", "title": "Why is my output wrong at these two test cases?", "body": "<p>C does not support statements like this:</p>\n\n<pre><code>if(1&lt;i&lt;6)\n</code></pre>\n\n<p>You want:</p>\n\n<pre><code>if( (1&lt;i) &amp;&amp; (i&lt;6) )\n</code></pre>\n\n<p><em>Translation:</em></p>\n\n<p>If <code>i is greater than 1</code>, <strong><em>and also</em></strong> <code>i is less than 6</code>, then...</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1557948141, "creation_date": 1557948141, "answer_id": 56156316, "question_id": 56156235, "link": "https://stackoverflow.com/questions/56156235/why-is-my-output-wrong-at-these-two-test-cases/56156316#56156316", "title": "Why is my output wrong at these two test cases?", "body": "<p>This doesn't do what you think it does:</p>\n\n<pre><code>1&lt;i&lt;6\n</code></pre>\n\n<p>This is parsed as two separate comparisons:</p>\n\n<pre><code>((1&lt;i)&lt;6)\n</code></pre>\n\n<p>This first checks if <code>i</code> is less than 1.  This evaluates to either 0 or 1.  Then that value is checked to see if it is less than 6.  Both 0 and 1 are less than 6, so this always evaulates to true. </p>\n\n<p>You instead want:</p>\n\n<pre><code>(i &lt; 1) &amp;&amp; (i &lt; 6)\n</code></pre>\n\n<p>The same applies to <code>6&lt;=i&lt;=20</code></p>\n"}], "owner": {"reputation": 37, "user_id": 8935008, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sn78mJFoGd8/AAAAAAAAAAI/AAAAAAAAGCU/ElvrYx05wxE/photo.jpg?sz=128", "display_name": "Gagan Batra", "link": "https://stackoverflow.com/users/8935008/gagan-batra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "closed_date": 1557947857, "accepted_answer_id": 56156316, "answer_count": 2, "score": 0, "last_activity_date": 1557948141, "creation_date": 1557947725, "question_id": 56156235, "link": "https://stackoverflow.com/questions/56156235/why-is-my-output-wrong-at-these-two-test-cases", "closed_reason": "Duplicate", "title": "Why is my output wrong at these two test cases?", "body": "<p>My two test cases 18 and 20 are not getting the expected output.</p>\n\n<p>I have written a code where the user has to type an integer which should be less that 100 and it should print <code>Weird</code> or <code>Not Weird</code>based on the following conditions:\n\"If n is odd, print <code>Weird</code>\",\n\"If n is even and in the inclusive range of 2 to 5, print <code>Not Weird</code>\",\n\"If n is even and in the inclusive range of 6 to 20, print <code>Weird</code>\",\n\"If n is even and greater than 20, print <code>Not Weird</code>\". Running the code with test cases as 18 and 20, it should print <code>Weird</code> for both the cases but instead the result is <code>Not Weird</code>.  </p>\n\n<pre><code>int main()\n{\n    int i;\n    scanf(\"%d\",&amp;i);\n    if (i%2==0)\n    {\n        if(1&lt;i&lt;6)\n        {\n            printf(\"Not Weird\");\n        }\n        else if(6&lt;=i&lt;=20)\n        {\n            printf(\"Weird\");\n        }\n        else\n        {\n            printf(\"Not Weird\");\n        }\n    }\n    else\n    {\n        printf(\"Weird\");\n    }\nreturn 0;\n}\n</code></pre>\n\n<p>I have tried with other test cases and they show the expected output but the problem only occurs with 18 and 20. Kindly help me with the bug.</p>\n"}, {"tags": ["c", "bash", "shell", "scripting", "popen"], "comments": [{"owner": {"reputation": 18299, "user_id": 2648811, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ee5af60b10a2d5fd8c864437a2062f0a?s=128&d=identicon&r=PG", "display_name": "Green Cloak Guy", "link": "https://stackoverflow.com/users/2648811/green-cloak-guy"}, "edited": false, "score": 0, "creation_date": 1557947479, "post_id": 56156112, "comment_id": 98941425, "body": "This could be related to what exactly <code>script2</code> is doing within <code>EXE_SOMETHING()</code>. Generally some environment variables are tied to the process/session, and the parts of <code>EXE_SOMETHING()</code> that need them (e.g. other <code>popen</code> calls or the like) would be loading into a fresh environment where those environment variables aren&#39;t present. Can you be more specific about the contents of <code>SET_ENV()</code> and <code>EXE_SOMETHING()</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 1, "last_activity_date": 1557951357, "creation_date": 1557951357, "answer_id": 56156989, "question_id": 56156112, "link": "https://stackoverflow.com/questions/56156112/environment-variables-not-visible-in-shell-script-executed-using-popen-in-c/56156989#56156989", "title": "Environment variables not visible in shell script executed using popen in c", "body": "<p>If you want to use <code>oraenv</code> to modify the current shell environment, you must invoke it with <code>. oraenv</code>; otherwise the environment changes will be made in a subshell. </p>\n\n<p>This is explained in the Oracle docs. Also see the documentation for the shell <code>.</code> command, which runs a script inside the current execution context rather than in a subshell.</p>\n"}], "owner": {"reputation": 300, "user_id": 9115448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d5e26ababd43eb04bbfefd8d608f78c?s=128&d=identicon&r=PG&f=1", "display_name": "Dark Matter", "link": "https://stackoverflow.com/users/9115448/dark-matter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 56156989, "answer_count": 1, "score": 0, "last_activity_date": 1557951357, "creation_date": 1557947204, "last_edit_date": 1557949550, "question_id": 56156112, "link": "https://stackoverflow.com/questions/56156112/environment-variables-not-visible-in-shell-script-executed-using-popen-in-c", "title": "Environment variables not visible in shell script executed using popen in c", "body": "<p>Can somebody help on this:</p>\n\n<p>I'm executing shell script using popen in c program. Something like this:</p>\n\n<pre><code>fd = popen(\"script1\", \"r\");\n</code></pre>\n\n<hr>\n\n<p>script1 code is like this:</p>\n\n<pre><code>#!/bin/sh\nsource script2     #loading another script2\n\nEXE_SOMETHING   #Function call from script2\n\n//Do something....\n</code></pre>\n\n<hr>\n\n<p>script2 code is like this:</p>\n\n<pre><code>#!/bin/sh\nfunction SET_ENV()\n{\n    oraenv &lt;&lt;-EOF\n    SID NAME\n    EOF\n}\n\nfunction EXE_SOMETHING()\n{\n    SET_ENV\n    //Executing sql query using sqlplus to get output from database.\n}\n</code></pre>\n\n<hr>\n\n<p>My problem is i'm not getting env variables in EXE_SOMETHING which are being set by SET_ENV function, due to which I'm getting sqlplus command not found.</p>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "edited": false, "score": 0, "creation_date": 1557947110, "post_id": 56156067, "comment_id": 98941255, "body": "On any decent compiler, not really."}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "edited": false, "score": 0, "creation_date": 1557947118, "post_id": 56156067, "comment_id": 98941260, "body": "I would say a good compiler should generate equally efficient  code."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1557947282, "post_id": 56156067, "comment_id": 98941328, "body": "The second should be <code>struct Obj *c = p+i;</code> which is the very same as the first one."}, {"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557947388, "post_id": 56156067, "comment_id": 98941380, "body": "@EugeneSh. Ok thanks, I corrected it."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557947435, "post_id": 56156067, "comment_id": 98941401, "body": "Well, after the edit the question is trivial. C standard is defining both expressions equivalent. They are syntactical sugar of each other."}, {"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "edited": false, "score": 0, "creation_date": 1557947580, "post_id": 56156067, "comment_id": 98941464, "body": "Ok, well I thought the first would be the same as <code>struct Obj *c = &amp;(*(p+i))</code> and it seems obvious that a compiler would optimize that out, but just wanted to confirm it was a recommended pattern for c."}, {"owner": {"reputation": 13530, "user_id": 593382, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/f7326fd554e09edf21ca727d6854e22e?s=128&d=identicon&r=PG", "display_name": "Grady Player", "link": "https://stackoverflow.com/users/593382/grady-player"}, "edited": false, "score": 0, "creation_date": 1557947607, "post_id": 56156067, "comment_id": 98941480, "body": "To clarify, before the edit... the question had a problem with pointer arithmetic (for non-1 sized objects)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947754, "post_id": 56156067, "comment_id": 98941550, "body": "That&#39;s standard way to get a pointer to an element. In fact, remember that arrays naturally decays to pointers to their first element, which means for an array <code>a</code> using plain <code>a</code> is exactly the same as doing <code>&amp;a[0]</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557947824, "post_id": 56156067, "comment_id": 98941583, "body": "Also, for any pointer or array <code>p</code> and index <code>i</code>, the expression <code>p[i]</code> is <i>exactly</i> equal to <code>*(p + i)</code>. That&#39;s part of the C standard."}], "answers": [{"comments": [{"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "edited": false, "score": 1, "creation_date": 1557947766, "post_id": 56156146, "comment_id": 98941561, "body": "Thanks for clarifying @tadman. I did not know that doing pointer arithmetic would consider the size (though it was not the intent of my original question)."}], "tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1557947347, "creation_date": 1557947347, "answer_id": 56156146, "question_id": 56156067, "link": "https://stackoverflow.com/questions/56156067/in-c-is-it-ok-to-use-and-together-to-quickly-get-the-pointer-to-an-object-i/56156146#56156146", "title": "In C is it ok to use &amp; and [] together to quickly get the pointer to an object in an array?", "body": "<p>That second version is perplexing and stands out as an anomaly, so unless you have an extremely compelling case for using it, don't. If you <em>do</em>, then you should document why so someone doesn't go and replace it with the former.</p>\n\n<p>The second form is also really brittle in that it might break if you changed something by refactoring and introducing a new struct like:</p>\n\n<pre><code>struct Mobj *c = p + i * sizeof(struct Obj);\n</code></pre>\n\n<p>Where you forgot to update the <code>sizeof</code> part and now your code is super broken.</p>\n\n<p>That of course overlooks the fact that when doing pointer math it will automatically increment by the size of the structure anyway, that is:</p>\n\n<pre><code>p[i] == *(p + i)\n</code></pre>\n\n<p>But in your case what you're doing is effectively this:</p>\n\n<pre><code>p[i * sizeof(Obj)]\n</code></pre>\n\n<p>Which is not what you're intending.</p>\n\n<p>Less is more. Coding is hard enough as it is, don't overcomplicate things.</p>\n"}, {"tags": [], "owner": {"reputation": 4060, "user_id": 763355, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dxAhW.jpg?s=128&g=1", "display_name": "MoDJ", "link": "https://stackoverflow.com/users/763355/modj"}, "is_accepted": false, "score": 2, "last_activity_date": 1557947366, "creation_date": 1557947366, "answer_id": 56156156, "question_id": 56156067, "link": "https://stackoverflow.com/questions/56156067/in-c-is-it-ok-to-use-and-together-to-quickly-get-the-pointer-to-an-object-i/56156156#56156156", "title": "In C is it ok to use &amp; and [] together to quickly get the pointer to an object in an array?", "body": "<p>Yea, it is okay. In fact, when you use p it is actually the same as &amp;p[0] from the compiler's point of view. Always let the compiler do the pointer math for you, use the first form.</p>\n"}, {"comments": [{"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1557948095, "post_id": 56156179, "comment_id": 98941701, "body": "@BenVoigt this is what I would consider the answer."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "edited": false, "score": 1, "creation_date": 1557949445, "post_id": 56156179, "comment_id": 98942258, "body": "@RickLove: John has now captured all the nuances correctly in his answer, IMO.  Also I saw where the C standard does (redundantly) make the statement dbush talks about, so my earlier comment was wrong."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1557947455, "creation_date": 1557947455, "answer_id": 56156179, "question_id": 56156067, "link": "https://stackoverflow.com/questions/56156067/in-c-is-it-ok-to-use-and-together-to-quickly-get-the-pointer-to-an-object-i/56156179#56156179", "title": "In C is it ok to use &amp; and [] together to quickly get the pointer to an object in an array?", "body": "<p>The C standard states that <code>&amp;array[index]</code> is exactly equivalent to <code>array + index</code>.  This means that both do pointer arithmetic, so they should be no different.</p>\n\n<p>Even if they were different choosing one over the other would be a microoptimization that's not worth doing unless you have a significant measurable difference between them.</p>\n"}, {"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557947823, "post_id": 56156232, "comment_id": 98941582, "body": "I think the second one is UB for the same <code>i</code> as <code>*(p+i)</code> is UB in that case."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1557947910, "post_id": 56156232, "comment_id": 98941631, "body": "I thought there was a special rule in the standard that <code>&amp;*p</code> is exactly equivalent to <code>p</code>."}, {"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "edited": false, "score": 0, "creation_date": 1557947941, "post_id": 56156232, "comment_id": 98941645, "body": "Is it correct to call pointing past the end of an array undefined behavior? The compiler doesn&#39;t know anything about array length. It is simply that the reference will be pointing past the end of the array (which is a valid address like any, just not valid data)."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557947998, "post_id": 56156232, "comment_id": 98941658, "body": "The same rule applies to the <code>[]</code> notation. <i>Thus, &amp;*E is equivalent to E (even if E is a null pointer), <b>and &amp;(E1[E2]) to ((E1)+(E2))</b>.</i> - <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note102\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#note102</a> So there is no difference at all."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557948083, "post_id": 56156232, "comment_id": 98941697, "body": "@EugeneSh., it is explicitly allowed to compute a pointer to one past the last element of an array via pointer addition, and also explicitly specified that attempting to dereference such a result produces UB.  See paragraph <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"nofollow noreferrer\">6.5.6/8</a> of the standard."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557948122, "post_id": 56156232, "comment_id": 98941710, "body": "@JohnBollinger ...and <code>*(p+i)</code> is dereferencing."}, {"owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "edited": false, "score": 0, "creation_date": 1557948341, "post_id": 56156232, "comment_id": 98941796, "body": "@JohnBollinger thank you for the reference to the specification. That helps!"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1557948556, "post_id": 56156232, "comment_id": 98941901, "body": "@user3386109, you are correct, and I have updated this answer accordingly.  I suspect, in fact, that that special rule is exactly intended for this case."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557948725, "post_id": 56156232, "comment_id": 98941967, "body": "@EugeneSh.: But <code>&amp;*(p+i)</code> is NOT dereferencing.  (In C.  The rules are more complicated in C++, and still being revised for clarity)"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1557948798, "post_id": 56156232, "comment_id": 98942000, "body": "@EugeneSh. yes, <code>*(p+i)</code> is dereferencing, and I specified that the equivalence to the following is provisional on <code>i</code> being less than the number of array elements.  However, as user3386109 observed, there is also an explicit special provision that when <code>&amp;</code> is applied to the result of an <code>*</code> operator, <i>neither is evaluated</i>, and it is as if both were omitted.  This is in <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.3.2p3\" rel=\"nofollow noreferrer\">paragraph 6.5.3.2/3</a> of the standard."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 1, "creation_date": 1557948942, "post_id": 56156232, "comment_id": 98942059, "body": "The two forms are equivalent for <i>all</i> values of <code>i</code>, including negative or larger than the array size.  (If the pointer arithmetic doesn&#39;t yield the address of an element within the same array that <code>p</code> points into, then the result of both forms is undefined behavior)"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1557949079, "post_id": 56156232, "comment_id": 98942109, "body": "@BenVoigt, John - That is debatable. It is dereferencing (or not-dereferencing) in the same sense as <code>&amp;p[i]</code> as the rule applies for both notations as I cited above. Anyway, Annex J.2 is explicitly stating that the operand of unary <code>*</code> has to be valid without exception. Also the rule is subject to constraint in 6.5.3.2p1 which is <i>The operand of the unary &amp; operator shall be either a function designator, the <b>result of a [] or unary * operator</i></b>. So applying it to a bad <code>i</code> is a constraint violation."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1557949255, "post_id": 56156232, "comment_id": 98942182, "body": "@EugeneSh: No constraints on values apply to unevaluated expressions.  For example <code>sizeof ((T*)0)-&gt;member</code> is permitted even though it has the form of a dereference of a null pointer.  The dereference is not performed.  Same with <code>&amp;*(p + i)</code>.  No dereference is performed, although it is syntactically present.."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "edited": false, "score": 0, "creation_date": 1557949473, "post_id": 56156232, "comment_id": 98942266, "body": "@BenVoigt Constraints in the standard apply not to expressions but serve as a prerequisites for the correctness of the stated semantics. The rules you are stating are coming from the semantics section which is not valid while the constraints are violated."}, {"owner": {"reputation": 260120, "user_id": 103167, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Ben Voigt", "link": "https://stackoverflow.com/users/103167/ben-voigt"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557949692, "post_id": 56156232, "comment_id": 98942366, "body": "@EugeneSh: Here&#39;s the rule that makes unevaluated expressions allowed irrespective of constraints: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#3.1p4\" rel=\"nofollow noreferrer\">&quot;Expressions that are not evaluated do not access objects&quot;</a>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1557949744, "post_id": 56156232, "comment_id": 98942389, "body": "@EugeneSh., Annex J is non-normative.  As for constraints, in <code>&amp;*(p + i)</code>, the operand of the <code>&amp;</code> operator is absolutely, without doubt, the result of a unary <code>*</code> operation.  Whether <i>evaluating</i> that operation would have defined behavior is not relevant to that analysis, and that would be exactly the point of the Standard calling out explicitly that in this special case, neither the <code>&amp;</code> nor the <code>*</code> is evaluated."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1557949946, "last_edit_date": 1557949946, "creation_date": 1557947714, "answer_id": 56156232, "question_id": 56156067, "link": "https://stackoverflow.com/questions/56156067/in-c-is-it-ok-to-use-and-together-to-quickly-get-the-pointer-to-an-object-i/56156232#56156232", "title": "In C is it ok to use &amp; and [] together to quickly get the pointer to an object in an array?", "body": "<blockquote>\n  <p>However, does this have a performance hit compared to doing the pointer arithmetic manually?</p>\n</blockquote>\n\n<p>Expressions using the indexing operator are <em>defined</em> to be equivalent to corresponding operations involving pointer arithmetic and dereferencing, so</p>\n\n<pre><code>&amp;p[i]\n</code></pre>\n\n<p>is exactly equivalent to</p>\n\n<pre><code>&amp;(*(p + i))\n</code></pre>\n\n<p>The standard furthermore specifies that when the operand of the <code>&amp;</code> operator is the result of a <code>*</code> operator, neither is evaluated, and the result is as if both were omitted, so that is in turn equivalent to</p>\n\n<pre><code>p + i\n</code></pre>\n\n<p>, which has defined behavior as long as it does not purport to produce a pointer to before the beginning of the array from which pointer <code>p</code> was derived, nor more than one position past its end.</p>\n\n<p>Although it is conceivable that a compiler would produce different or worse code in one case than in the other, there is no reason to expect that.</p>\n\n<blockquote>\n  <p>Are there any reasons why the first should be avoided?</p>\n</blockquote>\n\n<p>Not much.  The latter has a lighter cognitive load and is easier to read, inasmuch as (syntactically) it involves only one operation rather than two.  I tend to prefer it myself for that reason.  On the other hand, <em>understanding</em> it may be a little less intuitive.</p>\n"}], "owner": {"reputation": 10707, "user_id": 567524, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/vApA9.jpg?s=128&g=1", "display_name": "Rick Love", "link": "https://stackoverflow.com/users/567524/rick-love"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 56156232, "answer_count": 4, "score": -1, "last_activity_date": 1557949946, "creation_date": 1557947015, "last_edit_date": 1557947373, "question_id": 56156067, "link": "https://stackoverflow.com/questions/56156067/in-c-is-it-ok-to-use-and-together-to-quickly-get-the-pointer-to-an-object-i", "title": "In C is it ok to use &amp; and [] together to quickly get the pointer to an object in an array?", "body": "<p>I know this works to get the index (and do the pointer arithmetic automatically):</p>\n\n<p><code>struct Obj *c = &amp;p[i];</code></p>\n\n<p>However, does this have a performance hit compared to doing the pointer arithmetic manually?</p>\n\n<p><code>struct Obj *c = p+i;</code></p>\n\n<p>Are there any reasons why the first should be avoided?</p>\n"}, {"tags": ["c", "arrays", "pointers", "language-lawyer"], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 5, "creation_date": 1557947016, "post_id": 56156044, "comment_id": 98941220, "body": "This sort of argument from pragmatism makes sense, but does not seem much responsive to a [language-lawyer] question."}], "tags": [], "owner": {"reputation": 18385, "user_id": 1773434, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9HhFs.png?s=128&g=1", "display_name": "Govind Parmar", "link": "https://stackoverflow.com/users/1773434/govind-parmar"}, "is_accepted": false, "score": 2, "last_activity_date": 1557946908, "creation_date": 1557946908, "answer_id": 56156044, "question_id": 56155994, "link": "https://stackoverflow.com/questions/56155994/applying-strcpy-to-a-pointer-to-array-some-offset/56156044#56156044", "title": "Applying strcpy to a pointer to array + some_offset", "body": "<p>Yes, because even though the semantics of the function <code>strcpy</code> only make sense when dealing with arrays instead of pointers, there is no way for <code>strcpy</code> (or any other function) to tell whether it was passed an array or a pointer to an array, since when an array is passed as an argument to a function, it decays to a pointer to its first element.</p>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 6, "last_activity_date": 1557946966, "creation_date": 1557946966, "answer_id": 56156056, "question_id": 56155994, "link": "https://stackoverflow.com/questions/56155994/applying-strcpy-to-a-pointer-to-array-some-offset/56156056#56156056", "title": "Applying strcpy to a pointer to array + some_offset", "body": "<p><strong>Of course</strong> <code>s1</code> does not point to an array, it points to a <code>char</code>. But the term usage comes from the <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.1.4p1\" rel=\"noreferrer\">7.1.4p1</a>:</p>\n\n<blockquote>\n  <p>[...] If a function argument is described as being an array, the pointer actually passed to the function shall have a value such that all address computations and accesses to objects (that would be valid if the pointer did point to the first element of such an array) are in fact valid. [...]</p>\n</blockquote>\n\n<p>For <code>strcpy(test + 3, \"4567\");</code> the accesses <code>test[3 + 0 ... 4]</code> shall be valid, which is the case, among others possibilities, if <code>test</code> is an array of at least 8 characters.</p>\n"}], "owner": {"reputation": 6828, "user_id": 8990329, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f073ad236ccf499ebfbe504bc79a2096?s=128&d=identicon&r=PG&f=1", "display_name": "Some Name", "link": "https://stackoverflow.com/users/8990329/some-name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 56156056, "answer_count": 2, "score": 3, "last_activity_date": 1557946966, "creation_date": 1557946608, "question_id": 56155994, "link": "https://stackoverflow.com/questions/56155994/applying-strcpy-to-a-pointer-to-array-some-offset", "title": "Applying strcpy to a pointer to array + some_offset", "body": "<p>This is a language-lawyer question.</p>\n\n<p>The description of <code>strcpy</code> function is given at <code>7.24.2.3(p2)</code>:</p>\n\n<blockquote>\n  <p>The <code>strcpy</code> function copies the string pointed to by s2 (including\n  the terminating null character) into the array pointed to by s1.</p>\n</blockquote>\n\n<p>So consider the following code:</p>\n\n<pre><code>char test[8] = \"123\";\nstrcpy(test + 3, \"4567\");\nprintf(\"%s\\n\", test); //1234567\n</code></pre>\n\n<p>It works as expected, but I'm confused about the object pointed to by <code>test + 3</code>. It is clear that object pointed to by <code>test</code> has declared type <code>char[8]</code>. But as far as I can see the Standard <strong><em>does not</em></strong> explicitly defined sort of this: </p>\n\n<p>\"If we have an array of <code>n</code> elements than a pointer to <code>i &lt; n</code>th element can be considered a pointer to the first element of an array of <code>n - i</code> elements\".</p>\n\n<p>Since the function <code>strcpy</code> requires its first operand to be an array can we <em>pedantically speaking</em> apply pointer arithmetic as I showed above?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947296, "post_id": 56155943, "comment_id": 98941336, "body": "When <code>a</code> reaches <code>0</code> (i.e. <code>a == 0</code>) then what happens with <code>b[a - 1]</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947364, "post_id": 56155943, "comment_id": 98941368, "body": "And how to do <i>what?</i> It&#39;s really unclear what you&#39;re asking about and what you want to do. For some specified input, what should the output be? What is the output your <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> creates? Also please read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947365, "post_id": 56155943, "comment_id": 98941369, "body": "Well probably doesn&#39;t work, I have no idea how to do it"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947396, "post_id": 56155943, "comment_id": 98941382, "body": "I want to switch 2 numbers from any array with only 1"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947430, "post_id": 56155943, "comment_id": 98941399, "body": "Here, 2 and 8 from the first array are even and consecutive so we put an 2018 in that place"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557947517, "post_id": 56155943, "comment_id": 98941439, "body": "I don&#39;t know how to place <i>2018</i> in the place of 2 and 8"}], "answers": [{"comments": [{"owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "reply_to_user": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 1, "creation_date": 1557950417, "post_id": 56156558, "comment_id": 98942664, "body": "@AndreiJarca Welcome! Also note that this will replace three consecutive even numbers with a single 2018, since 2018 itself is even and after replacing the first two, you still have 2018 and one other even next to each other. Hopefully this is the desired behavior. If it is not, fixing it should not be hard. I can help on that if needed"}], "tags": [], "owner": {"reputation": 16676, "user_id": 10147399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a6d433902192f8bb03857ae1b849d4f?s=128&d=identicon&r=PG&f=1", "display_name": "Ayxan Haqverdili", "link": "https://stackoverflow.com/users/10147399/ayxan-haqverdili"}, "is_accepted": true, "score": 1, "last_activity_date": 1558071579, "last_edit_date": 1558071579, "creation_date": 1557949343, "answer_id": 56156558, "question_id": 56155943, "link": "https://stackoverflow.com/questions/56155943/how-to-switch-two-digits-in-an-array-with-only-one-digit/56156558#56156558", "title": "How to switch two digits in an array with only one digit?", "body": "<p>You can't really change the size of an array, but you can shift the elements and ignore elements at the end:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid shift_left(int* arr, size_t sz, size_t shift_cnt)\n{\n  for (size_t i = 0; i != sz - shift_cnt; ++i)\n  {\n    arr[i] = arr[i + shift_cnt];\n  }\n  for (size_t i = sz - shift_cnt; i != sz; ++i)\n  {\n    arr[i] = 0;\n  }\n}\n\nint main()\n{\n  int arr[] = { 2, 8, 5, 7, 3, 5 };\n  size_t sz = sizeof(arr) / sizeof(arr[0]);\n\n  for (size_t i = 0; i &lt; sz - 1;)\n  {\n    if (arr[i] % 2 == 0 &amp;&amp; arr[i + 1] % 2 == 0)\n    {\n      shift_left(arr + i, sz-- - i, 1);\n      arr[i] = 2018;\n    }\n    else\n    {\n      ++i;\n    }\n  }\n\n  for (size_t i = 0; i != sz; ++i)\n    printf(\"%d \", arr[i]);\n\n  return 0;\n}\n\n// Output: 2018 5 7 3 5\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1557955646, "last_edit_date": 1557955646, "creation_date": 1557950317, "answer_id": 56156759, "question_id": 56155943, "link": "https://stackoverflow.com/questions/56155943/how-to-switch-two-digits-in-an-array-with-only-one-digit/56156759#56156759", "title": "How to switch two digits in an array with only one digit?", "body": "<p>March down the source array looking for even pairs</p>\n\n<pre><code>// return size used\n\nsize_t AJ_squish(int *dest, size_t dest_size, const int *src, size_t src_size) {\n  size_t dest_len = 0;\n  while (src_size &gt; 1 &amp;&amp; dest_len &lt; dest_size) {\n    // 2 evens in a row?\n    if (src[0] % 2 == 0 &amp;&amp; src[1] % 2 == 0) {\n      dest[dest_len++] = 2018;\n      src_size -= 2;\n    } else {\n      dest[dest_len++] = *src++;\n      src_size--;\n    }\n  }\n  if (src_size &gt;  0 &amp;&amp; dest_len &lt; dest_size) {\n    dest[dest_len++] = *src;\n  }\n  return dest_len;\n}\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 56156558, "answer_count": 2, "score": 1, "last_activity_date": 1558071579, "creation_date": 1557946354, "last_edit_date": 1557949123, "question_id": 56155943, "link": "https://stackoverflow.com/questions/56155943/how-to-switch-two-digits-in-an-array-with-only-one-digit", "title": "How to switch two digits in an array with only one digit?", "body": "<p>How to do this:  </p>\n\n<p>array 1: <code>2  8 5 7 3 5</code><br>\narray 2: <code>2018 5 7 3 5</code></p>\n\n<p>The problem said that if two even numbers are consecutive in the first array, put a <code>2018</code> in their place, like so.\nHow can I do this?</p>\n\n<pre><code>for(a=n-1; a&gt;=0; a--)\n{\n    if( b[a]%2==0 &amp;&amp; b[a-1]%2==0)\n    {\n        for(c=a-1; c&lt;n-1; c++)\n        {\n            b[c]=b[c+1];\n        }\n        b[a]= 2017;\n    }\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1557945936, "post_id": 56155787, "comment_id": 98940760, "body": "Apart from not currently sporting any code attempting this (at least none posted to <i>this</i> question), what, exactly, is the problem you&#39;re experiencing? And unrelated, netbeans is a development UI. That tag has no business being in this question."}, {"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1557946114, "post_id": 56155787, "comment_id": 98940830, "body": "If I&#39;m understanding you correctly, why not 1) Create an array and copy a pointer to each team into it, 2) Create two new, empty lists, 3) Initialize a random number generator, 4) Copy a random element from the array into one list, then the other. 5) null that array element after you copy it.  6) If the random number is a &quot;null;&quot; element, then call &quot;rand()&quot; again."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557960812, "post_id": 56155787, "comment_id": 98945974, "body": "If you know number of teams (assume you do), Create 2 empty lists called say left and right.  Roll a random number from 0 to num-teams-1.  Every odd time, through, put into left, even time into right.  Once a team is moved, decrease num_teams by 1 and repeat until list is empty."}], "answers": [{"comments": [{"owner": {"reputation": 98775, "user_id": 421195, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a9793fdeb3b94e185c8c99c0238372f?s=128&d=identicon&r=PG", "display_name": "paulsm4", "link": "https://stackoverflow.com/users/421195/paulsm4"}, "edited": false, "score": 0, "creation_date": 1557946180, "post_id": 56155869, "comment_id": 98940854, "body": "Q: How do you &quot;pick a team at random&quot; from a doubly-linked list?  Not &quot;criticizing&quot; ... just asking."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1557946036, "creation_date": 1557946036, "answer_id": 56155869, "question_id": 56155787, "link": "https://stackoverflow.com/questions/56155787/how-to-generate-a-symmetric-sequence-same-amount-of-elements-of-each-part-betw/56155869#56155869", "title": "how to generate a symmetric sequence (same amount of elements of each part) between 0 and 1 in c?", "body": "<p>Select one team at random and assign it to group 1.  Then pick another team at random and assign to group 2.  </p>\n\n<p>Repeat until all teams have been assigned to a group.</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 11503327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce9c9cb33b430948811a32c5431c9fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Ratafia", "link": "https://stackoverflow.com/users/11503327/ratafia"}, "is_accepted": false, "score": 0, "last_activity_date": 1557946077, "creation_date": 1557946077, "answer_id": 56155876, "question_id": 56155787, "link": "https://stackoverflow.com/questions/56155787/how-to-generate-a-symmetric-sequence-same-amount-of-elements-of-each-part-betw/56155876#56155876", "title": "how to generate a symmetric sequence (same amount of elements of each part) between 0 and 1 in c?", "body": "<p>you can iterate over your list, compute a hash value for each item (which should almost be random), and sort the item against the hash value modulo the number of category you like to have (here is 2). It seems to me that could make the job.</p>\n"}], "owner": {"reputation": 11, "user_id": 11505483, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wFxk5M4ZYH4/AAAAAAAAAAI/AAAAAAAABJY/LZszBFUcZ8E/photo.jpg?sz=128", "display_name": "Daniel Hand", "link": "https://stackoverflow.com/users/11505483/daniel-hand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1557953696, "creation_date": 1557945687, "last_edit_date": 1557953696, "question_id": 56155787, "link": "https://stackoverflow.com/questions/56155787/how-to-generate-a-symmetric-sequence-same-amount-of-elements-of-each-part-betw", "title": "how to generate a symmetric sequence (same amount of elements of each part) between 0 and 1 in c?", "body": "<p>I have a double-chained list with descriptor of which the information in each node is a soccer team (also a structured type, with name, origin and an identification number). I have to separate the total teams in two groups randomly, but keeping an equal amount in each (except if the amount is odd).</p>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 2, "creation_date": 1557943479, "post_id": 56155193, "comment_id": 98939709, "body": "That works on arrays as arrays are layed out sequentially in memory. But linked lists are not guaranteed to be that way. So you can&#39;t do that."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 2, "creation_date": 1557943656, "post_id": 56155193, "comment_id": 98939793, "body": "To increment a pointer inside a linked list, you need a loop that follows the <code>prox</code> pointers."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 1, "creation_date": 1557943832, "post_id": 56155193, "comment_id": 98939862, "body": "Welcome to SO! It&#39;d be helpful to post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> for this which illustrates your code that is crashing."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 1, "creation_date": 1557944726, "post_id": 56155193, "comment_id": 98940212, "body": "Please, could you clearify whether you want to get the next <b>pilot</b>&#39;s time or the next (lap?) <b>time</b> of the same pilot? In any case, how have you allocated the memory for <code>time</code>?"}, {"owner": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1557945174, "post_id": 56155193, "comment_id": 98940411, "body": "@Bob__ What I want to do is: I have 4 pilots for 5 laps in a linked list and each node has the pointer <code>*time</code>. Then, I want to go through all the array with the <code>aux-&gt;time</code> and in each node has 5 different times that are recorded on another array."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557945344, "post_id": 56155193, "comment_id": 98940497, "body": "Why is something like <code>time</code> a pointer in the first place? That seems like a very strange design. It&#39;s just a number. Unless that&#39;s an array of <i>N</i> times, it&#39;s not worth the fuss."}, {"owner": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1557945488, "post_id": 56155193, "comment_id": 98940570, "body": "@tadman Yes it&#39;s a pointer to an array with 5 times"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1557945824, "post_id": 56155193, "comment_id": 98940709, "body": "Well, if you know the exact number (compile time constant) of laps, you could use an array inside the struct: <code>int time[N_LAPS];</code>. On the other hand, you already have <code>times</code> which seems to store the lap times of each car, so I&#39;m not sure to follow your data structure choices."}, {"owner": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "edited": false, "score": 0, "creation_date": 1557945922, "post_id": 56155193, "comment_id": 98940754, "body": "I can&#39;t use a static array because the number of laps it&#39;s not fixed, it&#39;s asked to the user to input a value between 5 and 10. What I want to do is copy from the <code>times[race.cars][race.laps]</code> to the correct pilot in each node. The bidimensional array has 20 times, and I want to split each 5 for each node."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1557947209, "post_id": 56155193, "comment_id": 98941301, "body": "This is missing a <i>lot</i> of code, especially with how things are allocated. Normally you&#39;d do <code>list-&gt;time[n] = x</code> where <code>n</code> is your index and <code>x</code> is your value, but this depends on that list being the correct size, and 0 &lt;= <code>n</code> &lt; S where <code>S</code> is the list size."}, {"owner": {"reputation": 25637, "user_id": 6243352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/715f60f9edc65642a6805752cfeebb27?s=128&d=identicon&r=PG&f=1", "display_name": "ggorlen", "link": "https://stackoverflow.com/users/6243352/ggorlen"}, "edited": false, "score": 0, "creation_date": 1557947520, "post_id": 56155193, "comment_id": 98941440, "body": "Where are you <code>malloc</code>ing memory for <code>int *time</code> before you dereference it?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1557948079, "post_id": 56155193, "comment_id": 98941695, "body": "<code>*(list-&gt;time+ j)</code> is better and more clearly written as <code>list-&gt;time[j]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "edited": false, "score": 0, "creation_date": 1557944859, "post_id": 56155333, "comment_id": 98940269, "body": "yeah, but imagine that before doing the <code>list-&gt;prox</code> I want to go through all the array with the pointer and after that I do the <code>list-&gt;prox</code>. In this case, I have 4 pilots for 5 laps, and I want to save all the 5 times in the node and after that I do <code>list-&gt;prox</code>."}, {"owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "reply_to_user": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "edited": false, "score": 0, "creation_date": 1557946866, "post_id": 56155333, "comment_id": 98941156, "body": "@whoami are your inner arrays ever initialized? Seems like Bob__ might be right, since from the snippet provided you never even initialize time"}], "tags": [], "owner": {"reputation": 1224, "user_id": 4950659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ygz0E.jpg?s=128&g=1", "display_name": "AdminXVII", "link": "https://stackoverflow.com/users/4950659/adminxvii"}, "is_accepted": false, "score": 1, "last_activity_date": 1557943877, "creation_date": 1557943877, "answer_id": 56155333, "question_id": 56155193, "link": "https://stackoverflow.com/questions/56155193/how-to-increment-a-pointer-inside-a-linked-list/56155333#56155333", "title": "How to increment a pointer inside a linked list", "body": "<p>Given that your structs are probably created as multiple malloc call, they are most likely distributed across memory.</p>\n\n<p>Imagine memory for an array. It's laid out like that:</p>\n\n<pre><code> p\n-----------\n|0|1|2|3|4|\n-----------\n</code></pre>\n\n<p>so you can call <code>*(p + 3)</code> to access a nearby value</p>\n\n<p>For dynamically allocated structs, it's most likely something like</p>\n\n<pre><code> p\n---------------------------\n|0|other thing|1|a|2|etc..|\n---------------------------\n</code></pre>\n\n<p>So <code>*(p + 2)</code> is inside <code>other thing</code>, which is not what you'd expect.</p>\n\n<p>The work around is that linked list have a pointer inside them; so for example <code>list-&gt;prox</code> should be the next instance. No need to touch the pointers directly.</p>\n\n<hr>\n\n<p>On a side note, your carPilot is itself a type; thus you should not add int before it.</p>\n"}], "owner": {"reputation": 1, "user_id": 9615021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "whoami", "link": "https://stackoverflow.com/users/9615021/whoami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1557945363, "creation_date": 1557943174, "last_edit_date": 1557945363, "question_id": 56155193, "link": "https://stackoverflow.com/questions/56155193/how-to-increment-a-pointer-inside-a-linked-list", "title": "How to increment a pointer inside a linked list", "body": "<p>To increment a pointer that points to an array, we do <code>*(p+i)</code> or <code>*(p++)</code> but how do I increment a pointer that is inside of a linked list? \nI have this struct:</p>\n\n<pre><code>typedef struct list carPilot, *pCarPilot;\nstruct list{\n    pilot pilot;\n    car car;\n    int *time;\n    pCarPilot prox;\n};\n\nstruct race {\n    int laps;     \n    int size;    \n    int n_cars;   \n};\n\n/* ------------------ */\n\nint times[race.cars][race.laps];\npCarPilot list = NULL;\n\nfor(j = 0; j &lt; race.laps; j++) {\n     times[i][j] = calculaSegundos(idade,peso,exp,potencia,caract.comprimento); \n     *(list-&gt;time+ j) = times[i][j];  // my error is HERE\n}\n</code></pre>\n\n<p>I'd tried to do <code>*(list-&gt;time + i)</code> and <code>*(list-&gt;time ++)</code> but when I run the code, the program just stops.</p>\n"}, {"tags": ["c", "arrays", "memory", "memory-management", "size"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557940908, "post_id": 56154533, "comment_id": 98938557, "body": "So long as it is not on the stack. The array has to be indexable so I think <code>SIZE_MAX</code> is the limit."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1557941016, "post_id": 56154533, "comment_id": 98938614, "body": "In the limits, the line you care about is <code>stack size</code> which indicates that the maximum stack size is 4096 kilobytes, i.e. 4 megabytes."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1557940864, "creation_date": 1557940864, "answer_id": 56154634, "question_id": 56154533, "link": "https://stackoverflow.com/questions/56154533/defining-maximum-char-array-size-allowable-to-c-programs-in-linux/56154634#56154634", "title": "Defining maximum char[] array size allowable to C programs in linux", "body": "<p>You need to modify the <code>stack</code> size. <code>-s</code> is the option to set stack size using <code>ulimit</code>.</p>\n\n<p>On your system currently it is 4 megabytes.</p>\n\n<pre><code>stack size              (kbytes, -s) 4096\n</code></pre>\n\n<p>Ex:</p>\n\n<pre><code>ulimit -s unlimited \n//sets stack size to ulimited\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1557940922, "creation_date": 1557940922, "answer_id": 56154646, "question_id": 56154533, "link": "https://stackoverflow.com/questions/56154533/defining-maximum-char-array-size-allowable-to-c-programs-in-linux/56154646#56154646", "title": "Defining maximum char[] array size allowable to C programs in linux", "body": "<p>Printf is showing you a <code>-1</code> since the format of <code>%d</code> is a signed integer which is smaller than unsigned (usually by 1 bit).  Function local character arrays go on the stack so that's the value you're looking for.</p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557950489, "post_id": 56154815, "comment_id": 98942692, "body": "The system won\u2019t blink when you allocate an array close the amount of physical memory. It is when you use it that effects are noticed."}], "tags": [], "owner": {"reputation": 12243, "user_id": 2192494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd4f75b6e9293967ba3c81f89edd68a?s=128&d=identicon&r=PG", "display_name": "Lee Daniel Crocker", "link": "https://stackoverflow.com/users/2192494/lee-daniel-crocker"}, "is_accepted": false, "score": 0, "last_activity_date": 1557941602, "creation_date": 1557941602, "answer_id": 56154815, "question_id": 56154533, "link": "https://stackoverflow.com/questions/56154533/defining-maximum-char-array-size-allowable-to-c-programs-in-linux/56154815#56154815", "title": "Defining maximum char[] array size allowable to C programs in linux", "body": "<p>Linux has a virtual memory manager that will allocate blocks as needed, swap blocks out to disk, and otherwise try to make the system look like there's no pre-set limit to how much memory you can allocate to a specific task. But that's like an American Express card with \"no pre-set spending limit\". If you try to charge a Ferrari, they're going to call you and ask \"WTF?\". In reality, all memory is finite, and so memory tricks will fail at some point. Unfortunately, there is no practical way to know what that point is in advance. It depends upon what else is running on the system, the size and speed of your disk, OS settings, and other things.</p>\n\n<p>As a practical matter, allocating an array close to the amount of physical RAM in the machine is likely to cause problems (slowdowns, if nothing else). So that might be a reasonable limit to consider. Memory-mapped files might be another thing to consider, but reality intrudes on their performance as well at some point.</p>\n"}], "owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 56154634, "answer_count": 3, "score": 0, "last_activity_date": 1557950555, "creation_date": 1557940456, "question_id": 56154533, "link": "https://stackoverflow.com/questions/56154533/defining-maximum-char-array-size-allowable-to-c-programs-in-linux", "title": "Defining maximum char[] array size allowable to C programs in linux", "body": "<p>I have made code in C involving local char arrays, but I read that if the size of the arrays are too high then a segmentation fault may occur.</p>\n\n<p>In my code, I included the following line:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n</code></pre>\n\n<p>And I also added in the output section: </p>\n\n<p>printf(\"%d\",SIZE_MAX);</p>\n\n<p>Upon execution, I see a -1 which suggests to me Unlimited.</p>\n\n<p>I then proceed into a console and checked my limits:</p>\n\n<pre><code>bash-3.1# ulimit -a\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 8189\nmax locked memory       (kbytes, -l) 4096\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nstack size              (kbytes, -s) 4096\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 8189\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n</code></pre>\n\n<p>And I see many \"unlimited\"'s.</p>\n\n<p>Am I looking in the right place to define the maximum allowable size for a char[] array? If so, Which value do I need to modify?</p>\n"}, {"tags": ["c", "arrays", "size", "language-lawyer", "pointer-arithmetic"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 13, "creation_date": 1557945564, "post_id": 56154380, "comment_id": 98940613, "body": "Well, can&#39;t find it, but looks like strictly speaking it is. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#J.2\" rel=\"nofollow noreferrer\">Annex J.2</a> is explicitly stating: <i>The operand of the unary * operator has an invalid value</i> is an undefined behavior. Here <code>&amp;a + 1</code> is not pointing to any valid object, so it is invalid."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 5, "creation_date": 1557988207, "post_id": 56154380, "comment_id": 98951847, "body": "Related: <a href=\"https://stackoverflow.com/q/32537471/3049655\">Is <code>*((*(&amp;array + 1)) - 1)</code> safe to use to get the last element of an automatic array?</a>. tl;dr <code>*(&amp;a + 1)</code> invokes Undefined Behvaior"}, {"owner": {"reputation": 35273, "user_id": 2637490, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9XyjC.gif?s=128&g=1", "display_name": "Alma Do", "link": "https://stackoverflow.com/users/2637490/alma-do"}, "edited": false, "score": 5, "creation_date": 1558083346, "post_id": 56154380, "comment_id": 98991375, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/16019009/find-size-of-array-without-using-sizeof-in-c\">Find size of array without using sizeof in C</a>"}, {"owner": {"reputation": 1279, "user_id": 4175223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/346po.png?s=128&g=1", "display_name": "janojlic", "link": "https://stackoverflow.com/users/4175223/janojlic"}, "reply_to_user": {"reputation": 35273, "user_id": 2637490, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9XyjC.gif?s=128&g=1", "display_name": "Alma Do", "link": "https://stackoverflow.com/users/2637490/alma-do"}, "edited": false, "score": 0, "creation_date": 1558123565, "post_id": 56154380, "comment_id": 99010487, "body": "@AlmaDo well the syntax does differ a bit, i.e. the indexing part, so I believe that this question is still valid on its own, but I might be wrong. Thank you for pointing it out!"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1559936379, "post_id": 56154380, "comment_id": 99589852, "body": "@janojlicz They&#39;re essentially the same, because <code>(ptr)[x]</code> is the same as <code>*((ptr) + x)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": false, "score": 35, "last_activity_date": 1563285328, "last_edit_date": 1563285328, "creation_date": 1557940180, "answer_id": 56154462, "question_id": 56154380, "link": "https://stackoverflow.com/questions/56154380/how-does-this-piece-of-code-determine-array-size-without-using-sizeof/56154462#56154462", "title": "How does this piece of code determine array size without using sizeof( )?", "body": "<p>This line is of most importance:</p>\n\n<pre><code>size = *(&amp;a + 1) - a;\n</code></pre>\n\n<p>As you can see, it first takes the address of <code>a</code> and adds one to it. Then, it dereferences that pointer and subtracts the original value of <code>a</code> from it.</p>\n\n<p>Pointer arithmetic in C causes this to return the number of elements in the array, or <code>5</code>. Adding one and <code>&amp;a</code> is a pointer to the next array of 5 <code>int</code>s after <code>a</code>. After that, this code dereferences the resulting pointer and subtracts <code>a</code> (an array type that has decayed to a pointer) from that, giving the number of elements in the array.</p>\n\n<p>Details on how pointer arithmetic works:</p>\n\n<p>Say you have a pointer <code>xyz</code> that points to an <code>int</code> type and contains the value <code>(int *)160</code>. When you subtract any number from <code>xyz</code>, C specifies that the actual amount subtracted from <code>xyz</code> is that number times the size of the type that it points to. For example, if you subtracted <code>5</code> from <code>xyz</code>, the value of <code>xyz</code> resulting would be <code>xyz - (sizeof(*xyz) * 5)</code> if pointer arithmetic didn't apply.</p>\n\n<p>As <code>a</code> is an array of <code>5</code> <code>int</code> types, the resulting value will be 5. However, this will not work with a pointer, only with an array. If you try this with a pointer, the result will always be <code>1</code>.</p>\n\n<p>Here's a little example that shows the addresses and how this is undefined. The the left-hand side shows the addresses:</p>\n\n<pre><code>a + 0 | [a[0]] | &amp;a points to this\na + 1 | [a[1]]\na + 2 | [a[2]]\na + 3 | [a[3]]\na + 4 | [a[4]] | end of array\na + 5 | [a[5]] | &amp;a+1 points to this; accessing past array when dereferenced\n</code></pre>\n\n<p>This means that the code is subtracting <code>a</code> from <code>&amp;a[5]</code> (or <code>a+5</code>), giving <code>5</code>.</p>\n\n<p><sub>Note that this is undefined behavior, and should not be used under any circumstances. Do not expect the behavior of this to be consistent across all platforms, and do not use it in production programs.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1557941205, "post_id": 56154614, "comment_id": 98938699, "body": "Fair enough. However for reasons hard to explain, everyone uses sizeof()/sizeof() ?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 5, "creation_date": 1557941288, "post_id": 56154614, "comment_id": 98938741, "body": "Most people do. For example, <code>sizeof(array)&#47;sizeof(array[0])</code> gives the number of elements in an array."}, {"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1557944116, "post_id": 56154614, "comment_id": 98939964, "body": "The C compiler is allowed to align the array, but I&#39;m unconvinced it&#39;s allowed to change the type of the array after doing so. Alignment would be more realistically implemented by inserting padding bytes."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1557944375, "post_id": 56154614, "comment_id": 98940065, "body": "@Kevin I&#39;m not saying it would change the type, but by dereferencing the array, the programmer has invoked the &quot;array of array&quot; behaviour, and the alignment of the elements of that outer array is what I question."}, {"owner": {"reputation": 116, "user_id": 7581343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b87be8977cdad5dcc9bbd44f9d4abc?s=128&d=identicon&r=PG&f=1", "display_name": "wrtlprnft", "link": "https://stackoverflow.com/users/7581343/wrtlprnft"}, "edited": false, "score": 0, "creation_date": 1557947243, "post_id": 56154614, "comment_id": 98941313, "body": "Can you circumvent the dereferencing issue by using <code>((char *)(&amp;a + 1) - (char *)a) &#47; ((char *)(a + 1) - (char *)a)</code> or does this just invoke some other kind of undefined behavior?"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 116, "user_id": 7581343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33b87be8977cdad5dcc9bbd44f9d4abc?s=128&d=identicon&r=PG&f=1", "display_name": "wrtlprnft", "link": "https://stackoverflow.com/users/7581343/wrtlprnft"}, "edited": false, "score": 0, "creation_date": 1557947530, "post_id": 56154614, "comment_id": 98941444, "body": "@wrtlprnft whrrrrr?????? OK, I can see where you are coming from, but I think you have just written sizeof() :-)"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557951051, "post_id": 56154614, "comment_id": 98942911, "body": "Subtracting of pointers is not limited to just two pointers into the same array\u2014the pointers are also allowed to be one past the end of the array. <code>&amp;a+1</code> is defined. As John Bollinger notes, <code>*(&amp;a+1)</code> is not, since it attempts to dereference an object that does not exist."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 5, "creation_date": 1557951320, "post_id": 56154614, "comment_id": 98943026, "body": "A compiler cannot implement a <code>char [][5]</code> as <code>char arr[][8]</code>. An array is just the repeated objects in it; there is no padding. Additional, this would break the (non-normative) example 2 in C 2018 6.5.3.4 7, which tells us we can compute the number of elements in an array with <code>sizeof array &#47; sizeof array[0]</code>."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1558010819, "post_id": 56154614, "comment_id": 98964334, "body": "@EricPostpischil , but I does that tell us that <code>sizeof(array[n])</code> is the same beast as <code>array[][n]</code>? I do know that sizeof()/sizeof() is the traditional way to calculate an array size, and it interesting that that is written into the standard.  It is also interesting that I can create odd-sized structs in C (by setting alignment flags sometimes), and you are saying that arrays of them would not be realigned?"}], "tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 27, "last_activity_date": 1557944639, "last_edit_date": 1557944639, "creation_date": 1557940781, "answer_id": 56154614, "question_id": 56154380, "link": "https://stackoverflow.com/questions/56154380/how-does-this-piece-of-code-determine-array-size-without-using-sizeof/56154614#56154614", "title": "How does this piece of code determine array size without using sizeof( )?", "body": "<p>Hmm, I suspect this is something that would not have worked back in the early days of C. It is clever though.</p>\n\n<p>Taking the steps one at a time:</p>\n\n<ul>\n<li><code>&amp;a</code> gets a pointer to an object of type int[5] </li>\n<li><code>+1</code> gets the next such object assuming there is an array of those</li>\n<li><code>*</code>  effectively converts that address into type pointer to int</li>\n<li><code>-a</code> subtracts the two int pointers, returning the count of int instances between them.</li>\n</ul>\n\n<p>I'm not sure it is completely legal (in this I mean language-lawyer legal - not will it work in practice), given some of the type operations going on. For example you are only \"allowed\" to subtract two pointers when they point to elements in the same array. <code>*(&amp;a+1)</code> was synthesised by accessing another array, albeit a parent array, so is not actually a pointer into the same array as <code>a</code>.\nAlso, while you are allowed to synthesise a pointer past the last element of an array, and you can treat any object as an array of 1 element, the operation of dereferencing (<code>*</code>) is not \"allowed\" on this synthesised pointer, even though it has no behaviour in this case!</p>\n\n<p>I suspect that in the early days of C (K&amp;R syntax, anyone?), an array decayed into a pointer much more quickly, so the <code>*(&amp;a+1)</code> might only return the address of the next pointer of type int**. The more rigorous definitions of modern C++ definitely allow the pointer to array type to exist and know the array size, and probably the C standards have followed suit. All C function code only takes pointers as arguments, so the technical visible difference is minimal. But I am only guessing here.</p>\n\n<p>This sort of detailed legality question usually applies to a C interpreter, or a lint type tool, rather than the compiled code. An interpretter might implement a 2D array as an array of pointers to arrays, because there is one less runtime feature to implement, in which case dereferencing the +1 would be fatal, and even if it worked would give the wrong answer.</p>\n\n<p>Another possible weakness may be that the C compiler might align the outer array. Imagine if this was an array of 5 chars (<code>char arr[5]</code>), when the program performs <code>&amp;a+1</code> it is invoking \"array of array\" behaviour. The compiler might decide that an array of array of 5 chars (<code>char arr[][5]</code>) is actually generated as an array of array of 8 chars (<code>char arr[][8]</code>), so that the outer array aligns nicely. The code we are discussing would now report the array size as 8, not 5. I'm not saying a particular compiler would definitely do this, but it might. </p>\n"}, {"comments": [{"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 13, "creation_date": 1557951911, "post_id": 56156165, "comment_id": 98943266, "body": "That \u201cshall not be used\u201d text is official: C 2018 6.5.6 8."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557952564, "post_id": 56156165, "comment_id": 98943541, "body": "@EricPostpischil: Do you have a link to the 2018 pre-pub draft (similar to N1570.pdf)?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1557953200, "post_id": 56156165, "comment_id": 98943785, "body": "@JohnBode: <a href=\"https://stackoverflow.com/a/83763/298225\">This answer</a> has <a href=\"https://web.archive.org/web/20181230041359if_/http://www.open-std.org/jtc1/sc22/wg14/www/abq/c17_updated_proposed_fdis.pdf\" rel=\"nofollow noreferrer\">a link to the Wayback Machine</a>. I checked the official standard in my purchased copy."}, {"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "edited": false, "score": 7, "creation_date": 1558005488, "post_id": 56156165, "comment_id": 98961211, "body": "So if one wrote <code>size = (int*)(&amp;a + 1) - a;</code> this code would be completely valid? :o"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "edited": false, "score": 0, "creation_date": 1558087732, "post_id": 56156165, "comment_id": 98993727, "body": "@Gizmo they probably originally didn&#39;t write that because that way you have to specify the element type; the original was probably written defined as a macro for type-generic use on different element types."}, {"owner": {"reputation": 1596, "user_id": 2548287, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mBqgl.png?s=128&g=1", "display_name": "Gizmo", "link": "https://stackoverflow.com/users/2548287/gizmo"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1558089160, "post_id": 56156165, "comment_id": 98994444, "body": "@Leushenko yeah that much I did figure, as C doesn&#39;t have templates/different prototypes based on parameter types."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 137, "last_activity_date": 1558006037, "last_edit_date": 1592644375, "creation_date": 1557947397, "answer_id": 56156165, "question_id": 56154380, "link": "https://stackoverflow.com/questions/56154380/how-does-this-piece-of-code-determine-array-size-without-using-sizeof/56156165#56156165", "title": "How does this piece of code determine array size without using sizeof( )?", "body": "<p>When you add 1 to a pointer, the result is the location of the next object in a sequence of objects of the pointed-to type (i.e., an array).  If <code>p</code> points to an <code>int</code> object, then <code>p + 1</code> will point to the next <code>int</code> in a sequence.  If <code>p</code> points to a 5-element array of <code>int</code> (in this case, the expression <code>&amp;a</code>), then <code>p + 1</code> will point to the next <em>5-element array of <code>int</code></em> in a sequence.</p>\n<p>Subtracting two pointers (provided they both point into the same array object, or one is pointing one past the last element of the array) yields the number of objects (array elements) between those two pointers.</p>\n<p>The expression <code>&amp;a</code> yields the address of <code>a</code>, and has the type <code>int (*)[5]</code> (pointer to 5-element array of <code>int</code>).  The expression <code>&amp;a + 1</code> yields the address of the next 5-element array of <code>int</code> following <code>a</code>, and also has the type <code>int (*)[5]</code>.  The expression <code>*(&amp;a + 1)</code> dereferences the result of <code>&amp;a + 1</code>, such that it yields the address of the first <code>int</code> following the last element of <code>a</code>, and has type <code>int [5]</code>, which in this context &quot;decays&quot; to an expression of type <code>int *</code>.</p>\n<p>Similarly, the expression <code>a</code> &quot;decays&quot; to a pointer to the first element of the array and has type <code>int *</code>.</p>\n<p>A picture may help:</p>\n<pre><code>int [5]  int (*)[5]     int      int *\n\n+---+                   +---+\n|   | &lt;- &amp;a             |   | &lt;- a\n| - |                   +---+\n|   |                   |   | &lt;- a + 1\n| - |                   +---+\n|   |                   |   |\n| - |                   +---+\n|   |                   |   |\n| - |                   +---+\n|   |                   |   |\n+---+                   +---+\n|   | &lt;- &amp;a + 1         |   | &lt;- *(&amp;a + 1)\n| - |                   +---+\n|   |                   |   |\n| - |                   +---+\n|   |                   |   |\n| - |                   +---+\n|   |                   |   |\n| - |                   +---+\n|   |                   |   |\n+---+                   +---+\n</code></pre>\n<p>This is two views of the same storage - on the left, we're viewing it as a sequence of 5-element arrays of <code>int</code>, while on the right, we're viewing it as a sequence of <code>int</code>.  I also show the various expressions and their types.</p>\n<p>Be aware, the expression <code>*(&amp;a + 1)</code> results in <em>undefined behavior</em>:</p>\n<blockquote>\n...<br>\nIf the result points one past the last element of the array object, it\nshall not be used as the operand of a unary * operator that is evaluated.\n</blockquote>\n<p><sup><em><a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"noreferrer\">C 2011 Online Draft</a>, 6.5.6/9</em></sup></p>\n"}], "owner": {"reputation": 1279, "user_id": 4175223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/346po.png?s=128&g=1", "display_name": "janojlic", "link": "https://stackoverflow.com/users/4175223/janojlic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8551, "favorite_count": 29, "accepted_answer_id": 56156165, "answer_count": 3, "score": 134, "last_activity_date": 1563285328, "creation_date": 1557939837, "last_edit_date": 1558123962, "question_id": 56154380, "link": "https://stackoverflow.com/questions/56154380/how-does-this-piece-of-code-determine-array-size-without-using-sizeof", "title": "How does this piece of code determine array size without using sizeof( )?", "body": "<p>Going through some C interview questions, I've found a question stating \"How to find the size of an array in C without using the sizeof operator?\", with the following solution. It works, but I cannot understand why.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n\nint main() {\n    int a[] = {100, 200, 300, 400, 500};\n    int size = 0;\n\n    size = *(&amp;a + 1) - a;\n    printf(\"%d\\n\", size);\n\n    return 0;\n}\n</code></pre>\n\n<p>As expected, it returns 5.</p>\n\n<p>edit: people pointed out <a href=\"https://stackoverflow.com/questions/16019009/find-size-of-array-without-using-sizeof-in-c\">this</a> answer, but the syntax does differ a bit, i.e. the indexing method</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>size = (&amp;arr)[1] - arr;\n</code></pre>\n\n<p>so I believe both questions are valid and have a slightly different approach to the problem. Thank you all for the immense help and thorough explanation!</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 3805, "user_id": 3845803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aG57R.jpg?s=128&g=1", "display_name": "Kon", "link": "https://stackoverflow.com/users/3845803/kon"}, "is_accepted": true, "score": 4, "last_activity_date": 1557939976, "creation_date": 1557939976, "answer_id": 56154416, "question_id": 56154370, "link": "https://stackoverflow.com/questions/56154370/c-program-crashes-when-calculation-performed/56154416#56154416", "title": "C program crashes when calculation performed", "body": "<p>Your last <code>printf</code> statement prints <code>n</code> as <code>%s</code> (string).  <code>n</code> is an integer and should not be printed as a string.</p>\n\n<pre><code>printf(\"Employee %s Bonus is %.2f\",n,bonus);\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>printf(\"Employee %d Bonus is %.2f\",n,bonus);\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 8485666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f49059e8c728c3e54ddeaf5d28c68ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ran_Macavity", "link": "https://stackoverflow.com/users/8485666/ran-macavity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56154416, "answer_count": 1, "score": 3, "last_activity_date": 1557940100, "creation_date": 1557939798, "last_edit_date": 1557940100, "question_id": 56154370, "link": "https://stackoverflow.com/questions/56154370/c-program-crashes-when-calculation-performed", "title": "C program crashes when calculation performed", "body": "<p>I have this program where I calculate employee bonus based on their salary. Program terminates when n ===999. But my problem is when I calculate the bonus,in either case \"Debug 1\" or \"Debug 2\" gets printed.\nand program crashes without any errors.</p>\n\n<p>This is my first program in C. I am familiar with java and I cannot figure out what I am doing wrong here. I am using Code::blocks for programming in C.</p>\n\n<p>Could someone kindly point out the error? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int n;\n    float basic;\n    float bonus;\n\n    for(;;)\n    {\n        printf(\"Enter the Emp No = \");\n        scanf(\"%d\",&amp;n);\n\n        if(n==999)\n        {\n            break;\n        }\n        else\n        {\n            printf(\"Enter Employee Salary\\n\");\n            scanf(\"%f\",&amp;basic);\n            printf(\"Basic Salary is %f\",basic);\n\n            if(basic &lt; 100000)\n            {\n                printf(\"Debug 1\");\n                bonus = 0.75 * basic;\n            }\n            else\n            {\n                printf(\"Debug 2\");\n                bonus = 0.5 * basic;\n            }\n            printf(\"Employee %s Bonus is %.2f\",n,bonus);\n        }\n\n        basic = 0.0f;\n        bonus = 0.0f;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "global"], "comments": [{"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557939190, "post_id": 56154169, "comment_id": 98937798, "body": "Static or dynamic linkage?"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557939277, "post_id": 56154169, "comment_id": 98937837, "body": "Please show in your question the commands you use to compile and link the code."}, {"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1557939300, "post_id": 56154169, "comment_id": 98937841, "body": "This answer specifically: <a href=\"https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix/12574420#12574420\" title=\"what is an undefined reference unresolved external symbol error and how do i fix\">stackoverflow.com/questions/12573816/&hellip;</a>"}, {"owner": {"reputation": 640, "user_id": 3793674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a5746c9da4b2293984258875ce00e1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/3793674/chrisd"}, "edited": false, "score": 0, "creation_date": 1557939359, "post_id": 56154169, "comment_id": 98937861, "body": "In the header you&#39;ve defined <code>x</code> as a <code>const int</code> and in the source file as a plain <code>int</code>. Was that a typo? Also, it&#39;s more usual to wrap the <code>#include</code> with an  <code>extern &quot;C&quot;</code> in the cpp sources."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1557939417, "post_id": 56154169, "comment_id": 98937887, "body": "The argument <code>int x</code> takes precedence over the global variable <code>int x = 5;</code> Which is to say that the correctness of your code depends on code that you haven&#39;t shown. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 41, "user_id": 11317528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b838aa544e65f67ef13fda50749ede14?s=128&d=identicon&r=PG&f=1", "display_name": "jdhabez", "link": "https://stackoverflow.com/users/11317528/jdhabez"}, "reply_to_user": {"reputation": 640, "user_id": 3793674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a5746c9da4b2293984258875ce00e1?s=128&d=identicon&r=PG&f=1", "display_name": "ChrisD", "link": "https://stackoverflow.com/users/3793674/chrisd"}, "edited": false, "score": 0, "creation_date": 1557939585, "post_id": 56154169, "comment_id": 98937956, "body": "@ChrisD yes, it is a typo sorry. I&#39;ve tried moving the extern &quot;C&quot; to the cpp source as well."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11317528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b838aa544e65f67ef13fda50749ede14?s=128&d=identicon&r=PG&f=1", "display_name": "jdhabez", "link": "https://stackoverflow.com/users/11317528/jdhabez"}, "edited": false, "score": 0, "creation_date": 1557939439, "post_id": 56154224, "comment_id": 98937897, "body": "but I am doing that..."}], "tags": [], "owner": {"reputation": 552, "user_id": 11038454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118900695ae8e562f696c0dd14feb0d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/11038454/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1557939226, "creation_date": 1557939226, "answer_id": 56154224, "question_id": 56154169, "link": "https://stackoverflow.com/questions/56154169/trouble-linking-c-global-variables-with-c-code/56154224#56154224", "title": "Trouble linking C global variables with C++ code", "body": "<p>You need to link the .o file where you have that value defined. Compile time, the compiler would not worry about the value. but at link time, compiler is trying to find the value among all the .o and linked libraries. if it cannot find, you will get that error.</p>\n"}], "owner": {"reputation": 41, "user_id": 11317528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b838aa544e65f67ef13fda50749ede14?s=128&d=identicon&r=PG&f=1", "display_name": "jdhabez", "link": "https://stackoverflow.com/users/11317528/jdhabez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "closed_date": 1557939221, "answer_count": 1, "score": -1, "last_activity_date": 1557939226, "creation_date": 1557938993, "question_id": 56154169, "link": "https://stackoverflow.com/questions/56154169/trouble-linking-c-global-variables-with-c-code", "closed_reason": "Duplicate", "title": "Trouble linking C global variables with C++ code", "body": "<p>I am working on a project that utilizes C source code to call upon a C++ function that is also linked to a C++ library. I have been able to allow for my C code to call on the C++ function, however I also want my C++ function to have access to the global variables defined in the C source code. I currently get errors when linking the C/C++ code .o files. The error messages go through each of the .o files that use these global variables and states \"undefined reference to..\"</p>\n\n<p>This isn't the exact code or anything but basically a very simple of example of what I am trying to do. The constants.h file also gets used by other C code.</p>\n\n<p>constants.h</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n\nextern const int x;\n\n#ifdef __cplusplus\n}\n#end if\n</code></pre>\n\n<p>constants.c</p>\n\n<pre><code>int x = 5;\n</code></pre>\n\n<p>mycppcode.cpp</p>\n\n<pre><code>#include \"constants.h\"\n\nvoid print_x(int x){\n\n    printf(\"%d\", x);\n\n};\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1557938071, "post_id": 56153808, "comment_id": 98937237, "body": "So <code>s</code> and <code>c</code> have the same length, <code>ns == nc</code>, right? One problem I see is that the index <code>d</code> does not apply to the result array <code>r</code>; you need a separate index for the result array."}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1557938445, "post_id": 56153808, "comment_id": 98937418, "body": "yes, they have the same length"}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "reply_to_user": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 0, "creation_date": 1557938516, "post_id": 56153808, "comment_id": 98937457, "body": "How can I do that ? I have no idea"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557938919, "post_id": 56153808, "comment_id": 98937666, "body": "Please show a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "edited": false, "score": 0, "creation_date": 1557939788, "post_id": 56153808, "comment_id": 98938056, "body": "uhm, i don&#39;t know to do more than this, I&#39;m not that good at this sorry"}], "answers": [{"tags": [], "owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "is_accepted": true, "score": 1, "last_activity_date": 1557940288, "creation_date": 1557940288, "answer_id": 56154485, "question_id": 56153808, "link": "https://stackoverflow.com/questions/56153808/stuck-on-code-about-arrays-and-moving-digits-in-it/56154485#56154485", "title": "Stuck on code about arrays and moving digits in it", "body": "<p>Your problem description is not very clear, but you want to do this:</p>\n\n<ul>\n<li>You have two arrays <code>s</code> and <code>c</code> of the same size <code>N</code>.</li>\n<li>First, walk through the array backwards. If the value in <code>c</code> is even, add the corresponding value from <code>s</code> to the result array.</li>\n<li>Finally, add the remaining elements of <code>s</code> to the array. The result array will now have <code>N</code> elements, too.</li>\n</ul>\n\n<p>The first thing to notice is that if you look at <code>c[4]</code> and decide to add element <code>s[4]</code> to the result array, the index for that array is <code>0</code>, because you add elements from the front. In general, if you want to append to an array, you do:</p>\n\n<pre><code>int array[5];      // space for 5 ints\nint n = 0;         // current length; start with empty array\n\narray[n++] = 5;    // array == [5];         n == 1\narray[n++] = 8;    // array == [5, 8];      n == 2\narray[n++] = 15;   // array == [5, 8, 15];  n == 3\n</code></pre>\n\n<p>Your backwards loop works, but it is a bit clumsy, in my opinion. In C (and other languages), ranges are described by the inclusive lower bound and an exclusive upper bound. In the range [0, <code>N</code>), the value <code>N</code> is just out of bound.</p>\n\n<p>Forwad loops initialize to the lower bound, break on the upper bound and increment after each cycle. Because of this asymetry, backwards loops are simpler when you start with the upper bound, break on the lower bound, but decrement at the start of the loop:</p>\n\n<pre><code>for (i = N; i-- &gt; 0; ) ...\n</code></pre>\n\n<p>The empty update section looks strange, but in this loop, the index never leaves the valid range and therefore also works with unsigned integers.</p>\n\n<p>Create your arrays:</p>\n\n<pre><code>int s[N] = {7, 3, 6, 2, 8};         // value array\nint c[N] = {0, 12, 5, 23, 14};      // control array\nint r[N];                           // result array\nint k = 0;                          // length of r\n</code></pre>\n\n<p>Now walk the arrays backwards and pick the items you want:</p>\n\n<pre><code>for (i = N; i-- &gt; 0; ) {\n    if (c[i] % 2 == 0) {\n        r[k++] = s[i];\n    }\n}\n</code></pre>\n\n<p>Walk the array forwards and pick the items you didn't pick in the first pass:</p>\n\n<pre><code>for (i = 0; i &lt; N; i++) {\n    if (c[i] % 2) {\n        r[k++] = s[i];\n    }\n}\n</code></pre>\n\n<p>Voil\u00e0.</p>\n"}], "owner": {"reputation": 55, "user_id": 11505346, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KnqcLz9qHP8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdaG8JPE6mfBPK7mwc8Yq5gZP2Kuw/mo/photo.jpg?sz=128", "display_name": "Andrei Jarca", "link": "https://stackoverflow.com/users/11505346/andrei-jarca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 56154485, "answer_count": 1, "score": 0, "last_activity_date": 1557940288, "creation_date": 1557937505, "last_edit_date": 1557939289, "question_id": 56153808, "link": "https://stackoverflow.com/questions/56153808/stuck-on-code-about-arrays-and-moving-digits-in-it", "title": "Stuck on code about arrays and moving digits in it", "body": "<p>There are two arrays:</p>\n\n<pre><code>s: 7 3  6  2  8  \nc: 0 12 5 23 14  \nnew array: 8 3 7 6 2\n</code></pre>\n\n<p>Basically, you look at array <code>c</code> and if it has an even number, you print the one from the array <code>s</code>. For example, <code>14</code> is even so you print <code>8</code>. You need to print them in that order, from right to left.</p>\n\n<p>So I read the first two arrays, but I don't know how to put the rest of the code. If you put:</p>\n\n<pre><code>array s: 1 2 3  \narray c: 4 4 4\n</code></pre>\n\n<p>you will get: <code>3 2 1</code>, which we need, but if I put 1 odd number, I will get some error number. I don't know how to put the rest of array <code>s</code>, after I put the even numbers.</p>\n\n<pre><code>for(d=0; d&lt;ns; d++)\n{\n    scanf(\"%d\", &amp;s[d]); //here we have the first array\n\n}\nfor(d=0; d&lt;nc; d++)\n{\n    scanf(\"%d\", &amp;c[d]); //second array\n}\nfor(d=0; d&lt;ns; d++)\n{\n    if(c[d]%2==0)   //I check here if the nb. from second array are even\n    {\n\n        r[d]=s[d]; //I try to put the numbers from the first array \n\n    }\n}\nfor(d=ns-1; d&gt;-1; d--)\n{\n    printf(\"%d \", r[d]);  //I print the new array\n}\n}\n</code></pre>\n"}, {"tags": ["c", "microcontroller"], "comments": [{"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 4, "creation_date": 1557937494, "post_id": 56153759, "comment_id": 98936978, "body": "How do you define &quot;best&quot;? Does your current approach not work?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557937518, "post_id": 56153759, "comment_id": 98936989, "body": "You can nest the next digit control inside the previous, since they won&#39;t change until the previous rolls over. When the l.s.digit chnages from say <code>0</code> to <code>1</code> you are unnecessarily checking all the other digits."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 2, "creation_date": 1557937561, "post_id": 56153759, "comment_id": 98937008, "body": "Why not just dump this out as a string (<code>sprintf(output, &quot;%04d&quot;, value)</code>) and then display each digit <code>d - &#39;0&#39;</code>? Unless you&#39;re changing the values thousands of times per second this is usually efficient enough."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1557937693, "post_id": 56153759, "comment_id": 98937073, "body": "Perhaps because <code>printf</code>family can be a very expensive option on a basic micro."}], "answers": [{"tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 4, "last_activity_date": 1557938102, "creation_date": 1557938102, "answer_id": 56153970, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56153970#56153970", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<p>You can nest the digit reset or increment</p>\n\n<pre><code>dis_value[0]++;\nif (dis_value[0] &gt; 9) {\n     dis_value[0] = 0;\n     dis_value[1]++;\n\n     if (dis_value[1] &gt; 9) {\n          dis_value[1] = 0;\n          dis_value[2]++;\n\n            if (dis_value[2] &gt; 9) {\n                dis_value[2] = 0;\n                dis_value[3]++;\n\n                if (dis_value[3] &gt; 9) {\n                    dis_value[3] = 0;\n                }\n           }\n      }\n  }\n</code></pre>\n\n<p>By doing above you are not unnecessarily executing all the <code>if</code>s.</p>\n"}, {"tags": [], "owner": {"reputation": 13124, "user_id": 1419272, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dcbff46aa5cd0a98d13d76595b3375f0?s=128&d=identicon&r=PG", "display_name": "alinsoar", "link": "https://stackoverflow.com/users/1419272/alinsoar"}, "is_accepted": false, "score": -1, "last_activity_date": 1558284604, "last_edit_date": 1558284604, "creation_date": 1557941225, "answer_id": 56154725, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56154725#56154725", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<p>Here I used the method <code>backtracking</code>, i.e. traversing all the branches of a tree and printing the buffer <code>a</code> when it is on some leaf.</p>\n\n<p>Feel free to change the values for the parameter <code>N</code> and <code>base</code>.</p>\n\n<p>The tree has the maximum depth <code>N</code>.  Each node, apart from leaves, has exactly <code>base</code> branches.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n\nint main(void)\n{\n  char a[100];\n  int i;\n  int N=4;\n  int base_1='9', zero_1='0'-1;\n\n  memset(a, 0, 100);\n  memset(a, zero_1, N);\n\n  i=0;\n  while(i&gt;=0)\n  {\n    if (++a[i]&lt;=base_1)\n      if (i==N-1) printf(\"%s\\n\", a);\n      else i++;\n    else\n      a[i--]=zero_1;\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 2, "creation_date": 1557944890, "post_id": 56154821, "comment_id": 98940281, "body": "Hmm, depending on the microcontroller, div and modulo functions can be quite expensive, or even emulated =&gt; very expensive."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1557946400, "post_id": 56154821, "comment_id": 98940946, "body": "@GemTaylor on every platform with hardware multiplication == all modern - it is not <a href=\"https://godbolt.org/z/iw5DgI\" rel=\"nofollow noreferrer\">godbolt.org/z/iw5DgI</a>   Only old 8 bit arch are affected."}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 2, "creation_date": 1557947129, "post_id": 56154821, "comment_id": 98941264, "body": "But you aren&#39;t doing multiplication, but division (modulo). On 8086, division could take up to 250 cycles, for example, compared to 4 for an internal register op."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1557949100, "post_id": 56154821, "comment_id": 98942117, "body": "@GemTaylor <code>% 10</code> and <code>&#47; 10</code> using divisions are very naive implementations"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 3, "last_activity_date": 1557941626, "creation_date": 1557941626, "answer_id": 56154821, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56154821#56154821", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<pre><code>char *inc(char *buff, unsigned *i)\n{\n    unsigned tmp = ++(*i);\n    buff[0] = tmp % 10;\n    tmp /= 10;\n    buff[1] = tmp % 10;\n    tmp /= 10;\n    buff[2] = tmp % 10;\n    tmp /= 10;\n    buff[3] = tmp % 10;\n    return buff;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 10690677, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RpOOztKAP0I/AAAAAAAAAAI/AAAAAAAAABc/eApviIeGe_g/photo.jpg?sz=128", "display_name": "Matthew Benjamin", "link": "https://stackoverflow.com/users/10690677/matthew-benjamin"}, "is_accepted": false, "score": 0, "last_activity_date": 1557942828, "creation_date": 1557942828, "answer_id": 56155115, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56155115#56155115", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nvoid delay(int number_of_seconds)\n{\n    int milli_seconds = 1000 * number_of_seconds;\n    clock_t start_time = clock();\n    while (clock() &lt; start_time + milli_seconds);\n}\n\nint main(int argc, const char *argv[])\n{\n\n    int arr[4] = {0};\n    for(int i=0; i &lt; 4; i++)\n    {\n        for(int j = 0; j&lt;9; j++)\n        {\n            arr[i]++;\n            delay(1000);\n            printf(\"%i%i%i%i\\n\",arr[3], arr[2], arr[1], arr[0]);\n        }\n    }\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 0, "last_activity_date": 1557947280, "last_edit_date": 1557947280, "creation_date": 1557946209, "answer_id": 56155913, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56155913#56155913", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<p>I spotted you want to keep the code with minimal dependencise on a microcontroller.</p>\n\n<p>If you are willing to treat the dis_value buffer as an integer, with one byte per digit, say little-endian, which can be held in a register, which should also be faster, then you can combine the sequence:</p>\n\n<pre><code>if (dis_value[N] &gt; 9) {\n  dis_value[N] = 0;\n  dis_value[N+1]++;\n</code></pre>\n\n<p>It becomes (with @kiran 's nesting)</p>\n\n<pre><code>if ((dis_value&amp;(0xf&lt;&lt;(N*8)))==(10&lt;&lt;(N*8)))\n{\n    dis_value+=(0x100-10)&lt;&lt;(N*8);\n    if ...\n}\n</code></pre>\n\n<p>Where I am presuming the compiler will resolve the constant expressions. \nIt would also be good to reverse the addition and the if in order to improve conditional pipeline evaluation, if your controller has a pipeline, but that means writing assembler code. </p>\n\n<p>The following pseudocode should give the idea. The next condition is evaluated using the value before the addition, so the two operations can be performed in parallel. If you were actually encoding this to a circuit, this is an obvious optimisation:</p>\n\n<pre><code>bool do0 = ((dis_value&amp;(0xf&lt;&lt;(0*8)))==(9&lt;&lt;(0*8)))\ndis_value++;\nif (do0)\n{\n    bool do1 = ((dis_value&amp;(0xf&lt;&lt;(1*8)))==(9&lt;&lt;(1*8)));\n    dis_value += (0x100-10)&lt;&lt;(0*8);\n    if (do1)\n    {\n        do2 = ((dis_value&amp;(0xf&lt;&lt;(2*8)))==(9&lt;&lt;(2*8)));\n        dis_value += (0x100-10)&lt;&lt;(1*8);\n        if (do2) ...\n    }\n}\n</code></pre>\n\n<p>The next question to ask is how can you minimally update a segmented display for an increment!</p>\n"}, {"tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": false, "score": 0, "last_activity_date": 1557989995, "creation_date": 1557989995, "answer_id": 56162552, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display/56162552#56162552", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<p>simulate math addition would suffice, checking from the lowest digit to the highest.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid incr(int dis_value[], int n) {\n    ++dis_value[0];\n    for (int i=0; i+1&lt;n; ++i) {\n        if (dis_value[i] &lt; 10) break;\n        dis_value[i+1] += dis_value[i] / 10;\n        dis_value[i] %= 10;\n    }\n    dis_value[n-1] %= 10;\n}\n\nvoid echo(int dis_value[], int n) {\n    for (int i=n-1; i&gt;=0; --i) printf(\"%d\", dis_value[i]);\n    printf(\"\\n\");\n}\n\nint main() {\n    int dis_value[] = {0, 0, 0, 0};\n    for (int i=0; i&lt;10000; ++i) {\n        incr(dis_value, 4);\n        echo(dis_value, 4);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 11185484, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-SmgKkS-tFFg/AAAAAAAAAAI/AAAAAAAABxc/kqbQgMSp1ss/photo.jpg?sz=128", "display_name": "Singed", "link": "https://stackoverflow.com/users/11185484/singed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 6, "score": 2, "last_activity_date": 1558284604, "creation_date": 1557937341, "question_id": 56153759, "link": "https://stackoverflow.com/questions/56153759/how-to-efficienty-count-from-0000-to-9999-in-a-digit-display", "title": "How to efficienty count from 0000 to 9999 in a digit display?", "body": "<p>I've n display that count from 0 to 9. I'd like to make an efficient code for a micro in C language. What I've wrote is:</p>\n\n<pre><code>dis_value[0]++;\nif (dis_value[0] &gt; 9) {\n    dis_value[0] = 0;\n    dis_value[1]++;\n}\nif (dis_value[1] &gt; 9) {\n    dis_value[0] = 0;\n    dis_value[1] = 0;\n    dis_value[2]++;\n}\nif (dis_value[2] &gt; 9) {\n    dis_value[0] = 0;\n    dis_value[1] = 0;\n    dis_value[2] = 0;\n    dis_value[3]++;\n}\nif (dis_value[3] &gt; 9) {\n    dis_value[0] = 0;\n    dis_value[1] = 0;\n    dis_value[2] = 0;\n    dis_value[3] = 0;\n}\n</code></pre>\n\n<p>Where from 0 to 3 are display module number.</p>\n\n<p>Is that the best way?</p>\n\n<p>Or maybe is better a single counter of 16bit that is split into 4 different part?</p>\n"}, {"tags": ["c", "programming-languages"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8674229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30d44fe82fcb6b4e4f6f5a1eefed92e?s=128&d=identicon&r=PG&f=1", "display_name": "Venugopal", "link": "https://stackoverflow.com/users/8674229/venugopal"}, "edited": false, "score": 0, "creation_date": 1557937913, "post_id": 56153879, "comment_id": 98937166, "body": "What is the case it doesn&#39;t affect other operands"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1557938480, "post_id": 56153879, "comment_id": 98937438, "body": "There also would be no implicit conversion of <code>y</code> if its type were <code>double</code>, even though that&#39;s not the same as <code>float</code>.  Instead, the result of the explicit conversion of <code>x</code> would be subject to a subsequent implicit conversion to <code>double</code>."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 2, "last_activity_date": 1557937928, "last_edit_date": 1557937928, "creation_date": 1557937806, "answer_id": 56153879, "question_id": 56153737, "link": "https://stackoverflow.com/questions/56153737/implicit-conversion-and-explicit-conversion-in-c/56153879#56153879", "title": "Implicit conversion and explicit conversion in c", "body": "<p>In this particular case it does.</p>\n\n<p>After the cast, you have an <code>int</code> and a <code>float</code> as operands of the <code>/</code> operator.  At that point the <strong>usual arithmetic conversions</strong> apply and the value of <code>y</code> is converted to type float so both operands have a common type.</p>\n\n<p>There would not be an implicit conversion if for example the type of <code>y</code> was float as both operands of <code>/</code> would have the same type.</p>\n"}], "owner": {"reputation": 31, "user_id": 8674229, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b30d44fe82fcb6b4e4f6f5a1eefed92e?s=128&d=identicon&r=PG&f=1", "display_name": "Venugopal", "link": "https://stackoverflow.com/users/8674229/venugopal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1557938794, "creation_date": 1557937264, "last_edit_date": 1557938234, "question_id": 56153737, "link": "https://stackoverflow.com/questions/56153737/implicit-conversion-and-explicit-conversion-in-c", "title": "Implicit conversion and explicit conversion in c", "body": "<p>Doing explicit conversion leads to implicit conversions of operands in an expression in c?</p>\n\n<p>Ex :</p>\n\n<pre><code> int x =10, y=20;\n float C =( float) x/y;\n</code></pre>\n\n<p>Here <code>x</code> is explicitly converted to <code>float</code>. does this conversion leads to implicit conversion of <code>y</code>? </p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1557936177, "post_id": 56153449, "comment_id": 98936368, "body": "The style of coding is often seen in loop control such as <code>while((c = getchar()) != EOF)</code>"}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1557936797, "post_id": 56153449, "comment_id": 98936666, "body": "This code might be part of a <code>strcpy</code> implementation <code>char * strcpy(char *s1, const char *s2) { size_t i; for(i = 0; (s1[i] = s2[i]) != &#39;\\0&#39;; i++); return s1; }</code>"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 6, "last_activity_date": 1557936037, "creation_date": 1557936037, "answer_id": 56153449, "question_id": 56153422, "link": "https://stackoverflow.com/questions/56153422/character-arrays-assignment-and-comparison-in-c/56153449#56153449", "title": "Character arrays assignment and comparison in C", "body": "<p>Considering <code>string</code>s are <code>\\0</code> terminated by the standard.</p>\n\n<pre><code>(s1[i] = s2[i]) != '\\0'\n</code></pre>\n\n<p>it will assign <code>s2[i]</code> to <code>s1[i]</code> then it will compare whether assigned value is <code>\\0</code> or not.</p>\n\n<p>It is usually used to break the loop while copying contents from one string to another.</p>\n"}], "owner": {"reputation": 305, "user_id": 6635922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea58011648a52c156f6852fc945d9a5c?s=128&d=identicon&r=PG&f=1", "display_name": "s_svr", "link": "https://stackoverflow.com/users/6635922/s-svr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 56153449, "answer_count": 1, "score": 0, "last_activity_date": 1557936037, "creation_date": 1557935917, "question_id": 56153422, "link": "https://stackoverflow.com/questions/56153422/character-arrays-assignment-and-comparison-in-c", "title": "Character arrays assignment and comparison in C", "body": "<p>What does this statement mean in C language (assuming s1 and s2 are character arrays)?</p>\n\n<pre><code>(s1[i] = s2[i]) != '\\0'\n</code></pre>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 44000, "user_id": 535275, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Ft2Mw.jpg?s=128&g=1", "display_name": "Scott Hunter", "link": "https://stackoverflow.com/users/535275/scott-hunter"}, "edited": false, "score": 2, "creation_date": 1557935718, "post_id": 56153312, "comment_id": 98936099, "body": "Where did you hear that C interprets <code>char</code> as 1 byte on machines that are word addressable w/ words being 4 bytes long?"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 2, "creation_date": 1557935723, "post_id": 56153312, "comment_id": 98936106, "body": "<code>word-addressable</code> does not mean you don&#39;t have access to individual bytes it is just that in one shot you will get entire word either for read/write."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1557936106, "post_id": 56153312, "comment_id": 98936329, "body": "The other 3-bytes can be use by the compiler for other things (like other chars), they might be unused in a <code>struct</code> depending on what else is in the struct and the struct packing regime.  All this is <i>implementation dependant</i>, not language-dependant.  See also <a href=\"http://www.catb.org/esr/structure-packing/\" rel=\"nofollow noreferrer\">catb.org/esr/structure-packing</a>"}, {"owner": {"reputation": 675, "user_id": 3259789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a55f2fc4903a6c4cc3d4554c7a970d41?s=128&d=identicon&r=PG&f=1", "display_name": "rAndom69", "link": "https://stackoverflow.com/users/3259789/random69"}, "edited": false, "score": 0, "creation_date": 1557936108, "post_id": 56153312, "comment_id": 98936330, "body": "Unsure about current C state, however in current C++ compiler would have to generate extra instructions to read/mask/update/write as with architectures which require aligned memory access. Any real world example of such architecture?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 2, "creation_date": 1557936996, "post_id": 56153312, "comment_id": 98936755, "body": "The C standard does not define a &quot;byte&quot; as 8 bits, it defines a &quot;byte&quot; as the smallest unit of addressable storage. So if the smallest unit of addressable storage is 32 bits wide on your machine, a C &quot;byte&quot; (and therefore the <code>char</code> type) could be 32 bits wide. It&#39;s also possible that the compiler could generate code to make the machine appear to have 8-bit addressable storage."}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1557937693, "creation_date": 1557937693, "answer_id": 56153844, "question_id": 56153312, "link": "https://stackoverflow.com/questions/56153312/about-memory-in-c/56153844#56153844", "title": "About memory in C", "body": "<p>A byte, by definition, is an addressable unit of data storage large enough to hold a character. This is enshrined in the C language standard. You cannot have unadressable bytes in C. So your C compiler should either define byte to be the same as word, or use software-defined addressing to access individual bytes. Both strategies are valid and both exist in the wild. </p>\n"}], "owner": {"reputation": 1, "user_id": 11505233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb358094c56d78939ebedd885e3864c5?s=128&d=identicon&r=PG&f=1", "display_name": "hoodwinker", "link": "https://stackoverflow.com/users/11505233/hoodwinker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1557937693, "creation_date": 1557935541, "question_id": 56153312, "link": "https://stackoverflow.com/questions/56153312/about-memory-in-c", "title": "About memory in C", "body": "<p>If memory is word-addressabe and supose a word is 4 byte. How and why 'C programming language' interpret char as 1 byte, and what happens to other 3 bytes?</p>\n"}, {"tags": ["c", "file", "struct", "scanf"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557933780, "post_id": 56152703, "comment_id": 98934970, "body": "When you use <code>scanf</code> to read the name, you successfully read a &quot;word&quot; that includes spaces. Think about that for your <code>fscanf</code> call."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557933814, "post_id": 56152703, "comment_id": 98934994, "body": "Also, the canonical way to do something like this is to loop while <code>fgets</code> return a non-null pointer, and then use <code>sscanf</code> for the parsing."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557934902, "post_id": 56152703, "comment_id": 98935630, "body": "Do not use <i>feof</i>, check <i>fscanf</i> return value."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 4347038, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658276510/picture?type=large", "display_name": "Peter Roman", "link": "https://stackoverflow.com/users/4347038/peter-roman"}, "edited": false, "score": 0, "creation_date": 1557942219, "post_id": 56154789, "comment_id": 98939113, "body": "Thanks (&quot;obrigado&quot;), Bruno."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "reply_to_user": {"reputation": 67, "user_id": 4347038, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658276510/picture?type=large", "display_name": "Peter Roman", "link": "https://stackoverflow.com/users/4347038/peter-roman"}, "edited": false, "score": 0, "creation_date": 1557942684, "post_id": 56154789, "comment_id": 98939351, "body": "if <i>google trans</i> right you said <i>I&#39;m going to post another 1 request for help, this time about dynamic structures With files - for me it&#39;s a bug! - I already take this comment ...!</i> ;-) Sorry I only speak French and English"}], "tags": [], "owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "is_accepted": true, "score": 1, "last_activity_date": 1557941481, "creation_date": 1557941481, "answer_id": 56154789, "question_id": 56152703, "link": "https://stackoverflow.com/questions/56152703/read-data-to-text-file-and-reserve-de-output-with-n-character/56154789#56154789", "title": "Read data to Text File and reserve de output with N character", "body": "<p>As you say in your question you cannot use <em>scanf</em> to read a complex name including spaces.</p>\n\n<p>But before to search <em>how</em> to do it is needed to decide <em>what</em> to do.</p>\n\n<p>Probably you do not want to memorize the extra spaces at the beginning and at the end (including the newline), and probably a name must not be empty.</p>\n\n<p>But what about inside a complex name ? If the user enter <code>John  Lays</code> do you save the name with the two spaces or you want to simplify to have only one ? Do you have to manage other special character like '-' (are <code>John - Lays</code> / <code>John- Lays</code> / <code>John -Lays</code> read as <code>John-Lays</code> ?).</p>\n\n<p>What to do if the input string is longer than 10 characters ? Just to stop to read letting the rest for the next read or to bypass up to a newline ? Because you print a message before each input you clearly want an input per line and the rest of the line must be bypassed.</p>\n\n<p>If you do not want to read the string as it is enter the best way is probably to write your own read string function.</p>\n\n<p>You also have to decide what to do if the user do not enter a number for <em>ID</em> or <em>Potencia</em> or <em>Avariado</em>, currently you do not even detect the error, this is not a good way. So in that case do you abort all (exit program), or you redo the read ? Probably you prefer to read again, for that you need to bypass the invalid input, but what that means, to bypass all up to a newline ?</p>\n\n<p>For instance :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n/* read an int memorizing its value in v,\n   return 0 in case of EOF else a non null value */\nint readInt(const char * msg, int * v)\n{\n  for (;;) {\n    fputs(msg, stdout);\n    if (scanf(\"%d\", v) == 1)\n      return 1;\n\n    /* not a number or EOF, bypass all up to \\n */\n    int c;\n\n    while ((c = fgetc(stdin)) != '\\n')\n      if (c == EOF)\n        return 0;\n\n    puts(\"invalid value\"); /* message may be also get in argument */\n  }\n}\n\n/* read a string up to a \\n\n   remove extra spaces at the beginning and end\n   simplify internal multiple spaces\n   accept any character and do not manage in a special way characters like like '-'\n   a non empty string must be read\n   read at most sz-1 characters in s then place the null character (as fgets), sz must be &gt; 1\n   if the line too long bypass the rest of the input up to \\n\n   return 0 in case of EOF else a non null value */\nint readStr(const char * msg, char * s, size_t sz)\n{\n  fputs(msg, stdout);\n\n  /* read the first char bypassing spaces including \\n */\n  if (scanf(\" %c\", s) == 0)\n    // EOF\n    return 0;\n\n  size_t index = 1;\n  int c;\n\n  sz -= 1;\n\n  while (index != sz) {\n    c = fgetc(stdin);\n\n    if ((c == EOF) || (c == '\\n'))\n      break;\n\n    if (!isspace(c))\n      s[index++] = c;\n    else if (s[index - 1] != ' ')\n      s[index++] = ' ';\n  }\n\n  s[(s[index - 1] != ' ') ? index : index-1] = 0;\n\n  // bypass possible rest of the line\n  while ((c != EOF) &amp;&amp; (c != '\\n'))\n    c = fgetc(stdin);\n\n  return 1;\n}\n\n/* ******************* */\n\nstruct estruturaCarro {\n  int id, potencia, avariado;\n  char name[11]; \n} carro;\n\nint main()\n{\n  do {\n    if (!readInt(\"\\n ID......:\", &amp;carro.id) ||\n        !readInt(\"\\n Potencia:\", &amp;carro.potencia) ||\n        !readInt(\"\\n Avariado:\", &amp;carro.avariado) ||\n        !readStr(\"\\n NAME:\", carro.name, sizeof(carro.name))) {\n      puts(\"EOF\");\n      return -1;\n    }\n    else\n      printf(\"%-2d %-3d %-1d '%-10s' \\n\\n\", carro.id, carro.potencia, carro.avariado, carro.name);\n  } while (strcmp(carro.name, \"end\"));\n\n  return 0;\n}\n</code></pre>\n\n<p>Compilation and execution:</p>\n\n<pre><code>pi@raspberrypi:/tmp $ gcc -pedantic -Wextra -Wall r.c\npi@raspberrypi:/tmp $ ./a.out\n\n ID......:aze\ninvalid value\n\n ID......:qsd\ninvalid value\n\n ID......:1\n\n Potencia:2\n\n Avariado:3\n\n NAME:aze            u iiiiiiiiiiiiiiiiii\n1  2   3 'aze u iiii' \n\n\n ID......:11\n\n Potencia:22\n\n Avariado:0\n\n NAME:    end\n11 22  0 'end       ' \n\npi@raspberrypi:/tmp $ \n</code></pre>\n\n<p>When you read in your file and supposing it was produced doing <code>fprintf(fp, \"%-2d %-3d %-1d %-10s\", ...)</code> :</p>\n\n<pre><code>  char line[21]; /* each line has 20 characters newline included */\n\n  while (fgets(line, sizeof(line), fp) != NULL) {\n    if (sscanf(line, \"%d %d %d\", &amp;carro.id, &amp;carro.potencia, &amp;carro.avariado) != 3)\n      /* abnormal case, invalid file */\n      break; /* anything else you want to do */\n    /* the string starts at the index 9 and has 10 characters out of the newline */\n    memcpy(carro.name, line + 9, 10);\n    carro.name[10] = 0;\n    /* ... */\n  }\n</code></pre>\n\n<p>note the name have spaces at the end if its length is less than 10 characters</p>\n\n<p>Or you can read in a way similar to the previous on stdin.</p>\n"}], "owner": {"reputation": 67, "user_id": 4347038, "user_type": "registered", "profile_image": "https://graph.facebook.com/1658276510/picture?type=large", "display_name": "Peter Roman", "link": "https://stackoverflow.com/users/4347038/peter-roman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56154789, "answer_count": 1, "score": 0, "last_activity_date": 1557941481, "creation_date": 1557933408, "question_id": 56152703, "link": "https://stackoverflow.com/questions/56152703/read-data-to-text-file-and-reserve-de-output-with-n-character", "title": "Read data to Text File and reserve de output with N character", "body": "<p>I want read data from console and output to Text file with reserve of N character per variable of structure type.<br>\nThe Text file is similar to:</p>\n\n<pre>\n1  111 1 Peter\n22 22  2 John Lays\n3  3   3 Anne Belgs\n</pre>\n\n<p>I do not know if I'm using the most correct functions.<br>\nAlso I can not read (\"carro.name\") more than 1 word (example: John Lays)</p>\n\n<pre><code>struct estruturaCarro {\n    int id, potencia, avariado;\n    char name[11]; \n} carro;\n...    \n//Read data to Text File:\n...\nprintf(\"\\n ID......:\"); scanf(\"%d\", &amp;carro.id);\nprintf(\"\\n Potencia:\"); scanf(\"%d\", &amp;carro.potencia);\nprintf(\"\\n Avariado:\"); scanf(\"%d\", &amp;carro.avariado);\nprintf(\"\\n NAME:\"); scanf(\"%10[0-9a-zA-Z ]\", carro.name);  // or scanf(\"%[^\\n]s\",...)\n\nfprintf(fp, \"%-2d %-3d %-1d %-10s \\n\\n\", carro.id, carro.potencia, carro.avariado, carro.name);\n...\n//Show File Text data:\n...\nint registos=0;\nwhile(1)\n{\n    fscanf(fp, \"%d %d %d %-10s\", &amp;carro.id, &amp;carro.potencia, &amp;carro.avariado, carro.name);\n    if(feof(fp)){ break; }    \n    printf(\"%-2d %-3d %-1d %-10s\\n\", carro.id, carro.potencia, carro.avariado, carro.name);\n    registos++;\n}\n\nprintf(\"\\nCarros=%d\", registos);\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 2, "creation_date": 1557932603, "post_id": 56152316, "comment_id": 98934245, "body": "Casts may sometimes violate strict aliasing. <code>memcpy</code> is the foolproof way of doing it. In any case, I&#39;m not sure I completely understand what problem you&#39;re trying to solve."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 2, "creation_date": 1557932612, "post_id": 56152316, "comment_id": 98934251, "body": "How do you get the value for <code>storage_somewhere</code>? If you supply an address that is not sufficiently aligned for your data type you might get an alignment trap when you use pointer casts, e.g. if you supply an odd address to access a 16bit or 32bit value. In this case you might have to use <code>memcpy</code>."}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 2, "creation_date": 1557932800, "post_id": 56152316, "comment_id": 98934362, "body": "The more you can avoid <code>void*</code> and cast the better it is, let the compiler helps you producing warnings/errors when your code is wrong (supposing types known). Note <i>unions</i> allow to manages several possible types of data, and to add an associated discriminant is a good way to do (so having typically a <i>struct</i> memorizing the <i>union</i> and the discriminant)."}, {"owner": {"reputation": 269, "user_id": 3867694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e5f817ce3cf98e4e71942a92fada55b?s=128&d=identicon&r=PG&f=1", "display_name": "aberg", "link": "https://stackoverflow.com/users/3867694/aberg"}, "edited": false, "score": 0, "creation_date": 1557932985, "post_id": 56152316, "comment_id": 98934485, "body": "Ah, well, storage_somewhere is guaranteed to offer 4 bytes, although sometimes only one is used."}, {"owner": {"reputation": 269, "user_id": 3867694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e5f817ce3cf98e4e71942a92fada55b?s=128&d=identicon&r=PG&f=1", "display_name": "aberg", "link": "https://stackoverflow.com/users/3867694/aberg"}, "reply_to_user": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557933086, "post_id": 56152316, "comment_id": 98934549, "body": "@bruno Forgot to mention that type-punning via union is not allowed"}, {"owner": {"reputation": 269, "user_id": 3867694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e5f817ce3cf98e4e71942a92fada55b?s=128&d=identicon&r=PG&f=1", "display_name": "aberg", "link": "https://stackoverflow.com/users/3867694/aberg"}, "edited": false, "score": 0, "creation_date": 1557933173, "post_id": 56152316, "comment_id": 98934608, "body": "The question related to the internals of the \u201dstorage framework\u201d. The exposed functions will only accept specific types (u08/s16/f32 etc)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1557935085, "post_id": 56152316, "comment_id": 98935749, "body": "@aberg As long as you follow the rules for a union then there is no type punning."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1557937480, "last_edit_date": 1557937480, "creation_date": 1557934921, "answer_id": 56153153, "question_id": 56152316, "link": "https://stackoverflow.com/questions/56152316/generic-storage-of-primitive-data-types/56153153#56153153", "title": "Generic storage of primitive data types", "body": "<blockquote>\n  <p>Is this standard practice in C? Is it assumed that I should memcpy\n  into an U32 when storing other data-types?</p>\n</blockquote>\n\n<p>It depends on what you mean by \"this\".  Converting object pointers back and forth between type <code>void *</code> and other object pointer types is relatively common, and it serves reasonable purposes (and sometimes unreasonable ones).  On the other hand, it is not typical at all to maintain a flat pool of memory into- and out of which you write and read values of varying type.</p>\n\n<p>But if you want something that serves as a flat pool of primitives, then a union of arrays would probably be a better choice:</p>\n\n<pre><code>#define WORD_COUNT 1024\n\nunion {\n    int8_t   as_schars[WORD_COUNT * 4];\n    uint8_t  as_uchars[WORD_COUNT * 4];\n    int16_t  as_sshorts[WORD_COUNT * 2];\n    uint16_t as_ushorts[WORD_COUNT * 2];\n    int32_t  as_sints[WORD_COUNT];\n    uint32_t as_uints[WORD_COUNT];\n    float    as_floats[WORD_COUNT];  // assumes 32-bit floats\n} primitives;\n</code></pre>\n\n<p>You may then access elements directly, without function calls, via expressions such as</p>\n\n<pre><code>uint8_t a_byte = primitives.as_uchars[42];\nint16_t a_short = primitives.as_sshorts[222];\nfloat f = primitives.as_floats[665];\n\nprimitives.as_uints[1] = 12;\n</code></pre>\n\n<p>You then also have no risk of undefined behavior arising from casting pointers back and forth and dereferencing the results.</p>\n\n<hr>\n\n<p>Alternatively, if your storage is divided into 32-bit units then you have a couple of other union-based alternatives based around a union for individual units such as this:</p>\n\n<pre><code>union primitive {\n    int8_t   as_schar;\n    uint8_t  as_uchar;\n    int16_t  as_sshort;\n    uint16_t as_ushort;\n    int32_t  as_sint;\n    uint32_t as_uint;\n    float    as_float;  // assumes 32-bit floats\n};\n</code></pre>\n\n<ul>\n<li><p>Provided that you can ensure that such a union has no padding, you can use that as your base type for storage and data exchange:</p>\n\n<pre><code>union primitive prim = /* ... */;\n\nuint8_t a_byte = prim.as_uchar;\nint16_t a_short = prim.as_sshort;\nfloat f = prim.as_float;\n</code></pre></li>\n<li><p>If you cannot assume or ensure that such a union has the correct storage size, then it's probably still better to use it for storing and recovering data than to use <code>memcpy</code>:</p>\n\n<pre><code>int16_t read_s16(uint32_t *storage_somewhere) {\n    return ((union primitive) { .as_uint = *storage_somewhere }).as_sshort;\n}\n\nvoid write_float(uint32_t *storage_somewhere, float data) {\n    *storage_somewhere = ((union primitive) { .as_float = data }).as_uint;\n}\n</code></pre></li>\n</ul>\n\n<p>Those alternatives make it as clear as possible to the compiler what you're doing, and it is more likely to generate optimal code for that than for the <code>memcpy</code> case.</p>\n"}], "owner": {"reputation": 269, "user_id": 3867694, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7e5f817ce3cf98e4e71942a92fada55b?s=128&d=identicon&r=PG&f=1", "display_name": "aberg", "link": "https://stackoverflow.com/users/3867694/aberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1557937480, "creation_date": 1557932202, "question_id": 56152316, "link": "https://stackoverflow.com/questions/56152316/generic-storage-of-primitive-data-types", "title": "Generic storage of primitive data types", "body": "<p>Storage is some chunk of memory:</p>\n\n<pre><code>U08* storage; \n</code></pre>\n\n<p>Current implementation only accepts read/write of U32 data.</p>\n\n<pre><code>U32 read(void* storage_somewhere) {\n    return *(U32*)storage_somewhere;\n}\n\nvoid write(void* storage_somewhere, U32 data_u32) {\n    *(U32*)storage_somewhere = data_u32;\n}\n</code></pre>\n\n<p>Is this standard practice in C?\nIs it assumed that I should memcpy into an U32 when storing other data-types?</p>\n\n<p>Given that I need:</p>\n\n<ul>\n<li><p>Read/write values of 1/2/4 bytes, signed/unsigned/floating</p></li>\n<li><p>Portable code (required to run on some embedded system)</p></li>\n</ul>\n\n<p>My understanding is that implementing something like:</p>\n\n<pre><code>void read(void* storage_somewhere, void* data_ptr, DATA_TYPE data_type)\nvoid write(void* storage_somewhere,void* data_ptr, DATA_TYPE data_type)\n</code></pre>\n\n<p>with specific pointer casts based on data_type:</p>\n\n<pre><code>switch(data_type)\n...\n   case tF32:\n       *(F32*)storage_somewhere = val_f32\n...\n</code></pre>\n\n<p>would lead to undefined behavior.</p>\n\n<p>What is the recommended approach? I assume one should use memcpy instead - but that means i could just use keep the existing functionality.</p>\n"}, {"tags": ["c", "syntax"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557932123, "post_id": 56152242, "comment_id": 98933956, "body": "<code>n % 10</code> isolates the least significant digit <code>4</code> which is added to <code>sum</code>. The number is then divided by 10, which removes that digit leaving <code>1056</code>. The two lines are executed in the sequence you wrote them."}], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "is_accepted": false, "score": 0, "last_activity_date": 1557932454, "creation_date": 1557932454, "answer_id": 56152382, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input/56152382#56152382", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>Altough the compiler can make some optimizations so your code might change, C does work on your code top down.</p>\n\n<p>The thing that happends here in the while loop</p>\n\n<p><code>sum += n % 10;</code> == <code>sum = sum + n % 10;</code>\nfirst of all, <code>%</code> operator is activate, and then the <code>+</code> operator.\nSo, first you get the last significant digit of the number, and then you sum it up to your result and assign it into <code>sum</code>.</p>\n\n<p>the same thing happens in <code>n/= 10;</code>. first you divide the number that saved in <code>n</code> and then you store the result in <code>n</code>.</p>\n\n<p>I hope it answers your question.</p>\n"}, {"tags": [], "owner": {"reputation": 98, "user_id": 11503487, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8eZTZG0oBCo/AAAAAAAAAAI/AAAAAAAAACU/SVtgoSx2Tyo/photo.jpg?sz=128", "display_name": "Luc A", "link": "https://stackoverflow.com/users/11503487/luc-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1557932493, "creation_date": 1557932493, "answer_id": 56152401, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input/56152401#56152401", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>How it works :</p>\n\n<p>While n isn't null, you add the rest of the division n/10.\nIf n = 10564 :\nAt the first iteration, you get 4, the result of 10564%10.\nThen, by dividing 10564 by 10 you get 1056,4. \nBUT n is an integer value, so you get n = 1056</p>\n\n<p>By doing the same operation, you always get the units of n and add it to the sum.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 11075490, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-taNyeYal4Rw/AAAAAAAAAAI/AAAAAAAAAFM/5YWjaBaQ6rU/photo.jpg?sz=128", "display_name": "Sovak", "link": "https://stackoverflow.com/users/11075490/sovak"}, "is_accepted": false, "score": 0, "last_activity_date": 1557932777, "creation_date": 1557932777, "answer_id": 56152486, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input/56152486#56152486", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>Well, the syntax and code seems correct. The syntax 'sum +=  n % 10' could also be written as 'sum = sum + n%10'. And 'n/=10' as 'n=n/10'. This will support that c reads everything from top to bottom and from left to right.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 11282203, "user_type": "registered", "profile_image": "https://graph.facebook.com/2628189050543988/picture?type=large", "display_name": "Tony Fools Orbis", "link": "https://stackoverflow.com/users/11282203/tony-fools-orbis"}, "edited": false, "score": 0, "creation_date": 1558005020, "post_id": 56152533, "comment_id": 98960945, "body": "thank you, i understand its method to add the sum now. i am not familiar with &quot;while&quot; loops."}], "tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 1, "last_activity_date": 1557991474, "last_edit_date": 1557991474, "creation_date": 1557932927, "answer_id": 56152533, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input/56152533#56152533", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>The sum is not \"both <code>% 10</code> and <code>/10</code> syntactically\".  </p>\n\n<p><code>n % 10</code> is the least significant (rightmost) digit of <code>n</code>.<br>\nThis is what gets added to <code>sum</code>.  </p>\n\n<p>Then <code>n /= 10</code> (<code>n = n / 10</code>) \"chops off\" that digit from <code>n</code>, and the process repeats.</p>\n\n<p>You can work through it by hand:</p>\n\n<p>Set <code>n = 12345</code> and <code>sum = 0</code>.</p>\n\n<p><code>12345</code> is not zero, so enter the loop:</p>\n\n<p><code>12345 % 10</code> is <code>5</code>, so <code>sum += 5</code>, which makes <code>5</code>.<br>\n<code>12345 / 10</code> is <code>1234</code> , so <code>n = 1234</code>.</p>\n\n<p>Now, <code>n</code> is <code>1234</code>, which is not zero.  </p>\n\n<p><code>1234 % 10</code> is <code>4</code>, so <code>sum += 4</code>, which makes <code>9</code>.<br>\n<code>1234 / 10</code> is <code>123</code>, so <code>n = 123</code>.</p>\n\n<p><code>123</code> is not zero...</p>\n\n<p>And so on, until <code>n</code> becomes zero, which will happen after there is only one digit left.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 0, "last_activity_date": 1557934981, "last_edit_date": 1557934981, "creation_date": 1557934395, "answer_id": 56153008, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input/56153008#56153008", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>the following description of what is happening in you code should help you to understand</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n// note, it is poor programming practice\n//       to include header files those contents are not used\n//#include &lt;string.h&gt;\n//#include &lt;math.h&gt;\n//#include &lt;stdlib.h&gt;\n\nint main() \n{\n    // assume input is 54321\n    int n;\n    scanf(\"%d\", &amp;n);\n    int sum = 0;\n\n    while(n)\n    {\n        // values at each loop\n        sum += n % 10;     // remember n%10 means the remainder of n/10\n            // n%10 =1 sum = 1 \n            // n%10 =2 sum = 3\n            // n%10 =3 sum = 6\n            // n%10 =4 sum = 10\n            // n%10 =5 sum = 15\n        n/= 10;  // shorthand for: n = n/10\n            //n = 5432\n            //n = 543\n            //n = 54\n            //n = 5\n            //n = 0\n    }\n\n    printf(\"%d\\n\", sum);\n    //Complete the code to calculate the sum of the five digits on n.\n    return 0;\n}\n</code></pre>\n\n<p>the output is:</p>\n\n<pre><code>15\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11282203, "user_type": "registered", "profile_image": "https://graph.facebook.com/2628189050543988/picture?type=large", "display_name": "Tony Fools Orbis", "link": "https://stackoverflow.com/users/11282203/tony-fools-orbis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56152533, "answer_count": 5, "score": 0, "last_activity_date": 1557991474, "creation_date": 1557931951, "question_id": 56152242, "link": "https://stackoverflow.com/questions/56152242/i-dont-quite-understand-the-syntax-where-it-adds-the-sum-of-5-digits-input", "title": "i don&#39;t quite understand the syntax where it adds the sum of 5 digits input", "body": "<p>i have been reading the discussion codes and don't understand the syntax in which the sum of 5 digits is outputted. i thought C reads everything top down, left right so how is sum both % 10 and /10 syntactically? </p>\n\n<p>this is a challenge from hackerrank, input 5 digits and output sum of 5 digits. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main() {\n\nint n;\nscanf(\"%d\", &amp;n);\nint sum = 0;\n\nwhile(n)\n{\n    sum += n % 10;\n    n/= 10;\n}\n\nprintf(\"%d\\n\", sum);\n//Complete the code to calculate the sum of the five digits on n.\nreturn 0;\n}\n</code></pre>\n\n<p>sample input 10564\nsampe output 16</p>\n"}, {"tags": ["c", "data-structures"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1557932156, "post_id": 56152192, "comment_id": 98933979, "body": "Where is your code that stores the data?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557932402, "post_id": 56152192, "comment_id": 98934128, "body": "The 2nd argument to <code>hash_table_lookup()</code> is supposed to be a <code>HashTableKey</code> but you&#39;re passing an <code>int*</code> pointer. What is the declaration of <code>HashTableKey</code>?"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1557932674, "post_id": 56152192, "comment_id": 98934285, "body": "@Barmar assuming it&#39;s from <a href=\"https://github.com/fragglet/c-algorithms/blob/master/src/hash-table.h\" rel=\"nofollow noreferrer\">here</a> then <code>HashTableKey</code> is a typedef alias of <code>void *</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1557932840, "post_id": 56152192, "comment_id": 98934394, "body": "The hash table apparently stores pointers to the keys and values, rather than copying the data. So if you use pointers to local data as keys or values, you&#39;ll run into problems."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1557933318, "post_id": 56152192, "comment_id": 98934688, "body": "As @Barmer says, the pointer value is used as the key, not the <code>int</code>. If you want to use numeric keys, you can store a number in a <code>void *</code> by casting (and convert the <code>void *</code> back to a number by casting) as long as the pointer value is wide enough to hold the integer value."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557935149, "post_id": 56152192, "comment_id": 98935785, "body": "please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you to debug it"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1557938451, "post_id": 56152192, "comment_id": 98937420, "body": "Regarding my earlier comment about storing an integer value in a <code>void *</code> (or in <code>HashTableKey</code>, there is no guarantee that it converting it back the other way will produce a matching integer value as both conversions are implementation-defined. However, a lot of code does use this trick even though it is not strictly portable."}], "owner": {"reputation": 15, "user_id": 8916251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d596b149e0defed84c005e02c3389819?s=128&d=identicon&r=PG&f=1", "display_name": "Marc G.G", "link": "https://stackoverflow.com/users/8916251/marc-g-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557931766, "creation_date": 1557931766, "question_id": 56152192, "link": "https://stackoverflow.com/questions/56152192/hash-table-lookup-null-pointer", "title": "Hash Table lookup null pointer", "body": "<p>I have a Hash Table with 2 key-value pairs. And when I recover a value with a key, that I'm sure I have stored, I get a null pointer. I have no clue what could be wrong here.</p>\n\n<p>This is the part of the code where it fails\nmapMatrices is of type:\nHashTable* mapMatrices</p>\n\n<pre><code>    printf(\"idA idB %i %i\\n\", idA, idB);\n    //printf(\"[Server %s] Recuperando matrices de id %i %i\\n\", hostname, idA, idB);\n\n    int key_test = 0;\n    iterarKeys();\n    printf(\"%p\\n\", hash_table_lookup(mapMatrices, &amp;key_test));\n    hValue = hash_table_lookup(mapMatrices, &amp;idA);\n    entradaA = (InfoMatrix *)hValue;\n    printf(\"%p\\n\", hValue);\n    printf(\"%p\\n\", entradaA);\n    printf(\"Lookup\\n\");\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>idA idB 0 1\nkey 0\nkey 1\n\n(nil)\n(nil)\n(nil)\nLookup\n</code></pre>\n\n<pre><code>void iterarKeys()\n{\n\n        HashTableIterator iter;\n        hash_table_iterate(mapMatrices, &amp;iter);\n        while (hash_table_iter_has_more(&amp;iter))\n        {\n            HashTablePair pair = hash_table_iter_next(&amp;iter);\n            int *key = (int *)pair.key;\n            printf(\"key %i\\n\", *key);\n        }\n        printf(\"\\n\");\n\n    return;\n}\n</code></pre>\n\n<p>I'm using this implementation of Hash-Table</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>/*\n\nCopyright (c) 2005-2008, Simon Howard\n\nPermission to use, copy, modify, and/or distribute this software\nfor any purpose with or without fee is hereby granted, provided\nthat the above copyright notice and this permission notice appear\nin all copies.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\nWARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\nWARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\nAUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\nCONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\nNEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\nCONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n\n */\n\n/* Hash table implementation */\n\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#include \"hash-table.h\"\n\n/* malloc() / free() testing */\n\n#ifdef ALLOC_TESTING\n#include \"alloc-testing.h\"\n#endif\n\nstruct _HashTableEntry {\n        HashTablePair pair;\n        HashTableEntry *next;\n};\n\nstruct _HashTable {\n        HashTableEntry **table;\n        unsigned int table_size;\n        HashTableHashFunc hash_func;\n        HashTableEqualFunc equal_func;\n        HashTableKeyFreeFunc key_free_func;\n        HashTableValueFreeFunc value_free_func;\n        unsigned int entries;\n        unsigned int prime_index;\n};\n\n/* This is a set of good hash table prime numbers, from:\n *   http://planetmath.org/encyclopedia/GoodHashTablePrimes.html\n * Each prime is roughly double the previous value, and as far as\n * possible from the nearest powers of two. */\n\nstatic const unsigned int hash_table_primes[] = {\n        193, 389, 769, 1543, 3079, 6151, 12289, 24593, 49157, 98317,\n        196613, 393241, 786433, 1572869, 3145739, 6291469,\n        12582917, 25165843, 50331653, 100663319, 201326611,\n        402653189, 805306457, 1610612741,\n};\n\nstatic const unsigned int hash_table_num_primes\n        = sizeof(hash_table_primes) / sizeof(int);\n\n/* Internal function used to allocate the table on hash table creation\n * and when enlarging the table */\n\nstatic int hash_table_allocate_table(HashTable *hash_table)\n{\n        unsigned int new_table_size;\n\n        /* Determine the table size based on the current prime index.\n         * An attempt is made here to ensure sensible behavior if the\n         * maximum prime is exceeded, but in practice other things are\n         * likely to break long before that happens. */\n\n        if (hash_table-&gt;prime_index &lt; hash_table_num_primes) {\n                new_table_size = hash_table_primes[hash_table-&gt;prime_index];\n        } else {\n                new_table_size = hash_table-&gt;entries * 10;\n        }\n\n        hash_table-&gt;table_size = new_table_size;\n\n        /* Allocate the table and initialise to NULL for all entries */\n\n        hash_table-&gt;table = calloc(hash_table-&gt;table_size,\n                                   sizeof(HashTableEntry *));\n\n        return hash_table-&gt;table != NULL;\n}\n\n/* Free an entry, calling the free functions if there are any registered */\n\nstatic void hash_table_free_entry(HashTable *hash_table, HashTableEntry *entry)\n{\n        HashTablePair *pair;\n\n        pair = &amp;(entry-&gt;pair);\n\n        /* If there is a function registered for freeing keys, use it to free\n         * the key */\n\n        if (hash_table-&gt;key_free_func != NULL) {\n                hash_table-&gt;key_free_func(pair-&gt;key);\n        }\n\n        /* Likewise with the value */\n\n        if (hash_table-&gt;value_free_func != NULL) {\n                hash_table-&gt;value_free_func(pair-&gt;value);\n        }\n\n        /* Free the data structure */\n\n        free(entry);\n}\n\nHashTable *hash_table_new(HashTableHashFunc hash_func,\n                          HashTableEqualFunc equal_func)\n{\n        HashTable *hash_table;\n\n        /* Allocate a new hash table structure */\n\n        hash_table = (HashTable *) malloc(sizeof(HashTable));\n\n        if (hash_table == NULL) {\n                return NULL;\n        }\n\n        hash_table-&gt;hash_func = hash_func;\n        hash_table-&gt;equal_func = equal_func;\n        hash_table-&gt;key_free_func = NULL;\n        hash_table-&gt;value_free_func = NULL;\n        hash_table-&gt;entries = 0;\n        hash_table-&gt;prime_index = 0;\n\n        /* Allocate the table */\n\n        if (!hash_table_allocate_table(hash_table)) {\n                free(hash_table);\n\n                return NULL;\n        }\n\n        return hash_table;\n}\n\nvoid hash_table_free(HashTable *hash_table)\n{\n        HashTableEntry *rover;\n        HashTableEntry *next;\n        unsigned int i;\n\n        /* Free all entries in all chains */\n\n        for (i=0; i&lt;hash_table-&gt;table_size; ++i) {\n                rover = hash_table-&gt;table[i];\n                while (rover != NULL) {\n                        next = rover-&gt;next;\n                        hash_table_free_entry(hash_table, rover);\n                        rover = next;\n                }\n        }\n\n        /* Free the table */\n\n        free(hash_table-&gt;table);\n\n        /* Free the hash table structure */\n\n        free(hash_table);\n}\n\nvoid hash_table_register_free_functions(HashTable *hash_table,\n                                        HashTableKeyFreeFunc key_free_func,\n                                        HashTableValueFreeFunc value_free_func)\n{\n        hash_table-&gt;key_free_func = key_free_func;\n        hash_table-&gt;value_free_func = value_free_func;\n}\n\n\nstatic int hash_table_enlarge(HashTable *hash_table)\n{\n        HashTableEntry **old_table;\n        unsigned int old_table_size;\n        unsigned int old_prime_index;\n        HashTableEntry *rover;\n        HashTablePair *pair;\n        HashTableEntry *next;\n        unsigned int index;\n        unsigned int i;\n\n        /* Store a copy of the old table */\n\n        old_table = hash_table-&gt;table;\n        old_table_size = hash_table-&gt;table_size;\n        old_prime_index = hash_table-&gt;prime_index;\n\n        /* Allocate a new, larger table */\n\n        ++hash_table-&gt;prime_index;\n\n        if (!hash_table_allocate_table(hash_table)) {\n\n                /* Failed to allocate the new table */\n\n                hash_table-&gt;table = old_table;\n                hash_table-&gt;table_size = old_table_size;\n                hash_table-&gt;prime_index = old_prime_index;\n\n                return 0;\n        }\n\n        /* Link all entries from all chains into the new table */\n\n        for (i=0; i&lt;old_table_size; ++i) {\n                rover = old_table[i];\n\n                while (rover != NULL) {\n                        next = rover-&gt;next;\n\n                        /* Fetch rover HashTablePair */\n\n                        pair = &amp;(rover-&gt;pair);\n\n                        /* Find the index into the new table */\n\n                        index = hash_table-&gt;hash_func(pair-&gt;key) % hash_table-&gt;table_size;\n\n                        /* Link this entry into the chain */\n\n                        rover-&gt;next = hash_table-&gt;table[index];\n                        hash_table-&gt;table[index] = rover;\n\n                        /* Advance to next in the chain */\n\n                        rover = next;\n                }\n        }\n\n        /* Free the old table */\n\n        free(old_table);\n\n        return 1;\n}\n\nint hash_table_insert(HashTable *hash_table, HashTableKey key,\n                      HashTableValue value)\n{\n        HashTableEntry *rover;\n        HashTablePair *pair;\n        HashTableEntry *newentry;\n        unsigned int index;\n\n        /* If there are too many items in the table with respect to the table\n         * size, the number of hash collisions increases and performance\n         * decreases. Enlarge the table size to prevent this happening */\n\n        if ((hash_table-&gt;entries * 3) / hash_table-&gt;table_size &gt; 0) {\n\n                /* Table is more than 1/3 full */\n\n                if (!hash_table_enlarge(hash_table)) {\n\n                        /* Failed to enlarge the table */\n\n                        return 0;\n                }\n        }\n\n        /* Generate the hash of the key and hence the index into the table */\n\n        index = hash_table-&gt;hash_func(key) % hash_table-&gt;table_size;\n\n        /* Traverse the chain at this location and look for an existing\n         * entry with the same key */\n\n        rover = hash_table-&gt;table[index];\n\n        while (rover != NULL) {\n\n                /* Fetch rover's HashTablePair entry */\n\n                pair = &amp;(rover-&gt;pair);\n\n                if (hash_table-&gt;equal_func(pair-&gt;key, key) != 0) {\n\n                        /* Same key: overwrite this entry with new data */\n\n                        /* If there is a value free function, free the old data\n                         * before adding in the new data */\n\n                        if (hash_table-&gt;value_free_func != NULL) {\n                                hash_table-&gt;value_free_func(pair-&gt;value);\n                        }\n\n                        /* Same with the key: use the new key value and free\n                         * the old one */\n\n                        if (hash_table-&gt;key_free_func != NULL) {\n                                hash_table-&gt;key_free_func(pair-&gt;key);\n                        }\n\n                        pair-&gt;key = key;\n                        pair-&gt;value = value;\n\n                        /* Finished */\n\n                        return 1;\n                }\n\n                rover = rover-&gt;next;\n        }\n\n        /* Not in the hash table yet.  Create a new entry */\n\n        newentry = (HashTableEntry *) malloc(sizeof(HashTableEntry));\n\n        if (newentry == NULL) {\n                return 0;\n        }\n\n        newentry-&gt;pair.key = key;\n        newentry-&gt;pair.value = value;\n\n        /* Link into the list */\n\n        newentry-&gt;next = hash_table-&gt;table[index];\n        hash_table-&gt;table[index] = newentry;\n\n        /* Maintain the count of the number of entries */\n\n        ++hash_table-&gt;entries;\n\n        /* Added successfully */\n\n        return 1;\n}\n\nHashTableValue hash_table_lookup(HashTable *hash_table, HashTableKey key)\n{\n        HashTableEntry *rover;\n        HashTablePair *pair;\n        unsigned int index;\n\n        /* Generate the hash of the key and hence the index into the table */\n\n        index = hash_table-&gt;hash_func(key) % hash_table-&gt;table_size;\n\n        /* Walk the chain at this index until the corresponding entry is\n         * found */\n\n        rover = hash_table-&gt;table[index];\n\n        while (rover != NULL) {\n                pair = &amp;(rover-&gt;pair);\n\n                if (hash_table-&gt;equal_func(key, pair-&gt;key) != 0) {\n\n                        /* Found the entry.  Return the data. */\n\n                        return pair-&gt;value;\n                }\n\n                rover = rover-&gt;next;\n        }\n\n        /* Not found */\n\n        return HASH_TABLE_NULL;\n}\n\nint hash_table_remove(HashTable *hash_table, HashTableKey key)\n{\n        HashTableEntry **rover;\n        HashTableEntry *entry;\n        HashTablePair *pair;\n        unsigned int index;\n        int result;\n\n        /* Generate the hash of the key and hence the index into the table */\n\n        index = hash_table-&gt;hash_func(key) % hash_table-&gt;table_size;\n\n        /* Rover points at the pointer which points at the current entry\n         * in the chain being inspected.  ie. the entry in the table, or\n         * the \"next\" pointer of the previous entry in the chain.  This\n         * allows us to unlink the entry when we find it. */\n\n        result = 0;\n        rover = &amp;hash_table-&gt;table[index];\n\n        while (*rover != NULL) {\n\n                pair = &amp;((*rover)-&gt;pair);\n\n                if (hash_table-&gt;equal_func(key, pair-&gt;key) != 0) {\n\n                        /* This is the entry to remove */\n\n                        entry = *rover;\n\n                        /* Unlink from the list */\n\n                        *rover = entry-&gt;next;\n\n                        /* Destroy the entry structure */\n\n                        hash_table_free_entry(hash_table, entry);\n\n                        /* Track count of entries */\n\n                        --hash_table-&gt;entries;\n\n                        result = 1;\n\n                        break;\n                }\n\n                /* Advance to the next entry */\n\n                rover = &amp;((*rover)-&gt;next);\n        }\n\n        return result;\n}\n\nunsigned int hash_table_num_entries(HashTable *hash_table)\n{\n        return hash_table-&gt;entries;\n}\n\nvoid hash_table_iterate(HashTable *hash_table, HashTableIterator *iterator)\n{\n        unsigned int chain;\n\n        iterator-&gt;hash_table = hash_table;\n\n        /* Default value of next if no entries are found. */\n\n        iterator-&gt;next_entry = NULL;\n\n        /* Find the first entry */\n\n        for (chain=0; chain&lt;hash_table-&gt;table_size; ++chain) {\n\n                if (hash_table-&gt;table[chain] != NULL) {\n                        iterator-&gt;next_entry = hash_table-&gt;table[chain];\n                        iterator-&gt;next_chain = chain;\n                        break;\n                }\n        }\n}\n\nint hash_table_iter_has_more(HashTableIterator *iterator)\n{\n        return iterator-&gt;next_entry != NULL;\n}\n\nHashTablePair hash_table_iter_next(HashTableIterator *iterator)\n{\n        HashTableEntry *current_entry;\n        HashTable *hash_table;\n        HashTablePair pair = {NULL, NULL};\n        unsigned int chain;\n\n        hash_table = iterator-&gt;hash_table;\n\n        if (iterator-&gt;next_entry == NULL) {\n                return pair;\n        }\n\n        /* Result is immediately available */\n\n        current_entry = iterator-&gt;next_entry;\n        pair = current_entry-&gt;pair;\n\n        /* Find the next entry */\n\n        if (current_entry-&gt;next != NULL) {\n\n                /* Next entry in current chain */\n\n                iterator-&gt;next_entry = current_entry-&gt;next;\n\n        } else {\n\n                /* None left in this chain, so advance to the next chain */\n\n                chain = iterator-&gt;next_chain + 1;\n\n                /* Default value if no next chain found */\n\n                iterator-&gt;next_entry = NULL;\n\n                while (chain &lt; hash_table-&gt;table_size) {\n\n                        /* Is there anything in this chain? */\n\n                        if (hash_table-&gt;table[chain] != NULL) {\n                                iterator-&gt;next_entry = hash_table-&gt;table[chain];\n                                break;\n                        }\n\n                        /* Try the next chain */\n\n                        ++chain;\n                }\n\n                iterator-&gt;next_chain = chain;\n        }\n\n        return pair;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "casting", "signed", "unsigned-char"], "comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 2, "creation_date": 1557930916, "post_id": 56151841, "comment_id": 98933152, "body": "Note that <code>char</code> may be <code>signed</code> or <code>unsigned</code> (up to your implementation) and in both case <code>char</code> is a distinct type from both <code>signed char</code> and <code>unsigned char</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557931031, "post_id": 56151841, "comment_id": 98933222, "body": "Generally you should treat any C-style cast as a red flag that you&#39;re doing something wrong."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557931065, "post_id": 56151841, "comment_id": 98933242, "body": "As for your problem, can you please copy-paste the <i>full</i> and *complete error output, including any possible informational notes."}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 4, "creation_date": 1557931150, "post_id": 56151841, "comment_id": 98933303, "body": "Please, provide <a href=\"https://stackoverflow.com/help/reprex\">MCVE</a>. In general, you should have no problem with casting to <code>const char *</code>."}, {"owner": {"reputation": 2354, "user_id": 9428851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MBhDff_bdY0/AAAAAAAAAAI/AAAAAAAACAY/lx7DUTjS350/photo.jpg?sz=128", "display_name": "Victor Gubin", "link": "https://stackoverflow.com/users/9428851/victor-gubin"}, "edited": false, "score": 0, "creation_date": 1557931337, "post_id": 56151841, "comment_id": 98933430, "body": "Why don&#39;t you try to <code>CANMessage(id, reintepret_cast&lt;char*&gt;(&amp;data[0]), len) </code>. In fact there is no binary difference between <code>char</code> and <code>uint8_t</code> data types. Both are 8-bits, so casting is safe if you working with arrays of characters or some RGBA pixmaps. Off cause if you are working with integer values, i.e. you have something like <code>if(a[i] &gt; b[i])</code> you&#39;d better not to cast."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1557931351, "post_id": 56151841, "comment_id": 98933437, "body": "<code>reinterpret_cast&lt;const char*&gt;(dta.data())</code> and <code>static_cast&lt;char&gt;(dta.size())</code> could do it."}, {"owner": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1557931373, "post_id": 56151841, "comment_id": 98933448, "body": "What is <code>uint_8</code>?"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 3108, "user_id": 4641116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gc52U.png?s=128&g=1", "display_name": "Eljay", "link": "https://stackoverflow.com/users/4641116/eljay"}, "edited": false, "score": 0, "creation_date": 1557931523, "post_id": 56151841, "comment_id": 98933551, "body": "@Eljay Good catch. :-) Eskey: Your code does not match the error message."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 1, "creation_date": 1557931980, "post_id": 56151841, "comment_id": 98933867, "body": "I could not reproduce the problem with your example (with missing parts to make it complete): <a href=\"http://coliru.stacked-crooked.com/a/1b54a11a5b0a341f\" rel=\"nofollow noreferrer\">coliru.stacked-crooked.com/a/1b54a11a5b0a341f</a>"}, {"owner": {"reputation": 97, "user_id": 11351033, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nd9yqoe_Cg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRdqRtKvVSDu6uhcXcNU9htaoq-Q/mo/photo.jpg?sz=128", "display_name": "Eskey Eski", "link": "https://stackoverflow.com/users/11351033/eskey-eski"}, "reply_to_user": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "edited": false, "score": 0, "creation_date": 1557933694, "post_id": 56151841, "comment_id": 98934924, "body": "@eerorika I was only able to reproduce it inside a C++98 mbed compiler, I tried my problem in visual studio and it was fine, with no errors, I didn&#39;t mention it as just the small mbed environment can check it using that online compiler. I ended up taking a different approach, my foo function now takes char* and I cast to char* when I call instead (char*)&amp;dta[0]. CANMessage can therefore just use the foo&#39;s char*. I was able to solve my problem, and luckily char* is just a buffer so casting should be harmless, per Michael&#39;s explanation, luckily."}], "answers": [{"comments": [{"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1557933382, "post_id": 56152216, "comment_id": 98934725, "body": "Both C and C++ require that all flavors of <code>char</code> be at least 8 bits. That comes from the definition of <code>CHAR_BIT</code> in <code>&lt;limits.h&gt;</code> which comes into C++ through <code>&lt;climits&gt;</code>."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1557934069, "post_id": 56152216, "comment_id": 98935159, "body": "@PeteBecker I don&#39;t know of any systems where <code>char</code>s have less than 8 bits myself, but there are plenty of other discussions here on SO mentioning both 6 and 7 bit char historical machines. One can probably disregard those Today though :-) ... but even if both <code>uint8_t</code> and <code>char</code> have 8 bits - they are not necessarily bit compatible as  Fran&#231;ois Andrieux points out."}], "tags": [], "owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "is_accepted": false, "score": 1, "last_activity_date": 1557934142, "last_edit_date": 1557934142, "creation_date": 1557931841, "answer_id": 56152216, "question_id": 56151841, "link": "https://stackoverflow.com/questions/56151841/change-uint8-t-to-char/56152216#56152216", "title": "Change uint8_t* to char*?", "body": "<p>Since you are in an environment where <code>std::uint8_t</code> is available, the <code>char</code> types must be max 8 bits, but just to make sure you're not on a machine with 7 bit char's, add a <code>static_assert</code>.</p>\n\n<p><a href=\"https://en.cppreference.com/w/cpp/language/reinterpret_cast\" rel=\"nofollow noreferrer\">reinterpret_cast</a> the <code>uint8_t*</code> to <code>const char*</code> and <a href=\"https://en.cppreference.com/w/cpp/language/static_cast\" rel=\"nofollow noreferrer\">static_cast</a> the size (<code>size_t</code>) of the vector to <code>char</code>.</p>\n\n<pre><code>void foo(unsigned _id, const std::vector&lt;uint8_t&gt;&amp; dta) {\n    static_assert(CHAR_BIT == 8, \"Strange char\");\n\n    CANMessage(\n        _id,\n        reinterpret_cast&lt;const char*&gt;(dta.data()),\n        static_cast&lt;char&gt;(dta.size())\n    );\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1557932386, "post_id": 56152217, "comment_id": 98934122, "body": "&quot;<code>std::uint8_t</code> is equal to <code>unsigned char</code>&quot; Is this required? Could it legally be an extended integer type?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1557932719, "post_id": 56152217, "comment_id": 98934311, "body": "@Fran&#231;oisAndrieux if <code>std::uint8_t</code> exists then <code>unsigned char</code> must be an unsigned 8-bit type. If <code>CHAR_BIT &gt; 8</code> then uint8_t can&#39;t exist"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1557932827, "post_id": 56152217, "comment_id": 98934382, "body": "@phuclv I agree that if <code>std::uint8_t</code> is defined, necessarily <code>unsigned char</code> is a compatible candidate for it. What I&#39;m wondering is if it&#39;s required that <code>std::uint8_t</code> actually be <code>unsigned char</code>. I don&#39;t see why an implementation would do otherwise, even if another <code>unsigned</code> 8 bit integer type is provided. You might as well just define it to be <code>unsigned char</code> but I&#39;m not sure if it <i>has</i> to."}, {"owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "edited": false, "score": 0, "creation_date": 1557932888, "post_id": 56152217, "comment_id": 98934424, "body": "<code>std::uint8_t</code> is a defined type, <code>unsigned char</code> is a built in type. Defined types must somehow be defined with the aid of build in types. If not using <code>unsigned char</code>, what else could be used?"}, {"owner": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 3, "creation_date": 1557932962, "post_id": 56152217, "comment_id": 98934471, "body": "@MichaelChourdakis It could be an <a href=\"https://timsong-cpp.github.io/cppwp/basic.fundamental#def:extended_signed_integer_type\" rel=\"nofollow noreferrer\">extended integer type</a>, they qualify as a fundamental integer type. For example, my compiler might have a <code>__unsigned_byte</code> type or something for reasons I can&#39;t imagine. Edit : There&#39;s also <code>char8_t</code> that has the same size, signedness and alignment as <code>unsigned char</code> since C++20."}, {"owner": {"reputation": 97, "user_id": 11351033, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nd9yqoe_Cg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRdqRtKvVSDu6uhcXcNU9htaoq-Q/mo/photo.jpg?sz=128", "display_name": "Eskey Eski", "link": "https://stackoverflow.com/users/11351033/eskey-eski"}, "edited": false, "score": 0, "creation_date": 1557933298, "post_id": 56152217, "comment_id": 98934680, "body": "@MichaelChourdakis Okay I see. It must be a buffer as I have already successfully used casting to char to send a message using the can protocol. Preferably the API would be unsigned char*, unfortunately this isn&#39;t the case."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 23093, "user_id": 7359094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HxJgU.jpg?s=128&g=1", "display_name": "Fran&#231;ois Andrieux", "link": "https://stackoverflow.com/users/7359094/fran%c3%a7ois-andrieux"}, "edited": false, "score": 0, "creation_date": 1557933324, "post_id": 56152217, "comment_id": 98934695, "body": "@Fran&#231;oisAndrieux Not having 8-bit <code>char</code> types but having fixed-width 8-bit extended <code>int</code> types would be somewhat <i>strange</i>.  But yeah, it seems legal."}], "tags": [], "owner": {"reputation": 8766, "user_id": 451321, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/7Sdao.jpg?s=128&g=1", "display_name": "Michael Chourdakis", "link": "https://stackoverflow.com/users/451321/michael-chourdakis"}, "is_accepted": true, "score": 2, "last_activity_date": 1557932427, "last_edit_date": 1557932427, "creation_date": 1557931841, "answer_id": 56152217, "question_id": 56151841, "link": "https://stackoverflow.com/questions/56151841/change-uint8-t-to-char/56152217#56152217", "title": "Change uint8_t* to char*?", "body": "<p><code>std::uint8_t</code> \u03b9s equal to <code>unsigned char</code>.</p>\n\n<p>This is different from plain char or signed char, but all of them are 8 bit, therefore casting would techically work.</p>\n\n<p>It's common that many functions that would otherwise need a \"buffer\" have a <code>char*</code> in their definition instead of the proper <code>unsigned char*</code>. Therefore, casting would most probably be harmless.</p>\n\n<p>In the case that the function actually wants characters but not a buffer, then you have a problem because the types are different, and whether you will have an issue or not is undefined.</p>\n"}], "owner": {"reputation": 97, "user_id": 11351033, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nd9yqoe_Cg0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRdqRtKvVSDu6uhcXcNU9htaoq-Q/mo/photo.jpg?sz=128", "display_name": "Eskey Eski", "link": "https://stackoverflow.com/users/11351033/eskey-eski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 56152217, "answer_count": 2, "score": 0, "last_activity_date": 1557934142, "creation_date": 1557930704, "last_edit_date": 1557932789, "question_id": 56151841, "link": "https://stackoverflow.com/questions/56151841/change-uint8-t-to-char", "title": "Change uint8_t* to char*?", "body": "<p>I have an API which requests a <code>char*</code>, this is my API function:</p>\n\n<pre><code>CANMessage(unsigned _id,  const char* _data, char _len = 8)\n</code></pre>\n\n<p>More information available here: <a href=\"https://os.mbed.com/docs/mbed-os/v5.11/mbed-os-api-doxy/classmbed_1_1_c_a_n_message.html\" rel=\"nofollow noreferrer\">https://os.mbed.com/docs/mbed-os/v5.11/mbed-os-api-doxy/classmbed_1_1_c_a_n_message.html</a></p>\n\n<p>I would like to call this function from within another function, but I am getting confused about <code>const char*</code> and casting. I want to call this function from function <code>foo()</code>, like so:</p>\n\n<pre><code>void foo(unsigned int id, /*???*/ data, char len) {\n    CANMessage(id, data, len)\n}\n</code></pre>\n\n<p>So I need to pass id, data and len to function foo. My problem is that the <code>data</code> coming in is a <code>uint8_t</code> type. I got a vector of <code>uint8_t</code>, where the address of the first element is the one I need to pass:</p>\n\n<pre><code>vector&lt;uint8_t&gt; dta;\n</code></pre>\n\n<p>Which I tried to pass as <code>&amp;dta[0]</code>: <code>foo(idNo, &amp;dta[0], length)</code></p>\n\n<p>With the foo function as so:</p>\n\n<pre><code>void foo(unsigned int id, uint8_t* data, char len) {\n    CANMessage(id, (char*)data, len)\n}\n</code></pre>\n\n<p>But I get \"Argument of type std::uint8_t * is incompatible with parameter of type char*</p>\n\n<p>How do I pass it as <code>const char*</code> when function <code>foo</code>, which calls it, accepts <code>uint8_t*</code>?</p>\n\n<p>Please note I can't change types, dta has to stay <code>vector&lt;uint8_t&gt;</code>.</p>\n"}, {"tags": ["c", "pipe", "output", "execv"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932143, "post_id": 56151716, "comment_id": 98933971, "body": "IMNSHO, you can&#39;t write a practical shell using <code>execl()</code> or <code>execlp()</code> because the argument lists to the <code>l</code>-exec functions are fixed at compile time and shell commands aren&#39;t.  You practically have to use <code>execv()</code> or one of its variants (<code>execve()</code>, <code>execvp()</code>, sometimes <code>execvpe()</code>) \u2014 the <code>v</code>-exec functions.  You create a null-terminated array of character pointers (rather like <code>argv</code> to <code>main()</code> \u2014 because that&#39;s what it becomes) and pass that to <code>execv()</code>:  given array <code>char **args;</code> appropriately initialized, <code>execv(args[0], args);</code> is the normal way to call <code>execv()</code>."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932327, "post_id": 56151716, "comment_id": 98934088, "body": "Exactly what i was looking for! I want to use execv() but entirely confused in this moment how to. So my code gets its command from the GET portion of the html page which it then parses and tokenizes out into <code>newCommand</code> which is then sent to <code>execution</code> to be run so is effectively in <code>command</code> but from there i cannot for the life of me figure out how to put the string in <code>command</code> into a <code>const * char []</code> to be able to send to <code>execv()</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932465, "post_id": 56151716, "comment_id": 98934156, "body": "Your code is confusing because there are comments, and a wholly unexpected <code>poll()</code> call.  I&#39;m not sure where you&#39;re doing what.  You should concentrate on creating an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) \u2014 or &#39;min-reprex&#39; if the subject on MSO is to be believed; I sincerely hope it isn&#39;t! \u2014 which doesn&#39;t include commented out code."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932584, "post_id": 56151716, "comment_id": 98934234, "body": "will edit it up right now to make it far more readable!"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932671, "post_id": 56151716, "comment_id": 98934283, "body": "You can create a normal <code>char **args = malloc((num_args + 1) * sizeof(args[0]));</code> and then make each element point to a string, the zeroth of which (<code>args[0]</code>) is the command name (or path to the command \u2014 which depends in part on whether you&#39;re using a <code>vp</code>-exec function), and the first is what will become <code>argv[1]</code> in the process, and <code>args[num_args] = NULL;</code>.  The <code>const</code> in the prototype says &quot;<code>execX()</code> will not modify the argument&quot; rather than that you must create something that&#39;s constant."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932753, "post_id": 56151716, "comment_id": 98934327, "body": "Will this method work @JonathanLeffler even if im not using <code>args[]</code> at all to get the command? As in the command given is not in anyway recieved through the command line argument terminal. Also how could i separate out the passed &quot;command&quot;. When i attempt to split it on spaces to place it into an array or anything of the sort it throws warnings"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557932815, "post_id": 56151716, "comment_id": 98934377, "body": "Yes, of course \u2014 you can create the <code>args</code> array any way you like; I carefully avoided using <code>argv</code> to avoid confusion with the argument to the shell&#39;s <code>main()</code>."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933009, "post_id": 56151716, "comment_id": 98934501, "body": "hmmm i dont suppose i could ask you for an example i think i&#39;m beginning to understand, or rather understanding the declaration of the <code>char **args</code> and how to use that but where im stuck is how to get each element to point to an individual part of the string inside the passed <code>char *command</code> as it doesnt appear theres a way to split it."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933138, "post_id": 56151716, "comment_id": 98934581, "body": "One of the bits of an MCVE that&#39;s missing is an example input \u2014 what is the input string that you want to execute?  Would you be better off with invoking <code>sh -c the-input-string</code> \u2014 which could go back to using <code>execlp()</code>, but probably wouldn&#39;t?  With some clarity on what the input looks like, an answer might be forthcoming."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933389, "post_id": 56151716, "comment_id": 98934727, "body": "ahhh okay perhaps i should include my entire code then it was just a lot so i thought that by not including it i would be  following the MCVE better. The example input which can be seen partially from the <code>parse</code> method is taken from the <code>GET</code> of an html string. This code is run with a webserver so i have an <code>html</code> page with a text box, in this text box ill type a command like <code>ls -l</code> and then in the search bar it says <code>localhost:3838&#47;run?command=ls+-l</code> which i then tokenize out the <code>ls -l</code> and put that into <code>newCommand</code> which is then sent to execution as <code>command</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933537, "post_id": 56151716, "comment_id": 98934824, "body": "No; don&#39;t include the entire code.  Make it <b>Minimal</b> \u2014 and <b>Complete</b> enough that it can be compiled/run \u2014 and the fact that it can be run makes it <b>Verifiable</b>.  In particular, you could avoid the &#39;command reading&#39; code; you could just create an array to hold the result, and pass that to the appropriate functions.  We don&#39;t need to see prompting and such like; that&#39;s not part of your problem.  We need <code>main()</code>, <code>parse()</code> and <code>execute()</code> \u2014 and probably that&#39;s all.  But an MCVE is not just code; there is also the input, and the expected result, and the actual result."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933696, "post_id": 56151716, "comment_id": 98934927, "body": "Understood, edited to include my main which should hopefully make this all make a bit more sense"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933707, "post_id": 56151716, "comment_id": 98934931, "body": "Is the code in <code>parse()</code> meant to map <code>%7C</code> to <code>|</code> (or double-blank pipe)?  That&#39;s not very general, is it?  Other things than pipe (and blanks) can be <code>%</code>-escaped (URL encoded) in a URL.  Note that your <code>main()</code> might contain <code>char data[] = &quot;&#47;run?command=\\&quot;ls -l\\&quot;&quot;;</code> \u2014 or would it be <code>char data[] = &quot;&#47;run?command=&amp;quot;ls+-l&amp;quot&quot;;</code> \u2014 or could it use <code>%22</code> instead of <code>&amp;quot</code>, or could it need to handle both?"}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1557933840, "post_id": 56151716, "comment_id": 98935014, "body": "yeah its meant to map <code>%7C</code> to <code>|</code> for piping purposes but i couldnt quite figure out how to convert the <code>%7C</code> to a <code>|</code> for piping, as from a URL <code>|</code> comes back to the terminal as <code>%7C</code> and if i put that in main then wouldnt i techinally be hard coding that variable and not getting it dynamically from the URL to work for other commands other then ls?"}], "answers": [{"comments": [{"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557934307, "post_id": 56152804, "comment_id": 98935299, "body": "Seems to throw a warning of <code>expected char * const * but argument is of type const char **</code> for <code>args</code>"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 1, "creation_date": 1557934880, "post_id": 56152804, "comment_id": 98935619, "body": "So you need to add a <code>const</code> after the <code>*</code>, @BretHasel?  Or remove the <code>const</code> before the <code>char</code>?  There should be a NULL after <code>command</code> in the initializer.  Removing the <code>const</code> works for me; it&#39;s what I&#39;d use automatically."}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557935037, "post_id": 56152804, "comment_id": 98935724, "body": "i ended up fixing it it had to be a <code>char* const args[] = {&quot;&#47;bin&#47;sh&quot;, &quot;-c&quot;, command};</code> but just wanted to let him know there was issues with his answer. Unfortunately didnt seem to help solve my issue though, it provides no output for some reason i dont quite understand and was currently trying to figure out"}, {"owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "edited": false, "score": 0, "creation_date": 1557935329, "post_id": 56152804, "comment_id": 98935889, "body": "Now i just need to figure out how to get piping to work"}], "tags": [], "owner": {"reputation": 1916, "user_id": 49237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6403263459464eabd3fec299f7fca11e?s=128&d=identicon&r=PG", "display_name": "wowest", "link": "https://stackoverflow.com/users/49237/wowest"}, "is_accepted": true, "score": 1, "last_activity_date": 1557933683, "creation_date": 1557933683, "answer_id": 56152804, "question_id": 56151716, "link": "https://stackoverflow.com/questions/56151716/how-change-execlp-to-execv-and-run-other-commands-then-just-ls/56152804#56152804", "title": "How change execlp to execv and run other commands then just &#39;ls&#39;", "body": "<p>If you want the <code>command</code> to be interpreted by a shell you will need to pass it as the an argument, something like: </p>\n\n<pre><code>const char *args[] = {\"/bin/sh\", \"-c\", command};\nexecve(\"/bin/sh\", args, NULL);\n</code></pre>\n\n<p>Beware that web shells are largely considered malware or future CVEs.</p>\n"}], "owner": {"reputation": 293, "user_id": 7177271, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8EkKHDl-kgU/AAAAAAAAAAI/AAAAAAAAABY/x2USaUE1k-o/photo.jpg?sz=128", "display_name": "Bret Hasel", "link": "https://stackoverflow.com/users/7177271/bret-hasel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 56152804, "answer_count": 1, "score": 0, "last_activity_date": 1557933683, "creation_date": 1557930370, "last_edit_date": 1557933660, "question_id": 56151716, "link": "https://stackoverflow.com/questions/56151716/how-change-execlp-to-execv-and-run-other-commands-then-just-ls", "title": "How change execlp to execv and run other commands then just &#39;ls&#39;", "body": "<p>At the moment im running an HTML webserver that can run commands given to it through a text box and a submit button but i need to convert the <code>execlp</code> to <code>execv</code> and im not understanding the array portion of the <code>execv</code>. I tried to just make it <code>execv(command, command);</code> but it gives me a passing argument of incompatible pointer type issue. Also for some reason my execution will only run one word commands like <code>ls</code> and wont accept any flags either and im not quite sure why that is. Execution and parsing section of code below, can provide full code if needed. </p>\n\n<p><strong>Exection.c</strong></p>\n\n<pre><code>char *parse(char *command){\n    char * newCommand = (char *) malloc(sizeof(char)*50);\n    int tgt = 0;\n     newCommand = strstr(command, \"/run?command=\");\n    newCommand = strtok(newCommand, \" \");\n    newCommand = newCommand + 13;\n     for(int src = 0; src&lt; strlen(newCommand); src++){\n        if(newCommand[src] == '+')\n        {\n            newCommand[src] = ' ';\n        }\n        else if(newCommand[src] == '%')\n        {\n            newCommand[src] = ' ';\n        }\n        else if(newCommand[src] == '7')\n        {\n            newCommand[src] = ' ';\n        }\n        else if(newCommand[src] == 'C')\n        {\n            newCommand[src] = '|';\n        }\n\n\n    }\n\n     return newCommand;\n}\n\nchar * execution(char *command){\n\n  int piper[2];\n    size_t len = 0;\n    pipe(piper);\n  char* output =  malloc(1000 * sizeof(char));\n    memset(output, '\\0', 1000* sizeof(char));\n    pid_t pid = fork();\n    if(pid != 0)// parent\n        {\n            wait(NULL);\n            close(piper[1]);\n      int n = sizeof(output);\n\n            struct pollfd * poll_fd = malloc(sizeof(struct pollfd));\n             poll_fd-&gt;fd = piper[0];\n             poll_fd-&gt;events = POLLIN;\n\n            if(poll(poll_fd, 1, 0) == 1){ // pipe data check\n            read(piper[0], output, 1000);\n            }\n\n        }\n        else{\n\n            close(1);\n            dup(piper[1]);\n            execlp(command, command, NULL);\n        exit(1);\n        }\n                return output;\n}\n\nint main (void){\n    int sockfd;\n    int new_fd; \n    struct addrinfo hints;\n    struct addrinfo *serverinfo; \n    struct addrinfo *p;\n    struct sockaddr_storage client_addr;\n    socklen_t addrsize;\n    struct sigaction sa;\n    int yes = 1;\n    char s[INET6_ADDRSTRLEN];\n    int status;\n\n    memset(&amp;hints, 0, sizeof hints); //makes struct empty \n    hints.ai_family = AF_UNSPEC; //IPv4 or v6 \n    hints.ai_socktype = SOCK_STREAM; //TCP type need \n    hints.ai_flags = AI_PASSIVE; //Fill in IP for us \n\n\n    //if can't get address info print error \n    if((status = getaddrinfo(NULL, PORT, &amp;hints, &amp;serverinfo)) != 0){\n        fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(status));\n        return 1;\n    }\n\n\n    for(p = serverinfo; p != NULL; p = p-&gt;ai_next){\n        if((sockfd = socket(p-&gt;ai_family, p-&gt;ai_socktype, p-&gt;ai_protocol)) == -1){\n            perror(\"server: socket\");\n            continue;\n        }\n\n        if(setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &amp;yes, sizeof(int)) == -1){\n            perror(\"setsockopt\");\n            exit(1);\n        }\n\n        if(bind(sockfd, p-&gt;ai_addr, p-&gt;ai_addrlen) == -1){\n            close(sockfd);\n            perror(\"server: bind\");\n            continue;\n        }\n\n        break;\n    }\n\n    freeaddrinfo(serverinfo);\n\n    if(p == NULL){\n        fprintf(stderr, \"server: failed to bind\\n\");\n        exit(1);\n    }\n\n    if(listen(sockfd, BACKLOG) == -1){\n        perror(\"listen\");\n        exit(1);\n    }\n\n    sa.sa_handler = sigchld_handler; // reap all dead processes\n    sigemptyset(&amp;sa.sa_mask);\n    sa.sa_flags = SA_RESTART;\n    if (sigaction(SIGCHLD, &amp;sa, NULL) == -1) {\n        perror(\"sigaction\");\n        exit(1);\n    }\n\n    printf(\"server: waiting for connections....\\n\");\n\n    while(1){\n        addrsize = sizeof client_addr;\n        new_fd = accept(sockfd, (struct sockaddr *)&amp;client_addr, &amp;addrsize);\n        if(new_fd == -1){\n            perror(\"Did not accept\");\n            continue;\n        }\n\n        inet_ntop(client_addr.ss_family, get_in_addr((struct sockaddr *)&amp;client_addr), s, sizeof s);\n        printf(\"server: got connection from %s\\n\", s);\n\n        if(!fork()){\n            close(sockfd);\n            int bufsize = 1024;\n\n            char *buffer = malloc(bufsize);\n            recv(new_fd, buffer, bufsize, 0);\n            send(new_fd, header, bufsize, 0);\n\n            if(send(new_fd, execution(parse(buffer)), 1000, 0) == -1)\n                perror(\"send\");\n            close(new_fd);\n            exit(0);\n        }\n        close(new_fd);\n    }\n\n    return 0;\n\n\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557929973, "post_id": 56151521, "comment_id": 98932501, "body": "What <i>do</i> you get? For debugging, can you print the hexadecimal value of <code>constantVariable</code> and <code>twosVariable </code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1557930298, "post_id": 56151521, "comment_id": 98932719, "body": "The two&#39;s complement of <code>5</code> isn&#39;t <code>0xFFFA</code> but <code>0xFFFB</code>."}, {"owner": {"reputation": 9, "user_id": 11503365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5504cef5f42d0f8c9f82ae1e0efb26?s=128&d=identicon&r=PG&f=1", "display_name": "bb5dgf", "link": "https://stackoverflow.com/users/11503365/bb5dgf"}, "edited": false, "score": 0, "creation_date": 1557930340, "post_id": 56151521, "comment_id": 98932751, "body": "I get -65531 for twosVariable, and 65530 for constantVariable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1557930571, "post_id": 56151521, "comment_id": 98932919, "body": "That&#39;s because your <code>int </code>is 32-bit not 16 bit."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1557930611, "post_id": 56151521, "comment_id": 98932957, "body": "Perhaps you meant <code>-6</code>?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1557930675, "post_id": 56151521, "comment_id": 98932999, "body": "I don&#39;t get <code>-65531</code> and <code>65530</code>, I get <code>-65530</code> and <code>65530</code> with your code. Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. Show the input and the output, and the expected output."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 3, "last_activity_date": 1557933423, "last_edit_date": 1557933423, "creation_date": 1557930879, "answer_id": 56151890, "question_id": 56151521, "link": "https://stackoverflow.com/questions/56151521/attempting-to-convert-a-value-into-2s-complement-in-c/56151890#56151890", "title": "Attempting to convert a value into 2s complement in C", "body": "<p>Indeed 2's complement is such that the complement to your number <code>n</code> (which algebraically is <code>-n</code>) is derived by <em>reflecting</em> the bit pattern of <code>n</code> then adding 1 to that number. Note that in a 2's complement scheme, -1 has all its bits set to 1.</p>\n\n<p>The problem with reflecting the bit pattern using <code>~</code> is that it can cause unwanted type promotion which ruins the result.</p>\n\n<p>One solution is to mask the the result of <code>~</code>, another is to cast the result. Of course, on a 2's complement platform, you can write simply <code>-n</code>, taking care to ensure that <code>n</code> is not already the smallest possible negative.</p>\n"}], "owner": {"reputation": 9, "user_id": 11503365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e5504cef5f42d0f8c9f82ae1e0efb26?s=128&d=identicon&r=PG&f=1", "display_name": "bb5dgf", "link": "https://stackoverflow.com/users/11503365/bb5dgf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557933423, "creation_date": 1557929809, "question_id": 56151521, "link": "https://stackoverflow.com/questions/56151521/attempting-to-convert-a-value-into-2s-complement-in-c", "title": "Attempting to convert a value into 2s complement in C", "body": "<p>I am writing an emulator in C and I want to make the constantValuable , which is 65530 (0xFFFA) be the two's complement variable of 5 however I cannot seem to get it quite right. Below is the example of the if statement where I would like this to be done.</p>\n\n<pre><code>if(opCodeType == 4)\n            {\n                if(registers[rsVariable] == registers[rtVariable])\n                {\n                    int twosVariable = ~(constantVariable) + 1;\n                    printf(\"%d\", twosVariable);\n                    pc = pc + (twosVariable*4);\n                }\n            } \n</code></pre>\n\n<p>I can't seem to understand why this does not work.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557929518, "post_id": 56151392, "comment_id": 98932177, "body": "First of all build a <i>release</i> version of the library, where all debug symbols are stripped. Secondly, if you only distribute the binary library file (and the header file) there&#39;s no source available for the user of the library and all the user can see is the generated assembly code. And it&#39;s impossible to &quot;hide&quot; the assembly code."}, {"owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557929636, "post_id": 56151392, "comment_id": 98932255, "body": "@Someprogrammerdude The problem is not in the assembler code. I tried to use the library in a new project. The call stack shows functions inside the lib and its local variables with their value."}, {"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1557929699, "post_id": 56151392, "comment_id": 98932304, "body": "Sounds like you have compiled with debug set on, which compiler are you using?"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1557929719, "post_id": 56151392, "comment_id": 98932320, "body": "@KrzysztofSzewczyk: The question asks about variable names, which can be omitted from the built library, and internal function names can also be omitted. Your statement \u201cYou can\u2019t protect anything\u201d is false."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1557929857, "post_id": 56151392, "comment_id": 98932416, "body": "You <i>did</i> build (and use) a <i>release</i> version of the library? Without any debug information (like variable or function names)? Perhaps you need to add an extra build-step for the release build to <code>strip</code> such information (depends on the environment and compilers)?"}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557930340, "post_id": 56151392, "comment_id": 98932750, "body": "@EricPostpischil not only - quoting op - &quot;variables, function names, calls&quot;"}, {"owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "edited": false, "score": 0, "creation_date": 1557931025, "post_id": 56151392, "comment_id": 98933219, "body": "It works. Thank you. As mentioned: The solution is to compile a release version of the library."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1557931073, "post_id": 56151392, "comment_id": 98933252, "body": "@KrzysztofSzewczyk: Yes, you could have written that external function names cannot be omitted. But that is not what you wrote. Your statement \u201cYou can\u2019t protect anything\u201d was false."}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1557935497, "post_id": 56151392, "comment_id": 98935981, "body": "Experienced and motivated revengineer will turn the binary to maintainable and readable codebase. You can&#39;t protect the codebase."}, {"owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "reply_to_user": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1557935666, "post_id": 56151392, "comment_id": 98936064, "body": "@KrzysztofSzewczyk When it comes to exchanges between partners, how one part could protect his own source code if it could be reversed ? Is there another solution beside using a static library ?"}, {"owner": {"reputation": 1693, "user_id": 6889435, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DKfVf.png?s=128&g=1", "display_name": "Kamila Szewczyk", "link": "https://stackoverflow.com/users/6889435/kamila-szewczyk"}, "edited": false, "score": 0, "creation_date": 1557942198, "post_id": 56151392, "comment_id": 98939103, "body": "You&#39;re boiling it down to XY problem, the solution is somewhere else."}], "owner": {"reputation": 661, "user_id": 5537770, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/f97da445cf7af4efd508de4586b80150?s=128&d=identicon&r=PG&f=1", "display_name": "Pryda", "link": "https://stackoverflow.com/users/5537770/pryda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557929374, "creation_date": 1557929374, "question_id": 56151392, "link": "https://stackoverflow.com/questions/56151392/protect-the-content-of-a-static-library-in-c", "title": "Protect the content of a static library in C", "body": "<p>I have created a static library (.lib). The source code looks like this:</p>\n\n<p>Source file:</p>\n\n<pre><code>void foo(void)\n{\n  MyType var;\n  var.val1 = 40;\n  var.val2 = 30;\n  use(var);\n}\n</code></pre>\n\n<p>Header filer (libheader.h):</p>\n\n<pre><code>/* Exported API */\nvoid foo(void);\n</code></pre>\n\n<p>Main project:</p>\n\n<pre><code>#include \"libheader.h\" // XX.lib already imported to the main project\n\nint main()\n{\n  // some code\n  foo(); // Breakpoint here and step in\n  // some code\n  return 0;\n}\n</code></pre>\n\n<p>In the main project, I imported the library and included \"libheader.h\" and I called <code>foo()</code>. When I debug my code and I put a breakpoint on <code>foo()</code>then I click on 'Step in' the assembler code of the static library is shown in the debug console and I can see local variables content like <code>var</code> (in the example). I can even see in the call stack that <code>use(var)</code> has been called.</p>\n\n<p>My question is: This library should be protected before being delivered to the client. Is it normal that the content (variables, function names, calls ...) of a .lib file can be seen during debug? Is there a way to crypt/protect it?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 2, "creation_date": 1557929140, "post_id": 56151251, "comment_id": 98931896, "body": "I think it is not only a warning, but an error. Both variables have the same scope and name. You can use a scope for every case."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557929146, "post_id": 56151251, "comment_id": 98931902, "body": "Create a block surrounded by curly-braces <code>{}</code>."}, {"owner": {"reputation": 554, "user_id": 5306039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e0b2908132960fc726570b38fe4266?s=128&d=identicon&r=PG&f=1", "display_name": "shubham", "link": "https://stackoverflow.com/users/5306039/shubham"}, "edited": false, "score": 2, "creation_date": 1557929147, "post_id": 56151251, "comment_id": 98931903, "body": "put the curly braces around it <code>case 1: {...}</code>"}, {"owner": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "edited": false, "score": 0, "creation_date": 1557929799, "post_id": 56151251, "comment_id": 98932379, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/92396/why-cant-variables-be-declared-in-a-switch-statement\">Why can&#39;t variables be declared in a switch statement?</a>"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "reply_to_user": {"reputation": 355, "user_id": 9515951, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-m53-xNkMviQ/AAAAAAAAAAI/AAAAAAAAAW0/rfDtMQwohLs/photo.jpg?sz=128", "display_name": "Umaiki", "link": "https://stackoverflow.com/users/9515951/umaiki"}, "edited": false, "score": 1, "creation_date": 1557929871, "post_id": 56151251, "comment_id": 98932424, "body": "@Umaiki: This is not a duplicate of that. They ask different questions."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1557938670, "post_id": 56151251, "comment_id": 98937537, "body": "<code>switch(...) { int a; case ... }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1557929235, "creation_date": 1557929235, "answer_id": 56151333, "question_id": 56151251, "link": "https://stackoverflow.com/questions/56151251/declaration-of-a-variable-inside-a-swich-case/56151333#56151333", "title": "Declaration of a variable inside a swich case", "body": "<p>Declare your variables inside a new code block. Start a new code block with <code>{</code></p>\n\n<pre><code>switch()\n{\n   case 1:\n   {\n     int a;\n      break;\n    }\n\n   case 2:\n   {\n     int a;\n      break;\n   }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 10, "last_activity_date": 1557929643, "last_edit_date": 1557929643, "creation_date": 1557929264, "answer_id": 56151342, "question_id": 56151251, "link": "https://stackoverflow.com/questions/56151251/declaration-of-a-variable-inside-a-swich-case/56151342#56151342", "title": "Declaration of a variable inside a swich case", "body": "<p>The reason is that the lexical scope of both declarations is the entire switch body; all the cases share that scope.<br>\nThat is, in terms of lexical scope, it's like writing</p>\n\n<pre><code>{\n    int a;\n    int a;\n}\n</code></pre>\n\n<p>The solution is to enclose the declarations in another braced scope.</p>\n\n<pre><code>switch(whatever)\n{\n   case 1:\n   {\n     int a;\n     break;\n   }\n\n   case 2:\n   {\n     int a;\n     break;\n   }\n}\n</code></pre>\n\n<p>(Whether you put the <code>break</code> inside or outside the braces is mostly a matter of taste. I prefer to include the entire case.)</p>\n\n<p>This works for the same reason that this \"switch-free\" snippet works:</p>\n\n<pre><code>{\n    {\n        int a;\n    }\n    {\n        int a;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1557932156, "creation_date": 1557932156, "answer_id": 56152298, "question_id": 56151251, "link": "https://stackoverflow.com/questions/56151251/declaration-of-a-variable-inside-a-swich-case/56152298#56152298", "title": "Declaration of a variable inside a swich case", "body": "<p>There are two reasons.</p>\n\n<ul>\n<li><p>Everything inside the <code>{ ... }</code> of a <code>switch</code> resides in the same scope, unless you add further local scopes inside it. So you can't have two variables with the same name, for the same reason as you can't have:</p>\n\n<pre><code>int main (void) \n{\n  int a; int a; // will not compile\n}\n</code></pre></li>\n<li><p>Grammatically, <code>case x:</code> works like a label. In the C syntax, it is formally called <em>labeled-statement</em> and a labeled-statement can only be followed by a <em>statement</em>, not a declaration. So you can't have a variable declaration directly after <code>case x:</code>, for the same reason as you can't have </p>\n\n<pre><code>int main (void) \n{ \n  label: int a; // will not compile\n}\n</code></pre></li>\n</ul>\n\n<p>The best solution is to create another local scope per case. Or rename the variables. </p>\n"}], "owner": {"reputation": 563, "user_id": 7864336, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/8a2d64bf3ba8d5d7bc5d961075241343?s=128&d=identicon&r=PG&f=1", "display_name": "schanti schul", "link": "https://stackoverflow.com/users/7864336/schanti-schul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 56151342, "answer_count": 3, "score": 4, "last_activity_date": 1557932156, "creation_date": 1557929006, "question_id": 56151251, "link": "https://stackoverflow.com/questions/56151251/declaration-of-a-variable-inside-a-swich-case", "title": "Declaration of a variable inside a swich case", "body": "<p>Why do I get a warning when I declare the same variable name inside different cases of a switch-case.</p>\n\n<pre><code>switch()\n{\n   case 1:\n     int a;\n   break;\n\n   case 2:\n     int a;\n   break;\n\n}\n</code></pre>\n\n<p>Is there a way to do this without getting a warning. (Without putting it before the switch - case)</p>\n"}, {"tags": ["arrays", "c"], "answers": [{"tags": [], "owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "is_accepted": false, "score": 0, "last_activity_date": 1557930884, "creation_date": 1557930884, "answer_id": 56151892, "question_id": 56151225, "link": "https://stackoverflow.com/questions/56151225/how-to-create-a-function-to-output-a-lying-down-hourglass-by-entering-the-size-o/56151892#56151892", "title": "how to create a function to output a lying-down hourglass by entering the size of the array", "body": "<p>If you dont need it to be generic for any numbers of rows but just for this case, so 1 foor loop would defenitly will be enough.</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) {   \n            if (i == 0 || i == 4) //1st and 5th rows\n                printf(\"%d        %d\\n\", i + 1, i + 13);\n            else if(i == 1 || i == 3)//2nd and 4th rows\n                printf(\"%d %d   %d %d\\n\", i + 1, i + 5, i + 9, i + 13);\n            else\n                printf(\"3 7 9 11 15\\n\");//3rd row\n    }\n</code></pre>\n\n<p>if you'll like to have it generic and depends on user's input for rows number - just add another for loop and calculate the number of blanks you need and which number to print depends on the number of iteration.</p>\n"}], "owner": {"reputation": 1, "user_id": 10550826, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NldhKtfMSQU/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbD_XyOuI-ERaT4PLERNAVbu1A83cA/mo/photo.jpg?sz=128", "display_name": "\uae40\ud0dc\uacbd", "link": "https://stackoverflow.com/users/10550826/%ea%b9%80%ed%83%9c%ea%b2%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1601681942, "creation_date": 1557928925, "last_edit_date": 1601681942, "question_id": 56151225, "link": "https://stackoverflow.com/questions/56151225/how-to-create-a-function-to-output-a-lying-down-hourglass-by-entering-the-size-o", "title": "how to create a function to output a lying-down hourglass by entering the size of the array", "body": "<p>How do I make a function to output a lying hourglass rather than a set hourglass by receiving an array?</p>\n\n<p>I know how to implement a vertical hourglass.</p>\n\n<p>When I received a number of five,</p>\n\n<pre><code>1        13\n2 6   10 14\n3 7 9 11 15\n4 8   12 16\n5        17\n</code></pre>\n"}, {"tags": ["c", "linear-programming", "solver"], "comments": [{"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 2, "creation_date": 1558621854, "post_id": 56151149, "comment_id": 99169314, "body": "This post <a href=\"https://meta.stackoverflow.com/questions/385234/deviates-from-the-original-intent-of-the-post-for-grammar-cleanup\">is being discussed on Meta</a>."}], "answers": [{"comments": [{"owner": {"reputation": 296, "user_id": 7230777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ca80d30fbd9c2718cedc2b549310972?s=128&d=identicon&r=PG&f=1", "display_name": "Noah16", "link": "https://stackoverflow.com/users/7230777/noah16"}, "edited": false, "score": 0, "creation_date": 1558004268, "post_id": 56152452, "comment_id": 98960518, "body": "Thanks. As I said I produced the needed data to construct the objective function and the constraints...I would like to use the faster and the easier (not too much programming and modifying for the data ). What is your opinion?"}, {"owner": {"reputation": 296, "user_id": 7230777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ca80d30fbd9c2718cedc2b549310972?s=128&d=identicon&r=PG&f=1", "display_name": "Noah16", "link": "https://stackoverflow.com/users/7230777/noah16"}, "edited": false, "score": 0, "creation_date": 1558004911, "post_id": 56152452, "comment_id": 98960887, "body": "Also, for the first option you proposed, you said: &quot;The APIs do the work of translating the logic of the model to the matrices and vectors that the solver actually needs&quot; I wanted to say that I already built in C language the matrices and vectors that the solver needs so how I can benefit from that without the need to build it again with API?"}, {"owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "reply_to_user": {"reputation": 296, "user_id": 7230777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ca80d30fbd9c2718cedc2b549310972?s=128&d=identicon&r=PG&f=1", "display_name": "Noah16", "link": "https://stackoverflow.com/users/7230777/noah16"}, "edited": false, "score": 0, "creation_date": 1558006907, "post_id": 56152452, "comment_id": 98962001, "body": "If you have already built the matrices and vectors, then using an API is probably easier. To be honest I don&#39;t know which APIs allow you to just pass the matrices and vectors -- probably all?"}, {"owner": {"reputation": 4387, "user_id": 673271, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8skfj.png?s=128&g=1", "display_name": "mattmilten", "link": "https://stackoverflow.com/users/673271/mattmilten"}, "edited": false, "score": 1, "creation_date": 1558012772, "post_id": 56152452, "comment_id": 98965689, "body": "You will not be able to let the solver work with the data structures you already have. They need to be replicated inside the solver and this is done by passing them to the respective API functions."}, {"owner": {"reputation": 296, "user_id": 7230777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ca80d30fbd9c2718cedc2b549310972?s=128&d=identicon&r=PG&f=1", "display_name": "Noah16", "link": "https://stackoverflow.com/users/7230777/noah16"}, "reply_to_user": {"reputation": 4387, "user_id": 673271, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8skfj.png?s=128&g=1", "display_name": "mattmilten", "link": "https://stackoverflow.com/users/673271/mattmilten"}, "edited": false, "score": 0, "creation_date": 1558012975, "post_id": 56152452, "comment_id": 98965835, "body": "@mattmilten Thanks. I failed to find something like this in the documentations ! I would be very grateful if you can link a similar situation or an example..thanks in advance"}, {"owner": {"reputation": 4387, "user_id": 673271, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/8skfj.png?s=128&g=1", "display_name": "mattmilten", "link": "https://stackoverflow.com/users/673271/mattmilten"}, "edited": false, "score": 0, "creation_date": 1558013839, "post_id": 56152452, "comment_id": 98966404, "body": "Not an example but the list of common problem creation functions for SCIP: <a href=\"https://scip.zib.de/doc-6.0.1/html/group__PublicProblemMethods.php\" rel=\"nofollow noreferrer\">scip.zib.de/doc-6.0.1/html/group__PublicProblemMethods.php</a>"}], "tags": [], "owner": {"reputation": 2127, "user_id": 3453768, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/RpSGc.png?s=128&g=1", "display_name": "LarrySnyder610", "link": "https://stackoverflow.com/users/3453768/larrysnyder610"}, "is_accepted": true, "score": 4, "last_activity_date": 1557932643, "creation_date": 1557932643, "answer_id": 56152452, "question_id": 56151149, "link": "https://stackoverflow.com/questions/56151149/minimize-a-linear-programming-system-in-c/56152452#56152452", "title": "Minimize a linear programming system in C", "body": "<p>One option is to use the APIs that commercial solvers like <a href=\"https://www.ibm.com/support/knowledgecenter/SS9UKU_12.6.0/com.ibm.cplex.zos.help/refcallablelibrary/homepageCrefman.html\" rel=\"nofollow noreferrer\">CPLEX</a> and <a href=\"http://www.gurobi.com/documentation/8.1/refman/c_api_overview.html\" rel=\"nofollow noreferrer\">Gurobi</a> provide for C/C++. Essentially, these APIs let you build the model in logical chunks (objective function, constraints, etc.). The APIs do the work of translating the <em>logic</em> of the model to the <em>matrices and vectors</em> that the solver actually needs in order to solve the model. </p>\n\n<p>Another approach is to use a modeling language like AMPL or GAMS. AMPL, for example, also provides a <a href=\"https://ampl.com/api/1.2.2/cpp/\" rel=\"nofollow noreferrer\">C/C++ API</a>. </p>\n\n<p>Which one you choose probably depends on what solver you plan to use and how often you need to modify your model and/or data programmatically.</p>\n"}], "owner": {"reputation": 296, "user_id": 7230777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7ca80d30fbd9c2718cedc2b549310972?s=128&d=identicon&r=PG&f=1", "display_name": "Noah16", "link": "https://stackoverflow.com/users/7230777/noah16"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 56152452, "answer_count": 1, "score": -7, "last_activity_date": 1558373715, "creation_date": 1557928662, "last_edit_date": 1558373715, "question_id": 56151149, "link": "https://stackoverflow.com/questions/56151149/minimize-a-linear-programming-system-in-c", "title": "Minimize a linear programming system in C", "body": "<p>I need to minimize a huge linear programming system where all related data (objective function, constraints) are stored in the memory in arrays and structures but not in lp file format or CPLEX</p>\n\n<p>I saw that there are many solvers like <a href=\"https://math.stackexchange.com/questions/888870/free-solvers-in-c-c-for-convex-integer-programming\">here</a> and <a href=\"https://stackoverflow.com/questions/2791559/how-to-choose-an-integer-linear-programming-solver/4052970#4052970\">here</a> but the problem is how can I minimize the model without calling it from a file of a special format?</p>\n\n<p>I did the same work previously in R and Python by solving the model directly after producing it without the need to save it initially in a special file and then call it by the solver. Here is an example in Python:</p>\n\n<pre><code>from lpsolve55 import *\nfrom lp_maker import *\nfrom lp_solve import *\n\nlp = lp_maker(obj_func, constraints , rhs, sense_equality)\nsolvestat = lpsolve('solve', lp)\nobj = lpsolve('get_objective', lp)\n</code></pre>\n\n<p>I think this is possible to do in C but really I don't know where to find how it is possible to do it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1557927918, "post_id": 56150803, "comment_id": 98931101, "body": "Can you move <code>team b[MAX_TEAMS_NUMBER]; team c[MAX_TEAMS_NUMBER];</code> after you have defined the new type <code>team</code> using <code>typedef</code>?"}, {"owner": {"reputation": 37414, "user_id": 204883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba29060be0758fa6537ff3d768a91757?s=128&d=identicon&r=PG", "display_name": "Arkku", "link": "https://stackoverflow.com/users/204883/arkku"}, "edited": false, "score": 1, "creation_date": 1557928138, "post_id": 56150803, "comment_id": 98931255, "body": "<a href=\"https://stackoverflow.com/help/reprex\">stackoverflow.com/help/reprex</a>"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1557928396, "post_id": 56150803, "comment_id": 98931412, "body": "I see code (<code>for(int i....)</code>), but it is not in any function!  You cannot have free-floating code.  It must be inside a function."}, {"owner": {"reputation": 11, "user_id": 11504277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16JfVc-vxYA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOq8fhF8WvfG4wRbNrk3wfS076RA/mo/photo.jpg?sz=128", "display_name": "Eliav Bareli", "link": "https://stackoverflow.com/users/11504277/eliav-bareli"}, "edited": false, "score": 0, "creation_date": 1557952924, "post_id": 56150803, "comment_id": 98943677, "body": "hi iam really sorry for not mention this, but all the code(of course just the loop and the declarations) is inside the main(int), and the two lines of declaration are under the two structures, in my original code. I will edit the question. thank you!"}, {"owner": {"reputation": 11, "user_id": 11504277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16JfVc-vxYA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOq8fhF8WvfG4wRbNrk3wfS076RA/mo/photo.jpg?sz=128", "display_name": "Eliav Bareli", "link": "https://stackoverflow.com/users/11504277/eliav-bareli"}, "edited": false, "score": 0, "creation_date": 1557955317, "post_id": 56150803, "comment_id": 98944554, "body": "I found my mistake and wrote it in the question."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11504277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16JfVc-vxYA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOq8fhF8WvfG4wRbNrk3wfS076RA/mo/photo.jpg?sz=128", "display_name": "Eliav Bareli", "link": "https://stackoverflow.com/users/11504277/eliav-bareli"}, "edited": false, "score": 0, "creation_date": 1557951457, "post_id": 56151040, "comment_id": 98943073, "body": "Im really sorry, in the original code it is not like that, it is below the structures. thank you for the comment, I will edit the question."}, {"owner": {"reputation": 11, "user_id": 11504277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16JfVc-vxYA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOq8fhF8WvfG4wRbNrk3wfS076RA/mo/photo.jpg?sz=128", "display_name": "Eliav Bareli", "link": "https://stackoverflow.com/users/11504277/eliav-bareli"}, "edited": false, "score": 0, "creation_date": 1557955342, "post_id": 56151040, "comment_id": 98944561, "body": "I found my mistake and wrote it in the question."}], "tags": [], "owner": {"reputation": 98, "user_id": 11503487, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8eZTZG0oBCo/AAAAAAAAAAI/AAAAAAAAACU/SVtgoSx2Tyo/photo.jpg?sz=128", "display_name": "Luc A", "link": "https://stackoverflow.com/users/11503487/luc-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1557928328, "creation_date": 1557928328, "answer_id": 56151040, "question_id": 56150803, "link": "https://stackoverflow.com/questions/56150803/expression-must-have-pointer-to-object-type-with-structs/56151040#56151040", "title": "expression must have pointer to object type with structs", "body": "<p>In C, the code order is very important. Here, you first try to create an array of \"teams\", then you tell the compiler what a \"team\" is. As it will read your code line by line, it doesn't know what a team is when reading your 2 first lines. </p>\n\n<p>You must move the 2 first lines after your structures.</p>\n\n<p>Keep in mind this problem can also occur with functions : if you use a function BEFORE its declaration, the compiler will detect an error. (declaration isn't implementation, you can implement a function at the bottom of your code but you need to declare it using a prototype.)</p>\n"}], "owner": {"reputation": 11, "user_id": 11504277, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-16JfVc-vxYA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdOq8fhF8WvfG4wRbNrk3wfS076RA/mo/photo.jpg?sz=128", "display_name": "Eliav Bareli", "link": "https://stackoverflow.com/users/11504277/eliav-bareli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557955263, "creation_date": 1557927568, "last_edit_date": 1557955263, "question_id": 56150803, "link": "https://stackoverflow.com/questions/56150803/expression-must-have-pointer-to-object-type-with-structs", "title": "expression must have pointer to object type with structs", "body": "<p><strong>* I find my mistake. c was already an int in this program . It was a big program(for me) and I had 20 variables and got confused. thank you. by the way, this option for copying a struct worked for me in the end.</strong></p>\n\n<p>I am trying to copy a structure, and it tells me that i need to put a pointer I think.\nI like to mention that I didnt use pointers in all my program.</p>\n\n<p>I've done a code of a game. it's a 500 hundred code and ran smoothly, until I tried to copy a structure.\nI equaled it with a lot of people that did similar to me, and they don't have my problem. I also searched in all of the web.\nIt writed to me two types of errors that I will add below.\nthank you!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct player {\n    char name[ARR_SIZE]; // player's name, up to 20 chars\n    int age; // player's age, 0 - 120\n    int defense; // defense power, 1 - 100\n    int attack; // attack power, 1 - 100\n}player;\n\ntypedef struct team {\n    char name[ARR_SIZE]; // team's name\n    int numberOfPlayers; // number of players in the team, up to MAX_PLAYERS\n    player teamPlayers[MAX_PLAYERS]; // array of the team players\n    int points; // the team points in the league\n    int wins; // number of wins\n    int draws; // number of draws\n    int losses; // number of losses\n}team;\n\nteam b[MAX_TEAMS_NUMBER];\nteam c[MAX_TEAMS_NUMBER]; (1)\n\n** the part of the code itself**\nint main ()\n{\n    for (int i = 0; i &lt; number_of_teams; i++)\n        {\n            c[i] = b[i]; (2)\n        }\n}\n</code></pre>\n\n<p>I denoted numbers near the problematic lines\n(1)'c': 'team[10]' differs in levels of indirection from 'int'\n(2) Expression must have a pointer to object type</p>\n"}, {"tags": ["c", "linux", "linux-kernel", "linux-device-driver", "kmalloc"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 2, "creation_date": 1557927247, "post_id": 56150495, "comment_id": 98930657, "body": "<code>it doesn&#39;t work</code> - how do you know that? How do you check that?"}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "edited": false, "score": 1, "creation_date": 1557927300, "post_id": 56150495, "comment_id": 98930685, "body": "can you provide the desired output and what&#39;s you actually get?"}, {"owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "edited": false, "score": 0, "creation_date": 1557927595, "post_id": 56150495, "comment_id": 98930875, "body": "copy_from_user returns the number of chars that couldn&#39;t copy so when i run it the k value always equal to the char number in temp. but when i change temp with buf ,k equals 0."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1557928211, "post_id": 56150495, "comment_id": 98931313, "body": "Where and how is <code>caesar_Buf</code> defined? Where and how is <code>memory_size</code> defined. <code>sizeof(char)</code> is always <code>== 1</code> therefore  <code>temp = kmalloc(memory_size ,GFP_USER);</code> is sufficient,  <i>as long as</i> <code>GPF_USER</code> <i>is defined somewhere.</i>   ( Show them or indicate this information some how in the code, or in your post.  It is not possible to answer the question without this type of information.)"}, {"owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "edited": false, "score": 0, "creation_date": 1557928736, "post_id": 56150495, "comment_id": 98931631, "body": "<code>char *caesar_Buf = NULL;</code> in the head   and   <code>caesar_Buf = (char *)kmalloc(memory_size * sizeof(char),GFP_KERNEL);</code>    in the init_module func"}, {"owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "edited": false, "score": 0, "creation_date": 1557928842, "post_id": 56150495, "comment_id": 98931699, "body": "<code>GFP_USER</code> is defined for for the <code>kmalloc()</code>"}, {"owner": {"reputation": 2236, "user_id": 11384392, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5bfH.jpg?s=128&g=1", "display_name": "Das_Geek", "link": "https://stackoverflow.com/users/11384392/das-geek"}, "edited": false, "score": 0, "creation_date": 1557929428, "post_id": 56150495, "comment_id": 98932112, "body": "It would be more helpful to include the parts of your code where they are defined. Use <a href=\"https://stackoverflow.com/help/reprex\">this guide</a> to help you make the necessary edits to your question."}, {"owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "edited": false, "score": 0, "creation_date": 1557930552, "post_id": 56150495, "comment_id": 98932908, "body": "i have add part of the code"}, {"owner": {"reputation": 9716, "user_id": 1116739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7dd5d55de3e76fd4ca0916028e2d46?s=128&d=identicon&r=PG", "display_name": "cha0site", "link": "https://stackoverflow.com/users/1116739/cha0site"}, "edited": false, "score": 0, "creation_date": 1557931174, "post_id": 56150495, "comment_id": 98933324, "body": "Fix your code to do what? <code>copy_from_user</code> is doing exactly what it&#39;s supposed to do here; it&#39;s refusing to copy from kernel-space. <code>temp</code> is in kernel-space memory, so <code>copy_from_user</code> doesn&#39;t copy. <code>buf</code> is in user-space memory, so it does."}, {"owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "edited": false, "score": 0, "creation_date": 1557940424, "post_id": 56150495, "comment_id": 98938337, "body": "i need to copy buf into temp and then do the encription on temp and save it into caesar_buf by using copy_from_user."}], "answers": [{"tags": [], "owner": {"reputation": 9716, "user_id": 1116739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de7dd5d55de3e76fd4ca0916028e2d46?s=128&d=identicon&r=PG", "display_name": "cha0site", "link": "https://stackoverflow.com/users/1116739/cha0site"}, "is_accepted": true, "score": 1, "last_activity_date": 1557931403, "creation_date": 1557931403, "answer_id": 56152062, "question_id": 56150495, "link": "https://stackoverflow.com/questions/56150495/how-can-i-fix-copy-from-user-doesnt-work/56152062#56152062", "title": "how can I fix copy_from_user doesn&#39;t work?", "body": "<p>You should be using <code>copy_from_user</code> instead of accessing <code>buf</code> directly (inside the loop, not when accessing <code>temp</code> (which is in kernel-space memory.)</p>\n\n<p><code>copy_from_user</code> is intended to ensure that to accesses in a user context only access user-space data -- i.e., that someone doesn't pass a pointer to kernel memory in a syscall and leaks data from the kernel somehow.</p>\n"}], "owner": {"reputation": 57, "user_id": 9884551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Victor Hanna", "link": "https://stackoverflow.com/users/9884551/victor-hanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 56152062, "answer_count": 1, "score": 1, "last_activity_date": 1557931403, "creation_date": 1557926648, "last_edit_date": 1557930490, "question_id": 56150495, "link": "https://stackoverflow.com/questions/56150495/how-can-i-fix-copy-from-user-doesnt-work", "title": "how can I fix copy_from_user doesn&#39;t work?", "body": "<p>I'm trying to code an encryption driver in Linux, but when I encrypt the string and copy it into the buffer by using <code>copy_from_user()</code> it doesn't work and the k value is the number of chars in the string</p>\n\n<p>If I change the <code>temp</code> in <code>copy_from_user</code> to <code>buf</code> it work fine </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>ssize_t encdec_write_caesar(struct file *filp, const char *buf, size_t count, loff_t *f_pos)\n{\n    char *temp ;\n    temp = kmalloc(memory_size * sizeof(char),GFP_USER);\n    memset(temp, 0, memory_size);\n\n    int i , k ;\n\n    k = ((encdec_private_date *)(filp-&gt;private_data))-&gt;key;\n    for(i = 0; i &lt; count; i++)\n    {\n        temp[i] = (buf[i] + k) % 128;\n    }\n\n    k = copy_from_user ( caesar_Buf , temp , count);\n    printk(\"write-&gt; %d\\n\"  ,k);\n\n    kfree(temp);\n    return 0;\n }\n</code></pre>\n\n<p>this is part of the code </p>\n\n<pre><code>#include &lt;linux/ctype.h&gt;\n#include &lt;linux/config.h&gt;\n#include &lt;linux/module.h&gt;\n#include &lt;linux/kernel.h&gt;\n#include &lt;linux/slab.h&gt;\n#include &lt;linux/fs.h&gt;\n#include &lt;linux/errno.h&gt;\n#include &lt;linux/types.h&gt;\n#include &lt;linux/proc_fs.h&gt;\n#include &lt;linux/fcntl.h&gt;\n#include &lt;asm/system.h&gt;\n#include &lt;asm/uaccess.h&gt;\n#include &lt;linux/string.h&gt;\n\n#include \"encdec.h\"\n\n#define MODULE_NAME \"encdec\"\n\nMODULE_LICENSE(\"GPL\");\nMODULE_AUTHOR(\"YOUR NAME\");\n\nint     encdec_open(struct inode *inode, struct file *filp);\nint     encdec_release(struct inode *inode, struct file *filp);\nint     encdec_ioctl(struct inode *inode, struct file *filp, unsigned int cmd, unsigned long arg);\n\nssize_t encdec_read_caesar( struct file *filp, char *buf, size_t count, loff_t *f_pos );\nssize_t encdec_write_caesar(struct file *filp, const char *buf, size_t count, loff_t *f_pos);\n\n\n\nint memory_size = 0;\n\nMODULE_PARM(memory_size, \"i\");\n\nint major = 0;\nchar *caesar_Buf = NULL;\n\n\nstruct file_operations fops_caesar = {\n    .open    =  encdec_open,\n    .release =  encdec_release,\n    .read    =  encdec_read_caesar,\n    .write   =  encdec_write_caesar,\n    .llseek  =  NULL,\n    .ioctl   =  encdec_ioctl,\n    .owner   =  THIS_MODULE\n};\n\n\n// Implemetation suggestion:\n// -------------------------\n// Use this structure as your file-object's private data structure\ntypedef struct {\n    unsigned char key;\n    int read_state;\n} encdec_private_date;\n\nint init_module(void)\n{\n    major = register_chrdev(major, MODULE_NAME, &amp;fops_caesar);\n    if(major &lt; 0)\n    {\n        return major;\n    }\n\n\n\n    caesar_Buf = (char *)kmalloc(memory_size * sizeof(char),GFP_KERNEL);\n\n\n\n    return 0;\n}\n\n</code></pre>\n"}, {"tags": ["c", "linux", "arm", "cpu-registers", "ptrace"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1558020544, "post_id": 56150432, "comment_id": 98970550, "body": "Looking at <a href=\"https://elixir.bootlin.com/linux/latest/source/arch/arm/include/uapi/asm/ptrace.h#L124\" rel=\"nofollow noreferrer\">elixir.bootlin.com/linux/latest/source/arch/arm/include/uapi&zwnj;&#8203;/&hellip;</a> , it looks like you should use <code>struct pt_regs</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1557936516, "post_id": 56152857, "comment_id": 98936528, "body": "<code>user_regs_struct</code> seems to be x86 specific.  The <code>user_regs</code> seems to be ARM specific in some kernel versions.  Different ARM Linux may/may not have VFP so the <code>PTRACE_GETREGS</code> returns different values.  I believe that R0-R15 are always the first 16 integers returned.  You can allocate a larger array and just use the first 16 values.  CPSR is 16 and orignal R0 is 17.  Then VFP if present."}], "tags": [], "owner": {"reputation": 1585, "user_id": 421550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e7a2292ef4ad3674b556df31e81efce?s=128&d=identicon&r=PG", "display_name": "domen", "link": "https://stackoverflow.com/users/421550/domen"}, "is_accepted": false, "score": 1, "last_activity_date": 1557933882, "creation_date": 1557933882, "answer_id": 56152857, "question_id": 56150432, "link": "https://stackoverflow.com/questions/56150432/get-registers-with-ptrace-in-arm-linux/56152857#56152857", "title": "Get registers with ptrace in arm-linux", "body": "<p>Check your <code>sys/user.h</code>, like the <code>man</code> page says.</p>\n\n<p>It's likely you'll find it under a different name, such as <code>struct user_regs</code>.</p>\n"}], "owner": {"reputation": 67, "user_id": 11013839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eec480fc8c7b27cd793aba23c16e5948?s=128&d=identicon&r=PG&f=1", "display_name": "paramikoooo", "link": "https://stackoverflow.com/users/11013839/paramikoooo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557933882, "creation_date": 1557926441, "question_id": 56150432, "link": "https://stackoverflow.com/questions/56150432/get-registers-with-ptrace-in-arm-linux", "title": "Get registers with ptrace in arm-linux", "body": "<p>Tried to get PC register of thread in arm linux.</p>\n\n<p>There is process , process id =  120 and it has 3 threads : threads id : 121,122,123 .</p>\n\n<pre><code>#include &lt;sys/ptrace.h&gt;\n#include &lt;sys/user.h&gt;\nint main()\n{\n    struct user_regs_struct regs;\n    ptrace (PTRACE_ATTACH,123,0,0);\n    ptrace (PTRACE_GETREGS,123,NULL,&amp;regs);\n    printf (\"0x%x\",regs.pc);\n}\n</code></pre>\n\n<p>When compiled in gcc - arm compiler , get error <code>error: storage size of 'regs' isn't known struct user_regs_struct regs</code></p>\n\n<p>Why this struct unknown?  how do I get registers value of thread with ptrace?</p>\n"}, {"tags": ["c", "pointers", "debugging", "matrix"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10489361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQfhl5BjUOw/AAAAAAAAAAI/AAAAAAAAero/i0PGh-cThgo/photo.jpg?sz=128", "display_name": "Valentina Nikolenko", "link": "https://stackoverflow.com/users/10489361/valentina-nikolenko"}, "edited": false, "score": 0, "creation_date": 1557927064, "post_id": 56150468, "comment_id": 98930547, "body": "it works!! thank you so so much!!!!! a question, why didnt it work...? I wanted to send a pointer to the function and not the whole matrix... why wasn&#39;t that good?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 25, "user_id": 10489361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQfhl5BjUOw/AAAAAAAAAAI/AAAAAAAAero/i0PGh-cThgo/photo.jpg?sz=128", "display_name": "Valentina Nikolenko", "link": "https://stackoverflow.com/users/10489361/valentina-nikolenko"}, "edited": false, "score": 0, "creation_date": 1557927220, "post_id": 56150468, "comment_id": 98930645, "body": "An array is already (decays into) a pointer when passed to a function, in other words, if you want to set the values of an array is enough to pass the array, not his address, you pass the address when you want to change the value of the pointer itself (the address of the array or where it points to)."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557928211, "post_id": 56150468, "comment_id": 98931314, "body": "Wouldn&#39;t the compiler complain here somewhere about incompatible types? Wouldn&#39;t it then be a matter of &quot;turn warnings of your compiler on!&quot;?"}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557929189, "post_id": 56150468, "comment_id": 98931932, "body": "@PaulOgilvie, yes, it should emit a warning in this case"}], "tags": [], "owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "is_accepted": true, "score": 2, "last_activity_date": 1557926568, "creation_date": 1557926568, "answer_id": 56150468, "question_id": 56150386, "link": "https://stackoverflow.com/questions/56150386/matrix-calculator-bug-not-working-properly/56150468#56150468", "title": "matrix calculator bug - not working properly", "body": "<p>If you want to receive a <code>MAT</code>, you need</p>\n\n<pre><code>void print_mat(MAT mat1){ // same as void print_mat(double mat1[N][N]){\n</code></pre>\n\n<p>instead of</p>\n\n<pre><code>void print_mat(MAT * mat1){ // You don't want a pointer to a 2D array\n</code></pre>\n\n<p>and here</p>\n\n<pre><code>printf(\"%.2f    \",*mat1[i][j]);\n</code></pre>\n\n<p>you don't want to dereference, instead</p>\n\n<pre><code>printf(\"%.2f    \", mat1[i][j]);\n</code></pre>\n\n<p>Same for <code>read_mat()</code></p>\n"}], "owner": {"reputation": 25, "user_id": 10489361, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZQfhl5BjUOw/AAAAAAAAAAI/AAAAAAAAero/i0PGh-cThgo/photo.jpg?sz=128", "display_name": "Valentina Nikolenko", "link": "https://stackoverflow.com/users/10489361/valentina-nikolenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 56150468, "answer_count": 1, "score": 1, "last_activity_date": 1557927042, "creation_date": 1557926307, "last_edit_date": 1557927042, "question_id": 56150386, "link": "https://stackoverflow.com/questions/56150386/matrix-calculator-bug-not-working-properly", "title": "matrix calculator bug - not working properly", "body": "<p>My code is building a matrix calculator. I have an array of matrices, a function to build the matrix, that gets a pointer to the wanted matrix (one of 6) and a pointer to an array of parameters to enter the matrix. another function is print_mat to print the matrix.</p>\n\n<p>The problem is: I have these matrices: MAT_A, MAT_B......MAT_F.\nwhen I enter parameters to MAT_X, it also showed om MAT_X-1. for instance - if I put parameters to MAT_B, somehow MAT_A gets updated too.</p>\n\n<hr>\n\n<pre><code>MAT type definition: typedef double MAT[N][N];\n\nMAT array:     MAT matrices[6];\n\nprinting matrix function: \n\nvoid print_mat(MAT * mat1){\nint i=0,j=0;\nprintf(\"the matrix is:\\n\\n\");\nfor(i=0;i&lt;N;i++){\n    for (int j = 0; j &lt; N ; ++j){\n        printf(\"%.2f    \",*mat1[i][j]);\n        if (j==N-1) /* end of line, last parameter on this line so move to the next one */\n            printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>put parameters in matrix function:</p>\n\n<pre><code>void read_mat (MAT  *mat1 , double * parameters){\nint i=0,j=0,index=0;\nfor(i=0;i&lt;N;i++){\n    for (int j = 0; j &lt; N ; ++j){\n        *(mat1)[i][j]=parameters[index];\n        index++;\n    }\n}\n</code></pre>\n\n<p>}</p>\n\n<p>How I call the functions to use: (relevant cases are case 0 and 1)</p>\n\n<pre><code>void execute(MAT *matrices,int *parameters, double *scalars, int command_index){\nswitch (command_index){\n    case 0:\n        read_mat(&amp;matrices[parameters[0]],scalars);\n        break;\n    case 1:\n        print_mat(&amp;matrices[parameters[0]]);\n        break;\n    case 2:\n        add_mat(&amp;matrices[parameters[0]],&amp;matrices[parameters[1]],&amp;matrices[parameters[2]]);\n        break;\n    case 3:\n        sub_mat(&amp;matrices[parameters[0]],&amp;matrices[parameters[1]],&amp;matrices[parameters[2]]);\n        break;\n    case 4:\n        mul_mat(&amp;matrices[parameters[0]],&amp;matrices[parameters[1]],&amp;matrices[parameters[2]]);\n        break;\n    case 5:\n        mul_scalar(&amp;matrices[parameters[0]],scalars,&amp;matrices[parameters[1]]);\n        break;\n    case 6:\n        trans_mat(&amp;matrices[parameters[0]],&amp;matrices[parameters[1]]);\n        break;\n    default: /* stop command */\n        stop();\n        break;\n}\n</code></pre>\n\n<p>}</p>\n\n<hr>\n\n<p>command: read_mat MAT_B,1,2.3456,-7.89\ncommand: print_mat MAT_B\nresult: \nthe matrix is: //(MAT_B) </p>\n\n<p>1.00    2.35    -7.89    0.00</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>but at the same time MAT_A:\ncommand: print_mat MAT_A</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>1.00    2.35    -7.89    0.00</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>0.00    0.00    0.00    0.00</p>\n\n<p>(while it should be all zeros)</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 4685974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdpVkFClVTE/AAAAAAAAAAI/AAAAAAAABgk/3vDJC6gnJ54/photo.jpg?sz=128", "display_name": "Moschte", "link": "https://stackoverflow.com/users/4685974/moschte"}, "edited": false, "score": 0, "creation_date": 1557925576, "post_id": 56150122, "comment_id": 98929529, "body": "Also good to use de brackets {}"}, {"owner": {"reputation": 9, "user_id": 11504276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-toGi490vELM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renPzyz_FURUD421YFI2RgO-fpYkA/mo/photo.jpg?sz=128", "display_name": "zheng boon", "link": "https://stackoverflow.com/users/11504276/zheng-boon"}, "edited": false, "score": 0, "creation_date": 1557925610, "post_id": 56150122, "comment_id": 98929554, "body": "erm sorry what does indent mean? i am sorry if i am troubling you"}, {"owner": {"reputation": 9, "user_id": 11504276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-toGi490vELM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renPzyz_FURUD421YFI2RgO-fpYkA/mo/photo.jpg?sz=128", "display_name": "zheng boon", "link": "https://stackoverflow.com/users/11504276/zheng-boon"}, "edited": false, "score": 0, "creation_date": 1557925653, "post_id": 56150122, "comment_id": 98929582, "body": "and thank you the code runs :D"}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1557925656, "post_id": 56150122, "comment_id": 98929585, "body": "indent means format like @Mike just did"}, {"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557925727, "post_id": 56150122, "comment_id": 98929626, "body": "@cleblanc except that Mike indent is wrong because of the extra &#39;;&#39; ;-)"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 2, "last_activity_date": 1557925532, "creation_date": 1557925532, "answer_id": 56150122, "question_id": 56150093, "link": "https://stackoverflow.com/questions/56150093/else-statement-is-resulting-in-identifier-expected-in-c-13/56150122#56150122", "title": "else statement is resulting in identifier expected in c 13", "body": "<p>The problem is a misplaced semi colon here <code>if ( hours &gt; 40 );</code> just remove the semi colon.  It's good practice to indent the code properly to help detect these kind of errors.</p>\n"}, {"tags": [], "owner": {"reputation": 3478, "user_id": 9061264, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TPing.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9061264/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1557927397, "last_edit_date": 1557927397, "creation_date": 1557926046, "answer_id": 56150291, "question_id": 56150093, "link": "https://stackoverflow.com/questions/56150093/else-statement-is-resulting-in-identifier-expected-in-c-13/56150291#56150291", "title": "else statement is resulting in identifier expected in c 13", "body": "<p>I guess he wants something like that:\nAnd of course as mentioned before the problem is the misplaced semicolon after the <code>if</code> statement. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\n\nvoid main (void)\n{\n    float hours,rate;\n    printf(\"Enter the number of hours worked in this week:\\n\");\n    scanf(\"%f\",&amp;hours);\n    printf(\"Enter the pay rate\\n\");\n    scanf(\"%f\",&amp;rate);\n    if (hours &gt; 40)\n    {\n        printf(\"more than 40\");\n    }\n    else\n    {\n        printf(\"less than 40\");\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11504276, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-toGi490vELM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3renPzyz_FURUD421YFI2RgO-fpYkA/mo/photo.jpg?sz=128", "display_name": "zheng boon", "link": "https://stackoverflow.com/users/11504276/zheng-boon"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1557926025, "answer_count": 2, "score": -2, "last_activity_date": 1557927397, "creation_date": 1557925443, "last_edit_date": 1557925601, "question_id": 56150093, "link": "https://stackoverflow.com/questions/56150093/else-statement-is-resulting-in-identifier-expected-in-c-13", "closed_reason": "Not suitable for this site", "title": "else statement is resulting in identifier expected in c 13", "body": "<p>I am a beginner at C and still learning the language </p>\n\n<p>I can't tell what the error is about. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;math.h&gt;\nvoid main (void)\n{\n    float hours,rate;\n    printf(\"Enter the number of hours worked in this week:\\n\");\n    scanf(\"%f\",&amp;hours);\n    printf(\"Enter the pay rate\\n\");\n    scanf(\"%f\",&amp;rate);\n    if ( hours &gt; 40 );\n        printf(\"more than 40\");\n\n    else{\n        printf(\"less than 40\");\n    }\n}\n</code></pre>\n\n<p>//c:13 identifier expected</p>\n"}, {"tags": ["c", "multithreading", "unix", "thread-safety"], "comments": [{"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 0, "creation_date": 1557926619, "post_id": 56150004, "comment_id": 98930216, "body": "All it is saying is that using thread-safe functions to implement <i>your</i> algorithm does not make your algorithm thread-safe."}, {"owner": {"reputation": 19267, "user_id": 801894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f2ccd17aa6fd622152ad88fc2ae784?s=128&d=identicon&r=PG", "display_name": "Solomon Slow", "link": "https://stackoverflow.com/users/801894/solomon-slow"}, "edited": false, "score": 1, "creation_date": 1557927552, "post_id": 56150004, "comment_id": 98930852, "body": "Re, &quot;strcpy()...is kinda thread safe.&quot; No. <code>strcpy()</code> and <code>strdup()</code> are not thread <i>safe</i>, they are thread <i>agnostic</i>. The only memory locations accessed by those functions are their own local variables, and locations to which your program provides pointers. If your threads don&#39;t provide pointers to <i>shared</i> buffers, when calling <code>strcpy()</code> or <code>strdup()</code> then there will be no need for thread-safety because there&#39;s no possibility of collision. If, on the other hand, your threads <i>do</i> provide pointers to shared data, then it&#39;s <i>your</i> responsibility to ensure the safety."}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 1, "creation_date": 1557936835, "post_id": 56150004, "comment_id": 98936686, "body": "I&#39;d love to hear the definition for &quot;kinda thread safe&quot;, is it the same as &quot;kinda pregnant&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 1, "creation_date": 1557926565, "post_id": 56150161, "comment_id": 98930178, "body": "... or if one thread does <code>char s1[] = &quot;foo&quot;; strcpy(s1,&quot;bar&quot;)</code> and the other thread does <code>strcpy(s2,s1)</code> with no synchronization it is not guaranteed that <code>s2</code> will get the value <code>&quot;foo&quot;</code> or <code>&quot;bar&quot;</code>, it might also get a partially changed value, e.g. <code>&quot;boo&quot;</code>."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1557926739, "post_id": 56150161, "comment_id": 98930310, "body": "if s1 is an array or a pointer to char, isn&#39;t it per-thread?  since it is defined in a thread&#39;s function, it is in thread&#39;s stack. ??"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557927061, "post_id": 56150161, "comment_id": 98930546, "body": "@Bodo I don&#39;t think it is possible. The fact that s1[]=&quot;foo&quot; is in thread&#39;s stack space does mean it is special to the thread. When the other thread comes, it does same thing. Is it wrong?"}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1557927143, "post_id": 56150161, "comment_id": 98930595, "body": "@Som.prog.du. if the buffer is shared, of course race is apparent."}, {"owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557927302, "post_id": 56150161, "comment_id": 98930686, "body": "@Bodo it is possible only and only if s2 is shared source."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "edited": false, "score": 0, "creation_date": 1557927570, "post_id": 56150161, "comment_id": 98930859, "body": "@snr Well yes if all of the data is local to the thread (which isn&#39;t clearly spelled out in the question IMO) then there&#39;s no problem what so ever. And that what&#39;s &quot;MT-safe&quot; means. Maybe a better term would be &quot;thread reentrant&quot;?"}, {"owner": {"reputation": 26764, "user_id": 144746, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/170e317e1e3d42b520786bcec9dfb409?s=128&d=identicon&r=PG", "display_name": "Voo", "link": "https://stackoverflow.com/users/144746/voo"}, "edited": false, "score": 0, "creation_date": 1557937259, "post_id": 56150161, "comment_id": 98936871, "body": "@some reentrancy has a very specific meaning that doesn&#39;t fit here imo. The concept here is very simple and really just means that any static data the function may use is correctly synchronized. The classic counter example is rand() which isn&#39;t safe to call in parallel."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1557926707, "last_edit_date": 1557926707, "creation_date": 1557925633, "answer_id": 56150161, "question_id": 56150004, "link": "https://stackoverflow.com/questions/56150004/thread-safety-vs-atomicity-in-c/56150161#56150161", "title": "Thread-safety vs atomicity in C", "body": "<p>\"MT-Safe\" in this context only means that you can call the function from multiple threads, not that there's any synchronization between the threads.</p>\n\n<p>For example, you have two threads where one is doing <code>strcpy(s1, \"foo\")</code> and the other is doing <code>strcpy(s1, \"bar\")</code> (and <code>s1</code> is a buffer shared between the threads), then you have a data-race as both threads could attempt to write to the destination <code>s1</code> simultaneously.</p>\n"}], "owner": {"reputation": 13191, "user_id": 4990642, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/xY0PD.jpg?s=128&g=1", "display_name": "snr", "link": "https://stackoverflow.com/users/4990642/snr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557926707, "creation_date": 1557925204, "question_id": 56150004, "link": "https://stackoverflow.com/questions/56150004/thread-safety-vs-atomicity-in-c", "title": "Thread-safety vs atomicity in C", "body": "<p>As far as I know, thread-safe functions can be called without needing to mutex or semaphore. Can't they?</p>\n\n<p>For example, <code>strcpy()</code> or <code>strdup()</code> is kinda thread safe function.</p>\n\n<p>But when I was reading the man-page, I saw the following and don't understand the saying along with the bolded example.</p>\n\n<blockquote>\n  <p>Being MT-Safe does not imply a function is atomic, nor that it\n                uses any of the memory synchronization mechanisms POSIX\n                exposes to users.  It is even possible that calling MT-Safe\n                functions in sequence does not yield an MT-Safe combination.\n                <strong>For example, having a thread call two MT-Safe functions one\n                right after the other does not guarantee behavior equivalent\n                to atomic execution of a combination of both functions, since\n                concurrent calls in other threads may interfere in a\n                destructive way.</strong></p>\n</blockquote>\n\n<p>Is the following usage wrong in a thread's function? If yes, what are the wrong points? If no, what is the meaning of quoted saying with the bolded one?</p>\n\n<pre><code>char *s1 = calloc(14, 1);\nchar *s2 = calloc(6, 1);\nchar *s3 = strdup(\"soner\");\nchar *s4 = strdup(\"stackoverflow\");\nstrcpy(s2, s3);\nstrcpy(s1, s4);\ns1[13] = s2[5] = 0;\n\nmutex_lock(&amp;mtx);\nprintf(\"%s %s\", s1, s2);\nfflush(stdout);\nmutex_unlock(&amp;mtx);\n\nfree(s1);\nfree(s2);\nfree(s3);\nfree(s4);\n</code></pre>\n"}, {"tags": ["c++", "c", "pointers", "structure", "fread"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557925396, "post_id": 56149988, "comment_id": 98929418, "body": "Post the code you tried.  It&#39;s impossible to know what&#39;s wrong without seeing your code."}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557926285, "post_id": 56149988, "comment_id": 98930003, "body": "@AndrewHenle Thanks for replying. Please check my code"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1557926541, "post_id": 56149988, "comment_id": 98930164, "body": "If you want to write the data with one fwrite call you&#39;ll need to construct a buffer in memory with the data in a suitable format as described in the answers below. You need to write the string data, not the pointer, and you need to know the length, neither of which is possible in one fwrite call using that struct."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1557926712, "post_id": 56149988, "comment_id": 98930294, "body": "You should choose one language which for this code looks like C."}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926766, "post_id": 56149988, "comment_id": 98930330, "body": "Thanks. c++ and c, both can fullfill my goal. hence thought of asking both experts"}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1557926843, "post_id": 56149988, "comment_id": 98930393, "body": "If you want a C++ answer then why are you using <code>fwrite</code> and <code>struct st varr;</code>?"}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926883, "post_id": 56149988, "comment_id": 98930422, "body": "using cstdlib header"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557926958, "post_id": 56149988, "comment_id": 98930467, "body": "You are writing pointer values to a file. This doesn&#39;t make sense. Read the chapter dealing with pointers in your C text book first."}], "answers": [{"comments": [{"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926036, "post_id": 56150141, "comment_id": 98929828, "body": "thanks for your reply. Is there any way i can write in one step? and also read in one step. Because, 2-3 steps is costing me much for several files in a loop. If it can happen in one read and write will optimize my code."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 1, "creation_date": 1557926129, "post_id": 56150141, "comment_id": 98929891, "body": "Nonsense. &quot;optimize my code&quot;. You are just lazy in typing? The above is the way to proceed."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 1, "creation_date": 1557926275, "post_id": 56150141, "comment_id": 98929998, "body": "@VishwadeepSingh You&#39;re asking <i>how</i> to do basic IO.  Don&#39;t worry about optimizing yet."}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557926393, "post_id": 56150141, "comment_id": 98930077, "body": "@AndrewHenle no, doing fwrite in one step is my goal, along with the string saved in char *"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 2, "creation_date": 1557926836, "post_id": 56150141, "comment_id": 98930388, "body": "@VishwadeepSingh Do you even know how <code>fwrite()</code> works and how to optimize that?  Do you know how your filesystem works and how to optimize that?  Do you know how your disk controller(s) work and how to optimize the way you do IO to take advantage of their particular performance characteristics?  Do you know how your disk(s) themselves work?  And if you do, do you know how much faster your &quot;optimized&quot; IO would be?  <b>Write clear, understandable code.</b>  Don&#39;t worry about optimizing until you have a known performance problem to solve. Then if it&#39;s an IO problem, go buy a faster disk."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557927246, "post_id": 56150141, "comment_id": 98930656, "body": "@VishwadeepSingh you cannot do this with a single <code>fwrite</code> and there are no &quot;tricks&quot;. Do as suggested in this answer, it&#39;s the best you can do. Worry about optimisation later. That&#39;s the professional way of approaching things. If the structure was with <code>char p[MAXLENTH]</code> instead of <code>char *p</code>, then, and only then you can do a single <code>fwrite</code> and a single <code>fread</code>."}], "tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 4, "last_activity_date": 1557927854, "last_edit_date": 1557927854, "creation_date": 1557925574, "answer_id": 56150141, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory/56150141#56150141", "title": "read structure from binary file having pointer pointed to memory", "body": "<p>There is no use writing this to a binary file. A text file would suffice.</p>\n\n<p>However, if this is your homework assignment (or so), I suggest you proceed as follows:</p>\n\n<ul>\n<li><p>write the length as an integer;</p></li>\n<li><p>write <code>len</code> bytes of the string. This does not include a terminating null.</p></li>\n</ul>\n\n<p>When reading back:</p>\n\n<ul>\n<li><p>read the integer length;</p></li>\n<li><p>allocate memory of this length <em>plus one byte</em></p></li>\n<li><p>read the string into that memory and <em>add the terminating null</em>.</p></li>\n</ul>\n\n<p>Fill your structure with this length and the pointer to allocated memory.</p>\n\n<hr>\n\n<p>In your comments you keep iterating you want to read and write in one step. <em>With your current data structure that is not possible</em> because the character string wil always be somewhere else in memory and <code>fwrite</code> can only write a contiguous block of memory.</p>\n\n<p>However, would you change your data structure to:</p>\n\n<pre><code>struct st{\n    char p[128];\n    int len;\n};\n</code></pre>\n\n<p>then you <em>can</em> write and read in one go because now the struct is a contiguous memory block. But now the string is limited to this 128 bytes(or any size you make it).</p>\n"}, {"comments": [{"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926113, "post_id": 56150154, "comment_id": 98929877, "body": "no saving the address will not help. Hence i am finding a way to write the whole structure in a binary in one fwrite, with the string as well. Is there any way i can do"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557926247, "post_id": 56150154, "comment_id": 98929970, "body": "Change <code>char *</code> to <code>char []</code>?"}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926342, "post_id": 56150154, "comment_id": 98930040, "body": "i cannot change the structure"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926405, "post_id": 56150154, "comment_id": 98930087, "body": "@VishwadeepSingh Then you have to have two <code>fwrite</code> ."}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557926471, "post_id": 56150154, "comment_id": 98930122, "body": "there cannot be any other way? @kiranBiradar"}, {"owner": {"reputation": 71, "user_id": 9102657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbcf538013f60f41df07644fcce36b9?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dipak", "link": "https://stackoverflow.com/users/9102657/luis-dipak"}, "edited": false, "score": 0, "creation_date": 1557926567, "post_id": 56150154, "comment_id": 98930180, "body": "Nope, mate: a) fwrite(  fp, &quot;%d&quot;, strlen(p) ); b) fputs(fp, p); or fwrite( fp, &quot;%s&quot;, p );"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926600, "post_id": 56150154, "comment_id": 98930206, "body": "@VishwadeepSingh Nope, you know the reason."}, {"owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "edited": false, "score": 0, "creation_date": 1557926818, "post_id": 56150154, "comment_id": 98930368, "body": "Thanks. I knew logically it is not possible. I thought any trick or something might be available."}], "tags": [], "owner": {"reputation": 71, "user_id": 9102657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cbcf538013f60f41df07644fcce36b9?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Dipak", "link": "https://stackoverflow.com/users/9102657/luis-dipak"}, "is_accepted": false, "score": 1, "last_activity_date": 1557925607, "creation_date": 1557925607, "answer_id": 56150154, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory/56150154#56150154", "title": "read structure from binary file having pointer pointed to memory", "body": "<p>I would suggest saving the strlen(p) first, followed by all the chars pointed by char *p. If you try to fwrite the struct as it is, you'll end up (in the file) with the value for the address with regrads to the first char. You do not want to save the address of the 1st char, do you?</p>\n"}, {"comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557928935, "post_id": 56150676, "comment_id": 98931754, "body": "It&#39;s your answer, so it&#39;s up to you to find a solution. It could be done with a similar trick as for the write part."}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": true, "score": 0, "last_activity_date": 1557935147, "last_edit_date": 1557935147, "creation_date": 1557927218, "answer_id": 56150676, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory/56150676#56150676", "title": "read structure from binary file having pointer pointed to memory", "body": "<p>If you are so much concerned about not having two <code>fwrite</code> you can have wrapper structure with zero length array.</p>\n\n<pre><code> struct st_wrap {\n         int len; \n         char p[0];\n };\n\nstruct st_wrap *temp= malloc (sizeof (struct st_wrap ) + strlen(varr.p)+1);\ntemp-&gt;len = strlen(varr.p);\n\n//Copy the data\nstrcpy(temp-&gt;p,varr.p);\n\n//Then write it to file\nfwrite(temp,sizeof(struct st_wrap)+strlen(varr.p),1,p);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1557931626, "last_edit_date": 1557931626, "creation_date": 1557930619, "answer_id": 56151813, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory/56151813#56151813", "title": "read structure from binary file having pointer pointed to memory", "body": "<p>Assuming you have written the length and string to binary file:</p>\n\n<pre><code>FILE* fp = fopen(\"file.bin\", \"wb\");\n\n/* writing */\nst str = { .p = \"foo\", .len = 3 };\nfwrite((char*)(&amp;str.len), sizeof(str.len), sizeof(str.len), fp);\nfwrite(str.p, str.len, str.len, fp);\n</code></pre>\n\n<p>You can now (in a different context) read the content from file into the struct object:</p>\n\n<pre><code>FILE* fp = fopen(\"file.bin\", \"rb\");\nst str;\n/* read length */\nfread((char*)&amp;str.len, sizeof(str.len), sizeof(str.len), fp);\n/* allocate enough space */\nstr.p = malloc((str.len + 1) * sizeof(char));\n/* read string */\nfread(str.p, str.len + 1, str.len + 1, fp);\n</code></pre>\n\n<p>Remember to free memory when you're done with <code>p</code>:</p>\n\n<pre><code>free(str.p);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1557989876, "creation_date": 1557989876, "answer_id": 56162521, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory/56162521#56162521", "title": "read structure from binary file having pointer pointed to memory", "body": "<p>I tried lot of ways, but @kiran Biradar's answer helped me a lot. hence displaying the working code here. </p>\n\n<p>WriteBinaryFile.cpp</p>\n\n<pre><code>    struct st_wrap {\n            int len;\n            int crc;\n            char p[0]; \n    };\n\n\n    int main ()\n    {\n            char p[100] = \"Hello World\";\n            struct st_wrap *temp= (struct st_wrap*) malloc (sizeof (struct st_wrap ) + strlen(p)+1);\n            temp-&gt;len = strlen(p);\n            temp-&gt;crc = 400;\n            strcpy(temp-&gt;p,p);\n            cout &lt;&lt; temp-&gt;p &lt;&lt; endl;\n            cout &lt;&lt; temp-&gt;len &lt;&lt; endl;\n            cout &lt;&lt; temp-&gt;crc &lt;&lt; endl;\n\n            FILE *p1;\n            p1=fopen(\"binary.dat\",\"wb\");\n            fwrite(temp,sizeof(struct st_wrap)+strlen(p),1,p1);\n            fclose(p1);\n\n    }\n</code></pre>\n\n<p>ReadBinaryFile.cpp</p>\n\n<pre><code>struct st_wrap {\n        int len;\n        int crc;\n        char p[0];\n};\n\n\nint main ()\n{\n        struct st_wrap *vw;\n        FILE *f=fopen(\"binary.dat\",\"rb\");\n        fseek(f, 0, SEEK_END);\n        long int filesize = ftell(f);\n        fseek(f, 0, SEEK_SET);\n        vw = (struct st_wrap*) malloc (filesize);\n        fread(vw,filesize,1,f);\n        cout &lt;&lt; vw-&gt;len &lt;&lt; endl;\n        cout &lt;&lt; vw-&gt;p &lt;&lt; endl;\n        cout &lt;&lt; vw-&gt;crc &lt;&lt; endl;\n        return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1025, "user_id": 1080000, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/KKv1g.jpg?s=128&g=1", "display_name": "Vishwadeep Singh", "link": "https://stackoverflow.com/users/1080000/vishwadeep-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 830, "favorite_count": 0, "accepted_answer_id": 56150676, "answer_count": 5, "score": 0, "last_activity_date": 1557989876, "creation_date": 1557925169, "last_edit_date": 1557926258, "question_id": 56149988, "link": "https://stackoverflow.com/questions/56149988/read-structure-from-binary-file-having-pointer-pointed-to-memory", "title": "read structure from binary file having pointer pointed to memory", "body": "<pre><code>struct st {\n        char *p;\n        int len;\n};\n</code></pre>\n\n<p>this is the structure which i need to write to a binary file, along with the string which is saved in </p>\n\n<p><code>char *p</code> </p>\n\n<p>I am supposed to write a binary file with the char array data. After writing to binary file. Is should also be able to read it in the same structure from binary file.</p>\n\n<p>I tried using FSEEK_END to get the binary size, and doing fread according to file size, but it is not saving string. Please suggest. Any help/suggestion/pointer would be appreciated.</p>\n\n<p>thanks in advance.</p>\n\n<p>sample code:</p>\n\n<pre><code> struct st {\n         char *p;\n         int len; \n };\n\n struct st varr;\n varr.len = 100;\n varr.p = new char[gen];\n strcpy(varr.p, \"Hello World\");\n\n FILE *p;\n p=fopen(\"address\",\"wb\");\n fwrite(&amp;varr,sizeof(struct st),1,p);\n fclose(p); \n</code></pre>\n\n<p>this will write me the pointer to the binary file. But i want to write here whole string, but the point is, it should done with one fwrite.</p>\n"}, {"tags": ["c++", "c", "linux", "shared-libraries"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1557924250, "post_id": 56149540, "comment_id": 98928630, "body": "Two-stage approach? Use a small, stable library for LD_PRELOAD, then load the big one from there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3458"}, "edited": false, "score": 0, "creation_date": 1557924260, "post_id": 56149540, "comment_id": 98928640, "body": "Also, why would updating a library crash whatever has it loaded? The running code keeps the old file open, the new code gets the new file."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557924299, "post_id": 56149540, "comment_id": 98928666, "body": "<i>otherwise they will crash on library replacement (which is expected)</i> Only if your update process overwrites the existing library.  Delete it first."}, {"owner": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "edited": false, "score": 0, "creation_date": 1557924422, "post_id": 56149540, "comment_id": 98928755, "body": "Arkadiy, Andrew, I tried deleting it first, but it crashes process anyway"}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 0, "creation_date": 1557924422, "post_id": 56149540, "comment_id": 98928756, "body": "Write the new library version to a temporary file (on the same disk) and move it into the correct place. Should be no risk of crashes (or anyone failing to load it)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557925261, "post_id": 56149540, "comment_id": 98929319, "body": "@hydrechan This seems relevant:  <a href=\"https://unix.stackexchange.com/questions/74165/how-to-upgrade-shared-library-without-crash\" title=\"how to upgrade shared library without crash\">unix.stackexchange.com/questions/74165/&hellip;</a>"}, {"owner": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557926465, "post_id": 56149540, "comment_id": 98930120, "body": "@AndrewHenle, yeah, I&#39;ve read it and this is exactly what I currently do: 1. unlink/rm existing one; 2. put new one into same location."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "edited": false, "score": 0, "creation_date": 1557924630, "post_id": 56149716, "comment_id": 98928884, "body": "I tried to unlink/delete original library before placing the update - still crashes the processes. Can I diagnose what is the actual cause of the crash - accessing mmapped file that was deleted or maybe something else?"}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "reply_to_user": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "edited": false, "score": 0, "creation_date": 1557925585, "post_id": 56149716, "comment_id": 98929541, "body": "gdb should be able to see it just fine as long as the process is still running. You could also keep a hard link to the old file around, or even just a copy."}, {"owner": {"reputation": 10709, "user_id": 3212865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B6qLg.jpg?s=128&g=1", "display_name": "spectras", "link": "https://stackoverflow.com/users/3212865/spectras"}, "reply_to_user": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "edited": false, "score": 3, "creation_date": 1557926447, "post_id": 56149716, "comment_id": 98930112, "body": "@hydrechan the normal upgrade process on all linux distributions involves replacing libraries that are being used by processes, and it never crashed one (the old one is kept around as an anonymous inode by the filesystem driver until it is no longer used). Something fishy is going on within your lib, and you should debug that."}, {"owner": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "edited": false, "score": 0, "creation_date": 1557926831, "post_id": 56149716, "comment_id": 98930380, "body": "I tried to make a test loop where it is being updated over and over, and it doesn&#39;t crash using either method (rm+cp, cp+mv). But this is artificial case because I&#39;m replacing old file with the identical copy. I will build multiple versions of the library and will try replacing versions randomly at high pace in the loop."}], "tags": [], "owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "is_accepted": false, "score": 1, "last_activity_date": 1557924418, "creation_date": 1557924418, "answer_id": 56149716, "question_id": 56149540, "link": "https://stackoverflow.com/questions/56149540/linux-shared-library-that-unloads-itself/56149716#56149716", "title": "Linux shared library that unloads itself", "body": "<p>I think you have some misunderstandings, and what you're asking for just doesn't make sense:</p>\n\n<blockquote>\n  <p>Inside my library ctor code, I check if the process I'm in is the one I need and do necessary hooking, otherwise it's a no-op and library is just a dead weight.</p>\n</blockquote>\n\n<p>And the work to unload it, rather than just leaving it there doing nothing, it <strong>more</strong> weight.</p>\n\n<blockquote>\n  <p>Unload is required for update procedure - if library is to be updated, it shouldn't be loaded into long-running processes - otherwise they will crash on library replacement (which is expected).</p>\n</blockquote>\n\n<p>This can only happen if you erroneously <em>overwrite</em> the library file, rather than <em>replacing</em> the file. The latter can be performed by installing a temp file to the same directory and performing the <code>rename</code> function (equivalently, the <code>mv</code> command) with the old file as the target.</p>\n\n<blockquote>\n  <p>And if there are other methods for automatically and reliably hooking glibc calls on the early stage</p>\n</blockquote>\n\n<p>Your focus on \"reliably\" sounds suspiciously close to wanting to use this mechanism to impose policy/access control in a way that potentially malicious applications can't get around. This is <strong>fundamentally impossible</strong> at the library level. You would need to run them in some kind of real sandbox to achieve that (e.g. by replacing the files with wrapper scripts that invoke them in the appropriate sandbox).</p>\n"}], "owner": {"reputation": 71, "user_id": 1091474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb8da284967d1bebe569fea7599473e8?s=128&d=identicon&r=PG", "display_name": "hydrechan", "link": "https://stackoverflow.com/users/1091474/hydrechan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557924418, "creation_date": 1557923866, "last_edit_date": 1557924041, "question_id": 56149540, "link": "https://stackoverflow.com/questions/56149540/linux-shared-library-that-unloads-itself", "title": "Linux shared library that unloads itself", "body": "<p>My goal is to hook several glibc functions inside a certain group of processes located at specific path. There are multiple methods to do so (gdb, strace, etc). But I need it to be made automatically and reliably on earliest stage so I won't miss a single call. So I decided to go with <code>LD_PRELOAD</code> method. And I need it to be done automatically without any user intervention, so injecting <code>LD_PRELOAD</code> into environment is kinda fragile and may be overridden by user. So I decided to specify my library inside <code>/etc/ld.so.preload</code> - this works just fine.</p>\n\n<p>Inside my library ctor code, I check if the process I'm in is the one I need and do necessary hooking, otherwise it's a no-op and library is just a dead weight.</p>\n\n<pre><code>__attribute__((constructor)) void my_lib_ctor()\n{\n  if (is_relevant_process())\n  {\n    do_the_wiring();\n  }\n}\n</code></pre>\n\n<p>The library does not export any symbols and everything inside is hidden by default (<code>-fvisibility=hidden</code> compiler flag), so there are no any real dependencies to my library from any process. So in case of injection into unrelated process it can be safely unloaded.</p>\n\n<p>Unload is required for update procedure - if library is to be updated, it shouldn't be loaded into long-running processes - otherwise they will crash on library replacement (which is expected). Processes of interest are short-lived and user-started, so impact on them is negligible.</p>\n\n<p>The problem is - I don't know how to unload it safely. I was thinking about <code>dlclose</code>, but calling it from the library itself will result it returning from the call back to the library code which will be already unloaded.</p>\n\n<p>And if there are other methods for <em>automatically and reliably</em> hooking glibc calls on the early stage (before app's <code>main()</code> execution) without touching the app of interest itself, I'll be glad if you let me know about them (slight modification of OS configs, e.g. preload, is OK). Thanks!</p>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1557923570, "post_id": 56149244, "comment_id": 98928228, "body": "You\u2019ll do it in two steps.  (1) Convert UTF8 to UTF32; (2) convert UTF32 to UTF16-LE.  Neither is particularly simple, though they\u2019re far from impossible.  Trying to combine them would lead to excruciating code."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10331124, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UcYvYUk0rDE/AAAAAAAAAAI/AAAAAAAAAAA/EmOcHrEwbxk/photo.jpg?sz=128", "display_name": "user10331124", "link": "https://stackoverflow.com/users/10331124/user10331124"}, "edited": false, "score": 0, "creation_date": 1558463800, "post_id": 56152008, "comment_id": 99107517, "body": "Thank you for the explanation could you please explain me a lil more about surrogate pairs if the input seq is F0 85 B6 BD what would the out put sequence be                                                                                                              F0:0b11110000    85:0b10000101      B6:0b10110110   BD:0b10111101   can this be taken in the same pattern as above  000 000101 110110 111101"}, {"owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "reply_to_user": {"reputation": 21, "user_id": 10331124, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UcYvYUk0rDE/AAAAAAAAAAI/AAAAAAAAAAA/EmOcHrEwbxk/photo.jpg?sz=128", "display_name": "user10331124", "link": "https://stackoverflow.com/users/10331124/user10331124"}, "edited": false, "score": 0, "creation_date": 1558469014, "post_id": 56152008, "comment_id": 99109649, "body": "It could be encoded as 3 bytes sequence in UTF-8, so it would be E5 B6 BD. Although your example gives the same result, it is not the shortest, you can consider it as an incorrect input. The code point is 0b101110110111101 = 0x5DBD, in UTF-16 it does not require an surrogate pair. So it would be just a single 16-bit word."}], "tags": [], "owner": {"reputation": 3648, "user_id": 4931630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4290ddd0630dd0091e3b9713a23c3434?s=128&d=identicon&r=PG&f=1", "display_name": "AterLux", "link": "https://stackoverflow.com/users/4931630/aterlux"}, "is_accepted": false, "score": 1, "last_activity_date": 1557931244, "creation_date": 1557931244, "answer_id": 56152008, "question_id": 56149244, "link": "https://stackoverflow.com/questions/56149244/concept-of-converting-from-utf8-to-utf16-le-the-math-operation-in-c-programming/56152008#56152008", "title": "concept of converting from UTF8 to UTF16 LE the math operation in c programming", "body": "<p>Basically, Unicode is a way to represent many as possible symbols in one continuous code space, the code of each symbol is usually called a \"<em>code point</em>\".\n<em>UTF-8</em> and <em>UTF-16</em> are just ways to encode and represent those code point in one or more octets (UTF-8) or 16-bit words (UTF-16), the latest can be represented as pair of octets in either <em>little-endian</em> (\"least significant first\" or \"Intel byte order\") or <em>big-endian</em> (\"most significant first\", or \"Motorola byte order\") sequence, which gives us two variants: UTF-16LE and UTF-16BE.</p>\n\n<p>First you need to do, is to extract the code point from the UTF-8 sequence. \nUTF-8 is encoded as follows:</p>\n\n<p><strong>0x00...0x7F</strong> encode symbol \"as-is\", it corresponds to standard ASCII symbols</p>\n\n<p>but, if most significant bit is set (i.e. <strong>0x80...0xFF</strong>), then it means that this is a sequence of several bytes, which all together encode the code point </p>\n\n<p>bytes from range <strong>0xC0...0xFF</strong> are on the first position of that sequence, in binary representation they will be:</p>\n\n<ul>\n<li>0b<strong>110xxxxx</strong> - 1 more byte follows and xxxxx are 5 most significant bits of the code point</li>\n<li>0b<strong>1110xxxx</strong> - 2 more bytes follow and xxxx are 4 most significant bits of the code point</li>\n<li>0b<strong>11110xxx</strong> - 3 more bytes...</li>\n<li>0b<strong>111110xx</strong> - 4 more bytes...</li>\n</ul>\n\n<p>There are no code points defined in Unicode standard, which require more than 5 UTF-8 bytes for now. </p>\n\n<p>following bytes are from range <strong>0x80...0xBF</strong> (i.e. 0b<strong>10xxxxxx</strong>) and encode next six bits (from most to least significant) from the code point value.</p>\n\n<p>So, looking at your example: E3 81 82 </p>\n\n<ul>\n<li>0xE3 == 0b<strong>1110</strong><em>0011</em> means there will be more 2 bytes in this code point and <em>0011</em> - are most significant bits of it</li>\n<li>0x81 == 0b<strong>10</strong><em>000001</em> means this is not the first byte in the code point sequence and it encodes next 6 bits: <em>000001</em></li>\n<li>0x82 == 0b<strong>10</strong><em>000010</em> means this is not the first byte in the code point sequence and it encodes next 6 bits: <em>000010</em></li>\n</ul>\n\n<p>i.e. result will be <em>0011 000001 000010</em> == <strong>0x3042</strong></p>\n\n<p><strong>UTF-16</strong> works the same way. Most usual code points are just encoded \"as-is\" but some large values are packed in so-called \"surrogate pairs\", which are combination of two 16-bit words:</p>\n\n<ul>\n<li>values from range <strong>0xD800...0xDBFF</strong> represents the first of them, its 10 lower bits are encoding 10 most significant bits of the resulting code point.</li>\n<li>values from range <strong>0xDC00...0xDFFF</strong> represents the second, its lower bits are encoding 10 least significant bits of the resulting code point.</li>\n</ul>\n\n<p>Surrogate pairs are required for values more than 0xFFFF (obvious) and for values 0xD800...0xDFFF - but this range is reserved in Unicode standard for surrogate pairs and there must no be such symbols.</p>\n\n<p>So, in our example <strong>0x3042</strong> does not hit that range and therefore requires only one 16-bit word.</p>\n\n<p>Since in your example UTF-16LE (little-endian) variant is given, that means, in the byte sequence first will be a least significant half of that word. I.e.</p>\n\n<p><strong>0x42 0x30</strong></p>\n"}], "owner": {"reputation": 21, "user_id": 10331124, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UcYvYUk0rDE/AAAAAAAAAAI/AAAAAAAAAAA/EmOcHrEwbxk/photo.jpg?sz=128", "display_name": "user10331124", "link": "https://stackoverflow.com/users/10331124/user10331124"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "closed_date": 1557942655, "answer_count": 1, "score": -3, "last_activity_date": 1557931244, "creation_date": 1557922841, "question_id": 56149244, "link": "https://stackoverflow.com/questions/56149244/concept-of-converting-from-utf8-to-utf16-le-the-math-operation-in-c-programming", "closed_reason": "Needs more focus", "title": "concept of converting from UTF8 to UTF16 LE the math operation in c programming", "body": "<p>I would like to know the concept of conversion from UTF8 to UTF16 LE </p>\n\n<p>for e.g \ninput sequence     E3 81 82\noutput sequence is   42 30     </p>\n\n<p>what is the actual arithmetic operation in this conversion.(I do not want to call in-built libraries)</p>\n"}, {"tags": ["c", "arrays", "sorting"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557922890, "post_id": 56149195, "comment_id": 98927776, "body": "Ultimately after sometime you will have out of bound access to <code>arr1</code> and <code>arr2</code> which will result in undefined behavior and you are seeing the result of it, that is <code>unsortedArray</code> contents are getting modified."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557922897, "post_id": 56149195, "comment_id": 98927783, "body": "A debugger is your best friend here. Yes we could help you, but learning to debug is a wonderful skil in programming!"}], "answers": [{"tags": [], "owner": {"reputation": 16436, "user_id": 10411602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b534549770aedbc4d7eb03a39d740f6?s=128&d=identicon&r=PG&f=1", "display_name": "Blaze", "link": "https://stackoverflow.com/users/10411602/blaze"}, "is_accepted": true, "score": 1, "last_activity_date": 1557923420, "last_edit_date": 1557923420, "creation_date": 1557923008, "answer_id": 56149293, "question_id": 56149195, "link": "https://stackoverflow.com/questions/56149195/why-unsortedarray-is-changing-while-my-code-running/56149293#56149293", "title": "Why unsortedArray is changing while my code running?", "body": "<p>You have undefined behavior because <code>arr2[9]</code> overflows. In your nested loop, this part</p>\n\n<pre><code>arr2[arr2Counter] = unsortedArray[i];\narr2Counter++;\n</code></pre>\n\n<p>Gets executed 36 times. As a result, you have out of bounds access, which causes undefined behavior. On my machine, <code>8 7 6 5 4 3 2 1</code> is printed, but the program then crashes because the stack is corrupted.</p>\n\n<p>Consider the logic of your program. The part inside <code>for (j = 0; j &lt; 9; j++) {</code> is executed a total of <code>72</code> times, and each time an entry is added to <code>arr1</code> or <code>arr2</code>. They can both hold <code>10</code> values each, so they can't hold all <code>72</code> values.</p>\n"}, {"tags": [], "owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "is_accepted": false, "score": 0, "last_activity_date": 1557923207, "creation_date": 1557923207, "answer_id": 56149349, "question_id": 56149195, "link": "https://stackoverflow.com/questions/56149195/why-unsortedarray-is-changing-while-my-code-running/56149349#56149349", "title": "Why unsortedArray is changing while my code running?", "body": "<p>Why is it changing? Because <code>arr1Counter</code> or <code>arr2Counter</code> (or both) can get bigger than the size of the arrays you use them to access.</p>\n\n<p>With less details:</p>\n\n<pre><code>   for (i = 0; i &lt; 9; i++){\n        for (j = 0; j &lt; 9; j++){\n             //maybe increment either here\n        }\n    }\n</code></pre>\n\n<p>That could go way above 9.\nSo, you can corrupt data.</p>\n"}], "owner": {"reputation": 21, "user_id": 10985493, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-94GSV7B96gY/AAAAAAAAAAI/AAAAAAAAAX0/r883hEGJmUs/photo.jpg?sz=128", "display_name": "Ashan shanaka", "link": "https://stackoverflow.com/users/10985493/ashan-shanaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 56149293, "answer_count": 2, "score": 1, "last_activity_date": 1557923420, "creation_date": 1557922679, "last_edit_date": 1557922711, "question_id": 56149195, "link": "https://stackoverflow.com/questions/56149195/why-unsortedarray-is-changing-while-my-code-running", "title": "Why unsortedArray is changing while my code running?", "body": "<p>I want to sort the given <code>unsortedArray</code> array. Before that I need to do following steps. But it always take the number 9 and then repeat number 8</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n\n    int unsortedArray[] = {9,8,7,6,5,4,3,2,1};\n\n    int arr1[9];\n    int arr2[9];\n\n    int arr1Counter = 0;\n    int arr2Counter = 0;\n\n    int i;int n;\n    for(i=0; i&lt;9; i++){\n\n        // n = unsortedArray[i];\n\n        int j;\n        for(j=0; j&lt;9; j++){\n\n            if(unsortedArray[j] != unsortedArray[i]){\n\n                if(unsortedArray[j] &gt; unsortedArray[i]){\n\n                    arr2[arr2Counter] = unsortedArray[i];\n                    arr2Counter++;\n\n                }else{\n\n                    arr1[arr1Counter] = unsortedArray[i];\n                    arr1Counter++;\n                }\n            }\n        }\n    }\n\n\n    int k;\n    for(k=0; k&lt;9; k++){\n        printf(\"%d \", unsortedArray[k]);\n    }\n\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "clang", "c11"], "comments": [{"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1557922308, "post_id": 56149041, "comment_id": 98927406, "body": "Not as far as I know. That would be useful, though."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557922319, "post_id": 56149041, "comment_id": 98927415, "body": "As usual I&#39;m very interested about why you need to do this? What is the real underlying problem you need to solve? Why do you think this is the natural solution to that problem? You&#39;re sure there&#39;s no other way to solve that problem?"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 5, "creation_date": 1557922325, "post_id": 56149041, "comment_id": 98927421, "body": "I donlt think that is possible because a macro is pre-processing, while typenames only become known during compilation."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1557922369, "post_id": 56149041, "comment_id": 98927442, "body": "You can use <code>_Generic</code> but it ain&#39;t pretty."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557922487, "post_id": 56149041, "comment_id": 98927506, "body": "@PaulOgilvie I don&#39;t need an integer constant expression usable in <code>#if</code> conditionals."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1557922494, "post_id": 56149041, "comment_id": 98927512, "body": "I&#39;ve found what I think is a good duplicate which shows you how to do this. If you think this is worth a stand-alone answer then please vote to reopen or ping me."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 2, "creation_date": 1557922597, "post_id": 56149041, "comment_id": 98927568, "body": "@Bathsheba - given <code>typedef int myInt;</code>  How does <code>_generic</code> help to determine if <code>myInt</code> is a type name before compilation?"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 3, "creation_date": 1557922629, "post_id": 56149041, "comment_id": 98927593, "body": "If you use an identifier in a context where the compiler expects a type, but it is not  a type. the compiler will diagnose an error.   That&#39;s it&#39;s job (among other things).  Since all you&#39;re doing with you hypothetical macro is a <code>_Static_Assert</code>, you&#39;re not achieving anything different.    So this strikes me as pointless - even if it was possible, which it doesn&#39;t appear to be."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1557922793, "post_id": 56149041, "comment_id": 98927705, "body": "@Bathsheba - what is closed?  (You have referenced some duplicate, but given no link.)"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1557922864, "post_id": 56149041, "comment_id": 98927748, "body": "@ryyker: I hammered it closed, incorrectly, some good soul has reopened it."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1557922881, "post_id": 56149041, "comment_id": 98927763, "body": "This was the reference: <a href=\"https://stackoverflow.com/questions/9804371/syntax-and-sample-usage-of-generic-in-c11/17290414#17290414\" title=\"syntax and sample usage of generic in c11\">stackoverflow.com/questions/9804371/&hellip;</a>"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1557922884, "post_id": 56149041, "comment_id": 98927768, "body": "@ryyker This was the proposed duplicate: <a href=\"https://stackoverflow.com/questions/9804371/syntax-and-sample-usage-of-generic-in-c11\" title=\"syntax and sample usage of generic in c11\">stackoverflow.com/questions/9804371/&hellip;</a> I don&#39;t think it is one so I reopened it :P.  (I&#39;m open to counter arguments.)"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 1, "creation_date": 1557923217, "post_id": 56149041, "comment_id": 98927998, "body": "@Peter My motivation was to wrap <code>_Alignas</code> with a macro that would simply do nothing if the suggested alignment (either type or integer expression) was less than the current one (normal <code>_Alignas</code> with a smaller alignment results in an error) and so I wanted to also accept either a typename or an integer expr, but now I&#39;m thinking simply requiring an integer expr (which you can always get from a typename by applying <code>_Alignof</code>) will be the simpler/clearer way to go."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1558090622, "post_id": 56149041, "comment_id": 98995200, "body": "Took me some time scratching my head, but it seems quite possible to do this, in compile-time, with pure standard C. Answer below."}], "answers": [{"comments": [{"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1558114831, "post_id": 56184944, "comment_id": 99007224, "body": "Nice solution! Thanks."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 4, "last_activity_date": 1558707113, "last_edit_date": 1558707113, "creation_date": 1558090316, "answer_id": 56184944, "question_id": 56149041, "link": "https://stackoverflow.com/questions/56149041/detecting-if-a-macro-argument-is-a-typename/56184944#56184944", "title": "Detecting if a macro argument is a typename", "body": "<p>In order to do this, you will need to check if the parameter is of type integer, and you need to check if it is a type or an expression. </p>\n\n<hr>\n\n<p><strong>Checking if a macro parameter, that may be a type or an expression, is of integer type:</strong></p>\n\n<p>This can be done with <code>_Generic</code>. A <code>_Generic</code> expression cannot contain two types that are identical, so it should suffice if you compare against all the stdint.h types only. Since these will alias with the default integer types, but not collide with each other (like for example <code>int</code> and <code>long</code> might).</p>\n\n<p>Now <code>_Generic</code> doesn't accept a type as operand, so you have to tweak the input to always become an expression.</p>\n\n<p>The trick that I invented just now, is to use the ambiguity between the parenthesis operator and the cast operator, and at the same time use the ambiguity between unary + and binary + operators.</p>\n\n<p>Given <code>(x)+0</code>. </p>\n\n<ul>\n<li>If <code>x</code> is a type, <code>()</code> becomes the cast operator and <code>+0</code> is the unary addition operator applied to an integer constant.</li>\n<li>If <code>x</code> is an expression, it will get parenthesized and then <code>+</code> is the binary addition operator. </li>\n</ul>\n\n<p>So you can do:</p>\n\n<pre><code>#define IS_INT(x) _Generic((x)+0, \\\n  uint8_t:  1, int8_t:  1,        \\\n  uint16_t: 1, int16_t: 1,        \\\n  uint32_t: 1, int32_t: 1,        \\\n  uint64_t: 1, int64_t: 1,        \\\n  default: 0)\n</code></pre>\n\n<p>This will work for all integer, character and float types, as well as pointers. It will not work on struct/union types (compiler error). It will not work with <code>void*</code> and probably not with <code>NULL</code> (compiler error, can't do pointer arithmetic).</p>\n\n<hr>\n\n<p><strong>Checking if a macro parameter, that may be a type or an expression, is an expression:</strong></p>\n\n<p>This can also be done using the same trick as above, use the ambiguity between different operators. For example:</p>\n\n<pre><code>#define IS_EXPR(x) (!!(x) + !(x) + 1 == 2)\n</code></pre>\n\n<ul>\n<li>If <code>x</code> is a non-zero integer constant expression, we get <code>1 + 0 + 1 = 2</code>.</li>\n<li>If <code>x</code> is a zero integer constant expression, we get <code>0 + 1 + 1 = 2</code>.</li>\n<li>If <code>x</code> is a type, we get <code>!!(int)+!(int)+1</code> which equals <code>0</code>. Both + are unary.</li>\n</ul>\n\n<p>This doesn't make a difference between float and integers though, so we need to combine this trick with the <code>IS_INT</code> macro.</p>\n\n<hr>\n\n<p><strong>Solution:</strong></p>\n\n<pre><code>#define IS_INTCONSTEXPR(x) ( IS_INT(x) &amp;&amp; IS_EXPR(x) )\n</code></pre>\n\n<p>Complete example with test cases, printing 1 if integer constant expression, otherwise 0:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n\n#define IS_INT(x) _Generic((x)+0, \\\n  uint8_t:  1, int8_t:  1,        \\\n  uint16_t: 1, int16_t: 1,        \\\n  uint32_t: 1, int32_t: 1,        \\\n  uint64_t: 1, int64_t: 1,        \\\n  default: 0)\n\n#define IS_EXPR(x) (!!(x) + !(x) + 1 == 2)\n\n#define IS_INTCONSTEXPR(x) ( IS_INT(x) &amp;&amp; IS_EXPR(x) )\n\n\n#define test(arg) printf(\"%d %s\\n\", IS_INTCONSTEXPR(arg),(#arg))\n\nint main (void)\n{\n  test(42);\n  test(sizeof(int));\n  test(1+1);\n  test(int);\n  test(unsigned int);\n  test(42.0);\n  test(double);\n  test(uint32_t);\n  test(uint32_t*);\n  test(_Bool);\n\n  _Static_assert( !IS_INTCONSTEXPR(int), \"\" ); // OK, passed\n  _Static_assert( IS_INTCONSTEXPR(42), \"\" );   // OK, passed\n\n  return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 42\n1 sizeof(int)\n1 1+1\n0 int\n0 unsigned int\n0 42.0\n0 double\n0 uint32_t\n0 uint32_t*\n0 _Bool\n</code></pre>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 1, "accepted_answer_id": 56184944, "answer_count": 1, "score": 10, "last_activity_date": 1558707113, "creation_date": 1557922143, "last_edit_date": 1557923664, "question_id": 56149041, "link": "https://stackoverflow.com/questions/56149041/detecting-if-a-macro-argument-is-a-typename", "title": "Detecting if a macro argument is a typename", "body": "<p>Within C11/gnuC11 is it possible to write a macro that returns an integer constant expression of value 1 or 0 respectively if the macro argument is or isn't a type name or at least a macro can distinguish between integer constant expressions and typenames (i.e., if can detect the argument isn't one of these, it can assume it is the other)?</p>\n\n<pre><code>#define IS_TYPENAME(X) /*???*/ \n_Static_assert( IS_TYPENAME(int), \"\" );\n_Static_assert( !IS_TYPENAME(42), \"\" );\n</code></pre>\n\n<p>Motivation:</p>\n\n<p>My motivation was to wrap <code>_Aligna</code>s with a macro that would simply do nothing if the suggested alignment (either type or integer expression) was less than the current one (normal <code>_Alignas</code> with a smaller alignment results in an error) and so I wanted to also accept either a typename or an integer expr, but now I'm thinking simply requiring an integer expr (which you can always get from a typename by applying <code>_Alignof</code>) will be the simpler/clearer way to go. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557921693, "post_id": 56148862, "comment_id": 98927004, "body": "What is the relation between <code>31 to 30</code> , <code>31 to 20</code> ..so on?"}, {"owner": {"reputation": 4476, "user_id": 2058293, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3798efb3cfd8001e14b637ea09fd2e70?s=128&d=identicon&r=PG", "display_name": "aaaaaa123456789", "link": "https://stackoverflow.com/users/2058293/aaaaaa123456789"}, "edited": false, "score": 0, "creation_date": 1557921939, "post_id": 56148862, "comment_id": 98927183, "body": "While I don&#39;t think it&#39;s possible to do what you want, you should know that it&#39;s almost certainly a better idea to just write <code>31 - 30</code> than to use a macro for it."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1557921997, "post_id": 56148862, "comment_id": 98927215, "body": "<i>Because of backwards compatibility...</i>  Can you just leave the legacy code (macros), so existing clients needing it, have it, but then define your new generalized macros for newer processes.  Both can co-exist."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 1, "creation_date": 1557922390, "post_id": 56148862, "comment_id": 98927457, "body": "Sadly, no. Macros can&#39;t define other macros."}, {"owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "reply_to_user": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1558513979, "post_id": 56148862, "comment_id": 99122367, "body": "@JL2210 Could you add that as answer?"}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1558525517, "post_id": 56148862, "comment_id": 99128795, "body": "Sure. I&#39;ll do that."}], "answers": [{"tags": [], "owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "is_accepted": true, "score": 1, "last_activity_date": 1558525521, "creation_date": 1558525521, "answer_id": 56256123, "question_id": 56148862, "link": "https://stackoverflow.com/questions/56148862/generalize-qx-to-qy-macro/56256123#56256123", "title": "Generalize Qx_TO_Qy macro?", "body": "<p>Sadly, no. Macros cannot define other macros.</p>\n"}], "owner": {"reputation": 6534, "user_id": 1202172, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8587094fc4666bee5d5852f163e6f86b?s=128&d=identicon&r=PG", "display_name": "Danijel", "link": "https://stackoverflow.com/users/1202172/danijel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56256123, "answer_count": 1, "score": 0, "last_activity_date": 1558525521, "creation_date": 1557921559, "question_id": 56148862, "link": "https://stackoverflow.com/questions/56148862/generalize-qx-to-qy-macro", "title": "Generalize Qx_TO_Qy macro?", "body": "<p>I am using a bunch of macros of type:</p>\n\n<pre><code>#define Q31_TO_Q30 (31-30)\n#define Q31_TO_Q20 (31-20)\n#define Q25_TO_Q15 (25-15)\netc. \n</code></pre>\n\n<p>I would like to generalize this without having to manualy add each case. <code>Q</code>s go from 1 to 31, so there would be huge number of lines to cover all cases. </p>\n\n<p><code>#define Q_TO_Q(x,y) (x-y)</code> seems easy, but I would like to continue using the same <code>Qx_TO_Qy</code> syntax because of the \"backwards compatibility\". </p>\n\n<p>Is some kind of macro magic possible that would achieve this? </p>\n"}, {"tags": ["c", "struct", "storage-class-specifier"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1557922356, "post_id": 56148754, "comment_id": 98927434, "body": "I have added it as an answer, we shall not answer a question with a comment."}], "answers": [{"comments": [{"owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1557922878, "post_id": 56149086, "comment_id": 98927760, "body": "The declaration works, but when I use <code>name</code> like <code>name.a = 1</code>, it shows error saying <code>unknown type name \u2018name\u2019</code>. Also, I am doing this globally."}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1557924259, "post_id": 56149086, "comment_id": 98928638, "body": "Cannot reproduce: <a href=\"https://ideone.com/M9KatR\" rel=\"nofollow noreferrer\">ideone.com/M9KatR</a> Can you make a full example?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "reply_to_user": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "edited": false, "score": 0, "creation_date": 1557924992, "post_id": 56149086, "comment_id": 98929151, "body": "<code>name.a = 5;</code> can only be in a function. Do you want to initialize it?"}], "tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": true, "score": 3, "last_activity_date": 1557925810, "last_edit_date": 1557925810, "creation_date": 1557922315, "answer_id": 56149086, "question_id": 56148754, "link": "https://stackoverflow.com/questions/56148754/how-to-specify-storage-class-specifier-for-an-object-of-struct-without-a-name/56149086#56149086", "title": "How to specify storage class specifier for an object of struct without a name?", "body": "<p>use the word <code>static</code> in front of it:</p>\n\n<pre><code>static struct{\n    int a;\n    char b[100];\n} name;\n</code></pre>\n\n<p>This will declare a variable named <code>name</code> with the type <code>struct { ... }</code> and the storage class specifier <code>static</code>.</p>\n\n<p>To initialize the member of the <code>struct</code>, you can use</p>\n\n<pre><code>static struct{\n    int a;\n    char b[100];\n} name = {5};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1557925746, "creation_date": 1557925746, "answer_id": 56150191, "question_id": 56148754, "link": "https://stackoverflow.com/questions/56148754/how-to-specify-storage-class-specifier-for-an-object-of-struct-without-a-name/56150191#56150191", "title": "How to specify storage class specifier for an object of struct without a name?", "body": "<p>If you want to initialize a structure members having <code>static</code> storage in file scope, you can do something like</p>\n\n<pre><code>static struct{\n    int a;\n    char b[100];\n} name = {.a=5, .b = \"test1\"};\n</code></pre>\n"}], "owner": {"reputation": 4073, "user_id": 11498773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d317da8c76af3f45f63986e9783740?s=128&d=identicon&r=PG&f=1", "display_name": "Mihir", "link": "https://stackoverflow.com/users/11498773/mihir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 56149086, "answer_count": 2, "score": 2, "last_activity_date": 1557925810, "creation_date": 1557921176, "question_id": 56148754, "link": "https://stackoverflow.com/questions/56148754/how-to-specify-storage-class-specifier-for-an-object-of-struct-without-a-name", "title": "How to specify storage class specifier for an object of struct without a name?", "body": "<p>I am using a struct like:</p>\n\n<pre><code>struct{\n    int a;\n    char b[100];\n}name;\n</code></pre>\n\n<p>I want to use <code>static</code> storage class specifier on <code>name</code>.\nHow can I do that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557920775, "post_id": 56148540, "comment_id": 98926444, "body": "Is the code you show <i>working?</i> Then I think this question would be a better match on <a href=\"https://codereview.stackexchange.com/tour\">the Code Review SE</a>."}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557920844, "post_id": 56148540, "comment_id": 98926490, "body": "@Someprogrammerdude Ok, how do we move it over?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557920900, "post_id": 56148540, "comment_id": 98926517, "body": "Unfortunately there&#39;s no way to move it automatically. You have to delete it here and post it anew there."}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557920921, "post_id": 56148540, "comment_id": 98926530, "body": "@Someprogrammerdude ok will do"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1557926533, "post_id": 56148540, "comment_id": 98930162, "body": "@jaycodez: I downvoted your question because it is unclear, too broad, and not really fit here. There is no objective answer to any &quot;what is the best way&quot; question."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557955057, "post_id": 56148540, "comment_id": 98944470, "body": "The question is actually about how do I move from using storage in a fixed size array to using dynamically allocated storage to remove the fixed size limitation. It was clear from the predecessor question, but perhaps could have been made more clear here."}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1557926859, "last_edit_date": 1557926859, "creation_date": 1557920951, "answer_id": 56148665, "question_id": 56148540, "link": "https://stackoverflow.com/questions/56148540/how-to-apply-memory-allocation-to-a-c-program-which-counts-the-amount-of-words-i/56148665#56148665", "title": "How to apply Memory Allocation to a C Program which counts the amount of words in a list? (eg. malloc, calloc, free)", "body": "<blockquote>\n  <p>However, what is the best way to set memory allocation to this code so that C (Programming Language) does not run out of memory. </p>\n</blockquote>\n\n<p>Notice that most computers, even cheap laptops, have quite a lot of RAM. In practice, you could expect to be able to allocate at least a gigabyte of memory. That is a lot for textual file processing! </p>\n\n<p>A large human-written text file is the Bible. As a rule of thumb, that text takes about 16 megabytes (to a factor of two). For most computers, that is a quite small amount of memory today (my AMD2970WX has more than that in its <a href=\"https://en.wikipedia.org/wiki/CPU_cache\" rel=\"nofollow noreferrer\">CPU cache</a>).</p>\n\n<blockquote>\n  <p>Is it best to use linked lists?</p>\n</blockquote>\n\n<p>The practical consideration is more algorithmic <a href=\"https://en.wikipedia.org/wiki/Time_complexity\" rel=\"nofollow noreferrer\">time complexity</a> than memory consumption. For example, searching something in a linked list has linear time. And going thru a list of a million words does take some time (even if computers are fast).</p>\n\n<p>You may want to read more about:</p>\n\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Flexible_array_member\" rel=\"nofollow noreferrer\">flexible array members</a> (use that instead in your <code>word_t</code>).</li>\n<li>string duplication routines like <a href=\"http://man7.org/linux/man-pages/man3/strdup.3.html\" rel=\"nofollow noreferrer\">strdup</a> or <a href=\"http://man7.org/linux/man-pages/man3/asprintf.3.html\" rel=\"nofollow noreferrer\">asprintf</a>. Even if you don't have them, reprogramming them is a fairly easy task.</li>\n</ul>\n\n<p>But you still want to avoid <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow noreferrer\">memory leaks</a> and also, and even more importantly, <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>.</p>\n\n<p>Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\"><em>How to debug small programs</em></a>.  Tools like <a href=\"https://valgrind.org/\" rel=\"nofollow noreferrer\">valgrind</a>, the <a href=\"http://clang-analyzer.llvm.org/\" rel=\"nofollow noreferrer\">clang static analyzer</a>, the <a href=\"https://sourceware.org/gdb/current/onlinedocs/gdb/\" rel=\"nofollow noreferrer\"><code>gdb</code> debugger</a>, the <a href=\"https://en.wikipedia.org/wiki/AddressSanitizer\" rel=\"nofollow noreferrer\">address sanitizer</a>, etc.. are very useful to learn and use.</p>\n\n<p>At last, read carefully, and in full, Norvig's <a href=\"http://norvig.com/21-days.html\" rel=\"nofollow noreferrer\"><em>Teach yourself programming in 10 years</em></a>. That text is thought provoking, and its appendix at least is surprisingly close to your questions.</p>\n\n<p>PS. I leave you to guess and estimate the total amount of text, in bytes, you are capable of reading during your entire life. That size is surprisingly small and probably fits in any smartphone today. On today's devices, text is really cheap. Photos and videos are not.</p>\n\n<p>NB. \"What is the best way\" types of question are too broad, off-topic here, matter of opinion, and related to <a href=\"https://en.wikipedia.org/wiki/P_versus_NP_problem\" rel=\"nofollow noreferrer\">P vs NP</a> question. <a href=\"https://en.wikipedia.org/wiki/Rice%27s_theorem\" rel=\"nofollow noreferrer\">Rice's theorem</a> and to the <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">halting problem</a>. These questions usually have no clear answer and are supposed to be unsolvable: it is often difficult to prove that a better answer could not be thought of in a dozen of years (even if, for <em>some</em> such questions, you could get a proof today: e.g. sorting is proved today to require at least <em>O(n log n)</em> time.).</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 0, "last_activity_date": 1557955781, "last_edit_date": 1557955781, "creation_date": 1557953377, "answer_id": 56157427, "question_id": 56148540, "link": "https://stackoverflow.com/questions/56148540/how-to-apply-memory-allocation-to-a-c-program-which-counts-the-amount-of-words-i/56157427#56157427", "title": "How to apply Memory Allocation to a C Program which counts the amount of words in a list? (eg. malloc, calloc, free)", "body": "<p>Since you already have an answer using a fixed-size array of struct to hold the information, changing from using the fixed-size array where storage is automatically reserved for you on the stack, to dynamically allocated storage where you can <code>realloc</code> as needed, simply requires initially declaring a pointer-to-type rather than array-of-type, and then allocating storage for each struct.</p>\n\n<p>Where before, with a fixed-size array of 512 elements you would have:</p>\n\n<pre><code>#define MAX_WORDS   512     /* max number of words */\n...\n    /* Array of struct of distinct words, initialized all zero */\n    words_t words[MAX_WORDS] = {{ .word = \"\" }};\n</code></pre>\n\n<p>When dynamically allocating, simply declare a pointer-to-type and provide an initial allocation of some reasonable number of elements, e.g.</p>\n\n<pre><code>#define MAX_WORDS     8     /* initial number of struct to allocate */\n...\n    /* pointer to allocated block of max_words struct initialized zero */\n    words_t *words = calloc (max_words, sizeof *words);\n</code></pre>\n\n<p>(<strong>note:</strong> you can allocate with either <code>malloc, calloc or realloc</code>, but only <code>calloc</code> allocates and also sets all bytes zero. In your case since you want the <code>.cap</code> and <code>.count</code> members initialized zero, <code>calloc</code> is a sensible choice)</p>\n\n<p>It's worth pausing a bit to understand whether you use a fixed size array or an allocated block of memory, you are accessing your data through a pointer to the first element. The only real difference is the compiler reserving storage for your array on the stack with a fixed array, and you being responsible for reserving storage for it through allocation. </p>\n\n<p>Access to the elements will be exactly the same because on access, an array is converted to a pointer to the first element. See: <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.3.2.1p3\" rel=\"nofollow noreferrer\">C11 Standard - 6.3.2.1 Other Operands - Lvalues, arrays, and function designators(p3)</a>  Either way you access the memory through a pointer to the first element. When dynamically allocating, you are assigning the address of the first element to your pointer rather than the compiler reserving storage for the array. Whether it is an array with storage reserved for you, or you declare a pointer and assign an allocated block of memory to it -- how you access the elements will be identical. (pause done)</p>\n\n<p>When you allocate, it is up to you to <strong><em>validate</em></strong> that the allocation succeeds. So you would follow your allocation with:</p>\n\n<pre><code>    if (!words) {   /* valdiate every allocation */\n        perror (\"calloc-words\");\n        exit (EXIT_FAILURE);\n    }\n</code></pre>\n\n<p>You are already keeping track of <code>index</code> telling you how many struct you have <em>filled</em>, you simply need to add one more variable to track how many struct are <em>available</em> (<code>size_t max_words = MAX_WORDS;</code> gives you the 2nd variable set to the initial allocation size <code>MAX_WORDS</code>). So your test for <em>\"Do I need to <code>realloc</code> now?\"</em> is simply when <em>filled == available</em>, or in your case <code>if (index == max_words)</code>.</p>\n\n<p>Since you now have the ability to <code>realloc</code>, your read loop no longer has to protect your array bounds and you can simply read each word in the file, e.g.</p>\n\n<pre><code>    while (fscanf (fptr, \"%s\", word) == 1) {  /* while valid word read */\n        int iscap = 0, isunique = 1;    /* is captial, is unique flags */\n        ...\n</code></pre>\n\n<p>Now all that remains is the <code>index == max_words</code> test <strong><em>before</em></strong> you fill another element. You can either place the test and <code>realloc</code> before the <code>for</code> and <code>if</code> blocks for handling <code>isunique</code>, which is fine, or you can actually place it within the <code>if (isunique)</code> block since technically unless you are adding a unique word, no <code>realloc</code> will be required. The only difference it makes is a corner-case where <code>index == max_words</code> and you call <code>realloc</code> before your <code>for</code> loop where the last word is not-unique, you may make one call to <code>realloc</code> where it wasn't technically required (think through that).</p>\n\n<p>To prevent that one <code>realloc</code> too many, place the test and <code>realloc</code> immediately before the new element will be filled, e.g.</p>\n\n<pre><code>        if (isunique) { /* if unique, add to array, increment index */\n            if (index == max_words) {       /* is realloc needed? */\n                /* always use a temporary pointer with realloc */\n                void *tmp = realloc (words, 2 * max_words * sizeof *words);\n                if (!tmp) {\n                    perror (\"realloc-words\");\n                    break;  /* don't exit, original data still valid */\n                }\n                words = tmp;    /* assign reallocated block to words */\n                /* (optional) set all new memory to zero */\n                memset (words + max_words, 0, max_words * sizeof *words);\n                max_words *= 2; /* update max_words to reflect new limit */\n            }\n            memcpy (words[index].word, word, len + 1);  /* have len */\n            if (iscap)                      /* if cap flag set */\n                words[index].cap = iscap;   /* set capital flag in struct */\n            words[index++].count++;         /* increment count &amp; index */\n        }\n</code></pre>\n\n<p>Now let's look closer at the reallocation itself, e.g.</p>\n\n<pre><code>            if (index == max_words) {       /* is realloc needed? */\n                /* always use a temporary pointer with realloc */\n                void *tmp = realloc (words, 2 * max_words * sizeof *words);\n                if (!tmp) { /* validate every allocation */\n                    perror (\"realloc-words\");\n                    break;  /* don't exit, original data still valid */\n                }\n                words = tmp;    /* assign reallocated block to words */\n                /* (optional) set all new memory to zero */\n                memset (words + max_words, 0, max_words * sizeof *words);\n                max_words *= 2; /* update max_words to reflect new limit */\n            }\n</code></pre>\n\n<p>The <code>realloc</code> call itself is <code>void *tmp = realloc (words, 2 * max_words * sizeof *words);</code>. Why not just <code>words = realloc (words, 2 * max_words * sizeof *words);</code>? Answer: You <strong>Never</strong> <code>realloc</code> the pointer itself, and <strong>always</strong> use a temporary pointer. Why? <code>realloc</code> allocates new storage, copies the existing data to the new storage and then calls <code>free()</code> on the old block of memory. When (not If) <code>realloc</code> fails, it returns <code>NULL</code> and does not touch the old block of memory. If you blindly assign <code>NULL</code> to your exiting pointer <code>words</code>, you have just overwritten the address to your old block of memory with <code>NULL</code> creating a memory-leak because you no longer have a reference to the old block of memory and it cannot be freed. So lesson learned, <em>Always <code>realloc</code> with a temporary pointer!</em></p>\n\n<p>If <code>realloc</code> succeeds, what then? Pay close attention to the lines:</p>\n\n<pre><code>                words = tmp;    /* assign reallocated block to words */\n                /* (optional) set all new memory to zero */\n                memset (words + max_words, 0, max_words * sizeof *words);\n                max_words *= 2; /* update max_words to reflect new limit */\n</code></pre>\n\n<p>The first simply assigns the address for the new block of memory created and filled by <code>realloc</code> to your <code>words</code> pointer. (`words now points to a block of memory with twice as many elements as it had before). </p>\n\n<p>The second line -- recall, <code>realloc</code> and <code>malloc</code> do not initialize the new memory to zero, if you want to initialize the memory zero, (which for your <code>.cap</code> and <code>.count</code> members is really helpful, you have to do that yourself with <code>memset</code>. So what needs to be set to zero? All the memory what wasn't in your original block. Where is that? Well, it starts at <code>words + max_words</code>. How many zeros do I have to write? You have to fill all memory above <code>words + max_words</code> to the end of the block. Since you doubled the size, you simply have to zero what was the original size starting at <code>words + max_words</code> which is <code>max_words * sizeof *words</code> bytes of memory. (remember we used <code>2 * max_words * sizeof *words</code> as the new size, and we <em>have NOT</em> updated <code>max_words</code> yet, so it still holds the original size)</p>\n\n<p>Lastly, now it is time to update <code>max_words</code>. Here just make it match whatever you added to your allocation in <code>realloc</code> above. I simply doubled the size of the current allocation each time <code>realloc</code> is called, so to update <code>max_words</code> to the new allocation size, you simply multiply by <code>2</code> with <code>max_words *= 2;</code>. You can add as little or a much memory as you like each time. You could scale by <code>3/2.</code>, you could add a fixed number of elements (say <code>10</code>), it is completely up to you, but avoid calling <code>realloc</code> to add 1-element each time. You can do it, but allocation and reallocation are relatively expensive operations, so better to add a reasonably sized block each time you <code>realloc</code>, and doubling is a reasonable balance between memory growth and the number of times <code>realloc</code> is called.</p>\n\n<p>Putting it altogether, you could do:</p>\n\n<pre><code>/**\n * C program to count occurrences of all words in a file.\n */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;limits.h&gt;\n\n#define MAX_WORD     50     /* max word size */\n#define MAX_WORDS     8     /* initial number of struct to allocate */\n\n#ifndef PATH_MAX\n#define PATH_MAX   2048     /* max path (defined for Linux in limits.h) */\n#endif\n\ntypedef struct {            /* use a struct to hold */\n    char word[MAX_WORD];    /* lowercase word, and */\n    int cap, count;         /* if it appeast capitalized, and its count */\n} words_t;\n\nchar *strlwr (char *str)    /* no need for unsigned char */\n{\n    char *p = str;\n\n    while (*p) {\n        *p = tolower(*p);\n        p++;\n    }\n\n    return str;\n}\n\nint main (void) {\n\n    FILE *fptr;\n    char path[PATH_MAX], word[MAX_WORD];\n    size_t i, len, index = 0, max_words = MAX_WORDS;\n\n    /* pointer to allocated block of max_words struct initialized zero */\n    words_t *words = calloc (max_words, sizeof *words);\n    if (!words) {   /* valdiate every allocation */\n        perror (\"calloc-words\");\n        exit (EXIT_FAILURE);\n    }\n\n    /* Input file path */\n    printf (\"Enter file path: \");\n    if (scanf (\"%s\", path) != 1) {  /* validate every input */\n        fputs (\"error: invalid file path or cancellation.\\n\", stderr);\n        return 1;\n    }\n\n    fptr = fopen (path, \"r\");   /* open file */\n    if (fptr == NULL) {         /* validate file open */\n        fputs ( \"Unable to open file.\\n\"\n                \"Please check you have read privileges.\\n\", stderr);\n        exit (EXIT_FAILURE);\n    }\n\n    while (fscanf (fptr, \"%s\", word) == 1) {  /* while valid word read */\n        int iscap = 0, isunique = 1;    /* is captial, is unique flags */\n\n        if (isupper (*word))            /* is the word uppercase */\n            iscap = 1;\n\n        /* remove all trailing punctuation characters */\n        len = strlen (word);                    /* get length */\n        while (len &amp;&amp; ispunct(word[len - 1]))   /* only if len &gt; 0 */\n            word[--len] = 0;\n\n        strlwr (word);                  /* convert word to lowercase */\n\n        /* check if word exits in list of all distinct words */\n        for (i = 0; i &lt; index; i++) {\n            if (strcmp(words[i].word, word) == 0) {\n                isunique = 0;               /* set unique flag zero */\n                if (iscap)                  /* if capital flag set */\n                    words[i].cap = iscap;   /* set capital flag in struct */\n                words[i].count++;           /* increment word count */\n                break;                      /* bail - done */\n            }\n        }\n        if (isunique) { /* if unique, add to array, increment index */\n            if (index == max_words) {       /* is realloc needed? */\n                /* always use a temporary pointer with realloc */\n                void *tmp = realloc (words, 2 * max_words * sizeof *words);\n                if (!tmp) { /* validate every allocation */\n                    perror (\"realloc-words\");\n                    break;  /* don't exit, original data still valid */\n                }\n                words = tmp;    /* assign reallocated block to words */\n                /* (optional) set all new memory to zero */\n                memset (words + max_words, 0, max_words * sizeof *words);\n                max_words *= 2; /* update max_words to reflect new limit */\n            }\n            memcpy (words[index].word, word, len + 1);  /* have len */\n            if (iscap)                      /* if cap flag set */\n                words[index].cap = iscap;   /* set capital flag in struct */\n            words[index++].count++;         /* increment count &amp; index */\n        }\n    }\n    fclose (fptr);  /* close file */\n\n    /*\n     * Print occurrences of all words in file.\n     */\n    puts (\"\\nOccurrences of all distinct words with Cap in file:\");\n    for (i = 0; i &lt; index; i++) {\n        if (words[i].cap) {\n            strcpy (word, words[i].word);\n            *word = toupper (*word);\n            /*\n             * %-15s prints string in 15 character width.\n             * - is used to print string left align inside\n             * 15 character width space.\n             */\n            printf(\"%-15s %d\\n\", word, words[i].count);\n        }\n    }\n    free (words);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Where with your sample data you would get:</p>\n\n<pre><code>$ ./bin/unique_words_with_cap_dyn\nEnter file path: dat/girljumped.txt\n\nOccurrences of all distinct words with Cap in file:\nAny             7\nOne             4\nSome            10\nThe             6\nA               13\n</code></pre>\n\n<p><strong>Memory Use/Error Check</strong></p>\n\n<p>In any code you write that dynamically allocates memory, you have 2 <em>responsibilities</em> regarding any block of memory allocated: (1) <em>always preserve a pointer to the starting address</em> for the block of memory so, (2) it can be <em>freed</em> when it is no longer needed.</p>\n\n<p>It is imperative that you use a memory error checking program to insure you do not attempt to access memory or write beyond/outside the bounds of your allocated block, attempt to read or base a conditional jump on an uninitialized value, and finally, to confirm that you free all the memory you have allocated. </p>\n\n<p>For Linux <code>valgrind</code> is the normal choice. There are similar memory checkers for every platform. They are all simple to use, just run your program through it.</p>\n\n<pre><code>$ valgrind ./bin/unique_words_with_cap_dyn\n==7962== Memcheck, a memory error detector\n==7962== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward et al.\n==7962== Using Valgrind-3.12.0 and LibVEX; rerun with -h for copyright info\n==7962== Command: ./bin/unique_words_with_cap_dyn\n==7962==\nEnter file path: dat/girljumped.txt\n\nOccurrences of all distinct words with Cap in file:\nAny             7\nOne             4\nSome            10\nThe             6\nA               13\n==7962==\n==7962== HEAP SUMMARY:\n==7962==     in use at exit: 0 bytes in 0 blocks\n==7962==   total heap usage: 4 allocs, 4 frees, 3,912 bytes allocated\n==7962==\n==7962== All heap blocks were freed -- no leaks are possible\n==7962==\n==7962== For counts of detected and suppressed errors, rerun with: -v\n</code></pre>\n\n<p>Above you can see there were <code>4</code> allocations and <code>4</code> frees (original allocation of <code>8</code>, <code>realloc</code> at <code>8, 16 &amp; 32</code>) and you can see there were <code>0</code> errors.</p>\n\n<p>Always confirm that you have freed all memory you have allocated and that there are no memory errors.</p>\n\n<p>Look things over and let me know if you have any questions.</p>\n"}], "owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 56157427, "answer_count": 2, "score": 0, "last_activity_date": 1557955781, "creation_date": 1557920534, "question_id": 56148540, "link": "https://stackoverflow.com/questions/56148540/how-to-apply-memory-allocation-to-a-c-program-which-counts-the-amount-of-words-i", "title": "How to apply Memory Allocation to a C Program which counts the amount of words in a list? (eg. malloc, calloc, free)", "body": "<p>Considering the code provided by @David C. Rankin in this previous answer:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/56141468/how-to-count-only-words-that-start-with-a-capital-in-a-list\">How to count only words that start with a Capital in a list?</a></p>\n\n<p>How do you optimise this code to include Memory Allocation for much larger text files? With this code below it will complete for small .txt files. </p>\n\n<p>However, what is the best way to set memory allocation to this code so that C (Programming Language) does not run out of memory. Is it best to use linked lists?</p>\n\n<pre><code>/**\n * C program to count occurrences of all words in a file.\n */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;limits.h&gt;\n\n#define MAX_WORD     50     /* max word size */\n#define MAX_WORDS   512     /* max number of words */\n\n#ifndef PATH_MAX\n#define PATH_MAX   2048     /* max path (defined for Linux in limits.h) */\n#endif\n\ntypedef struct {            /* use a struct to hold */\n    char word[MAX_WORD];    /* lowercase word, and */\n    int cap, count;         /* if it appeast capitalized, and its count */\n} words_t;\n\nchar *strlwr (char *str)    /* no need for unsigned char */\n{\n    char *p = str;\n\n    while (*p) {\n        *p = tolower(*p);\n        p++;\n    }\n\n    return str;\n}\n\nint main (void) {\n\n    FILE *fptr;\n    char path[PATH_MAX], word[MAX_WORD];\n    size_t i, len, index = 0;\n\n    /* Array of struct of distinct words, initialized all zero */\n    words_t words[MAX_WORDS] = {{ .word = \"\" }};\n\n    /* Input file path */\n    printf (\"Enter file path: \");\n    if (scanf (\"%s\", path) != 1) {  /* validate every input */\n        fputs (\"error: invalid file path or cancellation.\\n\", stderr);\n        return 1;\n    }\n\n    fptr = fopen (path, \"r\");   /* open file */\n    if (fptr == NULL) {         /* validate file open */\n        fputs ( \"Unable to open file.\\n\"\n                \"Please check you have read privileges.\\n\", stderr);\n        exit (EXIT_FAILURE);\n    }\n\n    while (index &lt; MAX_WORDS &amp;&amp;                 /* protect array bounds  */\n            fscanf (fptr, \"%s\", word) == 1) {   /* while valid word read */\n        int iscap = 0, isunique = 1;    /* is captial, is unique flags */\n\n        if (isupper (*word))            /* is the word uppercase */\n            iscap = 1;\n\n        /* remove all trailing punctuation characters */\n        len = strlen (word);                    /* get length */\n        while (len &amp;&amp; ispunct(word[len - 1]))   /* only if len &gt; 0 */\n            word[--len] = 0;\n\n        strlwr (word);                  /* convert word to lowercase */\n\n        /* check if word exits in list of all distinct words */\n        for (i = 0; i &lt; index; i++) {\n            if (strcmp(words[i].word, word) == 0) {\n                isunique = 0;               /* set unique flag zero */\n                if (iscap)                  /* if capital flag set */\n                    words[i].cap = iscap;   /* set capital flag in struct */\n                words[i].count++;           /* increment word count */\n                break;                      /* bail - done */\n            }\n        }\n        if (isunique) { /* if unique, add to array, increment index */\n            memcpy (words[index].word, word, len + 1);  /* have len */\n            if (iscap)                      /* if cap flag set */\n                words[index].cap = iscap;   /* set capital flag in struct */\n            words[index++].count++;         /* increment count &amp; index */\n        }\n    }\n    fclose (fptr);  /* close file */\n\n    /*\n     * Print occurrences of all words in file.\n     */\n    puts (\"\\nOccurrences of all distinct words with Cap in file:\");\n    for (i = 0; i &lt; index; i++) {\n        if (words[i].cap) {\n            strcpy (word, words[i].word);\n            *word = toupper (*word);\n            /*\n             * %-15s prints string in 15 character width.\n             * - is used to print string left align inside\n             * 15 character width space.\n             */\n            printf(\"%-15s %d\\n\", word, words[i].count);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Using your posted input</p>\n\n<pre><code>$ ./bin/unique_words_with_cap\nEnter file path: dat/girljumped.txt\n\nOccurrences of all distinct words with Cap in file:\nAny             7\nOne             4\nSome            10\nThe             6\nA               13\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1557920435, "post_id": 56148391, "comment_id": 98926234, "body": "Your title and what you say the question is about (in the first sentence) is totally misleading. You don&#39;t ask anything about <code>strcmp</code> at all. Please take some time to read <a href=\"http://stackoverflow.com/help\">the help pages</a>, take <a href=\"http://stackoverflow.com/tour\">the SO tour</a>, read about <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>, as well as <a href=\"https://codeblog.jonskeet.uk/2012/11/24/stack-overflow-question-checklist/\" rel=\"nofollow noreferrer\">this question checklist</a>."}, {"owner": {"reputation": 9, "user_id": 11503809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe90c8491f53f9b4a252b19a3e1fd23?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/11503809/mike"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557920863, "post_id": 56148391, "comment_id": 98926500, "body": "I am o sorry, please apologize. Of course I was meaning: printf(&quot;Compare between str1 and str2: %d, %d&quot;, strcmp(string1, string2));"}, {"owner": {"reputation": 9, "user_id": 11503809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe90c8491f53f9b4a252b19a3e1fd23?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/11503809/mike"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557921753, "post_id": 56148391, "comment_id": 98927054, "body": "I have updatet my question"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1557922756, "post_id": 56148391, "comment_id": 98927680, "body": "<code>printf(&quot;Compare between str1 and str2: %d, %d&quot;, strcmp(string1, string2))</code>: this is wrong, yourt format string has two <code>%d</code>s, but you provide only one argument (<code>strcmp(string1, string2)</code>). Your compiler probably warned you about this."}], "answers": [{"tags": [], "owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "is_accepted": false, "score": 5, "last_activity_date": 1557926478, "last_edit_date": 1557926478, "creation_date": 1557920241, "answer_id": 56148450, "question_id": 56148391, "link": "https://stackoverflow.com/questions/56148391/why-this-output-string-to-number/56148450#56148450", "title": "Why this output string to number?", "body": "<p>Please compile with full warnings! Always read those warnings carefully!</p>\n\n<p>The compiler should have told you that your format string is wrong.</p>\n\n<p>The % arguments in printf describe the type of the variable you are supplying. They don't provide any \"free\" type conversion, only formatting, so as you have strings, you need to use <code>%s</code></p>\n\n<p>What the compiler is trying to do instead is look at the pointer to your string and render that pointer value as an integer, but in fact it can't even do that properly if the size of integers is not the same as the size of pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 4, "last_activity_date": 1557920336, "creation_date": 1557920336, "answer_id": 56148474, "question_id": 56148391, "link": "https://stackoverflow.com/questions/56148391/why-this-output-string-to-number/56148474#56148474", "title": "Why this output string to number?", "body": "<p>Even if the strings contain numbers, they are still <strong><em>strings</em></strong>, and you need to print them using the <code>\"%s\"</code> format:</p>\n\n<pre><code>printf(\"Compare between str1 and str2: %s, %s\", string1, string2);\n//                                     ^^  ^^\n// Note the format specifier being different\n</code></pre>\n\n<p>As for the \"numbers\" that are printed, remember that arrays decay to pointers to their first element. It's the decimal value of those pointers you're printing.</p>\n\n<p>It should be noted that using mismatching format specifier and argument (like using <code>\"%d\"</code> to print a string) leads to <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behavior</em></a>.</p>\n\n<hr>\n\n<p>If you want to use <em>actual</em> numbers, and compare them with e.g. <code>&lt;</code> or <code>&gt;</code>, then you should have a numeric type instead, as in</p>\n\n<pre><code>int number1 = 1;\nint number2 = 2;\n</code></pre>\n\n<p>Then you can print them with the <code>\"%d\"</code> format specifier, as it expects an argument of type <code>int</code>:</p>\n\n<pre><code>printf(\"Compare between number1 and number2: %d, %d\", number1, number2);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "is_accepted": false, "score": 0, "last_activity_date": 1557921288, "last_edit_date": 1557921288, "creation_date": 1557920502, "answer_id": 56148530, "question_id": 56148391, "link": "https://stackoverflow.com/questions/56148391/why-this-output-string-to-number/56148530#56148530", "title": "Why this output string to number?", "body": "<pre><code>printf(\"Compare between str1 and str2: %d, %d\", string1, string2);\n</code></pre>\n\n<p>In that way you print address in memory of string1 and string2, in stack because this is fixed size array</p>\n\n<p>To print string use <code>%s</code>:</p>\n\n<pre><code>printf(\"Compare between str1 and str2: %s, %s\", string1, string2);\n</code></pre>\n\n<p>But this strings MUST be terminate by null ('\\0') or function will read in memory until find cell with value 0.</p>\n\n<p>To find ASCII code of CHAR (not whole string) use this:</p>\n\n<pre><code>printf(\"first char of str1: %c = %d\", string1[0], (int)string1[0]);\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11503809, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fe90c8491f53f9b4a252b19a3e1fd23?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/11503809/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1557926478, "creation_date": 1557920027, "last_edit_date": 1557922631, "question_id": 56148391, "link": "https://stackoverflow.com/questions/56148391/why-this-output-string-to-number", "title": "Why this output string to number?", "body": "<p>I have a Question about the strcmp function in c. As Homework we do some comparissions about strings. But one thing is not clear, we have to compare numbers with this function. I know that there are other comparing methods to compare numbers, but our prof use it this way.</p>\n\n<p>When I used the function like this: </p>\n\n<pre><code>char string1[] = \"1\";\nchar string2[] = \"2\"\n\nprintf(\"Compare between str1 and str2: %d, %d\", strcmp(string1, string2));\n</code></pre>\n\n<p>-> Output:</p>\n\n<pre><code>Compare between str1 and str2: 1\n</code></pre>\n\n<p>Which would mean that the string1 is bigger.</p>\n\n<p>I have then printf with just the variables:</p>\n\n<pre><code>printf(\"string1 %d\", string1);  //output: 6356750\nprintf(\"string2 %d\", string2);  //output: 6356748\n</code></pre>\n\n<p>Why are there such numbers? And what does this numbers mean?</p>\n\n<p>I was thinking that the numbers in the string array are representing the ASCII Code but I think i am wrong.</p>\n"}, {"tags": ["c", "math", "numeric", "ieee-754", "approximation"], "comments": [{"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557920396, "post_id": 56148283, "comment_id": 98926214, "body": "Please show your code, the input values, the output of your algorithm compared to the output of the standard library functions. What do you mean with &quot;in single precision&quot;? What do you mean with &quot;comparing the hexadecimal representations&quot;? How do you get these? Depending on the capabilities of your processor, other approximations, e.g. taylor series may be faster or better."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557920512, "post_id": 56148283, "comment_id": 98926282, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "reply_to_user": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557922121, "post_id": 56148283, "comment_id": 98927284, "body": "@EricPostpischil I have added the algorithm code and the way it is tested."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557922257, "post_id": 56148283, "comment_id": 98927383, "body": "@Bodo The Taylor series seems to be actually much more precise (according to the tests done). However, with no FPU architecture, it will be highly inefficient."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557923586, "post_id": 56148283, "comment_id": 98928234, "body": "@Daniel Do you need floating point results when you don&#39;t have an FPU? Both CORDIC and Taylor series can be implemented in fixed point (or fractional) arithmetic. IMHO it doesn&#39;t make much sense to compare floating point results of different algorithms with <code>memcmp</code>. You should check the difference compared to the actual value and define a required precision. BTW: Are you sure that <code>sizeof(unsigned int) == sizeof(float)</code>?"}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557924511, "post_id": 56148283, "comment_id": 98928812, "body": "@Bodo I do not agree with you. If I assume that the result of the other algorithm is correct then my result must be strictly identical. Otherwise, I am approximating to the result of the other approximation algorithm. If we were talking about computing physical distances using floating-point, for example, then yes I would need to compare the difference and see if it is correct up to some sufficient error."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "reply_to_user": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557924563, "post_id": 56148283, "comment_id": 98928853, "body": "@Bodo <code>sizeof(unsigned int) == sizeof(float)</code> Yes, on the architecture where I test."}, {"owner": {"reputation": 6679, "user_id": 10622916, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21bd4eeaa5ba60dc021c5ccfbf4a963d?s=128&d=identicon&r=PG&f=1", "display_name": "Bodo", "link": "https://stackoverflow.com/users/10622916/bodo"}, "edited": false, "score": 0, "creation_date": 1557925961, "post_id": 56148283, "comment_id": 98929767, "body": "@Daniel What is &quot;correct&quot; for a sine approximation? Calculating a floating point result of the highest precision that can be represented by the floating point format regardless of the duration or the precision of the input? Calculating a reasonable precision in a reasonable time? Calculating the best precision that can be achieved in a limited time? It depends on your needs. As you didn&#39;t write enough information about your requirements it is difficult to give an answer."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557928757, "post_id": 56148283, "comment_id": 98931642, "body": "Provide a <b>complete</b> example. Your question is missing definitions of <code>cordic_1K</code>, <code>cordic_ctab</code>, and <code>CORDIC_NTAB</code>. (Code to generate them would be acceptable.) It should present <b>complete</b> code ready to compile, including <code>#include</code> statements for <code>&lt;math.h&gt;</code>, <code>&lt;stdio.h&gt;</code>, and <code>&lt;string.h&gt;</code>. And you should point out specifically at least one case to examine where there are errors. Also, the version 1 of the <code>cordic</code> routine is not compatible with its use in <code>main</code>, so it is not part of a complete example. You should show a separate <code>main</code> or conditionalize the existing <code>main</code>."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557972349, "post_id": 56148283, "comment_id": 98947927, "body": "You can&#39;t really expect the CORDIC result to be bit-equivalent to the result from sinf(), but it should have a very small absolute difference.  You should figure out what kind of error you can tolerate in practical terms and then see if you can match that.  Note also that you are introducing some error when you quantize the angle."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557997787, "post_id": 56148283, "comment_id": 98956800, "body": "@MattTimmermans why not? is CORDIC&#39;s resolution is not great enough? or I would have to make significantly more iterations for that? why then using Taylor series I can make it bit-equivalent?"}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1558006977, "post_id": 56148283, "comment_id": 98962038, "body": "1) CORDIC will provide roughly the same accuracy over the entire range, but floating point values and the Taylor series are both more accurate very close to zero; and 2) if the ideal value is very close to the midpoint between two floats then even the smallest error can make it round in a different direction."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "edited": false, "score": 0, "creation_date": 1558008848, "post_id": 56148283, "comment_id": 98963068, "body": "(1) was exactly my suspicion, which you confirm. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "edited": false, "score": 0, "creation_date": 1557997854, "post_id": 56161373, "comment_id": 98956845, "body": "Thank you! So it seems that a lot more iterations are required in order to match math&#39;s <code>sin</code> ?"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "edited": false, "score": 0, "creation_date": 1558001613, "post_id": 56161373, "comment_id": 98959078, "body": "@Daniel no, Each iteration is representing one bit of mantissa so if you do more iteration than mantissa bits the result is not affected due to rounding. The difference is caused mainly due to different way of computing. You know math sin cos are rounded too ..."}, {"owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "edited": false, "score": 0, "creation_date": 1558002129, "post_id": 56161373, "comment_id": 98959341, "body": "right. I meant increasing iterations with computation precision. Just for completing my understanding: If I could compute the CORDIC in Xbits, where X is the number of possible exponents in the relevant range times 23 bits of the significand, then I could obtain the correct result for a float?"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "reply_to_user": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "edited": false, "score": 0, "creation_date": 1558006399, "post_id": 56161373, "comment_id": 98961688, "body": "IIRC math <code>sin</code> and <code>cos</code> has <code>+&#47;-1 ulp</code> error ... so up to <code>2 ulp</code> error difference to CORDIC might be just opposite rounding by <code>1 ulp</code> of both variants ... so the 64 bit variant might have the same accuracy as the <code>sin</code> and <code>cos</code> you are comparing to ..."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1558025925, "post_id": 56161373, "comment_id": 98973188, "body": "@Spektre: Re \u201cIIRC math <code>sin</code> and <code>cos</code> has +/-1 ulp error\u201d: The accuracy of math library routines is implementation-dependent. Nobody has implemented all of the math library routines with known-bounded run-time, although I think CRlibm covered sine and cosine. Commercial implementations may be 3-4 ULP, for example. Using the <code>double</code> <code>sin</code> as a reference for single-precision <code>sinf</code> would likely give a very nearly &#189; ULP value (using the single-precision ULP)."}], "tags": [], "owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "is_accepted": true, "score": 1, "last_activity_date": 1558001691, "last_edit_date": 1558001691, "creation_date": 1557984296, "answer_id": 56161373, "question_id": 56148283, "link": "https://stackoverflow.com/questions/56148283/sine-computation-with-cordic-results-in-not-precise-values/56161373#56161373", "title": "sine computation with CORDIC results in not precise values", "body": "<p>I gave it a shot but as mentioned in the comments you can not expect exact bit match as math goniometrics is usually based on Chebyshev polynomials. Also you do not have defined the <code>cordic_1K</code> constant. After some search I managed to do this in <strong>C++/VCL:</strong></p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>//---------------------------------------------------------------------------\n// IEEE 754 single masks\nconst DWORD _f32_sig    =0x80000000;    // sign\nconst DWORD _f32_exp    =0x7F800000;    // exponent\nconst DWORD _f32_exp_sig=0x40000000;    // exponent sign\nconst DWORD _f32_exp_bia=0x3F800000;    // exponent bias\nconst DWORD _f32_exp_lsb=0x00800000;    // exponent LSB\nconst DWORD _f32_exp_pos=        23;    // exponent LSB bit position\nconst DWORD _f32_man    =0x007FFFFF;    // mantisa\nconst DWORD _f32_man_msb=0x00400000;    // mantisa MSB\nconst DWORD _f32_man_bits=       23;    // mantisa bits\nconst float _f32_lsb     =  3.4e-38;    // abs min number\n//---------------------------------------------------------------------------\nfloat CORDIC32_atan[_f32_man_bits+1];\nvoid f32_sincos(float &amp;s,float &amp;c,float a)\n    {\n    int k;\n    float x,y=0.0,v=1.0,d,tx,ty,ta;\n    x=0.6072529350088812561694; // cordic_1K\n    for (k=0;k&lt;=_f32_man_bits;k++)\n        {\n        d =(a&gt;=0.0?+1.0:-1.0);\n        tx=x-d*v*y;\n        ty=y+d*v*x;\n        ta=a-d*CORDIC32_atan[k];\n        x=tx; y=ty; a=ta; v*=0.5;\n        }\n    c=x; s=y;\n    }\n//---------------------------------------------------------------------------\ndouble CORDIC64_atan[_f32_man_bits+1];\nvoid f64_sincos(float &amp;s,float &amp;c,double a)\n    {\n    int k;\n    double x,y=0.0,v=1.0,d,tx,ty,ta;\n    x=0.6072529350088812561694; // cordic_1K\n    for (k=0;k&lt;=_f32_man_bits;k++)\n        {\n        d =(a&gt;=0.0?+1.0:-1.0);\n        tx=x-d*v*y;\n        ty=y+d*v*x;\n        ta=a-d*CORDIC64_atan[k];\n        x=tx; y=ty; a=ta; v*=0.5;\n        }\n    c=x; s=y;\n    }\n//---------------------------------------------------------------------------\n//--- Builder: --------------------------------------------------------------\n//---------------------------------------------------------------------------\n__fastcall TForm1::TForm1(TComponent* Owner):TForm(Owner)\n    {\n    int i;\n    float s0,c0,s1,c1,s2,c2,d32,d64,D32,D64,x;\n    AnsiString txt=\"\";\n\n    // init CORDIC tables\n    for (x=1.0,i=0;i&lt;=_f32_man_bits;i++,x*=0.5)\n        {\n        CORDIC32_atan[i]=atan(x);\n        CORDIC64_atan[i]=atan(double(x));\n        }\n\n    // 32 bit\n    D32=0.0; D64=0.0;\n    for (x=-0.5*M_PI;x&lt;=+0.5*M_PI;x+=0.025)\n        {\n        s0=sin(x);\n        c0=cos(x);\n        f32_sincos(s1,c1,x); d32=fabs(s1-s0); if (D32&lt;d32) D32=d32;\n        f64_sincos(s2,c2,x); d64=fabs(s2-s0); if (D64&lt;d64) D64=d64;\n        if (d32+d64&gt;1e-16)\n            {\n            txt+=AnsiString().sprintf(\"sin(%2.5f) == %2.5f != %2.5f != %2.5f  | %.10f %.10f\\r\\n\",x,s0,s1,s2,d32,d64);\n            f32_sincos(s0,c0,x);    // debug breakpoint\n            f64_sincos(s2,c2,x);\n            }\n        }\n    txt=AnsiString().sprintf(\"max err: %.10f %.10f\\r\\n\",D32,D64)+txt;\n    mm_log-&gt;Lines-&gt;Add(txt);\n    }\n//-------------------------------------------------------------------------\n</code></pre>\n\n<p>You can ignore the <strong>VCL</strong> stuff like <code>AnsiString</code> (or port it to your environment) its just for printing the results...</p>\n\n<p><strong>The code gave me this output:</strong></p>\n\n<pre><code>max err: 0.0000002384 0.0000001192\nsin(-1.54580) == -0.99969 != -0.99969 != -0.99969  | 0.0000000596 0.0000000000\nsin(-1.52080) == -0.99875 != -0.99875 != -0.99875  | 0.0000001192 0.0000000000\nsin(-1.49580) == -0.99719 != -0.99719 != -0.99719  | 0.0000001192 0.0000000000\nsin(-1.44580) == -0.99220 != -0.99220 != -0.99220  | 0.0000000596 0.0000000000\nsin(-1.42080) == -0.98877 != -0.98877 != -0.98877  | 0.0000000596 0.0000000596\nsin(-1.39580) == -0.98473 != -0.98473 != -0.98473  | 0.0000001192 0.0000000596\nsin(-1.37080) == -0.98007 != -0.98007 != -0.98007  | 0.0000000000 0.0000000596\nsin(-1.34580) == -0.97479 != -0.97479 != -0.97479  | 0.0000000596 0.0000000000\nsin(-1.27080) == -0.95534 != -0.95534 != -0.95534  | 0.0000001192 0.0000000000\nsin(-1.24580) == -0.94765 != -0.94765 != -0.94765  | 0.0000000596 0.0000000596\nsin(-1.22080) == -0.93937 != -0.93937 != -0.93937  | 0.0000000596 0.0000000000\nsin(-1.19580) == -0.93051 != -0.93051 != -0.93051  | 0.0000000596 0.0000000596\nsin(-1.17080) == -0.92106 != -0.92106 != -0.92106  | 0.0000000596 0.0000000000\nsin(-1.14580) == -0.91104 != -0.91104 != -0.91104  | 0.0000001192 0.0000000596\nsin(-1.12080) == -0.90045 != -0.90045 != -0.90045  | 0.0000001192 0.0000000000\nsin(-1.07080) == -0.87758 != -0.87758 != -0.87758  | 0.0000001788 0.0000000596\nsin(-1.04580) == -0.86532 != -0.86532 != -0.86532  | 0.0000001788 0.0000000596\nsin(-1.02080) == -0.85252 != -0.85252 != -0.85252  | 0.0000001192 0.0000000596\nsin(-0.99580) == -0.83919 != -0.83919 != -0.83919  | 0.0000000000 0.0000000596\nsin(-0.97080) == -0.82534 != -0.82534 != -0.82534  | 0.0000001192 0.0000000596\nsin(-0.94580) == -0.81096 != -0.81096 != -0.81096  | 0.0000000596 0.0000000596\nsin(-0.92080) == -0.79608 != -0.79608 != -0.79608  | 0.0000000000 0.0000000596\nsin(-0.89580) == -0.78071 != -0.78071 != -0.78071  | 0.0000001788 0.0000000596\nsin(-0.87080) == -0.76484 != -0.76484 != -0.76484  | 0.0000000596 0.0000000000\nsin(-0.84580) == -0.74850 != -0.74850 != -0.74850  | 0.0000000596 0.0000000000\nsin(-0.82080) == -0.73169 != -0.73169 != -0.73169  | 0.0000001192 0.0000000000\nsin(-0.79580) == -0.71442 != -0.71442 != -0.71442  | 0.0000000596 0.0000000000\nsin(-0.77080) == -0.69671 != -0.69671 != -0.69671  | 0.0000000596 0.0000000596\nsin(-0.74580) == -0.67856 != -0.67856 != -0.67856  | 0.0000000000 0.0000000596\nsin(-0.72080) == -0.65998 != -0.65998 != -0.65998  | 0.0000001192 0.0000000596\nsin(-0.69580) == -0.64100 != -0.64100 != -0.64100  | 0.0000000596 0.0000000000\nsin(-0.67080) == -0.62161 != -0.62161 != -0.62161  | 0.0000001788 0.0000000596\nsin(-0.64580) == -0.60184 != -0.60184 != -0.60184  | 0.0000000596 0.0000001192\nsin(-0.62080) == -0.58168 != -0.58168 != -0.58168  | 0.0000000596 0.0000001192\nsin(-0.59580) == -0.56117 != -0.56117 != -0.56117  | 0.0000000596 0.0000000596\nsin(-0.57080) == -0.54030 != -0.54030 != -0.54030  | 0.0000001788 0.0000001192\nsin(-0.54580) == -0.51910 != -0.51910 != -0.51910  | 0.0000001788 0.0000001192\nsin(-0.52080) == -0.49757 != -0.49757 != -0.49757  | 0.0000000596 0.0000000894\nsin(-0.49580) == -0.47573 != -0.47573 != -0.47573  | 0.0000000894 0.0000000596\nsin(-0.47080) == -0.45360 != -0.45360 != -0.45360  | 0.0000000894 0.0000000298\nsin(-0.44580) == -0.43118 != -0.43118 != -0.43118  | 0.0000000298 0.0000000298\nsin(-0.42080) == -0.40849 != -0.40849 != -0.40849  | 0.0000000894 0.0000000596\nsin(-0.39580) == -0.38554 != -0.38554 != -0.38554  | 0.0000001192 0.0000000596\nsin(-0.37080) == -0.36236 != -0.36236 != -0.36236  | 0.0000000298 0.0000000000\nsin(-0.34580) == -0.33895 != -0.33895 != -0.33895  | 0.0000000000 0.0000000298\nsin(-0.32080) == -0.31532 != -0.31532 != -0.31532  | 0.0000000596 0.0000000000\nsin(-0.29580) == -0.29150 != -0.29150 != -0.29150  | 0.0000000596 0.0000000596\nsin(-0.27080) == -0.26750 != -0.26750 != -0.26750  | 0.0000000894 0.0000001192\nsin(-0.24580) == -0.24333 != -0.24333 != -0.24333  | 0.0000000894 0.0000001192\nsin(-0.22080) == -0.21901 != -0.21901 != -0.21901  | 0.0000000745 0.0000000894\nsin(-0.19580) == -0.19455 != -0.19455 != -0.19455  | 0.0000000894 0.0000000596\nsin(-0.17080) == -0.16997 != -0.16997 != -0.16997  | 0.0000001043 0.0000000894\nsin(-0.14580) == -0.14528 != -0.14528 != -0.14528  | 0.0000000894 0.0000000894\nsin(-0.12080) == -0.12050 != -0.12050 != -0.12050  | 0.0000000596 0.0000000671\nsin(-0.09580) == -0.09565 != -0.09565 != -0.09565  | 0.0000000522 0.0000000522\nsin(-0.07080) == -0.07074 != -0.07074 != -0.07074  | 0.0000000075 0.0000000224\nsin(-0.04580) == -0.04578 != -0.04578 != -0.04578  | 0.0000000447 0.0000000335\nsin(-0.02080) == -0.02080 != -0.02080 != -0.02080  | 0.0000000596 0.0000000577\nsin(0.00420) == 0.00420 != 0.00420 != 0.00420  | 0.0000000545 0.0000000549\nsin(0.02920) == 0.02920 != 0.02920 != 0.02920  | 0.0000000447 0.0000000410\nsin(0.05420) == 0.05418 != 0.05418 != 0.05418  | 0.0000000149 0.0000000186\nsin(0.07920) == 0.07912 != 0.07912 != 0.07912  | 0.0000000224 0.0000000373\nsin(0.10420) == 0.10401 != 0.10401 != 0.10401  | 0.0000000820 0.0000000745\nsin(0.12920) == 0.12884 != 0.12884 != 0.12884  | 0.0000001043 0.0000000894\nsin(0.15420) == 0.15359 != 0.15359 != 0.15359  | 0.0000001043 0.0000001043\nsin(0.17920) == 0.17825 != 0.17825 != 0.17825  | 0.0000000447 0.0000000745\nsin(0.20420) == 0.20279 != 0.20279 != 0.20279  | 0.0000000596 0.0000000745\nsin(0.22920) == 0.22720 != 0.22720 != 0.22720  | 0.0000001043 0.0000001043\nsin(0.25420) == 0.25147 != 0.25147 != 0.25147  | 0.0000001192 0.0000000894\nsin(0.27920) == 0.27559 != 0.27559 != 0.27559  | 0.0000000000 0.0000000596\nsin(0.30420) == 0.29953 != 0.29953 != 0.29953  | 0.0000000596 0.0000000298\nsin(0.32920) == 0.32329 != 0.32329 != 0.32329  | 0.0000000596 0.0000000596\nsin(0.35420) == 0.34684 != 0.34684 != 0.34684  | 0.0000000298 0.0000000298\nsin(0.37920) == 0.37018 != 0.37018 != 0.37018  | 0.0000000298 0.0000000298\nsin(0.40420) == 0.39329 != 0.39329 != 0.39329  | 0.0000001788 0.0000000596\nsin(0.42920) == 0.41615 != 0.41615 != 0.41615  | 0.0000000894 0.0000000894\nsin(0.45420) == 0.43875 != 0.43875 != 0.43875  | 0.0000000298 0.0000000000\nsin(0.47920) == 0.46107 != 0.46107 != 0.46107  | 0.0000000596 0.0000000298\nsin(0.50420) == 0.48311 != 0.48311 != 0.48311  | 0.0000000596 0.0000000596\nsin(0.52920) == 0.50485 != 0.50485 != 0.50485  | 0.0000001788 0.0000000596\nsin(0.55420) == 0.52627 != 0.52627 != 0.52627  | 0.0000002384 0.0000001192\nsin(0.57920) == 0.54736 != 0.54736 != 0.54736  | 0.0000001192 0.0000000596\nsin(0.60420) == 0.56811 != 0.56811 != 0.56811  | 0.0000000596 0.0000000596\nsin(0.62920) == 0.58850 != 0.58850 != 0.58850  | 0.0000000596 0.0000001192\nsin(0.65420) == 0.60853 != 0.60853 != 0.60853  | 0.0000001192 0.0000001192\nsin(0.67920) == 0.62817 != 0.62817 != 0.62817  | 0.0000000596 0.0000001192\nsin(0.70420) == 0.64743 != 0.64743 != 0.64743  | 0.0000000596 0.0000000000\nsin(0.72920) == 0.66628 != 0.66628 != 0.66628  | 0.0000000596 0.0000000000\nsin(0.75420) == 0.68471 != 0.68471 != 0.68471  | 0.0000000596 0.0000000000\nsin(0.77920) == 0.70271 != 0.70271 != 0.70271  | 0.0000000596 0.0000000000\nsin(0.82920) == 0.73739 != 0.73739 != 0.73739  | 0.0000000596 0.0000000000\nsin(0.85420) == 0.75405 != 0.75405 != 0.75405  | 0.0000001192 0.0000000000\nsin(0.87920) == 0.77023 != 0.77023 != 0.77023  | 0.0000001192 0.0000000000\nsin(0.90420) == 0.78593 != 0.78593 != 0.78593  | 0.0000000596 0.0000000596\nsin(0.92920) == 0.80114 != 0.80114 != 0.80114  | 0.0000000596 0.0000001192\nsin(0.95420) == 0.81585 != 0.81585 != 0.81585  | 0.0000001788 0.0000000596\nsin(0.97920) == 0.83005 != 0.83005 != 0.83005  | 0.0000000000 0.0000000596\nsin(1.00420) == 0.84373 != 0.84373 != 0.84373  | 0.0000001788 0.0000000000\nsin(1.02920) == 0.85689 != 0.85689 != 0.85689  | 0.0000000596 0.0000000000\nsin(1.05420) == 0.86951 != 0.86951 != 0.86951  | 0.0000001192 0.0000000000\nsin(1.12920) == 0.90407 != 0.90407 != 0.90407  | 0.0000000596 0.0000000000\nsin(1.15420) == 0.91447 != 0.91447 != 0.91447  | 0.0000000596 0.0000000596\nsin(1.17920) == 0.92430 != 0.92430 != 0.92430  | 0.0000001788 0.0000000596\nsin(1.20420) == 0.93355 != 0.93355 != 0.93355  | 0.0000000596 0.0000000000\nsin(1.25420) == 0.95030 != 0.95030 != 0.95030  | 0.0000000596 0.0000000596\nsin(1.27920) == 0.95779 != 0.95779 != 0.95779  | 0.0000001192 0.0000000596\nsin(1.30420) == 0.96467 != 0.96467 != 0.96467  | 0.0000000596 0.0000000000\nsin(1.35420) == 0.97664 != 0.97664 != 0.97663  | 0.0000000596 0.0000000596\nsin(1.45420) == 0.99321 != 0.99321 != 0.99321  | 0.0000000596 0.0000000000\nsin(1.47920) == 0.99581 != 0.99581 != 0.99581  | 0.0000001192 0.0000000000\nsin(1.50420) == 0.99778 != 0.99778 != 0.99778  | 0.0000000596 0.0000000000\nsin(1.52920) == 0.99914 != 0.99914 != 0.99914  | 0.0000000596 0.0000000000\nsin(1.55420) == 0.99986 != 0.99986 != 0.99986  | 0.0000000596 0.0000000000\n</code></pre>\n\n<p>As you can see the 64 bit tables produce much better match to math <code>sin</code> the error is up to <code>4 ulp</code> (2^-24) for 32 bit and <code>2 ulp</code> (2^-24) for 64 bit tables. As the mantissa of 32 bit float is <code>23+1</code> bits the result corresponds to 2 least significant bits of mantissa so its last hexadecimal digit is not matching ...</p>\n\n<p>PS the <code>atan</code> table is:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>CORDIC64_atan[24]={ 0.785398163397448, 0.463647609000806, 0.244978663126864, 0.124354994546761, 0.0624188099959574, 0.0312398334302683, 0.0156237286204768, 0.00781234106010111, 0.00390623013196697, 0.00195312251647882, 0.00097656218955932, 0.000488281211194898, 0.000244140620149362, 0.00012207031189367, 6.10351561742088E-05, 3.05175781155261E-05, 1.52587890613158E-05, 7.62939453110197E-06, 3.8146972656065E-06, 1.90734863281019E-06, 9.53674316405961E-07, 4.76837158203089E-07, 2.38418579101558E-07, 1.19209289550781E-07 };\n</code></pre>\n"}], "owner": {"reputation": 430, "user_id": 5043686, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9b9ead8d40183343c8f186f2e95b5b66?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel", "link": "https://stackoverflow.com/users/5043686/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 56161373, "answer_count": 1, "score": 3, "last_activity_date": 1558001691, "creation_date": 1557919680, "last_edit_date": 1557997543, "question_id": 56148283, "link": "https://stackoverflow.com/questions/56148283/sine-computation-with-cordic-results-in-not-precise-values", "title": "sine computation with CORDIC results in not precise values", "body": "<p>I am trying to implement the CORDIC algorithm for approximating a sine function in single precision, on architecture with no FPU. I compare the result obtained from my implementation with results obtained from standard C math functions. I tried implementing in two ways: 1) directly using floating-point operations, 2) converting the input to fixed-point and using integer based operations.\nI compare the results obtained from sinf(), sin() and sin() cast to float. The comparison is based on comparing the hexadecimal representations of the result with the expected from math functions.</p>\n\n<p>In (1) the implementation uses double types, then the result is cast to float. My calculated values are always off by at least one hexadecimal digit, no matter how many iterations are done with CORDIC.</p>\n\n<p>In (2), initially the input was mapped to a 32 bit integer.  The error was the same as in (1). Only after, increasing the fixed point size to 64 bit (and the number of iterations to 64) the precision improved. But yet, there are ranges of input for which the algorithm is not precise. If I would increase the fixed point size to 128 bit (and the number of iterations to 128), it may be enough to obtain precise values but it is completely unpractical.</p>\n\n<p>The algorithm in (1) is a modified version from the book <a href=\"https://www.jjj.de/fxt/fxtbook.pdf\" rel=\"nofollow noreferrer\">https://www.jjj.de/fxt/fxtbook.pdf</a></p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\nconst double cordic_1K = 0.6072529350088812561694467525049282631123908521500897724;\ndouble *cordic_ctab;\n\nvoid make_cordic_ctab(ulong na)\n{\n    double s = 1.0;\n    for (ulong k=0; k&lt;na; ++k)\n    {\n        cordic_ctab[k] = atan(s);\n        s *= 0.5;\n    }\n}\n\n\nvoid cordic(int theta, double* s, double* c, int n)\n{\n    double x, y, z, v;\n    double tx, ty, tz;\n    double d;\n\n    x = cordic_1K;\n    y = 0;\n    z = theta;\n    v = 1.0;\n\n    for (int k = 0; k &lt; n; ++k) {\n        d = (z &gt;= 0 ? +1 : -1);\n        tx = x - d * v * y;\n        ty = y + d * v * x;\n        tz = z - d * cordic_ctab[k];\n        x = tx;\n        y = ty;\n        z = tz;\n        v *= 0.5;\n    }\n    *c = x;\n    *s = y;\n}\n</code></pre>\n\n<p>The algorithm in (2) a is modified version found at <a href=\"http://www.dcs.gla.ac.uk/~jhw/cordic/\" rel=\"nofollow noreferrer\">http://www.dcs.gla.ac.uk/~jhw/cordic/</a> </p>\n\n<pre><code>#include &lt;math.h&gt;\n#include &lt;stdio.h&gt;\n#define cordic_1K 0x26dd3b6a10d79600\n#define CORDIC_NTAB 64\n\nvoid cordic(long theta, long *s, long *c, int n) {\n  long d, tx, ty, tz;\n  long x = cordic_1K, y = 0, z = theta;\n  n = (n &gt; CORDIC_NTAB) ? CORDIC_NTAB : n;\n\n  for (int k = 0; k &lt; n; ++k) {\n    d = z &gt;= 0 ? 0 : -1;\n    tx = x - (((y &gt;&gt; k) ^ d) - d);\n    ty = y + (((x &gt;&gt; k) ^ d) - d);\n    tz = z - ((cordic_ctab[k] ^ d) - d);\n    x = tx;\n    y = ty;\n    z = tz;\n  }\n\n  *c = x;\n  *s = y;\n}\n</code></pre>\n\n<p>The CORDIC table is similarly generated with bits=64. </p>\n\n<p>The testing for (1) is done as below:</p>\n\n<pre><code>int main(int argc, char **argv) {\n  float angle;\n  long s, c;\n  int failed = 0;\n\n  cordic_ctab = (double*)malloc(sizeof(double) * 64);\n  make_cordic_ctab(64);\n\n  for (int i = 0; i &lt; step; i++) {\n    angle = (i / step) * M_PI / 4;\n\n    cordic(angle, &amp;s, &amp;c, 64);\n    float result = s;\n    float expected = sinf(angle);\n\n    if (angle &lt; pow(2, -27))\n      result = angle;\n\n    if (memcmp(&amp;result, &amp;expected, sizeof(float)) != 0) {\n      failed += 1;\n      printf(\"%e : %e\\n\", result, expected);\n      printf(\"0x%x : 0x%x\\n\", *((unsigned int *)&amp;result),\n             *((unsigned int *)&amp;expected));\n      printf(\"\\n\");\n\n    }\n  }\n  printf(\"failed:%d\\n\", failed);\n}\n</code></pre>\n\n<p>The testing for (2) is done as below:</p>\n\n<pre><code>int main(int argc, char **argv) {\n  float angle;\n  long s, c;\n  int failed = 0;\n  double mul = 4611686018427387904.000000;\n  double step = 1000000000.0;\n\n  for (int i = 0; i &lt; step; i++) {\n    angle = (i / step) * M_PI / 4;\n\n    cordic((angle * mul), &amp;s, &amp;c, 64);\n    float result = s / mul;\n    float expected = sinf(angle);\n\n    if (angle &lt; pow(2, -27))\n      result = angle;\n\n    if (memcmp(&amp;result, &amp;expected, sizeof(float)) != 0) {\n      failed += 1;\n      printf(\"%e : %e\\n\", result, expected);\n      printf(\"0x%x : 0x%x\\n\", *((unsigned int *)&amp;result),\n             *((unsigned int *)&amp;expected));\n      printf(\"\\n\");\n\n    }\n  }\n  printf(\"failed:%d\\n\", failed);\n}\n</code></pre>\n\n<p>Is there something that I don't take into account for CORDIC? Is it possible that CORDIC is completely not suitable and other methods should be considered?</p>\n"}, {"tags": ["c", "shared-libraries", "static-linking", "autotools", "dynamic-linking"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557925185, "post_id": 56148161, "comment_id": 98929269, "body": "I&#39;m not sure I understand.  You&#39;ve struck out the most likely possibilities already.  How would you characterize an acceptable solution other than &quot;read my mind&quot;?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557926078, "post_id": 56148161, "comment_id": 98929859, "body": "Also, dynamic linking / loading details vary from platform to platform.  In what particular platform are you interested?"}, {"owner": {"reputation": 58765, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1557931457, "post_id": 56148161, "comment_id": 98933504, "body": "@JohnBollinger I&#39;m ok with an answer that says &quot;well... that&#39;s just not possible&quot;. I&#39;m not familiar enough with the subject area to know if I&#39;m missing something else. W.r.t. platforms, the project in question currently builds on Linux and MacOS, so some portability would be good. I&#39;ll add that to the question."}], "answers": [{"comments": [{"owner": {"reputation": 58765, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1557931620, "post_id": 56152072, "comment_id": 98933636, "body": "Fantastic answer. I was looking for someone to explain the extent of my options, which you&#39;ve done very clearly. Thank you."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557931916, "post_id": 56152072, "comment_id": 98933815, "body": "<i>I tend to like providing a wrapper script that sets <code>LD_LIBRARY_PATH</code>, so that that its effect is narrowly scoped.</i>  Funny, I like using <code>RPATH</code> or <code>RUNPATH</code> in the executable itself because <code>LD_LIBRARY_PATH</code> will propagate to child processes.  Of course, that means I have to package the executable with the proper shared objects, which can also cause problems."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1557932205, "post_id": 56152072, "comment_id": 98934011, "body": "That is a valid consideration, @AndrewHenle.  By &quot;so that its effect is narrowly scoped&quot; I meant relative to using <code>LD_LIBRARY_PATH</code> in your default shell configuration, not relative to using <code>RPATH</code> and / or <code>RUNPATH</code>, which is indeed even more narrowly scoped.  I have apparently betrayed my general bias against using <code>RPATH</code> and (to a lesser extent) <code>RUNPATH</code>.  But all of these tools have their purposes and plausible use cases."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1557931419, "creation_date": 1557931419, "answer_id": 56152072, "question_id": 56148161, "link": "https://stackoverflow.com/questions/56148161/can-i-force-a-dynamic-library-to-link-to-a-specific-dynamic-library-dependency/56152072#56152072", "title": "Can I force a dynamic library to link to a specific dynamic library dependency?", "body": "<p>Details of runtime dynamic linking vary from platform to platform.  The Autotools can insulate you from that to an extent, but if you care about the details, which apparently you do, then it probably is not adequate to allow the Autotools to choose for you.</p>\n\n<p>With that said, however, you seem to be ruling out just about <em>all</em> possibilities:</p>\n\n<ul>\n<li><p>The most reliable way to ensure that at runtime you get the specific implementation you linked against at build time is to link statically.  But you say you don't want that.</p></li>\n<li><p>If you instead use dynamic libraries then you rely on the dynamic linker to associate a library implementation with your executable at run time. In that case, there are two general choices for how you can direct the DL to a specific library implementation:</p>\n\n<ol>\n<li><p><strong>Via information stored in the program / library binary</strong>.  You are using terminology that suggests an ELF-based system, and for ELF shared objects, it is the <code>RPATH</code> and / or <code>RUNPATH</code> that convey information about where to look for required libraries.  There is no path information associated with individual library requirements; they are identified by SONAME only.  But you say you don't want to use <code>RPATH</code><sup>*</sup>, and so I suppose not <code>RUNPATH</code> either.</p></li>\n<li><p><strong>Via static or dynamic configuration of the dynamic linker</strong>.  This is where <code>LD_LIBRARY_PATH</code> comes in, but you say you don't want to use that.  The dynamic linker typically also has a configuration file or files, such as <code>/etc/ld.so.conf</code>. There you can specify library directories to search, and, with a bit of care, the order to search them.</p></li>\n</ol></li>\n</ul>\n\n<p>Possibly, then, you can cause your desired library implementation to be linked to your application by updating the dynamic linker's configuration files to cause it to search the wanted path first.  This will affect the whole system, however, and it's brittle.</p>\n\n<p>Alternatively, depending on details of the nature of the dependency, you could give your wanted version of libcrypto a distinct SONAME.  Effectively, that would make it a different object (<em>e.g.</em> libdjcrypto) as far as the static and dynamic linkers are concerned. But that is risky, because if your library has both direct and indirect dependencies on libcrypto, or if a program using your library depends on libcrypto via another path, then you'll end up at run time (dynamically) linking both libraries, and possibly even using functions from both, depending on the origin of each call.</p>\n\n<p><em>Note well</em> that the above issue should be a concern for you if you link your library statically, too.  If that leaves any indirect dynamic dependencies on <code>libcrypto</code> in your library, or any dynamic dependencies from other sources in programs using your library, then you will end up with multiple versions of libcrypto in use at the same time.</p>\n\n<p><strong>Bottom line</strong></p>\n\n<p>For an <em>executable</em>, the best options are either (1) all-static linkage or (2) (for ELF) <code>RPATH</code> / <code>LD_LIBRARY_PATH</code> / <code>RUNPATH</code>, ensuring that all components require the target library via the same <code>SONAME</code>.  I tend to like providing a wrapper script that sets <code>LD_LIBRARY_PATH</code>, so that that its effect is narrowly scoped.</p>\n\n<p>For a reusable <em>library</em>, \"don't do that\" is probably the best alternative.  The high potential for ending up with programs simultaneously using two different versions of the other library (libcrypto in your case) makes all available options unattractive.  Unless, of course, you're ok with multiple library versions being used by the same program, in which case static linkage and <code>RPATH</code> / <code>RUNPATH</code> (but not <code>LD_LIBRARY_PATH</code>) are your best available alternatives.</p>\n\n<hr>\n\n<p><sup>*</sup>Note that at least some versions of <code>libtool</code> have a habit of adding RPATH entries whether you ask for them or not -- something to watch out for.  You may need to patch the libtool scripts installed in your project to avoid that.</p>\n"}], "owner": {"reputation": 58765, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "accepted_answer_id": 56152072, "answer_count": 1, "score": 2, "last_activity_date": 1557931419, "creation_date": 1557919293, "last_edit_date": 1557923106, "question_id": 56148161, "link": "https://stackoverflow.com/questions/56148161/can-i-force-a-dynamic-library-to-link-to-a-specific-dynamic-library-dependency", "title": "Can I force a dynamic library to link to a specific dynamic library dependency?", "body": "<p>I'm building an dynamic library, <code>libfoo.so</code>, which depends on <code>libcrypto.so</code>.</p>\n\n<p>Within my autotools Makefile.am file, I have a line like this:</p>\n\n<pre><code>libfoo_la_LIBADD += -L${OPENSSL_DIR}/lib -lcrypto\n</code></pre>\n\n<p>where <code>$OPENSSL_DIR</code> defaults to <code>/usr</code> but can be overridden by passing <code>--with-openssl-dir=/whatever</code>.</p>\n\n<p>How can I ensure that an executable using <code>libfoo.so</code> uses <code>${OPENSSL_DIR}/lib/libcrypto.so</code> (only) <em>without</em> the person building or running the executable having to use <code>rpath</code> or fiddle with <code>LD_LIBRARY_PATH</code>?</p>\n\n<p>As things stand, I can build <code>libfoo</code> and pass <code>--with-openssl-dir=/usr/local/openssl-special</code> and it builds fine. But when I run <code>ldd libfoo.so</code>, it just points to the <code>libcrypto.so</code> in <code>/usr/lib</code>.</p>\n\n<p>The only solution I can think of is statically linking <code>libcrypto.a</code> into <code>libfoo.so</code>. Is there any other approach possible?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1557918764, "post_id": 56147948, "comment_id": 98925315, "body": "<code>temp</code> is a pointer, but <i>where does it point?</i>"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1557918802, "post_id": 56147948, "comment_id": 98925337, "body": "Also, please don&#39;t create type-aliases of pointers. It usually makes code harder to read, understand and maintain."}, {"owner": {"reputation": 1261, "user_id": 1846228, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9a17eedf0472db2700ce6f3d8848265d?s=128&d=identicon&r=PG", "display_name": "XapaJIaMnu", "link": "https://stackoverflow.com/users/1846228/xapajiamnu"}, "edited": false, "score": 0, "creation_date": 1557918897, "post_id": 56147948, "comment_id": 98925395, "body": "As said, don&#39;t do pointer aliases. Use <code>championship * temp = malloc(..)</code>. Your problem is that you declare a pointer but you don&#39;t allocate memory for it."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1557919419, "post_id": 56147948, "comment_id": 98925661, "body": "You should always enable compiler warnings. The compiler should warn you when you use a variable that is not initialized."}, {"owner": {"reputation": 6240, "user_id": 3223157, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/s6g80.jpg?s=128&g=1", "display_name": "Xatenev", "link": "https://stackoverflow.com/users/3223157/xatenev"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1557920027, "post_id": 56147948, "comment_id": 98925985, "body": "As @Gerhardh mentioned, make sure to compile your code with the necessary flags <code>-Wall -Wextra -Wpedantic</code>"}], "answers": [{"comments": [{"owner": {"reputation": 6240, "user_id": 3223157, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/s6g80.jpg?s=128&g=1", "display_name": "Xatenev", "link": "https://stackoverflow.com/users/3223157/xatenev"}, "edited": false, "score": 1, "creation_date": 1557919793, "post_id": 56148275, "comment_id": 98925853, "body": "<code>T *p = malloc(sizeof *p)</code> is a much more robust idiom than <code>T *p = malloc(sizeof (T))</code> because there is no chance of the sizeof (T) failing to match up with the T that was used to declare p. It&#39;s also more concise and easier to read. In this case it would be <code>malloc(sizeof *temp)</code>"}, {"owner": {"reputation": 6240, "user_id": 3223157, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/s6g80.jpg?s=128&g=1", "display_name": "Xatenev", "link": "https://stackoverflow.com/users/3223157/xatenev"}, "edited": false, "score": 1, "creation_date": 1557920199, "post_id": 56148275, "comment_id": 98926094, "body": "When sizeof&#39;s operand is a type, it has to be enclosed in parentheses. But when sizeof&#39;s operand is a variable, this is not required. In your current case it has to be enclosed in parantheses."}], "tags": [], "owner": {"reputation": 2393, "user_id": 803422, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/51b462bd16ac918a8563fa50c6ce416f?s=128&d=identicon&r=PG", "display_name": "user803422", "link": "https://stackoverflow.com/users/803422/user803422"}, "is_accepted": false, "score": -1, "last_activity_date": 1557919658, "creation_date": 1557919658, "answer_id": 56148275, "question_id": 56147948, "link": "https://stackoverflow.com/questions/56147948/how-to-give-value-to-a-typedef-alias-pointer-through-function/56148275#56148275", "title": "How to give value to a typedef alias pointer through function?", "body": "<p>Change your code as follows:</p>\n\n<pre><code>typedef struct\n{\n  match matches[30];\n  team teams[6];\n  int teamno;\n  int played;\n} championship;\n\nchampionship *newchampionship(){\n    championship *temp = malloc(sizeof championship);\n    temp-&gt;played=0;\n    temp-&gt;teamno=0;\n    return temp;\n}\n\nint main(){\n   championship *ch1=newchampionship();\n   ...\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11481767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65cd5174b3fab354bd4144c30c6791f0?s=128&d=identicon&r=PG&f=1", "display_name": "DoppelG", "link": "https://stackoverflow.com/users/11481767/doppelg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557919658, "creation_date": 1557918610, "last_edit_date": 1557918857, "question_id": 56147948, "link": "https://stackoverflow.com/questions/56147948/how-to-give-value-to-a-typedef-alias-pointer-through-function", "title": "How to give value to a typedef alias pointer through function?", "body": "<p>I want to create a new <code>championship</code> in a function but whenever i give value to it the code builds but when running it stops at this part.</p>\n\n<pre><code>typedef struct\n{\n    char id[10];\n    int c;\n}team;\n\ntypedef struct\n{\n    team t1;\n    team t2;\n    int t1g;\n    int t2g;\n}match;\n\ntypedef struct\n{\n  match matches[30];\n  team teams[6];\n  int teamno;\n  int played;\n}* championship;\n\nchampionship newchampionship(){\n    championship temp;\n    temp-&gt;played=0;\n    temp-&gt;teamno=0;\n    return temp;\n}\n\nint main(){\n   championship ch1=newchampionship();\n   ...\n}\n</code></pre>\n\n<p>Whenever it gets to <code>temp-&gt;played=0;</code> the whole thing stops and the process returns with -1073741819.</p>\n\n<p>Any idea how to fix this? I just want a championship with empty arrays and 0 in the int's.</p>\n"}, {"tags": ["c", "c-strings"], "comments": [{"owner": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1557918872, "post_id": 56147943, "comment_id": 98925380, "body": "You can allocate memory for your string by using an array: <code>char military_time[] = &quot;12345678&quot;</code>. You can then write to it. You still can&#39;t return it, because it will be deleted when you leave the function. For that functions usually either return a pointer allocated by <code>malloc</code>, or they take a pointer as an argument for the function to write into (for example <code>fread</code> does this). But if you&#39;re really desperate you can make the array <code>static</code>, which means it will exist for as long as the program is active (but then it will also always take up space, even when you don&#39;t need it)"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557919088, "post_id": 56147943, "comment_id": 98925486, "body": "<code>(s[0]-48)+(s[1]-48)</code>?  Don&#39;t do that.  Use the character value <code>&#39;0&#39;</code> instead of <code>48</code>.  48 isn&#39;t guaranteed to work, <code>&#39;0&#39;</code> will always work.  48 is also confusing."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1557919312, "post_id": 56147943, "comment_id": 98925598, "body": "This always gets easier when you let the caller provide you the storage you need.  It can then decide how to allocate it and, if necessary, how to release it.  It is rarely necessary.  So the signature should be int timeConversion(const char* time, char[] result, size_t resultLen).  Use the int return value to indicate error conditions, like unconvertible time string or result buffer too small."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557919730, "post_id": 56147943, "comment_id": 98925822, "body": "<code>a[0] = &#39;2&#39;;</code> will most like cause a segmentation fault because <code>a</code> points to a read only literal."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557919828, "post_id": 56147943, "comment_id": 98925872, "body": "Though you can do: <code>char military_time[] = &quot;12345678&quot;;</code> because this copies the read-only literal to your array, which is modifiable."}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "reply_to_user": {"reputation": 1412, "user_id": 3809561, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RTS59.jpg?s=128&g=1", "display_name": "yyny", "link": "https://stackoverflow.com/users/3809561/yyny"}, "edited": false, "score": 0, "creation_date": 1557920210, "post_id": 56147943, "comment_id": 98926102, "body": "@YoYoYonnY What happens when I do it like shown in the question? Why this does not work? AndrewHenle: Yes, actually this makes far more sense. Thank you. HansPassant: Thank you; I did not mind that. However, this was a coding challenge and I cannot change the signature. PaulOgilvie: How to make it read/write?"}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557920344, "post_id": 56147943, "comment_id": 98926174, "body": "@PaulOgilvie When is something read only?"}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557920691, "post_id": 56147943, "comment_id": 98926401, "body": "@KamilCuk So what to do if you need a mutable string literal? Do not I change the literals in my code? It works fine... (until now)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557920917, "post_id": 56147943, "comment_id": 98926528, "body": "I am confused about what do you ask. You code uses <code>malloc</code>. If <code>malloc</code> calls succeeds, it returns a pointer to a valid memory region. The region&#39;s size is 9 bytes, as you requested that many. Then you ask about <code>char* military_time = &quot;12345678&quot;;</code>. But you code doesn&#39;t use any string literals. Do you want to use a string literal? There is no &quot;mutable string literal&quot; - any string literal is immutable. However, a string literal may be used as an initializer for an array. So <code>char array[9] = &quot;12345678&quot;</code>. This will initialize the same as <code>char array[9] = { &#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;,&#39;6&#39;,&#39;7&#39;,&#39;8&#39;,&#39;\\0&#39; };</code>"}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1557920934, "post_id": 56147943, "comment_id": 98926540, "body": "Something is read-only when the compiler places it in a read-only data-segment and then the Memory Manage enforces the read-only-ness. For example, if the literal string <code>&quot;Hello world&quot;</code> is used in more than one place, then the compiler may use only one occurence of the literal. Clearly that must be protected from being modified in one place so the literal remains the same in the other place."}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557931641, "post_id": 56147943, "comment_id": 98933646, "body": "Hey, unfortunately, I got blocked from StackOverflow to ask further questions. Is something with this question wrong?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557921044, "post_id": 56148554, "comment_id": 98926603, "body": "Thank you for your answer. Could you maybe just add which type of data (regarding c-string, chars and literals) gets deleted after leaving the method and which must be deleted by hand. Is it true that malloced data can exist after procedures end? I am wondering because I encountered such a problem in the same exercise."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557921379, "post_id": 56148554, "comment_id": 98926795, "body": "@TVSuchty That is really a separate question, but to put shortly, all data in <code>timeConversion</code> gets deallocated in function exit, <i>except</i> one created with <code>malloc(9*sizeof(char))</code>. It will live on until you <code>free()</code> it, or when program ends and memory gets reclaimed by your operating system."}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557921678, "post_id": 56148554, "comment_id": 98926994, "body": "So <code>char * a = &quot;brevb&quot;; return a;</code>, would not work even if I do not modify anything because <code>a</code> gets destroyed?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557922559, "post_id": 56148554, "comment_id": 98927549, "body": "@TVSuchty No, that example is fine. Literals like <code>&quot;brevb&quot;</code> live as long as your program does. <code>a</code> gets destroyed, but it doesn&#39;t matter because address of <code>&quot;brevb&quot;</code> gets returned in <code>return a;</code> before that happens."}, {"owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557923175, "post_id": 56148554, "comment_id": 98927971, "body": "This is so confusing. So the address is copied and then destroyed, while the memory pointed to is still reserved. So why can&#39;t I return an array, the return should copy the array and then destroy the inner one"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "edited": false, "score": 0, "creation_date": 1557923768, "post_id": 56148554, "comment_id": 98928355, "body": "@TVSuchty Arrays cannot be returned by value directly. This is a flaw in C language, that exists due to historical reasons. If you want to know more, you should search the web or ask a new question. This comment section is not well suited for long conversations."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": true, "score": 2, "last_activity_date": 1557920575, "creation_date": 1557920575, "answer_id": 56148554, "question_id": 56147943, "link": "https://stackoverflow.com/questions/56147943/how-to-handle-replacing-string-literals-and-why-is-allocating-on-heap-important/56148554#56148554", "title": "How to handle replacing string-literals and why is allocating on heap important?", "body": "<blockquote>\n  <p>I have heard from a coder that substituting c-string literals causes undefined behaviour. </p>\n</blockquote>\n\n<p>Correct, you must not attempt to modify string literals. They are usually placed in read-only area by the compilers.</p>\n\n<p>Pointers to string literals should be declared with <code>const</code> to avoid undefined behaviour:</p>\n\n<pre><code>char const *a = \"111\"; \na[0] = '2';            // Ok: compiler error, because assigment to const\n</code></pre>\n\n<blockquote>\n  <p>However, I do not find a way around like in the following exercise, ...</p>\n</blockquote>\n\n<p><code>char* military_time = malloc(9*sizeof(char));</code> does not create string literal, so <code>military_time[0] = tenner;</code> is fine.</p>\n\n<p>You can modify memory for which you have allocated memory for:</p>\n\n<pre><code>char b[] = \"111\";      // Create array and initialize with contents copied from literal\nb[0] = '2';            // Ok: array can be modified\n\nchar *c = malloc(4);   // Create pointer which points to malloc'd area\nstrcpy(c, \"111\");      // Copy content from literal\nc[0] = '2';            // Ok: pointer points to area that can be modified\n</code></pre>\n\n<blockquote>\n<pre><code>char* military_time = \"12345678\";\n</code></pre>\n  \n  <p>causes faulty behaviour.</p>\n</blockquote>\n\n<p>Yes, code is incorrect for the reasons stated above.</p>\n"}], "owner": {"reputation": 131, "user_id": 10082454, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KP6qr5fgbEk/AAAAAAAAAAI/AAAAAAAAAkk/cMs3fNh5hKk/photo.jpg?sz=128", "display_name": "TVSuchty", "link": "https://stackoverflow.com/users/10082454/tvsuchty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "accepted_answer_id": 56148554, "answer_count": 1, "score": 1, "last_activity_date": 1557920575, "creation_date": 1557918584, "last_edit_date": 1557920263, "question_id": 56147943, "link": "https://stackoverflow.com/questions/56147943/how-to-handle-replacing-string-literals-and-why-is-allocating-on-heap-important", "title": "How to handle replacing string-literals and why is allocating on heap important?", "body": "<p>I have heard from a coder that substituting c-string literals causes undefined behaviour. </p>\n\n<p>E.g.:</p>\n\n<pre><code>char *a = \"111\";\na[0] = '2'; //Undefinded behaviour\n</code></pre>\n\n<p>However, I do not find a way around like in the following exercise, where I have to convert 12-hours-time to military time:</p>\n\n<pre><code>char* timeConversion(char* s) {\n    char* military_time = malloc(9*sizeof(char));\n    strncpy(military_time, s,8);\n    if(s[8] == 'P'){\n       if(s[0]!='1' || s[1]!='2'){\n       char hours = 10*(s[0]-'0')+(s[1]-'0');\n       hours += 12;\n       char tenner = (hours/10) + '0';\n       char onner = hours%10 + '0';\n       military_time[0] = tenner; //undefined\n       military_time[1] = onner;\n       }\n    } else {\n        if(s[0]=='1' &amp;&amp; s[1] =='2'){\n            military_time[0] = '0';\n            military_time[1]= '0';\n        }\n    }\n    return military_time;\n}\n</code></pre>\n\n<p>Is there a way to walk around this problem?</p>\n\n<p>Furthermore, I am wondering about the behaviour of this code.\nReplacing:</p>\n\n<pre><code>char* military_time = malloc(9*sizeof(char));\n</code></pre>\n\n<p>with:</p>\n\n<pre><code>char* military_time = \"12345678\";\n</code></pre>\n\n<p>causes faulty behaviour. I do not think that in the second case the variable gets outdated. Could this be an issue of the site, where I submitted the answer?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["c", "shutdown", "keil", "8051"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557918641, "post_id": 56147866, "comment_id": 98925241, "body": "Are you really running Windows on the embedded system? I find that highly unlikely. Read the documentation for the 8051, it should tell you how to reset it <i>without</i> having to use any kind of <code>system</code> function. There should probably be thousands if not millions of documentation, tutorials and examples all over the Internet (since 8051 seems to be a very popular base for schools)."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557918647, "post_id": 56147866, "comment_id": 98925242, "body": "You have a 8051 microcontroller? And you want to shutdown your computer from the 8051 microncontroller? How is the 8051 connected to your computer? You do understand the <code>system</code> command runs on 8051 microntroller, not on you computer, right?"}, {"owner": {"reputation": 134, "user_id": 11131523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-3O9ngZPKFGo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdeFi7656jSqPOfPxvSdL-OboBLdg/mo/photo.jpg?sz=128", "display_name": "Igor Galczak", "link": "https://stackoverflow.com/users/11131523/igor-galczak"}, "edited": false, "score": 0, "creation_date": 1557918845, "post_id": 56147866, "comment_id": 98925360, "body": "You need solution to windows, linux or both? On linux works <code>FILE* c = popen(&quot;command&quot;, &quot;r&quot;);</code> and read out like from file."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557920440, "post_id": 56147866, "comment_id": 98926240, "body": "Of course you can&#39;t use Windows functions on the 8051. The way to shut down a computer is to remove the power, and the way to do that programmatically is to have a latching power switch which can be turned off by software. For example, the power button on my PC isn&#39;t the <i>actual</i> power switch: that is a relay. What you can do is to perform a <a href=\"http://www.keil.com/support/docs/762.htm\" rel=\"nofollow noreferrer\">software reset of the 8051</a>."}], "owner": {"reputation": 57, "user_id": 7716750, "user_type": "registered", "profile_image": "https://graph.facebook.com/1179830985440861/picture?type=large", "display_name": "RAZOR", "link": "https://stackoverflow.com/users/7716750/razor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557918379, "creation_date": 1557918379, "question_id": 56147866, "link": "https://stackoverflow.com/questions/56147866/how-do-i-make-the-system-function-call-work", "title": "How do I make the system function call work?", "body": "<p>I want to shutdown the computer using an 8051 on the press of a button. Everything including the circuit is working fine except the call to the system function to initiate shutdown. This is because the stdlib.h that comes with Keil C51 does not include this function.</p>\n\n<p>I have tried replacing stdlib.h with the one from MinGW and also from this(they have the system function): <a href=\"https://code.woboq.org/qt5/include/stdlib.h.html\" rel=\"nofollow noreferrer\">https://code.woboq.org/qt5/include/stdlib.h.html</a>\nBoth times compilation failed because these files generate errors(too many to fix). Then I declared my own function(see below) which makes the compilation successful but does not work, i.e., does not shutdown. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;reg51.h&gt;\n\nvoid Delay(void){\n    int j;\n    int i;\n    for(i=0;i&lt;10;i++){\n        for(j=0;j&lt;10000;j++){}\n    }\n}\n\nextern int system (const char *__command);\n\nvoid main(){\n    P1=0xFF;\n    P2=0x00;\n    while(1){\n        P2=~P1;\n        system(\"C:\\\\WINDOWS\\\\System32\\\\shutdown /s\");\n        Delay();\n    }\n}\n</code></pre>\n\n<p>When a button is pressed, the computer should shut down. However, either compilation fails or the user-defined function does nothing.</p>\n"}, {"tags": ["c", "shell", "command", "pipe"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1557917392, "post_id": 56147502, "comment_id": 98924525, "body": "There are probably millions of examples of how to do this, all over the Internet. In summary: Read about <code>pipe</code>, more about <code>fork</code>, <code>dup2</code>, and <code>exec</code>."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557917641, "post_id": 56147502, "comment_id": 98924678, "body": "See: <a href=\"http://tldp.org/LDP/lpg/node11.html\" rel=\"nofollow noreferrer\">tldp.org/LDP/lpg/node11.html</a>"}], "owner": {"reputation": 11, "user_id": 11503582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da02237a2dc278321813ecaf8d97afed?s=128&d=identicon&r=PG&f=1", "display_name": "fokfoksootsoot", "link": "https://stackoverflow.com/users/11503582/fokfoksootsoot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557917301, "creation_date": 1557917186, "last_edit_date": 1557917301, "question_id": 56147502, "link": "https://stackoverflow.com/questions/56147502/implementing-piping-for-c-shell-project", "title": "Implementing Piping for C shell project", "body": "<p>So I have a project that involves creating a simple shell in C and one of the features is to support piping, e.g., a program like:</p>\n\n<p>./a.out | ./b.out\nwould redirect the stdout from ./a.out to the stdin of ./b.out</p>\n\n<p>The instructions in my assignment state to use 2 fork() calls, one for each command.</p>\n\n<p>Here is what I have so far... but I have no idea how to use 2 fork calls and what to even do exactly...I would greatly appreciate any tips! Thanks!</p>\n\n<pre><code>void doPipe()\n{\n    // here I have 2 int arrays that will be passed in to pipe(),\n    // since pipe takes in an int array of file descriptors to know \n    // where to get input and store output\n    int p1[2] = {STDIN_FILENO, STDOUT_FILENO};\n    int p2[2] = {STDIN_FILENO, STDOOUT_FILENO};\n\n    // here i fork to run child process\n    pid_t pID = fork();\n\n    if (pID == 0} { do stuff in child; }\n    else { do stuff in parent;}\n}\n</code></pre>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 5, "creation_date": 1557916026, "post_id": 56147060, "comment_id": 98923710, "body": "Its undefined behaviour, you are returning an address to an object which no longer exists after the call to f() ends."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1557916032, "post_id": 56147060, "comment_id": 98923713, "body": "<code>return &amp;node;</code>: Dangling pointer innit."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 4, "creation_date": 1557916076, "post_id": 56147060, "comment_id": 98923743, "body": "All local variables vanish as soon as the function they are declare in returns. That&#39;s what the compiler is telling you. It&#39;s actually more than a warning, because this is always wrong."}, {"owner": {"reputation": 413, "user_id": 10518032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d91471cd13b1f82257c4311a9e213753?s=128&d=identicon&r=PG&f=1", "display_name": "nm_tp", "link": "https://stackoverflow.com/users/10518032/nm-tp"}, "edited": false, "score": 2, "creation_date": 1557916159, "post_id": 56147060, "comment_id": 98923804, "body": "I believe that, in gcc, it will not be cleared, just overwritten in the next function call. Since you are accessing <code>node-&gt;x</code> and <code>node-&gt;y</code> in main, with no other function called after <code>f</code>, nothing had a chance to overwrite the values. The first printf probably does the overwrite so that the second one gets rubbish or an error."}, {"owner": {"reputation": 22489, "user_id": 3208297, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/KzpAh.jpg?s=128&g=1", "display_name": "blue_note", "link": "https://stackoverflow.com/users/3208297/blue-note"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557916168, "post_id": 56147060, "comment_id": 98923810, "body": "@Jabberwocky: that&#39;s my point. It does not. It printst the correct result for 1-2 times, and after that it vanishes."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1557916204, "post_id": 56147060, "comment_id": 98923833, "body": "<i>It printst the correct result for 1-2 times</i> Undefined behavior is undefined."}, {"owner": {"reputation": 35613, "user_id": 7582247, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OH0qZNY40Y4/AAAAAAAAAAI/AAAAAAAABbc/xAoU3i299E0/photo.jpg?sz=128", "display_name": "Ted Lyngmo", "link": "https://stackoverflow.com/users/7582247/ted-lyngmo"}, "edited": false, "score": 1, "creation_date": 1557916205, "post_id": 56147060, "comment_id": 98923834, "body": "The behaviour is undefined - so it can print whatever it likes, or not."}, {"owner": {"reputation": 1755, "user_id": 5986881, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7a607dd49a0116e3ba869a66d6fd1ba0?s=128&d=identicon&r=PG", "display_name": "Samer Tufail", "link": "https://stackoverflow.com/users/5986881/samer-tufail"}, "edited": false, "score": 1, "creation_date": 1557916209, "post_id": 56147060, "comment_id": 98923840, "body": "why does it matter when it disappears? its UB."}, {"owner": {"reputation": 7865, "user_id": 2331956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ede184a71447fbba327ad6190c079888?s=128&d=identicon&r=PG", "display_name": "Mike Vine", "link": "https://stackoverflow.com/users/2331956/mike-vine"}, "edited": false, "score": 1, "creation_date": 1557916220, "post_id": 56147060, "comment_id": 98923852, "body": "Its never cleared. Accessing that stack variable is undefined behavoir and so technically anything can happen, including somewhat contradictory things such as printing the value twice gives different answerts.  On a more technical level, although you shouldn&#39;t rely on this but its sometimes interesting to understand whats actually happening, is that the space that the variable in is still unused and so you can access it to call printf on it. However, the call to <code>printf</code> itself uses stack and writes over the value you left behind and were erronesouly accessing."}, {"owner": {"reputation": 187, "user_id": 3733334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e39a8a702cb94d44e344727625120f1?s=128&d=identicon&r=PG&f=1", "display_name": "mcabreb", "link": "https://stackoverflow.com/users/3733334/mcabreb"}, "edited": false, "score": 1, "creation_date": 1557916572, "post_id": 56147060, "comment_id": 98924064, "body": "It&#39;s undefined behaviour, so it can do whatever it pleases. It could even erase your hard drive. Check <a href=\"https://stackoverflow.com/questions/18506029/can-undefined-behavior-erase-the-hard-drive\" title=\"can undefined behavior erase the hard drive\">stackoverflow.com/questions/18506029/&hellip;</a>"}, {"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 1, "creation_date": 1557916593, "post_id": 56147060, "comment_id": 98924074, "body": "In this case the &quot;correct&quot; result is just a mirage"}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1557918322, "post_id": 56147060, "comment_id": 98925048, "body": "@blue_note -- Unlike other languages you may have used, C++ has a concept called <i>undefined behavior</i>.   Think of it this way -- if you had your drivers license revoked, does that mean you can&#39;t get into a car and drive it?  Just because something is illegal doesn&#39;t mean you are stopped from doing it.  The thing you need to be aware of is that anything can happen doing the illegal action.  You may be stopped by a policeman after driving the car 100 feet, or you could drive for years and not be stopped.  Your program could crash right away, or run for years and not show any issues."}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557960691, "post_id": 56147060, "comment_id": 98945946, "body": "A number of comments here comment on \u201cundefined behavior\u201d and imply or suggest the causes cannot be known or that inquiry is pointless. These comments are misguided at best. First, \u201cundefined behavior\u201d in the C standard merely means the standard imposes no requirements. There are other causes than the C standard, and it is worth inquiring about these, because it is useful to know how compilers work, how various features of C can be or are typically implemented, and how hardware works.\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557960813, "post_id": 56147060, "comment_id": 98945975, "body": "\u2026 For example, the pattern of an object apparently having a desired value immediately after a function return but not after a successive call is a big clue that there is a bug of returning the address of a local object. So knowledge of this pattern, and its cause in how the stack is used, can aid debugging. Additionally, understanding how the compiler uses the stack to implement function calls and local objects can aid in designing good programs or, ultimately, implementing compilers.\u2026"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1557960965, "post_id": 56147060, "comment_id": 98946006, "body": "\u2026 We should understand that many people who ask these questions are not trying to learn what the C standard says about the situation but about how software and hardware is acting. The author of this question gives indications of this: they acknowledge the compiler warning and acknowledge the use and alteration of the stack. This curiosity should be satisfied: Imparting knowledge, not just of the <b>abstract</b> C model but of <b>actual</b> implementation is a good thing. The knowledge is valuable and useful and should not be fobbed off as \u201cundefined behavior.\u201d"}], "owner": {"reputation": 22489, "user_id": 3208297, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/KzpAh.jpg?s=128&g=1", "display_name": "blue_note", "link": "https://stackoverflow.com/users/3208297/blue-note"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "closed_date": 1557916139, "answer_count": 0, "score": 1, "last_activity_date": 1557916266, "creation_date": 1557915860, "last_edit_date": 1557916266, "question_id": 56147060, "link": "https://stackoverflow.com/questions/56147060/c-when-is-function-stack-cleared", "closed_reason": "Duplicate", "title": "C: when is function stack cleared?", "body": "<p>I wrote the following code </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"stdio.h\"\n\nstruct node {\n    int x;\n    int y;\n};\ntypedef struct node Node;\n\nNode * f() {\n    Node node = {1, 2};\n    return &amp;node;\n}\n\nint main() {\n    Node *node = f();\n    printf(\"(%d, %d)\", node-&gt;x, node-&gt;y);\n    printf(\"(%d, %d)\", node-&gt;x, node-&gt;y);\n}\n</code></pre>\n\n<p>During compilation, I get <code>warning: address of stack memory associated with local variable 'node' returned</code> warning. </p>\n\n<p>However, the <code>printf</code> </p>\n\n<ul>\n<li>prints the correct result the first time</li>\n<li>prints the wrong result the second time</li>\n</ul>\n\n<p>This brings me to my question: <strong>when exactly</strong> is the stack of the call to <code>f()</code> cleared??</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1557915228, "post_id": 56146818, "comment_id": 98923218, "body": "Where is the infinite loop in your code? There is only one loop (the <code>while</code> loop) and that has a definite termination clause"}, {"owner": {"reputation": 1, "user_id": 11408586, "user_type": "registered", "profile_image": "https://graph.facebook.com/2356891044590225/picture?type=large", "display_name": "Long Nguy\u1ec5n", "link": "https://stackoverflow.com/users/11408586/long-nguy%e1%bb%85n"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1557915278, "post_id": 56146818, "comment_id": 98923250, "body": "I&#39;m posting this question because I don&#39;t know where to put them in"}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "edited": false, "score": 0, "creation_date": 1557915314, "post_id": 56146818, "comment_id": 98923274, "body": "what are you trying to do? it&#39;ll be better if you add additional information about what you want to get and what you actually get"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557915323, "post_id": 56146818, "comment_id": 98923280, "body": "Do you mean you want an infinite loop which asks the user for another number?"}, {"owner": {"reputation": 1, "user_id": 11408586, "user_type": "registered", "profile_image": "https://graph.facebook.com/2356891044590225/picture?type=large", "display_name": "Long Nguy\u1ec5n", "link": "https://stackoverflow.com/users/11408586/long-nguy%e1%bb%85n"}, "edited": false, "score": 0, "creation_date": 1557915389, "post_id": 56146818, "comment_id": 98923314, "body": "Yes. So what I was trying is that after it make the adding and print out the answer, the user press a button and then continuing to input another number"}], "answers": [{"comments": [{"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 1, "creation_date": 1557915684, "post_id": 56146979, "comment_id": 98923490, "body": "At some time program needs to have gracious exiting, please handle that too."}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557916041, "post_id": 56146979, "comment_id": 98923718, "body": "That would be a great option to have"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557916126, "post_id": 56146979, "comment_id": 98923777, "body": "Made <code>scanf(&quot;%c&quot;,&amp;quit);</code> --&gt;<code>scanf(&quot; %c&quot;,&amp;quit);</code> in case <code>\\n</code> is left out in stream."}, {"owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "reply_to_user": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 0, "creation_date": 1557916315, "post_id": 56146979, "comment_id": 98923916, "body": "@kiranBiradar is that working to clear the input buffer? I didnt know that option"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557918441, "post_id": 56146979, "comment_id": 98925133, "body": "It just clears the whitespace in the input buffer. Most format specifiers for <code>scanf</code> automatically filter any leading whitespace, but <code>%c</code> and <code>%[]</code> do not (so that the whitespace characters <i>can</i> be read if required to) but the added space instructs <code>scanf</code> to filter the whitespace."}], "tags": [], "owner": {"reputation": 175, "user_id": 9431030, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DiO1cugRDI4/AAAAAAAAAAI/AAAAAAAAALc/TUnnCgQJvBI/photo.jpg?sz=128", "display_name": "Yoni Newman", "link": "https://stackoverflow.com/users/9431030/yoni-newman"}, "is_accepted": false, "score": 4, "last_activity_date": 1557916207, "last_edit_date": 1557916207, "creation_date": 1557915618, "answer_id": 56146979, "question_id": 56146818, "link": "https://stackoverflow.com/questions/56146818/is-there-any-way-to-make-this-adding-an-infinite/56146979#56146979", "title": "Is there any way to make this adding an infinite?", "body": "<p>Just add an infinite loop inside your main function like that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint SUM(int a){\nint sum=0;\nwhile(a&gt;0){\n    sum =sum+(a%10);\n\n    a=a/10;\n\n}\n\nreturn sum;\n}\n\nint main(){\n    int x;\n    char quit = 'n';\n    do{\n        printf(\"Enter an integer = \");\n\n        scanf(\"%d\", &amp;x);\n\n        printf(\"Sum digit = %d\", SUM(x));\n\n        //exiting option \n        printf(\"Quit the program? [y/n]\");\n        scanf(\" %c\",&amp;quit);\n    }while(quit !='y' &amp;&amp; quit != 'Y');   \n}\n</code></pre>\n\n<p>also, the line that contain the SUM(x) function before the printf is redundant.</p>\n\n<p>EDIT: I inserted an option to quit the inifinite loop at the end of each iteration - if you dont want that option, just change it to <code>while(1)</code> and delete both of the printing and scanf commands before the end.</p>\n"}, {"tags": [], "owner": {"reputation": 704, "user_id": 8423763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UMZgw.jpg?s=128&g=1", "display_name": "shubhamr238", "link": "https://stackoverflow.com/users/8423763/shubhamr238"}, "is_accepted": false, "score": 0, "last_activity_date": 1557916905, "creation_date": 1557916905, "answer_id": 56147406, "question_id": 56146818, "link": "https://stackoverflow.com/questions/56146818/is-there-any-way-to-make-this-adding-an-infinite/56147406#56147406", "title": "Is there any way to make this adding an infinite?", "body": "<p>I think you are trying to implement the infinite loop so that the sum value retains and another sum value can be added to it.\nHope this code Helps!!\nOtherwise kindly improve your question</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint SUM(int a)\n{\n        int sum=0;\n        while(a&gt;0)\n        {\n                sum =sum+(a%10);\n                a=a/10;\n        }\n        return sum;\n}\n\nint main()\n{\n        int x,choice,result=0;\n        while(1)\n        {\n                printf(\"**MENU**\\n\");\n                printf(\"1. Perform Sum\\n\");\n                printf(\"2. Result\\n\");\n                printf(\"3. Exit\\n\");\n                printf(\"Choose:\");\n                scanf(\"%d\",&amp;choice);\n                switch(choice)\n                {\n                case 1:\n                        printf(\"Enter an integer = \");\n                        scanf(\"%d\", &amp;x);\n                        result+=SUM(x);\n                        break;\n                case 2:\n                        printf(\"Sum digit = %d\\n\", result);\n                        break;\n                case 3:\n                        printf(\"Final Result = %d\\n\",result);\n                        exit(0);\n                default:\n                        printf(\"Try Again!\\n\");\n                }\n\n        }\n        return(0);\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11408586, "user_type": "registered", "profile_image": "https://graph.facebook.com/2356891044590225/picture?type=large", "display_name": "Long Nguy\u1ec5n", "link": "https://stackoverflow.com/users/11408586/long-nguy%e1%bb%85n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557924297, "creation_date": 1557915092, "last_edit_date": 1557924297, "question_id": 56146818, "link": "https://stackoverflow.com/questions/56146818/is-there-any-way-to-make-this-adding-an-infinite", "title": "Is there any way to make this adding an infinite?", "body": "<p>So I tried to make this a infinite loop of input for user and adding it. But it just end at the end. Please help</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint SUM(int a)\n{\n  int sum = 0;\n  while (a &gt; 0) \n  {\n    sum = sum + (a % 10);\n    a = a / 10;\n  }\n  return sum;\n}\n\nint main()\n{\n  int x;\n  printf(\"Enter an integer = \");\n\n  scanf(\"%d\", &amp;x);\n\n  SUM(x);\n\n  printf(\"Sum digit = %d\", SUM(x));\n}\n</code></pre>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1557917714, "post_id": 56146769, "comment_id": 98924719, "body": "I added the gcc tag since this code isn&#39;t valid C but a gcc non-standard extension."}], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "edited": false, "score": 0, "creation_date": 1557915571, "post_id": 56146901, "comment_id": 98923414, "body": "aaaahhhhhhhh, of course... how silly of me... thank you :)"}], "tags": [], "owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1557918509, "last_edit_date": 1557918509, "creation_date": 1557915377, "answer_id": 56146901, "question_id": 56146769, "link": "https://stackoverflow.com/questions/56146769/initialize-all-struct-members-of-struct-array-in-c-using-designated-intializers/56146901#56146901", "title": "Initialize all struct members of struct array in C, using designated intializers range", "body": "<p>You are exceeding array bounds with <code>0 ... NODELIST_LEN</code>. You have to stop at <code>NODELIST_LEN - 1</code>.</p>\n\n<p>The below will work:</p>\n\n<pre><code>DW_nodelist dw_list = {\n    .list[0 ... NODELIST_LEN-1].dev_status = DW_DEV_DISABLED\n};\n</code></pre>\n\n<p>Note that the usage of <code>...</code> (specifying a range of elements) is a GCC-specific extension not supported by standard C.</p>\n\n<p>The GCC compiler warns if you use the <code>-Wpedantic</code> option.</p>\n\n<blockquote>\n<pre><code>warning: ISO C forbids specifying range of elements to initialize [-Wpedantic]\n   13 |     .list[0 ... NODELIST_LEN-1].dev_status = DW_DEV_DISABLED\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1557930460, "creation_date": 1557930460, "answer_id": 56151754, "question_id": 56146769, "link": "https://stackoverflow.com/questions/56146769/initialize-all-struct-members-of-struct-array-in-c-using-designated-intializers/56151754#56151754", "title": "Initialize all struct members of struct array in C, using designated intializers range", "body": "<p>In case someone wonders how to do the same with pure standard C language, it is a bit trickier. Given this:</p>\n\n<pre><code>#define DW_DEV_DISABLED 666\n#define NODELIST_LEN 32\n\ntypedef int DW_data;\ntypedef struct{\n  DW_data list[NODELIST_LEN];\n}DW_nodelist;\n</code></pre>\n\n<p>We could cook up a macro for array initialization like this:</p>\n\n<pre><code>DW_nodelist dw_list = \n{ \n  .list = { INIT(NODELIST_LEN, DW_DEV_DISABLED) } \n};\n</code></pre>\n\n<p>Where the first argument to the macro is the number of items to initialize and the second is the value. So here we want to set 32 items to some non-zero value. It is possible in standard C, but we need to declare a lot of macros like these:</p>\n\n<pre><code>#define INIT_1(val)  val\n#define INIT_2(val)  INIT_1(val),  INIT_1(val)\n#define INIT_4(val)  INIT_2(val),  INIT_2(val)\n#define INIT_10(val) INIT_4(val),  INIT_4(val),  INIT_2(val)\n#define INIT_32(val) INIT_10(val), INIT_10(val), INIT_10(val), INIT_2(val)\n</code></pre>\n\n<p>And then we can call these with another macro to make it all somewhat variable:</p>\n\n<pre><code>#define PREPROC(n, val) INIT_##n(val)\n#define INIT(n, val) PREPROC(n, val)\n</code></pre>\n"}], "owner": {"reputation": 671, "user_id": 9479013, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iQACf.png?s=128&g=1", "display_name": "BitShift", "link": "https://stackoverflow.com/users/9479013/bitshift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 56146901, "answer_count": 2, "score": 1, "last_activity_date": 1557930460, "creation_date": 1557914940, "last_edit_date": 1557917719, "question_id": 56146769, "link": "https://stackoverflow.com/questions/56146769/initialize-all-struct-members-of-struct-array-in-c-using-designated-intializers", "title": "Initialize all struct members of struct array in C, using designated intializers range", "body": "<p>I cannot get designated initialiser syntax working when using a range. I know that designated initialisers are possible with arrays, and I want to initialize a struct array so that all members are the same at boot. </p>\n\n<p>EDIT: error is </p>\n\n<blockquote>\n  <p>error: array index range in initializer exceeds array bounds    32 |<br>\n  [0 ... NODELIST_LEN].dev_status = DW_DEV_DISABLED</p>\n</blockquote>\n\n<pre><code>typedef struct {\n  int dev_status;\n}DW_data; \n\ntypedef struct{\n  DW_data list[NODELIST_LEN];\n}DW_nodelist;\n</code></pre>\n\n<p>I have tried the following: </p>\n\n<pre><code>DW_nodelist dw_list = {\n    .list[0 ... NODELIST_LEN].dev_status = DW_DEV_DISABLED\n}\n\nDW_nodelist dw_list = {\n    .list = {\n        [0 ... NODELIST_LEN].dev_status = DW_DEV_DISABLED\n    }\n}\n</code></pre>\n\n<p>I even gave these a whirl just for laughs:</p>\n\n<pre><code>DW_nodelist dw_list = {\n    .list = {\n        .dev_status[0 ... NODELIST_LEN] = DW_DEV_DISABLED\n    }\n}\n\nDW_nodelist dw_list = {\n    .list = [0 ... NODELIST_LEN].dev_status = DW_DEV_DISABLED\n}\n</code></pre>\n\n<p>What am I doing wrong, is this even possible with a struct array?</p>\n"}, {"tags": ["c", "for-loop", "printf", "scanf"], "comments": [{"owner": {"reputation": 25106, "user_id": 6699433, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1mOTM.jpg?s=128&g=1", "display_name": "klutt", "link": "https://stackoverflow.com/users/6699433/klutt"}, "edited": false, "score": 1, "creation_date": 1557914751, "post_id": 56146631, "comment_id": 98922922, "body": "Why are you using turbo c? It&#39;s outdated."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557914925, "post_id": 56146631, "comment_id": 98923032, "body": "Hint: don&#39;t use Turbo C. This tool is older than you. There are many alternatives, and most (if not all) of them are better than Turbo C. And please, don&#39;t post pictures of text, but post text instead."}, {"owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557914990, "post_id": 56146631, "comment_id": 98923079, "body": "I use codeblocks mainly but using tubo for checking the code"}, {"owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557915067, "post_id": 56146631, "comment_id": 98923115, "body": "Hey user3121023, what is benefit of adding printf statement in code then?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557915869, "post_id": 56146631, "comment_id": 98923614, "body": "<i>&quot; but using tubo for checking the code&quot;</i> : so why can&#39;t you &quot;check the code&quot; (whatever this is supposed to mean) in Codeblocks??"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1557915986, "post_id": 56146631, "comment_id": 98923682, "body": "<code>scanf</code> puts the cursor to the beginning of the next line. That&#39;s the way <code>scanf</code> works, you can&#39;t do anything about that."}], "answers": [{"comments": [{"owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557914809, "post_id": 56146661, "comment_id": 98922963, "body": "Why I am not getting a tab space after evey input? and how to enter input without pressing enter in the above code"}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557914984, "post_id": 56146661, "comment_id": 98923073, "body": "Enter all the numbers at once and press enter only once."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "reply_to_user": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 1, "creation_date": 1557915311, "post_id": 56146661, "comment_id": 98923272, "body": "You need to give space between each number while inputting."}, {"owner": {"reputation": 98, "user_id": 10890006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Df6aUhOcH3w/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZK6dlaWVpZoSRCQGr0oXzu7O8lOQ/mo/photo.jpg?sz=128", "display_name": "m.k", "link": "https://stackoverflow.com/users/10890006/m-k"}, "reply_to_user": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 2, "creation_date": 1557916645, "post_id": 56146661, "comment_id": 98924102, "body": "@RohitKumarShrivastava you only asked why are those two outputs different and i believe kiran answered that. what kind of output do you actually want and what should your input look like? could you give us an example of that?"}, {"owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "reply_to_user": {"reputation": 98, "user_id": 10890006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Df6aUhOcH3w/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZK6dlaWVpZoSRCQGr0oXzu7O8lOQ/mo/photo.jpg?sz=128", "display_name": "m.k", "link": "https://stackoverflow.com/users/10890006/m-k"}, "edited": false, "score": 0, "creation_date": 1557917047, "post_id": 56146661, "comment_id": 98924322, "body": "@m.k I want the output of both the codes as the output of second code."}, {"owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557917106, "post_id": 56146661, "comment_id": 98924361, "body": "The way @kiranBiradar told, stores that value(entered without pressing enter) to a[0] only."}, {"owner": {"reputation": 98, "user_id": 10890006, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Df6aUhOcH3w/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZK6dlaWVpZoSRCQGr0oXzu7O8lOQ/mo/photo.jpg?sz=128", "display_name": "m.k", "link": "https://stackoverflow.com/users/10890006/m-k"}, "reply_to_user": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "edited": false, "score": 0, "creation_date": 1557917207, "post_id": 56146661, "comment_id": 98924422, "body": "@RohitKumarShrivastava well you can use a for loop just to scan inputs and then use a second for loop to print your output as in the second code"}], "tags": [], "owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "is_accepted": false, "score": 2, "last_activity_date": 1557914591, "creation_date": 1557914591, "answer_id": 56146661, "question_id": 56146631, "link": "https://stackoverflow.com/questions/56146631/for-loop-is-iterating-printf-written-after-scanf-only-once/56146661#56146661", "title": "for loop is iterating printf written after scanf only once", "body": "<p>In first code you press enter after inputting the each input thus you see new line after each entry.</p>\n\n<p>In second code you are not printing newline through code nor manually.</p>\n\n<p>To print new line append <code>\\n</code> as below.</p>\n\n<pre><code> printf(\"\\t\\n\");\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 10826362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jPLAc.jpg?s=128&g=1", "display_name": "Rohit Kumar Shrivastava", "link": "https://stackoverflow.com/users/10826362/rohit-kumar-shrivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1557922511, "creation_date": 1557914503, "question_id": 56146631, "link": "https://stackoverflow.com/questions/56146631/for-loop-is-iterating-printf-written-after-scanf-only-once", "title": "for loop is iterating printf written after scanf only once", "body": "<p>I want to store array elements using for loop with a tap space.But tab is printed only once and then it doesn't work.\nThe code is following-</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\nvoid main()\n{\n  int i,a[10];\n  clrscr();\n  printf(\"Enter array elements: \\n\");\n  for(i=0;i&lt;5;i++)\n  {\n     scanf(\"%d\",&amp;a[i]);\n     printf(\"\\t\");\n  }\n  getch();\n}\n</code></pre>\n\n<p>The output of above code is-\n<a href=\"https://i.stack.imgur.com/MSvvg.png\" rel=\"nofollow noreferrer\">Output of above code in TurboC++</a></p>\n\n<p>I have tried CodeBlocks also but the output is same.\nOn the other hand when I use this code-</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include&lt;stdio.h&gt;\nint main()\n{\n  int i,a[5]={1,2,3,4,5};\n  for(i=0;i&lt;5;i++)\n  {\n     printf(\"%d\",a[i]);\n     printf(\"\\t\");\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The output is following-\n<a href=\"https://i.stack.imgur.com/wcTmj.png\" rel=\"nofollow noreferrer\">Compilor-CodeBlocks.</a></p>\n\n<p>Why the output is different for the codes?</p>\n"}, {"tags": ["c", "reference", "cudd"], "comments": [{"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1557914491, "post_id": 56146565, "comment_id": 98922757, "body": "I am suspecting necessary cudd libraries not linked correctly. Are you linking those statically or dynamically?"}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "reply_to_user": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1557914747, "post_id": 56146565, "comment_id": 98922919, "body": "I am linking the library during the compilation by adding the path of cudd.h, util.h and configure file with gcc. Is that the source of problem ? But , I think libraries are linked properly because , when I have tried the trivial program of displaying &quot;Hello World&quot; using those headers in the program , it worked properly."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557914968, "post_id": 56146565, "comment_id": 98923057, "body": "<code>I am linking the library during the compilation by adding the path of cudd.h</code> - no you are not. There are no <code>-lcudd</code> or similar lines in your command. You are setting include search paths with <code>-I</code> commands. Not linking. Can you post the output of <code>find &#47;home&#47;subhadip&#47;cudd-3.0.0 -name &#39;*.so</code> or similar? Are there any shared libraries inside <code>cudd-3.0.0</code>? How did you configured and compiled cudd library?"}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557915445, "post_id": 56146565, "comment_id": 98923337, "body": "@KamilCuk I have used ./configure, make, make check to configure the cudd library. I am not sure if there is any shared library in cudd-3.0.0."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557915602, "post_id": 56146565, "comment_id": 98923430, "body": "So, according to the README (which I hope you read), you have built the static libraries. So find them. You search for files with <code>.a</code> extension, ie. <code>find &#47;home&#47;subhadip&#47;cudd-3.0.0 -name &#39;*.a&#39;</code>,  probably <code>cudd.a</code> or <code>libcudd.a</code>. ( I think it&#39;s probably in the <code>.libs</code> directory, but that&#39;s a guess )."}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557916132, "post_id": 56146565, "comment_id": 98923780, "body": "@KamilCuk I found the following as you have told. /home/subhadip/cudd-3.0.0/cplusplus/.libs/libobj.a                                                       /home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a  /home/subhadip/cudd-3.0.0/dddmp/.libs/libdddmp.a . Now what should I do to fix the problem ?"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557917177, "post_id": 56147227, "comment_id": 98924400, "body": "I used ` gcc  -I /home/subhadip/cudd-3.0.0 -I /home/subhadip/cudd-3.0.0/util -I /home/subhadip/cudd-3.0.0/cudd  transfer1.c -I /home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a  -o transfer1 &#39; . But I am getting the same error."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 1, "creation_date": 1557917856, "post_id": 56147227, "comment_id": 98924810, "body": "Not <code>-I</code>, there is no <code>-I</code> before <code>.a</code> file in my command. Just treat the <code>.a</code> file as a source file. <code>gcc -I &#47;home&#47;subhadip&#47;cudd-3.0.0 -I &#47;home&#47;subhadip&#47;cudd-3.0.0&#47;util -I &#47;home&#47;subhadip&#47;cudd-3.0.0&#47;cudd transfer1.c &#47;home&#47;subhadip&#47;cudd-3.0.0&#47;cudd&#47;.libs&#47;libcudd.a -o transfer1</code>"}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557918936, "post_id": 56147227, "comment_id": 98925413, "body": "I have tried with the command which you have mentioned. This time I am getting different set of errors. So I have modified the question and mentioned it there."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 2, "creation_date": 1557919059, "post_id": 56147227, "comment_id": 98925468, "body": "You need to link math library. Add <code>-lm</code> after <code>.a</code> file. <code>...&#47;.libs&#47;libcudd.a -lm -o transfer1</code>. <code>log</code> calculates logarithm and <code>exp</code> calculates e-base exponential function value and <code>pow</code> takes a number to the power of another number. These are function from the C standard math library."}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557919303, "post_id": 56147227, "comment_id": 98925591, "body": "It compiled. But during running I get some segmentation fault. Now the output is : DdManager nodes: 4 | DdManager vars: 1 | DdManager reorderings: 0 | DdManager memory: 10523080  : 3 nodes 2 leaves 2 minterms ID =  0x9bc15\tindex = 0\tT = 1        \tE =  0          1  1  Segmentation fault (core dumped)"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557919722, "post_id": 56147227, "comment_id": 98925817, "body": "Well, your code may be full of errors, you didn&#39;t check any return values and such. Good luck. I have none experience in CUDD library. You can ask another question if you can&#39;t resolve your problem, maybe someone willing and experienced in CUDD will come by."}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557919860, "post_id": 56147227, "comment_id": 98925890, "body": "Well, By checking the return value , are you referring if fopen() returns NULL then we should terminate ?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "reply_to_user": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "edited": false, "score": 0, "creation_date": 1557919994, "post_id": 56147227, "comment_id": 98925968, "body": "<code>fopen</code> <code>malloc</code> <code>Cudd_Init</code> <code>Cudd_bddNewVar</code> and <code>Cudd_BddToAdd</code> . All functions that return value that can be checked for errors."}, {"owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557920083, "post_id": 56147227, "comment_id": 98926028, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/193391/discussion-between-subhadip-and-kamil-cuk\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": true, "score": 1, "last_activity_date": 1557916376, "creation_date": 1557916376, "answer_id": 56147227, "question_id": 56146565, "link": "https://stackoverflow.com/questions/56146565/cudd-package-undefined-reference-during-compilation/56147227#56147227", "title": "CUDD package : Undefined reference during compilation", "body": "<p>You compiled cudd and generated a static library. Now you need to link with it:</p>\n\n<pre><code>gcc .. &lt;other options&gt; ... transfer1.c /home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a -o transfer1\n</code></pre>\n\n<p>Note that the order of files matter.</p>\n\n<p>I can guess that for C++ support you have to link with <code>cplusplus/.libs/libobj.a</code> and for dddmp support you need symbols exported in <code>dddmp/.libs/libdddmp.a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 330, "user_id": 7561599, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-dLvCt3wo_Ec/AAAAAAAAAAI/AAAAAAAAAFs/ea7rBaBajkM/photo.jpg?sz=128", "display_name": "Aadil Hoda", "link": "https://stackoverflow.com/users/7561599/aadil-hoda"}, "is_accepted": false, "score": 1, "last_activity_date": 1576564080, "creation_date": 1576564080, "answer_id": 59368677, "question_id": 56146565, "link": "https://stackoverflow.com/questions/56146565/cudd-package-undefined-reference-during-compilation/59368677#59368677", "title": "CUDD package : Undefined reference during compilation", "body": "<p>After using the above solution, if the error still persists,\nFor me, I have not made the folder named 'bdd' in the proper location for the code line:</p>\n\n<pre><code>sprintf(filename, \"./bdd/graph.dot\");\n</code></pre>\n\n<p>Now, it is executing for me.</p>\n"}], "owner": {"reputation": 155, "user_id": 7871434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/309b6d9b242b03ae38a9d6c97e686861?s=128&d=identicon&r=PG&f=1", "display_name": "Subhadip", "link": "https://stackoverflow.com/users/7871434/subhadip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 56147227, "answer_count": 2, "score": 0, "last_activity_date": 1593055445, "creation_date": 1557914288, "last_edit_date": 1557918825, "question_id": 56146565, "link": "https://stackoverflow.com/questions/56146565/cudd-package-undefined-reference-during-compilation", "title": "CUDD package : Undefined reference during compilation", "body": "<p>I am learning CUDD package for research purposes. I have got one sample code from which I have tried to learn the basic functionalities. But I am getting error during compilation.</p>\n\n<p>I have already set the paths for the header.</p>\n\n<pre><code>#include &lt;sys/types.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"cudd.h\"\n#include \"util.h\"\n\nvoid print_dd(DdManager *gbm, DdNode *dd, int n, int pr)\n{\n    printf(\"Ddmanager nodes : %ld \\n\",Cudd_ReadNodeCount(gbm)); \n    printf(\"Ddmanager vars : %d \\n\",Cudd_ReadSize(gbm)); \n    printf(\"Ddmanager reorderings :%d\\n\",Cudd_ReadReorderings(gbm));\n    printf(\"DdManager memory % ld\",Cudd_ReadMemoryInUse(gbm));\n    Cudd_PrintDebug(gbm,dd,n,pr);\n}\n\nvoid write_dd(DdManager *gbm, DdNode *dd, char * filename)\n{\n   FILE *outfile; \n   outfile=fopen(filename,\"w\");\n   DdNode **ddnodearray=(DdNode **)malloc(sizeof(DdNode*));\n   ddnodearray[0]=dd;\n   Cudd_DumpDot(gbm,1,ddnodearray,NULL,NULL,outfile);\n   free(ddnodearray);\n   fclose(outfile);\n}\n\nint main(int argc, char *argv[])\n{\n    DdManager *gbm;\n    char filename[30];\n    gbm=Cudd_Init(0,0,CUDD_UNIQUE_SLOTS,CUDD_CACHE_SLOTS,0);\n    DdNode *bdd=Cudd_bddNewVar(gbm);\n    Cudd_Ref(bdd);\n    bdd=Cudd_BddToAdd(gbm,bdd);\n    print_dd(gbm,bdd,2,4);\n    sprintf(filename,\"./bdd/graph.dot\");\n    write_dd(gbm,bdd,filename);\n    Cudd_Quit(gbm);\n    return 0;       \n}\n</code></pre>\n\n<p>I am getting some error during compilation.</p>\n\n<pre><code> gcc -I /home/subhadip/cudd-3.0.0 -I /home/subhadip/cudd-3.0.0/util -I /home/subhadip/cudd-3.0.0/cudd transfer1.c /home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a -o transfer1 \n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddAPI.o): In function `Cudd_ExpectedUsedSlots':\n/home/subhadip/cudd-3.0.0/cudd/cuddAPI.c:1835: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/cuddAPI.c:1844: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/cuddAPI.c:1850: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddCache.o): In function `cuddCacheProfile':\n/home/subhadip/cudd-3.0.0/cudd/cuddCache.c:816: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddUtil.o): In function `Cudd_CountMinterm':\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddUtil.o): In function `Cudd_LdblCountMinterm':\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:729: undefined reference to `powl'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddUtil.o): In function `Cudd_CountMinterm':\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/cuddUtil.c:595: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-epd.o): In function `EpdNormalizeDecimal':\n/home/subhadip/cudd-3.0.0/epd/epd.c:834: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/epd/epd.c:834: undefined reference to `pow'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-epd.o):/home/subhadip/cudd-3.0.0/epd/epd.c:452: more undefined references to `pow' follow\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddAnneal.o): In function `siftBackwardProb':\n/home/subhadip/cudd-3.0.0/cudd/cuddAnneal.c:671: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/cuddAnneal.c:671: undefined reference to `exp'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddAnneal.o): In function `cuddAnnealing':\n/home/subhadip/cudd-3.0.0/cudd/cuddAnneal.c:229: undefined reference to `log'\n/home/subhadip/cudd-3.0.0/cudd/cuddAnneal.c:229: undefined reference to `log'\n/home/subhadip/cudd-3.0.0/cudd/.libs/libcudd.a(cudd_libcudd_la-cuddAnneal.o): In function `siftBackwardProb':\n/home/subhadip/cudd-3.0.0/cudd/cuddAnneal.c:671: undefined reference to `exp'\ncollect2: error: ld returned 1 exit status\n\n</code></pre>\n\n<p>I have tried to statically link the libraries but the there is a problem. How can I fix it?</p>\n"}, {"tags": ["c", "cmake", "shared-libraries", "static-libraries"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1557913909, "post_id": 56145729, "comment_id": 98922409, "body": "It is better to provide <b>absolute path</b> for <code>target_include_directories</code>. According to <a href=\"https://cmake.org/cmake/help/v3.14/command/target_include_directories.html\" rel=\"nofollow noreferrer\">documentation</a>, relative paths are allowed only for <code>$&lt;INSTALL_INTERFACE&gt;</code> expression. You don&#39;t show <code>my_app&#47;CMakeLists.txt</code> script. but assuming it has <code>target_link_libraries(&lt;exe&gt; utilities)</code>, the things should work."}, {"owner": {"reputation": 1, "user_id": 11503049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PQ_k9vESuwU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re33EDoDRwBUzTtAq-WxwAgm9gRNQ/mo/photo.jpg?sz=128", "display_name": "David Rodrigues", "link": "https://stackoverflow.com/users/11503049/david-rodrigues"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1557922109, "post_id": 56145729, "comment_id": 98927274, "body": "It&#39;s better, but it&#39;s still not working as I wish. In the current project, I&#39;m now able to <code>#include &lt;utilities.h&gt;</code>, or directly <code>#include &lt;file_utilities&#47;file_utilities.h&gt;</code>. But I still can&#39;t use it in another program with my <i>.so</i> or <i>.a</i> library. Can I use those built in the cmake-build-debug folder ?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1557924359, "post_id": 56145729, "comment_id": 98928710, "body": "If you want to provide header files for <b>other project</b>, normal way is to <b>install</b> those header files. Then, in the other project you just need to ajust include directories to that installed location. You may find <a href=\"https://cmake.org/cmake/help/v3.7/manual/cmake-packages.7.html\" rel=\"nofollow noreferrer\">CMake packaging tutorial</a> useful for your purpose."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557927675, "post_id": 56145729, "comment_id": 98930937, "body": "I would just recommend using <code>add_library(utilities)</code> as you have now, and just inside <code>my_app&#47;CMakeLists.txt</code> add <code>add_subdirectory(utlities ${CMAKE_CURRENT_SOURCE_DIR}&#47;..&#47;utilities)</code> and simple <code>target_link_libraries(my_app PUBLIC utilities)</code>. There is no need for <code>install()</code>, which is harder to maintain then just simple <code>add_library()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1557929172, "post_id": 56150698, "comment_id": 98931917, "body": "On Stack Overflow we want the answer to be useful even without following the links it has. But you answer currently has a little sence without links. Please, add at least some information from the links your provide <b>directly</b> into the question post."}], "tags": [], "owner": {"reputation": 78, "user_id": 10710264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13b00773db5f5b4717d1f2d7c548ceca?s=128&d=identicon&r=PG&f=1", "display_name": "d-karl", "link": "https://stackoverflow.com/users/10710264/d-karl"}, "is_accepted": false, "score": 0, "last_activity_date": 1557989172, "last_edit_date": 1557989172, "creation_date": 1557927270, "answer_id": 56150698, "question_id": 56145729, "link": "https://stackoverflow.com/questions/56145729/how-to-create-a-library-with-cmakelists-txt-and-include-it-in-another-program/56150698#56150698", "title": "How to create a library with CMakeLists.txt and include it in another program?", "body": "<p>I highly suggest reading <a href=\"https://pabloariasal.github.io/2018/02/19/its-time-to-do-cmake-right/\" rel=\"nofollow noreferrer\">this article</a>, in which a fictional library target is created, starting from project structure to installing/exporting. From my understanding, the author has exactly the same goal as you do. The article has cleared up a lot of things for me when I started out. I also recomend the project structure laid out within.</p>\n\n<p>Project structure:</p>\n\n<pre><code>libjsonutils\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 include\n\u2502   \u2514\u2500\u2500 jsonutils\n\u2502       \u2514\u2500\u2500 json_utils.h\n\u251c\u2500\u2500 src\n\u2502   \u251c\u2500\u2500 file_utils.h\n\u2502   \u2514\u2500\u2500 json_utils.cpp\n\u2514\u2500\u2500 test\n    \u251c\u2500\u2500 CMakeLists.txt\n    \u2514\u2500\u2500 src\n        \u2514\u2500\u2500 test_main.cpp\n</code></pre>\n\n<p>Specifically, you will want to take a look at <a href=\"https://pabloariasal.github.io/2018/02/19/its-time-to-do-cmake-right/#targets-and-properties\" rel=\"nofollow noreferrer\">Targets and Properties</a>, where generator expressions are used to differentiate between the include dir at build time, and when installed:</p>\n\n<pre><code>target_include_directories(JSONUtils\n    PUBLIC \n        $&lt;INSTALL_INTERFACE:include&gt;    \n        $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include&gt;\n    PRIVATE\n        ${CMAKE_CURRENT_SOURCE_DIR}/src\n)\n</code></pre>\n\n<p>The install process and exporting/importing of targets is explained a little later in <a href=\"https://pabloariasal.github.io/2018/02/19/its-time-to-do-cmake-right/#this-is-how-you-do-cmake\" rel=\"nofollow noreferrer\">This is how you do CMake</a>. What the author wants to do is be able to use the library in other cmake projects (e.g. a target called \"example\"), simply by doing the following:</p>\n\n<pre><code>find_package(JSONUtils 1.0 REQUIRED)\ntarget_link_libraries(example JSONUtils::JSONUtils)\n</code></pre>\n\n<p>In order to make this work, you will need to install and export the library. The author encourages this for installation:</p>\n\n<pre><code>include(GNUInstallDirs)\ninstall(TARGETS JSONUtils\n    EXPORT jsonutils-export\n    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}\n    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}\n)\n</code></pre>\n\n<p>And this for exporting:</p>\n\n<pre><code>install(EXPORT jsonutils-targets\n  FILE\n    JSONUtilsTargets.cmake\n  NAMESPACE\n    JSONUtils::\n  DESTINATION\n    ${CMAKE_INSTALL_LIBDIR}/cmake/JSONUtils\n)\n</code></pre>\n\n<p>The export will place a file named findJsonUtils.cmake in the given destination. This file will be what you need to import the library in other projects by using the find_package mechanism.</p>\n\n<p>All code samples in this post taken from Pablo Arias' linked article.</p>\n"}, {"tags": [], "owner": {"reputation": 3572, "user_id": 5710233, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-5LmFgRhfZNQ/AAAAAAAAAAI/AAAAAAAAABk/Etcd11tdJGc/photo.jpg?sz=128", "display_name": "Mizux", "link": "https://stackoverflow.com/users/5710233/mizux"}, "is_accepted": false, "score": 0, "last_activity_date": 1557996948, "creation_date": 1557996948, "answer_id": 56164617, "question_id": 56145729, "link": "https://stackoverflow.com/questions/56145729/how-to-create-a-library-with-cmakelists-txt-and-include-it-in-another-program/56164617#56164617", "title": "How to create a library with CMakeLists.txt and include it in another program?", "body": "<p>Your CMakeLists.txt is <strong>inside</strong> <code>utilities</code> try to use this.</p>\n\n<p><code>src/utilities/CMakeLists.txt</code>:</p>\n\n<pre><code>target_include_directories(${PROJECT_NAME}\n  PUBLIC\n    $&lt;BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/..&gt;\n)\n</code></pre>\n\n<p>For the app you should have something like:\n<code>src/my_app/CMakeLists.txt</code>:</p>\n\n<pre><code>target_link_libraries(${PROJECT_NAME} PRIVATE utilities)\n\n</code></pre>\n\n<p>and you should have simple\n<code>src/CMakeLists.txt</code>:</p>\n\n<pre><code>add_subdirectory(utilities)\nadd_subdirectory(my_app)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11503049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PQ_k9vESuwU/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3re33EDoDRwBUzTtAq-WxwAgm9gRNQ/mo/photo.jpg?sz=128", "display_name": "David Rodrigues", "link": "https://stackoverflow.com/users/11503049/david-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557996948, "creation_date": 1557911917, "question_id": 56145729, "link": "https://stackoverflow.com/questions/56145729/how-to-create-a-library-with-cmakelists-txt-and-include-it-in-another-program", "title": "How to create a library with CMakeLists.txt and include it in another program?", "body": "<p>I'm new to C/C++ development and I'm struggling with CMakeLists.txt in CLion IDE.</p>\n\n<p>I can't create a library (static or shared) that I can #include in another program. </p>\n\n<p>I have this kind of structure :</p>\n\n<pre><code>src/\n |\n |---&gt; utilities/\n |         |---&gt; CMakeLists.txt\n |         |---&gt; utilties.h\n |         |\n |         |---&gt; file_utilities/\n |         |            |---&gt; file_utilities.h\n |         |            |---&gt; file_utilities.c\n |        ...\n |\n |---&gt; my_app\n          |---&gt; CMakeLists.txt\n          |---&gt; main.c\n</code></pre>\n\n<p>I have generated a libutilities.so and a libutilities.a. In my main.c file, it works if I do a <code>#include \"../utilities/utilities.h\"</code> or <code>#include \"../utilities/file_utilities/file_utilities.h\"</code>.</p>\n\n<p>Worse, if I create another project, with another program and link my libutilities.so, the link seems to work, but still can't include my headers.</p>\n\n<p>I've tried many configuration, many options in CMakeLists.txt but it has never worked until now.</p>\n\n<p>Here is the CMakeLists.txt that I use for my library. I'm quite sure the problem is in this file.</p>\n\n<pre><code>    cmake_minimum_required(VERSION 3.7)\n    project(utilities VERSION 1.0.0)\n\n    set(CMAKE_CXX_STANDARD 11)\n\n    link_libraries(pthread)\n    link_libraries(ssl)\n    link_libraries(crypto)\n\n    find_package(CURL REQUIRED)\n    include_directories(${CURL_INCLUDE_DIRS})\n\n    file(GLOB_RECURSE SOURCES RELATIVES \"*.c\")\n    file(GLOB_RECURSE HEADERS RELATIVES \"*.h\")\n\n    add_library(${PROJECT_NAME} SHARED ${SOURCES} ${HEADERS})\n\n    set_target_properties(${PROJECT_NAME} PROPERTIES\n            PUBLIC_HEADER \"${HEADERS}\"\n            ARCHIVE_OUTPUT_DIRECTORY \"lib\"\n            LIBRARY_OUTPUT_DIRECTORY \"lib\"\n            OUTPUT_NAME ${PROJECT_NAME})\n\n    target_include_directories(${PROJECT_NAME} PUBLIC .)\n\n    target_link_libraries(${PROJECT_NAME} ${CURL_LIBRARIES})\n\n    include(GNUInstallDirs)\n    install(TARGETS ${PROJECT_NAME}\n            LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}\n            ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}\n            PUBLIC_HEADER DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/${PROJECT_NAME})\n</code></pre>\n\n<p>I'd like to have something more like <code>#include &lt;utilities/utilties.h&gt;</code> as it's a library. But I can't make it works.</p>\n\n<p>In the example I provided, the library is a simple \"utils\" library, but I have to create more that I'll have to deliver and be integrated in another program than mine.</p>\n"}, {"tags": ["c", "opengl-es", "opengl-es-2.0", "stencil-buffer"], "answers": [{"tags": [], "owner": {"reputation": 18064, "user_id": 2579738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oXata.png?s=128&g=1", "display_name": "BDL", "link": "https://stackoverflow.com/users/2579738/bdl"}, "is_accepted": true, "score": 3, "last_activity_date": 1557912012, "creation_date": 1557912012, "answer_id": 56145767, "question_id": 56145649, "link": "https://stackoverflow.com/questions/56145649/opengl-es-2-is-there-a-way-to-attach-a-stencil-buffer-with-a-different-resolut/56145767#56145767", "title": "openGL ES 2 - Is there a way to attach a stencil buffer with a different resolution than the target texture?", "body": "<p>It is not possible to attach textures with different sizes to a framebuffer.</p>\n\n<p>The <a href=\"https://www.khronos.org/registry/OpenGL/specs/es/2.0/es_full_spec_2.0.pdf\" rel=\"nofollow noreferrer\">OpenGL-ES 2.0 Spec</a> states in Section 4.4:</p>\n\n<blockquote>\n  <p>The framebuffer object target is said to be framebuffer complete [...] if all the following conditons are true:</p>\n  \n  <ul>\n  <li>All attached images have the same width and height.</li>\n  </ul>\n</blockquote>\n\n<p>If this is not the case, the framebuffer status has to return <code>FRAMEBUFFER_INCOMPLETE_DIMENSIONS</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 2201334, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ffb8527fbcc27d10f997fd1bfe248bf?s=128&d=identicon&r=PG", "display_name": "C Coder", "link": "https://stackoverflow.com/users/2201334/c-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56145767, "answer_count": 1, "score": 2, "last_activity_date": 1557912012, "creation_date": 1557911677, "last_edit_date": 1557911752, "question_id": 56145649, "link": "https://stackoverflow.com/questions/56145649/opengl-es-2-is-there-a-way-to-attach-a-stencil-buffer-with-a-different-resolut", "title": "openGL ES 2 - Is there a way to attach a stencil buffer with a different resolution than the target texture?", "body": "<p>I have an input texture in a certain resolution, and a target texture (attached as <code>GL_COLOR_ATTACHMENT0</code>) which is in a bigger resolution. I am using <code>glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST)</code> to upscale the input and draw some stuff on the target. </p>\n\n<p>I have a buffer which is in the same resolution as my input that I would like to use as <code>GL_STENCIL_ATTACHMENT</code>. \nIs it possible to attach it somehow without getting an error of <code>GL_FRAMEBUFFER_INCOMPLETE_DIMENSIONS</code>?</p>\n"}, {"tags": ["c", "terminal"], "comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1557908839, "post_id": 56144720, "comment_id": 98919475, "body": "Weird stuff happened with your formatting and half of your quotes are weird typographic ones that won&#39;t please a compiler. Bake your question a bit more and double-check it through the preview under the editor ;)"}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1557909270, "post_id": 56144720, "comment_id": 98919677, "body": "What do you expect from the number 200 in the format string <code>&quot;%200s&quot;</code>? If you want to read a string, just use <code>&quot;%s&quot;</code>. But the expression will never be true. Give <code>strcmp()</code> a try."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 1, "creation_date": 1557909516, "post_id": 56144720, "comment_id": 98919816, "body": "@harper it is quite right to restrict the input length, to prevent buffer overflow, although why not <code>998</code> is unclear."}, {"owner": {"reputation": 80047, "user_id": 169346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645dbb4f7ba1ff9d7ff2de02f68fbe9c?s=128&d=identicon&r=PG", "display_name": "JeremyP", "link": "https://stackoverflow.com/users/169346/jeremyp"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1557909626, "post_id": 56144720, "comment_id": 98919866, "body": "@Quentin I fixed the quotes"}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 1, "creation_date": 1557909827, "post_id": 56144720, "comment_id": 98919970, "body": "I guess that you are trying to read 200 characters? Use <code>fgets(input,200,stdin);</code>. I would suggest to allocate memory for <code>input</code>, rather that putting load on the program stack. Then try <code>strcmp( )</code> function from standard library."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557909835, "post_id": 56144720, "comment_id": 98919974, "body": "<code>if (input == &quot;ls&quot;)</code> should be <code>if (strcmp(&quot;ls&quot;, input) == 0)</code> which also needs <code>#include &lt;string.h&gt;</code>. You are comparing two pointers which will never be the same."}, {"owner": {"reputation": 12106, "user_id": 4431643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CoZjt.jpg?s=128&g=1", "display_name": "kiran Biradar", "link": "https://stackoverflow.com/users/4431643/kiran-biradar"}, "edited": false, "score": 3, "creation_date": 1557909962, "post_id": 56144720, "comment_id": 98920031, "body": "Also you should not write different function to execute different commands, rather a single common function by passing user inputted command directly to <code>execlp</code>."}, {"owner": {"reputation": 1, "user_id": 11502804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff35d8cc11af600d7869d97058b03af?s=128&d=identicon&r=PG&f=1", "display_name": "Gulkbag", "link": "https://stackoverflow.com/users/11502804/gulkbag"}, "edited": false, "score": 0, "creation_date": 1557910351, "post_id": 56144720, "comment_id": 98920270, "body": "Thanks to you guys, the strcmp thing fixed it, also yeah i just had that function for testing and thanks for pointing out that i should actually just restrict it to 998, i will mark this as solved now."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1557910693, "post_id": 56144720, "comment_id": 98920462, "body": "If the question got an answer, you can <b>accept</b> the answer. That&#39;s a way to mark it as solved. If you don&#39;t get an answer, hmm.. it would be probably not interesting enough. Probably it should be closed."}], "owner": {"reputation": 1, "user_id": 11502804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cff35d8cc11af600d7869d97058b03af?s=128&d=identicon&r=PG&f=1", "display_name": "Gulkbag", "link": "https://stackoverflow.com/users/11502804/gulkbag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1557911817, "answer_count": 0, "score": 0, "last_activity_date": 1557910594, "creation_date": 1557908688, "last_edit_date": 1557910594, "question_id": 56144720, "link": "https://stackoverflow.com/questions/56144720/trying-to-make-a-bootleg-terminal-emulator-ls-command-wont-work", "closed_reason": "Duplicate", "title": "Trying to make a bootleg terminal emulator, ls command won&#39;t work", "body": "<p>I am trying to make a bootleg terminal emulator, but I am having problems \n implementing the ls command</p>\n\n<p>Basically this ls command is supposed to just print out the files in the current \"dir\" like normal but it won't, here's my code:</p>\n\n<pre><code>void ls()\n{\n    int pid;            //process id\n    pid = fork();     //create another process\n    if ( pid &lt; 0 )\n    {                                 \n        printf(\"\\nFork failed\\n\");\n        exit (-1);\n    }\n    else if ( pid == 0 )\n    {                     \n        execlp ( \"/bin/ls\", \"ls\", \"-l\", NULL ); \n    }\n    else\n    {                             \n        wait (NULL);             \n        printf(\"\\nchild complete\\n\");\n        exit (0);\n    }\n}\n\nint main()\n{\n    char input[999];\n\n    scanf(\"%200s\", input);\n    if (input == \"ls\")\n    {\n        ls();\n    }\n    return 0;\n}\n</code></pre>\n\n<p>I type in ls and it's supposed to do its thing but it won't, it works without the input command thing but I can't just have a program that does a ls.</p>\n"}, {"tags": ["c", "gpu", "opencl"], "comments": [{"owner": {"reputation": 725, "user_id": 7968757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/febedd8312ee6b7f6559b765f27da3e6?s=128&d=identicon&r=PG&f=1", "display_name": "BlameTheBits", "link": "https://stackoverflow.com/users/7968757/blamethebits"}, "edited": false, "score": 3, "creation_date": 1557908074, "post_id": 56144284, "comment_id": 98919082, "body": "&quot;I seem to get worse performance.&quot; Why don&#39;t add some info about execution times (and maybe your hardware)? And a &quot;regular for loop&quot; means the &quot;same&quot; implementation on the cpu just with an outer for loop instead of the threads on the gpu? Regarding the performance I would say the access pattern is really bad for a gpu. A column-major order would be better. See e.g. <a href=\"https://stackoverflow.com/questions/21008125/which-memory-access-pattern-is-more-efficient-for-a-cached-gpu\">this question</a>."}, {"owner": {"reputation": 953, "user_id": 5767725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3ddaa139d48d3453eec52417ef76500?s=128&d=identicon&r=PG&f=1", "display_name": "mogu", "link": "https://stackoverflow.com/users/5767725/mogu"}, "edited": false, "score": 0, "creation_date": 1557911788, "post_id": 56144284, "comment_id": 98921095, "body": "If your opencl device is a discrete GPU, then i&#39;m not really surprising you get worse performance. Your kernel is trivial, and the total runtime is dominated by overhead of transferring data. CPU and iGPU would not need to transfer any data, but discrete GPU does, and transfers over PCIe are relatively slow. There&#39;s really no point running this code on discrete GPUs unless it&#39;s part of larger computation."}], "answers": [{"tags": [], "owner": {"reputation": 18176, "user_id": 48660, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/NJ1Lx.jpg?s=128&g=1", "display_name": "pmdj", "link": "https://stackoverflow.com/users/48660/pmdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1557924682, "creation_date": 1557924682, "answer_id": 56149815, "question_id": 56144284, "link": "https://stackoverflow.com/questions/56144284/troubles-with-slow-speeds-in-opencl/56149815#56149815", "title": "Troubles with slow speeds in opencl", "body": "<p>The commenters make some valid points, but I'll try to be a little more constructive and organised:</p>\n\n<ol>\n<li>Your data appears to consist of <code>double</code> precision floating point values. Depending on your GPU, this can be bad news in itself. Consumer grade GPUs typically are not optimised for working with <code>double</code>s, often only achieving 1/32 or 1/16 the throughput compared to single-precision <code>float</code> operations. Many pro-grade GPUs (Quadro, Tesla, FirePro, some Radeon Pro cards) are fine with them though, achieving 1/2 or 1/4 throughput versus <code>float</code>. As you're only performing a trivial arithmetic operation (comparison), and there's a good chance your runtime is dominated by memory access, it could be fine on consumer hardware too.</li>\n<li>I assume your <code>row_size</code> is not actually 0, it would help to know what the true (typical) value is, and whether it's fixed, variable by row, or variable per run but the same for each row. In any case, unless <code>row_size</code> is very small, the fact that you are running a serial <code>for</code> loop over it could be holding your code back.</li>\n<li>How big is your work size? In other words, how many rows in your array (give a typical range if it varies)? If it is very small, you will see little benefit from GPU parallelism: GPUs have a large number of processors and can schedule a few threads per processor. So your work items will need to number hundreds or better thousands to achieve decent hardware utilisation.</li>\n<li>You are reading a very large array from (presumably) system memory and not performing any intensive operations on it. This means your bottleneck will typically be on the memory access side - for discrete GPUs, system memory access needs to go through PCIe, so the speed of that link will place an upper bound on your performance. Additionally, your memory access pattern far from ideal for GPUs - you typically want work items to read adjacent memory cells at the same time as the memory unit typically fetches 64 bytes or more at once.</li>\n</ol>\n\n<p>Improvement suggestions:</p>\n\n<ul>\n<li>Profiling. If at all possible, use your GPU vendor's profiling tools to determine your true bottlenecks. Otherwise we're just guessing.</li>\n<li>For (4) - if at all possible, try not to move large amounts of data around too much. If you can generate your input arrays on the GPU, do so, so they never leave VRAM.</li>\n<li>For (4) - Optimise your memory accesses. AMD, NVidia and Intel all have OpenCL GPU optimisation guides which explain how to do this. Essentially, re-structure your data layout, or your kernel such that adjacent work items read adjacent pieces of memory. You ideally want work item 0 to read array item 0, work item 1 to read array item 1, etc. You may need to use local memory to coordinate between work items. Another option is to read vector-sized chunks of data per work item. (e.g. each work-item reads a double8 at a time) Watch for alignment in this case though.</li>\n<li>For (2) &amp; (3) - Unless <code>row_size</code> is very small (and fixed), try to split your loop across multiple work items and coordinate using local memory (reduction algorithms) and atomic operations in global memory.</li>\n<li>For (1): If you've optimised everything else and profiling is telling you that comparing <code>double</code>s on consumer hardware is too slow, either check if you can generate the data as <code>float</code>s without loss of accuracy (this will also halve your memory bandwidth woes), or check if you can otherwise do better somehow, for example by treating the <code>double</code> as a <code>long</code> and manually unpacking and comparing the exponent and mantissa using integer operations.</li>\n</ul>\n"}], "owner": {"reputation": 663, "user_id": 11118251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUR0V.jpg?s=128&g=1", "display_name": "Shadesfear", "link": "https://stackoverflow.com/users/11118251/shadesfear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1557924682, "creation_date": 1557907196, "last_edit_date": 1557910996, "question_id": 56144284, "link": "https://stackoverflow.com/questions/56144284/troubles-with-slow-speeds-in-opencl", "title": "Troubles with slow speeds in opencl", "body": "<p>I am trying to use opencl for the first time, the goal is to calculate the argmin of each row in an array. Since the operation on each row is independent of the others, I thought this would be easy to put on the graphics card. </p>\n\n<p>I seem to get worse performance using this code than when i just run the code on the cpu with an outer forloop, any help would be appreciated.</p>\n\n<p>Here is the code: </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#pragma OPENCL EXTENSION cl_khr_fp64 : enable\n\nint argmin(global double *array, int end)\n{\n  double minimum = array[0];\n  int index;\n  for (int j = 0; j &lt; end; j++)\n  {\n    if (array[j] &lt; minimum)\n    {\n      minimum = array[j];\n      index = j;\n    }\n  }\n  return index;\n}\n\nkernel void execute(global double *dist, global long *res, global double *min_dist)\n{\n  int row_size = 0;\n  int i = get_global_id(0);\n\n  int row_index = i * row_size;\n  res[i] = argmin(&amp;dist[row_index], row_size);\n  min_dist[i] = dist[res[i] + row_index];\n\n}\n</code></pre>\n"}, {"tags": ["c", "sdl", "sdl-2"], "answers": [{"tags": [], "owner": {"reputation": 47449, "user_id": 44729, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tyWaU.png?s=128&g=1", "display_name": "genpfault", "link": "https://stackoverflow.com/users/44729/genpfault"}, "is_accepted": true, "score": 0, "last_activity_date": 1557949809, "last_edit_date": 1557949809, "creation_date": 1557948924, "answer_id": 56156483, "question_id": 56143991, "link": "https://stackoverflow.com/questions/56143991/determine-correct-pixel-format-for-sdl-createtexture/56156483#56156483", "title": "Determine correct pixel format for SDL_CreateTexture()?", "body": "<p>A given <code>SDL_Renderer</code> is going to support at least one <code>SDL_PixelFormatEnum</code>;  Other formats will work but may incur a conversion penalty at creation and/or use.</p>\n\n<p>Use <code>SDL_GetRendererInfo()</code> to populate a <code>SDL_RendererInfo</code> &amp; use one of the formats in <code>SDL_RendererInfo::texture_formats</code> (from <a href=\"https://stackoverflow.com/a/33312056/44729\">here</a>):</p>\n\n<pre><code>SDL_RendererInfo info;\nSDL_GetRendererInfo( renderer, &amp;info );\ncout &lt;&lt; \"Renderer name: \" &lt;&lt; info.name &lt;&lt; endl;\ncout &lt;&lt; \"Texture formats: \" &lt;&lt; endl;\nfor( Uint32 i = 0; i &lt; info.num_texture_formats; i++ )\n{\n    cout &lt;&lt; SDL_GetPixelFormatName( info.texture_formats[i] ) &lt;&lt; endl;\n}\n</code></pre>\n\n<p>Back when I ran that both the DirectX &amp; OpenGL backends supported <code>SDL_PIXELFORMAT_ARGB8888</code>.</p>\n\n<p>Double-checking the SDL code via <code>git grep -A 25 SDL_RenderDriver</code> I think the first <code>texture_formats</code> is the \"preferred\" format:</p>\n\n<pre><code>SDL_render_d3d.c:SDL_RenderDriver D3D_RenderDriver = {\nSDL_render_d3d.c-    D3D_CreateRenderer,\nSDL_render_d3d.c-    {\nSDL_render_d3d.c-     \"direct3d\",\nSDL_render_d3d.c-     (SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_TARGETTEXTURE),\nSDL_render_d3d.c-     1,\nSDL_render_d3d.c-     {SDL_PIXELFORMAT_ARGB8888},\nSDL_render_d3d.c-     0,\nSDL_render_d3d.c-     0}\n--\nSDL_render_d3d11.c:SDL_RenderDriver D3D11_RenderDriver = {\nSDL_render_d3d11.c-    D3D11_CreateRenderer,\nSDL_render_d3d11.c-    {\nSDL_render_d3d11.c-        \"direct3d11\",\nSDL_render_d3d11.c-        (\nSDL_render_d3d11.c-            SDL_RENDERER_ACCELERATED |\nSDL_render_d3d11.c-            SDL_RENDERER_PRESENTVSYNC |\nSDL_render_d3d11.c-            SDL_RENDERER_TARGETTEXTURE\nSDL_render_d3d11.c-        ),                          /* flags.  see SDL_RendererFlags */\nSDL_render_d3d11.c-        6,                          /* num_texture_formats */\nSDL_render_d3d11.c-        {                           /* texture_formats */\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_ARGB8888,\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_RGB888,\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_YV12,\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_IYUV,\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_NV12,\nSDL_render_d3d11.c-            SDL_PIXELFORMAT_NV21\nSDL_render_d3d11.c-        },\nSDL_render_d3d11.c-        0,                          /* max_texture_width: will be filled in later */\nSDL_render_d3d11.c-        0                           /* max_texture_height: will be filled in later */\nSDL_render_d3d11.c-    }\nSDL_render_d3d11.c-};\n--\nSDL_render_metal.m:SDL_RenderDriver METAL_RenderDriver = {\nSDL_render_metal.m-    METAL_CreateRenderer,\nSDL_render_metal.m-    {\nSDL_render_metal.m-        \"metal\",\nSDL_render_metal.m-        (SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_TARGETTEXTURE),\nSDL_render_metal.m-        6,\nSDL_render_metal.m-        {\nSDL_render_metal.m-            SDL_PIXELFORMAT_ARGB8888,\nSDL_render_metal.m-            SDL_PIXELFORMAT_ABGR8888,\nSDL_render_metal.m-            SDL_PIXELFORMAT_YV12,\nSDL_render_metal.m-            SDL_PIXELFORMAT_IYUV,\nSDL_render_metal.m-            SDL_PIXELFORMAT_NV12,\nSDL_render_metal.m-            SDL_PIXELFORMAT_NV21\nSDL_render_metal.m-        },\nSDL_render_metal.m-    0, 0,\nSDL_render_metal.m-    }\nSDL_render_metal.m-};\n--\nSDL_render_gl.c:SDL_RenderDriver GL_RenderDriver = {\nSDL_render_gl.c-    GL_CreateRenderer,\nSDL_render_gl.c-    {\nSDL_render_gl.c-     \"opengl\",\nSDL_render_gl.c-     (SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_TARGETTEXTURE),\nSDL_render_gl.c-     1,\nSDL_render_gl.c-     {SDL_PIXELFORMAT_ARGB8888},\nSDL_render_gl.c-     0,\nSDL_render_gl.c-     0}\nSDL_render_gl.c-};\n--\nSDL_render_gles.c:SDL_RenderDriver GLES_RenderDriver = {\nSDL_render_gles.c-    GLES_CreateRenderer,\nSDL_render_gles.c-    {\nSDL_render_gles.c-     \"opengles\",\nSDL_render_gles.c-     (SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC),\nSDL_render_gles.c-     1,\nSDL_render_gles.c-     {SDL_PIXELFORMAT_ABGR8888},\nSDL_render_gles.c-     0,\nSDL_render_gles.c-     0\nSDL_render_gles.c-    }\nSDL_render_gles.c-};\n--\nSDL_render_gles2.c:SDL_RenderDriver GLES2_RenderDriver = {\nSDL_render_gles2.c-    GLES2_CreateRenderer,\nSDL_render_gles2.c-    {\nSDL_render_gles2.c-        \"opengles2\",\nSDL_render_gles2.c-        (SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_TARGETTEXTURE),\nSDL_render_gles2.c-        4,\nSDL_render_gles2.c-        {\nSDL_render_gles2.c-        SDL_PIXELFORMAT_ARGB8888,\nSDL_render_gles2.c-        SDL_PIXELFORMAT_ABGR8888,\nSDL_render_gles2.c-        SDL_PIXELFORMAT_RGB888,\nSDL_render_gles2.c-        SDL_PIXELFORMAT_BGR888\nSDL_render_gles2.c-        },\nSDL_render_gles2.c-        0,\nSDL_render_gles2.c-        0\nSDL_render_gles2.c-    }\nSDL_render_gles2.c-};\n--\nSDL_render_psp.c:SDL_RenderDriver PSP_RenderDriver = {\nSDL_render_psp.c-    .CreateRenderer = PSP_CreateRenderer,\nSDL_render_psp.c-    .info = {\nSDL_render_psp.c-        .name = \"PSP\",\nSDL_render_psp.c-        .flags = SDL_RENDERER_ACCELERATED | SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_TARGETTEXTURE,\nSDL_render_psp.c-        .num_texture_formats = 4,\nSDL_render_psp.c-        .texture_formats = { [0] = SDL_PIXELFORMAT_BGR565,\nSDL_render_psp.c-                                                 [1] = SDL_PIXELFORMAT_ABGR1555,\nSDL_render_psp.c-                                                 [2] = SDL_PIXELFORMAT_ABGR4444,\nSDL_render_psp.c-                                                 [3] = SDL_PIXELFORMAT_ABGR8888,\nSDL_render_psp.c-        },\nSDL_render_psp.c-        .max_texture_width = 512,\nSDL_render_psp.c-        .max_texture_height = 512,\nSDL_render_psp.c-     }\nSDL_render_psp.c-};\n--\nSDL_render_sw.c:SDL_RenderDriver SW_RenderDriver = {\nSDL_render_sw.c-    SW_CreateRenderer,\nSDL_render_sw.c-    {\nSDL_render_sw.c-     \"software\",\nSDL_render_sw.c-     SDL_RENDERER_SOFTWARE | SDL_RENDERER_TARGETTEXTURE,\nSDL_render_sw.c-     8,\nSDL_render_sw.c-     {\nSDL_render_sw.c-      SDL_PIXELFORMAT_ARGB8888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_ABGR8888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_RGBA8888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_BGRA8888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_RGB888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_BGR888,\nSDL_render_sw.c-      SDL_PIXELFORMAT_RGB565,\nSDL_render_sw.c-      SDL_PIXELFORMAT_RGB555\nSDL_render_sw.c-     },\nSDL_render_sw.c-     0,\nSDL_render_sw.c-     0}\nSDL_render_sw.c-};\n--\nSDL_DirectFB_render.c:SDL_RenderDriver DirectFB_RenderDriver = {\nSDL_DirectFB_render.c-    DirectFB_CreateRenderer,\nSDL_DirectFB_render.c-    {\nSDL_DirectFB_render.c-     \"directfb\",\nSDL_DirectFB_render.c-     (SDL_RENDERER_PRESENTVSYNC | SDL_RENDERER_ACCELERATED),\nSDL_DirectFB_render.c-     /* (SDL_TEXTUREMODULATE_NONE | SDL_TEXTUREMODULATE_COLOR |\nSDL_DirectFB_render.c-      SDL_TEXTUREMODULATE_ALPHA),\nSDL_DirectFB_render.c-      (SDL_BLENDMODE_NONE | SDL_BLENDMODE_MASK | SDL_BLENDMODE_BLEND |\nSDL_DirectFB_render.c-      SDL_BLENDMODE_ADD | SDL_BLENDMODE_MOD),\nSDL_DirectFB_render.c-     (SDL_SCALEMODE_NONE | SDL_SCALEMODE_FAST |\nSDL_DirectFB_render.c-      SDL_SCALEMODE_SLOW | SDL_SCALEMODE_BEST), */\nSDL_DirectFB_render.c-     0,\nSDL_DirectFB_render.c-     {\nSDL_DirectFB_render.c-             /* formats filled in later */\nSDL_DirectFB_render.c-     },\nSDL_DirectFB_render.c-     0,\nSDL_DirectFB_render.c-     0}\nSDL_DirectFB_render.c-};\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 11500742, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-VD2DGeSfxvA/AAAAAAAAAAI/AAAAAAAAABo/fpUEZWTs_c8/photo.jpg?sz=128", "display_name": "Joshua Shaffer", "link": "https://stackoverflow.com/users/11500742/joshua-shaffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 1, "accepted_answer_id": 56156483, "answer_count": 1, "score": 5, "last_activity_date": 1557949809, "creation_date": 1557906080, "last_edit_date": 1557949606, "question_id": 56143991, "link": "https://stackoverflow.com/questions/56143991/determine-correct-pixel-format-for-sdl-createtexture", "title": "Determine correct pixel format for SDL_CreateTexture()?", "body": "<p>I am struggling to convert a simple pong game from SDL to SDL2 because I could not find a valid value for the pixel format argument  <em>(second parameter '<code>Uint32</code> format')</em> when calling <code>SDL_CreateTexture()</code>. Finally I found success by using <code>SDL_PIXELFORMAT_ARGB8888</code>, and I also found that <code>SDL_PIXELFORMAT_UNKNOWN</code> works too. However, after reading a few articles on system endianness and determining byte-order, I'm still unsure how a valid pixel format can be found for a given system without guessing, using unknown, or running some separate shell scripts. </p>\n\n<p>Is it safe to just rely on <code>SDL_PIXELFORMAT_UNKNOWN</code>? Could anyone provide some information (or a link) to help me better understand these concepts and implementing them? I'd like to understand the related concepts better for future graphics programming.</p>\n\n<p>Here's what the code originally looked like:</p>\n\n<pre><code>screen = SDL_CreateRGBSurfaceWithFormat(0, width, height, 32, \n                                        SDL_PIXELTYPE_RGBA32); \n\nscreen_texture = SDL_CreateTextureFromSurface(renderer, screen);\n</code></pre>\n\n<p>And what I used to make it work:</p>\n\n<pre><code>screen = SDL_CreateRGBSurface(0, 640, 480, 32,\n                              0x00FF0000,\n                              0x0000FF00,\n                              0x000000FF,\n                              0xFF000000);\n\nscreen_texture = SDL_CreateTexture(renderer,\n                                   SDL_PIXELFORMAT_ARGB8888, \n                                   SDL_TEXTUREACCESS_TARGET,\n                                   640, 480); // SDL_PIXELFORMAT_UNKNOWN also works\n</code></pre>\n"}, {"tags": ["c", "embedded"], "comments": [{"owner": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1557911921, "post_id": 56143661, "comment_id": 98921188, "body": "This should be forum &quot;RenesasRulz&quot;. <a href=\"https://renesasrulz.com/\" rel=\"nofollow noreferrer\">renesasrulz.com</a>"}, {"owner": {"reputation": 1, "user_id": 11497829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64662fb1ab8ebaf6640db4efa29fcca0?s=128&d=identicon&r=PG&f=1", "display_name": "jeev", "link": "https://stackoverflow.com/users/11497829/jeev"}, "reply_to_user": {"reputation": 2462, "user_id": 2705907, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/e2UTS.jpg?s=128&g=1", "display_name": "Vagish", "link": "https://stackoverflow.com/users/2705907/vagish"}, "edited": false, "score": 0, "creation_date": 1557917145, "post_id": 56143661, "comment_id": 98924385, "body": "i reffered there but there is no information about powering up USB port..is there any other solution..."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1557944926, "post_id": 56143661, "comment_id": 98940298, "body": "Presumably by setting <code>USB0_VBUSEN</code> but I would imagine that would be done in your HMSC class driver.  Are you using this:  <a href=\"https://www.renesas.com/us/en/doc/products/mpumcu/apn/rx/002/r01an0513ej0232_usb.pdf\" rel=\"nofollow noreferrer\">renesas.com/us/en/doc/products/mpumcu/apn/rx/002/&hellip;</a>?  Does the sample application work?  Does your board actually support USB OTG?  If it an off-the-shelf board or a custom board? Do you know the hardware to be working?"}, {"owner": {"reputation": 1, "user_id": 11497829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64662fb1ab8ebaf6640db4efa29fcca0?s=128&d=identicon&r=PG&f=1", "display_name": "jeev", "link": "https://stackoverflow.com/users/11497829/jeev"}, "edited": false, "score": 0, "creation_date": 1557987387, "post_id": 56143661, "comment_id": 98951494, "body": "It supports usb otg ...i tried one sample code...it doesn&#39;t have any error ...but i am not able to supply power to the usb port and do you have any idea on how to read and write data into a text file...."}], "owner": {"reputation": 1, "user_id": 11497829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64662fb1ab8ebaf6640db4efa29fcca0?s=128&d=identicon&r=PG&f=1", "display_name": "jeev", "link": "https://stackoverflow.com/users/11497829/jeev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557908216, "creation_date": 1557904857, "last_edit_date": 1557908216, "question_id": 56143661, "link": "https://stackoverflow.com/questions/56143661/not-able-to-power-up-usb-port-of-rx111-controller", "title": "not able to power up usb port of RX111 controller", "body": "<p>I have used LCD port of this RX111 and its working but I am not able to powerup the usb port of RX111.<br>\nplease kindly suggest me a solution...I have put the main code of it</p>\n\n<pre><code>  void main(void)\n  {\n      R_MAIN_UserInit();\n      /* Start user code. Do not edit comment generated here */\n      Clear_Display();\n      DisplayCenter(0, (uint8_t *)\"USB Project\");\n\n      /* Start toggling the LEDs */\n      R_CMT1_Start();\n\n      /* Configure a switch press callback function */\n      SetSwitchPressCallback(cb_switch_press);\n      while (1)\n      {\n          if( R_usb_cstd_Scheduler() == USB_FLGSET )\n          {\n              R_usb_hstd_HcdTask();       /* HCD Task */\n              R_usb_hstd_MgrTask();       /* MGR Task */\n              usb_hmsc_Task();            /* HMSC Task */\n              usb_hmsc_StrgDriveTask();   /* HSTRG Task */\n              usb_hmsc_SampleAplTask();   /* HMSC Sample Task  */\n          }\n      }\n  }   /* eof main() */\n</code></pre>\n"}, {"tags": ["c", "linux-kernel", "sctp"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557907517, "post_id": 56143624, "comment_id": 98918780, "body": "Does <code>sctp_sendmsg()</code> returns in case the process receives a signal? Maybe add just register an <code>alarm()</code>?"}, {"owner": {"reputation": 31, "user_id": 8078648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881640c7c784319cbb9ace9d5f1983da?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/8078648/vladimir"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557909298, "post_id": 56143624, "comment_id": 98919701, "body": "I didn&#39;t check it but seems this way is not suitable for my application because it is single-threaded and in this case the code after sctp_sendmsg will not be executed."}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557909729, "post_id": 56143624, "comment_id": 98919914, "body": "why? why? Threading has nothing to do here, with alarms. A single threaded - that&#39;s even better, no need to worry about mutexes. <code>the code after sctp_sendmsg will not be executed</code> why??? If it acts like <code>select()</code> or <code>sleep()</code> etc. calls, it will just return with ERRNO = EINTR."}, {"owner": {"reputation": 31, "user_id": 8078648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881640c7c784319cbb9ace9d5f1983da?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/8078648/vladimir"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557909880, "post_id": 56143624, "comment_id": 98919992, "body": "maybe I didn&#39;t get your idea? did you propose to send kill -&lt;signal&gt; &lt;pid&gt; to the application?"}, {"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557909919, "post_id": 56143624, "comment_id": 98920013, "body": "Yes, but from inside the application, set an <code>alarm(1000)</code>  before entering <code>sctp_sendmsg</code>."}, {"owner": {"reputation": 31, "user_id": 8078648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881640c7c784319cbb9ace9d5f1983da?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/8078648/vladimir"}, "reply_to_user": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1557914109, "post_id": 56143624, "comment_id": 98922527, "body": "Seems I can re-use it somehow. Thanks a lot for the idea."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 11952062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e8d5a56dfb7044025d8bb156de9cb71?s=128&d=identicon&r=PG", "display_name": "MobileDeveloper", "link": "https://stackoverflow.com/users/11952062/mobiledeveloper"}, "is_accepted": false, "score": 1, "last_activity_date": 1566309742, "creation_date": 1566309742, "answer_id": 57575423, "question_id": 56143624, "link": "https://stackoverflow.com/questions/56143624/how-to-fix-hang-of-sctp-sendmsg-to-unreachable-host/57575423#57575423", "title": "How to fix hang of sctp_sendmsg to unreachable host", "body": "<p>I think setting SCTP_INIT params will help</p>\n\n<pre><code>     struct sctp_initmsg {\n     uint16_t sinit_num_ostreams;\n     uint16_t sinit_max_instreams;\n     uint16_t sinit_max_attempts;\n     uint16_t sinit_max_init_timeo;\n     };\n\n    sinit_max_attempts:  This integer specifies how many attempts the\n      SCTP endpoint should make at resending the INIT.  This value\n      overrides the system SCTP 'Max.Init.Retransmits' value.  The\n      default value of 0 indicates the use of the endpoint's default\n      value.  This is normally set to the system's default\n      'Max.Init.Retransmit' value.\n\n   sinit_max_init_timeo:  This value represents the largest timeout or\n      retransmission timeout (RTO) value (in milliseconds) to use in\n      attempting an INIT.  Normally, the 'RTO.Max' is used to limit the\n      doubling of the RTO upon timeout.  For the INIT message, this\n      value may override 'RTO.Max'.  This value must not influence\n      'RTO.Max' during data transmission and is only used to bound the\n      initial setup time.  A default value of 0 indicates the use of the\n      endpoint's default value.  This is normally set to the system's\n      'RTO.Max' value (60 seconds).\n</code></pre>\n\n<p>Before establishing connection (or call sctp_sendmsg) set socket options like this:</p>\n\n<pre><code>    sctp_initmsg init;\n    init.sinit_max_attempts   = m_nMaxAttempts;\n    init.sinit_max_init_timeo = m_nMaxInitTimeout;\n\n    if (setsockopt(nSockID, SOL_SCTP, SCTP_INITMSG, &amp;init, sizeof(init)) != 0)\n    {\n        std::cout &lt;&lt; strerror(errno);\n        return -1;\n    }\n    return 0;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8078648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/881640c7c784319cbb9ace9d5f1983da?s=128&d=identicon&r=PG&f=1", "display_name": "Vladimir", "link": "https://stackoverflow.com/users/8078648/vladimir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1566309742, "creation_date": 1557904710, "last_edit_date": 1557907159, "question_id": 56143624, "link": "https://stackoverflow.com/questions/56143624/how-to-fix-hang-of-sctp-sendmsg-to-unreachable-host", "title": "How to fix hang of sctp_sendmsg to unreachable host", "body": "<p>I am using Linux SCTP via lksctp-tools (CentOS 7.3, lksctp-tools-1.0.17-2.el7.x86_64) in my C application. How to avoid hang of <code>sctp_sendmsg()</code> function when it is used to establish a new SCTP association with the unreachable destination host.</p>\n\n<p>When <code>sctp_sendmsg()</code> is triggered from C code to establish new SCTP association with dest host which is not reachable then it hangs for several minutes and in wireshark, I see that Linux sends SCTP INIT retries. \nHow to avoid this hang? \nIs it possible to configure some timeout (for ex: 1 sec) which will interrupt <code>sctp_sendmsg()</code> or is it possible somehow quickly check that destination is alive (I don't want to follow ICMP  req-resp way)</p>\n\n<p>Configured TTL and flags arguments didn't help to resolve this issue.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>const uint32_t ttl = 1000; //ms\nrc = sctp_sendmsg(sctp_socket-&gt;fd, data.s, data.len, (struct sockaddr*)&amp;sin, sizeof(sin), htonl(ppid), 0, 0, ttl, 0);\nif (rc &lt; 0) {\n    printf(\"Could not connect: %s\\n\", strerror(errno));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 6230, "user_id": 924820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d35254b4ba07fdb455b7ceb44cd3d279?s=128&d=identicon&r=PG", "display_name": "BigMike", "link": "https://stackoverflow.com/users/924820/bigmike"}, "edited": false, "score": 3, "creation_date": 1557903209, "post_id": 56143267, "comment_id": 98916585, "body": "What&#39;s the value of r (assuming is not a typo) ? Do this even compile ?"}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1557903408, "post_id": 56143267, "comment_id": 98916688, "body": "(a) major: there is no such this as <code>r</code> anywhere in this code until <code>if(r==0)</code>, and (b) minor: <code>element</code> seems completely pointless in that argument list. How about the <i>real</i> code, or better still, a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Regarding <code>*headref=*headref-&gt;next</code>. It doesn&#39;t work for two reasons: 1. Operator precedence; that should be <code>*headref = (*headref)-&gt;next;</code> and 2. It isn&#39;t properly terminated with a <code>;</code>, so the line is invalid regardless."}], "answers": [{"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": true, "score": 3, "last_activity_date": 1557903623, "creation_date": 1557903623, "answer_id": 56143383, "question_id": 56143267, "link": "https://stackoverflow.com/questions/56143267/why-doesnt-the-following-work-even-though-they-both-pointers-point-to-the-same/56143383#56143383", "title": "Why doesn&#39;t the following work even though they both pointers point to the same address?", "body": "<p><code>-&gt;</code> has higher precedence than <code>*</code>.</p>\n\n<p><code>*headref-&gt;next</code> means <code>*(headref-&gt;next)</code>, while <code>pop1-&gt;next</code> is equivalent to <code>(*headref)-&gt;next</code>.</p>\n\n<p>In other words, you don't need <code>pop1</code> if you add a pair of parentheses.</p>\n"}], "owner": {"reputation": 11, "user_id": 9573222, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-HfNAV9_rE8U/AAAAAAAAAAI/AAAAAAAACQg/YksRBfXJjYU/photo.jpg?sz=128", "display_name": "NARASHIMA M", "link": "https://stackoverflow.com/users/9573222/narashima-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56143383, "answer_count": 1, "score": -1, "last_activity_date": 1557903623, "creation_date": 1557903071, "last_edit_date": 1557903284, "question_id": 56143267, "link": "https://stackoverflow.com/questions/56143267/why-doesnt-the-following-work-even-though-they-both-pointers-point-to-the-same", "title": "Why doesn&#39;t the following work even though they both pointers point to the same address?", "body": "<p>I am learning Structures and linked lists. When using a double structure pointer as head , I can't make it to direct to next element without using another structure pointer.</p>\n\n<pre><code>void pop(struct stack **headref,int element)\n{\n    struct stack *pop1=*headref;\n    if(pop1==NULL)\n    {\n        return 0;\n    }\n\n    if(r==0)\n    {\n        printf(\"%d %d\",*headref,pop1);\n        //*headref=*headref-&gt;next     why doesnt this line work?\n        *headref=pop1-&gt;next;\n        free(pop1);\n        return 1;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "compiler-construction", "grammar", "bison", "flex-lexer"], "comments": [{"owner": {"reputation": 11, "user_id": 9152886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd46db0c9be02ae5e533f62962438ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Melika Knight", "link": "https://stackoverflow.com/users/9152886/melika-knight"}, "reply_to_user": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "edited": false, "score": 0, "creation_date": 1557903387, "post_id": 56143165, "comment_id": 98916671, "body": "@Mike Kinghan thank you"}], "answers": [{"comments": [{"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 1, "creation_date": 1557910524, "post_id": 56144784, "comment_id": 98920365, "body": "Excellent answer!"}, {"owner": {"reputation": 11, "user_id": 9152886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd46db0c9be02ae5e533f62962438ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Melika Knight", "link": "https://stackoverflow.com/users/9152886/melika-knight"}, "edited": false, "score": 0, "creation_date": 1557987931, "post_id": 56144784, "comment_id": 98951726, "body": "Thank you so much for your detailed answer, I really appreciate your help. @Brian Tompsett - \u6c64\u83b1\u6069.  I have a question, when you used gcc parser.tab.c lex.yy.c -ll -o parser , have you written all of the Stack now,Cleanup,... in your parser? because when I run my parser it doesn&#39;t show any of details like Reading a token, Entering,...I&#39;m to writing compiler this way. thank you so much for your help"}, {"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "reply_to_user": {"reputation": 11, "user_id": 9152886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd46db0c9be02ae5e533f62962438ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Melika Knight", "link": "https://stackoverflow.com/users/9152886/melika-knight"}, "edited": false, "score": 0, "creation_date": 1557989131, "post_id": 56144784, "comment_id": 98952232, "body": "@MelikaKnight Please click the tick symbol to accept the answer. BTW: There is no stack code in my copy of the parser. As I said, I deleted it to get it to compile."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1558081745, "post_id": 56144784, "comment_id": 98990572, "body": "@BrianTompsett-\u6c64\u83b1\u6069, good job!  You have actually made more work than the original question poster."}], "tags": [], "owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "is_accepted": true, "score": 8, "last_activity_date": 1557928154, "last_edit_date": 1557928154, "creation_date": 1557908944, "answer_id": 56144784, "question_id": 56143165, "link": "https://stackoverflow.com/questions/56143165/getting-syntax-error-in-flex-bison-with-this-grammar/56144784#56144784", "title": "Getting Syntax Error in flex/bison with this grammar", "body": "<p>You are getting a syntax error because your input program is syntactically incorrect and the parser is working properly.</p>\n\n<p>The (trimmed) grammar shows a program as:</p>\n\n<pre><code>program:    PROGRAM IDENTIFIER M SEMICOLON declist block SEMICOLON\n</code></pre>\n\n<p>and it shows a block as:</p>\n\n<pre><code>block : \n    BEGINN stmtlist END\n    | stmt \n    ;\n</code></pre>\n\n<p>and subsequently a statement list is:</p>\n\n<pre><code>stmtlist : \n    stmt \n    | stmtlist SEMICOLON stmt \n    ;\n</code></pre>\n\n<p>Here, you will see that a SEMICOLON is a statement separator and not a terminator. This means there can never be a SEMICOLON before an END. However you did that:</p>\n\n<pre><code> Begin\n    i1 := i1 + i2;\n\nEnd\n</code></pre>\n\n<p>So you have to decide which is the correct interpretation of the language; your grammar or your input program. Beginners make this mistake so often it takes an experienced programmer or teacher a few seconds to spot. How could you have used bison to learn this? I'll add that detail following ...</p>\n\n<hr>\n\n<p>How could you have found this on your own? Well, following the <a href=\"https://stackoverflow.com/help/reprex\">rules of Stack Overflow</a> would have been a good start. You have not reduced your code example to the minimum required to explain your problem. You just dumped THE WHOLE THING into your question and just gave up and handed it over to us. </p>\n\n<p>How could a good student have simplified this problem. One thing you could have done is simplified your test input to  the parser and tried simpler and simpler input programs. For example, ask yourself \"does the error occur in the declarations or the block?\". \"What happens if I use a simpler program with no declarations?\". Using this form of deduction you might be able to deduce that the fault lies somewhere in the BLOCK. You could have tried examples that matched the different rules in BLOCK and statement list to see which alternatives worked and which did not and eventually find the rule that caused problems.</p>\n\n<p>You could then have created a much smaller grammar, lexer and test program to paste into Stack Overflow which explained the specific problem with the specific grammar rule that was failing and ask for help at that point. However, usually, in the process of creating the smaller example the problem and solution reveals itself.</p>\n\n<p>A more powerful and programmatic way of finding what caused the issue is to use the debug features built into bison. Bison has a test mode which is enabled by running bison with the -t argument and also setting the yydebug variable at run time. This will produce a detailed trace of the parse which will show you exactly which input symbol and rule caused the fault. I'll show you what that produces in the next installment following ...</p>\n\n<hr>\n\n<p>OK. I've now, after some issues with your pasted code produced the desired output. You have incorrectly pasted invalid code into the question. There is an extra \"}\" on line 41 of parser.y which I had to delete and we do not have your stack.h. I had to remove all your semantic actions to show a grammar debug. Anyway, after doing that and running with bison debug enabled we get the following (on my Mac):</p>\n\n<pre><code>briantompsett:~ cssbct$ gcc parser.tab.c lex.yy.c -ll -o parser\nbriantompsett:~ cssbct$ ./parser\nStarting parse\nEntering state 0\nReading a token: Program p1Main;\n\n    Int i1, i2:=#-23;   \nBegin\n    i1 := i1 + i2;\n\nEnd\n;Next token is token PROGRAM ()\nShifting token PROGRAM ()\nEntering state 1\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 3\nReducing stack by rule 3 (line 108):\n-&gt; $$ = nterm M ()\nStack now 0 1 3\nEntering state 5\nReading a token: Next token is token SEMICOLON ()\nShifting token SEMICOLON ()\nEntering state 6\nReading a token: Next token is token INT ()\nShifting token INT ()\nEntering state 9\nReducing stack by rule 9 (line 122):\n   $1 = token INT ()\n-&gt; $$ = nterm type ()\nStack now 0 1 3 5 6\nEntering state 26\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 50\nReading a token: Next token is token COMMA ()\nReducing stack by rule 12 (line 133):\n   $1 = token IDENTIFIER ()\n-&gt; $$ = nterm iddec ()\nStack now 0 1 3 5 6 26\nEntering state 51\nReducing stack by rule 15 (line 139):\n   $1 = nterm iddec ()\n-&gt; $$ = nterm idlist ()\nStack now 0 1 3 5 6 26\nEntering state 52\nNext token is token COMMA ()\nShifting token COMMA ()\nEntering state 82\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 50\nReading a token: Next token is token DECLARE ()\nShifting token DECLARE ()\nEntering state 81\nReducing stack by rule 13 (line 134):\n-&gt; $$ = nterm @1 ()\nStack now 0 1 3 5 6 26 52 82 50 81\nEntering state 110\nReading a token: Next token is token INTEGER ()\nShifting token INTEGER ()\nEntering state 7\nReading a token: Next token is token SEMICOLON ()\nReducing stack by rule 52 (line 206):\n   $1 = token INTEGER ()\n-&gt; $$ = nterm exp ()\nStack now 0 1 3 5 6 26 52 82 50 81 110\nEntering state 124\nNext token is token SEMICOLON ()\nReducing stack by rule 14 (line 134):\n   $1 = token IDENTIFIER ()\n   $2 = token DECLARE ()\n   $3 = nterm @1 ()\n   $4 = nterm exp ()\n-&gt; $$ = nterm iddec ()\nStack now 0 1 3 5 6 26 52 82\nEntering state 111\nReducing stack by rule 16 (line 140):\n   $1 = nterm idlist ()\n   $2 = token COMMA ()\n   $3 = nterm iddec ()\n-&gt; $$ = nterm idlist ()\nStack now 0 1 3 5 6 26\nEntering state 52\nNext token is token SEMICOLON ()\nShifting token SEMICOLON ()\nEntering state 83\nReducing stack by rule 17 (line 143):\n   $1 = nterm type ()\n   $2 = nterm idlist ()\n   $3 = token SEMICOLON ()\n-&gt; $$ = nterm vardec ()\nStack now 0 1 3 5 6\nEntering state 27\nReducing stack by rule 6 (line 117):\n   $1 = nterm vardec ()\n-&gt; $$ = nterm dec ()\nStack now 0 1 3 5 6\nEntering state 25\nReducing stack by rule 4 (line 113):\n   $1 = nterm dec ()\n-&gt; $$ = nterm declist ()\nStack now 0 1 3 5 6\nEntering state 24\nReading a token: this is idlist iddecthis is declare eeeethis is integerrrrvardecvar decccNext token is token BEGINN ()\nShifting token BEGINN ()\nEntering state 14\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 20\nReading a token: Next token is token DECLARE ()\nReducing stack by rule 34 (line 184):\n   $1 = token IDENTIFIER ()\n-&gt; $$ = nterm lvalue ()\nStack now 0 1 3 5 6 24 14\nEntering state 31\nNext token is token DECLARE ()\nShifting token DECLARE ()\nEntering state 54\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 20\nReading a token: Next token is token PLUS ()\nReducing stack by rule 34 (line 184):\n   $1 = token IDENTIFIER ()\n-&gt; $$ = nterm lvalue ()\nStack now 0 1 3 5 6 24 14 31 54\nEntering state 39\nNext token is token PLUS ()\nReducing stack by rule 56 (line 210):\n   $1 = nterm lvalue ()\n-&gt; $$ = nterm exp ()\nStack now 0 1 3 5 6 24 14 31 54\nEntering state 84\nNext token is token PLUS ()\nShifting token PLUS ()\nEntering state 57\nReading a token: Next token is token IDENTIFIER ()\nShifting token IDENTIFIER ()\nEntering state 20\nReading a token: Next token is token SEMICOLON ()\nReducing stack by rule 34 (line 184):\n   $1 = token IDENTIFIER ()\n-&gt; $$ = nterm lvalue ()\nStack now 0 1 3 5 6 24 14 31 54 84 57\nEntering state 39\nNext token is token SEMICOLON ()\nReducing stack by rule 56 (line 210):\n   $1 = nterm lvalue ()\n-&gt; $$ = nterm exp ()\nStack now 0 1 3 5 6 24 14 31 54 84 57\nEntering state 87\nNext token is token SEMICOLON ()\nReducing stack by rule 46 (line 200):\n   $1 = nterm exp ()\n   $2 = token PLUS ()\n   $3 = nterm exp ()\n-&gt; $$ = nterm exp ()\nStack now 0 1 3 5 6 24 14 31 54\nEntering state 84\nNext token is token SEMICOLON ()\nReducing stack by rule 35 (line 187):\n   $1 = nterm lvalue ()\n   $2 = token DECLARE ()\n   $3 = nterm exp ()\n-&gt; $$ = nterm stmt ()\nStack now 0 1 3 5 6 24 14\nEntering state 38\nReducing stack by rule 32 (line 180):\n   $1 = nterm stmt ()\n-&gt; $$ = nterm stmtlist ()\nStack now 0 1 3 5 6 24 14\nEntering state 37\nNext token is token SEMICOLON ()\nShifting token SEMICOLON ()\nEntering state 71\nReading a token: Next token is token END ()\nError : syntax error\nError: popping token SEMICOLON ()\nStack now 0 1 3 5 6 24 14 37\nError: popping nterm stmtlist ()\nStack now 0 1 3 5 6 24 14\nError: popping token BEGINN ()\nStack now 0 1 3 5 6 24\nError: popping nterm declist ()\nStack now 0 1 3 5 6\nError: popping token SEMICOLON ()\nStack now 0 1 3 5\nError: popping nterm M ()\nStack now 0 1 3\nError: popping token IDENTIFIER ()\nStack now 0 1\nError: popping token PROGRAM ()\nStack now 0\nCleanup: discarding lookahead token END ()\nStack now 0\n</code></pre>\n\n<p>You'll see that now it stopped at the SEMICOLON before the END, as shown by this part of the trace:</p>\n\n<pre><code>Next token is token SEMICOLON ()\nShifting token SEMICOLON ()\nEntering state 71\nReading a token: Next token is token END ()\nError : syntax error\nError: popping token SEMICOLON ()\n</code></pre>\n\n<p>That's how you should debug in the future.</p>\n"}], "owner": {"reputation": 11, "user_id": 9152886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd46db0c9be02ae5e533f62962438ee5?s=128&d=identicon&r=PG&f=1", "display_name": "Melika Knight", "link": "https://stackoverflow.com/users/9152886/melika-knight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 56144784, "answer_count": 1, "score": 1, "last_activity_date": 1557928154, "creation_date": 1557902662, "last_edit_date": 1557928008, "question_id": 56143165, "link": "https://stackoverflow.com/questions/56143165/getting-syntax-error-in-flex-bison-with-this-grammar", "title": "Getting Syntax Error in flex/bison with this grammar", "body": "<p>I am trying to generate middle code for a compiler. I am using flex-bison on macOS.\nWhen I try an input I get syntax error and I do not know where that syntax error came from. </p>\n\n<p>This is my lex: </p>\n\n<pre><code>%{\n#include&lt;stdbool.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n//#include \"LinkedList.h\"\n#include \"parser.tab.h\"\nchar* tempString;\n%}\n%option yylineno\n\nwhole   0|[1-9][0-9]*\nreal    {whole}\\.(([0-9])|([0-9][0-9]*[1-9]))\ndivisionop [/]\nnoSymbol    [^ \\t\\n\\/\\+\\-\\*\\:\\;\\,\\(\\)\\.]\nerror   {noSymbol}+\n\n%%\n\n\n[ \\t\\n\\r]+  ;\n\n\n\n\\#[-+]?{whole}/[\\ :\\,\\;\\+\\-\\/\\*\\)\\n\\r]|\".GT.\"|\".GE.\"|\".EQ.\"|\".NE.\"|\".LT.\"|\".LE.\"|\":=\"   {\n\n    char* string = (char*) malloc(strlen(yytext));\n    strcpy(string, yytext + 1);\n    string[strlen(string)] = 0;\n    //printf(\"Found integer : %d\\n\", atoi(string));\n    //push(string,INTEGER,yylineno);\n    return INTEGER;}\n\n\n\\#[-+]?{real}/[\\ :\\,\\;\\+\\-\\/\\*\\)\\n\\r]|\".GT.\"|\".GE.\"|\".EQ.\"|\".NE.\"|\".LT.\"|\".LE.\"|\":=\"    {\n    char* string = (char*) malloc(strlen(yytext));\n    strcpy(string, yytext + 1);\n    string[strlen(string)] = 0;\n    //printf(\"Found real:%s\\n\",string);\n    //push(string,REAL,0);\n    return REALNUM;\n}\n\n[a-zA-Z][0-9][0-9a-zA-Z]*   {\n    //printf(\"Found identifier:%s\\n\",yytext);\n    //yylval.str = yytext;\n    //printf(\"****lvalue is:%s\\n\",yylval.str);\n    //push(yytext,IDENTIFIER,yylineno);\n    tempString = (char*) malloc(strlen(yytext));\n    strcpy(tempString, yytext);\n    return IDENTIFIER;\n}\n\nProgram {\n    //printf(\"Found program :%s\\n\",yytext);\n    return PROGRAM;\n\n}\n\nInt {\n    //printf(\"Found int :%s\\n\",yytext);\n    return INT;\n\n}\n\nReal    {\n    //printf(\"Found real :%s\\n\",yytext);\n    return REAL;\n\n}\n\nBool    {\n    //printf(\"Found bool :%s\\n\",yytext);\n    return BOOL;\n\n}\n\nProcedure   {\n    //printf(\"Found real :%s\\n\",yytext);\n    return PROCEDURE;\n\n}\n\nFunction    {\n    //printf(\"Found function :%s\\n\",yytext);\n    return FUNCTION;\n\n}\n\nBegin   {\n    //printf(\"Found begin :%s\\n\",yytext);\n    return BEGINN;\n\n}\n\nEnd {\n    //printf(\"Found end :%s\\n\",yytext);\n    return END;\n\n}\n\nIf  {\n    //printf(\"Found if :%s\\n\",yytext);\n    return IF;\n}\n\nThen {\n    //printf(\"Found then :%s\\n\",yytext);\n    return THEN;\n\n}\n\nElse {\n    //printf(\"Found else :%s\\n\",yytext);\n    return ELSE;\n}\n\nWhile {\n    //printf(\"Found while :%s\\n\",yytext);\n    return WHILE;\n}\n\nDo {\n    //printf(\"Found do :%s\\n\",yytext);\n    return DO;\n}\n\nFor {\n    //printf(\"Found for :%s\\n\",yytext);\n    return FOR;\n}\n\nTo {\n    //printf(\"Found to :%s\\n\",yytext);\n    return TO;\n}\n\nDownto {\n    //printf(\"Found downto :%s\\n\",yytext);\n    return DOWNTO;\n}\n\nCase {\n    //printf(\"Found case :%s\\n\",yytext);\n    return CASE;\n}\n\nReturn {\n    //printf(\"Found return :%s\\n\",yytext);\n    return RETURN;\n}\n\n\"And Then\" {\n    //printf(\"Found andthen :%s\\n\",yytext);\n    //push(yytext,ANDTHEN,yylineno);\n    return ANDTHEN;\n}\n\n\"Or Else\" {\n    //printf(\"Found andthen :%s\\n\",yytext);\n    //push(yytext,ORELSE,yylineno);\n    return ORELSE;\n}\n\n\"+\" {\n    //printf(\"Found plus :%s\\n\",yytext);\n    return PLUS;\n}\n\n\\-  {\n    //printf(\"Found minus :%s\\n\",yytext);\n    return MINUS;\n\n}\n\n\\*  {\n    //printf(\"Found multiply :%s\\n\",yytext);\n    return MULTIPLY;\n}\n\n{divisionop}    {\n    //printf(\"Found division :%s\\n\",yytext);\n    //push(yytext,DIVISION,yylineno);\n    return DIVISION;\n}\n\n\".GT.\"  {\n    //printf(\"Found greaterthan :%s\\n\",yytext);\n    return GREATERTHAN;\n}\n\n\".GE.\"  {\n    //printf(\"Found greaterequal :%s\\n\",yytext);\n    return GREATEREQUAL;\n}\n\n\\.NE\\.  {\n    //printf(\"Found notequal :%s\\n\",yytext);\n    return NOTEQUAL;\n}\n\n\\.EQ\\.  {\n    //printf(\"Found EQUAL :%s\\n\",yytext);\n    return EQUAL;\n}\n\n\\.LT\\.  {\n    //printf(\"Found lessthan :%s\\n\",yytext);\n    return LESSTHAN;\n}\n\n\\.LE\\.  {\n    //printf(\"Found lessequal :%s\\n\",yytext);\n    return LESSEQUAL;\n}\n\n[,] {\n    //printf(\"Found comma :%s\\n\",yytext);\n    return COMMA;\n}\n\n\":=\"    {\n    //printf(\"Found declare :%s\\n\",yytext);\n    return DECLARE;\n}\n\n[:] {\n    //printf(\"Found semicolon :%s\\n\",yytext);\n    return COLON;\n}\n\n[;] {\n    //printf(\"Found semicolon :%s\\n\",yytext);\n    return SEMICOLON;\n}\n\n\n\\( {\n    //printf(\"Found oppar :%s\\n\",yytext);\n\n    return OPPAR;\n\n}\n\n\\)  {\n    //printf(\"Found cppar :%s\\n\",yytext);\n    return CPAR;\n}\n\nFalse   {\n    //printf(\"Found false :%s\\n\",yytext);\n    return FALSE;\n}\n\nTrue    {\n    //printf(\"Found true :%s\\n\",yytext);\n    return TRUE;\n}\n\n{error} {\n    printf(\"Error on : **&lt;&lt;  %s  &gt;&gt;**\\n\", yytext);\n    //yymore();\n}\n\\.  {\n    printf(\"Error on : **&lt;&lt;  illegal use of \\\" %s \\\" &gt;&gt;**\\n\", yytext);\n    //yymore();\n}\n\n%%\n\n\nint yywrap(){\n    return 1;\n}\n\n//int main(){\n//  yyin = fopen(\"input2P.txt\", \"r\");\n//  initLinkedList(table);\n//  while(yylex());\n//  printLinkedList();\n//  return 0;\n//}\n</code></pre>\n\n<p>this is my parser.y</p>\n\n<pre><code>%{\n#include&lt;stdio.h&gt;\n#include \"stack.h\"\n//#include \"LinkedList.h\"\n//#include \"symbol_table.h\"\n\nint currentType;\nchar* returnType;\n\nextern FILE* yyin;\nextern char* tempString;\nstruct Stack* tblptrStack;\n\nchar* new_temp(char *c) {\n    string name(\"t\");\n    name += to_string(num);\n    num++;\n    char *what = (char *) malloc(sizeof(char) * 100);\n    strcpy(what, name.c_str());\n    symbol_table_insert(what, c);\n    strcpy(what, symbol_table_lookup(what).id.c_str());\n    return what;\n}\n\n\nint yylex();\nvoid yyerror(char* error);\nstruct SymbolTable* secondArg(struct SymbolTable* a,struct SymbolTable* b );\n%}\n\n%union{\n  char *str;\n   struct {\n        int quad;\n        int is_boolean;\n        char *place;\n        char *code;\n        char *type;\n   } eval;\n}\n\n}\n\n%start program\n%token INTEGER\n%token ZERO\n%token REALNUM\n%token PROGRAM\n%token INT\n%token REAL\n%token BOOL\n%token PROCEDURE\n%token FUNCTION\n%token BEGINN\n%token END\n%token IF\n%token THEN\n%token ELSE\n%token WHILE\n%token DO\n%token FOR\n%token TO\n%token DOWNTO\n%token CASE\n%token RETURN\n%token ANDTHEN\n%token ORELSE\n%token IDENTIFIER\n%token PLUS\n%token MINUS\n%token MULTIPLY\n%token DIVISION\n%token GREATERTHAN\n%token GREATEREQUAL\n%token NOTEQUAL\n%token EQUAL\n%token LESSTHAN\n%token LESSEQUAL\n%token COMMA\n%token SEMICOLON\n%token COLON\n%token DECLARE\n%token OPPAR\n%token CPAR\n%token FALSE\n%token TRUE\n%token ERROR\n%type &lt;eval&gt; exp\n\n%left COMMA\n%left INT BOOL REAL\n\n%left COLON\n%left IF_PREC   \n%left ELSE\n%left ANDTHEN ORELSE\n%left PLUS MINUS\n%left MULTIPLY DIVISION\n%left GREATERTHAN GREATEREQUAL NOTEQUAL EQUAL LESSTHAN LESSEQUAL\n\n%%\n\nprogram:\n    PROGRAM IDENTIFIER M SEMICOLON declist block SEMICOLON {\n        printf(\"\\nin program\\n\"); allSymbolTablePrint( pop(tblptrStack) ); \n    }\n    | PROGRAM IDENTIFIER M SEMICOLON block SEMICOLON {\n        printf(\"\\nin program\\n\"); allSymbolTablePrint( pop(tblptrStack) ); \n    }\n    ;\nM:\n    { \n        struct SymbolTable* t = mkTable( NULL , \"program\");\n        push(t, tblptrStack);\n    }\n;\ndeclist:\n    dec\n    | declist dec \n    ;\ndec : \n    vardec {printf(\"var deccc\");}\n    | procdec\n    | funcdec\n    ;\ntype : \n    INT {\n        currentType=4;\n        returnType = (char*) malloc(strlen(\"INT\"));\n        strcpy(returnType, \"INT\");\n        printf(\"this is int\");\n    }\n    | REAL {\n        currentType=8;\n        returnType = (char*) malloc(strlen(\"REAL\"));\n        strcpy(returnType, \"REAL\");\n    }\n    |BOOL {\n        currentType=1;\n        returnType = (char*) malloc(strlen(\"BOOL\"));\n        strcpy(returnType, \"BOOL\");\n    }\n    ;\niddec : \n    IDENTIFIER { enterVar( tempString, currentType , 0 , top(tblptrStack) ); printf(\"a variable entered:%s\\n\",tempString); }\n    | IDENTIFIER { enterVar( tempString, currentType , 0 , top(tblptrStack) ); printf(\"a variable entered:%s\\n\",tempString); } DECLARE {\n    printf(\"this is declare eeee\");\n    } exp \n    ;\nidlist : \n    iddec {printf(\"this is idlist iddec\");}\n    | idlist COMMA iddec\n    ;\nvardec :\n    type idlist SEMICOLON \n    {printf(\"vardec\");}\n    ;\nprocdec :\n    PROCEDURE IDENTIFIER NP OPPAR paramdecs CPAR declist block SEMICOLON {\n        char* tmpc = top(tblptrStack)-&gt;name;\n        struct SymbolTable* tmpt = pop(tblptrStack);\n        enterProcFunc( tmpc , 0 , \"NULL\" ,  tmpt , top(tblptrStack) ); \n    }\n    | PROCEDURE IDENTIFIER NP OPPAR paramdecs CPAR block SEMICOLON { \n        char* tmpc = top(tblptrStack)-&gt;name;\n        struct SymbolTable* tmpt = pop(tblptrStack);\n        enterProcFunc( tmpc , 0 , \"NULL\" ,  tmpt , top(tblptrStack) ); \n    }\n    ;\nNP:\n    {\n        printf(\"inside NP\\t tempString:%s\\n\",tempString);\n        struct SymbolTable* t = mkTable( top(tblptrStack) , tempString );\n        push(t, tblptrStack);\n    }\n    ;\nfuncdec :\n    FUNCTION IDENTIFIER FN OPPAR paramdecs CPAR COLON type {\n        char* tmpc = top(tblptrStack)-&gt;name;\n        struct SymbolTable* tmpt = pop(tblptrStack);\n        enterProcFunc(tmpc , -1 , returnType ,  tmpt , top(tblptrStack) );\n    } declist block SEMICOLON\n    | FUNCTION IDENTIFIER FN OPPAR paramdecs CPAR COLON type {\n        char* tmpc = top(tblptrStack)-&gt;name;\n        struct SymbolTable* tmpt = pop(tblptrStack);\n        enterProcFunc(tmpc , -1 , returnType ,  tmpt , top(tblptrStack) );\n    } block SEMICOLON\n    ;\nFN:\n    {\n        printf(\"inside FN\\t tempString:%s\\n\",tempString);\n        struct SymbolTable* t = mkTable( top(tblptrStack) , tempString );\n        push(t, tblptrStack);\n    }\n    ;\nparamdecs :\n    paramdec { printf(\"paramdecs\"); }\n    | paramdecs SEMICOLON paramdec { printf(\"paramdecs\\n\"); }\n    | { printf(\"paramdecs\\n\"); }\n    ;\nparamdec : \n    type paramlist\n    ;\nparamlist :\n    IDENTIFIER \n    | paramlist COMMA IDENTIFIER\n    ;\nblock : \n    BEGINN stmtlist END\n    | stmt \n    ;\nstmtlist : \n    stmt \n    | stmtlist SEMICOLON stmt \n    ;\nlvalue : \n    IDENTIFIER\n    ;\nstmt :\n    lvalue DECLARE exp \n    | IF exp THEN block %prec IF_PREC\n    | IF exp THEN block ELSE block %prec ELSE\n    | WHILE exp DO block \n    | FOR lvalue DECLARE exp TO exp DO block \n    | FOR lvalue DECLARE exp DOWNTO exp DO block \n    | CASE exp caseelement END \n    | RETURN exp \n    | exp {printf(stmt exp);}\n    ;\nexp : \n    exp ANDTHEN exp \n    | exp ORELSE exp  \n    | exp PLUS exp   {\n        printf(\"Rule  \\t\\t mathlogicExpression -&gt; mathlogicExpression KW_PLUS mathlogicExpression\\n\");\n        $$.place = new_temp($1.type);\n        $$.type = $1.type;\n        printf($1.place, $3.place, \"+\", $$.place);\n    };\n    | exp MINUS exp \n    | exp MULTIPLY exp { printf(\" RULE FOR MULTIPLY\\n\");}\n    | exp DIVISION exp \n    | OPPAR exp CPAR \n    | boolexp relop boolexp\n    | INTEGER {printf(\"this is integerrrr\");}\n    | REALNUM \n    | TRUE\n    | FALSE \n    | lvalue \n    | IDENTIFIER OPPAR explist CPAR \n    ;\nboolexp:\n    OPPAR exp CPAR \n    | INTEGER \n    | REALNUM \n    | TRUE\n    | FALSE \n    | lvalue \n    | IDENTIFIER OPPAR explist CPAR \n    ;\ncaseelement : \n    INTEGER COLON block SEMICOLON\n    | caseelement INTEGER COLON block SEMICOLON\n    ;\nexplist :\n    exp \n    | explist COMMA exp  \n    |\n    ;\nrelop :\n    GREATERTHAN\n    | GREATEREQUAL\n    | NOTEQUAL\n    | EQUAL\n    | LESSTHAN\n    | LESSEQUAL\n    ;\n\n\n%%\n\nstruct SymbolTable* popTop(struct Stack* b ){\n    pop(b);\n    top(b);\n}\n\nint main(){\n    //printf(\"hi1\");\n    tblptrStack=createStack();\n    tblptrStack-&gt;top = NULL;\n    //printf(\"hi2\");\n    yyin = fopen(\"input3.txt\", \"r\");\n    //printf(\"hi3\");\n    yyparse();\n    return 0;\n}\n\nvoid yyerror(char* error){\n    printf(\"Error : %s\\n\", error);\n} \n</code></pre>\n\n<p>I tried this input for example:</p>\n\n<pre><code>Program p1Main;\n\n    Int i1, i2:=#-23;   \nBegin\n    i1 := i1 + i2;\n\nEnd\n;\n</code></pre>\n\n<p>and I get this error </p>\n\n<pre><code>a variable entered:i1\na variable entered:i2\nError : syntax error\nlogout\nSaving session...\n...copying shared history...\n...saving history...truncating history files...\n...completed.\n</code></pre>\n\n<p>I have tried to put <code>printf</code> s to find out where this syntax error comes from but I did not get any results. I have seen the other questions like this and tried their solution but it didn't work. Please help me if you know how to solve this. </p>\n"}, {"tags": ["c", "dll", "dllimport", "calling-convention"], "comments": [{"owner": {"reputation": 7055, "user_id": 1374704, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VNVyl.png?s=128&g=1", "display_name": "manuell", "link": "https://stackoverflow.com/users/1374704/manuell"}, "edited": false, "score": 0, "creation_date": 1557904621, "post_id": 56143055, "comment_id": 98917234, "body": "Did you see <a href=\"https://stackoverflow.com/questions/9946322/how-to-generate-an-import-library-lib-file-from-a-dll\" title=\"how to generate an import library lib file from a dll\">stackoverflow.com/questions/9946322/&hellip;</a> ?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557904869, "post_id": 56143055, "comment_id": 98917345, "body": "Using a def files work here. Please show a full, but minimal example."}, {"owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557905531, "post_id": 56143055, "comment_id": 98917709, "body": "@DavidHeffernan the DEF file for the DLL looks like this. Is there a way to tell <code>lib.exe</code> that ExampleFunction is undecorated stdcall?  <code>LIBRARY example-dll  EXPORTS  ExampleFunction</code>"}, {"owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "reply_to_user": {"reputation": 7055, "user_id": 1374704, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VNVyl.png?s=128&g=1", "display_name": "manuell", "link": "https://stackoverflow.com/users/1374704/manuell"}, "edited": false, "score": 0, "creation_date": 1557905672, "post_id": 56143055, "comment_id": 98917791, "body": "@manuell yes that was the first thing I saw when I started making the lib file."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557905717, "post_id": 56143055, "comment_id": 98917819, "body": "Can we have a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, in the question, by way of an edit. If you don&#39;t know how to do that, please visit the <a href=\"https://stackoverflow.com/help\">help center</a> and take the <a href=\"https://stackoverflow.com/tour\">tour</a>."}, {"owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1557907624, "post_id": 56143055, "comment_id": 98918843, "body": "@DavidHeffernan I&#39;ve now extended the question to include a reproducible example."}, {"owner": {"reputation": 7055, "user_id": 1374704, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VNVyl.png?s=128&g=1", "display_name": "manuell", "link": "https://stackoverflow.com/users/1374704/manuell"}, "edited": false, "score": 0, "creation_date": 1557911826, "post_id": 56143055, "comment_id": 98921123, "body": "Are you sure you feed the lib file to the linker? What happens when you suppress the extern keyword? You say &quot;I&#39;m importing by making declarations&quot;... That&#39;s not quite right. You just have to prototype the function (to make the compiler happy) and then give the lib to the linker."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557912231, "post_id": 56143055, "comment_id": 98921385, "body": "The process you use is exactly how I generate lib files and the resulting lib file has names that are not decorated in any way. I am sure that there is some extra step that you are taking that is not shown in the question."}, {"owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557914134, "post_id": 56143055, "comment_id": 98922547, "body": "@DavidHeffernan I just repeated the process step by step as I wrote it. No extra steps. Same output as listed in question where symbol name is prefixed with &#39;_&#39;. If you note in the linked article, the author managed to get <code>Name type: undecorate</code>. However I can&#39;t seem to get his dummy/stub method working either. <code>undecorate</code> is still a thing as e.g. <code>user32.lib</code> has all <code>stdcall</code> functions and uses it. But how?"}, {"owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "reply_to_user": {"reputation": 7055, "user_id": 1374704, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/VNVyl.png?s=128&g=1", "display_name": "manuell", "link": "https://stackoverflow.com/users/1374704/manuell"}, "edited": false, "score": 0, "creation_date": 1557914217, "post_id": 56143055, "comment_id": 98922597, "body": "@manuell Removing <code>extern</code> produces the same result. Compiler generates reference to _ExampleFunction@12 but linker can&#39;t find that because it doesn&#39;t exist (and isn&#39;t supposed to)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1557914909, "post_id": 56143055, "comment_id": 98923022, "body": "When I do this, I don&#39;t observe the behaviour that you report. Of course, you still have not produced a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which means we can&#39;t know for sure what you are actually doing."}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "is_accepted": false, "score": 1, "last_activity_date": 1557925851, "last_edit_date": 1557925851, "creation_date": 1557923122, "answer_id": 56149330, "question_id": 56143055, "link": "https://stackoverflow.com/questions/56143055/how-can-a-program-call-undecorated-stdcall-dll-exports-when-compiling-with-msvc/56149330#56149330", "title": "How can a program call undecorated stdcall DLL exports when compiling with MSVC?", "body": "<p>Turns out the information in the article link I posted above does actually work. (<a href=\"https://qualapps.blogspot.com/2007/08/how-to-create-32-bit-import-libraries.html\" rel=\"nofollow noreferrer\">https://qualapps.blogspot.com/2007/08/how-to-create-32-bit-import-libraries.html</a>)</p>\n\n<p>I had already created a dummy/stub library as the article mentioned... But I did not add a module definition file to the dummy library in the way I should have. I neglected to do this but also, I don't even see why it would work! I created it outside of Visual Studio and generated the .lib for it outside of Visual Studio. No luck. Doing it all in Visual Studio made it work.</p>\n\n<p>Simply adding a module definition that looks like this...</p>\n\n<pre><code>LIBRARY example-lib.dll\nEXPORTS\nExampleFunction\n</code></pre>\n\n<p>... causes the outputted .lib file to report this instead of what I originally listed in my question:</p>\n\n<pre><code>Version      : 0\nMachine      : 14C (x86)\nTimeDateStamp: FFFFFFFF\nSizeOfData   : 00000019\nDLL name     : example-lib.dll\nSymbol name  : _ExampleFunction@12\nType         : code\nName type    : undecorate\nHint         : 0\nName         : ExampleFunction\n</code></pre>\n\n<p>This is very strange! <strong>As the article mentions, this is essentially undocumented behaviour but it does solve my problem.</strong></p>\n\n<p>If you're having trouble following the article as I was, the solution to having a .lib file with undecorated <code>stdcall</code> imports is this:</p>\n\n<ol>\n<li><p>Create a new Visual C DLL project (not static library), name it the same as the DLL you want to create a .lib for.</p></li>\n<li><p>In the main source code file, which is a C++ file (doesn't matter that this is the case), copy the signatures for required functions as below. For example-lib, this is the entire source file!</p>\n\n<pre><code>include \"stdafx.h\"\nextern \"C\" __declspec(dllexport) void _stdcall ExampleFunction(int a, int b, int c) { }\n</code></pre></li>\n<li><p>This is the key part. In Visual C's Solution Explorer, right-click Source Files > Add > New Item... In the dialog that appears, select Code > Module Definition File (.def). Make it match your DLL name and export names as below. As this step doesn't require making any settings changes to reference the module definition, I really don't know why this works. But it does... It doesn't seem to be officially documented that this will work but the functionality has been present in MSVC since at least 2005-2007 (when the article was written).</p>\n\n<pre><code>LIBRARY example-lib.dll\nEXPORTS\nExampleFunction\n</code></pre></li>\n<li><p>Set to Release mode and build the library. Navigate to the project directory in Windows Explorer and you should now see the .dll file and the .lib file. You can run <code>dumpbin /headers example-lib.lib</code> to verify that <code>ExampleFunction</code> is undecorated as shown above.</p></li>\n<li><p>To use the dummy .lib file to reference a real DLL, add it to your original project by going to Project properties > Linker > Input > Additional Dependencies (and add the dependency directory if necessary). Then declare a reference to it in code like this:</p>\n\n<pre><code>extern void __stdcall ExampleFunction(int a, int b, int c);\n</code></pre></li>\n</ol>\n\n<p>Build your project and it should work. If you view your project EXE/DLL in a utility, you'll see that the <code>.idata</code> section will be referencing your DLL with undecorated function names. This works because the compiler will always generate a symbol reference like  <code>_ExampleFunction@12</code> but when this reaches Microsoft's linker in combination with the specialised .lib file, it sees that the <code>name type</code> for this is <code>undecorate</code> and it should resolve this symbol to the actual name <code>ExampleFunction.</code></p>\n"}], "owner": {"reputation": 113, "user_id": 7348172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0745b8fb8ad483d6750aa4a41813b2f0?s=128&d=identicon&r=PG&f=1", "display_name": "user7348172", "link": "https://stackoverflow.com/users/7348172/user7348172"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1557925851, "creation_date": 1557902176, "last_edit_date": 1557908102, "question_id": 56143055, "link": "https://stackoverflow.com/questions/56143055/how-can-a-program-call-undecorated-stdcall-dll-exports-when-compiling-with-msvc", "title": "How can a program call undecorated stdcall DLL exports when compiling with MSVC?", "body": "<p>I have a DLL written with x86 assembly language. All the exports refer to <code>stdcall</code> functions. All exports are undecorated.</p>\n\n<p>I specifically need this DLL as-is linked to a C project using an import library. <code>LoadLibrary</code> or changing export names etc is not an option.</p>\n\n<p>I have 2 problems</p>\n\n<ol>\n<li>When I create an import library (.lib) file for the DLL from a DEF file with export names, all of the names get decorated to <code>cdecl</code>! I can't find a way to specify them as undecorated <code>stdcall</code>. None of these decorated names exist in the DLL, so by run-time, nothing will work even if compilation was possible.</li>\n<li>When I write code to call a DLL function in MSVC, whether specifying stdcall or not, the compiler modifies the names of the functions. So a call to <code>ExampleFunction</code> becomes <code>_ExampleFunction@12</code>, and I need it to be <code>ExampleFunction</code> only.</li>\n</ol>\n\n<p>Fortunately, what I need MUST be possible because Windows system DLLs (e.g. kernel32.dll, user32.dll etc) follow the exact same conventions. Every exported function is stdcall and is undecorated.</p>\n\n<p>I've already read this: <a href=\"https://qualapps.blogspot.com/2007/08/how-to-create-32-bit-import-libraries.html\" rel=\"nofollow noreferrer\">https://qualapps.blogspot.com/2007/08/how-to-create-32-bit-import-libraries.html</a></p>\n\n<p>I encountered these issues:</p>\n\n<ol>\n<li>using <code>extern \"C\"</code> doesn't apply here as this is a C project. That specifier won't even work and despite this being a C project, names get modified anyway.</li>\n<li>Creating a .lib file from a DEF file with just raw function names doesn't work. The names get modified. </li>\n</ol>\n\n<p>The <code>example-lib.def</code> file looks like this:</p>\n\n<pre><code>LIBRARY example-lib.dll\nEXPORTS\nExampleFunction\n</code></pre>\n\n<p>The <code>.lib</code> file is generated with this command:</p>\n\n<pre><code>lib.exe /def:example-lib.def /OUT:example-lib.lib\n</code></pre>\n\n<p>The entry in the lib file looks like this when using <code>dumpbin.exe /headers example-lib.lib</code></p>\n\n<pre><code>Version      : 0\nMachine      : 14C (x86)\nTimeDateStamp: 5CDBA30C Wed May 15 06:26:36 2019\nSizeOfData   : 00000016\nDLL name     : example-lib.dll\nSymbol name  : _ExampleFunction\nType         : code\nName type    : no prefix\nHint         : 20\nName         : ExampleFunction\n</code></pre>\n\n<p>I'm importing by making declarations this:</p>\n\n<pre><code>extern void __stdcall ExampleFunction(int a, int b, int c);\n</code></pre>\n\n<p>I call the function like this:</p>\n\n<pre><code>ExampleFunction(1, 2, 3);\n</code></pre>\n\n<p>The lib file and directory in which it resides is specified in VC project settings.</p>\n\n<p>When the code calling <code>ExampleFunction</code> compiles, the linker won't complete because it can't find <code>_ExampleFunction@12</code> in my DEF file. And even if that was present in the DEF file, the program won't run because <code>_ExampleFunction@12</code> isn't exported in the actual DLL's export section. Only plain <code>ExampleFunction</code> is exported.</p>\n\n<p>So how do I achieve having the C program call ExampleFunction from the DLL exactly as is? How is this done when a C project calls a function from user32.dll? Can I use the same procedure for achieving this?</p>\n"}, {"tags": ["c", "gcc", "assembly", "sse", "built-in"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1557906285, "post_id": 56142838, "comment_id": 98918133, "body": "How did you test it to find out it was broken?  Looks like they compile identically with gcc <a href=\"https://godbolt.org/z/DOcbHs\" rel=\"nofollow noreferrer\">godbolt.org/z/DOcbHs</a> unless I&#39;m missing something.  But clang doesn&#39;t support <code>__builtin_ia32_unpckhps</code>.  Are you on OS X where the <code>gcc</code> command is actually <code>clang</code>?"}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 0, "creation_date": 1557932157, "post_id": 56142838, "comment_id": 98933980, "body": "Did you look at the disassembly of both variants (good one and bad one) and check the difference?"}, {"owner": {"reputation": 35113, "user_id": 3826372, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0peM.png?s=128&g=1", "display_name": "Ross Ridge", "link": "https://stackoverflow.com/users/3826372/ross-ridge"}, "edited": false, "score": 0, "creation_date": 1557944685, "post_id": 56142838, "comment_id": 98940190, "body": "If you&#39;re going to rewrite it, I&#39;d suggest start by using an inline function rather than macro.  I don&#39;t know why Intel(?) used a macro for this, but there hasn&#39;t been a reason to use macros to do this with GCC in 30 years."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 1, "creation_date": 1557986869, "post_id": 56142838, "comment_id": 98951273, "body": "I just tested both variants of your code using different random data. I also tested different compiler settings (unoptimized and <code>-O</code>). gcc compiler was version 7.4.0, 64-bit, Ubuntu Linux: Both variants had the same results. So if both variants have different results on your computer, this might be a compiler issue."}, {"owner": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1557986926, "post_id": 56142838, "comment_id": 98951295, "body": "@PeterCordes Shouldn&#39;t the user get some linker error if his compiler doesn&#39;t support <code>__builtin_ia32_unpckhps</code>?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 14659, "user_id": 2705055, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b1d5dfaf239229501a184c8858fbc954?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Rosenau", "link": "https://stackoverflow.com/users/2705055/martin-rosenau"}, "edited": false, "score": 0, "creation_date": 1557988463, "post_id": 56142838, "comment_id": 98951958, "body": "@MartinRosenau: Yes, I would expect that.  Maybe Apple clang is different from mainline clang on Godbolt.  Or maybe &quot;broke the function&quot; is just a really terrible description of the problem, and does mean linker error!  Clearly we need a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> + compiler version and options."}, {"owner": {"reputation": 61, "user_id": 6875866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6f992dedfbcf4357dccbed08c52a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Chany", "link": "https://stackoverflow.com/users/6875866/dick-chany"}, "edited": false, "score": 0, "creation_date": 1558290934, "post_id": 56142838, "comment_id": 99042914, "body": "Sorry for the slow response.  I&#39;m using gcc with -std=c99 and I&#39;m on Ubuntu, not OS X.  When I use that site you provided and compile as C code, not C++, it does give somewhat different compilation for the two.  I have worked out exactly where in here the problem is yet: <a href=\"https://godbolt.org/z/0myXso\" rel=\"nofollow noreferrer\">godbolt.org/z/0myXso</a> I think it may have to do with the unpcklps command using the second argument as the destination but I am not sure."}], "owner": {"reputation": 61, "user_id": 6875866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b6f992dedfbcf4357dccbed08c52a2?s=128&d=identicon&r=PG&f=1", "display_name": "Dick Chany", "link": "https://stackoverflow.com/users/6875866/dick-chany"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1557906503, "creation_date": 1557901214, "last_edit_date": 1557906256, "question_id": 56142838, "link": "https://stackoverflow.com/questions/56142838/how-do-builtin-ia32-unpcklps-hps-and-builtin-ia32-movlhps-hlps-work", "title": "How do __builtin_ia32_unpcklps/hps and __builtin_ia32_movlhps/hlps work?", "body": "<p>I am looking optimized ways to do matrix transpose on CPU only with a known cache set number and block size.  I found that the Intel intrinsic functions contained a low-level transpose of a 4x4 matrix. As follows:</p>\n\n<pre><code>#define _MM_TRANSPOSE4_PS(row0, row1, row2, row3)           \\\ndo {                                    \\\n  __v4sf __r0 = (row0), __r1 = (row1), __r2 = (row2), __r3 = (row3);    \\\n  __v4sf __t0 = __builtin_ia32_unpcklps (__r0, __r1);           \\\n  __v4sf __t1 = __builtin_ia32_unpcklps (__r2, __r3);           \\\n  __v4sf __t2 = __builtin_ia32_unpckhps (__r0, __r1);           \\\n  __v4sf __t3 = __builtin_ia32_unpckhps (__r2, __r3);           \\\n  (row0) = __builtin_ia32_movlhps (__t0, __t1);             \\\n  (row1) = __builtin_ia32_movhlps (__t1, __t0);             \\\n  (row2) = __builtin_ia32_movlhps (__t2, __t3);             \\\n  (row3) = __builtin_ia32_movhlps (__t3, __t2);             \\\n} while (0)\n\n</code></pre>\n\n<p>The functions its using are built-in GCC compiler functions which use the UNPCKHPS/LPS and MOVLHPS/HLPS x86 assembly commands.  That I understand and I roughly understand how those commands would work together to transpose the 4 rows.</p>\n\n<p>However, I wanted to test these functions and so I copy this into my code and edited it slightly.</p>\n\n<p>I found that simiply subsituting the function into the arguments with out using a temporary varible broke the function.  Here is an example of that:</p>\n\n<pre><code>#define _MM_TRANSPOSE4_PS(row0, row1, row2, row3)           \\\ndo {                                    \\\n  __v4sf __r0 = (row0), __r1 = (row1), __r2 = (row2), __r3 = (row3);    \\\n  __v4sf __t1 = __builtin_ia32_unpcklps (__r2, __r3);           \\\n  __v4sf __t2 = __builtin_ia32_unpckhps (__r0, __r1);           \\\n  __v4sf __t3 = __builtin_ia32_unpckhps (__r2, __r3);           \\\n  (row0) = __builtin_ia32_movlhps (__builtin_ia32_unpcklps (__r0, __r1), __t1);             \\\n  (row1) = __builtin_ia32_movhlps (__t1, __builtin_ia32_unpcklps (__r0, __r1));             \\\n  (row2) = __builtin_ia32_movlhps (__t2, __t3);             \\\n  (row3) = __builtin_ia32_movhlps (__t3, __t2);             \\\n} while (0)\n\n</code></pre>\n\n<p>Does anyone know why this would happen?  Normally, if you change the order of function calls (assuming that they aren't operating on the same pointer) cannot effect execution.</p>\n"}, {"tags": ["c", "code-analysis", "ctags"], "answers": [{"tags": [], "owner": {"reputation": 852, "user_id": 6386727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18c3dc2b0939eb1c624ea2e6f8c03c7?s=128&d=identicon&r=PG", "display_name": "Masatake YAMATO", "link": "https://stackoverflow.com/users/6386727/masatake-yamato"}, "is_accepted": false, "score": 0, "last_activity_date": 1557939212, "creation_date": 1557939212, "answer_id": 56154220, "question_id": 56142757, "link": "https://stackoverflow.com/questions/56142757/list-global-array-variables-in-a-c-program/56154220#56154220", "title": "List global array variables in a C program", "body": "<p>If you use universal-ctags (<a href=\"https://ctags.io\" rel=\"nofollow noreferrer\">https://ctags.io</a>), readtags distributed as part of u-ctags may help you. The readtags command supports S-expression based filtering.</p>\n\n<pre><code>[yamato@slave]~/var/ctags-github% cat /tmp/a.c \ncat /tmp/a.c \nint f[10];\nint g;\nstruct point {\n  int x, y;\n} points [64][32];\n[yamato@slave]~/var/ctags-github% ./ctags --kinds-C=v --fields=+t /tmp/a.c \n./ctags --kinds-C=v --fields=+t /tmp/a.c \n[yamato@slave]~/var/ctags-github% cat tags \ncat tags \n!_TAG_FILE_FORMAT   2   /extended format; --format=1 will not append ;\" to lines/\n!_TAG_FILE_SORTED   1   /0=unsorted, 1=sorted, 2=foldcase/\n!_TAG_OUTPUT_MODE   u-ctags /u-ctags or e-ctags/\n!_TAG_PROGRAM_AUTHOR    Universal Ctags Team    //\n!_TAG_PROGRAM_NAME  Universal Ctags /Derived from Exuberant Ctags/\n!_TAG_PROGRAM_URL   https://ctags.io/   /official site/\n!_TAG_PROGRAM_VERSION   0.0.0   /26a9333b/\nf   /tmp/a.c    /^int f[10];$/;\"    v   typeref:typename:int[10]\ng   /tmp/a.c    /^int g;$/;\"    v   typeref:typename:int\npoints  /tmp/a.c    /^} points [64][32];$/;\"    v   typeref:struct:point[64][32]\n[yamato@slave]~/var/ctags-github% ./readtags -t tags -e -Q '(substr? ($ \"typeref\") \"[\")' -l\n./readtags -t tags -e -Q '(substr? ($ \"typeref\") \"[\")' -l\nf   /tmp/a.c    /^int f[10];$/;\"    kind:v  typeref:typename:int[10]\npoints  /tmp/a.c    /^} points [64][32];$/;\"    kind:v  typeref:struct:point[64][32]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11502223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebdc5012a4f998f51c8fe5341741106f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/11502223/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557939212, "creation_date": 1557900858, "last_edit_date": 1557912532, "question_id": 56142757, "link": "https://stackoverflow.com/questions/56142757/list-global-array-variables-in-a-c-program", "title": "List global array variables in a C program", "body": "<p>There is a similar question asked before about listing global variables in C and the answers to that were using nm and ctags. ctags cli was -\nctags -R -x --sort=yes --c-kinds=v --file-scope=no </p>\n\n<p>Is there a ctags option to list only global arrays. In a huge codebase we are trying to reduce memory footprint and need to analyze all global arrays. Thanks.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "edited": false, "score": 0, "creation_date": 1557900046, "post_id": 56142544, "comment_id": 98915181, "body": "Have you tried printing the char you think you just read instead of waiting to the end and printing them all. Also: what is giving a warning about dereferencing a NULL ? You should include the full &quot;warning&quot;."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1557900283, "post_id": 56142544, "comment_id": 98915269, "body": "You also neglected to include <code>&lt;stdio.h&gt;</code>, which is required for <code>printf</code> and <code>scanf</code> proper."}, {"owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "edited": false, "score": 0, "creation_date": 1557903035, "post_id": 56142544, "comment_id": 98916500, "body": "added the error code. oh and I did include &lt;stdio.h&gt;, looks like the copy-pasting messed up."}], "answers": [{"tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 2, "last_activity_date": 1557900280, "creation_date": 1557900280, "answer_id": 56142642, "question_id": 56142544, "link": "https://stackoverflow.com/questions/56142544/why-is-this-dynamic-char-array-not-getting-correct-inputs-in-c/56142642#56142642", "title": "Why is this dynamic char array not getting correct inputs in C?", "body": "<p>The primary difference between the <code>int</code> version that works and the <code>char</code> version that doesn't is that you use <code>%d</code> and <code>%c</code> \u2014 and <code>%d</code> skips white space but <code>%c</code> does not.</p>\n\n<p>Change the <code>\"%c\"</code> to <code>\" %c\"</code> and you're in with a fighting chance.</p>\n\n<p>Three <code>scanf()</code> \u2014 or <code>scanf_s()</code> if you're working on Windows \u2014 conversions do not skip white space.  They are <code>%c</code>, <code>%[\u2026]</code> (scan sets), and <code>%n</code>.</p>\n"}], "owner": {"reputation": 4113, "user_id": 10305477, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--qRrIlzhZP8/AAAAAAAAAAI/AAAAAAAAAbg/OMHxlGTcZp4/photo.jpg?sz=128", "display_name": "Chase", "link": "https://stackoverflow.com/users/10305477/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56142642, "answer_count": 1, "score": -2, "last_activity_date": 1557902980, "creation_date": 1557899753, "last_edit_date": 1557902980, "question_id": 56142544, "link": "https://stackoverflow.com/questions/56142544/why-is-this-dynamic-char-array-not-getting-correct-inputs-in-c", "title": "Why is this dynamic char array not getting correct inputs in C?", "body": "<p>I'm experimenting with this very basic code and running into some memory problems.</p>\n\n<p>I noticed that the char array is not reading the inputs correctly, probably eating up a new line input. The program worked fine for an int array but I still get a warning about de-referencing NULL pointer.   </p>\n\n<p>Here's the char array,</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include&lt;stdlib.h&gt;\n\nint main()\n{\n    int N, i;\n    char* set;\n    scanf_s(\"%d\", &amp;N);\n    set = (char*)calloc(N, sizeof(char));\n    for (i = 0; i &lt; N; i++)\n    {\n        scanf_s(\"%c\", (set+i), 1);\n    }\n    for (i = 0; i &lt; N; i++)\n    {\n        printf(\"%c\", *(set + i));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Here's the int array,</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include&lt;stdlib.h&gt;\n\nint main()\n{\n    int N, i;\n    int* set;\n    scanf_s(\"%d\", &amp;N);\n    set = (int*)calloc(N, sizeof(int));\n    for (i = 0; i &lt; N; i++)\n    {\n        scanf_s(\"%d\", (set+i));\n    }\n    for (i = 0; i &lt; N; i++)\n    {\n        printf(\"%d\", *(set + i));\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As mentioned earlier, the int array works perfectly fine but I still want to fix the warning.</p>\n\n<p>Anyways the output for char array is just 'a' and new lines when I enter \"a b c\" as input and hit enter, Alternatively I tried entering just 'a' and hitting enter and it doesn't even let me input the other characters anymore.</p>\n\n<p>I want to understand what exactly is wrong and want to fix it. The current IDE I'm using is VS but I'd like a gcc 6.3 compatible version as well.</p>\n\n<p>Edit: The error I'm getting is on the printf line and it reads- </p>\n\n<p><code>Warning  C6011   Dereferencing NULL pointer 'set+i'.</code></p>\n"}, {"tags": ["python", "c", "cryptography", "public-key-encryption", "ecdsa"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8741475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ilo_bgsWwD8/AAAAAAAAAAI/AAAAAAAACpw/2IxNmhbMEPY/photo.jpg?sz=128", "display_name": "Prajwal B V", "link": "https://stackoverflow.com/users/8741475/prajwal-b-v"}, "edited": false, "score": 0, "creation_date": 1557981474, "post_id": 56158291, "comment_id": 98949672, "body": "Thanks for the clarification. How to disable the SHA-1 digest for the message &#39;Hello&#39; in python ECDSA? I am planning to use a separate hashing function for hashing purpose."}, {"owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "reply_to_user": {"reputation": 33, "user_id": 8741475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ilo_bgsWwD8/AAAAAAAAAAI/AAAAAAAACpw/2IxNmhbMEPY/photo.jpg?sz=128", "display_name": "Prajwal B V", "link": "https://stackoverflow.com/users/8741475/prajwal-b-v"}, "edited": false, "score": 0, "creation_date": 1557992523, "post_id": 56158291, "comment_id": 98953963, "body": "You can use the &#39;hashfunc&#39; parameter (see signinKey.sign(msg) in your code). E.g. for SHA-256 you could use <code>hashlib.sha256</code>. I guess you want to use a predefined, proven hash function? Because cryptographically good hash functions are absolutely not trivial (e.g. danger of collision attacks), so I would strongly advise against writing your own hash function."}, {"owner": {"reputation": 33, "user_id": 8741475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ilo_bgsWwD8/AAAAAAAAAAI/AAAAAAAACpw/2IxNmhbMEPY/photo.jpg?sz=128", "display_name": "Prajwal B V", "link": "https://stackoverflow.com/users/8741475/prajwal-b-v"}, "edited": false, "score": 0, "creation_date": 1558431928, "post_id": 56158291, "comment_id": 99089881, "body": "Thanks, I tried the api as signinKey.sign(msg, hashfunc = hashlib.sha256) and it worked. I did not intend to use my own hashing function. Besides I also saw that there is a  signinKey.sign_digest() API to sign without hashing."}], "tags": [], "owner": {"reputation": 18527, "user_id": 2331445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94bfb49e156193c0509c3a18e0f8923f?s=128&d=identicon&r=PG", "display_name": "Stephan Schlecht", "link": "https://stackoverflow.com/users/2331445/stephan-schlecht"}, "is_accepted": true, "score": 4, "last_activity_date": 1557958127, "creation_date": 1557958127, "answer_id": 56158291, "question_id": 56142232, "link": "https://stackoverflow.com/questions/56142232/ecdsa-signing-and-verifying-issue-between-python-ecdsa-and-c-micro-ecc-library/56158291#56158291", "title": "ECDSA Signing and Verifying issue between python ECDSA and C micro-ecc library", "body": "<p>The ECDSA signing procedure is a two-stage process:</p>\n\n<ul>\n<li>a hash digest is calculated from the message</li>\n<li>this digest is then signed.</li>\n</ul>\n\n<p>Python ECDSA uses SHA-1 by default unless otherwise stated. </p>\n\n<p>The SHA-1 digest for the message 'Hello' is hex encoded: <code>f7ff9e8b7bb2e09b70935a5d785e0cc5d9d0abf0</code>.</p>\n\n<p>This means you need to use this digest when calling the uECC_verify function. </p>\n\n<p><strong>Validation</strong></p>\n\n<p>Replace in your .c code the msg array with the following line of code:</p>\n\n<pre><code>uint8_t msg[] = { 0xf7, 0xff, 0x9e, 0x8b, 0x7b, 0xb2, 0xe0, 0x9b, 0x70, 0x93, 0x5a, 0x5d, 0x78, 0x5e, 0x0c, 0xc5, 0xd9, 0xd0, 0xab, 0xf0};\n</code></pre>\n\n<p>Then the verfiy function succeeds.  </p>\n\n<p><strong>Output</strong></p>\n\n<p>The output in the debug console looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D9Qei.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D9Qei.png\" alt=\"uECC_verify output\"></a>   </p>\n"}], "owner": {"reputation": 33, "user_id": 8741475, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ilo_bgsWwD8/AAAAAAAAAAI/AAAAAAAACpw/2IxNmhbMEPY/photo.jpg?sz=128", "display_name": "Prajwal B V", "link": "https://stackoverflow.com/users/8741475/prajwal-b-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1331, "favorite_count": 0, "accepted_answer_id": 56158291, "answer_count": 1, "score": 3, "last_activity_date": 1557958127, "creation_date": 1557897753, "last_edit_date": 1557898912, "question_id": 56142232, "link": "https://stackoverflow.com/questions/56142232/ecdsa-signing-and-verifying-issue-between-python-ecdsa-and-c-micro-ecc-library", "title": "ECDSA Signing and Verifying issue between python ECDSA and C micro-ecc library", "body": "<p>I am facing an issue when I do the following :</p>\n\n<ol>\n<li>Created a Public Private key pair using python for ECDSA SECP256k1 curve and printed it on the terminal.  </li>\n<li>Copy pasted the key pair in Python script and in visual studio (C coding that uses micro-ecc library). So that new key is not generated everytime I run the code.  </li>\n<li>Sign a message (\"Hello\") in Python using the private key and print both the signature and message on the terminal. I know that the message has to be hashed first using a standard hashing algorithm such as SHA256, but in this case I am using the message directly for signing.    </li>\n<li>Copy the signature and the same message (hash) into Visual studio.</li>\n<li>When I call the verify API in visual studio the verification fails all though it makes use of the same public key, message, signature and the curve.</li>\n</ol>\n\n<p>Libraries I am using:</p>\n\n<ol>\n<li>micro-ecc for C in visual studio <a href=\"https://github.com/kmackay/micro-ecc\" rel=\"nofollow noreferrer\">https://github.com/kmackay/micro-ecc</a>  </li>\n<li>ECDSA for python <a href=\"https://github.com/warner/python-ecdsa\" rel=\"nofollow noreferrer\">https://github.com/warner/python-ecdsa</a></li>\n</ol>\n\n<p>Other things I have tested and ensured:</p>\n\n<ol>\n<li>Signing and verifying both in python works fine for a same key pair say (sk,vk).  </li>\n<li>Signing and verifying both in visual studio works fine for a same key pair say (sk,vk).</li>\n<li>Signing using microECC in Visual Studio and verifying using ECDSA in python fails, also signing using ECDSA and verifying using microECC in fails.</li>\n<li>I am sure about the key Copy pasted from terminal is actually the intended key, because I have cross verified the verifying key from the copied signing Key and it is matching.</li>\n</ol>\n\n<p>First I generate the keys by running this script</p>\n\n<p>GenerateKeys.py</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import ecdsa\nfrom ecdsa import SigningKey, SECP256k1\n\n\nsk  = ecdsa.SigningKey.generate(curve=ecdsa.SECP256k1) \nvk  = sk.get_verifying_key()\n\nsklst = []\nfor e in bytearray(sk.to_string()):\n    sklst.append(e)\n\nvklst = []\nfor e in bytearray(vk.to_string()):\n    vklst.append(e)\n\nprint(\"Private Key is:\")\nprint(sklst)\n\nprint(\"Public Key is:\")\nprint(vklst)\n</code></pre>\n\n<p>Output of GenerateKeys.py</p>\n\n<pre><code>Private Key is:\n[38, 108, 90, 112, 230, 138, 62, 97, 107, 90, 227, 165, 207, 80, 251, 154, 17, 4, 73, 53, 33, 162, 33, 200, 243, 205, 116, 43, 36, 59, 201, 84]\nPublic Key is:\n[163, 238, 83, 33, 229, 249, 105, 12, 141, 7, 214, 134, 148, 1, 198, 45, 13, 31, 9, 223, 85, 201, 98, 248, 73, 160, 40, 255, 64, 214, 250, 121, 234, 103, 212, 148, 197, 48, 210, 38, 166, 51, 30, 81, 119, 240, 125, 104, 237, 24, 3, 216, 229, 87, 45, 7, 115, 69, 94, 187, 236, 91, 142, 18]\n</code></pre>\n\n<p>Copy paste the Private key into the Sign.py python script and generate signature and a public key\nI have used \"Hello\" as the msg for creating signature</p>\n\n<p>Sign.py</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>import ecdsa\nfrom ecdsa import SigningKey, SECP256k1\n\n\nsigninKey_lst = [38, 108, 90, 112, 230, 138, 62, 97, 107, 90, 227, 165, 207, 80, 251, 154, 17, 4, 73, 53, 33, 162, 33, 200, 243, 205, 116, 43, 36, 59, 201, 84]\nsigninKey_lst = bytearray(signinKey_lst)\nsigninKey = ecdsa.SigningKey.from_string(signinKey_lst, curve=ecdsa.SECP256k1)\nverifyKey = signinKey.get_verifying_key()\n\nsigninKey_lst = []\nfor e in bytearray(signinKey.to_string()):\n    signinKey_lst.append(e)\n\nverifyKey_lst = []\nfor e in bytearray(verifyKey.to_string()):\n    verifyKey_lst.append(e)\n\nprint(\"Public Key is:\")\nprint(verifyKey_lst)\n\nmsg = \"Hello\"\n\nsign = signinKey.sign(msg)\nsign_lst = []\n\nverifyKey_lst = []\nfor e in bytearray(sign):\n    sign_lst.append(e)\n\nprint(\"Signature is:\")\nprint(sign_lst)\n</code></pre>\n\n<p>Output of Sign.py:</p>\n\n<pre><code>Private Key is:\n[38, 108, 90, 112, 230, 138, 62, 97, 107, 90, 227, 165, 207, 80, 251, 154, 17, 4, 73, 53, 33, 162, 33, 200, 243, 205, 116, 43, 36, 59, 201, 84]\nPublic Key is:\n[163, 238, 83, 33, 229, 249, 105, 12, 141, 7, 214, 134, 148, 1, 198, 45, 13, 31, 9, 223, 85, 201, 98, 248, 73, 160, 40, 255, 64, 214, 250, 121, 234, 103, 212, 148, 197, 48, 210, 38, 166, 51, 30, 81, 119, 240, 125, 104, 237, 24, 3, 216, 229, 87, 45, 7, 115, 69, 94, 187, 236, 91, 142, 18]\nSignature is:\n[47, 107, 101, 228, 187, 209, 97, 180, 83, 149, 133, 71, 62, 15, 86, 186, 192, 222, 108, 221, 249, 128, 124, 7, 139, 110, 103, 108, 62, 89, 136, 152, 226, 43, 104, 166, 92, 247, 9, 201, 135, 96, 19, 75, 55, 229, 67, 198, 188, 90, 246, 17, 157, 1, 229, 71, 151, 206, 211, 95, 41, 51, 96, 42]\n</code></pre>\n\n<p>Copy paste the Signature and use the same message in visual studio with micro ecc library:-</p>\n\n<p>source.c</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"stdio.h\"\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"uECC.h\"\n#include \"constants.h\"\n\nuint8_t privateKey[32] = { 0 };\nuint8_t publicKey[64] = { 163, 238, 83, 33, 229, 249, 105, 12, 141, 7, 214, 134, 148, 1, 198, 45, 13, 31, 9, 223, 85, 201, 98, 248, 73, 160, 40, 255, 64, 214, 250, 121, 234, 103, 212, 148, 197, 48, 210, 38, 166, 51, 30, 81, 119, 240, 125, 104, 237, 24, 3, 216, 229, 87, 45, 7, 115, 69, 94, 187, 236, 91, 142, 18 };\nuint8_t msg[5] = { 'H','e','l','l','o' };\nuint8_t sign[64] = { 47, 107, 101, 228, 187, 209, 97, 180, 83, 149, 133, 71, 62, 15, 86, 186, 192, 222, 108, 221, 249, 128, 124, 7, 139, 110, 103, 108, 62, 89, 136, 152, 226, 43, 104, 166, 92, 247, 9, 201, 135, 96, 19, 75, 55, 229, 67, 198, 188, 90, 246, 17, 157, 1, 229, 71, 151, 206, 211, 95, 41, 51, 96, 42 };\n\nvoid printArray(uint8_t* pToArr, uint32_t u16ArrSize)\n{\n    uint32_t c = 0;\n    printf(\"[ \");\n    for (c = 0; c &lt; u16ArrSize; c++)\n    {\n        if (c != (u16ArrSize - 1))\n        {\n            printf(\" %u,\", *pToArr);\n        }\n        else\n        {\n            printf(\" %u\", *pToArr);\n        }\n        pToArr++;\n    }\n    printf(\" ]\");\n    return;\n}\n\nint main()\n{\n    const struct uECC_Curve_t* curve;\n    #if uECC_SUPPORTS_secp256k1\n    curve = uECC_secp256k1();\n    #endif\n\n    const char* m = \"Hello World\"; //{0xff, 0xff, 0xff, 0xff, 0xff,0xff }\n\n    printf(\"\\n/*************************************************************************************************\\n\");\n    printf(\"Validating the Encrypted hash with the public key and the hash used\\n\");\n\n    printf(\"\\n\\nPublic Key:\\n\");\n    printArray(publicKey, sizeof(publicKey));\n\n    printf(\"\\n\\nMsg:\\n\");\n    printArray(msg, sizeof(msg));\n\n    printf(\"\\n\\nsignature:\\n\");\n    printArray(sign, sizeof(sign));\n\n    printf(\"\\n\");\n    if (!uECC_verify(publicKey, msg, sizeof(msg), sign, curve))\n    {\n        printf(\"\\nuECC_verify() failed\\n\");\n    }\n    else\n    {\n        printf(\"\\nuECC_verify() succeeded\\n\");\n\n    }\n    printf(\"\\n/*************************************************************************************************/\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Output of the visual studio by running source.c:-</p>\n\n<pre><code>/*************************************************************************************************\nValidating the Encrypted hash with the public key and the hash used\n\n\nPublic Key:\n[  148, 49, 144, 80, 185, 77, 185, 14, 186, 168, 164, 110, 123, 192, 55, 219, 184, 133, 153, 65, 144, 169, 175, 171, 203, 225, 88, 134, 51, 199, 254, 215, 237, 144, 141, 137, 80, 190, 25, 35, 33, 136, 248, 190, 114, 60, 128, 34, 155, 157, 83, 68, 187, 154, 137, 9, 51, 112, 155, 54, 88, 104, 82, 138 ]\n\nMsg:\n[  72, 101, 108, 108, 111 ]\n\nsignature:\n[  186, 247, 43, 62, 152, 84, 40, 197, 74, 135, 80, 18, 152, 150, 121, 177, 155, 242, 1, 11, 171, 155, 45, 19, 174, 171, 190, 66, 31, 125, 214, 136, 41, 116, 139, 82, 71, 208, 4, 80, 47, 154, 100, 173, 110, 164, 25, 19, 7, 253, 175, 123, 34, 1, 99, 86, 241, 241, 211, 45, 15, 35, 210, 69 ]\n\nuECC_verify() failed\n\n/*************************************************************************************************/\n\nC:\\Users\\prajwal.bv\\source\\repos\\Crypt_sample1\\x64\\Debug\\Crypt_sample1.exe (process 17160) exited with code 0.\nTo automatically close the console when debugging stops, enable Tools-&gt;Options-&gt;Debugging-&gt;Automatically close the console when debugging stops.\nPress any key to close this window . . .\n\n</code></pre>\n\n<p>I expected the output of running source.c to be uECC_verify() succeeded. But it prints uECC_verify() failed.</p>\n"}, {"tags": ["c", "hash"], "comments": [{"owner": {"reputation": 17580, "user_id": 493106, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/48b0c7ab491edf2f69e63773181a22b5?s=128&d=identicon&r=PG", "display_name": "xaxxon", "link": "https://stackoverflow.com/users/493106/xaxxon"}, "edited": false, "score": 1, "creation_date": 1557896832, "post_id": 56142066, "comment_id": 98914091, "body": "please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 4, "creation_date": 1557896864, "post_id": 56142066, "comment_id": 98914104, "body": "The <code>WIDTH</code> is defined only when one of <code>UQUARK</code> or <code>DQUARK</code> is defined. Such control macros are usually set on the command line or in the make file: <code>gcc -DUQUARK ...</code> or <code>cl &#47;DUQUARK ...</code>."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 1, "creation_date": 1557900201, "post_id": 56142066, "comment_id": 98915241, "body": "To elaborate M.Oehm comment. We will need to see the code file which includes the shown header and the exact way you compile in order to help you with details. Please make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> which includes the building details. Do you use the make tool? Then show the makefile. Do you use an IDE then list all building parameters."}], "answers": [{"tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1557935465, "last_edit_date": 1557935465, "creation_date": 1557913078, "answer_id": 56146136, "question_id": 56142066, "link": "https://stackoverflow.com/questions/56142066/undeclared-here-not-in-a-function-in-c/56146136#56146136", "title": "undeclared here (not in a function) in C", "body": "<p>I guess for some reason neither UQUARK nor DQUARK are defined.</p>\n\n<p>Add this:</p>\n\n<pre><code>#if defined(UQUARK) &amp;&amp; defined(DQUARK)\n#error both UQUARK and DQUARK are defined\n#endif\n\n#if !defined(UQUARK) &amp;&amp; !defined(dQUARK)\n#error Neither UQUARK nor DQUARK are defined\n#endif\n</code></pre>\n\n<p>just before following line:</p>\n\n<pre><code>#if   defined(UQUARK)\n</code></pre>\n\n<p>Then the compilation will abort if either both <code>UQUARK</code> and <code>DQUARK</code> are defined (which probably makes no sense) or if neither <code>UQUARK</code> nor <code>DQUARK</code> are defined (which probably happens in your case).</p>\n\n<p>Now the question is: who defines <code>UQUARK</code> and/or <code>DQUARK</code>? Only you can tell.</p>\n"}], "owner": {"reputation": 29, "user_id": 9460902, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mTB6agn7Qjk/AAAAAAAAAAI/AAAAAAAAAA0/FXgRL-Z2nF8/photo.jpg?sz=128", "display_name": "Gibran Akbaromi", "link": "https://stackoverflow.com/users/9460902/gibran-akbaromi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2731, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1557935465, "creation_date": 1557896680, "last_edit_date": 1557896779, "question_id": 56142066, "link": "https://stackoverflow.com/questions/56142066/undeclared-here-not-in-a-function-in-c", "title": "undeclared here (not in a function) in C", "body": "<p>im new with c language, but i try to unerstand this quark hashing algorithm that was written in c language, and i found an error while im compiling the source code, from what i understand the WIDTH it already declared, but why is it still error ? </p>\n\n<p>this is the source code</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* uncomment to printf execution traces */\n// #define DEBUG\n\n#if   defined(UQUARK)\n#define CAPACITY 16 \n#define RATE      1\n#define WIDTH    17\n#elif defined(DQUARK)\n#define CAPACITY 20\n#define RATE      2\n#define WIDTH    22\n#endif\n\n\n#define DIGEST WIDTH\n\ntypedef uint64_t u64;\ntypedef uint32_t u32;\ntypedef uint8_t   u8; \n\ntypedef struct {\n  int pos; /* number of bytes read into x from current block */\n  //  u32 x[ WIDTH*8 ]; /* one bit stored in each word */\n  u32 x[ WIDTH*8 ]; /* one bit stored in each word */\n} hashState;\n\n\n#if   defined(UQUARK)\n/* 17 bytes */\nu8 iv[] = {0xd8,0xda,0xca,0x44,0x41,0x4a,0x09,0x97,\n       0x19,0xc8,0x0a,0xa3,0xaf,0x06,0x56,0x44,0xdb};\n\n</code></pre>\n\n<p>and its showing this error</p>\n\n<pre><code>quark.c:36:10: error : 'WIDTH' undeclared here (not in a function)\n   u32 x[WIDTH*8];\n\n</code></pre>\n"}, {"tags": ["c", "recursion"], "comments": [{"owner": {"reputation": 24693, "user_id": 10190237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f95f50f67af8a9658c5d76df263b323?s=128&d=identicon&r=PG&f=1", "display_name": "P.W", "link": "https://stackoverflow.com/users/10190237/p-w"}, "edited": false, "score": 1, "creation_date": 1557895554, "post_id": 56141870, "comment_id": 98913743, "body": "<code>else</code> does get executed when <code>i</code> is no longer less than 5. That&#39;s how the program ends."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1557895600, "post_id": 56141870, "comment_id": 98913758, "body": "Because <code>main</code> is calling itself.  Each call enters it from the top.  Once <code>i</code> is 5, the innermost call to <code>main</code> will execute its <code>else</code>.  You might want to brush up on the concept of recursion."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 1, "creation_date": 1557897192, "post_id": 56141870, "comment_id": 98914197, "body": "Calling <code>main</code> invokes undefined behavior."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1557897450, "post_id": 56141870, "comment_id": 98914272, "body": "Not returning a value from <code>main</code> (when <code>i&lt;5</code>) is also undefined behavior."}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 1, "creation_date": 1557897520, "post_id": 56141870, "comment_id": 98914304, "body": "@Brendan since C99 it&#39;s allowed to omit the return statement in main."}], "answers": [{"tags": [], "owner": {"reputation": 1422, "user_id": 4538770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adfd2f0b91001372439c7e23c60e4c52?s=128&d=identicon&r=PG", "display_name": "Jo&#235;l Hecht", "link": "https://stackoverflow.com/users/4538770/jo%c3%abl-hecht"}, "is_accepted": false, "score": 0, "last_activity_date": 1557897584, "creation_date": 1557897584, "answer_id": 56142204, "question_id": 56141870, "link": "https://stackoverflow.com/questions/56141870/why-else-is-not-getting-executed/56142204#56142204", "title": "Why &quot;else&quot; is not getting executed?", "body": "<p>Because the <code>else</code> goes with the <code>if</code> : once the <code>if</code> is done with i&lt;5, the <code>else</code> will never be called anymore, even if <code>i</code> reaches 5 on the i++ instruction.  </p>\n"}, {"comments": [{"owner": {"reputation": 97, "user_id": 10989902, "user_type": "registered", "profile_image": "https://graph.facebook.com/751829281850293/picture?type=large", "display_name": "Manpreet Sidhu", "link": "https://stackoverflow.com/users/10989902/manpreet-sidhu"}, "edited": false, "score": 0, "creation_date": 1558103116, "post_id": 56142295, "comment_id": 99001892, "body": "after value of i&gt;=5 then how printf executed in if block"}, {"owner": {"reputation": 179, "user_id": 10373450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04928f06e5a7fea240ed0a823bf53ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Dinesh", "link": "https://stackoverflow.com/users/10373450/siddharth-dinesh"}, "reply_to_user": {"reputation": 97, "user_id": 10989902, "user_type": "registered", "profile_image": "https://graph.facebook.com/751829281850293/picture?type=large", "display_name": "Manpreet Sidhu", "link": "https://stackoverflow.com/users/10989902/manpreet-sidhu"}, "edited": false, "score": 0, "creation_date": 1558351362, "post_id": 56142295, "comment_id": 99060288, "body": "You will get a &quot;5&quot; printed, since you are incrementing the i value before printing, If you move the &quot;i++&quot; after the printf and before you call main(). You will get the expected output."}, {"owner": {"reputation": 179, "user_id": 10373450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04928f06e5a7fea240ed0a823bf53ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Dinesh", "link": "https://stackoverflow.com/users/10373450/siddharth-dinesh"}, "reply_to_user": {"reputation": 97, "user_id": 10989902, "user_type": "registered", "profile_image": "https://graph.facebook.com/751829281850293/picture?type=large", "display_name": "Manpreet Sidhu", "link": "https://stackoverflow.com/users/10989902/manpreet-sidhu"}, "edited": false, "score": 0, "creation_date": 1558351409, "post_id": 56142295, "comment_id": 99060315, "body": "And also your second printf will never get executed."}], "tags": [], "owner": {"reputation": 179, "user_id": 10373450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04928f06e5a7fea240ed0a823bf53ca3?s=128&d=identicon&r=PG&f=1", "display_name": "Siddharth Dinesh", "link": "https://stackoverflow.com/users/10373450/siddharth-dinesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1557898108, "creation_date": 1557898108, "answer_id": 56142295, "question_id": 56141870, "link": "https://stackoverflow.com/questions/56141870/why-else-is-not-getting-executed/56142295#56142295", "title": "Why &quot;else&quot; is not getting executed?", "body": "<p>The else block is getting executed. You would understand if you add an printf statement in the else block like this.</p>\n\n<pre><code>int i=1;\nint main()\n{\n   if (i&lt;5)\n   {\n     i++; \n     printf(\"%d\\n\",i);\n     main(); \n     printf(\"\\n\\n%d\\n\",i);\n   }\n   else\n   {\n       printf(\"From Else Bloack, value of i is \",i);\n   }\n   return 0;\n}\n</code></pre>\n\n<p>The else block executes when the condition of the preceding if block becomes false.</p>\n"}], "owner": {"reputation": 97, "user_id": 10989902, "user_type": "registered", "profile_image": "https://graph.facebook.com/751829281850293/picture?type=large", "display_name": "Manpreet Sidhu", "link": "https://stackoverflow.com/users/10989902/manpreet-sidhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1557898108, "creation_date": 1557895242, "last_edit_date": 1557896836, "question_id": 56141870, "link": "https://stackoverflow.com/questions/56141870/why-else-is-not-getting-executed", "title": "Why &quot;else&quot; is not getting executed?", "body": "<p>Why Second <code>printf</code> is printing 5 value four time instead of else block?</p>\n\n<pre><code>    int i=1;\n    int main()\n    {\n       if (i&lt;5)\n       {\n         i++; \n         printf(\"%d\\n\",i);\n         main(); \n         printf(\"\\n\\n%d\\n\",i);\n       }\n       else\n       return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct", "text-files"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1557895077, "post_id": 56141701, "comment_id": 98913624, "body": "See <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-dangerous-why-should-it-not-be-used\">Why gets() is so dangerous it should never be used!</a> (especially for a login system...). You would normally read the entire accounts file with the hashed password into either an dynamically allocated array of struct, or list to have in memory to quickly iterate over for each login attempt. (at least for this exercise)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557895180, "post_id": 56141701, "comment_id": 98913651, "body": "@user3629249 - you might as well collect your comments and provide them as an answer, you have good points to make. Also while you are correct on <code>fflush(stdin)</code> from a C-Standard standpoint, if he is on windows -- of course they allow the non-standard use as an implementation feature..."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557895231, "post_id": 56141701, "comment_id": 98913663, "body": "@DavidC.Rankin, ok, moved my comments to an answer"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1557897645, "post_id": 56141701, "comment_id": 98914344, "body": "What you should do is send the password to a good hash function and stop storing passwords as plain text in a file."}, {"owner": {"reputation": 26033, "user_id": 1047662, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/8aXzf.jpg?s=128&g=1", "display_name": "Cyclonecode", "link": "https://stackoverflow.com/users/1047662/cyclonecode"}, "edited": false, "score": 0, "creation_date": 1557935912, "post_id": 56141701, "comment_id": 98936222, "body": "All password should be hashed and I would use a packed struct and store the data in a binary file or perhaps a database."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1557947864, "post_id": 56141701, "comment_id": 98941603, "body": "1. <code>fopen</code>, <code>fscanf</code> have return values - Please check out the manual pages for these functions. 2. The format %s can lead to buffer overruns. Try %19s.l 3. <code>fflush(stdin);</code> does not make sense. 4. <code>gets</code> is wrong. 5. <code>strcmp(pass,acc.pass)</code> should do a comparison with 0"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11491053, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417472878377412/picture?type=large", "display_name": "Minh Kh&#244;i", "link": "https://stackoverflow.com/users/11491053/minh-kh%c3%b4i"}, "edited": false, "score": 0, "creation_date": 1557896205, "post_id": 56141956, "comment_id": 98913910, "body": "1) i use <code>fflush(stdin)</code> because the program skip <code>gets(log[20].name)</code>. I looked back to another problem and look like it&#39;s the only solution. 2) i try to use <code>gets(...)</code> in order to get input from the user, If it unsafe what do you think i should use ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "reply_to_user": {"reputation": 3, "user_id": 11491053, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417472878377412/picture?type=large", "display_name": "Minh Kh&#244;i", "link": "https://stackoverflow.com/users/11491053/minh-kh%c3%b4i"}, "edited": false, "score": 0, "creation_date": 1557896325, "post_id": 56141956, "comment_id": 98913946, "body": "strongly suggest using <code>fgets()</code> (see the MAN page for details of the parameters and note that it also inputs the trailing newline, Suggest using: <code>strcspn()</code> to remove the newline"}, {"owner": {"reputation": 3, "user_id": 11491053, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417472878377412/picture?type=large", "display_name": "Minh Kh&#244;i", "link": "https://stackoverflow.com/users/11491053/minh-kh%c3%b4i"}, "edited": false, "score": 0, "creation_date": 1557934078, "post_id": 56141956, "comment_id": 98935165, "body": "I still dont know how to check <b>name</b> and <b>pass</b> in the account 2 and other account forward. Can you help me ?"}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": true, "score": 0, "last_activity_date": 1558052234, "last_edit_date": 1558052234, "creation_date": 1557895810, "answer_id": 56141956, "question_id": 56141701, "link": "https://stackoverflow.com/questions/56141701/login-system-using-text-file-in-c/56141956#56141956", "title": "Login system using text file in C", "body": "<p>in the function: <code>login()</code> the code needs to check every entry in the file before declaring a failure. After all, the first entry might not be for the person trying to login</p>\n\n<p>regarding: </p>\n\n<pre><code>sc = fopen(\"Account.txt\",\"r\"); \nfscanf(sc,\"\\nName: %s\",acc.name); \n</code></pre>\n\n<p>1) always check (!=NULL) the returned value from <code>fopen()</code> to assure the operation was successful. </p>\n\n<p>2) need to move past the first line of each entry in the input file before trying to read the name </p>\n\n<p>3) when using the input format specifiers '%s' and/or '%[...]' always include a MAX CHARACTERS modifier that is 1 less than the length of the input buffer because those specifiers always append a NUL byte to the input. This avoids a buffer overflow and the resulting undefined behavior. </p>\n\n<p>I.E. </p>\n\n<pre><code>if( !sc ) \n{ \n    perror( \"fopen failed\" ); \n    exit( EXIT_FAILURE ); \n} \n\n{input first line of acct and discard} \n\nif( fscanf(sc,\"\\nName: %19s\",acc.name) != 1 ) \n{ \n    // handle error \n} \n</code></pre>\n\n<p>However, if those lines in the input file contains those labels, like <code>Name:</code> Then the code needs to also input and discard those labels, as in the above example.</p>\n\n<p>This seems to be homework, so I'm very reluctant to just 'give' you appropriate code. I would expect your instructor or TA would be able to help you with the details of what the code should be doing.</p>\n\n<p>regarding statements like:</p>\n\n<pre><code>gets(log[20].name);\n</code></pre>\n\n<p>1) <code>gets()</code> is no longer part of the C language, Your compiler should have told you this.</p>\n\n<p>2) the valid index into an array has the range: 0...(number of entries in array -1).  So index 20 is beyond the end of the range.  Suggest just using a pointer to the array.  </p>\n\n<p>3) Suggest using `fgets() to input each line from the file.    </p>\n\n<p>4) the struct you have declared will not work well with the actual data from the input file.</p>\n\n<p>Suggest using:</p>\n\n<pre><code>#define MAX_LOG_ENTRIES 20\n\nint main( void )\n{\n    struct Account acc[ MAX_LOG_ENTRIES ] = { \"\",\"\" };\n    char dummy[128];\n    size_t i;\n    for( i = 0; i&lt;MAX_LOG_ENTRIES; i++ )\n    {\n        if( i&lt; MAX_LOG_ENTRIES &amp;&amp; fgets( dummy, sizeof( dummy ), sc ) )\n        {  // then successfully read 'account' line\n            if( fgets( dummy, sizeof( dummy ), sc ) )\n            {  // then successfully read 'Name:` line\n                // remove trailing newline\n                dummy[ strcspn( dummy, \"\\n\" )] = '\\0';\n                // skip past Name: ' label\n                char * namePtr = strchr( dummy, ':' );\n                if( namePtr )\n                { // then found the ':'\n                     // step by ': '\n                     namePtr += 2;\n                }\n                // extract name\n                strcpy( log[i].name, namePtr );\n\n            if( fgets( dummy, sizeof( dummy ), sc ) )\n            {  // then successfully read 'Pswd:` line\n                // remove trailing newline\n                dummy[ strcspn( dummy, \"\\n\" )] = '\\0';\n                // skip past Pswd: ' label\n                char * pswdPtr = strchr( dummy, ':' );\n                if( pswdPtr )\n                { // then found the ':'\n                     // step by ': '\n                     pswdPtr += 2;\n                }\n                // extract password\n                strcpy( log[i].pswd, pswdPtr );\n\n                // read/discard unused data line\n                fgets( dummy, sizeof( dummy ), sc );\n                // read/discard unused blank line\n                fgets( dummy, sizeof( dummy ), sc );          \n         }\n</code></pre>\n\n<p>When the above <code>for()</code> loop exits, all the records are read into the array named <code>log[]</code> and the variable 'i' contains the number of entries in the array 'log[]' that are actually used</p>\n\n<p>now the code needs to input the two fields from the user (name and pswd)</p>\n\n<p>Then loop through the array <code>log[]</code> to see if there is a 'name+pswd' match.</p>\n\n<p>if fgets( dummy, sizeof( dummy ), sc );a match is found, then success, otherwise the user failed to enter valid data.</p>\n\n<p>Note: The above code fails to check for errors and similar problems, including if the input file contains less than 20 entries.  You should be able to add the error (and EOF) checking</p>\n"}], "owner": {"reputation": 3, "user_id": 11491053, "user_type": "registered", "profile_image": "https://graph.facebook.com/1417472878377412/picture?type=large", "display_name": "Minh Kh&#244;i", "link": "https://stackoverflow.com/users/11491053/minh-kh%c3%b4i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2339, "favorite_count": 0, "accepted_answer_id": 56141956, "answer_count": 1, "score": 0, "last_activity_date": 1558052234, "creation_date": 1557893857, "question_id": 56141701, "link": "https://stackoverflow.com/questions/56141701/login-system-using-text-file-in-c", "title": "Login system using text file in C", "body": "<p>So my assignment is to create a login system. Username and passwords will be checked with content in the \u201caccount.txt\u201d file. The content is that file have structure look like this: </p>\n\n<p><em>Account ID: 1 <br/>\nName: John Lee<br/>\nPass: 7uf<br/>\nRole: student<br/>\n<br/>\nAccount ID: 2<br/>\nName: Park Lee<br/>\nPass: 42h<br/>\nRole: Lecturer<br/></em></p>\n\n<p>Here what i got so far:</p>\n\n<pre><code>struct Account {\n    char name[20];\n    char pass[20];\n};\n\nvoid Login (char name[], char pass[]){\n\n    FILE *sc;\n    struct Account acc;\n\n    sc = fopen(\"Account.txt\",\"r\");\n\n    fscanf(sc,\"\\nName: %s\",acc.name);\n    fscanf(sc,\"\\nPass: %s\",acc.pass);\n\n\n\n    if(strcmp(name,acc.name) == 0 &amp;&amp; strcmp(pass,acc.pass)) {\n        printf(\"Login successful\");\n    }\n    else {\n        printf(\"Name or Pass incorrect\");\n    }\n\n    fclose(sc);\n}\n\n\n int main () {\n\n    struct Account log[20];\n\n        fflush(stdin);\n        printf(\"\\n\\t\\tEnter your name: \");\n        gets(log[20].name);\n\n        printf(\"\\t\\tEnter your password: \");\n        gets(log[20].pass);\n\n        Login(log[20].name,log[20].pass);   \n    }\n\n    return 0; }\n</code></pre>\n\n<p>What do you guys think i should do ?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 33821, "user_id": 45685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y4RJr.jpg?s=128&g=1", "display_name": "AndersK", "link": "https://stackoverflow.com/users/45685/andersk"}, "edited": false, "score": 1, "creation_date": 1557892627, "post_id": 56141468, "comment_id": 98913096, "body": "lookup the function strtok() and isupper(). <a href=\"https://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow noreferrer\">en.cppreference.com/w/c/string/byte/strtok</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557902749, "post_id": 56143015, "comment_id": 98916328, "body": "Thank you, thank you, thank you really appreciate it :)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557902793, "post_id": 56143015, "comment_id": 98916358, "body": "Glad to help, let me know if there is anything that you have questions about and I&#39;m happy to explain."}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557908730, "post_id": 56143015, "comment_id": 98919422, "body": "How do you add malloc for this solution if the question has a bigger file?"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557909480, "post_id": 56143015, "comment_id": 98919798, "body": "You would replace <code>words_t words[MAX_WORDS]...</code> with <code>words_t *words = malloc (MAX_WORDS * sizeof *words);</code> to initially allocate <code>MAX_WORDS</code> elements. Keep a counter <code>size_t max_words = MAX_WORDS;</code> and then <code>if (index == max_words) { void *tmp = realloc (words, 2 * max_words * sizeof *words); if (!tmp) { perror (&quot;realloc-failed&quot;); break; } words = tmp; max_words *= 2; }</code>  That is the normal doubling scheme for dynamic memory. That way you can set <code>#define MAX_WORDS 8</code> to begin and then just double each time <code>index == max_words</code>, <code>realloc</code>, validate, and update <code>max_words *= 2;</code> That&#39;s it."}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557910566, "post_id": 56143015, "comment_id": 98920394, "body": "How do you &quot;Keep a counter size_t max_words = MAX_WORDS;&quot;"}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557910892, "post_id": 56143015, "comment_id": 98920587, "body": "Sorry I don&#39;t know how to implement all that"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557914630, "post_id": 56143015, "comment_id": 98922842, "body": "1) you just declare a second variable <code>words_max = WORDS_MAX;</code> that will track the total number of elements allocated. When you <code>realloc</code>, you can&#39;t change the constant <code>WORDS_MAX</code>, so you change your <code>words_max</code> variable. Your <code>index</code> tells you &quot;How many elements are filled&quot;. You <code>words_max</code> tells you how many are available. When <code>filled == available</code>, you <code>realloc</code> creating <code>2 * words_max * sizeof *words</code> elements and since you used <code>2 * words_max</code> above, you must update <code>words_max *= 2;</code> at the end of the <code>realloc</code> so it now holds correct &quot;available elements&quot; again."}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557918043, "post_id": 56143015, "comment_id": 98924905, "body": "Any chance you can add that to the answer as a second response? trying to get my head around malloc"}, {"owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557920604, "post_id": 56143015, "comment_id": 98926343, "body": "See following question <a href=\"https://stackoverflow.com/questions/56148540/how-to-apply-memory-allocation-to-a-c-program-which-counts-the-amount-of-words-i\" title=\"how to apply memory allocation to a c program which counts the amount of words i\">stackoverflow.com/questions/56148540/&hellip;</a>"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "edited": false, "score": 0, "creation_date": 1557954840, "post_id": 56143015, "comment_id": 98944383, "body": "@jaycodez see the answer to <a href=\"https://stackoverflow.com/questions/56148540/how-to-apply-memory-allocation-to-a-c-program-which-counts-the-amount-of-words-i\">https://stackoverflow.com/questions/56148540/...</a>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 1, "last_activity_date": 1557901983, "creation_date": 1557901983, "answer_id": 56143015, "question_id": 56141468, "link": "https://stackoverflow.com/questions/56141468/how-to-count-only-words-that-start-with-a-capital-in-a-list/56143015#56143015", "title": "How to count only words that start with a Capital in a list?", "body": "<p>You are working in the correct direction, you just need to rearrange your code a bit. While you can use separate arrays to try and keep track each unique word, while coordinating that index with an index in an array holding the number of times the word occurs and the same index in another array holding whether the word occurs in your file capitalized or not -- but there is a better way.</p>\n\n<p>Whenever you have to coordinate differing types of data as a single-unit, you need to be thinking <code>struct</code>. With a <code>struct</code>, you can coordinate each unique word, whether it appears capitalized in the file, and the number of times it occurs (case-insensitive) as a single unit, e.g.</p>\n\n<pre><code>typedef struct {            /* use a struct to hold */\n    char word[MAX_WORD];    /* lowercase word, and */\n    int cap, count;         /* if it appeast capitalized, and its count */\n} words_t;\n</code></pre>\n\n<p>Now you can simply create an array of <code>words_t</code> and be able to add each <code>word</code> (lowercase) as the word within the struct, capture whether it ever appears <code>cap</code>italized and the total <code>count</code> of the times it occurs.</p>\n\n<p>This simplifies the logic in your code. Now you simply declare an array of <code>words_t</code>, e.g.</p>\n\n<pre><code>#define MAX_WORD     50     /* max word size */\n#define MAX_WORDS   512     /* max number of words */\n...\n    /* Array of struct of distinct words, initialized all zero */\n    words_t words[MAX_WORDS] = {{ .word = \"\" }};\n</code></pre>\n\n<p>You ask for your filename -- <strong><em>validating every user input</em></strong>, e.g.</p>\n\n<pre><code>    /* Input file path */\n    printf (\"Enter file path: \");\n    if (scanf (\"%s\", path) != 1) {  /* validate every input */\n        fputs (\"error: invalid file path or cancellation.\\n\", stderr);\n        return 1;\n    }\n</code></pre>\n\n<p>Now loop over your words -- while protecting your array bounds as well as reading each word:</p>\n\n<pre><code>    while (index &lt; MAX_WORDS &amp;&amp;                 /* protect array bounds  */\n            fscanf (fptr, \"%s\", word) == 1) {   /* while valid word read */\n</code></pre>\n\n<p>Now the crux of the logic needed to store and keep track of which words have appeared capitalized comes into play. First you need a flag to test whether the word appears capitalized to capture the information <em>before</em> you convert the word to lowercase (along with your <code>isunique</code> flag). You capture whether the word appears capitalized, simply by testing the first character with <code>isupper()</code>, e.g.</p>\n\n<pre><code>        int iscap = 0, isunique = 1;    /* is captial, is unique flags */\n\n        if (isupper (*word))            /* is the word uppercase */\n            iscap = 1;\n</code></pre>\n\n<p>Rather than just trimming a single punctuation, you can just as easily trim <em>all</em> punctuation before converting the word to lowercase, e.g.</p>\n\n<pre><code>        /* remove all trailing punctuation characters */\n        len = strlen (word);                    /* get length */\n        while (len &amp;&amp; ispunct(word[len - 1]))   /* only if len &gt; 0 */\n            word[--len] = 0;\n\n        strlwr (word);                  /* convert word to lowercase */\n</code></pre>\n\n<p>Now all that remains from a data storage standpoint is to loop to determine whether the word <code>isunique</code>, and if it <strong>is not</strong>, simply set the <code>cap</code> flag if <code>iscap</code> is TRUE and increment the count. If it <strong>is</strong> unique, then, after exiting the loop, you copy the word to a new element in your array (using <code>memcpy</code> you have the length, no need to scan again) and you do the same thing with <code>cap</code> and <code>count</code>, incrementing <code>index</code> when done,</p>\n\n<pre><code>        /* check if word exits in list of all distinct words */\n        for (i = 0; i &lt; index; i++) {\n            if (strcmp(words[i].word, word) == 0) {\n                isunique = 0;               /* set unique flag zero */\n                if (iscap)                  /* if capital flag set */\n                    words[i].cap = iscap;   /* set capital flag in struct */\n                words[i].count++;           /* increment word count */\n                break;                      /* bail - done */\n            }\n        }\n        if (isunique) { /* if unique, add to array, increment index */\n            memcpy (words[index].word, word, len + 1);  /* have len */\n            if (iscap)                      /* if cap flag set */\n                words[index].cap = iscap;   /* set capital flag in struct */\n            words[index++].count++;         /* increment count &amp; index */\n        }\n    }\n    fclose (fptr);  /* close file */\n</code></pre>\n\n<p>All that remains is looping over the elements stored in the array and checking the <code>.cap</code> member to determine if the word appears capitalized before printing the word and the number of times it appears (<strong>note:</strong> your <strong>Expected Output:</strong> counts are wrong based on your example text)</p>\n\n<pre><code>    /*\n     * Print occurrences of all words in file.\n     */\n    puts (\"\\nOccurrences of all distinct words with Cap in file:\");\n    for (i = 0; i &lt; index; i++) {\n        if (words[i].cap) {\n            strcpy (word, words[i].word);\n            *word = toupper (*word);\n            /*\n             * %-15s prints string in 15 character width.\n             * - is used to print string left align inside\n             * 15 character width space.\n             */\n            printf(\"%-15s %d\\n\", word, words[i].count);\n        }\n    }\n</code></pre>\n\n<p>(<strong>note:</strong> the use of <code>puts</code> instead of <code>printf</code> for <code>\"Occurrences of...\"</code> as there is no conversion needed... a good compiler will optimize this for you)</p>\n\n<p>Putting it altogether, you could do:</p>\n\n<pre><code>/**\n * C program to count occurrences of all words in a file.\n */\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;limits.h&gt;\n\n#define MAX_WORD     50     /* max word size */\n#define MAX_WORDS   512     /* max number of words */\n\n#ifndef PATH_MAX\n#define PATH_MAX   2048     /* max path (defined for Linux in limits.h) */\n#endif\n\ntypedef struct {            /* use a struct to hold */\n    char word[MAX_WORD];    /* lowercase word, and */\n    int cap, count;         /* if it appeast capitalized, and its count */\n} words_t;\n\nchar *strlwr (char *str)    /* no need for unsigned char */\n{\n    char *p = str;\n\n    while (*p) {\n        *p = tolower(*p);\n        p++;\n    }\n\n    return str;\n}\n\nint main (void) {\n\n    FILE *fptr;\n    char path[PATH_MAX], word[MAX_WORD];\n    size_t i, len, index = 0;\n\n    /* Array of struct of distinct words, initialized all zero */\n    words_t words[MAX_WORDS] = {{ .word = \"\" }};\n\n    /* Input file path */\n    printf (\"Enter file path: \");\n    if (scanf (\"%s\", path) != 1) {  /* validate every input */\n        fputs (\"error: invalid file path or cancellation.\\n\", stderr);\n        return 1;\n    }\n\n    fptr = fopen (path, \"r\");   /* open file */\n    if (fptr == NULL) {         /* validate file open */\n        fputs ( \"Unable to open file.\\n\"\n                \"Please check you have read privileges.\\n\", stderr);\n        exit (EXIT_FAILURE);\n    }\n\n    while (index &lt; MAX_WORDS &amp;&amp;                 /* protect array bounds  */\n            fscanf (fptr, \"%s\", word) == 1) {   /* while valid word read */\n        int iscap = 0, isunique = 1;    /* is captial, is unique flags */\n\n        if (isupper (*word))            /* is the word uppercase */\n            iscap = 1;\n\n        /* remove all trailing punctuation characters */\n        len = strlen (word);                    /* get length */\n        while (len &amp;&amp; ispunct(word[len - 1]))   /* only if len &gt; 0 */\n            word[--len] = 0;\n\n        strlwr (word);                  /* convert word to lowercase */\n\n        /* check if word exits in list of all distinct words */\n        for (i = 0; i &lt; index; i++) {\n            if (strcmp(words[i].word, word) == 0) {\n                isunique = 0;               /* set unique flag zero */\n                if (iscap)                  /* if capital flag set */\n                    words[i].cap = iscap;   /* set capital flag in struct */\n                words[i].count++;           /* increment word count */\n                break;                      /* bail - done */\n            }\n        }\n        if (isunique) { /* if unique, add to array, increment index */\n            memcpy (words[index].word, word, len + 1);  /* have len */\n            if (iscap)                      /* if cap flag set */\n                words[index].cap = iscap;   /* set capital flag in struct */\n            words[index++].count++;         /* increment count &amp; index */\n        }\n    }\n    fclose (fptr);  /* close file */\n\n    /*\n     * Print occurrences of all words in file.\n     */\n    puts (\"\\nOccurrences of all distinct words with Cap in file:\");\n    for (i = 0; i &lt; index; i++) {\n        if (words[i].cap) {\n            strcpy (word, words[i].word);\n            *word = toupper (*word);\n            /*\n             * %-15s prints string in 15 character width.\n             * - is used to print string left align inside\n             * 15 character width space.\n             */\n            printf(\"%-15s %d\\n\", word, words[i].count);\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>Using your posted input </p>\n\n<pre><code>$ ./bin/unique_words_with_cap\nEnter file path: dat/girljumped.txt\n\nOccurrences of all distinct words with Cap in file:\nAny             7\nOne             4\nSome            10\nThe             6\nA               13\n</code></pre>\n\n<p>(<strong>note:</strong> <code>\"Some/some\"</code> appears <code>10</code> times and <code>\"A/a\"</code> appears <code>13</code> times instead of the <code>3/8</code> shown in your <strong>Expected Output:</strong>, which you can confirm by simple count)</p>\n\n<p>Look things over and let me know if you have further questions.</p>\n"}], "owner": {"reputation": 1551, "user_id": 586817, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/da6139ee51c56e562fb48700b431a9e4?s=128&d=identicon&r=PG&f=1", "display_name": "jaycodez", "link": "https://stackoverflow.com/users/586817/jaycodez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 56143015, "answer_count": 1, "score": 0, "last_activity_date": 1557901983, "creation_date": 1557891859, "last_edit_date": 1557898453, "question_id": 56141468, "link": "https://stackoverflow.com/questions/56141468/how-to-count-only-words-that-start-with-a-capital-in-a-list", "title": "How to count only words that start with a Capital in a list?", "body": "<p><strong>How to count words that only start with capitals?</strong></p>\n\n<ul>\n<li>Find all uppercase starting words <em>(eg. Any = 3)</em></li>\n<li>Count how many times those words occur <em>(eg. Any=3 + any+4 = Any=7)</em>  </li>\n</ul>\n\n<hr>\n\n<p><strong>See the example code from this demonstration:</strong></p>\n\n<p><a href=\"https://codeforwin.org/2018/02/c-program-count-occurrences-of-all-words-a-file.html\" rel=\"nofollow noreferrer\">https://codeforwin.org/2018/02/c-program-count-occurrences-of-all-words-a-file.html</a></p>\n\n<p><strong>Code example:</strong></p>\n\n<p><a href=\"https://onlinegdb.com/HJgWn-K2E\" rel=\"nofollow noreferrer\">https://onlinegdb.com/HJgWn-K2E</a></p>\n\n<pre><code>/**\n* C program to count occurrences of all words in a file.\n*/\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_WORDS   50\n\nchar *strlwr(char *str)\n{\n    unsigned char *p = (unsigned char *)str;\n\n    while (*p) {\n        *p = tolower((unsigned char)*p);\n        p++;\n    }\n\n    return str;\n}\n\nint main()\n{\n    FILE *fptr;\n    char path[100];\n    int i, len, index, isUnique;\n\n    // List of distinct words\n    char words[MAX_WORDS][50];\n    char word[50];\n\n    // Count of distinct words\n    int  count[MAX_WORDS];\n\n\n    /* Input file path */\n    printf(\"Enter file path: \");\n    scanf(\"%s\", path);\n\n\n    /* Try to open file */\n    fptr = fopen(path, \"r\");\n\n    /* Exit if file not opened successfully */\n    if (fptr == NULL)\n    {\n        printf(\"Unable to open file.\\n\");\n        printf(\"Please check you have read privileges.\\n\");\n\n        exit(EXIT_FAILURE);\n    }\n\n    // Initialize words count to 0\n    for (i=0; i&lt;MAX_WORDS; i++)\n        count[i] = 0;\n\n\n\n\n    index = 0;\n\n    while (fscanf(fptr, \"%s\", word) != EOF)\n    {\n        // Convert word to lowercase\n        strlwr(word);\n\n        // Remove last punctuation character\n        len = strlen(word);\n        if (ispunct(word[len - 1]))\n            word[len - 1] = '\\0';\n\n\n        // Check if word exits in list of all distinct words\n        isUnique = 1;\n        for (i=0; i&lt;index &amp;&amp; isUnique; i++)\n        {\n            if (strcmp(words[i], word) == 0)\n                isUnique = 0;\n        }\n\n        // If word is unique then add it to distinct words list\n        // and increment index. Otherwise increment occurrence\n        // count of current word.\n        if (isUnique)\n        {\n            strcpy(words[index], word);\n            count[index]++;\n\n            index++;\n        }\n        else\n        {\n            count[i - 1]++;\n        }\n\n\n\n    }\n\n    // Close file\n    fclose(fptr);\n\n\n    /*\n     * Print occurrences of all words in file.\n     */\n    printf(\"\\nOccurrences of all distinct words in file: \\n\");\n    for (i=0; i&lt;index; i++)\n    {\n        /*\n         * %-15s prints string in 15 character width.\n         * - is used to print string left align inside\n         * 15 character width space.\n         */\n        printf(\"%-15s %d\\n\", words[i], count[i]);\n    }\n\n\n    return 0;\n}\n</code></pre>\n\n<p>In this code example, they make all words lower case letters then count all those words. </p>\n\n<p>Instead: How do you only add the words to the unique list if it starts with a capital, then count all the occurances of that word</p>\n\n<p>Should you combine <strong>fscanf</strong> with <strong>if (isupper[0])</strong></p>\n\n<p><strong>Test.txt file</strong></p>\n\n<pre><code>Any girl jumped over one boy.\nSome car skipped to some boy.\nOne town drove over the town.\nAny town ran under some dog.\nSome girl drove to a town.\nThe boy walked under any town.\nA town jumped over any car.\nAny boy jumped from a car.\nA dog ran over a boy.\nA girl ran to some car.\nA car ran under the girl.\nThe car ran on any town.\nOne dog walked under any dog.\nA car jumped on some town.\nA boy ran to a boy.\nThe dog drove over a boy.\nA boy jumped over the car.\nSome car drove on some girl.\nOne boy drove under some girl.\nA girl walked over some dog.\n</code></pre>\n\n<p><strong>Expected Output:</strong></p>\n\n<pre><code>Any  7\nSome 3\nOne  4\nThe  6\nA    8\n</code></pre>\n\n<p><strong>Current Output:</strong></p>\n\n<pre><code>any             7\ngirl            7\njumped          5\nover            7\none             4\nboy             10\nsome            10\ncar             9\nskipped         1\nto              4\ntown            8\ndrove           5\nthe             6\nran             6\nunder           5\ndog             6\na               13\nwalked          3\nfrom            1\non              3\n</code></pre>\n\n<p><strong>Possible Solutions:</strong></p>\n\n<pre><code>    // skip the word if it does not contain a capital letter at start\n    if (islower(word[0])) {\n        continue;\n    }\n</code></pre>\n\n<p>Then create another <strong>FOR</strong> loop which checks how often those words appear in the file if they are starting with <em>lowercase</em> or <em>uppercase</em></p>\n"}, {"tags": ["c", "linux", "windows", "io"], "comments": [{"owner": {"reputation": 101, "user_id": 7800752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e52682cd00a0f8ad8ecea53f26d7b36?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith", "link": "https://stackoverflow.com/users/7800752/jsmith"}, "edited": false, "score": 0, "creation_date": 1557891996, "post_id": 56141449, "comment_id": 98913000, "body": "Also, I will mention that I have tried multiple files, and I seem to have issues with all of them when I am on Windows.  Still no problems on Linux, however.  Thanks!"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1557892880, "post_id": 56141449, "comment_id": 98913135, "body": "According to the <a href=\"https://linux.die.net/man/3/read\" rel=\"nofollow noreferrer\"><code>read (3)</code>  man page</a>, <code>read</code> returns <code>-1</code> on error, not something based on not-<code>&gt; 0</code>. You should check for a <code>-1</code> return value, and then inspect <code>errno</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1557893179, "post_id": 56141449, "comment_id": 98913213, "body": "Regarding the <code>&gt; 0</code> condition, this is  <i>very</i> problematic since <code>bytes</code> an <i>unsigned</i> integer. Consider the unsigned equivalent of <code>-1</code> in a <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow noreferrer\">two&#39;s complement</a> system. And if you see e.g. <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/read.html\" rel=\"nofollow noreferrer\">this <code>read</code> reference</a> you will see that it returns a value of type <code>ssize_t</code>, which is signed."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1557893314, "post_id": 56141449, "comment_id": 98913238, "body": "@jww Other than that, <code>&gt; 0</code> is an okay condition. The loop will end if there&#39;s an error or end-of-file."}, {"owner": {"reputation": 101, "user_id": 7800752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e52682cd00a0f8ad8ecea53f26d7b36?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith", "link": "https://stackoverflow.com/users/7800752/jsmith"}, "edited": false, "score": 0, "creation_date": 1557893789, "post_id": 56141449, "comment_id": 98913339, "body": "Good catch on that unsigned int.  However, after testing, read() is definitely not returning -1.  It is returning 0.  Doing a little more digging, it seems that read is stopping on the <i>substitute character</i> which hex value in the ascii table is 1A."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557896544, "post_id": 56141449, "comment_id": 98913995, "body": "OT: regarding: <code>if (argc != 2) { return 1; }</code>  should tell the user what they should have input (via a USAGE statement) before calling the <code>return</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557896948, "post_id": 56141449, "comment_id": 98914130, "body": "regarding: <i>Still no problems on Linux,</i>  no problem because linux uses <code>ctrl-d</code> for EOF rather than <code>ctrl-z</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557897119, "post_id": 56141449, "comment_id": 98914176, "body": "OT: regarding: <code>if (fd == -1) { return 1; }</code>  1) please follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>   2) when an error indication is returned from a C library function, use <code>perror( &quot;your error message&quot;)</code>;  to output to <code>stderr</code> both your error message and the text reason the system thinks the error occurred"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557897332, "post_id": 56141449, "comment_id": 98914249, "body": "OT: when calling <code>read()</code> the code should be checking for all 3 return conditions: 1) &lt;0 means an error occurred  2) ==0 means EOF or the other end of the connection closed the connection  3) &gt;0 means that many characters were read."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557897466, "post_id": 56141449, "comment_id": 98914283, "body": "OT: regarding: <code>while ((bytes = read(fd, buffer, sizeof(unsigned char) * 8)) &gt; 0) {</code>  This would be much more flexibility written as: <code>while ((bytes = read(fd, buffer, sizeof( buffer )) &gt; 0) {</code>"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 7800752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e52682cd00a0f8ad8ecea53f26d7b36?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith", "link": "https://stackoverflow.com/users/7800752/jsmith"}, "is_accepted": false, "score": 1, "last_activity_date": 1557894929, "creation_date": 1557894929, "answer_id": 56141831, "question_id": 56141449, "link": "https://stackoverflow.com/questions/56141449/program-not-reading-entire-file/56141831#56141831", "title": "Program Not Reading Entire File", "body": "<p>I have found the answer in this post after all.  They were having the issue with stdin, though.  Apparently the substitute character (1A) is the same as CTRL+Z in Windows, and so it was forcibly closing my program when reading that character.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/12942518/c-reading-from-stdin-stops-at-0x1a-character\">C reading (from stdin) stops at 0x1a character</a></p>\n"}], "owner": {"reputation": 101, "user_id": 7800752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e52682cd00a0f8ad8ecea53f26d7b36?s=128&d=identicon&r=PG&f=1", "display_name": "jsmith", "link": "https://stackoverflow.com/users/7800752/jsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557894929, "creation_date": 1557891698, "last_edit_date": 1557892752, "question_id": 56141449, "link": "https://stackoverflow.com/questions/56141449/program-not-reading-entire-file", "title": "Program Not Reading Entire File", "body": "<p>I am writing a hex dump program in C.  I know there are tons of hex dump programs out there, but I wanted to write one for the experience.  I have written the program in CodeBlocks, on Windows, but I can't seem to get it to work.</p>\n\n<p>I am reading in a test program which is roughly 137,000 bytes, but the program stops at 417 bytes.  Now, when I compile the code on Linux (as it's only a console application and is using standard C libraries), it works perfectly, and gives back the correct amount of bytes in the file.  Does anyone have any idea why read() would not work on Windows, but works fine in Linux?</p>\n\n<p>Below is an example of how I am reading in the file.</p>\n\n<pre><code>int main(int argc, char **argv)\n{\n    if (argc != 2) { return 1; }\n\n    int fd = open(argv[1], O_RDONLY);\n    if (fd == -1) { return 1; }\n\n    unsigned char buffer[8];\n    unsigned int bytes = 0;\n    unsigned int total_bytes = 0;\n\n    while ((bytes = read(fd, buffer, sizeof(unsigned char) * 8)) &gt; 0) {\n        ...\n        total_bytes += bytes;\n    }\n\n    printf(\"Total Bytes: %d\\n\", total_bytes);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "sql-server", "ado"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10288406"}, "is_accepted": true, "score": 0, "last_activity_date": 1558002007, "creation_date": 1558002007, "answer_id": 56166271, "question_id": 56141289, "link": "https://stackoverflow.com/questions/56141289/connect-to-sql-server-2017-failed-but-return-null-error-information-when-using-c/56166271#56166271", "title": "Connect to sql server 2017 failed but return null error information when using c++ ADO", "body": "<p>Just add <code>::CoInitialize(NULL);</code> in the same function of <code>Open</code>, will be ok.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10288406"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56166271, "answer_count": 1, "score": 0, "last_activity_date": 1558002007, "creation_date": 1557890196, "last_edit_date": 1557891790, "question_id": 56141289, "link": "https://stackoverflow.com/questions/56141289/connect-to-sql-server-2017-failed-but-return-null-error-information-when-using-c", "title": "Connect to sql server 2017 failed but return null error information when using c++ ADO", "body": "<p>My environment is: Windows 10 , Microsoft SQL Server 2017 Developer Edition.</p>\n\n<p>I'm using c++ ADO to connect to sql server, but when it is connecting to the server, it throw an error, but return null error information.</p>\n\n<p>Below is my codes,</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// ms_connection.h\n\n#import \"C:\\Program Files (x86)\\Common Files\\system\\ado\\msado15.dll\" no_namespace rename(\"EOF\",\"adoEOF\")rename(\"BOF\",\"adoBOF\")\n\nclass MSConnection\n{\npublic:\n\n    virtual void init();\n    virtual void connect();\n\nprivate:\n\n    _ConnectionPtr m_connection;\n\n};\n</code></pre>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>// ms_connection.cpp\n\n#include \"ms_connection.h\"\n\nvoid MSConnection::init()\n{\n    try\n    {\n        m_connection.CreateInstance(\"ADODB.Connection\");\n    }\n    catch (_com_error e)\n    {\n        LOG_ERROR &lt;&lt; \"MSConnection failed when try to init the object, \" &lt;&lt; (const char*)e.Description();\n\n        throw (const char*)e.Description();\n    }\n}\n\nvoid MSConnection::connect()\n{\n    try\n    {\n        m_connection-&gt;Open(L\"Provider=SQLOLEDB;Data Source=127.0.0.1, 1443;\", L\"root\", L\"haiwell\", adModeUnknown);\n    }\n    catch (_com_error e)\n    {\n        LOG_ERROR &lt;&lt; \"MSConnection failed when try to connect to the server, \" &lt;&lt; (const char*)e.Description();\n\n        throw (const char*)e.Description();\n    }\n}\n\n</code></pre>\n\n<p>When execute the <code>init()</code> and <code>connect()</code>, I found an error in log,</p>\n\n<pre><code>2019-05-15 11:00:18.343 ERROR [14408] [MSConnection::connect@36] MSConnection failed when try to connect to the server, (null)\n</code></pre>\n\n<p>I have restarted my computer and sql server, but the problem is still existed.</p>\n\n<p>Could someone give me any advice? Why is it so strange?</p>\n\n<p>Thanks a lot in advance.</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557888589, "post_id": 56141092, "comment_id": 98912429, "body": "So you have <code>void cmparrays (int *a, int *b, size_t sza, size_t szb) { ... }</code> and you have passed both arrays and the size of each to your function. (you can also pass <code>int *c, size_t szc</code> as parameters if you need to pass a 3rd array in). Now just implement your logic. Where are you stuck?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 3, "creation_date": 1557888858, "post_id": 56141092, "comment_id": 98912472, "body": "<b><i>Show your code</i></b>"}, {"owner": {"reputation": 374, "user_id": 9858322, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUNcB.jpg?s=128&g=1", "display_name": "rsonx", "link": "https://stackoverflow.com/users/9858322/rsonx"}, "edited": false, "score": 0, "creation_date": 1557889203, "post_id": 56141092, "comment_id": 98912545, "body": "(1) You must know the size of both the arrays beforehand to check whether they are equal or not. (2) Pass array 1, array 2, size 1, size 2 to the function. (3) exit if (size 1!= size 2). (4) loop from i = 0 to i = size 1 or size 2. And compare array 1[i] and array 2[i]. Put the max in a third array. After completion of loop return the start address of third array."}], "answers": [{"comments": [{"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557891429, "post_id": 56141203, "comment_id": 98912898, "body": "<code>sizeof</code> is an operator, not a function."}, {"owner": {"reputation": 16, "user_id": 11495751, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zq_isqwLMFc/AAAAAAAAAAI/AAAAAAAAACQ/W9NO229_zyw/photo.jpg?sz=128", "display_name": "moondrip", "link": "https://stackoverflow.com/users/11495751/moondrip"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557975459, "post_id": 56141203, "comment_id": 98948454, "body": "\u5358\u7d14\u306b\u82f1\u8a9e\u3092\u9593\u9055\u3048\u3066\u3044\u307e\u3057\u305f\u304b\u3002\u4fee\u6b63\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u3002"}], "tags": [], "owner": {"reputation": 16, "user_id": 11495751, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Zq_isqwLMFc/AAAAAAAAAAI/AAAAAAAAACQ/W9NO229_zyw/photo.jpg?sz=128", "display_name": "moondrip", "link": "https://stackoverflow.com/users/11495751/moondrip"}, "is_accepted": true, "score": 0, "last_activity_date": 1557889301, "creation_date": 1557889301, "answer_id": 56141203, "question_id": 56141092, "link": "https://stackoverflow.com/questions/56141092/how-to-make-a-function-to-find-the-difference-between-each-element-of-two-arrays/56141203#56141203", "title": "How to make a function to find the difference between each element of two arrays of equal length", "body": "<p>You can do this by using a function called \"sizeof\".</p>\n\n<pre><code>if(sizeof(arrA) == sizeof(arrB)){\n    //OK\n}else{\n    //NG\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 11220573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IX2xz.png?s=128&g=1", "display_name": "napier fou du roi", "link": "https://stackoverflow.com/users/11220573/napier-fou-du-roi"}, "edited": false, "score": 0, "creation_date": 1558063363, "post_id": 56141352, "comment_id": 98984330, "body": "Thank you so much for the super detailed response. I&#39;m really trying to go through all of it and understand. We&#39;re in the middle of hell week so i might not be able to respond with a question til we&#39;re done with the exams and stuff. Again, thank you."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1557890806, "creation_date": 1557890806, "answer_id": 56141352, "question_id": 56141092, "link": "https://stackoverflow.com/questions/56141092/how-to-make-a-function-to-find-the-difference-between-each-element-of-two-arrays/56141352#56141352", "title": "How to make a function to find the difference between each element of two arrays of equal length", "body": "<p>Let's look at your function and take it piece-by-piece, first and foremost, since your comparison can either succeed (equal sized arrays) or fail (unequal sized arrays), you should choose a return type that can indicate success or failure. Type <code>int</code> is fine, you can choose your scheme, e.g. <code>-1</code> is failure, <code>1</code> for success, or <code>0/1</code> -- just be consistent. So your function prototype (presuming you want to fill <code>arrC[]</code> in your function and make the filled <code>arrC[]</code> usable back in the caller), you could do:</p>\n\n<pre><code>int cmparrays (int *a, int *b, int *c, size_t sza, size_t szb, size_t szc)\n{\n    ...\n</code></pre>\n\n<p>You mention ANSI C, that will inject an additional caveat in that ANSI C requires are variable declarations at the beginning of each scope and does not provide for declaring loop variables within the <code>for</code> loop statement itself, so you would need:</p>\n\n<pre><code>    size_t i;   /* ANSI C requires variable declarations before statements */\n</code></pre>\n\n<p>The first order of business should be a comparison between the size of <code>arrA[]</code> and <code>arrB[]</code>. If they are unequal your comparison fails and you should return error. As a second part of the test, you should ensure that the size of <code>arrC[]</code> is at least as big as the size of <code>arrA[]</code> and <code>arrB[]</code>. You could do:</p>\n\n<pre><code>    if (sza != szb || szc &lt; sza) {  /* validate sizes */\n        fputs (\"Comparison is not possible\\n.\", stderr);\n        return -1;  /* return -1 indicating error */\n    }\n</code></pre>\n\n<p>If all is good, just output your prefix for the <code>arrC[]</code> elements, e.g.</p>\n\n<pre><code>    fputs (\"arrC[] = {\", stdout);               /* output prefix */\n</code></pre>\n\n<p>(which will output <code>\"arrC[] = {\"</code> setting up for the rest of the elements to be output)</p>\n\n<p>Now it is just a matter of looping over the elements in <code>arrA[]</code> and <code>arrB[]</code> and if they are equal assigning <code>0</code> to that element of <code>arrC[]</code>, otherwise, assign the larger to <code>arrC[]</code>. That can be done with a simple loop, an <code>if ... else</code> and a <code>ternary</code> operator, e.g.</p>\n\n<pre><code>    for (i = 0; i &lt; sza; i++) {                 /* loop over each element */\n        if (a[i] == b[i])                       /* if elements equal */\n            c[i] = 0;                           /* set to zero */\n        else    /* otherwise */\n            c[i] = a[i] &gt; b[i] ? a[i] : b[i];   /* set to larger element */\n        printf (i ? \", %d\" : \"%d\", c[i]);       /* output value */\n    }\n</code></pre>\n\n<p>All that remains is outputting the <em>suffix</em> for your output and returning an indication of success:</p>\n\n<pre><code>    fputs (\"};\\n\", stdout);     /* tidy up with closing brace &amp; newline */\n\n    return 1;   /* return success */\n}\n</code></pre>\n\n<p>Putting it altogether in a short example to test both equal and unequal array lengths, you could do:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint cmparrays (int *a, int *b, int *c, size_t sza, size_t szb, size_t szc)\n{\n    size_t i;   /* ANSI C requires variable declarations before statements */\n\n    if (sza != szb || szc &lt; sza) {  /* validate sizes */\n        fputs (\"Comparison is not possible\\n.\", stderr);\n        return -1;  /* return -1 indicating error */\n    }\n\n    fputs (\"arrC[] = {\", stdout);               /* output prefix */\n\n    for (i = 0; i &lt; sza; i++) {                 /* loop over each element */\n        if (a[i] == b[i])                       /* if elements equal */\n            c[i] = 0;                           /* set to zero */\n        else    /* otherwise */\n            c[i] = a[i] &gt; b[i] ? a[i] : b[i];   /* set to larger element */\n        printf (i ? \", %d\" : \"%d\", c[i]);       /* output value */\n    }\n    fputs (\"};\\n\", stdout);     /* tidy up with closing brace &amp; newline */\n\n    return 1;   /* return success */\n}\n\nint main (void) {\n#ifndef TESTUNEQUAL\n    int arrA[] = {1, 4, 7, 8, 9},\n        arrB[] = {3, 2, 7, 8, 6},\n#else\n    int arrA[] = {1, 2, 3},\n        arrB[] = {2, 4, 5, 7, 9},\n#endif\n        arrC[sizeof arrA/sizeof *arrA] = {0};\n    size_t  sza = sizeof arrA/sizeof *arrA,\n            szb = sizeof arrB/sizeof *arrB,\n            szc = sizeof arrC/sizeof *arrC;\n\n    if (cmparrays (arrA, arrB, arrC, sza, szb, szc) == -1)\n        return 1;\n    /* you can use array arrC[] here and below */\n}\n</code></pre>\n\n<p>(<strong>note:</strong> the use of a simply preprocessor definition for <code>TESTUNEQUAL</code> to change the declarations for <code>arrA[]</code> and <code>arrB[]</code> if the <code>-DTESTUNEQUAL</code> define is passed as part of the compile string)</p>\n\n<p><strong>Example Use/Output</strong></p>\n\n<p>With equal length arrays:</p>\n\n<pre><code>$ ./bin/cmparrays\narrC[] = {3, 4, 0, 0, 9};\n</code></pre>\n\n<p>or compiling with <code>TESTUNEQUAL</code> defined:</p>\n\n<pre><code>$ gcc -Wall -Wextra -pedantic -std=c11 -Ofast -o bin/cmparrays_unequal \\\ncmparrays.c -DTESTUNEQUAL\n\n$ ./bin/cmparrays_unequal\nComparison is not possible\n</code></pre>\n\n<p>Let me know if you have further questions.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 2650134, "user_type": "registered", "profile_image": "https://graph.facebook.com/1515187256/picture?type=large", "display_name": "Muhammad Satrio Pakarti", "link": "https://stackoverflow.com/users/2650134/muhammad-satrio-pakarti"}, "is_accepted": false, "score": 0, "last_activity_date": 1557891177, "creation_date": 1557891177, "answer_id": 56141396, "question_id": 56141092, "link": "https://stackoverflow.com/questions/56141092/how-to-make-a-function-to-find-the-difference-between-each-element-of-two-arrays/56141396#56141396", "title": "How to make a function to find the difference between each element of two arrays of equal length", "body": "<p>to get length of array, you need to divide sizeof array you want to check with type of the array, example:</p>\n\n<pre><code>int arrA[] = {1, 4, 7, 8, 9};\nint sizeOfArrayA = sizeof(arrA)/sizeof(int);\n</code></pre>\n\n<p>in <i>sizeOfArrayA </i> you will get 5.</p>\n\n<p>below code is example:</p>\n\n<pre><code>int compare(int* arrA, int sizeA, int* arrB, int sizeB, int* arrC){\n    int i;\n    if(sizeA != sizeB)\n        return -1;\n\n    for(i=0;i&lt;sizeA;i++){\n        if(arrA[i]==arrB[i])\n            arrC[i] = 0;\n        else if(arrA[i]&gt;arrB[i])\n            arrC[i] = arrA[i];\n        else\n            arrC[i] = arrB[i];\n    }\n\n    return 0;\n}\n\nint main(void) {\n    int arrA[] = {1, 4, 7, 8, 9};\n    int arrB[] = {3, 2, 7, 8, 6};\n    int arrC[50] = {0};\n\n    if(compare(\n            arrA, sizeof(arrA)/sizeof(int),\n            arrB, sizeof(arrB)/sizeof(int),\n            arrC) != 0)\n    {\n        printf(\"Comparison is not possible.\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11220573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IX2xz.png?s=128&g=1", "display_name": "napier fou du roi", "link": "https://stackoverflow.com/users/11220573/napier-fou-du-roi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "closed_date": 1557910580, "accepted_answer_id": 56141203, "answer_count": 3, "score": -1, "last_activity_date": 1557891177, "creation_date": 1557888351, "last_edit_date": 1557888574, "question_id": 56141092, "link": "https://stackoverflow.com/questions/56141092/how-to-make-a-function-to-find-the-difference-between-each-element-of-two-arrays", "closed_reason": "Needs more focus", "title": "How to make a function to find the difference between each element of two arrays of equal length", "body": "<p>The function supposedly checks if the size of both arrays are the same. If they are, compare each index of both arrays and see which one has a greater value. Store the bigger value inside a third array. If both values are equal, then store a zero inside the 3rd array. Prior to the end of the function, display all the elements in the third array. If sizes of both arrays are not equal, then display \"Comparison is not possible\".</p>\n\n<p>All I have tried is brute force studying ANSI C but I'm still a bit lost.</p>\n\n<h3>Example 1:</h3>\n\n<p>Input:</p>\n\n<pre><code>arrA[] = {1, 4, 7, 8, 9};\narrB[] = {3, 2, 7, 8, 6};\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>arrC[] = {3, 4, 0, 0, 9};\n</code></pre>\n\n<h3>Example 2:</h3>\n\n<p>Input:</p>\n\n<pre><code>arrA[] = {1, 2, 3};                          \narrB[] = {2, 4, 5, 7, 9};\n</code></pre>\n\n<p>Output:</p>\n\n<p>Comparison is not possible.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 3, "creation_date": 1557887731, "post_id": 56141000, "comment_id": 98912280, "body": "No, it&#39;s <i>Undefined Behavior</i> resulting from integer overflow - anything can happen. Compiling with warnings enabled provides <code>&quot;overflow.c:8:5: warning: overflow in implicit constant conversion [-Woverflow]&quot;</code> and at <code>&quot;overflow.c:9:5 ...&quot;</code>"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 2, "creation_date": 1557887936, "post_id": 56141000, "comment_id": 98912317, "body": "Undefined behavior or not, <code>2147483648 + 2147483648 = 4294967296 = 2^32 = 0 (mod 2^32)</code> assuming a 32-bit integer."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1557888157, "post_id": 56141000, "comment_id": 98912352, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#3.4.3p3\" rel=\"nofollow noreferrer\">C11 Standard - 3.4.3(p3)</a> - <code>&quot;EXAMPLE An example of undefined behavior is the behavior on integer overflow.&quot;</code> (how each individual compiler handles that condition is not defined - but assigning <code>0</code> as a result would be one reasonable way -- there is just no guarantee how it will be handled)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557891640, "post_id": 56141000, "comment_id": 98912931, "body": "<code>int a=2147483648;</code> causes implementation-defined behaviour (if int is 32-bit) since the initializer is out of range for <code>int</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557891734, "post_id": 56141000, "comment_id": 98912954, "body": "@ybungalobill your logic is invalid as if it is a 32-bit integer then there cannot be <code>2147483648</code> in the first place"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1557891930, "post_id": 56141000, "comment_id": 98912988, "body": "@M.M there is, <a href=\"https://en.wikipedia.org/wiki/Modular_arithmetic\" rel=\"nofollow noreferrer\">modulo 2^32</a>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557893518, "post_id": 56141000, "comment_id": 98913282, "body": "@ybungalobill there&#39;s no modulo operation in this code"}], "answers": [{"tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 1, "last_activity_date": 1557892470, "creation_date": 1557892470, "answer_id": 56141546, "question_id": 56141000, "link": "https://stackoverflow.com/questions/56141000/generating-an-arithmetic-overflow/56141546#56141546", "title": "Generating an arithmetic overflow", "body": "<p>For your specific compiler on your specific computer; it's plausible that <code>int a=2147483648;</code> is essentially the same as <code>int a=INT_MAX+1;</code> which is treated like <code>int a=INT_MIN;</code>, and same for <code>int b</code>, and that this leads to <code>return INT_MIN+INT_MIN;</code> which is actually like \"0x80000000 + 0x80000000 = 0x100000000 = 0x00000000 with overflow\".</p>\n\n<p>However, all of the above relies on undefined behavior (with the assumption that the undefined behavior accidentally causes wrapping in practice).</p>\n\n<p>In general; you want to use <code>unsigned int</code> (or even better, <code>uint32_t</code>) to avoid undefined behavior and get the \"intended overflow\" you were hoping for.</p>\n"}], "owner": {"reputation": 11, "user_id": 11421851, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-uw8Fgxo0EJ4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4AbgDHQ1fLtqrqp1pL4-Hf7SUfw/mo/photo.jpg?sz=128", "display_name": "wizard 0x99", "link": "https://stackoverflow.com/users/11421851/wizard-0x99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1557892470, "creation_date": 1557887349, "question_id": 56141000, "link": "https://stackoverflow.com/questions/56141000/generating-an-arithmetic-overflow", "title": "Generating an arithmetic overflow", "body": "<p>Why these two values produces zero output. I thought it suppose to generate an arithmetic overflow but acting like a and b have opposite signes.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n// trying to generate an arithmetic overflow\nint sum(int a, int b) {\n    return a + b;\n}\nint main()\n{\n    int a=2147483648;\n    int b=2147483648;\n    printf(\"%d\", sum(a,b));\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "operating-system", "pseudocode"], "answers": [{"comments": [{"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1557888887, "post_id": 56140949, "comment_id": 98912479, "body": "Dijkstra&#39;s solution is &quot;unfair&quot; - one philosopher can be very lucky and always eat while another philosopher can be very unlucky and starve."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "reply_to_user": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "edited": false, "score": 0, "creation_date": 1557889482, "post_id": 56140949, "comment_id": 98912586, "body": "Yes, it is... but it&#39;s still the most common (and usually simplest) way to avoid deadlock in practice."}], "tags": [], "owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "is_accepted": false, "score": 0, "last_activity_date": 1557888479, "last_edit_date": 1557888479, "creation_date": 1557886796, "answer_id": 56140949, "question_id": 56140841, "link": "https://stackoverflow.com/questions/56140841/dining-philosopherss-problem-with-test-set-instruction/56140949#56140949", "title": "Dining philosophers&#39;s problem with test-set instruction", "body": "<p>Sure, an <em>atomic</em> <code>TestAndSet</code> is enough to make a mutex lock.  <code>TestAndSet(fork)</code> is an attempted lock that returns <code>false</code> if it's successful.  <code>fork=false</code> unlocks it.  </p>\n\n<p>You can use Dijkstra's solution -- every philosopher locks the northernmost fork first. </p>\n"}, {"comments": [{"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557889651, "post_id": 56141078, "comment_id": 98912612, "body": "The algorithm makes no progress until the current &#39;next controller&#39; wants to eat."}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557891592, "post_id": 56141078, "comment_id": 98912919, "body": "@MattTimmermans: That&#39;s what makes it fair. Of course if a philosopher isn&#39;t hungry they can <code>eat()</code> for zero time, and to improve performance &quot;thinking&quot; can be split into many periods between &quot;zero time eating&quot;."}, {"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557892180, "post_id": 56141078, "comment_id": 98913023, "body": "&quot;fair&quot; in a &quot;sucks for everybody&quot; kind of way ;-)"}, {"owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1557892562, "post_id": 56141078, "comment_id": 98913082, "body": "@MattTimmermans: Well, &quot;fair&quot; in the &quot;everyone has an equal chance to eat&quot; way (or maybe in a &quot;sucks for gluttons&quot; way)."}], "tags": [], "owner": {"reputation": 25733, "user_id": 559737, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5de249db6565b87a2699e131974268a?s=128&d=identicon&r=PG", "display_name": "Brendan", "link": "https://stackoverflow.com/users/559737/brendan"}, "is_accepted": false, "score": 0, "last_activity_date": 1557889161, "last_edit_date": 1557889161, "creation_date": 1557888207, "answer_id": 56141078, "question_id": 56140841, "link": "https://stackoverflow.com/questions/56140841/dining-philosopherss-problem-with-test-set-instruction/56141078#56141078", "title": "Dining philosophers&#39;s problem with test-set instruction", "body": "<p>Yes.</p>\n\n<p>For one example; with an atomic <code>TestAndSet</code> instruction and an atomic <code>clear</code> instruction; it's possible to nominate a \"controlling philosopher\" in a fair manner; where the nominated controlling philosopher checks if both of their forks are free and decides if they can/can't eat, and then releases control.</p>\n\n<p>For example:</p>\n\n<pre><code>while(running) {\n    if(testAndSet(controllerFlag) == TRUE) {\n        if(nextController == ME) {\n            if(bothForksAreFree()) {\n                myNextState = EATING;\n                markBothForksInUse(ME);\n            } else {\n                myNextState = WAITING;\n            }\n            nextController = nextController + 1;\n            if(nextController &gt; MAX_CONTROLLERS) {\n                nextController = 0;\n            }\n        }\n        clear(controllerFlag);\n        if(myNextState == EATING) {\n            eat();\n            markBothForksFree(ME);\n            think();\n        }\n    }\n}\n</code></pre>\n\n<p>For data; this involves assigning each philosopher a unique and sequential number (e.g. 0 to N), the <code>controllerFlag</code>, plus a flag to represent the state of each fork (in use, free). The <code>markBothForksFree()</code> may need to use the \"atomic clear\" instruction, but everything else is guarded by <code>controllerFlag</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 11470348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd3581e69847ef2aec5eb1d45366eb93?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/11470348/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1557889161, "creation_date": 1557885683, "question_id": 56140841, "link": "https://stackoverflow.com/questions/56140841/dining-philosopherss-problem-with-test-set-instruction", "title": "Dining philosophers&#39;s problem with test-set instruction", "body": "<p>having test-set instruction defined as:</p>\n\n<pre><code>  function TestAndSet (var x: boolean): boolean;\n  begin\n    TestAndSet = x;\n    x = true\n  end;\n</code></pre>\n\n<p>is it possible to solve dining philosophers's problem ? And yes, I know that we can solve it using semaphores or monitors. </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557885799, "post_id": 56140686, "comment_id": 98911985, "body": "when asking a question about a run time problem, as this question is doing, please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> so we can reproduce the problem and help you debug it."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1557886112, "post_id": 56140686, "comment_id": 98912021, "body": "regarding: <code>Node N = D-&gt;head;  if(D == NULL){</code>  1) variable names should indicate <code>content</code> or <code>usage</code> (or better, both).  Names like <code>N</code> and <code>D</code> are meaningless.  2) if <code>D</code> is NULL, then accessing <code>D-&gt;head</code> is undefined behavior and will result in a seg fault event."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557886421, "post_id": 56140686, "comment_id": 98912071, "body": "OT:  for ease of readability and understanding: 1) please consistently indent the code.  Indent after EVERY opening brace &#39;{&#39;.  Unindent before EVERY closing brace &#39;}&#39;.  Suggest each indent level be 4 spaces.  2) include struct &amp; typedef definitions so readers can understand what is being reference.  3) use meaningful variable (and parameter) names 4) post the bodies of all your functions"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557886747, "post_id": 56140686, "comment_id": 98912120, "body": "in function: <code>lookup()</code>, regarding: <code>return N-&gt;value;</code>  per the variable naming, this would indicate a integer is being returned rather than a <code>char*</code>  Always post the data definitions"}], "answers": [{"tags": [], "owner": {"reputation": 27279, "user_id": 857132, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4fd51ed5980999c7c6ce3729d6cb2184?s=128&d=identicon&r=PG", "display_name": "John3136", "link": "https://stackoverflow.com/users/857132/john3136"}, "is_accepted": false, "score": 1, "last_activity_date": 1557886932, "last_edit_date": 1557886932, "creation_date": 1557884729, "answer_id": 56140739, "question_id": 56140686, "link": "https://stackoverflow.com/questions/56140686/error-in-c-segmentation-fault-with-method/56140739#56140739", "title": "Error in C; segmentation fault with method", "body": "<p>In the lookup() function</p>\n\n<pre><code> Node N = D-&gt;head;\n if(D == NULL){\n</code></pre>\n\n<p>You have already accessed D before checking if it is NULL. This could result in a NULL pointer accesss and core dump.</p>\n\n<p>In the insert() function:</p>\n\n<pre><code> while(S!=NULL) {\n    S = S-&gt;next;\n  }\n  // You are guaranteed that S is now == NULL, so the\n  // next line is a NULL pointer access.\n  S-&gt;next = newNode(k,v);\n</code></pre>\n\n<p>You need to keep the last item so you can say <code>last-&gt;next = newNode(k, v);</code></p>\n\n<p>Also: if there are 0 items in the collection, doesn't <code>numItems</code> get incremented twice? Hard to tell because of the bad code formatting...</p>\n\n<p>Additional comments: </p>\n\n<ul>\n<li>You obviously have typedefs for Dictionary and Node that hide the fact they are pointers. Don't do that. It makes it confusing for anyone reading the code.</li>\n<li>A very common convention is to start types with a capital letter but not variables, so <code>D</code>, <code>N</code> and <code>S</code> are all bad names. You can do better than 1 character names anyway. How about <code>dict</code> and <code>node</code></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11440434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3962b01ec9b99146123c9a3441e854f0?s=128&d=identicon&r=PG&f=1", "display_name": "user11440434", "link": "https://stackoverflow.com/users/11440434/user11440434"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1557886932, "creation_date": 1557884205, "question_id": 56140686, "link": "https://stackoverflow.com/questions/56140686/error-in-c-segmentation-fault-with-method", "title": "Error in C; segmentation fault with method", "body": "<p>So i'm having a segmentation error with this piece of code and i don't know why. i thought it had to do with the fact that I was using NULL wrong(?) but i don't think thats it. .I tried adding more error messages to see if I can go anywhere with that but I still get the same error /:</p>\n\n<pre><code>char* lookup(Dictionary D, char* k){\n   Node N = D-&gt;head;\n\n   if(D == NULL){\n    fprintf(stderr, \"Error: calling lookup() on null Dictionary\");\n    exit(EXIT_FAILURE);\n   }\n\n   while(N!=NULL){\n    if(strcmp(N-&gt;key,k)==0){\n      return N-&gt;value;\n      break;\n    }\n    N = N-&gt;next;\n   }\n   return NULL;\n}\n\n\nvoid insert(Dictionary D, char* k, char* v){\n  // Node N = D-&gt;head;\n\n   if(D==NULL){\n    fprintf(stderr, \"Error: inserting on a null Dictionary\\n\");\n    exit(EXIT_FAILURE);\n   }\n\n   if(lookup(D,k)!=NULL){\n    fprintf(stderr, \"already existing\\n\");\n    exit(EXIT_FAILURE);\n   }\n\n   else{\n\n     if(D-&gt;numItems==0){\n      Node N;\n      N = newNode(k,v);\n      D-&gt;head = N;\n      D-&gt;numItems++;\n     }\n\n    //if there is only a head node, add node after it\n   else{\n    Node S = D-&gt;head;\n      while(S!=NULL) {\n        S = S-&gt;next;\n      }\n      S-&gt;next = newNode(k,v);\n    }\n      D-&gt;numItems++;\n   }\n\n }\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 52186, "user_id": 1553090, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Wj4s1.png?s=128&g=1", "display_name": "paddy", "link": "https://stackoverflow.com/users/1553090/paddy"}, "edited": false, "score": 4, "creation_date": 1557882675, "post_id": 56140500, "comment_id": 98911449, "body": "<code>^</code> is the bitwise-XOR operator.  It does <i>not</i> perform exponentiation."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887033, "post_id": 56140500, "comment_id": 98912169, "body": "regarding: <code>#include &lt;conio.h&gt;</code>  The header file: <code>conio.h</code> is a nonstandard header, only found on windows.  Please make it a habit of using the standard IO function rather than the &#39;learner&#39; functions in <code>conio.h</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887204, "post_id": 56140500, "comment_id": 98912195, "body": "regarding: <code>main (){</code>  There are only two valid signatures for the <code>main()</code> function.  (regardless of what visual studio allows) They are: <code>int main( void )</code> and <code>int main( int argc, char *argv[] )</code>  Any modern compiler (which visual studio is not) will output a warning message about this problem"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887348, "post_id": 56140500, "comment_id": 98912220, "body": "OT: for ease of readability and understanding;  1) please consistently indent the code.  Indent after every opening brace &#39;{&#39;.  Unindent before every closing brace &#39;};&#39;.  Suggest each indent level be 4 spaces.  2) please follow the axion: <i>only one statement per line and (at most) one variable declaration per statement.</i>  Note: consider a closing brace &#39;}&#39;. as a separate statement."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887447, "post_id": 56140500, "comment_id": 98912234, "body": "OT: regarding: <code>scanf ( &quot;%d&quot; , &amp;end);</code>  The <code>scanf()</code> family of functions returns the number of successful input conversions.  Always check that returned number to assure the operation was successful.  I.E. <code>if( scanf ( &quot;%d&quot; , &amp;end) != 1 ) { &#47;&#47; handle error }</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887716, "post_id": 56140500, "comment_id": 98912279, "body": "regarding: <code>printf ( &quot; entered number needs to be greater than 1  &quot;)</code>  per the statement: <code>while ( end&lt;1);</code>  This is not true.  Rather any number &gt;=1 will end the loop"}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1557921285, "post_id": 56140500, "comment_id": 98926740, "body": "When the code first reaches <code>for(m=3 ;  m&lt;x ; m++ ) {</code>, <code>x</code> has not yet been assigned a value."}], "owner": {"reputation": 9, "user_id": 11501325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b0613597fb61de4c3f45353e16ec7b?s=128&d=identicon&r=PG&f=1", "display_name": "ddb", "link": "https://stackoverflow.com/users/11501325/ddb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557920796, "creation_date": 1557882171, "last_edit_date": 1557920796, "question_id": 56140500, "link": "https://stackoverflow.com/questions/56140500/program-to-compute-a-polynomial-equation", "title": "Program to compute a polynomial equation", "body": "<p>I need to wap  which asks user for input  of a natural num . - end</p>\n\n<p>The entered number needs to be greater than 1 . If the condition is not meet , show the user message  \" end needs to be greater than 1 \"  and then ask him again for the input using a loop . After  the correct input \nvalue ,  calculate for every number between 1 and variable end   , the following equations. </p>\n\n<p>Im unable to get correct output </p>\n\n<pre><code>x^4-2x^2+1-(x+1)^2          \nx(x-2)(x+1)^2\n</code></pre>\n\n<p>the  output should be  as follows        </p>\n\n<pre><code>x expression 1  expression 2 \n 1  -4         -4\n 2   0          0\n 3   48         48 \n     ...** \n</code></pre>\n\n<p><p></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nmain (){\nint v , x , end  ;\n\ndo {printf( \"enter a natural number  \");\n\nscanf  (  \"%d\", &amp;end);\nif  ( end &lt;1 ){\n\nprintf ( \" entered number needs to be greater than 1  \");\nscanf  (  \"%d\", &amp;end); }\n}   while ( end&lt;=1);  \n int arr [end];\n int m ;\n for(m=3 ;  m&lt;x ; m++ ) {\n\n for (x=1 ; x&lt;end ; x++)  \n\n  v= pow(x,4)- 2*(x,2)+1-((x+1),2);      \n  printf (\" %d\", v   );  \n\n\n   printf ( \"%d\",m );\n   printf (\"\\n\");\n\n   }}\n</code></pre>\n"}, {"tags": ["c++", "c", "lambda", "function-pointers", "sigint"], "comments": [{"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557878791, "post_id": 56140057, "comment_id": 98910786, "body": "Signal handles are global. How do you expect it to function if there&#39;s more than one instance of <code>MyClass</code>?"}, {"owner": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "reply_to_user": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557879090, "post_id": 56140057, "comment_id": 98910842, "body": "good point, there is likely to only be one instance of <code>MyClass</code> does this mean I can simply have the <code>sig_handler</code> be static?"}, {"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557879145, "post_id": 56140057, "comment_id": 98910858, "body": "Yes, and have a global pointer pointing to the only instance of <code>MyClass</code> that you have. Which also raises the question why you need it to be a class in the first place."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 0, "creation_date": 1557882735, "post_id": 56140057, "comment_id": 98911458, "body": "You can&#39;t take the address of a non-static member function because you cannot call a non-static member function without some specific instance of the class. See pointer-to-member-function for more explanation (although you can&#39;t use a PTMF as a C callback either). You can use a static member function, although that is morally equivalent to a global variable."}, {"owner": {"reputation": 55767, "user_id": 219159, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cxM6H.jpg?s=128&g=1", "display_name": "Seva Alekseyev", "link": "https://stackoverflow.com/users/219159/seva-alekseyev"}, "edited": false, "score": 0, "creation_date": 1557885604, "post_id": 56140057, "comment_id": 98911948, "body": "Are you allowed to use static class variables? They have global lifetime, if not global scope."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1557887829, "post_id": 56140057, "comment_id": 98912301, "body": "the posted code is C++, not C (they are two different languages)  please remove the &#39;c&#39; tag"}, {"owner": {"reputation": 148, "user_id": 1691072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bb628a9dd3b9b398f4cbba392a6bc73?s=128&d=identicon&r=PG", "display_name": "pratikpc", "link": "https://stackoverflow.com/users/1691072/pratikpc"}, "edited": false, "score": 0, "creation_date": 1614566494, "post_id": 56140057, "comment_id": 117415804, "body": "If you are allowed to use Asio, check out <a href=\"https://stackoverflow.com/questions/42342305/using-boost-asio-to-catch-ctrl-c\" title=\"using boost asio to catch ctrl c\">stackoverflow.com/questions/42342305/&hellip;</a> @Max"}], "answers": [{"comments": [{"owner": {"reputation": 60686, "user_id": 277176, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2678da280c230bccef9781b8e5fbaf80?s=128&d=identicon&r=PG", "display_name": "Yakov Galka", "link": "https://stackoverflow.com/users/277176/yakov-galka"}, "edited": false, "score": 0, "creation_date": 1557879227, "post_id": 56140160, "comment_id": 98910879, "body": "Upvoted. Though I think <code>epoll</code> and <code>kqueue</code> let you pass context with the event."}, {"owner": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "edited": false, "score": 0, "creation_date": 1557967481, "post_id": 56140160, "comment_id": 98947145, "body": "I ended up using static member variables for class this did the trick"}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1557884585, "last_edit_date": 1557884585, "creation_date": 1557878869, "answer_id": 56140160, "question_id": 56140057, "link": "https://stackoverflow.com/questions/56140057/c-capture-ctrlc-without-using-globals/56140160#56140160", "title": "c++ capture ctrl+c without using globals", "body": "<p>It is not possible to communicate between the signal handler and the rest of the program using local variables. No parameters are passed into the handler other than the raised signal and the handler returns no value.</p>\n\n<p>The words \"global variables\" are somewhat ambiguous. People sometimes mean different things depending on context. If your restriction applies only to the global scope, then simply use a <code>volatile sig_atomic_t</code> within some namespace. Or use static member variable, if you so prefer.</p>\n\n<p>If your restriction applies to static storage duration, then you can use a thread local variable instead.</p>\n\n<p>If your restriction applies to all global memory, then your problem is unsolvable using a signal handler. You simply need a global variable of some sort.</p>\n\n<hr>\n\n<p>If you can rely on POSIX rather than C++ standard, A way to handle <code>SIGINT</code> without globals is to make sure that it is <em>not</em> handled, and block the thread with <code>sigwait</code>. If the call returns <code>SIGINT</code>, then stop the program, otherwise do what you want to do with the signal that was caught.</p>\n\n<p>Of course, this means that the blocking thread doesn't do anything other than wait for signals. You'll need to do the actual work in other thread(s).</p>\n\n<p>Technically though, global memory is probably still used. The use is simply hidden inside system library.</p>\n\n<hr>\n\n<p>Furthermore, it is not safe to use <code>std::cout</code> within a signal handler. I know that is only an example, but <em>\"call the external library for cleanup\"</em> is very likely also async signal unsafe.</p>\n\n<p>This can be fixed simply by calling the cleanup outside the for loop rather than inside the handler.</p>\n\n<hr>\n\n<blockquote>\n  <p>The main problem is that I can't seem to setup the <code>signal()</code> declaration to bind to my instance of <code>MyClass::sig_handler</code>.</p>\n</blockquote>\n\n<p>That's because <code>signal</code> requires a function pointer (of type <code>void(int)</code>). Non-static member functions cannot be pointed by function pointers. They can only be pointed by member function pointers, which <code>signal</code> doesn't accept.</p>\n"}], "owner": {"reputation": 1661, "user_id": 5141619, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/eaaef6fdf502d7df2b2be002fa9ad51c?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/5141619/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1148, "favorite_count": 0, "accepted_answer_id": 56140160, "answer_count": 1, "score": 1, "last_activity_date": 1557884585, "creation_date": 1557878009, "last_edit_date": 1557878683, "question_id": 56140057, "link": "https://stackoverflow.com/questions/56140057/c-capture-ctrlc-without-using-globals", "title": "c++ capture ctrl+c without using globals", "body": "<p>I have simplified my example for an easier explanation. I am writing an application that counts to 100 but at any given time I allow the user to cancel the program by entering <code>ctrl+c</code> through the keyboard.</p>\n\n<p>What seemingly started as a simple program quickly became complicated based on my lack of knowledge on function pointers. This is what I'm attempting to do:</p>\n\n<ol>\n<li>Capture the SIGINT signal when <code>ctrl+c</code> is pressed.</li>\n<li>Once captured, call a member function that shuts down a third-party resource.</li>\n</ol>\n\n<p>The catch is that unlike the two examples that <a href=\"https://stackoverflow.com/a/48164204/5141619\">Michael Haidl</a> and <a href=\"https://stackoverflow.com/a/17766999/5141619\">Grijesh Chauhan</a> give on capturing <code>SIGINT</code>, I am not permitted to store any global variables. The ideal scenario is one in which all variables and function calls related to <code>signal()</code> are encapsulated within a class of mine.</p>\n\n<p>Here's my modified attempt based on <em>Haidl</em> and <em>Grijesh's</em> code:</p>\n\n<pre><code>#include &lt;thread&gt;\n#include &lt;chrono&gt;\n#include &lt;functional&gt;\n#include &lt;iostream&gt;\n#include &lt;signal.h&gt;\n\nclass MyClass {\n    public:\n        volatile sig_atomic_t cancel = 0;\n        void sig_handler(int signal) { \n            cancel = true; \n            this-&gt;libCancel();\n        }   \n        void libCancel() { std::cout &lt;&lt; \"Cancel and cleanup\" &lt;&lt; std::endl; }\n};\n\nint main(int argc, char *argv[]) {\n\n  MyClass mc; \n  //using std::placeholders::_1;\n  //std::function&lt;void(int)&gt; handler = std::bind(&amp;MyClass::sig_handler, mc, _1);\n  //signal(SIGINT, handler);\n  signal(SIGINT, &amp;mc.sig_handler); // **compiler error** \n\n  for (int i = 0; !mc.cancel &amp;&amp; i &lt; 100; ++i)\n  {\n      std::cout &lt;&lt; i &lt;&lt; std::endl;\n      std::this_thread::sleep_for(std::chrono::seconds(1));\n  }\n  return 0;\n}\n</code></pre>\n\n<p>As you can see, I'd like the code to simply count to 100 and exit if all goes well. But if the user calls <code>ctrl+c</code> then the class should handle <code>SIGINT</code>, call the external library for cleanup, and the <code>for</code> loop will exit.</p>\n\n<p><strong>The main problem is that I can't seem to setup the <code>signal()</code> declaration to bind to my instance of <code>MyClass::sig_handler</code>. I even tried casting my member function to <code>std::function</code> to be used by <code>signal()</code>, commented out, but the compiler isn't happy about the fact that C++ <code>function&lt;void(int)&gt;</code> isn't equivalent to the C lang <code>void (*)(int)</code>.</strong></p>\n\n<p>Any and all criticism is welcome. I'm not at all tied to what I've written and I clearly don't have a great fundamental understanding of how to use function pointers with member functions.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878172, "post_id": 56140049, "comment_id": 98910677, "body": "Pretty sure that restrict just makes it undefined and allows the compiler to do untraceable evil unto your code."}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878251, "post_id": 56140049, "comment_id": 98910690, "body": "@MichaelDorgan Yes, I also feared that the undefined behavior of my code tossed over a sack of rice in china each time I ran it."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878342, "post_id": 56140049, "comment_id": 98910708, "body": "<a href=\"https://www.geeksforgeeks.org/restrict-keyword-c/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/restrict-keyword-c</a>"}, {"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878462, "post_id": 56140049, "comment_id": 98910729, "body": "I had read that keeksforgeeks.org section and my preliminary conclusion was that it is better not to use that <code>restrict</code> keyword at all. Unless someone here convinces me otherwise :)"}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878675, "post_id": 56140049, "comment_id": 98910764, "body": "restrict can allow the compiler a few optimization advantages, but you have to be damn careful when using.  To the point where it becomes a magnet during code reviews..."}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 4, "last_activity_date": 1557878564, "creation_date": 1557878564, "answer_id": 56140128, "question_id": 56140049, "link": "https://stackoverflow.com/questions/56140049/can-the-restrict-qualifier-in-c-help-finding-bugs-due-to-overlapping-blocks/56140128#56140128", "title": "Can the `restrict` qualifier in C help finding bugs due to overlapping blocks?", "body": "<blockquote>\n  <p>Can I expect the compiler to be clever and use those <code>restrict</code>\n  adornments in such a case or are they making matters even worse (e.g.\n  by introducing undefined behavior)?</p>\n</blockquote>\n\n<p>The <code>restrict</code> qualifier serves primarily to give compilers license for optimization.  The only language <em>constraint</em> (whose violation requires a diagnostic) is that only object pointers may be <code>restrict</code>-qualified.  As a quality of implementation matter, you can hope that your compiler will diagnose violations of restrict qualification, but in practice, no compiler can guarantee to catch all violations.</p>\n"}], "owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 56140128, "answer_count": 1, "score": 2, "last_activity_date": 1557878564, "creation_date": 1557877937, "question_id": 56140049, "link": "https://stackoverflow.com/questions/56140049/can-the-restrict-qualifier-in-c-help-finding-bugs-due-to-overlapping-blocks", "title": "Can the `restrict` qualifier in C help finding bugs due to overlapping blocks?", "body": "<p>After reading up on the keyword <code>restrict</code>, I am a bit confused. It appears to only give a hint to the compiler for possibilities of optimizations. But not so much to find bugs or increase the expressiveness of the language.</p>\n\n<p>As all old time C programmers know, there is <code>memcpy()</code> and <code>memmove()</code>, the latter of those two promising to handle overlapping regions, the former promising not to handle it.</p>\n\n<p>Now, you can write the <code>restrict</code> keyword at function arguments, in structs and just stand alone with a pointer declaration.</p>\n\n<p>But I could not find any explanations, how it all is supposed to work if you have combinations of those applications in your code.</p>\n\n<p>Example:</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define SUCCESS 1\n#define FAILED 0\n\ntypedef int Ret_t;\n\nRet_t check( Ret_t result, const char * expr, int line, const char * file )\n{\n    if(FAILED == result)\n        printf(\"Expr: %s failed! (%s:%d)\\n\", expr, file,line);\n    return result;\n}\n\n\n#define CHECK(expr) (check(expr,#expr))\n#define CHECK_ABORT(expr) if(FAILED == check((expr),#expr,__LINE__,__FILE__)) return FAILED\n#define CHECK_ABORT_MAIN(expr) if(FAILED == check((expr),#expr,__LINE__,__FILE__)) return -1\n#define ARRAY_CAPACITY(x) (sizeof(x) / sizeof((x)[0]))\n\ntypedef struct Slice_uint8_tag\n{\n    uint8_t * restrict p;\n    size_t capacity;\n} Slice_uint8_t;\n\ntypedef struct const_Slice_uint8_tag\n{\n    const uint8_t * restrict p;\n    size_t size;\n} const_Slice_uint8_t;\n\nstatic inline\nSlice_uint8_t\nmake_Slice_uint8 (uint8_t* restrict p,size_t capacity)\n{\n    Slice_uint8_t s = { .p = p, .capacity = capacity };\n    return s;\n}\n\nstatic inline \nconst_Slice_uint8_t\nmake_const_Slice_uint8 (const uint8_t *restrict p, size_t size)\n{\n    const_Slice_uint8_t s = { .p = p, .size = size };\n    return s;\n}\n\nRet_t mm(Slice_uint8_t target, const_Slice_uint8_t source)\n{\n    if(target.capacity &gt;= source.size)\n    {\n        size_t i;\n        for(i = 0; i &lt; source.size; ++i)\n        {\n            target.p[i] = source.p[i];\n        }\n        return SUCCESS;\n    }\n    return FAILED;\n}\n\nint main()\n{\n    const char hello[] = \"Hello World!\";\n    unsigned char buffer[100];\n    unsigned char buffer1[100];\n\n    printf(\"hello array length: %ld\\nlength of hello string: %ld\\n\", ARRAY_CAPACITY(hello), strlen(hello));\n\n    CHECK_ABORT_MAIN(mm(make_Slice_uint8(buffer,ARRAY_CAPACITY(buffer)),make_const_Slice_uint8((const uint8_t*)hello,strlen(hello) + 1)));\n    printf( \"buffer after mm(): %s\\n\", buffer);\n\n    CHECK_ABORT_MAIN(mm(make_Slice_uint8(buffer1,ARRAY_CAPACITY(buffer1)),make_const_Slice_uint8(buffer,ARRAY_CAPACITY(buffer))));\n    printf( \"buffer1 after mm(): %s\\n\", buffer1);\n\n    // Now, lets see if `restrict` wins us something:\n    CHECK_ABORT_MAIN(mm(make_Slice_uint8(buffer1,ARRAY_CAPACITY(buffer1)),make_const_Slice_uint8(buffer1,ARRAY_CAPACITY(buffer1))));\n    printf( \"buffer1 after mm(): %s\\n\", buffer1);\n    return 0;\n}\n</code></pre>\n\n<p>The members <code>p</code> in both <code>Slice_uint8_t</code> and <code>const_Slice_uint8_t</code> are marked as <code>restrict</code>ed. And now the function <code>mm</code> takes 2 instances of those structs... and this raises my question:</p>\n\n<p>Can I expect the compiler to be clever and use those <code>restrict</code> adornments in such a case or are they making matters even worse (e.g. by introducing undefined behavior)?</p>\n\n<p>I compiled all that with: <code>gcc -std=c99 -Wall -O3 -o main *.c</code> and it compiled with 0 warnings, 0 errors.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 2721, "user_id": 8767209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f22597b536b07b41525099a8c16e23ce?s=128&d=identicon&r=PG&f=1", "display_name": "MFisherKDX", "link": "https://stackoverflow.com/users/8767209/mfisherkdx"}, "edited": false, "score": 6, "creation_date": 1557876646, "post_id": 56139891, "comment_id": 98910354, "body": "<code>if(registers[rsVariable] = registers[rtVariable])</code> --&gt; use double equals <code>==</code> to compare equality."}, {"owner": {"reputation": 1660, "user_id": 5501407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cz29B.jpg?s=128&g=1", "display_name": "R4444", "link": "https://stackoverflow.com/users/5501407/r4444"}, "edited": false, "score": 0, "creation_date": 1557876647, "post_id": 56139891, "comment_id": 98910356, "body": "<code>if(registers[rsVariable] == registers[rtVariable])</code> change to this"}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 5, "creation_date": 1557877183, "post_id": 56139891, "comment_id": 98910473, "body": "Configure your compiler to warn you about basic errors. If it is GCC or Clang, use <code>-Wall -Wextra</code>"}, {"owner": {"reputation": 13419, "user_id": 1405588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01a91a47db3526000ffa9247f95fff62?s=128&d=identicon&r=PG", "display_name": "o11c", "link": "https://stackoverflow.com/users/1405588/o11c"}, "edited": false, "score": 0, "creation_date": 1557878656, "post_id": 56139891, "comment_id": 98910761, "body": "Since MIPS is a fixed-size encoding, you can make <code>pc</code> a <code>uint32_t*</code> and avoid scaling the offset yourself."}], "owner": {"reputation": 19, "user_id": 9891144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1905270979492459/picture?type=large", "display_name": "Jack Holden", "link": "https://stackoverflow.com/users/9891144/jack-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557876437, "creation_date": 1557876437, "question_id": 56139891, "link": "https://stackoverflow.com/questions/56139891/how-would-i-code-this-particular-mips-operator-in-c", "title": "How would I code this particular MIPS operator in C?", "body": "<p>I'm creating a MIPS emulator using C, and I am trying to create the method for BEQ and BNE, however the actions are confusing me. Below are the actions that are performed in MIPS and then how I've interpreted them, which is apparently incorrect. </p>\n\n<p><strong>BEQ if(rs==rt) pc+=offset*4</strong></p>\n\n<pre><code>//beq\n            else if(opCodeType == 4)\n            {\n                if(registers[rsVariable] = registers[rtVariable])\n                {\n                    pc = pc + offset*4;\n                }\n            } \n</code></pre>\n\n<p><strong>BNE if(rs!=rt) pc+=offset*4</strong> </p>\n\n<pre><code>//bne \n            else if(opCodeType == 5)\n            {\n                if(registers[rsVariable] != registers[rtVariable])\n                {\n                    pc = pc + offset*4;\n                }\n            } \n</code></pre>\n\n<p>All help is very much appreciated as this is the final piece to the puzzle!</p>\n"}, {"tags": ["c", "multithreading", "deadlock", "semaphore", "dining-philosopher"], "comments": [{"owner": {"reputation": 15415, "user_id": 982257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pRf2i.jpg?s=128&g=1", "display_name": "Iguananaut", "link": "https://stackoverflow.com/users/982257/iguananaut"}, "edited": false, "score": 0, "creation_date": 1557875461, "post_id": 56139704, "comment_id": 98910119, "body": "I guess you still have a race condition somewhere."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878798, "post_id": 56139704, "comment_id": 98910787, "body": "Captain Obvious is obvious.  Neither of our comments are helping out the new contributor though."}, {"owner": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557878891, "post_id": 56139704, "comment_id": 98910804, "body": "It could be that a few well place printf()s could show you the problem, or they made hide the Heisenbug.  I&#39;d still try it though to help you marrow it down (or better yet, use a debugger that helps with these types of issues.)"}, {"owner": {"reputation": 37, "user_id": 11501047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007a630106d04ffa6cb05f14e497c4bf?s=128&d=identicon&r=PG&f=1", "display_name": "Chris F.", "link": "https://stackoverflow.com/users/11501047/chris-f"}, "reply_to_user": {"reputation": 12073, "user_id": 527574, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/e5b251b4ac8f0cb7942587ee8077cddb?s=128&d=identicon&r=PG", "display_name": "Michael Dorgan", "link": "https://stackoverflow.com/users/527574/michael-dorgan"}, "edited": false, "score": 0, "creation_date": 1557879605, "post_id": 56139704, "comment_id": 98910940, "body": "@MichaelDorgan actually there is a trace file that is made when running the code where it shows me the semaphore values and where the threads get stuck but it takes up quite a bit of space which is why I have not posted it. I could post the last bit of the trace where the program thinks it has hit a deadlock if that helps."}], "answers": [{"comments": [{"owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "reply_to_user": {"reputation": 37, "user_id": 11501047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007a630106d04ffa6cb05f14e497c4bf?s=128&d=identicon&r=PG&f=1", "display_name": "Chris F.", "link": "https://stackoverflow.com/users/11501047/chris-f"}, "edited": false, "score": 1, "creation_date": 1557882478, "post_id": 56140423, "comment_id": 98911409, "body": "For a hint; if you assume that at least one philosopher is a left handed ( thus picks up right, then left), the illustrated problem will take care of itself."}], "tags": [], "owner": {"reputation": 8402, "user_id": 4664415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hsfxj.jpg?s=128&g=1", "display_name": "mevets", "link": "https://stackoverflow.com/users/4664415/mevets"}, "is_accepted": true, "score": 2, "last_activity_date": 1557881435, "creation_date": 1557881435, "answer_id": 56140423, "question_id": 56139704, "link": "https://stackoverflow.com/questions/56139704/deadlocks-in-c-with-semaphores/56140423#56140423", "title": "Deadlocks in C with semaphores", "body": "<p>The classic Dining Philosophers problem has N philosophers and N forks; but each needs 2 forks to eat.   A given fork semaphore may have a maximum value of 1 [ available ], and a minimum value of -1 ( one has the fork, one is waiting on the fork ).   Your forks have values of 10 and 20?</p>\n\n<p>In your logic, you check the value of the semaphore, and if it is >= 0, you say that you \u201chave it\u201d, then go on to check the other one; but you don\u2019t have it.   You don\u2019t have a semaphore until you have <em>wait</em>ed on it.   After eat()ing, you post to both of them, even though you may not have ever waited on either of them.  That is why you have insanely high values for the semaphores.</p>\n\n<p>Secondly, by the time <em>sem_get_value</em> has returned, the value of the semaphore may have changed.   This is a common synchronization problem, so common it has a name: TOCTOU (Time Of Check to Time Of Use).   You need to use mechanisms where you make decisions based upon actions, not just checking the status.</p>\n\n<p>Third, one you change this to effectively sit in a loop:</p>\n\n<pre><code>  sem_wait(left);\n  sem_wait(right);\n  eat();\n  sem_post(right);\n  sem_post(left);\n</code></pre>\n\n<p>You will have a completely different synchronization problem, which is the one that the Dining Philosophers is meant to illustrate.   Happy Hunting!</p>\n"}], "owner": {"reputation": 37, "user_id": 11501047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/007a630106d04ffa6cb05f14e497c4bf?s=128&d=identicon&r=PG&f=1", "display_name": "Chris F.", "link": "https://stackoverflow.com/users/11501047/chris-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1118, "favorite_count": 0, "accepted_answer_id": 56140423, "answer_count": 1, "score": 2, "last_activity_date": 1557890675, "creation_date": 1557874898, "last_edit_date": 1557890675, "question_id": 56139704, "link": "https://stackoverflow.com/questions/56139704/deadlocks-in-c-with-semaphores", "title": "Deadlocks in C with semaphores", "body": "<p>I have an assignment about deadlocks for a Dining Philosophers program. I am asked to make a file called \"sections1.c\" that has a deadlock issue and after completing creating a deadlock, I am to copy the code and solve the deadlock condition in a file \"sections2.c\". My teacher is having us program with MDAT. The MDAT should run just like semaphores and pthread functions as he gave us this on the MDAT guide.</p>\n\n<pre><code>void mdat_mutex_init(const char *name, pthread_mutex_t *lock,\npthread_mutexattr_t *attr);\n\nvoid mdat_mutex_lock(pthread_mutex_t *lp);\n\nvoid mdat_mutex_unlock(pthread_mutex_t *lp);\n\nvoid mdat_sem_init(const char *name, sem_t *sem, int pshared, int value);\n\nvoid mdat_sem_wait(sem_t *sp);\n\nvoid mdat_sem_post(sem_t *sp);\n</code></pre>\n\n<p>The MDAT supposedly takes responsibility of the scheduler and schedules the treads randomly by seeding the current time when run.</p>\n\n<p>In the main file, which I am not allowed to edit, the function sectionInitGlobals runs once and sectionRunPhilosopher runs once with each pthread_create.</p>\n\n<p>A problem could be that I have never used semaphores before, and am using them incorrectly.</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>//  sections1.c: mutual exclusion model sections\n\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include \"sections.h\"\n#include \"mdat.h\"\n\n// TODO: Declare shared variables here\nint numPhils;\nsem_t * sem_arr;\n\nvoid sectionInitGlobals(int numPhilosophers)\n{\n  // TODO: Complete this function\n  int i;\n\n  char char_arr[50];\n\n  sem_t arr[numPhilosophers];\n\n  numPhils = numPhilosophers;\n\n  for(i = 0; i &lt; numPhilosophers; i++)\n  {\n    sprintf(char_arr,\"%d\", i);\n    mdat_sem_init(char_arr, &amp;arr[i], 0, 0);\n  }\n\n  sem_arr = arr;\n}\n\nvoid sectionRunPhilosopher(int philosopherID, int numRounds)\n{\n  int lChopstick = philosopherID;\n  int rChopstick;\n\n  int left;\n  int right;\n\n  int i;\n  int hasEaten;\n  int hasLeft;\n  int hasRight;\n\n  if(philosopherID == 0)\n    rChopstick = numPhils - 1;\n  else\n    rChopstick = philosopherID - 1;\n\n  for(i = 0; i &lt; numRounds; i++)\n  {\n    hasEaten = 0;\n    hasLeft = 0;\n    hasRight = 0;\n\n    while(hasEaten == 0)\n    {\n      sem_getvalue(&amp;sem_arr[lChopstick], &amp;left);\n      if(left &gt;= 0 || hasLeft == 1)\n      {\n        hasLeft = 1;\n      }\n      else\n      {\n        mdat_sem_wait(&amp;sem_arr[lChopstick]);\n      }\n\n      sem_getvalue(&amp;sem_arr[rChopstick], &amp;right);\n      if(right &gt;= 0 &amp;&amp; hasLeft != 0)\n      {\n        hasRight = 1;\n      }\n      else\n      {\n        mdat_sem_wait(&amp;sem_arr[rChopstick]);\n      }\n\n      if(hasLeft != 0 &amp;&amp; hasRight != 0)\n      {\n        eat();\n        hasEaten = 1;\n        mdat_sem_post(&amp;sem_arr[lChopstick]);\n        mdat_sem_post(&amp;sem_arr[rChopstick]);\n      }\n    }\n\n    think();\n  }\n}\n</code></pre>\n\n<p>When testing my code I get to run it with any number of threads and rounds that I want, however, it seems that with more threads the deadlock is guaranteed. When I run the code with 100 threads it reaches a deadlock every time, but with more threads shouldn't it have a less chance of reaching a deadlock?</p>\n\n<p>Results:</p>\n\n<p>With 16 threads and 10 rounds, the deadlock sometimes depending on the scheduler.</p>\n\n<p>With 6 threads and 5 rounds, the deadlock occurs 0% of the time.</p>\n\n<p>With 100 threads and 5 rounds, the deadlock occurs 100% of the time.</p>\n\n<p>Edit:</p>\n\n<p>End of trace files when no deadlock occurs and when program thinks deadlock occurs:</p>\n\n<p>No Deadlock:</p>\n\n<pre><code>THREAD: 3\nSECTION: DoneRounds\nMESSAGE: Thread 3 has completed\n*******************************************************************************\n|ID   |PROPERTY     |LOC  |SECTION      |STATUS       |WAITING ON             |\n|0    |0            |19   |             |completed    |                       |\n|1    |1            |19   |             |completed    |                       |\n|2    |2            |19   |             |completed    |                       |\n|3    |3            |19   |             |completed    |                       |\n|4    |4            |19   |             |completed    |                       |\n|5    |5            |19   |             |completed    |                       |\n|6    |6            |19   |             |completed    |                       |\n|7    |7            |19   |             |completed    |                       |\n|8    |8            |19   |             |completed    |                       |\n|9    |9            |19   |             |completed    |                       |\n|10   |10           |19   |             |completed    |                       |\n|11   |11           |19   |             |completed    |                       |\n|12   |12           |19   |             |completed    |                       |\n|13   |13           |19   |             |completed    |                       |\n|14   |14           |19   |             |completed    |                       |\n|15   |15           |19   |             |completed    |                       |\n-------------------------------------------------------------------------------\n|LOCK NAME                |STATUS       |WAITING THREADS                      |\n|lock_a                   |unlocked     |                                     |\n|lock_b                   |unlocked     |                                     |\n-------------------------------------------------------------------------------\n|SEMAPHORE NAME           |VALUE        |WAITING THREADS                      |\n|0                        |20           |                                     |\n|1                        |20           |                                     |\n|2                        |20           |                                     |\n|3                        |20           |                                     |\n|4                        |20           |                                     |\n|5                        |20           |                                     |\n|6                        |20           |                                     |\n|7                        |20           |                                     |\n|8                        |20           |                                     |\n|9                        |20           |                                     |\n|10                       |20           |                                     |\n|11                       |20           |                                     |\n|12                       |20           |                                     |\n|13                       |20           |                                     |\n|14                       |20           |                                     |\n|15                       |20           |                                     |\n*******************************************************************************\n***** Program Trace End *****\n</code></pre>\n\n<p>Deadlock:</p>\n\n<pre><code>THREAD: 13\nSECTION: DoneRounds\nMESSAGE: Thread 13 has completed\n*******************************************************************************\n|ID   |PROPERTY     |LOC  |SECTION      |STATUS       |WAITING ON             |\n|0    |0            |19   |             |completed    |                       |\n|1    |1            |32   |             |waiting-sem  |1                      |\n|2    |2            |32   |             |waiting-sem  |2                      |\n|3    |3            |38   |             |waiting-sem  |2                      |\n|4    |4            |19   |             |completed    |                       |\n|5    |5            |19   |             |completed    |                       |\n|6    |6            |19   |             |completed    |                       |\n|7    |7            |19   |             |completed    |                       |\n|8    |8            |19   |             |completed    |                       |\n|9    |9            |32   |             |waiting-sem  |9                      |\n|10   |10           |38   |             |waiting-sem  |9                      |\n|11   |11           |19   |             |completed    |                       |\n|12   |12           |19   |             |completed    |                       |\n|13   |13           |19   |             |completed    |                       |\n|14   |14           |19   |             |completed    |                       |\n|15   |15           |19   |             |completed    |                       |\n-------------------------------------------------------------------------------\n|LOCK NAME                |STATUS       |WAITING THREADS                      |\n|lock_a                   |unlocked     |                                     |\n|lock_b                   |unlocked     |                                     |\n-------------------------------------------------------------------------------\n|SEMAPHORE NAME           |VALUE        |WAITING THREADS                      |\n|0                        |10           |                                     |\n|1                        |-1           |1                                    |\n|2                        |-2           |2 3                                  |\n|3                        |10           |                                     |\n|4                        |20           |                                     |\n|5                        |20           |                                     |\n|6                        |20           |                                     |\n|7                        |20           |                                     |\n|8                        |10           |                                     |\n|9                        |-2           |9 10                                 |\n|10                       |10           |                                     |\n|11                       |20           |                                     |\n|12                       |20           |                                     |\n|13                       |20           |                                     |\n|14                       |20           |                                     |\n|15                       |20           |                                     |\n*******************************************************************************\nERROR! VIOLATION: No ready threads to schedule - possible DEADLOCK\n***** Program Trace End *****\n</code></pre>\n\n<hr>\n\n<h2>Edit After Answer</h2>\n\n<p>Thanks to mevets!\nFinal Code:\nsection1.c - Want deadlock</p>\n\n<pre><code>//  sections1.c: mutual exclusion model sections\n\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include \"sections.h\"\n#include \"mdat.h\"\n\n// TODO: Declare shared variables here\nint numPhils;\nsem_t * sem_arr;\n\nvoid sectionInitGlobals(int numPhilosophers)\n{\n  // TODO: Complete this function\n  int i;\n\n  char char_arr[50];\n\n  sem_t arr[numPhilosophers];\n\n  numPhils = numPhilosophers;\n\n  for(i = 0; i &lt; numPhilosophers; i++)\n  {\n    sprintf(char_arr,\"%d\", i);\n    mdat_sem_init(char_arr, &amp;arr[i], 0, 1);\n  }\n\n  sem_arr = arr;\n}\n\nvoid sectionRunPhilosopher(int philosopherID, int numRounds)\n{\n  int lChop = philosopherID;\n  int rChop;\n\n  int i;\n\n  if(philosopherID == 0)\n    rChop = numPhils - 1;\n  else\n    rChop = philosopherID - 1;\n\n  for(i = 0; i &lt; numRounds; i++)\n  {\n    mdat_sem_wait(&amp;sem_arr[lChop]);\n    mdat_sem_wait(&amp;sem_arr[rChop]);\n    eat();\n    mdat_sem_post(&amp;sem_arr[rChop]);\n    mdat_sem_post(&amp;sem_arr[lChop]);\n\n    think();\n  }\n}\n</code></pre>\n\n<p>section2.c - Do NOT want deadlock</p>\n\n<pre><code>//  sections1.c: mutual exclusion model sections\n\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;semaphore.h&gt;\n#include \"sections.h\"\n#include \"mdat.h\"\n\n// TODO: Declare shared variables here\nint numPhils;\nsem_t * sem_arr;\n\nvoid sectionInitGlobals(int numPhilosophers)\n{\n  // TODO: Complete this function\n  int i;\n\n  char char_arr[50];\n\n  sem_t arr[numPhilosophers];\n\n  numPhils = numPhilosophers;\n\n  for(i = 0; i &lt; numPhilosophers; i++)\n  {\n    sprintf(char_arr,\"%d\", i);\n    mdat_sem_init(char_arr, &amp;arr[i], 0, 1);\n  }\n\n  sem_arr = arr;\n}\n\nvoid sectionRunPhilosopher(int philosopherID, int numRounds)\n{\n  int lChop = philosopherID;\n  int rChop;\n\n  int i;\n\n  if(philosopherID == 0)\n    rChop = numPhils - 1;\n  else\n    rChop = philosopherID - 1;\n\n  for(i = 0; i &lt; numRounds; i++)\n  {\n    if(philosopherID != numPhils - 1)\n    {\n      mdat_sem_wait(&amp;sem_arr[lChop]);\n      mdat_sem_wait(&amp;sem_arr[rChop]);\n      eat();\n      mdat_sem_post(&amp;sem_arr[rChop]);\n      mdat_sem_post(&amp;sem_arr[lChop]);\n    }\n    else\n    {\n      mdat_sem_wait(&amp;sem_arr[rChop]);\n      mdat_sem_wait(&amp;sem_arr[lChop]);\n      eat();\n      mdat_sem_post(&amp;sem_arr[lChop]);\n      mdat_sem_post(&amp;sem_arr[rChop]);\n    }\n\n    think();\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "parallel-processing", "mpi", "memory-address"], "comments": [{"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1557878368, "post_id": 56139633, "comment_id": 98910713, "body": "at first glance that sounds correct. I&#39;d rather use the <code>offsetof()</code> macro or the <code>MPI_Aint_diff()</code> function in order to populate the <code>disp</code> array, and that being said, this is unlikely the root cause of your problem. You will more likely receive some help if you edit your question with a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (since the issue might be in the code you did not post)"}, {"owner": {"reputation": 7287, "user_id": 8062491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rd6rD.png?s=128&g=1", "display_name": "Gilles Gouaillardet", "link": "https://stackoverflow.com/users/8062491/gilles-gouaillardet"}, "edited": false, "score": 0, "creation_date": 1557878638, "post_id": 56139633, "comment_id": 98910758, "body": "as a matter of style and performance, you do not need the <code>for</code> loop at all since you can broadcast <code>n_node</code> elements at once (and that being said, you might have to <code>MPI_Type_create_resized()</code> the derived datatype to accomodate padding the compiler could have added). In any case, the <code>node</code> derived datatype (creation and destruction) can be moved outside of the <code>for</code> loop."}], "owner": {"reputation": 155, "user_id": 11069485, "user_type": "registered", "profile_image": "https://graph.facebook.com/2642664675749312/picture?type=large", "display_name": "Chris Wong", "link": "https://stackoverflow.com/users/11069485/chris-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1557874337, "creation_date": 1557874337, "question_id": 56139633, "link": "https://stackoverflow.com/questions/56139633/use-of-mpi-type-struct-and-mpi-bcast-to-communicate-a-data-structure-in-c", "title": "Use of MPI_Type_struct and MPI_Bcast to communicate a data structure in C", "body": "<p>I have a data structure that I am building in series, i.e, on <code>rank = 0</code> using MPI:</p>\n\n<pre><code>typedef struct node {\n  int nodeID,\n  dof_u, dof_v, dof_theta ;\n  double x, y ;\n  char BC[8] ;\n} node ;\n</code></pre>\n\n<p>I then fill in this structure for an array of 4 \"nodes\" in the following manner:</p>\n\n<pre><code>  int n_node = 4 ;\n  int n_dof = 3*n_node ;\n  node *nodes = malloc(sizeof(node) * n_node) ;\n\n  if (rank == 0) {\n    nodes[0].nodeID = 0 ;\n    nodes[0].dof_u = 0 ; nodes[0].dof_v = 1 ; nodes[0].dof_theta = 2 ;\n    nodes[0].x = 0. ; nodes[0].y = 0. ;\n\n    nodes[1].nodeID = 1 ;\n    nodes[1].dof_u = 3 ; nodes[1].dof_v = 4 ; nodes[1].dof_theta = 5 ;\n    nodes[1].x = 0. ; nodes[1].y = 12. * 12. ;\n\n    nodes[2].nodeID = 2 ;\n    nodes[2].dof_u = 6 ; nodes[2].dof_v = 7 ; nodes[2].dof_theta = 8 ;\n    nodes[2].x = 9. * 12. ; nodes[2].y = 12. * 12. ;\n\n    nodes[3].nodeID = 3 ;\n    nodes[3].dof_u = 9 ; nodes[3].dof_v = 10 ; nodes[3].dof_theta = 11 ;\n    nodes[3].x = 9. * 12. ; nodes[3].y = 0. ;\n</code></pre>\n\n<p>This worked in in series, before I added any MPI stuff. Of course, my problem now that I am using MPI is that all of this information only lives on proc 0, but I want to communicate it to all procs using <code>MPI_Bcast</code>. First, I created an <code>MPI_Datatype</code> to be able to pass to <code>MPI_Bcast</code>. Then I used <code>MPI_Address</code> in order to determine the <code>MPI_Aint</code> array that I need to create an <code>MPI_Type_struct</code> for my <code>node</code> <code>struct</code>.</p>\n\n<p>My current implementation is bugged, i.e., the data is not being communicated to all procs:</p>\n\n<pre><code>    for (int i = 0 ; i &lt; n_node ; i++) {\n      MPI_Datatype node ;\n      MPI_Datatype type[7] = {MPI_INT, MPI_INT, MPI_INT, MPI_INT,\n                              MPI_DOUBLE, MPI_DOUBLE, MPI_CHAR} ;\n      int blocklen[7] = {1, 1, 1, 1, 1, 1, 8} ;\n      MPI_Aint disp[7] ;\n\n      MPI_Address(&amp;nodes[i].nodeID, &amp;disp[0]) ;\n      MPI_Address(&amp;nodes[i].dof_u, &amp;disp[1]) ;\n      MPI_Address(&amp;nodes[i].dof_v, &amp;disp[2]) ;\n      MPI_Address(&amp;nodes[i].dof_theta, &amp;disp[3]) ;\n      MPI_Address(&amp;nodes[i].x, &amp;disp[4]) ;\n      MPI_Address(&amp;nodes[i].y, &amp;disp[5]) ;\n      MPI_Address(&amp;nodes[i].BC, &amp;disp[6]) ;\n\n      disp[6] = disp[6] - disp[0] ;\n      disp[5] = disp[5] - disp[0] ;\n      disp[4] = disp[4] - disp[0] ;\n      disp[5] = disp[3] - disp[0] ;\n      disp[2] = disp[2] - disp[0] ;\n      disp[1] = disp[1] - disp[0] ;\n      disp[0] = 0 ;\n\n      MPI_Type_struct(7, blocklen, disp, type, &amp;node) ;\n      MPI_Type_commit(&amp;node) ;\n\n      MPI_Bcast(&amp;nodes[i], 1, node, 0, MPI_COMM_WORLD) ;\n\n      MPI_Type_free(&amp;node) ;\n    }\n</code></pre>\n\n<p>Does anyone see anything obviously wrong with what I have done here? Perhaps I am calculating the relative offsets incorrectly, or this can't be done in a <code>for</code> loop? I'm not sure. I have no prior experience with this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557871114, "post_id": 56139144, "comment_id": 98909026, "body": "You are increasing the variables that you are comparing to. So how will the conditions end the loops? There is no syntax error, just a conceptual one."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1557871225, "post_id": 56139144, "comment_id": 98909060, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for tips on debugging your code. Also, get a piece of paper and a pencil. Mentally step through each line of code one at a time and write down the values of each variable."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557871477, "post_id": 56139144, "comment_id": 98909133, "body": "I don&#39;t see the point of <code>return(0);</code> Would <code>printf(&quot;\\n&quot;);</code> be better, once the loops are fixed?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1557871628, "post_id": 56139144, "comment_id": 98909172, "body": "Did you mis-post the code, or did you change it in reponse to comments? If the latter, please don&#39;t do that, because the question asked is now pointless, apart from needing to reset <code>j</code> to the original value at the start of the inner loop."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557873605, "post_id": 56139144, "comment_id": 98909700, "body": "It should be <code>int main(void)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 552, "user_id": 11038454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/118900695ae8e562f696c0dd14feb0d7?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/11038454/tony"}, "is_accepted": false, "score": 0, "last_activity_date": 1557871403, "creation_date": 1557871403, "answer_id": 56139230, "question_id": 56139144, "link": "https://stackoverflow.com/questions/56139144/shape-matrix-helpkeeps-crashing/56139230#56139230", "title": "shape matrix help(keeps crashing)", "body": "<h1>include </h1>\n\n<pre><code>int main ()\n{\n    int row, col;\n\n    printf(\"How many rows?\\n\");\n    scanf(\"%d\", &amp;row);\n    printf(\"How many columns?\\n\");\n    scanf(\"%d\", &amp;col);\n\n    int i=0,j=0;\n\n    while (i&lt;row)\n    {\n        i++;\n\n        j = 0;\n        while(j &lt; col)\n        {\n            printf(\"$\");\n            j++;\n        }\n//         return(0); you don't need a return here\n    }\n}\n</code></pre>\n\n<p>or, use for loop will be better</p>\n\n<pre><code>for (int i = 0; i &lt; row; ++i)\n{\n    for (int j = 0; j &lt; col; ++j)\n        printf(\"$\");\n}\n</code></pre>\n\n<p>Also, validate the row and col before use them will be a good idea</p>\n\n<pre><code>if (row &lt; 0 || row &gt; YourRowCount || col &lt; 0 || col &gt; YourColCount)\n{\n    printf(\"Error row / col: %d,%d\\n\", row, col);\n    exit(-1);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557876950, "post_id": 56139672, "comment_id": 98910423, "body": "You&#39;re Initializing twice the loop iterators. Consider using <code>for (int i = 0; i &lt; rows; i++)</code>"}, {"owner": {"reputation": 31, "user_id": 10540038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aN6BOphd1lc/AAAAAAAAAAI/AAAAAAAAACA/tA6rAz3BD9o/photo.jpg?sz=128", "display_name": "Hafeez Ul Haq Ahsaas", "link": "https://stackoverflow.com/users/10540038/hafeez-ul-haq-ahsaas"}, "reply_to_user": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557877318, "post_id": 56139672, "comment_id": 98910508, "body": "as for your second comment you&#39;re right about the 1 maximum iteration, but for your first comment you can&#39;t really pass void as a parameter to main(). Thanks"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557877518, "post_id": 56139672, "comment_id": 98910557, "body": "The <code>void</code> means that <b>no</b> parameters are accepted. A function should be well-defined."}, {"owner": {"reputation": 31, "user_id": 10540038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aN6BOphd1lc/AAAAAAAAAAI/AAAAAAAAACA/tA6rAz3BD9o/photo.jpg?sz=128", "display_name": "Hafeez Ul Haq Ahsaas", "link": "https://stackoverflow.com/users/10540038/hafeez-ul-haq-ahsaas"}, "edited": false, "score": 0, "creation_date": 1557940440, "post_id": 56139672, "comment_id": 98938345, "body": "Edited again, have a look please!"}], "tags": [], "owner": {"reputation": 31, "user_id": 10540038, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-aN6BOphd1lc/AAAAAAAAAAI/AAAAAAAAACA/tA6rAz3BD9o/photo.jpg?sz=128", "display_name": "Hafeez Ul Haq Ahsaas", "link": "https://stackoverflow.com/users/10540038/hafeez-ul-haq-ahsaas"}, "is_accepted": false, "score": 0, "last_activity_date": 1557940395, "last_edit_date": 1557940395, "creation_date": 1557874646, "answer_id": 56139672, "question_id": 56139144, "link": "https://stackoverflow.com/questions/56139144/shape-matrix-helpkeeps-crashing/56139672#56139672", "title": "shape matrix help(keeps crashing)", "body": "<p>You're returning from loop it it's first cycle with <code>return(0)</code>!</p>\n\n<p>Also if you are allowed to use <code>for</code> loop you can simply do it like:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main (void)\n{\n    int row, col;\n\n    printf(\"How many rows?\\n\");\n    scanf(\"%d\", &amp;row);\n    printf(\"How many columns?\\n\");\n    scanf(\"%d\", &amp;col);\n\n    int i = 0, j = 0;\n\n    for (i = 0; i &lt; row; i++) {\n        for (j = 0; j &lt; col; j++) {\n            printf(\"$\");\n        }\n        printf(\"\\n\");\n    }\n\n    getch();\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10501138, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6p_bh1sE96Y/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXfEl5N7nhDFd8gGuzUqORTNQnIDA/mo/photo.jpg?sz=128", "display_name": "cisc_programmer123", "link": "https://stackoverflow.com/users/10501138/cisc-programmer123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557940395, "creation_date": 1557870898, "last_edit_date": 1557871255, "question_id": 56139144, "link": "https://stackoverflow.com/questions/56139144/shape-matrix-helpkeeps-crashing", "title": "shape matrix help(keeps crashing)", "body": "<p>I am trying to print a matrix of shapes, but my program continues to crash. what is wrong with my code?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int row, col;\n\n    printf(\"How many rows?\\n\");\n    scanf(\"%d\", &amp;row);\n    printf(\"How many columns?\\n\");\n    scanf(\"%d\", &amp;col);\n\n    int i=0,j=0;\n\n    while (i&lt;row)\n    {\n        i ++;\n\n        while(j &lt; col)\n\n        {\n            printf(\"$\");\n            j ++;\n        }\n        return(0);\n    }\n}\n</code></pre>\n\n<p>I have tried trouble shooting by initializing the counters, and trying to find syntax error. Also how can i become better at trouble shooting? I am an entry level C Programmer.</p>\n"}, {"tags": ["c", "timer", "stm32", "pwm", "stm32f4"], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": true, "score": 1, "last_activity_date": 1557870586, "creation_date": 1557870586, "answer_id": 56139098, "question_id": 56138951, "link": "https://stackoverflow.com/questions/56138951/can-a-pwm-signal-be-provided-by-only-one-channel-on-one-timer/56139098#56139098", "title": "Can a pwm signal be provided by only one channel on one timer?", "body": "<p>no. as many as supported by the timer. PWM  channels using the same timer will have the same frequency.</p>\n"}], "owner": {"reputation": 13, "user_id": 11396767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gewu6.jpg?s=128&g=1", "display_name": "lcpdeb", "link": "https://stackoverflow.com/users/11396767/lcpdeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 56139098, "answer_count": 1, "score": 1, "last_activity_date": 1557878880, "creation_date": 1557869749, "last_edit_date": 1557878880, "question_id": 56138951, "link": "https://stackoverflow.com/questions/56138951/can-a-pwm-signal-be-provided-by-only-one-channel-on-one-timer", "title": "Can a pwm signal be provided by only one channel on one timer?", "body": "<p>I initialized PWM configuration in 4 channels on a timer, but only the last channel I set works. Does that mean only 1 channel can work at a time?</p>\n"}, {"tags": ["c", "string", "comparison"], "comments": [{"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 3, "creation_date": 1557869691, "post_id": 56138902, "comment_id": 98908596, "body": "<code>&#39;+&#39;</code> is a small integer, not a pointer to the first element of a NUL-terminated array of <code>char</code>. That would be <code>&quot;+&quot;</code>."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1557870128, "post_id": 56138902, "comment_id": 98908749, "body": "You should be getting all sorts of compilation warnings from your compiler \u2014 about not passing pointers to <code>strcmp()</code> or converting integers to pointers.  If you are getting such compiler warnings, you should deal with them before asking on SO, or ask about how to resolve the compiler warnings if you don&#39;t understand them.  If you&#39;re not getting such warnings, you need to learn how to make your compiler give you warnings, and always use those options.  With GCC, consider using <code>-std=c11 -Werror -Wall -Wextra -Wmissing-prototypes -Wstrict-prototypes</code>."}, {"owner": {"reputation": 3, "user_id": 11132991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3RuLz_F-iqY/AAAAAAAAAAI/AAAAAAAAACU/lepv9UPzt6w/photo.jpg?sz=128", "display_name": "Maska", "link": "https://stackoverflow.com/users/11132991/maska"}, "edited": false, "score": 0, "creation_date": 1557870686, "post_id": 56138902, "comment_id": 98908919, "body": "thenk and sorry for asking a dump question"}, {"owner": {"reputation": 5295, "user_id": 2513200, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3d4b041c512a4e708a42494eb465b40f?s=128&d=identicon&r=PG", "display_name": "Hulk", "link": "https://stackoverflow.com/users/2513200/hulk"}, "edited": false, "score": 2, "creation_date": 1557870787, "post_id": 56138902, "comment_id": 98908948, "body": "...and when you&#39;ve fixed all the things mentioned by the other comments, think about your comparison - as you&#39;ve written it, it is always true."}], "answers": [{"comments": [{"owner": {"reputation": 31685, "user_id": 2458991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WWDzI.jpg?s=128&g=1", "display_name": "bruno", "link": "https://stackoverflow.com/users/2458991/bruno"}, "edited": false, "score": 0, "creation_date": 1557871441, "post_id": 56139146, "comment_id": 98909122, "body": "may be also propose the OP to replace <code>scanf(&quot;%c&quot;, &amp;operatorValue);</code> by <code>scanf(&quot; %c&quot;, &amp;operatorValue);</code> to bypass possible separators like a newline coming from the previous input thank to the space before &quot;%c&quot; ?"}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": 1, "last_activity_date": 1557870905, "creation_date": 1557870905, "answer_id": 56139146, "question_id": 56138902, "link": "https://stackoverflow.com/questions/56138902/string-comparison-in-c-with-operators/56139146#56139146", "title": "String comparison in C with operators", "body": "<p>operator value is char. you can't use string functions with I</p>\n\n<pre><code>    while (operatorValue != '+' ||  ....\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 197, "user_id": 5983050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/333234567d7a296851388bf6c6d8669f?s=128&d=identicon&r=PG", "display_name": "pjaj", "link": "https://stackoverflow.com/users/5983050/pjaj"}, "is_accepted": true, "score": 0, "last_activity_date": 1557872714, "last_edit_date": 1557872714, "creation_date": 1557871065, "answer_id": 56139178, "question_id": 56138902, "link": "https://stackoverflow.com/questions/56138902/string-comparison-in-c-with-operators/56139178#56139178", "title": "String comparison in C with operators", "body": "<p>It may be easier to use the <em>strchr</em> function, defined as</p>\n\n<pre><code>char *strchr(const char *string, int c);\n</code></pre>\n\n<p>It finds the first occurrence of a character in a string. The character c can be the null character (\\0); the ending null character of string is included in the search. Returns NULL if the character is not found.\nSee the following page for a full description and example of use</p>\n\n<p><a href=\"https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_71/rtref/strchr.htm\" rel=\"nofollow noreferrer\">https://www.ibm.com/support/knowledgecenter/en/ssw_ibm_i_71/rtref/strchr.htm</a></p>\n\n<pre><code>char target = \"+-*/\";\n....\n} while  (strchr(target, (int) operatorValue)) ==0); // loops until it gets a match\n</code></pre>\n\n<p>Then if you want to add more characters to the search string it is easy.</p>\n"}], "owner": {"reputation": 3, "user_id": 11132991, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3RuLz_F-iqY/AAAAAAAAAAI/AAAAAAAAACU/lepv9UPzt6w/photo.jpg?sz=128", "display_name": "Maska", "link": "https://stackoverflow.com/users/11132991/maska"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56139178, "answer_count": 2, "score": -2, "last_activity_date": 1557872714, "creation_date": 1557869496, "last_edit_date": 1557869922, "question_id": 56138902, "link": "https://stackoverflow.com/questions/56138902/string-comparison-in-c-with-operators", "title": "String comparison in C with operators", "body": "<p>I can't compare between operators  and it takes 1 only input and then the program crashes.</p>\n\n<pre><code>char operatorValue;\ndo\n{\n\n    printf(\"\\nEnter Operator:\");\n    scanf(\"%c\", &amp;operatorValue);\n\n} while (strcmp(operatorValue, '+') != 0 || strcmp(operatorValue, '-') != 0 ||\n         strcmp(operatorValue, '*') != 0 || strcmp(operatorValue, '/') != 0);\n</code></pre>\n"}, {"tags": ["c", "unix", "parallel-processing", "fork", "deadlock"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 8864190, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48ac6a46839735d0c1ac07f19a3c8427?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Helps", "link": "https://stackoverflow.com/users/8864190/tim-helps"}, "is_accepted": true, "score": 2, "last_activity_date": 1557870436, "last_edit_date": 1557870436, "creation_date": 1557869860, "answer_id": 56138963, "question_id": 56138848, "link": "https://stackoverflow.com/questions/56138848/id-like-to-create-a-deadlock-in-my-program-but-its-not-workingc-fork-parale/56138963#56138963", "title": "I&#39;d like to create a deadlock in my program but it&#39;s not working(C, fork, paralell-programming)", "body": "<p>s and q are not being shared between the parent and child. The child makes a copy then continues to run with a different variable.</p>\n\n<p>Because these do no share variable, you never actually call \"down\" on an that is less than or equal to 0.</p>\n"}], "owner": {"reputation": 13, "user_id": 11500767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a8bc83b6d025b8814ee3bfa1a7f4c7?s=128&d=identicon&r=PG&f=1", "display_name": "ripper19", "link": "https://stackoverflow.com/users/11500767/ripper19"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56138963, "answer_count": 1, "score": 1, "last_activity_date": 1557870436, "creation_date": 1557869215, "question_id": 56138848, "link": "https://stackoverflow.com/questions/56138848/id-like-to-create-a-deadlock-in-my-program-but-its-not-workingc-fork-parale", "title": "I&#39;d like to create a deadlock in my program but it&#39;s not working(C, fork, paralell-programming)", "body": "<p>I'd like to create a deadlock after down(&amp;s);\n        printf(\"c s %d\\n\",s);</p>\n\n<p>It suppose to stuck after down(&amp;s); printf(\"c s %d\\n\",s); and I cant figure out why not. So I'd like to ask some help.</p>\n\n<pre><code>void down(int *s){\nwhile(*s&lt;0 || *s==0){;}\n*s=*s-1;\n}\nvoid up(int *q){\n     *q=*q+1;\n}\nint main(){\nint p,pid;\nint s=1,q=1;\nif ((pid = fork()) == 0){\n    down(&amp;q);\n    printf(\"c q %d\\n\",q);\n    sleep(1);\n    down(&amp;s);\n    printf(\"c s %d\\n\",s);\n    sleep(1);\n    printf(\"child\\n\");\n    up(&amp;q);\n    printf(\"c q %d\\n\",q);\n    sleep(1);\n    up(&amp;s);\n    printf(\"c s %d\\n\",s);\n    sleep(1);\n    }\nelse{\n    down(&amp;s);\n    printf(\"p s %d\\n\",s);\n    sleep(1);\n    down(&amp;q);\n    printf(\"p q %d\\n\",q);\n    sleep(1);\n    printf(\"parent\\n\");\n    up(&amp;s);\n    printf(\"p s %d\\n\",s);\n    sleep(1);\n    up(&amp;q);\n    printf(\"p q %d\\n\",q);\n    sleep(1);\n    }\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "variable-assignment"], "comments": [{"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1557868774, "post_id": 56138748, "comment_id": 98908265, "body": "you&#39;re dereferencing a NULL pointer."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 0, "creation_date": 1557869028, "post_id": 56138748, "comment_id": 98908376, "body": "To answer your question about <code>malloc</code>, yes, you can use it with primitives:  <code>int *sum = malloc(sizeof(*sum));</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1557869254, "post_id": 56138748, "comment_id": 98908465, "body": "Unless you are allocating memory in the function, you will have to pass a pointer to the required sum variable to the function \u2013 if you must use a pointer to the sum."}, {"owner": {"reputation": 2823, "user_id": 6872717, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UCuzs.png?s=128&g=1", "display_name": "alx", "link": "https://stackoverflow.com/users/6872717/alx"}, "edited": false, "score": 0, "creation_date": 1557874227, "post_id": 56138748, "comment_id": 98909844, "body": "It should be <code>int main(void)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11500803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Khh2wDnK3lk/AAAAAAAAAAI/AAAAAAAAAFo/arpmxPKKkUs/photo.jpg?sz=128", "display_name": "Why&#39;d of Vir", "link": "https://stackoverflow.com/users/11500803/whyd-of-vir"}, "edited": false, "score": 0, "creation_date": 1557869762, "post_id": 56138865, "comment_id": 98908624, "body": "Thank you sir, this makes so much sense. as you mention when the function is returning a data, it&#39;s just creating the copy of that data right? so we do need a variable somewhere to assign this copy to the variable for later use?"}, {"owner": {"reputation": 515, "user_id": 1447805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vBmyF.png?s=128&g=1", "display_name": "Daniel Skarbek", "link": "https://stackoverflow.com/users/1447805/daniel-skarbek"}, "reply_to_user": {"reputation": 11, "user_id": 11500803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Khh2wDnK3lk/AAAAAAAAAAI/AAAAAAAAAFo/arpmxPKKkUs/photo.jpg?sz=128", "display_name": "Why&#39;d of Vir", "link": "https://stackoverflow.com/users/11500803/whyd-of-vir"}, "edited": false, "score": 0, "creation_date": 1557870459, "post_id": 56138865, "comment_id": 98908851, "body": "If you want to catch the return variable, yes it needs to be assigned to something.  You are allowed to ignore a return value if you don&#39;t want to use it.  In the code here, the value of the variable <code>sum</code> in the <code>sum()</code> stack frame is copied into the variable <code>num</code> in the <code>main()</code> stack frame. In the alternate version from Moschte&#39;s answer where an <code>int *</code> is being returned the address of the malloc&#39;ed integer is copied from sum to num in the same way, but in that case, it is the address being copied rather than the int value.  Though, in this code there really is no need to use pointers."}, {"owner": {"reputation": 515, "user_id": 1447805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vBmyF.png?s=128&g=1", "display_name": "Daniel Skarbek", "link": "https://stackoverflow.com/users/1447805/daniel-skarbek"}, "reply_to_user": {"reputation": 11, "user_id": 11500803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Khh2wDnK3lk/AAAAAAAAAAI/AAAAAAAAAFo/arpmxPKKkUs/photo.jpg?sz=128", "display_name": "Why&#39;d of Vir", "link": "https://stackoverflow.com/users/11500803/whyd-of-vir"}, "edited": false, "score": 0, "creation_date": 1557873937, "post_id": 56138865, "comment_id": 98909781, "body": "@Why&#39;dofVir If this answers your question, please accept the answer so I get credit for it.  Thanks."}], "tags": [], "owner": {"reputation": 515, "user_id": 1447805, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vBmyF.png?s=128&g=1", "display_name": "Daniel Skarbek", "link": "https://stackoverflow.com/users/1447805/daniel-skarbek"}, "is_accepted": false, "score": 1, "last_activity_date": 1557869337, "creation_date": 1557869337, "answer_id": 56138865, "question_id": 56138748, "link": "https://stackoverflow.com/questions/56138748/using-pointer-to-save-the-data-thats-being-returned-from-the-function-in-c/56138865#56138865", "title": "Using pointer to save the data that&#39;s being returned from the function in c", "body": "<p>Starting with your second question, you can use malloc to allocate memory of any size for any type of variable.  Yes, you can use malloc to allocate ints and other primitive types on the heap.</p>\n\n<pre><code>int i_am_a_stack_variable = 1;\nint * i_am_a_pointer_to_heap_memory = malloc(sizeof(int));\n</code></pre>\n\n<p>For your first question, I think you are mis-understanding how return variables work. Typically, the use of global variables should be avoided. They certainly aren't needed to return values from functions. The return value of a function is copied from the function's stack frame back to the calling stack frame wherever it is assigned. Note that it is COPIED back. Whether it is a primitive type or a pointer (which is really just another type of primitive). Your code could be written just not using pointers at all. Also, note that your code was not using a global variable at all even though you mentioned global variables.</p>\n\n<pre><code>#include &lt;math.h&gt; \n#include &lt;stdio.h&gt; \n\nint sum(); \nint main() \n{ \n    int num; \n    num = sum(); \n    printf(\"\\nSum of two given values = %d\", num); \n    return 0; \n} \n\nint sum() \n{ \n    int a = 50, b = 80;\n    int sum = 0; \n    printf(\"%d %d\",a,b);\n    sum = a+b; \n    return sum; \n} \n</code></pre>\n\n<p>Does this make sense?</p>\n"}, {"comments": [{"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 1, "creation_date": 1557871004, "post_id": 56138882, "comment_id": 98908995, "body": "Beware of memory leak - calling malloc() without a corresponding free()"}], "tags": [], "owner": {"reputation": 102, "user_id": 4685974, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-BdpVkFClVTE/AAAAAAAAAAI/AAAAAAAABgk/3vDJC6gnJ54/photo.jpg?sz=128", "display_name": "Moschte", "link": "https://stackoverflow.com/users/4685974/moschte"}, "is_accepted": false, "score": 0, "last_activity_date": 1557871093, "last_edit_date": 1557871093, "creation_date": 1557869419, "answer_id": 56138882, "question_id": 56138748, "link": "https://stackoverflow.com/questions/56138748/using-pointer-to-save-the-data-thats-being-returned-from-the-function-in-c/56138882#56138882", "title": "Using pointer to save the data that&#39;s being returned from the function in c", "body": "<p>This should work</p>\n\n<pre><code>#include &lt;math.h&gt; \n#include &lt;stdio.h&gt; \n\nint *sum(); \nint main() \n{ \n    int *num; \n    num = sum(); \n    printf(\"\\nSum of two given values = %d\", *num); \n    free(num);\n    return 0; \n} \n\nint *sum() \n{ \n    int a = 50, b = 80;\n    int *sum = malloc(sizeof(int)); \n    printf(\"%d %d\",a,b);\n    *sum = a+b; \n    return sum; \n}\n</code></pre>\n\n<p>You need to allocate memory for the pointer. In your case you need memory for one Integer. When you say int* sum =NULL your pointer has no Adress. You can't access a null pointer. </p>\n"}], "owner": {"reputation": 11, "user_id": 11500803, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Khh2wDnK3lk/AAAAAAAAAAI/AAAAAAAAAFo/arpmxPKKkUs/photo.jpg?sz=128", "display_name": "Why&#39;d of Vir", "link": "https://stackoverflow.com/users/11500803/whyd-of-vir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557875849, "creation_date": 1557868683, "last_edit_date": 1557875849, "question_id": 56138748, "link": "https://stackoverflow.com/questions/56138748/using-pointer-to-save-the-data-thats-being-returned-from-the-function-in-c", "title": "Using pointer to save the data that&#39;s being returned from the function in c", "body": "<ol>\n<li><p>When we wanna return one particular type of data, we need to declare a global variable first right? and assign this variable to the value thats being returned by the funtion?</p></li>\n<li><p>Also for int primitive data type, we cannot use malloc to reserve memory block?</p></li>\n</ol>\n\n<p>Sincerely,\nheadful of doubts.</p>\n\n<pre><code>#include &lt;math.h&gt; \n#include &lt;stdio.h&gt; \n\nint *sum(); \nint main() \n{ \n    int *num; \n    num = sum(); \n    printf(\"\\nSum of two given values = %d\", *num); \n    return 0; \n} \n\nint *sum() \n{ \n    int a = 50, b = 80;\n    int *sum = NULL; \n    printf(\"%d %d\",a,b);\n    *sum = a+b; \n    return sum; \n} \n</code></pre>\n\n<p>I wanna using pointers to save the data thats being returned by the function. is it possible? I know it's possible for linked list structures. But I'm not sure about integers and other primitive data types.</p>\n"}]