[{"tags": ["c", "shell", "time"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1455753154, "post_id": 35470094, "comment_id": 58635758, "body": "<code>c</code> is not shell. Are you certain that <code>inputfile_name</code> exists, and contains data?"}, {"owner": {"reputation": 29, "user_id": 5069677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lvZFyRsLGBc/AAAAAAAAAAI/AAAAAAAAAHk/00UlnvXpMYw/photo.jpg?sz=128", "display_name": "feroz haider", "link": "https://stackoverflow.com/users/5069677/feroz-haider"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1455753293, "post_id": 35470094, "comment_id": 58635818, "body": "yes these both are different . and no inputfile_name exist"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455753329, "post_id": 35470094, "comment_id": 58635833, "body": "@ferozhaider How is your program supposed to work if no file <code>inputfile_name</code> exists? Please consider adding marginal error checking to your program."}, {"owner": {"reputation": 29, "user_id": 5069677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lvZFyRsLGBc/AAAAAAAAAAI/AAAAAAAAAHk/00UlnvXpMYw/photo.jpg?sz=128", "display_name": "feroz haider", "link": "https://stackoverflow.com/users/5069677/feroz-haider"}, "edited": false, "score": 0, "creation_date": 1455753398, "post_id": 35470094, "comment_id": 58635862, "body": "ok thank you so much"}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "edited": false, "score": 0, "creation_date": 1455753446, "post_id": 35470094, "comment_id": 58635875, "body": "I no input file name exists, then the first <code>open</code> returns -1 as does the first <code>read</code> (setting EBADF in the process). That terminates your while loop immediately after which there&#39;s not much left to do."}, {"owner": {"reputation": 29, "user_id": 5069677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lvZFyRsLGBc/AAAAAAAAAAI/AAAAAAAAAHk/00UlnvXpMYw/photo.jpg?sz=128", "display_name": "feroz haider", "link": "https://stackoverflow.com/users/5069677/feroz-haider"}, "edited": false, "score": 0, "creation_date": 1455753797, "post_id": 35470094, "comment_id": 58635969, "body": "i made files and run again. still same problem"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1455755189, "post_id": 35470094, "comment_id": 58636396, "body": "Turn off smart quotes when you&#39;re editing code. You can&#39;t use curly quotes in C programs (or most other programming languages)."}, {"owner": {"reputation": 29, "user_id": 5069677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lvZFyRsLGBc/AAAAAAAAAAI/AAAAAAAAAHk/00UlnvXpMYw/photo.jpg?sz=128", "display_name": "feroz haider", "link": "https://stackoverflow.com/users/5069677/feroz-haider"}, "edited": false, "score": 0, "creation_date": 1455785390, "post_id": 35470094, "comment_id": 58647533, "body": "i did.. but still 0 sec"}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 2, "last_activity_date": 1455753244, "creation_date": 1455753244, "answer_id": 35470147, "question_id": 35470094, "link": "https://stackoverflow.com/questions/35470094/program-in-c-gives-0sec-user-time-and-system-time/35470147#35470147", "title": "Program in C gives 0sec user time and system time", "body": "<p>If a program runs sufficiently fast, it may terminate before the long-term system clock (as queried with <code>gettimeofday</code> advances. On some systems, this clock has a precision of just 10&thinsp;ms, so it's likely that this happens with a very brief program like yours. In this situation, the operating system reports the runtime of your program as 0 as it didn't take any time to run from the point of view of <code>gettimeofday</code>.</p>\n"}], "owner": {"reputation": 29, "user_id": 5069677, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-lvZFyRsLGBc/AAAAAAAAAAI/AAAAAAAAAHk/00UlnvXpMYw/photo.jpg?sz=128", "display_name": "feroz haider", "link": "https://stackoverflow.com/users/5069677/feroz-haider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 35470147, "answer_count": 1, "score": 1, "last_activity_date": 1455754454, "creation_date": 1455752978, "last_edit_date": 1455754454, "question_id": 35470094, "link": "https://stackoverflow.com/questions/35470094/program-in-c-gives-0sec-user-time-and-system-time", "title": "Program in C gives 0sec user time and system time", "body": "<p>please explain why the user and system time output is zero seconds and 0% cpu usage.</p>\n\n<pre><code>#include &lt;unistd.h&gt; \n#include &lt;sys/stat.h&gt; \n#include &lt;fcntl.h&gt; \n#include &lt;stdlib.h&gt;  \n\nint main() { \n    char c;\n    int in, out; \n\n    in = open(\u201cinputfile_name\u201d, O_RDONLY); \n    out = open(\u201coutputfile_name\u201d, O_WRONLY|O_CREAT, S_IRUSR|S_IWUSR);  \n\n    while(read(in,&amp;c,1) == 1) \n        write(out,&amp;c,1);\n\n    exit(0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455751139, "post_id": 35469718, "comment_id": 58634987, "body": "And the Python tag just slipped in? Do not add unrealted tags!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455751188, "post_id": 35469718, "comment_id": 58635007, "body": "&quot;// means: true&quot; So why not use <code>true</code> and <code>stdbool.h</code> then?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1455751472, "post_id": 35469718, "comment_id": 58635128, "body": "@Olaf Becausethat&#39;s C99 and OP may not have learned about C99 yet? There are thousands of reasons not to use the weird type <code>_Bool</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455754762, "post_id": 35469718, "comment_id": 58636266, "body": "@FUZxxl: <code>true</code> is an <code>int</code>, not <code>_Bool</code>. It is just standard C. And can you recify calling the unsigned integer type <code>_Bool</code> &quot;weird&quot;?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455755787, "post_id": 35469718, "comment_id": 58636574, "body": "@Olaf <code>_Bool</code> has different conversion rules from any other type. It also has a more restricted range than <code>char</code> which is something that breaks with the conventions of C (i.e. <code>char</code> being the most narrow type)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455755936, "post_id": 35469718, "comment_id": 58636616, "body": "@FUZxxl: Similar to <code>bool</code> in C++. It just sticks as close to C++ <code>bool</code> as possible without breaking established conversions."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455756151, "post_id": 35469718, "comment_id": 58636680, "body": "@Olaf It already breaks all the conventions. <code>_Bool</code> shouldn&#39;t be used."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455759198, "post_id": 35469718, "comment_id": 58637689, "body": "@FUZxxl: I don&#39;t see how <code>_Bool</code>&#39;s being more narrow than <code>char</code> can break any conventions. What conventions are based on <code>char</code>&#39;s status of being the most narrow type? There&#39;s no reason to avoid <code>bool</code> (aka <code>_Bool</code>) in C. One can actually argue that <code>_Bool</code> should be preferred over <code>bool</code> to avoid conflicts with C++ in cross-compilable headers."}], "answers": [{"comments": [{"owner": {"reputation": 56828, "user_id": 4062354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xcV4d.png?s=128&g=1", "display_name": "MikeCAT", "link": "https://stackoverflow.com/users/4062354/mikecat"}, "edited": false, "score": 0, "creation_date": 1455758036, "post_id": 35469741, "comment_id": 58637301, "body": "<code>char *main()</code> is illegal in C++, but might not be illegal in C. It is implementation-defined. (N1256 5.1.2.2.1 Program startup)"}], "tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": true, "score": 2, "last_activity_date": 1455755400, "last_edit_date": 1455755400, "creation_date": 1455751246, "answer_id": 35469741, "question_id": 35469718, "link": "https://stackoverflow.com/questions/35469718/assignment-makes-integer-from-pointer-without-a-cast-wint-conversion/35469741#35469741", "title": "assignment makes integer from pointer without a cast [-Wint-conversion]", "body": "<p>Firstly, <code>char *main()</code> is illegal in C. It should be <code>int main()</code>.</p>\n\n<p>Secondly, <code>'a'</code> and the like are <em>integer</em> constants in C. You cannot use them to initialize and array of <code>char *</code> elements. If you wanted a <code>char</code> array you should have declared it as</p>\n\n<pre><code>const char vowels[] = {'a', 'e', 'i', 'o', 'u'};\n</code></pre>\n\n<p>If you wanted a string array you should have declared it as</p>\n\n<pre><code>const char *const vowels[] = {\"a\", \"e\", \"i\", \"o\", \"u\"};\n</code></pre>\n\n<p>Finally, it is completely unclear what you were trying to say by <code>c = vowels</code>. If you want to check whether <code>c</code> is in <code>vowels</code> array, keep in mind that there's no core language feature that can do it for you (and certainly not the <code>=</code> operator). You have to implement the check manually or use an applicable library feature.</p>\n\n<p>For example, one possible way to check it is</p>\n\n<pre><code>const char vowels[] = {'a', 'e', 'i', 'o', 'u'};\n...\nif (memchr(vowels, c, sizeof vowels) != NULL)\n  putchar('*');\n</code></pre>\n\n<p>Alternatively, it can be expressed as</p>\n\n<pre><code>const char *const vowels = \"aeiou\";\n...\nif (strchr(vowels, c) != NULL)\n  putchar('*');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 0, "last_activity_date": 1455751254, "creation_date": 1455751254, "answer_id": 35469744, "question_id": 35469718, "link": "https://stackoverflow.com/questions/35469718/assignment-makes-integer-from-pointer-without-a-cast-wint-conversion/35469744#35469744", "title": "assignment makes integer from pointer without a cast [-Wint-conversion]", "body": "<p>First of all, your program contains a typo. <code>==</code> is comparison whereas <code>=</code> is assignment. Instead of this line</p>\n\n<pre><code>if(c = vowels) putchar('*');\n</code></pre>\n\n<p>you probably meant to write</p>\n\n<pre><code>if(c == vowels) putchar('*');\n</code></pre>\n\n<p>but even that is incorrect. You cannot use the <code>==</code> operator to test for membership. To test for membership, you could use the <code>strchr()</code> function from <code>&lt;string.h&gt;</code>:</p>\n\n<pre><code>if (memchr(vowels, c, sizeof vowels) != NULL) putchar('*');\n</code></pre>\n\n<p>You can read <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/memchr.html\" rel=\"nofollow\">here</a> about what <code>memchr</code> does.</p>\n\n<p>Lastly, as <code>AnT</code> already remarked, <code>main</code> shouldn't return a <code>char*</code>. The <code>main</code> function must return an <code>int</code> in a strictly conforming C program. Change the line</p>\n\n<pre><code>char* main() {\n</code></pre>\n\n<p>to</p>\n\n<pre><code>int main() {\n</code></pre>\n\n<p>to fix this.</p>\n"}, {"tags": [], "owner": {"reputation": 124806, "user_id": 121747, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9fcebb68b105446c0d9eebbce1146044?s=128&d=identicon&r=PG&f=1", "display_name": "Jack", "link": "https://stackoverflow.com/users/121747/jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1455751273, "creation_date": 1455751273, "answer_id": 35469748, "question_id": 35469718, "link": "https://stackoverflow.com/questions/35469718/assignment-makes-integer-from-pointer-without-a-cast-wint-conversion/35469748#35469748", "title": "assignment makes integer from pointer without a cast [-Wint-conversion]", "body": "<p>The problem is that you are not comparing anything in <code>c = vowels</code>. You are assigning to <code>c</code> the address of the array <code>vowels</code> (which is a pointer indeed).</p>\n\n<p>Probably you wanted to check equality between c and one of the vowels but you must use the <code>[]</code> operator since <code>vowels</code> is an array, an index, and a different operator (comparison, which is <code>==</code>). Something like:</p>\n\n<pre><code>if (c == vowels[2])\n</code></pre>\n\n<p>but then vowels should be a <code>char[]</code> not a <code>char*[]</code>.</p>\n"}], "owner": {"reputation": 45, "user_id": 5943033, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/bb500d026ddb1c39a871fedd8523177c?s=128&d=identicon&r=PG&f=1", "display_name": "madhaj1", "link": "https://stackoverflow.com/users/5943033/madhaj1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7184, "favorite_count": 1, "accepted_answer_id": 35469741, "answer_count": 3, "score": 1, "last_activity_date": 1455755400, "creation_date": 1455751076, "last_edit_date": 1455751095, "question_id": 35469718, "link": "https://stackoverflow.com/questions/35469718/assignment-makes-integer-from-pointer-without-a-cast-wint-conversion", "title": "assignment makes integer from pointer without a cast [-Wint-conversion]", "body": "<p>i am new to c, i am trying to make a simple code in which i replace the vowels of an input with the * character... i am having trouble with the array (i am mainly familiar with python only using c now.)</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n char* main() {\n int c;\n char* vowels[] = {'a', 'e', 'i', 'o', 'u'};\n\n while( 1 ) {   // means: true\n  c = getchar();\n  if(c == EOF) break;\n  if(c = vowels) putchar('*'); \n  else putchar(c);\n}\n}\n</code></pre>\n\n<p>i keep receiving the same error message: novowels.c:5:41: note: (near initialization for \u2018vowels[4]\u2019)\nnovowels.c:10:12: warning: assignment makes integer from pointer without a cast [-Wint-conversion]\n       if(c = vowels) putchar('*'); \n            ^</p>\n\n<p>.... please help, i can't quite figure out how do complete this program of replacing vowels with *</p>\n"}, {"tags": ["c", "algorithm", "math", "primes", "square-root"], "comments": [{"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1455750378, "post_id": 35469430, "comment_id": 58634661, "body": "@RSahu I don&#39;t believe this is a proper duplicate. Please reopen."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455750451, "post_id": 35469430, "comment_id": 58634693, "body": "@FUZxxl, I was biased by the title."}, {"owner": {"reputation": 877, "user_id": 922586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b31e99db47262f6c402540646c69829?s=128&d=identicon&r=PG&f=1", "display_name": "Steger", "link": "https://stackoverflow.com/users/922586/steger"}, "edited": false, "score": 0, "creation_date": 1455750495, "post_id": 35469430, "comment_id": 58634719, "body": "With a little more research, you might rephrase your question as: &quot;What is an efficient algorithm for finding all factors of an integer?&quot; I think you will find that this is a rather deep question that has been tackled many times on this forum..."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1455750572, "post_id": 35469430, "comment_id": 58634752, "body": "Searching for &quot;why are floating point operations slower than integer operations&quot; in google produces a lot of interesting links."}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "reply_to_user": {"reputation": 877, "user_id": 922586, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5b31e99db47262f6c402540646c69829?s=128&d=identicon&r=PG&f=1", "display_name": "Steger", "link": "https://stackoverflow.com/users/922586/steger"}, "edited": false, "score": 0, "creation_date": 1455750737, "post_id": 35469430, "comment_id": 58634828, "body": "@Steger I&#39;ll take tour suggestion as I was indeed trying to find different ways to tackle this problem:)"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455750885, "post_id": 35469430, "comment_id": 58634887, "body": "It depends on problem size. sqrt takes 100 cycles most, multiplication takes at leas half a cycle. So if your integer is greater than 400 then sqrt definitely has the advantage."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1455750897, "post_id": 35469430, "comment_id": 58634891, "body": "<a href=\"http://stackoverflow.com/a/5296669/434551\">An interesting approach to compute square root of integers</a>."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 1, "creation_date": 1455751457, "post_id": 35469430, "comment_id": 58635124, "body": "On the other hand, the remainder takes at least 10x more time than multiplication anyway, so event the ideal case you are not saving a lot of time."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455751854, "post_id": 35469430, "comment_id": 58635266, "body": "@user3528438 On Haswell, an <code>fsqrt</code> takes as long as an <code>fdiv</code> according to Agner Fog."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455755034, "post_id": 35469430, "comment_id": 58636352, "body": "<code>if(number % divider = 0)</code>will not compile: should be <code>if(number % divider == 0)</code> for a comparison."}, {"owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455755124, "post_id": 35469430, "comment_id": 58636380, "body": "@WeatherVane modified"}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": false, "score": 2, "last_activity_date": 1455751934, "last_edit_date": 1455751934, "creation_date": 1455750539, "answer_id": 35469605, "question_id": 35469430, "link": "https://stackoverflow.com/questions/35469430/what-is-an-efficient-algorithm-to-find-all-the-factors-of-an-integer/35469605#35469605", "title": "What is an efficient algorithm to find all the factors of an integer?", "body": "<p>In C, you can take square roots of floating point numbers with the <code>sqrt()</code> family of functions in the header <code>&lt;math.h&gt;</code>.</p>\n\n<p>Taking square roots is usually slower than dividing because the algorithm to take square roots is more complicated than the division algorithm. This is not a property of the C language but of the hardware that executes your program. On modern processors, taking square roots can be just as fast as dividing. This holds, for example, on the Haswell microarchitecture.</p>\n\n<p>However, if the algorithmic improvements are good, the slightly slower speed of a <code>sqrt()</code> call usually doesn't matter.</p>\n\n<p>To only compare up to the square root of <code>number</code>, employ code like this:</p>\n\n<pre><code>#include &lt;math.h&gt;\n\n/* ... */\n\nint root = (int)sqrt((double)number);\nfor(divider = 2; divider &lt;= root; divider++)\n    if(number % divider = 0)\n        print(\"%d can divided by %d\\n\", number, divider);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455752832, "post_id": 35469927, "comment_id": 58635627, "body": "If the input range is limited and I pre-compute all prime numbers in that range as a table, what would the complicity be? (or is such a table feasible for say int32?)"}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455752951, "post_id": 35469927, "comment_id": 58635668, "body": "@user3528438 You can compute the primes in the range 1 to M in time O(M * log log M) using the <a href=\"https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes\" rel=\"nofollow noreferrer\">Sieve of Eratosthenes</a>. There are better algorithms for the job, but this is by far the simplest, and for M in the order of hundreds of millions to even billions it should be the fastest one if implemented efficiently."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455753284, "post_id": 35469927, "comment_id": 58635813, "body": "@user3528438 And to answer your second question, there are about 200 million primes in that range (pi(n) ~= n / ln n), so the table would occupy somewhat around 800 megabytes. You can probably compute it within a couple of seconds on a single CPU, so yes, that might well be feasible depending on your constraints"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455753963, "post_id": 35469927, "comment_id": 58636017, "body": "Well, in the uint32 range, the largest factor must be below 65536, and below 65536 there are only 6542 prime numbers. So at least in the uint32 range, it would be quite efficient and feasible isn&#39;t it?"}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455754053, "post_id": 35469927, "comment_id": 58636048, "body": "@user3528438 Oh you mean precomputing the primes up to sqrt(n) and using that table? Yes that&#39;s very feasible for your given range. However it&#39;s asymptotically &quot;only&quot; a logarithmic factor better than naive trivial division because of how dense primes are within the set of natural numbers. For 64 bits this is no longer feasible, but Pollard-Rho still &quot;kinda&quot; is (depending on your time constraints of course)."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455754511, "post_id": 35469927, "comment_id": 58636172, "body": "@user3528438 Not sure what algorithm you have in mind. Say <code>n &lt;= 4294967296 = 2^32</code> and you have precomputed all primes up to <code>sqrt(2^32) = 2^16 = 65536</code>. Then you will still need to check every one of the ~6000 primes in that range for whether they are a prime factor of <code>n</code>"}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 0, "creation_date": 1455754822, "post_id": 35469927, "comment_id": 58636287, "body": "Not really. If you divide the input by the prime factor each time you find one, and terminate when the input is smaller than the prime number to be checked. 4294967296 is a good case because it &quot;hits&quot; the table very early(at 2s). Worst case is some 4293001441 which doesn&#39;t hit until the very end (needs to check all 6542 primes bellow 65536)."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1455785703, "post_id": 35469927, "comment_id": 58647705, "body": "Skipping multiples of two is doing something else than the OP asks. Your method produces an asymmetry. It excludes multiples of two but includes e.g. multiples of three.  The OP is not finding only prime divisors but all divisors (excluding 1 and the number itself)."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1455791692, "post_id": 35469927, "comment_id": 58651812, "body": "@Zboson OPs method is already borked if he wants to find all the divisors, because their method cannot find factors larger than sqrt(n). I&#39;m providing a means to compute prime factors, which can be used to compute the divisors afterwards. If you so will, this is an output-sensitive algorithm, because most numbers do not have a lot of divisors (but some do)"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1455792018, "post_id": 35469927, "comment_id": 58652054, "body": "<code>printf(&quot;%d can divided by %d and %d\\n&quot;, number, divider, number&#47;divider);</code> gives the other factor."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1455792320, "post_id": 35469927, "comment_id": 58652283, "body": "@Zboson I know that, thanks. Still it&#39;s not clear what OPs intention is, due to this"}], "tags": [], "owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "is_accepted": false, "score": 3, "last_activity_date": 1455792436, "last_edit_date": 1455792436, "creation_date": 1455752208, "answer_id": 35469927, "question_id": 35469430, "link": "https://stackoverflow.com/questions/35469430/what-is-an-efficient-algorithm-to-find-all-the-factors-of-an-integer/35469927#35469927", "title": "What is an efficient algorithm to find all the factors of an integer?", "body": "<blockquote>\n  <p>However, it seems that sqrt() isn't really able to boost the efficiency</p>\n</blockquote>\n\n<p>That is to be expected, as the saved multiplication per iteration is largely dominated by the much slower division operation inside the loop.</p>\n\n<blockquote>\n  <p>Also, the <code>number % divider = 0</code> is used to test if divider could evenly divide number, is there also a more efficient way to do the test besides using %?</p>\n</blockquote>\n\n<p>Not that I know of. Checking whether <code>a % b == 0</code> is at least as hard as checking <code>a % b = c</code> for some c, because we can use the former to compute the latter (with one extra addition). And at least on Intel architectures, computing the latter is just as computationally expensive as a division, which is amongst the slowest operations in typical, modern processors.</p>\n\n<p>If you want <em>significantly</em> better performance, you need a better factorization algorithm, of which <a href=\"https://en.wikipedia.org/wiki/Integer_factorization#Factoring_algorithms\" rel=\"nofollow\">there are plenty</a>. One particular simple one with runtime O(n<sup>1/4</sup>) is <a href=\"https://en.wikipedia.org/wiki/Pollard%27s_rho_algorithm\" rel=\"nofollow\">Pollard's \u03c1 algorithm</a>. You can find a straightforward C++ implementation <a href=\"https://github.com/niklasb/contest-algos/blob/master/number_theory.cpp#L75\" rel=\"nofollow\">in my algorithms library</a>. Adaption to C is left as an exercise to the reader:</p>\n\n<pre><code>int rho(int n) { // will find a factor &lt; n, but not necessarily prime\n  if (~n &amp; 1) return 2;\n  int c = rand() % n, x = rand() % n, y = x, d = 1;\n  while (d == 1) {\n    x = (1ll*x*x % n + c) % n;\n    y = (1ll*y*y % n + c) % n;\n    y = (1ll*y*y % n + c) % n;\n    d = __gcd(abs(x - y), n);\n  }\n  return d == n ? rho(n) : d;\n}\n\nvoid factor(int n, map&lt;int, int&gt;&amp; facts) {\n  if (n == 1) return;\n  if (rabin(n)) { // simple randomized prime test (e.g. Miller\u2013Rabin)\n    // we found a prime factor\n    facts[n]++;\n    return;\n  }\n  int f = rho(n);\n  factor(n/f, facts);\n  factor(f, facts);\n}\n</code></pre>\n\n<p>Constructing the factors of <code>n</code> from its prime factors is then an easy task. Just use all possible exponents for the found prime factors and combine them in each possible way.</p>\n"}, {"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455756948, "post_id": 35470770, "comment_id": 58636949, "body": "You may not need all the prime numbers. I suggest you check each for being a factor, as you generate them. Also, each prime may divide more than once, for example <code>45 =  3 * 3 * 5</code>."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455757342, "post_id": 35470770, "comment_id": 58637086, "body": "@WeatherVane Please see the test code. Running it with <code>fact2(45, p)</code> generates <code>(3,2), (5,1)</code>. A difficult case is when the largest prime factor is greater than 65536, which is easy to hadle because there is at most one of them for each input."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455757600, "post_id": 35470770, "comment_id": 58637172, "body": "Sorry I don&#39;t follow MATLAB, but in C it&#39;s still valid to generate the primes as you go, rather than all you might need."}, {"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455757756, "post_id": 35470770, "comment_id": 58637218, "body": "@WeatherVane That&#39;s true but I don&#39;t know how (yet). It&#39;ll be useful when the input range is too large for the table to be feasible."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455757830, "post_id": 35470770, "comment_id": 58637241, "body": "Unless you used a sieve you would still need a table, as you use it to test for / generate the next prime."}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "edited": false, "score": 1, "creation_date": 1455762494, "post_id": 35470770, "comment_id": 58638615, "body": "FWIW, the precise asymptotic complexity of this method is O(n^(1/2) / log n) per query (+ the preprocessing step obviously)"}, {"owner": {"reputation": 84156, "user_id": 916657, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/75bf31b48e75eedfebaa411a76a85155?s=128&d=identicon&r=PG", "display_name": "Niklas B.", "link": "https://stackoverflow.com/users/916657/niklas-b"}, "edited": false, "score": 0, "creation_date": 1455762814, "post_id": 35470770, "comment_id": 58638698, "body": "Not that it really matters if you have a specific input range in mind, of course."}], "tags": [], "owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "is_accepted": false, "score": 0, "last_activity_date": 1455757871, "last_edit_date": 1455757871, "creation_date": 1455756791, "answer_id": 35470770, "question_id": 35469430, "link": "https://stackoverflow.com/questions/35469430/what-is-an-efficient-algorithm-to-find-all-the-factors-of-an-integer/35470770#35470770", "title": "What is an efficient algorithm to find all the factors of an integer?", "body": "<p>This is just my random thought, so please comment and critisize it if it's wrong.</p>\n\n<p>The idea is to precompute all the prime numbers below a certain range and use it as a table.</p>\n\n<p>Looping though the table, check if the prime number is a factor, if it is, then increament the counter for that prime number, if not then increment the index. Terminate when the index reaches the end or the prime number to check exceeds the input.</p>\n\n<p>At end, the result is a table of all the prime factors of the input, and their counts. Then generating all natual factors should be trival, isn't it?</p>\n\n<p>Worst case, the loop needs to go to the end, then it takes 6542 iterations.</p>\n\n<p>Considering the input is [0, 4294967296] this is similar to <code>O(n^3/8)</code>.</p>\n\n<p>Here's MATLAB code that implements this method:</p>\n\n<p>if <code>p</code> is generated by <code>p=primes(65536);</code> this method would work for all inputs between <code>[0, 4294967296]</code> (but not tested).</p>\n\n<pre><code>function [ output_non_zero ] = fact2(input, p)\n    output_table=zeros(size(p));\n    i=1;\n    while(i&lt;length(p));\n        if(input&lt;1.5)\n            break; \n            % break condition: input is divided to 1,\n            % all prime factors are found. \n        end\n        if(rem(input,p(i))&lt;1)\n            % if dividable, increament counter and don't increament index\n            % keep checking until not dividable\n            output_table(i)=output_table(i)+1;\n            input = input/p(i);\n        else\n            % not dividable, try next\n            i=i+1;\n        end\n    end\n\n    % remove all zeros, should be handled more efficiently\n     output_non_zero = [p(output_table~=0);...\n                        output_table(output_table~=0)];\n     if(input &gt; 1.5)\n         % the last and largest prime factor could be larger than 65536\n         % hence would skip from the table, add it to the end of output\n         % if exists\n         output_non_zero = [output_non_zero,[input;1]];\n     end\nend\n</code></pre>\n\n<p><strong>test</strong></p>\n\n<pre><code>p=primes(65536);\nt = floor(rand()*4294967296);\nb = fact2(t, p);\n% check if all prime factors adds up and they are all primes\nassert((prod(b(1,:).^b(2,:))==t)&amp;&amp;all(isprime(b(1,:))), 'test failed');\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "is_accepted": true, "score": 3, "last_activity_date": 1455891068, "last_edit_date": 1495541207, "creation_date": 1455788151, "answer_id": 35477661, "question_id": 35469430, "link": "https://stackoverflow.com/questions/35469430/what-is-an-efficient-algorithm-to-find-all-the-factors-of-an-integer/35477661#35477661", "title": "What is an efficient algorithm to find all the factors of an integer?", "body": "<p>I'm not going to address what the best algorithm to find all factors of an integer is. Instead I would like to comment on your current method.</p>\n\n<p>There are thee conditional tests cases to consider</p>\n\n<ol>\n<li><code>(divider * divider) &lt;= number</code></li>\n<li><code>divider &lt;= number/divider</code></li>\n<li><code>divider &lt;= sqrt(number)</code></li>\n</ol>\n\n<p>See <a href=\"https://stackoverflow.com/questions/22556599/conditional-tests-in-primality-by-trial-division\">Conditional tests in primality by trial division</a> for more detials.</p>\n\n<p>The case to use depends on your goals and hardware.</p>\n\n<p>The advantage of case 1 is that it does not require a division. However, it can overflow when <code>divider*divider</code> is larger than the largest integer. Case two does not have the overflow problem but it requires a division. For case3 the <code>sqrt</code> only needs to be calculated once but it requires that the <code>sqrt</code> function get perfect squares correct.</p>\n\n<p>But there is something else to consider many instruction sets, including the x86 instruction set, return the remainder as well when doing a division. Since you're already doing <code>number % divider</code> this means that you get it for free when doing  <code>number / divider</code>.</p>\n\n<p>Therefore, case 1 is only useful on system where the division and remainder are not calculated in one instruction and you're not worried about overflow.</p>\n\n<p>Between case 2 and case3 I think the main issue is again the instruction set. Choose case 2 if the <code>sqrt</code> is too slow compared to case2 or if your <code>sqrt</code> function does not calculate perfect squares correctly. Choose case 3 if the instruction set does not calculate the divisor and remainder in one instruction.</p>\n\n<p>For the x86 instruction set case 1, case 2 and case 3 should give essentially equal performance. So there <em>should</em> be no reason to use case 1 (however see a subtle point below) . The C standard library guarantees that the <code>sqrt</code> of perfect squares are done correctly. So there is no disadvantage to case 3 either. </p>\n\n<p>But there is one subtle point about case 2.  I have found that some compilers don't recognize that the division and remainder are calculated together.  For example in the following code</p>\n\n<pre><code>for(divider = 2; divider &lt;= number/divider; divider++)\n    if(number % divider == 0)\n</code></pre>\n\n<p>GCC generates two division instruction even though only one is necessary. One way to fix this is to keep the division and reminder close like this</p>\n\n<pre><code>divider = 2, q = number/divider, r = number%divider\nfor(; divider &lt;= q; divider++, q = number/divider, r = number%divider)\n    if(r == 0)\n</code></pre>\n\n<p>In this case GCC produces only one division instruction and case1, case 2 and case 3 have the same performance.  But this code is a bit less readable than </p>\n\n<pre><code>int cut = sqrt(number);\nfor(divider = 2; divider &lt;= cut; divider++)\n    if(number % divider == 0)\n</code></pre>\n\n<p>so I think overall case 3 is the best choice at least with the x86 instruction set.</p>\n"}], "owner": {"reputation": 387, "user_id": 4238247, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/iAQwx.png?s=128&g=1", "display_name": "edhu", "link": "https://stackoverflow.com/users/4238247/edhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1414, "favorite_count": 0, "accepted_answer_id": 35477661, "answer_count": 4, "score": 2, "last_activity_date": 1455891068, "creation_date": 1455749747, "last_edit_date": 1455800226, "question_id": 35469430, "link": "https://stackoverflow.com/questions/35469430/what-is-an-efficient-algorithm-to-find-all-the-factors-of-an-integer", "title": "What is an efficient algorithm to find all the factors of an integer?", "body": "<p>I was writing a very simple program to examine if a number could divide another number evenly:</p>\n\n<pre><code>// use the divider squared to reduce iterations\nfor(divider = 2; (divider * divider) &lt;= number; divider++)\n    if(number % divider == 0)\n        print(\"%d can divided by %d\\n\", number, divider);\n</code></pre>\n\n<p>Now I was curious if the task could be done by finding the square root of number and compare it to divider. However, it seems that sqrt() isn't really able to boost the efficiency. How was sqrt() handled in C and how can I boost the efficiency of sqrt()? Also, is there any other way to approach the answer with even greater efficiency?</p>\n\n<p>Also, the</p>\n\n<pre><code>number % divider == 0\n</code></pre>\n\n<p>is used to test if divider could evenly divide number, is there also a more efficient way to do the test besides using %?</p>\n"}, {"tags": ["c", "ubuntu", "makefile", "message-queue"], "comments": [{"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "edited": false, "score": 0, "creation_date": 1455749707, "post_id": 35469226, "comment_id": 58634355, "body": "Just to be sure, you have executed <code>sudo apt-get install build-essential</code> ? And your Makefile is broken. <code>all: </code>requires <code>deneme</code> but you provided <code>deneme1</code>!"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "reply_to_user": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "edited": false, "score": 0, "creation_date": 1455751709, "post_id": 35469226, "comment_id": 58635213, "body": "yes I executed build -essential even to be sure again, I type this and install again"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751265, "post_id": 35469697, "comment_id": 58635042, "body": "thanks a lot , I changed the second line to &quot;deneme&quot; but it still give the same error"}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751411, "post_id": 35469697, "comment_id": 58635106, "body": "Does it compile if you manually execute <code>gcc deneme.c -o deneame -lrt</code>  ?"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751904, "post_id": 35469697, "comment_id": 58635294, "body": "yesss ! , it compiles and even run but how could this be possible ? how can I fix my makefile than ?"}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455752047, "post_id": 35469697, "comment_id": 58635355, "body": "You must have an error in your Makefile. Maybe you used spaces instead of tabs. Note that the tab character is a very important part of the syntax of Makefiles. All command lines must start with tabs."}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455752384, "post_id": 35469697, "comment_id": 58635480, "body": "You can try this Makefile in order to be sure: <a href=\"http://pastebin.com/raw/DwAzfWSd/Makefile\" rel=\"nofollow noreferrer\">pastebin.com/raw/DwAzfWSd/Makefile</a>"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455752748, "post_id": 35469697, "comment_id": 58635597, "body": "@FUZxxl  I wrote the file with tabs again but I still could not compile it with makefile, I can only compile it with manually command. Really thanks again"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455752981, "post_id": 35469697, "comment_id": 58635681, "body": "I copied and pasted your sent to my makefile, unfortunately nothing change, I can only compile it with manually"}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455753137, "post_id": 35469697, "comment_id": 58635748, "body": "Maybe it is your editor. Try to download it unmodified.  In your source directory execute <code>rm Makefile; wget http:&#47;&#47;pastebin.com&#47;raw&#47;DwAzfWSd&#47;Makefile</code>"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455753791, "post_id": 35469697, "comment_id": 58635968, "body": "wouvvv  I download it and it works now, as you said the editor is problem than. Thank you very very much really thanks."}], "tags": [], "owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "is_accepted": false, "score": 1, "last_activity_date": 1455752575, "last_edit_date": 1455752575, "creation_date": 1455750941, "answer_id": 35469697, "question_id": 35469226, "link": "https://stackoverflow.com/questions/35469226/ubuntu-message-queue-makefile-error/35469697#35469697", "title": "Ubuntu Message Queue Makefile Error", "body": "<p>(Note: The OP has edited the question and fixed the Makefile after this answer)</p>\n\n<p>You have a broken Makefile.<br>\nThe reason why you've even seen the linker error is that you have probably executed <code>make deneme</code>. In that case <code>make</code> will try to compile <code>dename.c</code> with default compiler options (because it did not find a target called <code>deneme</code>) and the default options do not include <code>-lrt</code>.</p>\n\n<p>You have to fix your Makefile (replace <code>deneme1:</code> with <code>deneme:</code>)</p>\n\n<pre><code>all: deneme\n\ndeneme: deneme.c\n    gcc -g -Wall -o deneme deneme.c -lrt\n\nclean:\n    rm -f deneme *~ *.o\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751210, "post_id": 35469705, "comment_id": 58635018, "body": "thanks a lot , I changed the second line but it still give the same error"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751296, "post_id": 35469705, "comment_id": 58635055, "body": "What did you type to build the program? Just <code>make</code>? Can you show me your corrected makefile?"}, {"owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751593, "post_id": 35469705, "comment_id": 58635162, "body": "yes I write just    &quot;make deneme&quot;  but it cannot compile it and I corrected my makefile in my question also"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "edited": false, "score": 0, "creation_date": 1455751666, "post_id": 35469705, "comment_id": 58635198, "body": "@IremHerguner Make sure the <code>gcc -g ...</code> line is prefixed with a tabulator, not spaces! Makefiles require you to use tabulators for indentation, spaces may not work."}, {"owner": {"reputation": 1912, "user_id": 2599567, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zLvLW.jpg?s=128&g=1", "display_name": "gollum", "link": "https://stackoverflow.com/users/2599567/gollum"}, "edited": false, "score": 0, "creation_date": 1455789843, "post_id": 35469705, "comment_id": 58650572, "body": "We wants it, we needs it. Must have the precious. They stole it from us. Sneaky little @FUZxxl. Wicked, tricksy, false! (J.R.R. Tolkien).  ;)"}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1455750993, "creation_date": 1455750993, "answer_id": 35469705, "question_id": 35469226, "link": "https://stackoverflow.com/questions/35469226/ubuntu-message-queue-makefile-error/35469705#35469705", "title": "Ubuntu Message Queue Makefile Error", "body": "<p>The problem with your Makefile is that your <code>all</code> target depends on <code>demene</code> but the target that specifies <code>-lrt</code> is called <code>demene1</code>. Thus, the default inference rules kick in and <code>demene</code> is attempted to be linked without <code>-lrt</code>. The rule for <code>deneme1</code> is also wrong in that it attempts to create a binary named <code>deneme</code>, even though the rule should create <code>deneme1</code>. To resolve this, change the first to third lines to</p>\n\n<pre><code>all: deneme1\ndeneme1: deneme.c\n    gcc -g -Wall -o deneme1 deneme.c -lrt\n</code></pre>\n\n<p>or the second line to</p>\n\n<pre><code>deneme: deneme.c\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3767474, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/15a7c167d3f2fad257e7d937539dc9aa?s=128&d=identicon&r=PG&f=1", "display_name": "Irem Herguner", "link": "https://stackoverflow.com/users/3767474/irem-herguner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 35469705, "answer_count": 2, "score": 1, "last_activity_date": 1455752575, "creation_date": 1455748901, "last_edit_date": 1455751133, "question_id": 35469226, "link": "https://stackoverflow.com/questions/35469226/ubuntu-message-queue-makefile-error", "title": "Ubuntu Message Queue Makefile Error", "body": "<p>I have a problem with message queues in C in Ubuntu. I use VirtualBox to run the Ubuntu.</p>\n\n<p>I took error which is \"undefined reference to mq_open. ld returned 1 exit status\".</p>\n\n<p>I know there is a same question as this but I tried that solution but it did not worked, so I want to ask again. Please help!</p>\n\n<p>Here is my code, it is really simple but I can not even compile it.</p>\n\n<p>this is my deneme.c </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;mqueue.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/stat.h&gt;\n\n#include \"sharedMsg.h\"\n\nint main()\n{\n  mqd_t mq;\n  mq = mq_open(MQNAME, O_RDWR | O_CREAT, 0666, NULL);\n}\n</code></pre>\n\n<p>this is my sharedMsg.h</p>\n\n<pre><code>struct item{\n  char *word;\n  int lineNum;\n};\n\n#define MQNAME \"/sentmsg\"\n</code></pre>\n\n<p>and finally this is my MakeFile</p>\n\n<pre><code>all: deneme\ndeneme: deneme.c\n    gcc -g -Wall -o deneme deneme.c -lrt\nclean:\n    rm -fr *~ *.o \n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 2, "creation_date": 1455748435, "post_id": 35468939, "comment_id": 58633810, "body": "You do NOT have strings. You have not left space for the <i>nul-terminating</i> character at the end of each row of characters (e.g. <code>col + 1</code>). You have <i>character arrays</i>. You can write them out using <code>fputc</code>."}, {"owner": {"reputation": 375, "user_id": 3795691, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d492793c9bd6c13f58265e61a3bd6e9a?s=128&d=identicon&r=PG", "display_name": "Mattia Righetti", "link": "https://stackoverflow.com/users/3795691/mattia-righetti"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455748646, "post_id": 35468939, "comment_id": 58633890, "body": "I have to check their length before putting them out. That&#39;s the problem I don&#39;t know how to solve"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455750635, "post_id": 35468939, "comment_id": 58634781, "body": "This is where you have to be a little smart about it. I would suggest making them strings by leaving room for the <i>nul-terminating</i> character and writing the <i>nul-terminating</i> character (<code>0</code>) after you read each word. Otherwise, you will need to store the length of each word. (you generally store this as the <code>1st</code> char in each row -- meaning read each char in the word and start your save loop at <code>j</code> at <code>1</code>, then when you read the last char, you set <code>cruciverba[i][0] = j</code>) When you write them out with <code>fputc</code> you use <code>for (j = 1; j &lt; cruciverba[i][0]; j++)</code>. (more work than strings)"}], "answers": [{"tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 0, "last_activity_date": 1455751741, "creation_date": 1455751741, "answer_id": 35469838, "question_id": 35468939, "link": "https://stackoverflow.com/questions/35468939/reading-from-a-file-and-print-to-another-file/35469838#35469838", "title": "Reading from a File and print to another File", "body": "<pre><code>#define TRIGGER '*'\n\nvoid out(FILE *fileOut, char *buff, int value){\n//this function is output buffer\n    static int pos = 0;\n    if(value == TRIGGER){\n        buff[pos] = '\\0';\n        if(pos &gt;= 2)\n            fprintf(fileOut, \"%s\\n\", buff);\n        pos = 0;\n    } else {\n        buff[pos++] = value;\n    }\n}\n</code></pre>\n\n<p>...</p>\n\n<p>//at main</p>\n\n<pre><code>FILE *fileOut = fopen(\"out.txt\", \"w\");\nint side[2] = {row, col};\nfor(int s = 0; s &lt; 2; ++s){\n    char buff[side[s]+1];\n    *buff = 0;\n    for (int i = 0; i &lt; side[s]; i++) {\n        for (int j = 0; j &lt; side[1-s]; j++) {\n            out(fileOut, buff, s ? cruciverba[j][i] : cruciverba[i][j]);\n        }\n        out(fileOut, buff, TRIGGER);\n    }\n    fprintf(fileOut, \"\\n\");\n}\nfclose(fileOut);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1455766102, "creation_date": 1455766102, "answer_id": 35472265, "question_id": 35468939, "link": "https://stackoverflow.com/questions/35468939/reading-from-a-file-and-print-to-another-file/35472265#35472265", "title": "Reading from a File and print to another File", "body": "<p>This problem is designed to torment you on a number of levels. From <em>character oriented</em> input, character array verses string understanding, array indexing, text file format, and a host of additional subtle issues, this is designed to force you to focus on a character-by-character level.</p>\n\n<p>To begin with you have your data file that contains your array bounds followed by <code>5-rows</code> of <code>7-characters</code> each (you must account for the <code>'\\n'</code> char terminating each line). Your array storage is <code>5-row</code> by <code>6-col</code>. Which means from a <em>character oriented</em> input standpoint, you must account for the read of the <code>'\\n'</code> while ignoring it from a data/index standpoint.</p>\n\n<p>(<strong>note:</strong> while the intent of the problem seems to have you read into a 2D-array, you could read <code>row*col</code> of chars into a 1D array as well -- that approach is not without its challenges either)</p>\n\n<p>After navigating the read into your array, you are faced with output the array, while considering only <code>[A-Za-z]</code> (<code>alpha</code>) characters as part of each line, the <code>'*'</code> characters as a <code>'\\n'</code> and the end of each row as a <code>'\\n'</code> as well.</p>\n\n<p>There is no easy, or one right, way to approach this. Regardless how you do, this is where you are going to have to really focus on indexing gymnastics to arrive at a routine that provides the proper output. The approach below uses a <code>7-char</code> buffer and a buffer-index to buffer each wanted char and to write the buffer to <code>stdout</code> when all conditions are met (e.g. a <code>'*'</code> or end-of-row is reached). Below is a commented example of one way to approach the problem. I have left the second part of manipulating the to you, but with the examples provided here and by BLUEPIXY, you have a couple of examples that show you have to approach handling the indexing. Example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main (int argc, char **argv) {\n\n    int row, col, i, idx, j, c;\n    FILE *fp = argc &gt; 1 ? fopen (argv[1], \"r\") : stdin;\n\n    if (!fp) {  /* validate file open for reading */\n        fprintf (stderr, \"error: file open failed '%s'.\\n\", argv[1]);\n        return 1;\n    }\n    row = col = i = idx = j = c = 0;  /* initialize all values */\n\n    /* validate row and col data read */\n    if (fscanf (fp, \"%d %d%*c\", &amp;row, &amp;col) != 2) {\n        fprintf (stderr, \"error: invalid read of row/col.\\n\");\n        return 1;\n    }\n\n    char cruciverbal[row][col]; /* variable length array to data */\n    char buf[col+1];            /* buffer to assist in printing  */\n\n    for (i = 0; i &lt; row; i++) {         /* for each row in array */\n        for (j = 0; j &lt; col; j++) {     /* for each char in row  */\n            if ((c = fgetc (fp)) == EOF)    /* jump if EOF */\n                goto readdone;\n            else {\n                cruciverbal[i][j] = c;  /* store char in array   */\n            }\n        }\n        fgetc (fp);  /* discard newline in file */\n    }\nreaddone:\n\n    if (fp != stdin) fclose (fp);   /* close file if not stdin   */\n\n    /* print characters to stdout */\n    for (i = 0; i &lt; row; i++) {\n        for (j = 0; j &lt; col; j++) {\n            if (isalpha (cruciverbal[i][j]))    /* if [A-Za-Z]  */\n                buf[idx++] = cruciverbal[i][j]; /* buffer char  */\n            else {\n                if (idx &gt; 1) {          /* check if buffer &gt; 1  */\n                    buf[idx] = 0;       /* nul-terminate buffer */\n                    printf (\"%s\\n\", buf);\n                    idx = 0;            /* reset buffer index   */\n                }\n                else {                  /* if buf &lt; 2, print \\n */\n                    fputc ('\\n', stdout);\n                    continue;\n                }\n            }\n        }   /* if last char in row is [A-Za-z] */\n        if (isalpha (cruciverbal[i][j-1])) {\n            if (idx &gt; 1) {\n                buf[idx] = 0;           /* nul-terminate buffer */\n                printf (\"%s\\n\", buf);\n            }\n            else if (idx == 0)          /* if buffer empty */\n                fputc ('\\n', stdout);   /* output newline  */\n        }\n        idx = 0;                        /* reset buf index */\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Use/Output</strong></p>\n\n<pre><code>$ ./bin/cruciverbal &lt;../dat/56array.txt\nsugli\nodiati\ntiri\ntri\ncd\noe\npoi\n</code></pre>\n\n<p>Look over both answers and let us know if you have any questions.</p>\n"}], "owner": {"reputation": 375, "user_id": 3795691, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d492793c9bd6c13f58265e61a3bd6e9a?s=128&d=identicon&r=PG", "display_name": "Mattia Righetti", "link": "https://stackoverflow.com/users/3795691/mattia-righetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1455766102, "creation_date": 1455747652, "question_id": 35468939, "link": "https://stackoverflow.com/questions/35468939/reading-from-a-file-and-print-to-another-file", "title": "Reading from a File and print to another File", "body": "<p>I have a file test.txt which looks like this:</p>\n\n<pre><code>5 6\nsugli*\nodiati\ntiri*n\ntri*cd\noe*poi\n</code></pre>\n\n<p>The first two numbers are the array dimension in which all these words have to be put. </p>\n\n<p>The code for the following task is (<em>fileIn</em> is the <em>test.txt</em> file):</p>\n\n<pre><code>int row, col;\nfscanf(fileIn, \"%d %d%*c\", &amp;row, &amp;col);\nint cruciverba[row][col];\n\nfor (int i = 0; i &lt; row; i++) {\n    for (int j = 0; j &lt; col; j++) {\n        cruciverba[i][j] = fgetc(fileIn);\n    }\n    char space = fgetc(fileIn);\n}\n</code></pre>\n\n<p>The array is now created. Now I should write a function (or more) that writes string to another file, but not every string in the array, just the ones that have length >= 2 horizontally and vertically. Note that the <code>'*'</code> is the string separator.\nThe goal is to have a output.txt file that contains these strings:</p>\n\n<pre><code>sugli\nodiati\ntiri\ntri\ncd\noe\npoi\n\nsotto\nudire\ngiri\nlai\nit\nco\nindi\n</code></pre>\n\n<p>I know how to output the strings but I don't have any idea how to approach the issue. Any suggestion?  </p>\n"}, {"tags": ["c", "unix", "conio"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455747543, "post_id": 35468862, "comment_id": 58633422, "body": "1) Use standard C boolean type and constants. Do not use homebrew stuff like <code>TRUE</code>. 2) Use only standard C features. 3) In Linux/Unix use PAM."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 4, "creation_date": 1455747559, "post_id": 35468862, "comment_id": 58633428, "body": "<code>conio.h</code> is a windows-only library. You&#39;ll need to get rid of it and use something in a portable standard."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 1, "creation_date": 1455747654, "post_id": 35468862, "comment_id": 58633469, "body": "@RPGillespie It&#39;s actually and old MS-DOS header. It&#39;s not a library!"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1455747776, "post_id": 35468862, "comment_id": 58633524, "body": "@iharob I use the word &quot;library&quot; very loosely - It could mean header file, package, object archive, shared object, etc."}, {"owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455747995, "post_id": 35468862, "comment_id": 58633627, "body": "can&#39;t we just use <code>if, #elif, #else, and #endif </code> Directives to switch between the libraries? @RPGillespie ?"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455748154, "post_id": 35468862, "comment_id": 58633679, "body": "Yes, you can use preprocessor directives for windows or linux-only code"}, {"owner": {"user_type": "does_not_exist", "display_name": "user948581"}, "edited": false, "score": 1, "creation_date": 1455748293, "post_id": 35468862, "comment_id": 58633744, "body": "Don&#39;t take the &quot;portable&quot; word too seriously. At some point your program interacts with the OS and needs to rely on OS-specific features (the console/terminal in your case). You may use conditional compilation, rely on a lib that does it for you or go with the standards (lowest common denominator)."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 1, "creation_date": 1455748320, "post_id": 35468862, "comment_id": 58633757, "body": "Also, have you read this thread yet? <a href=\"http://stackoverflow.com/questions/6856635/hide-password-input-on-terminal\" title=\"hide password input on terminal\">stackoverflow.com/questions/6856635/&hellip;</a>"}, {"owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "edited": false, "score": 0, "creation_date": 1455748548, "post_id": 35468862, "comment_id": 58633857, "body": "Thanks for this, this helps a lot"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1455750485, "post_id": 35468862, "comment_id": 58634712, "body": "On UNIX-like systems, you could either directly call termios (the terminal driver) to turn off echoing or you could use a high-level library like curses or getline. Getline is actually portable and compiles on Windows, too."}], "owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455747480, "creation_date": 1455747355, "question_id": 35468862, "link": "https://stackoverflow.com/questions/35468862/c-making-this-program-portable", "title": "C - making this program portable", "body": "<h1>The idea</h1>\n\n<p>scanning a password entered by the user and showing <code>**********</code> in place of <code>P@$$w00r_D</code></p>\n\n<h1>explaining the code</h1>\n\n<p>inside a <code>while</code> loop keep scanning the characters using <code>getch()</code> and put them into an array <code>password[]</code>, until the user press <code>return</code></p>\n\n<h1>The Code</h1>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\n#define TRUE 1 \n#define P_MAX 25\n\nint main(int argc, char* argv[]) {\n   char password[P_MAX], ch;\n   int i = 0;\n\n   puts(\"Enter the password [MAX 25]: \");\n   while (TRUE) {\n      if (i &lt; 0) {\n         i = 0;\n      }//end if\n      ch = getch();\n\n      if (ch == 13)//return\n         break;\n      if (ch == 8) // BACKSPACE\n      {\n         putch('b');\n         putch(NULL);//Overwrite that character by NULL.\n         putch('b');\n         i--;//Decrement Current Track of Character. (i)\n         continue;\n      }//end if\n          password[i++] = ch;\n          ch = '*';\n      putch(ch);\n   }//end while\n\n   printf(\"\\nPassword Entered : %s\", password);//test\n   getch();\nreturn 0;\n}//end main\n</code></pre>\n\n<h1>Compiling on Unix machine</h1>\n\n<pre><code>[ar.lnx@host Documents] $ gcc 115.c -o x\n115.c:2:18: fatal error: conio.h: No such file or directory\ncompilation terminated.\n[ar.lnx@host Documents] $\n</code></pre>\n\n<p>this code works fine on windows, but not in Unix.\nany help?</p>\n"}, {"tags": ["c", "unit-testing", "gcc", "gcov"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455746840, "post_id": 35468712, "comment_id": 58633097, "body": "You really should not use ancient ANSI-C. At least use C99, better standard C."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455746964, "post_id": 35468712, "comment_id": 58633156, "body": "i need the library to be c89 compliant because of the obscure platforms i will be delivering to. is that relevant to gcov&#39;s operation?"}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455747481, "post_id": 35468712, "comment_id": 58633396, "body": "(obviously the <i>real</i> library is more complicated than what i&#39;ve posted here. this is just the MCVE version.)"}], "answers": [{"comments": [{"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1455759803, "post_id": 35470852, "comment_id": 58637895, "body": "i&#39;ve tried replacing the two compile flags with <code>--coverage</code> and the error persists. according to the page you linked, the <code>-ftest-coverage</code> already implied <code>-lgcov</code>."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1455760049, "post_id": 35470852, "comment_id": 58637976, "body": "if i change the CFLAGS variable in my makefile to use <code>--coverage</code> rather than the two flags i was originally using <i>and</i> add the <code>-lgcov</code> option to the linking step, it successfully builds and links the program but when trying to run gcov it says &quot;mylib.gcno:cannot open graph file&quot;."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1455760893, "post_id": 35470852, "comment_id": 58638235, "body": "it seems to be storing the libmylib.gcno and libmylib.gcda files in the lib folder, although the unittest.gc** files are in the root directory."}, {"owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "edited": false, "score": 0, "creation_date": 1455761455, "post_id": 35470852, "comment_id": 58638375, "body": "aha! in the end, here&#39;s my working makefile: <a href=\"https://gist.github.com/anonymous/8facc7db1ad9d047be63\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/8facc7db1ad9d047be63</a>. if you update your answer with the changed options, i&#39;ll gladly mark it as accepted. namely, i didn&#39;t need to add any options when compiling the test suite, and needed the -o when running gcov."}], "tags": [], "owner": {"reputation": 4501, "user_id": 5747415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WgeaU.jpg?s=128&g=1", "display_name": "Dirk Herrmann", "link": "https://stackoverflow.com/users/5747415/dirk-herrmann"}, "is_accepted": true, "score": 3, "last_activity_date": 1455790665, "last_edit_date": 1455790665, "creation_date": 1455757242, "answer_id": 35470852, "question_id": 35468712, "link": "https://stackoverflow.com/questions/35468712/how-do-i-unit-test-a-dynamic-library-using-gcov/35470852#35470852", "title": "How do I unit-test a dynamic library using gcov?", "body": "<p>You need to give the command line argument <code>-lgcov</code> for the linker (normally <code>-ftest-coverage</code> implies <code>-lgcov</code>, but you have a separate linking step where <code>-ftest-coverage</code> is not given as a command line argument).  Alternatively, you can just use the <code>--coverage</code> command line argument, which is a shortcut also for <code>-fprofile-arcs</code> and <code>-ftest-coverage</code>, as explained here: <a href=\"http://www.univ-orleans.fr/sciences/info/ressources/webada/doc/gnat/gcc_3.html\" rel=\"nofollow\">http://www.univ-orleans.fr/sciences/info/ressources/webada/doc/gnat/gcc_3.html</a>:</p>\n\n<blockquote>\n  <p>--coverage</p>\n  \n  <p>This option is used to compile and link code instrumented for\n  coverage analysis. The option is a synonym for `-fprofile-arcs'\n  `-ftest-coverage' (when compiling) and `-lgcov' (when linking). See\n  the documentation for those options for more details.</p>\n</blockquote>\n\n<p>At the same place, btw., it is also explained that you don't have to compile all files with these options, which hopefully answers your question 2.</p>\n"}], "owner": {"reputation": 6477, "user_id": 3961271, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2cKoq.jpg?s=128&g=1", "display_name": "Woodrow Barlow", "link": "https://stackoverflow.com/users/3961271/woodrow-barlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 0, "accepted_answer_id": 35470852, "answer_count": 1, "score": 4, "last_activity_date": 1455790665, "creation_date": 1455746708, "question_id": 35468712, "link": "https://stackoverflow.com/questions/35468712/how-do-i-unit-test-a-dynamic-library-using-gcov", "title": "How do I unit-test a dynamic library using gcov?", "body": "<p>I am building a dynamically-linked library, and am setting up a simple test suite. I want to use gcov to generate a static code analysis coverage report.</p>\n\n<p>My library is a C file containing function implementations and a header file containing function prototypes. My test suite is simply an application that calls the functions in various ways and confirms the validity of the output.</p>\n\n<p>I am compiling both the library and the test suite with the <code>-fprofile-arcs</code> and <code>-ftest-coverage</code> flags, as described <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Invoking-Gcov.html#Invoking-Gcov\" rel=\"nofollow\">on GNU's guide to GCOV</a>. I am also including the <code>-O0</code> flag to disable compiler optimization and the <code>-g</code> flag to enable debug symbols. The executable generated from the test suite is linked dynamically to the library.</p>\n\n<p>All files compile cleanly and without warning, but it fails to link the test suite to the library -- citing a \"hidden symbol <code>__gcov_merge_add</code>\". If I compile without the <code>-fprofile-arcs</code> and <code>-ftest-coverage</code> flags, the linking succeeds and I am able to run the test suite executable.</p>\n\n<p>So I have a few questions which still aren't resolved after reading the GNU guide to GCOV.</p>\n\n<ol>\n<li>Why is the linking failing? How can I resolve this?</li>\n<li>Do I need to include the profile and coverage flags when compiling <em>both</em> the library and the test suite?</li>\n</ol>\n\n<hr>\n\n<p>Here is my <code>inc/mylib.h</code> file:</p>\n\n<pre><code>#ifndef __MYLIB_H__\n#define __MYLIB_H__\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif /* __cplusplus */\n\nint\nfoo (int a);\n\nint\nbar (int a);\n\n#ifdef __cplusplus\n}\n#endif /* __cplusplus */\n\n#endif /* __MYLIB_H__ */\n</code></pre>\n\n<hr>\n\n<p>Here is my <code>src/mylib.c</code> file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"mylib.h\"\n\nint foo(int a) {\n    if (a &gt; 5) {\n        return 5;\n    }\n    return a;\n}\n\nint bar(int a) {\n    if (a &lt; 0) {\n        return 0;\n    }\n    return a;\n}\n</code></pre>\n\n<hr>\n\n<p>Here is my <code>test/unittests.c</code> file:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"mylib.h\"\n\nvoid run_foo_tests() {\n    int inputs[] = {3, 6};\n    int expected_results[] = {3, 5};\n    int i, actual_result;\n\n    for ( i = 0; i &lt; sizeof(inputs) / sizeof(int); i++ ) {\n        actual_result = foo(inputs[i]);\n        if (actual_result == expected_results[i]) {\n            printf(\"Test %d passed!\\n\", i + 1);\n        } else {\n            printf(\"Test %d failed!\\n\", i + 1);\n            printf(\"  Expected result: %d\\n\", expected_results[i]);\n            printf(\"  Actual result: %d\\n\", actual_result);\n        }\n    }\n}\n\nvoid run_bar_tests() {\n    int inputs[] = {3, -1};\n    int expected_results[] = {3, 0};\n    int i, actual_result;\n\n    for ( i = 0; i &lt; sizeof(inputs) / sizeof(int); i++ ) {\n        actual_result = bar(inputs[i]);\n        if (actual_result == expected_results[i]) {\n            printf(\"Test %d passed!\\n\", i + 1);\n        } else {\n            printf(\"Test %d failed!\\n\", i + 1);\n            printf(\"  Expected result: %d\\n\", expected_results[i]);\n            printf(\"  Actual result: %d\\n\", actual_result);\n        }\n    }\n}\n\nint main(int argc, char *argv[]) {\n    run_foo_tests();\n    run_bar_tests();\n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Here is my <code>Makefile</code>:</p>\n\n<pre><code>CC=gcc\nCFLAGS=-Wall -std=c89 -g -O0 -Iinc -fprofile-arcs -ftest-coverage\n\nall: clean build run_tests\n\nbuild:\n    $(CC) $(CFLAGS) -fPIC -c src/*.c -o lib/mylib.o\n    $(CC) -shared lib/mylib.o -o lib/libmylib.so\n    $(CC) $(CFLAGS) test/*.c -o bin/unittests -Llib -lmylib\n\nrun_tests:\n    LD_LIBRARY_PATH=lib bin/unittests\n    gcov src/*.c\n\nclean:\n    rm -f *.gcda *.gcno *.gcov\n    rm -rf bin lib ; mkdir bin lib\n</code></pre>\n\n<hr>\n\n<p>When I run <code>make</code>, I am presented with this output:</p>\n\n<pre><code>rm -f *.gcda *.gcno *.gcov\nrm -rf bin lib ; mkdir bin lib\ngcc -Wall -std=c89 -g -O0 -Iinc -fprofile-arcs -ftest-coverage -fPIC -c src/*.c -o lib/mylib.o\ngcc -shared lib/mylib.o -o lib/libmylib.so\ngcc -Wall -std=c89 -g -O0 -Iinc -fprofile-arcs -ftest-coverage test/*.c -o bin/unittests -Llib -lmylib\n/usr/bin/ld: bin/unittests: hidden symbol `__gcov_merge_add' in /usr/lib/gcc/x86_64-redhat-linux/4.8.5/libgcov.a(_gcov_merge_add.o) is referenced by DSO\n/usr/bin/ld: final link failed: Bad value\ncollect2: error: ld returned 1 exit status\nmake: *** [build] Error 1\n</code></pre>\n"}, {"tags": ["file", "permissions", "c"], "comments": [{"owner": {"reputation": 4222, "user_id": 2072269, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/xNPjb.png?s=128&g=1", "display_name": "muru", "link": "https://stackoverflow.com/users/2072269/muru"}, "edited": false, "score": 3, "creation_date": 1455746630, "post_id": 35470136, "comment_id": 58635779, "body": "This probably should be asked on <a href=\"https://security.stackexchange.com\">Information Security</a>, though I have a feeling they&#39;d prefer <a href=\"https://stackoverflow.com\">Stack Overflow</a>."}, {"owner": {"reputation": 586, "user_id": 5216673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb5d8b8e0713574ae9a4836651a39e56?s=128&d=identicon&r=PG", "display_name": "thrig", "link": "https://stackoverflow.com/users/5216673/thrig"}, "edited": false, "score": 0, "creation_date": 1455749713, "post_id": 35470136, "comment_id": 58635780, "body": "The attacker would regardless only have to win the last gap between the  access/fopen calls, and the naive brute force attack of spamming symlink/unlink calls would not be influenced by the added complexity of some sort of for loop."}, {"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 2, "creation_date": 1455752879, "post_id": 35470136, "comment_id": 58635781, "body": "I&#39;m voting to close this question as off-topic because it&#39;s about programming and security. It would be better off on <a href=\"https://security.stackexchange.com\">Information Security</a>, though <a href=\"https://stackoverflow.com\">Stack Overflow</a> would work too."}], "answers": [{"tags": [], "owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "is_accepted": true, "score": 0, "last_activity_date": 1455777371, "creation_date": 1455777371, "answer_id": 35474492, "question_id": 35470136, "link": "https://stackoverflow.com/questions/35470136/stopping-race-conditions-by-adding-race-conditions/35474492#35474492", "title": "Stopping Race Conditions by Adding Race Conditions?", "body": "<p>Generally, when implementing security solutions, it is considered dangerous to reinvent the wheel. This is particular true for cryptographic operations, but this is another example. You really want to understand all the ins and outs of attackers methods before you attempt to defeat them. </p>\n\n<p>For example, on the OWASP website (<a href=\"https://www.owasp.org/index.php/File_Access_Race_Condition:_TOCTOU\" rel=\"nofollow\">here</a>) it mentions that attackers have techniques to increase the size of the timing window - so you should understand those techniques among others. </p>\n\n<p>Short of that kind of thorough understanding, go with a well vetted solution, such as the one described <a href=\"https://www.securecoding.cert.org/confluence/display/c/FIO45-C.+Avoid+TOCTOU+race+conditions+while+accessing+files\" rel=\"nofollow\">here</a> which uses the 'wx' flag to <code>fopen()</code></p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1455753182, "question_id": 263948}, "owner": {"reputation": 3909, "user_id": 2757398, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/D7ZKF.jpg?s=128&g=1", "display_name": "Nick Gilbert", "link": "https://stackoverflow.com/users/2757398/nick-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 35474492, "answer_count": 1, "score": 1, "last_activity_date": 1455777371, "creation_date": 1455746366, "question_id": 35470136, "link": "https://stackoverflow.com/questions/35470136/stopping-race-conditions-by-adding-race-conditions", "title": "Stopping Race Conditions by Adding Race Conditions?", "body": "<p>I'm doing a theoretical exercise for a class. We are given this snippit of UNIX C code which is vulnerable to race conditions between the access() call and the open() call.</p>\n\n<pre><code>/*  vulp.c  */\n\n#include &lt;stdio.h&gt;\n#include&lt;unistd.h&gt;\n\n#define DELAY 10000\n\nint main()\n{\n   char * fn = \"/tmp/XYZ\";\n   char buffer[60];\n   FILE *fp;\n   long int  i;\n\n   /* get user input */\n   scanf(\"%50s\", buffer );\n\n   if(!access(fn, W_OK)){\n       /* simulating delay */\n        for (i=0; i &lt; DELAY; i++){\n           int a = i^2; \n        }\n\n        fp = fopen(fn, \"a+\");\n        fwrite(\"\\n\", sizeof(char), 1, fp);\n        fwrite(buffer, sizeof(char), strlen(buffer), fp);\n        fclose(fp);\n   }\n   else printf(\"No permission \\n\");\n}\n</code></pre>\n\n<p>If an attacker were to point to a file they did not own and win the race condition, they could overwrite a file without permission. It seems like this can be fixed by adding more access() and open() calls so that there are so many race conditions its virtually impossible to win them all. I figured adding a for loop around the current access and open call would do that but wouldn't that just mean the attacker only has to win the last race condition? If so how can I repeat the access and open calls in a way that preserves the functionality of the program and makes a bad race condition a statistical improbability?</p>\n"}, {"tags": ["c", "linux", "udp", "handle", "polling"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1455750367, "post_id": 35468555, "comment_id": 58634652, "body": "It isn&#39;t likely you will get any errors at all, unless you&#39;ve sent over a connected UDP socket to an unreachable destination, in which case you should disconnect the socket and stop sending to that destination. If you get any other error it is probably fatal, so you should close the socket and exit."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5942675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ccc7481b832daeb521be35e968f291?s=128&d=identicon&r=PG&f=1", "display_name": "julino", "link": "https://stackoverflow.com/users/5942675/julino"}, "edited": false, "score": 0, "creation_date": 1455851377, "post_id": 35487849, "comment_id": 58685458, "body": "Niceeeee answer Mr. Emmerson. Thanks a lot! :)"}], "tags": [], "owner": {"reputation": 7332, "user_id": 204143, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8170ad848a91c4cc534755d37befb6cc?s=128&d=identicon&r=PG", "display_name": "Steve Emmerson", "link": "https://stackoverflow.com/users/204143/steve-emmerson"}, "is_accepted": true, "score": 1, "last_activity_date": 1455827717, "last_edit_date": 1455827717, "creation_date": 1455814947, "answer_id": 35487849, "question_id": 35468555, "link": "https://stackoverflow.com/questions/35468555/poll-handling-with-udp/35487849#35487849", "title": "POLL handling with UDP", "body": "<p>POLLHUP indicates that the socket has been disconnected. Because your program is listening on a UDP socket, you shouldn't get this error condition.</p>\n\n<p>You might get a POLLERR, however, and should be prepared to handle it. The <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/toc.htm\" rel=\"nofollow\">POSIX.1-2008 standard</a> says</p>\n\n<pre><code>POLLERR\nAn error has occurred on the device or stream. This flag is only valid in\nthe revents bitmask; it shall be ignored in the events member.\n</code></pre>\n\n<p>and it's possible that the error is due to a hardware failure. You should destroy the socket and attempt to re-create it.</p>\n\n<p>Unlike TCP, UDP doesn't have a mechanism for marking a packet as urgent or out-of-band, so you should't get a POLLRDBAND or POLLPRI. Also, both of these conditions are optional obsolescent extensions -- so they shouldn't be used according to the POSIX.1-2008 standard:</p>\n\n<pre><code>Obsolescent\nThe functionality described may be removed in a future version of this \nvolume of POSIX.1-2008. Strictly Conforming POSIX Applications and Strictly \nConforming XSI Applications shall not use obsolescent features.\n\nXSI STREAMS\nThe functionality described is optional. The functionality described is also \nan extension to the ISO C standard.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 9199127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce5710e3431b281aea2a9784564c7991?s=128&d=identicon&r=PG&f=1", "display_name": "Marcelo Pacheco", "link": "https://stackoverflow.com/users/9199127/marcelo-pacheco"}, "is_accepted": false, "score": 0, "last_activity_date": 1610266904, "creation_date": 1610266904, "answer_id": 65651322, "question_id": 35468555, "link": "https://stackoverflow.com/questions/35468555/poll-handling-with-udp/65651322#65651322", "title": "POLL handling with UDP", "body": "<p>POLLERR can happen on a SOCK_DGRAM if you send a packet and any ICMP error comes referencing that packet (network unreachable, host unreachable, port unreachable, ...).<br />\nSince the return is asynchronous, the write itself will succeed.</p>\n"}], "owner": {"reputation": 23, "user_id": 5942675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1ccc7481b832daeb521be35e968f291?s=128&d=identicon&r=PG&f=1", "display_name": "julino", "link": "https://stackoverflow.com/users/5942675/julino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 35487849, "answer_count": 2, "score": 1, "last_activity_date": 1610266904, "creation_date": 1455746018, "question_id": 35468555, "link": "https://stackoverflow.com/questions/35468555/poll-handling-with-udp", "title": "POLL handling with UDP", "body": "<p>I've been writing (with almighty C) a server wich listens in UDP. I've got 2 sockets listening on the same port (IPv4 and IPv6) and im using poll() to monitor both sockets.</p>\n\n<p>So, when listening, what is the correct way to handle poll revents erros ? Is possible to receive a POLLHUP? If its possible how it must be handled? Same goes for POLLERR</p>\n\n<p>Also, its possible to receive a POLLRDBAND or POLLPRI? If so then what does it means and how it must be handled?</p>\n\n<p>Thanks in advance.</p>\n\n<p>PS: All questions are UDP-related</p>\n"}, {"tags": ["c", "embedded", "pic"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1455746170, "post_id": 35468533, "comment_id": 58632773, "body": "Suggestions? First ask a question."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1455746299, "post_id": 35468533, "comment_id": 58632842, "body": "1) C does not support <i>methods</i>. 2) Learn <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> 3) Format&amp;indent your code properly. 4) Use prototype-style function declarators."}, {"owner": {"reputation": 121, "user_id": 5939745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16ddb7e06f9dea577428bca5bf300e?s=128&d=identicon&r=PG&f=1", "display_name": "Chogo", "link": "https://stackoverflow.com/users/5939745/chogo"}, "edited": false, "score": 0, "creation_date": 1455746723, "post_id": 35468533, "comment_id": 58633047, "body": "Im sorry about that, I meant functions; I will try to format my code better in future but meanwhile any suggestions"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455746878, "post_id": 35468533, "comment_id": 58633115, "body": "It&#39;s impossible to tell anything without a schematic. And with the schematic it will fit more the <a href=\"http://electronics.stackexchange.com/\">SE EE</a>"}, {"owner": {"reputation": 121, "user_id": 5939745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16ddb7e06f9dea577428bca5bf300e?s=128&d=identicon&r=PG&f=1", "display_name": "Chogo", "link": "https://stackoverflow.com/users/5939745/chogo"}, "edited": false, "score": 0, "creation_date": 1455747128, "post_id": 35468533, "comment_id": 58633234, "body": "I&#39;m actually doing computer science and the code is simulated in mplab x ide and proteus"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5939745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16ddb7e06f9dea577428bca5bf300e?s=128&d=identicon&r=PG&f=1", "display_name": "Chogo", "link": "https://stackoverflow.com/users/5939745/chogo"}, "edited": false, "score": 0, "creation_date": 1455748873, "post_id": 35468965, "comment_id": 58633971, "body": "Sorry for the mix up with methods and functions; I am addicted to java. Anyway thanks for the information. Let me study it detail and see what will come of it"}], "tags": [], "owner": {"reputation": 734, "user_id": 4854929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6wiFm.jpg?s=128&g=1", "display_name": "Darko Djuric", "link": "https://stackoverflow.com/users/4854929/darko-djuric"}, "is_accepted": false, "score": 0, "last_activity_date": 1455747774, "last_edit_date": 1492086765, "creation_date": 1455747774, "answer_id": 35468965, "question_id": 35468533, "link": "https://stackoverflow.com/questions/35468533/embedded-c-code-to-control-a-dc-motor-with-a-pic-microcontroller/35468965#35468965", "title": "Embedded C code to control a DC motor with a PIC microcontroller", "body": "<p>Functions, not methods, to be precise.</p>\n\n<p>So what is exactly the question? </p>\n\n<p>What I can say from a quick look on a source code:</p>\n\n<p>LEDs initialisation should be done as you did in InitializeIO() function. Simply set proper TRISx bits to 0 to configure LED pins as output.</p>\n\n<p>For the PWM and motor control functions you should take some time and try to understand how builtin PWM peripheral works. It is a part of OC (Output Compare) and it is very easy to use. Please, take look on following link <a href=\"http://ww1.microchip.com/downloads/en/DeviceDoc/61111E.pdf\" rel=\"nofollow noreferrer\">http://ww1.microchip.com/downloads/en/DeviceDoc/61111E.pdf</a></p>\n\n<p>and this one for the minimal implementation using builtin peripheral libraries <a href=\"https://electronics.stackexchange.com/questions/69232/pic32-pwm-minimal-example\">https://electronics.stackexchange.com/questions/69232/pic32-pwm-minimal-example</a></p>\n\n<p>Basically you need to set up OC registers to \"make\" OC module acts like PWM. You need to allocate one of the timers to work with OC module (it will be used for base PWM frequency) and that's it. </p>\n\n<p>All you need after that is to set PWM duty cycle value by setting timer PRx register, you don't need to swap bits like in your PWM routine. </p>\n\n<p>To stop it simple stop it simply disable the timer. </p>\n\n<p>To run it again run the timer.</p>\n\n<p>To change direction (it depends of your driver for the motor) I guess you need just to toggle direction pin.</p>\n\n<p>I hope it helps...</p>\n"}], "owner": {"reputation": 121, "user_id": 5939745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df16ddb7e06f9dea577428bca5bf300e?s=128&d=identicon&r=PG&f=1", "display_name": "Chogo", "link": "https://stackoverflow.com/users/5939745/chogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5818, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455770072, "creation_date": 1455745955, "last_edit_date": 1455770072, "question_id": 35468533, "link": "https://stackoverflow.com/questions/35468533/embedded-c-code-to-control-a-dc-motor-with-a-pic-microcontroller", "title": "Embedded C code to control a DC motor with a PIC microcontroller", "body": "<p>Im trying to create an embedded c code to control a dc motor with the PIC32MX460F512L microcontroller. Ive Configured the system clock at 80MHz, and the peripheral clock at 10MHz, Am using Timer 1 for pulsing the PWM with a given duty cycle, and Timer 2 for measuring the motor run time. I have a header file(includes.h) that contains system configuration information eg clock. Ive created most of the functions but some are a bit challenging. For example, initializing the LEDS and the functions for forward, backward movements and stop, I wanted the dc motor to run in forward direction for 4 sec at 70% duty cycle, then stop for 1 sec then reverse for 3 sec at 50% duty cycle and then stop for 1 sec and then forward again for 3 sec at 40% duty cycle, stop for 1 sec and finally forward for 5 sec at 20% duty cycle. Any suggestions for the forward, stop, and reverse functions</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;includes.h&gt;\n\nvoid main()\n{\n    // Setting up PIC modules such as Timers, IOs OCs,Interrupts, ...\n    InitializeIO();\n    InitializeLEDs();\n    InitializeTimers();\n\n    while(1) {\n        WaitOnBtn1();\n        Forward(4.0,70);\n        Stop(1.0);\n        Backward(3.0,50);\n        Stop(2);\n        Forward(3.0,40);\n        Stop(1.0);\n        Backward(2.0,20);\n        LEDsOFF();\n    }\n    return;\n}\n\nvoid InitializeIO(){\n    TRISAbits.TRISA6 = 1;\n    TRISAbits.TRISA7 = 1;\n    TRISGbits.TRISG12 = 0;\n    TRISGbits.TRISB13 = 0;\n    LATGbits.LATB12 = 0;\n    LATGbits.LATB13 = 0;\n    return;\n}\n\nvoid InitializeLEDs(){\n    //code to initialize LEDS\n}\n\nvoid InitializeTimers(){\n    // Initialize Timer1\n    T1CON = 0x0000; // Set Timer1 Control to zeros\n    T1CONbits.TCKPS=3; // prescale by 256\n    T1CONbits.ON = 1; // Turn on Timer\n    PR1= 0xFFFF; // Period of Timer1 to be full\n    TMR1 = 0; // Initialize Timer1 to zero\n    // Initialize Timer2\n    T2CON = 0;\n    T2CONbits.TCKPS = 7; // prescale by 256\n    T2CONbits.T32 = 1; // use 32 bits timer\n    T2CONbits.ON = 1;\n    PR2 = 0xFFFFFFFF; // Period is set for 32 bits\n    TMR2 = 0;\n}\n\nvoid WaitOnBtn1(){\n    // wait on Btn1 indefinitely\n    while(PORTAbits.RA6 == 0);\n\n    // Turn On LED1 indicating it is Btn1 is Pushed\n    LATBbits.LATB10 = 1;\n    return;\n}\n\nvoid Forward(float Sec, int D){\n    int RunTime = (int)(Sec*39000); // convert the total\n    time to number of Tics\n    TMR2 = 0;\n    //LEDs\n    LATGbits.LATG12 = 1; // forward Direction\n    LATBbits.LATB12 = 0;\n    LATBbits.LATB13 = 0;\n    LATBbits.LATB11 = 1;\n    // Keep on firing the PWM as long as Run time is not\n    elapsed\n    while (TMR2 &lt; RunTime){\n        PWM(D);\n    }\n    return;\n}\n\nvoid PWM(int D){\n    TMR1 = 0;\n    int Period = 400;\n    while (TMR1&lt; Period) {\n        if (TMR1 &lt; Period*D/100){\n            LATGbits.LATG13 = 1;\n        }\n        else{\n        LATGbits.LATG13 = 0;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "multithreading", "thread-safety", "pthreads", "pthread-exit"], "comments": [{"owner": {"reputation": 3297, "user_id": 1472828, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2vX5H.jpg?s=128&g=1", "display_name": "HoKy22", "link": "https://stackoverflow.com/users/1472828/hoky22"}, "edited": false, "score": 0, "creation_date": 1455745503, "post_id": 35468398, "comment_id": 58632376, "body": "What are you expecting to see?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455745571, "post_id": 35468398, "comment_id": 58632429, "body": "This is what mutexes are for. Also, you can&#39;t do anything after you call <code>pthread_exit</code> since the thread has exited, so it won&#39;t do the <code>thread = NULL;</code> operation."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455745728, "post_id": 35468398, "comment_id": 58632529, "body": "My expectation was another version of the code above solving the problem I tried to describe. I though about using mutexes but I did not see how it would fix the problem."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455745821, "post_id": 35468398, "comment_id": 58632584, "body": "Yes your doubts are well founded - what you have is called a race condition. Since the <code>thread</code> variable is being accessed by multiple threads you need to properly protect access to it. Most common method is with a mutex. See <a href=\"http://linux.die.net/man/3/pthread_mutex_lock\" rel=\"nofollow noreferrer\"><code>pthread_mutex_lock</code> and <code>pthread_mutex_unlock</code></a> for more details."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1455745992, "post_id": 35468398, "comment_id": 58632674, "body": "Ignoring the <code>pthread_exit</code> problem pointed out by David, and ignoring visibility issues: Imagine if the worker thread sees <code>no_of_handles_running == 0</code>, and so it exits the loop, and then the main thread sees there&#39;s a worker thread running so it doesn&#39;t start one, and then the worker thread exits without seeing the new work."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455746194, "post_id": 35468398, "comment_id": 58632786, "body": "@DavidSchwartz, great catch with the = NULL after thread_exit."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1455746202, "post_id": 35468398, "comment_id": 58632791, "body": "@immibis, Exactly, this is the problem I am trying to solve. Main thread think there is already a worker since it was interrupted before setting thread=NULL and therefore does not start a new one. This is what I am trying to solve."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455746210, "post_id": 35468398, "comment_id": 58632795, "body": "@user1816142 Using a mutex can fix the problem because it ensures only one thread will access the <code>thread</code> variable at any given time. The parts of the code that access a shared resource is referred to as the &quot;critical section&quot;. All critical sections need to be protected by locking the mutex preceding the CS and unlocking after the CS."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455746327, "post_id": 35468398, "comment_id": 58632863, "body": "@user1816142 That&#39;s exactly the problem a mutex would solve."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455746897, "post_id": 35468398, "comment_id": 58633122, "body": "@DavidSchwartz, Thanks for trying to help guys. Maybe I am just tired, I added an example above with a mutex but I still fear I might have the same problem."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455747115, "post_id": 35468398, "comment_id": 58633227, "body": "Your <code>pthread_mutex_unlock</code> is in the wrong spot in <code>start_worker_thread_if_needed</code>. It needs to go after the <code>if</code> block (ie, you must always unlock the mutex). Other than that it should work fine. Oh, assuming you have correctly initialised <code>my_mutex</code> of course (that is not shown)."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1455747380, "post_id": 35468398, "comment_id": 58633358, "body": "Why exit the thread? why not have the thread sleep while there&#39;s nothing to do? I would consider using a blocking pipe IO to send messages to the thread. The thread will simply block on an IO read until it receives a task through the pipe. You ca look into <a href=\"https://github.com/boazsegev/c-server-tools/blob/master/lib/libasync.c\" rel=\"nofollow noreferrer\">this library</a> as an example for using pipes for thread communication."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455748031, "post_id": 35468398, "comment_id": 58633643, "body": "@kaylum, sorry about the unlock, that was a silly mistake. The init is not shown, I just did this as a quick example.  I still have the feeling that if that if we exit the loop but get interrupted before the worker thread can take the lock, then the main thread will take the lock, see that there is already a worker thread running and do nothing.   Then the worker can continue but now it is outside the while loop, it sets the worker to NULL and exits. However the previous call from the main thread is lost right since no worker was started and the old one had already left the while loop :-)"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455748384, "post_id": 35468398, "comment_id": 58633791, "body": "It sounds like you could be right. But it is difficult to recommend a full solution for you because your code is incomplete. In particular, it appears that <code>no_of_handles_running</code> is also a shared variable that can be accessed by multiple threads which would mean it also needs to be protected. Also, as asked above already..why do you exit the worker thread at all? Why not just let it wake up periodically to do its polling (or better still, signal it to wake up when there is work to be done)?"}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455748723, "post_id": 35468398, "comment_id": 58633914, "body": "no_of_handles_running is safe it is only used inside the poll function which is only called by the worker thread so that part is ok. For the frequency I need it to be super responsive when the is work to do so I do not want a longer sleep. On the other hand jobs might be infrequent so I do not want a thread doing 20 msec polling if not needed."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455748901, "post_id": 35468398, "comment_id": 58633981, "body": "Ok but there must be something inside the poll function which is shared with other threads. Because other threads need to queue up work for the poll function. Is that not the case? Also, for responsiveness you should not be using polling at all then. Your code should  be event driven - that is, the worker thread is woken up exactly when there is something to do."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455748912, "post_id": 35468398, "comment_id": 58633987, "body": "The signal part of your comment is interesting. This is for a cross platform project. Is there such a mechanism built into posix?"}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455749016, "post_id": 35468398, "comment_id": 58634035, "body": "Yes the active handles value is provided by libcurl. I ask for it inside the poll function."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455749089, "post_id": 35468398, "comment_id": 58634075, "body": "Indeed libcurl can be used with libev but my code currently does not support that version."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455749254, "post_id": 35468398, "comment_id": 58634150, "body": "Again, it is difficult to tell you what to do without the full context of your requirements. There are many different ways to implement event driven logic. For example, if you can monitor file descriptors then <a href=\"http://linux.die.net/man/2/poll\" rel=\"nofollow noreferrer\"><code>poll</code></a> or <a href=\"http://linux.die.net/man/2/select\" rel=\"nofollow noreferrer\"><code>select</code></a> can be used. If your requirements are broader then another option is condition variables - see <a href=\"http://linux.die.net/man/3/pthread_cond_wait\" rel=\"nofollow noreferrer\"><code>pthread_cond_wait</code></a> and <a href=\"http://linux.die.net/man/3/pthread_cond_signal\" rel=\"nofollow noreferrer\"><code>pthread_cond_signal</code></a>."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "edited": false, "score": 0, "creation_date": 1455749630, "post_id": 35468398, "comment_id": 58634328, "body": "Thank you so much for your suggestions. I will read up on condition variables first thing tomorrow morning (it is midnight here)."}, {"owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455791666, "post_id": 35468398, "comment_id": 58651793, "body": "@kaylum. Many thanks for the pointer on condition variables. I think it did exactly what I needed. Posted final code below."}], "answers": [{"tags": [], "owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "is_accepted": false, "score": 0, "last_activity_date": 1455795261, "last_edit_date": 1455795261, "creation_date": 1455791617, "answer_id": 35478981, "question_id": 35468398, "link": "https://stackoverflow.com/questions/35468398/posix-pthread-worker-that-is-only-running-when-needed/35478981#35478981", "title": "Posix pthread worker that is only running when needed", "body": "<p>Thanks to for all the help in the comments above. Kaylums suggestion to use condition variables seems to be a good approach to not risk ending up with the corner case I was concerned about.</p>\n\n<p>The final code (with logs removed) is the one below and it appears to work just fine.</p>\n\n<pre><code>static int no_of_handles_running;\nstatic int RUN_THREAD = 0;\npthread_t thread = NULL;\npthread_mutex_t mutex = PTHREAD_MUTEX_INITIALIZER;\npthread_cond_t cv  = PTHREAD_COND_INITIALIZER;;\n\nvoid *worker_thread(void *threadid)\n{\n    RUN_THREAD = 1;\n    do {\n        poll();  //Will update no_of_handles_running\n        if (no_of_handles_running == 0) {\n            pthread_mutex_lock(&amp;mutex);\n            pthread_cond_wait(&amp;cv, &amp;mutex);\n            pthread_mutex_unlock(&amp;mutex);\n        }\n    } while (RUN_THREAD);\n    thread = NULL;\n    pthread_exit(NULL);\n\n}\nvoid start_worker_thread() {\n    if (thread == NULL) {\n        int rc = pthread_create(&amp;thread, NULL, worker_thread, NULL);\n        if (rc){\n            return;\n        } \n    }\n    pthread_mutex_lock(&amp;mutex);\n    pthread_cond_signal(&amp;cv);\n    pthread_mutex_unlock(&amp;mutex);\n}\n\nvoid stop_worker_thread() {\n    RUN_THREAD = 0;\n    pthread_mutex_lock(&amp;mutex);\n    pthread_cond_signal(&amp;cv);\n    pthread_mutex_unlock(&amp;mutex);\n}\n</code></pre>\n"}], "owner": {"reputation": 487, "user_id": 1816142, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ec9a94911c92b7a2e1eb00af2d7acc2a?s=128&d=identicon&r=PG", "display_name": "user1816142", "link": "https://stackoverflow.com/users/1816142/user1816142"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455795261, "creation_date": 1455745435, "last_edit_date": 1455747741, "question_id": 35468398, "link": "https://stackoverflow.com/questions/35468398/posix-pthread-worker-that-is-only-running-when-needed", "title": "Posix pthread worker that is only running when needed", "body": "<p>I have a worker thread doing a polling activity (it's targeting libcurl but that is not relevant).</p>\n\n<p>Many actions from the application can start a worker thread but if it is already running, no new thread should be created. A new request from the application is simply joined with any other polling already ongoing.</p>\n\n<p>In summary, a single worker thread that exits when there is nothing left to do.</p>\n\n<p>The code is:</p>\n\n<pre><code>pthread_t thread = NULL;\nstruct timespec sleep_val = {0, 20000000};\nvoid *worker_thread(void *threadid)\n{\n    do {\n        poll();\n        nanosleep(&amp;sleep_val, NULL);\n    } while (no_of_handles_running &gt; 0);\n    pthread_exit(NULL);\n    thread = NULL;\n}\n\nvoid start_worker_thread_if_needed() {\n    if (thread == NULL) {\n        pthread_create(&amp;thread, NULL, worker_thread, NULL);\n    }\n}\n</code></pre>\n\n<p>My doubt is about thread safety. The function start_worker_thread_if_needed() can be called at any time any number of times.</p>\n\n<p>So, what if start_worker_thread_if_needed() is called exactly when we exit the while loop and therefor interrupts the worker thread. If that happens the condition if (thread == NULL) will be FALSE since the worker thread is interrupted and pthread_exit + thread = NULL has not yet completed. </p>\n\n<p>So now start_worker_thread_if_needed() will exit without creating a new thread but as soon as control is returned to the old worker thread it will continue to the pthread_exit line and the worker thread is destroyed.</p>\n\n<p>The issue will be that the request that was just made triggering start_worker_thread_if_needed() will be lost and the polling will not start until the next call to start_worker_thread_if_needed().</p>\n\n<p>Edit: Here is a suggestion with mutex but I still have the same doubt. What happens if the main thread interrupts just after we exit the while loop and before the worker can take the mutex. Then the main thread does not create a new thread and then the worker exit.</p>\n\n<pre><code>void *worker_thread(void *threadid)\n{\n    do {\n        poll();\n        nanosleep(&amp;sleep_val, NULL);\n    } while (no_of_handles_running &gt; 0);\n    pthread_mutex_lock(&amp;my_mutex);\n    thread = NULL;\n    pthread_mutex_unlock(&amp;my_mutex);\n    pthread_exit(NULL);\n}\n\nvoid start_worker_thread_if_needed() {\n    pthread_mutex_lock(&amp;my_mutex);\n    if (thread == NULL) {\n        pthread_create(&amp;thread, NULL, worker_thread, NULL);\n    }\n    pthread_mutex_unlock(&amp;my_mutex);\n}\n</code></pre>\n\n<p>I think I have a flaw in how I have set this up and it would be highly appreciated if someone could help out with the proper solution.</p>\n"}, {"tags": ["c", "assembly", "return-type"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 4, "creation_date": 1455745215, "post_id": 35468163, "comment_id": 58632199, "body": "&#39;Monotone tenure princess&#39; lol, have an upvote just for that:)"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 3, "creation_date": 1455746089, "post_id": 35468163, "comment_id": 58632730, "body": "Assembly has no concept of a &quot;return type&quot;, nor an &quot;argument&quot;."}, {"owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1455746345, "post_id": 35468163, "comment_id": 58632871, "body": "can you further explain @immibis ? if such is the case I find it difficult to understand how I would write a meaningful function based on the assembly. I know now from this question asked, <a href=\"http://stackoverflow.com/questions/6171172/return-value-of-a-c-function-to-asm\" title=\"return value of a c function to asm\">stackoverflow.com/questions/6171172/&hellip;</a> that the register being used to return can help determine the return type, I am still working on the arguments."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455747500, "post_id": 35468163, "comment_id": 58633407, "body": "Assembly language has a <i>calling convention</i> which you use to determine what is passed above. You see <code>rdi</code>, <code>rsi</code> and <code>rdx</code> used. It just so happens, the 64-bit calling convention uses the first six integer arguments (from the left) which are passed in RDI, RSI, RDX, RCX, R8, and R9, in that order. So there are 3 arguments passed to your function in RDI, RSI, and RDX."}, {"owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455747565, "post_id": 35468163, "comment_id": 58633433, "body": "@DavidC.Rankin that is good news, thats what I was starting to think! Thank you."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1455747573, "post_id": 35468163, "comment_id": 58633440, "body": "@ChristopherJakob I mean exactly what I said - there is no such thing as a return type, or an argument, in assembly. C has them, but assembly doesn&#39;t. And you can do certain things in assembly that have the effect of passing arguments or return values in C. But those are to do with the way C is translated to assembly, not assembly itself."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1455747839, "post_id": 35468163, "comment_id": 58633554, "body": "This is, I think, an unfair assignment. You could write C code which would produce equivalent assembly when compiled, but as to the argument types, who can say? maybe <code>int</code>, maybe <code>unsigned int</code>, maybe something else..."}, {"owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1455747929, "post_id": 35468163, "comment_id": 58633596, "body": "@immibis that is something I know, thank you for the insight. I should have reworded my question. What I was trying to say is how can I translate a C return statement and arguments passed from assembly. I see now that its in the calling convention and return register."}], "answers": [{"comments": [{"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 1, "creation_date": 1455747597, "post_id": 35468306, "comment_id": 58633446, "body": "&quot;addq %rdi, %rdx&quot; adds rdi to rdx. Where do you suppose the initial value of rdx comes from? (Hint: you may be wrong about it being only two arguments)."}, {"owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "reply_to_user": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "edited": false, "score": 0, "creation_date": 1455747783, "post_id": 35468306, "comment_id": 58633528, "body": "@davmac yep, you&#39;re right, I noticed that it was three when I realized I was being silly about the second add command. Thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1551592"}, "edited": false, "score": 0, "creation_date": 1455752007, "post_id": 35468306, "comment_id": 58635339, "body": "@ChristopherJakob Look into the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">System V ABI</a>, it describes which argument is what register."}], "tags": [], "owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "is_accepted": false, "score": 0, "last_activity_date": 1455745184, "last_edit_date": 1495535282, "creation_date": 1455745184, "answer_id": 35468306, "question_id": 35468163, "link": "https://stackoverflow.com/questions/35468163/determining-the-return-type-of-a-function-in-assembly/35468306#35468306", "title": "determining the return type of a function in assembly", "body": "<p>this post, answers my question for the most part. <a href=\"https://stackoverflow.com/questions/6171172/return-value-of-a-c-function-to-asm\">Return value of a C function to ASM</a> I didn't see this until I completely rethought my search word choice. I still am trying to figure out the number of arguments passed into the function. if I am correct though ` </p>\n\n<pre><code>addq    %rsi, %rdi\naddq    %rdi, %rdx\n</code></pre>\n\n<p>these two lines show me that two aguments  are passed. one is stored in <code>&amp;rsi</code> the other stored in <code>%rdi</code></p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455756280, "post_id": 35468810, "comment_id": 58636728, "body": "The 2nd paragraph isn&#39;t really relevant here, this is a leaf function and it&#39;s only using registers that hold its args."}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1455758151, "post_id": 35468810, "comment_id": 58637343, "body": "The assembly is quite obviously using <code>x86-64</code>, which has different calling conventions entirely."}], "tags": [], "owner": {"reputation": 241, "user_id": 5731628, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-VjD-gt13QCQ/AAAAAAAAAAI/AAAAAAAAAHs/fb3YMM5Ta_c/photo.jpg?sz=128", "display_name": "c_mnon", "link": "https://stackoverflow.com/users/5731628/c-mnon"}, "is_accepted": true, "score": 1, "last_activity_date": 1455747432, "last_edit_date": 1455747432, "creation_date": 1455747123, "answer_id": 35468810, "question_id": 35468163, "link": "https://stackoverflow.com/questions/35468163/determining-the-return-type-of-a-function-in-assembly/35468810#35468810", "title": "determining the return type of a function in assembly", "body": "<p>You should look at the calling convention for the processor/platform to understand the low level implementation.</p>\n\n<p>Before calling a subroutine, the caller should save the contents of certain registers that are designated caller-saved. The caller-saved registers are EAX, ECX, EDX[x86]. Since the called subroutine is allowed to modify these registers, if the caller relies on their values after the subroutine returns, the caller must push the values in these registers onto the stack (so they can be restore after the subroutine returns.\nTo pass parameters to the subroutine, push them onto the stack before the call. The parameters should be pushed in inverted order (i.e. last parameter first). Since the stack grows down, the first parameter will be stored at the lowest address (this inversion of parameters was historically used to allow functions to be passed a variable number of parameters). [ from x86 calling convention]</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455748000, "post_id": 35468983, "comment_id": 58633632, "body": "It&#39;s the SysV calling convention, used by everything but Windows. (Linux, OS X, Solaris, etc.)"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455748010, "post_id": 35468983, "comment_id": 58633634, "body": "There is a defined calling convention for X86_64, so you do know what the order is."}, {"owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455748237, "post_id": 35468983, "comment_id": 58633724, "body": "@DavidC.Rankin I didn&#39;t know the calling convention (SysV). Without that I couldn&#39;t say what the order of args is. BTW there isn&#39;t a single x86_64 calling convention as Peter points outs."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455748276, "post_id": 35468983, "comment_id": 58633739, "body": "I understand, that&#39;s why you didn&#39;t get dinged for it <code>:)</code>"}], "tags": [], "owner": {"reputation": 3123, "user_id": 2460798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb86705efc70171089a2ec34b6c856b4?s=128&d=identicon&r=PG", "display_name": "\u03a7p\u1e98", "link": "https://stackoverflow.com/users/2460798/%ce%a7p%e1%ba%98"}, "is_accepted": false, "score": 1, "last_activity_date": 1455747825, "creation_date": 1455747825, "answer_id": 35468983, "question_id": 35468163, "link": "https://stackoverflow.com/questions/35468163/determining-the-return-type-of-a-function-in-assembly/35468983#35468983", "title": "determining the return type of a function in assembly", "body": "<p>There are 3 arguments. They are rsi, rdi and rdx. Return value is in rax. Function sums the three arguments. Arguments can be signed or unsigned, as Addq works with both. All arguments and return value should be considered to have same type (signed or unsigned 64 bit integers).</p>\n\n<p>This is a calling convention I've never seen on x64. So after converting to C the compiler won't generate the same assembly unless you specify a custom calling convention (assuming the compiler supports that). </p>\n\n<p>Once you define a calling convention you can say what the order of the arguments is. Until then you don't know if rsi/rdi/rdx is first, second, or third arg.</p>\n"}, {"comments": [{"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1455764438, "post_id": 35469047, "comment_id": 58639130, "body": "Clearly from the output it is Redhat Linux ;-)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1455764851, "post_id": 35469047, "comment_id": 58639258, "body": "@MichaelPetch: Are you making fun of my &quot;obviously&quot;?  That&#39;s fair. :)  I sometimes get annoyed with &quot;easy&quot; questions and talk down in reply to them.  By the time I&#39;ve read the question to see if it&#39;s really as simple as it appears, I already have a reply in mind.  Often I start it as a comment, then realize that it&#39;s turned into an answer, and post it as such."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1455765057, "post_id": 35469047, "comment_id": 58639325, "body": "I placed a winky smiley face on the end. I was just joking around. You may say why I chose Redhat Linux. Can&#39;t tell from the code presented but I happened to notice this: <a href=\"https://ideone.com/nuu1Ao\" rel=\"nofollow noreferrer\">ideone.com/nuu1Ao</a> (the very bottom suggests output was Redhat). I went searching because I thought something might have been missing from the question."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1455766147, "post_id": 35469047, "comment_id": 58639619, "body": "@MichaelPetch: I knew you were joking around, but I couldn&#39;t figure out what the joke was &gt;.&lt;  Interesting find, that might well be what this code is taken from.  I wonder what the compile options were for that.  Maybe <code>-O1</code>?    <code>p2</code> in that file uses the unsigned-compare trick (so probably not <code>-O0</code>), but <code>p3</code> looks badly optimized (it could be <code>imul $100, %edi, %eax</code> / <code>add %esi, %eax</code>)."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1455766416, "post_id": 35469047, "comment_id": 58639685, "body": "It is generated code, but I&#39;m not quite sure what compile option but part seems optimized and part doesn&#39;t. So higher than <code>-O0</code> and the age of the compiler might explain some poor/missed optimizations. I&#39;d guess <code>-O1</code> too."}, {"owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "edited": false, "score": 0, "creation_date": 1455852142, "post_id": 35469047, "comment_id": 58685627, "body": "@PeterCordes apparently is a goddess, how dare I ask a question the goddess deems easy. How about this princess if you deem a question to be easy, don&#39;t answer it. Isn&#39;t that better? Or are you slave to the rep score?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "edited": false, "score": 0, "creation_date": 1455855611, "post_id": 35469047, "comment_id": 58686524, "body": "@ChristopherJakob: That wasn&#39;t all directed at this question.  I think I&#39;d just read a few even more boring questions, which I did skip, and was slightly grumpy.  I thought that it was obvious that the <code>add</code> instructions were operating on three inputs, since the destination is read and written. (unlike <code>mov</code>, where the dest is write-only).  This is not a bad question because there is a non-obvious part: <i>why</i> does it make sense for a function to use those registers.  That&#39;s the part worth answering (by identifying which calling convention it was using), esp. since another answer was wrong."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 2, "last_activity_date": 1455748087, "last_edit_date": 1495541729, "creation_date": 1455748087, "answer_id": 35469047, "question_id": 35468163, "link": "https://stackoverflow.com/questions/35468163/determining-the-return-type-of-a-function-in-assembly/35469047#35469047", "title": "determining the return type of a function in assembly", "body": "<p>See <a href=\"https://stackoverflow.com/tags/x86/info\">https://stackoverflow.com/tags/x86/info</a> for links to calling convention docs.  This looks like the standard SysV x86 ABI, used by everything except Windows.</p>\n\n<p>This is obviously doing two adds 64bit adds to generate a result from three input registers, then putting the result in <code>%rax</code>.</p>\n\n<p>You can't tell whether the result is signed or unsigned, though, because the code would be the same.</p>\n\n<p>Also, an optimized version would skip the <code>mov</code> by using <code>lea</code> as a non-destructive add with an output that wasn't one of the inputs:</p>\n\n<pre><code>lea  (%rdi,%rdx), %rax\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 4581921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/1385008401813441/picture?type=large", "display_name": "Christopher Jakob", "link": "https://stackoverflow.com/users/4581921/christopher-jakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2145, "favorite_count": 0, "accepted_answer_id": 35468810, "answer_count": 4, "score": 3, "last_activity_date": 1455748087, "creation_date": 1455744624, "question_id": 35468163, "link": "https://stackoverflow.com/questions/35468163/determining-the-return-type-of-a-function-in-assembly", "title": "determining the return type of a function in assembly", "body": "<p>The code below is a homework assignment, the actual assembly commands I understand. However I am unsure (and have been looking) how to determine the return type of the function and how many arguments if any the function takes. Professor really didn't go over this well (Monotone tenure princess) \nThe assignment is to read assembly code and then write c code base on the assembly code. Again I understand the instructions, just cant figure out what the return type is or how many arguments the code takes</p>\n\n<pre><code>    .file   \"hw5.c\"\n    .text\n    .p2align 4,,15\n.globl p1\n    .type   p1, @function\np1:\n.LFB0:\n    .cfi_startproc\n    addq    %rsi, %rdi\n    addq    %rdi, %rdx\n    movq    %rdx, %rax\n    ret\n    .cfi_endproc\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1455744097, "post_id": 35467965, "comment_id": 58631519, "body": "Are you sure the <code>while</code> loop is like your equation?"}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 2, "creation_date": 1455744410, "post_id": 35467965, "comment_id": 58631714, "body": "Use a debugger.  Set a breakpoint at the top of your program, and step through it line-by-line.  Watch the value of each variable at each step."}, {"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1455744676, "post_id": 35467965, "comment_id": 58631878, "body": "You need to be more specific with your error description: exactly what is <i>this code in your question</i> doing? How is that different from what you expected? Saying that you tried a bunch of different things and they didn&#39;t work, doesn&#39;t tell us anything about the code that you&#39;ve actually presented here."}, {"owner": {"reputation": 1080, "user_id": 1546803, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8vhGT.jpg?s=128&g=1", "display_name": "miss.serena", "link": "https://stackoverflow.com/users/1546803/miss-serena"}, "edited": false, "score": 1, "creation_date": 1455744741, "post_id": 35467965, "comment_id": 58631918, "body": "or get out a pen and paper, pick some value for x and then go through your code by hand. If you let x = 6, then you know that n should return as 2 and that should happen pretty fast. You should be able to see your errors immediately"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455744916, "post_id": 35467965, "comment_id": 58632025, "body": "Please name stuff in such a way that makes sense.  &#39;number&#39; is just horrible.  &#39;seriesLimit&#39; might be better.  &#39;currentTotal&#39; may be good for the accumulator, &#39;termIndex&#39; for, well, the index of the term.  Single-letter var names confuse us, and yourself."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455745031, "post_id": 35467965, "comment_id": 58632079, "body": "Did you mean to use floating-point types?  Comparing two FP values that you think should be equal may well not work as you expect."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 1, "creation_date": 1455745106, "post_id": 35467965, "comment_id": 58632138, "body": "&#39;I&#39;ve been trying to modify it for hours only to get infinte loops etc.&#39; - no, no, no! See @abelenky comment above about debugging."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "reply_to_user": {"reputation": 1080, "user_id": 1546803, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/8vhGT.jpg?s=128&g=1", "display_name": "miss.serena", "link": "https://stackoverflow.com/users/1546803/miss-serena"}, "edited": false, "score": 1, "creation_date": 1455745258, "post_id": 35467965, "comment_id": 58632226, "body": "@miss.serena presents a viable option.  Your program is so short you should be able to &quot;run it by hand&quot;.  (But I&#39;d really prefer that you use a debugger.  It is an <b><i>essential</i></b> professional skill.  I will never hire someone who cannot use a debugger)"}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 0, "last_activity_date": 1455744620, "creation_date": 1455744620, "answer_id": 35468160, "question_id": 35467965, "link": "https://stackoverflow.com/questions/35467965/using-while-loop-to-complete-the-following-equation/35468160#35468160", "title": "Using While loop to complete the following equation", "body": "<p>I think your program is not computing the right <code>c</code> value, if you simply add 1 to <code>c</code> in each iteration then at the end <code>c</code> will be equal to the number of iterations, try this</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint\nmain(void)\n{\n    double x = 0;\n    double y = 0;\n    double z = 0;\n    if (scanf(\"%lf\", &amp;x) != 1)\n        return -1;\n    for (double n = 0 ; y &lt; x ; ++n)\n    {\n        z = y; // Store the value before `y' &gt;= `x'\n        y = y + pow(n, 2); // Update `y'\n    }\n    fprintf(stdout, \"%f\\n\", z);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1455744839, "post_id": 35468191, "comment_id": 58631987, "body": "Instead of just posting a block of code, you should add some comments or explanation of why it fixes the issue."}, {"owner": {"reputation": 3297, "user_id": 1472828, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2vX5H.jpg?s=128&g=1", "display_name": "HoKy22", "link": "https://stackoverflow.com/users/1472828/hoky22"}, "reply_to_user": {"reputation": 8218, "user_id": 2615940, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/9a6Qc.jpg?s=128&g=1", "display_name": "skrrgwasme", "link": "https://stackoverflow.com/users/2615940/skrrgwasme"}, "edited": false, "score": 0, "creation_date": 1455744949, "post_id": 35468191, "comment_id": 58632039, "body": "Sure, I will add something"}], "tags": [], "owner": {"reputation": 3297, "user_id": 1472828, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2vX5H.jpg?s=128&g=1", "display_name": "HoKy22", "link": "https://stackoverflow.com/users/1472828/hoky22"}, "is_accepted": false, "score": 0, "last_activity_date": 1455745063, "last_edit_date": 1455745063, "creation_date": 1455744726, "answer_id": 35468191, "question_id": 35467965, "link": "https://stackoverflow.com/questions/35467965/using-while-loop-to-complete-the-following-equation/35468191#35468191", "title": "Using While loop to complete the following equation", "body": "<pre><code>n = c + pow(c, 2);\n</code></pre>\n\n<p>Doesn't do what you think would do. In order to sum to the value correctly because you never saved your previous sum correctly.</p>\n\n<pre><code>int main(void) {    \n    int number;\n\n    printf(\"Please enter a number\\n\");\n    scanf(\"%d\", &amp;number);\n\n    double c = 1; //stores number\n    double n = 0;\n    double prev = 0;\n\n    while (n&lt;number)\n    {\n        prev = n;\n        n += pow(c, 2);\n        c++;\n\n    }\n\n    printf(\"The largest n is %lf\\n\", prev);\n\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1455746245, "post_id": 35468270, "comment_id": 58632817, "body": "@chux I have added the casting.:)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1455747767, "post_id": 35468270, "comment_id": 58633520, "body": "@chux Actually there is no need to use the casting because n * n can not be greater than UINT_MAX."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 1, "last_activity_date": 1455746626, "last_edit_date": 1455746626, "creation_date": 1455745047, "answer_id": 35468270, "question_id": 35467965, "link": "https://stackoverflow.com/questions/35467965/using-while-loop-to-complete-the-following-equation/35468270#35468270", "title": "Using While loop to complete the following equation", "body": "<p>Here you are.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main( void )\n{\n    while ( 1 )\n    {        \n        printf( \"Enter a positive number (0-exit): \" );\n        unsigned int number;\n\n        if ( !( scanf( \"%u\", &amp;number ) == 1 ) || number == 0 ) break;\n\n        unsigned int n = 0;\n        unsigned long long sum = 0;\n\n        while ( ( sum + ( unsigned long long )( n + 1 ) * ( n + 1 ) ) &lt; number ) \n        {\n            ++n;\n            sum += ( unsigned long long )n * n;\n        }            \n\n        printf( \"The largest n is %u and the corresponding sum is %llu\\n\", n, sum );\n    }       \n}    \n</code></pre>\n\n<p>If to enter for example <code>65</code> and then <code>0</code> then the output might look like</p>\n\n<pre><code>Enter a positive number (0-exit): 65\nThe largest n is 5 and the corresponding sum is 55\nEnter a positive number (0-exit): 0\n</code></pre>\n\n<p>If you want you can change the type of the variable <code>number</code> from <code>unsigned int</code> to <code>double</code>. All you else need to do in this case is to change the format specifier for <code>scanf</code>.</p>\n\n<p>As for your program then the loop itself</p>\n\n<pre><code>while (n &lt; number)\n{\n    n = c + pow(c, 2);\n    c++;    \n} \n</code></pre>\n\n<p>is wrong because within the loop <code>n</code> can become greater than the number and <code>c</code> will be increased.</p>\n\n<p>Also instead of</p>\n\n<pre><code>n = c + pow(c, 2);\n</code></pre>\n\n<p>there must be</p>\n\n<pre><code>n += c * c;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455745968, "post_id": 35468475, "comment_id": 58632661, "body": "So <code>n</code> is just <code>c + c*c</code>?  Maybe you wanted <code>n += c*c;</code>"}, {"owner": {"reputation": 1575, "user_id": 5082337, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/602d82f37f432daa9a2e1907a3f02b83?s=128&d=identicon&r=PG", "display_name": "Marinos K", "link": "https://stackoverflow.com/users/5082337/marinos-k"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455746091, "post_id": 35468475, "comment_id": 58632731, "body": "sorry I pasted your original code instead of mine :). Check again, I&#39;ve replaced it.."}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1455750444, "post_id": 35468475, "comment_id": 58634688, "body": "<code>c*c</code> is better than <code>pow(c, 2)</code> as the latter is a double; also, you probably want an <code>unsigned long</code> for <code>n</code> (or better, <code>while (n &lt; number - c*c) { n+= c*c; ++c; }</code>) to avoid overflow."}], "tags": [], "owner": {"reputation": 1575, "user_id": 5082337, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/602d82f37f432daa9a2e1907a3f02b83?s=128&d=identicon&r=PG", "display_name": "Marinos K", "link": "https://stackoverflow.com/users/5082337/marinos-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1455750512, "last_edit_date": 1455750512, "creation_date": 1455745746, "answer_id": 35468475, "question_id": 35467965, "link": "https://stackoverflow.com/questions/35467965/using-while-loop-to-complete-the-following-equation/35468475#35468475", "title": "Using While loop to complete the following equation", "body": "<p>You should use integers rather than double and remember to decrement c in the end (since the last c is the first one which is actually GREATER than your input).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\n    int number;\n\n    printf(\"Please enter a number\\n\");\n    scanf(\"%i\", &amp;number);\n\n    int c = 1; // stores number\n    int n = 0;\n\n    while (n &lt; number) {\n        n += c*c;\n        c++;    \n    }    \n    printf(\"The largest n is %i\\n\", --c);\n\n    return 0;    \n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5302613, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tQRzi6npaLs/AAAAAAAAAAI/AAAAAAAAB78/ObwEmp7bPmc/photo.jpg?sz=128", "display_name": "Tanner Oelke", "link": "https://stackoverflow.com/users/5302613/tanner-oelke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1455750512, "creation_date": 1455743998, "last_edit_date": 1455750158, "question_id": 35467965, "link": "https://stackoverflow.com/questions/35467965/using-while-loop-to-complete-the-following-equation", "title": "Using While loop to complete the following equation", "body": "<p>I'm trying to write a program which prompts users for a number <code>x</code>, and finds the largest <code>n</code> that\nsatisfies the following equation:\n1\u00b2 + 2\u00b2 + 3\u00b2 + ... + <code>n</code>\u00b2 &lt; <code>x</code>.</p>\n\n<p>First I need to know what my program is doing wrong, I've been trying to modify it for hours only to get infinite loops etc. I know this is an error in my logic; I just need to know what logic to use to complete the problem.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(void)\n{\n    int number;\n\n    printf(\"Please enter a number\\n\");\n    scanf(\"%d\", &amp;number);\n\n    double c = 1; // stores number\n    double n = 0;\n\n    while (n &lt; number)\n    {\n        n = c + pow(c, 2);\n        c++;    \n    }    \n    printf(\"The largest n is %lf\\n\", c);\n    printf(\"%lf\", n);\n\n    return 0;    \n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "struct", "malloc"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743461, "post_id": 35467559, "comment_id": 58631193, "body": "This is invalid syntax. Maybe you should consult a C book."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743858, "post_id": 35467559, "comment_id": 58631392, "body": "And if an array was a pointer, it would be called &quot;pointer&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 1, "last_activity_date": 1455742657, "creation_date": 1455742657, "answer_id": 35467589, "question_id": 35467559, "link": "https://stackoverflow.com/questions/35467559/c-how-to-malloc-struct-containing-string-and-array/35467589#35467589", "title": "C - how to malloc struct containing string and array?", "body": "<p>To avoid confusion, and to make the code maintainable do it like this</p>\n\n<pre><code>Node *new_node = malloc(sizeof(*new_node));\nif (new_node == NULL)\n   allocation_error_do_not_continue();\n</code></pre>\n\n<p>if you check <code>sizeof(*new_node)</code> which is the same as <code>sizeof(Node)</code> would be <code>10 * sizeof(int *)</code> + <code>32 sizeof(char)</code> although <code>sizeof(char)</code> is always 1 so <code>10 * sizeof(int *) + 32</code>.</p>\n\n<p>Not that this requires the definition of the structure to be avaliable in order for the <code>sizeof</code> operator to be able to give the size of the structure.</p>\n\n<p>Also, you suggest to <code>malloc()</code> for the <code>name</code> member, the <code>name</code> member is an array and you cannot assign to it, it has enough space for a 31 character string which you can use by assigning to each element, or using <code>strcpy()</code>/<code>memcpy()</code> to copy a complete array to it. But you can't assign to it and you don't need to <code>malloc()</code> space for it because <code>malloc()</code>ing the structure already <code>malloc()</code>ed both arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 1, "last_activity_date": 1455742666, "creation_date": 1455742666, "answer_id": 35467591, "question_id": 35467559, "link": "https://stackoverflow.com/questions/35467559/c-how-to-malloc-struct-containing-string-and-array/35467591#35467591", "title": "C - how to malloc struct containing string and array?", "body": "<p>When you allocate space for your struct as <code>Node *new_node = malloc(sizeof(Node));</code>, that includes space for each struct element.  </p>\n\n<p>In this case, that includes space for 32 <code>char</code> and 10 <code>int *</code>.  So you don't need to allocate space for the <code>name</code> array, although depending on your usage, you might allocate space to each element of <code>contents</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "is_accepted": false, "score": 0, "last_activity_date": 1455749850, "creation_date": 1455749850, "answer_id": 35469452, "question_id": 35467559, "link": "https://stackoverflow.com/questions/35467559/c-how-to-malloc-struct-containing-string-and-array/35469452#35469452", "title": "C - how to malloc struct containing string and array?", "body": "<p>The usual idiom is</p>\n\n<pre><code>Node *new_node = malloc(sizeof *new_node);\n</code></pre>\n\n<p>This ensures that the space allocated sufficient for <code>new_node</code>, even if you change its type.  If you use <code>sizeof (Node)</code> instead, you are prone to the mistake of changing the type of <code>new_node</code> and failing to update the <code>sizeof</code> expression.</p>\n\n<p>Your code</p>\n\n<pre><code>node-&gt;name = malloc(32 * sizeof(char));\n</code></pre>\n\n<p>will not compile because <code>node-&gt;name</code> is not a pointer type; it's an array within the Node type, and the storage is allocated when you <code>malloc()</code> for <code>new_node</code> above.  So you can just go ahead and use that storage.</p>\n\n<p>Note that <code>sizeof (char)</code> is 1 by definition, and the above would normally be written</p>\n\n<pre><code>node-&gt;name = malloc(32);  // still can't assign to node-&gt;name, though!\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5942580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ef146f6deffd85649ad8e4804dbfbe?s=128&d=identicon&r=PG", "display_name": "BC906", "link": "https://stackoverflow.com/users/5942580/bc906"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2198, "favorite_count": 0, "accepted_answer_id": 35467591, "answer_count": 3, "score": 0, "last_activity_date": 1455749850, "creation_date": 1455742552, "question_id": 35467559, "link": "https://stackoverflow.com/questions/35467559/c-how-to-malloc-struct-containing-string-and-array", "title": "C - how to malloc struct containing string and array?", "body": "<p>say, I have some struct like this:</p>\n\n<pre><code>typedef struct node {\n    char[32] name;\n    int *contents[10];\n} Node;\n</code></pre>\n\n<p>I want to initialize a new Node and store it on heap, do I need also to malloc space for name and integers?\nHowever, if I tried to malloc space for them, for example:</p>\n\n<pre><code>Node *new_node = malloc{...};\nnew_node-&gt;name = malloc{32 * sizeof(char)};\n...\n</code></pre>\n\n<p>I got error says name is not assignable.</p>\n"}, {"tags": ["c", "algorithm", "binary-search-tree", "red-black-tree"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743393, "post_id": 35467474, "comment_id": 58631157, "body": "&quot;I have implemented a red black tree in C. In the C++ map ...&quot; - So which language is it? C and C++ are <b>different</b> languages!"}, {"owner": {"reputation": 143, "user_id": 4309871, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/35d800dacd0cf60b545050759c8f5410?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo", "link": "https://stackoverflow.com/users/4309871/gustavo"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743469, "post_id": 35467474, "comment_id": 58631198, "body": "My intention was to look in the C++ stl library to understand how it works."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743585, "post_id": 35467474, "comment_id": 58631251, "body": "You can also look into the Python or a Fortran library. But that does not show how to implement it in C. And C very well <b>does</b> have comparison operators. To learn C, read a C book, not a C++ book or a novel. If you have a <b>specific</b> problem with your C code, state it clearly and provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1455743380, "post_id": 35467638, "comment_id": 58631149, "body": "Of course, that assumes that the <code>&lt;</code> operator describes a total ordering.  Not all types afford such an ordering, and not all <code>&lt;</code> operators provide one.  On the other hand, those that don&#39;t probably should not be used in a search tree."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1455743635, "post_id": 35467638, "comment_id": 58631279, "body": "@JohnBollinger indeed, my answer assumes the context of C++ Compare types that require strict total ordering. I shall mention it explicitly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455743740, "post_id": 35467638, "comment_id": 58631339, "body": "OP seems to re-implement in C. Not sure what his problem is, as he does not even show code."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455744235, "post_id": 35467638, "comment_id": 58631599, "body": "@Olaf my understanding is that Gustavo is asking how to implement equality comparison when the comparison function only does inequality."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455744390, "post_id": 35467638, "comment_id": 58631698, "body": "See his comment to the other question. He seems to try learning C using C++ as &quot;template&quot;."}, {"owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455744817, "post_id": 35467638, "comment_id": 58631977, "body": "@Olaf the other comment appears to pretty much confirm my interpretation. Although, for some reason they contradict the original question by suggesting the use of non-strict inequality."}], "tags": [], "owner": {"reputation": 178960, "user_id": 2079303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cf7f63e49a75376e0f761c8abeb6d5a?s=128&d=identicon&r=PG", "display_name": "eerorika", "link": "https://stackoverflow.com/users/2079303/eerorika"}, "is_accepted": true, "score": 4, "last_activity_date": 1455746011, "last_edit_date": 1455746011, "creation_date": 1455742789, "answer_id": 35467638, "question_id": 35467474, "link": "https://stackoverflow.com/questions/35467474/red-black-tree-comparison-function/35467638#35467638", "title": "Red black tree comparison function", "body": "<p>You can express equality in terms of strict inequality:</p>\n\n<pre><code>(a == b) &lt;==&gt; !(a &lt; b || b &lt; a)\n</code></pre>\n\n<p>The equivalence assumes that comparison relation is strict total ordering. That's required by C++ Compare types and also what you must require from the comparison function in your tree implementation.</p>\n\n<p>As far as your binary tree search is concerned, take a look at how the first <code>cmp</code> is implemented. Pay attention to how it finds out when to return 0 using only <code>&lt;</code>. Your implementation can do exactly the same using the second <code>cmp</code>.</p>\n"}], "owner": {"reputation": 143, "user_id": 4309871, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/35d800dacd0cf60b545050759c8f5410?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo", "link": "https://stackoverflow.com/users/4309871/gustavo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "closed_date": 1455749257, "accepted_answer_id": 35467638, "answer_count": 1, "score": -1, "last_activity_date": 1455746011, "creation_date": 1455742281, "last_edit_date": 1455745561, "question_id": 35467474, "link": "https://stackoverflow.com/questions/35467474/red-black-tree-comparison-function", "closed_reason": "Not suitable for this site", "title": "Red black tree comparison function", "body": "<p>I have implemented a red black tree in C. In the C++ map it is possible to provide a custom comparison which only performs the operation value1 &lt; value2. This operation returns true or false but how is the tree implemented without a comparison operation? I want my comparison function to return only 1 or 0 without any == operator. I tried to read it in the stl but the code is unreadable although I have experience in C++. </p>\n\n<p>The full code is not necessary because it's the same code as every other tree implementation. At the moment there is the following compare function:</p>\n\n<pre><code>int cmp(void *key1, void *key2){\n  if(*(int*)key1 &lt; *(int*)key2){\n    return 1;\n  }else if(*(int*)key1 &gt; *(int*)key2){\n    return -1;\n  }else{\n    return 0;\n  }\n}\n</code></pre>\n\n<p>I want a compare function like this:</p>\n\n<pre><code>int cmp(void *key1, void *key2){\n  if(*(int*)key1 &lt; *(int*)key2){\n    return 1;\n  }else{\n    return 0;\n  }\n}\n</code></pre>\n\n<p>I do not understand how searching works with this compare function because there is no stop condition when a node was found.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 1, "creation_date": 1455741717, "post_id": 35467267, "comment_id": 58630234, "body": "What did you expect to happen instead?"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455741828, "post_id": 35467267, "comment_id": 58630295, "body": "If you replace both calls to <code>clock()</code> with <code>time(0)</code> and remove the <code>&#47; CLOCKS_PER_SEC</code> part, does it do something more like what you expected?  (Note: this change is technically not guaranteed even to compile, but the odds are overwhelmingly that it will be fine.)"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455741871, "post_id": 35467267, "comment_id": 58630316, "body": "Incidentally: <a href=\"https://stackoverflow.com/questions/24302160/scanf-on-an-istream-object/24318630#24318630\"><code>scanf</code> is broken-as-specified, and can&#39;t be safely used for many of the things people want to use it for</a>; the precise thing you are doing with it happens to be safe, but I strongly recommend you get out of the habit of using it at all."}, {"owner": {"reputation": 159, "user_id": 3312910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/q5BMn.jpg?s=128&g=1", "display_name": "betseg", "link": "https://stackoverflow.com/users/3312910/betseg"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455741893, "post_id": 35467267, "comment_id": 58630330, "body": "I expected seconds - as in <a href=\"http://stackoverflow.com/questions/459691/best-timing-method-in-c\">here</a>"}, {"owner": {"reputation": 159, "user_id": 3312910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/q5BMn.jpg?s=128&g=1", "display_name": "betseg", "link": "https://stackoverflow.com/users/3312910/betseg"}, "reply_to_user": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455741964, "post_id": 35467267, "comment_id": 58630362, "body": "btw i code in c, not c++"}, {"owner": {"reputation": 159, "user_id": 3312910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/q5BMn.jpg?s=128&g=1", "display_name": "betseg", "link": "https://stackoverflow.com/users/3312910/betseg"}, "edited": false, "score": 0, "creation_date": 1455742167, "post_id": 35467267, "comment_id": 58630483, "body": "time(0) works better, but starts counting after first input"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455742303, "post_id": 35467267, "comment_id": 58630577, "body": "The linked post talks about both C and C++, and its criticism of <code>scanf</code> applies equally to both languages, since the C++ standard doesn&#39;t make any changes to the specification of <code>scanf</code>."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1455742416, "post_id": 35467267, "comment_id": 58630629, "body": "I don&#39;t understand what you mean by &quot;<code>time</code> starts counting after first input.&quot;"}, {"owner": {"reputation": 159, "user_id": 3312910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/q5BMn.jpg?s=128&g=1", "display_name": "betseg", "link": "https://stackoverflow.com/users/3312910/betseg"}, "edited": false, "score": 0, "creation_date": 1455742514, "post_id": 35467267, "comment_id": 58630682, "body": "./program, wait 5 seconds, write something, wait 5 seconds more, press enter, output is &quot;5&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455745542, "post_id": 35467267, "comment_id": 58632405, "body": "&quot;it shows a number like 0.000053&quot; looks right.  What value did you expect?  Wall time as in <a href=\"http://stackoverflow.com/a/35467466/2410359\">this answer</a> or something else?  Without this clarity the question is unclear."}], "answers": [{"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 3, "last_activity_date": 1455742250, "creation_date": 1455742250, "answer_id": 35467466, "question_id": 35467267, "link": "https://stackoverflow.com/questions/35467267/finding-the-time-spent-in-scanf/35467466#35467466", "title": "Finding the time spent in scanf", "body": "<p><code>clock</code> measures \"CPU time,\" not \"wall-clock time.\"  The difference is (approximately) that CPU time does not include time spent waiting for something to happen. 0.000053 seconds (53 microseconds) is in the right ballpark for the amount of CPU time consumed by this use of <code>scanf</code> -- no matter how long you waited before you pressed Enter.</p>\n\n<p><code>time</code>, <code>gettimeofday</code>, and <code>clock_gettime(CLOCK_MONOTONIC)</code> (in increasing order of precision) measure wall-clock time.  If you need to measure wall-clock time, use one of those.</p>\n"}], "owner": {"reputation": 159, "user_id": 3312910, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/q5BMn.jpg?s=128&g=1", "display_name": "betseg", "link": "https://stackoverflow.com/users/3312910/betseg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1455752070, "answer_count": 1, "score": -1, "last_activity_date": 1455742250, "creation_date": 1455741605, "question_id": 35467267, "link": "https://stackoverflow.com/questions/35467267/finding-the-time-spent-in-scanf", "closed_reason": "Needs details or clarity", "title": "Finding the time spent in scanf", "body": "<p>I tried this, but it doesn't work well, it shows a number like 0.000053</p>\n\n<pre><code>    begin = clock();\n    scanf(\" %c\", &amp;in);\n    end = clock();\n    printf(\"%f\\n\", (double)(end - begin) / CLOCKS_PER_SEC);\n</code></pre>\n"}, {"tags": ["c", "file-io", "fgets"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1455741565, "post_id": 35467212, "comment_id": 58630160, "body": "Have you though that it is the same as comparing to the <i>previous</i> line?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455741587, "post_id": 35467212, "comment_id": 58630168, "body": "Don&#39;t use all-uppercase names for anything else than macros or enum-constants."}], "answers": [{"comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455741704, "post_id": 35467286, "comment_id": 58630227, "body": "If your first line is empty you will get a false positive."}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1455742389, "post_id": 35467286, "comment_id": 58630615, "body": "Wouldn&#39;t it be faster just swapping the pointers to the two lines?"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455743209, "post_id": 35467286, "comment_id": 58631050, "body": "@EugeneSh. that case isn&#39;t a false positive - do you remember <code>fgets</code> add a newline?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455743312, "post_id": 35467286, "comment_id": 58631104, "body": "So what will happen in case of a file with a single newline? It will count 1 if I parse it correctly.."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "edited": false, "score": 1, "creation_date": 1455743531, "post_id": 35467286, "comment_id": 58631224, "body": "If the file has a single new line - the <code>while</code> loop read just once and assign it to <code>line</code> - whereas <code>next_line</code> remains empty - so <code>strcmp</code> check return non-zero, <code>similar</code> is not increased"}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": true, "score": 2, "last_activity_date": 1455741864, "last_edit_date": 1455741864, "creation_date": 1455741664, "answer_id": 35467286, "question_id": 35467212, "link": "https://stackoverflow.com/questions/35467212/comparing-current-line-to-next-one-using-fgets/35467286#35467286", "title": "Comparing current line to next one using fgets?", "body": "<p>It's possible - add a new var <code>next_line</code>. For example,</p>\n\n<pre><code>int similar = 0;\nchar line[100] = \"\";\nchar next_line[100] = \"\";\n\nFILE *f = fopen(file, \"r\");\nwhile (fgets(line, 100, f)) {\n    if (strcmp(next_line, line) == 0) {\n            similar++;\n    }\n    strcpy(next_line, line);\n}\n</code></pre>\n\n<p>NOTE:</p>\n\n<ul>\n<li>You must check <code>strcmp</code> with <code>0</code>, not <code>'0'</code></li>\n<li>This only works to compare adjacent lines.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 9606, "user_id": 3677097, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b8c49e598194e53b9aba3a195da387a5?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas DM", "link": "https://stackoverflow.com/users/3677097/andreas-dm"}, "is_accepted": false, "score": 0, "last_activity_date": 1455746404, "creation_date": 1455746404, "answer_id": 35468658, "question_id": 35467212, "link": "https://stackoverflow.com/questions/35467212/comparing-current-line-to-next-one-using-fgets/35468658#35468658", "title": "Comparing current line to next one using fgets?", "body": "<p>Compare current line with previous line or compare current line with a defined string:<br> \nEx. My textfile contains this text:</p>\n\n<p><code>This is a line // (\\n)</code><br>\n<code>This is a line // (\\n)</code><br>\n<code>This is a line // without newline</code><br></p>\n\n<pre><code>char line_comp []  = \"This is a line\\n\"; // For lines with newline\nchar line_comp2 [] = \"This is a line\";   // For lines without newline\nchar line[255];                          // Store the line\n</code></pre>\n\n<p>Now we can go through the file and see if the lines match one of the above:</p>\n\n<pre><code>int equal = 0;\nwhile (fgets(line, 255, f) != NULL) {\n    if (strcmp(line, line_comp) == 0 || strcmp(line, line_comp2) == 0)\n        ++equal;\n}\n</code></pre>\n\n<p>And then finally print the result: <code>printf(\"Lines equal: %d\\n\", equal);</code> <br>\nRemember to check if the file was opened correctly and remember to close the file after use.</p>\n"}], "owner": {"reputation": 31, "user_id": 5527371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc11ac9857b823215ef314dea79ef46b?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Raleigh", "link": "https://stackoverflow.com/users/5527371/andrew-raleigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "accepted_answer_id": 35467286, "answer_count": 2, "score": -1, "last_activity_date": 1455753324, "creation_date": 1455741425, "last_edit_date": 1455753324, "question_id": 35467212, "link": "https://stackoverflow.com/questions/35467212/comparing-current-line-to-next-one-using-fgets", "title": "Comparing current line to next one using fgets?", "body": "<p>I'm trying to access the next line using fgets in order to count the number of lines that are similar to the next one, is there anyway to get the nextLine variable?</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>int similar = 0;\r\nchar line[100];\r\nchar nextLine[100];\r\nFILE *f = fopen(file, \"r\");\r\nwhile (fgets(line, 100, f)) {\r\n            if (strcmp(nextLine, line) == '0') {\r\n                      similar++;\r\n            }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c", "gcc", "codeblocks", "gcc-warning"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455741100, "post_id": 35467078, "comment_id": 58629907, "body": "Look at the &quot;Build Log&quot; tab in Code::Blocks , it will show the exact commandline being sent to the compiler. Check that this commandline has your flag in it; and use copy-paste to try the same commandline in your console . Any warnings would also appear in Build Log."}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455741182, "post_id": 35467078, "comment_id": 58629940, "body": "<a href=\"http://pastebin.com/raw/mrfuTFgj\" rel=\"nofollow noreferrer\">This</a> is my Build-Log"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455741233, "post_id": 35467078, "comment_id": 58629970, "body": "Nothing is being built there, you just ran the program you build previously.  In the Build menu click &quot;Rebuild&quot;"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455741249, "post_id": 35467078, "comment_id": 58629980, "body": "All other Flags are Working Fine, but <code>-Wshadow</code> don&#39;t"}, {"owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455741356, "post_id": 35467078, "comment_id": 58630042, "body": "@M.M You right, I had to <a href=\"http://pastebin.com/raw/9BkvDte9\" rel=\"nofollow noreferrer\">rebuild</a> it. Thank you. If you post an Asnwer with this Typo I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1455741514, "creation_date": 1455741514, "answer_id": 35467243, "question_id": 35467078, "link": "https://stackoverflow.com/questions/35467078/compiler-flag-wshadow-doesnt-work-in-codebloks/35467243#35467243", "title": "Compiler flag &quot;-Wshadow&quot; doesn&#39;t work in CodeBloks", "body": "<p>When you add compiler flags via the IDE, it doesn't automatically mark any existing object files or executable as out-of-date.</p>\n\n<p>You need to click on \"Rebuild\" to do a full rebuild of your code using the new flags.</p>\n"}], "owner": {"reputation": 4739, "user_id": 4745612, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1b8f0eb3ff209075ac07aabc64d2bde4?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/4745612/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 35467243, "answer_count": 1, "score": 0, "last_activity_date": 1455741515, "creation_date": 1455740990, "last_edit_date": 1455741515, "question_id": 35467078, "link": "https://stackoverflow.com/questions/35467078/compiler-flag-wshadow-doesnt-work-in-codebloks", "title": "Compiler flag &quot;-Wshadow&quot; doesn&#39;t work in CodeBloks", "body": "<p>I realized that I need compiler flag <code>-Wshadow</code> after I mess up some code, so I decide to use it in <code>Codeblocks</code> too, but it doesn't work and I can't figure out why.</p>\n\n<p>The following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void){\n    int i = 0;\n    int arr[] = {1,2,3};\n\n    for (int i=0 ; i &lt; 3 ; i++){\n        printf(\"%d \",arr[i]);\n    }\n\n    printf(\"\\nI = %d\\n\",i);\n}\n</code></pre>\n\n<p>If I try to compile it in my <code>Terminal</code> with the following <code>flags</code> :</p>\n\n<pre><code>-Wall -Wextra -Werror -Wstrict-prototypes -Wconversion -Wmissing-prototypes -Wold-style-definition -Wshadow -O0 -g\n</code></pre>\n\n<p>I get the following Output, which is OK:</p>\n\n<pre><code>program.c: In function \u2018main\u2019:\nprogram.c:7:14: error: declaration of \u2018i\u2019 shadows a previous local [-Werror=shadow]\n     for (int i=0 ; i &lt; 3 ; i++){\n              ^\nprogram.c:4:9: note: shadowed declaration is here\n     int i = 0;\n         ^\ncc1: all warnings being treated as errors\n</code></pre>\n\n<p>Now using the same Compiler <code>Flags</code> doesn't seems to work, compiles fine with no warnings, just like the flag <code>-Wshadow</code> is not present.</p>\n\n<p>Does anyone know how to fix this?</p>\n\n<p>GCC version is:</p>\n\n<pre><code>gcc (Ubuntu 5.3.0-3ubuntu1~14.04) 5.3.0 20151204\n</code></pre>\n"}, {"tags": ["c", "module", "fortran"], "comments": [{"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "reply_to_user": {"reputation": 17025, "user_id": 2737715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/600bf8722446680e50fbbb6ecbbe2b44?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vogt", "link": "https://stackoverflow.com/users/2737715/alexander-vogt"}, "edited": false, "score": 0, "creation_date": 1455738234, "post_id": 35466124, "comment_id": 58628106, "body": "I&#39;ve updated my question to be more specific about the issue. Namely, it fails at compile, and says &quot;undefined reference to __testF_MOD_fortfunc"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1455738421, "post_id": 35466124, "comment_id": 58628227, "body": "The order in which files are listed matters to the linker.  It may solve your problem to swap testC.o and testF.o in your link command."}, {"owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "edited": false, "score": 0, "creation_date": 1455738551, "post_id": 35466124, "comment_id": 58628303, "body": "Tried swapping testC.o and testF.o. No luck unfortunately."}, {"owner": {"reputation": 2418, "user_id": 5128826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b54c3cd8c70aad8122d9391ce8028a?s=128&d=identicon&r=PG&f=1", "display_name": "nsilent22", "link": "https://stackoverflow.com/users/5128826/nsilent22"}, "edited": false, "score": 0, "creation_date": 1455739458, "post_id": 35466124, "comment_id": 58628894, "body": "FYI: You don&#39;t need to specify function declaration as &quot;extern&quot;. AFAIK it&#39;s only usable for variables."}, {"owner": {"reputation": 17025, "user_id": 2737715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/600bf8722446680e50fbbb6ecbbe2b44?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vogt", "link": "https://stackoverflow.com/users/2737715/alexander-vogt"}, "edited": false, "score": 0, "creation_date": 1455739730, "post_id": 35466124, "comment_id": 58629075, "body": "Please use the the generic tag <a href=\"https://stackoverflow.com/questions/tagged/fortran\">fortran</a>. Otherwise you are referring to a specific standard that is more than 25 years old (hint: the latest released standard is Fortran 2008, Fortran 2015 is in the works). As an added benefit, more users are following the generic tag."}], "answers": [{"tags": [], "owner": {"reputation": 17025, "user_id": 2737715, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/600bf8722446680e50fbbb6ecbbe2b44?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vogt", "link": "https://stackoverflow.com/users/2737715/alexander-vogt"}, "is_accepted": true, "score": 3, "last_activity_date": 1455738545, "creation_date": 1455738545, "answer_id": 35466338, "question_id": 35466124, "link": "https://stackoverflow.com/questions/35466124/calling-a-subroutine-in-a-module-from-c/35466338#35466338", "title": "Calling a subroutine in a module from C", "body": "<p>You can use <code>objdump -t testF.o</code> to read out the function name from an object directly. This reveals the following line: </p>\n\n<pre><code>0000000000000000 g     F .text  00000000000000b4 __testf_MOD_fortfunc\n</code></pre>\n\n<p>That's your function name. You can see that it is <code>testf</code> in lowercase. \nUsing this in the C code should solve your problem. </p>\n\n<p>However, these naming conventions are compiler dependent. You should really take a look into the <code>ISO_C_binding</code> module and the improved C interoperability of modern Fortran. </p>\n"}], "owner": {"reputation": 379, "user_id": 1991502, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1883e91ac7aca1b3b90581ba0c70b521?s=128&d=identicon&r=PG", "display_name": "DJames", "link": "https://stackoverflow.com/users/1991502/djames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 661, "favorite_count": 0, "accepted_answer_id": 35466338, "answer_count": 1, "score": 1, "last_activity_date": 1455739936, "creation_date": 1455737928, "last_edit_date": 1495541254, "question_id": 35466124, "link": "https://stackoverflow.com/questions/35466124/calling-a-subroutine-in-a-module-from-c", "title": "Calling a subroutine in a module from C", "body": "<p>I would like to know how I can get a C program to call a Fortran 90 subroutine contained withing a Fortran 90 module.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/15557439/how-to-call-a-fortran90-function-included-in-a-module-in-c-code?lq=1\">This question deals with a similar problem</a>, and I'm trying to implement the solution, but I'm still having issues.</p>\n\n<p>Here are toy examples of the <code>testC.c</code> file, which contains the main function, and the module file <code>testF.f90</code>, which contains the Fortran 90 subroutine.</p>\n\n<p>testC.c</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\nextern void __testF_MOD_fortfunc(int *,float *);\n\nint main() {\n   int ii=5;\n   float ff=5.5;\n\n   __testF_MOD_fortfunc(&amp;ii, &amp;ff);\n\n   return 0;\n}\n</code></pre>\n\n<p>testF.f90</p>\n\n<pre><code>module testF\n\ncontains\n\nsubroutine fortfunc(ii,ff)\n    implicit none\n\n    integer ii\n    real*4  ff\n\n    write(6,100) ii, ff\n    100 format('ii=',i2,' ff=',f6.3)\n\n    return\nend subroutine fortfunc\n\nend module testF\n</code></pre>\n\n<p>To compile, I am using the following lines</p>\n\n<pre><code>gcc -c testC.c\ngfortran -o testF.f90\ngcc -o test testF.o testC.o -lgfortran\n</code></pre>\n\n<p>I get the error message</p>\n\n<pre><code>testC.o: In function `main':\ntestC.c:(.text+0x27): undefined reference to `__testF_MOD_fortfunc'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1455736965, "post_id": 35465754, "comment_id": 58627242, "body": "Does MISRA forbid implicit conversions, explicit casts, or both? (A terminology note: a cast is an an explicit operator; an implicit conversion is not a cast.) You don&#39;t need a cast to call <code>memcpy</code> or <code>malloc</code>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455737033, "post_id": 35465754, "comment_id": 58627287, "body": "What is this MISRA thing? If it doesn&#39;t allow you to provide a pointer to something when void* is expected, it is just wrong."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 4, "creation_date": 1455737160, "post_id": 35465754, "comment_id": 58627370, "body": "<i>&quot;how does Misra expect malloc and everything else to work without any warnings being thrown?&quot;</i> Based on what I could find you&#39;re not supposed to use <code>malloc</code>, meaning the answer would be <i>&quot;It doesnt&quot;</i>."}, {"owner": {"reputation": 382, "user_id": 5758899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84804ba7c6e4a42a67b3966b8fe020fd?s=128&d=identicon&r=PG&f=1", "display_name": "Ismael Infante", "link": "https://stackoverflow.com/users/5758899/ismael-infante"}, "edited": false, "score": 2, "creation_date": 1455737343, "post_id": 35465754, "comment_id": 58627488, "body": "You can check the official documentation at <a href=\"http://www.misra.org.uk/\" rel=\"nofollow noreferrer\">misra.org.uk</a> Every rule has its rationale."}, {"owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1455737731, "post_id": 35465754, "comment_id": 58627763, "body": "@KeithThompson both implicit and explicit casts will thorw error. And most of the times the code won&#39;t even compile for implicit cast(unless a void* is involved)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 6, "creation_date": 1455737744, "post_id": 35465754, "comment_id": 58627773, "body": "You should not cast <code>void *</code> to/from other pointers in C. C is not C++. And AFIK MISRA does not even allow (or at least strongly discourages) using dynamic memory allocation at all."}, {"owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "edited": false, "score": 0, "creation_date": 1455737823, "post_id": 35465754, "comment_id": 58627836, "body": "well memory allocation was just an example. It seems like Misra completely forbids any pointer typecast."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455737960, "post_id": 35465754, "comment_id": 58627941, "body": "While you hardly can avoid all casts, it generally is good advise only to use cast if they are really necessary. A properly designed interface does seldom need casts, especially of pointers (another issue is signed/unsigned casting)."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1455737985, "post_id": 35465754, "comment_id": 58627959, "body": "There is no such thing as an &quot;implicit cast&quot; in C, nor does the standard use the term &quot;typecast&quot;. The word &quot;cast&quot; applies only to the explicit operator, written as a parenthesized type name. Can you update the question with a quotation of the actual requirement? (If implicit pointer conversions are forbidden, I don&#39;t see how you could use <code>malloc</code> or <code>memcpy</code>.)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455738777, "post_id": 35465754, "comment_id": 58628448, "body": "<code>to</code> and <code>from</code> do NOT need to be typecast to void, to call memcpy or malloc"}, {"owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455738891, "post_id": 35465754, "comment_id": 58628520, "body": "@M.M ofcourse not but Misra will throw warnings if you do that."}, {"owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1455738943, "post_id": 35465754, "comment_id": 58628564, "body": "@KeithThompson yes it seems like malloc and memcpy are not supposed to be used"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1455739200, "post_id": 35465754, "comment_id": 58628732, "body": "What <i>exactly</i> does the actual MISRA requirement say? The exact wording could be important."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455740903, "post_id": 35465754, "comment_id": 58629798, "body": "Wikipedia suggests that MISRA does not allow use of malloc anyway"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455755110, "post_id": 35465754, "comment_id": 58636374, "body": "Even Microsoft bans memcpy.  <a href=\"https://blogs.microsoft.com/cybertrust/2009/05/14/please-join-me-in-welcoming-memcpy-to-the-sdl-rogues-gallery/\" rel=\"nofollow noreferrer\">blogs.microsoft.com/cybertrust/2009/05/14/&hellip;</a>"}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 1, "creation_date": 1455756727, "post_id": 35465754, "comment_id": 58636869, "body": "You should post the specific MISRA rule(s) that your asking about (they&#39;re numbered and any warning should provide that number) and you should post an example of the code that generates the rule violation message.  Otherwise there&#39;s potential for a lot of confusion (as evidenced in the long comment trail...)."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455780555, "post_id": 35465754, "comment_id": 58644967, "body": "MISRA-C:2012 is obviously not C++ so I&#39;m removing that tag."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455841181, "post_id": 35465754, "comment_id": 58682636, "body": "and the reason for deleting the Lint tag was?"}], "answers": [{"comments": [{"owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "edited": false, "score": 0, "creation_date": 1455738847, "post_id": 35466143, "comment_id": 58628500, "body": "well we actually use dynamic allocation only once and then manage it throughout the application life-cycle so we have sort of avoided repeatedly allocating dynamic memory . There are other issues like passing generic inter task messages, parsing data received over a network interface and so on and so forth. Somehow by trying to comply with Misra, I don&#39;t get a feeling that we are actually making our code more robust and better and loss out a lot on efficiency."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "edited": false, "score": 3, "creation_date": 1455739225, "post_id": 35466143, "comment_id": 58628746, "body": "@thunderbird: it is <i>frequently</i> the case that compliance with a standard not narrowly tailored to your specific application imposes costs in both effort and efficiency. The question of whether the costs are worth the benefit is for you and the project stakeholders to decide together, based on an informed assessment of both the costs and the benefits. Compliance isn&#39;t good for its own sake; it&#39;s because there are good outcomes. If you&#39;re not getting those good outcomes at a reasonable cost, then push back."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "edited": false, "score": 0, "creation_date": 1455740976, "post_id": 35466143, "comment_id": 58629841, "body": "@thunderbird the whole idea of standards like this is to promote correctness over efficiency.  Slow and steady beats fast but crashes sometimes.  (I doubt you would find any measurable difference in run speed anyway though, e.g. for serializing data in a portable fashion compared to casting char buffers to structs)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455742105, "post_id": 35466143, "comment_id": 58630435, "body": "@M.M, this is certainly not true. There is a <b>tremendous</b> performance difference between identity-encoded serialization and any flexible serialization. Seen it with my own eyes."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455742204, "post_id": 35466143, "comment_id": 58630503, "body": "ok. Use <code>-O3</code>.  But identity serialization is a pain anyway because when you change your struct in a later version of code then you have to write a bunch of BS to be able to load earlier versions of the save file, and then there&#39;s the case of when the struct contains pointers..."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1455744812, "post_id": 35466143, "comment_id": 58631971, "body": "@SergeyA: Right, so there&#39;s a good example. If the performance cost exceeds the safety benefit then you can make a principled, data-driven argument that the serialization code should be <i>isolated</i> into its own walled-off subsystem that is carefully reviewed, and exempt from your requirements policy. Policies are our servants; make yours work to achieve your goals."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1455745006, "post_id": 35466143, "comment_id": 58632068, "body": "@M.M, well, you can always change your struct by adding fields in the end. And identity serialization has a good place for it&#39;s purposes. If you do not trust me, call NASDAQ and ask them why they have Ouch protocol."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455745292, "post_id": 35466143, "comment_id": 58632246, "body": "I actually took some time to read the MISRA guidelines. Looks like very specific and very far away from my domain, so I can not possibly comment on those. I am not sure how one can actually write a program without using any form of memory management... but may be it is possible."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455745744, "post_id": 35466143, "comment_id": 58632540, "body": "@SergeyA: You can certainly write sophisticated programs without heap management. There are virtual machines, or for that matter, physical machines, that do not have a heap <i>at all</i>, and they do useful work.  Again: imagine you lived in a world without malloc; what would you do? Memory managers are not that hard to write; I&#39;ve asked interview candidates to sketch the implementation of one on a whiteboard."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455746355, "post_id": 35466143, "comment_id": 58632879, "body": "@EricLippert, you can write your own malloc, no question about that. But any version of it will return a void* - this is the only thing generalized memory manager can rerturn. And conversion from void* to the the type pointer is not allowed by Misra, judging from the comments above. Now what?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 3, "creation_date": 1455748025, "post_id": 35466143, "comment_id": 58633640, "body": "@SergeyA: Who said anything about writing a generalized memory manager? You need a block of ints, <b>write a memory manager dedicated to making you a block of ints</b>.  Generalized memory managers are a pile of danger; the whole point of this standard is to get away from that danger, not to re-implement it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455748233, "post_id": 35466143, "comment_id": 58633721, "body": "@EricLippert, what if I need blocks of ints, doubles, short ints, floats, charcters, structs Foo, Bar and Baz, enums, unsigned ints - do I need that many specialized managers?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 4, "creation_date": 1455748441, "post_id": 35466143, "comment_id": 58633814, "body": "@SergeyA: Here&#39;s your choices:  (1) use a language with a proper type system and runtime that ensures memory safety, pay the performance costs associated with them. (2) Use a language with a crap type system that lets you convert any reference to any other reference, write code that uses void* as a proxy for any type, pay the cost of bugs so awful they make your hair fall out, or (3) use a language with a crap type system, eschew void*, write a lot of boring code.   I choose (1), but that&#39;s because such languages more than meet my needs."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455754738, "post_id": 35466143, "comment_id": 58636258, "body": "MISRA guidelines are for critical systems (people&#39;s lives may be at stake), typically running with limited system resources (limited RAM, no virtual memory), that must run indefinitely.  Think engine control computers, medical devices, spacecraft.  The prohibition against pointer casting lets you get the most out of type checking system.  The prohibition against dynamic memory allocation eliminates the possibility of fragmentation or memory leaks causing a failure while in steady state."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455805221, "post_id": 35466143, "comment_id": 58661326, "body": "@EricLippert, if your choicew is 1), what are you doing in C++ tag?"}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 4, "creation_date": 1455809360, "post_id": 35466143, "comment_id": 58664562, "body": "@SergeyA: I freely admit that I am not a C++ expert, having never written even a single C++ compiler; I have only ever written compilers for <i>other</i> languages in C++. You really don&#39;t know a language until after you&#39;ve written a couple of compilers for it. That said, I think I may be able to occasionally add some value on the subject."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455811781, "post_id": 35466143, "comment_id": 58666484, "body": "@Adrian, thats true but there are people who use MISRA-C:2012 in game systems, it&#39;s not only critical systems, otherwise they should not be using lint, do you agree?"}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455830409, "post_id": 35466143, "comment_id": 58677860, "body": "@Veriloud:  The question is about the rationale behind some of the rules, and the rules were written for critical systems.  The official title of the rules is <i>Guidelines for the Use of the C Language in Critical Systems</i>.  People using these guidelines for things that aren&#39;t critical systems is irrelevant to the rationale for the rules."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455831022, "post_id": 35466143, "comment_id": 58678187, "body": "@Adrian, regardless of its title, you do realize the original MISRA-C rules came out of the telecomm industry (a person working at BT)?  They are also based on many other safer C standards (e.g. Les Hatton), and of course, Koenig&#39;s (of AT&amp;T Bell Labs) Traps and Pitfalls, and: the C standards themselves specific to those areas in the C language that are unpredictable (undefined, unspecific and implementation specific) including folklore rules of the past MISRA stds, which have been downgraded or eliminated - i.e. no, the rationale applies to all c development."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "reply_to_user": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455831488, "post_id": 35466143, "comment_id": 58678451, "body": "@Veriloud:  This is not the right forum for this conversation.  The context of this question is about the rationale of particular MISRA guidelines.  The guidelines were written for critical systems.  Whether or not it makes sense to apply some of those guidelines in non-critical systems is off topic here."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455832294, "post_id": 35466143, "comment_id": 58678935, "body": "@Adrian, I used to work at the company that originally submitted the guidelines, I might know.  BTW, how do you know Thunderbird&#39;s context is safety critical (after all, lint is not normally a tool used in this area)?  I disagree its off topic, and the considerations as SergeyA provided are also on topic.  Many users apply MISRA-C that are not safety critical, this is why MISRA-C:2012 is being more widely adopted, and more of these questions from a non-critical context will be asked in the future."}], "tags": [], "owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "is_accepted": false, "score": 5, "last_activity_date": 1455738452, "last_edit_date": 1455738452, "creation_date": 1455737986, "answer_id": 35466143, "question_id": 35465754, "link": "https://stackoverflow.com/questions/35465754/rationale-behind-misra-2012-not-allowing-cast-between-different-pointers/35466143#35466143", "title": "rationale behind Misra 2012 not allowing cast between different pointers", "body": "<p>This does not answer your question, which is about rationales. Rather, it points out that you should not be in this situation in the first place.</p>\n\n<p>Typing \"misra malloc\" into your favourite search engine leads us to:</p>\n\n<p><a href=\"http://www.misra.org.uk/forum/viewtopic.php?t=260\" rel=\"noreferrer\">http://www.misra.org.uk/forum/viewtopic.php?t=260</a></p>\n\n<p>which asks:</p>\n\n<blockquote>\n  <p>As per the rule we are not supposed to use functions like malloc(), free(), calloc() etc. But malloc() is a very common requirement. Most of the embedded system applications use their own application level memory managers so as to make the allocation and de-allocation fast. Do you have any suggestions to get around this problem ( if we can't use malloc, any other way )? </p>\n</blockquote>\n\n<p>And the answer is:</p>\n\n<blockquote>\n  <p>We have been asked about solutions and workarounds for various things that are prohibited in both MISRA C1 and MISRA C2 such as using malloc, calloc, etc. for dynamic memory allocation. Neither MISRA or any member of the MISRA C Working Group will give any guidance or approval to any deviation or \"workaround\". </p>\n</blockquote>\n\n<hr>\n\n<p>You have a requirement that the code comply with a certain standard. You're using mechanisms which don't comply with that standard. Either figure out a <em>principled</em> and <em>robust</em> way to comply, or come up with a clear policy for how to deal with deliberate non-compliance.</p>\n\n<p>You mention memcpy, for example. It's non-compliant. So take a step back and ask \"suppose I did not have any implementation of memcpy.  <strong>How would I write my own memcpy that was compliant</strong>?\" You're using memcpy to solve a problem; solve the problem without it. </p>\n\n<p>Now do the same for malloc.  There was a day when malloc didn't exist, and someone had to write it without malloc. You have a problem that is solved by malloc. If you didn't have malloc, how would you solve it? Nothing in malloc is magical; you can write your own that does a better job than malloc does, where by \"better\" I mean \"complies with your requirements\".</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455805516, "post_id": 35475801, "comment_id": 58661547, "body": "@SergeyA With static or local allocation, obviously. (<a href=\"http://stackoverflow.com/questions/35341893/how-do-i-create-a-module-in-misrac2012-that-follows-dir-4-12-and-4-8\">This question</a>  is one such example.)  This is nothing unique to MISRA, all safety standards ban the use of dynamic memory allocation on the heap."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455805949, "post_id": 35475801, "comment_id": 58661911, "body": "How is it different from the &#39;heap&#39;? How allocating from <code>static char pool[gazzilion]</code> using your own allocator is safer than using language-provided, years tested and polished, peer-reviwed by multituted of eyes standard function?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 2, "creation_date": 1455806220, "post_id": 35475801, "comment_id": 58662127, "body": "@SergeyA Dynamic allocation leads to segmentation, non-deterministic allocation times, memory leaks and so on. It is a 100% superfluous, needlessly bloated feature in any small embedded system. In mission-critical software, dynamic allocation is also completely pointless, since there are no non-deterministic attributes present. Also note that <code>static type_t pool[n]</code> is only used for exactly <code>n</code> objects of type <code>type_t</code> and nothing else. While malloc is completely type/size generic and therefore must use segmentation."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455806475, "post_id": 35475801, "comment_id": 58662341, "body": "Hold on a sec. Are you also suggesting to use fixed pool for <i>every</i> different type of object I have in my program? So if I use approximately 500 <b>types</b> in my app, I end up with 500 pools? Also, how malloc is different in terms of leaks from allocating from said pool?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455807006, "post_id": 35475801, "comment_id": 58662796, "body": "@SergeyA For every ADT you use. Whenever you need to use true private encapsulation in C, which should be the only case when the ADT needs to do the allocation, rather than the caller. <code>malloc</code> is different because those who use it for the sake of saving memory must also actively call <code>free</code> and that&#39;s where you can get bugs. But &quot;saving memory&quot; dynamically doesn&#39;t make any sense in single process system, since you don&#39;t share memory with anyone. Your heap must always be large enough to fit the worst-case scenario, so they you might as well statically allocate that exact amount of memory."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455807221, "post_id": 35475801, "comment_id": 58662962, "body": "@SergeyA Think of it the other way: if you have a single process on a system with a certain fixed amount of memory, why would you want to use <code>malloc</code>? There exists no reason why you would ever need to do that, <a href=\"http://electronics.stackexchange.com/questions/171257/realloc-wasting-lots-of-space-in-my-mcu/171581#171581\">see this</a>."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455807755, "post_id": 35475801, "comment_id": 58663333, "body": "Lundin, if you do not free (in any way) resources from statically allocated pools, you might as well not free those you allocate dynamically. What makes it any different?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455807848, "post_id": 35475801, "comment_id": 58663408, "body": "Lundin, I would use malloc because it was tested more times than there are stars in observable part of universe (my wild guess at estimations). And if you do not want to free your resources, do not free them, no one forces you to. <code>malloc()</code> is also a function used by other library functions, for example, <code>strdup</code>. So, you are banning <code>strdup</code> too?"}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455808754, "post_id": 35475801, "comment_id": 58664088, "body": "@Lundin &quot;all safety standards ban the use of dynamic memory allocation on the heap.&quot;  The word &quot;ban&quot; is inappropriate for any rules within MISRA-C:2012 other than the mandatory ones, there&#39;s a reason why the language has changed since prior MISRA standards.  Also the \u201crules\u201d constitute are only one part of the entire document and it&#39;s vitally important the background information and process issues described in the leading sections are not ignored...instead of treating engineers like idiots to blindly follow the rules (like the previous MISRA versions).  This is why MISRA has such a bad rap."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455809256, "post_id": 35475801, "comment_id": 58664473, "body": "@SergeyA Just read the linked to post, it explains everything. To begin with, every computer in the world is not a RAM-based PC/desktop one..."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 5, "creation_date": 1455809805, "post_id": 35475801, "comment_id": 58664928, "body": "@SergeyA: The issue is not whether malloc is well tested. The issue is not whether it reliably performs according to its contract.  The issue is that malloc&#39;s contract is <b>terrible to begin with</b>. Malloc moves the testing burden from making sure that malloc does its job to making sure that the program that uses it is robust <b>in all possible code paths that could run out of memory</b>. It is nigh impossible to write robust software for that scenario."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1455811073, "post_id": 35475801, "comment_id": 58665914, "body": "@EricLippert, how does pool allocation solve this problem? Of not running out of memory, I mean."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455814092, "post_id": 35475801, "comment_id": 58668284, "body": "@SergeyA: Good question. First, begin by questioning whether a program even needs to dynamically allocate memory. If it doesn&#39;t, then you don&#39;t need an allocator. Suppose it does. How could we build allocators that have better contracts than malloc? You could build allocators that are much smarter. For example: allocators that know when a block of memory contains results that could be recomputed if necessary, and therefore the block can be invalidated when memory gets low."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1455814269, "post_id": 35475801, "comment_id": 58668394, "body": "@SergeyA: Allocators that provide services beyond merely &quot;here&#39;s your memory, or null&quot;, like being able to query the state of memory availability, or say what portions of the system are using how many resources, or put bounds on minimum, peak and average expected resource consumption. I could go on and on; you can make allocators that are way, way more powerful and useful than malloc that give you the benefits of type safety and amenability to analysis for both performance and correctness."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455814562, "post_id": 35475801, "comment_id": 58668595, "body": "@SergeyA: And to answer your earlier question, of course you get rid of strdup. strdup is horrid. The fact that you need to duplicate strings <i>at all</i> is a consequence of the horrible design decision to make strings mutable arrays. The fact that it can arbitrarily fail is awful. If you want to write reliable software then throw all that 40 year old stuff away and build <i>reliable, fortified subsystems whose correctness can be determined through static analysis</i>, and whose contracts make the analyzing the correctness of the whole programs tractable."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "edited": false, "score": 0, "creation_date": 1455816818, "post_id": 35475801, "comment_id": 58670093, "body": "@EricLippert, ping me when any modern 3-d game engine is written in your glorious new programming language. Or high-frequency trading software. So far all you are saying is wishful thinking."}, {"owner": {"reputation": 610493, "user_id": 88656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fbdff3ffb6f111d172759b4f05bea0e?s=128&d=identicon&r=PG", "display_name": "Eric Lippert", "link": "https://stackoverflow.com/users/88656/eric-lippert"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 1, "creation_date": 1455817006, "post_id": 35475801, "comment_id": 58670187, "body": "@SergeyA: As I&#39;ve repeatedly said: standards exist for a reason. The reason that mission-critical reliability standards exist is to ensure reliability in mission-critical software, by definition. The C runtime was not designed to meet those needs. If those are the wrong standards to apply to video games, because those standards impose unacceptable development or performance costs, then push back on the imposition of the standards!"}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455820474, "post_id": 35475801, "comment_id": 58672340, "body": "Again, &quot;required&quot; does not mean mandatory, MISRA-C:2012 can be  (should be IMHO) applied to non-critical software. Game programming can be &quot;MISRA compliant&quot; if you follow the process activities required, which any decent company would including rigorous peer review and documenting the reasons for not blindly tools/guidelines. As I said in my answer, the standard alludes to the practical world SergyA refers to, Dir. 4.12, pg. 34, &quot;If a decision is made to use dynamic memory, care shall be taken to ensure that the software behaves in a predictable manner...&quot; and then provides examples."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455830615, "post_id": 35475801, "comment_id": 58677954, "body": "&quot;every single user of MISRA has to ignore this rule&quot; [citation needed]  I&#39;m aware of software groups that do not ignore this rule."}, {"owner": {"reputation": 407, "user_id": 4759597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EogPb.png?s=128&g=1", "display_name": "Veriloud", "link": "https://stackoverflow.com/users/4759597/veriloud"}, "edited": false, "score": 0, "creation_date": 1455833077, "post_id": 35475801, "comment_id": 58679368, "body": "The rule is too broad, and because of the signal to noise factor developers turn off the rule in the tool...however, if the rule was more specific (as he suggested) it would do less harm than good...this is an issue of configuring the tool, also Lundin is right, this specific rule requires no deviation, but might have if they took his suggestion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 0, "creation_date": 1455866572, "post_id": 35475801, "comment_id": 58690733, "body": "@AdrianMcCarthy It is my own belief. I really don&#39;t see how it would be practical to write programs that can&#39;t contain NULL, memcpy/memset/memcmp, generic programming (functions like bsearch, qsort) etc etc.  I just now looked at the previous large project I made and checked what removing <code>void*</code> would mean. Most notably, it would mean that I would have to drop my std library which contains MISRA conforming equivalents of most common standard functions (the library ignores advisory rule 11.5) and instead use the compiler&#39;s non-compliant std lib, which is neither verified, safe nor portable."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1455782297, "creation_date": 1455782297, "answer_id": 35475801, "question_id": 35465754, "link": "https://stackoverflow.com/questions/35465754/rationale-behind-misra-2012-not-allowing-cast-between-different-pointers/35475801#35475801", "title": "rationale behind Misra 2012 not allowing cast between different pointers", "body": "<p>MISRA-C:2012 is actually somewhat lax when it comes to pointer conversions. Most rules are sound, concerned with forcing you to follow the C standard, not invoking undefined behavior, or do universally bad things like casting away const qualifiers from a pointer. You shouldn't have any objections against any of that.</p>\n\n<p>The only controversial rule is 11.5:</p>\n\n<blockquote>\n  <p>A conversion should not be performed from a pointer to void into a\n  pointer to object.</p>\n</blockquote>\n\n<p>I think this one is what causes you head ache. The rationale is alignment concerns and conversions between incompatible pointer types, which would lead to undefined behavior.</p>\n\n<p>That rule does indeed indirectly ban the use of many basic library functions like <code>memcpy</code>. My personal recommendation to MISRA regarding this rule during the 2012 review was:</p>\n\n<p>(Strongly disagree) \"There are too many cases of generic C programming when void pointer casts are necessary. This rule isn't practical and will do more harm than good. Instead, make a rule banning the specific danger the rule tries to protect against, namely \"pointer-to-x, cast to void*, cast to pointer-to-y\".\"</p>\n\n<p>But they didn't listen, and there you have it: a useless rule which forces every tool to spew out a flood of false positives. Meaning that every single user of MISRA has to ignore this rule. It is Advisory so you can ignore it without raising any deviation procedure. Just block it in your static analyser and move on.</p>\n\n<p>The MISRA committee has yet to realize that false positives is a safety hazard in itself, since it might lead to people starting to re-write perfectly fine code and thereby introducing bugs. </p>\n\n<blockquote>\n  <p>how does Misra expect malloc </p>\n</blockquote>\n\n<p>MISRA expects you not to use malloc at all, it is explicitly banned by directive 4.12, for very sound reasons. But that's another topic.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 5998710, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-mITi3xODuno/AAAAAAAAAAI/AAAAAAAAAAA/7boIcz1dMC0/photo.jpg?sz=128", "display_name": "Roberto Bagnara", "link": "https://stackoverflow.com/users/5998710/roberto-bagnara"}, "is_accepted": false, "score": 9, "last_activity_date": 1456766434, "creation_date": 1456766434, "answer_id": 35705550, "question_id": 35465754, "link": "https://stackoverflow.com/questions/35465754/rationale-behind-misra-2012-not-allowing-cast-between-different-pointers/35705550#35705550", "title": "rationale behind Misra 2012 not allowing cast between different pointers", "body": "<p>I would like to go back to what the OP asked and get a few things straight.\nFirst of all, there is no problem in calling void *memcpy(void *to, const void *from, size_t n), as a conversion of a pointer to object to a void pointer does not violate any MISRA-C:2012 guideline.  In other words, any tool producing violations for that is simply buggy.</p>\n\n<p>Secondly, before coming to any conclusion it is important to read what Rule 11.5, the relevant MISRA-C:2012 guideline, actually says, that is:</p>\n\n<pre>\n  Rule 11.5\n  A conversion should not be performed from pointer to void into\n  pointer to object\n\n  Category Advisory\n  Analysis Decidable, Single Translation Unit\n  Applies to C90, C99\n\n  Rationale\n  Conversion of a pointer to void into a pointer to object may result\n  in a pointer that is not correctly aligned, resulting in undefined\n  behaviour. It should be avoided where possible but may be necessary,\n  for example when dealing with memory allocation functions. If\n  conversion from a pointer to object into a pointer to void is used,\n  care should be taken to ensure that any pointers produced do not\n  give rise to the undefined behaviour discussed under Rule 11.3.\n</pre>\n\n<p>Observations:</p>\n\n<ol>\n<li>it is an advisory rule (i.e., neither required nor mandatory), so it can be deviated, and MISRA defined the correct deviation process;</li>\n<li>converting a pointer to object to a pointer to void is fine: it is the other way around that is problematic;</li>\n<li>the rationale explicitly mentions memory allocation functions (and, yes, a program that uses dynamic memory allocation can be made compliant to MISRA-C:2012);</li>\n<li>the rationale provides guidance on what to do when converting pointers to objects to pointers to void, perfectly in line with that the OP would like to have (\"info asking us to double check packing, alignment and anything else that might go wrong\").</li>\n</ol>\n"}], "owner": {"reputation": 2441, "user_id": 2313921, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0d70275bb0c90980f4149cb664bb768e?s=128&d=identicon&r=PG", "display_name": "thunderbird", "link": "https://stackoverflow.com/users/2313921/thunderbird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7257, "favorite_count": 2, "answer_count": 3, "score": 5, "last_activity_date": 1456766434, "creation_date": 1455736748, "last_edit_date": 1455833128, "question_id": 35465754, "link": "https://stackoverflow.com/questions/35465754/rationale-behind-misra-2012-not-allowing-cast-between-different-pointers", "title": "rationale behind Misra 2012 not allowing cast between different pointers", "body": "<p>I am currently working on a project which requires the code to be Misra 2012 compliant. Throughout the project we have lots of required misra warnings telling us we cant convert pointer to one type to a pointer to another type. Things as simple as <code>void *memcpy(void *to, const void *from, size_t n)</code> produce two Misra Required warnings since both to and from need to be type-casted to void* and const void* respectively. \nConversion from void* to a pointer to any other type also gives a Misra warning.</p>\n\n<p>My question is how does Misra expect malloc and everything else to work without any warnings being thrown? Even converting a void* buffer to uint8_t* buffer to parse abuffer byte by byte and fill up all the elements of a structure structure will throw numerous warnings?</p>\n\n<p>Instead of these warnings could it not just show use a note or info asking us to double check packing, alignment and anything else that might go wrong?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455738058, "post_id": 35465736, "comment_id": 58628006, "body": "Your first two lines in <code>main</code> uses <code>n</code> as the size for many array variables. But <code>n</code> is 0 at that point. So you have all 0 sized arrays. Maybe you meant to use <code>N</code> instead? This also illustrates why it is bad practice to use variable names that are so similar."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455738803, "post_id": 35465736, "comment_id": 58628477, "body": "I know that is what you intended <code>n</code> to do. The intention is fine. It&#39;s just that you are also using <code>n</code> incorrectly to intialise your array sizes. For example <code>w[n]</code> makes an aray with 0 elements instead of 25. Change that to <code>w[N]</code>. Same for the other array variables. Make sense?"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455738926, "post_id": 35465736, "comment_id": 58628552, "body": "Also, <code>while(n&lt;=N)</code> is wrong. That will allow <code>n</code> to be <code>25</code>. But 25 is not a valid array index and using it will overflow the arrays. The valid array indices are 0 to 24. Needs to be <code>while(n&lt;N)</code>. Probably other errors but I haven&#39;t looked through all the code. fix those first and re-test."}], "owner": {"reputation": 5, "user_id": 5942115, "user_type": "registered", "profile_image": "https://graph.facebook.com/10100399375201897/picture?type=large", "display_name": "ari", "link": "https://stackoverflow.com/users/5942115/ari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455737953, "creation_date": 1455736696, "last_edit_date": 1455737953, "question_id": 35465736, "link": "https://stackoverflow.com/questions/35465736/while-loop-for-scanning-user-input-table-into-array", "title": "while loop for scanning user input table into array", "body": "<p>I am a super unintuitive beginner programming student working on a homework assignment. The program is to take an input table of hockey teams and game stats, calculate \"points\", and then output the table organized in a different way, with additional columns for points and games played. </p>\n\n<p>So far, I haven't made it past scanning the input. With my while loop, I'm trying to first determine if the string is a conference name or a team name and then scan and store the subsequent table values accordingly. I'm just trying to print the same table back out at this point, but when i copy/paste the input input table which was given, I get no output, and when I manually type it in, it comes out suuper weird.</p>\n\n<p>The input table looks something like this:</p>\n\n<p>Conference1_Name    3               (teams in conference)</p>\n\n<p>Team_1_Name 31 15 2 2 (wins, losses, ot losses, shootout losses)</p>\n\n<p>Team_2_Name 24 21 1 0</p>\n\n<p>Team_3_Name 27 19 0 2</p>\n\n<p>Conference2_Name    4</p>\n\n<p>Team_4_Name 30 15 1 1</p>\n\n<p>...</p>\n\n<p>aaand this is my code so far...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;limits.h&gt;\n\nint main(void){\n    int n=0, N=25, nE=0, nW=0, i, w[n], l[n], otl[n], sol[n], gp[n], pts[n];\n    char input[30], team[n][30];\n\n    printf(\"Enter conference data\\n\");\n    setvbuf(stdout,NULL,_IONBF,0);\n\n    while(n&lt;=N){\n        scanf(\"%s\", input);\n        if (0==strcmp(input, \"Eastern_Conference\")) {\n            scanf(\"%d\", &amp;nE);\n            continue; //does not count eastern conference as a team, but stores number of teams, and does not increment n\n        }\n\n        if (0==strcmp(input, \"Western_Conference\")) {\n            scanf(\"%d\", &amp;nW);\n            continue; //does not count western conference as a team, but stores number of teams, and does not increment n\n        }\n\n        if (0==strcmp(input, \"EOD\")) break; \n\n    //originally i had a statement like: if (nE&gt;0 &amp;&amp; nW&gt;0){N=nE+nW;) so that the loop condition n&lt;N will break the loop on it's own but thought maybe EOD would simplify it and fix my problem//\n\n\n        strcpy(team[n], input);\n        scanf(\"%d%d%d%d\", &amp;w[n], &amp;l[n], &amp;otl[n], &amp;sol[n]);\n\n        gp[n]=w[n]+l[n];\n        pts[n]=(2*w[n])+otl[n]+sol[n];\n\n        n++;\n\n    }   //so we have input the data and calculated points\n\n    printf(\"\\n%s\\t%s\\t%s\\t%s\\t%s\\t%s\\t%s\\n\", \"WHL\", \"GP\", \"W\", \"L\", \"OTL\", \"SL\", \"PTS\");\n    for(i=0; i&lt;n; i++){\n        printf(\"%s\\t%d\\t%d\\t%d\\t%d\\t%d\\t%d\\n\", team[i], gp[i], w[i], l[i], otl[i], sol[i], pts[i]);\n    }\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "image-processing"], "comments": [{"owner": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 2, "creation_date": 1455738575, "post_id": 35465628, "comment_id": 58628321, "body": "C has no standard libraries for image display, because display is very dependent on OS, windowing system (or lack thereof) and other platform-specific factors.  It would be helpful if you added some background about the environment you wish to work in ."}, {"owner": {"reputation": 591, "user_id": 2584457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/043a4a2e4b3f45ca47379469a122b196?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2584457/josh"}, "reply_to_user": {"reputation": 32686, "user_id": 10396, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ddbfebb47432f6599da361df6a135c7c?s=128&d=identicon&r=PG", "display_name": "AShelly", "link": "https://stackoverflow.com/users/10396/ashelly"}, "edited": false, "score": 0, "creation_date": 1455812384, "post_id": 35465628, "comment_id": 58666969, "body": "@AShelly The environment I am using is Ubuntu 14.04 64 bit."}], "answers": [{"tags": [], "owner": {"reputation": 4668, "user_id": 5256563, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/eWfIu.gif?s=128&g=1", "display_name": "FiReTiTi", "link": "https://stackoverflow.com/users/5256563/firetiti"}, "is_accepted": false, "score": 1, "last_activity_date": 1455737182, "creation_date": 1455737182, "answer_id": 35465891, "question_id": 35465628, "link": "https://stackoverflow.com/questions/35465628/real-time-display-of-jpeg-in-byte-array-using-c/35465891#35465891", "title": "Real time display of .jpeg in byte array using C", "body": "<p>There are many different libraries to display an image. One lite/simple is <a href=\"http://nxv.sourceforge.net\" rel=\"nofollow\">NxV</a>. You can also use QT.</p>\n"}, {"tags": [], "owner": {"reputation": 144819, "user_id": 2836621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/suHg4.jpg?s=128&g=1", "display_name": "Mark Setchell", "link": "https://stackoverflow.com/users/2836621/mark-setchell"}, "is_accepted": false, "score": 0, "last_activity_date": 1455747059, "creation_date": 1455747059, "answer_id": 35468796, "question_id": 35465628, "link": "https://stackoverflow.com/questions/35465628/real-time-display-of-jpeg-in-byte-array-using-c/35468796#35468796", "title": "Real time display of .jpeg in byte array using C", "body": "<p>You can maybe use the <code>display</code> program which is part of the ImageMagick suite which is installed on most Linux distros and is also available for OSX and Windows.</p>\n\n<p>Basically, at the command line, you do:</p>\n\n<pre><code>display image.png\n</code></pre>\n\n<p>and it shows the image. It can display PNG, JPEG, TIFF and around 150 other formats. If your image changes, or you want to display a different one, you can do the following and it will look up the first instance of <code>display</code> and tell it to refresh with the new image:</p>\n\n<pre><code>display -remote image2.jpg\n</code></pre>\n\n<p>It can also take the image from its <code>stdin</code> as long as you tell it what type of file is coming, so it will work just as well like this:</p>\n\n<pre><code>cat image.jpg | display jpg:-\n</code></pre>\n\n<p>So you could effectively use <code>popen()</code> to start <code>display</code> and then send your image buffer to its <code>stdin</code> and then, when your image changes, run it again with the added <code>-remote</code> parameter to make it look up the first displayed image and refresh it rather than opening another display.</p>\n\n<p>There are many options to resize the image before display, overlay it on a solid background or texture and so on if you run <code>man display</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 2584457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/043a4a2e4b3f45ca47379469a122b196?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2584457/josh"}, "is_accepted": false, "score": 1, "last_activity_date": 1455900649, "last_edit_date": 1455900649, "creation_date": 1455899945, "answer_id": 35510305, "question_id": 35465628, "link": "https://stackoverflow.com/questions/35465628/real-time-display-of-jpeg-in-byte-array-using-c/35510305#35510305", "title": "Real time display of .jpeg in byte array using C", "body": "<p>I found a solution that will work for right now. I decided to use the OpenCV library which has deprecated C functions to handle image display. </p>\n\n<pre><code>void decryptionFunction(){\n\nuint8 *plaintext; /* Pointer to buffer that contains decrypted jpeg \n                   data*/\nuint32 plaintext_len;\nint k = 0;\nwhile(1){\n    /*Decryption happens here... malloc() buffer and set *plaintext \n     equal to it*/\n\n    CvMat matbox = cvMat(240, 320, CV_8UC1, plaintext);\n    IplImage *img;\n    img = cvDecodeImage(&amp;matbox, 1);\n    cvNamedWindow(\"test\", CV_WINDOW_AUTOSIZE);\n    cvShowImage(\"test\", img);\n    cvWaitKey(100);\n    cvReleaseImage(&amp;img);\n    free(plaintext);\n    }\n}\n</code></pre>\n\n<p>While these functions are deprecated and can be cut at any time, for the time being they do exactly what I want. The buffer contains compressed jpeg data, and in order for it to be shown in the window, it has to be decoded into a raw format. I am still looking for a C implementation that can do exactly this that isn't deprecated. </p>\n"}], "owner": {"reputation": 591, "user_id": 2584457, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/043a4a2e4b3f45ca47379469a122b196?s=128&d=identicon&r=PG", "display_name": "Josh", "link": "https://stackoverflow.com/users/2584457/josh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455900649, "creation_date": 1455736383, "question_id": 35465628, "link": "https://stackoverflow.com/questions/35465628/real-time-display-of-jpeg-in-byte-array-using-c", "title": "Real time display of .jpeg in byte array using C", "body": "<p>I am working on a project where I have a server that sends an encrypted jpeg to a client which then decrypts it. Currently the image is stored in a byte array on the receiver end before it is written to the current directory. </p>\n\n<pre><code>void decryptionFunction(){\n\n    uint8 *plaintext; /* Pointer to buffer that contains decrypted jpeg \n                       data*/\n    uint32 plaintext_len;\n    int k = 0;\n    while(1){\n        /*Decryption happens here... malloc() buffer and set *plaintext \n         equal to it*/\n\n        char buffer[32];\n        snprintf(buffer, sizeof(char) *32 \"file%i.jpeg\", k);\n        FILE *fp;\n        fp = fopen(buffer, \"wb\");\n        fwrite(plaintext, 1, plaintext_len, fp);\n        fclose(fp);\n        k++;\n        free(plaintext);\n    }\n}\n</code></pre>\n\n<p>Each time the while loop completes a new image is placed in the buffer and then writes the image to the current directory. This all works fine, however I would like to display the image somehow instead of writing it to the current directory. Is there a way to do this in C?  I have currently thought about streaming it from the receiver to VLC using some protocol, but that seems a little more complicated than what I am wanting. </p>\n\n<p>Ideally, I would like to just display the image from the buffer and refresh the display each time through the while loop. </p>\n\n<p>Thanks for any input.</p>\n"}, {"tags": ["c", "arrays", "pointers", "char", "constants"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1455735753, "post_id": 35465375, "comment_id": 58626463, "body": "<code>argv</code> can be modified, it&#39;s not required to be <code>const</code>, and maybe you are looking for <code>const char *const pointer</code> where the first const means that the pointed to data is <code>const</code> and the second means that the pointer itself is const, i.e. It cannot point to anything else but it&#39;s original value."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1455735811, "post_id": 35465375, "comment_id": 58626502, "body": "The first two snippets are identical, and produce exactly the same warning."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 2, "creation_date": 1455736366, "post_id": 35465375, "comment_id": 58626848, "body": "No, technically they are not identical. The first snippet is a an array of <code>char *</code>, the second is a double pointer."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 2, "creation_date": 1455736824, "post_id": 35465375, "comment_id": 58627163, "body": "@RPGillespie You have a lot to learn. Using the first snippet (without the consts), try <code>for (int i = 0; i &lt; argc; i++) printf( &quot;%s\\n&quot;, *argv++ );</code> and see what the compiler has to say about that (nothing), and whether it works (it does). Point is, even though the argument is specified as an array of pointers, it is actually a double pointer."}, {"owner": {"reputation": 720, "user_id": 1488669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3a04ac86429705678a33160bf9af58?s=128&d=identicon&r=PG", "display_name": "fanton", "link": "https://stackoverflow.com/users/1488669/fanton"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 0, "creation_date": 1455736982, "post_id": 35465375, "comment_id": 58627255, "body": "@user3386109: This is true in this particular case, with <code>argv</code>, but RPGillespie is right. In theory, <code>char **p;</code> and <code>char *p[]</code> are two different things."}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 720, "user_id": 1488669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3a04ac86429705678a33160bf9af58?s=128&d=identicon&r=PG", "display_name": "fanton", "link": "https://stackoverflow.com/users/1488669/fanton"}, "edited": false, "score": 3, "creation_date": 1455737066, "post_id": 35465375, "comment_id": 58627309, "body": "@fanton No, not when <code>char *p[]</code> appears as a function argument. In other contexts, sure."}, {"owner": {"reputation": 2418, "user_id": 5128826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03b54c3cd8c70aad8122d9391ce8028a?s=128&d=identicon&r=PG&f=1", "display_name": "nsilent22", "link": "https://stackoverflow.com/users/5128826/nsilent22"}, "edited": false, "score": 0, "creation_date": 1455739179, "post_id": 35465375, "comment_id": 58628714, "body": "Take a look at the answer to this question: <a href=\"http://stackoverflow.com/questions/7526152/easy-rule-to-read-complicated-const-declarations\" title=\"easy rule to read complicated const declarations\">stackoverflow.com/questions/7526152/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 3, "creation_date": 1455739851, "post_id": 35465375, "comment_id": 58629148, "body": "@RPGillespie The C Standard defines that they are exactly identical, in a function parameter list.  It is not possible to pass arrays by value in C"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 1, "creation_date": 1455741649, "post_id": 35465375, "comment_id": 58630197, "body": "<code>const char const</code> is the same as <code>const const char</code>, in every situation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1455741998, "post_id": 35465375, "comment_id": 58630377, "body": "... and the same as <code>const char</code> and <code>char const</code>, too, of course."}, {"owner": {"reputation": 83, "user_id": 5853934, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/458718767646876/picture?type=large", "display_name": "Jack Galt", "link": "https://stackoverflow.com/users/5853934/jack-galt"}, "edited": false, "score": 0, "creation_date": 1455779185, "post_id": 35465375, "comment_id": 58644306, "body": "Thanks for all the feedback. I know that *[] and ** are different when they aren&#39;t in a function argument, but my question was specifically whether or not they were producing an identical result in THIS case."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5853934, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/458718767646876/picture?type=large", "display_name": "Jack Galt", "link": "https://stackoverflow.com/users/5853934/jack-galt"}, "edited": false, "score": 0, "creation_date": 1455779626, "post_id": 35466695, "comment_id": 58644508, "body": "I realize that the syntax is non standard for a normal int main definition, I actually didn&#39;t write the code, it&#39;s a lesson I&#39;m working through that someone else wrote. I&#39;m still working though the whole program to understand the reasons for a lot of things done in the program. I suspect the const modifiers are there because argv is being used by APR functions, but I haven&#39;t gotten that far yet. Are there not certain instances where const modifiers are used <b>both</b> before the type and before the pointer of said type?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 83, "user_id": 5853934, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/458718767646876/picture?type=large", "display_name": "Jack Galt", "link": "https://stackoverflow.com/users/5853934/jack-galt"}, "edited": false, "score": 0, "creation_date": 1455780201, "post_id": 35466695, "comment_id": 58644784, "body": "@JackGalt no, these are both the same context (order of qualifiers and types makes no difference so long as you don&#39;t reorder past a <code>*</code>, you can even write <code>const int const long const long const</code> instead of <code>const long long</code> if you want)"}, {"owner": {"reputation": 83, "user_id": 5853934, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/458718767646876/picture?type=large", "display_name": "Jack Galt", "link": "https://stackoverflow.com/users/5853934/jack-galt"}, "edited": false, "score": 0, "creation_date": 1455784568, "post_id": 35466695, "comment_id": 58647055, "body": "Thank you! That helps clarify things considerably, and you saved me some time trying to understand what a code typo was doing. If the compiler had rejected it entirely I would&#39;ve understood immediately it was wrong. I&#39;ve seen other code examples with double use of const and so I assumed there was reason for it, I&#39;ve been chasing my tail apparently."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1455739629, "creation_date": 1455739629, "answer_id": 35466695, "question_id": 35465375, "link": "https://stackoverflow.com/questions/35465375/const-char-const-char-compiler-warning/35466695#35466695", "title": "const char const *char[] compiler warning", "body": "<p>In this line:</p>\n\n<pre><code>int main(int argc, const char const *argv[])\n</code></pre>\n\n<p>you wrote <code>const</code> twice. In general, this is permitted by the C Standard but it seems your compiler is being friendly and warning anyway.  You could either ignore or disable this warning, or remove one of the <code>const</code>s.</p>\n\n<p>However, <code>main</code> is special: using <code>const</code> here is non-standard. It should be:</p>\n\n<pre><code>int main(int argc, char *argv[])\n</code></pre>\n\n<p>Compilers may or may not accept the version with <code>const</code>. It is <em>implementation-defined</em> whether they do, which means the compiler's documentation should have a page talking about which signatures of <code>main</code> it accepts.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1455740119, "creation_date": 1455740119, "answer_id": 35466842, "question_id": 35465375, "link": "https://stackoverflow.com/questions/35465375/const-char-const-char-compiler-warning/35466842#35466842", "title": "const char const *char[] compiler warning", "body": "<blockquote>\n  <p>Unless I grossly misunderstand the way const works in a parameter definition, since argv is an array I would need to use</p>\n\n<pre><code>int main(int argc, const char const **argv)\n</code></pre>\n  \n  <p>or perhaps</p>\n\n<pre><code>int main(int argc, const char *argv[])\n</code></pre>\n</blockquote>\n\n<p>Apparently, then, you grossly misunderstand the way <code>const</code> works in a parameter definition.  We'll get to that in a moment, but first I observe that the permitted signatures for <code>main()</code> are <em>specified by the standard</em>.  Implementations are permitted to support additional signatures, but the ones that conforming, \"hosted\" implementations are required to support are:</p>\n\n<pre><code>int main(void)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>int main(int argc, char *argv[])\n</code></pre>\n\n<p>and equivalents (C2011, 5.1.2.2.1).  Regardless of all other considerations, therefore, those signatures are supported, and inequivalent ones, such as with <code>const</code> qualifiers, do not need to be supported.</p>\n\n<p>Back, then, to the question of array arguments.  Suppose you have an array ...</p>\n\n<pre><code>int a[4];\n</code></pre>\n\n<p>... that you want to pass to a function.  Technically speaking, you can't do it.  In almost all contexts, and particularly when they appear as function arguments, array values <em>decay</em> to pointers.  You can pass such a pointer, as is indeed common, but you cannot pass the array itself.  The element type of the array, including exactly the same qualifiers, is the target type of the resulting pointer value.  Moreover, <em>values</em> cannot be <code>const</code> -- that's a property of types.  Thus, it's perfectly fine to write</p>\n\n<pre><code>int a[4];\nint f(int *);\n\nf(a);\n</code></pre>\n\n<p>Additionally, be aware that both your proposed method signatures declare parameter <code>argv</code> as a pointer to a pointer to <code>const char</code>.  That type is not compatible with pointer to pointer to <code>char</code>.  If you wanted to declare that <code>argv</code> itself cannot be changed (though doing so is unnecessary) then you could write it as</p>\n\n<pre><code>int main(int argc, char ** const argv)\n</code></pre>\n\n<p>, which I suspect your compiler would accept.  If you wanted to declare that the pointers in the <code>argv</code> array cannot be changed via <code>argv</code>, then that would be ...</p>\n\n<pre><code>int main(int argc, char * const *argv)\n</code></pre>\n\n<p>... which also stands a good chance of being accepted.  What you actually tried to write, however, declared the <em>contents</em> of the <code>argv</code> elements to be <code>const</code>, and that's not compatible.</p>\n"}, {"tags": [], "owner": {"reputation": 449279, "user_id": 65863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f00013ceab8fb1928885c5c172fbfd4a?s=128&d=identicon&r=PG", "display_name": "Remy Lebeau", "link": "https://stackoverflow.com/users/65863/remy-lebeau"}, "is_accepted": false, "score": 1, "last_activity_date": 1455740545, "last_edit_date": 1455740545, "creation_date": 1455740241, "answer_id": 35466870, "question_id": 35465375, "link": "https://stackoverflow.com/questions/35465375/const-char-const-char-compiler-warning/35466870#35466870", "title": "const char const *char[] compiler warning", "body": "<p><code>const</code> applies to what is on its immediate left, unless there is nothing to the left then it applies to what is on its immediate right instead.  So the declaration:</p>\n\n<pre><code>int main(int argc, const char const *argv[])\n</code></pre>\n\n<p>Is applying two <code>const</code> to the same <code>char</code> identifier, hence the warning.</p>\n\n<p>If you want to say that <code>argv</code> is an array of non-constant pointers to constant characters, use this:</p>\n\n<pre><code>const char * argv[]\n</code></pre>\n\n<p>If you want to say that <code>argv</code> is an array of constant pointers to constant characters, use this:</p>\n\n<pre><code>const char * const argv[]\n</code></pre>\n\n<p>The <em>correct</em> declaration of <code>argv</code> parameter is simply <code>char* argv[]</code> or <code>char** argv</code>. No <code>const</code> specifiers are used at all.  Specific compilers may allow <code>const</code> variations, but that is not defined by the standards.</p>\n"}], "owner": {"reputation": 83, "user_id": 5853934, "user_type": "registered", "accept_rate": 17, "profile_image": "https://graph.facebook.com/458718767646876/picture?type=large", "display_name": "Jack Galt", "link": "https://stackoverflow.com/users/5853934/jack-galt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1455740545, "creation_date": 1455735629, "question_id": 35465375, "link": "https://stackoverflow.com/questions/35465375/const-char-const-char-compiler-warning", "title": "const char const *char[] compiler warning", "body": "<p>I'm learning C and still a little green but I'm going through some lessons and I am getting a compiler warning about a duplicate 'const' declaration specifier.</p>\n\n<p>the offending line is;</p>\n\n<pre><code>int main(int argc, const char const *argv[])\n</code></pre>\n\n<p>Unless I grossly misunderstand the way const works in a parameter definition, since argv is an array I would need to use;</p>\n\n<pre><code>int main(int argc, const char const **argv)\n</code></pre>\n\n<p>or perhaps</p>\n\n<pre><code>int main(int argc, const char *argv[])\n</code></pre>\n\n<p>The compiler doesn't complain with either of these options, and if my thinking is correct both should produce the same result since *argv[] is a pointer to an array. I realize they would have different meanings if argv were NOT an array, but am I wrong that they produce the same result and that they are the proper declaration as opposed to the original, in this particular case?</p>\n"}, {"tags": ["c", "testing", "http2"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455735182, "post_id": 35464959, "comment_id": 58626132, "body": "I think it is not obvious what <code>h2[c]</code> is.."}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1455735276, "post_id": 35464959, "comment_id": 58626186, "body": "Why you do not use <code>telnet</code> ?"}, {"owner": {"reputation": 774, "user_id": 623115, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/57b3c8ce4f8a0ee655676a0513cf318e?s=128&d=identicon&r=PG", "display_name": "Cracker", "link": "https://stackoverflow.com/users/623115/cracker"}, "reply_to_user": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1455735424, "post_id": 35464959, "comment_id": 58626265, "body": "@ParhamAlvani because it&#39;s a binary protocol"}, {"owner": {"reputation": 1829, "user_id": 4242097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1347add4ae303c0258a3db358ed77c55?s=128&d=identicon&r=PG", "display_name": "Parham Alvani", "link": "https://stackoverflow.com/users/4242097/parham-alvani"}, "edited": false, "score": 0, "creation_date": 1455735446, "post_id": 35464959, "comment_id": 58626279, "body": "sorry ... I find it now .."}, {"owner": {"reputation": 774, "user_id": 623115, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/57b3c8ce4f8a0ee655676a0513cf318e?s=128&d=identicon&r=PG", "display_name": "Cracker", "link": "https://stackoverflow.com/users/623115/cracker"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1455735463, "post_id": 35464959, "comment_id": 58626288, "body": "@EugeneSh. I assume that if one doesn&#39;t know what <code>h2&#47;h2c</code> is, they cannot help me anyway"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1455735558, "post_id": 35464959, "comment_id": 58626342, "body": "You might be very wrong. There are plenty of people just happy to learn. And <i>many</i> of the good answers were not known to the answerers themselves prior the questions."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1455736645, "post_id": 35464959, "comment_id": 58627050, "body": "I know next to nothing about h2 and h2c, but it didn&#39;t take long for me to find the HTTP/2 working group&#39;s <a href=\"https://github.com/http2/http2-spec/wiki/Implementations\" rel=\"nofollow noreferrer\">list of known implementations</a>.  These include several h2c-based clients.  Among then, it claims <code>curl</code> supports h2c-14.  Apparently there is also a Perl module for HTTP/2 that supports h2c."}], "answers": [{"comments": [{"owner": {"reputation": 774, "user_id": 623115, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/57b3c8ce4f8a0ee655676a0513cf318e?s=128&d=identicon&r=PG", "display_name": "Cracker", "link": "https://stackoverflow.com/users/623115/cracker"}, "edited": false, "score": 0, "creation_date": 1455790003, "post_id": 35465713, "comment_id": 58650699, "body": "Thanks! Just what I was looking for."}, {"owner": {"reputation": 5687, "user_id": 717521, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e3a42e29e189a1d4b1aade7c42dbb1e3?s=128&d=identicon&r=PG", "display_name": "Andy Davies", "link": "https://stackoverflow.com/users/717521/andy-davies"}, "edited": false, "score": 1, "creation_date": 1455910794, "post_id": 35465713, "comment_id": 58717872, "body": "Other tool to try is h2spec <a href=\"https://github.com/summerwind/h2spec\" rel=\"nofollow noreferrer\">github.com/summerwind/h2spec</a> which tests servers for conformance with the spec"}], "tags": [], "owner": {"reputation": 13642, "user_id": 1215076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7363920d78e5115b7d2cf0774b60d653?s=128&d=identicon&r=PG", "display_name": "sbordet", "link": "https://stackoverflow.com/users/1215076/sbordet"}, "is_accepted": true, "score": 3, "last_activity_date": 1455736621, "creation_date": 1455736621, "answer_id": 35465713, "question_id": 35464959, "link": "https://stackoverflow.com/questions/35464959/simple-tool-to-test-my-h2c-implementation/35465713#35465713", "title": "Simple tool to test my h2c implementation", "body": "<p>Since you work in C, you can use <a href=\"https://nghttp2.org/\" rel=\"nofollow\"><code>nghttp2</code></a> to test your <code>h2c</code> implementation.</p>\n\n<p>I just tried it against a <a href=\"http://eclipse.org/jetty\" rel=\"nofollow\">Jetty</a> HTTP/2 server, and this is the output:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ nghttp -v http://localhost:8080\n[  0.000] send SETTINGS frame &lt;length=12, flags=0x00, stream_id=0&gt;\n      (niv=2)\n      [SETTINGS_MAX_CONCURRENT_STREAMS(0x03):100]\n      [SETTINGS_INITIAL_WINDOW_SIZE(0x04):65535]\n[  0.000] send HEADERS frame &lt;length=33, flags=0x05, stream_id=1&gt;\n      ; END_STREAM | END_HEADERS\n      (padlen=0)\n      ; Open new stream\n      :authority: localhost:8080\n      :method: GET\n      :path: /\n      :scheme: http\n      accept: */*\n      accept-encoding: gzip, deflate\n      user-agent: nghttp2/0.6.7\n[  0.104] recv SETTINGS frame &lt;length=12, flags=0x00, stream_id=0&gt;\n      (niv=2)\n      [SETTINGS_HEADER_TABLE_SIZE(0x01):4096]\n      [SETTINGS_INITIAL_WINDOW_SIZE(0x04):65535]\n[  0.104] send SETTINGS frame &lt;length=0, flags=0x01, stream_id=0&gt;\n      ; ACK\n      (niv=0)\n[  0.105] recv SETTINGS frame &lt;length=0, flags=0x01, stream_id=0&gt;\n      ; ACK\n      (niv=0)\n[  0.121] recv (stream_id=1, noind=0) :status: 200\n[  0.121] recv (stream_id=1, noind=0) server: Jetty(9.3.z-SNAPSHOT)\n[  0.121] recv (stream_id=1, noind=0) date: Wed, 17 Feb 2016 19:11:17 GMT\n[  0.121] recv (stream_id=1, noind=0) custom: Value\n[  0.121] recv (stream_id=1, noind=0) content-type: text/plain\n[  0.121] recv (stream_id=1, noind=0) content-length: 72\n[  0.121] recv HEADERS frame &lt;length=70, flags=0x04, stream_id=1&gt;\n      ; END_HEADERS\n      (padlen=0)\n      ; First response header\nHello from Jetty using HTTP/2.0\nuri=/\ndate=Wed Feb 17 20:11:17 CET 2016\n[  0.121] recv DATA frame &lt;length=72, flags=0x01, stream_id=1&gt;\n      ; END_STREAM\n[  0.121] send GOAWAY frame &lt;length=8, flags=0x00, stream_id=0&gt;\n      (last_stream_id=0, error_code=NO_ERROR(0x00), opaque_data(0)=[])\n</code></pre>\n"}], "owner": {"reputation": 774, "user_id": 623115, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/57b3c8ce4f8a0ee655676a0513cf318e?s=128&d=identicon&r=PG", "display_name": "Cracker", "link": "https://stackoverflow.com/users/623115/cracker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "closed_date": 1455744764, "accepted_answer_id": 35465713, "answer_count": 1, "score": 1, "last_activity_date": 1455736621, "creation_date": 1455734318, "question_id": 35464959, "link": "https://stackoverflow.com/questions/35464959/simple-tool-to-test-my-h2c-implementation", "closed_reason": "Needs details or clarity", "title": "Simple tool to test my h2c implementation", "body": "<p>As a part of my studies, I decided to write an HTTP/2 server that is capable of simply serving static files. I have to write it in C, which I have very little experience with, so I decided to go with <code>h2c</code> (uses TCP), not <code>h2</code> (uses TLS). I need some tool to test my server, but I cannot use neither Chrome, nor Firefox, because both of them support only <code>h2</code>.</p>\n\n<p>What is the easiest way to test my server? Maybe there is some <code>h2c</code> implementation for other language, like python or js (node), where I can quickly assemble a test client?</p>\n\n<p>I still consider implementing <code>h2</code>, if nothing comes up, but after looking at <a href=\"https://wiki.openssl.org/index.php/SSL/TLS_Client\" rel=\"nofollow\">this OpenSSL TLS client example</a>, I am sort of scared, because it's only a simple <code>GET</code> and its size is 4 times the code I have written so far.</p>\n"}, {"tags": ["c", "pointers", "malloc"], "comments": [{"owner": {"reputation": 3968, "user_id": 2402061, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/VUGa3.png?s=128&g=1", "display_name": "Ricky Mutschlechner", "link": "https://stackoverflow.com/users/2402061/ricky-mutschlechner"}, "edited": false, "score": 1, "creation_date": 1455733186, "post_id": 35464562, "comment_id": 58624972, "body": "<code>malloc</code> will give you a pointer to some memory at least as big as the size that you ask for (although sometimes it will return <code>NULL</code>, on failure). Did you try actually printing out <code>sizeof(node)</code> versus <code>sizeof(node *)</code> to see what you get?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455733244, "post_id": 35464562, "comment_id": 58624999, "body": "You do not &quot;allocate a pointer&quot;, but an object of the type it <b>points to</b> and assign the address to the pointer. Now think which size you have to pass to <code>malloc</code>."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1455733195, "creation_date": 1455733195, "answer_id": 35464614, "question_id": 35464562, "link": "https://stackoverflow.com/questions/35464562/c-allocate-a-pointer/35464614#35464614", "title": "C: allocate a pointer", "body": "<pre><code>head=malloc(sizeof(node*));\n</code></pre>\n\n<p>is incorrect. That call to <code>malloc</code> allocates enough memory to hold only a <code>node*</code>. A <code>node*</code> must point to a <code>node</code> object. That means you need to allocate sufficient memory to hold a <code>node</code> object, not a <code>node*</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1455733218, "creation_date": 1455733218, "answer_id": 35464619, "question_id": 35464562, "link": "https://stackoverflow.com/questions/35464562/c-allocate-a-pointer/35464619#35464619", "title": "C: allocate a pointer", "body": "<p><code>sizeof(node)</code> is the size in bytes of the whole struct, which can be arbitrarily large. <code>sizeof(node*)</code> is the size of a pointer variable, which is fixed, no matter how large is the structure (and it is pretty small on most systems).</p>\n"}, {"comments": [{"owner": {"reputation": 457, "user_id": 3486475, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uuvCX.jpg?s=128&g=1", "display_name": "Mr T", "link": "https://stackoverflow.com/users/3486475/mr-t"}, "edited": false, "score": 0, "creation_date": 1455733467, "post_id": 35464669, "comment_id": 58625133, "body": "So what&#39;s the point to type that &quot;head=malloc(sizeof(node*));&quot; anyway?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 457, "user_id": 3486475, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uuvCX.jpg?s=128&g=1", "display_name": "Mr T", "link": "https://stackoverflow.com/users/3486475/mr-t"}, "edited": false, "score": 0, "creation_date": 1455741254, "post_id": 35464669, "comment_id": 58629985, "body": "@Skemelio If you wanted to allocate a pointer, for some reason. You might write <code>node **head = malloc(sizeof(node*));</code>"}], "tags": [], "owner": {"reputation": 2201, "user_id": 4326588, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oZdKx.jpg?s=128&g=1", "display_name": "Ulysses", "link": "https://stackoverflow.com/users/4326588/ulysses"}, "is_accepted": true, "score": 2, "last_activity_date": 1455733313, "last_edit_date": 1495535298, "creation_date": 1455733313, "answer_id": 35464669, "question_id": 35464562, "link": "https://stackoverflow.com/questions/35464562/c-allocate-a-pointer/35464669#35464669", "title": "C: allocate a pointer", "body": "<pre><code>head=malloc(sizeof(node*));\n</code></pre>\n\n<p>Will allocate a space in memory to hold a POINTER to a object of type node.</p>\n\n<pre><code>head=malloc(sizeof(node));\n</code></pre>\n\n<p>Will allocate space for the structure itself, and return to you the address of that memory space, and you will hold that in the <code>head</code> variable</p>\n\n<p>For more info, check this other question about Malloc.\n<a href=\"https://stackoverflow.com/questions/1957099/how-do-free-and-malloc-work-in-c\">How do free and malloc work in C?</a></p>\n"}], "owner": {"reputation": 457, "user_id": 3486475, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/uuvCX.jpg?s=128&g=1", "display_name": "Mr T", "link": "https://stackoverflow.com/users/3486475/mr-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1632, "favorite_count": 0, "accepted_answer_id": 35464669, "answer_count": 3, "score": -6, "last_activity_date": 1455733313, "creation_date": 1455733008, "question_id": 35464562, "link": "https://stackoverflow.com/questions/35464562/c-allocate-a-pointer", "title": "C: allocate a pointer", "body": "<p>So we have a struct that is actually representing a node of a linked list. Also a pointer that points to node.</p>\n\n<pre><code>typedef struct node{\n    int value;\n    struct node *next;\n}node;\n\nnode* head=NULL;\n</code></pre>\n\n<p>If I am going to dynamically allocate the pointer using malloc,</p>\n\n<pre><code>head=malloc(sizeof(node));\n</code></pre>\n\n<p>that means that I am creating some memory space, with size of node, and head is pointing at it.</p>\n\n<p>I would like to know the difference between this  <code>head=malloc(sizeof(node*));</code>, as you can see in the sizeof it has node* instead of node. Now I really think that all this time I had no idea what  malloc really does!</p>\n"}, {"tags": ["c++", "c", "opencv", "opencv3.0", "opencv-stitching"], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 5006200, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC640Vu0Q_VRenFl1xtiaW5Tf7C6HTNG-NE3da42g=k-s128", "display_name": "Ali Jahani", "link": "https://stackoverflow.com/users/5006200/ali-jahani"}, "is_accepted": false, "score": 0, "last_activity_date": 1456148199, "last_edit_date": 1456148199, "creation_date": 1456034162, "answer_id": 35532823, "question_id": 35463797, "link": "https://stackoverflow.com/questions/35463797/opencv-stitching-how-to-get-better-performance-using-opencv-stitcher-class/35532823#35532823", "title": "(OpenCV Stitching) How to get better performance using OpenCV Stitcher class?", "body": "<ol>\n<li><p>FAST feature detector is faster than SURF and ORB.</p>\n\n<p>Moreover, finding 1500 features in a 640*480 picture takes too much time. 300 features is ok. So you can use this code instead:</p>\n\n<pre><code>detail::OrbFeaturesFinder(Size(3,1),300));\n</code></pre></li>\n<li><p>Stitcher Class is so slow. I suggest you try to implement stitcher class yourself. Try using feature detectors, descriptors, then matching and after that find homography then making mask and then warping. </p></li>\n<li><p>I don't understand your third question, <em>\"How can I catch directions between two images?\"</em>. What do you mean exactly?</p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 4082588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/890cad26c94c7d7f6891ad652b19e758?s=128&d=identicon&r=PG&f=1", "display_name": "\uae40\ub0a8\uaddc", "link": "https://stackoverflow.com/users/4082588/%ea%b9%80%eb%82%a8%ea%b7%9c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2743, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1456148199, "creation_date": 1455730603, "question_id": 35463797, "link": "https://stackoverflow.com/questions/35463797/opencv-stitching-how-to-get-better-performance-using-opencv-stitcher-class", "title": "(OpenCV Stitching) How to get better performance using OpenCV Stitcher class?", "body": "<p>I have some problems when using Stitcher class.</p>\n\n<p>First, I use ORB Feature Finder because it's faster than SURF.\nbut it's still slow.</p>\n\n<p>Second, Stitcher class accuracy is too low.</p>\n\n<p>Third, How can I get more performance by using Stitcher class?</p>\n\n<p>Additional, How can I catch directions between two images?</p>\n\n<p>This is my code.</p>\n\n<p>Thank you.</p>\n\n<pre><code>#include \"opencv2/core/core.hpp\"\n#include \"opencv2/highgui/highgui.hpp\"\n#include \"opencv2/stitching.hpp\"\n#include \"opencv2/features2d.hpp\"\n\nusing namespace cv;\nusing namespace std;\n\nvoid overlayImage(const cv::Mat &amp;background, const cv::Mat &amp;foreground, cv::Mat &amp;output, cv::Point2i location);\n\nint main(int argc, char* argv[])\n{\n\n Mat first;\n Mat second;\n Mat m_first;\n Mat m_second;\n vector&lt;Mat&gt; images;\n// vector&lt;Mat&gt; re_images;\n Mat panorama;\n Mat result;\n unsigned long t;\n t = getTickCount();\n first = imread(argv[1], CV_LOAD_IMAGE_COLOR);\n second = imread(argv[2], CV_LOAD_IMAGE_COLOR);\n //Mat m_first = Mat::zeros( first.size(), first.type() );\n //Mat m_second = Mat::zeros( second.size(), second.type() );\n /*\nfor( int y = 0; y &lt; first.rows; y++ ) {\n    for( int x = 0; x &lt; first.cols; x++ ) {\n         for( int c = 0; c &lt; 3; c++ ) {\n          m_first.at&lt;Vec3b&gt;(y,x)[c] = saturate_cast&lt;uchar&gt;( 1.2*( first.at&lt;Vec3b&gt;(y,x)[c] ) + 20 );\n     }\n    }\n}\n\nfor( int y = 0; y &lt; second.rows; y++ ){\n for( int x = 0; x &lt; second.cols; x++ ) {\n         for( int c = 0; c &lt; 3; c++ )  {\n      m_second.at&lt;Vec3b&gt;(y,x)[c] =\n         saturate_cast&lt;uchar&gt;( 1.2*( second.at&lt;Vec3b&gt;(y,x)[c] ) + 20 );\n    }\n    }\n}\n*/\n//imwrite(\"first.png\", m_first);\n//imwrite(\"second.png\", m_second);\n resize(first, m_first, Size(640, 480));\n resize(second, m_second, Size(640, 480));\n images.push_back(m_first); \n images.push_back(m_second);\n\n\n Stitcher stitcher = Stitcher::createDefault(false);\n //Stitcher::Status status = stitcher.stitch(imgs, pano);\n //stitcher.setWarper(new PlaneWarper());\n stitcher.setWarper(new SphericalWarper());\n// stitcher.setWarper(new CylindricalWarper());\n stitcher.setFeaturesFinder(new detail::OrbFeaturesFinder(Size(3,1),1500));\n//        stitcher.setRegistrationResol(0.6);\n//        stitcher.setSeamEstimationResol(0.1);\n//        stitcher.setCompositingResol(0.5);\n//stitcher.setPanoConfidenceThresh(1);\n        stitcher.setWaveCorrection(true);\n        stitcher.setWaveCorrectKind(detail::WAVE_CORRECT_HORIZ);\n        stitcher.setFeaturesMatcher(new detail::BestOf2NearestMatcher(false,0.3));\n        stitcher.setBundleAdjuster(new detail::BundleAdjusterRay());\n\n        stitcher.setBlender(new detail::MultiBandBlender());\n stitcher.stitch(images, panorama);\n printf(\"%.2lf sec \\n\",  (getTickCount() - t) / getTickFrequency() );\n Rect rect(panorama.cols / 2 - 320, panorama.rows / 2 - 240, 640, 480);\n Mat subimage = panorama(rect);\n Mat car = imread(\"car.png\");\n overlayImage(subimage, car, result, cv::Point(320 - (car.cols / 2), 240 - (car.rows / 2 )));\n imshow(\"panorama\", result);\n// resize(panorama, result, Size(640, 480));\n imwrite(\"result.jpg\", result);\n waitKey(0); \n\n return 0;\n}\n\nvoid overlayImage(const cv::Mat &amp;background, const cv::Mat &amp;foreground, cv::Mat &amp;output, cv::Point2i location)\n{\n  background.copyTo(output);\n\n\n\n   // start at the row indicated by location, or at row 0 if location.y is negative.\n  for(int y = std::max(location.y , 0); y &lt; background.rows; ++y)\n  {\n    int fY = y - location.y; // because of the translation\n\n     // we are done of we have processed all rows of the foreground image.\n    if(fY &gt;= foreground.rows)\n      break;\n\n     // start at the column indicated by location, \n\n\n    // or at column 0 if location.x is negative.\n    for(int x = std::max(location.x, 0); x &lt; background.cols; ++x)\n    {\n      int fX = x - location.x; // because of the translation.\n\n       // we are done with this row if the column is outside of the foreground image.\n      if(fX &gt;= foreground.cols)\n        break;\n\n       // determine the opacity of the foregrond pixel, using its fourth (alpha) channel.\n      double opacity =\n        ((double)foreground.data[fY * foreground.step + fX * foreground.channels() + 3])\n\n\n        / 255.;\n\n\n\n       // and now combine the background and foreground pixel, using the opacity, \n\n\n      // but only if opacity &gt; 0.\n      for(int c = 0; opacity &gt; 0 &amp;&amp; c &lt; output.channels(); ++c)\n      {\n        unsigned char foregroundPx =\n          foreground.data[fY * foreground.step + fX * foreground.channels() + c];\n\n        unsigned char backgroundPx =\n          background.data[y * background.step + x * background.channels() + c];\n\n        output.data[y*output.step + output.channels()*x + c] =\n          backgroundPx * (1.-opacity) + foregroundPx * opacity;\n\n      }\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "linker", "unresolved-external"], "comments": [{"owner": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 0, "creation_date": 1455730657, "post_id": 35463679, "comment_id": 58623474, "body": "You need the extern &quot;C&quot; bit"}], "answers": [{"comments": [{"owner": {"reputation": 40276, "user_id": 432358, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/D931H.png?s=128&g=1", "display_name": "Slava", "link": "https://stackoverflow.com/users/432358/slava"}, "edited": false, "score": 1, "creation_date": 1455730526, "post_id": 35463736, "comment_id": 58623393, "body": "As that header is used in .c <code>extern &quot;C&quot;</code> should be <code>#ifdef</code> for C++"}, {"owner": {"reputation": 4858, "user_id": 5739035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-RQUt7m42pBk/AAAAAAAAAAI/AAAAAAAAAyw/mLHBtE-PQic/photo.jpg?sz=128", "display_name": "Adi Levin", "link": "https://stackoverflow.com/users/5739035/adi-levin"}, "edited": false, "score": 0, "creation_date": 1455730645, "post_id": 35463736, "comment_id": 58623469, "body": "Yep. Added now. Thanks!"}, {"owner": {"reputation": 8058, "user_id": 619818, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qzq4k.jpg?s=128&g=1", "display_name": "Angus Comber", "link": "https://stackoverflow.com/users/619818/angus-comber"}, "edited": false, "score": 0, "creation_date": 1455730658, "post_id": 35463736, "comment_id": 58623475, "body": "Just tried surrounding both C functions with #ifdef __cplusplus and that works"}, {"owner": {"reputation": 8058, "user_id": 619818, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qzq4k.jpg?s=128&g=1", "display_name": "Angus Comber", "link": "https://stackoverflow.com/users/619818/angus-comber"}, "edited": false, "score": 0, "creation_date": 1455730793, "post_id": 35463736, "comment_id": 58623550, "body": "Sorry, only needed for legacy_task func"}, {"owner": {"reputation": 27952, "user_id": 3747990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qE6kU.png?s=128&g=1", "display_name": "Niall", "link": "https://stackoverflow.com/users/3747990/niall"}, "edited": false, "score": 0, "creation_date": 1455731372, "post_id": 35463736, "comment_id": 58623910, "body": "Albeit that this is a duplicate, this is a very nice answer."}, {"owner": {"reputation": 202, "user_id": 3664223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0235b292b7fcf98faf75e2aa360865?s=128&d=identicon&r=PG&f=1", "display_name": "user3664223", "link": "https://stackoverflow.com/users/3664223/user3664223"}, "edited": false, "score": 0, "creation_date": 1530108493, "post_id": 35463736, "comment_id": 89119735, "body": "Tried with this(surrounding with extern c) didnt worked, Actually c code code in another project in same solution(vs2015) and I am calling from cpp function project, please let me know any other things to check."}], "tags": [], "owner": {"reputation": 4858, "user_id": 5739035, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-RQUt7m42pBk/AAAAAAAAAAI/AAAAAAAAAyw/mLHBtE-PQic/photo.jpg?sz=128", "display_name": "Adi Levin", "link": "https://stackoverflow.com/users/5739035/adi-levin"}, "is_accepted": true, "score": 13, "last_activity_date": 1455730737, "last_edit_date": 1495542176, "creation_date": 1455730392, "answer_id": 35463736, "question_id": 35463679, "link": "https://stackoverflow.com/questions/35463679/unresolved-external-calling-c-function-from-c/35463736#35463736", "title": "Unresolved external calling C function from C++", "body": "<p>Notice that the link error says that the symbol <code>?legacy_task@@YAXXZ</code> was not found. This is a mingled name, derived by the C++ compiler from the function name. For compatibility with C, you need to use \"extern \"C\" in <code>legacy.h</code>:</p>\n\n<pre><code>#ifdef __cplusplus\nextern \"C\" {\n#endif\n   void legacy_task (void);\n#ifdef __cplusplus\n}\n#endif\n</code></pre>\n\n<p>This way, the compiler does not mangle the funtion's name.</p>\n\n<p>For a detailed discussion of <code>extern \"C\"</code>, see <a href=\"https://stackoverflow.com/questions/1041866/in-c-source-what-is-the-effect-of-extern-c\">In C++ source, what is the effect of extern &quot;C&quot;?</a></p>\n"}], "owner": {"reputation": 8058, "user_id": 619818, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/qzq4k.jpg?s=128&g=1", "display_name": "Angus Comber", "link": "https://stackoverflow.com/users/619818/angus-comber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4971, "favorite_count": 0, "closed_date": 1455730625, "accepted_answer_id": 35463736, "answer_count": 1, "score": 2, "last_activity_date": 1455730737, "creation_date": 1455730235, "question_id": 35463679, "link": "https://stackoverflow.com/questions/35463679/unresolved-external-calling-c-function-from-c", "closed_reason": "Duplicate", "title": "Unresolved external calling C function from C++", "body": "<p>I have a Visual Studio solution which has to call legacy C code from C++ code and I am getting linker errors.  Eg:</p>\n\n<pre><code>1&gt;------ Build started: Project: testapp_soln, Configuration: Debug Win32 ------\n1&gt;legacy.lib(launchit.obj) : error LNK2019: unresolved external symbol \"void __cdecl legacy_task(void)\" (?legacy_task@@YAXXZ) referenced in function \"public: virtual void __thiscall Launchit::DoIt(void)\" (?DoIt@Launchit@@UAEXXZ)\n1&gt;E:\\share\\code\\so\\TestApp\\testapp_soln\\Debug\\testapp_soln.exe : fatal error LNK1120: 1 unresolved externals\n========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ==========\n</code></pre>\n\n<p>I have a static lib project called legacy with a C++ class, launchit calling the C functions in legacy C code.</p>\n\n<p>Here are details of the legacy project.</p>\n\n<p>legacy.h:</p>\n\n<pre><code>#ifndef LEGACY_H_\n#define LEGACY_H_\n\nextern void legacy_task (void);\n\nextern int initialise_thing();\n\n#endif /* LEGACY_H_ */\n</code></pre>\n\n<p>legacy.c</p>\n\n<pre><code>#include \"legacy.h\"\n\nvoid legacy_task (void)\n{\n  /* doing things */\n  initialise_thing();\n}\n</code></pre>\n\n<p>legacy_init.c</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint initialise_thing()\n{\n  printf(\"Doing init thing here\\n\");\n  return 0;\n}\n</code></pre>\n\n<p>legacy C stuff called from launchit class</p>\n\n<p>launchit.hpp</p>\n\n<pre><code>#ifndef LAUNCHIT_HPP_\n#define LAUNCHIT_HPP_\n\nclass Launchit\n{\npublic:\n    Launchit();\n    virtual ~Launchit();\n    virtual void DoIt();\n};\n\n#endif // LAUNCHIT_HPP_\n</code></pre>\n\n<p>launchit.cpp</p>\n\n<pre><code>#include \"Launchit.hpp\"\n#include \"legacy.h\"\n\nLaunchit::Launchit() \n{\n}\n\nLaunchit::~Launchit()\n{\n</code></pre>\n\n<h2>    }</h2>\n\n<pre><code>void Launchit::DoIt()\n{\n    legacy_task();\n}\n</code></pre>\n\n<p>Then I build this as a static lib.  It build just fine.</p>\n\n<p>I have a console application project like this:</p>\n\n<pre><code>#include \"launchit.hpp\"\n\nint main() {\n    Launchit li;\n    li.DoIt();\n}\n</code></pre>\n\n<p>But this gives me linker error:</p>\n\n<pre><code>legacy.lib(launchit.obj) : error LNK2019: unresolved external symbol \"void __cdecl legacy_task(void)\" (?legacy_task@@YAXXZ) referenced in function \"public: virtual void __thiscall Launchit::DoIt(void)\" (?DoIt@Launchit@@UAEXXZ)\n</code></pre>\n\n<p>How can I fix this linker error?</p>\n"}, {"tags": ["c", "arrays", "sorting", "char", "bubble-sort"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455729150, "post_id": 35463265, "comment_id": 58622491, "body": "Tip: Change <code>int n = sizeof a &#47; sizeof a[10];</code> --&gt; <code>int n = sizeof a &#47; sizeof a[0];</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1455729479, "post_id": 35463265, "comment_id": 58622696, "body": "It looks like confusion between <i>characters</i> and <i>strings</i> is the main reasn of the problem."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1455729585, "post_id": 35463265, "comment_id": 58622763, "body": "Quite probably you want to change <code>fscanf(in, &quot;%s &quot;, &amp;a[i]);</code> to <code>fscanf(in, &quot;%c&quot;, &amp;a[i]);</code>"}, {"owner": {"reputation": 1, "user_id": 5941693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FLEO.jpg?s=128&g=1", "display_name": "JDCode", "link": "https://stackoverflow.com/users/5941693/jdcode"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1455729833, "post_id": 35463265, "comment_id": 58622960, "body": "@JohnHascall That was it. That is all it took. I&#39;m fairly new to programming and I knew it was going to be something tiny. Thank you so much for your help."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5941693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FLEO.jpg?s=128&g=1", "display_name": "JDCode", "link": "https://stackoverflow.com/users/5941693/jdcode"}, "edited": false, "score": 0, "creation_date": 1455744581, "post_id": 35463328, "comment_id": 58631821, "body": "Thanks for the help. I changed what you suggested but its still not working as I had hoped. What did you mean by &quot;Same problem exist with <code>fscanf(in, &quot;%s &quot;, &amp;a[i]);</code> , too.&quot; (I&#39;m fairly new to coding to be honest :P)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1455729229, "creation_date": 1455729229, "answer_id": 35463328, "question_id": 35463265, "link": "https://stackoverflow.com/questions/35463265/arranging-a-character-array-using-bubble-sort/35463328#35463328", "title": "Arranging a character array using bubble sort", "body": "<p>The basic problem, as I can see, is with</p>\n\n<pre><code>scanf(\"%s\", &amp;inname);\n</code></pre>\n\n<p>In your code, <code>inname</code> is a single <code>char</code>, which cannot hold <em>string</em> inputs. You'll be needing an array.</p>\n\n<p>You need to change</p>\n\n<pre><code>char inname;\nchar outname;\n</code></pre>\n\n<p>to</p>\n\n<pre><code>#define NAMSIZ 32\n\nchar inname[NAMSIZ] = {0};\nchar outname[NAMSIZ] = {0};\n</code></pre>\n\n<p>and then,</p>\n\n<pre><code>scanf(\"%31s\", inname);\n</code></pre>\n\n<p>and accordingly.</p>\n\n<p>Same problem exist with <code>fscanf(in, \"%s \", &amp;a[i]);</code>, too.</p>\n"}], "owner": {"reputation": 1, "user_id": 5941693, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0FLEO.jpg?s=128&g=1", "display_name": "JDCode", "link": "https://stackoverflow.com/users/5941693/jdcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455729293, "creation_date": 1455729099, "last_edit_date": 1455729293, "question_id": 35463265, "link": "https://stackoverflow.com/questions/35463265/arranging-a-character-array-using-bubble-sort", "title": "Arranging a character array using bubble sort", "body": "<p>Here is my code so far. I am perfectly able to sort files holding numbers but clueless when it comes to characters. It takes in a file of my choosing and outputs another file with the sorted array. But so far all I'm getting are blank files and I can't figure out why.</p>\n\n<p>So how can I fix my code to sort an array of characters and then output it?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint bubble_sort(char *a, int n);\n\nint main(void) {\n    char a[10];\n    int n = sizeof a / sizeof a[10];\n    int i;\n    char inname;\n    char outname;\n\n    printf(\"Enter input name: \");\n    scanf(\"%s\", &amp;inname);\n    printf(\"Enter output name: \");\n    scanf(\"%s\", &amp;outname);\n\n    FILE *in, *out;\n\n    out = fopen(&amp;outname, \"w\");\n\n    if ((in = fopen(&amp;inname, \"r\")) == NULL) {\n        printf(\"File not found\\n\");\n\n    }\n\n\n    else {\n        for (int i = 0; i &lt; 10; i++)\n        {\n            fscanf(in, \"%s \", &amp;a[i]);\n        }\n\n        bubble_sort(a, n);\n\n        for (i = 0; i &lt; 10; i++) {\n            printf(\"%s\\n\", a[i]);\n            fprintf(out, \"%s\\n\", a[i]);\n        }\n    }\n\n        fclose(in);\n        fclose(out);\n        return 0;\n    }\n\n\nint bubble_sort(char *a, int n) {\n    int i, j;\n    char temp;\n\n        for (j = 1; j&lt;n; j++)\n        {\n            for (i = 0; i&lt;n - j; i++)\n            {\n                if ((int)a[i] &gt;= (int)a[i + 1])\n                {\n                    temp = a[i];\n                    a[i] = a[i + 1];\n                    a[i + 1] = temp;\n\n            }\n        }\n    }\n    return a[i];\n}\n</code></pre>\n"}, {"tags": ["python", "c", "encryption", "public-key-encryption"], "comments": [{"owner": {"reputation": 4411, "user_id": 481584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c42fc6c4a1f02f91834f21038aaa9a51?s=128&d=identicon&r=PG", "display_name": "Quentin Pradet", "link": "https://stackoverflow.com/users/481584/quentin-pradet"}, "edited": false, "score": 1, "creation_date": 1455729052, "post_id": 35463204, "comment_id": 58622433, "body": "Key exchange does not appear to be part of the library."}, {"owner": {"reputation": 470, "user_id": 1133959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9lAIc.jpg?s=128&g=1", "display_name": "pefu", "link": "https://stackoverflow.com/users/1133959/pefu"}, "reply_to_user": {"reputation": 4411, "user_id": 481584, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c42fc6c4a1f02f91834f21038aaa9a51?s=128&d=identicon&r=PG", "display_name": "Quentin Pradet", "link": "https://stackoverflow.com/users/481584/quentin-pradet"}, "edited": false, "score": 0, "creation_date": 1455729844, "post_id": 35463204, "comment_id": 58622968, "body": "I recently watched a talk of D.J.Bernstein : <a href=\"https://www.youtube.com/watch?v=Cj3PN5-n108\" rel=\"nofollow noreferrer\">youtube.com/watch?v=Cj3PN5-n108</a> (Paper here: <a href=\"http://safecurves.cr.yp.to/bada55/bada55-20140722.pdf\" rel=\"nofollow noreferrer\">safecurves.cr.yp.to/bada55/bada55-20140722.pdf</a> ).  In this entertaining talk DJB speaks about providers as \u201eman in the middle\u201c.  So I&#39;m now looking for a cryptographically safe way to implement such a key exchange."}, {"owner": {"reputation": 58084, "user_id": 1816580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30e6b41f1e2bd48b058e8e72c1f0f57?s=128&d=identicon&r=PG", "display_name": "Artjom B.", "link": "https://stackoverflow.com/users/1816580/artjom-b"}, "edited": false, "score": 0, "creation_date": 1455732752, "post_id": 35463204, "comment_id": 58624716, "body": "That&#39;s what signatures are for, which the library provides with Ed25519. One side must <i>trust</i> the other side. What&#39;s your trust anchor?"}], "answers": [{"tags": [], "owner": {"reputation": 496, "user_id": 2564344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d787527d0ba13f2913a803c7dcea600?s=128&d=identicon&r=PG", "display_name": "Mizstik", "link": "https://stackoverflow.com/users/2564344/mizstik"}, "is_accepted": false, "score": 0, "last_activity_date": 1469141943, "creation_date": 1469141943, "answer_id": 38515673, "question_id": 35463204, "link": "https://stackoverflow.com/questions/35463204/how-to-exchange-and-authenticate-ephemeral-public-keys-with-tweetnacl/38515673#38515673", "title": "How to exchange and authenticate ephemeral public keys with tweetnacl?", "body": "<p>You can't without a trusted third party and another secure channel. That is the reason SSL has certificate authorities and trust-chain certificates pre-deployed in the browser. Without those, the exchange process is vulnerable to an active man in the middle.</p>\n"}], "owner": {"reputation": 470, "user_id": 1133959, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9lAIc.jpg?s=128&g=1", "display_name": "pefu", "link": "https://stackoverflow.com/users/1133959/pefu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1469141943, "creation_date": 1455728928, "question_id": 35463204, "link": "https://stackoverflow.com/questions/35463204/how-to-exchange-and-authenticate-ephemeral-public-keys-with-tweetnacl", "title": "How to exchange and authenticate ephemeral public keys with tweetnacl?", "body": "<p>The C library <a href=\"http://tweetnacl.cr.yp.to/\" rel=\"nofollow\">http://tweetnacl.cr.yp.to/</a> for strong ECC encryption written\nand published by Daniel J.Bernstein is very neat and small.</p>\n\n<p>Using it from Python is even easier with the tweetnacl Python interface module written and published by Jan Moj\u017e\u00ed\u0161 : <a href=\"https://mojzis.com/software/python-tweetnacl/index.html\" rel=\"nofollow\">https://mojzis.com/software/python-tweetnacl/index.html</a></p>\n\n<p>Generating ephemeral public and secret key pairs is very easy: </p>\n\n<pre><code>python\n&gt;&gt;&gt; import tweetnacl as nacl\n&gt;&gt;&gt; pk, sk = nacl.crypto_box_keypair()\n</code></pre>\n\n<p>Assuming Alice got Bobs public key and vice versa then encrypted communication using the <code>crypto_box()</code> and <code>crypto_box_open()</code> functions \nis pretty straight forward and easy to implement.</p>\n\n<p>But I wonder:  What is easiest way to get Alice \"<code>pk</code>\" from here to \nBob and the public key of Bob back to Alice?  How can Bob be sure that\na received public key is really the key of Alice and vice versa?</p>\n"}, {"tags": ["c", "format", "printf"], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 8, "last_activity_date": 1455746146, "last_edit_date": 1455746146, "creation_date": 1455726951, "answer_id": 35462524, "question_id": 35462452, "link": "https://stackoverflow.com/questions/35462452/parameterizing-format-specifier-in-printf/35462524#35462524", "title": "Parameterizing format specifier in printf", "body": "<p>Yes, you can make the <em>field width</em> an asterisk (<code>*</code>), and supply the value as an <code>int</code> argument. Something like</p>\n\n<pre><code>printf(\"%-*s \\n\", width, \"Identity\");\n</code></pre>\n\n<p>where <code>width</code> is of type <code>int</code> holding the field width value. You can change the value of <code>width</code> to change the field width.</p>\n\n<p>To quote the <code>C11</code> standard regarding this, chapter \u00a77.21.6.1, <em><code>fprintf()</code></em>,</p>\n\n<blockquote>\n  <p>An optional <strong>minimum</strong> <em>field width</em>. [...] The field width\n  takes the form of an asterisk <code>*</code> (described later) or a nonnegative decimal integer.</p>\n</blockquote>\n\n<p>and related,</p>\n\n<blockquote>\n  <p>As noted above, a field width, or precision, or both, may be indicated by an asterisk. In\n  this case, an <code>int</code> argument supplies the field width or precision.[...]</p>\n</blockquote>\n"}], "owner": {"reputation": 3930, "user_id": 855151, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fd2935a0eef3014247dcd8d64b7d0527?s=128&d=identicon&r=PG", "display_name": "Hasan Iqbal", "link": "https://stackoverflow.com/users/855151/hasan-iqbal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "accepted_answer_id": 35462524, "answer_count": 1, "score": 4, "last_activity_date": 1455746146, "creation_date": 1455726762, "last_edit_date": 1455728240, "question_id": 35462452, "link": "https://stackoverflow.com/questions/35462452/parameterizing-format-specifier-in-printf", "title": "Parameterizing format specifier in printf", "body": "<p>I have a few lines of output like the following:</p>\n\n<pre><code>    printf(\"%-20s %-20s %-20s %-20s %-20s \\n\", \"Identity\", \"Identity\", \"float\", \"double\", \"long double\");\n    printf(\"%-20s %-20s %-20s %-20s %-20s \\n\", \"Number\", \"LHS\", \"error\", \"error\", \"error\");\n</code></pre>\n\n<p>As you can see, if I wanted to change the spacing between them, I would have to change the number 20 ten times. Is there a way to parameterize the format specifier? So that changing only once would change them all?</p>\n"}, {"tags": ["c", "pointers", "memory-management", "malloc", "free"], "comments": [{"owner": {"reputation": 2506, "user_id": 3528438, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/27f8b3bc74bea842104821678137cdb2?s=128&d=identicon&r=PG&f=1", "display_name": "user3528438", "link": "https://stackoverflow.com/users/3528438/user3528438"}, "edited": false, "score": 2, "creation_date": 1455726016, "post_id": 35462150, "comment_id": 58620382, "body": "free has to match malloc exactlly, or UB"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1455726112, "post_id": 35462150, "comment_id": 58620442, "body": "You can only pass the exact pointer returned by <code>malloc</code> or <code>realloc</code> or <code>calloc</code> to <code>free</code>.  You can not pass a modified pointer to <code>free</code> without encountering undefined behavior."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1455726149, "post_id": 35462150, "comment_id": 58620468, "body": "The answer is directly in what you pasted: <i>If ptr does not point to a block of memory allocated with the above functions, it causes undefined behavior.</i> Pointing somewhere other than the start is the same as not pointing at the block."}, {"owner": {"reputation": 51, "user_id": 3846175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TiBPm.jpg?s=128&g=1", "display_name": "Jumer", "link": "https://stackoverflow.com/users/3846175/jumer"}, "edited": false, "score": 0, "creation_date": 1455726364, "post_id": 35462150, "comment_id": 58620637, "body": "When you say that I have to pass free the exact pointer returned by malloc family you mean the variable itself or the memory direction?  Would this be legal?  int *ptr1 = malloc(sizeof(int)*10); int *ptr2 = ptr1;  free(ptr2);"}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1455726475, "post_id": 35462150, "comment_id": 58620721, "body": "@jumer the <i>value</i> that <code>malloc()</code> returned is what must be provided to <code>free()</code>. How you manage storage of that value is based on your needs but in your simple example, the unmodified variable is sufficient."}], "answers": [{"comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 3, "creation_date": 1455726404, "post_id": 35462223, "comment_id": 58620661, "body": "Or... perhaps your program will crash. You do not know with certainty what will happen, you only know that the behavior is <i>undefined</i>."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455727336, "post_id": 35462223, "comment_id": 58621313, "body": "Never heard of <i>failed <code>free()</code></i>, can you quote something?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455727424, "post_id": 35462223, "comment_id": 58621381, "body": "Moreover, IMHO, <i>&quot;You will have memory leak&quot;</i> is wrong, as that is far from being guaranteed."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1455743813, "post_id": 35462223, "comment_id": 58631372, "body": "@mah Program crash will be side effect from the messed memory."}, {"owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455743922, "post_id": 35462223, "comment_id": 58631435, "body": "@SouravGhosh Memory leak will occur when <code>free</code> fails. If the same pointer is assigned (malloc-ed) multiple times without freeing, there is memory leak."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1455744253, "post_id": 35462223, "comment_id": 58631611, "body": "@i486 you don&#39;t seem to get it... you are predicting what will happen based on anecdotal evidence. The problem is your prediction is not based on a defined expectation; the only valid expectation is &quot;undefined behavior&quot; which might as well be saying &quot;we don&#39;t really know what will happen but it&#39;s probably not desirable&quot;. This makes your answer a bit less than useful."}], "tags": [], "owner": {"reputation": 6024, "user_id": 2417459, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/QcuXb.png?s=128&g=1", "display_name": "i486", "link": "https://stackoverflow.com/users/2417459/i486"}, "is_accepted": false, "score": 1, "last_activity_date": 1455726148, "creation_date": 1455726148, "answer_id": 35462223, "question_id": 35462150, "link": "https://stackoverflow.com/questions/35462150/use-of-free-with-variable-pointers/35462223#35462223", "title": "Use of free with variable pointers", "body": "<p>You will have memory leak (failed <code>free</code>) or broken <code>malloc</code> chain if try to <code>free</code> modified (increased) pointer.</p>\n"}], "owner": {"reputation": 51, "user_id": 3846175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TiBPm.jpg?s=128&g=1", "display_name": "Jumer", "link": "https://stackoverflow.com/users/3846175/jumer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "closed_date": 1455726108, "answer_count": 1, "score": -1, "last_activity_date": 1455726148, "creation_date": 1455725956, "last_edit_date": 1592644375, "question_id": 35462150, "link": "https://stackoverflow.com/questions/35462150/use-of-free-with-variable-pointers", "closed_reason": "Duplicate", "title": "Use of free with variable pointers", "body": "<p>From cplusplus.com:</p>\n<blockquote>\n<p>A block of memory previously allocated by a call to malloc, calloc or realloc is deallocated, making it available again for further allocations.</p>\n<p>If ptr does not point to a block of memory allocated with the above functions, it causes undefined behavior.</p>\n<p>If ptr is a null pointer, the function does nothing.</p>\n<p>Notice that this function does not change the value of ptr itself, hence it still points to the same (now invalid) location.</p>\n</blockquote>\n<p>But what happen if my pointer doesn't point to the start of the block.</p>\n<p>For example:</p>\n<pre><code>int *ptr = malloc(sizeof(int)*10);\n\nptr++;\n\nfree(ptr);\n</code></pre>\n<p>Does free only free the last 9 positions? This would be horrible in this case, then:</p>\n<pre><code>int *ptr = malloc(sizeof(int)*10);\nint i;\n\nfor(i=0; i&lt;10; i++, ptr++);\n\nfree(ptr);\n</code></pre>\n<p>Here ptr points outside of the block of memory reserved by malloc.</p>\n<p>And what would be the behaviour of this?</p>\n<pre><code>int *ptr1 = malloc(sizeof(int)*10);\nint *ptr2 = ptr1 + 2;\n\nfree(ptr2);\n</code></pre>\n<p>Thanks.</p>\n"}, {"tags": ["c", "keyword", "automatic-storage"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1455725810, "post_id": 35462081, "comment_id": 58620230, "body": "<code>auto type instead of local variables</code>..please read a C book first."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1455725829, "post_id": 35462081, "comment_id": 58620248, "body": "<code>auto</code> is not a type."}, {"owner": {"reputation": 13, "user_id": 5941453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lWrjaClrzh4/AAAAAAAAAAI/AAAAAAAAATU/2LO1p1pqVe4/photo.jpg?sz=128", "display_name": "Arul", "link": "https://stackoverflow.com/users/5941453/arul"}, "edited": false, "score": 0, "creation_date": 1455726431, "post_id": 35462081, "comment_id": 58620683, "body": "auto type is one of types of storage class. So I mentioned auto-type specifier"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1455726716, "post_id": 35462081, "comment_id": 58620870, "body": "just to complete what Mr. @KerrekSB said, it is a storage-class specifier."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5941453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lWrjaClrzh4/AAAAAAAAAAI/AAAAAAAAATU/2LO1p1pqVe4/photo.jpg?sz=128", "display_name": "Arul", "link": "https://stackoverflow.com/users/5941453/arul"}, "edited": false, "score": 0, "creation_date": 1455726850, "post_id": 35462178, "comment_id": 58620981, "body": "where auto keyword is used?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 13, "user_id": 5941453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lWrjaClrzh4/AAAAAAAAAAI/AAAAAAAAATU/2LO1p1pqVe4/photo.jpg?sz=128", "display_name": "Arul", "link": "https://stackoverflow.com/users/5941453/arul"}, "edited": false, "score": 0, "creation_date": 1455727571, "post_id": 35462178, "comment_id": 58621486, "body": "@Arul do you mean <i>explicitly</i>?"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 1, "last_activity_date": 1455726673, "last_edit_date": 1455726673, "creation_date": 1455726016, "answer_id": 35462178, "question_id": 35462081, "link": "https://stackoverflow.com/questions/35462081/why-are-we-going-for-auto-type-storage-class/35462178#35462178", "title": "why are we going for auto-type storage class?", "body": "<p>First of all, <code>auto</code> (keyword) is <strong>not</strong> a type specifier, it's a storage class specifier. Quoting from the standard,</p>\n\n<blockquote>\n  <p>An object has a storage duration that determines its lifetime. There are four storage\n  durations: static, thread, automatic, and allocated.</p>\n</blockquote>\n\n<p>To quote <code>C11</code>, chapter \u00a76.2.4, <em>Storage durations of objects</em></p>\n\n<blockquote>\n  <p>An object whose identifier is declared with no linkage and without the storage-class\n  specifier <code>static</code> has automatic storage duration,[..]</p>\n</blockquote>\n\n<p>and, regarding the <em>linkage</em>, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>The following identifiers have <strong>no linkage</strong>: an identifier declared to be anything other than\n  an object or a function; an identifier declared to be a function parameter; <strong>a block scope\n  identifier for an object declared without the storage-class specifier <code>extern</code>.</strong></p>\n</blockquote>\n\n<p>So, local variables, satisfying above conditions are by default, having automatic storage duration. You don't have to <em>explicitly</em> specify the <code>auto</code> keyword.</p>\n\n<p>OTOH, type-specifiers determine the type (of data or variables). Going by the standard definition of type</p>\n\n<blockquote>\n  <p>The meaning of a value stored in an object or returned by a function is determined by the\n  <strong><em>type</em></strong> of the expression used to access it.</p>\n</blockquote>\n"}], "owner": {"reputation": 13, "user_id": 5941453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lWrjaClrzh4/AAAAAAAAAAI/AAAAAAAAATU/2LO1p1pqVe4/photo.jpg?sz=128", "display_name": "Arul", "link": "https://stackoverflow.com/users/5941453/arul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "closed_date": 1455726973, "answer_count": 1, "score": 0, "last_activity_date": 1455726673, "creation_date": 1455725747, "last_edit_date": 1455726452, "question_id": 35462081, "link": "https://stackoverflow.com/questions/35462081/why-are-we-going-for-auto-type-storage-class", "closed_reason": "Duplicate", "title": "why are we going for auto-type storage class?", "body": "<p>In C, why we go for storage classes? I heard that auto type is the same as the local variable. in that case, why we go for auto type?is there any special by using auto type instead of local variables which is not mentioned as auto.\nfor example, </p>\n\n<pre><code>int a=10; \n</code></pre>\n\n<p>and </p>\n\n<pre><code>auto int a=10; \n</code></pre>\n\n<p>both are stored in stack segment and scope of these variables is within the function.so what is the difference between these two? why we go for <code>auto</code>-type?</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1455725274, "post_id": 35461838, "comment_id": 58619827, "body": "It returns you an error as you should return <code>0</code> from <code>main</code>. (and declare it as <code>int main(void)</code>)"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 5, "creation_date": 1455725608, "post_id": 35461838, "comment_id": 58620082, "body": "Can you please try harder to write a question title?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1455726515, "post_id": 35461838, "comment_id": 58620740, "body": "<code>unsigned char ch;</code> --&gt; <code>unsigned  ch;</code>"}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455726563, "post_id": 35461838, "comment_id": 58620774, "body": "Next time don&#39;t write the whole file before trying to compile. It&#39;s like making soup without ever tasting it until the very end."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455726663, "post_id": 35461838, "comment_id": 58620828, "body": "Compiled with <code>-Wall</code> option gives <i>warning: format \u2018%x\u2019 expects argument of type \u2018unsigned int *\u2019, but argument 3 has type \u2018unsigned char *\u2019</i>"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1455726983, "post_id": 35461838, "comment_id": 58621076, "body": "&quot;So... after the errors, I removed the save file part and worked only with the XOR process, printing in the screen step by step... trying to see where the code fails. &quot;... <i>and?</i>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1455727658, "post_id": 35461838, "comment_id": 58621548, "body": "@John Hascall Why are you fixing OP&#39;s code in the question? It is clearly not the intention of the <code>edit</code> button."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1455727829, "post_id": 35461838, "comment_id": 58621662, "body": "return 0; doesn&#39;t change to question or the answer.  It was obviously distracting people from the real question."}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1455727947, "post_id": 35461838, "comment_id": 58621751, "body": "Come on, one person mentioning it doesn&#39;t mean &quot;It was obviously distracting people&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 2, "last_activity_date": 1455728578, "last_edit_date": 1455728578, "creation_date": 1455727061, "answer_id": 35462562, "question_id": 35461838, "link": "https://stackoverflow.com/questions/35461838/error-closing-a-file-with-fscanf/35462562#35462562", "title": "Error closing a file with fscanf", "body": "<p>If you compile your code with <code>-Wall</code> option the following message will be displayed:</p>\n\n<pre><code>test.c: In function \u2018main\u2019:\ntest.c:471:5: warning: format \u2018%x\u2019 expects argument of type \u2018unsigned int *\u2019, but argument 3 has type \u2018unsigned char *\u2019 [-Wformat=]\n     while (fscanf(fpIn, \"%02x\", &amp;ch) != EOF) {\n     ^\n</code></pre>\n\n<p>The error is the type of variable passed to <code>scanf</code>. You are passing address of a char variable, mostly 8 bits.</p>\n\n<p><code>scanf</code> takes that address as <code>unsigned int</code> pointer and write it with <code>sizeof(unsigned int)</code> bytes.</p>\n\n<p>The first variable declared after <code>ch</code> variable is <code>fpIn</code>. This variable is overwritten by <code>scanf</code> and this is why you cannot close the input file: due to the fact that the pointer is corrupted.</p>\n"}], "owner": {"reputation": 173, "user_id": 5941350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56b1e7d118773ec8d4e5bc5c2801adfe?s=128&d=identicon&r=PG&f=1", "display_name": "Hollweg", "link": "https://stackoverflow.com/users/5941350/hollweg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455735057, "creation_date": 1455725108, "last_edit_date": 1455735057, "question_id": 35461838, "link": "https://stackoverflow.com/questions/35461838/error-closing-a-file-with-fscanf", "title": "Error closing a file with fscanf", "body": "<p>I'm making a code to encrypt and decrypt a plaintext using the cryptography technique Vigen\u00e8re Cipher.</p>\n\n<p>The code to encrypt is working fine, but I'm having a problem with my decrypt code. </p>\n\n<p>To decrypt:</p>\n\n<p>I read a file, with the cipher of the plaintext (encoded) and pick an hexadecimal of two digits, make a <code>XOR</code> with my key, and it returns me the\noriginal message coded.</p>\n\n<p>The problem is that I'm having a problem after all this process. \nThe algorithm works well... it decrypts, but it seems that it have a problem\nwith the <code>EOF</code>, because the code returns me an error after the process and did not let me close the file.</p>\n\n<p>The idea is to save the cipher <code>XOR</code> Key in a file:</p>\n\n<pre><code>fprintf(fpOut, \"%c\", ch ^ key[i % KEY_LENGTH]);\n</code></pre>\n\n<ul>\n<li>The plaintext message is 'Hello!'</li>\n<li>The ctext file contains 'Hello!' XOR Key = e94acd43ce0e </li>\n<li>The dtext file must contains the message Hello again (cipher <code>XOR</code> key = message)</li>\n</ul>\n\n<p>My original code (simplified) is this one:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\n#define KEY_LENGTH 2 // Can be anything from 1 to 13\n\nint main ( void ) {\n\n    unsigned char ch;\n\n    FILE *fpIn, *fpOut;\n    int i;\n    unsigned char key[KEY_LENGTH] = {0xA1, 0x2F};\n\n    fpIn = fopen(\"ctext.txt\", \"r\");\n    fpOut = fopen(\"dtext.txt\", \"w\");\n    i = 0;\n\n    while (fscanf(fpIn, \"%02x\", &amp;ch) != EOF) {\n        printf (\"\\n Value read: %x\", ch);\n        if (ch != '\\n'){\n                ch = ch ^ key[i % KEY_LENGTH];\n                i++;\n        }\n        printf (\"\\n Value after XOR: %c\", ch);\n    }\n\n    fclose(fpIn);\n    fclose(fpOut);\n    return;\n}\n</code></pre>\n\n<p>Can anyone see what I did wrong?</p>\n"}, {"tags": ["c", "arrays", "algorithm"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1455724182, "post_id": 35461252, "comment_id": 58618958, "body": "<code>if (a[0] &lt; a[i])         {             greatest = a[i];         }   </code> means &quot;if the first element is lesser than the current then the current one is the greatest&quot;. Which doesn&#39;t make any sense."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455726992, "post_id": 35461252, "comment_id": 58621086, "body": "The logic is completely wrong. Read it out loud to yourself."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455727567, "post_id": 35461252, "comment_id": 58621484, "body": "..or step through it with your debugger, something you should have done before posting here:("}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 3, "creation_date": 1455723866, "post_id": 35461311, "comment_id": 58618689, "body": "And <code>printf(&quot;%d&quot;, a[i]);</code> is UB."}], "tags": [], "owner": {"reputation": 11494, "user_id": 1795279, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4TEag.jpg?s=128&g=1", "display_name": "Haris", "link": "https://stackoverflow.com/users/1795279/haris"}, "is_accepted": false, "score": 2, "last_activity_date": 1455725460, "last_edit_date": 1455725460, "creation_date": 1455723851, "answer_id": 35461311, "question_id": 35461252, "link": "https://stackoverflow.com/questions/35461252/c-programming-greatest-of-10-numbers-whats-wrong-with-my-code-i-dont-get-the-o/35461311#35461311", "title": "c programming greatest of 10 numbers .whats wrong with my code? i dont get the output", "body": "<p>There are many issues with your code. Lets take it one by one</p>\n\n<p><hr>\n1)\n<code>scanf()</code> needs an address.</p>\n\n<pre><code>scanf(\"%d\", &amp;a[i]);\n            ^\n</code></pre>\n\n<p>add an ampersand.</p>\n\n<hr>\n\n<p>2)\nYou do not reset the value of <code>i</code> before using it in the last <code>printf()</code>.</p>\n\n<pre><code>printf(\"%d\", a[i]);\n</code></pre>\n\n<p>Therefore, <code>i = 10</code>, which is out of bound fro the array <code>a[]</code>, therefore leading to undefined behavior.</p>\n\n<p><hr>\n3)\nSince you are storing the values in the variable <code>greatest</code> in the <code>for</code> loop here, </p>\n\n<pre><code>for (i = 0 ; i &lt; 10 ; i++)\n{\n    if (a[0] &lt; a[i])\n    {\n        greatest = a[i];\n    }    \n}\n</code></pre>\n\n<p>while comparing for the greatest number, you should also compare with the variable <code>greatest</code>. Because it would contain the the updated greatest value always. And better store the first value in the variable <code>greatest</code> before you start with this loop</p>\n\n<pre><code>greatest = a[0];\nfor (i = 1 ; i &lt; 10 ; i++)\n{\n    if (greatest &lt; a[i])\n    {\n        greatest = a[i];\n    }    \n}\n</code></pre>\n\n<p>And later also, print the value in the <code>greatest</code> variable.</p>\n\n<pre><code>printf(\"%d\", greatest);\n</code></pre>\n\n<hr>\n\n<p><strong>NOTE:</strong> \nUse the standard definition of <code>main()</code></p>\n\n<pre><code>int main(void) //if no command line arguments.\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455724598, "post_id": 35461529, "comment_id": 58619270, "body": "Damn! My program is identical to yours (except that I hard-coded 10 instead of #defining it), you&#39;ve beaten me by literally 20 seconds... I guess I&#39;ll just discard my answer then. :-("}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 3761, "user_id": 3982001, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "Fabio says Reinstate Monica", "link": "https://stackoverflow.com/users/3982001/fabio-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455724790, "post_id": 35461529, "comment_id": 58619431, "body": "@FabioTurati Let&#39;s think that we wrote the answer together.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 3, "last_activity_date": 1455724628, "last_edit_date": 1455724628, "creation_date": 1455724422, "answer_id": 35461529, "question_id": 35461252, "link": "https://stackoverflow.com/questions/35461252/c-programming-greatest-of-10-numbers-whats-wrong-with-my-code-i-dont-get-the-o/35461529#35461529", "title": "c programming greatest of 10 numbers .whats wrong with my code? i dont get the output", "body": "<p>For starters (apart from other logical errors) this statement</p>\n\n<pre><code>a[0] = greatest;\n</code></pre>\n\n<p>does not make sense.</p>\n\n<p>The program can look like</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define N 10\n\nint main( void )\n         ^^^^^\n{      \n    int a[N];\n    int greatest;\n    int i;     \n\n    for ( i = 0 ; i &lt; N ; i++ ) scanf( \"%d\", &amp;a[i] );\n                                             ^^^^^ \n    greatest = a[0];\n    ^^^^^^^^^^^^^^^^\n    for ( i = 1 ; i &lt; N ; i++ )\n    {\n        if ( greatest &lt; a[i] ) greatest = a[i];\n             ^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^\n    }\n\n    printf( \"%d\\n\", greatest );\n                  ^^^^^^^^\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4980397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93b6414d69b121cd1383689d951c6c59?s=128&d=identicon&r=PG&f=1", "display_name": "hash", "link": "https://stackoverflow.com/users/4980397/hash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "closed_date": 1455724618, "answer_count": 2, "score": -9, "last_activity_date": 1455725460, "creation_date": 1455723707, "last_edit_date": 1455725393, "question_id": 35461252, "link": "https://stackoverflow.com/questions/35461252/c-programming-greatest-of-10-numbers-whats-wrong-with-my-code-i-dont-get-the-o", "closed_reason": "Not suitable for this site", "title": "c programming greatest of 10 numbers .whats wrong with my code? i dont get the output", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main()\n{      \n    int a[10], greatest = 0, i;     \n    a[0] = greatest;\n    for (i = 0 ; i &lt; 10 ; i++)\n    {\n        scanf(\"%d\", a[i]);\n    } \n\n    for (i = 0 ; i &lt; 10 ; i++)\n    {\n        if (a[0] &lt; a[i])\n        {\n            greatest = a[i];\n        }    \n    }\n    printf(\"%d\", a[i]);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "multidimensional-array", "dynamic-arrays"], "comments": [{"owner": {"reputation": 47633, "user_id": 3889449, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb07e0f09deb982a1a0deedca7a5c002?s=128&d=identicon&r=PG", "display_name": "Marco Bonelli", "link": "https://stackoverflow.com/users/3889449/marco-bonelli"}, "edited": false, "score": 0, "creation_date": 1455730614, "post_id": 35461135, "comment_id": 58623451, "body": "do you even indent bro"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5941266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd68bcb38ee8696e3429feb519cf31e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Spilman", "link": "https://stackoverflow.com/users/5941266/joe-spilman"}, "edited": false, "score": 0, "creation_date": 1455723641, "post_id": 35461178, "comment_id": 58618496, "body": "Well that was easier than expected, Thanks."}], "tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 2, "last_activity_date": 1455723667, "last_edit_date": 1495535413, "creation_date": 1455723513, "answer_id": 35461178, "question_id": 35461135, "link": "https://stackoverflow.com/questions/35461135/how-do-i-create-an-array-dynamic-in-one-dimension-yet-static-in-others-c/35461178#35461178", "title": "How do I create an array, dynamic in one dimension yet static in others? C", "body": "<p>Make a static array of pointers:</p>\n\n<pre><code>int i;\ndouble *x[2];\nfor(i=0;i&lt;2;i++){\n    x[i] = malloc(10000*sizeof(double));\n}\n</code></pre>\n\n<p>And proceed as you are (<a href=\"https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">without casting the result of <code>malloc</code></a>).</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1455724108, "last_edit_date": 1455724108, "creation_date": 1455723646, "answer_id": 35461224, "question_id": 35461135, "link": "https://stackoverflow.com/questions/35461135/how-do-i-create-an-array-dynamic-in-one-dimension-yet-static-in-others-c/35461224#35461224", "title": "How do I create an array, dynamic in one dimension yet static in others? C", "body": "<p>Write the following way</p>\n\n<pre><code>int i;\ndouble *x[2];\nfor(i=0;i&lt;2;i++){\n    x[i] = (double*) malloc(10000*sizeof(double));\n}\n</code></pre>\n\n<p>Or you could even write provided that the array itself has automatic storage duration.</p>\n\n<pre><code>double *x[2] = { malloc(10000*sizeof(double)), malloc(10000*sizeof(double)) };\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5941266, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd68bcb38ee8696e3429feb519cf31e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Spilman", "link": "https://stackoverflow.com/users/5941266/joe-spilman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1481071158, "creation_date": 1455723434, "last_edit_date": 1481071158, "question_id": 35461135, "link": "https://stackoverflow.com/questions/35461135/how-do-i-create-an-array-dynamic-in-one-dimension-yet-static-in-others-c", "title": "How do I create an array, dynamic in one dimension yet static in others? C", "body": "<p>Here is my current attempt however when I try to assign a double to one element I am told that the \"subscripted value is neither array nor pointer nor vector\". Can anyone point me in the right direction (pun intended).</p>\n\n<pre><code>int i;\ndouble x[2];\nfor(i=0;i&lt;2;i++){\ndouble *x[i];\nx[i] = (double*) malloc(10000*sizeof(double));\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 20311, "user_id": 248756, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bbe1403403cbd6ff3f67238a2025826b?s=128&d=identicon&r=PG", "display_name": "Michiel Pater", "link": "https://stackoverflow.com/users/248756/michiel-pater"}, "edited": false, "score": 1, "creation_date": 1455722179, "post_id": 35460570, "comment_id": 58617334, "body": "What does not work? Do you have an error message?"}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455722347, "post_id": 35460570, "comment_id": 58617442, "body": "In order to get better responses I recommend providing better information. &quot;Somehow it does not work&quot; is not sufficient. It may not work because (1) It does not compile; (2) because while it compiles, it does not link; (3) while it compiles and links, it crashes; (4) while it compiles, links and doesn&#39;t crash, it fails to behave in the  expected way. Each of the possible levels of failure produce output which is tremendously helpful in finding the reason for the failure."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455722727, "post_id": 35460570, "comment_id": 58617759, "body": "And for a more consistent style I suggest that a program which uses goto should perform <i>all</i> flow control with goto. Using a while loop in a program with goto is like having a digital watch in a Western movie."}, {"owner": {"reputation": 635, "user_id": 5503203, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b8fc16849bdc2cf90674e4cc38f02e6f?s=128&d=identicon&r=PG&f=1", "display_name": "ITguy", "link": "https://stackoverflow.com/users/5503203/itguy"}, "edited": false, "score": 0, "creation_date": 1455722926, "post_id": 35460570, "comment_id": 58617935, "body": "The question is poorly written and no explanation is given."}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455723617, "post_id": 35460570, "comment_id": 58618480, "body": "Thank you for your comments. I&#39;m new to this site and this is my first post. I have edited the question so that it is clearer to understand. I&#39;l pay more attention the next time."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455727140, "post_id": 35460570, "comment_id": 58621192, "body": "Since you are a beginner, I would recommend <i>not</i> using <code>goto</code> ever. Otherwise you&#39;ll use it like a crutch when you can&#39;t figure out the right loop logic."}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "reply_to_user": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1455729118, "post_id": 35460570, "comment_id": 58622470, "body": "@RPGillespie Thanks for your advice. I&#39;ll pay attention to that"}], "answers": [{"comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455722506, "post_id": 35460625, "comment_id": 58617568, "body": "This does not fix the OP problem due to the \\n  not consumed"}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455722797, "post_id": 35460625, "comment_id": 58617828, "body": "I&#39;m trying to learn C by myself so can you please explain why avoid using goto statements ?"}, {"owner": {"reputation": 971, "user_id": 5935366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6dfca29890919ec6ab874cf49b92041?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Gardener", "link": "https://stackoverflow.com/users/5935366/martin-gardener"}, "edited": false, "score": 1, "creation_date": 1455722899, "post_id": 35460625, "comment_id": 58617908, "body": "goto is a ambigious statement, according to compiler constructor it changes the flow of instructions that you have writter ending in an incorrect manner and is a bad coding practice, anything that can be achieved using goto can in the end be achieved using a loop."}, {"owner": {"reputation": 971, "user_id": 5935366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6dfca29890919ec6ab874cf49b92041?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Gardener", "link": "https://stackoverflow.com/users/5935366/martin-gardener"}, "edited": false, "score": 0, "creation_date": 1455722935, "post_id": 35460625, "comment_id": 58617940, "body": "@LP i don&#39;t understand you properly mate, why would you want \\n to be consumed? no one is checking for new line feed anywhere tho."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455723778, "post_id": 35460625, "comment_id": 58618609, "body": "@DanyalImran Regarding the newline: When the user enters a number at <code>scanf(&quot;%d&quot;, &amp;guess_value); </code>, the input contains a trailing newline which is not consumed immediately; scanf stops at the end of the number. As long as the number is not guessed, everything is fine because <i>the next</i>  <code>scanf(%s)</code> will skip (and consume) leading whitespace, including the newline still in the buffer. (to be continued)"}, {"owner": {"reputation": 971, "user_id": 5935366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6dfca29890919ec6ab874cf49b92041?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Gardener", "link": "https://stackoverflow.com/users/5935366/martin-gardener"}, "edited": false, "score": 0, "creation_date": 1455723986, "post_id": 35460625, "comment_id": 58618798, "body": "oh its a typical C++ error actually that produces a buffer ignore when you shift from int to char, must be probably here aswell."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455724132, "post_id": 35460625, "comment_id": 58618924, "body": "(continued) When the number is guessed properly though, the next input comes from <code>scanf(&quot;%c&quot;, &amp;answer);</code>. The %c conversion specifier, designed to read a single char, <i>does not</i> skip leading whitespace (here: the pending newline)  but instead assigns it to <code>answer</code>. The condition will never be true, no matter what the user enters (on a normal terminal, input is only transmitted after hitting enter, inserting a newline in the input)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455724330, "post_id": 35460625, "comment_id": 58619059, "body": "Sorry, I was writing my answer. BTW @PeterA.Schneider weel explained all things."}], "tags": [], "owner": {"reputation": 971, "user_id": 5935366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6dfca29890919ec6ab874cf49b92041?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Gardener", "link": "https://stackoverflow.com/users/5935366/martin-gardener"}, "is_accepted": false, "score": 0, "last_activity_date": 1455722823, "last_edit_date": 1455722823, "creation_date": 1455722253, "answer_id": 35460625, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35460625#35460625", "title": "Simple guessing game in c", "body": "<p>avoid using goto statements. use do-while instead</p>\n\n<pre><code>do {\nnumber=rand() %100+1;\n\nnumber_of_guesses=0;\ndo {\n    printf(\"\\nEnter a number between 0 and 100\\n\");\n    scanf(\"%d\", &amp;guess_value);      \n    number_of_guesses++;\n    if (guess_value == number){\n        printf(\"Right !!! You win\\n\");\n    }\n    else if (guess_value &gt; number){\n        printf(\"\\nYour guess is too high. Guess again\");\n    }\n    else {printf(\"\\nYour guess is too low. Guess again\");\n    }\n} while (guess_value != number);\n\nprintf(\"You guessed %d times !\", number_of_guesses);\n\nprintf(\"Do you want to play again? y? n?\");\nscanf(\"%c\", &amp;answer);\n} while (answer == 'y');\n</code></pre>\n\n<p>This should fix your problem, it loops in the code until anything besides 'y' appears.</p>\n"}, {"tags": [], "owner": {"reputation": 801, "user_id": 1885917, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d1933f8099056c36ad0a365890222855?s=128&d=identicon&r=PG", "display_name": "Daniele", "link": "https://stackoverflow.com/users/1885917/daniele"}, "is_accepted": false, "score": 4, "last_activity_date": 1455722438, "creation_date": 1455722438, "answer_id": 35460699, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35460699#35460699", "title": "Simple guessing game in c", "body": "<p>I think the problem is that you compare <code>guess_value</code> before initialization.</p>\n"}, {"tags": [], "owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "is_accepted": false, "score": 0, "last_activity_date": 1455722464, "creation_date": 1455722464, "answer_id": 35460714, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35460714#35460714", "title": "Simple guessing game in c", "body": "<p>Your problem is that you should reset guess_value, otherwhise while will not be executed</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455723822, "post_id": 35461137, "comment_id": 58618648, "body": "Thanks for your help !! Can you explain why we must you %s instead of %c ?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455723955, "post_id": 35461137, "comment_id": 58618767, "body": "Totally <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">UB</a>. <code>answer</code> is a <code>char</code> variable. It cannot hold a sting...."}, {"owner": {"reputation": 1, "user_id": 5930022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad273ccbe77cfb75065e8860c4827deb?s=128&d=identicon&r=PG&f=1", "display_name": "AirKite", "link": "https://stackoverflow.com/users/5930022/airkite"}, "edited": false, "score": 0, "creation_date": 1455731880, "post_id": 35461137, "comment_id": 58624234, "body": "Use scanf(&quot;%s&quot;, &amp;answer); because scanf(&quot;%c&quot;, &amp;answer); in this code, dont work... Check it!"}], "tags": [], "owner": {"reputation": 1, "user_id": 5930022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad273ccbe77cfb75065e8860c4827deb?s=128&d=identicon&r=PG&f=1", "display_name": "AirKite", "link": "https://stackoverflow.com/users/5930022/airkite"}, "is_accepted": false, "score": -1, "last_activity_date": 1455723438, "creation_date": 1455723438, "answer_id": 35461137, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35461137#35461137", "title": "Simple guessing game in c", "body": "<p>This works:</p>\n\n<pre><code>#include &lt;stdio.h&gt; // Include\n\nint main() { \n    int number, guess_value, number_of_guesses;\n    char answer;\n\n    A:  \n    srand(time(NULL)); // Fix\n    number = rand() %100+1;\n    number_of_guesses = 0;\n    while(guess_value != number) {\n        puts(\"\\nEnter a number between 0 and 100\\n\");\n        scanf(\"%d\", &amp;guess_value);      \n        number_of_guesses++;\n        if (guess_value == number) {\n            printf(\"Right !!! You win\\n\");\n        }\n        else if (guess_value &gt; number) {\n            printf(\"\\nYour guess is too high. Guess again\");\n        }\n        else {\n            printf(\"\\nYour guess is too low. Guess again\");\n        }\n    }\n\n    printf(\"You guessed %d times !\\n\", number_of_guesses);\n    puts(\"Do you want to play again? y? n?\");\n    scanf(\"%s\", &amp;answer); // Fix\n    if (answer == 'y'){ \n         goto A;\n    }\n    return 0;   \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455724631, "post_id": 35461318, "comment_id": 58619305, "body": "i think this is the best answer. Did you run it?"}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455724691, "post_id": 35461318, "comment_id": 58619358, "body": "Thank you for your comment !! Helps me alot !!"}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455725827, "post_id": 35461318, "comment_id": 58620243, "body": "Can you please explain more about the 4th point ? I am not sure that i understand it correctly. Sorry for any inconvenience. I&#39;m not a native Ennglish speaker"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455726059, "post_id": 35461318, "comment_id": 58620414, "body": "@Minh Don&#39;t worry, me too. In your code you init the number to be guessed before entering the first loop. This means that the number to be guessed will be always the same, even after the user wants to play the game a second time."}, {"owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "edited": false, "score": 0, "creation_date": 1455726258, "post_id": 35461318, "comment_id": 58620560, "body": "ahh i understand now. Thanks for your help !! Really helpeful"}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 1, "last_activity_date": 1455726728, "last_edit_date": 1455726728, "creation_date": 1455723870, "answer_id": 35461318, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35461318#35461318", "title": "Simple guessing game in c", "body": "<p>Corrected code is:</p>\n\n<pre><code>int main()\n{\n    int number, guess_value,number_of_guesses;\n    char answer;\n\n    srand((unsigned)time(NULL));\n\n    do\n    {\n        number=rand() %100+1;\n        number_of_guesses=0;\n        do\n        {\n            printf(\"\\nEnter a number between 0 and 100\\n\");\n            scanf(\"%d\", &amp;guess_value);\n            number_of_guesses++;\n            if (guess_value == number)\n            {\n                printf(\"Right !!! You win\\n\");\n            }\n            else if (guess_value &gt; number)\n            {\n                printf(\"\\nYour guess is too high. Guess again\");\n            }\n            else\n            {\n                printf(\"\\nYour guess is too low. Guess again\");\n            }\n        }\n        while (guess_value != number);\n\n        printf(\"You guessed %d times !\\n\", number_of_guesses);\n\n        printf(\"Do you want to play again? y? n?\");\n\n        scanf(\" %c\", &amp;answer);\n    }\n    while (answer == 'y');\n\n    return 0;\n}\n</code></pre>\n\n<p>Many thing are wrong in your code:</p>\n\n<ol>\n<li>As already well explained by other users <strong>do not use goto statement</strong></li>\n<li>you must reset <code>guess_value</code> before entering the game while loop, or change the loop to a <code>do{}while(guess_value != number)</code></li>\n<li>You have to add a whitespace before the %c format specifier to consume \"garbage\" that belongs to the input buffer after the <code>scanf(\"%d\", &amp;guess_value);</code></li>\n<li>number variable must be init each <code>while (answer == 'y');</code> loop. Otherwise it always use the same number to be guessed.</li>\n</ol>\n\n<p>To be more specific about point 3 you must understand that the first <code>scanf</code> does not consume the <code>'\\n'</code> (carriage return, enter keyboard key) char of user input. This char still in the input buffer until the second <code>scanf</code> is executed when <code>'\\n'</code> is returned into answer variable. Finally when you check <code>if (answer == 'y')</code> the condition is always false.</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 5581232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y74Hn.png?s=128&g=1", "display_name": "Joses Paul", "link": "https://stackoverflow.com/users/5581232/joses-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1455756632, "last_edit_date": 1455756632, "creation_date": 1455726327, "answer_id": 35462294, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c/35462294#35462294", "title": "Simple guessing game in c", "body": "<pre><code>#include&lt;stdio.h&gt;                           \n#include&lt;stdlib.h&gt;                        //for rand &amp; srand function\n#include&lt;time.h&gt;                          //for time obviously. \n int main()\n{ \nint number, guess_value,number_of_guesses;\nchar answer;\n\nA:                                       //put label here, Generate rand val every time. \nsrand((unsigned)time(NULL));\nnumber=rand() %100+1;\n\nguess_value=0;                           //reset the guess value.\nnumber_of_guesses=0;\n\nwhile (guess_value != number){\n  printf(\"\\nEnter a number between 0 and 100\\n\");\n  scanf(\"%d\", &amp;guess_value);      \n  number_of_guesses++;\n  if (guess_value == number){\n    printf(\"Right !!! You win\\n\");\n  }\n  else if (guess_value &gt; number){\n    printf(\"\\nYour guess is too high. Guess again\");\n  }\n  else {printf(\"\\nYour guess is too low. Guess again\");\n  }\n}\n\nprintf(\"You guessed %d times !\", number_of_guesses);\nprintf(\"Do you want to play again? y? n?\");\n\ngetchar();                               //use this to remove the \\n.\nscanf(\"%c\", &amp;answer);\nif (answer == 'y'){\ngoto A; /*return to to beginging*/\n}\n\nreturn 0;   \n}\n</code></pre>\n\n<p>scanf gets the input from the input buffer, \nEvery time a user hits the enter, <code>\\n</code>   gets to the buffer.\nAfter this scanf function, take the <code>\\n</code>.</p>\n"}], "owner": {"reputation": 61, "user_id": 5941073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8e73d579774df6efe1370bac8c73bef?s=128&d=identicon&r=PG&f=1", "display_name": "Minh", "link": "https://stackoverflow.com/users/5941073/minh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 0, "answer_count": 6, "score": -7, "last_activity_date": 1455756632, "creation_date": 1455722100, "last_edit_date": 1455723468, "question_id": 35460570, "link": "https://stackoverflow.com/questions/35460570/simple-guessing-game-in-c", "title": "Simple guessing game in c", "body": "<p>Hello I'm trying to write a simple number guessing game in c. If the player guesses the number correctly, the program will give a message and aks if the player want to play again. </p>\n\n<p>When i compile the code, it generate the random number, let the player guess the number and check whether the number is right or not. But when it aks if the player want to play again, it does not let the player answer and instead just exit. I don not know why it happens. Can you please help me? </p>\n\n<pre><code>int main()\n{ \n\nint number, guess_value,number_of_guesses;\nchar answer;\n\nsrand((unsigned)time(NULL));\nnumber=rand() %100+1;\n\nA:number_of_guesses=0;\nwhile (guess_value != number){\n    printf(\"\\nEnter a number between 0 and 100\\n\");\n    scanf(\"%d\", &amp;guess_value);      \n    number_of_guesses++;\n    if (guess_value == number){\n        printf(\"Right !!! You win\\n\");\n    }\n    else if (guess_value &gt; number){\n        printf(\"\\nYour guess is too high. Guess again\");\n    }\n    else {printf(\"\\nYour guess is too low. Guess again\");\n    }\n}\n\nprintf(\"You guessed %d times !\", number_of_guesses);\n\nprintf(\"Do you want to play again? y? n?\");\nscanf(\"%c\", &amp;answer);\nif (answer == 'y'){ \n    goto A; /*return to to beginging*/\n}\nreturn 0;   \n}\n</code></pre>\n"}, {"tags": ["c", "list"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1455720963, "post_id": 35460066, "comment_id": 58616422, "body": "More code. Depends on the implementation and the API. You show us a <b>node</b>, not a <b>list</b>, so we have no idea what an empty list <b>might</b> look like."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1455720970, "creation_date": 1455720970, "answer_id": 35460098, "question_id": 35460066, "link": "https://stackoverflow.com/questions/35460066/how-to-create-emty-linked-list-in-c/35460098#35460098", "title": "How to create emty linked list in C?", "body": "<p>An empty list has no nodes in it:</p>\n\n<pre><code>struct node *list = NULL;\n</code></pre>\n\n<p>If you want to add nodes to the end of the list:</p>\n\n<pre><code>void addNode(struct node **list, int value)\n{\n    struct node *newnode = malloc(sizeof(struct node));\n    if (newnode == NULL) {\n        perror(\"malloc failed\");\n        exit(1);\n    } \n    newnode-&gt;data = value;\n    newnode-&gt;next = NULL;\n    if (*list == NULL) {\n        *list = newnode;\n    } else {\n        struct node *temp = *list;\n        while (temp-&gt;next != NULL) {\n            temp = temp-&gt;next;\n        }\n        temp-&gt;next = newnode;\n    }\n}\n\n....\n\naddNode(&amp;list, 1);\naddNode(&amp;list, 2);\naddNode(&amp;list, 3);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5550920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356ed49c8f21ea955e431d4a905f80bb?s=128&d=identicon&r=PG&f=1", "display_name": "Agniezhk", "link": "https://stackoverflow.com/users/5550920/agniezhk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "closed_date": 1455724414, "answer_count": 1, "score": -5, "last_activity_date": 1455721535, "creation_date": 1455720893, "last_edit_date": 1455721235, "question_id": 35460066, "link": "https://stackoverflow.com/questions/35460066/how-to-create-emty-linked-list-in-c", "closed_reason": "Needs details or clarity", "title": "How to create emty linked list in C?", "body": "<p>I instalize list and how to make list emty? </p>\n\n<pre><code>struct node {\n   int data;\n  struct node *next;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 8, "creation_date": 1455720700, "post_id": 35459957, "comment_id": 58616226, "body": "The term for the problem is <i>undefined behavior</i>. You are dereferencing an uninitialized pointer."}, {"owner": {"reputation": 54937, "user_id": 16587, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9ed3482ccbb461fbf8796b251caf8f4d?s=128&d=identicon&r=PG", "display_name": "George Stocker", "link": "https://stackoverflow.com/users/16587/george-stocker"}, "edited": false, "score": 0, "creation_date": 1455890567, "post_id": 35459957, "comment_id": 58705068, "body": "Please do not deface your questions.  You can&#39;t ask new questions because you&#39;ve been question banned by the system for asking poorly received questions (as <a href=\"http://stackoverflow.com/revisions/35459957/5\">you point out in your edit</a>) but the answer isn&#39;t to deface your questions. The answer is to start to answer other questions and get upvotes; which will cause the system to recognize that you are a valuable contributor."}], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 6, "last_activity_date": 1455721049, "last_edit_date": 1455721049, "creation_date": 1455720704, "answer_id": 35459990, "question_id": 35459957, "link": "https://stackoverflow.com/questions/35459957/addition-and-subtraction-of-a-char-pointer/35459990#35459990", "title": "Addition and Subtraction of a char pointer", "body": "<p>You haven't allocated  space for the character and the pointer is not initialized, so dereferencing the pointer will result in undefined behavior.</p>\n\n<p>Initialize it beforehand like this:</p>\n\n<pre><code>char a;\nchar* A = &amp;a;\n</code></pre>\n\n<p>or use just a <code>char</code> and obtain a pointer to it using <code>&amp;a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 4, "last_activity_date": 1455722032, "last_edit_date": 1455722032, "creation_date": 1455720890, "answer_id": 35460062, "question_id": 35459957, "link": "https://stackoverflow.com/questions/35459957/addition-and-subtraction-of-a-char-pointer/35460062#35460062", "title": "Addition and Subtraction of a char pointer", "body": "<p>This is undefined behaviour as <code>A</code> does not point to anything and you are <em>dereferencing</em> it.</p>\n\n<p>Either point it to an automatic variable: <code>char c; char* A = &amp;c;</code>, or set it to the return of a <code>malloc</code> call.</p>\n\n<p>Note that you <em>must</em> initialise the value of the <code>char</code> to which you are pointing, otherwise the behaviour of <code>*A += 1;</code> will too be undefined. Fortunately you actually do that with your statement <code>*A = 'A';</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1456068384, "post_id": 35460654, "comment_id": 58764541, "body": "The <code>*A = &#39;A&#39;;</code> seems pretty much redundant to me."}], "tags": [], "owner": {"reputation": 85, "user_id": 5581232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y74Hn.png?s=128&g=1", "display_name": "Joses Paul", "link": "https://stackoverflow.com/users/5581232/joses-paul"}, "is_accepted": false, "score": 1, "last_activity_date": 1455722333, "creation_date": 1455722333, "answer_id": 35460654, "question_id": 35459957, "link": "https://stackoverflow.com/questions/35459957/addition-and-subtraction-of-a-char-pointer/35460654#35460654", "title": "Addition and Subtraction of a char pointer", "body": "<p><em>key:</em> <em>A pointer must be declared and also initialized.</em></p>\n\n<hr>\n\n<p><strong>----  General Syntax  ----</strong> </p>\n\n<p>Declaration:<br>\n<strong>data-type *pointer_name;</strong></p>\n\n<p>Initialization:<br>\n<strong>pointer_name = variable_address</strong></p>\n\n<hr>\n\n<p><strong><em>Example:</em></strong> </p>\n\n<pre><code>    char a = 'A' ;\n    char *ptr ;        //pointer declaration\n    ptr = &amp;a ;         //pointer initialization\n</code></pre>\n\n<p>or</p>\n\n<pre><code>    char a = 'A' ;\n    char *ptr = &amp;a ;   //initialization and declaration together.\n</code></pre>\n\n<hr>\n\n<p>So your code will look like this:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main (int argc, char *argv[])\n{ \n  char a = 'A';\n  char *A = &amp;a;\n\n  *A = 'A';\n  *A += 1;\n\n  printf(\"%c\",*A);\n  return 0;\n}\n</code></pre>\n\n<hr>\n\n<p>Output: <strong>B</strong></p>\n"}], "owner": {"reputation": 15, "user_id": 5921389, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_Pwe-JI9z0E/AAAAAAAAAAI/AAAAAAAAAMw/6ZmFuElLTOI/photo.jpg?sz=128", "display_name": "I                         I", "link": "https://stackoverflow.com/users/5921389/i-i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1455890308, "creation_date": 1455720612, "last_edit_date": 1455890308, "question_id": 35459957, "link": "https://stackoverflow.com/questions/35459957/addition-and-subtraction-of-a-char-pointer", "title": "Addition and Subtraction of a char pointer", "body": "<p>I'm trying to add and/or subtract number to char* in C\nthis code doesn't work for some reason. using char without pointer works though. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;string.h&gt;\n\nint main (int argc, char *argv[])\n{\n    char *A;\n\n    *A = 'A';\n    *A += 1;\n\n    printf(\"%c\",*A);\n    return 0;\n}\n</code></pre>\n\n<p>I'm not sure what the term for this problem is called so a just create a new one</p>\n"}, {"tags": ["c", "switch-statement", "case", "atmel"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1455721711, "post_id": 35459951, "comment_id": 58616993, "body": "Study something about <a href=\"https://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow noreferrer\">state machibnes</a> and <a href=\"http://whatis.techtarget.com/definition/debouncing\" rel=\"nofollow noreferrer\">debouncing</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 2, "creation_date": 1455723140, "post_id": 35459951, "comment_id": 58618100, "body": "Besides debouncing, you didn&#39;t wait for the key to be released, and as @LPs implied, you must consider the current state."}, {"owner": {"reputation": 45, "user_id": 5871439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52b2d6437e1f3ee04de5a2d69542c6a5?s=128&d=identicon&r=PG&f=1", "display_name": "LoneCoder", "link": "https://stackoverflow.com/users/5871439/lonecoder"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455783094, "post_id": 35459951, "comment_id": 58646281, "body": "@LPs thanks guys I have done state machines before so will need to refresh my memory and give this a go"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5871439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52b2d6437e1f3ee04de5a2d69542c6a5?s=128&d=identicon&r=PG&f=1", "display_name": "LoneCoder", "link": "https://stackoverflow.com/users/5871439/lonecoder"}, "edited": false, "score": 0, "creation_date": 1455783023, "post_id": 35465880, "comment_id": 58646251, "body": "Thank you for answering my question, fortunately I have done state machines briefly before in my course. Looks like I&#39;ll have to go back and refresh my memory :s"}, {"owner": {"reputation": 45, "user_id": 5871439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52b2d6437e1f3ee04de5a2d69542c6a5?s=128&d=identicon&r=PG&f=1", "display_name": "LoneCoder", "link": "https://stackoverflow.com/users/5871439/lonecoder"}, "edited": false, "score": 0, "creation_date": 1455789343, "post_id": 35465880, "comment_id": 58650198, "body": "With the nested if statement inside the switch statement:          case ST_IDLE:         case ST_WAIT_FOR_STEP_2:         case ST_WAIT_FOR_STEP_3:             if (_keypressed &gt; 0)             {                 _state++;             }             break;         default:             break;  Is this telling the processor to step through the enumerators and when it steps through the above three basically do nothing or wait for the next enumerator in the type enum?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1455790298, "post_id": 35465880, "comment_id": 58650908, "body": "The nested <code>if</code> statement is followed by a <code>break</code> so the <code>switch</code> code block, and then the function, are exit."}, {"owner": {"reputation": 99, "user_id": 3896097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f2456d4b36ec50d8820566cf29f2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/3896097/marcos"}, "edited": false, "score": 1, "creation_date": 1455967673, "post_id": 35465880, "comment_id": 58734966, "body": "That piece of code is a bit tricky. The states IDLE, WAIT_FOR_STEP_2 and WAIT_FOR_STEP_3 are wait states and their only purpose is to wait for a key press. When this event is triggered, then the state machine moves to the following state. Notice that the enum EnumStates must be in a specific order for this piece of code to work correctly."}], "tags": [], "owner": {"reputation": 99, "user_id": 3896097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19f2456d4b36ec50d8820566cf29f2bd?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/3896097/marcos"}, "is_accepted": true, "score": 1, "last_activity_date": 1455737152, "creation_date": 1455737152, "answer_id": 35465880, "question_id": 35459951, "link": "https://stackoverflow.com/questions/35459951/moving-through-code-using-a-push-button-switch/35465880#35465880", "title": "Moving through code using a Push Button switch", "body": "<p>I would suggest using a state machine.</p>\n\n<p>Something like this (I'm assuming you need to write some code to do a demo only):</p>\n\n<pre><code>/* States */\ntypedef enum EnumStates\n{\n    ST_IDLE,\n    ST_FORWARD_180,\n    ST_WAIT_FOR_STEP_2,\n    ST_REVERSE_90,\n    ST_WAIT_FOR_STEP_3,\n    ST_REVERSE_90_2,\n}\nEState;\n\n/* to know if the switch was pressed */\nchar _keypressed = 0;\n\n/* state variable */\nEState _state = ST_IDLE;\n\n/* very simple keyboard process */\nvoid SwitchTask(void)\n{\n    /* The keypressed flag will be valid for one cycle of the while loop */\n    _keypressed = 0;\n    if (bit_is_clear(PINB, 5))\n    {\n        _keypressed = 1; \n        /* this is a simple way to implement debouncing */\n        /* I assume you do not have timing requirements */\n        _delay_ms(100);\n    }\n}\n\n/* demo task */\n/* This task implements a simple state machine */\nvoid DemoTask(void)\n{\n    switch(_state)\n    {\n        case ST_FORWARD_180:\n            Forward_180();\n            _state = ST_WAIT_FOR_STEP_2;\n            break;\n        case ST_REVERSE_90:\n            Reverse_90();\n            _state = ST_WAIT_FOR_STEP_3;\n            break;\n        case ST_REVERSE_90_2:\n            Reverse_90_2();\n            _state = ST_IDLE;\n            break;\n        case ST_IDLE:\n        case ST_WAIT_FOR_STEP_2:\n        case ST_WAIT_FOR_STEP_3:\n            if (_keypressed &gt; 0)\n            {\n                _state++;\n            }\n            break;\n        default:\n            break;\n    }\n}\n\nint main(void)\n{\n    /* initialization */\n    DDRB |= (1&lt;&lt;A) | (1&lt;&lt;B) | (1&lt;&lt;C) | (1&lt;&lt;D);  // Set output pins\n    DDRB &amp;= ~(1&lt;&lt;PINB5);        // Set input pin for switch \n    _keypressed = 0;\n\n    while(1)\n    {\n        SwitchTask();\n        DemoTask();\n    }   \n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5871439, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/52b2d6437e1f3ee04de5a2d69542c6a5?s=128&d=identicon&r=PG&f=1", "display_name": "LoneCoder", "link": "https://stackoverflow.com/users/5871439/lonecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 35465880, "answer_count": 1, "score": 1, "last_activity_date": 1455737152, "creation_date": 1455720590, "question_id": 35459951, "link": "https://stackoverflow.com/questions/35459951/moving-through-code-using-a-push-button-switch", "title": "Moving through code using a Push Button switch", "body": "<p>I am trying to incorporate a push button switch to control my software for a stepper motor. </p>\n\n<p>I have three functions for the motor where it would rotate at three different angles (from 0-180 degrees forward, 90 degrees reverse and 90 reverse again back to 0) in a sequence, one after the other. </p>\n\n<p>I would like to use one push button switch to step through these functions in an order. </p>\n\n<p>Would anyone have any suggestions on how to do this? I am imagining I have to create a case statement but have been going in circles with no progress. </p>\n\n<p>This is my current code below, at the moment pressing the switch will just run the first \"if\" function rotating the motor clockwise by 180 degrees:</p>\n\n<pre><code>#define F_CPU 1000000\n\n#include &lt;avr/io.h&gt;\n#include &lt;avr/interrupt.h&gt;\n#include &lt;util/delay.h&gt;\n\n#define A PINB0\n#define C PINB1\n#define B PINB4\n#define D PINB3\n\nint16_t i=0; // Auxiliary variable ()\n\nvoid HalfStep(uint8_t step);\nvoid Forward_180(void);\nvoid Reverse_90(void);\nvoid Reverse_90_2(void);\n\n/********************************* MAIN ********************************/\nint main(void)\n{\n    DDRB |= (1&lt;&lt;A) | (1&lt;&lt;B) | (1&lt;&lt;C) | (1&lt;&lt;D);  // Set output pins\n\n    DDRB &amp;= ~(1&lt;&lt;PINB5);        // Set input pin for switch \n\n    while(1)\n    {\n\n        if(bit_is_clear(PINB, 5))\n        {\n            Forward_180();              // Clockwise 180 degrees \n        }\n\n        if(bit_is_clear(PINB, 5))       // Anti-clockwise 90 degrees\n        {\n            Reverse_90();\n        }\n\n        if(bit_is_clear(PINB, 5))       // Anti-clockwise 90 degrees again \n        {\n            Reverse_90_2();\n        }\n    }\n\n    return 0;\n}\n\n/***************** HALF STEPPING &amp; DIRECITON FUNCTIONS *****************/\nvoid HalfStep(uint8_t step)\n{\n    switch (step)\n    {\n        case 0: // whole number after i%8\n        PORTB |= (1&lt;&lt;A) | (1&lt;&lt;D);\n        PORTB &amp;= ~((1&lt;&lt;B) | (1&lt;&lt;C));\n        break;\n\n        case 1: // 0.125\n        PORTB |= (1&lt;&lt;A);\n        PORTB &amp;= ~((1&lt;&lt;B)|(1&lt;&lt;C)|(1&lt;&lt;D));\n        break;\n\n        case 2: // 0.25\n        PORTB |= (1&lt;&lt;A)|(1&lt;&lt;C);\n        PORTB &amp;= ~((1&lt;&lt;B)|(1&lt;&lt;D));\n        break;\n\n        case 3: // 0.375\n        PORTB |= (1&lt;&lt;C);\n        PORTB &amp;= ~((1&lt;&lt;A)|(1&lt;&lt;B)|(1&lt;&lt;D));\n        break;\n\n        case 4: // 0.5\n        PORTB |= (1&lt;&lt;B)|(1&lt;&lt;C);\n        PORTB &amp;= ~((1&lt;&lt;A)|(1&lt;&lt;D));\n        break;\n\n        case 5: // 0.625\n        PORTB |= (1&lt;&lt;C);\n        PORTB &amp;= ~((1&lt;&lt;A)|(1&lt;&lt;B)|(1&lt;&lt;D));\n        break;\n\n        case 6: // 0.75\n        PORTB |= (1&lt;&lt;D)|(1&lt;&lt;C);\n        PORTB &amp;= ~((1&lt;&lt;A)|(1&lt;&lt;B));\n        break;\n\n        case 7: // 0.875\n        PORTB |= (1&lt;&lt;D);\n        PORTB &amp;= ~((1&lt;&lt;A)|(1&lt;&lt;B)|(1&lt;&lt;C));\n        break;\n    }\n}\n\nvoid Forward_180(void)\n{\n    while (i&lt;=48)\n    {\n        HalfStep(i%8);\n        i++;\n        _delay_ms(5);\n    };\n}\n\nvoid Reverse_90(void)\n{\n    while (i&gt;=24)\n    {\n        HalfStep(i%8);\n        i--;\n        _delay_ms(10);\n    };\n}\n\nvoid Reverse_90_2(void)\n{\n    while (i&gt;=0)\n    {\n        HalfStep(i%8);\n        i--;\n        _delay_ms(10);\n    };\n}\n</code></pre>\n"}, {"tags": ["c", "bit-manipulation"], "comments": [{"owner": {"reputation": 3277, "user_id": 4886927, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/fc490fc8a95b40b0b752e661f37ab946?s=128&d=identicon&r=PG&f=1", "display_name": "pasaba por aqui", "link": "https://stackoverflow.com/users/4886927/pasaba-por-aqui"}, "edited": false, "score": 0, "creation_date": 1455719200, "post_id": 35459177, "comment_id": 58614958, "body": "Why not simply &quot;result = (aaregister &amp; (1 &lt;&lt; pos)) != 0&quot; ?. No loop."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1455719633, "last_edit_date": 1455719633, "creation_date": 1455719201, "answer_id": 35459383, "question_id": 35459177, "link": "https://stackoverflow.com/questions/35459177/bitwise-operation-to-set-decimal-variable/35459383#35459383", "title": "bitwise operation to set decimal variable", "body": "<p>You are shifting the wrong part: instead of shifting <code>1</code> to the right (which will produce zero when <code>pos</code> is not zero) you should shift <code>aaregister</code> to the right, like this:</p>\n\n<pre><code>result = result &amp; ((aaregister &gt;&gt; pos) &amp; 1);\n</code></pre>\n\n<p>In addition, the declaration of <code>result</code> needs to move inside the loop, so that you reset it back to <code>1</code> on each iteration (<a href=\"http://ideone.com/nhRj39\" rel=\"nofollow\">demo</a>).</p>\n\n<p>Now that your program is working, here are some important points about bit operations:</p>\n\n<p><strong>You cannot force a zero into a number by OR-ing</strong> - hence, <code>aaregister | 0 &lt;&lt; 1</code> operation is pointless. In order to force a zero you need to AND with an inverse, like this:</p>\n\n<pre><code>aaregister = aaregister &amp; ~(1 &lt;&lt; 1);\n</code></pre>\n\n<p>or better</p>\n\n<pre><code>aaregister &amp;= ~(1 &lt;&lt; 1);\n</code></pre>\n\n<p><strong>Compound assignments make your code easier to read</strong> - instead of writing</p>\n\n<pre><code>aaregister = aaregister | 1 &lt;&lt; 3;\n</code></pre>\n\n<p>write</p>\n\n<pre><code>aaregister |= (1 &lt;&lt; 3);\n</code></pre>\n\n<p><strong>Testing a bit can be done in any position</strong> - if you would like to check that position <code>pos</code> is set or not, use</p>\n\n<pre><code>if (aaregister &amp; (1 &lt;&lt; pos)) {\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 2, "last_activity_date": 1455720439, "creation_date": 1455720439, "answer_id": 35459895, "question_id": 35459177, "link": "https://stackoverflow.com/questions/35459177/bitwise-operation-to-set-decimal-variable/35459895#35459895", "title": "bitwise operation to set decimal variable", "body": "<p>New answer, based on what I believe the expected output is intended to be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main ()\n{\n    int pos;\n    unsigned int aaregister = 0;\n    unsigned int result = 0;\n    aaregister |= 1 &lt;&lt; 0;\n    printf(\"|0: %02X \\n\", aaregister);\n    aaregister |= 1 &lt;&lt; 1;\n    printf(\"|1: %02X \\n\", aaregister);\n    aaregister |= 0 &lt;&lt; 2;\n    printf(\"|2: %02X \\n\", aaregister);\n    aaregister |= 1 &lt;&lt; 3;\n    printf(\"|3: %02X \\n\", aaregister);\n    for (pos = 3; pos&gt;=0;pos--)\n    {\n        result = (aaregister &gt;&gt; pos) &amp; 1;\n        printf(\"Pos %d: res : %d\\n\", pos, result);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>|0: 01\n|1: 03\n|2: 03\n|3: 0B\nPos 3: res : 1\nPos 2: res : 0\nPos 1: res : 1\nPos 0: res : 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 5941453, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lWrjaClrzh4/AAAAAAAAAAI/AAAAAAAAATU/2LO1p1pqVe4/photo.jpg?sz=128", "display_name": "Arul", "link": "https://stackoverflow.com/users/5941453/arul"}, "is_accepted": false, "score": -1, "last_activity_date": 1455733510, "last_edit_date": 1455733510, "creation_date": 1455728518, "answer_id": 35463062, "question_id": 35459177, "link": "https://stackoverflow.com/questions/35459177/bitwise-operation-to-set-decimal-variable/35463062#35463062", "title": "bitwise operation to set decimal variable", "body": "<p>to set a bit you can use this logic</p>\n\n<pre><code>a=(1&lt;&lt;(pos-1))|a; \n</code></pre>\n"}], "owner": {"reputation": 2832, "user_id": 1410376, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/3aMQc.jpg?s=128&g=1", "display_name": "Anis_Stack", "link": "https://stackoverflow.com/users/1410376/anis-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35459895, "answer_count": 3, "score": 1, "last_activity_date": 1455733510, "creation_date": 1455718665, "last_edit_date": 1455721493, "question_id": 35459177, "link": "https://stackoverflow.com/questions/35459177/bitwise-operation-to-set-decimal-variable", "title": "bitwise operation to set decimal variable", "body": "<p>I wrote a light program using bitwise operation.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main ()\n{\n    int pos;\n    unsigned int aaregister = 0;\n    unsigned int result = 1;\n    aaregister = aaregister|(1 &lt;&lt; 0);\n    printf(\"|0: %02X \\n\", aaregister);\n    aaregister = aaregister | 1 &lt;&lt; 1;\n    printf(\"|1: %02X \\n\", aaregister);\n    aaregister = aaregister | 0 &lt;&lt; 2;\n    printf(\"|2: %02X \\n\", aaregister);\n    aaregister = aaregister | 1 &lt;&lt; 3;\n    printf(\"|3: %02X \\n\", aaregister);\n    for (pos = 3; pos&gt;=0;pos--) \n    {\n         result = result &amp; (aaregister &amp; (1 &gt;&gt; pos));\n        printf(\" %d \\n\", result);\n         printf(\"res : %02X \\n\", result);\n    }\n  return 0;\n} \n</code></pre>\n\n<p>my purpose is set <code>aaregister</code> to binary value 1011 and then set the <code>result</code> according to bit position.</p>\n\n<p>if bit pos = 3 <code>1</code> so result = 1</p>\n\n<p>if pos = 2 <code>0</code> so result = 0</p>\n\n<p>if pos = 1 <code>1</code> so result = 1</p>\n\n<p>if pos = 0 <code>1</code> so result = 1</p>\n\n<p>but the program doesn't return that !!</p>\n\n<p>what wrong with the c program  ?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 1, "creation_date": 1455718777, "post_id": 35459059, "comment_id": 58614627, "body": "You didn&#39;t show us <code>createStore()</code>.  Do you actually initialize the values within the allocated structure?  If you don&#39;t that is the most likely cause of your troubles.  That, plus the fact that you call <code>insertBrand()</code> with no arguments from main even though your definition shows two arguments.  Makes me think that this won&#39;t even compile, let alone work."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1455718882, "post_id": 35459059, "comment_id": 58614694, "body": "There are no calls to <code>insertBrand</code> in the code you posted.  You have a useless declaration of it in <code>main</code>, which you should remove.  But where is it actually called?"}, {"owner": {"reputation": 1911, "user_id": 5312235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gVNwh.jpg?s=128&g=1", "display_name": "morels", "link": "https://stackoverflow.com/users/5312235/morels"}, "edited": false, "score": 1, "creation_date": 1455718950, "post_id": 35459059, "comment_id": 58614756, "body": "you called insertBrand with no arguments."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1911, "user_id": 5312235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gVNwh.jpg?s=128&g=1", "display_name": "morels", "link": "https://stackoverflow.com/users/5312235/morels"}, "edited": false, "score": 2, "creation_date": 1455719083, "post_id": 35459059, "comment_id": 58614848, "body": "@morels: nope - declared, not called."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 2, "creation_date": 1455719108, "post_id": 35459059, "comment_id": 58614868, "body": "@DavidHoelzer: the function is declared, not called, in <code>main()</code>."}, {"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1455719142, "post_id": 35459059, "comment_id": 58614906, "body": "Oh, look at that.  What an odd thing to do.  Thanks.  I have to add that to my list of &quot;Stupid C tricks&quot; in the class that I teach. ;)"}, {"owner": {"reputation": 1911, "user_id": 5312235, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gVNwh.jpg?s=128&g=1", "display_name": "morels", "link": "https://stackoverflow.com/users/5312235/morels"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1455719238, "post_id": 35459059, "comment_id": 58614994, "body": "@JonathanLeffler that is not better..."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1455719230, "post_id": 35459243, "comment_id": 58614985, "body": "That line (re)declares the function without giving it a prototype.  It is not a function call.  It is neither a good idea nor what is really wanted, but it is &#39;legitimate&#39; C."}], "tags": [], "owner": {"reputation": 174, "user_id": 5934644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5d99c42018c02b0af58f56ffe4f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "SADIK Younsse", "link": "https://stackoverflow.com/users/5934644/sadik-younsse"}, "is_accepted": false, "score": 2, "last_activity_date": 1455732463, "last_edit_date": 1455732463, "creation_date": 1455718834, "answer_id": 35459243, "question_id": 35459059, "link": "https://stackoverflow.com/questions/35459059/calling-function-including-pointer-parameters/35459243#35459243", "title": "Calling function including pointer parameters", "body": "<p>First of all you must check your creation function. You also you have put this line in the main without any parameters <code>store* insertBrand();</code> you didn't return any value into your <code>insertBrand</code> \u2014 however you had a return type in your definition function <code>store*</code>.  You must ensure of initializing the structure when you create it and ensure of the brands initializing also.</p>\n\n<p>In your main function you put a declaration of the function:</p>\n\n<pre><code>store* insertBrand();\n</code></pre>\n\n<p>This is not a call to <code>insertBrand</code>; it's just a (non-prototype) function declaration.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 5524648, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/351848e19277036e724ea51d237dc40f?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe", "link": "https://stackoverflow.com/users/5524648/moshe"}, "is_accepted": false, "score": 0, "last_activity_date": 1455732448, "creation_date": 1455732448, "answer_id": 35464384, "question_id": 35459059, "link": "https://stackoverflow.com/questions/35459059/calling-function-including-pointer-parameters/35464384#35464384", "title": "Calling function including pointer parameters", "body": "<p>i am sorry for the mess, didnt want to make a too big question with a lot of code in it.\nhowever, for those who ask:</p>\n\n<pre><code>store * createStore()\n{\n    char name[SIZE];\n    int i, j;\n    store* newStore = (store*)malloc(sizeof(store));\n    if (newStore == NULL)\n    {\n        puts(\"allocating error\");\n        free(newStore);\n        return NULL;\n    }\n    puts(\"enter store name : (32 ch. MAX\");\n    getchar(name);\n    gets(name);\n    newStore-&gt;s_Name = strdup(name);\n    if (newStore-&gt;s_Name == NULL)\n    {\n        puts(\"allocating error\");\n        free(newStore-&gt;s_Name);\n        free(newStore);\n    }\n    puts(\"enter total number of sunglasses : \");\n    scanf(\"%d\", &amp;(newStore-&gt;s_TotalSg));\n\n    puts(\"enter number of brands : \");\n    scanf(\"%d\", &amp;(newStore-&gt;s_NumOfBrands));\n\n    newStore-&gt;brands = (brand**)calloc(sizeof(newStore-&gt;s_NumOfBrands), sizeof(brand*));\n    if (newStore-&gt;brands == NULL)\n    {\n        puts(\"allocating error\");\n        free(newStore-&gt;s_Name);\n        free(newStore-&gt;s_NumOfBrands);\n        free(newStore-&gt;s_TotalSg);\n        free(newStore-&gt;brands);\n        free(newStore);\n        return NULL;\n    }\n    for (i = 0; i &lt; newStore-&gt;s_NumOfBrands; i++)\n    {\n        newStore-&gt;brands[i] = createBrand();\n        if (newStore-&gt;brands[i] == NULL)\n        {\n            puts(\"allocating error\");\n            for (j = 0; j &lt; i; j++)\n                free(newStore-&gt;brands[j]);\n            free(newStore-&gt;s_Name);\n            free(newStore-&gt;s_NumOfBrands);\n            free(newStore-&gt;s_TotalSg);\n            free(newStore-&gt;brands);\n            free(newStore);\n            return NULL;\n        }\n    }\n    return newStore;\n}\n</code></pre>\n\n<p>is it helpfull for my question?</p>\n"}, {"tags": [], "owner": {"reputation": 174, "user_id": 5934644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba5d99c42018c02b0af58f56ffe4f6e9?s=128&d=identicon&r=PG&f=1", "display_name": "SADIK Younsse", "link": "https://stackoverflow.com/users/5934644/sadik-younsse"}, "is_accepted": false, "score": 0, "last_activity_date": 1455746243, "creation_date": 1455746243, "answer_id": 35468606, "question_id": 35459059, "link": "https://stackoverflow.com/questions/35459059/calling-function-including-pointer-parameters/35468606#35468606", "title": "Calling function including pointer parameters", "body": "<p>Hi your function contains some mistakes, so i will just list them here :\n1. Why you try to apply free function on a pointer you tested before and is NULL and integer </p>\n\n<pre><code>free(newStore); // line 9 of the function\nfree(newStore-&gt;s_Name); // line 19\nfree(newStore-&gt;s_NumOfBrands); // line 33 and 48\nfree(newStore-&gt;s_TotalSg); // line 34 and 49\n</code></pre>\n\n<ol start=\"2\">\n<li><p>This line isn't correct i think</p>\n\n<p>newStore->brands = (brand**)calloc(sizeof(newStore->s_NumOfBrands), sizeof(brand*));</p></li>\n</ol>\n\n<p>You want to do this i think :</p>\n\n<pre><code>newStore-&gt;brands = (brand**)calloc(newStore-&gt;s_NumOfBrands, sizeof(brand*));\n</code></pre>\n\n<p>This is a quick clean up of your code check it and improve it also check you createBrand</p>\n\n<pre><code>store * createStore()\n{\n    char name[SIZE];\n    int i, j;\n    store* newStore = (store*)malloc(sizeof(store));\n    if (newStore == NULL) {\n        puts(\"allocating error\");\n        return NULL;\n    }\n    puts(\"enter store name : (32 ch. MAX\");\n    getchar(name); // you can use scanf instead of this two lines\n    gets(name);\n    newStore-&gt;s_Name = strdup(name);\n    if (newStore-&gt;s_Name == NULL) {\n        puts(\"allocating error\");\n        free(newStore);\n        return NULL;\n    }\n    puts(\"enter total number of sunglasses : \");\n    scanf(\"%d\", &amp;(newStore-&gt;s_TotalSg));\n\n    puts(\"enter number of brands : \");\n    scanf(\"%d\", &amp;(newStore-&gt;s_NumOfBrands));\n\n    newStore-&gt;brands = (brand**)calloc(newStore-&gt;s_NumOfBrands, sizeof(brand*));\n    if (newStore-&gt;brands == NULL) {\n        puts(\"allocating error\");\n        free(newStore-&gt;s_Name);\n        free(newStore);\n        return NULL;\n    }\n\n    for (i = 0; i &lt; newStore-&gt;s_NumOfBrands; i++) {\n        newStore-&gt;brands[i] = createBrand();\n        if (newStore-&gt;brands[i] == NULL) {\n            puts(\"allocating error\");\n            for (j = 0; j &lt; i; j++)\n                free(newStore-&gt;brands[j]);\n            free(newStore-&gt;s_Name);\n            free(newStore-&gt;brands);\n            free(newStore);\n            return NULL;\n        }\n    }\n    return newStore;\n}\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 5524648, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/351848e19277036e724ea51d237dc40f?s=128&d=identicon&r=PG&f=1", "display_name": "Moshe", "link": "https://stackoverflow.com/users/5524648/moshe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1455746243, "creation_date": 1455718365, "last_edit_date": 1455719469, "question_id": 35459059, "link": "https://stackoverflow.com/questions/35459059/calling-function-including-pointer-parameters", "title": "Calling function including pointer parameters", "body": "<p>Let's say I have a sunglasses shop.\nMy structures (bottom to top):</p>\n\n<pre><code>typedef struct Model\n{\n    int m_Num;\n    int m_amount;\n}model;\ntypedef struct Brand\n{\n    char b_name[20];\n    int b_amount;\n    int b_NumOfModels;\n    model ** models;\n}brand;\ntypedef struct Store\n{\n    char * s_Name;\n    int s_NumOfBrands;\n    int s_TotalSg;\n    brand ** brands;\n}store;\n</code></pre>\n\n<p>I have built \"createStore/Brand/Model\" functions - checked, worked perfectly.\nThe next part I want to pay attention to is after I have created a store, I want to be able to add more stores/brands/models.\nI have tried for example adding some random brand:</p>\n\n<pre><code>store * insertBrand(store*, char*);\n</code></pre>\n\n<p>and as feedback, I want to get a message if the brand exists or does not exist:</p>\n\n<pre><code>int main()\n{\n    store* moshSstore = createStore();\n    store* insertBrand();\n    return 0;\n}\n\nstore * insertBrand(store *s, char* brandName)\n{\n    int i, j, found;\n    for (i = 0; i &lt; s-&gt;s_NumOfBrands; i++)\n    {\n        if (strcmp(s-&gt;brands[i]-&gt;b_name, brandName) == 0)\n            break;\n    }\n    if (i &lt; s-&gt;s_NumOfBrands)   //found\n        printf(\"brand has been found\");\n\n    else                        //not found\n        printf(\"brand not found\");\n}\n</code></pre>\n\n<p>This is my code. I have tried to debug but I don't understand why the <code>insertBrand</code> function is not working (not working at all).</p>\n"}, {"tags": ["c", "list", "pointers"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 2, "creation_date": 1455718378, "post_id": 35459027, "comment_id": 58614332, "body": "This <i>looks</i> like C, but either way, C != C++. You should generally only tag the language you are using/compiling."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 2, "creation_date": 1455718515, "post_id": 35459027, "comment_id": 58614442, "body": "<code>(*ptrptr)-&gt;next_ptr = tmp_ptr; free(tmp_ptr);</code> oO"}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 1, "creation_date": 1455718528, "post_id": 35459027, "comment_id": 58614452, "body": "Please get rid of that menu/choice stuff. Create a small example with fixed input to reproduce the problem. (Also, <code>action</code> is repeatedly calling itself. That&#39;s not a sane way to implement a menu. Use a loop.)"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1455718558, "post_id": 35459027, "comment_id": 58614475, "body": "@Dario de cianni  Show a compiled example The code you showed will not compile at least due to this declaration tylist *ptrptr;"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1455718575, "post_id": 35459027, "comment_id": 58614490, "body": "Also (perhaps a transcription error?) your <code>typedef</code> is <code>stylist</code>, but you use <code>tylist</code>."}, {"owner": {"reputation": 128, "user_id": 5810646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be0f60ad655116607509872ee15e8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "iba", "link": "https://stackoverflow.com/users/5810646/iba"}, "reply_to_user": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1455719156, "post_id": 35459027, "comment_id": 58614917, "body": "@crashmstr edited tag C++ and type stylist. @M Ohem should i use a while with a condition like while(response != 0)? Vlad from Moscow the code compile, otherwise how could i be posting this question?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1455719558, "post_id": 35459027, "comment_id": 58615284, "body": "@Dariodecianni the point was that the code <i>as posted</i> would not compile, and we can&#39;t read your mind or your screen."}], "answers": [{"comments": [{"owner": {"reputation": 128, "user_id": 5810646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be0f60ad655116607509872ee15e8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "iba", "link": "https://stackoverflow.com/users/5810646/iba"}, "edited": false, "score": 0, "creation_date": 1455719211, "post_id": 35459195, "comment_id": 58614967, "body": "Now i see, but should I do it in another way or shouldn&#39;t i free it? And: why it&#39;s working for the first 4 insertion?"}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 128, "user_id": 5810646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be0f60ad655116607509872ee15e8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "iba", "link": "https://stackoverflow.com/users/5810646/iba"}, "edited": false, "score": 0, "creation_date": 1455719539, "post_id": 35459195, "comment_id": 58615264, "body": "@Dariodecianni: Well, with every new item you add to your list, you <code>free()</code> the previous one, but have the new item still point at the (now invalid) memory address of the previous one. What do you think happens in <code>visit_list()</code> when, after printing the <code>value</code> of the most recent item, your program follows the pointer-to-invalid-memory to get at the next item? It is <a href=\"http://stackoverflow.com/questions/2397984\">undefined behaviour</a> to reference invalid memory. Your program may crash the first time, or &quot;work&quot; a hundred times. It&#39;s a broken program, in any case."}, {"owner": {"reputation": 128, "user_id": 5810646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be0f60ad655116607509872ee15e8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "iba", "link": "https://stackoverflow.com/users/5810646/iba"}, "edited": false, "score": 1, "creation_date": 1455743146, "post_id": 35459195, "comment_id": 58631013, "body": "thank you for the help, i apologise all you for making such a stupid/uncorrect question."}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": true, "score": 0, "last_activity_date": 1455720041, "last_edit_date": 1495540234, "creation_date": 1455718713, "answer_id": 35459195, "question_id": 35459027, "link": "https://stackoverflow.com/questions/35459027/segmentation-fault-on-6th-insert-in-linked-list/35459195#35459195", "title": "Segmentation fault on 6th insert in linked list", "body": "<pre><code>    tmp_ptr = (tylist *)malloc(sizeof(tylist));\n    tmp_ptr = *ptrptr;\n</code></pre>\n\n<p>You just leaked <code>sizeof( tylist )</code> in memory. (You edited this one out after I copied it.)</p>\n\n<p>Oh, and <a href=\"https://stackoverflow.com/questions/605845\">don't cast the result of <code>malloc()</code> in C</a>.</p>\n\n<pre><code>    (*ptrptr)-&gt;next_ptr = tmp_ptr;\n    free(tmp_ptr);\n</code></pre>\n\n<p>Your <code>next_ptr</code> now points to <code>free()</code>'d memory. Any access to <code>next_ptr</code> from here on (as in <code>visit_list()</code>) is <a href=\"https://stackoverflow.com/questions/2397984\">undefined behaviour</a>.</p>\n\n<pre><code>int value;\ncase 1:\n    printf(\"\\nValue: \");\n    scanf(\"%d\", &amp;value);\n</code></pre>\n\n<p><em>Never</em> use <code>scanf()</code> for parsing user input. (Use <code>fgets()</code> and parse in-memory.) </p>\n\n<p>If you <em>insist</em> on using <code>scanf()</code>, at least check the return code -- <code>value</code> might be uninitialized at this point if the user did enter a non-number.</p>\n\n<pre><code>    return 0; \n}   \n</code></pre>\n\n<p>I don't see any code for releasing the memory once you are done with your list. Not <code>free()</code>ing allocated memory before you end your program is a memory leak. That e.g. Windows or Linux recover that memory as they tear down the program's process doesn't change the fact that <em>your program</em> leaked the memory.</p>\n"}], "owner": {"reputation": 128, "user_id": 5810646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be0f60ad655116607509872ee15e8a6e?s=128&d=identicon&r=PG&f=1", "display_name": "iba", "link": "https://stackoverflow.com/users/5810646/iba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 1, "closed_date": 1455749973, "accepted_answer_id": 35459195, "answer_count": 1, "score": -3, "last_activity_date": 1455720041, "creation_date": 1455718292, "last_edit_date": 1455718792, "question_id": 35459027, "link": "https://stackoverflow.com/questions/35459027/segmentation-fault-on-6th-insert-in-linked-list", "closed_reason": "Not suitable for this site", "title": "Segmentation fault on 6th insert in linked list", "body": "<p>i'm making a program where you can create a linked list and modify/delete/add/print value, but i'm getting some error testing it.\nFirst one is segmentation fault 11: when you add the 4th value and there are all equal values (1, 1, 1, 1), trying to print the list will get you a segfault, can't figure it out why.\nSecond error (for the moment): sometimes the 6th or 8th value added will delete all other values, living the last two inserted and placing a 0 in tail.</p>\n\n<p>This is the portion of code interested:</p>\n\n<pre><code>typedef struct list\n{\n    int value;\n    struct list* next_ptr;\n}tylist;\n\nint main()\n{\n\n    tylist *ptrptr;\n    ptrptr = NULL;\n    printf(\"\\nI'm going to initialize the list now\\n\");\n    action(choicer(), &amp;ptrptr);\n    return 0; \n}   \nvoid insert_at_beg(tylist** ptrptr, int value)\n{\n    if(*ptrptr != NULL)                             \n    {\n        tylist* tmp_ptr;\n        tmp_ptr = *ptrptr;\n        *ptrptr = (tylist*)malloc(sizeof(tylist));\n        (*ptrptr)-&gt;value = value;\n        (*ptrptr)-&gt;next_ptr = tmp_ptr;\n        free(tmp_ptr);\n    }\n    else\n    {\n        printf(\"\\nList is empty, that's your first entry\\n\");\n        *ptrptr = (tylist*)malloc(sizeof(tylist));\n        (*ptrptr)-&gt;value = value;\n        (*ptrptr)-&gt;next_ptr = NULL;\n    }\nvoid action(int choice, tylist **ptrptr)\n{\n    switch(choice)\n    {\n    int value;\n    case 1:\n        printf(\"\\nValue: \");\n        scanf(\"%d\", &amp;value);\n        insert_at_beg(ptrptr, value);\n        action(choicer(), ptrptr);\n        break;\n\n\n    case 8:\n        visit_list(ptrptr);\n        action(choicer(), ptrptr);\n        break;\n    }\n}\nvoid visit_list(tylist **ptrptr) \n{\n    while((*ptrptr) != NULL)\n    {\n        printf(\" %d\", (*ptrptr)-&gt;value);\n        ptrptr = &amp;((*ptrptr)-&gt;next_ptr);\n    }\n}\n</code></pre>\n\n<p>I've deleted some lines of code on purpose, because it seems just long enough this way, if it's unclear i'll post more.</p>\n\n<p>P.s. i'm sorry for my bad english, i'm trying to improve it.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13636, "user_id": 3191557, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffa6013ed93cfff5ef56f1ddf63956b1?s=128&d=identicon&r=PG&f=1", "display_name": "dhke", "link": "https://stackoverflow.com/users/3191557/dhke"}, "edited": false, "score": 3, "creation_date": 1455718460, "post_id": 35459005, "comment_id": 58614400, "body": "&quot;<i>it does not happen</i>&quot;? What exactly? After the call to <code>task()</code>, <code>a</code> contains <code>{2, 4, 200}</code>. <code>range = 0</code> and <code>b = NULL</code> are essentially no-ops, however, because you are modifying local variables (copies of the call parameters)."}, {"owner": {"reputation": 919, "user_id": 1913796, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/SuFNn.jpg?s=128&g=1", "display_name": "Alexandru Cimpanu", "link": "https://stackoverflow.com/users/1913796/alexandru-cimpanu"}, "edited": false, "score": 2, "creation_date": 1455718532, "post_id": 35459005, "comment_id": 58614455, "body": "<code>len</code> won&#39;t change unless u call <code>task(a, &amp;len)</code> and declare <code>task(int *b, int* range)</code>. In your example <code>len</code> doesn&#39;t change because it&#39;s passed by value and not by reference."}, {"owner": {"reputation": 75, "user_id": 4085234, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bdee164f0fa8b8ef5e1982d13269c844?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/4085234/jenny"}, "edited": false, "score": 0, "creation_date": 1455718685, "post_id": 35459005, "comment_id": 58614570, "body": "Don&#39;t modifications to arrays within functions change the original array?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1455719000, "post_id": 35459005, "comment_id": 58614797, "body": "Yes, but <code>len</code> passed as <code>range</code> is not an array, so it&#39;s passed by value like everything else. Nor does modifying the locally scoped pointer argument modify the pointer that was originally passed. Only arrays (which effectively decay to pointers) or the <i>targets</i> of pointers can be modified within a function in a way that escapes to the outside scope."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455719194, "post_id": 35459005, "comment_id": 58614953, "body": "<code>static void task(int *b, int range){</code> Is it allowed to make a function static?"}, {"owner": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455719239, "post_id": 35459005, "comment_id": 58614996, "body": "@sun, yes.  A <code>static</code> function in C is local to that file, cannot be accessed from another file (or &quot;translation unit&quot;, to be pedantic)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455719424, "post_id": 35459005, "comment_id": 58615153, "body": "Actually you cannot pass an array to a function - as an array. Instead the array is implicitly converted to a pointer to the first entry - that&#39;s why <code>int *b</code> as argument works (a pointer is not an array!). So, there is really no exception to the pass by value principle."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "edited": false, "score": 0, "creation_date": 1455719468, "post_id": 35459005, "comment_id": 58615200, "body": "@SamWatkins: To use the precise term: it has internal linkage, like other <code>static</code> objects are file-level."}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "edited": false, "score": 0, "creation_date": 1455719596, "post_id": 35459005, "comment_id": 58615311, "body": "@SamWatkins Yes, I misremembered the sentense &quot;The declarations in the declaration list shall contain no storage-class specifier other than register and no initializations.&quot; in N1570"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455721680, "post_id": 35459005, "comment_id": 58616969, "body": "C passes scalar arguments by value, but arrays are in effect passed by reference, since rather than passing the array, C instead passes the address of the first element of the array.  So if you modify a scalar argument, it has no effect on the caller, but if you modify an array argument, you are in fact writing through a pointer argument and the result is visible to the caller."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4085234, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bdee164f0fa8b8ef5e1982d13269c844?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/4085234/jenny"}, "edited": false, "score": 0, "creation_date": 1455718940, "post_id": 35459260, "comment_id": 58614753, "body": "This is a code snippet from a quiz review to emphasize concepts we&#39;ve learned I didn&#39;t write this"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 0, "creation_date": 1455719158, "post_id": 35459260, "comment_id": 58614920, "body": "&quot;to emphasize concepts we&#39;ve learned&quot; are they trying to teach you how to write no-ops? what was their actual question?"}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1455719184, "post_id": 35459260, "comment_id": 58614942, "body": "That explain why is that weird"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455720579, "post_id": 35459260, "comment_id": 58616125, "body": "Downvoted: You cannot set array to NULL, it&#39;s not a pointer. Besides array already decays to pointer, there is no reason for double pointer nonsense."}, {"owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "edited": false, "score": 0, "creation_date": 1455721011, "post_id": 35459260, "comment_id": 58616449, "body": "It is not the fault of the function, but how he declares b"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1455721902, "post_id": 35459260, "comment_id": 58617135, "body": "This example is incorrect.  If called as shown, the argument <code>b</code> as seen by <code>task</code> is <i>not</i> an <code>int **</code>.  It is in fact an <code>int (*)[3]</code>, and its value is the address of <code>a</code>.  It is not an array of pointers, as your example expects."}], "tags": [], "owner": {"reputation": 1664, "user_id": 2649079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b41a2c9d80a4b8917940e65858c9abc0?s=128&d=identicon&r=PG", "display_name": "Nadir", "link": "https://stackoverflow.com/users/2649079/nadir"}, "is_accepted": false, "score": 0, "last_activity_date": 1455718952, "last_edit_date": 1455718952, "creation_date": 1455718884, "answer_id": 35459260, "question_id": 35459005, "link": "https://stackoverflow.com/questions/35459005/why-wouldnt-this-change-the-values-in-the-array/35459260#35459260", "title": "Why wouldn&#39;t this change the values in the array?", "body": "<p>When using pointers, you can modify to what the pointer is pointing to, but not the pointer itself.\nSo, your function will modify a, effectively putting 200 in the last position, however, it will not become NULL.\nLen wont be modified as well.\nTo modify both of them, you should do</p>\n\n<pre><code>void task(int **b, int *range) {\n    *(b)[*range - 1] = 200;\n    *range = 0;\n    *b = NULL;\n}\n</code></pre>\n\n<p>And call it as</p>\n\n<pre><code>task(&amp;b, &amp;len);\n</code></pre>\n\n<p>But why would you want to modify the array if you are gonna set it to NULL later?</p>\n"}, {"tags": [], "owner": {"reputation": 143, "user_id": 4071573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cffafd3bd704e5c07c6acd81c94b77f?s=128&d=identicon&r=PG&f=1", "display_name": "johnson262", "link": "https://stackoverflow.com/users/4071573/johnson262"}, "is_accepted": false, "score": 0, "last_activity_date": 1455727446, "creation_date": 1455727446, "answer_id": 35462683, "question_id": 35459005, "link": "https://stackoverflow.com/questions/35459005/why-wouldnt-this-change-the-values-in-the-array/35462683#35462683", "title": "Why wouldn&#39;t this change the values in the array?", "body": "<p>What happens when you declare the array <code>int a[]= {2,4,6};</code> is that the values <code>2,4,6</code> will be stored in memory in three consecutive memory fields. In variable <code>a</code> will be stored the address to the first memory field (where the first array element was saved).</p>\n\n<p>When calling <code>task(a,len);</code> you pass a copy of this address (call by value).\nBecause of this you can enter the array in the called function but can not override the actual variable <code>a</code>. </p>\n\n<p>What happens there is that <code>b[range-1] = 200;</code> overrides the third element with <code>200</code>. <code>range = 0;</code> and <code>b = NULL;</code> do only override the local variables, that only exist in the function. The least two instructions don't affect the variables in your <code>main()</code>.</p>\n\n<p>When returning to <code>main()</code> <code>a</code> and <code>len</code> have still the same values as before calling <code>task(a,len);</code>. But the values stored in the array are now <code>a={2,4,200};</code>.</p>\n"}], "owner": {"reputation": 75, "user_id": 4085234, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/bdee164f0fa8b8ef5e1982d13269c844?s=128&d=identicon&r=PG&f=1", "display_name": "Jenny", "link": "https://stackoverflow.com/users/4085234/jenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1455727446, "creation_date": 1455718236, "question_id": 35459005, "link": "https://stackoverflow.com/questions/35459005/why-wouldnt-this-change-the-values-in-the-array", "title": "Why wouldn&#39;t this change the values in the array?", "body": "<p>I know in C, things are passed by value however I thought that arrays, if modified in functions (without making a copy) would have the original modified but when I run this code that does not happen. I am assuming range doesn't change len because of the scope?</p>\n\n<p>Can someone explain?</p>\n\n<pre><code>static void task(int *b, int range){\n  b[range-1] = 200;\n  range = 0;\n  b = NULL;\n}\n\nint main (){\n  int a[]= {2,4,6};\n  int len = 3, i;\n  printf(\"len1:  %d\\n\", len);\n\n  task(a,len);\n  printf(\"len %d\\n\", len);\n  for(i=0; i &lt; len; i++){\n    printf(\"%d\\n\", a[i]);\n  }\n\n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1455718578, "post_id": 35458944, "comment_id": 58614491, "body": "Now is a good time to learn how to use a debugger. With a debugger you can step through the code, line by line, while being able to watch what happens, as well as being able to see the values of all variables. Being able to use a debugger is crucial for anyone who want to program."}, {"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1455718908, "post_id": 35458944, "comment_id": 58614728, "body": "hello, yes I am using the debugger, though it&#39;s my first time. I see something wrong with the divider and maybe even the number. but I don&#39;t know what&#39;s wrong, and how it should be calculated.  I am totally confused."}, {"owner": {"reputation": 3297, "user_id": 1472828, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2vX5H.jpg?s=128&g=1", "display_name": "HoKy22", "link": "https://stackoverflow.com/users/1472828/hoky22"}, "edited": false, "score": 0, "creation_date": 1455719341, "post_id": 35458944, "comment_id": 58615083, "body": "Can you point out what line you are seeing might be wrong?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1455719859, "post_id": 35458944, "comment_id": 58615540, "body": "State <code>C</code> and <code>D</code> are calculating the divider without add the values. BTW your code, using a state machine, is, at least, weird. If is not mandatory (i guess school homework) to use state machine, think to change your implementation."}, {"owner": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "edited": false, "score": 0, "creation_date": 1455720085, "post_id": 35458944, "comment_id": 58615717, "body": "Change implementation to <code>strtod</code> unless you absolutely must write an inferior version of it yourself."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "edited": false, "score": 0, "creation_date": 1456124470, "post_id": 35459873, "comment_id": 58783460, "body": "Thank you very much! It worked.  To answer your comment below my state: The start of the code was already given to me and they told me I had to do it with the states for exercise. Then they said the structure is okay, but the calculation was wrong and I didn&#39;t find out what exactly was wrong. Now I got it, thank you. Usually I would have tried it on another way."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": true, "score": 1, "last_activity_date": 1455720380, "creation_date": 1455720380, "answer_id": 35459873, "question_id": 35458944, "link": "https://stackoverflow.com/questions/35458944/user-input-string-converted-to-double/35459873#35459873", "title": "User input String converted to double", "body": "<p>Correcting your weird code</p>\n\n<p>State <code>C</code> and <code>D</code> should be</p>\n\n<pre><code>case C:\n    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n    {\n        state = D;\n        divider = divider * 10.0;\n        number = number * 10.0 + ch - '0';\n    }\n    else\n    {\n        state = Error;\n    }\n    break;\ncase D:\n    if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n    {\n        state = D;\n        divider = divider * 10.0;\n        number = number * 10.0 + ch - '0';\n    }\n    else if (ch == '\\0')\n    {\n        state = End;\n    }\n    else\n    {\n        state = Error;\n    }\n    break;\n</code></pre>\n\n<p>And state <code>B</code> should avoid to increment the divider:</p>\n\n<pre><code>    case B:\n        if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n        {\n            state = B;\n            number = number * 10.0 + ch - '0';\n        }\n        else if (ch == '.')\n        {\n            state = C;\n        }\n        else if (ch == '\\0')\n        {\n            state = End;\n        }\n        else\n        {\n            state = Error;\n        }\n        break;\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5761445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pb19I.png?s=128&g=1", "display_name": "DeathToxic", "link": "https://stackoverflow.com/users/5761445/deathtoxic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 35459873, "answer_count": 1, "score": 0, "last_activity_date": 1455720380, "creation_date": 1455718109, "question_id": 35458944, "link": "https://stackoverflow.com/questions/35458944/user-input-string-converted-to-double", "title": "User input String converted to double", "body": "<p>The code below works, but it calculates something wrong. Please tell me what or how I should calculate it so that the output will be the same as the input. Please don't change or add new code except it's just the calculation part.</p>\n\n<p>The result at the moment is just for example: \n<p>Type a String which will be converted to a double: 12.23\n<br>string 12.23 -> number 0.012 </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid main()\n{\n    char input[100];\n    printf(\"Type a String which will be converted to a double: \");\n    scanf(\"%s\", input);\n\n    double number = 0.0;\n    double divider = 1.0;\n    double sign = 1.0;\n\n    enum { Start, End, Error, A, B, C, D } state = Start;\n\n    int i = 0;\n    while (state != End &amp;&amp; state != Error)\n    {\n        char ch = input[i];\n        i++;\n        switch (state)\n        {\n        case Start:\n            if (ch == '+' || ch == '-')\n            {\n                state = A;\n                if (ch == '-')\n                {\n                    sign = -1.0;\n                }\n            }\n            else if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n            {\n                state = B;\n                number = number * 10.0 + ch - '0';\n            }\n            else\n            {\n                state = Error;\n            }\n            break;\n        case A:\n            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n            {\n                state = B;\n                number = number * 10.0 + ch - '0';\n            }\n            else\n            {\n                state = Error;\n            }\n            break;\n        case B:\n            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n            {\n                state = B;\n                number = number * 10.0 + ch - '0';\n            }\n            else if (ch == '.')\n            {\n                state = C;\n                divider = divider * 10.0;\n            }\n            else if (ch == '\\0')\n            {\n                state = End;\n            }\n            else\n            {\n                state = Error;\n            }\n            break;\n        case C:\n            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n            {\n                state = D;\n                divider = divider * 10.0;\n            }\n            else\n            {\n                state = Error;\n            }\n            break;\n        case D:\n            if (ch &gt;= '0' &amp;&amp; ch &lt;= '9')\n            {\n                state = D;\n                divider = divider * 10.0;\n            }\n            else if (ch == '\\0')\n            {\n                state = End;\n            }\n            else\n            {\n                state = Error;\n            }\n            break;\n        }\n    }\n\n    if (state == End)\n    {\n        printf(\"string %s -&gt; number %g \\n\", input, sign * number / divider);\n    }\n    else\n    {\n        printf(\"Enter a valid number! \\n\");\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "pthreads"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 2, "creation_date": 1455718328, "post_id": 35458888, "comment_id": 58614285, "body": "how do you call <code>pthread_join</code>?"}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1455718988, "post_id": 35458888, "comment_id": 58614783, "body": "I have faced similar behavior when the pthreads were wrapped by a class, and the class&#39; method which invokes pthread_join was called out after the class instance was being destructed. Perhaps you can somehow check same in your case."}, {"owner": {"reputation": 3297, "user_id": 1472828, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2vX5H.jpg?s=128&g=1", "display_name": "HoKy22", "link": "https://stackoverflow.com/users/1472828/hoky22"}, "edited": false, "score": 2, "creation_date": 1455719373, "post_id": 35458888, "comment_id": 58615107, "body": "Post the code at least"}, {"owner": {"reputation": 15473, "user_id": 744720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65030f1bd22dbb4d1e6976cfac08a1c5?s=128&d=identicon&r=PG", "display_name": "keltar", "link": "https://stackoverflow.com/users/744720/keltar"}, "edited": false, "score": 0, "creation_date": 1455719515, "post_id": 35458888, "comment_id": 58615240, "body": "<code>__call_tls_dtors</code> siggests thread have finished and tries to destroy its TLS. Is there anything interesting/dangerous that is kept in TLS?"}, {"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455733076, "post_id": 35458888, "comment_id": 58624904, "body": "As the code is huge, I am giving here my code snippet which explain how I am creating child threads, their exits and joining them."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455782341, "post_id": 35467197, "comment_id": 58645899, "body": "I have changed declaration of &#39;thread Id&#39; from &#39;unsigned long int&#39; to &#39;pthread_t&#39; but still the result is same. The thread Ids already global as they defined outside the main function."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455787158, "post_id": 35467197, "comment_id": 58648589, "body": "There&#39;s not much in the code you posted. Otherwise, create an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Did you check <code>pthread_create()</code> calls succeed?"}, {"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455788782, "post_id": 35467197, "comment_id": 58649751, "body": "Surprisingly if I replace &#39;return NULL&#39; with &#39;pthread_exit(0)&#39;, no crash in pthread_join and program executed successfully. Confused why &#39;return NULL&#39; causing crash and &#39;pthread_exit&#39; not."}, {"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455789446, "post_id": 35467197, "comment_id": 58650279, "body": "Yes, pthread_create() was successful and the activation function was also executed for some time before it exit."}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455789510, "post_id": 35467197, "comment_id": 58650332, "body": "It sounds like you have some <i>undefined behaviour</i> (buffer overrun, uninitialized pointer use etc etc) in your code. Because return NULL; wouldn&#39;t change anything if you use it in place of pthread_exit(0); -- both are equivalent. I can&#39;t really help much as the code you posted is too abstract and doesn&#39;t exhibit the <i>actual</i> problem you have."}, {"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455790639, "post_id": 35467197, "comment_id": 58651118, "body": "I think the entry and return arguments matters to pthread and inside activation function, does it matter how I written the code especially when it is returning NULL? If I have programming bugs in my activation function on how I use variables, how I declared them, how memory is allocated , whether memory freed or not, is it matters at thread exit ?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1455791952, "post_id": 35467197, "comment_id": 58651995, "body": "Typically memory leaks don&#39;t matter. But if you have buffer overruns etc, then it&#39;s most definitely going to show up in an unexpected way (which looks to be the case here because replacing replacing <code>return NULL;</code> &quot;fixes&quot; the issue)."}, {"owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "edited": false, "score": 0, "creation_date": 1456809940, "post_id": 35467197, "comment_id": 59106821, "body": "Actually I integrated third party code with my program and in the third party code there were optional assembly instructions for performance reasons based on compiler and word width of the OS. This piece of code was working well when I was using fedora 18 and the problem occurred when i started using Fedora 20 which has different gcc compiler version. Due to compiler mismatch looks like the assembler instructions were behaving differently. Now after disabling optional assembler instructions, pthread_join has no issue. Thanks everybody for your comments."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1455741358, "creation_date": 1455741358, "answer_id": 35467197, "question_id": 35458888, "link": "https://stackoverflow.com/questions/35458888/pthread-join-function-crash/35467197#35467197", "title": "pthread_join function crash", "body": "<p>In the (pseudo)code you posted, the main issue is the type of thread identifiers: they all should be of type <code>pthread_t</code>. But you have <code>unsigned long int</code>s. The crash is most likely because <code>pthread_join()</code> attempts to read <code>rcThId1</code> et al as if they are <code>pthread_t</code> which they are not.</p>\n\n<p>Change the type of <code>rcThId1</code> ..<code>rcThId6</code> to <code>pthread_t</code>. </p>\n\n<p>You should be getting some warnings. If not compiler with:</p>\n\n<pre><code>gcc -Wall -Wextra -pedantic-errors\n</code></pre>\n\n<p>Aside:</p>\n\n<p>You probably need to have th thread ids as global. Move them inside <code>main()</code> unless you have a good reason not to.</p>\n"}], "owner": {"reputation": 35, "user_id": 3899508, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/355ec5936b0c311280ffa33b541aab3d?s=128&d=identicon&r=PG&f=1", "display_name": "user3899508", "link": "https://stackoverflow.com/users/3899508/user3899508"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2084, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1455741527, "creation_date": 1455717960, "last_edit_date": 1455741527, "question_id": 35458888, "link": "https://stackoverflow.com/questions/35458888/pthread-join-function-crash", "title": "pthread_join function crash", "body": "<p>There is a crash inside 'pthread_join' when main function calls it and before that the child thread already terminated. This is the backtrace from gdb:</p>\n\n<pre><code>Core was generated by `./bin/test'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0xb76fb530 in __call_tls_dtors@plt () from /lib/libpthread.so.0\n(gdb) bt\n#0  0xb76fb530 in __call_tls_dtors@plt () from /lib/libpthread.so.0\n#1  0xb76fdd5a in start_thread (arg=0xb40fab40) at pthread_create.c:319\n#2  0xb762f74e in clone () at ../sysdeps/unix/sysv/linux/i386/clone.S:129\n</code></pre>\n\n<p>The pthread activation function receives NULL argument and return NULL argument. I am clueless why I am seeing this crash consistently. </p>\n\n<p>Could somebody help what could be wrong in child thread activation function? I am using Fedora 20 and gcc version 4.8.3 20140911 (Red Hat 4.8.3-7) (GCC)</p>\n\n<p>Skeleton of child activation function is below</p>\n\n<pre><code>void* testControl(void* param)\n{\n   ...................\n   return NULL;\n}\n</code></pre>\n\n<p>As the my code is huge I am giving here the code snippet which explains how I am creating child threads, their exits and termination.</p>\n\n<pre><code>unsigned long int rcThId1;  \nunsigned long int rcThId2;\nunsigned long int rcThId3;\nunsigned long int rcThId4;\nunsigned long int rcThId5;\nunsigned long int rcThId6;\n\nvoid* rcControl1(void* arg)\n{\n  bool th_loop = true;\n\n  while(th_loop)\n  {\n\n     /*Listen and receive the message on message queue*/\n\n     ...........\n     ..........\n\n     switch(message_type)\n     {\n        ............\n        ............\n\n        case EXIT:\n\n          th_loop = false;\n          break;\n\n        default:\n          break;\n     }\n\n   }\n\n   return NULL;\n\n}\n\n/*Activation functions for rcControl2 rcControl3 rcControl4\n\nrcControl5 rcControl6 similar to the defination of rcControl1*/\n\nint main(void)\n{\n  pthread_create(&amp;rcThId1,NULL,rcControl1,NULL);\n  pthread_create(&amp;rcThId2,NULL,rcControl2,NULL);\n  pthread_create(&amp;rcThId3,NULL,rcControl3,NULL);\n  pthread_create(&amp;rcThId4,NULL,rcControl4,NULL);\n  pthread_create(&amp;rcThId5,NULL,rcControl5,NULL);\n  pthread_create(&amp;rcThId6,NULL,rcControl6,NULL);\n\n  ..............\n  ..............\n  /*Post EXIT event to Thread1*/\n  /*Post EXIT event to Thread2*/\n  /*Post EXIT event to Thread3*/\n  /*Post EXIT event to Thread4*/\n  /*Post EXIT event to Thread5*/\n  /*Post EXIT event to Thread6*/\n  /*By now all threads would have already exited */\n\n  pthread_join(rcThId1, NULL);/*Inside this function crash is happening*/    \n  pthread_join(rcThId2, NULL);\n  pthread_join(rcThId3, NULL);\n  pthread_join(rcThId4, NULL);\n  pthread_join(rcThId5, NULL);\n  pthread_join(rcThId6, NULL);\n\n  return 0;\n}\n</code></pre>\n\n<p>Inside <code>pthread_join(rcThId1, NULL);</code> call the crash is happened.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "arrays", "string", "switch-statement", "scanf"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1455717917, "post_id": 35458701, "comment_id": 58613982, "body": "Check the indexes! And use a better test string, e.g. <code>abc...z</code>. Btw: That is too error-prone; use the code to directly index into the array. And do not use all-uppercase for variables."}, {"owner": {"reputation": 26941, "user_id": 2979617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/whfql.png?s=128&g=1", "display_name": "M Oehm", "link": "https://stackoverflow.com/users/2979617/m-oehm"}, "edited": false, "score": 3, "creation_date": 1455718082, "post_id": 35458701, "comment_id": 58614107, "body": "You use <code>%s</code> to print a character; use <code>%c</code> instead. (The <code>%s</code> expects a <code>char *</code>, which it dereferences. The ASCII value you pass as variadic argument isn&#39;t a valid address and probably dosn&#39;t have the right size.. Compile with warnings enabled to learn about format/argument mismatches.)"}, {"owner": {"reputation": 3919, "user_id": 3169961, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42c9a71949249cac6172502dfce7da7d?s=128&d=identicon&r=PG", "display_name": "sabbahillel", "link": "https://stackoverflow.com/users/3169961/sabbahillel"}, "edited": false, "score": 0, "creation_date": 1455718627, "post_id": 35458701, "comment_id": 58614523, "body": "Note, you can get rid of the if inside the while by setting <code>len=strlen(CH);</code> and making the while a for loop <code>for(i=0; i&lt;len; i++)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5940814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89a613f908378724b9ad6b0b66e3e4e3?s=128&d=identicon&r=PG&f=1", "display_name": "PAVAN KUMAR", "link": "https://stackoverflow.com/users/5940814/pavan-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1455762807, "last_edit_date": 1455762807, "creation_date": 1455718517, "answer_id": 35459119, "question_id": 35458701, "link": "https://stackoverflow.com/questions/35458701/number-of-chars-in-a-string-with-scanf-and-switch-statment/35459119#35459119", "title": "number of chars in a string with scanf() and switch-statment", "body": "<p>The only mistake is while printing the count replace <code>%s</code> with <code>%c</code>\ni.e change</p>\n\n<pre><code>printf(\"%s\\t - %d times\\n\",(char) j,alpha[j- 65]);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"%c\\t - %d times\\n\",(char) j,alpha[j- 65]);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1456000340, "post_id": 35459132, "comment_id": 58746745, "body": "You should probably highlight this modification: <code>char CH[SIZE];</code> in your code vs <code>char * CH[SIZE];</code> in the OPs code. This should&#39;ve been the cause for the segmentation fault."}], "tags": [], "owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "is_accepted": true, "score": 1, "last_activity_date": 1455718866, "last_edit_date": 1455718866, "creation_date": 1455718554, "answer_id": 35459132, "question_id": 35458701, "link": "https://stackoverflow.com/questions/35458701/number-of-chars-in-a-string-with-scanf-and-switch-statment/35459132#35459132", "title": "number of chars in a string with scanf() and switch-statment", "body": "<p>Well, change <code>%s</code> to <code>%c</code> in your <code>printf</code>.</p>\n\n<p>Do</p>\n\n<pre><code>printf(\"%c\\t - %d times\\n\",(char) j,alpha[j- 65]);\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>printf(\"%s\\t - %d times\\n\",(char) j,alpha[j- 65]);\n</code></pre>\n\n<p>Your corrected code is</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define SIZE 100\nint main(int argc, char* argv[])\n{\n    char CH[SIZE];\n    int alpha[26] = { 0 };\n    unsigned int i = 0; \n\n    printf(\"name\\n\");\n        scanf(\"%s\", CH);\n    while(i &lt; SIZE){\n        if(CH[i] != '\\0')\n        {   \n            switch(CH[i])\n            {\n                case 'a':\n                case 'A': ++alpha[0]; break;\n                case 'b':\n                case 'B': ++alpha[1]; break;\n                case 'c':\n                case 'C': ++alpha[1]; break;\n                case 'y': \n                case 'Y': ++alpha[24]; break;\n                case 'z': \n                case 'Z': ++alpha[25]; break;\n            }//end switch\n        }else{ break;}\n    ++i;\n    }//end while\n    int j;\n    for( j = 65; j &lt; 91; ++j)\n    {\n        if(alpha[j- 65] != 0)\n        printf(\"%c\\t - %d times\\n\",(char) j,alpha[j- 65]);\n    }\n}\n</code></pre>\n\n<p>If you are having a doubt on the difference between <code>%c</code> and <code>%s</code>, check <a href=\"https://www.quora.com/What-is-the-difference-between-c-and-s-in-c-programming\" rel=\"nofollow\">this</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": false, "score": 0, "last_activity_date": 1455718609, "creation_date": 1455718609, "answer_id": 35459158, "question_id": 35458701, "link": "https://stackoverflow.com/questions/35458701/number-of-chars-in-a-string-with-scanf-and-switch-statment/35459158#35459158", "title": "number of chars in a string with scanf() and switch-statment", "body": "<p>The problem is with your <code>printf</code> format:</p>\n\n<pre><code>printf(\"%s\\t - %d times\\n\",(char) j,alpha[j- 65]);\n</code></pre>\n\n<p>Change it to this:</p>\n\n<pre><code>printf(\"%c\\t - %d times\\n\",j,alpha[j- 65]);\n</code></pre>\n\n<p>The <code>char</code> cast is harmless but unnecessary.  The real problem is the <code>%s</code> which needs to be <code>%c</code>.</p>\n"}], "owner": {"reputation": 248, "user_id": 5744492, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hURQy.png?s=128&g=1", "display_name": "0x0584", "link": "https://stackoverflow.com/users/5744492/0x0584"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 35459132, "answer_count": 3, "score": 0, "last_activity_date": 1455762807, "creation_date": 1455717481, "last_edit_date": 1455718384, "question_id": 35458701, "link": "https://stackoverflow.com/questions/35458701/number-of-chars-in-a-string-with-scanf-and-switch-statment", "title": "number of chars in a string with scanf() and switch-statment", "body": "<h1>What i'm trying to do</h1>\n\n<p>i'm trying to count the number of characters in a string. i try to save a string in an array <code>CH[100]</code>, then start a <code>switch-statement</code> to find how much the character <code>Q</code> is repeated...</p>\n\n<h1>the Code</h1>\n\n<blockquote>\n  <p>114.c</p>\n</blockquote>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define SIZE 100\nint main(int argc, char* argv[])\n{\n    char* CH[SIZE];\n    int alpha[26] = { 0 };\n    unsigned int i = 0; \n\n    printf(\"name\\n\");\n        scanf(\"%s\", CH);\n    while(i &lt; SIZE){\n        if(CH[i] != '\\0')\n        {   \n            switch(CH[i])\n            {\n                case 'a':\n                case 'A': ++alpha[0]; break;\n                case 'b':\n                case 'B': ++alpha[1]; break;\n                case 'c':\n                case 'C': ++alpha[1]; break;\n                .           .           .   \n                .           .           .\n                .           .           .\n                case 'y': \n                case 'Y': ++alpha[24]; break;\n                case 'z': \n                case 'Z': ++alpha[25]; break;\n            }//end switch\n        }else{ break;}\n    ++i;\n    }//end while\n    for(int j = 65; j &lt; 91; ++j)\n    {\n        if(alpha[j- 65] != 0)\n        printf(\"%s\\t - %d times\\n\",(char) j,alpha[j- 65]);\n    }\n}\n</code></pre>\n\n<h1>Compilation and execution:</h1>\n\n<pre><code>[ar.lnx@host Documents] $ gcc 114.c -o x\n[ar.lnx@host Documents] $ ./x\ndonner le nom\nanas\nSegmentation fault (core dumped)\n[ar.lnx@host Documents] $\n</code></pre>\n\n<p>i can't understand what is the problem, can someone help me find what's happening here</p>\n"}, {"tags": ["c", "linux", "tcp", "md5"], "comments": [{"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 1, "creation_date": 1455715421, "post_id": 35457791, "comment_id": 58612162, "body": "I think you are overwriting the last byte of the string with <code>\\0</code> in the server. The string is already null-terminated so you don&#39;t have to do it."}, {"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 1, "creation_date": 1455715598, "post_id": 35457791, "comment_id": 58612278, "body": "You shouldn&#39;t use MD5 if you just want to make sure the data is ok. Use something like CRC32. If you need the cryptographic properties of MD5, use something that has not been broken yet such as SHA3."}, {"owner": {"reputation": 23, "user_id": 5863346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bfc9fbfc995db0d7ad3923444975ba?s=128&d=identicon&r=PG&f=1", "display_name": "matkuz", "link": "https://stackoverflow.com/users/5863346/matkuz"}, "reply_to_user": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455730681, "post_id": 35457791, "comment_id": 58623490, "body": "I have to use MD5 like that. I delete on server site \\0 and my output to compere &gt;md5: d3e25f16b3f59fecccda12d29b3a6736  &gt;sum3: 3a7dc0c282082d9f7339864b4d504b45 so still not work :("}, {"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455802890, "post_id": 35457791, "comment_id": 58659596, "body": "There obviously must be a difference in the buffers after transmission. Print the buffers (exactly as they are passed to the str2md5 function) for debugging and compare them carefully."}, {"owner": {"reputation": 23, "user_id": 5863346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bfc9fbfc995db0d7ad3923444975ba?s=128&d=identicon&r=PG&f=1", "display_name": "matkuz", "link": "https://stackoverflow.com/users/5863346/matkuz"}, "reply_to_user": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455828817, "post_id": 35457791, "comment_id": 58677019, "body": "Yes - it is diffrent string, but I don&#39;t know how to correctly repair the tcp send and recv so as to have the same data."}, {"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455877908, "post_id": 35457791, "comment_id": 58697214, "body": "What is the difference between the strings? I don&#39;t mean the MD5 strings, I mean the actual strings that you run MD5 against."}, {"owner": {"reputation": 23, "user_id": 5863346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bfc9fbfc995db0d7ad3923444975ba?s=128&d=identicon&r=PG&f=1", "display_name": "matkuz", "link": "https://stackoverflow.com/users/5863346/matkuz"}, "reply_to_user": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455880453, "post_id": 35457791, "comment_id": 58698902, "body": "I just send line of text like &quot;Here is my text bla bla&quot; and in other side I read like &quot;Here&quot; &quot;is my text&quot;, &quot;bla bla&quot;. For &quot;Here&quot;  I count MD5 and I suppose - it is my mistake. I reall don&#39;t know how to repeit it, I want to count MD5 for the same text in both sides."}, {"owner": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455882018, "post_id": 35457791, "comment_id": 58699931, "body": "try only running MD5 whenever you have a line terminated by \\n"}, {"owner": {"reputation": 23, "user_id": 5863346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bfc9fbfc995db0d7ad3923444975ba?s=128&d=identicon&r=PG&f=1", "display_name": "matkuz", "link": "https://stackoverflow.com/users/5863346/matkuz"}, "reply_to_user": {"reputation": 3334, "user_id": 4473327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hP14q.jpg?s=128&g=1", "display_name": "neuhaus", "link": "https://stackoverflow.com/users/4473327/neuhaus"}, "edited": false, "score": 0, "creation_date": 1455884800, "post_id": 35457791, "comment_id": 58701714, "body": "Yes - it will be the best solution but Could you give me example how to do it in my code - using answer the question? Where insert cheching the \\n I think that 100 charakters is enough to read one line, Am I wrong?"}], "owner": {"reputation": 23, "user_id": 5863346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77bfc9fbfc995db0d7ad3923444975ba?s=128&d=identicon&r=PG&f=1", "display_name": "matkuz", "link": "https://stackoverflow.com/users/5863346/matkuz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455716940, "creation_date": 1455714952, "last_edit_date": 1455716940, "question_id": 35457791, "link": "https://stackoverflow.com/questions/35457791/md5-sum-in-tcp-connection", "title": "MD5 sum in TCP connection", "body": "<p>I am trying to use function like <code>MD5_Init</code>,<code>MD5_Update</code> etc.</p>\n\n<p>I try to <code>getline</code> from my file in server and send, in client I <code>read</code> 100 chars. </p>\n\n<p>Here is my most important part of code:\nserver.c\n</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>connfd = accept(listenfd,(struct sockaddr*) NULL,NULL);\n\nif(sposob == 1)     \n{\n    while( (read = getline(&amp;line,&amp;len,stream) ) != -1)\n    {\n\n        write(connfd,line,read); // raad = zwraca wartosc ile   \n        sleep(czas);    // mala precyzja\n        line[read-1] = '\\0';        \n\n        if( !odbierz_i_policz_md5(connfd,line,read) )\n        {\n            perror(\"Blad MD5 \\n\");\n        }\n\n    }\n}\n\n// my function\nchar *str2md5(const char *str, int length) {\n    int n;\n    MD5_CTX c;\n    unsigned char digest[16];\n    char *out = (char*)malloc(33);\n\n    MD5_Init(&amp;c);\n\n    while (length &gt; 0) {\n        if (length &gt; 512) {\n            MD5_Update(&amp;c, str, 512);\n        } else {\n            MD5_Update(&amp;c, str, length);\n        }\n        length -= 512;\n        str += 512;\n    }\n\n    MD5_Final(digest, &amp;c);\n\n    for (n = 0; n &lt; 16; ++n) {\n        snprintf(&amp;(out[n*2]), 16*2, \"%02x\", (unsigned int)digest[n]);\n    }\n\n    return out;\n}\nint odbierz_i_policz_md5(int gniazdo,char *str1, int length)\n{\n    char *out = (char*)malloc(33);\n    char *wiad;\n\n    if(recv(gniazdo, out, 33,0) != -1)\n    {\n        wiad = str2md5(str1,length) ;\n        if (strncmp (wiad,out,33) == 0)\n        {\n            free(out);\n            free(wiad);\n            return 1;\n        }\n        else\n        {\n            free(out);\n            free(wiad);     \n            return 0;\n        }   \n    }\n    else{\n        fprintf(stdout,\"Recv error! \\n\");\n        exit(EXIT_FAILURE); \n    }\n\n}\n</code></pre>\n\n<p>client.c</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#define BUFLEN 100 \nwhile( (n = read(sockfd,recvBuff,sizeof(recvBuff-1))) &gt; 0 )\n{\n    char *wiad; \n    recvBuff[n] = 0;        \n    write(fd,recvBuff,n);\n    /*  if(fprintf(stdout,\"%s\",recvBuff) == EOF)\n    {\n        perror(\"fprintf\");\n    }\n    fflush(stdout);\n    */  \n\n    // odebral - teraz wyslac\n    wiad = str2md5(recvBuff,n);\n    fprintf(stdout,\"Wiadomosc %s \\n\",recvBuff);\n    if( send(sockfd,wiad,33,0) == -1 )\n    {\n        fprintf(stderr, \"Failure Sending Message\\n\");\n    }\n    free(wiad);\n}\n</code></pre>\n\n<p>My problem:\nI have diffrent MD5 in client and server ! I thing that MD5 should have in both site(client,server) the same message. Where is my mistake? How to improve my code? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 2, "creation_date": 1455714804, "post_id": 35457724, "comment_id": 58611736, "body": "Learn from a good C book, not from online tutorials. The tutorials are good for reference, but will always make you a c programmer with lot of holes."}, {"owner": {"reputation": 29, "user_id": 5929763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93459f3d748f43a00dff7e22a538be16?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/5929763/stuart"}, "edited": false, "score": 0, "creation_date": 1455715385, "post_id": 35457724, "comment_id": 58612133, "body": "Hi Ashish, Thanks for the reply. I am teaching myself from a book. It&#39;s &quot;C Through UNIX&quot; by Kenneth E. Martin. It&#39;s admittedly an older book but does require me think a bit more about relationships within the language. In this case, the relationship between a data type used in a declaration and the most appropriate format specifier to use, as well as what that means for how RAM is used. Thanks also for the hint about tutorials. I&#39;ll bear that in mind."}], "answers": [{"tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 3, "last_activity_date": 1455715179, "creation_date": 1455715179, "answer_id": 35457881, "question_id": 35457724, "link": "https://stackoverflow.com/questions/35457724/program-not-displaying-first-operand-after-change-of-data-type/35457881#35457881", "title": "program not displaying first operand after change of data type", "body": "<p>The compiler cannot give you the correct result because you <strong>lied</strong> to it (by using the wrong format specifier).</p>\n\n<p>If you want to enter a <code>int</code>, use <code>\"%d\"</code>; If you want to enter a <code>short int</code>, use <code>\"%hd\"</code>.</p>\n\n<p>Otherwise, you will cause undefined behavior, in which case anything from a segfault to a run-time crash can take place. Keep in mind that undefined behaviors don't deserve a discussion.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1455715737, "last_edit_date": 1455715737, "creation_date": 1455715262, "answer_id": 35457906, "question_id": 35457724, "link": "https://stackoverflow.com/questions/35457724/program-not-displaying-first-operand-after-change-of-data-type/35457906#35457906", "title": "program not displaying first operand after change of data type", "body": "<p>I think that when a value for the second variable <code>b</code> is entered the memory occupied by variable <code>a</code> is overwritten or vice versa. </p>\n\n<p>It is the same effect that the memory around an array can be overwritten if to use an invalid index out of the acceptable range of indices for the array.</p>\n"}], "owner": {"reputation": 29, "user_id": 5929763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93459f3d748f43a00dff7e22a538be16?s=128&d=identicon&r=PG&f=1", "display_name": "Stuart", "link": "https://stackoverflow.com/users/5929763/stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "closed_date": 1455720220, "answer_count": 2, "score": 0, "last_activity_date": 1455715737, "creation_date": 1455714748, "last_edit_date": 1455715722, "question_id": 35457724, "link": "https://stackoverflow.com/questions/35457724/program-not-displaying-first-operand-after-change-of-data-type", "closed_reason": "Duplicate", "title": "program not displaying first operand after change of data type", "body": "<p>I'm currently teaching myself a little C and am receiving a curious response from the executable. Here is the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n   int a, b;   /* the operands in the arithmetic */\n\n   while(1) {\n      printf(\"\\n\\n\\n enter two integers: \");\n      scanf(\"%d %d\", &amp;a, &amp;b);\n      printf(\"\\n %d  +     %d is  %d\", a, b, a + b);\n      printf(\"\\n %d  -     %d is  %d\", a, b, a - b);\n      printf(\"\\n %d  *     %d is  %d\", a, b, a * b);\n      printf(\"\\n %d  /     %d is  %d\", a, b, a / b);\n      printf(\"\\n %d  mod   %d is  %d\", a, b, a % b);\n   }\n   return 0;\n}\n</code></pre>\n\n<p>When this is run, using the int data type as shown, it produces the following output.</p>\n\n<p>enter two integers: <code>32000 32000</code></p>\n\n<pre><code>32000 + 32000 is 64000\n32000 - 32000 is 0\n32000 * 32000 is 1024000000\n32000 / 32000 is 1\n32000 mod 32000 is 0\n</code></pre>\n\n<p>As you can see the output is as would be expected. However when int is replaced with short and no other changes have been made the program generates the following output.</p>\n\n<p>enter two integers: <code>32000 32000</code></p>\n\n<pre><code>0 + 32000 is 32000\n0 - 32000 is -32000\n0 * 32000 is 0\n0 / 32000 is 0\n0 mod 32000 is 0\n</code></pre>\n\n<p>As you can clearly see the program no longer displays the first operand even though 32000 is within the range that gcc documentation says can be represented by a short, which is -32767 to 32767. I am at a loss to understand this.</p>\n\n<p>Further research has revealed that, with the scanf() function, I should have used included the format specification modifier h replacing %d with %hd. My understanding is that using only %d with scanf() causes either the compiler or the hardware to \"throw away\" the top two bytes.</p>\n\n<p>What I am really puzzled about is why is it that only the first operand is affected considering that scanf() used two instances of the (incorrect) %d format specifier ?</p>\n\n<p>Any help that you may be able to give with this would be much appreciated.</p>\n\n<p>Best regards,</p>\n\n<p>Stuart</p>\n"}, {"tags": ["c++", "c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 3, "creation_date": 1455714766, "post_id": 35457496, "comment_id": 58611701, "body": "If you restrict the first (optional) parameter to literal string you may change <code>printf(__VA_ARGS__)</code> to <code>printf(&quot;&quot; __VA_ARGS__)</code> and let concatenation do the job."}, {"owner": {"reputation": 171938, "user_id": 2684539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c5fff6fb65e95570ad1a90fe1e3522e?s=128&d=identicon&r=PG&f=1", "display_name": "Jarod42", "link": "https://stackoverflow.com/users/2684539/jarod42"}, "edited": false, "score": 0, "creation_date": 1455714817, "post_id": 35457496, "comment_id": 58611744, "body": "Else, in c++11, you may forward to variadic template function."}, {"owner": {"reputation": 4604, "user_id": 3821804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/d837f426da3935510c8c43f2a2c07f8d?s=128&d=identicon&r=PG&f=1", "display_name": "GingerPlusPlus", "link": "https://stackoverflow.com/users/3821804/gingerplusplus"}, "edited": false, "score": 0, "creation_date": 1455715060, "post_id": 35457496, "comment_id": 58611920, "body": "What&#39;s wrong with your current code? It looks OK to me."}, {"owner": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1455715395, "post_id": 35457496, "comment_id": 58612138, "body": "What is the compiler? Do you use C++11?"}, {"owner": {"reputation": 51, "user_id": 5940524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9e31e094d6b3d2838243041cf566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mihail Isaev", "link": "https://stackoverflow.com/users/5940524/mihail-isaev"}, "edited": false, "score": 0, "creation_date": 1455777684, "post_id": 35457496, "comment_id": 58643652, "body": "Jarod42, very interesting idea! Maybe I can write first macro to convert (&quot;some variable=%i&quot;, variableValue) to string and then pass it to my macro Eval. I believe that solution is very close."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1455781128, "post_id": 35457496, "comment_id": 58645247, "body": "So what do you use, C or C++? These are two different languages, and in particular they may differ on the level of the preprocessor."}, {"owner": {"reputation": 51, "user_id": 5940524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9e31e094d6b3d2838243041cf566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mihail Isaev", "link": "https://stackoverflow.com/users/5940524/mihail-isaev"}, "edited": false, "score": 0, "creation_date": 1455782250, "post_id": 35457496, "comment_id": 58645846, "body": "I use both C and C++ in my project. It&#39;s project of embedded software in Keil uVision IDE ARM. But this macro I will use only in C++ files."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 0, "creation_date": 1455783898, "post_id": 35457496, "comment_id": 58646679, "body": "Then the C preprocessor is not the right tool for you. Distinguish C++ and C and use the appropriate tools."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5940524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9e31e094d6b3d2838243041cf566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mihail Isaev", "link": "https://stackoverflow.com/users/5940524/mihail-isaev"}, "is_accepted": true, "score": 3, "last_activity_date": 1455792728, "creation_date": 1455792728, "answer_id": 35479390, "question_id": 35457496, "link": "https://stackoverflow.com/questions/35457496/variadic-macros-with-zero-or-more-additional-arguments/35479390#35479390", "title": "Variadic macros with zero or more additional arguments", "body": "<pre><code>// Macro to count of arguments\n#define VA_NUM_ARGS(...) VA_NUM_ARGS_IMPL(__VA_ARGS__, 10,9,8,7,6,5,4,3,2,1)\n#define VA_NUM_ARGS_IMPL(_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,N,...) N\n\n// Macro dispatcher\n#define macro_dispatcher(func, ...) macro_dispatcher_(func, VA_NUM_ARGS(__VA_ARGS__))\n#define macro_dispatcher_(func, nargs) macro_dispatcher__(func, nargs)\n#define macro_dispatcher__(func, nargs) func ## nargs\n\n#define EVAL_UNIVERSAL(...) macro_dispatcher(EV, __VA_ARGS__)(__VA_ARGS__)\n\n#define EV1(func) if (func == -1) return -1;\n#define EV2(func, ...) if (func == -1) { printf(__VA_ARGS__); return -1; }\n\n#define EV3(func, ...) EV2(func, __VA_ARGS__)\n#define EV4(func, ...) EV2(func, __VA_ARGS__)\n#define EV5(func, ...) EV2(func, __VA_ARGS__)\n#define EV6(func, ...) EV2(func, __VA_ARGS__)\n#define EV7(func, ...) EV2(func, __VA_ARGS__)\n</code></pre>\n\n<p>And I use it like this:</p>\n\n<pre><code>EVAL_UNIVERSAL(CheckInitialParameters());\nEVAL_UNIVERSAL(CheckInitialParameters(), \"text\");\nEVAL_UNIVERSAL(CheckInitialParameters(), \"%i\", 1);\nEVAL_UNIVERSAL(CheckInitialParameters(), \"%i %i\", 1, 2);\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5940524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e9e31e094d6b3d2838243041cf566b8?s=128&d=identicon&r=PG&f=1", "display_name": "Mihail Isaev", "link": "https://stackoverflow.com/users/5940524/mihail-isaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 1, "accepted_answer_id": 35479390, "answer_count": 1, "score": 2, "last_activity_date": 1455792728, "creation_date": 1455714110, "last_edit_date": 1495535285, "question_id": 35457496, "link": "https://stackoverflow.com/questions/35457496/variadic-macros-with-zero-or-more-additional-arguments", "title": "Variadic macros with zero or more additional arguments", "body": "<p>I have a macro for checking results of some test methods:</p>\n\n<pre><code>#define Eval(func, ...) if (func == -1) { printf(__VA_ARGS__); return -1; }\n</code></pre>\n\n<p>I want to get this functionally:</p>\n\n<pre><code>Eval(Check_1(),\"Check1 failed.\"); // case 1\nEval(Check_2()); // case 2\nEval(Check_3(), \"some variable=%i\", variableValue); // case 3\n</code></pre>\n\n<p>At case 1 I want to write comment to user (\"Check1 failed\") and then return -1 (it's work).\nAt case 2 I just want to return from method, not print any information for user. So I must to detect situation of empty comment and not to call printf() - it's not work.</p>\n\n<p>If any of \"Check_x\" methods failed, i need exit from current method by return code -1;</p>\n\n<p>Is it any way to do this with macro?</p>\n\n<p>Very similar question was here: <a href=\"https://stackoverflow.com/questions/5588855/standard-alternative-to-gccs-va-args-trick\">Standard alternative to GCC's ##<strong>VA_ARGS</strong> trick?</a> , but I can't modify this code for my situation.</p>\n\n<p>EDIT:\nI use C99 standart.\nAt current version of my code case 2 compiled with error \"expected an expression\" (I think it because of comma and empty argument).\nAlso I need to use case 3 for print additional information (variable values).\nSo, second argument not actually simple string.</p>\n\n<p>EDIT2:\n<strong>I get solution for my task.</strong> <a href=\"http://efesx.com/2010/07/17/variadic-macro-to-count-number-of-arguments/\" rel=\"nofollow noreferrer\">Here I find it</a></p>\n\n<pre><code>// Macro to count of arguments\n#define VA_NUM_ARGS(...) VA_NUM_ARGS_IMPL(__VA_ARGS__, 10,9,8,7,6,5,4,3,2,1)\n#define VA_NUM_ARGS_IMPL(_1,_2,_3,_4,_5,_6,_7,_8,_9,_10,N,...) N\n\n// Macro dispatcher\n#define macro_dispatcher(func, ...) macro_dispatcher_(func, VA_NUM_ARGS(__VA_ARGS__))\n#define macro_dispatcher_(func, nargs) macro_dispatcher__(func, nargs)\n#define macro_dispatcher__(func, nargs) func ## nargs\n\n#define EVAL_UNIVERSAL(...) macro_dispatcher(EV, __VA_ARGS__)(__VA_ARGS__)\n\n#define EV1(func) if (func == -1) return -1;\n#define EV2(func, ...) if (func == -1) { printf(__VA_ARGS__); return -1; }\n\n#define EV3(func, ...) EV2(func, __VA_ARGS__)\n#define EV4(func, ...) EV2(func, __VA_ARGS__)\n#define EV5(func, ...) EV2(func, __VA_ARGS__)\n#define EV6(func, ...) EV2(func, __VA_ARGS__)\n#define EV7(func, ...) EV2(func, __VA_ARGS__)\n</code></pre>\n\n<p>And I use it like this:</p>\n\n<pre><code>EVAL_UNIVERSAL(CheckInitialParameters());\nEVAL_UNIVERSAL(CheckInitialParameters(), \"text\");\nEVAL_UNIVERSAL(CheckInitialParameters(), \"%i\", 1);\nEVAL_UNIVERSAL(CheckInitialParameters(), \"%i %i\", 1, 2);\n</code></pre>\n\n<p>Very thanks to Jens Gustedt, and rmn (<a href=\"http://efesx.com/\" rel=\"nofollow noreferrer\">http://efesx.com/</a>)</p>\n"}, {"tags": ["c", "printf"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1455714259, "post_id": 35457442, "comment_id": 58611324, "body": "Your <code>printf</code> formats don&#39;t match the values you&#39;re passing.  Your compiler should have warned about this.  Because you&#39;re passing unexpected argument types, they are being unpacked incorrectly by <code>printf</code>."}, {"owner": {"reputation": 28330, "user_id": 298054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7dffcc86140441472cfb6119375a9d7?s=128&d=identicon&r=PG", "display_name": "jweyrich", "link": "https://stackoverflow.com/users/298054/jweyrich"}, "edited": false, "score": 1, "creation_date": 1455714341, "post_id": 35457442, "comment_id": 58611378, "body": "If you&#39;re using GCC or Clang, it&#39;s a good practice to add these flags when compiling <code>-Wall -Wextra</code>. Make this an habit."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1455723120, "post_id": 35457513, "comment_id": 58618079, "body": "An alternative would be to continue using <code>%lu</code>, and to use <code>(unsigned long)UINT32_MAX</code>. This may be useful if you cannot use <code>&lt;inttypes.h&gt;</code> for some reason."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1455726153, "post_id": 35457513, "comment_id": 58620471, "body": "@Ian Abbott Need to add: casting to <code>(unsigned long)</code> is a good alternative because <code>unsigned long</code> is <i>at least</i> the width of <code>uint32_t</code>."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 15, "last_activity_date": 1455714163, "creation_date": 1455714163, "answer_id": 35457513, "question_id": 35457442, "link": "https://stackoverflow.com/questions/35457442/printf-redifines-uint32-max/35457513#35457513", "title": "printf redifines UINT32_MAX", "body": "<p>You are using <code>%lu</code>, this is incorrect.  The <code>%lu</code> specifier is for <code>unsigned long</code> and <em>only</em> <code>unsigned long</code>, not <code>uint32_t</code>.  This is why the output is incorrect.  Use <code>PRIu32</code> instead.</p>\n\n<p>Your compiler should have caught this error for you, if you were compiling with warnings enabled.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt; // defines PRIu32\n\nprintf(\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\"\n    \"%\" PRIu32 \"\\n\",\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX);\n</code></pre>\n\n<p>In practice, <code>PRIu32</code> is defined to <code>\"u\"</code> on most systems.</p>\n"}, {"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1455794527, "post_id": 35457529, "comment_id": 58653722, "body": "It&#39;s not an <code>unsigned long</code>, but it&#39;s not an <code>unsigned int</code> either, so merely omitting the <code>l</code> is incorrect."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1455795080, "post_id": 35457529, "comment_id": 58654094, "body": "Yes, technically the minimum size for <code>int</code> is 2 bytes. Finding such a system can be tricky though ;)"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1455795274, "post_id": 35457529, "comment_id": 58654227, "body": "@IanAbbott (replying to myself) - However, I <i>think</i> the type of the constant <code>UINT32_MAX</code> will always be one of <code>unsigned int</code> or <code>unsigned long</code>, rather than something inbetween, so one of <code>%u</code> or <code>%lu</code> would work, but the problem is knowing which one. Hence the need for the <code>PRIu32</code> macro from <code>&lt;inttypes.h&gt;</code>."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1455796033, "post_id": 35457529, "comment_id": 58654708, "body": "I think <code>int</code> is typically 2 bytes on C compilers for 16-bit systems, such as MS-DOS (without any 32-bit extensions)."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "reply_to_user": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1455796434, "post_id": 35457529, "comment_id": 58654954, "body": "@IanAbbott: pretty much what I was saying... but who knows, perhaps MS-DOS is popular in the area you live in."}], "tags": [], "owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "is_accepted": false, "score": 1, "last_activity_date": 1455714212, "creation_date": 1455714212, "answer_id": 35457529, "question_id": 35457442, "link": "https://stackoverflow.com/questions/35457442/printf-redifines-uint32-max/35457529#35457529", "title": "printf redifines UINT32_MAX", "body": "<pre><code>$ gcc -Wall -Wextra your_code.c\nwarning: format \u2018%lu\u2019 expects type \u2018long unsigned int\u2019, but argument 2 has type \u2018unsigned int\u2019\n</code></pre>\n\n<p>It's not a <code>long</code>, don't use the <code>l</code> specifier.</p>\n\n<p>Your code has Undefined Behaviour, and in practice it essentially reads garabage.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455725937, "post_id": 35457546, "comment_id": 58620330, "body": "This makes the reasonable assumption that on OP&#39;s system, <code>uint32_t</code> and <code>unsigned</code> are the same type.  This is not a portable solution in general though."}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1455714249, "last_edit_date": 1495541318, "creation_date": 1455714249, "answer_id": 35457546, "question_id": 35457442, "link": "https://stackoverflow.com/questions/35457442/printf-redifines-uint32-max/35457546#35457546", "title": "printf redifines UINT32_MAX", "body": "<p>This is undefined behavior: you are passing <code>unsigned int</code>, but your <code>%lu</code> format tells <code>printf</code> that you are passing <code>long unsigned int</code>. This leads to <a href=\"https://stackoverflow.com/q/2397984/335858\"><em>undefined behavior</em></a>, because <code>printf</code> goes by what the format specifier says (in fact, it has no other way to find out, because type information is not passed to <code>printf</code>).</p>\n\n<p>Once you fix your format issue, the problem goes away:</p>\n\n<pre><code>printf(\"%u\\n%u\\n%u\\n%u\\n%u\\n%u\\n%u\\n\",\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX,\n    UINT32_MAX);\n</code></pre>\n\n<p>This prints</p>\n\n<pre><code>4294967295\n4294967295\n4294967295\n4294967295\n4294967295\n4294967295\n4294967295\n</code></pre>\n\n<p><a href=\"http://ideone.com/Lb3kl8\" rel=\"nofollow noreferrer\">Demo.</a></p>\n"}], "owner": {"reputation": 67, "user_id": 3770668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a00a76402f4b7b7381a68777a8b22f9?s=128&d=identicon&r=PG&f=1", "display_name": "Matombo", "link": "https://stackoverflow.com/users/3770668/matombo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 35457513, "answer_count": 3, "score": 4, "last_activity_date": 1455714249, "creation_date": 1455713926, "question_id": 35457442, "link": "https://stackoverflow.com/questions/35457442/printf-redifines-uint32-max", "title": "printf redifines UINT32_MAX", "body": "<p>code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n\nint main(int argc, char *argv[]) {\n    printf(\"%lu\\n%lu\\n%lu\\n%lu\\n%lu\\n%lu\\n%lu\\n\",\n        UINT32_MAX,\n        UINT32_MAX,\n        UINT32_MAX,\n        UINT32_MAX,\n        UINT32_MAX,\n        UINT32_MAX,\n        UINT32_MAX);\n    return 0;\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>4294967295\n4294967295\n4294967295\n4294967295\n4294967295\n18446744073709551615\n18446744073709551615\n</code></pre>\n\n<p>bug or intentional? and why?\ni think it speaks for itself but the interface needs me to add more lines before i can post it (to much code for to less text lol)</p>\n"}, {"tags": ["c", "function", "gcc", "arguments"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455713224, "post_id": 35457026, "comment_id": 58610574, "body": "It&#39;s just a variable name, like any other.  The compiler doesn&#39;t treat it specially.  Sometimes people use it for variables whose value isn&#39;t used, but that&#39;s purely a convention and more common in other languages.  The warning is just what it says, and you&#39;d see the same thing if you used any other name, e.g. <code>x</code>."}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 4, "last_activity_date": 1455713228, "creation_date": 1455713228, "answer_id": 35457172, "question_id": 35457026, "link": "https://stackoverflow.com/questions/35457026/what-does-underscore-as-an-argument-in-c-mean/35457172#35457172", "title": "What does underscore as an argument in C mean?", "body": "<p>The underscore <code>_</code> is a valid, ordinary identifier. Defining a function like this:</p>\n\n<pre><code>type function(arg1, arg2, arg3)\n{\n    ...\n}\n</code></pre>\n\n<p>(i.ee without parameter types) is a deprecated style back from the pre-ANSI days called a <em>K&amp;R-style definition.</em> All parameters implicitly have type <code>int</code> unless you explicitly declare them to have a different type like this:</p>\n\n<pre><code>type function(arg1, arg2, arg3)\n    type arg1;\n    type arg2;\n    type arg3;\n{\n    ...\n}\n</code></pre>\n\n<p>where <code>type arg1;</code> is an ordinary declaration. These definitions are still allowed but deprecated. Because you didn't explicitly declare <code>_</code>, the compiler warns you about the implicit declaration as <code>int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455717374, "post_id": 35457212, "comment_id": 58613560, "body": "You should never write &quot;K&amp;R style&quot; functions. It is an obsolescent feature as per 6.11.7."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1455713998, "last_edit_date": 1455713998, "creation_date": 1455713327, "answer_id": 35457212, "question_id": 35457026, "link": "https://stackoverflow.com/questions/35457026/what-does-underscore-as-an-argument-in-c-mean/35457212#35457212", "title": "What does underscore as an argument in C mean?", "body": "<p>This</p>\n\n<pre><code>int func(_)\n{\n    return 1;\n}\n</code></pre>\n\n<p>is a function definition with an identifier list consisiting from one identifier with name <code>_</code> (underscore).</p>\n\n<p>It is not a correct function definition. According to the C Standard (6.9.1 Function definitions)</p>\n\n<blockquote>\n  <p>6 If the declarator includes an identifier list, each declaration in\n  the declaration list shall have at least one declarator, those\n  declarators shall declare only identifiers from the identifier list,\n  <strong>and every identifier in the identifier list shall be declared</strong>.</p>\n</blockquote>\n\n<p>It would be more correctly to define the function for example like</p>\n\n<pre><code>int func(_)\nint _;\n{\n    return 1;\n}\n</code></pre>\n\n<p>As for the similar definition of main</p>\n\n<pre><code>int main(_)\n{\n   //...\n}\n</code></pre>\n\n<p>then it is not a valid declaration of main even if to add definition of the identifier <code>_</code> like it is done above</p>\n\n<pre><code>int main(_)\nint _;\n{\n   //...\n}\n</code></pre>\n\n<p>The C standard does not allow to declare main with an identifier list. At least it is not a standard declaration of main.</p>\n"}], "owner": {"reputation": 1921, "user_id": 4355809, "user_type": "registered", "accept_rate": 84, "profile_image": "https://graph.facebook.com/100000696083609/picture?type=large", "display_name": "yanpas", "link": "https://stackoverflow.com/users/4355809/yanpas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "accepted_answer_id": 35457172, "answer_count": 2, "score": 4, "last_activity_date": 1455713998, "creation_date": 1455712834, "question_id": 35457026, "link": "https://stackoverflow.com/questions/35457026/what-does-underscore-as-an-argument-in-c-mean", "title": "What does underscore as an argument in C mean?", "body": "<p>All modern compilers (clang 3.6, gcc 4.8) allow writing functions with an <code>_</code> in arguments' list.\nLike this:</p>\n\n<pre><code>int func(_)\n{\n    return 1;\n}\n</code></pre>\n\n<p>Even <code>main</code> allows such argument (<code>int main(_)</code>)</p>\n\n<p>The only warning is</p>\n\n<blockquote>\n  <p>p1_concat.c:31:5: warning: type of \u2018_\u2019 defaults to \u2018int\u2019 [enabled by default]</p>\n</blockquote>\n\n<p>What does this underscore mean?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455712743, "post_id": 35456957, "comment_id": 58610244, "body": "Well, can you add more details? As of now I cannot understand your question properly."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1455712999, "post_id": 35456957, "comment_id": 58610426, "body": "IIRC, so do other C&#39;s."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940391"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455713360, "post_id": 35456957, "comment_id": 58610682, "body": "@AshishAhuja sizeof(enum {b, a}) is 4 and sizeof(int) is also 4 that means if(4!=4) then return a;, how the value of a is 1?"}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 5, "creation_date": 1455713540, "post_id": 35456957, "comment_id": 58610806, "body": "It&#39;s a scoping issue.  In C, <code>enum</code> values always start at <code>0</code> unless explicitly overridden.  However, in C89 you&#39;re getting the inner <code>enum</code> values, whereas in C99 you&#39;re getting the outer <code>enum</code> values."}], "answers": [{"tags": [], "owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "is_accepted": true, "score": 8, "last_activity_date": 1455713877, "creation_date": 1455713877, "answer_id": 35457422, "question_id": 35456957, "link": "https://stackoverflow.com/questions/35456957/can-somebody-explain-these-c-code/35457422#35457422", "title": "Can somebody explain these C code?", "body": "<p>The difference between the C89 and C99 behavior is due to which <code>enum</code> definition is in scope.  In gcc, for C89 the inner definition is in effect for <code>return b</code>, while in C99 the outer definition is in effect for <code>return b</code>.</p>\n\n<p>You can see this more clearly in the following example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nenum {a=5, b=6};\n\nint different(void)\n{\n    if (sizeof(enum {b=7, a=8}) != sizeof(int))\n        return a;\n    return b;\n}\n\nint main()\n{\n    printf(\"%d\\n\", different());\n}\n</code></pre>\n\n<p>In gcc, C89 mode gives 7 and C99 mode gives 6.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5940391"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 35457422, "answer_count": 1, "score": 7, "last_activity_date": 1455777368, "creation_date": 1455712668, "last_edit_date": 1455777368, "question_id": 35456957, "link": "https://stackoverflow.com/questions/35456957/can-somebody-explain-these-c-code", "title": "Can somebody explain these C code?", "body": "<p><strong>Code:</strong></p>\n\n<pre><code>enum {a, b};\n\nint different(void)  \n{  \n    if (sizeof (enum {b, a}) != sizeof (int))  \n        return a; // a == 1  \n    return b; // b == 0 in C89, b == 1 in C99  \n}\n</code></pre>\n\n<p>How <code>a==1</code> and <code>b==0</code> in <code>c89</code> and <code>b==1</code> in <code>c99</code> ?</p>\n\n<p>I want to know how value of <code>a</code> in return <code>a</code> is 1 and return value of <code>b</code> changes in <code>c89</code> and <code>c99</code> ?</p>\n"}, {"tags": ["c", "matrix", "linear-programming"], "comments": [{"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1455712660, "post_id": 35456811, "comment_id": 58610177, "body": "<code>printf(&quot;constraint %d: &quot;);</code>  you forget the argument"}, {"owner": {"reputation": 11, "user_id": 5839974, "user_type": "registered", "profile_image": "https://graph.facebook.com/1148224898521809/picture?type=large", "display_name": "Genevieve Baguhin Engalan", "link": "https://stackoverflow.com/users/5839974/genevieve-baguhin-engalan"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1455713441, "post_id": 35456811, "comment_id": 58610741, "body": "thank you for that but can you help me with the computations at the bottom of my code? It doesn&#39;t give me any projection."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455713542, "post_id": 35456811, "comment_id": 58610808, "body": "@GenevieveBaguhinEngalan, Can you please put expected output of the projections? And the actual output? Then I might be actually be able to help you."}, {"owner": {"reputation": 11, "user_id": 5839974, "user_type": "registered", "profile_image": "https://graph.facebook.com/1148224898521809/picture?type=large", "display_name": "Genevieve Baguhin Engalan", "link": "https://stackoverflow.com/users/5839974/genevieve-baguhin-engalan"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455733953, "post_id": 35456811, "comment_id": 58625423, "body": "@Ashish the output is an ordered pair"}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455761593, "post_id": 35456811, "comment_id": 58638402, "body": "@GenevieveBaguhinEngalan, what do you mean? Can you please manually type the expected output in the question."}], "answers": [{"comments": [{"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 2, "creation_date": 1456000768, "post_id": 35457018, "comment_id": 58746897, "body": "Having an excess format specifier (or put differently insufficient number of arguments) causes <i>undefined behavior</i>: <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/c/fprintf</a> (down in the explanation for parameter <code>...</code>)"}], "tags": [], "owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "is_accepted": false, "score": 4, "last_activity_date": 1455888868, "last_edit_date": 1455888868, "creation_date": 1455712819, "answer_id": 35457018, "question_id": 35456811, "link": "https://stackoverflow.com/questions/35456811/projection-of-a-point-to-a-plane/35457018#35457018", "title": "Projection of a point to a plane", "body": "<p>Change</p>\n\n<pre><code> printf(\"constraint %d: \");\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"constraint %d: \", r);\n</code></pre>\n\n<p>This is because, when you put <code>%d</code> in a printf, the value of the variable after the comma gets printed. In your case, you put <code>%d</code> but do not put a variable after the comma. Thus, when you execute the program, no value gets printed because the compiler does not know which value you want to print.</p>\n\n<p>No matter which compiler you're using, enabling all the warning will help you solve this easily next time. If you're using gcc, use the flags <code>-Wall</code> and <code>-Wextra</code>. <code>-Wall</code> will give you extra warnings, including one for your silly mistake. <code>-Wextra</code> will make all warnings into errors, which will ensure that you cannot ignore these warnings. </p>\n"}], "owner": {"reputation": 11, "user_id": 5839974, "user_type": "registered", "profile_image": "https://graph.facebook.com/1148224898521809/picture?type=large", "display_name": "Genevieve Baguhin Engalan", "link": "https://stackoverflow.com/users/5839974/genevieve-baguhin-engalan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1465265539, "creation_date": 1455712295, "last_edit_date": 1465265539, "question_id": 35456811, "link": "https://stackoverflow.com/questions/35456811/projection-of-a-point-to-a-plane", "title": "Projection of a point to a plane", "body": "<p>Can you help me? I need to code on how to solve a projection of a point to a plane. I don't know whats wrong with my code.</p>\n\n<p>The idea of the solution of my projection is:  </p>\n\n<p>Suppose I have a matrix A with elements<br>\n1 2 3<br>\n4 5 6<br>\n7 8 9  </p>\n\n<p>and I have an initial point x = (0, 2), then the projection will be computed as, </p>\n\n<p>Projection of x to row 1 =( 0 - 2{[1 + (2)(0) + (3)(2)]/[sqrt(2^2 + 3^2)]} , 2 - 3{[1 + (2)(0) + (3)(2)]/[sqrt(2^2 + 3^2)]})</p>\n\n<p>Here is my code:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n\nint main() {\n     int rows, cols, r, c;\n     float inputMatrix[100][100], rowSum[100] = {0}, initial[100];\n     long long int a, square[100] = {0};\n     double k;\n     int x, y, z;\n     double p1[100], p2[100], p3[100];\n     float l, m, n;\n\nprintf(\"Enter size of a matrix\\n\");\nscanf(\"%d %d\", &amp;rows, &amp;cols);\nprintf(\"Enter matrix of size %dX%d\\n\", rows, cols);\n/* Input matrix */\nfor ( r = 0; r &lt; rows; r++) {\n    for (c = 0; c &lt; cols; c++) {\n        scanf(\"%f\", &amp;inputMatrix[r][c]);\n    }\n}\n\nprintf(\"\\nrows: %d cols: %d \\n\\nConstraints Matrix:\\n\",rows,cols);\nfor( r = 0; r &lt; rows; r++) {\n        printf(\"constraint %d: \");\n    for( c = 0; c &lt; cols; c++) {\n        printf(\"%.3f \", inputMatrix[r][c]);\n    }\n    printf(\"\\n\");\n}\nprintf(\"\\n\");\nfor (r = 0; r &lt; rows; r++)  {\n    for (c = 1; c &lt; cols; c++) {\n        a = inputMatrix[r][c];\n        square[r] += a * a;\n    }\n    printf(\"Sum of squares of row %d: %lld\\n\",r,square[r]);\n}\n\nprintf(\"\\nEnter Initial point:\\n\");\nfor(c = 0; c &lt; cols; c++){\n    scanf(\"%f\", &amp;initial[c]);\n}\n\n\nprintf(\"\\nEnter three row number of constraint you want to find a projection:\\n\");\n  scanf(\"%d %d %d\", &amp;x, &amp;y, &amp;z);\n  printf(\"%d %d %d\", x, y, z);\n  printf(\"\\nProjections:\\n\");\n\n  for(r = 0; r &lt; rows; r++){\n        rowSum[r] += inputMatrix[r][0];\n        for(c = 1; c &lt; cols; c++){\n            rowSum[r] += ((inputMatrix[r][c])*(initial[c]));\n        }\n  }\n\n  for(c = 1; c &gt; cols; c++)\n    {\n        l = 1.0 / sqrt(square[x]);\n        m = 1.0 / sqrt(square[y]);\n        n = 1.0 / sqrt(square[z]);\n        p1[c-1] = initial[c] - (inputMatrix[x][c]* rowSum[x] * l);\n        p2[c-1] = initial[c] - (inputMatrix[y][c]* rowSum[y] * m);\n        p3[c-1] = initial[c] - (inputMatrix[z][c]* rowSum[z] * n);\n\n    }\n    //printing projections on screen\n    printf(\"\\nP1:\");\n    for(c = 0; c &gt; cols-1; c++)\n    {\n        printf(\" %.3f \", p1[c]);\n    }\n\n    printf(\"\\nP2:\");\n    for(c = 0; c &gt; cols-1; c++)\n    {\n        printf(\" %.3f \", p2[c]);\n    }\n\n    printf(\"\\nP3:\");\n    for(c = 0; c &gt; cols-1; c++)\n    {\n        printf(\" %.3f \", p3[c]);\n    }\n\n  return 0;\n}\n</code></pre>\n\n<p>This is my sample output </p>\n\n<p><img src=\"https://i.stack.imgur.com/USsIL.jpg\" alt=\"\"></p>\n"}, {"tags": ["c", "multithreading", "pthreads", "mutex"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455712181, "post_id": 35456565, "comment_id": 58609835, "body": "Is <code>counter</code> supposed to be protected by the mutex or not? There seem to be lots of cases where you modify <code>counter</code> without holding the mutex or set <code>counter</code> to zero without broadcasting the c.v. -- those kinds of things can lead to waiting for something that has already happened."}, {"owner": {"reputation": 2996, "user_id": 914284, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/1080045267/picture?type=large", "display_name": "Hamit YILDIRIM", "link": "https://stackoverflow.com/users/914284/hamit-yildirim"}, "edited": false, "score": 0, "creation_date": 1455712743, "post_id": 35456565, "comment_id": 58610243, "body": "Also i suggest to wait 6&#39;s reputation for quanta time for a thread sleeping insteade of 30 use for example 18"}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455737089, "post_id": 35456565, "comment_id": 58627322, "body": "@DavidSchwartz sorry for my late reply. The counter is to count the number of the flags that would be turned on by the worker threads. The master threads measure the flags that are turned to 1 by the worker threads and increase the counter value. So if the counter value is equal to the number of threads then the while loop exits and proceed forward and So the counter is not modified by the worker threads. the counter is modified by the master thread only. It broadcasts the value to the worker threads as the worker threads waiting on the counter value to be 0. I am not sure if I. need mutex"}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "reply_to_user": {"reputation": 2996, "user_id": 914284, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/1080045267/picture?type=large", "display_name": "Hamit YILDIRIM", "link": "https://stackoverflow.com/users/914284/hamit-yildirim"}, "edited": false, "score": 0, "creation_date": 1455737289, "post_id": 35456565, "comment_id": 58627455, "body": "@HamitY\u0131ld\u0131r\u0131m I am sorry but I didn&#39;t actually understood your point. Can you elaborate a bit more. Thanks"}, {"owner": {"reputation": 2996, "user_id": 914284, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/1080045267/picture?type=large", "display_name": "Hamit YILDIRIM", "link": "https://stackoverflow.com/users/914284/hamit-yildirim"}, "edited": false, "score": 0, "creation_date": 1455784813, "post_id": 35456565, "comment_id": 58647214, "body": "think a thread waits on background 6 ms then when if it starts to wait processor looks it after handling another one. For this reason look it s releasing process 6 and its reputation times. This just a detail feedback not all your problems solving. For the full solution in your case i suggest to look producer consumer samples"}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "reply_to_user": {"reputation": 2996, "user_id": 914284, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/1080045267/picture?type=large", "display_name": "Hamit YILDIRIM", "link": "https://stackoverflow.com/users/914284/hamit-yildirim"}, "edited": false, "score": 0, "creation_date": 1455826380, "post_id": 35456565, "comment_id": 58675691, "body": "@HamitY\u0131ld\u0131r\u0131m I will take a look in the producer consumer model using pthreads. Can you please post an example that fits my model. Thank you"}], "answers": [{"comments": [{"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455737930, "post_id": 35458280, "comment_id": 58627919, "body": "Hello Thank you for your reply. I included the changes but still the program is not operating as intended. I think the program is waiting in an infinite loop and it is not terminating. Do I need to initialize the counter using mutex"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455757468, "post_id": 35458280, "comment_id": 58637131, "body": "@duttasankha yes, of course - access to shared variable must be synchronized between all paths of execution"}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455763460, "post_id": 35458280, "comment_id": 58638846, "body": "I put the counter into the mutex. But it is still not working."}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455784180, "post_id": 35458280, "comment_id": 58646833, "body": "Me and my friend have worked on the code. The code is executing and terminating but still not producing the intended result. So I have edited my post and updated the code. But it is not that well commented as before as there are lot of changes that we need to perform to get the result"}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455819783, "post_id": 35458280, "comment_id": 58671947, "body": "@duttasankha I have written <a href=\"https://github.com/spinlockirqsave/c/tree/master/threads_cons_prod_cond\" rel=\"nofollow noreferrer\">example</a> how to synchronize threads working on each row of table here. Please read <a href=\"https://github.com/spinlockirqsave/c/tree/master/threads_cons_prod_cond/README\" rel=\"nofollow noreferrer\">README</a> for explanation."}, {"owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455826553, "post_id": 35458280, "comment_id": 58675801, "body": "Thank you very much for providing me with the link. I will definitely take a look."}, {"owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "reply_to_user": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "edited": false, "score": 0, "creation_date": 1455827056, "post_id": 35458280, "comment_id": 58676094, "body": "@duttasankha <a href=\"https://github.com/spinlockirqsave/c/tree/master/threads_cons_prod\" rel=\"nofollow noreferrer\">this</a> is basic example, without syncing threads on each row of the table"}], "tags": [], "owner": {"reputation": 27359, "user_id": 1141471, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/t1JZE.png?s=128&g=1", "display_name": "4pie0", "link": "https://stackoverflow.com/users/1141471/4pie0"}, "is_accepted": true, "score": 0, "last_activity_date": 1455757433, "last_edit_date": 1455757433, "creation_date": 1455716315, "answer_id": 35458280, "question_id": 35456565, "link": "https://stackoverflow.com/questions/35456565/simple-pipelining-using-pthreads/35458280#35458280", "title": "Simple pipelining using pthreads", "body": "<p>There are several errors in this code.</p>\n\n<ol>\n<li><p>You may start from fixing creation of worker threads:</p>\n\n<pre><code>wArguments[i] = (worker_args* )malloc(sizeof(worker_args));\nwArguments[i]-&gt;threadId = i;\nwArguments[i]-&gt;outBuff = outdataArgs;\n\npthread_create(&amp;Workers[i],NULL,worker_func, (void *)wArguments);\n</code></pre></li>\n</ol>\n\n<p>You are initializing <code>worker_args</code> structs but incorrectly - passing pointer to array <code>(void *)wArguments</code> instead of pointers to array elements you just initialized.</p>\n\n<pre><code>pthread_create(&amp;Workers[i],NULL,worker_func, (void *)wArguments[i]);\n//                                                             ^^^\n</code></pre>\n\n<ol start=\"2\">\n<li><p>Initialize counter before starting threads that use it's value:</p>\n\n<pre><code>void *master_func(void *arguments)\n{\n/* (...) */\npthread_mutex_init(&amp;mutex, NULL);\npthread_cond_init (&amp;cond_var, NULL);\ncounter = WthNum;\n</code></pre></li>\n<li><p>When starting master thread, you incorrectly pass pointer to pointer:</p>\n\n<pre><code>pthread_create(&amp;thread[i],NULL,master_func,(void *)&amp;args[i]);\n</code></pre></li>\n</ol>\n\n<p>Please change this to:</p>\n\n<pre><code>pthread_create(&amp;thread[i],NULL,master_func,(void *) args[i]);\n</code></pre>\n\n<ol start=\"4\">\n<li>All accesses to <code>counter</code> variable (as any other shared memory) must be synchronized between threads.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 2996, "user_id": 914284, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/1080045267/picture?type=large", "display_name": "Hamit YILDIRIM", "link": "https://stackoverflow.com/users/914284/hamit-yildirim"}, "is_accepted": false, "score": 0, "last_activity_date": 1455863719, "creation_date": 1455863719, "answer_id": 35498816, "question_id": 35456565, "link": "https://stackoverflow.com/questions/35456565/simple-pipelining-using-pthreads/35498816#35498816", "title": "Simple pipelining using pthreads", "body": "<p>I think you should use semaphore based producer- consumer model like this</p>\n\n<p><a href=\"https://jlmedina123.wordpress.com/2014/04/08/255/\" rel=\"nofollow\">https://jlmedina123.wordpress.com/2014/04/08/255/</a></p>\n"}], "owner": {"reputation": 577, "user_id": 1618283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/00e98dbe99dc2d713e323449af1311e6?s=128&d=identicon&r=PG", "display_name": "duttasankha", "link": "https://stackoverflow.com/users/1618283/duttasankha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 0, "accepted_answer_id": 35458280, "answer_count": 2, "score": 1, "last_activity_date": 1455863719, "creation_date": 1455711592, "last_edit_date": 1455784058, "question_id": 35456565, "link": "https://stackoverflow.com/questions/35456565/simple-pipelining-using-pthreads", "title": "Simple pipelining using pthreads", "body": "<p>Very recently I have started working on pthreads and trying to implement software pipelining with pthreads. To do that I have a written a toy program myself, a similar of which would be a part of my main project. </p>\n\n<p>So in this program the <strong>main thread</strong> creates and <em>input</em> and <em>output</em> buffer of integer type and then creates a single <strong>master thread</strong> and passes those buffers to the <strong>master thread</strong>. The <strong>master thread</strong> in turn creates two <strong>worker threads</strong>. </p>\n\n<p>The <em>input</em> and the <em>output buffer</em> that is passed from the <strong>main</strong> to the <strong>master thread</strong> is of size <strong>n</strong>x<strong>k</strong> (e.g. 5x10 of size int). The <strong>master thread</strong> iterates over a chunk of size <strong>k</strong> (i.e. 10) for <strong>n</strong> (i.e. 5) number of times. \nThere is a loop running in the <strong>master thread</strong> for <strong>k</strong> (5 in here) number of times. In each iteration of <strong>k</strong> the <strong>master thread</strong> does some operation on a portion of input data of size <strong>n</strong> and place it in the <em>common buffer</em> shared between the <strong>master</strong> and the <strong>worker threads</strong>. The <strong>master thread</strong> then signals the worker threads that the data has been placed in the <em>common buffer</em>. </p>\n\n<p>The two <strong>worker threads</strong> waits for the signal from the <strong>master thread</strong> if the <em>common buffer</em> is ready. The operation on the <em>common buffer</em> is divided into half among the <strong>worker threads</strong>. Which means one <strong>worker thread</strong> would work on the first half and the other <strong>worker thread</strong> would work on the next half of the <em>common buffer</em>. \nOnce the <strong>worker threads</strong> gets the signal from the <strong>master thread</strong>, each of the <strong>worker thread</strong> does some operation on their half of the data and copy it to the <em>output buffer</em>. Then the <strong>worker threads</strong> informs the <strong>master thread</strong> that their operation is complete on the <em>common buffer</em> by setting flag values. An array of flags are created for  <strong>worker threads</strong>. The <strong>master thread</strong> keeps on checking if all the flags are set which basically means all the <strong>worker threads</strong> finished their operation on the <em>common buffer</em> and so <strong>master thread</strong> can place the next data chunk into the <em>common buffer</em> safely for <strong>worker thread's</strong> consumption.</p>\n\n<p>So essentially there is communication between the <strong>master</strong> and the <strong>worker threads</strong> in a pipelined fashion. In the very end I am printing the <em>output buffer</em> in the <strong>main thread</strong>. But I am getting no output at all. I have copy pasted my code with full comments on almost all steps.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;string.h&gt;\n\n#define MthNum 1 //Number of Master threads\n#define WthNum 2 //Number of Worker threads\n#define times 5 // Number of times the iteration (n in the explanation)\n#define elNum 10 //Chunk size during each iteration (k in the explanation)\n\npthread_mutex_t mutex; // mutex variable declaration\npthread_cond_t cond_var; //conditional variarble declaration\nbool completion_flag = true; //This global flag indicates the completion of the worker thread. Turned false once all operation ends\n                             //marking the completion\nint *commonBuff; //common buffer between master and worker threads\nint *commFlags; //array of flags that are turned to 1 by each worker threads. So worker thread i turns commFlags[i] to 1\n                // the master thread turns commFlags[i] = 0 for i =0 to (WthNum - 1)\nint *commFlags_s;\nint counter; // This counter used my master thread to count if all the commFlags[i] that shows\n             //all the threads finished their work on the common buffer\n// static pthread_barrier_t barrier;\n// Arguments structure passed to master thread\ntypedef struct{\n    int *input; // input buffer\n    int *output;// output buffer\n}master_args;\n\n// Arguments structure passed to worker thread\ntypedef struct{\n    int threadId;\n    int *outBuff;\n}worker_args;\n\nvoid* worker_func(void *arguments);\nvoid *master_func(void *);\n\nint main(int argc,char*argv[]){\n\n    int *ipData,*opData;\n    int i,j;\n\n    // allocation of input buffer and initializing to 0\n    ipData = (int *)malloc(times*elNum*sizeof(int));\n    memset(ipData,0,times*elNum*sizeof(int));\n\n    // allocation of output buffer and initializing to 0\n    opData = (int *)malloc(times*elNum*sizeof(int));\n    memset(opData,0,times*elNum*sizeof(int));\n\n    pthread_t thread[MthNum];\n    master_args* args[MthNum];\n\n\n    //creating the single master thread and passing the arguments\n    for( i=0;i&lt;MthNum;i++){\n        args[i] = (master_args *)malloc(sizeof(master_args));\n        args[i]-&gt;input= ipData;\n        args[i]-&gt;output= opData;\n        pthread_create(&amp;thread[i],NULL,master_func,(void *)args[i]);\n    }\n\n    //joining the master thred\n    for(i=0;i&lt;MthNum;i++){\n        pthread_join(thread[i],NULL);\n    }\n\n    //printing the output buffer values\n    for(j =0;j&lt;times;j++ ){\n        for(i =0;i&lt;elNum;i++){\n            printf(\"%d\\t\",opData[i+j*times]);\n        }\n      printf(\"\\n\");\n    }\n\n    return 0;\n}\n\n//This is the master thread function\nvoid *master_func(void *arguments){\n\n    //copying the arguments pointer to local variables\n    master_args* localMasterArgs = (master_args *)arguments;\n    int *indataArgs = localMasterArgs-&gt;input; //input buffer\n    int *outdataArgs = localMasterArgs-&gt;output; //output buffer\n\n    //worker thread declaration\n    pthread_t Workers[WthNum];\n    //worker thread arguments declaration\n    worker_args* wArguments[WthNum];\n    int i,j;\n\n    pthread_mutex_init(&amp;mutex, NULL);\n    pthread_cond_init (&amp;cond_var, NULL);\n    counter =0;\n\n    commonBuff = (int *)malloc(elNum*sizeof(int));\n\n    commFlags = (int *)malloc(WthNum*sizeof(int));\n    memset(commFlags,0,WthNum*sizeof(int) );\n    commFlags_s= (int *)malloc(WthNum*sizeof(int));\n    memset(commFlags_s,0,WthNum*sizeof(int) );\n\n    for(i =0;i&lt;WthNum;i++){\n\n        wArguments[i] = (worker_args* )malloc(sizeof(worker_args));\n        wArguments[i]-&gt;threadId = i;\n        wArguments[i]-&gt;outBuff = outdataArgs;\n\n        pthread_create(&amp;Workers[i],NULL,worker_func,(void *)wArguments[i]);\n    }\n\n    for (i = 0; i &lt; times; i++) {\n        for (j = 0; j &lt; elNum; j++)\n            indataArgs[i + j * elNum] = i + j;\n\n        while (counter != 0) {\n            counter = 0;\n\n            pthread_mutex_lock(&amp;mutex);\n            for (j = 0; j &lt; WthNum; j++) {\n                counter += commFlags_s[j];\n            }\n            pthread_mutex_unlock(&amp;mutex);\n\n        }\n        pthread_mutex_lock(&amp;mutex);\n        memcpy(commonBuff, &amp;indataArgs[i * elNum], sizeof(int));\n        pthread_mutex_unlock(&amp;mutex);\n        counter = 1;\n        while (counter != 0) {\n            counter = 0;\n\n            pthread_mutex_lock(&amp;mutex);\n            for (j = 0; j &lt; WthNum; j++) {\n                counter += commFlags[j];\n            }\n            pthread_mutex_unlock(&amp;mutex);\n\n\n        }\n        // printf(\"master broad cast\\n\");\n        pthread_mutex_lock(&amp;mutex);\n        pthread_cond_broadcast(&amp;cond_var);\n         //releasing the lock\n        pthread_mutex_unlock(&amp;mutex);\n\n    }\n\n    pthread_mutex_lock(&amp;mutex);\n     completion_flag = false;\n    pthread_mutex_unlock(&amp;mutex);\n\n    for (i = 0; i &lt; WthNum; i++) {\n        pthread_join(Workers[i], NULL);\n    }\n\n    pthread_mutex_destroy(&amp;mutex);\n    pthread_cond_destroy(&amp;cond_var);\n\n    return NULL;\n}\n\n\nvoid* worker_func(void *arguments){\n\n    worker_args* localArgs = (worker_args*)arguments;\n\n    //copying the thread ID and the output buffer\n    int tid = localArgs-&gt;threadId;\n    int *localopBuffer = localArgs-&gt;outBuff;\n    int i,j;\n    bool local_completion_flag=false;\n\n    while(local_completion_flag){\n\n        pthread_mutex_lock(&amp;mutex);\n        commFlags[tid] =0;\n        commFlags_s[tid] =1;\n        pthread_cond_wait(&amp;cond_var,&amp;mutex);\n        commFlags_s[tid] =0;\n        commFlags[tid] =1;\n        if (tid == 0) {\n            for (i = 0; i &lt; (elNum / 2); i++) {\n                localopBuffer[i] = commonBuff[i] * 5;\n            }\n        } else { // Thread ID 1 operating on the other half of the common buffer data and placing on the\n                 // output buffer\n            for (i = 0; i &lt; (elNum / 2); i++) {\n                localopBuffer[elNum / 2 + i] = commonBuff[elNum / 2 + i] * 10;\n            }\n        }\n         local_completion_flag=completion_flag;\n        pthread_mutex_unlock(&amp;mutex);//releasing the lock\n\n    }\n\n    return NULL;\n}\n</code></pre>\n\n<p>But I have no idea where I have done wrong in my implementation since logically it seems to be correct. But definitely there is something wrong in my implementation. I have spent a long time trying different things to fix it but nothing worked. Sorry for this long post but I am unable to determine a section where I might have done wrong and so I couldn't concise the post. So if anybody could take a look into the problem and implementation and can suggest what changes needed to be done to run it as intended then that it would be really helpful. Thank you for your help and assistance.</p>\n"}, {"tags": ["c", "arrays", "variables"], "comments": [{"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 2, "creation_date": 1455710335, "post_id": 35456032, "comment_id": 58608534, "body": "What do you expect the statement <code>sorting[a];</code> to do?"}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 2, "creation_date": 1455710425, "post_id": 35456032, "comment_id": 58608573, "body": "<a href=\"http://stackoverflow.com/questions/12111372/store-value-from-a-for-loop-into-an-array\">store-value-from-a-for-loop-into-an-array</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1455710471, "post_id": 35456032, "comment_id": 58608607, "body": "declare the size of the array. But even if it&#39;s wrong, that&#39;s not causing the problem."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1455710503, "post_id": 35456032, "comment_id": 58608629, "body": "<code>int sorting[]</code> most probably does not define what you think it does."}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1455710504, "post_id": 35456032, "comment_id": 58608630, "body": "@Michael, i think OP wants to give array size by using <code>sorting[a];</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1455710719, "post_id": 35456032, "comment_id": 58608770, "body": "Thanks Joachim. and all others"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1455710740, "post_id": 35456032, "comment_id": 58608788, "body": "<i>&quot;even if it&#39;s wrong, that&#39;s not causing the problem.&quot;</i> It kind of is. You&#39;re expecting the array to have space for <code>a</code> elements after that, which it doesn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1455710627, "post_id": 35456175, "comment_id": 58608724, "body": "@alk Well that is the &quot;proper&quot; solution. I think you can guess what the other solution to <i>allocate</i> the array would be. :)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 2, "creation_date": 1455710720, "post_id": 35456175, "comment_id": 58608771, "body": "GCC, as an extension, assumes <code>int a[]</code> to have <i>one</i> element."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "edited": false, "score": 0, "creation_date": 1455710914, "post_id": 35456175, "comment_id": 58608907, "body": "Thanks. I&#39;ve chosen to avoid the global already, after seeing your answer before. I assume one answer is to just give a non-user defined value"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 1, "creation_date": 1455711438, "post_id": 35456175, "comment_id": 58609278, "body": "@alk It is according to the C Standard that the array of incomplete type with external definition has type int[1] and its element is initialized by zero."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1455711795, "last_edit_date": 1455711795, "creation_date": 1455710518, "answer_id": 35456175, "question_id": 35456032, "link": "https://stackoverflow.com/questions/35456032/code-to-fill-in-array-suddenly-changes-variable-c/35456175#35456175", "title": "Code to fill in array suddenly changes variable (C)", "body": "<p>When you declare <code>sorting</code> you declare it as an array of an unknown size. If you don't define the array anywhere the size will be one and any indexing above that will be out of bounds and lead to <em>undefined behavior</em> (most likely overwriting other data, like variables).</p>\n\n<p>There are two solutions to this, but I will only tell you one: Don't use global variables, and define the array after you get the size as input from the user. I.e.</p>\n\n<pre><code>scanf(\"%d\",&amp;a);\nint sorting[a];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1455711293, "last_edit_date": 1455711293, "creation_date": 1455710862, "answer_id": 35456303, "question_id": 35456032, "link": "https://stackoverflow.com/questions/35456032/code-to-fill-in-array-suddenly-changes-variable-c/35456303#35456303", "title": "Code to fill in array suddenly changes variable (C)", "body": "<p>In this (incomplete) program</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint sorting[], control,place, a,b,print;\n^^^^^^^^^^^^^^\nint main()\n{\n    printf(\"Please enter how many numbers there are in total.\\n\");\n    scanf(\"%d\",&amp;a);\n    sorting[a];\n    control=a-1;\n    print=a;\n    printf(\"Please start entering your numbers.\\n\");\n    for(;print&gt;0;print--)\n    {\n         scanf(\"%d\",&amp;sorting[print-1]);\n    }\n</code></pre>\n\n<p>array <code>sorting</code> has type <code>int [1]</code> (if it was not redeclared before the end of the translation unit and has incomplete type. It is not an array with a zero size as it is written in other answer). Thus this expression </p>\n\n<pre><code>sorting[a];\n</code></pre>\n\n<p>means an attempt to access memory beyond the array if <code>a</code> is greater than 0.</p>\n\n<p>Instead of the external definition of the array <code>sorting</code> you could declare the array as a variable length array within main. For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint control,place, a,b,print;\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nint main()\n{\n    printf(\"Please enter how many numbers there are in total.\\n\");\n    scanf(\"%d\",&amp;a);\n    int sorting[a];\n    ^^^^^^^^^^^^^^^ \n    control=a-1;\n    print=a;\n    printf(\"Please start entering your numbers.\\n\");\n    for(;print&gt;0;print--)\n    {\n         scanf(\"%d\",&amp;sorting[print-1]);\n    }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5940189"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 35456175, "answer_count": 2, "score": -4, "last_activity_date": 1455711795, "creation_date": 1455710129, "question_id": 35456032, "link": "https://stackoverflow.com/questions/35456032/code-to-fill-in-array-suddenly-changes-variable-c", "title": "Code to fill in array suddenly changes variable (C)", "body": "<p>I'm at the very beginning of learning to code, and have come up with the following problem that's left me scratching my head. at the second last input of the 'for' loop, 'control' suddenly becomes that input (tested by inserting a printf) any idea why, and what to do to avoid it (other than abandoning scanf) </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint sorting[], control,place, a,b,print;\nint main()\n{\n    printf(\"Please enter how many numbers there are in total.\\n\");\n    scanf(\"%d\",&amp;a);\n    sorting[a];\n    control=a-1;\n    print=a;\n    printf(\"Please start entering your numbers.\\n\");\n    for(;print&gt;0;print--)\n    {\n         scanf(\"%d\",&amp;sorting[print-1]);\n    }\n</code></pre>\n\n<p>P.s. I know I've got an extra variable (print) when 'a' would do fine- I re-wrote that to see if the 'control=a' was somehow causing the problems. </p>\n"}, {"tags": ["c", "module", "kernel", "scheduled-tasks", "interrupt"], "comments": [{"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1455717155, "post_id": 35455938, "comment_id": 58613400, "body": "<code>GFP_KERNEL</code> within interrupt handler? Really? Almost every manual about Linux kernel programming tells that this is prohibited. You need to use <code>GFP_ATOMIC</code> and be ready to allocation failures."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5939974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72808b3e1a0bd1fff6944f082034fd61?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar A.", "link": "https://stackoverflow.com/users/5939974/oscar-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1455789361, "creation_date": 1455789361, "answer_id": 35478145, "question_id": 35455938, "link": "https://stackoverflow.com/questions/35455938/work-queues-and-interrupts-failed/35478145#35478145", "title": "Work queues and Interrupts failed", "body": "<p>Thanks for your help, Tsyvarev, I miss that (<strong>GFP_ATOMIC</strong>).. But after 100000 interrupts something continue wrong. I deleted everything inside the interrupt and the problem continues, the only thing that could be wrong is the return value, and indeed, it was, I never return IRQ_HANDLED. That was the problem.</p>\n"}], "owner": {"reputation": 11, "user_id": 5939974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72808b3e1a0bd1fff6944f082034fd61?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar A.", "link": "https://stackoverflow.com/users/5939974/oscar-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 35478145, "answer_count": 1, "score": 1, "last_activity_date": 1455789361, "creation_date": 1455709865, "question_id": 35455938, "link": "https://stackoverflow.com/questions/35455938/work-queues-and-interrupts-failed", "title": "Work queues and Interrupts failed", "body": "<p>Basically what I'm trying to do is to add a WorkQueue every interrupt, but after exactly 100001 interrupts, the systemm fails and the interrupt doesn't work anymore \"irq 63: nobody cared (try booting with the \"irqpoll\" option)\".</p>\n\n<p>This is my code:</p>\n\n<p>Inside.h file:</p>\n\n<pre><code>typedef struct    work_struct     GFA_DMA_QUEUE_Work_Struct_t;\n\ntypedef struct\n{\n  uint32_t      dma_length;\n  uint8_t  *    dma_page_pointer;\n} GFA_DMA_QUEUE_Work_Data_t;\n\ntypedef struct\n{\n  GFA_DMA_QUEUE_Work_Struct_t       Work;         \n  GFA_DMA_QUEUE_Work_Data_t         Data;\n  GFA_DMA_QUEUE_Work_t;\n}\n</code></pre>\n\n<p>Inside .c file:</p>\n\n<pre><code>static    struct  workqueue_struct *   GFA_DMA_QUEUE_workqueue;\nGFA_DMA_QUEUE_Work_t *      dma_queue_work;\n\ncreate_task( dma_page_pointer,dma_length)\n{\n//.....\ndma_queue_work = (GFA_DMA_QUEUE_Work_t *) kmalloc( sizeof(GFA_DMA_QUEUE_Work_t), __GFP_NOFAIL | GFP_KERNEL );\ndma_queue_work-&gt;Data.dma_length = dma_length;\ndma_queue_work-&gt;Data.dma_page_pointer = dma_page_pointer;\nINIT_WORK ( (GFA_DMA_QUEUE_Work_Struct_t *)dma_queue_work, GFA_DMA_QUEUE_queue_handler);\nretVal = queue_work (GFA_DMA_QUEUE_workqueue, (GFA_DMA_QUEUE_Work_Struct_t * )dma_queue_work);\n}\n\nstatic   void   GFA_DMA_QUEUE_queue_handler( GFA_DMA_QUEUE_Work_Struct_t *  Dma_Queue_Work )\n{\n  //.....\n  kfree( dma_queue_work );\n}\n</code></pre>\n\n<p>Inside the interrupt:</p>\n\n<p>I just call create_tasks() function with the right parameters.</p>\n\n<p>And after 100001 interrupts, I got \"irq 63: nobody cared (try booting with the \"irqpoll\" option)\". The system was working as it should be. </p>\n\n<p>The time that the interrupt needs to create the task in about 6uSecs, so is not a problem.</p>\n\n<p>I unmount the module and mount again and everytime that the interruption arrives to 100001 failed. </p>\n\n<p>Could be a memory leak? Is the a way to check memory leaks in the kernel module?</p>\n\n<p>Do you have and idea that it could be happening?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["c", "linux", "fork"], "comments": [{"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1455710046, "post_id": 35455766, "comment_id": 58608351, "body": "recursion? it&#39;s hard to tell what your question is."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5927852, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d44bf13e383f9785dd0a0854cc041e44?s=128&d=identicon&r=PG&f=1", "display_name": "Kebtiz", "link": "https://stackoverflow.com/users/5927852/kebtiz"}, "edited": false, "score": 0, "creation_date": 1455743136, "post_id": 35456009, "comment_id": 58631008, "body": "Okay, I will try working at it from there, thank you."}], "tags": [], "owner": {"reputation": 2244, "user_id": 5520680, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/C1jQH.png?s=128&g=1", "display_name": "Tom&#39;s", "link": "https://stackoverflow.com/users/5520680/toms"}, "is_accepted": false, "score": 1, "last_activity_date": 1455710056, "creation_date": 1455710056, "answer_id": 35456009, "question_id": 35455766, "link": "https://stackoverflow.com/questions/35455766/how-to-execute-system-commands-in-specific-order-with-fork/35456009#35456009", "title": "How to execute system commands in specific order with fork", "body": "<p>Without the code or the binary tree, I only can guess.</p>\n\n<p>If I was you, I search onto the binary tree in order to find system command.\nEach time I find a command, I fork() and [execve in the child] + [waitpid in the father].</p>\n\n<p>If you search in your binary tree the right order, then your system command will be executed with the rigth order too.</p>\n\n<p>Does this look good for you ?</p>\n"}], "owner": {"reputation": 63, "user_id": 5927852, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/d44bf13e383f9785dd0a0854cc041e44?s=128&d=identicon&r=PG&f=1", "display_name": "Kebtiz", "link": "https://stackoverflow.com/users/5927852/kebtiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1455710621, "creation_date": 1455709441, "last_edit_date": 1455710015, "question_id": 35455766, "link": "https://stackoverflow.com/questions/35455766/how-to-execute-system-commands-in-specific-order-with-fork", "title": "How to execute system commands in specific order with fork", "body": "<p>I have an array containing, among other things, a series of system commands that i need to execute in a specific order and wait after until each one is completed before moving onto the next, the order is determined from leaves to root of a binary tree.  I have been reading about this for days and experimenting for many hours and still don't have a semi workable scrap of code.</p>\n\n<ol>\n<li><p>I don't understand how to create multiple children that can create more children and/or execute a command.  </p></li>\n<li><p>I also don't understand how I pass information into children.  </p></li>\n<li><p>It doesn't have to use fork(), I just need help getting a tree with execution priority at the leaves started.</p></li>\n</ol>\n\n<p>All of my data is stored in a 3 dimensional array, with the execution strings I need to run being stored in acquire[i][1] for 7>=i>=0</p>\n"}, {"tags": ["c", "pointers", "go", "unsafe", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1455709831, "creation_date": 1455709831, "answer_id": 35455921, "question_id": 35455702, "link": "https://stackoverflow.com/questions/35455702/getting-double-free-or-corruption-out-when-using-free-in-cgo-golang/35455921#35455921", "title": "Getting double free or corruption (out) when using free in cgo, golang", "body": "<p>From <a href=\"https://golang.org/cmd/cgo/#hdr-Go_references_to_C\" rel=\"nofollow\">https://golang.org/cmd/cgo/#hdr-Go_references_to_C</a> :</p>\n\n<pre><code>// Go string to C string\n// The C string is allocated in the C heap using malloc.\n// It is the caller's responsibility to arrange for it to be\n// freed, such as by calling C.free (be sure to include stdlib.h\n// if C.free is needed).\nfunc C.CString(string) *C.char\n</code></pre>\n\n<p>Your</p>\n\n<pre><code>path := C.CString(filename)\n</code></pre>\n\n<p>makes a copy and you have to free it while <code>statt</code> is a normal Go-memory-managed variable.</p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 915, "favorite_count": 0, "accepted_answer_id": 35455921, "answer_count": 1, "score": 1, "last_activity_date": 1455709831, "creation_date": 1455709255, "question_id": 35455702, "link": "https://stackoverflow.com/questions/35455702/getting-double-free-or-corruption-out-when-using-free-in-cgo-golang", "title": "Getting double free or corruption (out) when using free in cgo, golang", "body": "<p>I am trying to understand and learn cgo, and as a part of that, I wrote a function that checks for filepermission using <code>C.stat</code>. </p>\n\n<pre><code>import (\n    \"fmt\"\n    \"unsafe\"\n    \"os\"\n)\n//#include &lt;sys/stat.h&gt;\n//#include &lt;stdlib.h&gt;\nimport \"C\"\n\nfunc CheckPerm(filename string) {\n\n    statt := C.stat //stat struct from C\n    path := C.CString(filename)\n    st := *(*C.struct_stat)(unsafe.Pointer(statt)) //Casting unsafe pointer to C.struct_stat\n    defer C.free(unsafe.Pointer(path)) //free\n    defer C.free(unsafe.Pointer(statt))\n    C.stat(path, &amp;st)\n    if st.st_mode &amp; C.S_IRGRP &gt; 0 || st.st_mode &amp; C.S_IWGRP &gt; 0 || st.st_mode &amp; C.S_IXGRP &gt; 0 || st.st_mode &amp; C.S_IROTH &gt; 0 || st.st_mode &amp; C.S_IWOTH &gt; 0 || st.st_mode &amp; C.S_IXOTH &gt; 0 {\n        fmt.Println(\"file permission too broad, make it non-readable to groups and others.\")\n        os.Exit(1)\n    }\n    fmt.Println(\"File permission looks fine\")\n</code></pre>\n\n<p>}</p>\n\n<p>Upon passing a filepath to the function, it errors out saying </p>\n\n<pre><code>*** Error in `/tmp/Build go-sync.go and run77go': double free or corruption (out): 0x0000000000609480 ***\nSIGABRT: abort\nPC=0x7fe4302f3267 m=0\nsignal arrived during cgo execution\n\ngoroutine 1 [syscall, locked to thread]:\nruntime.cgocall(0x401930, 0xc820097808, 0xc800000000)\n/usr/lib/go/src/runtime/cgocall.go:120 +0x11b fp=0xc8200977d8 sp=0xc8200977a8\ngosyncmodules._Cfunc_free(0x609480)\n==========snip============\n</code></pre>\n\n<p>Because of the last line pasted here <code>gosyncmodules._Cfunc_free(0x609480)</code>, I removed the <code>defer C.free(unsafe.Pointer(statt))</code> and it works fine now.</p>\n\n<ul>\n<li>Why is it throwing error when I am trying to free the struct that was created, whereas it can be used to free the path variable?</li>\n<li>Will a similar scenario cause a memory leak, if not in this case?</li>\n</ul>\n"}, {"tags": ["c", "struct", "typedef"], "comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1455709465, "post_id": 35455683, "comment_id": 58607945, "body": "You are aware that you name a formal parameter of your function like the typedef (<code>Reciever</code>)? I assume that it overrides the typedef which completely invalidates your declarations in the function."}, {"owner": {"reputation": 21412, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 1, "creation_date": 1455709500, "post_id": 35455683, "comment_id": 58607970, "body": "What are those parameters to your function? For example <code>struct Recievers Reciever</code> is saying the caller needs to pass in a <code>struct Reciever</code> (note that&#39;s not how you spell &quot;receiver&quot;!), but you never use it, and the fact that the parameter is called <code>Reciever</code> means the function can&#39;t see the <code>typedef</code>, also called <code>Reciever</code>, from the header file - this is what&#39;s causing your errors."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 4, "creation_date": 1455709615, "post_id": 35455683, "comment_id": 58608048, "body": "Also, defining (and filling) local structure objects in your function won&#39;t get you very far; the objects will disappear once the function is finished. Perhaps you want to fill global objects?"}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 1, "creation_date": 1455709738, "post_id": 35455683, "comment_id": 58608131, "body": "It will not solve your problem, but I am sure that there is a mistake in the code. I guess you want set the port of EACH LED, but you are always set LED1.port = GPIO. Seems like you forgot to change the number, dont you?"}, {"owner": {"reputation": 5304, "user_id": 2757035, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/fade5daafd5717576b33f2e08f4f9429?s=128&d=identicon&r=PG&f=1", "display_name": "underscore_d", "link": "https://stackoverflow.com/users/2757035/underscore-d"}, "edited": false, "score": 1, "creation_date": 1455709843, "post_id": 35455683, "comment_id": 58608199, "body": "Don&#39;t give variables names using the same case convention as objects. Pick a scheme for each and stick to it. I also don&#39;t know why C programmers typedef structs so often as it just provides further opportunities for confusion like this. (What am I missing?)"}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 0, "creation_date": 1455711716, "post_id": 35455683, "comment_id": 58609478, "body": "You got the same name twice in your struct: typedef struct &quot;Ultrasonic&quot;{     char port;     int pinNumber; }&quot;Ultrasonic&quot;;"}, {"owner": {"reputation": 13, "user_id": 5940004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38818833484b56533834f9b13dbf6f17?s=128&d=identicon&r=PG&f=1", "display_name": "anoyingorange", "link": "https://stackoverflow.com/users/5940004/anoyingorange"}, "edited": false, "score": 0, "creation_date": 1455712852, "post_id": 35455683, "comment_id": 58610322, "body": "First of all, thank you for all your answers, they solved the issue. I mistyped receiver, and i just copied it all the way. And as for xy36, that is just the bonus that you noticed I used LED1.port for all the structures."}], "answers": [{"tags": [], "owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "is_accepted": true, "score": 0, "last_activity_date": 1455711001, "last_edit_date": 1592644375, "creation_date": 1455711001, "answer_id": 35456345, "question_id": 35455683, "link": "https://stackoverflow.com/questions/35455683/how-to-use-structs-declared-in-the-header-and-defined-in-source-code-by-a-functi/35456345#35456345", "title": "How to use structs declared in the header and defined in source code by a function", "body": "<blockquote>\n<p>When I try to compile, it basically gives these errors for every struct I try to create:</p>\n<p>hw_init.c:8:5: warning: statement with no effect [-Wunused-value] Reciever  Reciever1;\nhw_init.c:8:14: error: expected ';' before 'Reciever1' Reciever Reciever1;</p>\n</blockquote>\n<p>You get the error message because you use the word <code>Reciever</code> for a typedef'd struct as well as the first function parameter:</p>\n<pre><code>void hardWareInit(struct Recievers Reciever, struct LEDs LED, struct    Ultrasonic Ultrasonic)\n</code></pre>\n<p>You should use a diffent designator for the first parameter.</p>\n<p>Further I suggest to name <code>reciever</code> to  <code>receiver</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 5940004, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38818833484b56533834f9b13dbf6f17?s=128&d=identicon&r=PG&f=1", "display_name": "anoyingorange", "link": "https://stackoverflow.com/users/5940004/anoyingorange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 35456345, "answer_count": 1, "score": 0, "last_activity_date": 1522917517, "creation_date": 1455709213, "last_edit_date": 1522917517, "question_id": 35455683, "link": "https://stackoverflow.com/questions/35455683/how-to-use-structs-declared-in-the-header-and-defined-in-source-code-by-a-functi", "title": "How to use structs declared in the header and defined in source code by a function", "body": "<p>I am trying to store the main features of my hardware configuration in one place, so I created structures for it. I declared them as <code>typedef</code> in a header file, and I want to create and define the actual structures in a function, that I can call when the application starts. (I am using an STM32F04 board with chibiOS running on it.)</p>\n\n<p>Here is the header file:</p>\n\n<pre><code>#ifndef HW_INIT_INCLUDED\n#define HW_INIT_INCLUDED\n\n#include &lt;mcuconf.h&gt;\n#include &lt;hal.h&gt;\n#include &lt;ch.h&gt;\n\nstruct Recievers;\nstruct LEDs;\nstruct Ultrasonic;\n\ntypedef struct Recievers{\n    int iD;\n    int port;\n    int pinNumber;\n} Reciever;\n\ntypedef struct LEDs{\n    int iD;\n    char port;\n    int pinNumber;\n    bool status;\n    float dutyCycleConstant;\n} LED;\n\ntypedef struct Ultrasonic{\n    char port;\n    int pinNumber;\n}Ultrasonic;\n\n\n/*\nInitaliases the values of hw parameters.\n*/\n\nvoid hardWareInit(struct Recievers Reciever, struct LEDs LED, struct Ultrasonic Ultrasonic);\n\n#endif // HW_INIT_INCLUDED\n</code></pre>\n\n<p>and here is the source code:</p>\n\n<pre><code>#include &lt;hw_init.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nvoid hardWareInit(struct Recievers Reciever, struct LEDs LED, struct    Ultrasonic Ultrasonic)\n{\n    Reciever Reciever1, Reciever2, Reciever3, Reciever4;\n    LED LED1, LED2, LED3;\n    Ultrasonic Ultrasonic1;\n\n    Reciever1.iD = 1;\n    Reciever1.port = GPIOF;\n    Reciever1.pinNumber = 1;\n\n    Reciever2.iD = 2;\n    Reciever2.port = GPIOG;\n    Reciever2.pinNumber = 1;\n\n    Reciever3.iD = 3;\n    Reciever3.port = GPIOI;\n    Reciever3.pinNumber = 1;\n\n    Reciever4.iD = 3;\n    Reciever4.port = GPIOE;\n    Reciever4.pinNumber = 1;\n\n    LED1.iD = 1;\n    LED1.port = GPIOD;\n    LED1.pinNumber = 16;\n    LED1.status = 0;\n    LED1.dutyCycleConstant = 0.3;\n\n    LED2.iD = 2;\n    LED1.port = GPIOD;\n    LED2.pinNumber = 16;\n    LED2.status = 0;\n    LED2.dutyCycleConstant = 0.3;\n\n    LED3.iD = 3;\n    LED1.port = GPIOD;\n    LED3.pinNumber = 16;\n    LED3.status = 0;\n    LED3.dutyCycleConstant = 0.3;\n\n    Ultrasonic1.port = GPIOC;\n    Ultrasonic1.pinNumber = 1;\n}\n</code></pre>\n\n<p>When I try to compile, it basically gives these errors for every struct I try to create:</p>\n\n<p>hw_init.c:8:5: warning: statement with no effect [-Wunused-value]\n     Reciever Reciever1;\n     ^\nhw_init.c:8:14: error: expected ';' before 'Reciever1'\n     Reciever Reciever1;</p>\n"}, {"tags": ["c", "linux"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1455708672, "post_id": 35455372, "comment_id": 58607402, "body": "Please take some time to <b><i>re-read</i></b> <a href=\"http://stackoverflow.com/help\">the help pages</a>, especially the sections named <a href=\"http://stackoverflow.com/help/on-topic\">&quot;What topics can I ask about here?&quot;</a> and <a href=\"http://stackoverflow.com/help/dont-ask\">&quot;What types of questions should I avoid asking?&quot;</a>. Especially re-read <a href=\"http://stackoverflow.com/help/how-to-ask\">about how to ask good questions</a>.and how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>."}, {"owner": {"reputation": 307, "user_id": 4526289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Hoou.jpg?s=128&g=1", "display_name": "liam_g", "link": "https://stackoverflow.com/users/4526289/liam-g"}, "edited": false, "score": 0, "creation_date": 1455709608, "post_id": 35455372, "comment_id": 58608038, "body": "Souunds like a homework assignment, have you attempted this at all? Post your current code and explain where you are stuck."}, {"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "reply_to_user": {"reputation": 307, "user_id": 4526289, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Hoou.jpg?s=128&g=1", "display_name": "liam_g", "link": "https://stackoverflow.com/users/4526289/liam-g"}, "edited": false, "score": 0, "creation_date": 1455711453, "post_id": 35455372, "comment_id": 58609301, "body": "Hello, @liam_g. Thanks for your answers. I&#39;ve added the code i&#39;m trying to make work. Thanks."}, {"owner": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455713644, "post_id": 35455372, "comment_id": 58610883, "body": "Smells like homework."}, {"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455714488, "post_id": 35455372, "comment_id": 58611495, "body": "Yes, @Ashish Ahuja. It&#39;s homework and i&#39;m stacked with that."}, {"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "reply_to_user": {"reputation": 4778, "user_id": 4688119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ajaGK.png?s=128&g=1", "display_name": "Ashish Ahuja", "link": "https://stackoverflow.com/users/4688119/ashish-ahuja"}, "edited": false, "score": 0, "creation_date": 1455715020, "post_id": 35455372, "comment_id": 58611897, "body": "@Ashish Ahuja, but i&#39;m not asking to solve my homework, i&#39;m asking to help me deal with specific problem. Code is present. Problem described."}, {"owner": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "edited": false, "score": 0, "creation_date": 1455722169, "post_id": 35455372, "comment_id": 58617329, "body": "Not sure why so many downvotes, it&#39;s a legitimate question, how to check if you are at the root directory."}, {"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "reply_to_user": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "edited": false, "score": 0, "creation_date": 1455723808, "post_id": 35455372, "comment_id": 58618634, "body": "Hello, @Sam Watkins. It&#39;s simple. At beginning I just added what I need to realize without code present. And collected some downvotes before added problem code))"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "edited": false, "score": 1, "creation_date": 1455714202, "post_id": 35456729, "comment_id": 58611275, "body": "Thanks for your answer @mati865. But my code list files in current directory and changes to parent directory too. And so on. It work as I expect, but I can&#39;t check if current directory is root, and get eternal loop(( Thanks."}], "tags": [], "owner": {"reputation": 301, "user_id": 5940067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d99e3b44ac2a56fea9733fce9b3cee89?s=128&d=identicon&r=PG&f=1", "display_name": "mati865", "link": "https://stackoverflow.com/users/5940067/mati865"}, "is_accepted": false, "score": 0, "last_activity_date": 1455713010, "last_edit_date": 1455713010, "creation_date": 1455712049, "answer_id": 35456729, "question_id": 35455372, "link": "https://stackoverflow.com/questions/35455372/c-list-all-files-in-current-directory-then-move-in-directory-above-list-files/35456729#35456729", "title": "C - list all files in current directory then move in directory above, list files, and so on until root directory is reached", "body": "<p>You aren't listing directory content. To do it use:</p>\n\n<pre><code>system(\"ls\");      //show files in current directory that doesn't begin with \".\"\nsystem(\"ls -a\");   //show all files in current directory\n</code></pre>\n\n<p>Simple code that lists current and parent </p>\n\n<pre><code>system(\"ls\");\nchdir(\"./..\");\nsystem(\"ls\");\n</code></pre>\n\n<p>And it's output</p>\n\n<pre><code>$ Debug/lf.o\nlist_files.c                   //current directory\nDebug  src  test_file.txt      //parent directory\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "is_accepted": false, "score": 1, "last_activity_date": 1455719306, "creation_date": 1455719306, "answer_id": 35459435, "question_id": 35455372, "link": "https://stackoverflow.com/questions/35455372/c-list-all-files-in-current-directory-then-move-in-directory-above-list-files/35459435#35459435", "title": "C - list all files in current directory then move in directory above, list files, and so on until root directory is reached", "body": "<p>Here is the solution, maybe not elegant, but working - check if</p>\n\n<pre><code>(int)cwd[1] != 0\n</code></pre>\n\n<p>int value of second element of <strong>cwd</strong> array is <strong>0</strong>. It means the directory is \"/\" - parent and stops.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nint main(void)\n{\n  DIR *d;\n  char cwd[1024];\n  struct dirent *dir;\n  do {\n      d = opendir(\".\");\n       if (getcwd(cwd, sizeof(cwd)) != NULL)\n           fprintf(stdout, \"Current working dir: %s\\n\", cwd);\n       else\n           perror(\"getcwd() error\");\n      if (d)\n      {\n        while ((dir = readdir(d)) != NULL)\n        {\n          if (dir-&gt;d_type == DT_REG)\n          {\n            printf(\"%s\\n\", dir-&gt;d_name);\n          }\n        }\n        chdir(\"..\");\n        closedir(d);\n      }\n  }while ((int)cwd[1] != 0);\n  return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "edited": false, "score": 1, "creation_date": 1455724085, "post_id": 35460577, "comment_id": 58618878, "body": "Thanks you, @Sam Watkins. So much additional options. Need to try it to remember and improve my skills. Thanks you again. Have a nice day."}], "tags": [], "owner": {"reputation": 6383, "user_id": 218294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ecbae898b5088d092feea0f82ae5ffb?s=128&d=identicon&r=PG", "display_name": "Sam Watkins", "link": "https://stackoverflow.com/users/218294/sam-watkins"}, "is_accepted": true, "score": 1, "last_activity_date": 1455722767, "last_edit_date": 1455722767, "creation_date": 1455722126, "answer_id": 35460577, "question_id": 35455372, "link": "https://stackoverflow.com/questions/35455372/c-list-all-files-in-current-directory-then-move-in-directory-above-list-files/35460577#35460577", "title": "C - list all files in current directory then move in directory above, list files, and so on until root directory is reached", "body": "<p>Your <code>cwd[1] != 0</code> or <code>cwd[1] != '\\0'</code> is an okay way to do it.  There's no need to cast that to an int.</p>\n\n<p>You could also use <code>strcmp(cwd, \"/\")</code>, which makes it slightly more clear what you are doing.  This will be zero at the root directory on a UNIX or Linux system.</p>\n\n<p>For a more portable solution, you can compare the current directory name with the previous directory name, something like this:</p>\n\n<pre><code>char cwd[1024];\nchar parent[1024];\ngetcwd(cwd, sizeof(cwd));\n</code></pre>\n\n<p>and inside the loop:</p>\n\n<pre><code>        chdir(\"..\");\n        getcwd(parent, sizeof(parent));\n        if (strcmp(cwd, parent) == 0)\n                break;\n        strcpy(cwd, parent);\n</code></pre>\n\n<p>On a POSIX system, you can check if the current directory is the root without using <code>getcwd()</code>, using code like this:</p>\n\n<pre><code>int cwd_is_root(void)\n{\n        struct stat cwd, parent;\n        if (stat(\".\", &amp;cwd) &lt; 0)\n                return -1;\n        if (stat(\"..\", &amp;parent) &lt; 0)\n                return -1;\n        return cwd.st_ino == parent.st_ino &amp;&amp; cwd.st_dev == parent.st_dev;\n}\n</code></pre>\n\n<p>It is simpler and better just to use <code>getcwd</code> as you did, unless you are writing your own libc!  <code>getcwd</code> is a system call on Linux.</p>\n"}], "owner": {"reputation": 145, "user_id": 2700985, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/TFS4B.jpg?s=128&g=1", "display_name": "fapw", "link": "https://stackoverflow.com/users/2700985/fapw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1123, "favorite_count": 0, "closed_date": 1455746727, "accepted_answer_id": 35460577, "answer_count": 3, "score": -6, "last_activity_date": 1455722767, "creation_date": 1455708350, "last_edit_date": 1455714284, "question_id": 35455372, "link": "https://stackoverflow.com/questions/35455372/c-list-all-files-in-current-directory-then-move-in-directory-above-list-files", "closed_reason": "Needs more focus", "title": "C - list all files in current directory then move in directory above, list files, and so on until root directory is reached", "body": "<p>Could you help me please to develop a program in C that scans the current directory and\ndisplays the names of all files that are located there\nwith extensions. Then program goes to\nparent directory, which then becomes current, and these\nabove steps are repeated until the current directory is not\nbecome root directory.\nThanks. \nHave a nice day.</p>\n\n<p>P.S. Sorry. Here is the code i'm trying to make work. It lists all files from current directory, but do not go to parent directory.\nP.S.S My code lists files in current directory and changes to parent directory too. And so on. It work as I expect, but I can't check if current directory is root, and get eternal loop. Thanks.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;errno.h&gt;\n\nint main(void)\n{\n  DIR *d;\n  char cwd[1024];\n  struct dirent *dir;\n  do {\n      d = opendir(\".\");\n       if (getcwd(cwd, sizeof(cwd)) != NULL)\n           fprintf(stdout, \"Current working dir: %s\\n\", cwd);\n       else\n           perror(\"getcwd() error\");\n      if (d)\n      {\n        while ((dir = readdir(d)) != NULL)\n        {\n          if (dir-&gt;d_type == DT_REG)\n          {\n            printf(\"%s\\n\", dir-&gt;d_name);\n          }\n        }\n        chdir(\"..\");\n        closedir(d);\n      }\n  // Do not know how to check if current directory is root\n  // and getting eternal loop \n  }while (cwd != \"/\");\n  return 0;\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>Current working dir: /\nCurrent working dir: /\n......................\nCurrent working dir: /\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 2, "creation_date": 1455707951, "post_id": 35455154, "comment_id": 58606882, "body": "use <code>for(j=i;j&lt;i+step;j++)</code> instead of <code>for(j=1;j&lt;=step;j++)</code> as j should start from the value of i and it should run upto current value i.e + number of step. but first for loop you need to run upto <code>&lt;=stair-step</code>"}, {"owner": {"reputation": 456, "user_id": 5276705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e8bd54c7b2823d28abc6dbee63f3e0b?s=128&d=identicon&r=PG", "display_name": "SKD", "link": "https://stackoverflow.com/users/5276705/skd"}, "edited": false, "score": 4, "creation_date": 1455708030, "post_id": 35455154, "comment_id": 58606921, "body": "What error/output you are getting?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5940084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RPy7eo_JIsM/AAAAAAAAAAI/AAAAAAAAABs/UlVuA15b7Og/photo.jpg?sz=128", "display_name": "asparkhour", "link": "https://stackoverflow.com/users/5940084/asparkhour"}, "edited": false, "score": 0, "creation_date": 1455708700, "post_id": 35455403, "comment_id": 58607426, "body": "Imagine you are exercising. So for every 4 steps you climb say S1 to S4 out of S10 you come back to S1+ 1 i.e S2. And S2 you climb 4 steps. i.e S2 - S3 - S4 -S5 then you come back to S2+1 i.e S3 and climb 4 steps again and so on until you reach S10"}], "tags": [], "owner": {"reputation": 722, "user_id": 5639126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cc61c3859ba7951cec0dcc05612aef5?s=128&d=identicon&r=PG&f=1", "display_name": "secret squirrel", "link": "https://stackoverflow.com/users/5639126/secret-squirrel"}, "is_accepted": false, "score": -1, "last_activity_date": 1455708419, "creation_date": 1455708419, "answer_id": 35455403, "question_id": 35455154, "link": "https://stackoverflow.com/questions/35455154/c-program-for-steps-and-stairs/35455403#35455403", "title": "C program for steps and stairs", "body": "<p>Not sure what you actually mean, but if you want to go up the stairs with the number of steps then you need to change the increment value in your for loop:</p>\n\n<pre><code>for(j=1;j&lt;=step;j+=step)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1455709824, "last_edit_date": 1455709824, "creation_date": 1455708686, "answer_id": 35455500, "question_id": 35455154, "link": "https://stackoverflow.com/questions/35455154/c-program-for-steps-and-stairs/35455500#35455500", "title": "C program for steps and stairs", "body": "<pre><code>#include&lt;stdio.h&gt;\nint main()\n{\n    int i,j,stair,step;\n    stair=10;\n    step=3;\n    for(i=0;i&lt;=stair-step+1;i++)// here we are decreasing step bcz we are ruuning loop for extra steps in next for loop\n    {\n        for(j=i;j&lt;i+step;j++)\n        {    \n            printf(\"\\nJ:::%d\",j);    \n        }    \n        printf(\"\\tI:::%d\",i);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As we now there is pattern.<br>\n0-1-2<br>\n1-2-3<br>\n2-3-4<br>\n3-4-5<br>\nits a common series 0,1,2,3... in evrey row</p>\n\n<p>As every row starts with +1 of the previous row starts that is value of i.<br>\nso we will start <code>j=i</code> in every loop as i will run 0,1,2,3...</p>\n\n<p>And next we need to run upto the value of step so we will write <code>j&lt;i+step</code><br>\nso that it wiil run upto current value of i + number of steps.<br>\nfor suppose i=0;<br>\nstep=3  </p>\n\n<pre><code>for(j=i;j&lt;i+step;j++)\n</code></pre>\n\n<p>j=0 initial value j&lt;0+3 means loop will run from 0 to 2</p>\n\n<pre><code>i=1 =&gt;loop will run from j=1 to j&lt;1+3  Output 1,2,3  \ni=2 =&gt;loop will run from j=2 to j&lt;2+3  Output 2,3,4  \ni=3 =&gt;loop will run from j=3 to j&lt;3+3  Output 3,4,5\n...\n..\n..\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5940084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RPy7eo_JIsM/AAAAAAAAAAI/AAAAAAAAABs/UlVuA15b7Og/photo.jpg?sz=128", "display_name": "asparkhour", "link": "https://stackoverflow.com/users/5940084/asparkhour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1646, "favorite_count": 0, "accepted_answer_id": 35455500, "answer_count": 2, "score": 0, "last_activity_date": 1455709824, "creation_date": 1455707789, "last_edit_date": 1455709801, "question_id": 35455154, "link": "https://stackoverflow.com/questions/35455154/c-program-for-steps-and-stairs", "title": "C program for steps and stairs", "body": "<p>So I am writing a program where we take input on total number of stairs and number of steps in one go. So for example.</p>\n\n<p>Lets say </p>\n\n<pre><code>stairs=10;\nsteps=3;\n</code></pre>\n\n<p>So starting from zero. It goes. 0-1-2. Then Goes back to 1 and goes 1-2-3, 2-3-4, 3-4-5, 4-5-6 and so on till 8-9-10.<br>\nI wrote code for it. But something is missing. Here it is:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    int i,j,stair,step;\n    stair=10;\n    step=3;\n\n    for(i=0;i&lt;=stair;i++)\n    {\n        for(j=1;j&lt;=step;j++)\n        {\n            printf(\"\\nJ:::%d\",j);\n        }    \n       printf(\"\\tI:::%d\",i);\n    }\n}\n</code></pre>\n\n<p>Instead of giving just code. Can someone help me with logic ?\nThanks a lot in advance. </p>\n"}, {"tags": ["c", "memory-management", "malloc", "sizeof", "realloc"], "answers": [{"comments": [{"owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1455708175, "post_id": 35455182, "comment_id": 58607020, "body": "Alright, this made it so much clearer. How would I go about to print out how much memory I have allocated then?"}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1455708291, "post_id": 35455182, "comment_id": 58607118, "body": "@FelixRos&#233;n you cannot, see my update. Good question btw, I had the same when I was learning C, +1."}, {"owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "reply_to_user": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "edited": false, "score": 0, "creation_date": 1455708436, "post_id": 35455182, "comment_id": 58607235, "body": "C and memory management at its best @FelixRos&#233;n! You will learn <i>a lot</i>, trust me! Glad I helped. :)"}], "tags": [], "owner": {"reputation": 66610, "user_id": 2411320, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5kF5N.jpg?s=128&g=1", "display_name": "gsamaras", "link": "https://stackoverflow.com/users/2411320/gsamaras"}, "is_accepted": true, "score": 3, "last_activity_date": 1455710999, "last_edit_date": 1455710999, "creation_date": 1455707869, "answer_id": 35455182, "question_id": 35455127, "link": "https://stackoverflow.com/questions/35455127/how-does-realloc-work-regarding-increasing-size-of-memory-blocks/35455182#35455182", "title": "How does realloc work regarding increasing size of memory blocks?", "body": "<p>Q: Am I misunderstanding how realloc works? </p>\n\n<p>A: <em>No</em>, but you are misunderstanding what you are printing!</p>\n\n<hr>\n\n<p><strong>You are printing the size of the <em>pointer</em>.</strong></p>\n\n<blockquote>\n  <p>So, for a 32bit computer, the pointer size can be 4 bytes; 64bit computers can have 8 bytes. Or, a 64bit computer running a 32bit OS will have 4 bytes. Still, under a specific architecture, all types of pointers (void*, int*, char*, long* etc) will have same size (except function pointers).</p>\n</blockquote>\n\n<p>Check this example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void) {\n        char* buf1 = malloc(sizeof(char));\n        printf(\"buf1 = %zu\\n\", sizeof(buf1));\n        char* buf2 = malloc(1000 * sizeof(char));\n        printf(\"buf2 = %zu\\n\", sizeof(buf2));\n        return 0;\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>gsamaras@gsamaras:~/Desktop$ ./a.out \nbuf1 = 8\nbuf2 = 8\n</code></pre>\n\n<hr>\n\n<p>You can't print how much memory you have allocated. It's the <em>programmer's responsibility</em> to keep track of the memory (s)he has allocated, by keeping an extra variable, <code>size</code> in your example.</p>\n"}, {"tags": [], "owner": {"reputation": 30739, "user_id": 186193, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/df61dcc6eec08cb7d62f1959b89ae843?s=128&d=identicon&r=PG", "display_name": "Ferenc Deak", "link": "https://stackoverflow.com/users/186193/ferenc-deak"}, "is_accepted": false, "score": 2, "last_activity_date": 1455707875, "creation_date": 1455707875, "answer_id": 35455186, "question_id": 35455127, "link": "https://stackoverflow.com/questions/35455127/how-does-realloc-work-regarding-increasing-size-of-memory-blocks/35455186#35455186", "title": "How does realloc work regarding increasing size of memory blocks?", "body": "<p>You are not misunderstanding <code>realloc</code>. You are misunderstanding <code>sizeof</code>.</p>\n\n<p><code>sizeof(buffer)</code> is the size of the pointer (which for you it seems to be 8), not the size of the buffer it points to. Yo will have to track the allocated size for yourself.</p>\n"}], "owner": {"reputation": 1385, "user_id": 4464551, "user_type": "registered", "accept_rate": 52, "profile_image": "https://graph.facebook.com/10206253300199979/picture?type=large", "display_name": "Felix Ros&#233;n", "link": "https://stackoverflow.com/users/4464551/felix-ros%c3%a9n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 35455182, "answer_count": 2, "score": 0, "last_activity_date": 1455710999, "creation_date": 1455707721, "last_edit_date": 1455708649, "question_id": 35455127, "link": "https://stackoverflow.com/questions/35455127/how-does-realloc-work-regarding-increasing-size-of-memory-blocks", "title": "How does realloc work regarding increasing size of memory blocks?", "body": "<p>So how (and if) does realloc increase the memory pointed to in this loop.</p>\n\n<pre><code>char* buffer = malloc(sizeof(char));\nssize_t size = 0;\n\nwhile(true)\n{   \n    //increment size;\n    size++;\n\n    // increment buffer_inc memory size by size (one byte at a time)\n    buffer = realloc(buffer, size);\n    ......\n</code></pre>\n\n<p>When I run this, I get that my inital <code>sizeof(buffer)</code> is <code>8</code> and after the loop, my size is still <code>8</code> shouldnt it be <code>9</code>? </p>\n\n<p>What's weird is that even if I do <code>buffer = realloc(buffer, size + sizeof(char);</code> I still get that my value on <code>sizeof(buffer)</code> (after the loop) is <code>8</code> am I missing something regarding how realloc works? In my understanding it allocated more memory, in the amount of <code>size_t size</code>(passed as the second argument) for the memory passed in <code>void* ptr</code> (as the first argument).</p>\n\n<p>Am I misunderstanding how realloc works? </p>\n"}, {"tags": ["c", "pointers", "fopen"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455706931, "post_id": 35454647, "comment_id": 58606142, "body": "<code>f</code> is invalid after closing it. So using it in any other function after that is Undefined Behaviour. UB means that it may work but it may also crash, or write to some other file, or continue silently, or any other undefined action."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455707100, "post_id": 35454647, "comment_id": 58606261, "body": "Is <code>fputc(otpCipher[j], f);</code> writing to <code>Solution.jpg</code> ? I don&#39;t think so..."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 3, "creation_date": 1455707213, "post_id": 35454647, "comment_id": 58606336, "body": "@LPs I think it does in the OP&#39;s case. Because <code>fopen(&quot;Solution.jpg&quot;, &quot;w&quot;);</code> just happens to reuse the same memory for that <code>FILE</code> as the pointer <code>f</code> already references. So the pointer in <code>f</code> as used for that <code>fputc</code> is valid by chance."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455711635, "post_id": 35454647, "comment_id": 58609416, "body": "You say it&#39;s &quot;working&quot; only because it happens to do what you happen to want. If you had wanted it to do something else, it wouldn&#39;t be working. It is doing something you did not tell it to do, so I wouldn&#39;t say it&#39;s working."}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 4, "creation_date": 1455707531, "post_id": 35454818, "comment_id": 58606570, "body": "You correctly diagnosed the actual behavior, but be aware that it is in no way condoned by the C Standard.  It is undefined behavior to use <code>f</code> after calling <code>fclose(f)</code>. Call it a small miracle that <code>fopen()</code> returns the same pointer, certainly do not rely on it.  Also note that you should should also check the return values of <code>fopen</code> and <code>fread</code>."}, {"owner": {"reputation": 143, "user_id": 4071573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cffafd3bd704e5c07c6acd81c94b77f?s=128&d=identicon&r=PG&f=1", "display_name": "johnson262", "link": "https://stackoverflow.com/users/4071573/johnson262"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1455712159, "post_id": 35454818, "comment_id": 58609806, "body": "Thank you, I know this is a bad thing. So I added this to my answer for the sake of clarity."}, {"owner": {"reputation": 2149, "user_id": 2096401, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVjii.jpg?s=128&g=1", "display_name": "TripeHound", "link": "https://stackoverflow.com/users/2096401/tripehound"}, "edited": false, "score": 4, "creation_date": 1455713162, "post_id": 35454818, "comment_id": 58610528, "body": "+1 for both exploring the problem yourself using gdb and realising / accepting that &quot;it happens to work&quot; is not a good state to be in."}], "tags": [], "owner": {"reputation": 143, "user_id": 4071573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cffafd3bd704e5c07c6acd81c94b77f?s=128&d=identicon&r=PG&f=1", "display_name": "johnson262", "link": "https://stackoverflow.com/users/4071573/johnson262"}, "is_accepted": true, "score": 6, "last_activity_date": 1455712436, "last_edit_date": 1455712436, "creation_date": 1455706901, "answer_id": 35454818, "question_id": 35454647, "link": "https://stackoverflow.com/questions/35454647/why-does-fopen-works-without-saving-the-returned-pointer/35454818#35454818", "title": "Why does fopen works without saving the returned pointer?", "body": "<p>I just found the answer using gdb.</p>\n\n<p>So since I'm using <code>fclose()</code> before opening the new file, the pointer to the file used before were freed. This pointer could be used again and <code>fopen()</code> returned this pointer every time I ran this program.</p>\n\n<p>So it worked just because there were no other file opened at the time I called <code>fopen()</code>.</p>\n\n<p>This is undefined behavior and which can lead to other problems. It should be avoided in all circumstances (I did it by mistake). I just wanted to understand why this was working and fixed my code.</p>\n"}], "owner": {"reputation": 143, "user_id": 4071573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cffafd3bd704e5c07c6acd81c94b77f?s=128&d=identicon&r=PG&f=1", "display_name": "johnson262", "link": "https://stackoverflow.com/users/4071573/johnson262"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 35454818, "answer_count": 1, "score": 8, "last_activity_date": 1455712436, "creation_date": 1455706478, "last_edit_date": 1455707668, "question_id": 35454647, "link": "https://stackoverflow.com/questions/35454647/why-does-fopen-works-without-saving-the-returned-pointer", "title": "Why does fopen works without saving the returned pointer?", "body": "<p>I wrote a little program to decrypt an, OTP encrypted, file. This works just fine. </p>\n\n<p>But I realized that I forgot to save the returned file pointer when calling fopen on \"Solution.jpg\". As you can see, I am writing to the file pointer f. I am wondering why this code is working.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define FILE_SIZE 4202\n\nint main () {\n    unsigned char key[FILE_SIZE], otpCipher[FILE_SIZE];\n\n    FILE *f = fopen(\"otpkey.bin\", \"r\");\n    fread(key, sizeof(char), FILE_SIZE, f);\n    fclose(f);\n\n    f = fopen(\"otpcipher.bin\", \"r\");\n    fread(otpCipher, sizeof(char), FILE_SIZE, f);\n    fclose(f);\n\n    fopen(\"Solution.jpg\", \"w\");\n\n    for (int j = 0; j &lt; FILE_SIZE; ++j) {\n        otpCipher[j] = otpCipher[j] ^ key[j];\n        fputc(otpCipher[j], f);\n    }\n\n    fclose(f);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "profiling", "cross-compiling", "intel-pin"], "comments": [{"owner": {"reputation": 1701, "user_id": 1132699, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f17e6c9aef8844da2d32fa1367ea5f5d?s=128&d=identicon&r=PG", "display_name": "nitzanms", "link": "https://stackoverflow.com/users/1132699/nitzanms"}, "edited": false, "score": 0, "creation_date": 1455797922, "post_id": 35454343, "comment_id": 58655898, "body": "You&#39;re invoking pin in the correct way in cases 2 and 1 (case 1 is for complex process tree flows). I suspect the issue is not Pin itself but something in the Pintool. Can you share a minimal reproducer of the issue?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5917581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f8be74ab9799edcab1bf18dc26a0c7f6?s=128&d=identicon&r=PG&f=1", "display_name": "G Ashwin", "link": "https://stackoverflow.com/users/5917581/g-ashwin"}, "edited": false, "score": 0, "creation_date": 1455789260, "post_id": 35477519, "comment_id": 58650135, "body": "I have taken care of all the four cases you have mentioned ,  even the given inscount.so doesn&#39;t give any output for the 32-bit executable. What can be the error then? As given , I have compiled it separately for 32-bit architecture. But then for my tool  , I collect information about branches and functions which come properly but file that contains the names of images is empty."}], "tags": [], "owner": {"reputation": 6531, "user_id": 507028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/150b5324471a76f6f2fa9dd2380ad611?s=128&d=identicon&r=PG", "display_name": "Neitsa", "link": "https://stackoverflow.com/users/507028/neitsa"}, "is_accepted": false, "score": 0, "last_activity_date": 1455787788, "creation_date": 1455787788, "answer_id": 35477519, "question_id": 35454343, "link": "https://stackoverflow.com/questions/35454343/profile-32-bit-app-on-64-bit-system-using-intel-pin/35477519#35477519", "title": "Profile 32-bit app on 64-bit system using INTEL PIN", "body": "<p>There are a few caveats to know when starting a program under pin control:</p>\n\n<p>1) The pintool <strong>must be compiled in the same architecture</strong> than the instrumented program (so, if your program is 32-bit, your pin tool must be 32-bit).</p>\n\n<p>2) Ensure your system is setup to execute 32-bit programs on a 64-bit OS (some linux systems still need <code>ia32-libs</code> and / or need to be prepared for executing 32-bit programs (e.g. <code>sudo dpkg --add-architecture i386</code>)</p>\n\n<p>3) Ensure you have <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/71313/Pin/html/index.html#LIBRARIES\" rel=\"nofollow\">all required libraries for PIN</a></p>\n\n<p>4) Use <a href=\"https://software.intel.com/sites/landingpage/pintool/docs/71313/Pin/html/index.html#PIN_LAUNCHER\" rel=\"nofollow\">pin.sh</a></p>\n\n<p>Your command should be:</p>\n\n<ul>\n<li><code>pin -t pintool.so -- &lt;program&gt; &lt;program-options&gt;</code></li>\n</ul>\n\n<p>If you still have problems it is probably a problem with your pintool code rather than pin itself.</p>\n\n<p>Did you tried one of the simple example (like <code>inscount</code>) on your program ?</p>\n"}, {"tags": [], "owner": {"reputation": 58, "user_id": 4437719, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-eiIx_vbktuY/AAAAAAAAAAI/AAAAAAAAAE8/v0y3bunLg9w/photo.jpg?sz=128", "display_name": "asm", "link": "https://stackoverflow.com/users/4437719/asm"}, "is_accepted": false, "score": 2, "last_activity_date": 1478444014, "creation_date": 1478444014, "answer_id": 40450685, "question_id": 35454343, "link": "https://stackoverflow.com/questions/35454343/profile-32-bit-app-on-64-bit-system-using-intel-pin/40450685#40450685", "title": "Profile 32-bit app on 64-bit system using INTEL PIN", "body": "<p>well i found a workaround to compile the 32bit library of pin ( i mean instcount0 ) in 64bit arch.</p>\n\n<p>i did modify the config file related to building the library.</p>\n\n<p>i have pin located in /opt/ so , i edited\n</p>\n\n<pre><code>/opt/pin-3.0-76991-gcc-linux/source/tools/Config\n</code></pre>\n\n<p>\nat line 38</p>\n\n<pre class=\"lang-html prettyprint-override\"><code># Define the architecture of the target\n# ; TARGET ?= $(HOST_ARCH)\nTARGET = ia32\nifeq ($(TARGET),ia32)\n    BITS := 32\nelse\n    BITS := 64\nendif\n</code></pre>\n\n\n\n<p>i just changed the target to ia32. works just fine after build .</p>\n"}, {"tags": [], "owner": {"reputation": 482, "user_id": 6105985, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lEqxGMHWDuM/AAAAAAAAAAI/AAAAAAAAACU/VsqqqzUhbNI/photo.jpg?sz=128", "display_name": "Bruce Shen", "link": "https://stackoverflow.com/users/6105985/bruce-shen"}, "is_accepted": false, "score": 0, "last_activity_date": 1513788705, "creation_date": 1513788705, "answer_id": 47910850, "question_id": 35454343, "link": "https://stackoverflow.com/questions/35454343/profile-32-bit-app-on-64-bit-system-using-intel-pin/47910850#47910850", "title": "Profile 32-bit app on 64-bit system using INTEL PIN", "body": "<p>Check the version of your PIN binary. </p>\n\n<pre><code>file PIN_DIR/pin\n</code></pre>\n\n<p>I downloaded PIN kit from this <a href=\"https://software.intel.com/en-us/articles/pin-a-binary-instrumentation-tool-downloads\" rel=\"nofollow noreferrer\" title=\"PIN Downloads\">link</a>. My PIN binary is 32-bit. If yours is 64-bit version, you can modify codes that check system architecture in pin.sh, and run</p>\n\n<pre><code>PIN_DIR/pin.sh\n</code></pre>\n\n<p>That should give you a 32-bit version PIN binary.</p>\n"}], "owner": {"reputation": 23, "user_id": 5917581, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/f8be74ab9799edcab1bf18dc26a0c7f6?s=128&d=identicon&r=PG&f=1", "display_name": "G Ashwin", "link": "https://stackoverflow.com/users/5917581/g-ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2214, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1513788705, "creation_date": 1455705665, "last_edit_date": 1455787893, "question_id": 35454343, "link": "https://stackoverflow.com/questions/35454343/profile-32-bit-app-on-64-bit-system-using-intel-pin", "title": "Profile 32-bit app on 64-bit system using INTEL PIN", "body": "<p>I compiled a C program using -<em>m32 gcc</em> option . I want to profile this program using a Pin tool . My kernel is 64 bit.</p>\n\n<p>I have tried :-</p>\n\n<p>1) <code>pin -t64 &lt;64-bit toolname&gt; -t &lt;32-bit toolname&gt; -- &lt;application&gt;</code></p>\n\n<p>2) <code>pin -t &lt;32-bit toolname&gt; -- &lt;application&gt;</code></p>\n\n<p>3) <code>pin -t &lt;64-bit toolname&gt; -- &lt;application&gt;</code></p>\n\n<p>I have the same .cpp tool file for both the tools compiled differently for 32 bit and 64 bit architectures.</p>\n\n<p>Case 3 invoked an error 'unable to load .. Check the architecture type' .\nCases 1 and 2 , the command was successful but produced some unexpected output , for ex names of images written into a file is empty in this case but contains proper results when executed with a 64-bit application . Which is the correct way to set up the pin tool for this case?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1455704988, "post_id": 35454041, "comment_id": 58604730, "body": "Could it be a designated initializer syntax?"}], "answers": [{"comments": [{"owner": {"reputation": 1351, "user_id": 1671693, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29d161382ae04e0889c241931b8aae1f?s=128&d=identicon&r=PG", "display_name": "Gregory Kuhn", "link": "https://stackoverflow.com/users/1671693/gregory-kuhn"}, "edited": false, "score": 0, "creation_date": 1455705136, "post_id": 35454098, "comment_id": 58604853, "body": "well, that&#39;s embarrassing, I should have known that! An answer within 30 secs. Fair play!"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 1351, "user_id": 1671693, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29d161382ae04e0889c241931b8aae1f?s=128&d=identicon&r=PG", "display_name": "Gregory Kuhn", "link": "https://stackoverflow.com/users/1671693/gregory-kuhn"}, "edited": false, "score": 0, "creation_date": 1455705224, "post_id": 35454098, "comment_id": 58604928, "body": "@GregoryKuhn Happens to the best of us. Syntax is hard to search for."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455706014, "post_id": 35454098, "comment_id": 58605492, "body": "&quot;the new C99 initialization syntax&quot;  It&#39;s 17 years old... :)"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455707337, "post_id": 35454098, "comment_id": 58606423, "body": "@Lundin Well, for Microsoft it&#39;s still new."}], "tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 3, "last_activity_date": 1455705009, "creation_date": 1455705009, "answer_id": 35454098, "question_id": 35454041, "link": "https://stackoverflow.com/questions/35454041/c-code-snippet-dot-operator-syntax/35454098#35454098", "title": "C code snippet dot operator syntax", "body": "<p>That's the new C99 initialization syntax. An initializer of the form</p>\n\n<pre><code>.field = value\n</code></pre>\n\n<p>initializes structure member <code>field</code> to <code>value</code> instead of initializing the next structure member in order.</p>\n"}], "owner": {"reputation": 1351, "user_id": 1671693, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/29d161382ae04e0889c241931b8aae1f?s=128&d=identicon&r=PG", "display_name": "Gregory Kuhn", "link": "https://stackoverflow.com/users/1671693/gregory-kuhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 35454098, "answer_count": 1, "score": 1, "last_activity_date": 1455705616, "creation_date": 1455704908, "question_id": 35454041, "link": "https://stackoverflow.com/questions/35454041/c-code-snippet-dot-operator-syntax", "title": "C code snippet dot operator syntax", "body": "<p>I encountered the following code snippet within a cstartup file for a cortex m0 micro - <code>cstartup_M.c</code></p>\n\n<pre><code>#pragma location = \".intvec\"\n__root const intvec_elem __vector_table[] =\n{\n  { .__ptr = __sfe( \"CSTACK\" ) },\n  __iar_program_start,\n\n  NonMaskableInt_Handler,\n  HardFault_Handler,\n</code></pre>\n\n<p>Could someone please explain the syntax within the line: <code>{ .__ptr = __sfe( \"CSTACK\" ) },</code></p>\n\n<p>Specifically:</p>\n\n<ol>\n<li>What is the purpose of the additional code block?</li>\n<li>What is going on here:  <code>.__ptr</code>?</li>\n</ol>\n"}, {"tags": ["c", "printf", "filestream"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455704913, "post_id": 35454005, "comment_id": 58604680, "body": "<code>fprintf</code> is standard C, I don;t know about <code>_ftprintf</code>"}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1455704999, "post_id": 35454005, "comment_id": 58604739, "body": "What OS, what API, does this apply to?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1455705253, "post_id": 35454005, "comment_id": 58604947, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/xkh07fe2.aspx\" rel=\"nofollow noreferrer\"><code>_ftprintf</code></a> is a Visual C (and C++) specific &quot;function&quot; which is actually a macro the expands to another function in the <code>printf</code> family depending on the <code>_UNICODE</code> and <code>_MBCS</code> macros. There&#39;s a table in the reference to say what it expands to."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4684040, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/381a3e3d83d1328b0b00424cb3000bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Itay Avraham", "link": "https://stackoverflow.com/users/4684040/itay-avraham"}, "edited": false, "score": 0, "creation_date": 1455706696, "post_id": 35454230, "comment_id": 58605987, "body": "Thanks Eldar, and when _UNICODE is defined?"}, {"owner": {"reputation": 4975, "user_id": 3994425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56f3f6d003abc63fb417f1c209d08b66?s=128&d=identicon&r=PG&f=1", "display_name": "Eldar Dordzhiev", "link": "https://stackoverflow.com/users/3994425/eldar-dordzhiev"}, "reply_to_user": {"reputation": 125, "user_id": 4684040, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/381a3e3d83d1328b0b00424cb3000bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Itay Avraham", "link": "https://stackoverflow.com/users/4684040/itay-avraham"}, "edited": false, "score": 0, "creation_date": 1455734683, "post_id": 35454230, "comment_id": 58625840, "body": "@ItayAvraham <code>Project Properties -&gt; General -&gt; Project Defaults -&gt; Character Set</code>. If <code>Use Unicode Character Set</code> is set, MSBuild will define it implicitly."}], "tags": [], "owner": {"reputation": 4975, "user_id": 3994425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56f3f6d003abc63fb417f1c209d08b66?s=128&d=identicon&r=PG&f=1", "display_name": "Eldar Dordzhiev", "link": "https://stackoverflow.com/users/3994425/eldar-dordzhiev"}, "is_accepted": true, "score": 4, "last_activity_date": 1455706076, "last_edit_date": 1455706076, "creation_date": 1455705365, "answer_id": 35454230, "question_id": 35454005, "link": "https://stackoverflow.com/questions/35454005/fprintf-vs-ftprintf/35454230#35454230", "title": "Fprintf VS _ftprintf", "body": "<p><code>_tprintf</code> and <code>_ftprintf</code> are to be used with <code>TCHAR</code> format strings. <code>TCHAR</code> is just a macro, which unwraps into either <code>char</code> or <code>wchar_t</code>, depending on whether is the <code>_UNICODE</code> macro defined.</p>\n\n<p>So, basically, if you don't have <code>_UNICODE</code> defined, <code>_ftprintf</code> will be equivalent to <code>fprintf</code>, otherwise it will be equivalent to <code>fwprintf</code>.</p>\n"}], "owner": {"reputation": 125, "user_id": 4684040, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/381a3e3d83d1328b0b00424cb3000bfc?s=128&d=identicon&r=PG&f=1", "display_name": "Itay Avraham", "link": "https://stackoverflow.com/users/4684040/itay-avraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 35454230, "answer_count": 1, "score": 4, "last_activity_date": 1455706076, "creation_date": 1455704817, "question_id": 35454005, "link": "https://stackoverflow.com/questions/35454005/fprintf-vs-ftprintf", "title": "Fprintf VS _ftprintf", "body": "<p>both have almost same input parameters:</p>\n\n<pre><code>int _ftprintf( FILE *stream, const _tchar *format [, argument ]...)\n\nint fprintf(FILE *stream, const char *format, ...)\n</code></pre>\n\n<p>What is the difference between the two format agruments?\nWhen should I use each?</p>\n"}, {"tags": ["c", "visual-studio-2015"], "comments": [{"owner": {"reputation": 7651, "user_id": 2960823, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/otSfG.jpg?s=128&g=1", "display_name": "kuroi neko", "link": "https://stackoverflow.com/users/2960823/kuroi-neko"}, "edited": false, "score": 3, "creation_date": 1455704473, "post_id": 35453712, "comment_id": 58604325, "body": "Read scanf documentation again. Your formats are wrong."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 1, "creation_date": 1455704489, "post_id": 35453712, "comment_id": 58604338, "body": "<code>%7.2f</code> --&gt; <code>%2f</code>, <code>%2.2d</code> --&gt; <code>%02d</code>"}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1455704629, "post_id": 35453712, "comment_id": 58604446, "body": "You should already get a bunch of compiler warnings like <code>&#39;scanf_s&#39; : unknown type field character &#39;.&#39; in format specifier</code> or <code>&#39;scanf_s&#39; : too many arguments passed for format string</code>. Please don&#39;t ignore them"}, {"owner": {"reputation": 11, "user_id": 5939658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aedc3c1d7437b58cccf60564b94edb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moein IzadPanah", "link": "https://stackoverflow.com/users/5939658/moein-izadpanah"}, "edited": false, "score": 0, "creation_date": 1455704750, "post_id": 35453712, "comment_id": 58604546, "body": "There isn&#39;t any sort of error after building the code."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 1, "creation_date": 1455704755, "post_id": 35453712, "comment_id": 58604549, "body": "You tagged this as <code>C++</code>.  Why aren&#39;t you using <code>cin</code>?  Using <code>scanf_s</code> or similar functions removes the type-safety features of <code>cin</code>.  If you get the format specification incorrect for <code>scanf_s</code>, the behavior of the program is undefined."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1455705306, "post_id": 35453712, "comment_id": 58604986, "body": "<code>scanf_s(&quot;%2.2d&#47;%2.2d&#47;%4.4d&quot;, &amp;Month, &amp;Day, &amp;Year);</code>  --  Also, a format string with the <code>&#47;</code> character in it does not give you masked editing features, if that is what you were trying to accomplish with that string.  I wish it were that simple."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5939658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aedc3c1d7437b58cccf60564b94edb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moein IzadPanah", "link": "https://stackoverflow.com/users/5939658/moein-izadpanah"}, "is_accepted": false, "score": 0, "last_activity_date": 1455803820, "creation_date": 1455803820, "answer_id": 35483424, "question_id": 35453712, "link": "https://stackoverflow.com/questions/35453712/debug-assertion-failed-visual-studio-2015/35483424#35483424", "title": "&quot;Debug Assertion Failed&quot; Visual Studio 2015", "body": "<p>The only problem with this code is that inside the scanf of the \"Unit Price\", instead of just writing \"%f\", it has written \"%7.2f\".\nany sort of formatting whatsoever should be done in the printf part and in can not be defined in the scanf.</p>\n"}], "owner": {"reputation": 11, "user_id": 5939658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1aedc3c1d7437b58cccf60564b94edb6?s=128&d=identicon&r=PG&f=1", "display_name": "Moein IzadPanah", "link": "https://stackoverflow.com/users/5939658/moein-izadpanah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455803986, "creation_date": 1455704069, "last_edit_date": 1455803986, "question_id": 35453712, "link": "https://stackoverflow.com/questions/35453712/debug-assertion-failed-visual-studio-2015", "title": "&quot;Debug Assertion Failed&quot; Visual Studio 2015", "body": "<p>There seems to be an error with my piece of code in c.\nwhen I try to run it, it gives the \"Microsoft visual Studio C++ Runtime Library\".\nit gives this error after I give the first input and press enter.\nIn my code, I'm trying to get some information from the user and then printing it in a new format.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\nint     Code;\nint     Day, Month, Year;\nfloat   Price;\n\nprintf(\"Enter Item Number: \");\nscanf_s(\"%d\", &amp;Code);\n\nprintf(\"Enter Unit Price: \");\nscanf_s(\"%7.2f\", &amp;Price);\n\nprintf(\"Enter Purchase Date (mm/dd/yyyy): \");\nscanf_s(\"%2.2d/%2.2d/%4.4d\", &amp;Month, &amp;Day, &amp;Year);\n\n/* Here is the New Format Printout */\n\nprintf(\"Item\\tUnit\\tPurchase\\n\\tPrice\\tDate\\n\");\nprintf(\"%3.3d\\t$%f\\t%d/%d/%d\", Code, Price, Month, Day, Year);\nreturn 0;\n}\n</code></pre>\n\n<p><a href=\"http://i.stack.imgur.com/Gb8Og.jpg\" rel=\"nofollow\">Error Image</a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455704291, "post_id": 35453653, "comment_id": 58604185, "body": "The prime generator problem statement reads: &quot;In each of the next t lines there are two numbers m and n (1 &lt;= m &lt;= n &lt;= 1000000000, n-m&lt;=100000)&quot;. That means the size of your <code>arr</code> variable can go up to 4GB in size. See any problem with that?"}], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 1, "last_activity_date": 1455704875, "creation_date": 1455704875, "answer_id": 35454031, "question_id": 35453653, "link": "https://stackoverflow.com/questions/35453653/why-am-i-getting-a-run-time-errorsigsegv-for-the-following-code/35454031#35454031", "title": "Why am I getting a run time error(SIGSEGV) for the following code?", "body": "<p>The problem lies with this declaration:</p>\n\n<pre><code>int arr[b];\n</code></pre>\n\n<p>This attempts to allocate 4\u00b7<em>b</em> bytes of memory on the stack. Stack size is usually limited to a couple megabytes of memory, but for the larger test cases, the judging tool is going to invoke your program with <em>b</em> = 1000000000 which causes your program to allocate 4 gigabytes of memory on the stack. This is more than you can place on the stack, causing the SIGSEGV you observe.</p>\n\n<p>To resolve the issue, use <code>malloc()</code> to allocate <code>arr</code> instead of declaring a variable length array. Memory allocated via <code>malloc()</code> comes from the <em>heap</em> which can grow as large as the operating system lets you, usually until all the memory is exhausted and possibly further.</p>\n\n<p>You should also consider to implement a different algorithm to solve this problem. There are primality tests that are much more efficient than the na\u00efve sieve of Eratosthenes you implement.</p>\n"}], "owner": {"reputation": 11, "user_id": 5939738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9053f5ceb3eeb67baf09c5578145c12b?s=128&d=identicon&r=PG&f=1", "display_name": "hishighness", "link": "https://stackoverflow.com/users/5939738/hishighness"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1456468701, "accepted_answer_id": 35454031, "answer_count": 1, "score": -2, "last_activity_date": 1455704875, "creation_date": 1455703932, "question_id": 35453653, "link": "https://stackoverflow.com/questions/35453653/why-am-i-getting-a-run-time-errorsigsegv-for-the-following-code", "closed_reason": "Not suitable for this site", "title": "Why am I getting a run time error(SIGSEGV) for the following code?", "body": "<p>This is the solution of the Prime Generator problem on SPOJ(Sphere online judge), I have checked and no array is out of bound, and still it is showing run time error.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int n;\n    int i,j,a,b;\n    scanf(\"%d\", &amp;n);\n\n    while(n){\n        scanf(\"%d %d\", &amp;a, &amp;b);\n        int arr[b];\n\n        // Filling the array\n        for(i=2;i&lt;=b;i++){\n            arr[i-2]=i;\n        }\n\n        int p,c;\n        for(p=0;p&lt;b-1;p++){\n            if(arr[p]){\n                if(arr[p]&gt;=a){\n                    printf(\"\\n%d\", arr[p]); \n                }\n                for(c=p+arr[p];c&lt;b-2;c+= arr[p]){\n                    arr[c]=0;\n                }\n            }\n        }\n        n--;    \n    }\n</code></pre>\n"}, {"tags": ["c++", "c", "makefile", "environment-variables", "include-path"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 1, "creation_date": 1455707167, "post_id": 35453011, "comment_id": 58606303, "body": "This is subjective, but\u2014I strongly suggest using flags.  Flags are explicit, and environment variables are more annoying to debug.  If you use flags, you can copy a command out of a make invocation and run it in your terminal window.  With environment variables, you can&#39;t.  I&#39;m currently working with a build system that uses lots of environment variables at work, and it&#39;s a total pain."}], "answers": [{"tags": [], "owner": {"reputation": 443, "user_id": 5846449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e896df6712393f5e7e891b219246544b?s=128&d=identicon&r=PG&f=1", "display_name": "Vladislav Mikitich", "link": "https://stackoverflow.com/users/5846449/vladislav-mikitich"}, "is_accepted": false, "score": 0, "last_activity_date": 1455702681, "last_edit_date": 1495540236, "creation_date": 1455702681, "answer_id": 35453166, "question_id": 35453011, "link": "https://stackoverflow.com/questions/35453011/specify-library-path-via-compiler-environment-variables-or-command-line-flags-in/35453166#35453166", "title": "Specify library path via compiler environment variables or command line flags in C and C++?", "body": "<p>You can use cmake for configuring your project</p>\n\n<p>And find boost and gsl with cmake</p>\n\n<p><a href=\"https://cmake.org/cmake/help/v3.2/module/FindGSL.html\" rel=\"nofollow noreferrer\">https://cmake.org/cmake/help/v3.2/module/FindGSL.html</a>\n<a href=\"https://cmake.org/cmake/help/v3.0/module/FindBoost.html\" rel=\"nofollow noreferrer\">https://cmake.org/cmake/help/v3.0/module/FindBoost.html</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/6646405/how-do-you-add-boost-libraries-in-cmakelists-txt\">Example for boost</a></p>\n"}], "owner": {"reputation": 57967, "user_id": 2805305, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/442d249754d1725d9510cf06fa46b964?s=128&d=identicon&r=PG&f=1", "display_name": "bolov", "link": "https://stackoverflow.com/users/2805305/bolov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455708453, "creation_date": 1455702270, "last_edit_date": 1455708453, "question_id": 35453011, "link": "https://stackoverflow.com/questions/35453011/specify-library-path-via-compiler-environment-variables-or-command-line-flags-in", "title": "Specify library path via compiler environment variables or command line flags in C and C++?", "body": "<p>When using a library outside of the project, e.g. <a href=\"http://www.boost.org/\" rel=\"nofollow\">boost</a> or <a href=\"https://github.com/Microsoft/GSL\" rel=\"nofollow\">Guidelines Support Library</a>, how should we specify the paths related to that library?</p>\n\n<ul>\n<li><p>add the paths to the <code>LIBRARY_PATH</code> and <code>CPLUS_INCLUDE_PATH</code> environment variables used by the compiler.</p></li>\n<li><p>define a environment variable (e.g. <code>GSL_PATH</code>) and then<br>\nadd <code>-L</code> and <code>-isystem</code> flags in the makefile of each project.</p></li>\n</ul>\n\n<p>Is there a best practice for this? What are the advantages and disadvantages of each approach? Consider the need to compile and use the project on other systems.</p>\n\n<p>For various reasons the libraries are installed in a custom path</p>\n"}, {"tags": ["c", "gcc", "arm", "elf", "gnu-toolchain"], "comments": [{"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 2, "creation_date": 1455719204, "post_id": 35452912, "comment_id": 58614962, "body": "Probably it depends on gcc version.  There are various options that your should look at (in some versions).  For instance, <code>-mabi</code> will control some <i>eabi</i> parameters.  You could ask the vendor of <i>Proteus</i> (and they should support a wider variety of ELF files for a better product)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1455768873, "post_id": 35452912, "comment_id": 58640339, "body": "where did you get these toolchains or did you build them yourself from the same gnu sources?  If not built from the same gnu sources, then who knows what differences there will be.  But even from the same sources those, normaly triplets, arm-none-eabi, arm-linux-gnueabi, (arm-none-elf, arm-elf) etc trigger a number of build options, any one of those or a combination of them might do something to the elf file that Proteus supports.  I agree with artless noise though the problem here is Proteus not supporting elf files generally, and/or putting the blinders on to a specific subset or flavor"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1455769039, "post_id": 35452912, "comment_id": 58640384, "body": "I dont remember if arm-elf builds anymore with the current sources, might have to go back a few, but an interesting experiment would be to build arm-none-eabi and arm-elf from the same binutils and gcc, take a very small project maybe even just a branch to self, build that (well that would be binutils only no need for gcc)(actually binutils is likely the package generating all the elf files anyway).  and use a hex dump tool or some other to see if there are any actual differences.  I suspect you may not be fighting arm-elf vs arm-none-eabi but instead one binutils version to another."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1455769064, "post_id": 35452912, "comment_id": 58640391, "body": "can you post the versions of each arm-elf-as --version arm-elf-gcc --version arm-none-eabi-as --version, etc."}, {"owner": {"reputation": 693, "user_id": 492927, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/139646fbca54ab3a188db0eebf92631c?s=128&d=identicon&r=PG", "display_name": "Sreeyesh", "link": "https://stackoverflow.com/users/492927/sreeyesh"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1455777680, "post_id": 35452912, "comment_id": 58643650, "body": "@dwelch I have updated my question with version details of my toolchain"}, {"owner": {"reputation": 693, "user_id": 492927, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/139646fbca54ab3a188db0eebf92631c?s=128&d=identicon&r=PG", "display_name": "Sreeyesh", "link": "https://stackoverflow.com/users/492927/sreeyesh"}, "reply_to_user": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1455778534, "post_id": 35452912, "comment_id": 58644010, "body": "@dwelch I didn&#39;t compile the toolchain myself. I just used the pre-built binaries.  arm-elf from <a href=\"http://gnutoolchains.com/arm-elf/\" rel=\"nofollow noreferrer\">gnutoolchains.com/arm-elf</a> arm-none-eabi : installed the version that was available in ubuntu software repository."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 4453524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sBZea.jpg?s=128&g=1", "display_name": "ljrk", "link": "https://stackoverflow.com/users/4453524/ljrk"}, "edited": false, "score": 2, "creation_date": 1455784954, "post_id": 35475720, "comment_id": 58647291, "body": "The toolchains differ in some ways, including the default &quot;implicit&quot; options when called. If the compiler version is the same, basically both compilers do produce the same binary, as long as the same options are provided. The arm-none-eabi toolchain is targeted for most general use thus disables some &quot;fancy&quot; features. Also usually it does not include and link to a standard-library (by default) except the start-up symbols. So yes, you&#39;re right, the option is probably enabled by default in arm-elf"}, {"owner": {"reputation": 613, "user_id": 4453524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sBZea.jpg?s=128&g=1", "display_name": "ljrk", "link": "https://stackoverflow.com/users/4453524/ljrk"}, "edited": false, "score": 1, "creation_date": 1455785096, "post_id": 35475720, "comment_id": 58647355, "body": "See here on what compiler options are enabled by default: <a href=\"http://stackoverflow.com/a/18600837/4453524\">stackoverflow.com/a/18600837/4453524</a>"}], "tags": [], "owner": {"reputation": 693, "user_id": 492927, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/139646fbca54ab3a188db0eebf92631c?s=128&d=identicon&r=PG", "display_name": "Sreeyesh", "link": "https://stackoverflow.com/users/492927/sreeyesh"}, "is_accepted": true, "score": 5, "last_activity_date": 1455781898, "creation_date": 1455781898, "answer_id": 35475720, "question_id": 35452912, "link": "https://stackoverflow.com/questions/35452912/is-there-any-difference-in-the-format-of-executable-file-generated-by-arm-elf-an/35475720#35475720", "title": "Is there any difference in the format of executable file generated by arm-elf and arm-none-eabi toolchains?", "body": "<p>I finally found out the solution for the issue. I noticed that, in Proteus, there is option to configure the toolchain and build the source code from Proteus itself.</p>\n\n<p>I just did the foloowing things</p>\n\n<ol>\n<li>Selected GNU ARM toolchain from the list of supported compilers</li>\n<li>Configured the tool chain path to point to my arm-none-eabi tool chain.</li>\n<li>Created a new project with an empty main function.</li>\n<li>Built the project.</li>\n</ol>\n\n<p>The build was successful and more interestingly I could debug the executable.</p>\n\n<p>Proteus logs the build commands. When I analysed the logs, I noticed that some extra options being used by Proteus when invoking arm-none-eabi-gcc. I experimented with those extra options and finally found out that the option <code>-gdwarf-2</code> plays the key role.</p>\n\n<p>I updated my makefile with this option and it worked fine.</p>\n\n<p>This option simply enables DWARF version 2 format, That's all what I understood from the web search. But why arm-elf toolchain worked without this option is still a question in my mind. May be, this option is enabled in arm-elf by default.</p>\n\n<p>Anyway I am satisfied with this finding as I can proceed with my work now.</p>\n\n<p>Thanks to all those who spared their precious time to help me out. Hope this finding will help people experimenting with Proteus simulation using GNU ARM toolchain.</p>\n"}], "owner": {"reputation": 693, "user_id": 492927, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/139646fbca54ab3a188db0eebf92631c?s=128&d=identicon&r=PG", "display_name": "Sreeyesh", "link": "https://stackoverflow.com/users/492927/sreeyesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 900, "favorite_count": 0, "accepted_answer_id": 35475720, "answer_count": 1, "score": 4, "last_activity_date": 1455781898, "creation_date": 1455702020, "last_edit_date": 1455777210, "question_id": 35452912, "link": "https://stackoverflow.com/questions/35452912/is-there-any-difference-in-the-format-of-executable-file-generated-by-arm-elf-an", "title": "Is there any difference in the format of executable file generated by arm-elf and arm-none-eabi toolchains?", "body": "<p>I am trying to build a bare metal arm project. I tried the GNU toolchains <code>arm-elf</code> and <code>arm-none-eabi</code>. Executables generated by both toolchains, when converted to intel hex format, runs fine.</p>\n\n<p>I am using the software Proteus for simulation. Proteus supports debugging executables in both elf and coff format.</p>\n\n<p>In my case Proteus accepts the executable generated by <code>arm-elf</code> but its showing error when loading the executable generated by <code>arm-none-eabi</code>. The error message shown by Proteus is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qPb7v.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qPb7v.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I just ran the <code>file</code> command in linux with the two executables as argument, one by one.</p>\n\n<p>The results are shown below.</p>\n\n<h1>arm-none-eabi output</h1>\n\n<p>image: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), statically linked, not stripped</p>\n\n<h1>arm-elf output</h1>\n\n<p>image: ELF 32-bit LSB executable, ARM, version 1, statically linked, not stripped</p>\n\n<p>Is there any option to generate Proteus compatible elf file using arm-none-eabi toolchain?</p>\n\n<p>Edit:\nDetails of my tollchains' versions.</p>\n\n<pre><code>C:\\SysGCC\\arm-elf\\bin&gt;arm-elf-gcc.exe --version\narm-elf-gcc.exe (GCC) 4.6.3\nCopyright (C) 2011 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nC:\\SysGCC\\arm-elf\\bin&gt;arm-elf-as.exe --version\nGNU assembler (GNU Binutils) 2.22\nCopyright 2011 Free Software Foundation, Inc.\nThis program is free software; you may redistribute it under the terms of\nthe GNU General Public License version 3 or later.\nThis program has absolutely no warranty.\nThis assembler was configured for a target of `arm-elf'.\n\nsreeyesh@ITP-PTLX118:~$ arm-none-eabi-gcc --version\narm-none-eabi-gcc (15:4.9.3+svn227297-1) 4.9.3 20150529 (prerelease)\nCopyright (C) 2014 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n\nsreeyesh@ITP-PTLX118:~$ arm-none-eabi-as --version\nGNU assembler (2.25-10ubuntu1+5build1) 2.25\nCopyright (C) 2014 Free Software Foundation, Inc.\nThis program is free software; you may redistribute it under the terms of\nthe GNU General Public License version 3 or later.\nThis program has absolutely no warranty.\nThis assembler was configured for a target of `arm-none-eabi'.\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1455701164, "post_id": 35452535, "comment_id": 58601814, "body": "The question is: what counts as <i>delete</i> for you. Is it enough to overwrite it with blanks or zero-bytes? Or does it have to be removed completely, i.e. subsequent content is shifted (which is much more tedious)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455701378, "post_id": 35452535, "comment_id": 58601983, "body": "Unrelated, but <code>int *q; q = malloc(sizeof(int));.. . fread(q,...</code> is pointless. Use <code>int q;... fread(&amp;q,...</code> instead."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1455701433, "post_id": 35452535, "comment_id": 58602017, "body": "...and <code>*fp2 = fopen(&quot;sridhar.txt&quot;,&quot;r&quot;);</code> should be <code>fp2 = fopen(&quot;sridhar.txt&quot;,&quot;r&quot;);</code>. Compile with all warnings enabled."}, {"owner": {"reputation": 41, "user_id": 5897000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b4ffa958829a8245bc8ca72effe3cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/5897000/sridhar"}, "edited": false, "score": 0, "creation_date": 1455701773, "post_id": 35452535, "comment_id": 58602249, "body": "Yes, I need to shift the content to the top of the file and make file smaller as i read data. That is my requirement as of now. Can you please help me with a way of doing that."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455703269, "post_id": 35452535, "comment_id": 58603407, "body": "Useful as a queue file is, not many common file systems support it natively:("}], "answers": [{"tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": false, "score": 0, "last_activity_date": 1455703328, "creation_date": 1455703328, "answer_id": 35453437, "question_id": 35452535, "link": "https://stackoverflow.com/questions/35452535/how-to-simultaneously-read-and-delete-contents-of-file-in-c/35453437#35453437", "title": "How to simultaneously read and delete contents of file in C", "body": "<p>There is no <em>delete</em> operation on basic files. You can read/write but not delete. Delete is a <em>logical</em> operation that you must implement by yourself even by marking in some way a record as <em>deleted</em> or moving the remaining part of the file on top of what you want to <em>delete</em>...</p>\n\n<p>Note that there is no <em>insert</em> operation at all, there is too much semantic for <em>delete</em> and <em>insert</em> that modern file system don't provide one for you, you must build one by yourself (or use a library for this, or a structured access layer like a database...).</p>\n"}], "owner": {"reputation": 41, "user_id": 5897000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00b4ffa958829a8245bc8ca72effe3cf?s=128&d=identicon&r=PG&f=1", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/5897000/sridhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1455703328, "creation_date": 1455701054, "question_id": 35452535, "link": "https://stackoverflow.com/questions/35452535/how-to-simultaneously-read-and-delete-contents-of-file-in-c", "title": "How to simultaneously read and delete contents of file in C", "body": "<p>I am doing file read using fread as in the code below. Please help me on how to immediately delete the contents of the files that i completed to read. So if I read one value, delete that value from file and do fclose. Later when i open the file, then the file should be having only two values left.\nI dont know which function to use to delete. Please help me.\n(Which ever content is read, should get deleted)</p>\n\n<p>I am using the code below</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n\nint *p; \n\np = malloc(sizeof(int));\np1 = malloc(sizeof(int));\np2 = malloc(sizeof(int));\n\n*p = 5;\n*p1 = 6;\n*p2 = 7;\nFILE *fp1 = fopen(\"sridhar.txt\",\"w\");\n fwrite(p,sizeof(int),1,fp1);\n fwrite(p1,sizeof(int),1,fp1);\n fwrite(p2,sizeof(int),1,fp1);\n fclose(fp1);\n\n printf(\"\\n Value of p p1 p2 written into the file is :%d \\n\",*p,*p1,*p2);\n\nint *q, *q1, *q2;\nFILE *fp2 = fopen(\"sridhar.txt\",\"r\");\n\nq = malloc(sizeof(int));\nq1 = malloc(sizeof(int));\nq2 = malloc(sizeof(int));\n\n\nfread(q,sizeof(int),1,fp2);\nfclose(fp2); // Delete Logic may come here\n\n*fp2 = fopen(\"sridhar.txt\",\"r\");\nfread(q1,sizeof(int),1,fp2);\nfclose(fp2);\n// Delete Logic In here\n\n*fp2 = fopen(\"sridhar.txt\",\"r\");\nfread(q2,sizeof(int),1,fp2);\nfclose(fp2);\n// Delete logic here \n\n printf(\"\\n Value of q q1 q2 read from the file is :%d %d %d\\n\",*q, *q1,     *q2);\n\n return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "switch-statement", "output"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1455699681, "post_id": 35451910, "comment_id": 58600797, "body": "You have already calculated <code>B</code>, <code>C</code> and <code>D</code>, why do you want to do it again? And more importantly why do you want to do it <i>after</i> the variables have been used by the <code>switch</code>? And I suggest you actually print out the values of the variables, to make sure they are what you expect them to be."}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 2, "creation_date": 1455699790, "post_id": 35451910, "comment_id": 58600869, "body": "So start some debugging. Check where the program stucks."}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 1, "creation_date": 1455699998, "post_id": 35451910, "comment_id": 58601010, "body": "What numbers do you expect in A? Do you expect the value 1, 2, 3 or the ASCII value?."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 5939374, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/8IMGS.jpg?s=128&g=1", "display_name": "salmonade", "link": "https://stackoverflow.com/users/5939374/salmonade"}, "edited": false, "score": 0, "creation_date": 1455701735, "post_id": 35452025, "comment_id": 58602220, "body": "Yup seems that I should have removed the &#39;  &#39; marks. Thanks a bunch for pointing that out, got it up and running now."}], "tags": [], "owner": {"reputation": 1214, "user_id": 2935508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525579321b8c3af42762ce6b288f8353?s=128&d=identicon&r=PG&f=1", "display_name": "Umamahesh P", "link": "https://stackoverflow.com/users/2935508/umamahesh-p"}, "is_accepted": false, "score": 2, "last_activity_date": 1455699711, "creation_date": 1455699711, "answer_id": 35452025, "question_id": 35451910, "link": "https://stackoverflow.com/questions/35451910/switch-case-assignment-none-of-my-cases-are-providing-an-output/35452025#35452025", "title": "Switch Case Assignment, none of my cases are providing an output", "body": "<p>Your case statement includes ascii value of the numbers. Is this case 1? or case '1'. Both have different meanings. </p>\n"}, {"comments": [{"owner": {"reputation": 1214, "user_id": 2935508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525579321b8c3af42762ce6b288f8353?s=128&d=identicon&r=PG&f=1", "display_name": "Umamahesh P", "link": "https://stackoverflow.com/users/2935508/umamahesh-p"}, "edited": false, "score": 0, "creation_date": 1455700102, "post_id": 35452103, "comment_id": 58601077, "body": "The expression is valid as &#39;1&#39; provides ascii value of 1 and is a valid integer."}, {"owner": {"reputation": 2638, "user_id": 306936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/218d76bf3b9e1f5214a4e2774b445700?s=128&d=identicon&r=PG", "display_name": "GingerJack", "link": "https://stackoverflow.com/users/306936/gingerjack"}, "reply_to_user": {"reputation": 1214, "user_id": 2935508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/525579321b8c3af42762ce6b288f8353?s=128&d=identicon&r=PG&f=1", "display_name": "Umamahesh P", "link": "https://stackoverflow.com/users/2935508/umamahesh-p"}, "edited": false, "score": 0, "creation_date": 1455700288, "post_id": 35452103, "comment_id": 58601206, "body": "yes what i meant was 1 and &quot;1&quot; are not one and the same .as &quot;1&quot; has a ascii value of 49."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1455701291, "post_id": 35452103, "comment_id": 58601917, "body": "The switch statement&#39;s controlling  expression has to be to an integer, as well as the  expressions of any case label has to be. A <code>char</code> literal in fact is an <code>int</code>."}, {"owner": {"reputation": 2638, "user_id": 306936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/218d76bf3b9e1f5214a4e2774b445700?s=128&d=identicon&r=PG", "display_name": "GingerJack", "link": "https://stackoverflow.com/users/306936/gingerjack"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1455702694, "post_id": 35452103, "comment_id": 58602963, "body": "@alk I agree with you . on  a side note A char literal is a short int"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1455709627, "post_id": 35452103, "comment_id": 58608061, "body": "<code>sizeof  &#39;A&#39;</code> on my system (recent GCC) returns 4, where as <code>sizeof (short int)</code> returns 2."}], "tags": [], "owner": {"reputation": 2638, "user_id": 306936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/218d76bf3b9e1f5214a4e2774b445700?s=128&d=identicon&r=PG", "display_name": "GingerJack", "link": "https://stackoverflow.com/users/306936/gingerjack"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699943, "creation_date": 1455699943, "answer_id": 35452103, "question_id": 35451910, "link": "https://stackoverflow.com/questions/35451910/switch-case-assignment-none-of-my-cases-are-providing-an-output/35452103#35452103", "title": "Switch Case Assignment, none of my cases are providing an output", "body": "<p>The constant-expression for a case must be the same data type as the variable in the switch, and it must be a constant or a literal.\nIn your case they are not the same.So please rectify that.</p>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "is_accepted": false, "score": 0, "last_activity_date": 1455700190, "creation_date": 1455700190, "answer_id": 35452211, "question_id": 35451910, "link": "https://stackoverflow.com/questions/35451910/switch-case-assignment-none-of-my-cases-are-providing-an-output/35452211#35452211", "title": "Switch Case Assignment, none of my cases are providing an output", "body": "<p>I think you just want the numbers in the switch cases, so try this one:</p>\n\n<pre><code>switch(A){\n      case 1:    printf(\"M\");\n                 break;\n      case 2:    printf(\"MM\");\n                 break;\n      case 3:    printf(\"MMM\"); \n                 break;    \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 5939374, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/8IMGS.jpg?s=128&g=1", "display_name": "salmonade", "link": "https://stackoverflow.com/users/5939374/salmonade"}, "edited": false, "score": 0, "creation_date": 1455701670, "post_id": 35452362, "comment_id": 58602175, "body": "Ah thank you so much, got the program up and running. Grace to you."}], "tags": [], "owner": {"reputation": 1563, "user_id": 2632764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TpYmn.png?s=128&g=1", "display_name": "Sorcrer", "link": "https://stackoverflow.com/users/2632764/sorcrer"}, "is_accepted": true, "score": 2, "last_activity_date": 1455700576, "creation_date": 1455700576, "answer_id": 35452362, "question_id": 35451910, "link": "https://stackoverflow.com/questions/35451910/switch-case-assignment-none-of-my-cases-are-providing-an-output/35452362#35452362", "title": "Switch Case Assignment, none of my cases are providing an output", "body": "<p>In your <code>switch()</code> , each case assumes its a character <code>1</code> (as per ascii table hex value <code>0x31</code>) and when it checks with the case what your actual value will be a integer value, ie; if <code>num</code> is <code>1</code> then its hex value is also <code>0x1</code>,\nso you should change the switch cases to hex values of integers</p>\n\n<p>Also one more note , I think you should change <code>if(0&lt;num&amp;&amp;num&lt;3001)</code> to <code>if(num &gt; 0 &amp;&amp; num&lt;3001)</code></p>\n\n<pre><code>if((num &gt; 0) &amp;&amp; (num&lt;3001))\n{\n    printf(\"*\\n\");\n    switch(A)\n    {\n\n          case 1  : printf(\"M\");\n                      break;\n          case 2  : printf(\"MM\");\n                      break;\n          case 3  : printf(\"MMM\"); \n                      break;    \n    }\n\n    switch(B)\n    {\n           B = ((num%1000)/100);\n\n           case 1  : printf(\"C\");\n                       break;\n           case 2  : printf(\"CC\");\n                       break;\n           case 3  : printf(\"CCC\");\n                       break;\n           case 4  : printf(\"CD\");\n                       break;\n           case 5  : printf(\"D\");\n                       break;\n           case 6  : printf(\"DC\");\n                       break;\n           case 7  : printf(\"DCC\");\n                       break;\n           case 8  : printf(\"DCCC\");\n                       break;\n           case 9  : printf(\"CM\");\n                       break;\n           }\n\n    switch(C)\n    {\n           C = ((num%100)/10);\n\n           case 1  : printf(\"X\");\n                       break;\n           case 2  : printf(\"XX\");\n                       break;\n           case 3  : printf(\"XXX\");\n                       break;\n           case 4  : printf(\"XL\");\n                       break;\n           case 5  : printf(\"L\");\n                       break;\n           case 6  : printf(\"LI\");\n                       break;\n           case 7  : printf(\"LII\");\n                       break;\n           case 8  : printf(\"LIII\");\n                       break;\n           case 9  : printf(\"XC\");\n                       break; \n    }\n\n    switch(D)\n    {\n           D = num%10;\n\n           case 1 : printf(\"I\");\n                      break;\n           case 2 : printf(\"II\");\n                      break;\n           case 3 : printf(\"III\");\n                      break; \n           case 4 : printf(\"IV\");\n                      break;\n           case 5 : printf(\"V\");\n                      break;\n           case 6 : printf(\"VI\");\n                      break;\n           case 7 : printf(\"VII\");\n                      break;\n           case 8 : printf(\"VIII\");\n                      break;\n           case 9 : printf(\"IX\");\n                      break;      \n    }  \n} \n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5939374, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/8IMGS.jpg?s=128&g=1", "display_name": "salmonade", "link": "https://stackoverflow.com/users/5939374/salmonade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 35452362, "answer_count": 4, "score": 0, "last_activity_date": 1455700576, "creation_date": 1455699348, "question_id": 35451910, "link": "https://stackoverflow.com/questions/35451910/switch-case-assignment-none-of-my-cases-are-providing-an-output", "title": "Switch Case Assignment, none of my cases are providing an output", "body": "<p>Hi we were assigned to make a program that would ask the user to input a 4 digit decimal and the program was supposed to convert it to its roman numeral equivalent. We were tasked to only use the switch case function and nothing else. I thought I had the right idea but the problem with my code is it doesn't provide an output. Below is my code, help, pointers and advice would be greatly appreciated</p>\n\n<pre><code>int num, A, B, C, D;    \n\nprintf(\"enter a number: \");\nscanf(\"%d\", &amp;num);\n\nD = num%10;\nC = ((num%100)/10);\nB = ((num%1000)/100);\nA = (num/1000);\n\nif(0&lt;num&amp;&amp;num&lt;3001)\n{\n\n    switch(A)\n    {\n\n          case '1'  : printf(\"M\");\n                      break;\n          case '2'  : printf(\"MM\");\n                      break;\n          case '3'  : printf(\"MMM\"); \n                      break;    \n    }\n\n    switch(B)\n    {\n           B = ((num%1000)/100);\n\n           case '1'  : printf(\"C\");\n                       break;\n           case '2'  : printf(\"CC\");\n                       break;\n           case '3'  : printf(\"CCC\");\n                       break;\n           case '4'  : printf(\"CD\");\n                       break;\n           case '5'  : printf(\"D\");\n                       break;\n           case '6'  : printf(\"DC\");\n                       break;\n           case '7'  : printf(\"DCC\");\n                       break;\n           case '8'  : printf(\"DCCC\");\n                       break;\n           case '9'  : printf(\"CM\");\n                       break;\n           }\n\n    switch(C)\n    {\n           C = ((num%100)/10);\n\n           case '1'  : printf(\"X\");\n                       break;\n           case '2'  : printf(\"XX\");\n                       break;\n           case '3'  : printf(\"XXX\");\n                       break;\n           case '4'  : printf(\"XL\");\n                       break;\n           case '5'  : printf(\"L\");\n                       break;\n           case '6'  : printf(\"LI\");\n                       break;\n           case '7'  : printf(\"LII\");\n                       break;\n           case '8'  : printf(\"LIII\");\n                       break;\n           case '9'  : printf(\"XC\");\n                       break; \n    }\n\n    switch(D)\n    {\n           D = num%10;\n\n           case '1' : printf(\"I\");\n                      break;\n           case '2' : printf(\"II\");\n                      break;\n           case '3' : printf(\"III\");\n                      break; \n           case '4' : printf(\"IV\");\n                      break;\n           case '5' : printf(\"V\");\n                      break;\n           case '6' : printf(\"VI\");\n                      break;\n           case '7' : printf(\"VII\");\n                      break;\n           case '8' : printf(\"VIII\");\n                      break;\n           case '9' : printf(\"IX\");\n                      break;      \n    }  \n}            \n\nelse\n    printf(\"number out of bounds\");\n</code></pre>\n"}, {"tags": ["c", "rpc"], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 1, "last_activity_date": 1455700162, "creation_date": 1455700162, "answer_id": 35452193, "question_id": 35451760, "link": "https://stackoverflow.com/questions/35451760/rpc-client-gives-cant-encode-arguments/35452193#35452193", "title": "RPC Client gives Can&#39;t encode arguments", "body": "<p>You are missing some parentheses:</p>\n\n<pre><code>if (stat = callrpc(...) != 0)\n</code></pre>\n\n<p>is evaluated to</p>\n\n<pre><code>if (stat = (callrpc(...) != 0))\n</code></pre>\n\n<p>which always assigns <code>1</code> to <code>stat</code> in case of an error, which is <code>RPC_CANTENCODEARGS</code>. You need</p>\n\n<pre><code>if ((stat = callrpc(...)) != 0)\n</code></pre>\n\n<p>to get the real error code and message printed in</p>\n\n<pre><code>clnt_perrno(stat);\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 1886172, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/49TPH.jpg?s=128&g=1", "display_name": "Argos", "link": "https://stackoverflow.com/users/1886172/argos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 538, "favorite_count": 0, "accepted_answer_id": 35452193, "answer_count": 1, "score": 2, "last_activity_date": 1455700162, "creation_date": 1455698955, "last_edit_date": 1455699737, "question_id": 35451760, "link": "https://stackoverflow.com/questions/35451760/rpc-client-gives-cant-encode-arguments", "title": "RPC Client gives Can&#39;t encode arguments", "body": "<p>I'm trying to write the simpliest client in RPC with this code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;rpc/rpc.h&gt;\n\nint main(int argc, char *argv[]){\n  int stat;\n  char out;\n    char in='f';\n\n  if(stat=callrpc(argv[1],0x20000001, 1, 1, (xdrproc_t)xdr_void, &amp;in, (xdrproc_t)xdr_char, &amp;out)!=0){\n      clnt_perrno(stat);\n      exit(1);\n  }\n\n  exit(0);\n}\n</code></pre>\n\n<p>It compiles, but when I try to run it, it gives me a \"RPC: Can't encode arguments\"</p>\n\n<p>EDIT: Actually the server do not recieve any argument neither it send back anything, that's why I put a <code>xdr_void</code> added <code>&amp;in</code> and <code>&amp;out</code> to avoid segmentation fault error.</p>\n"}, {"tags": ["c", "macros", "c-preprocessor"], "comments": [{"owner": {"reputation": 2638, "user_id": 306936, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/218d76bf3b9e1f5214a4e2774b445700?s=128&d=identicon&r=PG", "display_name": "GingerJack", "link": "https://stackoverflow.com/users/306936/gingerjack"}, "edited": false, "score": 0, "creation_date": 1455699035, "post_id": 35451678, "comment_id": 58600385, "body": "Can #define and #undef directives help in your scenario?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455699170, "post_id": 35451678, "comment_id": 58600470, "body": "What you are asking is impossible, unless you define <code>MY_MACRO</code> as <code>VALUEA</code> directly."}, {"owner": {"reputation": 3405, "user_id": 4675398, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f82f90aae5005af1ffe060462dd87482?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/4675398/fabian"}, "edited": false, "score": 0, "creation_date": 1455699188, "post_id": 35451678, "comment_id": 58600482, "body": "Maybe? What happens if I undefine and redefine CHOOSE?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1455700618, "post_id": 35451678, "comment_id": 58601423, "body": "The same as without undefining, but eliminating a compiler warning at least ;)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455700636, "post_id": 35451678, "comment_id": 58601439, "body": "I don&#39;t see how this makes any sense. If you need your program to change behavior over time, you need to use variables. What is the actual problem you are trying to solve?"}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 0, "creation_date": 1455700738, "post_id": 35451678, "comment_id": 58601498, "body": "If you undefine your macros, its undefined;) for example: if you #define VALUEA &quot;A&quot; followed by undef VALUEA is not defined anymore"}, {"owner": {"reputation": 191, "user_id": 5703503, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/b023efc85baa1716b81233447654df72?s=128&d=identicon&r=PG&f=1", "display_name": "xy36", "link": "https://stackoverflow.com/users/5703503/xy36"}, "edited": false, "score": 2, "creation_date": 1455700896, "post_id": 35451678, "comment_id": 58601625, "body": "Could you use a macro like: #define VALUEA &quot;A&quot;                                              #define  VALUEB &quot;B&quot;                                                           #define MY_MACRO(x) x?VALUEA:VALUEB                  Note that you need the parameter x in this case."}, {"owner": {"reputation": 1563, "user_id": 2632764, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/TpYmn.png?s=128&g=1", "display_name": "Sorcrer", "link": "https://stackoverflow.com/users/2632764/sorcrer"}, "edited": false, "score": 0, "creation_date": 1455701014, "post_id": 35451678, "comment_id": 58601717, "body": "Can you please explain use case scenario, I didn&#39;t understood your exact problem, (Note: You should true #if &amp; #endif"}, {"owner": {"reputation": 112, "user_id": 3592767, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DwrkY.jpg?s=128&g=1", "display_name": "Yog", "link": "https://stackoverflow.com/users/3592767/yog"}, "edited": false, "score": 0, "creation_date": 1455713443, "post_id": 35451678, "comment_id": 58610743, "body": "you can use <code>#define static CHOOSE VALUEB</code> then you will get <code>MY_MACRO</code> as &quot;A&quot;,  but it will hide <code>CHOOSE</code> and will show it as &quot;A&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 1, "last_activity_date": 1455701290, "creation_date": 1455701290, "answer_id": 35452628, "question_id": 35451678, "link": "https://stackoverflow.com/questions/35451678/can-i-somehow-have-static-c-macros/35452628#35452628", "title": "Can I somehow have static C macros?", "body": "<p>Compiler will do the preprocessing whole project before compiling so if you do something like that it will lead to re-define macro warning and the <code>CHOOSE</code> always be what it is define latest.</p>\n\n<p>You should separate the code in two mode similar to this:</p>\n\n<pre><code>#define VALUEA \"A\"\n#define VALUEB \"B\"\n\n#ifndef CASE_B\n    #define CHOOSE VALUEA\n#endif\n\n#ifdef CASE_B\n    #define CHOOSE VALUEB\n#endif\n\n#ifdef CASE_A\n    #define MY_MACRO CHOOSE \n#endif\n</code></pre>\n\n<p>so you just need to define <code>CASE_A</code> or <code>CASE_B</code> according to your purpose.</p>\n"}, {"comments": [{"owner": {"reputation": 3405, "user_id": 4675398, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f82f90aae5005af1ffe060462dd87482?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/4675398/fabian"}, "edited": false, "score": 0, "creation_date": 1458629859, "post_id": 35526084, "comment_id": 59933469, "body": "Did you test this? It does not work. Neither <code>TEMP</code> nor <code>MY_MACRO</code> has a defined value after <code>#undef MY_MACRO</code>."}], "tags": [], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "is_accepted": false, "score": 1, "last_activity_date": 1455986749, "creation_date": 1455986749, "answer_id": 35526084, "question_id": 35451678, "link": "https://stackoverflow.com/questions/35451678/can-i-somehow-have-static-c-macros/35526084#35526084", "title": "Can I somehow have static C macros?", "body": "<p>A trivial approach: \"save\" the \"value\" of a macro in a temporary macro:</p>\n\n<pre><code>#define VALUEA \"A\"\n#define VALUEB \"B\"\n\n#define CHOOSE VALUEA\n\n#define MY_MACRO CHOOSE\n\n// CHOOSE   -&gt; VALUEA\n// MY_MACRO -&gt; VALUEA\n\n#define TEMP MY_MACRO // save\n#undef MY_MACRO\n\n#define CHOOSE VALUEB\n#define MY_MACRO TEMP // restore\n\n// CHOOSE   -&gt; VALUEB\n// MY_MACRO -&gt; VALUEA\n</code></pre>\n"}], "owner": {"reputation": 3405, "user_id": 4675398, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/f82f90aae5005af1ffe060462dd87482?s=128&d=identicon&r=PG&f=1", "display_name": "Fabian", "link": "https://stackoverflow.com/users/4675398/fabian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1455986749, "creation_date": 1455698667, "last_edit_date": 1455702771, "question_id": 35451678, "link": "https://stackoverflow.com/questions/35451678/can-i-somehow-have-static-c-macros", "title": "Can I somehow have static C macros?", "body": "<p>I want to assign a value to a macro based on the value of another macro. However, the two macros are connected. Is there a way to avoid this? The following minimal example shows what I need:</p>\n\n<pre><code>#define VALUEA \"A\"\n#define VALUEB \"B\"\n\n// somewhere I define CHOOSE \n#define CHOOSE VALUEA\n\n// MY_MACRO shall have the value of CHOOSE, but AT THE MOMENT of this line.\n// I want to reassign CHOOSE while MY_MACRO stays the same.\n\n#define MY_MACRO CHOOSE \n// now MY_MACRO has evaluates to CHOOSE evaluates to \"A\"\n\n#define CHOOSE VALUEB\n// now MY_MACRO has evaluates to \"B\" but I want it to be \"A\"\n</code></pre>\n"}, {"tags": ["c", "structure"], "comments": [{"owner": {"reputation": 53, "user_id": 5829597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rbSnb.jpg?s=128&g=1", "display_name": "Gineet Mehta", "link": "https://stackoverflow.com/users/5829597/gineet-mehta"}, "edited": false, "score": 0, "creation_date": 1455698794, "post_id": 35451627, "comment_id": 58600225, "body": "Doesn&#39;t work with gets() too, the subsequent structure entities are getting <b>\\n</b> as the <b>name</b> string."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 3, "creation_date": 1455698874, "post_id": 35451627, "comment_id": 58600280, "body": "<code>fflush(stdin)</code> is UB, and you don&#39;t need to pass <code>sizeof(x) - 1</code> in <code>fgets</code>, just pass <code>fgets(arr, sizeof arr, ...);</code>: <code>fgets</code> reads characters from stream and stores them as a C string into str <b>until (num-1)</b> characters have been read or either a newline or the end-of-file is reached, whichever happens first."}, {"owner": {"reputation": 693, "user_id": 492927, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/139646fbca54ab3a188db0eebf92631c?s=128&d=identicon&r=PG", "display_name": "Sreeyesh", "link": "https://stackoverflow.com/users/492927/sreeyesh"}, "edited": false, "score": 0, "creation_date": 1455698888, "post_id": 35451627, "comment_id": 58600296, "body": "Don&#39;t use fflush(stdin). This won&#39;t work for the intended purpose."}, {"owner": {"reputation": 53, "user_id": 5829597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rbSnb.jpg?s=128&g=1", "display_name": "Gineet Mehta", "link": "https://stackoverflow.com/users/5829597/gineet-mehta"}, "reply_to_user": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1455699048, "post_id": 35451627, "comment_id": 58600394, "body": "@AlterMann yeah okay, I&#39;ll do that. But that doesn&#39;t solve the problem of &quot;\\n&quot; being fed into the name of the structure objects that follow."}, {"owner": {"reputation": 35932, "user_id": 1606345, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IwiIM.png?s=128&g=1", "display_name": "David Ranieri", "link": "https://stackoverflow.com/users/1606345/david-ranieri"}, "edited": false, "score": 0, "creation_date": 1455699452, "post_id": 35451627, "comment_id": 58600643, "body": "@GineetMehta, as I said <code>fflush(stdin);</code> is UB, try to consume/flush the trailing new line using <code>int c; while ((c = fgetc(stdin)) != &#39;\\n&#39; &amp;&amp; c != EOF);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 791, "user_id": 2422527, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5e3bbce8f736739dd113201ab2bade2c?s=128&d=identicon&r=PG&f=1", "display_name": "songziming", "link": "https://stackoverflow.com/users/2422527/songziming"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699602, "creation_date": 1455699602, "answer_id": 35451993, "question_id": 35451627, "link": "https://stackoverflow.com/questions/35451627/fgets-feeds-n-to-the-subsequent-string-not-taking-input/35451993#35451993", "title": "fgets() feeds \\n to the subsequent string, not taking input", "body": "<p><code>scanf</code> doesn't consume <code>\\n</code>, so <code>\\n</code> is still in <code>stdin</code> and read by <code>fgets</code> in next iteration. <code>fflush(stdin)</code> is not in standard C, so the behavior is undefined.</p>\n\n<p>You can consume the newline after <code>scanf_s</code> using <code>getc</code>:</p>\n\n<pre><code>...\nfgets(ptr-&gt;ac_no, 19, stdin);\nprintf(\"Enter Balance: \");\nscanf_s(\"%f\", &amp;(ptr-&gt;balance));\ngetc(stdin);\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5829597, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/rbSnb.jpg?s=128&g=1", "display_name": "Gineet Mehta", "link": "https://stackoverflow.com/users/5829597/gineet-mehta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455699602, "creation_date": 1455698457, "last_edit_date": 1455699411, "question_id": 35451627, "link": "https://stackoverflow.com/questions/35451627/fgets-feeds-n-to-the-subsequent-string-not-taking-input", "title": "fgets() feeds \\n to the subsequent string, not taking input", "body": "<p>I'm trying to input names for an array of structures. Though this is working fine for the 1st iteration, in the 2nd iteration, the <strong>name</strong> string of the structure  object receives <strong>\\n</strong> and I don't know why that is. </p>\n\n<p>I've tried the fflush(stdin) as well but it doesn't seem to work out :/</p>\n\n<pre><code>struct employee\n{\n    char ac_no[20], name[30];\n    float balance;\n};\n\nvoid getdata (struct employee *);\nvoid getdata(struct employee *ptr)\n{\n    printf(\"Enter Name: \");\n    fgets(ptr-&gt;name, 29, stdin);\n    ptr-&gt;name[strcspn((ptr-&gt;name), \"\\r\\n\")] = 0;\n    printf(\"Enter Account Number: \");\n    fgets(ptr-&gt;ac_no, 19, stdin);\n    printf(\"Enter Balance: \");\n    scanf_s(\"%f\", &amp;(ptr-&gt;balance));\n    fflush(stdin);\n}\n\n//In Main()\nstruct employee emp[5];\nregister int i;\nfor (i = 0;i &lt; 5;i++)\n{\n    printf(\"\\nEmployee %d: \\n\", (i+1));\n        getdata(&amp;emp[i]);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "casting", "null", "ternary-operator"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1455698581, "post_id": 35451594, "comment_id": 58600097, "body": "A good answer needs, in my opinion a standard reference, but what&#39;s going on here is an implicit conversion of NULL to (char*)NULL in the first case, and an implicit conversion of (char*)NULL to (void*)NULL in the second case. Nice question though, plus one."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": false, "score": 1, "last_activity_date": 1455703684, "last_edit_date": 1455703684, "creation_date": 1455702520, "answer_id": 35453105, "question_id": 35451594, "link": "https://stackoverflow.com/questions/35451594/principle-of-different-operand-types-adoption-for-ternary-operator-in-c/35453105#35453105", "title": "Principle of different operand types adoption for ternary operator in C", "body": "<p>I will try an explanation:</p>\n\n<p><code>0</code> or <code>(void*)0</code> is a null pointer constant, which is appropriately handled by the ternary conditional operator:</p>\n\n<blockquote>\n  <p>if one operand is a <strong>null pointer constant</strong>, the result has the type\n  of the other operand; (6.5.15 6)</p>\n</blockquote>\n\n<p>but <code>(void*)((void *)0)</code> is a null pointer, but not the null pointer constant (<code>NULL</code>):</p>\n\n<blockquote>\n  <p>An integer constant expression with the value 0, or such an expression\n  cast to type void *,is called a null pointer constant. If a null\n  pointer constant is converted to a pointer type, the resulting\n  pointer, called a null pointer, is guaranteed to compare unequal to a\n  pointer to any object or function. (6.3.2.3 3)</p>\n</blockquote>\n\n<p>Hence now, this paragraph applies:</p>\n\n<blockquote>\n  <p>otherwise, one operand is a pointer to void or a qualified version of\n  void, in which case the result type is a pointer to an appropriately\n  qualified version of void.  (6.5.15 6)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 24488, "user_id": 4082723, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LJbVr.png?s=128&g=1", "display_name": "2501", "link": "https://stackoverflow.com/users/4082723/2501"}, "edited": false, "score": 0, "creation_date": 1455709683, "post_id": 35453506, "comment_id": 58608092, "body": "+one It makes a lot of sense now."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 1, "last_activity_date": 1455705252, "last_edit_date": 1495541254, "creation_date": 1455703514, "answer_id": 35453506, "question_id": 35451594, "link": "https://stackoverflow.com/questions/35451594/principle-of-different-operand-types-adoption-for-ternary-operator-in-c/35453506#35453506", "title": "Principle of different operand types adoption for ternary operator in C", "body": "<p>The following applies:</p>\n\n<blockquote>\n  <p>6.5.15 Conditional operator </p>\n  \n  <p>The first operand shall have scalar type.<br>\n  One of the following shall hold for the second and third operands:</p>\n  \n  <p>/--/</p>\n  \n  <p>\u2014 both operands are pointers to qualified or unqualified versions of\n  compatible types;<br>\n  \u2014 one operand is a pointer and the other is a null\n  pointer constant; or<br>\n  \u2014 one operand is a pointer to an object type and\n  the other is a pointer to a qualified or unqualified version of void.</p>\n</blockquote>\n\n<p>In the first case you have one operand <code>(char*)NULL</code> which is an (unqualified) pointer to type, and one operand <code>NULL</code> which is a null pointer constant.</p>\n\n<p>Further down in \u00a76 it says:</p>\n\n<blockquote>\n  <p>If both the second and third operands are pointers or one is a null\n  pointer constant and the other is a pointer, the result type is a\n  pointer to a type qualified with all the type qualifiers of the types\n  referenced by both operands</p>\n</blockquote>\n\n<p>In plain English: if one operand is of type <code>char*</code> and the other is a null pointer constant, the result is <code>char*</code>.</p>\n\n<p>In the second case you have one pointer to type and one <code>void*</code>. Neither is a null pointer constant (I'll explain why further below). Further down in the same paragraph it says (emphasis mine):</p>\n\n<blockquote>\n  <p>... if one operand is a\n  null pointer constant, the result has the type of the other operand; <strong>otherwise, one operand\n  is a pointer to void or a qualified version of void, in which case the result type is a\n  pointer to an appropriately qualified version of void.</strong></p>\n</blockquote>\n\n<p>Meaning that the result of the second <code>?:</code> operation is of type <code>void*</code>. This should answer your second question.</p>\n\n<hr>\n\n<p>To answer you first question, it has nothing to do with the <code>?:</code> operator as such, but is about the \"ancient C mystery\" of null pointer versus null pointer constants.</p>\n\n<p>How the macro NULL is expanded is implementation-defined, it is either <code>0</code> or <code>(void*)</code>. It is guaranteed to be a null pointer constant. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/32136092/how-to-write-c-c-code-correctly-when-null-pointer-is-not-all-bits-zero/32136460#32136460\">There is a difference between a <em>null pointer</em> and a <em>null pointer constant</em></a>, namely that a null pointer may have any implementation-defined value, while a null pointer constant is always <code>0</code> or <code>(void*)0</code>.</p>\n\n<p>6.3.2.2 says:</p>\n\n<blockquote>\n  <p>An integer constant expression with the value 0, or such an expression\n  cast to type void *, is called a null pointer constant. If a null\n  pointer constant is converted to a pointer type, the resulting\n  pointer, called a null pointer, is guaranteed to compare unequal to a\n  pointer to any object or function.</p>\n</blockquote>\n\n<p>So <code>(void*)NULL</code> is a null pointer, but it is not a null pointer constant. Therefore the conditional operator treats it as a void pointer. </p>\n\n<p>To sum it up: null pointers are not a special case for the conditional operator, only null pointer constants are.</p>\n"}], "owner": {"reputation": 4161, "user_id": 2998612, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2c2a14786a7098647715bfac3d2a5042?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Dong", "link": "https://stackoverflow.com/users/2998612/kevin-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 35453506, "answer_count": 2, "score": 4, "last_activity_date": 1455709667, "creation_date": 1455698340, "last_edit_date": 1455698746, "question_id": 35451594, "link": "https://stackoverflow.com/questions/35451594/principle-of-different-operand-types-adoption-for-ternary-operator-in-c", "title": "Principle of different operand types adoption for ternary operator in C", "body": "<p>There are many kinds of typecasting to make sure assignment works such as implicit type conversion (promotion) and explicit type conversion (truncation), but I am not sure how it works on pointers type conversion for ternary operator.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\nint main (void)\n{\n    (void)((rand() ? (char*)NULL :        NULL) + 1);\n    /*     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        -&gt; expression A */\n\n    /* GCC Warning: pointer of type \u2018void *\u2019 used in arithmetic */\n    (void)((rand() ? (char*)NULL : (void*)NULL) + 1);\n    /*     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        -&gt; expression B */\n\n    return 0;\n}\n</code></pre>\n\n<p>Apparently, the compiler regards expression A as type of <code>char*</code> but B as type of <code>void*</code>.</p>\n\n<p>I have two questions:</p>\n\n<ul>\n<li><p>I've checked the preprocessed code, and <code>NULL</code> is exactly expanded to <code>((void*)0)</code>, so why are <code>((void*)0)</code> and <code>(void*)((void*)0)</code> different types?</p></li>\n<li><p>According to the expression B, why the compiler cast type of <code>char*</code> to type of <code>void*</code> but not vise versa?</p></li>\n</ul>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 6899, "user_id": 1212012, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gmBY7.png?s=128&g=1", "display_name": "Mathieu", "link": "https://stackoverflow.com/users/1212012/mathieu"}, "edited": false, "score": 2, "creation_date": 1455698661, "post_id": 35451585, "comment_id": 58600143, "body": "May the <b>stringizing operator</b> (#) help you? <a href=\"https://msdn.microsoft.com/en-us/library/7e3a913x.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/7e3a913x.aspx</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1455701348, "post_id": 35451585, "comment_id": 58601956, "body": "The macro <i>names</i> are not available at runtime, so this is unfortunately not possible."}, {"owner": {"reputation": 83, "user_id": 5709643, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af562c507a7ae4aa41ba3d44a8b03289?s=128&d=identicon&r=PG&f=1", "display_name": "bvp147", "link": "https://stackoverflow.com/users/5709643/bvp147"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1458533433, "post_id": 35451585, "comment_id": 59885819, "body": "@Ctx: I agree with you. I used a table for mapping ID and macro. thanks"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5709643, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af562c507a7ae4aa41ba3d44a8b03289?s=128&d=identicon&r=PG&f=1", "display_name": "bvp147", "link": "https://stackoverflow.com/users/5709643/bvp147"}, "edited": false, "score": 0, "creation_date": 1455787372, "post_id": 35453868, "comment_id": 58648736, "body": "my case the number value in define is not matched with string. Using array for a lot of data (many define value) is not good. any suggestion?"}], "tags": [], "owner": {"reputation": 735, "user_id": 2568434, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/2aDtk.jpg?s=128&g=1", "display_name": "dear_tzvi", "link": "https://stackoverflow.com/users/2568434/dear-tzvi"}, "is_accepted": false, "score": 1, "last_activity_date": 1455704453, "last_edit_date": 1495539910, "creation_date": 1455704453, "answer_id": 35453868, "question_id": 35451585, "link": "https://stackoverflow.com/questions/35451585/check-input-string-match-with-given-macro-in-c/35453868#35453868", "title": "Check input string match with given macro In C", "body": "<p>I guess you can try the following:</p>\n\n<p>Step 1 - Extract the number part out of string (e.g for MACRO_ID_48 it will be 48)</p>\n\n<ul>\n<li>There are many references for this, for example - <a href=\"https://stackoverflow.com/questions/13399594/how-to-extract-numbers-from-string-in-c\">How to extract numbers from string in c?</a></li>\n</ul>\n\n<p>Step 2 - Return the number</p>\n\n<p>Of course that this solution is only relevant for the naive approach in which the number in 'define' value name represents the value.</p>\n\n<p>Another option for you (in case the number in the 'define' name is not equal to the value -</p>\n\n<p>Step 1 - Create an array with the same size as the values of your 'define'</p>\n\n<p>Step 2 - In init, set each value in the array to match 'define' initial value</p>\n\n<p>Step 3 - Once you've parsed the number from 'string' - return value saved in the array</p>\n"}], "owner": {"reputation": 83, "user_id": 5709643, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/af562c507a7ae4aa41ba3d44a8b03289?s=128&d=identicon&r=PG&f=1", "display_name": "bvp147", "link": "https://stackoverflow.com/users/5709643/bvp147"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1455704453, "creation_date": 1455698309, "question_id": 35451585, "link": "https://stackoverflow.com/questions/35451585/check-input-string-match-with-given-macro-in-c", "title": "Check input string match with given macro In C", "body": "<p>Suppose that, I have following macros that are defined in header file:</p>\n\n<pre><code># define MACRO_ID_1        1\n# define MACRO_ID_2        2\n...\n# define MACRO_ID_1000     1000\n</code></pre>\n\n<p>In main.c, I will input a string like MACRO1, MACRO2...\nI would like to write a function to output macro from input string</p>\n\n<pre><code>int func_string2macro (char* string)\n{ \n  ...\n  return &lt;macro_similar_to_string&gt;;\n}\n</code></pre>\n\n<p>For using : func_string2macro(\"MACRO1\") then it will return MACRO_ID_1</p>\n\n<p>I found that <code>switch/case</code> can be solved this issue\nBut with a alot of macro (1000) then switch/case method is not good.</p>\n\n<p>Anyone can support me?</p>\n"}, {"tags": ["python", "c", "macos", "core-foundation", "mach"], "answers": [{"tags": [], "owner": {"reputation": 170455, "user_id": 149341, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/omfTQ.png?s=128&g=1", "display_name": "duskwuff -inactive-", "link": "https://stackoverflow.com/users/149341/duskwuff-inactive"}, "is_accepted": true, "score": 2, "last_activity_date": 1455699856, "creation_date": 1455699856, "answer_id": 35452078, "question_id": 35451564, "link": "https://stackoverflow.com/questions/35451564/running-processes-in-os-x-find-the-initiator-process/35452078#35452078", "title": "Running processes in OS X, Find the initiator process", "body": "<p>You can't. Mac OS X does not keep track of this information in the way you're looking for -- opening an application from another application does not establish a relationship of any sort between those applications.</p>\n"}], "owner": {"reputation": 3214, "user_id": 4333809, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb246fedefccc8b02a3efb989143d3b9?s=128&d=identicon&r=PG&f=1", "display_name": "Zohar81", "link": "https://stackoverflow.com/users/4333809/zohar81"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 35452078, "answer_count": 1, "score": 2, "last_activity_date": 1455699856, "creation_date": 1455698241, "last_edit_date": 1455698678, "question_id": 35451564, "link": "https://stackoverflow.com/questions/35451564/running-processes-in-os-x-find-the-initiator-process", "title": "Running processes in OS X, Find the initiator process", "body": "<p>I'd like to create a daemon (base on script or some lower level language) that calculates statistics on all opened applications according to their initiating process. The problem is that the initiating process does not always equivalent to the actual parent process.</p>\n\n<p>For instance, When I press an hyperlink from Microsoft Word that should open executable file like  <code>file:///Applications/Chess.app/</code></p>\n\n<p>In the case above, I've observed that the ppid of 'Chess' is in fact 'launchd', just the same as if I was running it from launchpad.</p>\n\n<p>Perhaps there's a mach_port (or any other) api to figure out who really initiated the application ?</p>\n"}, {"tags": ["c", "api"], "answers": [{"tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": true, "score": 3, "last_activity_date": 1455699838, "last_edit_date": 1455699838, "creation_date": 1455699263, "answer_id": 35451869, "question_id": 35451547, "link": "https://stackoverflow.com/questions/35451547/in-place-vs-allocating-api/35451869#35451869", "title": "in-place vs allocating API", "body": "<p>The thing to consider is whether the type of the object the function constructs is <em>opaque</em>. An opaque type is only forward-declared in the header file and the only thing you can do with it is having a pointer to it and passing that pointer to separately compiled API functions. <code>FILE</code> in the standard library is such an opaque type. For an opaque type, you have no option but have to provide an allocation and a deallocation function as the user has no other way to obtain a reference to an object of that type.</p>\n\n<p>If the type is not opaque \u2013 that is, the definition of the <code>struct</code> is in the header file \u2013 it is more versatile to have a function that does only <em>initialization</em> \u2013 and, if required, another that does finalization \u2013 but no allocation and deallocation. The reason is that with this interface, the <em>user</em> can decide whether to put the objects on the stack\u2026</p>\n\n<pre><code>struct widget w;\nwidget_init(&amp;w, 42, \"lorem ipsum\");\n// use widget\u2026\nwidget_fini(&amp;w);\n</code></pre>\n\n<p>\u2026or on the heap.</p>\n\n<pre><code>struct widget * wp = malloc(sizeof(struct widget));\nif (wp == NULL)\n  exit(1);  // or do whatever\nwidget_init(wp, 42, \"lorem ipsum\");\n// use widget\u2026\nwidget_fini(wp);\nfree(wp);\n</code></pre>\n\n<p>If you think that this is too much typing, you \u2013 or your users themselves \u2013 can easily provide convenience functions.</p>\n\n<pre><code>inline struct widget *\nnew_widget(const int n, const char *const s)\n{\n  struct widget wp = malloc(sizeof(struct widget));\n  if (wp != NULL)\n    widget_init(wp, n, s);\n  return wp;\n}\n\ninline void\ndel_widget(struct widget * wp)\n{\n  widget_fini(wp);\n  free(wp);\n}\n</code></pre>\n\n<p>Going the other way round is not possible.</p>\n\n<p>Interfaces should always provide the essential building blocks to compose higher-level abstractions but not make legitimate uses impossible by being overly restrictive.</p>\n\n<p>Of course, this leaves us with the question when to make a type opaque. A good rule of thumb \u2013 that I have first seen in the <a href=\"https://www.kernel.org/doc/Documentation/CodingStyle\" rel=\"nofollow\">coding standards</a> for the <em>Linux</em> kernel \u2013 might be to make types opaque only if there are no data members your users could meaningfully access. I think this rule should be refined a little to take into account that non-opaque types allow for \u201cmember\u201d functions to be provided as <code>inline</code> versions in the header files which might be desirable from a performance point of view. On the other hand, opaque types provide better encapsulation (especially since C has no way to restrict access to a <code>struct</code>'s members). I would also lean towards an opaque type more easily if making it not opaque would force me to <code>#include</code> headers into the header file of my library because they provide definitions of the types used as members in my type. (I'm okay with <code>#include</code>ing <code>&lt;stdint.h&gt;</code> for <code>uint32_t</code>. I'm a little less easy about <code>#include</code>ing a large header such as <code>&lt;unistd.h&gt;</code> and I'd certainly try to avoid having to <code>#include</code> a header from a third-party library such as <code>&lt;curses.h&gt;</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 0, "last_activity_date": 1455700361, "creation_date": 1455700361, "answer_id": 35452282, "question_id": 35451547, "link": "https://stackoverflow.com/questions/35451547/in-place-vs-allocating-api/35452282#35452282", "title": "in-place vs allocating API", "body": "<p>IMO the \"cascade of sub-allocations\" is not a problem if you keep the object opaque so you can keep it in a consistent state.  The creation and destruction routines will have some added complexity dealing with an allocation failure part way through creation, but nothing too onerous.</p>\n\n<p>Besides the option to have a static/stack-allocated copy <em>(which I'm generally not fond of anyway)</em>, in my mind, the main advantage of a scheme like:</p>\n\n<pre><code>x = initThang(thangPtr);\n</code></pre>\n\n<p>is the ease of returning a variety of more specific error codes. </p>\n"}], "owner": {"reputation": 497, "user_id": 999127, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/399d847d1294654f0eb161e26f3a589c?s=128&d=identicon&r=PG", "display_name": "airman", "link": "https://stackoverflow.com/users/999127/airman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 35451869, "answer_count": 2, "score": 3, "last_activity_date": 1455726208, "creation_date": 1455698198, "last_edit_date": 1495539900, "question_id": 35451547, "link": "https://stackoverflow.com/questions/35451547/in-place-vs-allocating-api", "title": "in-place vs allocating API", "body": "<p>I need to create a library in C and I am wondering how to manage objects: returning allocated (ex: fopen, opendir) or in-place initialization (ex: GNU hcreate_r).</p>\n\n<p>I understand that it is mostly <a href=\"https://stackoverflow.com/a/6431849\">a question of taste</a>, and I'm inclined to choose the allocating API because of the convenience when doing lazy initialization (by testing if the object pointer is NULL).</p>\n\n<p>However, after reading <a href=\"https://www.akkadia.org/drepper/cpumemory.pdf\" rel=\"nofollow noreferrer\">Ulrich's paper (PDF)</a>, I'm wondering if this design will cause locality of reference problems, especially if I compose objects from others:</p>\n\n<pre><code>struct opaque_composite {\n    struct objectx *member1;\n    struct objecty *member2;\n    struct objectz *member2;\n    /* ... */\n};\n</code></pre>\n\n<p>Allocation of such an object will make a cascade of other sub-allocations. Is this a problem in practice? And are there other issues that I should be aware of?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1455697536, "post_id": 35451312, "comment_id": 58599501, "body": "You should not be using <code>pow</code>. Did you read its documentation? Instead of <code>pow(2,i)</code>, use <code>(1&lt;&lt;i)</code>."}, {"owner": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1455697594, "post_id": 35451312, "comment_id": 58599542, "body": "In c @Magisch  (******)"}, {"owner": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1455697807, "post_id": 35451312, "comment_id": 58599672, "body": "didn&#39;t get you? what are you both saying @BLUEPIXY and David Schwartz"}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 1, "creation_date": 1455697913, "post_id": 35451312, "comment_id": 58599730, "body": "<code>pow()</code> will return a <code>double</code> value, type cast it to <code>int</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455698161, "post_id": 35451312, "comment_id": 58599860, "body": "@DeepakTalan What&#39;s don&#39;t you get? I&#39;m saying that instead of <code>pow(2,i)</code>, you should use <code>(1&lt;&lt;i)</code>, since it does what you want. You should read the documentation for <code>pow</code>, so you can see that it does not do what you want."}], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "edited": false, "score": 0, "creation_date": 1455697924, "post_id": 35451414, "comment_id": 58599737, "body": "then how do i do it ? is there a way i can achieve the same result?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "edited": false, "score": 0, "creation_date": 1455697981, "post_id": 35451414, "comment_id": 58599772, "body": "@DeepakTalan Considering your results are undefined, no. What exactly did you want to do anyways? The mathemathical operation of modulo only works for whole numbers."}, {"owner": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "edited": false, "score": 0, "creation_date": 1455698502, "post_id": 35451414, "comment_id": 58600055, "body": "problem solved , i just saved the value of pow in different variable by type casting it........................will be removing the question from here"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "reply_to_user": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "edited": false, "score": 0, "creation_date": 1455698586, "post_id": 35451414, "comment_id": 58600103, "body": "@DeepakTalan Thats not how this QA site works. Removing the question is not permitted once answers are posted. The question will remain as help to future readers with the same problem. Read <a href=\"https://stackoverflow.com/help\">help center</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. Also consider accepting the answer that helped you the most with the green checkmark."}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 0, "last_activity_date": 1455698159, "last_edit_date": 1455698159, "creation_date": 1455697670, "answer_id": 35451414, "question_id": 35451312, "link": "https://stackoverflow.com/questions/35451312/illegal-use-of-floating-point-error-while-using-pow-in-c/35451414#35451414", "title": "Illegal use of Floating point error while using &quot;pow()&quot; in C", "body": "<p>You cannot use a <code>float</code> or <code>double</code> value for modulo (<code>%</code>). The value for modulo needs to be an integer, which is what your compiler is telling you about when it gives you the error \"Illegal use of floating point\"</p>\n\n<p>You are not supposed to use the modulo operator for anything else then</p>\n\n<pre><code>&lt;integer value&gt;%&lt;integer value&gt;\n</code></pre>\n\n<p>If you just want to evaluate your <code>double</code> as if it was an <code>int</code> (without rounding), then you can just cast the <code>double</code> to <code>int</code>.</p>\n\n<p>Like this:</p>\n\n<pre><code>p%(int)(pow(2,i))!=0\n</code></pre>\n"}], "owner": {"reputation": 665, "user_id": 4446574, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/hikya.jpg?s=128&g=1", "display_name": "d02d33pak", "link": "https://stackoverflow.com/users/4446574/d02d33pak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455698159, "creation_date": 1455697318, "last_edit_date": 1455697633, "question_id": 35451312, "link": "https://stackoverflow.com/questions/35451312/illegal-use-of-floating-point-error-while-using-pow-in-c", "title": "Illegal use of Floating point error while using &quot;pow()&quot; in C", "body": "<p>I am getting \"Illegal use of floating point\" error in line no 8,10 and 12. </p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;math.h&gt;\nvoid main()\n{   int p,i,c=0;\n    scanf(\"%d\",&amp;p);\n    for(i=11;i&gt;=0;i--)\n    {   if((p==pow(2,i))&amp;&amp;(p%pow(2,i)==0))      //here\n            c++;\n        else if((p/pow(2,i)!=0)&amp;&amp;(p%pow(2,i)!=0))   //here\n        {       c++;\n            p=p%pow(2,i);               //here\n        }\n    }\n    printf(\"%d\",c);\n    getch();\n}\n</code></pre>\n\n<p>I think there is a problem while calculating the remainder of p using the pow() funciton.\nPlease help me.</p>\n"}, {"tags": ["java", "android", "c"], "comments": [{"owner": {"reputation": 740, "user_id": 3962551, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d112f36024be638be6557dd82712f573?s=128&d=identicon&r=PG", "display_name": "Logan Guo", "link": "https://stackoverflow.com/users/3962551/logan-guo"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455699220, "post_id": 35451257, "comment_id": 58600498, "body": "@MichaelWalz yes, I did, and it is correct."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455699374, "post_id": 35451257, "comment_id": 58600596, "body": "I if the output of your function is correct, you should make that clear in your question."}, {"owner": {"reputation": 740, "user_id": 3962551, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d112f36024be638be6557dd82712f573?s=128&d=identicon&r=PG", "display_name": "Logan Guo", "link": "https://stackoverflow.com/users/3962551/logan-guo"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455699557, "post_id": 35451257, "comment_id": 58600720, "body": "sorry, actually I not quite sure if that is correct"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455700511, "post_id": 35451257, "comment_id": 58601346, "body": "Still, it&#39;s part of the question. Make that clear in the question."}], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 3962551, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d112f36024be638be6557dd82712f573?s=128&d=identicon&r=PG", "display_name": "Logan Guo", "link": "https://stackoverflow.com/users/3962551/logan-guo"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699309, "creation_date": 1455699309, "answer_id": 35451893, "question_id": 35451257, "link": "https://stackoverflow.com/questions/35451257/how-to-convert-c-tohex-method-to-java/35451893#35451893", "title": "how to convert c toHex method to java", "body": "<p>Using methods below works for me</p>\n\n<pre><code>/**\n * Convert byte to Hexadecimal\n *\n * @param bytes\n * @return\n */\nprivate static String toHex(byte[] bytes) throws NoSuchAlgorithmException {\n    BigInteger bi = new BigInteger(1, bytes);\n    String hex = bi.toString(16);\n    int paddingLength = (bytes.length * 2) - hex.length();\n    if (paddingLength &gt; 0) {\n        return String.format(\"%0\" + paddingLength + \"d\", 0) + hex;\n    } else {\n        return hex;\n    }\n}\n</code></pre>\n\n<p>or another way</p>\n\n<pre><code>public static String toHex(byte[] bytes) {\n    StringBuffer buff = new StringBuffer();\n    for (byte b : bytes) {\n        buff.append(String.format(\"%02X\", b));\n    }\n    return buff.toString();\n}\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 3962551, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/d112f36024be638be6557dd82712f573?s=128&d=identicon&r=PG", "display_name": "Logan Guo", "link": "https://stackoverflow.com/users/3962551/logan-guo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455701082, "creation_date": 1455697182, "last_edit_date": 1455701082, "question_id": 35451257, "link": "https://stackoverflow.com/questions/35451257/how-to-convert-c-tohex-method-to-java", "title": "how to convert c toHex method to java", "body": "<p>Does anyone know how to convert blow code snippet to java code?\nThanks.</p>\n\n<pre><code>void\nrawdata_to_hex (const unsigned char *rawdata, char *hex_str, int n_bytes)\n{\n    static const char hex[] = \"0123456789abcdef\";\n    int i;\n\n    for (i = 0; i &lt; n_bytes; i++) {\n        unsigned int val = *rawdata++;\n        *hex_str++ = hex[val &gt;&gt; 4];\n        *hex_str++ = hex[val &amp; 0xf];\n    }\n    *hex_str = '\\0';\n}\n</code></pre>\n\n<p>I am using below code, but looks like it is not correct.</p>\n\n<pre><code>public static String toHex(byte[] buf) {\n        if (buf == null) return \"\";\n        StringBuffer result = new StringBuffer(2 * buf.length);\n        for (int i = 0; i &lt; buf.length; i++) {\n            appendHex(result, buf[i]);\n        }\n        return result.toString();\n    }\n\n    private final static String HEX = \"0123456789abcdef\";\n    private static void appendHex(StringBuffer sb, byte b) {\n        sb.append(HEX.charAt((b &gt;&gt; 4) &amp; 0x0f)).append(HEX.charAt(b &amp; 0x0f));\n    }\n</code></pre>\n\n<p>My question is how to covert that? anyone can help?</p>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 5, "last_activity_date": 1455697177, "creation_date": 1455697177, "answer_id": 35451255, "question_id": 35451189, "link": "https://stackoverflow.com/questions/35451189/is-include-a-directory-valid-in-c-project/35451255#35451255", "title": "Is #include a directory valid in C project?", "body": "<p>All <code>#include</code> does is opens the file, reads the contents, and injects those contents into the <em>preprocessed</em> source file in place of the <code>#include</code>.</p>\n\n<p>So no, attempting to <code>#include</code> a directory makes no sense.</p>\n\n<p>Although it looks syntactically correct, the preprocessor will, in your case, attempt to open <code>directory-name</code> as a file.</p>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 5938959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d946250f15ad3272599851add2d648aa?s=128&d=identicon&r=PG&f=1", "display_name": "virat", "link": "https://stackoverflow.com/users/5938959/virat"}, "is_accepted": false, "score": 0, "last_activity_date": 1455699425, "creation_date": 1455699425, "answer_id": 35451930, "question_id": 35451189, "link": "https://stackoverflow.com/questions/35451189/is-include-a-directory-valid-in-c-project/35451930#35451930", "title": "Is #include a directory valid in C project?", "body": "<p>No, this is not valid syntax for c and it will not open any directory file.\nThis doesn't make any sense in c.</p>\n"}], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 3, "accepted_answer_id": 35451255, "answer_count": 2, "score": 1, "last_activity_date": 1455699425, "creation_date": 1455696922, "last_edit_date": 1455697317, "question_id": 35451189, "link": "https://stackoverflow.com/questions/35451189/is-include-a-directory-valid-in-c-project", "title": "Is #include a directory valid in C project?", "body": "<p>I'm reusing a code that have the syntax similar to this:</p>\n\n<pre><code>#include \"..\\..\\..\\directory-name\"\n</code></pre>\n\n<p>Normally we include a file but in this case a directory is included.</p>\n\n<p><strong>Is it a valid syntax and what it will do ?</strong></p>\n"}, {"tags": ["c", "linked-list", "singly-linked-list"], "comments": [{"owner": {"reputation": 80, "user_id": 5701768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323279cd65cab37ccc7b1a86b2e5addc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve YonG", "link": "https://stackoverflow.com/users/5701768/steve-yong"}, "edited": false, "score": 0, "creation_date": 1455695842, "post_id": 35450759, "comment_id": 58598604, "body": "you cannot print in reverse way with single iteration."}, {"owner": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "reply_to_user": {"reputation": 80, "user_id": 5701768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323279cd65cab37ccc7b1a86b2e5addc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve YonG", "link": "https://stackoverflow.com/users/5701768/steve-yong"}, "edited": false, "score": 0, "creation_date": 1455695924, "post_id": 35450759, "comment_id": 58598636, "body": "@SteveYonG Oh yes he can.  He would have to use a stack.  Recursion essentially is using a stack if you think about how the call frames are loaded."}, {"owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "edited": false, "score": 0, "creation_date": 1455695974, "post_id": 35450759, "comment_id": 58598663, "body": "You know that this will run in O(N*N) because you&#39;ve your search for the previous node can only start at the head of the list? A better way is to the reverse the list (this could be done with no space overhead if a destructive operation is allowed). Then you can achieve linear runtime."}, {"owner": {"reputation": 80, "user_id": 5701768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323279cd65cab37ccc7b1a86b2e5addc?s=128&d=identicon&r=PG&f=1", "display_name": "Steve YonG", "link": "https://stackoverflow.com/users/5701768/steve-yong"}, "reply_to_user": {"reputation": 381813, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1455696075, "post_id": 35450759, "comment_id": 58598717, "body": "@TimBiegeleisen oh. in case of stack. it is possible. lol"}], "answers": [{"tags": [], "owner": {"reputation": 138000, "user_id": 5577765, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LoGpC.jpg?s=128&g=1", "display_name": "Rabbid76", "link": "https://stackoverflow.com/users/5577765/rabbid76"}, "is_accepted": false, "score": 4, "last_activity_date": 1501740193, "last_edit_date": 1501740193, "creation_date": 1455695808, "answer_id": 35450851, "question_id": 35450759, "link": "https://stackoverflow.com/questions/35450759/how-to-print-out-a-singly-linked-list-in-reverse-order/35450851#35450851", "title": "how to print out a singly linked list in reverse order?", "body": "<p>To print a single linked list in reverse order you can use a recursive function. You have to step into the recursion to the end and print the elements of the list right before you leave the recursion function:</p>\n\n<pre><code>void printReverse(node *act)\n{\n    if ( act == NULL )          // terminate if end of list is reached\n        return;\n\n    printRev( act-&gt;next );      // print next node \n    printf( \"%d \", act-&gt;info ); // print this node\n}\n</code></pre>\n\n<p>If you do not want to use recursion, you can of course reverse the list, then print the list and finally reverse it again.</p>\n\n<p>Reversing a list is not difficult. Traverse through the list, take each element and reorder it in front of the head of the list.</p>\n\n<pre><code>node * reverse(node *head)\n{\n  node *act, *prev;\n  if ( head == NULL )\n      return;\n\n  prev = head;\n  act = head-&gt;next;\n  while ( act != NULL )\n  {\n      prev-&gt;next = act-&gt;next;\n      act-&gt;next = head;\n      head = act;\n      act = prev-&gt;next;\n  }\n  return head;\n}\n\nvoid printReverse(node *head)\n{\n    node *act;\n\n    act = reverse(head);\n    while ( act != NULL )\n    {\n      printf( \"%d \", act-&gt;info ); // print this node\n      act = act-&gt;next;\n    }\n    reverse(head);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 16507, "user_id": 4787126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a822df86c907c77c792a8f91b2bab41?s=128&d=identicon&r=PG&f=1", "display_name": "Zbynek Vyskovsky - kvr000", "link": "https://stackoverflow.com/users/4787126/zbynek-vyskovsky-kvr000"}, "is_accepted": false, "score": 2, "last_activity_date": 1455696508, "last_edit_date": 1455696508, "creation_date": 1455696122, "answer_id": 35450932, "question_id": 35450759, "link": "https://stackoverflow.com/questions/35450759/how-to-print-out-a-singly-linked-list-in-reverse-order/35450932#35450932", "title": "how to print out a singly linked list in reverse order?", "body": "<p>As you want to avoid recursion, you need to reverse the list first. I see some attempt in the original code but it doesn't look correct. Try the following:</p>\n\n<pre><code>node *current = head;\nif (current != NULL) {\n    node *prev = NULL;\n    for (node *next = current-&gt;next; ; next = (current = next)-&gt;next) {\n        current-&gt;next = prev;\n        prev = current;\n        if (next == NULL)\n            break;\n    }\n}\n</code></pre>\n\n<p>Then <code>current</code> will point to the head of the list and you can traverse using the <code>next</code> link over the list. Note that it will modify your original list but this is expected as I understood the original requirement.</p>\n"}, {"tags": [], "owner": {"reputation": 15165, "user_id": 1116364, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b67dfca0caba03083330d39a304b1766?s=128&d=identicon&r=PG", "display_name": "Daniel Jour", "link": "https://stackoverflow.com/users/1116364/daniel-jour"}, "is_accepted": false, "score": 1, "last_activity_date": 1455702482, "last_edit_date": 1455702482, "creation_date": 1455701487, "answer_id": 35452708, "question_id": 35450759, "link": "https://stackoverflow.com/questions/35450759/how-to-print-out-a-singly-linked-list-in-reverse-order/35452708#35452708", "title": "how to print out a singly linked list in reverse order?", "body": "<p>The issue with the recursive algorithm is that, if you're a bit paranoid like me, the list could be large enough to cause the recursive calls to sum up and overflow the stack. If the list is from some user input then this could be used for a denial of service attack. Thus I see two reasonable choices:</p>\n\n<ol>\n<li>Create a reversed copy of the list and print that.</li>\n<li>Reverse the list in place, print it, possibly reverse it back.</li>\n</ol>\n\n<p>The later is interesting if you're working in a memory constrained setting or with large lists.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;assert.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct node {\n  int value;\n  struct node * next;\n};\n\nvoid reverse_inplace (struct node ** list) {\n  assert(list != NULL);\n  struct node * follow = NULL, * lead = *list;\n  while (lead != NULL) {\n    struct node * next = lead-&gt;next;\n    lead-&gt;next = follow;\n    follow = lead;\n    lead = next;\n  }\n  *list = follow;\n}\n\nvoid print (struct node const * head) {\n  printf(\"( \");\n  while (head) {\n    printf(\"%d \", head-&gt;value);\n    head = head-&gt;next;\n  }\n  printf(\")\");\n}\n\nvoid link (struct node * array, size_t count) {\n  struct node * follow = NULL;\n  while (count--&gt;0) {\n    array[count].next = follow;\n    follow = &amp;(array[count]);\n  }\n}\n\nvoid fill (struct node * list, int value, int const step) {\n  while (list != NULL) {\n    list-&gt;value = value;\n    value += step;\n    list = list-&gt;next;\n  }\n}\n\nint main () {\n  size_t const sizes[] = {1, 2, 6};\n  size_t const num =\n    sizeof(sizes) / sizeof(sizes[0]);\n  size_t caseId = 0;\n  for (; caseId &lt; num; ++caseId) {\n    struct node * head =\n      malloc(sizeof(*head) * sizes[caseId]);\n    printf(\"Case %zu: List of size %zu\\n\",\n      caseId, sizes[caseId]);\n    link(head, sizes[caseId]);\n    fill(head, caseId, caseId);\n    printf(\"  initial: \");\n    print(head);\n    printf(\" \\n\");\n    reverse_inplace(&amp; head);\n    printf(\" reversed: \");\n    print (head);\n    printf(\" \\n\");\n    reverse_inplace(&amp; head);\n    free(head);\n  }\n  printf(\"Case %zu: empty list \\n\", caseId);\n  struct node * head = NULL;\n  printf(\"  initial: \");\n  print(head);\n  printf(\" \\n\");\n  reverse_inplace(&amp; head);\n  printf(\"  reversed: \");\n  print(head);\n  printf(\" \\n\");\n  return 0;\n}\n</code></pre>\n\n<p>(<a href=\"http://ideone.com/LPxVf8\" rel=\"nofollow\">Live on ideone</a>)</p>\n"}], "owner": {"reputation": 57, "user_id": 5859124, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/fece78dcdfa9ccbe56f402420c561879?s=128&d=identicon&r=PG&f=1", "display_name": "david", "link": "https://stackoverflow.com/users/5859124/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1527775792, "creation_date": 1455695500, "last_edit_date": 1527775792, "question_id": 35450759, "link": "https://stackoverflow.com/questions/35450759/how-to-print-out-a-singly-linked-list-in-reverse-order", "title": "how to print out a singly linked list in reverse order?", "body": "<pre><code>struct node\n{\n  int info;\n  struct node *next;\n};\ntypedef struct node node;\n\nvoid *printRev(node *head){\n      int count=0;\n      int i;\n      node *beforeFin;\n      node *tempHead;\n      tempHead = head;\n\n      while(tempHead-&gt;next != NULL){\n          count++;\n          tempHead-&gt;next = tempHead-&gt;next-&gt;next; //LAST ITERATION SHOULD BE AT THE END OF LIST\n      }\n      printf(\"COUNT IS: %d\\n\", count);\n      for(i = 0; i &lt;= count; i++){\n        beforeFin = Prev(head, tempHead-&gt;next);\n        printf(\"%d\", beforeFin-&gt;info);\n      }\n      printf(\"\\n\");\n    }\n</code></pre>\n\n<p>As of now this prints out: </p>\n\n<pre><code>COUNT IS: 3\nSegmentation fault (core dumped)\n</code></pre>\n\n<p><code>Prev</code> returns a pointer to the node before the given pointer (<code>tempHead-&gt;next</code>) my intention was for this to print out the singly linked list in reverse order using the for loop above. So the <code>-&gt;info</code> of the given node should return 5 in the example below (after the first iteration).</p>\n\n<p>Before the <code>printf</code> that prints the count, <code>tempHead-&gt;next</code> should point to the final node.</p>\n\n<p>Right now I am passing in <code>2 3 5 4</code> and this is giving me the count before the 4. Id like for this to print out <code>4 5 3 2</code></p>\n\n<p>I would appreciate any help given, I am a beginner as you might be able to tell. Thank you all in advance!</p>\n\n<p><strong>I could do this using recursion but I'd like to learn figure out this method.</strong></p>\n"}, {"tags": ["c++", "c", "embedded", "microcontroller", "8051"], "comments": [{"owner": {"reputation": 7369, "user_id": 2436655, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f13e1ea8bbf6506462623c85acb8e32?s=128&d=identicon&r=PG&f=1", "display_name": "pzaenger", "link": "https://stackoverflow.com/users/2436655/pzaenger"}, "edited": false, "score": 3, "creation_date": 1455694901, "post_id": 35450532, "comment_id": 58598102, "body": "<code>void data(char TxBits) {</code> =&gt; <code>void data(char[] TxBits) {</code>. And <code>i &lt; nTxBits</code> won&#39;t work."}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455695722, "post_id": 35450532, "comment_id": 58598541, "body": "I have defined nTxBits as:int nTxBits = sizeof(TxBits)/sizeof(char);"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1455695824, "post_id": 35450532, "comment_id": 58598593, "body": "@sss put code inside backticks <code>like this</code> to make it readable"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1455695835, "post_id": 35450532, "comment_id": 58598598, "body": "Is <code>data segment too large</code> the exact error message ? Because you have indeed an error in your code (<code>void data(char TxBits)</code> shoud be <code>void data(char *TxBits)</code>), but the message suggests a problem of memory model (small or tiny) that old MS/DOS compilers like TurboC++ used to issue."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 1, "creation_date": 1455695936, "post_id": 35450532, "comment_id": 58598644, "body": "And C and C++ are different languages, so please choose your own (here my advice would be C) or explain why the question concerns both."}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455697102, "post_id": 35450532, "comment_id": 58599216, "body": "Yes, &quot; &#39;DATA&#39;: SEGMENT TOO LARGE &quot; is the error popping up while compiling"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1455697203, "post_id": 35450532, "comment_id": 58599280, "body": "@sss At this point we need to know, at least: What paltform? Which compiler?"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455697261, "post_id": 35450532, "comment_id": 58599313, "body": "The array doesn&#39;t look very big. What happens of you reduce the <code>TxBits</code> array so say 8 elements ? Maybe the problem is elsewhere."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455697478, "post_id": 35450532, "comment_id": 58599460, "body": "I cannot imagine that this array makes the data segment too large, even on an arduino. You can check <a href=\"http://playground.arduino.cc/Main/CorruptArrayVariablesAndMemory\" rel=\"nofollow noreferrer\">playground.arduino.cc/Main/CorruptArrayVariablesAndMemory</a> for a discussion of object sizes, types and where they are stored. There is a possibility that declaring objects <code>const</code> will make them end up in read-only memory which may have more space, but I have no practical experience what else needs to be done in the build process to achieve that."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455697644, "post_id": 35450532, "comment_id": 58599574, "body": "@PeterA.Schneider It depens on the rest of code. Maybe there are other arrays or big RAM allocate dtsructures. BTW OP could try to change the declaration to <code>const char</code> to move array to flash memory."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455697732, "post_id": 35450532, "comment_id": 58599622, "body": "@LPs Yes, flash was what I thought too. Perhaps you have practical advice for the OP about that? And -- if there is indeed a large array which the OP didn&#39;t tell us about I&#39;ll be kinda mad ;-)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455697970, "post_id": 35450532, "comment_id": 58599761, "body": "@PeterA.Schneider I&#39;m trying to help him answering to his comments of answer."}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455698410, "post_id": 35450532, "comment_id": 58600007, "body": "@LPs I am using Silicon labs IDE"}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455698456, "post_id": 35450532, "comment_id": 58600034, "body": "@PeterA.Schneider yeah there is another huge array in a config file. Sorry for not letting know before"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455698779, "post_id": 35450532, "comment_id": 58600222, "body": "On your 8051, you have 127 byte of data segment. As suggested you could declare <code>TxBits</code> as <code>const char</code>. This will put the array in the code space."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455698997, "post_id": 35450532, "comment_id": 58600355, "body": "@sss So I think we got to the bottom of it, and I&#39;m only a little bit mad.... ;-)."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1455699284, "post_id": 35450532, "comment_id": 58600542, "body": "@sss BTW, I don&#39;t know Silicon Labs IDE and compiler, but probably there is somewhere the option to set the memory model used by application. Take a look <a href=\"https://www.silabs.com/Support%20Documents/TechnicalDocs/an143.pdf\" rel=\"nofollow noreferrer\">HERE</a> it could drive you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1455699385, "post_id": 35450532, "comment_id": 58600601, "body": "Using C++ on a 8051 core is like trying to squeeze a dull elephant into a rusty Lada from the 1980. Just my personal opinion of course."}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455700393, "post_id": 35450532, "comment_id": 58601278, "body": "@Lundin thanks for the solution. It worked for me."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455704033, "post_id": 35450532, "comment_id": 58604023, "body": "@Lundin &#39;C++&#39; and &#39;8051&#39; in the same sentence without the phrase &#39;don&#39;t even think about it&#39;.  Strange:("}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455704779, "post_id": 35450532, "comment_id": 58604581, "body": "@MartinJames Personally I would prefer to squeeze an energetic, not yet housebroken chihuahua into a modern SUV (C on ARM)."}], "answers": [{"tags": [], "owner": {"reputation": 6315, "user_id": 1460461, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/dLO8S.png?s=128&g=1", "display_name": "Benvorth", "link": "https://stackoverflow.com/users/1460461/benvorth"}, "is_accepted": false, "score": 0, "last_activity_date": 1455695256, "creation_date": 1455695256, "answer_id": 35450693, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling/35450693#35450693", "title": "data segment too large while compiling", "body": "<p>Your Parameter is not declared correctly. Replace  this:</p>\n\n<pre><code>void data(char TxBits)\n</code></pre>\n\n<p>by this</p>\n\n<pre><code>void data(char [] TxBits)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455696816, "post_id": 35450761, "comment_id": 58599082, "body": "I have edited the code according to the comments. Still, the error persists"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455696976, "post_id": 35450761, "comment_id": 58599157, "body": "@sss what is your platform? Try to change <code>char TxBits[]</code> to <code>const char TxBits[]</code>"}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455697226, "post_id": 35450761, "comment_id": 58599293, "body": "I am using Silicon labs IDE for embedded application"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455697296, "post_id": 35450761, "comment_id": 58599331, "body": "@sss ok, but which MCU? How much RAM? I&#39;m guessing you finished your space to allocate the whole array..."}, {"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455698339, "post_id": 35450761, "comment_id": 58599962, "body": "I am using C8051F930 on a development board"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 2, "creation_date": 1455699017, "post_id": 35450761, "comment_id": 58600370, "body": "@sss I think the proper solution is to laugh Silabs in the face everytime they try to peddle you some 1980s technology. But even Silabs have ARM cores nowadays, there should be no reason for you to use that old crap."}], "tags": [], "owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "is_accepted": false, "score": 0, "last_activity_date": 1455696475, "last_edit_date": 1455696475, "creation_date": 1455695507, "answer_id": 35450761, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling/35450761#35450761", "title": "data segment too large while compiling", "body": "<p>Your function</p>\n\n<pre><code>void data(char TxBits)\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>void data(char *TxBits, size_t nTxBits)\n{\n    int i;\n\n    for (i = 0;i &lt; nTxBits;i++)\n    {\n        gpio=TxBits[i];    \n        wait(loopcount);\n    }\n}\n</code></pre>\n\n<p>You can call it by:</p>\n\n<pre><code>data ( TxBits, sizeof(TxBits)/sizeof(TxBits[0]) );\n</code></pre>\n\n<p>In this specific case, you have a <code>char</code> array, and you can also write:</p>\n\n<pre><code>data (TxBits, sizeof(TxBits));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455697034, "post_id": 35450771, "comment_id": 58599186, "body": "Do I understand correctly that the OP incorporated your suggestions in his post now with the last edit? I.e. if his problem persists, this does not solve it."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455697182, "post_id": 35450771, "comment_id": 58599265, "body": "@PeterA.Schneider it seem so. But anyway the OP&#39;s original code was clearly wrong anyway."}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 1, "last_activity_date": 1455695715, "last_edit_date": 1455695715, "creation_date": 1455695543, "answer_id": 35450771, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling/35450771#35450771", "title": "data segment too large while compiling", "body": "<p>You probably need this:</p>\n\n<pre><code>void data(char *TxBits, int size)  // size of the number of elements of your table\n{\n  int i;\n\n  for (i = 0;i &lt; size; i++)\n  {\n    gpio=TxBits[i];    \n    wait(loopcount);\n  }\n}\n</code></pre>\n\n<p>Calling the function</p>\n\n<pre><code>data(TxBits, sizeof(TxBits) / sizeof(TxBits[0]);\n</code></pre>\n\n<p>To get the number of elements of an array we use <code>sizeof(TxBits) / sizeof(TxBits[0]</code> where <code>sizeof(TxBits)</code> is the number of bytes the array takes in memory and <code>sizeof(TxBits[0]</code> is the size of one element of the array.</p>\n"}, {"tags": [], "owner": {"reputation": 1575, "user_id": 5082337, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/602d82f37f432daa9a2e1907a3f02b83?s=128&d=identicon&r=PG", "display_name": "Marinos K", "link": "https://stackoverflow.com/users/5082337/marinos-k"}, "is_accepted": false, "score": 2, "last_activity_date": 1455697509, "creation_date": 1455697509, "answer_id": 35451366, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling/35451366#35451366", "title": "data segment too large while compiling", "body": "<p>From your code I reckon you're working with some micro-controller so I'm not sure if you're serious about the C++ tag or not. If you are, this is a C++-style solution which uses <code>std::bitset</code> (specialised container for dealing with bits which will require less space):</p>\n\n<pre><code>std::bitset&lt;134&gt; foo (std::string(\"01010101010101010101010100101010101010101010101010010101010101010101010101001010101010101010101010100101010101010101010101010100000000\"));\n\nvoid data(const std::bitset&amp; bitset, int loopcount) {\n  // if C++11 \n  for (auto&amp; bit : foo) {\n    gpio = bit;\n    wait(loopcount);\n  }\n\n  // if C++98\n  // for (int i = 0; i&lt;bitset.size(); i++) {\n  //   gpio = foo[i];\n  //   wait(loopcount);\n  // }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455778062, "post_id": 35451607, "comment_id": 58643807, "body": "so having changed the TxBits array as above, I need to transmit each bit inside a byte with MSB as first to Data Tx() function. Can you let me know how to proceed?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "edited": false, "score": 0, "creation_date": 1455779789, "post_id": 35451607, "comment_id": 58644585, "body": "@sss Study binary and hex numbers to begin with. IMO everyone should be doing that before even considering to take on programming."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1455698397, "creation_date": 1455698397, "answer_id": 35451607, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling/35451607#35451607", "title": "data segment too large while compiling", "body": "<blockquote>\n  <p>I am passing an array of bits to some other function</p>\n</blockquote>\n\n<p>No, you are passing an array of bytes, each byte having the binary value 00000000 or 00000001.</p>\n\n<p>In order to save memory, you should store bit values as actual bits and not as bytes:</p>\n\n<pre><code>uint8_t TxBits[]=\n{  0x55, // 0,1,0,1,0,1,0,1,\n   0x55, // 0,1,0,1,0,1,0,1,\n   0x55, // 0,1,0,1,0,1,0,1,\n   0x00, // 0,0,0,0,0,0,0,0,\n   0x20, // 0,0,1,0,0,0,0,0,\n   ...\n};\n\nsize_t nTxBits = sizeof(TxBits) / 8;\n</code></pre>\n\n<p>You should also avoid the <code>char</code> type whenever doing arithmetic, since it has implementation-defined signedness.</p>\n\n<p>Also if this is a small microcontroller system, you should allocate the data in ROM instead of RAM whenever possible. That is: <code>const uint8_t TxBits[]</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 5938968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b445009f1e58bceccf8b9d42064b9cd4?s=128&d=identicon&r=PG&f=1", "display_name": "sss", "link": "https://stackoverflow.com/users/5938968/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "answer_count": 5, "score": 0, "last_activity_date": 1455698882, "creation_date": 1455694722, "last_edit_date": 1455698882, "question_id": 35450532, "link": "https://stackoverflow.com/questions/35450532/data-segment-too-large-while-compiling", "title": "data segment too large while compiling", "body": "<p>Here, I am passing an array of bits to some other function.\nSince, array size is too large, it throws an error saying \"data segment too large\" while compiling.</p>\n\n<p>I have newly edited the code. But, the error: data segment too large still exists</p>\n\n<p>This is the code:</p>\n\n<pre><code>char TxBits[]={0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,     \n               0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,1,0,0,1,0,1,0,1,1,0,1,1,0,1,1,1,0,\n               0,0,0,1,1,0,0,0,1,0,0,1,0,0,1,1,1,1,1,1,0,1,0,1,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,\n               0,0,0,0,0,0,0,0,0,0,0,0,0,0};\n\n int nTxBits = sizeof(TxBits)/sizeof(char);\n\nvoid data(char *TxBits,int nTxBits, int loopcount)\n{\n\n  int i;\n\n  for (i = 0;i &lt; nTxBits;i++)\n  {\n\n    gpio=TxBits[i];    \n    wait(loopcount);\n  }\n\n}\n</code></pre>\n\n<p>So, I am thinking of converting bits in an array to bytes and passing to function. May I know how to proceed? open to suggestions.\nKindly reply</p>\n"}, {"tags": ["c++", "c", "mongodb"], "answers": [{"tags": [], "owner": {"reputation": 1711, "user_id": 3093018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/891cb1871d92c0260b98bd5c7ddd1cd4?s=128&d=identicon&r=PG&f=1", "display_name": "bauman.space", "link": "https://stackoverflow.com/users/3093018/bauman-space"}, "is_accepted": true, "score": 1, "last_activity_date": 1457403145, "creation_date": 1457403145, "answer_id": 35857667, "question_id": 35450340, "link": "https://stackoverflow.com/questions/35450340/mongodb-c-driver-mongoc-collection-find-cant-find-document-by-field/35857667#35857667", "title": "MongoDB C driver mongoc_collection_find() can&#39;t find Document by field", "body": "<pre><code>bool b = BSON_APPEND_INT64(query,\"Obj.Num\",1111111111111);\ncollection = mongoc_client_get_collection(m_mogoClient,\"CollectionDB\",\"TestCollection\");\ncursor = mongoc_collection_find (collection, MONGOC_QUERY_NONE, 0, 0, 0, query, NULL, NULL);\n</code></pre>\n\n<p>Hopefully you figured it out by now.  </p>\n\n<p>the dot notation in bson b (line1) needs to be the namespace of the field</p>\n\n<p>the Collection name (line 2 &amp; referenced in your shell code) was mashup of the collection name and the namespace.  It should be contain the database name and the collection name only.</p>\n"}], "owner": {"reputation": 26119, "user_id": 63898, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/88464b7b200398866f216092f01747ed?s=128&d=identicon&r=PG", "display_name": "user63898", "link": "https://stackoverflow.com/users/63898/user63898"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 393, "favorite_count": 0, "accepted_answer_id": 35857667, "answer_count": 1, "score": 1, "last_activity_date": 1457403145, "creation_date": 1455693984, "question_id": 35450340, "link": "https://stackoverflow.com/questions/35450340/mongodb-c-driver-mongoc-collection-find-cant-find-document-by-field", "title": "MongoDB C driver mongoc_collection_find() can&#39;t find Document by field", "body": "<p>i try to find document by field name which is inside object .\ni have this 1 document inside collection names \"TestCollection\"  </p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"56c2f0f3892b312e740041a1\"),\n    \"Obj\" : {\n        \"Type\" : 0,\n        \"Num\" : NumberLong(1111111111111)\n    }\n}\n</code></pre>\n\n<p>Based on this tutorial : <a href=\"http://api.mongodb.org/c/current/tutorial.html#find\" rel=\"nofollow\">http://api.mongodb.org/c/current/tutorial.html#find</a><br>\nAnd this API doc about \"find\" i learn that i need to use dot notation to search by  Obj.Num\nI try to find this document like this : </p>\n\n<pre><code>mongoc_collection_t *collection  = NULL;\nmongoc_cursor_t *cursor  = NULL;\nconst bson_t *doc  = NULL;\nchar *str = NULL;\nbson_t * query = bson_new ();\nstd::string str;\nbool b = BSON_APPEND_INT64(query,\"TestCollection.Num\",1111111111111);\n// b is true\ncollection = mongoc_client_get_collection(m_mogoClient,\"CollectionDB\",\"Obj.Num\");\ncursor = mongoc_collection_find (collection, MONGOC_QUERY_NONE, 0, 0, 0, query, NULL, NULL);\n\n\n\n\n while (mongoc_cursor_next (cursor, &amp;doc)) {\n             //it is never gets here to print the document \n             str = bson_as_json (doc, NULL);\n             printf (\"%s\\n\", str);\n             bson_free (str);\n}\n\nbson_destroy (query);\nmongoc_cursor_destroy (cursor);\nmongoc_collection_destroy (collection);\n</code></pre>\n\n<p>to test the query i run it in the mongoDB shell \nand i did get back the document result as you see :</p>\n\n<pre><code>&gt; use CollectionDB\nswitched to db CollectionDB\n&gt; db\nCollection\n&gt; db.TestCollection.find(\n... {\n... \"Obj.Num\":1111111111111\n... }\n... )\n{ \"_id\" : ObjectId(\"56c2f0f3892b312e740041a1\"), \"Obj\" : { \"Type\" : 0, \"Num\" : NumberLong(\"1111111111111\") } }\n\n&gt;\n</code></pre>\n\n<p>what is wrong in the c code , why it is not giving me back result ?\nthanks</p>\n"}, {"tags": ["c", "performance"], "comments": [{"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 8, "creation_date": 1455693613, "post_id": 35450237, "comment_id": 58597461, "body": "Don&#39;t you need to increment <code>data</code> in the loop too?"}, {"owner": {"reputation": 109956, "user_id": 159145, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/r8ryC.png?s=128&g=1", "display_name": "Dai", "link": "https://stackoverflow.com/users/159145/dai"}, "edited": false, "score": 2, "creation_date": 1455693779, "post_id": 35450237, "comment_id": 58597543, "body": "Use something like SIMD to process the data faster."}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1455693819, "post_id": 35450237, "comment_id": 58597565, "body": "Why are you using <code>void*</code> instead of <code>char*</code> for your data if the data is chars?"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 2, "creation_date": 1455693862, "post_id": 35450237, "comment_id": 58597588, "body": "Also, don&#39;t you need to do <code>if(data[i]) return 0;</code> ?"}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 10, "creation_date": 1455695598, "post_id": 35450237, "comment_id": 58598457, "body": "if you want to zero data at allocation time then <code>calloc</code> is much faster than <code>malloc</code> then zero"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1455696288, "post_id": 35450237, "comment_id": 58598814, "body": "IMHO, this is one of those cases where inline assembly is probably your best bet."}, {"owner": {"reputation": 186, "user_id": 4354782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cc1c4f1cf4c512ebeba91928d9e27?s=128&d=identicon&r=PG&f=1", "display_name": "orion", "link": "https://stackoverflow.com/users/4354782/orion"}, "edited": false, "score": 0, "creation_date": 1455697977, "post_id": 35450237, "comment_id": 58599770, "body": "Which compiler do you use? What are the optimization flags? The compiler may do a better job at optimizing than you will without the expense of obfuscating the code (in production, it&#39;s undesirable to have &quot;magic code&quot; that noone can debug)."}, {"owner": {"reputation": 744, "user_id": 4877405, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/104Vt.jpg?s=128&g=1", "display_name": "Ringo_D", "link": "https://stackoverflow.com/users/4877405/ringo-d"}, "reply_to_user": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1455700827, "post_id": 35450237, "comment_id": 58601578, "body": "@AndyTurner Sorry I miss it. Added now."}, {"owner": {"reputation": 744, "user_id": 4877405, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/104Vt.jpg?s=128&g=1", "display_name": "Ringo_D", "link": "https://stackoverflow.com/users/4877405/ringo-d"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1455701453, "post_id": 35450237, "comment_id": 58602034, "body": "@L\u01b0uV\u0129nhPh&#250;c I learn a lot!"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 4, "creation_date": 1455709680, "post_id": 35450237, "comment_id": 58608090, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1493936/faster-approach-to-checking-for-an-all-zero-buffer-in-c\">Faster approach to checking for an all-zero buffer in C?</a>, although that question doesn&#39;t have any great answers :/  Also found <a href=\"http://stackoverflow.com/questions/15172102/using-c-intel-assembly-what-is-the-fastest-way-to-test-if-a-128-byte-memory-blo\">Using C/Intel assembly, what is the fastest way to test if a 128-byte memory block contains all zeros?</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455711213, "post_id": 35450237, "comment_id": 58609110, "body": "Also, took me forever to find, but I knew I&#39;d seen this recently: <a href=\"http://stackoverflow.com/questions/35132492/how-to-get-gcc-to-generate-decent-code-that-checks-if-a-buffer-is-full-of-nul-by\">How to get gcc to generate decent code that checks if a buffer is full of NUL bytes?</a>.  This question itself is a decent answer to the others.  It mentions the <code>int foo(const char usth[static 512])</code> syntax to try to convince the compiler that it&#39;s ok to auto-vectorize in a way that reads data the scalar code wouldn&#39;t have.  (but which unfortunately gcc and clang don&#39;t seem to take advantage of)."}, {"owner": {"reputation": 21267, "user_id": 8014, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9a51b486fec41adca6738d37f0d9cb3a?s=128&d=identicon&r=PG", "display_name": "Oddthinking", "link": "https://stackoverflow.com/users/8014/oddthinking"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1455718231, "post_id": 35450237, "comment_id": 58614202, "body": "@SouravGhosh: I believe the memset is just some example test harness code to create the array, and that his real data will not necessarily be all zeros, so it will need checking."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1455721912, "post_id": 35450237, "comment_id": 58617146, "body": "@L\u01b0uV\u0129nhPh&#250;c <i>if you want to zero data at allocation time then <code>calloc</code> is much faster than <code>malloc</code> then zero</i>  One thing to be aware of, though, is <code>calloc</code> can provide zero&#39;d <i>virtual</i> memory without actually creating the physical mapping. If you actually need the physical mapping for some reason (memory to store data read from a <i>fast</i> device, for example), you may actually need the pages to be mapped and actually zero the memory to force the mapping to be created.  See <a href=\"http://stackoverflow.com/questions/2688466/why-mallocmemset-is-slower-than-calloc\" title=\"why mallocmemset is slower than calloc\">stackoverflow.com/questions/2688466/&hellip;</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1455737566, "post_id": 35450237, "comment_id": 58627646, "body": "@AndrewHenle: That&#39;s true if burning CPU time between allocation and the first <code>read</code> is ok.  Otherwise, you might as well let the first <code>read</code> trigger the copy-on-write allocation of physical pages to back the mapping.  Subsequent writes to the buffer (including further <code>read(2)</code> system calls) will be just as fast either way.  You could also use <code>madvise(MADV_HUGEPAGE)</code> to get the memory wired, and as a bonus, have it use transparent hugepages.  Interesting reading for the opposite problem (turning dirty pages back into copy-on-write zero pages): <a href=\"http://stackoverflow.com/q/21722545/224132\">stackoverflow.com/q/21722545/224132</a>"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1455737767, "post_id": 35450237, "comment_id": 58627796, "body": "@Andrew: there&#39;s also <code>mlock</code>, or <code>mmap(MAP_LOCKED)</code> for getting already-wired zeroed pages that won&#39;t pagefault when you first touch them.  You&#39;d probably want to combine this with <code>MAP_HUGETLB</code>, since hugepages can&#39;t be swapped out (and I don&#39;t think they start COW-mapped to a single zero page)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455739313, "post_id": 35450237, "comment_id": 58628811, "body": "@PeterCordes <i>That&#39;s true if burning CPU time between allocation and the first read is ok. Otherwise, you might as well let the first read trigger the copy-on-write allocation of physical pages to back the mapping</i> Usually true. I was merely pointing out that <code>calloc()</code> doesn&#39;t necessarily create physical mappings despite zeroing out the memory.  That can matter if the device being read can deliver data faster than the OS can map the pages. Thanks for pointing out other options for getting already-mapped memory. And for mentioning <code>MAP_HUGETLB</code>, another high-performance tool too often ignored."}, {"owner": {"reputation": 12992, "user_id": 2170527, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64f36e49ac8529003cf57c003746388b?s=128&d=identicon&r=PG", "display_name": "yugr", "link": "https://stackoverflow.com/users/2170527/yugr"}, "edited": false, "score": 0, "creation_date": 1485160030, "post_id": 35450237, "comment_id": 70791450, "body": "I&#39;ve tried asking Glibc to implement an <a href=\"https://sourceware.org/bugzilla/show_bug.cgi?id=21018\" rel=\"nofollow noreferrer\">API for this</a> but it got rejected."}], "answers": [{"comments": [{"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "edited": false, "score": 0, "creation_date": 1455694243, "post_id": 35450335, "comment_id": 58597783, "body": "I also don&#39;t know the reason of the downvote. The idea seems really smart :) and I personally like it. Therefore one upvote from me. Perhaps some insignificant type cast is required, but this is only cosmetic improvement."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 4, "creation_date": 1455695611, "post_id": 35450335, "comment_id": 58598463, "body": "This solution is not really efficient: <code>memcmp</code> is given unaligned pointers: it cannot use optimized code that compares multiple byte at a time efficiently.  Furthermore, comparing bytes from memory is less efficient than comparing bytes to a constant value.  I did not downvote, but I understand those who did."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1455695949, "post_id": 35450335, "comment_id": 58598649, "body": "@chqrlie not necessarily, it depends on the implementation of memcmp. Some of them check if pointers are aligned and change the algorithm accordingly."}, {"owner": {"reputation": 1423, "user_id": 5700944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3eb2f574da513288b45bde6de8f06999?s=128&d=identicon&r=PG&f=1", "display_name": "dmi", "link": "https://stackoverflow.com/users/5700944/dmi"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1455696069, "post_id": 35450335, "comment_id": 58598712, "body": "@chqrlie, in my opinion memcmp should be much optimized comparing to the solution given by the topic starter for a particular platform. Besides that, the question refers to the memory block allocated by malloc, and thus the memcmp is leagable to be used with respect to the mem alignment. Thus I find the answer still very good. Perhaps the applicability of the proposed solution for particular task should be considered, but this IMHO is out of topic."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 5, "creation_date": 1455696405, "post_id": 35450335, "comment_id": 58598866, "body": "@MichaelWalz I think his point was that because of <code>data, data+1</code>, both pointers <i>cannot</i> be aligned."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1455697604, "post_id": 35450335, "comment_id": 58599550, "body": "@chqrlie: The function should be written to allow both pointers to be aligned, but other than that the performance of any approach not using compiler intrinsics will be limited by the fact that even on platforms which have unsigned integer types with no padding, the Standard forbids the use of any such type larger than &quot;unsigned char&quot; to read data written as other types even when pointers are perfectly aligned."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1455700482, "post_id": 35450335, "comment_id": 58601327, "body": "@supercat Strict aliasing rules (or any other language rules) don&#39;t apply to implementation of C standard library functions. As long as <code>memcmp</code> behaves as standard says, code inside can use any types it wishes. Functions don&#39;t even have to be written in C."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455706498, "post_id": 35450335, "comment_id": 58605841, "body": "@MichaelWalz: that&#39;s exactly what I am hinting at, the naive <code>check_bytes</code> calls <code>memcmp</code> with pointers only 1 byte apart, defeating any such attempt for alignment based optimizations."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455728431, "post_id": 35450335, "comment_id": 58622040, "body": "@user694733: You noted that an approach comparing bytes in memory to other bytes in memory will be less efficient than comparisons to a constant.  While that should be the case, my point was that since there are no compiler intrinsics to scan for the first thing that doesn&#39;t match a constant, and since code which doesn&#39;t use compiler intrinsics is (IMHO annoyingly and stupidly) limited to processing one byte at a time, memcmp may, even with such overhead, come out ahead of anything that could be written without the use of compiler intrinsics,"}], "tags": [], "owner": {"reputation": 7964, "user_id": 1072468, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cb56d2bf7341a5092975ce5c7af50b6e?s=128&d=identicon&r=PG", "display_name": "Nicu Stiurca", "link": "https://stackoverflow.com/users/1072468/nicu-stiurca"}, "is_accepted": false, "score": 5, "last_activity_date": 1455698948, "last_edit_date": 1455698948, "creation_date": 1455693964, "answer_id": 35450335, "question_id": 35450237, "link": "https://stackoverflow.com/questions/35450237/fastest-way-to-check-mass-data-if-null-in-c/35450335#35450335", "title": "Fastest way to check mass data if null in C?", "body": "<p>The following checks if the first byte is what you want, and all subsequent pairs of bytes are the same.</p>\n\n<pre><code>int check_bytes(const char * const data, size_t length, const char val)\n{\n    if(length == 0) return 1;\n    if(*data != val) return 0;\n    return memcmp(data, data+1, length-1) ? 0 : 1;\n}\n\nint check_bytes64(const char * const data, size_t length, const char val)\n{\n    const char * const aligned64_start = (char *)((((uintptr_t)data) + 63) / 64 * 64);\n    const char * const aligned64_end = (char *)((((uintptr_t)data) + length) / 64 * 64);\n    const size_t start_length = aligned64_start - data;\n    const size_t aligned64_length = aligned64_end - aligned64_start;\n    const size_t end_length = length - start_length - aligned64_length;\n\n    if (!check_bytes(data, start_length, val)) return 0;\n    if (!check_bytes(aligned64_end, end_length, val)) return 0;\n\n    return memcmp(aligned64_start, aligned64_start + 64, aligned64_length-64) ? 0 : 1;\n}\n</code></pre>\n\n<p>A more elaborate version of this function should probably pass cache-line-aligned pointers to <code>memcmp</code>, and manually check the remaining blocks(s) instead of just the first byte.</p>\n\n<p>Of course, you will have to profile on your specific hardware to see if there is any speed benefit of this method vs others.</p>\n\n<p>If anyone doubts whether this works, <a href=\"http://ideone.com/BJro86\" rel=\"nofollow\">ideone</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 6223, "user_id": 2726892, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/DE8Dn.png?s=128&g=1", "display_name": "MooseBoys", "link": "https://stackoverflow.com/users/2726892/mooseboys"}, "edited": false, "score": 0, "creation_date": 1455696700, "post_id": 35450498, "comment_id": 58599021, "body": "Could you use something like <a href=\"https://en.wikipedia.org/wiki/Duff%27s_device\" rel=\"nofollow noreferrer\">Duff&#39;s device</a> to parameterize the unroll factor?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1455697348, "post_id": 35450498, "comment_id": 58599365, "body": "That code will invoke Undefined Behavior in C99, C11, or C14 if the data in question has an effective type which is something other than a size_t or a signed equivalent.  Note that for purpose of C99&#39;s aliasing rules, <code>int</code> and <code>long</code> are different types; even if both are the same size as <code>size_t</code>, at most one of them will be an equivalent type for purpose of aliasing rules.  Your approach would be a good one in most sensible dialects of C, but not in C99, C11, or C14 as defined by the Standards."}, {"owner": {"reputation": 186, "user_id": 4354782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cc1c4f1cf4c512ebeba91928d9e27?s=128&d=identicon&r=PG&f=1", "display_name": "orion", "link": "https://stackoverflow.com/users/4354782/orion"}, "edited": false, "score": 1, "creation_date": 1455697872, "post_id": 35450498, "comment_id": 58599704, "body": "Compilers are quite complex and unpredictable. I&#39;m concerned that because the compiler can&#39;t verify the alignment of the incoming pointer at compile-time, it will produce expensive instructions (a lot of fast instructions only work on aligned addresses). Also, peeking into the assembler at different levels of optimizations may reveal the compiler is already attempting to unroll the loops and group the branches (speculative execution)."}, {"owner": {"reputation": 3541, "user_id": 3375011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b8f530efa8f910230c1ec4514abf5?s=128&d=identicon&r=PG&f=1", "display_name": "Davidmh", "link": "https://stackoverflow.com/users/3375011/davidmh"}, "edited": false, "score": 4, "creation_date": 1455699552, "post_id": 35450498, "comment_id": 58600717, "body": "Is the loop unrolling actually providing a speed up? It looks like something the compiler should be quite good at. GCC has <code>-funroll-loops</code> to do this automatically."}, {"owner": {"reputation": 744, "user_id": 4877405, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/104Vt.jpg?s=128&g=1", "display_name": "Ringo_D", "link": "https://stackoverflow.com/users/4877405/ringo-d"}, "edited": false, "score": 0, "creation_date": 1455701184, "post_id": 35450498, "comment_id": 58601835, "body": "Thanks for your answering. I have seen this kind of code before. But why it is faster? Is it compiler make something magical for &quot;|&quot; operator?"}, {"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1455703009, "post_id": 35450498, "comment_id": 58603189, "body": "@supercat What is C14? The new C standard? Even wikipedia doesn&#39;t have an article for it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 744, "user_id": 4877405, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/104Vt.jpg?s=128&g=1", "display_name": "Ringo_D", "link": "https://stackoverflow.com/users/4877405/ringo-d"}, "edited": false, "score": 1, "creation_date": 1455705622, "post_id": 35450498, "comment_id": 58605204, "body": "@Ringo_D: it should be faster because there are fewer test and branches. fewer comparisons with <code>0</code>, fewer bound tests because of reading multiple bytes at a time and unrolling the loop."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1455706110, "post_id": 35450498, "comment_id": 58605573, "body": "@supercat: I confirm that the above core might not work as expected on a DS9K: I couldn&#39;t test even try it there because its central unit has not yet recovered from the last UB, daemons are still flying in and out of it."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 3541, "user_id": 3375011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa9b8f530efa8f910230c1ec4514abf5?s=128&d=identicon&r=PG&f=1", "display_name": "Davidmh", "link": "https://stackoverflow.com/users/3375011/davidmh"}, "edited": false, "score": 0, "creation_date": 1455706230, "post_id": 35450498, "comment_id": 58605657, "body": "@Davidmh: only careful benchmarking can answer this question. Manual unrolling should still improve performance if the compiler does not unroll the loop automatically."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455708499, "post_id": 35450498, "comment_id": 58607278, "body": "gcc 5.3 <code>-O3</code> does some of <a href=\"http://goo.gl/1fNS4n\" rel=\"nofollow noreferrer\">the most perverse auto-vectorization I&#39;ve ever seen on this function</a>.  I think it doesn&#39;t realize that the cleanup loop is just a cleanup loop and not worth vectorizing.  In any case, since you do <code>val |= a byte</code>, it unpacks the bytes to 64bit vector elements with a chain of <code>vextracti128</code>, 2x <code>vpmovzxbw</code>, 4x <code>vpmovzxwd</code>, and 8x <code>vpmovzxdq</code> before ORing them together!  I haven&#39;t even found the main loop yet, it&#39;s probably tiny."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455708877, "post_id": 35450498, "comment_id": 58607539, "body": "Also, why are you doing anything with <code>CHAR_BIT</code>?  I don&#39;t follow the logic.  <code>sizeof</code>&#39;s result is in units of <code>char</code>s, not bits.  Other than that, ORing some chunks together to improve branch-predictor patterns is probably a good idea.  Like maybe a cache-line at a time of data (64bytes on all modern x86 CPUs).  Your unroll seems excessive; 8 should be plenty.  gcc likes to go berserk setting up aligned pointers for auto-vectorized loops, which leads to really bloated code."}, {"owner": {"reputation": 186, "user_id": 4354782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d8cc1c4f1cf4c512ebeba91928d9e27?s=128&d=identicon&r=PG&f=1", "display_name": "orion", "link": "https://stackoverflow.com/users/4354782/orion"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1455715059, "post_id": 35450498, "comment_id": 58611919, "body": "@PeterCordes The main loop is just between lines 18 and 40."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455726421, "post_id": 35450498, "comment_id": 58620671, "body": "@PeterCordes: you are absolutely right. I fixed the <code>CHAR_BIT</code> mess and downsized the unrolling."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455738326, "post_id": 35450498, "comment_id": 58628167, "body": "Here&#39;s <a href=\"http://goo.gl/uNxSW5\" rel=\"nofollow noreferrer\">an attempt to get gcc to generate less-horrible code</a>.  Using a byte accumulator for the byte-loop helps avoids the perverse unpacking when it auto-vectorizes.  Skipping the word-cleanup loop is good, since gcc is going to auto-vectorize the byte loop anyway.  The code is not bad with AVX2, but nasty with avx or with just SSE."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455744965, "post_id": 35450498, "comment_id": 58632047, "body": "@PeterCordes: it is amazing how difficult it has become to make gcc or clang generate readable assembly code nowadays. Bloat is everywhere, for  questionable performance gains."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1455746030, "post_id": 35450498, "comment_id": 58632690, "body": "@chqrlie: on one missed-optimization bug I reported a while ago, one of the gcc devs said they should probably have gcc just use unaligned loads/stores for x86 in a lot of cases, instead of peeling off so many loop iterations to set up an aligned vector loop.  That&#39;s faster in the common case where the buffer <i>is</i> aligned, despite the lack of guarantee.  Fast hardware support for unaligned loads/stores makes it pretty competitive with scalar startup/cleanup loops (esp. the clunky ones gcc generates) for non-gigantic buffer sizes."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1455746114, "post_id": 35450498, "comment_id": 58632746, "body": "And yeah, locally-optimal code that will win a micro-benchmark (with hot caches and primed branch prediction) is not the same thing as efficient code for part of a larger program.  Instruction cache, and especially uop-cache, are valuable resources that compilers tend to squander.  I haven&#39;t done a lot of looking at profile-directed optimization output, but hopefully it only bloats functions that are actually hot with <code>-O3</code>, otherwise using <code>-O3</code> for programs that don&#39;t have just one hot loop is pretty questionable."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1456181371, "post_id": 35450498, "comment_id": 58819323, "body": "<a href=\"https://gcc.gnu.org/bugzilla/show_bug.cgi?id=69908\" rel=\"nofollow noreferrer\">gcc bug report submitted</a> about how it&#39;s apparently impossible to write a function for this that compiles nicely, and about the perverse auto-vectorization for this specific attempt."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": true, "score": 14, "last_activity_date": 1455726317, "last_edit_date": 1455726317, "creation_date": 1455694588, "answer_id": 35450498, "question_id": 35450237, "link": "https://stackoverflow.com/questions/35450237/fastest-way-to-check-mass-data-if-null-in-c/35450498#35450498", "title": "Fastest way to check mass data if null in C?", "body": "<p>You can handle multiple bytes at a time and unroll the loop:</p>\n\n<pre><code>int dataisnull(const void *data, size_t length) {\n    /* assuming data was returned by malloc, thus is properly aligned */\n    size_t i = 0, n = length / sizeof(size_t);\n    const size_t *pw = data;\n    const unsigned char *pb = data;\n    size_t val;\n#define UNROLL_FACTOR  8\n#if UNROLL_FACTOR == 8\n    size_t n1 = n - n % UNROLL_FACTOR;\n    for (; i &lt; n1; i += UNROLL_FACTOR) {\n        val = pw[i + 0] | pw[i + 1] | pw[i + 2] | pw[i + 3] |\n              pw[i + 4] | pw[i + 5] | pw[i + 6] | pw[i + 7];\n        if (val)\n            return 0;\n    }\n#endif\n    val = 0;\n    for (; i &lt; n; i++) {\n        val |= pw[i];\n    }\n    for (i = n * sizeof(size_t); i &lt; length; i++) {\n        val |= pb[i];\n    }\n    return val == 0;\n}\n</code></pre>\n\n<p>Depending on your specific problem, it might be more efficient to detect non zero values early or late:</p>\n\n<ul>\n<li>If the all zero case is the most common, you should compute cumulate all bits into the <code>val</code> accumulator and test only at the end.</li>\n<li>If the all zero case is rare, you should check for non zero values more often.</li>\n</ul>\n\n<p>The unrolled version above is a compromise that tests for non zero values every 64 or 128 bytes depending on the size of <code>size_t</code>.</p>\n\n<p>Depending on your compiler and processor, you might get better performance by unrolling less or more.  You could also use intrinsic functions available for your particular architecture to take advantage of vector types, but it would be less portable.</p>\n\n<p>Note that the code does not verify proper alignment for the <code>data</code> pointer:</p>\n\n<ul>\n<li>it cannot be done portably.</li>\n<li>it assumes the data was allocated via <code>malloc</code> or similar, hence properly aligned for any type.</li>\n</ul>\n\n<p>As always, benchmark different solutions to see if it makes a real difference.  This function might not be a bottleneck at all, writing a complex function to optimize a rare case is counterproductive, it makes the code less readable, more likely to contain bugs and much less maintainable. For example, the assumption on data alignment may not hold if you change memory allocation scheme or if you use static arrays, the function may invoke undefined behavior then.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 3, "creation_date": 1455697737, "post_id": 35450683, "comment_id": 58599624, "body": "Note that in C99, C11, and C14 the function will invoke Undefined Behavior if the data was written as any type other than word_type or a signed equivalent thereof.  Maybe someday the Standards Committee will acknowledge that a decent language should include a means of using types larger than &quot;char&quot; for purposes of manipulating &quot;raw memory&quot;, but it hasn&#39;t yet."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1455697830, "post_id": 35450683, "comment_id": 58599686, "body": "@supercat Yes, I know. It is a \u201cfingers crossed\u201d approach."}], "tags": [], "owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "is_accepted": false, "score": 4, "last_activity_date": 1455697999, "last_edit_date": 1455697999, "creation_date": 1455695209, "answer_id": 35450683, "question_id": 35450237, "link": "https://stackoverflow.com/questions/35450237/fastest-way-to-check-mass-data-if-null-in-c/35450683#35450683", "title": "Fastest way to check mass data if null in C?", "body": "<p>I once wrote the following function for my own use. It assumes that the data to check is a multiple of a constant chunk size and aligned properly for a buffer of machine words. If this is not given in your case, it is not hard to loop for the first and last few bytes individually and only check the bulk with the optimized function. (Strictly speaking, it is undefined behavior even if the array is properly aligned but the data has been written by any type that is incompatible with <code>unsigned long</code>. However, I believe that you can get pretty far with this careful breaking of the rules here.)</p>\n\n<pre><code>#include &lt;assert.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;stddef.h&gt;\n#include &lt;stdint.h&gt;\n\nbool\nis_all_zero_bulk(const void *const p, const size_t n)\n{\n  typedef unsigned long word_type;\n  const size_t word_size = sizeof(word_type);\n  const size_t chunksize = 8;\n  assert(n % (chunksize * word_size) == 0);\n  assert((((uintptr_t) p) &amp; 0x0f) == 0);\n  const word_type *const frst = (word_type *) p;\n  const word_type *const last = frst + n / word_size;\n  for (const word_type * iter = frst; iter != last; iter += chunksize)\n    {\n      word_type acc = 0;\n      // Trust the compiler to unroll this loop at its own discretion.\n      for (size_t j = 0; j &lt; chunksize; ++j)\n        acc |= iter[j];\n      if (acc != 0)\n        return false;\n    }\n  return true;\n}\n</code></pre>\n\n<p>The function itself is not very smart. The main ideas are:</p>\n\n<ul>\n<li>Use large unsigned machine words for data comparison.</li>\n<li>Enable loop unrolling by factoring out an inner loop with a constant iteration count.</li>\n<li>Reduce the number of branches by ORing the words into an accumulator and only comparing it every few iterations against zero.</li>\n<li>This should also make it easy for the compiler to generate vectorized code using <a href=\"https://en.wikipedia.org/wiki/SIMD\" rel=\"nofollow\">SIMD</a> instructions which you really want for code like this.</li>\n</ul>\n\n<p>Additional non-standard tweaks would be to annotate the function with <code>__attribute__ ((hot))</code> and use <code>__builtin_expect(acc != 0, false)</code>. Of course, the most important thing is to turn on your compiler's optimizations.</p>\n"}], "owner": {"reputation": 744, "user_id": 4877405, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/104Vt.jpg?s=128&g=1", "display_name": "Ringo_D", "link": "https://stackoverflow.com/users/4877405/ringo-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1246, "favorite_count": 4, "closed_date": 1455722519, "accepted_answer_id": 35450498, "answer_count": 3, "score": 24, "last_activity_date": 1455726317, "creation_date": 1455693523, "last_edit_date": 1455719323, "question_id": 35450237, "link": "https://stackoverflow.com/questions/35450237/fastest-way-to-check-mass-data-if-null-in-c", "closed_reason": "Duplicate", "title": "Fastest way to check mass data if null in C?", "body": "<p>I have a mass of data, maybe 4MB. Now want to check if all bits in it are 0.</p>\n\n<p>Eg: \nHere is the data:</p>\n\n<pre><code>void* data = malloc(4*1024*1024);\nmemset(data, 0, 4*1024*1024);\n</code></pre>\n\n<p>Check if all bits in it are 0. Here is my solution which is not fast enough:</p>\n\n<pre><code>int dataisnull(char* data, int length)\n{\n    int i = 0;\n    while(i&lt;length){\n        if (data[i]) return 0;\n        i++;\n    }\n    return 1;\n}\n</code></pre>\n\n<p>This code might have some things to improve in performance. For example, in 32/64 bits machine, checking 4/8 bytes at a time may be faster.</p>\n\n<p>So I wonder what is the fastest way to do it?</p>\n"}, {"tags": ["javascript", "c", "closures", "function-pointers"], "comments": [{"owner": {"reputation": 298, "user_id": 2682712, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dfjkv.png?s=128&g=1", "display_name": "goodbytes", "link": "https://stackoverflow.com/users/2682712/goodbytes"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455693552, "post_id": 35450135, "comment_id": 58597439, "body": "Tried returning a function from another, but I coundn&#39;t access the counter from outside of it. Also, I couldn&#39;t define a function inside another since well, it&#39;s C."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 1, "creation_date": 1455693602, "post_id": 35450135, "comment_id": 58597458, "body": "Then please edit your question and show that, even it if is wrong."}, {"owner": {"reputation": 14088, "user_id": 4642212, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f858afc6f98f72ca7d617da224a28db7?s=128&d=identicon&r=PG&f=1", "display_name": "Sebastian Simon", "link": "https://stackoverflow.com/users/4642212/sebastian-simon"}, "edited": false, "score": 1, "creation_date": 1455693625, "post_id": 35450135, "comment_id": 58597470, "body": "@goodbytes Include your attempts in the question, not in the comments, since <i>the question has to include your attempts</i>."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1455693830, "post_id": 35450135, "comment_id": 58597575, "body": "@MichaelWalz: I don&#39;t really know what you&#39;ll learn from the attempt on a question that asks &quot;is this even possible?&quot; (especially when the answer is, in absence of someone smarter than me, a rather resounding thud of a &quot;nope&quot;)."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1455694154, "post_id": 35450135, "comment_id": 58597742, "body": "@Amadan question includes this : &quot; I was not able to completely achieve this....&quot;, that suggested that the OP has tried something."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1455694058, "last_edit_date": 1455694058, "creation_date": 1455693527, "answer_id": 35450238, "question_id": 35450135, "link": "https://stackoverflow.com/questions/35450135/solve-javascript-counter-dilemma-in-c/35450238#35450238", "title": "Solve javascript counter dilemma in C", "body": "<p>In a word, not really. A closure is, effectively, a structure that consists of a function pointer, if you will, <em>and the captured state</em> (the variables that are closed over). You cannot capture state in C. You could fake a closure by explicitly defining a structure to hold state, and explicitly passing this structure in to the function; but then a) it gets messy, and b) what's the point of not passing <code>counter</code> when you need to pass a struct with <code>counter</code>?</p>\n\n<p>Your specific code could be done by explicitly defining <code>counter</code> as a static variable; but it is not generalisable to what closure really is.</p>\n\n<p>EDIT: Apparently there is a mechanism to pass the structure for you: FFCALL. It is still ugly. Anyway, moving to close as duplicate.</p>\n"}], "owner": {"reputation": 298, "user_id": 2682712, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/dfjkv.png?s=128&g=1", "display_name": "goodbytes", "link": "https://stackoverflow.com/users/2682712/goodbytes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1455694066, "answer_count": 1, "score": 0, "last_activity_date": 1455694058, "creation_date": 1455693109, "question_id": 35450135, "link": "https://stackoverflow.com/questions/35450135/solve-javascript-counter-dilemma-in-c", "closed_reason": "Duplicate", "title": "Solve javascript counter dilemma in C", "body": "<p>I came across below <a href=\"http://www.w3schools.com/js/js_function_closures.asp\" rel=\"nofollow\">example in w3schools</a>, while learning about javascript closures. I was wondering if this could be achieved in <strong>C programming</strong>, since we have similar <strong>function pointers</strong> in C. However, I was not able to completely achieve this with simple pointers to function implementation. Can someone please give it a try? Redirect me if it has already been asked. </p>\n\n<pre><code>var add = (function () {\n    var counter = 0;\n    return function () {return counter += 1;}\n})();\n\nadd();\nadd();\nadd();\n\n// the counter is now 3\n</code></pre>\n"}, {"tags": ["c", "function", "initialization", "local-variables", "static-variables"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455704249, "post_id": 35449956, "comment_id": 58604151, "body": "Sounds good, as long as you understand that your filter is not thread-safe."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 5, "last_activity_date": 1455693179, "last_edit_date": 1455693179, "creation_date": 1455692625, "answer_id": 35450000, "question_id": 35449956, "link": "https://stackoverflow.com/questions/35449956/let-static-function-variable-take-value-of-parameter-in-c/35450000#35450000", "title": "Let static function variable take value of parameter in C", "body": "<p><code>static</code> variables are <em>initialized</em> before the program execution begins, so you cannot use a variable value to initialize a <code>static</code> variable. You'll need a compile-time constant value to initialize the <code>static</code> variable.</p>\n\n<p>Quoting <code>C11</code> standard, chapter \u00a76.2.4, <em>Storage durations of objects</em> (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p>[..] or with the storage-class\n  specifier static, has static storage duration. Its lifetime is the entire execution of the\n  program and <strong>its stored value is initialized only once, prior to program startup.</strong></p>\n</blockquote>\n\n<p>However, you can always <em>assign</em> a new value to the <code>static</code> variable.</p>\n\n<p>That said, coming to the <em>initialization</em> part, as per chapter  \u00a76.7.9, </p>\n\n<blockquote>\n  <p>If an object that has static or thread storage duration is not initialized\n  explicitly, then<br>\n  - ... <br>\n   - if it has arithmetic type, it is initialized to (positive or unsigned) zero<br>\n  - ... <br></p>\n</blockquote>\n\n<p>so, you need not initialize the <code>static float</code>s <em>explicitly</em> to <code>0</code>. You can assign any value, whatsoever later in the code.</p>\n"}, {"comments": [{"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455693504, "post_id": 35450022, "comment_id": 58597414, "body": "So I was actually able to get the behavior I wanted by doing <code>static float top;</code> and then <code>top = n</code>  This gets me all the persistent state that lets me do time based manipulation with no need for structs or extra complexity.   Caller always just passes in a value for n."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455729364, "post_id": 35450022, "comment_id": 58622617, "body": "Yes - using static for persistent state is easier, but it doesn&#39;t scale - they have many of the same problems that global variables do.  If your needs are simple, then using statics might be good enough. I&#39;m not saying that you need to move away from static variables for your current implementation, but keep this technique in mind whenever you want to use static variables to keep persistent context as it may be the solution when your application gets more complex (such as needing to process multiple audio streams concurrently or something)."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455729597, "post_id": 35450022, "comment_id": 58622770, "body": "Also keep in mind that you don&#39;t necessarily need to go to the complexity of having full blown open/close or init/free functions - those just provide a mechanism for hiding data &amp; implementation details.  generally that&#39;s desirable, but again your own specific can take precedence.  You could always just have a struct (or variable if the persistent state is that minimal) that the caller manages ownership and initialization of."}, {"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455742206, "post_id": 35450022, "comment_id": 58630505, "body": "Yeah I could imagine one way the complexity would not scale is if the static variables are not name-spaced.  Is that the case?  In other words, if I use a static int called theta in dspFunction1 and I have several dspFunctions all which need to keep track of a theta variable would they collide given the name theta?"}, {"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455742289, "post_id": 35450022, "comment_id": 58630570, "body": "Also, with regards to structs.  Is there a way to have the function entirely manage the struct.  Like create the struct as a static entity and malloc memory to it and just free it at program end or something?  I guess that is the same scenario as using regular static local variables but at least it encapsulates the names within a struct."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455743987, "post_id": 35450022, "comment_id": 58631468, "body": "There&#39;s no problem regarding name collisions with static variables in other functions - the names are locally scoped, so you can have several static variables named  <code>theta</code> in difference functions. It might confuse debuggers sometimes."}, {"owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "reply_to_user": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455744255, "post_id": 35450022, "comment_id": 58631613, "body": "As far as having a the struct managed by the function - take a look at <code>strtok()</code> and <code>strtok_r()</code>.  <code>strtok_r()</code> has a context variable exposed (thought the context isn&#39;t a  struct, just a pointer).  <code>strtok()</code> doesn&#39;t, it keeps it&#39;s context in an internal static variable.  It can (and probably often is) implemented by just calling <code>strtok_r()</code> with its own static context. <code>strtok()</code> is the &quot;easy&quot; interface, <code>strtok_r()</code> is the flexible (slightly more complicated) interface."}, {"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455745075, "post_id": 35450022, "comment_id": 58632113, "body": "sry, im confused.. are you citing <code>strtok*</code> as something similar to the struct pointer concept we&#39;re talking about?  or something to actually use?"}, {"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "reply_to_user": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "edited": false, "score": 0, "creation_date": 1455745229, "post_id": 35450022, "comment_id": 58632210, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/103769/discussion-between-user5797668-and-michael-burr\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 310760, "user_id": 12711, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c330bdee507c95c603a93ca91d9145a9?s=128&d=identicon&r=PG", "display_name": "Michael Burr", "link": "https://stackoverflow.com/users/12711/michael-burr"}, "is_accepted": false, "score": 1, "last_activity_date": 1455693282, "last_edit_date": 1455693282, "creation_date": 1455692733, "answer_id": 35450022, "question_id": 35449956, "link": "https://stackoverflow.com/questions/35449956/let-static-function-variable-take-value-of-parameter-in-c/35450022#35450022", "title": "Let static function variable take value of parameter in C", "body": "<p>What you should do is create a struct that holds the data that is needed across calls and pass a pointer to the struct to the function.  If you wnat to get fancy, you can create functions that allocate, initialize and free such a struct (and the user of the functions never needs to know what the contents of the struct are.</p>\n\n<p>Something like:</p>\n\n<pre><code>struct mangle_t {\n    bool direction;\n    float bottom;\n    float top;\n    float theta;\n};\n\nstruct mangle_t* mangle_open(void)\n{\n    struct mangle_t* m = malloc(sizeof *m);\n\n    if (m) {\n        memset(m, 0, sizeof *m);\n    }\n\n    return m;\n}\n\nvoid mangle_close(struct mangle_t* m)\n{\n    free(m);\n}\n\n\n\nvoid mangle(struct mangle_t* m, float * data, int n) {\n\n    m-&gt;top = n;\n    m-&gt;theta += 5;\n\n}\n</code></pre>\n\n<p>As far as assigning a parameter to a static variable, you can just perofrm the assignment like any other variable (however, not as an initialization in the variable's declaration - that only happens once).</p>\n"}, {"comments": [{"owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "edited": false, "score": 0, "creation_date": 1455699061, "post_id": 35450232, "comment_id": 58600405, "body": "so the <code>static</code> aspect is actually not critical here?"}], "tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": true, "score": 1, "last_activity_date": 1455693502, "creation_date": 1455693502, "answer_id": 35450232, "question_id": 35449956, "link": "https://stackoverflow.com/questions/35449956/let-static-function-variable-take-value-of-parameter-in-c/35450232#35450232", "title": "Let static function variable take value of parameter in C", "body": "<p>In your case, <code>top</code> is a <strong>local static variable</strong>. </p>\n\n<p>It is like global static variable and global variable that they all have <strong>static storage duration</strong> and they have value before the code startup.</p>\n\n<p>The reason you have error similar to this case:</p>\n\n<pre><code>int a;\nint b = a; \\\\initializer is not a constant\n\nint main() {\n...\n}\n</code></pre>\n\n<p>With your purpose, use <code>top</code> as a global variable is a right way to go. </p>\n"}, {"tags": [], "owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "is_accepted": false, "score": 1, "last_activity_date": 1455694357, "last_edit_date": 1455694357, "creation_date": 1455694037, "answer_id": 35450356, "question_id": 35449956, "link": "https://stackoverflow.com/questions/35449956/let-static-function-variable-take-value-of-parameter-in-c/35450356#35450356", "title": "Let static function variable take value of parameter in C", "body": "<p>I'm not sure if you want to initialize <code>top</code> once and then keep it, but if so, this is what I would do:</p>\n\n<pre><code>void mangle(float *data, int n) {\n    static float top = -1; // Assuming that n will never be -1\n    if (top == -1)\n        top = n;\n    // .....\n}\n</code></pre>\n\n<p>If  you don't need to keep the value of <code>top</code> over function calls, there is no need to declare it <code>static</code>.</p>\n"}], "owner": {"reputation": 3680, "user_id": 5797668, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/3dd63df8b807723a17486949f2262c00?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Bollbach", "link": "https://stackoverflow.com/users/5797668/alex-bollbach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 35450232, "answer_count": 4, "score": 3, "last_activity_date": 1455694357, "creation_date": 1455692457, "last_edit_date": 1455692843, "question_id": 35449956, "link": "https://stackoverflow.com/questions/35449956/let-static-function-variable-take-value-of-parameter-in-c", "title": "Let static function variable take value of parameter in C", "body": "<p>I am writing a data mashing function where I'm modifying audio data over time for a sort of dynamic bit-crusher audio filter.  It is convenient for me to use static variables because their values carry over between function calls and this helps me achieve some interesting time-based effects by incrementing and so forth across rendering callbacks.  </p>\n\n<p>For example, one effect uses a sin function to modulate some sound effect over time.  Like so:</p>\n\n<pre><code>void mangle(float * data, int n) {\n\n   static bool direction = false;\n\n   static float bottom = 0;\n   static float top = n;\n   static float theta = 0;\n\n   theta += 5;\n\n// data = sin(theta) etc..\n</code></pre>\n\n<p>So I wish <code>theta</code> to be initialized once and than modified over time.  Likewise, top wants to be static variable because I modify it later in the function also.  In addition, <code>top</code> should take on the value of parameter <code>n</code> because <code>n</code> changes based on program state.  But when I go to assign <code>n</code> to <code>top</code>, I get the compiler error </p>\n\n<blockquote>\n  <p><code>Initializer element is not a compile-time constsant</code>.</p>\n</blockquote>\n\n<p>Is there a way to assign a parameter to a static variable?  Is there another way to accomplish what I want without static variables?  I am aware I could use instance variables but I find that to be too much.</p>\n"}, {"tags": ["python", "c", "python-2.7", "ctype"], "comments": [{"owner": {"reputation": 21, "user_id": 2477951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181001870bd72a29a96f768da4c6469a?s=128&d=identicon&r=PG", "display_name": "user2477951", "link": "https://stackoverflow.com/users/2477951/user2477951"}, "edited": false, "score": 0, "creation_date": 1455776226, "post_id": 35449842, "comment_id": 58643001, "body": "but it is working in Python prompt not in  script file. does somebody know the reason please.  Thanks PSR."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2477951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181001870bd72a29a96f768da4c6469a?s=128&d=identicon&r=PG", "display_name": "user2477951", "link": "https://stackoverflow.com/users/2477951/user2477951"}, "edited": false, "score": 0, "creation_date": 1455692820, "post_id": 35449911, "comment_id": 58597073, "body": "I am having Every file in same path(directory) it is not working"}], "tags": [], "owner": {"reputation": 1774, "user_id": 426065, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cDexq.jpg?s=128&g=1", "display_name": "Elixir Techne", "link": "https://stackoverflow.com/users/426065/elixir-techne"}, "is_accepted": false, "score": 0, "last_activity_date": 1455692303, "creation_date": 1455692303, "answer_id": 35449911, "question_id": 35449842, "link": "https://stackoverflow.com/questions/35449842/files-operation-in-ctypec-module-in-python-for-file-operations/35449911#35449911", "title": "Files operation in ctype(c) module in Python for file operations", "body": "<p>The better way would be passing file path to func_open as it expects a.c to be in working directory of python or directory where libmystuff.so.1.0.1 is placed.</p>\n\n<p>To verify if file open is working put libmystuff.so.1.0.1, python file, a.c file at same location.</p>\n"}], "owner": {"reputation": 21, "user_id": 2477951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/181001870bd72a29a96f768da4c6469a?s=128&d=identicon&r=PG", "display_name": "user2477951", "link": "https://stackoverflow.com/users/2477951/user2477951"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1455694000, "creation_date": 1455692026, "last_edit_date": 1455694000, "question_id": 35449842, "link": "https://stackoverflow.com/questions/35449842/files-operation-in-ctypec-module-in-python-for-file-operations", "title": "Files operation in ctype(c) module in Python for file operations", "body": "<p>I am beginner in Python: </p>\n\n<p>1) I have written a file <strong>a.c</strong> which is having a function(func_open) which does file open and returns.<br>\n2) I have made it a <strong>.so</strong> file so that to <strong>import to python as ctype module</strong>.<br>\n3) when I call <strong>func_open()</strong> from <strong>python as root</strong>;<br>\n     - <strong>control is entring into a.c function  func_open()</strong> but I am getting an error: \"open: No such file or directory\"</p>\n\n<pre><code>    File: a.c\n    /***********************************/\n    #include&lt;stdio.h&gt;\n    #include &lt;sys/types.h&gt;\n    #include &lt;sys/stat.h&gt;\n    #include &lt;fcntl.h&gt;\n    int func_open(void)\n    {\n        open(\"./a.c\",O_RDWR);\n        perror(\"open\");\n        return 0;\n    }\n\n    /**********PYTHON Code*********/\n    #!/usr/bin/python\n    import ctypes\n    from ctypes import *\n    testlib = ctypes.CDLL('./libmystuff.so.1.0.1')\n    print \"Open: \",testlib.func_open(),\"\\n\"\n</code></pre>\n"}, {"tags": ["c", "arrays", "memory", "embedded", "language-lawyer"], "comments": [{"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 3, "creation_date": 1455692357, "post_id": 35449797, "comment_id": 58596866, "body": "They will take the exact same amount of memory.  There is no need for the compiler to create an anonymous string constant for this case.  You friend seems to be under the misconception that some kind of dynamic copying takes place.  It does not."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1455692630, "post_id": 35449797, "comment_id": 58596979, "body": "You should ask your classmate where he thinks the data of the second initializer comes from."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 2, "creation_date": 1455693157, "post_id": 35449797, "comment_id": 58597249, "body": "@TomKarzes Your comment is somewhat misleading. There is a hidden <code>memcpy</code> when array is initalized and initialization data is copied from ROM to RAM."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1455694645, "post_id": 35449797, "comment_id": 58597975, "body": "@user694733 In both cases, <code>string</code> should be allocated in the data section, initialized with the desired string value.  There should be no difference at all.  Any load-time issues, whether from disk or from ROM or whatever, should be identical in the two cases.  That was the point of the question, and that is as direct an answer as can be given."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455694938, "post_id": 35449797, "comment_id": 58598113, "body": "@TomKarzes I know, both are equal. I was just saying that on typical embedded system there <i>is</i> copying that takes place at initalization state."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 1, "creation_date": 1455695003, "post_id": 35449797, "comment_id": 58598142, "body": "@TomKarzes It isn&#39;t obvious what scope <code>string</code> has, you can&#39;t assume that it will sit at file scope. And your assumptions only apply on a RAM-based, PC-like system. On embedded systems with true ROM and no harddrive, even static storage duration variables are initialized in &quot;runtime&quot; with a copy-down from ROM."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455695175, "post_id": 35449797, "comment_id": 58598231, "body": "At any rate, the string literal will be allocated in the executable. There is no way around that."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455695241, "post_id": 35449797, "comment_id": 58598266, "body": "@Lundin None of that matters.  I made no assumptions.  The two cases should be identical.  Why do you think they aren&#39;t?  They are two different syntaxes for the same array initializer.  No more, no less."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455695612, "post_id": 35449797, "comment_id": 58598466, "body": "@TomKarzes If the variable is allocated on the stack, it will obviously have to be initialized in run-time, each time the program counter enters the scope where the variable resides in. Which means that the actual literal must be allocated in read-only memory. --&gt;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455695695, "post_id": 35449797, "comment_id": 58598514, "body": "@TomKarzes If the variable has static storage duration, then it will end up in the <code>.data</code> segment, which on a RAM-based PC system is pre-loaded when the program is loaded into RAM at startup. Then there is no need to have the actual literal accessible in run-time, so it doesn&#39;t have to be allocated in addressable memory. On a ROM-based system (flash memory etc) however, the literal sits in ROM and at program start-up it gets copied into <code>.data</code> by your own program. So you always get a copy of it in addressable ROM no matter what you do."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1455695788, "post_id": 35449797, "comment_id": 58598576, "body": "@Lundin Yes, of course.  Why are you harping on that?  That isn&#39;t the issue.  The issue is whether there is some kind of benefit from writing the inializer as a string literal vs. using array initializer syntax.  And the answer is that <i>there is no difference</i>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "edited": false, "score": 0, "creation_date": 1455695864, "post_id": 35449797, "comment_id": 58598614, "body": "@TomKarzes Because I was referring to your comment &quot;There is no need for the compiler to create an anonymous string constant for this case. You friend seems to be under the misconception that some kind of dynamic copying takes place. It does not. &quot; which is not true for all systems. Dynamic copying is exactly what takes place at least on every ROM-based system."}, {"owner": {"reputation": 16851, "user_id": 5460719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0f2a855c86ad12fc2988d3948b69ec6?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Karzes", "link": "https://stackoverflow.com/users/5460719/tom-karzes"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1455695996, "post_id": 35449797, "comment_id": 58598674, "body": "@Lundin ok, regarding that comment, yes, I was assuming static storage.  If it&#39;s automatic, then a copy of the initializer needs to be placed in static storage.  But the two cases will still be handled the same, that&#39;s the real point.  OP&#39;s friend seemed to think they were different."}], "answers": [{"comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455692136, "post_id": 35449859, "comment_id": 58596778, "body": "Sorry, I didn&#39;t means this. It&#39;s a mistake, I&#39;m going to fix that."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 6, "last_activity_date": 1455692148, "last_edit_date": 1455692148, "creation_date": 1455692073, "answer_id": 35449859, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35449859#35449859", "title": "Will a string initializer somewhat waste memory?", "body": "<p>After your edit, there is no difference between the two definitions. Both will produce an array of ten characters and initialized to the same contents.</p>\n\n<p>This is actually easy to verify: First check what <code>sizeof</code> gives you for the two arrays, then you can use e.g. <code>memcmp</code> to compare both the arrays.</p>\n\n<p><strike>The second initialization is <em>almost</em> equal to the first, with once crucial difference: The second array is not terminated as a string.</p>\n\n<p>The first creates an array of ten characters (including the terminator) and the second creates an array of nine characters. If you don't use the array as a string, then yes you will save once element with the second initialization.</strike></p>\n"}, {"comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455692661, "post_id": 35449988, "comment_id": 58596993, "body": "Sorry, I forgot to add that &#39;\\0&#39;. Question is edited now."}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455692749, "post_id": 35449988, "comment_id": 58597035, "body": "Ok I saw that - as @Joachim said they are simply the same then."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1455693453, "post_id": 35449988, "comment_id": 58597391, "body": "You should either delete the answer or edit it reflect the updated question."}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 0, "last_activity_date": 1455692560, "creation_date": 1455692560, "answer_id": 35449988, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35449988#35449988", "title": "Will a string initializer somewhat waste memory?", "body": "<blockquote>\n  <p>will a string initializer create two same string? Or string initializers are just syntax sugars?</p>\n</blockquote>\n\n<p>The two cases are totally different:</p>\n\n<p>1st case:</p>\n\n<pre><code>char string[] = \"some text\";  // &lt;-- string initialization\n</code></pre>\n\n<p>This syntax is string-specific and cannot apply to any other data type. It automatically add a <code>\\0</code> character at the end so it's guaranteed that library function such as <code>printf</code> knows where to end the output (with <code>%s</code> control string).</p>\n\n<hr>\n\n<p>2nd case:</p>\n\n<pre><code>char string[] = {'s', 'o', 'm', 'e', ' ', 't', 'e', 'x', 't'};  // &lt;--  array initialization\n</code></pre>\n\n<p>This syntax is to initialize <strong>array</strong> BUT not <s>string</s>. The syntax can be used to initialize other types of array (such as <code>int</code>, <code>long</code>, etc.). It NEVER automatically add a <code>\\0</code> at the end of the array. So it'd be WRONG to <code>printf</code> this char array using the <code>%s</code> control.</p>\n\n<hr>\n\n<p>In short, these are two different initialization syntaxes used for different purposes. If you need <strong>string</strong>, then use the first syntax, if you use <strong>character array</strong> - then use the second.</p>\n"}, {"comments": [{"owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 0, "creation_date": 1455694260, "post_id": 35450341, "comment_id": 58597794, "body": "Is the term &quot;string literal&quot; implies it&#39;s static? As I know, string literals are guaranteed to be static in C."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 1, "creation_date": 1455694633, "post_id": 35450341, "comment_id": 58597969, "body": "@sunqingyao The string literal is preserved throughout the execution of the program, so in that way it is &quot;static&quot;. But the C term and keyword <code>static</code>, which affects storage duration and scope, doesn&#39;t really apply to string literals."}, {"owner": {"reputation": 51, "user_id": 5939003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a54d980fa14e40e395a94ddc159731?s=128&d=identicon&r=PG&f=1", "display_name": "user5939003", "link": "https://stackoverflow.com/users/5939003/user5939003"}, "reply_to_user": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "edited": false, "score": 1, "creation_date": 1455694677, "post_id": 35450341, "comment_id": 58597991, "body": "@sunqingyao No, it&#39;s implied because it&#39;s undefined behavior to modify a string literal (which means that it&#39;s likely to be placed in ROM) and because of 6.7.9/4 &quot;All the expressions in an initializer for an object that has static or thread storage duration shall be constant expressions or string literals.&quot; Whereas C++ outright says &quot;string literals have static storage duration&quot;."}], "tags": [], "owner": {"reputation": 51, "user_id": 5939003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82a54d980fa14e40e395a94ddc159731?s=128&d=identicon&r=PG&f=1", "display_name": "user5939003", "link": "https://stackoverflow.com/users/5939003/user5939003"}, "is_accepted": false, "score": 3, "last_activity_date": 1455693985, "creation_date": 1455693985, "answer_id": 35450341, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35450341#35450341", "title": "Will a string initializer somewhat waste memory?", "body": "<p>The C standard has a \"special case\" that allows you to initialize an array with a string literal:</p>\n\n<blockquote>\n  <p>\u00a76.7.9/14 An array of character type may be initialized by a character\n  string literal or UTF\u22128 string literal, optionally enclosed in braces.\n  Successive bytes of the string literal (including the terminating null\n  character if there is room or if the array is of unknown size)\n  initialize the elements of the array.</p>\n</blockquote>\n\n<p>That's it. It doesn't say anything else, which would be an implementation detail of the platform and compiler. Unlike C++, which explicitly gives string literal static storage duration, the C standard <strong>doesn't</strong>. It's implied. There are common extensions that allow you to modify string literals, meaning that it's not guaranteed that it will be placed in read-only memory.</p>\n"}, {"comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455695069, "post_id": 35450419, "comment_id": 58598182, "body": "I feel that this is the best answer as it answers from the practical point of view and covers all questions."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1456319202, "post_id": 35450419, "comment_id": 58890575, "body": "Maybe you could provide evidence for your statements quoting the standard - I personally am not 100% sure what you are saying is true. Also providing real-life examples will be good too - though not so important as the first one."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1456321998, "post_id": 35450419, "comment_id": 58892568, "body": "@FISOCPP The C standard does not specify where data is stored, because that&#39;s outside the scope of the language standard. To find something to quote, you&#39;d have to dig into compiler docs and elf format specifications etc. But you could simply look at the memory map of any program and see for yourself. Now if you are going to down vote my answer because <i>you</i> don&#39;t know the scope of the C standard, or because <i>you</i> have never seen the .rodata section in a map file (which is everyday trivial stuff for anyone who has ever done hardware-related programming), then I am not going to teach it to you."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1456331422, "post_id": 35450419, "comment_id": 58899564, "body": "Calm down. All am I saying is that from your post I can&#39;t understand why the 2 forms are equivalent. You just state it without any proof. For me this is not evident from first sight."}, {"owner": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1456332028, "post_id": 35450419, "comment_id": 58900034, "body": "I can even tell you why - I remember that sometime in the past I&#39;ve been testing those 2 forms and they were producing different code. In the first case there was one globally stored string literal which was copied to locally allocated variable and in the second one the string itself was encoded in the function code as move instructions. Maybe that is not standard but from your post I can&#39;t tell for sure unless I completely trust your  unproven opinion."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 2917, "user_id": 4031604, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d800dd437bdbb2645b3c71236583fd?s=128&d=identicon&r=PG&f=1", "display_name": "AnArrayOfFunctions", "link": "https://stackoverflow.com/users/4031604/anarrayoffunctions"}, "edited": false, "score": 0, "creation_date": 1456385275, "post_id": 35450419, "comment_id": 58924205, "body": "@FISOCPP &quot;All you can do is to move it from one read-only memory segment to another, which will give you the very same program size in the end anyway.&quot; Also see the last paragraph of my answer: if you don&#39;t use the string format, some compilers may not realize that it is a string and store it in some other part of the read-only memory than the segment used for strings. You still allocate it, it has to be allocated somewhere. I still don&#39;t get it why some people think a program can magically know about other things besides those stored in its own memory."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 7, "last_activity_date": 1455694677, "last_edit_date": 1455694677, "creation_date": 1455694274, "answer_id": 35450419, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35450419#35450419", "title": "Will a string initializer somewhat waste memory?", "body": "<pre><code>char string[] = \"some text\";\n</code></pre>\n\n<p>is 100% equivalent to</p>\n\n<pre><code>char string[] = {'s', 'o', 'm', 'e', ' ', 't', 'e', 'x', 't', '\\0'};\n</code></pre>\n\n<p>Your friend is confused: if <code>string</code> is a local variable, then in <em>both</em> cases you create two strings. Your variable <code>string</code> which resides on the stack and a read-only string literal which resides in read-only memory (<code>.rodata</code>). </p>\n\n<p>There is no way to avoid the read-only storage, since all data must be allocated somewhere. You cannot allocate string literals in thin air. All you can do is to move it from one read-only memory segment to another, which will give you the very same program size in the end anyway.</p>\n\n<p>The former style is preferred in general, as it is more readable. It is indeed a form of syntactic sugar.</p>\n\n<p>But it is also preferred because it might ease some compiler optimization known as \"string pooling\", which allows the compiler to store the string literal <code>\"some text\"</code> in more memory-effective ways. If you initialize the string character-by-character, the compile may or may not realize that it is a read-only string constant.</p>\n"}, {"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1455727677, "creation_date": 1455727677, "answer_id": 35462762, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35462762#35462762", "title": "Will a string initializer somewhat waste memory?", "body": "<p>Semantically, the two lines are identical. But the practical consequences will depend on the compiler.</p>\n\n<p>Experimenting with <a href=\"http://gcc.godbolt.org/\" rel=\"nofollow\">http://gcc.godbolt.org/</a> shows a variety of strategies:</p>\n\n<ul>\n<li><p>Fill in the arrays one character at a time using a series of <code>movb</code> instructions (or equivalent) with immediate operands.</p></li>\n<li><p>Fill in the arrays one doubleword at a time using <code>movabsq / movq</code> pairs, where the first has an immediate doubleword operand.</p></li>\n<li><p>Copy the data into the arrays from a string constant stored in the <code>.rodata</code> section.</p></li>\n</ul>\n\n<p>Different compilers used different strategies for the two cases. In particular, <code>gcc</code> found the <code>movabsq</code> optimization only for the case of <code>char string[] = \"string literal\";</code>, which makes your friend's strategy somewhat bulkier (because the generated code has more bytes).</p>\n\n<p>Trying different optimization settings would probably have produced even more variations.</p>\n\n<p>It's clear that the base data has to be stored <em>somewhere</em> in the program, whether it is in the data section or as a series of immediate operands in executable code. Since it is not practical to figure out or guess how a particular style might affect a given compiler's ability to optimize, the only rational approach is to use the style which is easiest to read and maintain. (The useful corollary is that the compiler will probably also have the easiest time with the most common style.)</p>\n\n<p>In the unlikely event that this is actually performance-critical, you would have to examine the code produced by the actual compiler being used. But you should first ask yourself whether an initialized mutable buffer is really necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 1, "last_activity_date": 1455839507, "creation_date": 1455839507, "answer_id": 35494810, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory/35494810#35494810", "title": "Will a string initializer somewhat waste memory?", "body": "<ul>\n<li><p>In the first case, <code>string[]</code> is initialised using a <em>literal string constant</em> of length 10 bytes, which will be instantiated in a read-only segment.  </p></li>\n<li><p>In the second case <code>string[]</code> is initialised using a <em>constant array of literal character constants</em> of length 10 bytes, which will be instantiated in a read-only segment.  </p></li>\n</ul>\n\n<p>Both cases are identical both semantically and in memory requirement. The first is merely syntactic sugar for the second (and much more convenient, and less error prone). </p>\n\n<p>If you need to initialise a non-read-only data with compile-time constant data, that the constant initialiser will necessarily be compiled-in regardless of the syntax used.  You cannot get something for nothing.  If however the data is constant, you can use a single read-only copy by declaring:</p>\n\n<pre><code>const char* string = \"some text\" ;\n</code></pre>\n\n<p>This will create a pointer <code>string</code> to a <em>constant string</em>, and can save memory when compared with a say:</p>\n\n<pre><code>#define string \"some text\"\n</code></pre>\n\n<p>which may generate multiple copies of \"some text\" everywhere the macro <code>string</code> is used. (Although most modern compiler/linker toolchains are able remove duplicate strings in any case).  In the first instance you can take the address of <code>string</code> and be sure that the value will be identical for all references, while the macro will be different for each reference is not optimised. Another semantic difference is that for <code>const char* string</code>, <code>sizeof(string)</code> is the size of a pointer, wheras for <code>string[]</code> it is the length of the initialiser (including the nul terminator)</p>\n"}], "owner": {"reputation": 11698, "user_id": 5399734, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2162d669508364bb0c03aba1a2473aa8?s=128&d=identicon&r=PG&f=1", "display_name": "nalzok", "link": "https://stackoverflow.com/users/5399734/nalzok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 35450419, "answer_count": 6, "score": 4, "last_activity_date": 1455839507, "creation_date": 1455691901, "last_edit_date": 1455692082, "question_id": 35449797, "link": "https://stackoverflow.com/questions/35449797/will-a-string-initializer-somewhat-waste-memory", "title": "Will a string initializer somewhat waste memory?", "body": "<p>To initialize a char array, usually I write:</p>\n\n<pre><code>char string[] = \"some text\";\n</code></pre>\n\n<p>But today, one of my classmates said that one should use:</p>\n\n<pre><code>char string[] = {'s', 'o', 'm', 'e', ' ', 't', 'e', 'x', 't', '\\0'};\n</code></pre>\n\n<p>I told him it is crazy to abandon readability and brevity, but he argued that initializing a char array with a string will actually create two strings, one asides in the stack and another in the read-only memory. When working with embedded devices, this can result in unacceptable waste in memory. </p>\n\n<p>Of course, string initializers seems clearer, so I'll use them in my programs. But the question is, will a string initializer create two same string? Or string initializers are just syntax sugars?</p>\n"}, {"tags": ["c", "multithreading", "pthreads"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1455688597, "post_id": 35448879, "comment_id": 58595239, "body": "It&#39;s impossible to say without seeing your code. For example, we don&#39;t know how you have parallelised your pipeline. Obviously there are dependencies across the pipelines. So if you have not coded it correctly you may be just serialising the computation. Also, there are general reasons why just throwing more threads at a problem does not necessarily improve performance. That same question has been asked many times - see for example: <a href=\"https://stackoverflow.com/questions/32005767/why-is-the-multithreaded-version-of-this-program-slower\">Why is the multithreaded version of this program slower?</a>"}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1455689041, "post_id": 35448879, "comment_id": 58595421, "body": "@kaylum I agree that without posting the code, it&#39;s impossible to know if the entire pipelining version is correctly coded. But are there more specific reasons that could cause the problem I mentioned? Because with only one line of code, why did I get different running time? It was just killing me."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455689296, "post_id": 35448879, "comment_id": 58595518, "body": "@kaylum So basically from the post you were sharing, sharing memory between threads makes the program run slow. I think I can start with that. Thanks."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1455689550, "post_id": 35448879, "comment_id": 58595609, "body": "There are other factors. For example if each thread just executes one line of code for a small data set then a non threaded program which executes all those same lines of code will almost certainly perform better than the multi thread program. Because there is overhead in creating and synchronizing the threads."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455689823, "post_id": 35448879, "comment_id": 58595708, "body": "@kaylum I understood the overhead of creating and synchronizing the threads. I wasn&#39;t using threads to just execute one line of code and then synchronize. I&#39;ll check my code again and see if I can find any other problems. Thanks for the suggestions."}, {"owner": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 1, "creation_date": 1455689828, "post_id": 35448879, "comment_id": 58595711, "body": "Also have a look at what scheduling policy the OS uses for multiple threads. If each thread has the same priority for example then they might be executing one after the other which could slow down your program."}, {"owner": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1455689905, "post_id": 35448879, "comment_id": 58595742, "body": "^ This. Allocating threads is pretty expensive - a property that is pretty universal across most systems. If you&#39;re doing lots of tiny calculations in individual threads, usually the overhead is close to, or in some cases greater than, the actual work being done. How many threads are you spawning? You should only have one, maybe two per CPU core. Are you pooling threads and sleeping/waking them as you&#39;re going through your iterations? If you&#39;re allocating new threads each time you start a calculation, I would suspect that is your problem."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 12040, "user_id": 510036, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b7c510641e6526d19abc93e866e75ac8?s=128&d=identicon&r=PG", "display_name": "Qix - MONICA WAS MISTREATED", "link": "https://stackoverflow.com/users/510036/qix-monica-was-mistreated"}, "edited": false, "score": 0, "creation_date": 1455690577, "post_id": 35448879, "comment_id": 58596051, "body": "@Qix I created four threads including the master thread with each one running one function logically. I created four work queues to pass the data between threads and used semaphores to sleep/wake them. I don&#39;t think the creation of threads is the problem but maybe the communications will be."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1455690717, "post_id": 35448879, "comment_id": 58596107, "body": "@Martinn The policy is TS. From this link - <a href=\"https://www-01.ibm.com/support/knowledgecenter/SSSTCZ_2.0.0/com.ibm.rt.doc.20/realtime/lnx_schedule.html\" rel=\"nofollow noreferrer\">www-01.ibm.com/support/knowledgecenter/SSSTCZ_2.0.0/&hellip;</a>, it says with TS, &quot;each thread runs for a limited time period, after which the next thread is allowed to run.&quot; Could TS slow down the program?"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455694288, "post_id": 35448879, "comment_id": 58597810, "body": "Does each program produce its output all at once? And does each program require its full input before it can begin processing? If the answer to either of these questions is &quot;yes&quot;, multithreading probably won&#39;t help you."}, {"owner": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1455761692, "post_id": 35448879, "comment_id": 58638423, "body": "@Jimmy This may affect the performance and will largely depend on what the threads are doing and whether or not they are killed as soon as they finish their work. Have a go at experimenting with other scheduling policies, just remember to set the priority when using FIFO and RR in the link you gave."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1455970203, "post_id": 35448879, "comment_id": 58735757, "body": "@DavidSchwartz Yes, each program needs to wait for the previous one to be completed. Why won&#39;t multithreading improve the performance in this case? Each program can still run in parallel just like the CPU pipelining so I think it won&#39;t slow the program down unless the data is too small because of the thread creation and join overhead. Let me know if I am wrong, thanks."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 497, "user_id": 1812249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3d126f269c17f870e5378f38942b1e1d?s=128&d=identicon&r=PG&f=1", "display_name": "jigglypuff", "link": "https://stackoverflow.com/users/1812249/jigglypuff"}, "edited": false, "score": 0, "creation_date": 1455970227, "post_id": 35448879, "comment_id": 58735769, "body": "@Martinn I will look into that to see if it can help, thanks."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1456021162, "post_id": 35448879, "comment_id": 58752498, "body": "@Jimmy If each program waits for the previous one to complete, how will they run in parallel?"}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1456033690, "post_id": 35448879, "comment_id": 58754735, "body": "@DavidSchwartz When each program finishes, it triggers the next one and will start to run concurrently if its input from the previous one is ready. Just like Instruction Pipelining in CPU - <a href=\"https://en.wikipedia.org/wiki/Instruction_pipelining\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Instruction_pipelining</a>. If there are N stages, theoretically it can speed up the execution to approximately 1/N, although it always gets worse. This is my understanding of Parallelism with Pipelining."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1456038137, "post_id": 35448879, "comment_id": 58755552, "body": "@Jimmy That makes no sense. If each one cannot start until the previous one finishes, no overlap is possible."}, {"owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "reply_to_user": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1456066403, "post_id": 35448879, "comment_id": 58763736, "body": "@DavidSchwartz Well, because the first one doesn&#39;t need wait so immediately when it finishes running on the previous data, it can start with a new one. So it&#39;s possible that the first program is in execution on the new data in parallel with the second program running on the previous data. This is how classic RISC pipelining improve the CPU instruction throughput using pipelining approach, where Instruction Fetching, Decoding, Execution, Memory Stage and Writing Back can run in parallel within one clock."}], "owner": {"reputation": 63, "user_id": 3394806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/012ab451c90f2c1a4224f3c803018a47?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy", "link": "https://stackoverflow.com/users/3394806/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 376, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1455688523, "creation_date": 1455688193, "last_edit_date": 1455688523, "question_id": 35448879, "link": "https://stackoverflow.com/questions/35448879/multithreading-program-using-pthread-in-c-is-slower-than-serial-version", "title": "Multithreading program using pthread in C is slower than serial version", "body": "<p>I'm converting a C program to multithreading version. The code is too long to post here but the approach I was using is quite simple. There is a pipeline in the original program that has four programs. The output of each of the programs becomes the input of the next one. What I did was create one thread for each of the four programs to make a task pipelining using pthread. The machine I was using is a 16 cores server. I'm getting the correct result but the problem is the performance is getting worse. When I was debugging it, I found the weirdest thing. Even running just some one line of code with the same data, the timing is different. For example, there is one line of code in the program like below</p>\n\n<pre><code>mtx[i][j][d] = max(mtx[i][j][d], mtx[i-2][j-1][d-1] + t[offset]);//max is a macro defined to find the max of two values\n</code></pre>\n\n<p>which is simply a three-dimensional dynamic programming computation. </p>\n\n<p>Because all data is the same and it is not in any Critical Section, I was really confused what could be the cause. Could it be the caching problem because it is Shared-Memory machine? </p>\n"}, {"tags": ["c", "multithreading", "pthreads", "printf"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455687229, "post_id": 35448641, "comment_id": 58594705, "body": "Your main thread wait synchronisation is incorrect. So its not waiting properly for all threads to exit before exiting the main thread (which also stops all the child threads). <code>pthread_join(sellingTicket, NULL)</code>. That waits for the <i>same</i> thread on each loop - the last thread to be created. You need a <i>seperate</i> <code>sellingTicket</code> pthread_t variable for each child thread."}, {"owner": {"reputation": 169, "user_id": 4159081, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c1c5b5f6d7381286dd2f772b9e2baf46?s=128&d=identicon&r=PG&f=1", "display_name": "thedreamer", "link": "https://stackoverflow.com/users/4159081/thedreamer"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1455688763, "post_id": 35448641, "comment_id": 58595312, "body": "@kaylum - I see point you are making but unable to implement - pthread_join such that it catches all the created thread, can you please give an example in my scenario - way I have created threads"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 4159081, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c1c5b5f6d7381286dd2f772b9e2baf46?s=128&d=identicon&r=PG&f=1", "display_name": "thedreamer", "link": "https://stackoverflow.com/users/4159081/thedreamer"}, "edited": false, "score": 0, "creation_date": 1455688434, "post_id": 35448747, "comment_id": 58595176, "body": "Sorry but I am still not able to understand and surprisingly I am not finding example to join multiple threads way I have created. Could you please add that with your answer ? Also the while loop I kept near pthread_join was during additional debugging ..if I remove the while loop near pthread_join and just keep pthread_join(sellingTicket, NULL); I see no impact on result"}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455704676, "post_id": 35448747, "comment_id": 58604493, "body": "&#39;@thedreamer if you wish to join all the threads, you shoud make &#39;sellingTicket&#39; an array.  Just look at your code again - the pthread_create() loop is overwriting the same &#39;sellingTicket&#39; var each time round, so losing all the thread references except the last:("}, {"owner": {"reputation": 169, "user_id": 4159081, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c1c5b5f6d7381286dd2f772b9e2baf46?s=128&d=identicon&r=PG&f=1", "display_name": "thedreamer", "link": "https://stackoverflow.com/users/4159081/thedreamer"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1455736674, "post_id": 35448747, "comment_id": 58627068, "body": "@MartinJames : Thank you for the pointer, yes I did that eventually as updated in the edit section and things worked fine. Question - why would I get 4 different thread id&#39;s if there was overwriting happening and returning of 3 threads ( hmm ..atleast printf showed 3 different thread id) exited and not just 1 ? Can you please help me understand it"}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "reply_to_user": {"reputation": 169, "user_id": 4159081, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c1c5b5f6d7381286dd2f772b9e2baf46?s=128&d=identicon&r=PG&f=1", "display_name": "thedreamer", "link": "https://stackoverflow.com/users/4159081/thedreamer"}, "edited": false, "score": 0, "creation_date": 1455739927, "post_id": 35448747, "comment_id": 58629197, "body": "@thedreamer The threads each had their own ID, you just didn&#39;t keep track of them correctly."}], "tags": [], "owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "is_accepted": true, "score": 3, "last_activity_date": 1455687568, "creation_date": 1455687568, "answer_id": 35448747, "question_id": 35448641, "link": "https://stackoverflow.com/questions/35448641/thread-exit-discrepency-in-multi-thread-scenario/35448747#35448747", "title": "thread exit discrepency in multi-thread scenario", "body": "<p>Your join loop tries to join the last thread over and over rather than trying to join each thread that was created. You need to keep track of the thread IDs so that you can join them all.</p>\n\n<p>Once you've joined a thread, the thread ID is invalid and it is a serious mistake to pass it to any pthread_* function.</p>\n"}], "owner": {"reputation": 169, "user_id": 4159081, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c1c5b5f6d7381286dd2f772b9e2baf46?s=128&d=identicon&r=PG&f=1", "display_name": "thedreamer", "link": "https://stackoverflow.com/users/4159081/thedreamer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 35448747, "answer_count": 1, "score": 0, "last_activity_date": 1455690071, "creation_date": 1455686992, "last_edit_date": 1455690071, "question_id": 35448641, "link": "https://stackoverflow.com/questions/35448641/thread-exit-discrepency-in-multi-thread-scenario", "title": "thread exit discrepency in multi-thread scenario", "body": "<p>I have written a very simple code for practicing semaphore. Task is to sell tickets and each thread should update the shared variable of total tickets till it becomes zero. Issue I am observing is - the thread which sells last ticket and makes ticket_count = 0 by decrementing it exits without printing how many total tickets it sold. I added mutex around printf just for hack of it as I read about issues of printf in multi-threaded environment on SO. Reason I find this issue different than normal printf issues pointed at SO with regard to multi-threading is - its always ( not always 8/10 times - issue is intermittent - other 2 times it prints all 4 threads ticket sold) the last thread i.e. the one which sells last ticket skips the printf and exits. Can someone point me what am I doing wrong ?</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n\n#define NUMTHREADS  4       /* number of threads i.e. ticket sellers */\n\nstatic unsigned int ticket_count = 25;\n\npthread_mutex_t mutex2 = PTHREAD_MUTEX_INITIALIZER;\n\nsem_t mutex;\n\nvoid *ticketProcessing(void *arg)\n{\n    bool loop_alive = true;\n    int local_counter = 0;\n    while(loop_alive)\n    {\n        sleep(1);\n        sem_wait(&amp;mutex);\n        if (ticket_count &gt; 0)\n        {\n            local_counter++;\n            ticket_count--;\n            printf(\" thread id -- %d - decided to sell 1 ticket \\n \", (int)pthread_self());\n        }\n        else\n        {\n            loop_alive = false;\n        }\n        sem_post(&amp;mutex);\n    }\n\n    pthread_mutex_lock(&amp;mutex2);\n    printf(\" ticket sold by thread id -- %d -- is  %d \\n \", (int)pthread_self(), local_counter);\n    pthread_mutex_unlock(&amp;mutex2);\n  //  return 0;\n}\n\nint main(void)\n{\n    pthread_t sellingTicket;\n    sem_init(&amp;mutex, 0, 1);\n    int i;\n\n    for(i = 0; i &lt; NUMTHREADS; i++)\n    {\n        pthread_create(&amp;sellingTicket, NULL, ticketProcessing, NULL);\n    }\n\n    i = 0;\n    while(i &lt; NUMTHREADS)\n    {\n        pthread_join(sellingTicket, NULL);\n        i++;\n    }\n\n\n    printf(\" All threads exited !!! \\n \");\n    return 0;\n}\n</code></pre>\n\n<p>Edit : I tried to create array and join in below fashion and it works</p>\n\n<pre><code> pthread_t threads[4];\n\n for(i = 0; i &lt; 4; i++)\n {\n     pthread_create(&amp;threads[i], NULL, ticketProcessing, NULL);\n }\n\nfor(i = 0; i &lt; 4; i++)\n{\n    pthread_join(threads[i], NULL);\n}\n</code></pre>\n"}, {"tags": ["c", "arduino", "esp8266"], "answers": [{"comments": [{"owner": {"reputation": 3709, "user_id": 4501084, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/JQ1ra.jpg?s=128&g=1", "display_name": "pgmank", "link": "https://stackoverflow.com/users/4501084/pgmank"}, "edited": false, "score": 1, "creation_date": 1521206737, "post_id": 37011214, "comment_id": 85644868, "body": "The newest version of the Espressif SDK now supports PEAP."}], "tags": [], "owner": {"reputation": 29, "user_id": 5363312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f95cc500034c4dd56babe751f9c3b30a?s=128&d=identicon&r=PG&f=1", "display_name": "Luno", "link": "https://stackoverflow.com/users/5363312/luno"}, "is_accepted": false, "score": 2, "last_activity_date": 1462298466, "creation_date": 1462298466, "answer_id": 37011214, "question_id": 35448629, "link": "https://stackoverflow.com/questions/35448629/is-it-possible-to-get-esp8266-running-on-wpa2-enterprise-network/37011214#37011214", "title": "Is it possible to get ESP8266 running on WPA2 Enterprise network?", "body": "<p>The feature was recently added and is not mature. It currently supports certificate (EAP-TLS) but not password (PEAP) authentication.</p>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://github.com/esp8266/Arduino/issues/1102\" rel=\"nofollow\">https://github.com/esp8266/Arduino/issues/1102</a></li>\n<li><a href=\"http://bbs.espressif.com/viewtopic.php?f=46&amp;t=1442\" rel=\"nofollow\">http://bbs.espressif.com/viewtopic.php?f=46&amp;t=1442</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 3709, "user_id": 4501084, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/JQ1ra.jpg?s=128&g=1", "display_name": "pgmank", "link": "https://stackoverflow.com/users/4501084/pgmank"}, "is_accepted": false, "score": 4, "last_activity_date": 1521207666, "last_edit_date": 1521207666, "creation_date": 1521207171, "answer_id": 49322039, "question_id": 35448629, "link": "https://stackoverflow.com/questions/35448629/is-it-possible-to-get-esp8266-running-on-wpa2-enterprise-network/49322039#49322039", "title": "Is it possible to get ESP8266 running on WPA2 Enterprise network?", "body": "<p>Since Version 2.0 of the Espressif SDK, ESP8266 can be connected to both EAP and PEAP WPA2 Enterprise networks.</p>\n\n<p>I quote <a href=\"https://github.com/esp8266/Arduino/issues/1032#issuecomment-258907047\" rel=\"nofollow noreferrer\">a small guide from GitHub</a> on how to implement the connection:</p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/g046C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/g046C.png\" alt=\"ESP8266 Connection to WPA2 Enterprise Networks GitHub Guide\"></a></p>\n</blockquote>\n"}], "owner": {"reputation": 1339, "user_id": 1378959, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/2849a50e9f68dd39245aa88dccd6ae7d?s=128&d=identicon&r=PG", "display_name": "jhtong", "link": "https://stackoverflow.com/users/1378959/jhtong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11330, "favorite_count": 3, "answer_count": 2, "score": 7, "last_activity_date": 1579167150, "creation_date": 1455686920, "question_id": 35448629, "link": "https://stackoverflow.com/questions/35448629/is-it-possible-to-get-esp8266-running-on-wpa2-enterprise-network", "title": "Is it possible to get ESP8266 running on WPA2 Enterprise network?", "body": "<p>I've seen examples for ESP8266 chip Wifi clients logging onto a WPA2 personal network.</p>\n\n<p>However, is it possible for an ESP8266 client to login to an <em>enterprise</em> network?</p>\n"}, {"tags": ["c", "pointers"], "answers": [{"tags": [], "owner": {"reputation": 1462, "user_id": 611707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dd5a0a990ac6e72a0fa15f18b7cd7f7?s=128&d=identicon&r=PG", "display_name": "codemaker", "link": "https://stackoverflow.com/users/611707/codemaker"}, "is_accepted": false, "score": 0, "last_activity_date": 1455686183, "last_edit_date": 1455686183, "creation_date": 1455685663, "answer_id": 35448353, "question_id": 35448245, "link": "https://stackoverflow.com/questions/35448245/pointer-arithmetic-with-strings/35448353#35448353", "title": "Pointer arithmetic with strings", "body": "<p>Assuming you are trying to increment the ascii value of <code>C</code> by one and print that and move the character pointed to forward, you want to use <code>*ptr++ + 1</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455685958, "post_id": 35448356, "comment_id": 58594258, "body": "ya.. thank u for that. I got it. But y there was a segmentation fault with my code, as I m trying to increase the ascii value if C , which will give D, and then move to next address location. Will you please explain me that ?"}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "reply_to_user": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455686047, "post_id": 35448356, "comment_id": 58594285, "body": "@Eric Wang has already explained that. I wont try to repeat his answer."}, {"owner": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455686245, "post_id": 35448356, "comment_id": 58594349, "body": "Can u suggest some material to get some clarity about these concepts. thank u."}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "reply_to_user": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455750898, "post_id": 35448356, "comment_id": 58634892, "body": "@t.purnaChander there are some extremely in depth, advanced books like [this] (<a href=\"http://linker.iecc.com/\" rel=\"nofollow noreferrer\">linker.iecc.com</a>). Depending on your experience level you may or may not find it useful. Other than that you can study the basics of assembler or there may be articles on the net. I&#39;m not certain entry level c books would cover this."}], "tags": [], "owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "is_accepted": false, "score": 3, "last_activity_date": 1455750753, "last_edit_date": 1455750753, "creation_date": 1455685678, "answer_id": 35448356, "question_id": 35448245, "link": "https://stackoverflow.com/questions/35448245/pointer-arithmetic-with-strings/35448356#35448356", "title": "Pointer arithmetic with strings", "body": "<p>This will print <code>D</code> then increment the pointer to the next char.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nmain()\n{\n    char *ptr=\"C programming\";\n    printf(\" %c \\n\",(*ptr++) + 1);    \n}\n</code></pre>\n\n<p>You cannot increment the character value in place in memory as it is a character literal and as such most probably stored in the data section of your binary executable. it's read only and any attempts to alter it will lead to undefined behaviour (segfault probably ~100% of the time).</p>\n\n<p>You should make a habit of declaring such literals <code>const</code>. Indeed c++ will pull you up on this if it has any extra level of warnings enabled.</p>\n\n<p>The above code works because it is not altering the memory, it is simply adding 1 to the value for the purpose of passing to <code>printf</code>.</p>\n\n<p>Another option is to use array syntax instead of pointer syntax, you are declaring the string to be on the stack and so it is writeable.</p>\n\n<p>To do this the syntax is</p>\n\n<pre><code>char ptr[]=\"C programming\";\n</code></pre>\n\n<p>You can think of a pointer just pointing anywhere, you give the compiler an option to put it wherever it likes, so it sticks it in read only memory. When you use array syntax is has to be right there, where you declare it.</p>\n"}, {"comments": [{"owner": {"reputation": 3765, "user_id": 459615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f4c8c6dee5c7decf6434296f0fce47?s=128&d=identicon&r=PG", "display_name": "Kurt Stutsman", "link": "https://stackoverflow.com/users/459615/kurt-stutsman"}, "edited": false, "score": 0, "creation_date": 1455686513, "post_id": 35448384, "comment_id": 58594443, "body": "This is close to right answer, but not quite. The poster said he wanted it to print <code>D</code> ie increment the value prior to printing it."}, {"owner": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455686627, "post_id": 35448384, "comment_id": 58594481, "body": "Thank u. It s has become a bit confusing . can u explain me bit more about these ,,  ptr [ ]  &quot;  and ,,  *ptr  &#39;&#39; ."}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "reply_to_user": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "edited": false, "score": 0, "creation_date": 1455687351, "post_id": 35448384, "comment_id": 58594754, "body": "@t.purnaChander I updated the answer a little, but you need use google or read books to get a better understand of such concepts, I guess."}, {"owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "reply_to_user": {"reputation": 3765, "user_id": 459615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f4c8c6dee5c7decf6434296f0fce47?s=128&d=identicon&r=PG", "display_name": "Kurt Stutsman", "link": "https://stackoverflow.com/users/459615/kurt-stutsman"}, "edited": false, "score": 0, "creation_date": 1455688202, "post_id": 35448384, "comment_id": 58595095, "body": "@KurtStutsman Yeah, I see, then need change the printf line to <code>printf(&quot;%c \\n&quot;, (*(ptr++))+1);</code>"}], "tags": [], "owner": {"reputation": 16010, "user_id": 1568658, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FPSGe.jpg?s=128&g=1", "display_name": "user218867", "link": "https://stackoverflow.com/users/1568658/user218867"}, "is_accepted": true, "score": 7, "last_activity_date": 1455692964, "last_edit_date": 1495541209, "creation_date": 1455685832, "answer_id": 35448384, "question_id": 35448245, "link": "https://stackoverflow.com/questions/35448245/pointer-arithmetic-with-strings/35448384#35448384", "title": "Pointer arithmetic with strings", "body": "<h2>Reason for your error</h2>\n\n<p>You are trying to modify a string literal, which is a non-modifiable object.\nThat's why you get a segmentation fault.</p>\n\n<p>Even if you simply call <code>ptr[0]++</code>, it will be a segmentation fault.</p>\n\n<h2>Solution</h2>\n\n<p>One solution is to change the declaration to:</p>\n\n<p><code>char ptr[] = \"C programming\"</code></p>\n\n<p>Then you can modify the char array.</p>\n\n<p>They look similar? Yes, the string literal is still non-modifiable, but you have declared an array with its own space, which will be initialized by the string literal, and the array is stored in the stack, and thus modifiable.</p>\n\n<h2>Example</h2>\n\n<p>Here is a full code example:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint test() {\n    char str[]=\"C programming\";\n    char *ptr = str;\n\n    while(*ptr != '\\0') {\n        // print original char,\n        printf(\"%c \\n\", *(ptr++));\n\n        // print original char plus 1, but don't change array,\n        // printf(\"%c \\n\", (*(ptr++))+1);\n\n        // modify char of array to plus 1 first, then print,\n        // printf(\"%c \\n\", ++(*(ptr++)));\n    }\n\n    return 0;\n}\n\nint main(int argc, char * argv[]) {\n    test();\n    return 0;\n}\n</code></pre>\n\n<p><em>Tip</em>: you should only enable one of the <code>printf()</code> lines at the same time, due to <code>++</code> operator.</p>\n\n<h2>More tips</h2>\n\n<p>Note that we declared a <code>ptr</code> and a <code>str</code>, because we can't use <code>++</code> operation on an array (you can't change the address of an array), thus <code>++str</code> will get a compile error, while <code>++ptr</code> won't.</p>\n\n<hr>\n\n<h2>@Update - About memory</h2>\n\n<p><em>(To answer your comment)</em></p>\n\n<ul>\n<li>A <strong>string literal</strong> is usually stored in a read-only area of a process; refer to <a href=\"https://stackoverflow.com/questions/2589949/c-string-literals-where-do-they-go\">C string literals: Where do they go?</a></li>\n<li>A <strong>char array</strong>, if declared inside a method, then it's allocated on the stack, thus you can modify it; when you initialize a char array from a string literal, there are actually 2 copies of the same value: 1 is read-only; 1 is modifiable; the char array is initialized from the read-only copy.</li>\n<li>A <strong>char pointer</strong> it stores a single address; the pointer itself is allocated on stack in this case, and you can modify it.</li>\n</ul>\n\n<p>You might also want to know more about <em>pointer</em> or <em>address</em> or <em>array</em> or  Linux process memory layout_ or <em>data sections of a C program</em>; try searching on Google, or refer to books like <a href=\"https://rads.stackoverflow.com/amzn/click/com/0131103628\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">The C Programming Language, 2nd Edn</a> and <a href=\"https://rads.stackoverflow.com/amzn/click/com/1593272200\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">The Linux Programming Interface</a> \u2014 though this is a question about C rather than Linux.  There's also <a href=\"https://stackoverflow.com/questions/562303/the-definitive-c-book-guide-and-list\">The Definitive C Book Guide and List</a> on Stack Overflow.</p>\n"}, {"tags": [], "owner": {"reputation": 5024, "user_id": 4439794, "user_type": "registered", "accept_rate": 39, "profile_image": "https://i.stack.imgur.com/ogyE1.png?s=128&g=1", "display_name": "Trevor", "link": "https://stackoverflow.com/users/4439794/trevor"}, "is_accepted": false, "score": 0, "last_activity_date": 1455686787, "last_edit_date": 1455686787, "creation_date": 1455686323, "answer_id": 35448496, "question_id": 35448245, "link": "https://stackoverflow.com/questions/35448245/pointer-arithmetic-with-strings/35448496#35448496", "title": "Pointer arithmetic with strings", "body": "<blockquote>\n  <p>why the following code is throwing a segmentation fault</p>\n</blockquote>\n\n<p><code>++*ptr</code> means <code>*ptr = *ptr + 1</code> </p>\n\n<p>in C, string literal is a non-modifiable object. You are trying to dereference <code>ptr</code> and set value for the address that <code>ptr</code> points to.</p>\n"}], "owner": {"reputation": 113, "user_id": 5933890, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9bc56dcc09b8e8170c83ce32a7d6a66d?s=128&d=identicon&r=PG&f=1", "display_name": "t.purna Chander", "link": "https://stackoverflow.com/users/5933890/t-purna-chander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5256, "favorite_count": 3, "accepted_answer_id": 35448384, "answer_count": 4, "score": 2, "last_activity_date": 1455750753, "creation_date": 1455685033, "last_edit_date": 1455685313, "question_id": 35448245, "link": "https://stackoverflow.com/questions/35448245/pointer-arithmetic-with-strings", "title": "Pointer arithmetic with strings", "body": "<p>I learning these concepts, please help me why the following code is throwing a segmentation fault. \nMy intention in this code is to print capital letter <strong>D</strong> and move to next address. Please explain me. thank u.</p>\n\n<pre><code>main()\n{\n    char *ptr=\"C programming\";\n    printf(\" %c \\n\",++*ptr);    \n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 1, "creation_date": 1455692369, "post_id": 35448170, "comment_id": 58596872, "body": "Downvoted, because question doesn&#39;t contain <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. As I result, no one knows exactly what you are trying to do, and answers try to guess what your intended data type is."}, {"owner": {"reputation": 861, "user_id": 3966009, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lynj8.png?s=128&g=1", "display_name": "Samuel Thompson", "link": "https://stackoverflow.com/users/3966009/samuel-thompson"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455914852, "post_id": 35448170, "comment_id": 58720028, "body": "it is very clear in the title that my data type is char * [][] more specifically char * [20][250]. i want to initialize it, and then re-initialize it. and it doesnt have an example because it have no idea how to do it."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1455960778, "post_id": 35448170, "comment_id": 58732791, "body": "Pointers are traditionally hard for beginners. It&#39;s unclear whether you have understood what you want. You can see from answers that they have different ideas on what you need to do. Good question would have a short example of using tha variable after the allocation to demonstrate what you actually need."}], "answers": [{"comments": [{"owner": {"reputation": 337, "user_id": 5803703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/580f989162e32a2e0bcb438c86750782?s=128&d=identicon&r=PG&f=1", "display_name": "Massey101", "link": "https://stackoverflow.com/users/5803703/massey101"}, "edited": false, "score": 1, "creation_date": 1455686175, "post_id": 35448331, "comment_id": 58594322, "body": "SIZE_OF_STRING + 1 assuming it&#39;s containing a regular c string."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1455723989, "last_edit_date": 1455723989, "creation_date": 1455685505, "answer_id": 35448331, "question_id": 35448170, "link": "https://stackoverflow.com/questions/35448170/how-to-declare-a-char20250/35448331#35448331", "title": "how to declare a char*[20][250]", "body": "<p>If <code>args</code> is declared as:</p>\n\n<pre><code>char* args[20][250];\n</code></pre>\n\n<p>You can allocate memory for each item of that array using:</p>\n\n<pre><code>for (int i = 0; i &lt; 20; ++i )\n{\n   for ( int j = 0; j &lt; 250; ++j )\n   {\n      args[i][j] = malloc(sizeof(*args[i][j])*(SIZE_OF_STRING+1));\n   }\n}\n</code></pre>\n\n<p>If <code>args</code> is declared as:</p>\n\n<pre><code>char*** args;\n</code></pre>\n\n<p>You need a few more <code>malloc</code> calls.</p>\n\n<p><strong>Step 1</strong></p>\n\n<p>Allocate memory for <code>arg</code>.</p>\n\n<pre><code>args = malloc(sizeof(*args)*20);\n</code></pre>\n\n<p><strong>Step 2</strong></p>\n\n<p>Allocate memory for <code>args[0] - args[19]</code>.</p>\n\n<pre><code>for (int i = 0; i &lt; 20; ++i )\n{\n   args[i] = malloc(sizeof(*args[i])*250);\n}\n</code></pre>\n\n<p><strong>Step 3</strong></p>\n\n<p>Allocate memory for <code>args[0][0] - args[19][249]</code>.</p>\n\n<pre><code>for (int i = 0; i &lt; 20; ++i )\n{\n   for ( int j = 0; j &lt; 250; ++j )\n   {\n      args[i][j] = malloc(sizeof(*args[i][j])*(SIZE_OF_STRING+1));\n   }\n}\n</code></pre>\n\n<p><strong>Combine them</strong></p>\n\n<pre><code>args = malloc(sizeof(*args)*20);\nfor (int i = 0; i &lt; 20; ++i )\n{\n   args[i] = malloc(sizeof(*args[i])*250);\n   for ( int j = 0; j &lt; 250; ++j )\n   {\n      args[i][j] = malloc(sizeof(*args[i][j])*(SIZE_OF_STRING+1));\n   }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1455686513, "post_id": 35448417, "comment_id": 58594442, "body": "So, if I declare <code>int a[20][250]</code>, you&#39;re telling me that it is not one contiguous block of memory?"}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1455686809, "post_id": 35448417, "comment_id": 58594549, "body": "@pat Just added a footnote about exactly that.  You&#39;re correct, it is not.  C doesn&#39;t have true 2-dimensional array support; it only has array-of-pointers-to-anything-else support."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1455687033, "post_id": 35448417, "comment_id": 58594629, "body": "Declare <code>a</code> as above, and print <code>sizeof(a)</code>.  You will find it to be <code>20*250*sizeof(int)</code>.  Not a pointer to be found here."}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1455687216, "post_id": 35448417, "comment_id": 58594701, "body": "@pat: Oh sorry, I misread your comment\u2014 I thought you were asking about malloc&#39;ing <code>int [20][250]</code>, not letting the compiler stack-allocation-lay-it-out.  Yes, you&#39;re right about that.  I forget how stack-allocation arrays work exactly.  If you can answer the question using that kind of layout with malloc, go for it!!  But IIRC, memory layout done at compile time gets to make some shortcuts you don&#39;t have available at <code>malloc()</code>-time."}], "tags": [], "owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1455688363, "last_edit_date": 1455688363, "creation_date": 1455686008, "answer_id": 35448417, "question_id": 35448170, "link": "https://stackoverflow.com/questions/35448170/how-to-declare-a-char20250/35448417#35448417", "title": "how to declare a char*[20][250]", "body": "<p>Just to be clear, when you desire a 2D array of type <code>char*[20][250]</code>, what you're asking for in C-speak is a 20-element array of <code>char*[250]</code>s, each of which is a 250-element array of <code>char *</code> C-strings <em>(each of which is an array of <code>char</code>s)</em>.</p>\n\n<p>Because a dynamically-allocated 2D array isn't a single area of memory but rather an array of pointers to other arrays, you can't do this in one step<sup>1</sup>.\u00a0\u00a0The allocation that will do what you want would look like this:</p>\n\n<pre><code>char ***args;\n\nargs = malloc(sizeof(char**[20]));\nfor (int i = 0; i &lt; 20; ++i) {\n    args[i] = malloc(sizeof(char*[250]));\n\n    // optional, depending on your usage:\n    for (int j = 0; j &lt; 20; ++j)\n        args[i][j] = \"\"; // This makes every `char *` element point to the same location in memory\u2014 the location of the compiled-in `\"\"` / `(char *){ '\\0' }`.\n}\n</code></pre>\n\n<p>To free the memory, structure your calls the same as the <code>malloc</code>-ing code, but in reverse-hierarchical order:</p>\n\n<pre><code>for (int i = 0; i &lt; 20; ++i)\n    free(args[i]);\nfree(args);\n</code></pre>\n\n<p><sub><sup>1</sup> Okay, so it is technically possible to allocate it as one big blob and then wire up the 20-element array to point into the desired offsets into the blob.\u00a0\u00a0This convolutes <code>free()</code>ing though and usually isn't necessary\u2014 for most use-cases, the performance gains would be negligible (and you'd still need to <code>malloc()</code> a separate array of pointers that address into the 2D blob).\u00a0\u00a0You typically only see 2D-blob allocation when data is massively 2D \u2014 such as image data \u2014 and <code>data[x][y]</code> access syntax is eschewed in favor of <code>data[y * width + x]</code> syntax because it's no less efficient than what the compiler would do, and doesn't require more than one <code>malloc</code>/<code>free</code> pair per blob of data.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1455687918, "post_id": 35448611, "comment_id": 58594988, "body": "Interesting style: <code>malloc(sizeof(char [20][250]))</code>"}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1455688808, "post_id": 35448611, "comment_id": 58595331, "body": "@chux That&#39;s the form that you&#39;d use if you wanted the allocated memory to be in the form of a 20&#215;250 2D array of single-<code>char</code>s, as Chris says with <i>\u201cdenotes a pointer to an array of 20 arrays of 250 chars\u201d</i>.  If you instead wanted a 20&#215;250 2D array of C-strings, I don&#39;t believe a single <code>malloc()</code> will work."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1455689972, "post_id": 35448611, "comment_id": 58595770, "body": "@chux: I prefer <code>malloc(sizeof *args)</code>, but I don&#39;t think that&#39;s what you&#39;re talking about. However, the onky text application I can think of which might fit that datatype would be a terminal emulator/editor/screen thingy, and even there unicode has changed most of the old certainties."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455730515, "post_id": 35448611, "comment_id": 58623385, "body": "@SlippD.Thompson: a &quot;C string&quot; is not a type it&#39;s a (somewhat vague) concept -- a null-terminated sequence of chars.  A <code>char [20][250]</code> is a type, one that can hold 20 &quot;C strings&quot; each of which is up to 249 characters.  Depending on exactly what the OP wants, all of this may or may not be relevant..."}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455756023, "post_id": 35448611, "comment_id": 58636651, "body": "@ChrisDodd  Correct, a \u201cC string\u201d is not a type, but it is a highly specific concept with a ubiquitously-agreed upon type (<code>char *</code>) and memory layout (zero-terminated array).  Similarly, a \u201cwide C string\u201d is always <code>wchar_t *</code> and zero-term; and a \u201cPascal string\u201d is always <code>char *</code> with the first byte containing the length (and usually zero-term).  I dare you to find any book or platform documentation from the last 30 years that disagrees with this ubiquitous agreement (if not standard).  |  Yes, what the OP wants is vague, as @user694733 noted."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455756270, "post_id": 35448611, "comment_id": 58636724, "body": "@SlippD.Thompson: a &quot;C string&quot; often refers to a char array type not a char pointer type. K&amp;R use the term this way, as does pretty much every book ever published."}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455756785, "post_id": 35448611, "comment_id": 58636889, "body": "@ChrisDodd Yes, that&#39;s why I wrote <i>\u201cmemory layout (zero-terminated <b>array</b>)\u201d</i>.  Also, in C, arrays are implemented using pointers\u2014 all arrays are of pointer type.  I&#39;m failing to see how your distinction of K&amp;R using the <code>char[]</code> syntax over the <code>char *</code> syntax (both of which are the same type) disproves anything I&#39;ve said or supports your claim that <i>\u201ca &quot;C string&quot; is a somewhat vague concept\u201d</i>."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "reply_to_user": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455757332, "post_id": 35448611, "comment_id": 58637082, "body": "@SlippD.Thompson: Arrays are <i>NOT</i> pointer types -- that misconception is behind most new user confusion with C.  Yes, arrays can be implicitly converted to pointers, but the distinction <i>IS</i> important, as this and other questions show."}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455758644, "post_id": 35448611, "comment_id": 58637482, "body": "@ChrisDodd Disagree.  The type of data is format, layout, and usage patterns of it.  Because of this, the <code>char *</code> type is not of <code>char[]</code> type, but the <code>char[]</code> is certainly of <code>char *</code> type.  Although <code>char *</code> is more generalized and less specific than <code>char[]</code>, it is still the same type.  It sounds like you&#39;re extrapolating the imposed limits of type-checking to be the definition of a type\u2014 would you agree that <code>AString</code> defined as <code>typedef char[] AString;</code> is a distinct type from <code>char[]</code>?  I wouldn&#39;t, in a general context."}, {"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455758743, "post_id": 35448611, "comment_id": 58637512, "body": "@ChrisDodd It&#39;s also worth noting that a C string cannot be dynamically alloced into a <code>char[]</code>\u2014 only a <code>char *</code> will work.  It is for this reason that I used that syntax in my answer &amp; comments."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 4, "last_activity_date": 1455686848, "creation_date": 1455686848, "answer_id": 35448611, "question_id": 35448170, "link": "https://stackoverflow.com/questions/35448170/how-to-declare-a-char20250/35448611#35448611", "title": "how to declare a char*[20][250]", "body": "<p>Postfix operators are always higher precedence than prefix, so when you say</p>\n\n<pre><code>char*[20][250]\n</code></pre>\n\n<p>you get an array of 20 arrays of 250 pointers to characters.  You can use parentheses the bind the <code>*</code> more tightly:</p>\n\n<pre><code>char (*)[20][250]\n</code></pre>\n\n<p>denotes a pointer to an array of 20 arrays of 250 chars.  So if you have</p>\n\n<pre><code>char (*args)[20][250];\n</code></pre>\n\n<p>you can use</p>\n\n<pre><code>args = malloc(sizeof(char [20][250]));\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 1, "creation_date": 1455714222, "post_id": 35450193, "comment_id": 58611292, "body": "Typedefs\u2026 I didn&#39;t think that would work so +1.  This does still limit the array to a size determined at compile-time, but that&#39;s out-of-scope from what the OP&#39;s asking."}, {"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "reply_to_user": {"reputation": 28007, "user_id": 177525, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09f21a34cb0a63b36fa7d4022bfe36b1?s=128&d=identicon&r=PG", "display_name": "Slipp D. Thompson", "link": "https://stackoverflow.com/users/177525/slipp-d-thompson"}, "edited": false, "score": 0, "creation_date": 1455726444, "post_id": 35450193, "comment_id": 58620692, "body": "Typedefs are not necessary, but they make things simpler to understand.  The number of dimensions must be fixed, and all dimensions except the first must be constant in order for the compiler to do the address computation.  If you are willing to write the address computation by hand, you can have a dynamic number of dynamically sized dimensions, and still have all of the elements remain contiguous."}], "tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 1, "last_activity_date": 1455693351, "creation_date": 1455693351, "answer_id": 35450193, "question_id": 35448170, "link": "https://stackoverflow.com/questions/35448170/how-to-declare-a-char20250/35450193#35450193", "title": "how to declare a char*[20][250]", "body": "<p>You can declare a typedef for a 2d array like so:</p>\n\n<pre><code>    typedef char *array2d_t[20][250];\n</code></pre>\n\n<p>You can now <code>malloc</code> enough memory to hold a single instance of this 2d array:</p>\n\n<pre><code>    array2d_t *array3d = malloc(1 * sizeof(*array3d));\n</code></pre>\n\n<p>Because pointers behave like arrays of the things to which they point, we actually have a 3d array whose first dimension has arity 1 (note the <code>1 *</code> in the malloc), so the first index can be only 0.  We can index it thus:</p>\n\n<pre><code>    array3d[0][0][0] = \"Hello\";\n    array3d[0][1][0] = \"World\";\n    array3d[0][19][249] = \"End of the world!\";\n</code></pre>\n\n<p>Or, if you prefer, we can dereference the pointer explicitly:</p>\n\n<pre><code>    (*array3d)[0][0] = \"Hello\";\n    (*array3d)[1][0] = \"World\";\n    (*array3d)[19][249] = \"End of the world!\";\n</code></pre>\n\n<p>Alternatively, we can declare a typedef for a 1d array like so:</p>\n\n<pre><code>    typedef char *array1d_t[250];\n</code></pre>\n\n<p>An can now <code>malloc</code> enough memory to hold 20 instances of this 1d array:</p>\n\n<pre><code>    array1d_t *array2d = malloc(20 * sizeof(*array2d));\n</code></pre>\n\n<p>We no can now index the array with:</p>\n\n<pre><code>    array2d[0][0] = \"Hello\";\n    array2d[1][0] = \"World\";\n    array2d[19][249] = \"End of the world!\";\n</code></pre>\n"}], "owner": {"reputation": 861, "user_id": 3966009, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/lynj8.png?s=128&g=1", "display_name": "Samuel Thompson", "link": "https://stackoverflow.com/users/3966009/samuel-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 1, "accepted_answer_id": 35448331, "answer_count": 4, "score": -3, "last_activity_date": 1455965778, "creation_date": 1455684604, "last_edit_date": 1455965778, "question_id": 35448170, "link": "https://stackoverflow.com/questions/35448170/how-to-declare-a-char20250", "title": "how to declare a char*[20][250]", "body": "<p>i have a char * [][] and i need to empty it, and make a new one every now and then, but i dont know how to reinitialize it over and over again</p>\n\n<p>i tried</p>\n\n<pre><code>args = malloc(sizeof(char*[20][250])*20);\n</code></pre>\n\n<p>and</p>\n\n<pre><code>args = malloc(sizeof(char***)*20);\n</code></pre>\n\n<p>but i still cant reinitilize the array. Is the array really 20 X 250 with a char* as the element perhaps?</p>\n\n<p>and how do you iterate through a char array that is of the type *[20][250]?</p>\n\n<p>this is for the execv and will be used like this</p>\n\n<pre><code>for(int i =0 ;i&lt; maxArgs;i++){\n    execv(args[i][0],args[i]);\n    ERROR(\"failed to start\");\n}\n</code></pre>\n"}, {"tags": ["c", "while-loop", "switch-statement"], "comments": [{"owner": {"reputation": 1357, "user_id": 4485032, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e181e72fec3bd2224c932a376f6ca00a?s=128&d=identicon&r=PG&f=1", "display_name": "jmcg", "link": "https://stackoverflow.com/users/4485032/jmcg"}, "edited": false, "score": 1, "creation_date": 1455683283, "post_id": 35447941, "comment_id": 58593367, "body": "I&#39;m not well-versed in C, but isn&#39;t <code>id</code> supposed to be an <code>int</code>? your <code>case</code>s are enclosed in single quotes"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1455745518, "post_id": 35447941, "comment_id": 58632387, "body": "for ease of understanding and readability by us humans: 1) consistently indent the code (never use tabs for indenting as each wordprocessor/editor has the tab stops/tab width set differently.)  Indent after every opening brace &#39;{&#39;.   Un-indent before every closing brace &#39;}&#39;.  Suggest using 4 spaces for each indent level as 4 spaces is wide enough to be visible even with variable width fonts. 2) follow the axiom: <i>only one statement per line and (at most) one variable declaration per statement.</i>  3) separate code blocks (for, if, else, while. do...while, switch, case, default) by a blank line."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1455746079, "post_id": 35447941, "comment_id": 58632720, "body": "a small thing:  the word &#39;pleas&#39; is unknown,  suspect you meant &#39;please&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5834252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee721d63546fe016c3d191bafe7fdc83?s=128&d=identicon&r=PG&f=1", "display_name": "Wearin", "link": "https://stackoverflow.com/users/5834252/wearin"}, "edited": false, "score": 0, "creation_date": 1455684106, "post_id": 35447960, "comment_id": 58593636, "body": "Oh duh. I was using my switch statement about chars as an example. I&#39;m dumb. Thanks man!"}], "tags": [], "owner": {"reputation": 438, "user_id": 4602794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08b4e5768f2775714ff5f7b0dad39599?s=128&d=identicon&r=PG&f=1", "display_name": "zakaiter", "link": "https://stackoverflow.com/users/4602794/zakaiter"}, "is_accepted": true, "score": 4, "last_activity_date": 1455683278, "creation_date": 1455683278, "answer_id": 35447960, "question_id": 35447941, "link": "https://stackoverflow.com/questions/35447941/switch-statement-keeps-using-default-case-no-matter-what-c-beginner/35447960#35447960", "title": "Switch statement keeps using default case no matter what - C beginner", "body": "<blockquote>\n  <p>Remove quotes and try from switch condition</p>\n</blockquote>\n\n<pre><code> switch (id) {\n        case 1: \n             printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n             scanf(\"%d\", &amp;amount);\n             inv1 += amount;\n             break;\n        case 2: \n             printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n             scanf(\"%d\", &amp;amount);\n             inv2 += amount;\n             break;\n        case 3: \n             printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n             scanf(\"%d\", &amp;amount);\n             inv3 += amount;\n             break;\n        case 4: \n             printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n             scanf(\"%d\", &amp;amount);\n             inv4 += amount;\n             break;\n        default:\n            printf(\"Error: That ID Number is not an option. \\n\");\n            break;\n                      }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "reply_to_user": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "edited": false, "score": 1, "creation_date": 1455684689, "post_id": 35448003, "comment_id": 58593804, "body": "@user3386109 true... :) perhaps my answer just add the explanation of why it doesn&#39;t work as expected. Best choice would still be the accepted answer."}], "tags": [], "owner": {"reputation": 28386, "user_id": 5666987, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/guTdN.jpg?s=128&g=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/5666987/ian"}, "is_accepted": false, "score": 1, "last_activity_date": 1455684619, "last_edit_date": 1455684619, "creation_date": 1455683570, "answer_id": 35448003, "question_id": 35447941, "link": "https://stackoverflow.com/questions/35447941/switch-statement-keeps-using-default-case-no-matter-what-c-beginner/35448003#35448003", "title": "Switch statement keeps using default case no matter what - C beginner", "body": "<p>Since you read your input as integer:</p>\n\n<pre><code>scanf(\"%d\", &amp;id); //note the %d\n</code></pre>\n\n<p>Then the <code>id</code> will have a value of integer, converted from the <code>string</code> which you input in your Console.</p>\n\n<pre><code>Example: \nInput: 41 //this is char '4' and '1', having value of 0x34 (52) and 0x31 (49) respectively\nResult: id = 41 //(not resulting in char* but value of 41)\n</code></pre>\n\n<p>If you want to use character, then you should do this instead:</p>\n\n<pre><code>char id;\nscanf(\" %c\", &amp;id); //note the %c, might also be better if used with early space to avoid \\n from the input buffer\n</code></pre>\n\n<p>Such that it will read your input as character</p>\n\n<pre><code>Example:\nInput: 4 //this is char '4' (having value of 0x34 (52))\nResult: id = '4' or id = 52 //not resulting in actual value of 4, but char '4' or value of 52 (0x34)\n</code></pre>\n\n<p>Then your switch:</p>\n\n<pre><code>switch(id){\n    case '4': //this has actual value of 52 (or 0x34), check ASCII table\n        break;\n    // and so on, \n}\n</code></pre>\n\n<p>will be fine. </p>\n\n<p>Note that this will limit your option from <code>'0'-'9'</code> though, since they are the only available ASCII chars.</p>\n\n<p>So, it is still best to use <code>scanf(\"%d\", &amp;id);</code></p>\n\n<p>Simply remove the <code>'</code> in your <code>switch</code>:</p>\n\n<pre><code>int id;\nscanf(\"%d, &amp;id);\nswitch(id){\n    case 1: //this has actual integer value of 1, not ASCII '1' = 0x31 (or 49)\n        break;\n    // and so on, will be fine\n}\n</code></pre>\n\n<p>Then it will also work.</p>\n"}, {"tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1455745979, "creation_date": 1455745979, "answer_id": 35468543, "question_id": 35447941, "link": "https://stackoverflow.com/questions/35447941/switch-statement-keeps-using-default-case-no-matter-what-c-beginner/35468543#35468543", "title": "Switch statement keeps using default case no matter what - C beginner", "body": "<p>There seems to be a mis-understanding, as shown in the code, between a character value and a integer value.   </p>\n\n<p>a character, like '1' has the value 0x31.  </p>\n\n<p>while a integer value like 1 has the value 0x00000001.  </p>\n\n<p>For the switch/cases, the case values need to be integers, so do not wrap those values in single quotes as those single quotes indicate character literals rather than integer literals.</p>\n"}], "owner": {"reputation": 27, "user_id": 5834252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ee721d63546fe016c3d191bafe7fdc83?s=128&d=identicon&r=PG&f=1", "display_name": "Wearin", "link": "https://stackoverflow.com/users/5834252/wearin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 0, "accepted_answer_id": 35447960, "answer_count": 3, "score": 0, "last_activity_date": 1455745979, "creation_date": 1455683116, "question_id": 35447941, "link": "https://stackoverflow.com/questions/35447941/switch-statement-keeps-using-default-case-no-matter-what-c-beginner", "title": "Switch statement keeps using default case no matter what - C beginner", "body": "<p>//This code is supposed to add or subtract and keep track of four different beer brands with individual ID's. Using -1 does exit, but using any of the ID numbers 1-4 causes the program to execute the defualt case.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\nint inv1;\nint inv2;\nint inv3;\nint inv4;\n\nprintf(\"Pleas enter the beginning inventory of Piels. \\n\");\nscanf(\"%d\", &amp;inv1);\nprintf(\"Pleas enter the beginning inventory of Coors. \\n\");\nscanf(\"%d\", &amp;inv2);\nprintf(\"Pleas enter the beginning inventory of Bud. \\n\");\nscanf(\"%d\", &amp;inv3);\nprintf(\"Pleas enter the beginning inventory of Iron City. \\n\");\nscanf(\"%d\", &amp;inv4);\n\nprintf(\"Please enter the ID number. \\n Piels - 1 \\n Coors - 2 \\n Bud - 3 \\n Iron City - 4 \\n Enter -1 to exit \\n\"); \n\nint id;\n\nscanf(\"%d\", &amp;id);\nwhile( id != -1){\n\nint amount;\n\n    switch (id) {\n    case '1': \n         printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n         scanf(\"%d\", &amp;amount);\n         inv1 += amount;\n         break;\n    case '2': \n         printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n         scanf(\"%d\", &amp;amount);\n         inv2 += amount;\n         break;\n    case '3': \n         printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n         scanf(\"%d\", &amp;amount);\n         inv3 += amount;\n         break;\n    case '4': \n         printf(\"Enter the change in amount. It will be a negative if the amount is sold, or positive if the amount is purchased \\n\");\n         scanf(\"%d\", &amp;amount);\n         inv4 += amount;\n         break;\n    default:\n        printf(\"Error: That ID Number is not an option. \\n\");\n        break;\n                  }\n\n\nprintf(\"Please enter the ID number. \\n Piels - 1 \\n Coors - 2 \\n Bud - 3 \\n Iron City - 4 \\n Enter -1 to exit \\n\");\n    scanf(\"%d\", &amp;id);\n}\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["c", "file", "random-access"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1455715585, "post_id": 35447852, "comment_id": 58612266, "body": "When posting code, a consistent readable indentation will make your question more readable. Check the preview before posting code (and edit afterwards if it does not look good)."}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 5905417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d5f520580bde38fccd427921430d14f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco_D", "link": "https://stackoverflow.com/users/5905417/marco-d"}, "edited": false, "score": 0, "creation_date": 1455734856, "post_id": 35457744, "comment_id": 58625941, "body": "I&#39;m not undestarding a part of the code: fseek ( fd, 0, SEEK_CUR);  Do this set the stream to the first bit of the file? Why i need this? @user3121023"}, {"owner": {"reputation": 65, "user_id": 5905417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d5f520580bde38fccd427921430d14f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco_D", "link": "https://stackoverflow.com/users/5905417/marco-d"}, "edited": false, "score": 1, "creation_date": 1455736402, "post_id": 35457744, "comment_id": 58626885, "body": "just found my answer here: <a href=\"http://stackoverflow.com/questions/1713819/why-fseek-or-fflush-is-always-required-between-reading-and-writing-in-the-read-w\" title=\"why fseek or fflush is always required between reading and writing in the read w\">stackoverflow.com/questions/1713819/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "is_accepted": true, "score": 1, "last_activity_date": 1455714818, "creation_date": 1455714818, "answer_id": 35457744, "question_id": 35447852, "link": "https://stackoverflow.com/questions/35447852/update-a-file-record/35457744#35457744", "title": "Update a file record", "body": "<p><code>fseek</code> should be called when switching between read and write.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct{\n    int codigo;\n    char nombre[30];\n    char integrantes[100];\n    int cant_discos;\n} t_bandas;\n\nint main()\n{\n    int res,cant;\n    long pos = 0;\n    t_bandas aux;\n    FILE * fd;\n\n    fd=fopen(\"bandas.dat\",\"rb+\");\n    if(fd==NULL){\n        puts(\"ERROR\");\n        exit(-1);\n    }\n\n    while ( ( res = fread ( &amp;aux, 1, sizeof ( t_bandas), fd)) == sizeof ( t_bandas)) {\n        printf(\"New cant value..\\n\");\n        scanf(\"%d\",&amp;cant);\n        aux.cant_discos=cant;\n        fseek ( fd, pos, SEEK_SET);//seek to start of record\n        fwrite(&amp;aux,sizeof( t_bandas),1,fd);\n        pos = ftell ( fd);//store end of record\n        fseek ( fd, 0, SEEK_CUR);//seek in-place to change from write to read\n    }\n    fclose(fd);\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 5905417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1d5f520580bde38fccd427921430d14f?s=128&d=identicon&r=PG&f=1", "display_name": "Marco_D", "link": "https://stackoverflow.com/users/5905417/marco-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 35457744, "answer_count": 1, "score": 1, "last_activity_date": 1455714818, "creation_date": 1455682643, "question_id": 35447852, "link": "https://stackoverflow.com/questions/35447852/update-a-file-record", "title": "Update a file record", "body": "<p>I'm trying to update a record of a random access file in C. I just need to update the integer cant_discos in every record of my .dat file.</p>\n\n<p>This is the code i wrote, i have 2 problems:</p>\n\n<p>1) My code just let me edit the first record of my file.</p>\n\n<p>2) The program doesn't update the record.  </p>\n\n<pre><code>typedef struct{\nint codigo;\nchar nombre[30];\nchar integrantes[100];\nint cant_discos;\n} t_bandas;\n\nint main()\n{\n   int res,cant;\nt_bandas aux;\n    FILE * fd;\n    fd=fopen(\"bandas.dat\",\"rb+\");\n    if(fd==NULL){ puts(\"ERROR\"); exit(-1)}\n\nwhile(!feof(fd)){\nres=fread(&amp;aux,sizeof( t_bandas),1,fd);\nif(res!=0){\nprintf(\"New cant value..\\n\");\nscanf(\"%d\",&amp;cant);\naux.cant_discos=cant;\nfwrite(&amp;aux,sizeof( t_bandas),1,fd);    \n}    \n}\nfclose(fd);\n    return 0;    }\n</code></pre>\n"}, {"tags": ["c", "gcc", "clock", "timing"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455683657, "post_id": 35447849, "comment_id": 58593486, "body": "Your problem is likely due to problems in <code>Myfunction</code> or your <code>float</code> cast. Try casting to <code>(double)</code> and change the format specifier to <code>%.8lf</code>."}, {"owner": {"reputation": 1752, "user_id": 1597059, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/AEZlG.png?s=128&g=1", "display_name": "A23149577", "link": "https://stackoverflow.com/users/1597059/a23149577"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455688116, "post_id": 35447849, "comment_id": 58595057, "body": "@DavidC.Rankin I changed it as you mentioned, but nothing have been changed. I am still getting system halted"}], "owner": {"reputation": 1752, "user_id": 1597059, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/AEZlG.png?s=128&g=1", "display_name": "A23149577", "link": "https://stackoverflow.com/users/1597059/a23149577"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1455682634, "creation_date": 1455682634, "question_id": 35447849, "link": "https://stackoverflow.com/questions/35447849/trying-to-get-timing-for-a-c-function-leads-to-system-halted", "title": "Trying to get timing for a C function leads to system halted", "body": "<p>I am trying to get timing for a C function on Ubuntu. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;inttypes.h&gt;\n#include &lt;time.h&gt;   \n\nint main(){\nclock_t start1, end1;\nint ITER = 250;\nuint32_t i = 0;\n\nuint32_t a[16] = {0x000000f0,0x000ff000, 0x00000000,0x00000000,0x00ff0000, 0x000f0000, 0x00fa0000, 0x00eee000,0x00000000,0x00000000, 0x00000000,0x00000000,0x00000000, 0x00000000, 0x00000000, 0x00000000};\nuint32_t b[16] = {0x00000fff,0xff000000, 0x0ff00000,0x00ff0000,0x000ff000, 0x0000ff00, 0x00000000, 0x00000000,0x00000000,0x00000000, 0x00000000,0x00000000,0x00000000, 0x00000000, 0x00000000, 0x00000000};\nuint32_t m[16] = {0x00000fff,0xff000000, 0x0ff00000,0x00ff0000,0x000ff000, 0x0000ff00, 0x00000ff0, 0x000000ff,0x00000000,0x00000000, 0x00000000,0x00000000,0x00000000, 0x00000000, 0x00000000, 0x00000000};\n\n\nuint32_t res[16] = {0};\n\nstart1 = clock();\nfor(i = 0; i &lt; ITER; i +=1){\n        Myfunction(res, b, a, m);\n}\nend1 = clock();\nprintf(\"clock_per_sec = %.8f\\n\",(float)(end1 - start1)/(CLOCKS_PER_SEC * ITER));\nreturn 0;\n}\n</code></pre>\n\n<p>If I set the <code>ITER</code> variable to 250, I'd get my timing around 2~9 us. So, I tried to set the <code>ITER</code> variable to some greater number like 1000 to get more accurate timing values. However, even for <code>ITER = 251</code> when I run my code, I've got system halted. I cannot figure out where the problem is, since my function takes around 5 us in average, running 1000 times should take around 5 ms. My function is an inline assembly function which uses AArch64 advanced SIMD assembly instructions and vector registers. Could it be related to that?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455682756, "post_id": 35447839, "comment_id": 58593216, "body": "<code>printf(&quot;%p&quot;, addr);</code> You use <code>%p</code> to print pointers..."}], "answers": [{"tags": [], "owner": {"reputation": 14710, "user_id": 5538420, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/oc81s.jpg?s=128&g=1", "display_name": "dxiv", "link": "https://stackoverflow.com/users/5538420/dxiv"}, "is_accepted": false, "score": 2, "last_activity_date": 1455682765, "creation_date": 1455682765, "answer_id": 35447881, "question_id": 35447839, "link": "https://stackoverflow.com/questions/35447839/getting-the-address-as-a-char-string-in-c/35447881#35447881", "title": "getting the address as a char string in c?", "body": "<p>Try this instead:</p>\n\n<pre><code>sprintf(addr, \"%p\", &amp;c);\nprintf(\"%s\\n\", addr);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1455682875, "creation_date": 1455682875, "answer_id": 35447904, "question_id": 35447839, "link": "https://stackoverflow.com/questions/35447839/getting-the-address-as-a-char-string-in-c/35447904#35447904", "title": "getting the address as a char string in c?", "body": "<p>Use <code>sprintf(addr, \"%p\", &amp;c);</code></p>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 5719895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e410ee91b279c7f1d4bd12cd551f33cd?s=128&d=identicon&r=PG&f=1", "display_name": "please rekt me", "link": "https://stackoverflow.com/users/5719895/please-rekt-me"}, "edited": false, "score": 0, "creation_date": 1455684038, "post_id": 35447944, "comment_id": 58593614, "body": "why is (void *) used?"}, {"owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "reply_to_user": {"reputation": 55, "user_id": 5719895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e410ee91b279c7f1d4bd12cd551f33cd?s=128&d=identicon&r=PG&f=1", "display_name": "please rekt me", "link": "https://stackoverflow.com/users/5719895/please-rekt-me"}, "edited": false, "score": 0, "creation_date": 1455684178, "post_id": 35447944, "comment_id": 58593653, "body": "According to the C specification, the argument for <code>%p</code> must be a <code>void *</code>. So other types of pointers need to be cast to <code>void *</code>. On most systems, it doesn&#39;t make any difference, but there are some weird computer systems where it does matter."}], "tags": [], "owner": {"reputation": 31945, "user_id": 3386109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zt9UL.png?s=128&g=1", "display_name": "user3386109", "link": "https://stackoverflow.com/users/3386109/user3386109"}, "is_accepted": true, "score": 1, "last_activity_date": 1455683145, "creation_date": 1455683145, "answer_id": 35447944, "question_id": 35447839, "link": "https://stackoverflow.com/questions/35447839/getting-the-address-as-a-char-string-in-c/35447944#35447944", "title": "getting the address as a char string in c?", "body": "<p>The <code>sprintf</code> function is used to \"print\" to a string. So instead of </p>\n\n<pre><code>strcpy(addr, &amp;c);\n\nprintf(\"%p\\n\", &amp;c);\nprintf(\"%s\", addr);\n\nprintf(\"\\n\");\n</code></pre>\n\n<p>try</p>\n\n<pre><code>sprintf( addr, \"%p\", (void *)&amp;c );\nprintf( \"%p\\n\", (void *)&amp;c );\nprintf( \"%s\\n\", addr );\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5719895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e410ee91b279c7f1d4bd12cd551f33cd?s=128&d=identicon&r=PG&f=1", "display_name": "please rekt me", "link": "https://stackoverflow.com/users/5719895/please-rekt-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3562, "favorite_count": 0, "accepted_answer_id": 35447944, "answer_count": 3, "score": 3, "last_activity_date": 1455683145, "creation_date": 1455682572, "question_id": 35447839, "link": "https://stackoverflow.com/questions/35447839/getting-the-address-as-a-char-string-in-c", "title": "getting the address as a char string in c?", "body": "<p>say I have the following:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main() {\n    char c = 'c';\n    char addr[50];\n    strcpy(addr, &amp;c);\n\n    printf(\"%p\\n\", &amp;c);\n    printf(\"%s\", addr);\n\n    printf(\"\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>The above would print</p>\n\n<pre><code>0x7ffc241780af\nc@@ //some gibberish\n</code></pre>\n\n<p>for the second line of the output, I am intending to output the char array so that it prints same as the first line.\nI am wishing to have memory address as a string so that I can manipulate with it, but how exactly do I get the memory address as a char string?</p>\n"}, {"tags": ["c", "algorithm", "casting", "bit-manipulation"], "comments": [{"owner": {"reputation": 2088, "user_id": 1535706, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fdbc5a75b701551a48a172a534c74e92?s=128&d=identicon&r=PG", "display_name": "rslemos", "link": "https://stackoverflow.com/users/1535706/rslemos"}, "edited": false, "score": 0, "creation_date": 1455681571, "post_id": 35447511, "comment_id": 58592890, "body": "You should use the correct format specifier for <code>long long</code>: <code>%lld</code> (or <code>%llX</code> for hex). Besides, <code>produceCopy1</code> is not defined; also <code>cOut</code> is read before it gets initialized."}, {"owner": {"reputation": 2088, "user_id": 1535706, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fdbc5a75b701551a48a172a534c74e92?s=128&d=identicon&r=PG", "display_name": "rslemos", "link": "https://stackoverflow.com/users/1535706/rslemos"}, "edited": false, "score": 0, "creation_date": 1455681643, "post_id": 35447511, "comment_id": 58592914, "body": "You have to initialize it to what value is sane for your algorithm. Is it zero? Then <code>int cOut = 0;</code>."}, {"owner": {"reputation": 11, "user_id": 5938286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c750df7459216cac1421658ce6634c8?s=128&d=identicon&r=PG&f=1", "display_name": "MrNinjaSox", "link": "https://stackoverflow.com/users/5938286/mrninjasox"}, "reply_to_user": {"reputation": 2088, "user_id": 1535706, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/fdbc5a75b701551a48a172a534c74e92?s=128&d=identicon&r=PG", "display_name": "rslemos", "link": "https://stackoverflow.com/users/1535706/rslemos"}, "edited": false, "score": 0, "creation_date": 1455682038, "post_id": 35447511, "comment_id": 58593026, "body": "I have done that, and my problem still is not solved. Thank you though for noticing that, I didn&#39;t see that when I looked at it. I believe the error is something with my bit masking and type casting. I am not sure what is wrong with that though."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1455685391, "post_id": 35447511, "comment_id": 58594059, "body": "Bit shifts on signed values are problematic. See <a href=\"http://stackoverflow.com/questions/4009885/arithmetic-bit-shift-on-a-signed-integer\"><b>Arithmetic bit-shift on a signed integer</b></a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1460444429, "post_id": 35447511, "comment_id": 60731203, "body": "Make all your types be unsigned, and use <code>ULL</code> suffix on your hex constants"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 5928295, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/reGMi.jpg?s=128&g=1", "display_name": "Aditya B G", "link": "https://stackoverflow.com/users/5928295/aditya-b-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1455685044, "creation_date": 1455685044, "answer_id": 35448248, "question_id": 35447511, "link": "https://stackoverflow.com/questions/35447511/problems-with-bit-shifting-and-type-casting-when-implementing-booths-algorithm/35448248#35448248", "title": "Problems with Bit Shifting and Type Casting when Implementing Booth&#39;s Algorithm", "body": "<p>Return of function Add() may not be integer type but you are returning int type. If we add two integers may result more than int type.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 3661991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pKRul.jpg?s=128&g=1", "display_name": "iloveracecarguy219843798217413", "link": "https://stackoverflow.com/users/3661991/iloveracecarguy219843798217413"}, "is_accepted": false, "score": 0, "last_activity_date": 1455695615, "creation_date": 1455695615, "answer_id": 35450794, "question_id": 35447511, "link": "https://stackoverflow.com/questions/35447511/problems-with-bit-shifting-and-type-casting-when-implementing-booths-algorithm/35450794#35450794", "title": "Problems with Bit Shifting and Type Casting when Implementing Booth&#39;s Algorithm", "body": "<p>You don't need those masks to solve the problem. If the masking is the problem, just bitwise or the product and the multiplier, which will set the lower 32 bits of the 64 bit product to the \"right half\" you want. Then, just pass the product shifted 32 bits to the right, cast to an int in your addition function call. This will truncate the 64 bit binary to 32 bit binary.</p>\n\n<p>PS. Starting Babic's lab assignments the night before ensures you're going to be in for a bad time...</p>\n"}, {"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1460465648, "creation_date": 1460465648, "answer_id": 36573928, "question_id": 35447511, "link": "https://stackoverflow.com/questions/35447511/problems-with-bit-shifting-and-type-casting-when-implementing-booths-algorithm/36573928#36573928", "title": "Problems with Bit Shifting and Type Casting when Implementing Booth&#39;s Algorithm", "body": "<p>In addition to the errors rslemos noticed, there are still two things to correct:</p>\n\n<ol>\n<li>The integer constants <code>0xFFFFFFFF00000000</code> and <code>0xFFFFFFFFFFFFFFFF</code> need a suffix with <code>LL</code>.</li>\n<li><p>When adding something to <code>product</code>, the value added must not sign-extend. Thus, change</p>\n\n<pre><code>    product = (long long) Add (0, multiplier);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>    product = (unsigned)multiplier; // do not sign-extend multiplier\n</code></pre>\n\n<p>and</p>\n\n<pre><code>            product = (long long) Add((int)product, productRHI);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>            product |= (unsigned)productRHI;    // do not sign-extend productRHI\n</code></pre>\n\n<p>(two occurrences).</p></li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 5938286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c750df7459216cac1421658ce6634c8?s=128&d=identicon&r=PG&f=1", "display_name": "MrNinjaSox", "link": "https://stackoverflow.com/users/5938286/mrninjasox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1460465648, "creation_date": 1455680677, "last_edit_date": 1460444288, "question_id": 35447511, "link": "https://stackoverflow.com/questions/35447511/problems-with-bit-shifting-and-type-casting-when-implementing-booths-algorithm", "title": "Problems with Bit Shifting and Type Casting when Implementing Booth&#39;s Algorithm", "body": "<p>I am writing a program that implements <a href=\"https://en.wikipedia.org/wiki/Booth%27s_multiplication_algorithm#A_typical_implementation\" rel=\"nofollow\">Booth's Algorithm</a> to multiply ints. I am only allowed to use bit-level operators, logical operators, and bit shifts. I am allowed one loop for the program, and a function that will add two ints.\nI am having trouble understanding what is going wrong with my program. When I am using bitwise operators to mask half of the long long, I am getting incorrect values. Any advice on what I am doing wrong there? Maybe I am not understanding how to mask properly. It also may have to do with type casting; I am really unsure. Thanks in advance for any help!</p>\n\n<p>Here is by code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint Add (int x, int y);\nlong long Booth (int x, int y);\n\nint main() {\n    int hex1, hex2;\n    long long product;\n    printf(\"\\nEnter Multiplicand &amp; Multiplier in hex: \");\n    scanf(\" %x %x\", &amp;hex1, &amp;hex2);\n\n    product = Booth(hex1, hex2);\n\n    printf(\"Multiplicand = 0x%08X \\tAs signed = %+d\\n\", hex1, hex1);\n    printf(\"Multiplier = 0x%08X \\tAs signed = %+d\\n\", hex2, hex2);\n    printf(\"Product = 0x%16X \\tAs signed = %+d\\n\", product, product);\n}\n\nint Add (int x, int y) {\n    return x + y;\n}\n\nlong long Booth (int multiplicand, int multiplier) {\n    int i;\n    long long product;\n    long long productLH;\n    long long productRH;\n    int productLHI;\n    int productRHI;\n    int cOut;\n    int negMultiplicand;\n    negMultiplicand = Add (~multiplicand, 1);\n    product = (long long) Add (0, multiplier);\n\n    for (i = 0; i &lt; 32; i++) {\n        if (((product &amp; 1) == 1) &amp;&amp; (cOut == 0)) {\n            //Mask left half and right half of product\n            productLH = (product &amp; 0xFFFFFFFF00000000);\n            productRH = (product &amp; 0x00000000FFFFFFFF);\n\n            //Bit shift product so all values are in lower 32 bits\n            productLH = (productLH &gt;&gt; 32);\n\n            //Convert left halves and right halves to ints\n            productLHI = (int) (productLH &amp; 0x00000000FFFFFFFF);\n            productRHI = (int) productRH &amp; (0x00000000FFFFFFFF);\n            productLHI = Add(productLHI, negMultiplicand);\n\n            //Put halves back together\n            product = (long long) Add(productLHI, 0);\n            product = ((product &lt;&lt; 32) &amp; 0xFFFFFFFFFFFFFFFF);\n            product = (long long) Add((int)product, productRHI);\n        }   \n        else if (((product &amp; 1) == 0) &amp;&amp; (cOut == 1)) {\n            //Mask left half and right half of product\n            productLH = (product &amp; 0xFFFFFFFF00000000);\n            productRH = (product &amp; 0x00000000FFFFFFFF);\n\n            //Bit shift product so all values are in lower 32 bits\n            productLH = (productLH &gt;&gt; 32);\n\n            //Convert left halves and right halves to ints\n            productLHI = (int) (productLH &amp; 0x00000000FFFFFFFF);\n            productRHI = (int) productRH &amp; (0x00000000FFFFFFFF);\n            productLHI = Add(productLHI, multiplicand);\n\n            //Put halves back together\n            product = (long long) Add(productLHI, 0);\n            product = ((product &lt;&lt; 32) &amp; 0xFFFFFFFFFFFFFFFF);\n            product = (long long) Add((int)product, productRHI);\n        }\n        cOut = (product &amp; 1);\n        product = product &gt;&gt; 1;\n    }\n    return product;\n}\n</code></pre>\n"}]