[{"tags": ["c", "pointers", "segmentation-fault"], "comments": [{"owner": {"reputation": 2059, "user_id": 2759368, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d03e2c110cced20e5bde6dc62146fcce?s=128&d=identicon&r=PG&f=1", "display_name": "nnn", "link": "https://stackoverflow.com/users/2759368/nnn"}, "edited": false, "score": 0, "creation_date": 1448496231, "post_id": 33928522, "comment_id": 55618040, "body": "Can you post also the implementation of <code>power_arr</code>? The issue may be there..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1448496766, "post_id": 33928522, "comment_id": 55618166, "body": "I don&#39;t quite understand how the second call can be made if the first has seg-faulted. Is this your code or &quot;something like my code&quot;?"}, {"owner": {"reputation": 105, "user_id": 5382962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bede225260668ef42bfb94aaf13b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "hermetik", "link": "https://stackoverflow.com/users/5382962/hermetik"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448496984, "post_id": 33928522, "comment_id": 55618227, "body": "@Weather Vane. My apologizes. I originally had the first call - which produced a segmentation fault. Prior to this, I tested the function call in another source file, so I simply copied the block of statements (variables and second function call). Commented out the first, re-ran the second successfully. I was left scratching my head as to why the call was failing, when I tested the call seconds prior. The inclusion of both calls was to show that I have used identical variable types and calling conventions."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448497060, "post_id": 33928522, "comment_id": 55618245, "body": "You&#39;re never allocating any space for <code>rlength</code> to point to. So <code>power_arr()</code> is indirecting through an uninitialized pointer."}, {"owner": {"reputation": 105, "user_id": 5382962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bede225260668ef42bfb94aaf13b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "hermetik", "link": "https://stackoverflow.com/users/5382962/hermetik"}, "edited": false, "score": 0, "creation_date": 1448497203, "post_id": 33928522, "comment_id": 55618278, "body": "@Barmer. That makes total sense, but then, why would the second call succeed every time? *length is an uninitialized pointer as well. Also, *rlength is initialized in power_arr; the call `*res_length = nlength."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448497239, "post_id": 33928522, "comment_id": 55618288, "body": "Don&#39;t expect to draw <i>any</i> conclusions when UB happens to work."}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 1, "last_activity_date": 1448497071, "creation_date": 1448497071, "answer_id": 33928671, "question_id": 33928522, "link": "https://stackoverflow.com/questions/33928522/segmentation-fault-on-identical-code/33928671#33928671", "title": "Segmentation Fault on Identical Code", "body": "<p>The program has undefined behaviour because pointer <code>rlength</code> was not initialized and has indetermined value.</p>\n\n<pre><code>int *rlength;\n</code></pre>\n\n<p>On the other hand in the function you are trying to write to an unallocated memory using this pointer.</p>\n\n<pre><code>*res_length = nlength;\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 5382962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/bede225260668ef42bfb94aaf13b2e0e?s=128&d=identicon&r=PG&f=1", "display_name": "hermetik", "link": "https://stackoverflow.com/users/5382962/hermetik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "closed_date": 1448497132, "accepted_answer_id": 33928671, "answer_count": 1, "score": 1, "last_activity_date": 1448527374, "creation_date": 1448495988, "last_edit_date": 1448527374, "question_id": 33928522, "link": "https://stackoverflow.com/questions/33928522/segmentation-fault-on-identical-code", "closed_reason": "Duplicate", "title": "Segmentation Fault on Identical Code", "body": "<p>I have a case where I am calling a function twice, using two different sets of variables. The first call results in a segmentation fault, the second call returns successfully.</p>\n\n<p>The parameters are identical, short of the variable names. What could be the cause of this behavior?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include \"euler-v2.h\"\n\n#define POWER 1000\n\nint main(void)\n{\n    int i;\n\n    int base[] = { 2 };\n    int *r;\n    int *rlength;\n\n    // The below line causes a segmentation fault\n    r = power_arr(base, sizeof(base) / sizeof(int), 2, rlength);\n\n    int n[] = { 2 };\n    int *pow;\n    int *length;\n\n    pow = power_arr(n, sizeof(n) / sizeof(int), 2, length);\n\n\n    exit(0); \n}\n</code></pre>\n\n<p>The function prototype in a separate header file:</p>\n\n<pre><code>int *power_arr(int *n, int nlength, int exp, int *res_length);\n</code></pre>\n\n<p>I cant discern any difference between the first call to <code>power_arr</code> and the second call. Any insight into what exactly is occurring here?</p>\n\n<p>EDIT:</p>\n\n<p>Source for function <code>power_arr</code>:</p>\n\n<pre><code>int *power_arr(int *n, int nlength, int exp, int *res_length)\n{\n    int i, j, tmp_length;\n    int *res, *tmp;\n\n    res = n;\n\n    printf(\"Step 1\\n\"); // Last printed line\n    *res_length = nlength;\n    printf(\"Step 2\\n\"); // Never reaches here\n\n    while (--exp &gt; 0)\n    {\n        tmp_length = *res_length;\n        tmp = malloc(sizeof(int) * tmp_length);\n\n        if (!tmp)\n        {\n            return NULL;\n        }\n\n        copy(tmp, res, *res_length);\n\n        for (i = *n - 1; i &gt; 0; i--)\n        {\n            res = sum(res, *res_length, tmp, tmp_length, res_length);\n        }\n\n        if (!res)\n        {\n            return NULL;\n        }\n\n            free(tmp);\n    }\n        return res;\n}\n</code></pre>\n\n<p>Note, I have placed to <code>printf</code> statements for debugging. I have commented where the code execution fails.</p>\n"}, {"tags": ["c", "synchronization", "semaphore"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448531231, "post_id": 33928365, "comment_id": 55630447, "body": "It is not the job of stackoverflow to design your code, it is not the job of stackoverflow to perform the analysis of your problem scenario.  We are here to answer two kinds of questions  1) why does it not compile and 2) why is the wrong output being produced.   In either case, you must post your code, and in the first case indicate exactly what is not compiling.  and in the second case post the input, the expected output, and the actual output.   In general, no code, no help.  We will not do your homework for you."}, {"owner": {"reputation": 601, "user_id": 3288630, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2a1f87803038dce5d1a9688c82c1e41?s=128&d=identicon&r=PG", "display_name": "deqyra", "link": "https://stackoverflow.com/users/3288630/deqyra"}, "reply_to_user": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448533904, "post_id": 33928365, "comment_id": 55632183, "body": "Thank you for your help."}], "answers": [{"comments": [{"owner": {"reputation": 601, "user_id": 3288630, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2a1f87803038dce5d1a9688c82c1e41?s=128&d=identicon&r=PG", "display_name": "deqyra", "link": "https://stackoverflow.com/users/3288630/deqyra"}, "edited": false, "score": 0, "creation_date": 1448534325, "post_id": 33928845, "comment_id": 55632449, "body": "I&#39;m gonna try that out, I have a few ideas, thanks for the hint :-)"}], "tags": [], "owner": {"reputation": 2381, "user_id": 2574937, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/feedcf155189fa4c0e6f0f5ef99e6201?s=128&d=identicon&r=PG&f=1", "display_name": "Brian Malehorn", "link": "https://stackoverflow.com/users/2574937/brian-malehorn"}, "is_accepted": true, "score": 2, "last_activity_date": 1448498441, "creation_date": 1448498441, "answer_id": 33928845, "question_id": 33928365, "link": "https://stackoverflow.com/questions/33928365/semaphores-enhanced-swimming-pool/33928845#33928845", "title": "Semaphores : enhanced swimming pool", "body": "<blockquote>\n  <p>imagine this case: a non-member is waiting for his basket, and there\n  are no members in the queue at the moment. Then, a member shows up,\n  and obviously, he is waiting for resources too. At this point, the\n  non-members who were waiting too should fall asleep until the member\n  leaves the queue, but they are already asleep waiting for their\n  basket, which means they already called P(s_members). As a result, the\n  priority rule does not apply.</p>\n</blockquote>\n\n<p>So what you're saying is \"if a non-member goes to sleep in the same queue as members do, we're screwed\". I agree. Once a non-member goes to sleep in the queue, you can't exactly yank them out later.</p>\n\n<p>Since non-members and members cannot wait for a resource on the same semaphore, <code>s_basket</code> must be wrong.</p>\n\n<p>How about trying <code>s_basket_members</code> and <code>s_basket_nonmembers</code>?</p>\n\n<p>I believe you will also need to keep track of a few <code>int</code>s as well, like how many members/non-members are waiting, and how many baskets are available.</p>\n"}], "owner": {"reputation": 601, "user_id": 3288630, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d2a1f87803038dce5d1a9688c82c1e41?s=128&d=identicon&r=PG", "display_name": "deqyra", "link": "https://stackoverflow.com/users/3288630/deqyra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 33928845, "answer_count": 1, "score": 1, "last_activity_date": 1448534441, "creation_date": 1448495026, "last_edit_date": 1448534441, "question_id": 33928365, "link": "https://stackoverflow.com/questions/33928365/semaphores-enhanced-swimming-pool", "title": "Semaphores : enhanced swimming pool", "body": "<p>I am working on process synchronization, with an improved version of the swimming pool problem:</p>\n\n<blockquote>\n  <p>Bathers want to go to the swimming pool:  </p>\n  \n  <ul>\n  <li>They have to take an empty basket  </li>\n  <li>They have to go in a free cubicle  </li>\n  <li>They put their swimsuit on, put their clothes in the basket and leave the cubicle  </li>\n  <li>They swim  </li>\n  <li>They head back to a free cubicle with their basket  </li>\n  <li>They put their clothes back on, and leave the cubicle  </li>\n  <li>They give the empty basket back  </li>\n  <li>There is a limited number of baskets and cubicles  </li>\n  <li>If a bather can't find an empty basket or a free cubicle, he will wait until one is available  </li>\n  </ul>\n  \n  <h1>IMPROVED VERSION:</h1>\n  \n  <ul>\n  <li>There are members and non-members  </li>\n  <li>The members have priority over non-members  </li>\n  <li>If one resource becomes available, it will be given to a waiting member, and if there's not, it will be given to anyone waiting.</li>\n  </ul>\n</blockquote>\n\n<p>To do this, I thought I'd use 3 semaphores: one for the baskets, one for the cubicles, and one for the waiting members. This way, when a member is waiting, the semaphore would block any process calling <code>P(s_members)</code>, and when a member finally gets a basket, he calls <code>V(s_members)</code>. But there can be several members waiting in the queue, and the semaphore should not 'release' a non-member each time <code>V(s_members)</code> is called. That's why I thought <code>sembuf.sem_op = 0;</code> would be a good deal, because non-members would have to wait for 0.<br>\nThe problem is that with this solution:  </p>\n\n<ul>\n<li>non-members have to call <code>P(s_members)</code> before calling <code>P(s_basket)</code> or <code>P(s_cubicle)</code>.</li>\n<li>non-members have to call <code>P(s_members)</code> in order to fall asleep and be queued with others, but they need not to increase/decrease the value of the semaphore, because it doesn't depend on them.  </li>\n<li>members waiting for resources need to call <code>P(s_members)</code> in order to increase/decrease its value (because they are in the queue), but they need not to fall asleep and continue waiting for their basket.  </li>\n<li>imagine this case: a non-member is waiting for his basket, and there are no members in the queue at the moment. Then, a member shows up, and obviously, he is waiting for resources too. At this point, the non-members who were waiting too should fall asleep until the member leaves the queue, but they are already asleep waiting for their basket, which means they already called <code>P(s_members)</code>. As a result, the priority rule does not apply.</li>\n</ul>\n\n<p>How can we solve that ?<br>\nI hope it's clear enough, it's hard to explain and easy to mess it up all.\nThank you for your time reading this.</p>\n\n<p><strong>EDIT:</strong><br>\nSorry if I posted this on the wrong StackExchange community, I will think twice about it next time!</p>\n"}, {"tags": ["c", "static-libraries"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 3, "creation_date": 1448495116, "post_id": 33928358, "comment_id": 55617734, "body": "Libraries, especially static libraries, should be listed after source files or object files on the linking command line.  And what&#39;s your library doing in the <code>inc</code> directory?  Libraries go in a <code>lib</code> directory \u2014 hence <code>&#47;usr&#47;lib</code> and <code>&#47;lib</code> and <code>&#47;usr&#47;local&#47;lib</code>.  Anyway, hacking the compiler line: <code>gcc -Wall -Werror -Wextra -I.&#47;inc -L.&#47;inc main.c -lft</code> (assuming you really have <code>libft.a</code> in your <code>inc</code> directory)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448495469, "post_id": 33928358, "comment_id": 55617821, "body": "Incidentally, it&#39;s good to see you taking warnings seriously; take kudos for that."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448495737, "post_id": 33928358, "comment_id": 55617914, "body": "See also <a href=\"https://stackoverflow.com/questions/9253200\">Undefined reference to <code>pthread_create()</code></a> and <a href=\"https://stackoverflow.com/questions/22623851\">Trouble compiling against static library</a>."}, {"owner": {"reputation": 29, "user_id": 5367273, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637549015419/picture?type=large", "display_name": "Nestoyeur", "link": "https://stackoverflow.com/users/5367273/nestoyeur"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448497037, "post_id": 33928358, "comment_id": 55618240, "body": "Awsome it work well now, thanks :) for this inc/libft.a it was for test how work the options -L and -l with gcc but yeah when i will finish this lib it will go in all my other project in a lib folder ;p"}], "owner": {"reputation": 29, "user_id": 5367273, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153637549015419/picture?type=large", "display_name": "Nestoyeur", "link": "https://stackoverflow.com/users/5367273/nestoyeur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1448495804, "answer_count": 0, "score": 0, "last_activity_date": 1448495340, "creation_date": 1448494975, "last_edit_date": 1448495340, "question_id": 33928358, "link": "https://stackoverflow.com/questions/33928358/cant-compile-main-c-with-my-library-a", "closed_reason": "Duplicate", "title": "Can&#39;t compile main.c with my library.a", "body": "<p>I'm trying to compile <code>libft.a</code> and <code>main.c</code> with this command:</p>\n\n<blockquote>\n  <p>gcc -Wall -Werror -Wextra -I./inc/ -L./inc/ -lft main.c</p>\n</blockquote>\n\n<p>and this is what I get:</p>\n\n<blockquote>\n  <p>/tmp/ccuwcCPB.o: in function \u00ab main \u00bb:<br>\n  main.c:(.text+0x1b): undefined reference to \u00ab ft_putchar \u00bb<br>\n  collect2: error: ld returned 1 exit status</p>\n</blockquote>\n\n<p>I have tried to remove my header file and I get another error about implicit declaration, so this is not a header problem. </p>\n\n<p>I have tried to use a different <code>libft.a</code> coming from an other student (same work) but same problem again. </p>\n\n<p>Does someone have an idea about this error?</p>\n"}, {"tags": ["c", "machine-learning", "openmp", "false-sharing"], "comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448532178, "post_id": 33928347, "comment_id": 55631114, "body": "Add a tag to C or C++, whichever one you are using."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448532287, "post_id": 33928347, "comment_id": 55631187, "body": "Are you sure you don&#39;t have race conditions?  Are the values of <code>X_indptr[i]</code> unique? If they are not it appears to me that two threads could try to write to memory using the same index."}, {"owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448683215, "post_id": 33928347, "comment_id": 55692422, "body": "Added the tag. No, the indexes are not unique, but the race conditions are &quot;desired&quot; in the sense that mathematically the &quot;noise&quot; created by them decays out. The paper shows this. They are not desired in the sense of the actual computation is causing the caches to invalidate and creating a memory bound"}, {"owner": {"reputation": 12289, "user_id": 675568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1cfe53579fb7b2afd58949be94cf97e?s=128&d=identicon&r=PG", "display_name": "Tom Zych", "link": "https://stackoverflow.com/users/675568/tom-zych"}, "edited": false, "score": 0, "creation_date": 1448708914, "post_id": 33928347, "comment_id": 55697777, "body": "I vote for this as &quot;most absurd-looking, yet actually meaningful, title of the year&quot; :)"}], "answers": [{"comments": [{"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448539368, "post_id": 33933444, "comment_id": 55635649, "body": "Nice code cleanup. I guess a private <code>W_local</code> vector won&#39;t work (easily) because of <code>c += X_data[j] * W[X_indices[j]];</code>  I mean <code>c</code> depends on all the full sum I think and so partial sums won&#39;t work.  <code>#pragma atomic</code> before writing to <code>W</code> would fix the problem but I don&#39;t know about performance.  If <code>if ( Y[i] * c &lt;= 1 ) </code> is not true often then this should be okay."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "reply_to_user": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448539815, "post_id": 33933444, "comment_id": 55635944, "body": "@Zboson Yeah, I thought abut the atomic too. But the bulk of the paper the OP was referring to was about not caring about race conditions in the update of <code>W</code> and that the algorithm would converge all the same, but only with better speed-up... So I simply added a comment inside the code telling the race condition was &quot;by design&quot;, although I wouldn&#39;t do that myself in one of my codes."}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "edited": false, "score": 0, "creation_date": 1448540207, "post_id": 33933444, "comment_id": 55636166, "body": "Oh, good point (already up voted). I find the claim a bit surprising. Race conditions at best still cause slow downs even if the result turns out okay."}, {"owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448683754, "post_id": 33933444, "comment_id": 55692508, "body": "Thank you. Makes a lot of sense. Memory bounds have been my problem most of this time. My next idea was to try a vector of locks to lock computation for elements or blocks of the W vector. I will try this later, but can you think of any way to remove the memory access bound of my computation?"}, {"owner": {"reputation": 29002, "user_id": 2542702, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fW5ka.jpg?s=128&g=1", "display_name": "Z boson", "link": "https://stackoverflow.com/users/2542702/z-boson"}, "reply_to_user": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448707218, "post_id": 33933444, "comment_id": 55697283, "body": "@aidan.plenert.macdonald, what about sorting <code>X_indices</code> and then acting on the sorted array?"}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "reply_to_user": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448708552, "post_id": 33933444, "comment_id": 55697688, "body": "@aidan.plenert.macdonald memory bound problems are the most complicated ones to optimise. The typical approach is to tile your problem to better fit in cache and improve data reuse. But here, I hardly see it an option since you have a very random access pattern. Doubling the length of the <code>W</code> array as suggested would improve the false sharing issue, but worsen the data fitting in cache. Finally, a note to say that I&#39;m not convince the algorithm is right, even with the &quot;per design&quot; collision, since the flushing of <code>W</code> is very unpredictable."}, {"owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448724572, "post_id": 33933444, "comment_id": 55702269, "body": "@Gilles You are right. I think something is up with the algorithm. I will spend more time looking at the paper. I&#39;ll report back if there was something I missed. I wasn&#39;t thinking about cache flushes previously."}, {"owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448725504, "post_id": 33933444, "comment_id": 55702583, "body": "<a href=\"http://arxiv.org/pdf/1506.06438v1.pdf\" rel=\"nofollow noreferrer\">arxiv.org/pdf/1506.06438v1.pdf</a> provides a further analysis. They mention cache synchronization here and prove convergence under this system as well. Furthermore they introduce fixed point arithmetic as a improvement to the computation."}, {"owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "edited": false, "score": 0, "creation_date": 1448727613, "post_id": 33933444, "comment_id": 55703303, "body": "I made all the changes you did, and this cut the computation time in half! The biggest player was adding the omp after the pragma ... amazing what writing code properly does!"}], "tags": [], "owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "is_accepted": true, "score": 3, "last_activity_date": 1448708091, "last_edit_date": 1448708091, "creation_date": 1448525484, "answer_id": 33933444, "question_id": 33928347, "link": "https://stackoverflow.com/questions/33928347/false-sharing-in-hogwild-algorithms/33933444#33933444", "title": "False Sharing in Hogwild! Algorithms", "body": "<p>I don't know much about the algorithm you mention, but it looks to me it globally is much more memory bound than compute bound. To convince you, here is a quick rewrite of your code:</p>\n\n\n\n<pre class=\"lang-cpp prettyprint-override\"><code>void update( size_t epoch, const double *X_data, const int *X_indices,\n             const int *X_indptr, const int *Y, double *W,\n             double reg, double step_size, size_t nodes,\n             size_t X_height, size_t X_width ) {\n\n    const double step = step_size / ( 1 + epoch );\n    const double ratio = step / ( X_height * nodes );\n    const double tapper = ( 1 - reg * step ) / nodes;\n\n    #pragma omp parallel \n    {\n        #pragma omp for schedule( static )\n        for ( size_t i = 0; i &lt; X_height; i++ ) {\n            double c = 0;\n            for ( int j = X_indptr[i]; j &lt; X_indptr[i+1]; j++ ) {\n                c += X_data[j] * W[X_indices[j]]; // Scaled to discount the MPI scaling\n            }\n            if ( Y[i] * c &lt;= 1 ) {\n                double ratioYi = Y[i] * ratio;\n                for ( int j = X_indptr[i]; j &lt; X_indptr[i+1]; j++ ) {\n                    // ATTENTION: this will collide across threads and have undefined result BY DESIGN\n                    W[X_indices[j]] += ratioYi * X_data[j];\n                }\n            }\n        } // END FOR OMP PARALLELIZED\n\n        #pragma omp for schedule( static ) // Might not do much\n        for ( size_t i = 0; i &lt; X_width; i++ ) { // (1 - self.reg*step)*self.W/self.nodes +\n            W[i] *= tapper;\n        }\n    }\n}\n</code></pre>\n\n<p>As you can see, I did a few changes. Most of them are purely stylistic (like indentation, spacing, variable declaration location, etc), but some are truly important. For example, by defining <code>ratio</code>, and <code>ratioYi</code> as shallow in loops as possible, I remove (or help the compiler to remove, would it have done it) most the of computations from the code. It becomes all of a sudden obvious that the code almost only accesses data and computes very little.\nTherefore, unless you have a multi-socket (or multi memory controller) shared memory machine, you won't see much speed-up (if any) out of this OpenMP parallelisation.</p>\n\n<p>Moreover, the \"by design\" race conditions the algorithm accepts while updating <code>W</code> in parallel, even if justified in the paper you pointed, keep on puzzling me. I still wouldn't like to rely on an undefined behaviour for a computational code (or any code for that matter).</p>\n\n<p>Anyway, assuming the code does what you want, scales and is indeed only limited by L1 cache invalidations due to false sharing (or indeed true sharing here, since you authorise data collisions), a possible \"solution\" would be to increase the size of your <code>W</code> array, by for example doubling its size, and to only store meaningful data every second index. In your algorithm, this wouldn't change anything. Simply, you would have to multiply by 2 <code>X_indices</code>. By doing that, you would even more limit the likelihood of false sharing by mechanically dividing by two the number of useful data stored in a single cache line. However, again, for a memory-bound code, increasing the memory consumption might not be the best idea ever... But since it is super straightforward a test, just try it and see if it gives you any benefit.</p>\n\n<p>A final note also to say that your code had a bug in the OpenMP parallelisation, whereby you had <code>#pragma for</code> instead of <code>#pragma omp for</code>. Not sure if this was a typo while copying here, but better mentioning it just in case.</p>\n"}], "owner": {"reputation": 4473, "user_id": 3002273, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/14663c07f99bd2fdc191b05db9d3e900?s=128&d=identicon&r=PG&f=1", "display_name": "ignorance", "link": "https://stackoverflow.com/users/3002273/ignorance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 33933444, "answer_count": 1, "score": 3, "last_activity_date": 1448708091, "creation_date": 1448494939, "last_edit_date": 1448683093, "question_id": 33928347, "link": "https://stackoverflow.com/questions/33928347/false-sharing-in-hogwild-algorithms", "title": "False Sharing in Hogwild! Algorithms", "body": "<p>I am trying to implement the <a href=\"https://www.eecs.berkeley.edu/~brecht/papers/hogwildTR.pdf\" rel=\"nofollow\">Hogwild! Linear SVM</a> algorithm, but I am running into false sharing problems with my implementation.</p>\n\n<p>My code is below, but the background is that I am trying to compute which samples fail my test and make and update which is given by that set of vectors. Hogwild! (as far as I understand) simply makes the update on the same memory totally asynchronously. This would create \"noise\" in a mathematical sense due to the improperly times updates.</p>\n\n<p>Sadly, as I try to do these async updates, the L1 cache is invalidated and has to be re-fetched. Below is my code.</p>\n\n<p>Is there a good way to fix this false sharing without losing the asynchronous? (I am more of a mathematician than a computer scientist). <a href=\"https://people.cs.umass.edu/~emery/pubs/Predator-ppopp14.pdf\" rel=\"nofollow\">This</a> mentions that using different optimization levels can fix this.</p>\n\n<pre><code>void update(size_t epoch, const double *X_data, const int *X_indices,\n            const int *X_indptr, const int *Y, double *W,\n            double reg, double step_size, size_t nodes,\n            size_t X_height, size_t X_width) {\n\n  size_t i, j;\n  double step = step_size/(1 + epoch);\n  double c;\n\n#pragma omp parallel shared(W, X_data, X_indices, X_indptr, Y) private(i, j, c)\n  {\n#pragma for schedule(static)\n    for (i=0;i&lt;X_height;i++) {\n      c = 0.0;\n      for (j=X_indptr[i];j&lt;X_indptr[i+1];j++)\n        c += X_data[j]*W[X_indices[j]]; // Scaled to discount the MPI scaling                                                \n\n      if (Y[i]*c &gt; 1)\n        continue;\n\n      for (j=X_indptr[i];j&lt;X_indptr[i+1];j++)\n        W[X_indices[j]] += step*Y[i]*X_data[j]/(X_height*nodes);\n    } // END FOR OMP PARALLELIZED                                                                                            \n\n#pragma for schedule(static) // Might not do much                                                                            \n    for (i=0;i&lt;X_width;i++) // (1 - self.reg*step)*self.W/self.nodes +                                                       \n      W[i] *= (1 - reg*step)/nodes;\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 0, "creation_date": 1448494905, "post_id": 33928299, "comment_id": 55617669, "body": "You need braces around the statements in your for loop in lerArray.  And it looks like you have your relational comparisons backwards in minimo and maximo."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1448495148, "post_id": 33928299, "comment_id": 55617746, "body": "And you need the following:     g = maximo(a);     l = minimo(a);"}, {"owner": {"reputation": 635, "user_id": 5225141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46ca2a143210415021833f869de4551d?s=128&d=identicon&r=PG&f=1", "display_name": "Chad", "link": "https://stackoverflow.com/users/5225141/chad"}, "edited": false, "score": 1, "creation_date": 1448495207, "post_id": 33928299, "comment_id": 55617757, "body": "When you say, &quot;the code can&#39;t be compiled,&quot; you need to give the compiler output.  The errors will tell you (and us) what&#39;s wrong with your code."}, {"owner": {"reputation": 27, "user_id": 5606354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563d84294c75e61c23928dd2455e0ce?s=128&d=identicon&r=PG&f=1", "display_name": "W.W", "link": "https://stackoverflow.com/users/5606354/w-w"}, "edited": false, "score": 0, "creation_date": 1448495405, "post_id": 33928299, "comment_id": 55617805, "body": "First of all,Sorry I only noticed now that the functions are named in Portuguese. The error is in line 13 &quot;  maximo(a) = g; minimo(a) = l;&quot;    It outputs   &quot;lvalue required as left operand of assignment;&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448496103, "post_id": 33928435, "comment_id": 55618007, "body": "The code should really check that <code>scanf()</code> is successful on each iteration, and should decide what to do about a short data set (only 4 numbers instead of 5) too."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448496217, "post_id": 33928435, "comment_id": 55618035, "body": "@JonathanLeffler good point. I just made the minimal changes to get the OP&#39;s code working."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448497080, "post_id": 33928435, "comment_id": 55618252, "body": "Thanks.  I can&#39;t give a second up-vote."}], "tags": [], "owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "is_accepted": true, "score": 3, "last_activity_date": 1448497911, "last_edit_date": 1448497911, "creation_date": 1448495481, "answer_id": 33928435, "question_id": 33928299, "link": "https://stackoverflow.com/questions/33928299/finding-the-greatest-and-the-lowest-value-in-an-array-using-functions-in-c/33928435#33928435", "title": "Finding the greatest and the lowest value in an array using functions in C", "body": "<p>As mentioned in the comments:<br></p>\n\n<pre><code>maximo(a) = g;\nminimo(a) = l;\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>g = maximo(a);\nl = minimo(a);\n</code></pre>\n\n<p><br></p>\n\n<p>And you need braces around your loop in lerArray:</p>\n\n<pre><code>void lerArray (int x[DIM]){\n    int i,numb;\n\n    for(i=0;i&lt;DIM;i++)\n    {\n        printf(\"Intoduza o %d\u00ba elemento\\n\",i);\n            scanf(\"%d\",&amp;numb);\n            x[i]= numb;\n    }\n}\n</code></pre>\n\n<p><br></p>\n\n<p>Also as mentioned by JonathanLeffler you don't error check the return from <code>scanf</code> and don't handle the case where the user doesn't enter all numbers.<br></p>\n\n<p>The code below has those changes. It compiles and runs properly.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define DIM 5\n\nint lerArray (int x[DIM]);\nint maximo(int x[DIM]);\nint minimo(int x[DIM]);\n\n\nint main(){\n    int a[DIM],l,g;\n    int count = 0;\n\n    count = lerArray(a);\n\n    printf(\"Numbers entered = %d\\n\", count);\n\n    if( DIM == count )\n    {\n        g = maximo(a);\n        l = minimo(a);\n\n        printf(\"Minimo:%d \\t  Maximo:%d\\n\",g,l);\n    }\n    else\n    {\n        printf(\"Wrong number of entries.\\n\");\n    }\n\n    return 0;\n}\n\n\nint lerArray (int x[DIM]){\n    int i,numb;\n    int count = 0;\n\n    for(i=0;i&lt;DIM;i++)\n    {\n        printf(\"Intoduza o %d\u00ba elemento\\n\",i);\n        if( 1 == scanf(\"%d\",&amp;numb) )\n        {\n            ++count;\n            x[i]= numb;\n        }\n    }\n    return( count );\n}\n\n\nint maximo(int x[DIM]){\n    int i,max;\n    max =x[0];\n\n    for(i=0;i&lt;DIM;i++){\n        if (max&gt;x[i])\n            max = x[i];\n    }\n    return max;\n}\n\nint minimo(int x[DIM]){\n    int i,min;\n    min =x[0];\n\n    for(i=0;i&lt;DIM;i++){\n        if(min&lt;x[i])\n             min=x[i];\n    }\n\n    return min;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5606354, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e563d84294c75e61c23928dd2455e0ce?s=128&d=identicon&r=PG&f=1", "display_name": "W.W", "link": "https://stackoverflow.com/users/5606354/w-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "closed_date": 1452122801, "accepted_answer_id": 33928435, "answer_count": 1, "score": 1, "last_activity_date": 1448497911, "creation_date": 1448494627, "last_edit_date": 1448496030, "question_id": 33928299, "link": "https://stackoverflow.com/questions/33928299/finding-the-greatest-and-the-lowest-value-in-an-array-using-functions-in-c", "closed_reason": "Not suitable for this site", "title": "Finding the greatest and the lowest value in an array using functions in C", "body": "<p>I've written a program to find the greatest and the lowest number in an array of n numbers using functions.</p>\n\n<p>I don't know where I got it wrong, because the code can't be compiled.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#define DIM 5\n\nvoid lerArray(int x[DIM]);\nint maximo(int x[DIM]);\nint minimo(int x[DIM]);\n\n\nint main(){\n    int a[DIM],l,g;\n    lerArray(a);\n    maximo(a) = g;\n    minimo(a) = l;\n\n    printf(\"Minimo:%d \\t  Maximo:%d \",g,l);\n\n    return 0;\n}\n\n\nvoid lerArray (int x[DIM]){\n    int i,numb;\n\n    for(i=0;i&lt;DIM;i++)\n        printf(\"Intoduza o %d\u00ba elemento\\n\",i);\n            scanf(\"%d\",&amp;numb);\n            x[i]= numb;\n}\n\n\nint maximo(int x[DIM]){\n    int i,max;\n    max =x[0];\n\n    for(i=0;i&lt;DIM;i++){\n        if (max&gt;x[i])\n            max = x[i];\n    }\n    return max;\n}\n\nint minimo(int x[DIM]){\n    int i,min;\n    min =x[0];\n\n    for(i=0;i&lt;DIM;i++){\n        if(min&lt;x[i])\n             min=x[i];\n    }\n\n    return min;\n}\n</code></pre>\n\n<p>The error I get is in line 13 <code>maximo(a) = g;</code> \u2014 the compiler outputs \"<code>lvalue required as left operand of assignment</code>\"</p>\n"}, {"tags": ["c", "string", "pointers", "input"], "comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448531591, "post_id": 33928227, "comment_id": 55630708, "body": "regarding this line in getline() <code>char* result = &quot;&quot;;</code>, this is setting the pointer to some readonly literal.  Suggest using <code>char* result = NULL;</code>  this line: <code>*result++ = c;</code> will result in undefined behaviour and lead to a seg fault event.  Suggest call <code>realloc()</code> with parameters <code>result</code> and the current number of characters in the line before trying to set the new character into the allocated memory pointed to by result.   Be sure to actually allocate one more character than is actually needed, so in the end can append a NUL char."}], "answers": [{"comments": [{"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "edited": false, "score": 0, "creation_date": 1448523720, "post_id": 33928257, "comment_id": 55626057, "body": "These articles seems very interesting, but i am still a begginer so i only understand half of these things and above all i can&#39;t link these informations to my issue. At least now i know the reason why my compiler let me doing &quot;wrong&quot; things with pointer and memory."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 3, "last_activity_date": 1448494371, "last_edit_date": 1592644375, "creation_date": 1448494371, "answer_id": 33928257, "question_id": 33928227, "link": "https://stackoverflow.com/questions/33928227/return-a-string-made-with-a-line-read-from-input/33928257#33928257", "title": "Return a string made with a line read from input", "body": "<p>Both functions have <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><em>undefined behaviour</em></a> since you are modifying string literals. It just <em>seems</em> to work in one case. Basically, <code>result</code> needs to point to memory that can be legally accessed, which is not the case in either of the snippets.</p>\n<p>On the same subject, you might find this useful: <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">What Every C Programmer Should Know About Undefined Behavior</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "edited": false, "score": 0, "creation_date": 1448524478, "post_id": 33928466, "comment_id": 55626379, "body": "I see. I must be really naive because i thought memory were automaticaly allocated  when you were incrementing a pointer... In my mind it was working like this: ` char* result = &quot;&quot;;   /* result[0] = &quot;&quot; <i>/   *result++ = c;    /</i> result[0] = c <i>/  *result++ = c   /</i> result[1] = c */ `"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448532090, "post_id": 33928466, "comment_id": 55631049, "body": "wrong and wrong.  First, the pointer <code>result</code> is on the stack, the place where is points is in readonly memory (whereever the linker placed the &quot;&quot; literal.  Second, the <code>++</code> is performed after the assignment is performed, (and then the pointer to the start of the string is lost.)  Suggest 1) malloc memory to point toward 2) use a counter so the assignment is <code>result[counter] = newchar; counter++;</code>  where <code>counter</code> was initialized to 0"}, {"owner": {"reputation": 688, "user_id": 1487159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hblnt.jpg?s=128&g=1", "display_name": "markshancock", "link": "https://stackoverflow.com/users/1487159/markshancock"}, "edited": false, "score": 0, "creation_date": 1448569823, "post_id": 33928466, "comment_id": 55651923, "body": "Good point on the post increment but, it will still have the same effect the next time around the loop.  Regarding the stack being readonly memory, that is compiler/processor dependent.  I have definitely seen people accidentally change literals and write into the stack."}], "tags": [], "owner": {"reputation": 688, "user_id": 1487159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hblnt.jpg?s=128&g=1", "display_name": "markshancock", "link": "https://stackoverflow.com/users/1487159/markshancock"}, "is_accepted": false, "score": 1, "last_activity_date": 1448495644, "creation_date": 1448495644, "answer_id": 33928466, "question_id": 33928227, "link": "https://stackoverflow.com/questions/33928227/return-a-string-made-with-a-line-read-from-input/33928466#33928466", "title": "Return a string made with a line read from input", "body": "<p>Think of it this way. \nWhen you say</p>\n\n<pre><code>char* result = \"\";\n</code></pre>\n\n<p>you are setting up a pointer 'result' to point to a 1-byte null terminated string (just the null).  Since it is a local variable it will be allocated on the stack.</p>\n\n<p>Then when you say</p>\n\n<pre><code>*result++ = c;\n</code></pre>\n\n<p>you are storing that value 'c' in to that address + 1.<br>\nSo, where are you putting it?<br>\nWell, most stacks are to-down; so they grow toward lower addresses; so, you are probably writing over what is already on the stack (the return address for whatever called this, all the registers it needs restore and all sorts of important stuff).</p>\n\n<p>That is why you have to be very careful with pointers.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448497926, "post_id": 33928645, "comment_id": 55618439, "body": "Last <code>getlien()</code> has weaknesses.  <code>if( ++pos &gt;= size ) return buffer;</code> --&gt; <code>buffer</code> not null character terminated.  2 ) corner case <code>*result++</code> is a problem if <code>size == 0</code>.  3) <code>size_t pos=0</code>   Still a nice answer."}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448498597, "post_id": 33928645, "comment_id": 55618598, "body": "Agreed, I ignored size==0 (to keep the example/presentation simple); fixed the size_t pos=0 (used int since OP used int). Thanks!"}, {"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "edited": false, "score": 0, "creation_date": 1448525089, "post_id": 33928645, "comment_id": 55626677, "body": "Thanks, i diddn&#39;t knew about malloc(). Does the line ` char* result = malloc(size<i>sizeof(char</i>)); ` ask for result to be stored in memory with the size of 100 char ? If yes, why 100 instead of just 1? Is it because it would be more costly to realloc(result, size+=1) at every new char added?"}, {"owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "edited": false, "score": 0, "creation_date": 1448570961, "post_id": 33928645, "comment_id": 55652394, "body": "@ChuckCottrill By the way in the dynamic version i think you wrote result = &#39;\\0&#39; instead of *result = &#39;\\0&#39; ."}], "tags": [], "owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "is_accepted": true, "score": 3, "last_activity_date": 1448903131, "last_edit_date": 1448903131, "creation_date": 1448496882, "answer_id": 33928645, "question_id": 33928227, "link": "https://stackoverflow.com/questions/33928227/return-a-string-made-with-a-line-read-from-input/33928645#33928645", "title": "Return a string made with a line read from input", "body": "<p>Your function does not allocate enough space for the string being read. The variable char* result = \"\" defines a char pointer to a string literal (\"\", empty string), and you store some arbitrary number of characters into the location pointed to by result.</p>\n\n<pre><code>char* getLine(void)\n{\n    char* result = \"\"; //you need space to store input\n    int i, c;\n\n    i = 1;\n    while((c = getchar()) != EOF)\n    {\n        *result++ = c; //you should check space\n        i++;\n\n        if(c == '\\n')\n            return result - i; //you should null-terminate\n    }\n    return result - i; //you should null-terminate\n}\n</code></pre>\n\n<p>You need to allocate space for your string, which is challenging because you don't know how much space you are going to need a priori.  So you need to decide whether to limit how much you read (ala fgets), or dynamically reallocate space as you read more. Also, how to you indicate that you have finished input (reached EOF)?</p>\n\n<p>The following alternative assumes dynamic reallocation is your chosen strategy.</p>\n\n<pre><code>char* getLine(void)\n{\n    int ch; int size=100; size_t pos=0;\n    char* result = malloc(size*sizeof(char*));\n    while( (ch=getchar()) != EOF )\n    {\n        *result++ = ch;\n        if( ++pos &gt;= size ) {\n            realloc(result,size+=100);\n            //or,realloc(result,size*=2);\n            if(!result) exit(1); //realloc failed\n        }\n        if( c=='\\n' ) break;\n    }\n    *result = '\\0'; //null-terminate\n    return result - pos;\n}\n</code></pre>\n\n<p><em>When you are done with the string returned from the above function, please remember to free() the allocated space.</em></p>\n\n<p>This alternative assumes you provide a buffer to store the string (and specifies the size of the buffer).</p>\n\n<pre><code>char* getLine(char* buffer, size_t size)\n{\n    int ch;\n    char* result = buffer;\n    size_t pos=0;\n    while( (ch=getchar()) != EOF )\n    {\n        *result++ = ch;\n        if( ++pos &gt;= size ) break; //full\n        if( c=='\\n' ) break;\n    }\n    *result = '\\0'; //null-terminate\n    return buffer;\n}\n</code></pre>\n\n<p>Both avoid the subtle interaction between detecting EOF, and having enough space to store a character read. The solution is to buffer a character if you read and there is not enough room, and then inject that on a subsequent read. You will also need to null-ter</p>\n"}, {"tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1448498378, "last_edit_date": 1448498378, "creation_date": 1448497960, "answer_id": 33928796, "question_id": 33928227, "link": "https://stackoverflow.com/questions/33928227/return-a-string-made-with-a-line-read-from-input/33928796#33928796", "title": "Return a string made with a line read from input", "body": "<p>When you expect to return a string from a function, you have two options (1) provide a string to the function with adequate space to hold the string (including the null-terminating character), or (2) dynamically allocate memory for the string within the function and return a pointer. Within your function you must also have a way to insure your are not writing beyond the end of the space available <em>and</em> you are leaving room for the null-terminating character. That requires passing a maximum size if you are providing the array to the function, and keeping count of the characters read.</p>\n\n<p>Putting that together, you could do something similar to:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#define MAXC 256\n\nchar* getLine (char *s, int max)\n{\n    int i = 0, c = 0;\n    char *p = s;\n\n    while (i + 1 &lt; max &amp;&amp; (c = getchar()) != '\\n' &amp;&amp; c != EOF) {\n        *p++ = c;\n        i++;\n    }\n    *p = 0;\n    return s;\n}\n\nint main (void) {\n\n    char buf[MAXC] = {0};\n\n    printf (\"\\ninput : \");\n    getLine (buf, MAXC);\n\n    printf (\"output: %s\\n\\n\", buf);\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>Example/Output</strong></p>\n\n<pre><code>$ ./bin/getLine\n\ninput : A quick brown fox jumps over the lazy dog.\noutput: A quick brown fox jumps over the lazy dog.\n</code></pre>\n"}], "owner": {"reputation": 893, "user_id": 5016201, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/axdqP.jpg?s=128&g=1", "display_name": "aurelienC", "link": "https://stackoverflow.com/users/5016201/aurelienc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 33928645, "answer_count": 4, "score": 1, "last_activity_date": 1448903131, "creation_date": 1448494193, "question_id": 33928227, "link": "https://stackoverflow.com/questions/33928227/return-a-string-made-with-a-line-read-from-input", "title": "Return a string made with a line read from input", "body": "<p>i am trying to code a C <strong>function which returns a line read from the input as a char*</strong> . I am on Windows and i test my program in the command line by giving files as input and output of my program like this:</p>\n\n<pre><code>cl program.c\nprogram &lt; test_in.txt &gt; test_out.txt\n</code></pre>\n\n<p>This is my (not working) function:</p>\n\n<pre><code>char* getLine(void)\n{\n    char* result = \"\";\n    int i, c;\n\n    i = 1;\n    while((c = getchar()) != EOF)\n    {\n         *result++ = c;\n         i++;\n\n         if(c == '\\n')\n            return result - i;\n    }\n\n    return result - i;\n}\n</code></pre>\n\n<p>I was expecting it to work because i previously wrote:</p>\n\n<pre><code>char* getString(char* string)\n{\n\n    //char* result = string; // the following code achieve this.\n    char* result = \"\";\n    int i;\n\n    for(i = 1; *result++ = *string++; i++);\n\n    return result - i;\n}\n</code></pre>\n\n<p>And these lines of code have a correct behaviour.<br><br>\nEven if every answers will be appreciated, i would be really thankfull \n<strong>if any of you could explain me why my getString() function works while my getLine() function doesn't</strong>.</p>\n"}, {"tags": ["c", "arrays", "compare"], "answers": [{"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1448493950, "creation_date": 1448493950, "answer_id": 33928182, "question_id": 33928161, "link": "https://stackoverflow.com/questions/33928161/how-does-this-read-a-zero-when-comparing-two-arrays/33928182#33928182", "title": "How does this read a &#39;zero&#39; when comparing two arrays?", "body": "<p>The third argument to <code>memcmp</code> is the number of bytes, not the number of elements.</p>\n\n<p>You meant:</p>\n\n<pre><code>memcmp(num4, num2, 4 * sizeof num4[0]);\n</code></pre>\n\n<p>Your existing code only compares the first four bytes. If your system has 4-byte ints (which is common) then you only compared the first int.</p>\n\n<p>I used <code>sizeof num4[0]</code> instead of <code>sizeof(int)</code> so that the code still works even if you later change <code>num4</code> and <code>num2</code> to be a different type of array.</p>\n"}], "owner": {"reputation": 193, "user_id": 5595149, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/01284f1a2f1ef96da03074bf299b2c58?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Sultana", "link": "https://stackoverflow.com/users/5595149/simon-sultana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 33928182, "answer_count": 1, "score": 0, "last_activity_date": 1448493968, "creation_date": 1448493856, "last_edit_date": 1448493968, "question_id": 33928161, "link": "https://stackoverflow.com/questions/33928161/how-does-this-read-a-zero-when-comparing-two-arrays", "title": "How does this read a &#39;zero&#39; when comparing two arrays?", "body": "<pre><code>int num4[10] = {3,4,8,9};\nint num2[10] = {3,8,6,8};\n\ncompare2 = memcmp(num4, num2, 4);\n</code></pre>\n\n<p>Why is the value of compare2 zero even though the arrays are not equal?</p>\n"}, {"tags": ["c", "shell", "pipe"], "comments": [{"owner": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448494180, "post_id": 33928141, "comment_id": 55617432, "body": "well, your example doesn&#39;t look like a <a href=\"http://stackoverflow.com/help/mcve\">MCVE</a>"}, {"owner": {"reputation": 87, "user_id": 4413894, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8e8f78405f1e7ae537c97634ca58e2c8?s=128&d=identicon&r=PG&f=1", "display_name": "thomas_p", "link": "https://stackoverflow.com/users/4413894/thomas-p"}, "reply_to_user": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448494506, "post_id": 33928141, "comment_id": 55617552, "body": "I know but I put the whole code in case someone would like to compile it and execute it on his computer. As I pointed above, the custom functions I use are tested and work properly. The fault is probably somewhere  bellow the point I ve put a comment in the code."}, {"owner": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448494506, "post_id": 33928141, "comment_id": 55617553, "body": "the whole idea behind a pipe between two child processes is that you create a <a href=\"http://linux.die.net/man/3/pipe\" rel=\"nofollow noreferrer\">pipe</a> in the parent process (the shell), then after the first fork, close one of the ends of the pipe, and <a href=\"http://linux.die.net/man/2/dup\" rel=\"nofollow noreferrer\">dup</a> the other end to either <code>stdout</code> (fd=2) for the first program in the pipe or <code>stdin</code> (fd=1) for the second program in the pipe and then perform exec the correcesponding pprogram."}, {"owner": {"reputation": 87, "user_id": 4413894, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8e8f78405f1e7ae537c97634ca58e2c8?s=128&d=identicon&r=PG&f=1", "display_name": "thomas_p", "link": "https://stackoverflow.com/users/4413894/thomas-p"}, "reply_to_user": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448494959, "post_id": 33928141, "comment_id": 55617686, "body": "I &#39;ve followd the idea you suggest but still this is not working properly. Actually I ve achieved pipe communication between parent and child processes but between child-child processes with the same parent, following the same logic, it doesn&#39;t seem to work."}, {"owner": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448495581, "post_id": 33928141, "comment_id": 55617855, "body": "<a href=\"http://stackoverflow.com/questions/8082932/connecting-n-commands-with-pipes-in-a-shell\" title=\"connecting n commands with pipes in a shell\">stackoverflow.com/questions/8082932/&hellip;</a> Also I&#39;ve made a mistake. stdin fd==0, stdout==1, stderr==2"}, {"owner": {"reputation": 87, "user_id": 4413894, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8e8f78405f1e7ae537c97634ca58e2c8?s=128&d=identicon&r=PG&f=1", "display_name": "thomas_p", "link": "https://stackoverflow.com/users/4413894/thomas-p"}, "reply_to_user": {"reputation": 14855, "user_id": 3159253, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/046000bcd9bbb664fc01891f558baa0d?s=128&d=identicon&r=PG&f=1", "display_name": "user3159253", "link": "https://stackoverflow.com/users/3159253/user3159253"}, "edited": false, "score": 0, "creation_date": 1448496671, "post_id": 33928141, "comment_id": 55618143, "body": "Well I just tried some things on the code and find the solution to the problem.  All I had to do was to close the file descriptos ( fd[0],fd[1] ) after the second fork() in the parent process.  Somehow, open file descriptors in the parent process caused one of the child process not to exit properly and so there was the fault.  It&#39;s all clear and making sense now.  Thanks for your help pal :)"}], "owner": {"reputation": 87, "user_id": 4413894, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8e8f78405f1e7ae537c97634ca58e2c8?s=128&d=identicon&r=PG&f=1", "display_name": "thomas_p", "link": "https://stackoverflow.com/users/4413894/thomas-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448493710, "creation_date": 1448493710, "question_id": 33928141, "link": "https://stackoverflow.com/questions/33928141/shell-with-pipe-communication-between-2-child-processes-with-the-same-parent-pro", "title": "SHELL with PIPE communication BETWEEN 2 child processes with the same parent process", "body": "<p>I want to create a UNIX based <code>shell</code> that supports commands with 1 pipe.\nFor example, the command <code>ls | wc</code></p>\n\n<p>I have wrote the following code but when I try an input like the one above, the program actes weird and can't figure out where the fault is. </p>\n\n<p>To be more specific, it appears to <code>fork()</code> properly, then <code>exec()</code> with the proper parameters but only the command before the pipe (ls) exits properly. The command after the pipe (wc) never exits actually and as a result there is no output from the program.</p>\n\n<p>I 've put some <code>printf</code> to help me figure out where is the fault in the code.\nFunctions <code>fetch_input</code> and <code>string_tokenizer</code> are tested and work fine.</p>\n\n<p>The fault must be somewhere below the point pointed in the code.\nAny suggestion to help me find what is the fault would be appreciated.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;unistd.h&gt;\n\n#define ANSI_COLOR_GREEN \"\\x1b[32m\"\n#define ANSI_COLOR_CYAN \"\\x1b[36m\"\n#define ANSI_COLOR_RESET \"\\x1b[0m\"\n\nchar * fetch_input(char * buffer);\nchar * trim(char * string);\nchar ** string_tokenizer(char * string, char c);\n\nint main(int arc, char * argv[]){\n\nchar *input, *init_input, **commands, **com1, **com2;\npid_t fork_pid_1, fork_pid_2, ret_pid;\nint stat,i, fd[2];\n\ninit_input = (char *)malloc(sizeof(char)*256);\n\ninput = init_input;\ninput = fetch_input(input);\n\nwhile(strcmp(input,\"exit\")!=0){\n\n    commands = string_tokenizer(input,'|');\n    com1 = string_tokenizer(commands[0],' ');\n\n    if(commands[1]==0){\n        fork_pid_1 = fork();\n        if(fork_pid_1&lt;0){\n            printf(\"Fork Error!\\n\");\n            _exit(1);\n        }\n        else if(fork_pid_1==0){\n            execvp(com1[0],com1);\n            printf(\"Exec Error!\\n\");\n            _exit(1);\n        }\n        else{\n            ret_pid=wait(&amp;stat);\n\n        }\n    }\n    else{                 //the fault is probably somewhere below that point\n        if(pipe(fd)&lt;0){ _exit(1);}\n\n        fork_pid_1 = fork();\n\n        if(fork_pid_1&lt;0){\n            printf(\"Fork Error!\\n\");\n            _exit(1);\n        }\n        else if(fork_pid_1==0){\n\n            printf(\"First command, ready to exec...(pid:%d)\\n\",getpid());       \n\n            close(fd[0]);\n            dup2(fd[1],1);\n            close(fd[1]);\n\n            execvp(com1[0],com1);\n            printf(\"Exec Error!\\n\");\n            _exit(1);\n\n        }\n        else{\n            com2 = string_tokenizer(commands[1],' ');\n\n            fork_pid_2=fork();\n            if(fork_pid_2&lt;0){\n                printf(\"Fork Error!\\n\");\n                _exit(1);\n            }\n            else if(fork_pid_2==0){\n\n                printf(\"Second command, ready to exec...(pid:%d)\\n\",getpid());\n\n                close(fd[1]);\n                dup2(fd[0],0);\n                close(fd[0]);\n\n                execvp(com2[0],com2);\n                printf(\"Exec Error!\\n\");\n                _exit(1);\n\n\n            }\n            else{   \n                printf(\"Now we 're in the parent process...(p_pid:%d)\\n\",getpid());\n                while( (ret_pid=waitpid(-1,&amp;stat,0)) &gt;0 ){\n                    printf(\"Child process (%d) exited with status:%d\\n\",ret_pid,stat);\n                }\n\n            }\n\n        }\n\n\n    }\n    input = init_input;\n    input = fetch_input(input);\n}\n\nreturn 0;\n}\n\nchar * fetch_input(char * buffer){\n\nint i, sum;\n\ndo{\n    printf(ANSI_COLOR_CYAN \"$\" ANSI_COLOR_RESET);\n    fflush(stdin);\n    fgets(buffer,256,stdin);\n    if(buffer[strlen(buffer)-1]=='\\n'){\n        buffer[strlen(buffer)-1]='\\0';\n    }\n    sum=0;\n    for(i=0;i&lt;strlen(buffer);i++){\n        if(buffer[i]==' '){sum++;}\n    }\n}while(strlen(buffer)==sum);\n\nbuffer = trim(buffer);\n\nreturn buffer;\n\n}\n\nchar * trim(char * string){\n\n    int i;\n\n    i=strlen(string);\n    while(string[i-1]==' '){\n        i--;\n    }\n    *(string+i)='\\0';\n    while(isspace(*string)){string++;}\n\n    return string;\n}\n\nchar ** string_tokenizer(char * string, char c){\n\n     int j=0,k,i,done,found,first,last;\n     char ** ret, *str;\n\n     str=string;\n     if( (str==0) || (strlen(str)==0) ) return NULL;\n     ret = (char **)malloc(sizeof(char*));\n     do{\n        done=0;\n        found=0;\n        i=0;\n        first=-1;\n        last=-1;\n\n        while( (str[i]!='\\0') &amp;&amp; (done==0) ){\n\n               if( (str[i]==c) &amp;&amp; (found==0) ){\n                    i++;\n               }\n               else if( (str[i]!=c) &amp;&amp; (found==0) ){\n                    found=1;\n                    first=i;\n                    i++;\n               }\n               else if( (str[i]!=c) &amp;&amp; (found!=0) ){\n                    i++;\n               }\n               else if( (str[i]==c) &amp;&amp; (found!=0) ){\n                    done=1;\n                    last=i;\n               }\n\n         }\n\n\n         if(done!=0){\n\n\n             *(ret+j) = (char *)malloc(sizeof(char)*(last-first+1));\n\n             for(k=first;k&lt;last;k++){\n                 *(*(ret+j)+(k-first)) = str[k];\n             }\n             *(*(ret+j)+(k-first)) = '\\0';\n             *(ret+j) = trim(*(ret+j));\n             j++;\n             str=str+last;\n         }\n\n\n     }while(done!=0);\n\n     if( (done==0) &amp;&amp; (found==0) ){\n         *(ret+j)=NULL;\n     }\n     else if( (done==0) &amp;&amp; (found!=0) ){\n          *(ret+j) = (char *)malloc(sizeof(char)*(i-first+1));\n          for(k=first;k&lt;i;k++){\n              *(*(ret+j)+(k-first)) = str[k];\n          }\n          *(*(ret+j)+(k-first)) = '\\0';\n      *(ret+j)=trim(*(ret+j));\n          *(ret+j+1) = NULL;\n     }\n\n     return ret;\n}\n</code></pre>\n"}, {"tags": ["c", "numerical-integration"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1448493453, "post_id": 33928064, "comment_id": 55617202, "body": "Thanks for adding a proper question! But unless your code is supposed to create an image, please <a href=\"https://stackoverflow.com/posts/33928064/edit\">edit</a> your post and add your current output as text."}, {"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1448494459, "post_id": 33928064, "comment_id": 55617529, "body": "Consistent formatting of your code helps make it easier to follow as well. I just ran it through Linux <code>indent</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448494589, "post_id": 33928064, "comment_id": 55617581, "body": "Note: numerically more stable to do <code>for (i = 1, x = a + dx; i &lt; n; i++, )     sum += f(x*(i-1));</code> in <code>trapezoidal_int()</code>.  Yet this should not explain &quot;way too less than expected&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448495378, "post_id": 33928064, "comment_id": 55617802, "body": "Note: <a href=\"https://en.wikipedia.org/wiki/Trapezoidal_rule\" rel=\"nofollow noreferrer\">Trapezoidal rule</a> is not that great near the vertical part of ellipses.  Please quantify &quot;way too less than expected&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448496561, "post_id": 33928064, "comment_id": 55618123, "body": "Code is only integrating from the center of the tank to the edge.  Thus answers are about 1/4 what they should be."}, {"owner": {"reputation": 3971, "user_id": 2840714, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/s9vli.jpg?s=128&g=1", "display_name": "ChuckCottrill", "link": "https://stackoverflow.com/users/2840714/chuckcottrill"}, "edited": false, "score": 0, "creation_date": 1448498814, "post_id": 33928064, "comment_id": 55618647, "body": "You state that the tank has an ellipse cross section, and you have a depth gauge. From your code it appears that you assume the tank is lying on the side, rather than vertical."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5606287"}, "edited": false, "score": 0, "creation_date": 1448509995, "post_id": 33928914, "comment_id": 55621291, "body": "Also, can you tell me how can I incorporate different values of Width, Height and Length into the code? e.g. the code should run for any values of width, height and length."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1157391"}, "is_accepted": true, "score": 1, "last_activity_date": 1486271531, "last_edit_date": 1486271531, "creation_date": 1448498870, "answer_id": 33928914, "question_id": 33928064, "link": "https://stackoverflow.com/questions/33928064/calibrating-in-c-program/33928914#33928914", "title": "Calibrating in C program", "body": "<p>There are a few mistakes here and there. First, let's use global variables for the dimensions of the tank so that function f() can use them:</p>\n\n<pre><code>double WIDTH;\ndouble HEIGHT;\ndouble LENGTH;\n</code></pre>\n\n<p>You function f() had the height and width reversed:</p>\n\n<pre><code>double f (double x)\n{\n    double a = HEIGHT / 2.0;\n    double b = WIDTH / 2.0;\n    double y = (b / a) * sqrt (a * a - x * x);\n\n    return y;\n}\n</code></pre>\n\n<p>The doubling of the value of the integral, which is necessary to measure both sides of the major axis, should be done in main() and not in trapezoidal_int(). It is bad practice to have a function that does not do what it's name suggests.</p>\n\n<p>The bounds of integration were also wrong:</p>\n\n<pre><code>int main ()\n{\n    int h_cm;\n\n    WIDTH = 8.0;                                                \n    HEIGHT = 4.0;                                      \n    LENGTH = 7.0;\n\n    for (h_cm = 0; h_cm &lt;= HEIGHT * 100; h_cm += 10) {\n        double h = h_cm / 100.0;\n        double area = 2.0 * trapezoidal_int (&amp;f, HEIGHT / 2 - h,\n                                             HEIGHT / 2, 100);\n        double volume = area * LENGTH;\n\n        printf (\"Depth %d cm:  Volume %.6lf cubic metres\\n\",\n                h_cm, volume);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5606287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 0, "accepted_answer_id": 33928914, "answer_count": 1, "score": 0, "last_activity_date": 1486271531, "creation_date": 1448493236, "last_edit_date": 1448571548, "question_id": 33928064, "link": "https://stackoverflow.com/questions/33928064/calibrating-in-c-program", "title": "Calibrating in C program", "body": "<p><strong>Problem</strong>: To measure the volume of liquid in the tank, a depth gauge (measuring stick) can be used. It is inserted into an opening at the top and the level of liquid on the gauge can be used to determine the amount of liquid in the tank.</p>\n\n<p>The tank has width w, height h and length len (in m). In the example output shown below, we take w=8, h=4 and len=7. Your programs should work for any values of w, h and len, not just these specific values.</p>\n\n<p>We look at inserting a measuring stick that is already calibrated in units of 10 centimeters. This measuring gauge can be inserted into an opening at the top of the tank and used to measure the depth of the liquid in the tank.</p>\n\n<p>Your task will be to write a C program to produce a table of values showing the volume of liquid in the tank for each of the points on the gauge.</p>\n\n<p>The output of your program (for the example above) should look like:</p>\n\n<p>Depth 10 cm : Volume 1.188814 cubic meters</p>\n\n<p>Depth 20 cm : Volume 3.336448 cubic meters</p>\n\n<p>Depth 30 cm : Volume 5.992683 cubic meters\n. . .</p>\n\n<p>Depth 380 cm : Volume 172.547399 cubic meters</p>\n\n<p>Depth 390 cm : Volume 174.657114 cubic meters</p>\n\n<p>Depth 400 cm : Volume 175.743037 cubic meters</p>\n\n<p><strong>Methodology:</strong>\nIf the tank has width W and height H (in centimeters), the focal radii of the cross section are A = W/2 and B = H/2. Then the equation of the ellipse is:\nX^2/A^2 + Y^2/B^2 = 1</p>\n\n<p>To find the volume at given depth you should compute the cross-sectional area of the tank for each given depth using a numerical integration\nalgorithm such as the trapezoidal method.</p>\n\n<pre><code> #include &lt;stdio.h&gt;\n #include &lt;math.h&gt;\n #include &lt;stdlib.h&gt;\n double WIDTH;\n double HEIGHT;\n double LENGTH;\n\n //Function: y in terms of x\n typedef double (*DFD) (double);\n double f (double x)\n {\n double a = HEIGHT / 2.0;\n double b = WIDTH / 2.0;\n double y = (b / a) * sqrt (a * a - x * x);\n\nreturn y;\n}\n\n//Integrating the function -&gt; Area\ndouble trapezoidal_int (DFD f ,double a, double b, int n){\n\n double x, dx, sum=0.0;\n int i=0;\n dx = (b-a)/ n;\n sum = (f(a) + f(b))/2;\n for (i=1, x = a + dx; i &lt; n; i++, x += dx)\n  sum += f(x);\n return 2.0 * sum * dx;\n }\n\nint main ()\n{\nint h_cm;\nprintf (\"Enter Width of the tank (in m):\\n\");\nscanf (\"%lf\",&amp;WIDTH);\n\nprintf (\"Enter Height of the tank (in m):\\n\");\nscanf (\"%lf\",&amp;HEIGHT);\n\nprintf (\"Enter Length of the tank(in m):\\n\");\nscanf (\"%lf\",&amp;LENGTH);\n\nfor (h_cm = 0; h_cm &lt;= HEIGHT * 100; h_cm += 10) {\n    double h = h_cm / 100.0;\n    double area = trapezoidal_int (&amp;f, HEIGHT / 2 - h, HEIGHT / 2, 100);\n    double volume = area * LENGTH;\n\n    printf (\"Depth %d cm:  Volume %.6lf cubic metres\\n\",\n            h_cm, volume);\n}\n\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "algorithm", "for-loop"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1448492229, "post_id": 33927743, "comment_id": 55616714, "body": "<i>&quot;when I try to submit it it says wrong output&quot;</i> so is this an automated challenge? If so, perhaps the output format is not <b>exactly</b> what the question asks for."}, {"owner": {"reputation": 2556, "user_id": 3488231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da4ac79b71c44d696f3567d4b53f6239?s=128&d=identicon&r=PG&f=1", "display_name": "user12205", "link": "https://stackoverflow.com/users/3488231/user12205"}, "edited": false, "score": 0, "creation_date": 1448493832, "post_id": 33927743, "comment_id": 55617312, "body": "I&#39;ve edited the question based on the assumption that you mean a <a href=\"https://en.wikipedia.org/wiki/Stem-and-leaf_display\" rel=\"nofollow noreferrer\">stem-and-leaf</a> diagram rather than a histogram. Feel free to edit it back if this is not what you mean."}], "answers": [{"tags": [], "owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1448517663, "creation_date": 1448517663, "answer_id": 33931580, "question_id": 33927743, "link": "https://stackoverflow.com/questions/33927743/creating-a-stem-and-leaf-diagram/33931580#33931580", "title": "Creating a stem-and-leaf diagram", "body": "<p>Your code is a bit epic. More to the point:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint cmp(const void *av, const void *bv) { return *(int*)av - *(int*)bv; }\n\nint main(void) {\n  unsigned n[1000000], i = 0, x;\n  while (scanf(\"%d\", &amp;x) == 1) if (x &lt; 100) n[i++] = x;\n  if (i == 0) return 0;\n  qsort(n, i, sizeof n[0], cmp);\n  unsigned k = 0;\n  while (k &lt; i) {\n    unsigned d = n[k] / 10;\n    printf(\"%d|\", d);\n    while (k &lt; i &amp;&amp; n[k] / 10 == d) printf(\"%d\", n[k++] % 10);\n    printf(\"\\n\");\n  }\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5606206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6a379271a36203ca971fba0b640fe6?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Kotvas", "link": "https://stackoverflow.com/users/5606206/adam-kotvas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1448517663, "creation_date": 1448491529, "last_edit_date": 1448493778, "question_id": 33927743, "link": "https://stackoverflow.com/questions/33927743/creating-a-stem-and-leaf-diagram", "title": "Creating a stem-and-leaf diagram", "body": "<p>I am trying to make a program in C (for school purposes) that reads numbers from interval [0, 99] and makes a stem-and-leaf diagram out of them with tens on the beginning of a row and followed by all the units.</p>\n\n<p>Here is example of input: </p>\n\n<blockquote>\n  <p>1 2 5 2 25 27 93 4 93 93 58 51</p>\n</blockquote>\n\n<p>and output should be: </p>\n\n<p>0 | 12245<br>\n2 | 57<br>\n5 | 18<br>\n9 | 333</p>\n\n<p>and here's my code:</p>\n\n<pre><code>// uloha-9-5.c -- Tyzden 9 - Uloha 5\n// Adam Kotvas, 18.11.2015 10:02:12\n\n#include &lt;stdio.h&gt;\n\nint main()\n{\n  int n[100],i=0,j=0,l=0,desiatky[10],temp=0,k=0;\n  while(scanf(\"%d\",&amp;n[i])&gt;0)\n  {\n    if(n[i]&gt;99 || n[i]&lt;0){\n      continue;\n    }\n    i++;\n  }\n\n  for(j=0;j&lt;=10;j++)\n  {\n    desiatky[j]=0;\n  }\n  for(j=0;j&lt;i;j++)\n  {\n    desiatky[(n[j]/10)%10]=1;\n  }\n  for(k=0;k&lt;i;k++)\n  {\n  for(j=0;j&lt;i;j++)\n  {\n    if(n[j]&gt;n[j+1] &amp;&amp; j!=i-1)\n    {\n      temp=n[j];\n      n[j]=n[j+1];\n      n[j+1]=temp;\n    }\n  }\n  }\n  for(j=0;j&lt;10;j++)\n  {\n    if(desiatky[j]==1)\n    {\n        printf(\"%d | \",j);\n        for(l=0;l&lt;i;l++)\n        {\n          if((n[l]/10)%10==j)\n          printf(\"%d\",n[l]%10);\n        }\n        printf(\"\\n\");\n    }\n  }\n  return 0;\n}\n</code></pre>\n\n<p>The problem is that it works good for all numbers in the given interval but when I try to submit it it says wrong output :(. Do you have any idea on what could be possibly wrong with this program?</p>\n"}, {"tags": ["c", "string", "malloc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 4, "creation_date": 1448491213, "post_id": 33927659, "comment_id": 55616302, "body": "It&#39;s not uncommon for API documentation to mention that the caller is responsible for <code>free</code>ing the return value."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448491270, "post_id": 33927659, "comment_id": 55616325, "body": "I have no idea what that means man. Pretty new here, this is my first semester of CS113. Love it so far though!"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448491470, "post_id": 33927659, "comment_id": 55616402, "body": "<code>int num_zeros = ((cpu-&gt;word_size) - strlen(string));</code> contains a signed-unsigned error"}, {"owner": {"reputation": 2137, "user_id": 1212725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/152c2f757fe98760a1cca54a21f63a31?s=128&d=identicon&r=PG", "display_name": "bruceg", "link": "https://stackoverflow.com/users/1212725/bruceg"}, "edited": false, "score": 4, "creation_date": 1448491518, "post_id": 33927659, "comment_id": 55616417, "body": "Whoever calls zeropad must free the returned buffer when they&#39;re done with it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1448491564, "post_id": 33927659, "comment_id": 55616440, "body": "You&#39;ll have to free it after. The catch is that you don&#39;t have to change anything about <code>zero_pad</code> itself. Just mention in the documentation of your code that, whenever someone calls <code>zero_pad</code>, they&#39;ll have to make sure that they make the call to <code>free</code>."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448491619, "post_id": 33927659, "comment_id": 55616462, "body": "I just called zero_pad from main. So, I can free it from main? I&#39;ll try that next. :D"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1448491662, "post_id": 33927659, "comment_id": 55616484, "body": "&quot;If I try to free it after, the function has already returned and thus can&#39;t go on to freeing it&quot;. That&#39;s not the case. The function is returning a pointer to the buffer. So the caller of the function can free it. <code>malloc</code> and <code>free</code> do not have to be done in the same function."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448491671, "post_id": 33927659, "comment_id": 55616491, "body": "EDIT: This is for a project in class. One of the requirments is that everything is freed at the end and there are no memory leaks. I&#39;ll update OP so it&#39;s clear"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1448491706, "post_id": 33927659, "comment_id": 55616499, "body": "<code>strncat</code> is used incorrect here: the first argument must be a null-terminated string. Better would be <code>strcpy(zero_string + i, string); return zero_string;</code>"}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448491876, "post_id": 33927659, "comment_id": 55616575, "body": "SWEET! Got it working! I just needed to free the variables that were made from zero_pad in main. I set a variable called e1 and e2 to something regarding zero_pad&#39;s output. Once I freed those two, it freed the rest as well. So it&#39;s all working! No memory leaks detected by Valgrind."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1448491952, "post_id": 33927659, "comment_id": 55616607, "body": "@TylerShellberg Yes, you can. If you <code>malloc</code> something, you don&#39;t have to necessarily <code>free</code> it in the <i>same</i> function. Any memory object you <code>malloc</code> is owned by a process (not just by a function in the process), and can be <code>free</code>d by that process. The only reason why there&#39;s this rule about &quot;you shall <code>free</code> what you <code>malloc</code>&quot; is to conserve precious resources."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448492430, "post_id": 33927659, "comment_id": 55616791, "body": "There are several ways to return a pointer to a string from a function -- and all of them are annoying. You can have the function allocate space  using <code>malloc</code>, which makes the caller responsible for calling <code>free()</code>. Or you can return a pointer to a <code>static</code> character array -- which means that later calls will clobber the string returned by previous calls, and it places a fixed upper bound on the size of the string. Or the caller can allocate space for the string and pass in a pointer to it -- which makes the caller responsible for allocating the memory (and knowing how much is needed)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448493501, "post_id": 33927659, "comment_id": 55617214, "body": "@KeithThompson Doesn&#39;t the use of a static character array after the call completed cause UB?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448493732, "post_id": 33927659, "comment_id": 55617289, "body": "@Rhymoid: No. The point of <code>static</code> (when used inside a function) is that it gives the object <i>static storage duration</i>, which means that the object&#39;s lifetime is the entire execution of the program. It also means that there&#39;s only one copy of the array, rather than one copy per call."}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448532566, "post_id": 33927659, "comment_id": 55631345, "body": "@KeithThompson I was thinking of something else. Thanks for the explanation, it makes sense now."}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 1360500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ae700736b49a41611fc833a0f7ae487?s=128&d=identicon&r=PG", "display_name": "didou", "link": "https://stackoverflow.com/users/1360500/didou"}, "is_accepted": false, "score": 0, "last_activity_date": 1448662692, "creation_date": 1448662692, "answer_id": 33965444, "question_id": 33927659, "link": "https://stackoverflow.com/questions/33927659/cant-free-a-mallocd-string/33965444#33965444", "title": "Can&#39;t free a Malloc&#39;d string", "body": "<p>What is <code>cpu-&gt;word_size</code> ? Are you sure that <code>cpu-&gt;word_size &gt;= strlen(string)</code> in any case ? </p>\n\n<p>Anyway, the returned buffer is mallocated so it is the caller's responsibility to free it. Another possibility is to use a static variable if you know the maximum size needed. This is the code.</p>\n\n<pre><code>#define MAX_SIZE 128 /* adjust this */\nchar *zero_pad(struct cpu_t *cpu, char *string)\n{\n    static char zero_string[MAX_SIZE]; \n    int num_zeros = ((cpu-&gt;word_size) - strlen(string));\n    int i;\n\n    for(i = 0; i &lt; num_zeros; i++)\n    {\n        zero_string[i] = '0';\n    }\n\n    strcpy(zero_string + i, string); \n    return zero_string;   \n}\n</code></pre>\n\n<p>Obviously, the caller should be informed that the returned buffer is always the same (the caller has to duplicate the returned buffer if needed, e.g. using <code>strdup()</code> and later <code>free()</code>).</p>\n"}], "owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 225, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448662692, "creation_date": 1448491116, "last_edit_date": 1448491955, "question_id": 33927659, "link": "https://stackoverflow.com/questions/33927659/cant-free-a-mallocd-string", "title": "Can&#39;t free a Malloc&#39;d string", "body": "<p>This one should be quick, I think. </p>\n\n<p>EDIT: This is for my CS113 class. I just needed to free all the memory. If Valgrind found any memory leaks, I'd lose points. :P</p>\n\n<p>Regardless, I figured out that it apparently just required me to free stuff in Main that related to the return value of zero_pad. Once I did so, it worked fine. I'd mark this post as \"complete\" if I knew how.</p>\n\n<pre><code>char *zero_pad(struct cpu_t *cpu, char *string)\n{\n    char *zero_string = malloc(cpu-&gt;word_size + 1); \n    int num_zeros = ((cpu-&gt;word_size) - strlen(string));\n    int i;\n\n    for(i = 0; i &lt; num_zeros; i++)\n    {\n        zero_string[i] = '0';\n    }\n\n    return strncat(zero_string, string, strlen(string));    \n}\n</code></pre>\n\n<p>I need to free zero_string, since I allocated it. However, I have no idea how. \nIf I free it before I return, then I've lost that data and can't return it. If I try to free it after, the function has already returned and thus can't go on to freeing it. </p>\n\n<p>I tried to use strcpy to copy the string in zero_string into a new string, but I must have been doing it wrong, because I just ended up with a massive mess. </p>\n\n<p>So, what do you all think? </p>\n"}, {"tags": ["c", "warnings", "quicksort"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1448490883, "post_id": 33927544, "comment_id": 55616175, "body": "change <code>char *strings[]</code> to <code>const char *strings[]</code>. String literals have the type <code>const char *</code>."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1448491081, "post_id": 33927544, "comment_id": 55616254, "body": "Just to be clear. These are warnings not errors (the <code>-Werror</code> compiler flag can turn these into actual compile errors but it does not appear to be the case here) . &quot;Compilation finished successfully.&quot; - so it looks like your compile completed successfully."}, {"owner": {"reputation": 301, "user_id": 3977598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55f14b32ba8925acd7c88aed8bdfb07a?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyDewd", "link": "https://stackoverflow.com/users/3977598/geekydewd"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1448492232, "post_id": 33927544, "comment_id": 55616716, "body": "@mch I get errors after doing that."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448492644, "post_id": 33927544, "comment_id": 55616878, "body": "Note: <code>return *ia  - *ib;</code> risks <code>int</code> overflow, which is undefined behavior.  Suggest <code>return (*ia  &gt; *ib) - (*ia  &lt; *ib);</code>"}], "answers": [{"tags": [], "owner": {"reputation": 10401, "user_id": 681044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OWZ3c.jpg?s=128&g=1", "display_name": "kwarunek", "link": "https://stackoverflow.com/users/681044/kwarunek"}, "is_accepted": true, "score": 1, "last_activity_date": 1448491046, "creation_date": 1448491046, "answer_id": 33927644, "question_id": 33927544, "link": "https://stackoverflow.com/questions/33927544/quicksort-example-will-not-compile/33927644#33927644", "title": "QuickSort example will not compile", "body": "<p>change in lines:</p>\n\n<ul>\n<li>68: initializer: const char *strings[]</li>\n<li>55: argument: const char **array</li>\n</ul>\n\n<p>or compile with <code>-Wno-write-strings</code></p>\n"}], "owner": {"reputation": 301, "user_id": 3977598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55f14b32ba8925acd7c88aed8bdfb07a?s=128&d=identicon&r=PG&f=1", "display_name": "GeekyDewd", "link": "https://stackoverflow.com/users/3977598/geekydewd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 33927644, "answer_count": 1, "score": 1, "last_activity_date": 1448492152, "creation_date": 1448490557, "last_edit_date": 1448492152, "question_id": 33927544, "link": "https://stackoverflow.com/questions/33927544/quicksort-example-will-not-compile", "title": "QuickSort example will not compile", "body": "<p>I found this example but when I get compilation warnings. If somebody could help me with this i'd appreciate it very much.</p>\n\n<pre><code>#include &lt;stdio.h&gt; \n#include &lt;stdlib.h&gt; \n#include &lt;string.h&gt; \n\n/* qsort int comparison function */ \nint int_cmp(const void *a, const void *b) \n{ \n    const int *ia = (const int *)a; // casting pointer types \n    const int *ib = (const int *)b;\n    return *ia  - *ib; \n    /* integer comparison: returns negative if b &gt; a \n    and positive if a &gt; b */ \n} \n\n/* integer array printing function */ \nvoid print_int_array(const int *array, size_t len) \n{ \n    size_t i;\n\n    for(i=0; i&lt;len; i++) \n        printf(\"%d | \", array[i]);\n\n    putchar('\\n');\n} \n\n/* sorting integers using qsort() example */ \nvoid sort_integers_example() \n{ \n    int numbers[] = { 7, 3, 4, 1, -1, 23, 12, 43, 2, -4, 5 }; \n    size_t numbers_len = sizeof(numbers)/sizeof(int);\n\n    puts(\"*** Integer sorting...\");\n\n    /* print original integer array */ \n    print_int_array(numbers, numbers_len);\n\n    /* sort array using qsort functions */ \n    qsort(numbers, numbers_len, sizeof(int), int_cmp);\n\n    /* print sorted integer array */ \n    print_int_array(numbers, numbers_len);\n} \n\n/* qsort C-string comparison function */ \nint cstring_cmp(const void *a, const void *b) \n{ \n    const char **ia = (const char **)a;\n    const char **ib = (const char **)b;\n    return strcmp(*ia, *ib);\n    /* strcmp functions works exactly as expected from\n    comparison function */ \n} \n\n/* C-string array printing function */ \nvoid print_cstring_array(char **array, size_t len) \n{ \n    size_t i;\n\n    for(i=0; i&lt;len; i++) \n        printf(\"%s | \", array[i]);\n\n    putchar('\\n');\n} \n\n/* sorting C-strings array using qsort() example */ \nvoid sort_cstrings_example() \n{ \n    char *strings[] = { \"Zorro\", \"Alex\", \"Celine\", \"Bill\", \"Forest\", \"Dexter\" };\n    size_t strings_len = sizeof(strings) / sizeof(char *);\n\n    /** STRING */ \n    puts(\"*** String sorting...\");\n\n    /* print original string array */ \n    print_cstring_array(strings, strings_len);\n\n    /* sort array using qsort functions */ \n    qsort(strings, strings_len, sizeof(char *), cstring_cmp);\n\n    /* print sorted string array */ \n    print_cstring_array(strings, strings_len);\n} \n\n\n\n/* an example of struct */ \nstruct st_ex { \n    char product[16];\n    float price;\n};\n\n/* qsort struct comparision function (price float field) */ \nint struct_cmp_by_price(const void *a, const void *b) \n{ \n    struct st_ex *ia = (struct st_ex *)a;\n    struct st_ex *ib = (struct st_ex *)b;\n    return (int)(100.f*ia-&gt;price - 100.f*ib-&gt;price);\n    /* float comparison: returns negative if b &gt; a \n    and positive if a &gt; b. We multiplied result by 100.0\n    to preserve decimal fraction */ \n\n} \n\n/* qsort struct comparision function (product C-string field) */ \nint struct_cmp_by_product(const void *a, const void *b) \n{ \n    struct st_ex *ia = (struct st_ex *)a;\n    struct st_ex *ib = (struct st_ex *)b;\n    return strcmp(ia-&gt;product, ib-&gt;product);\n    /* strcmp functions works exactly as expected from\n    comparison function */ \n} \n\n/* Example struct array printing function */ \nvoid print_struct_array(struct st_ex *array, size_t len) \n{ \n    size_t i;\n\n    for(i=0; i&lt;len; i++) \n        printf(\"[ product: %s \\t price: $%.2f ]\\n\", array[i].product, array[i].price);\n\n    puts(\"--\");\n} \n\n/* sorting structs using qsort() example */ \nvoid sort_structs_example(void) \n{ \n    struct st_ex structs[] = {{\"mp3 player\", 299.0f}, {\"plasma tv\", 2200.0f}, \n                              {\"notebook\", 1300.0f}, {\"smartphone\", 499.99f}, \n                              {\"dvd player\", 150.0f}, {\"matches\", 0.2f }};\n\n    size_t structs_len = sizeof(structs) / sizeof(struct st_ex);\n\n    puts(\"*** Struct sorting (price)...\");\n\n    /* print original struct array */ \n    print_struct_array(structs, structs_len);\n\n    /* sort array using qsort functions */ \n    qsort(structs, structs_len, sizeof(struct st_ex), struct_cmp_by_price);\n\n    /* print sorted struct array */ \n    print_struct_array(structs, structs_len);\n\n    puts(\"*** Struct sorting (product)...\");\n\n    /* resort using other comparision function */ \n    qsort(structs, structs_len, sizeof(struct st_ex), struct_cmp_by_product);    \n\n    /* print sorted struct array */ \n    print_struct_array(structs, structs_len);\n} \n\n\n/* MAIN program (calls all other examples) */ \nint main() \n{ \n    /* run all example functions */ \n    sort_integers_example();\n    sort_cstrings_example();\n    sort_structs_example();\n    return 0;\n} \n\n/*\nExecution result:\n\n\n*** Integer sorting...\n7 | 3 | 4 | 1 | -1 | 23 | 12 | 43 | 2 | -4 | 5 | \n-4 | -1 | 1 | 2 | 3 | 4 | 5 | 7 | 12 | 23 | 43 | \n*** String sorting...\nZorro | Alex | Celine | Bill | Forest | Dexter | \nAlex | Bill | Celine | Dexter | Forest | Zorro | \n*** Struct sorting (price)...\n[ product: mp3 player    price: $299.00 ]\n[ product: plasma tv     price: $2200.00 ]\n[ product: notebook      price: $1300.00 ]\n[ product: smartphone    price: $499.99 ]\n[ product: dvd player    price: $150.00 ]\n[ product: matches       price: $0.20 ]\n--\n[ product: matches       price: $0.20 ]\n[ product: dvd player    price: $150.00 ]\n[ product: mp3 player    price: $299.00 ]\n[ product: smartphone    price: $499.99 ]\n[ product: notebook      price: $1300.00 ]\n[ product: plasma tv     price: $2200.00 ]\n--\n*** Struct sorting (product)...\n[ product: dvd player    price: $150.00 ]\n[ product: matches       price: $0.20 ]\n[ product: mp3 player    price: $299.00 ]\n[ product: notebook      price: $1300.00 ]\n[ product: plasma tv     price: $2200.00 ]\n[ product: smartphone    price: $499.99 ]\n--\n*/\n</code></pre>\n\n<p>My errors are as follows:</p>\n\n<pre><code>g++ -Wall -o \"Qiksortfromnet\" \"Qiksortfromnet.cpp\" (in directory: /home/dylan)\nQiksortfromnet.cpp: In function \u2018void sort_cstrings_example()\u2019:\nQiksortfromnet.cpp:68:79: warning: deprecated conversion from string constant to \u2018char*\u2019 [-Wwrite-strings]\n     char *strings[] = { \"Zorro\", \"Alex\", \"Celine\", \"Bill\", \"Forest\", \"Dexter\" };\n                                                                               ^\n\n Qiksortfromnet.cpp:68:79: warning: deprecated conversion from string\n constant to \u2018char*\u2019 [-Wwrite-strings] Qiksortfromnet.cpp:68:79:\n warning: deprecated conversion from string constant to \u2018char*\u2019\n [-Wwrite-strings] Qiksortfromnet.cpp:68:79: warning: deprecated\n conversion from string constant to \u2018char*\u2019 [-Wwrite-strings]\n Qiksortfromnet.cpp:68:79: warning: deprecated conversion from string\n constant to \u2018char*\u2019 [-Wwrite-strings] Qiksortfromnet.cpp:68:79:\n warning: deprecated conversion from string constant to \u2018char*\u2019\n [-Wwrite-strings] Compilation finished successfully.\n</code></pre>\n\n<p>Last edit from a previous user removed half of my errors/warnings... please do not do that !!!</p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448490710, "post_id": 33927488, "comment_id": 55616111, "body": "Since <code>array</code> is an array of pointers to characters, not <code>PostalCode</code>, why are you multiplying <code>sizeof(PostalCode) * size</code> when you try to allocate it?"}], "answers": [{"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 3, "last_activity_date": 1448491553, "last_edit_date": 1448491553, "creation_date": 1448490548, "answer_id": 33927542, "question_id": 33927488, "link": "https://stackoverflow.com/questions/33927488/postal-code-using-structures/33927542#33927542", "title": "Postal code using structures", "body": "<p>The structure already contains an array of 5 pointers as its data member</p>\n\n<pre><code>typedef struct PostalCode\n{\n    int size;\n    char *array[5];\n    ^^^^^^^^^^^^^^\n} \n</code></pre>\n\n<p>So you need not to allocate it.</p>\n\n<p>If you want to use this array to store for example 5 object of type <code>PostalCode</code>\n(though in this case it would be better if the array has type <code>PostalCode *array[5]</code>) then you can write</p>\n\n<pre><code>for ( int i = 0; i &lt; 5; i++ )\n{ \n    h-&gt;array[i] = malloc( sizeof( PostalCode ) );\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": false, "score": 0, "last_activity_date": 1448490838, "creation_date": 1448490838, "answer_id": 33927601, "question_id": 33927488, "link": "https://stackoverflow.com/questions/33927488/postal-code-using-structures/33927601#33927601", "title": "Postal code using structures", "body": "<p>You don't need to allocate <code>array</code>, it's an array, not a pointer. But you do need to allocate memory for each element.</p>\n\n<pre><code>for (int i = 0; i &lt; 5; i++) {\n    h-&gt;array[i] = malloc(size);\n}\n</code></pre>\n"}], "owner": {"reputation": 2728, "user_id": 5237611, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ef9dbabde19ea7759116c85eea13340a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/5237611/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 33927542, "answer_count": 2, "score": 2, "last_activity_date": 1448527464, "creation_date": 1448490291, "last_edit_date": 1448527464, "question_id": 33927488, "link": "https://stackoverflow.com/questions/33927488/postal-code-using-structures", "title": "Postal code using structures", "body": "<p>I'm trying to make a a structure that stores postal codes but I receive this error: \"c:15:11: error: assignment to expression with array type\n  h->array = malloc(sizeof(PostalCode)*size);\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\ntypedef struct PostalCode\n{\n    int size;\n    char *array[5];\n} PostalCode;\n\nvoid main()\n{\n    int size = 5;\n    PostalCode *h = malloc(sizeof(PostalCode));\n    h-&gt;size = size;\n    h-&gt;array = malloc(sizeof(PostalCode)*size);\n}\n</code></pre>\n"}, {"tags": ["c", "struct", "hashtable", "free", "destroy"], "comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1448490269, "post_id": 33927377, "comment_id": 55615930, "body": "Unless you show where your allocations are taking place, then all we can do is guess how to free the memory. Are we to <i>assume</i> both <code>key</code> and <code>value</code> are allocated for each node, or is <code>value</code> simply a pointer?"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1448490457, "post_id": 33927377, "comment_id": 55616007, "body": "<code>p</code> is a pointer to <code>SymTable_T</code>, which itself is a typedef of <code>struct SymTable *</code>, so you need to dereference it twice and it does not have members like <code>next</code> or <code>key</code>. Are you sure that this is your exact code?"}, {"owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1448490700, "post_id": 33927377, "comment_id": 55616106, "body": "@DavidC.Rankin yes, assume key and value are both allocated already."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1448495367, "post_id": 33927377, "comment_id": 55617798, "body": "It&#39;s extremely confusing having <code>SymTable_T</code> be a pointer type, but <code>Node_T</code> is not.  I strongly recommend not using pointer typedefs; instead make <code>Symtable_T</code> the struct type and write <code>SymTable_T *</code> when you want a pointer."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448495490, "post_id": 33927377, "comment_id": 55617827, "body": "You should probably post your creation code too, it&#39;s hard to say what should be freed when we can&#39;t see what you allocated.  The question could be answered by saying that you must call <code>free</code> once for each time you called <code>malloc</code> (and with the same address)"}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448657764, "post_id": 33928555, "comment_id": 55686722, "body": "I have added my <code>create</code> function which holds memory allocation info. I tried implementing your code but I am getting several warnings and errors."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "reply_to_user": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448678288, "post_id": 33928555, "comment_id": 55691767, "body": "OK, you have shown where you allocate the pointers <code>S_Table-&gt;Table = (Node_T **) calloc(DEFAULT_TABLE_SIZE, sizeof(Node_T *));</code> (which should be simply <code>S_Table-&gt;Table = calloc(DEFAULT_TABLE_SIZE, sizeof(Node_T *));</code> ), but you have not shown where you allocate memory for each node. Good job on using <code>calloc</code> to insure the pointers are allocated <code>NULL</code>, that is an assumption I made in my answer. Can you post your entire code? I can certainly do more with a minimum complete verifiable example I can compile. See: <a href=\"http://stackoverflow.com/help/mcve\"><b>How to create a MCVE</b></a>"}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": false, "score": 0, "last_activity_date": 1448496214, "creation_date": 1448496214, "answer_id": 33928555, "question_id": 33927377, "link": "https://stackoverflow.com/questions/33927377/c-destroy-function-w-2-structures/33928555#33928555", "title": "C - Destroy function w/ 2 structures", "body": "<p>It is difficult to determine exactly the memory layout you are trying to free without also seeing how the memory was allocated. Based on your comments you are allocating memory for an array of <code>symTable</code> (element initialized <code>NULL</code>), a number of pointers to <code>struct Node</code> (<code>Table</code>) which are initialized <code>NULL</code> and from which the list of nodes are allocated with separate allocations for <code>key</code> and <code>value</code>. You are holding the <em>starting address</em> to the list of nodes in <code>Table</code>.</p>\n\n<p>Assuming that <code>symTable</code> is an allocated <em>array</em> of <code>struct SymTable</code>, and that memory is allocated for each node of type <code>struct Node</code> in the pointer to pointer to type <code>Node_t</code> (<code>struct Node</code>) named <code>Table</code> for each element in <code>symTable</code>, and that both <code>key</code> and <code>value</code> are allocated, you could try freeing the memory associate with each list <code>Table</code> in each element of <code>symTable</code> with something like:</p>\n\n<pre><code>void symTable_destroy (SymTable_T *symTable)\n{\n    for (i = 0; i &lt; DEFAULT_TABLE_SIZE &amp;&amp; symTable[i]; i++)\n    {\n        struct Node *p = *(symTable[i]-&gt;Table); /* pointer to node  */\n        while (p != NULL)               /* for each allocated node  */\n        {\n            struct Node *victim = p;    /* pointer node to delete   */\n            free (victim-&gt;key);         /* free key for node        */\n            free (victim-&gt;value);       /* free value for node      */\n            p = p-&gt;nextp;               /* set p to next node       */\n            free (victim);              /* free node memory         */\n        }\n        free (symTable[i]-&gt;Table);      /* free Table memory        */\n    }\n    free (symTable);     /* free allocated array of struct SymTable */\n}\n</code></pre>\n\n<p>Above the pointer <code>victim</code> points to the current node to be deleted allowing <code>p</code> to hold the address of <code>nextp</code> and remain valid after the current node is deleted. Give this a go and let me know if you have problems. If you have any issues, edit your question and post the full code showing the allocations and I am happy to work with your further.</p>\n"}], "owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2895, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1448657690, "creation_date": 1448489806, "last_edit_date": 1448657690, "question_id": 33927377, "link": "https://stackoverflow.com/questions/33927377/c-destroy-function-w-2-structures", "title": "C - Destroy function w/ 2 structures", "body": "<p>I'm working on a destroy function for my program but I'm having trouble implementing it because my structures are mixing me up. I have two structures: 1 for the <code>&lt;key, value&gt;</code> pairs and another for the array, table size, and counter. Here is what I have:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;assert.h&gt;\n#include \"symTable.h\"\n#define DEFAULT_TABLE_SIZE 61\n#define HASH_MULTIPLIER 65599\n\ntypedef struct Node\n{\n    char *key;\n    int *value;\n    struct Node *next;\n} Node_T;\n\ntypedef struct SymTable\n{\n    Node_T **Table;\n    int tablesize;\n    int counter;\n} *SymTable_T;\n\nSymTable_T SymTable_create(void)\n{\n    SymTable_T S_Table;\n\n    S_Table = malloc(sizeof(SymTable_T *) * DEFAULT_TABLE_SIZE);\n    S_Table-&gt;Table = (Node_T **) calloc(DEFAULT_TABLE_SIZE, sizeof(Node_T *));\n\n    return S_Table;\n}\n\nvoid symTable_destroy(SymTable_T symTable)\n{\n    SymTable_T *p, *nextp;\n    int i;\n\n    assert(symTable != NULL);\n\n    for (i = 0; i &lt; DEFAULT_TABLE_SIZE; i++)\n    {\n        for (p = symTable[i]; p != NULL; p = nextp)\n        {\n            nextp = p-&gt;next;\n            assert(p-&gt;key != NULL);\n            free(p-&gt;key);\n            free(p);\n        }\n    }\n    free(symTable);\n    return;\n}\n</code></pre>\n\n<p>but this doesn't work for many reasons. Can someone explain how I can go about freeing everything in both structures? The syntax has me very confused. Do I need to (should I) free counter? Should I do one structure at a time or should I be freeing the Node when I am at each index in the array? Thanks guys.</p>\n"}, {"tags": ["c", "arrays", "struct", "file-handling", "structured-array"], "comments": [{"owner": {"reputation": 7, "user_id": 5595606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab208002390d95425a1c06de95cfbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Elizabeth Ekefre", "link": "https://stackoverflow.com/users/5595606/elizabeth-ekefre"}, "edited": false, "score": 0, "creation_date": 1448488921, "post_id": 33927154, "comment_id": 55615349, "body": "This isn&#39;t the full code sorry, the name in the first fopen is for the administrator of the program. Irrelevant to the question though but just in case anyone was wondering"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "edited": false, "score": 1, "creation_date": 1448489081, "post_id": 33927154, "comment_id": 55615412, "body": "The error you are getting is caused by the fact that <code>student[50]</code> is an array of structs. So doing this <code>student.name</code> cant work, you need to define which student in the list you want ie. <code>student[0].name</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1448489122, "post_id": 33927154, "comment_id": 55615441, "body": "<code>goto exam;</code> is that a joke? More seriously, the way you attempt to use <code>fprintf</code> to write all the records to a text file is quite wrong."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5595606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab208002390d95425a1c06de95cfbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Elizabeth Ekefre", "link": "https://stackoverflow.com/users/5595606/elizabeth-ekefre"}, "edited": false, "score": 0, "creation_date": 1448605610, "post_id": 33927245, "comment_id": 55661045, "body": "Thank you so much that solved the problem :] Would you by any chance know hot to read a particular string from the text file? Like i input up to fifty student names how would I pick one name to check if it exists or not?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 7, "user_id": 5595606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab208002390d95425a1c06de95cfbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Elizabeth Ekefre", "link": "https://stackoverflow.com/users/5595606/elizabeth-ekefre"}, "edited": false, "score": 0, "creation_date": 1448991707, "post_id": 33927245, "comment_id": 55808646, "body": "@ElizabethEkefre This is a different question that has been answered many times. Do some research, have a go, and if you run into problems ask another question here at SO."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 1, "last_activity_date": 1448489602, "last_edit_date": 1448489602, "creation_date": 1448489328, "answer_id": 33927245, "question_id": 33927154, "link": "https://stackoverflow.com/questions/33927154/getting-looped-struct-data-into-a-file-in-c/33927245#33927245", "title": "Getting looped struct data into a file in C", "body": "<p>This</p>\n\n<pre><code>fprintf(admin, \"Name: %s \\nRoll Number: %s\\n\\n\", student.name, student.rollno);\n</code></pre>\n\n<p>cannot work, <code>student</code> is an array of <code>stud</code>'s (or at least it would be if i were in the school). You have already shown that you know how to iterate over the number of students with <code>for(x=0; x&lt;stud; x++)</code>, so just do it again:</p>\n\n<pre><code>for(x=0; x&lt;stud; x++) {\n    fprintf(admin, \"Name: %s \\nRoll Number: %s\\n\\n\", student[x].name, student[x].rollno);\n}\n</code></pre>\n\n<p>There are likely going to be other errors in your program (Like that <code>goto exam</code> immediately jumping out of your for loop to somewhere). But this will at least deal with the error you have described.</p>\n"}], "owner": {"reputation": 7, "user_id": 5595606, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab208002390d95425a1c06de95cfbd2?s=128&d=identicon&r=PG&f=1", "display_name": "Elizabeth Ekefre", "link": "https://stackoverflow.com/users/5595606/elizabeth-ekefre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 33927245, "answer_count": 1, "score": 0, "last_activity_date": 1448489602, "creation_date": 1448488821, "question_id": 33927154, "link": "https://stackoverflow.com/questions/33927154/getting-looped-struct-data-into-a-file-in-c", "title": "Getting looped struct data into a file in C", "body": "<p>I have a looped struct array that accepts student name and roll number for as many students the user inputs</p>\n\n<p>Code:</p>\n\n<pre><code>int x;\nstruct studs\n{\n    char name[50];\n    char rollno[50];\n}student[50];\n\n            printf(\"\\t\\t________________________________\");\n            printf(\"\\n\\n\\t\\t\\tStudent Registration\");\n            printf(\"\\n\\t\\t_______________________________\");\n            printf(\"\\n\\n\\tHow many students in %s \", course);\n            scanf(\"%d\", &amp;stud);\n\n            admin = fopen(name, \"a\");\n            fprintf(admin, \"\\nNumber of students for %s: %d\", course, stud);\n            fclose(admin);\n\n            for(x=0; x&lt;stud; x++)\n            {\n                printf(\"\\n\\nStudent %d\", x+1);\n                printf(\"\\n_____________________________\");\n                printf(\"\\n\\nStudent Name : \");\n                scanf(\"%s\", student[x].name);\n                printf(\"\\nStudent Rollno. : \");\n                scanf(\"%s\", student[x].rollno);\n                system(\"\\npause\");\n                goto exam;\n            }\n            admin = fopen(\"student.txt\", \"w\");\n            fprintf(admin, \"Name: %s \\nRoll Number: %s\\n\\n\", student.name, student.rollno);\n            fclose(admin);\n</code></pre>\n\n<p>As you can see i'm trying to put each name and number into the text file but I keep getting this errors</p>\n\n<p>error: request for member 'name' in something not a structure or union |\nerror: request for member 'rollno' in something not a structure or union</p>\n\n<p>Is there anyway to get this into a file, with or without the struct?</p>\n"}, {"tags": ["c", "shell"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1448487734, "post_id": 33926804, "comment_id": 55614754, "body": "Note that the C Shell (<a href=\"https://stackoverflow.com/questions/tagged/csh\">csh</a>) is quite different from a shell written in C (or, perhaps more accurately, it is a specific example of a shell written in C with a long heritage, having been written in the late 1970s)."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1448488603, "post_id": 33926889, "comment_id": 55615182, "body": "Always place code after <code>execvp()</code> to detect and report failure to execute the command.  In a shell with a loop, if you don&#39;t take care about that, you can easily end up with multiple processes all trying to read from the terminal at once, which leads to chaos and confusion."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1448490035, "post_id": 33926889, "comment_id": 55615825, "body": "<b>And</b> be careful about what code that will be executed after a call to one of the <code>exec*()</code> functions fails after a call to <code>fork()</code> - among other things the <code>fork()</code> will duplicate all open file descriptors and streams <b>along with any data in buffers waiting to be written</b>."}], "tags": [], "owner": {"reputation": 2223, "user_id": 1027857, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eafd8f11220851675483c051a132c570?s=128&d=identicon&r=PG", "display_name": "toth", "link": "https://stackoverflow.com/users/1027857/toth"}, "is_accepted": true, "score": 1, "last_activity_date": 1448487696, "creation_date": 1448487696, "answer_id": 33926889, "question_id": 33926804, "link": "https://stackoverflow.com/questions/33926804/ls-grep-in-shell-written-in-c/33926889#33926889", "title": "ls | grep in shell written in C", "body": "<p>Remove the quotes in the argument to grep. i.e., use</p>\n\n<pre><code>char *grep[] = {\"grep\", \".c\", NULL};\n</code></pre>\n\n<p>If you are calling <code>execvp</code>, the usual shell expansion of arguments (i.e., globbing, removal of quotes, etc) does not happen, so effectively what you are doing is the same as</p>\n\n<pre><code>ls | grep '\".c\"'\n</code></pre>\n\n<p>In a normal shell.</p>\n\n<p>Also be aware that nothing that comes after the call to <code>execvp</code> will execute, <code>execvp</code> <strong>replaces</strong> the current process, it will never return.</p>\n"}, {"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1448494135, "post_id": 33927044, "comment_id": 55617411, "body": "@WumpusQ.Wumbley: Oh, of course \u2014 doubling is sufficient; it ensures that <code>grep</code> sees the backslash (this isn&#39;t a <code>system()</code> call where there&#39;s a shell to confuse things, and I don&#39;t want <code>grep</code> looking for an actual backslash).  Thanks!"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 0, "last_activity_date": 1448488842, "last_edit_date": 1448488842, "creation_date": 1448488372, "answer_id": 33927044, "question_id": 33926804, "link": "https://stackoverflow.com/questions/33926804/ls-grep-in-shell-written-in-c/33927044#33927044", "title": "ls | grep in shell written in C", "body": "<p>You have multiple problems:</p>\n\n<ol>\n<li><p>One problem is that you have far too few calls to <code>close()</code>.  When you use <code>dup2()</code> to replicate a file descriptor from a pipe to standard input or standard output, you should close <em>both</em> file descriptors returned by <code>pipe()</code>.</p></li>\n<li><p>A second problem is that the shell removes double quotes around arguments but you've added them around your.  You are looking for files whose name contains <code>\".c\"</code> (where the double quotes are part of the file name being searched for).  Use:</p>\n\n<pre><code>char *grep[] = { \"grep\", \"\\\\.c$\", NULL };\n</code></pre>\n\n<p>This looks for a dot and a <code>c</code> at the end of the line.</p></li>\n<li><p>You should report failures after <code>execvp()</code>.  If any of the <code>exec*()</code> functions returns, it failed.  It can happen when the user mistypes a command name, for example.  It is crucial that you report the error and that the child process then exits.  If you don't do that, you can end up in a normal iterative shell (rather than this one-shot, non-iterative, non-interactive shell) with multiple shell processes all trying to read from the terminal at the same time, which leads to chaos and confusion.</p></li>\n</ol>\n"}], "owner": {"reputation": 302, "user_id": 3784518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8niqD.jpg?s=128&g=1", "display_name": "photeesh", "link": "https://stackoverflow.com/users/3784518/photeesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2228, "favorite_count": 0, "accepted_answer_id": 33926889, "answer_count": 2, "score": 0, "last_activity_date": 1448488842, "creation_date": 1448487308, "last_edit_date": 1448487808, "question_id": 33926804, "link": "https://stackoverflow.com/questions/33926804/ls-grep-in-shell-written-in-c", "title": "ls | grep in shell written in C", "body": "<p>I am trying to make my own shell in C.  It uses one pipe and the input (for now) is static. I execute commands using execvp.\nEverything is fine except when I run the command <code>ls |grep \".c\"</code> I get no results. Can anyone show me where is the problem and find a solution.</p>\n\n<p>The shell so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n\nint   p[2];\nint pid;\nint r;\n\nmain()\n{\n    char *ls[] = {\"ls\", NULL};\n    char *grep[] = {\"grep\", \"\\\".c\\\"\", NULL};\n\n    pipe(p);\n\n    pid = fork();\n    if (pid  != 0) {\n            // Parent: Output is to child via pipe[1]\n\n            // Change stdout to pipe[1]\n            dup2(p[1], 1);\n            close(p[0]);\n\n            r = execvp(\"ls\", ls);\n    } else {\n            // Child: Input is from pipe[0] and output is via stdout.\n            dup2(p[0], 0);\n            close(p[1]);\n\n            r = execvp(\"grep\", grep);\n            close(p[0]);\n    }\n\n    return r;\n}\n</code></pre>\n"}, {"tags": ["c", "loops", "feof"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1448488269, "post_id": 33926590, "comment_id": 55615015, "body": "What, specifically, is the misbehavior you observe?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1448488358, "post_id": 33926590, "comment_id": 55615058, "body": "But do note that your use of <code>feof()</code> is incorrect; see <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448488428, "post_id": 33926590, "comment_id": 55615098, "body": "Can you clarify whether you are trying to read a single student,  or you are trying to read all the students from the file?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448488498, "post_id": 33926590, "comment_id": 55615127, "body": "...in any case it would be <code>while (!feof(test))</code> but as commented either way is wrong."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535180, "post_id": 33926590, "comment_id": 55633029, "body": "in general, never use <code>feof()</code> for loop control.  In this case use the returned value from the call to <code>fread()</code> to control the loop.  The man page for <code>fread()</code> has the details on the returned value"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535231, "post_id": 33926590, "comment_id": 55633067, "body": "when calling <code>fopen()</code>, always check (!=NULL) the returned value to assure the operation was successful"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535470, "post_id": 33926590, "comment_id": 55633238, "body": "this line: <code>Class[i] = st;</code> is only going to place a pointer to <code>st</code> in <code>Class[i]</code>.   Suggest using <code>memcpy( Class[i], st, sizeof(student) )&#39;</code>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535538, "post_id": 33926590, "comment_id": 55633296, "body": "always check the returned value from a call to <code>fread()</code> to assure the operation was successful.  (if use <code>fread()</code> in while statement, it is the returned value that will actually control the loop)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535623, "post_id": 33926590, "comment_id": 55633352, "body": "in the posted code, the variable <code>Class[]</code> is not defined.  can we assume it is an array of <code>student</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448535767, "post_id": 33927031, "comment_id": 55633447, "body": "The assignment of <code>Class[i]</code> from <code>st</code> will not work in c (it might in c++) but this is not c++"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1448488335, "last_edit_date": 1495540046, "creation_date": 1448488335, "answer_id": 33927031, "question_id": 33926590, "link": "https://stackoverflow.com/questions/33926590/my-loop-isnt-workingusing-feof/33927031#33927031", "title": "My loop isn&#39;t working(using feof)", "body": "<p>See <a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">why is while(feof) always wrong</a>.</p>\n\n<p>Instead, you should loop until you fail to read a student:</p>\n\n<pre><code>while (1 == fread(&amp;st, sizeof st, 1, test))\n{\n    Class[i++] = st;\n}\n</code></pre>\n\n<p>Also it would be good to make sure you don't overflow the buffer of <code>Class</code>, so put in a check for <code>i</code> too, e.g.:</p>\n\n<pre><code>for (i = 0; i &lt; MAX_CLASS &amp;&amp; 1 == fread(&amp;st, sizeof st, 1, test); ++i)\n{\n    Class[i] = st;\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5077840, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f8b95ea5e32c311de9340957c89391d?s=128&d=identicon&r=PG&f=1", "display_name": "Borislav Nikolaev", "link": "https://stackoverflow.com/users/5077840/borislav-nikolaev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 432, "favorite_count": 1, "accepted_answer_id": 33927031, "answer_count": 1, "score": 1, "last_activity_date": 1448488335, "creation_date": 1448486341, "last_edit_date": 1448488052, "question_id": 33926590, "link": "https://stackoverflow.com/questions/33926590/my-loop-isnt-workingusing-feof", "title": "My loop isn&#39;t working(using feof)", "body": "<pre><code>FILE *test;\nstudent st;\nint i = 0;\ntest = fopen(\"example.bin\", \"rb\");\nwhile (feof(test))\n{\n    fread(&amp;st, sizeof(st),1,test);\n    Class[i] = st;\n\n    i++;\n}\nfclose(test);\n</code></pre>\n\n<p>So my question is how to read it, put the data in my structure and stop the loop?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1448486043, "post_id": 33926464, "comment_id": 55613910, "body": "See: <a href=\"https://en.wikipedia.org/wiki/Bitwise_operations_in_C\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Bitwise_operations_in_C</a>"}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 0, "creation_date": 1448487716, "post_id": 33926464, "comment_id": 55614737, "body": "This is a simple typo or concept error; we should remove the question."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448486644, "post_id": 33926502, "comment_id": 55614205, "body": "There is another very important difference with <code>&amp;&amp;</code>."}], "tags": [], "owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "is_accepted": false, "score": 1, "last_activity_date": 1448486000, "creation_date": 1448486000, "answer_id": 33926502, "question_id": 33926464, "link": "https://stackoverflow.com/questions/33926464/what-does-mean-c/33926502#33926502", "title": "what does &amp; mean? C", "body": "<p>\"&amp;\" is bitwise AND, which takes the corresponding bits of the 2 numbers, and ANDs them together. \"&amp;&amp;\" is the boolean AND operator that returns true/false depending on the value of the 2 conditions being compared.</p>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 1, "last_activity_date": 1448486065, "creation_date": 1448486065, "answer_id": 33926515, "question_id": 33926464, "link": "https://stackoverflow.com/questions/33926464/what-does-mean-c/33926515#33926515", "title": "what does &amp; mean? C", "body": "<p>A single &amp; is a bitwise and operator.. You can know more about it here:</p>\n\n<p><a href=\"http://www.tutorialspoint.com/cprogramming/c_bitwise_operators.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/cprogramming/c_bitwise_operators.htm</a></p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 4, "last_activity_date": 1448486925, "creation_date": 1448486925, "answer_id": 33926710, "question_id": 33926464, "link": "https://stackoverflow.com/questions/33926464/what-does-mean-c/33926710#33926710", "title": "what does &amp; mean? C", "body": "<p>Contrary to your question, the program prints</p>\n\n<pre><code>Everything we know is a lie!\n</code></pre>\n\n<p>The bitwise operation of <code>&amp;</code> is this</p>\n\n<pre><code>dec binary\n-8  111111111111111111111000\n 7  000000000000000000000111 \n    ------------------------\n &amp;  000000000000000000000000\n</code></pre>\n\n<p>However, the first statement </p>\n\n<pre><code>Math is good -8 and 7 are both not zero\n</code></pre>\n\n<p>would print if you used the logical operator <code>&amp;&amp;</code> because both <code>-8</code> and <code>7</code> are <code>true</code>.</p>\n"}], "owner": {"reputation": 403, "user_id": 5605732, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/da4ffb5adf6be4d68cd8aaaafeda9fee?s=128&d=identicon&r=PG&f=1", "display_name": "FlyingNades", "link": "https://stackoverflow.com/users/5605732/flyingnades"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "closed_date": 1448487291, "accepted_answer_id": 33926710, "answer_count": 3, "score": -9, "last_activity_date": 1514669959, "creation_date": 1448485843, "last_edit_date": 1514669959, "question_id": 33926464, "link": "https://stackoverflow.com/questions/33926464/what-does-mean-c", "closed_reason": "Duplicate", "title": "what does &amp; mean? C", "body": "<p>i have this code :</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n   int main(void)\n   {\n    if (-8 &amp; 7)\n   {\n       printf(\"Math is good -8 and 7 are both not zero\\n\");\n   }\n   else\n   {\n       printf(\"Everything we know is a lie!\\n\");\n   }\n    system(\"PAUSE\");\n    return (0);\n   }\n</code></pre>\n\n<p>I'm new to C and my trying to figure out what this &amp; operator does, can someone explain this to me?</p>\n"}, {"tags": ["c", "microblaze"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1448485086, "post_id": 33926250, "comment_id": 55613400, "body": "You already read the required bits. What do you mean? Masking? Read about bit operators."}, {"owner": {"reputation": 123, "user_id": 5605933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4efjT.jpg?s=128&g=1", "display_name": "ksaliya", "link": "https://stackoverflow.com/users/5605933/ksaliya"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448487162, "post_id": 33926250, "comment_id": 55614470, "body": "I feel so stupid now. That&#39;s exactly what I wanted. Thank you Olaf."}], "owner": {"reputation": 123, "user_id": 5605933, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4efjT.jpg?s=128&g=1", "display_name": "ksaliya", "link": "https://stackoverflow.com/users/5605933/ksaliya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448484957, "creation_date": 1448484957, "question_id": 33926250, "link": "https://stackoverflow.com/questions/33926250/how-to-read-a-portion-of-a-gpio-input-or-assign-the-gpio-input-to-a-bit-vector", "title": "How to read a portion of a GPIO input or assign the GPIO input to a bit vector?", "body": "<p>I'm trying to read the inputs from a GPIO through a microblaze implemented in a Basys3 FPGA board. My GPIO inputs are coming from the 16 dip switches in the Basys3 board. Currently I'm using the following line of code to read the GPIO input to a variable.</p>\n\n<p>DataRead = XGpio_DiscreteRead(&amp;GpioDevice, 2);</p>\n\n<p>where \"GpioDevice\" is the instance name and '2' is the channel number. This line reads the 16 switches and assigns the Hex value of the switches to the u32 variable 'DataRead'. </p>\n\n<p>Is there a way to read only a portion of the GPIO input (ex: if my switches are set to 1111 0000 1010 1100, is there a way to read only 4 bits from that)</p>\n\n<p>OR</p>\n\n<p>is there a way to read all 16bits and assign the value to a bit vector rather than to a u32. </p>\n\n<p>My goal is to use individual bits of the GPIO input to do some sort of a task.</p>\n\n<p>if bit 1 = 1 then do something</p>\n\n<p>if bit 2 = 0 then do something etc...</p>\n"}, {"tags": ["c", "macros", "initialization", "structure"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 3, "creation_date": 1448483904, "post_id": 33925983, "comment_id": 55612824, "body": "This is C. You cannot assign values in a structure definition."}, {"owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448484170, "post_id": 33925983, "comment_id": 55612986, "body": "@Olaf is there a way to initialize them globally?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448484268, "post_id": 33925983, "comment_id": 55613042, "body": "See @cad&#39;s answer. You cannot provide some &quot;default initialiser&quot;, however. If you need such, use an init-function."}], "answers": [{"comments": [{"owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448484237, "post_id": 33926016, "comment_id": 55613017, "body": "I am not working with C99 afaik. Is there another way to globally initialize the members?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448484434, "post_id": 33926016, "comment_id": 55613121, "body": "@donutjuice What do you mean by &quot;globally&quot;? I added something to my answer, maybe this&#39;ll help you."}, {"owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448484566, "post_id": 33926016, "comment_id": 55613185, "body": "so that the variable can be used in each of my functions. For the solutions you provided, would I make that statement inside of the structure or after it?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448484623, "post_id": 33926016, "comment_id": 55613212, "body": "After it. A <code>struct</code> definition can only contain uninitialized data definitions, <b>no</b> default initializations."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "edited": false, "score": 0, "creation_date": 1448484984, "post_id": 33926016, "comment_id": 55613351, "body": "@donutjuice a struct definition defines a type, not a variable. Your posted code does not have any variables in it."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448485180, "post_id": 33926016, "comment_id": 55613445, "body": "@M.M Oh, nice wording, the first sentence. I plagiarized somewhat if you don&#39;t mind. :-)"}], "tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": false, "score": 3, "last_activity_date": 1448485092, "last_edit_date": 1448485092, "creation_date": 1448483948, "answer_id": 33926016, "question_id": 33925983, "link": "https://stackoverflow.com/questions/33925983/initializing-fields-of-a-structure/33926016#33926016", "title": "Initializing fields of a structure", "body": "<p>You try to initialize a member in a <code>struct</code> <strong>definition</strong>, which is a <strong>type</strong><sup>1</sup>. That's <strong>no</strong> variable definition and doesn't take up any memory at runtime, mind you. You don't define any variable at all, so there's nothing to initialize.</p>\n\n<p>When actually defining a variable you can do something similar by using a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow\"><em>designated initializer list</em></a>:</p>\n\n<pre><code>struct SymTable table = { .tablesize = DEFAULT_TABLE_SIZE, .counter = 1 };\n</code></pre>\n\n<p>This feature is only available since C99, however (GCC implements it as a <strong>non-conformant extension since C90!</strong>). Another, &lt; C99 way, would be the somewhat bulkier</p>\n\n<pre><code>struct SymTable table = { NULL, DEFAULT_TABLE_SIZE, 1 };\n</code></pre>\n\n<p>where you need to know the order of members <strong>and</strong> the default values of each member.</p>\n\n<hr>\n\n<p><sub><sup>1</sup> Thanks to @M.M for that neat wording! </sub></p>\n"}, {"tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": true, "score": 2, "last_activity_date": 1448485169, "creation_date": 1448485169, "answer_id": 33926305, "question_id": 33925983, "link": "https://stackoverflow.com/questions/33925983/initializing-fields-of-a-structure/33926305#33926305", "title": "Initializing fields of a structure", "body": "<p>You are trying to use an assignment in the definition of <code>struct SymTable</code>. This is a structure, i.e. a kind of type. You can't assign a value to a type, or to a part of a type: a type isn't a piece of storage, it's a classification of storage.</p>\n\n<p>You can use an assignment when defining an object of type <code>struct SymTable</code>. You can assign all the fields; if you omit some fields, the fields you omit will be initialized to \u201czero\u201d (meaning <code>0</code> for integer fields, <code>0.0</code> for floating point fields, <code>NULL</code> for pointer fields).</p>\n\n<pre><code>struct SymTable syms1 = {NULL, DEFAULT_TABLE_SIZE, 1};\nstruct SymTable syms2 = {.counter = 1, .tablesize = DEFAULT_TABLE_SIZE};\n</code></pre>\n\n<p>The syntax I used for <code>syms2</code> was introduced in C99, which is supported by most but not all common compilers). The syntax I used for <code>syms1</code> has existed since the dawn of time; it has the downside that you need to provide values for the fields in order.</p>\n\n<p>If you were trying to provide default values for any new object of type <code>struct symTable</code>, this is not a feature that C provides natively. A <code>struct symTable</code> declared by just writing <code>struct symTable somename;</code> in a function has uninitialized content, and there's nothing you can do about it. You can do it via a macro, but you'll need to call the macro explicitly when you create an object.</p>\n\n<pre><code>#define STRUCT_SYMTABLE_DEFAULT {NULL, DEFAULT_TABLE_SIZE, 1}\n\u2026\nstruct symTable syms3 = STRUCT_SYMTABLE_DEFAULT;\n</code></pre>\n\n<p>This approach has some downsides: you can only use this to initialize a struct, you can't use this syntax to assign a value later. Also, there's no type checking. A way to fix these defects is to return a value from a function. Good compilers will optimize it to the same code.</p>\n\n<pre><code>struct symTable inline symTable_default(void) {\n    struct symTable default = {NULL, DEFAULT_TABLE_SIZE, 1};\n    return default;\n}\n\u2026\nstruct symTable syms4 = symTable_default();\n\u2026\n/* Reset the table to its default value */\nsyms4 = symTable_default();\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 5477862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/5d29e9f093c9fe9e7e3deb4503860886?s=128&d=identicon&r=PG&f=1", "display_name": "donut juice", "link": "https://stackoverflow.com/users/5477862/donut-juice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5551, "favorite_count": 0, "accepted_answer_id": 33926305, "answer_count": 2, "score": 2, "last_activity_date": 1448485270, "creation_date": 1448483838, "last_edit_date": 1448485270, "question_id": 33925983, "link": "https://stackoverflow.com/questions/33925983/initializing-fields-of-a-structure", "title": "Initializing fields of a structure", "body": "<p>I'm working on a hash table assignment and I'm getting an unexpected error when trying to initialize my structure variables with a macro value. Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"symTable.h\"\n#define DEFAULT_TABLE_SIZE 61\n#define HASH_MULTIPLIER 65599\n\ntypedef struct Node\n{\n    char *key;\n    int *value;\n    struct Node *next;\n} Node_T;\n\ntypedef struct SymTable\n{\n    Node_T **Table;\n    int tablesize = DEFAULT_TABLE_SIZE; //where I am getting my error\n    int counter = 1;\n} *SymTable_T;\n</code></pre>\n\n<p>and the error I am getting is</p>\n\n<pre><code>error: expected ':', ',', ';', '}' or '__attribute__' before '=' token\n</code></pre>\n\n<p>Can someone explain to me why it isn't accepting my macro value?</p>\n"}, {"tags": ["c", "linux", "assembly", "nasm"], "answers": [{"comments": [{"owner": {"reputation": 4445, "user_id": 560903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d66cec4f7bd065097137c2001c96b866?s=128&d=identicon&r=PG", "display_name": "keithmo", "link": "https://stackoverflow.com/users/560903/keithmo"}, "edited": false, "score": 0, "creation_date": 1448484292, "post_id": 33925854, "comment_id": 55613056, "body": "Would <code>return 0;</code> from main() accomplish the same thing? Just curious (and I&#39;m not in a position where I can this this right now)."}, {"owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "edited": false, "score": 0, "creation_date": 1448485599, "post_id": 33925854, "comment_id": 55613663, "body": "Should do.  Note that writing your own <code>main</code> in asm and then calling the C library is not guarenteed to be safe -- some C implementations rely on special code added to <code>main</code> by the compiler to initialize the standard library properly.  Linux should be fine, however."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1448488213, "post_id": 33925854, "comment_id": 55614986, "body": "Generally not an issue on Linux as generally runtime is initialized before the call to <i>main</i> with all the <code>libc</code> versions I have encountered on that platform. This includes C++. Windows on the other hand may require the <code>ctor</code> startup code to be called (for static global objects) inside <i>main</i> . (as an example of what you describe) if using C++. This is heavily dependent on the C/C++ runtime library being used."}, {"owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "edited": false, "score": 1, "creation_date": 1448495993, "post_id": 33925854, "comment_id": 55617976, "body": "Also, in ELF, IIRC, a .so can define <code>_init</code> and <code>_fini</code> functions (explicit names) and ELF loader (e.g. <code>&#47;lib64&#47;ld-linux-x86-64.so.2</code>) will call them when it loads/unloads the .so respectively.  When you use gcc to link an executable, it includes <code>crt0.o</code> which has the <code>_start</code> symbol which gcc tells ld is the &quot;start symbol&quot; [transfer control to after loading]. <code>_start</code> is what calls <code>main</code> after setting up a few things and <i>may</i> be what calls the functions specified with ctors/dtors attributes.  Likewise, for .so _init--&gt;ctors, _fini--&gt;dtors.  Or ... ctors/dtors handled by ELF loader."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1448499147, "post_id": 33925854, "comment_id": 55618711, "body": "@ChrisDodd: gcc&#39;s <code>main</code> aligns the stack by 16.  If the C runtime stuff that calls main hasn&#39;t done that already, you&#39;ll be breaking the ABI.  (Which will only matter if anything ever calls a function that actually faults if the stack isn&#39;t aligned, e.g. uses alignment-required SSE insns to load or store on the stack.)  But yes, returning from <code>main</code> will do the trick here, to answer Keithmo&#39;s question."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": true, "score": 10, "last_activity_date": 1448483299, "creation_date": 1448483299, "answer_id": 33925854, "question_id": 33925706, "link": "https://stackoverflow.com/questions/33925706/why-cant-stdout-from-calling-c-library-printf-in-asm-be-piped-to-other-programs/33925854#33925854", "title": "Why can&#39;t stdout from calling c library printf in asm be piped to other programs?", "body": "<p>C stdio functions may be buffered by default, so writing to stdout with <code>printf</code> doesn't always actually output anything -- sometimes it just writes to the buffer, awaiting a subsequent flush.  Often times, whether a given stdio stream is buffered or not depends on whether it is connected to a terminal or a pipe or a file or something else.</p>\n\n<p>When you call the exit system call (as you do), any data still in buffers will be lost.  If you instead call the C library <code>exit</code> function, it will flush all buffers before actually exiting.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user706775"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 3, "accepted_answer_id": 33925854, "answer_count": 1, "score": 9, "last_activity_date": 1448483299, "creation_date": 1448482707, "question_id": 33925706, "link": "https://stackoverflow.com/questions/33925706/why-cant-stdout-from-calling-c-library-printf-in-asm-be-piped-to-other-programs", "title": "Why can&#39;t stdout from calling c library printf in asm be piped to other programs?", "body": "<p>I have written a simple NASM program:</p>\n\n<p><strong>printtest.asm</strong></p>\n\n<pre><code>section .data\nstr_out db \"val = %d\",10,0\n\nsection .text\n\nglobal main\n\nextern printf\n\nmain:\n\n    PUSH 5\n    PUSH DWORD str_out\n    CALL printf\n    ADD ESP, 8\n    MOV EAX, 1\n    INT 80h\n</code></pre>\n\n<p>I am linking and creating an executable with the following commands:</p>\n\n<pre><code>nasm -f elf -l printtest.lst printtest.asm\ngcc -o  printtest printtest.o\n</code></pre>\n\n<p>When linked and executed, this prints \"val = 5\" to the console no problem. As far as I'm aware, calling <code>printf</code> by default writes on <code>stdout</code>. So why when I try and pipe this to another program does the other program seem to receive no input?</p>\n\n<p>E.g</p>\n\n<pre><code>./printtest | cat\n</code></pre>\n\n<p>Seems to do nothing</p>\n\n<p>I am sure I am fundamentally misunderstanding something here.</p>\n"}, {"tags": ["c", "gcc", "clang"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482464, "post_id": 33925618, "comment_id": 55612115, "body": "Why would you do that? Either you have the statement in the code or you don&#39;t. If you want to disble part of the code at compiler-time, use the preprocessor."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482483, "post_id": 33925618, "comment_id": 55612130, "body": "@Olaf It&#39;s autogenerated code, with side effects. The neatest solution would be to mark it as maybe unused, else I&#39;ll have to do <code>-Wno-unused-value</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482532, "post_id": 33925618, "comment_id": 55612162, "body": "What I wrote applies to automatically generated code, too. But you have a third option: just don&#39;t emit that code."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482629, "post_id": 33925618, "comment_id": 55612213, "body": "@Olaf Deducing whether the result is unused and swapping in <code>(void)0</code> for t would increase complexity significantly."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482819, "post_id": 33925618, "comment_id": 55612300, "body": "No it would not. However, please clarify what you want to accomplish actually. As given, it looks like an XY-problem. Hmm... do you mean not to use the <b>result</b> of an expression? You already did that with <code>(void)0</code>."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448482887, "post_id": 33925618, "comment_id": 55612329, "body": "@Olaf It is not an XY question. You do not know the codebase I&#39;m working on, and you do not know which solution is more elegant. Why not give me the benefit of the doubt? This is a valid programming question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448482908, "post_id": 33925618, "comment_id": 55612340, "body": "Is the final <code>t;</code> elegant?"}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448482928, "post_id": 33925618, "comment_id": 55612349, "body": "@WeatherVane In this instance, yes it is."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448482973, "post_id": 33925618, "comment_id": 55612365, "body": "Why? You have used <code>t</code> so you don&#39;t need a dummy reference to defeat a compiler warning."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448482979, "post_id": 33925618, "comment_id": 55612372, "body": "I did not vote to close as OT. It is just not clear what you actually mean."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448483073, "post_id": 33925618, "comment_id": 55612419, "body": "@WeatherVane: <code>t;</code> can generate a compiler warning. Perhaps that is what OP wants to suppress. However, as <code>t</code> is executed, it actually <b>is</b> used (at least for a side-effect if <code>t</code> is <code>volatile</code>)."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448483084, "post_id": 33925618, "comment_id": 55612427, "body": "@WeatherVane I have used <code>t</code> to return the value <code>t</code> from the statement expression. It&#39;s sometimes used, sometimes not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448483159, "post_id": 33925618, "comment_id": 55612462, "body": "A statement expression does not return anything (where would it?). That would only be an assignment-expression or a <code>return</code> statement."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448483242, "post_id": 33925618, "comment_id": 55612506, "body": "@Olaf The <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow noreferrer\">docs</a> beg to differ. &quot;the result value of a statement expression undergoes array and function pointer decay, and is returned by value to the enclosing expression&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448483387, "post_id": 33925618, "comment_id": 55612573, "body": "Again: An <i>expression statement</i> cannot be enclosed in an expression. So it cannot return anything. Feel free to prove me wrong: <a href=\"http://port70.net/~nsz/c/c11/n1570.html\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html</a> You refer to a <b>gcc extension</b>! Please make that clear in your question. However, it is still not clear what you want to accomplish; You have to show the surrounding code. Think about a better way by using a function."}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448483567, "post_id": 33925618, "comment_id": 55612661, "body": "@Olaf Your link specifies nothing about statement expressions. The question is tagged <code>gcc</code> and <code>clang</code>, and I refer to the (commonly used) extension by name: statement expressions."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448483640, "post_id": 33925618, "comment_id": 55612694, "body": "Provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> <b>in</b> your qestion. Do not just use external links."}], "answers": [{"comments": [{"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "edited": false, "score": 0, "creation_date": 1448484351, "post_id": 33926036, "comment_id": 55613081, "body": "Unfortunately I then get <code>explicitly assigning value of variable of type &#39;struct Value *&#39; to itself [-Werror,-Wself-assign]</code>"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "edited": false, "score": 0, "creation_date": 1448492787, "post_id": 33926036, "comment_id": 55616949, "body": "@Alec stop using <code>-Wself-assign</code> perhaps"}, {"owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448493390, "post_id": 33926036, "comment_id": 55617181, "body": "@M.M I think that <code>-Wno-unused-value</code> is the least egregious of the two options, so that&#39;s what I&#39;m using at the moment - unless anyone comes up with a solution to mark an expression result (not a variable) as maybe unused."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 1, "last_activity_date": 1448484015, "creation_date": 1448484015, "answer_id": 33926036, "question_id": 33925618, "link": "https://stackoverflow.com/questions/33925618/mark-statement-expression-as-maybe-unused/33926036#33926036", "title": "Mark statement expression as maybe unused", "body": "<p>Yes, this can be quite disturbing if you use such things in macros or alike. I usually silence such warnings by using a completely useless assignment at the end:</p>\n\n<pre><code>t = t;\n</code></pre>\n\n<p>This has two effects: the compiler now thinks that <code>t</code> is used, and also that the result of that is an rvalue so nobody can try to take the address of the whole <code>({ })</code> expression.</p>\n"}, {"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 1, "last_activity_date": 1448493355, "last_edit_date": 1448493355, "creation_date": 1448490722, "answer_id": 33927579, "question_id": 33925618, "link": "https://stackoverflow.com/questions/33925618/mark-statement-expression-as-maybe-unused/33927579#33927579", "title": "Mark statement expression as maybe unused", "body": "<p>Here's what I use:</p>\n\n<pre><code>// tell compiler to shut up about unused variables\n#define VARIABLE_USED(_sym) \\\n    _variable_used(!!_sym)\n\n__attribute__((__always_inline__)) static inline\nvoid\n_variable_used(int flg)\n{\n}\n</code></pre>\n\n<ul>\n<li>You may need variants based on your actual types.  But, because of the <code>!!</code> trick, the above works for almost any intrinsic type (inc. pointers)</li>\n<li>You may need <code>inline</code> instead of <code>static inline</code> depending on your compiler</li>\n<li>Without <code>__attribute__((__always_inline__))</code> if your compiler complains about it</li>\n</ul>\n\n<p>So, somewhere in the code just add <code>VARIABLE_USED(my_unused_variable);</code> for all your unused symbols.</p>\n\n<p>NOTE: This is <em>zero</em> overhead (i.e. generates no extra code).  It may seem like it does with the formulation of the argument, but because of the inline definition, it gets optimized away.  But, it does trick the compiler into thinking the variable has been used.</p>\n\n<p>The above is what I've used for a long time.  But, I just thought up a possibly simpler variant [this is <em>untested</em>]:</p>\n\n<pre><code>// tell compiler to shut up about unused variables\n#define VARIABLE_USED(_sym) \\\n    do { \\\n        if (1) \\\n            break;\n        if (!! _sym) \\\n            break; \\\n    } while (0)\n</code></pre>\n\n<p>These macros <em>might</em> work for a struct, as is:</p>\n\n<pre><code>struct foobar foo;\n...\nVARIABLE_USED(&amp;foo);\n</code></pre>\n"}], "owner": {"reputation": 2441, "user_id": 750875, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e5fa3880a89e30118d71984f18846dde?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/750875/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1448493355, "creation_date": 1448482394, "last_edit_date": 1448483957, "question_id": 33925618, "link": "https://stackoverflow.com/questions/33925618/mark-statement-expression-as-maybe-unused", "title": "Mark statement expression as maybe unused", "body": "<p>How do I mark a <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Statement-Exprs.html\" rel=\"nofollow\">statement expression</a>, i.e.</p>\n\n<pre><code>({struct Value * t = expr; set(t,val); t;})\n</code></pre>\n\n<p>as maybe unused, i.e.</p>\n\n<pre><code>__attribute__((unused))\n</code></pre>\n\n<p>It's autogenerated code, with side effects. Deducing whether the result is unused and swapping in <code>(void)0</code> for <code>t</code> at generation time would increase complexity significantly. The neatest solution would be to mark it as maybe unused, else I'll have to do <code>-Wno-unused-value</code>.</p>\n"}, {"tags": ["android", "c", "linux", "input", "hid"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4500123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615227441c71038c9887dafec6199105?s=128&d=identicon&r=PG&f=1", "display_name": "Blondie", "link": "https://stackoverflow.com/users/4500123/blondie"}, "edited": false, "score": 0, "creation_date": 1448564208, "post_id": 33929547, "comment_id": 55649771, "body": "Many thanks for the help! I have accepted this good answer and posted my changed code as answer (i hope that this is ok so)"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 0, "last_activity_date": 1448504009, "last_edit_date": 1495542632, "creation_date": 1448504009, "answer_id": 33929547, "question_id": 33925582, "link": "https://stackoverflow.com/questions/33925582/failed-to-read-a-usb-hid-rfid-reader-with-c/33929547#33929547", "title": "Failed to read a USB HID RFID-Reader with C", "body": "<p>Of course you are occasionally missing events: you read up to 64 event structures, but assume you got exactly two, regardless of <code>rd</code>, the amount read.</p>\n\n<p>You should first verify that you have complete input events (<code>(rd % sizeof (struct input_event)) == 0</code>). If not, you certainly should alert the user, as that's exceedingly rare (as in should never ever occur), and abort.</p>\n\n<p>Then, check how many actual input events you have received. (That would be <code>rd / sizeof (struct input_event)</code>.) You <strong>cannot</strong> rely on the events occurring as pairs, because kernel internal timing will affect things, even if the device reports them in consecutive HID messages. Instead, you need to examine each event separately, and examine each event you read.</p>\n\n<p>Personally, I'd suggest using a <a href=\"https://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow noreferrer\">finite-state machine</a> for this. Have your outer loop consume entire identifiers. Within the outer loop, initially discard all events except those that may begin a new identifier. Receive those identifiers in an inner loop, ending with a terminating identifier. I'd go as far as read only single events at a time, to make the inner loop simpler. (There are at most a thousand events per second or so, so the extra syscall overhead is completely irrelevant here.)</p>\n\n<p>I have a complete example for barcodes <a href=\"https://stackoverflow.com/a/29956584/1475978\">here</a> -- there is very little difference to your use case. Carefully examine the <code>barcode_read()</code> function; it includes a timeout, instead of \"hanging\" (waiting forever) if a new sequence of input events (for a barcode, a sequence of digits followed by a non-digit) is interrupted in mid-run, say because the reader glitched or something. I'm pretty sure you could easily modify it to work for your use cases. </p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 4500123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615227441c71038c9887dafec6199105?s=128&d=identicon&r=PG&f=1", "display_name": "Blondie", "link": "https://stackoverflow.com/users/4500123/blondie"}, "is_accepted": false, "score": 0, "last_activity_date": 1448564090, "creation_date": 1448564090, "answer_id": 33945377, "question_id": 33925582, "link": "https://stackoverflow.com/questions/33925582/failed-to-read-a-usb-hid-rfid-reader-with-c/33945377#33945377", "title": "Failed to read a USB HID RFID-Reader with C", "body": "<p>In response to the Answer from Nominal Animal i have changed my code to this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;linux/input.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;signal.h&gt;\n\n#define BARCODE_MAXLEN  1023\n\n\nsize_t barcode_read(int fd,\n                    char *const buffer, const size_t length)\n{\n    size_t len = 0;\n    int status = ETIMEDOUT;\n\n    if (!buffer || length &lt; 2 ) {\n        //errno = EINVAL;\n        return (size_t)0;\n    }\n\n\n    while (1) {\n        struct input_event ev;\n        ssize_t n;\n        int digit;\n\n        n = read(fd, &amp;ev, sizeof ev);\n        if (n == (ssize_t)-1) {\n            if (errno == EINTR)\n                continue;\n            status = errno;\n            break;\n\n        } else\n        if (n == sizeof ev) {\n\n            /* We consider only key presses and autorepeats. */\n            if (ev.type != EV_KEY || (ev.value != 1 &amp;&amp; ev.value != 2))\n                continue;\n\n            switch (ev.code) {\n            case KEY_0: digit = '0'; break;\n            case KEY_1: digit = '1'; break;\n            case KEY_2: digit = '2'; break;\n            case KEY_3: digit = '3'; break;\n            case KEY_4: digit = '4'; break;\n            case KEY_5: digit = '5'; break;\n            case KEY_6: digit = '6'; break;\n            case KEY_7: digit = '7'; break;\n            case KEY_8: digit = '8'; break;\n            case KEY_9: digit = '9'; break;\n            default:    digit = '\\0';\n            }\n\n            /* Non-digit key ends the code, except at beginning of code. */\n            if (digit == '\\0') {\n                if (!len)\n                    continue;\n                status = 0;\n                break;\n            }\n\n            if (len &lt; length)\n                buffer[len] = digit;\n            len++;\n\n            continue;\n\n        } else\n        if (n == (ssize_t)0) {\n            status = ENOENT;\n            break;                \n\n        } else {\n            status = EIO;\n            break;\n        }\n    }\n\n    /* Add terminator character to buffer. */\n    if (len + 1 &lt; length)\n        buffer[len + 1] = '\\0';\n    else\n        buffer[length - 1] = '\\0';\n\n    errno = status;\n    return len;\n}\n\nint main(int argc, char* argv[])\n{\n    struct input_event ev[64];\n    int fevdev = -1;\n    int result = 0;\n    int size = sizeof(struct input_event);\n    int rd;\n    int value;\n    char name[256] = \"Unknown\";\n    char *device = \"/dev/usb/input1-1.4\";\n\n    fevdev = open(device, O_RDONLY);\n    if (fevdev == -1) {\n        printf(\"Failed to open event device.\\n\");\n        exit(1);\n    }\n\n    result = ioctl(fevdev, EVIOCGNAME(sizeof(name)), name);\n    printf (\"Reading From : %s (%s)\\n\", device, name);\n\n    printf(\"Getting exclusive access: \");\n    result = ioctl(fevdev, EVIOCGRAB, 1);\n    printf(\"%s\\n\", (result == 0) ? \"SUCCESS\" : \"FAILURE\");\n\n    while (1) {\n        char    code[BARCODE_MAXLEN + 1];\n        size_t  len;\n\n        //if (done) {\n        //    status = EINTR;\n        //    break;\n        //}\n\n        len = barcode_read(fevdev, code, sizeof code);\n        if (errno) {\n            //status = errno;\n            break;\n        }\n        if (len &lt; (size_t)1) {\n            //status = ETIMEDOUT;\n            break;\n        }\n\n        printf(\"%zu-digit barcode: %s\\n\", len, code);\n        fflush(stdout);\n    }\n\n    printf(\"Exiting.\\n\");\n    result = ioctl(fevdev, EVIOCGRAB, 1);\n    close(fevdev);\n    return 0;\n}\n</code></pre>\n\n<p>I do not really know what I've done here. (Im only a hobby-programmer in vb.net)\nEssentially i have used the example from Nominal Animal (size_t barcode_read) and removed the timeout. \nThis works perfectly. No more read errors.\nThis is certainly not a good program style...but it works for me.</p>\n\n<p>Many Thank to Nominal Animal for the explanation of the problem and the example!</p>\n"}], "owner": {"reputation": 23, "user_id": 4500123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/615227441c71038c9887dafec6199105?s=128&d=identicon&r=PG&f=1", "display_name": "Blondie", "link": "https://stackoverflow.com/users/4500123/blondie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 33929547, "answer_count": 2, "score": 1, "last_activity_date": 1448564090, "creation_date": 1448482263, "last_edit_date": 1495540424, "question_id": 33925582, "link": "https://stackoverflow.com/questions/33925582/failed-to-read-a-usb-hid-rfid-reader-with-c", "title": "Failed to read a USB HID RFID-Reader with C", "body": "<p>i have a cheap USB-RFID-Reader. This reader is a HID-Keyboard (without buttons).\nI need to capture the output of the reader without writing it to any console.\nI have found this code here:\n<a href=\"https://stackoverflow.com/a/7672324/4500123\">https://stackoverflow.com/a/7672324/4500123</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;linux/input.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/select.h&gt;\n#include &lt;sys/time.h&gt;\n#include &lt;termios.h&gt;\n#include &lt;signal.h&gt;\n\nint main(int argc, char* argv[])\n{\n    struct input_event ev[64];\n    int fevdev = -1;\n    int result = 0;\n    int size = sizeof(struct input_event);\n    int rd;\n    int value;\n    char name[256] = \"Unknown\";\n    char *device = \"/dev/input/event3\";\n\n\n    fevdev = open(device, O_RDONLY);\n    if (fevdev == -1) {\n        printf(\"Failed to open event device.\\n\");\n        exit(1);\n    }\n\n    result = ioctl(fevdev, EVIOCGNAME(sizeof(name)), name);\n    printf (\"Reading From : %s (%s)\\n\", device, name);\n\n    printf(\"Getting exclusive access: \");\n    result = ioctl(fevdev, EVIOCGRAB, 1);\n    printf(\"%s\\n\", (result == 0) ? \"SUCCESS\" : \"FAILURE\");\n\n   while (1)\n    {\n        if ((rd = read(fevdev, ev, size * 64)) &lt; size) {\n            break;\n        }\n\n        value = ev[0].value;\n\n        if (value != ' ' &amp;&amp; ev[1].value == 1 &amp;&amp; ev[1].type == 1) {\n            printf (\"Code[%d]\\n\", (ev[1].code));\n        }\n    }\n\n    printf(\"Exiting.\\n\");\n    result = ioctl(fevdev, EVIOCGRAB, 1);\n    close(fevdev);\n    return 0;\n}\n</code></pre>\n\n<p>This code should work. I have it running on my RaspberryPI without problems.\nI try now to get this code to work on my Android Tablet (with root). But very often i missing letters or the Code is incomplete.</p>\n\n<p>If i write to a text file, all letters are be transfered without problems. But with the code it wont work properly.</p>\n\n<p>What can i do to find out the problem? Is it a timing problem?</p>\n"}, {"tags": ["c", "binary", "add"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1448482283, "post_id": 33925539, "comment_id": 55612023, "body": "I would say all of the presented examples are correct."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1448482863, "post_id": 33925539, "comment_id": 55612317, "body": "EDIT: Nope. 0111 + 0001 should equal 1000. My calculator says it is 1001. What&#39;s up with that?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1448483052, "post_id": 33925539, "comment_id": 55612407, "body": "But in the question it reads <code>0111 + 0001 = 1000 (wrong)</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448483071, "post_id": 33925539, "comment_id": 55612418, "body": "When code does <code>0111 + 0001</code>, is <code>cpu-&gt;carry</code> set to 0 first?  Code may have an off by 1 from the previous calculation."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448483115, "post_id": 33925539, "comment_id": 55612440, "body": "Sorry about that Eugene. It&#39;s very difficult for me to balance the answers I&#39;m getting versus the answers I&#39;m getting online. I was mixing a couple up. I&#39;ll fix that."}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448483347, "post_id": 33925539, "comment_id": 55612557, "body": "Gah, I honestly can&#39;t tell if my answers are right or wrong. I&#39;m not sure the tool I was using online was correct anyways. D:"}, {"owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "edited": false, "score": 0, "creation_date": 1448483448, "post_id": 33925539, "comment_id": 55612608, "body": "Thanks Chux! Looks like that might have been the issue after all! I just set the carry flag to zero at the beginning of the function and it seems fine now."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 0, "last_activity_date": 1448483642, "creation_date": 1448483642, "answer_id": 33925945, "question_id": 33925539, "link": "https://stackoverflow.com/questions/33925539/binary-adder-only-working-most-of-the-time/33925945#33925945", "title": "Binary adder only working *most* of the time", "body": "<p>OP's test cases expected the <code>cpu-&gt;carry</code> to have a 0 when doing the <code>void add_function(struct cpu_t *cpu)</code>.</p>\n\n<p>Look like OP should have 2 add functions and use accordingly.</p>\n\n<pre><code>void addc_function(struct cpu_t *cpu) {\n  // existing code \n}\n\nvoid add_function(struct cpu_t *cpu) {\n  cpu-&gt;carry = 0;\n  addc_function(cpu);\n}\n</code></pre>\n"}], "owner": {"reputation": 687, "user_id": 5403466, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9d2024715232484a2e467afa8de1af7c?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler Shellberg", "link": "https://stackoverflow.com/users/5403466/tyler-shellberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 33925945, "answer_count": 1, "score": 1, "last_activity_date": 1448483642, "creation_date": 1448482136, "last_edit_date": 1448483313, "question_id": 33925539, "link": "https://stackoverflow.com/questions/33925539/binary-adder-only-working-most-of-the-time", "title": "Binary adder only working *most* of the time", "body": "<p>I'm currently working on a binary adder.</p>\n\n<p>Register A and B are the input registers. They are stored as doubly-linked lists. Register S is for output. (For the truth table)</p>\n\n<p>Here is the truth table provided:</p>\n\n<p>A | B | CarryIn | S | CarryOut</p>\n\n<p>0 | 0 | 0       | 0 | 0</p>\n\n<p>0 | 0 | 1       | 1 | 0</p>\n\n<p>0 | 1 | 0       | 1 | 0</p>\n\n<p>0 | 1 | 1       | 0 | 1</p>\n\n<p>1 | 0 | 0       | 1 | 0</p>\n\n<p>1 | 0 | 1       | 0 | 1</p>\n\n<p>1 | 1 | 0       | 0 | 1</p>\n\n<p>1 | 1 | 1       | 1 | 1</p>\n\n<p>Here is the structure (CPU) that holds pointers to them, along with other data:</p>\n\n<pre><code>struct cpu_t\n{\n        int word_size; \n        int unsign; \n        int overflow; \n        int carry;\n        int sign;\n        int parity;\n        int zero;\n        struct bit_t *r1_head;\n        struct bit_t *r1_tail;\n        struct bit_t *r2_head;\n        struct bit_t *r2_tail;\n        struct bit_t *r3_head;\n        struct bit_t *r3_tail;\n};\n</code></pre>\n\n<p>And here is my add function:</p>\n\n<pre><code>void add_function(struct cpu_t *cpu)\n{\n    int i = 0;\n\n    struct bit_t *temp1 = cpu-&gt;r1_tail;\n    struct bit_t *temp2 = cpu-&gt;r2_tail;\n    struct bit_t *temp3 = cpu-&gt;r3_tail;\n\n    while(i &lt; (cpu-&gt;word_size))\n    {\n        if(temp1-&gt;n == 0 &amp;&amp; temp2-&gt;n == 0 &amp;&amp; cpu-&gt;carry == 0)\n        {\n            temp3-&gt;n = 0;   \n            cpu-&gt;carry = 0;\n        }\n        else if(temp1-&gt;n == 0 &amp;&amp; temp2-&gt;n == 0 &amp;&amp; cpu-&gt;carry == 1)\n        {\n            temp3-&gt;n = 1;   \n            cpu-&gt;carry = 0;\n        }\n        else if(temp1-&gt;n == 0 &amp;&amp; temp2-&gt;n == 1 &amp;&amp; cpu-&gt;carry == 0)\n        {\n            temp3-&gt;n = 1;   \n            cpu-&gt;carry = 0;\n        }\n        else if(temp1-&gt;n == 0 &amp;&amp; temp2-&gt;n == 1 &amp;&amp; cpu-&gt;carry == 1)\n        {\n            temp3-&gt;n = 0;   \n            cpu-&gt;carry = 1;\n        }\n        else if(temp1-&gt;n == 1 &amp;&amp; temp2-&gt;n == 0 &amp;&amp; cpu-&gt;carry == 0)\n        {\n            temp3-&gt;n = 1;   \n            cpu-&gt;carry = 0;\n        }\n        else if(temp1-&gt;n == 1 &amp;&amp; temp2-&gt;n == 0 &amp;&amp; cpu-&gt;carry == 1)\n        {\n            temp3-&gt;n = 0;   \n            cpu-&gt;carry = 1;\n        }\n        else if(temp1-&gt;n == 1 &amp;&amp; temp2-&gt;n == 1 &amp;&amp; cpu-&gt;carry == 0)\n        {\n            temp3-&gt;n = 0;   \n            cpu-&gt;carry = 1;\n        }\n        else if(temp1-&gt;n == 1 &amp;&amp; temp2-&gt;n == 1 &amp;&amp; cpu-&gt;carry == 1)\n        {\n            temp3-&gt;n = 1;   \n            cpu-&gt;carry = 1;\n        }\n\n        temp1 = temp1-&gt;prev;\n        temp2 = temp2-&gt;prev;\n        temp3 = temp3-&gt;prev;\n        i++;\n    }\n}\n</code></pre>\n\n<p>Here is some sample output to show the kind of issue I'm having:</p>\n\n<p>With a word_size of 2:</p>\n\n<p>01 + 01 = 10 (correct)</p>\n\n<p>With a word_size of 4:</p>\n\n<p>0111 + 0001 = 1001 (wrong)</p>\n\n<p>With a word_size of 8:</p>\n\n<p>10101010 + 01010101 = 11111111 (correct)</p>\n\n<p>11101101 + 01101000 = 01010110 (incorrect, actual is 01010101)</p>\n\n<p>With a word_size of 4:</p>\n\n<p>1001 + 0110 = 1111 (correct)</p>\n\n<p>1111 + 1111 = 1110 (correct)</p>\n\n<p>So, based on this input, does anyone know why my code isn't working? Any ideas?</p>\n\n<p>If you need me to edit in some more code, I think I can easily do that. If not, I'll just tell you what you need through the comments.</p>\n\n<p>Thanks for any help you can give!</p>\n"}, {"tags": ["c", "bash", "executable"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3597108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3f412b8a2b76530417011c90e69e40?s=128&d=identicon&r=PG&f=1", "display_name": "vanka", "link": "https://stackoverflow.com/users/3597108/vanka"}, "edited": false, "score": 0, "creation_date": 1448975941, "post_id": 33925581, "comment_id": 55797640, "body": "Is there any way to find out when a function starts executing and when it stops? I want to find that timestamp obeying the restriction of not modifying the c source and only using the info I can get from the executable. I tried looking for this in gdb and gprof related articles, but i didn&#39;t found anything specific."}], "tags": [], "owner": {"reputation": 604, "user_id": 4666991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hFSp9.jpg?s=128&g=1", "display_name": "matz", "link": "https://stackoverflow.com/users/4666991/matz"}, "is_accepted": true, "score": 1, "last_activity_date": 1448482257, "creation_date": 1448482257, "answer_id": 33925581, "question_id": 33925486, "link": "https://stackoverflow.com/questions/33925486/can-a-bash-script-access-information-from-a-c-executable-it-takes-as-parameter/33925581#33925581", "title": "Can a bash script access information from a C executable it takes as parameter?", "body": "<p>Short answer is no.</p>\n\n<p>Longer answer is no, but have a look at <em>profilers</em> to measure the execution time of a program (e.g. <a href=\"https://sourceware.org/binutils/docs/gprof/\" rel=\"nofollow\">gprof</a>) and <em>debuggers</em> to inspect value of variables during runtime (e.g. <a href=\"https://www.gnu.org/software/gdb/\" rel=\"nofollow\">gdb</a>).</p>\n"}], "owner": {"reputation": 3, "user_id": 3597108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc3f412b8a2b76530417011c90e69e40?s=128&d=identicon&r=PG&f=1", "display_name": "vanka", "link": "https://stackoverflow.com/users/3597108/vanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33925581, "answer_count": 1, "score": 0, "last_activity_date": 1448482257, "creation_date": 1448481955, "question_id": 33925486, "link": "https://stackoverflow.com/questions/33925486/can-a-bash-script-access-information-from-a-c-executable-it-takes-as-parameter", "title": "Can a bash script access information from a C executable it takes as parameter?", "body": "<p>To be more concrete, I have a C executable and I want to know in my bash script the execution time of a function from that C. I also want to know if I can find out what is the value of a certain variable from that file .  </p>\n\n<p>PS: I don't want to output on the console the things I need from the C file and then to read that output in the script</p>\n"}, {"tags": ["c", "linux", "ipc", "msgrcv"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1448489914, "post_id": 33925120, "comment_id": 55615780, "body": "Please clarify your question. Which functions exactly are failing? Your title refers to <code>sendmsg</code> and <code>recvmsg</code> but the code shown does not have any calls to these functions. Do you mean <code>msgsnd</code> and <code>msgrcv</code>? In any case, you have multiple calls of all those functions. Which of those exactly are failing and what is the diagnostic output of your program? You need to help us by giving all the relevant info."}, {"owner": {"reputation": 87, "user_id": 3602820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc0242bff2b386c23de77cacd722419c?s=128&d=identicon&r=PG&f=1", "display_name": "patricio2626", "link": "https://stackoverflow.com/users/3602820/patricio2626"}, "edited": false, "score": 0, "creation_date": 1448501436, "post_id": 33925120, "comment_id": 55619291, "body": "I just included sys/types.h but it didn&#39;t change anything in the behavior."}], "answers": [{"tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 2, "last_activity_date": 1448515051, "creation_date": 1448515051, "answer_id": 33931062, "question_id": 33925120, "link": "https://stackoverflow.com/questions/33925120/c-linux-ubuntu-msgsnd-and-msgrcv-errno-22-einval/33931062#33931062", "title": "C Linux (Ubuntu) - msgsnd() and msgrcv() errno 22 (EINVAL)", "body": "<p>I stared at your code for such a long time before I could spot the problem.</p>\n\n<pre><code>if(msqID = msgget(key, IPC_CREAT | 0666) == -1)\n</code></pre>\n\n<p>The parentheses are in the wrong place! That code effectively assigns <code>msgget(key, IPC_CREAT | 0666) == -1</code> to <code>msqID</code>. That is, <code>msqID</code> is a result of a conditional and explains why <code>msqID</code> is always <code>0</code>.</p>\n\n<p>The correct code should be as follows. Take note of the placement of the parentheses.</p>\n\n<pre><code>if((msqID = msgget(key, IPC_CREAT | 0666)) == -1)\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 3602820, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/dc0242bff2b386c23de77cacd722419c?s=128&d=identicon&r=PG&f=1", "display_name": "patricio2626", "link": "https://stackoverflow.com/users/3602820/patricio2626"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3398, "favorite_count": 1, "accepted_answer_id": 33931062, "answer_count": 1, "score": 1, "last_activity_date": 1448515051, "creation_date": 1448480488, "last_edit_date": 1448497937, "question_id": 33925120, "link": "https://stackoverflow.com/questions/33925120/c-linux-ubuntu-msgsnd-and-msgrcv-errno-22-einval", "title": "C Linux (Ubuntu) - msgsnd() and msgrcv() errno 22 (EINVAL)", "body": "<p>I'm trying my hand at IPC (message passing) for a while now, and I'm unable to resolve this problem. errno 22 (EINVAL) for msgget() seems to be <em>Invalid message queue identifier, nonpositive message type, or invalid message size</em>.  Now, errno 22 for msgrcv() is <em>msgqid invalid, or msgsz less than 0</em>, so this seems to point to my Queue ID being wrong since invalid msqueue id overlaps in the two error explanations.</p>\n\n<p>I should note that my <em>msgget()</em> call returns 0 as the queue ID.  This 'should' be fine, as the docs say that any non-negative return value is valid.  Any ideas?</p>\n\n<p>Output from a run after adjusting the counter to one (don't want to paste 100 error messages): </p>\n\n<p><em>msqID = 0, sendMessage.msgText = Hola!: 0, sendMessage.msgType = 1, MSG_SIZE = 256 Ruh roh, in parent send: : Invalid argument \nchild msgrcv(): msqID = 0, rcvMessage.msgText = , rcvMesage.msgType = 1, MSG_SIZE = 256 \nRuh roh, in child rcv: : Invalid argument</em> </p>\n\n<p>This fails on line line 31 (first msgsnd() in the parent process) and line 60 (first msgrcv() in the child process).</p>\n\n<pre><code>#include &lt;errno.h&gt;\n#include &lt;sys/msg.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nconst int MAX_TEXT_SIZE = 255;\nconst int COUNTER = 99;\nint main(){\n  srand(time(NULL));\n  int childPID, key = rand(), msgSendRslt, msgRecvRslt, msqID;\n  long int type  = 1;\n  struct msg {long msgType; char msgText[MAX_TEXT_SIZE];};\n  const int MSG_SIZE = sizeof(struct msg)-sizeof(long int);\n    if(msqID = msgget(key, IPC_CREAT | 0666) == -1){\n      perror(\"\\nRuh roh: \");\n      exit(1);\n    }\n    if((childPID = fork()) &gt; 0){\n      struct msg sendMessage, rcvMessage;\n      sendMessage.msgType = type;\n      char *sendMsg = malloc(MAX_TEXT_SIZE);\n      for(int i = 0; i &lt; 100; i++){\n        sprintf(sendMsg, \"Hola!: %d\", i);\n        strcpy(sendMessage.msgText, sendMsg);\n        printf(\"\\nmsqID = %d, sendMessage.msgText = %s, sendMessage.msgType = %ld, MSG_SIZE = %d\", msqID, sendMessage.msgText, sendMessage.msgType, MSG_SIZE);\n        printf(\"\\n\");\n        if(msgsnd(msqID, &amp;sendMsg, MSG_SIZE, IPC_NOWAIT) != -1){\n          printf(\"\\nFrom parent, sent msg %d\", i);\n          if(msgrcv(msqID, &amp;rcvMessage, MSG_SIZE, rcvMessage.msgType, IPC_NOWAIT) != -1){;\n            printf(\"\\nIn the parent, received from child: %s\", rcvMessage.msgText);\n          }\n          else\n            perror(\"\\nRuh roh, in parent rcv: \");\n        }\n        else\n          perror(\"\\nRuh roh, in parent send: \");\n          printf(\"\\nerrno: %d\", errno);\n      }\n      strcpy(sendMessage.msgText, \"Over and out!\");\n      if(msgsnd(msqID, &amp;sendMsg, MSG_SIZE, 0) == -1)\n        perror(\"\\nRuh roh, in parent send at end: \");\n    }\n  else if (childPID == 0){ //child\n    int count = 0;\n    int test = ceil(3.8);\n    char *countS = malloc(ceil(log(COUNTER)/log(10)));\n    struct msg rcvMessage, sendMessage;\n    strcpy(rcvMessage.msgText, \"\");\n    sendMessage.msgType = type;\n    rcvMessage.msgType = type;\n    while(strcmp(rcvMessage.msgText, \"Over and out!\") != 0){\n      sprintf(countS, \"%d\", count);\n      strcat(strcpy(sendMessage.msgText, \"10-4 good buddy!: \"), countS);\n      printf(\"\\nchild msgrcv(): msqID = %d, rcvMessage.msgText = %s, rcvMesage.msgType = %ld, MSG_SIZE = %d\", msqID, rcvMessage.msgText, rcvMessage.msgType, MSG_SIZE);\n      printf(\"\\n\");\n      if(msgrcv(msqID, &amp;rcvMessage, MSG_SIZE, rcvMessage.msgType, IPC_NOWAIT) != -1){\n        printf(\"\\nIn the child, received from the parent: %s\", rcvMessage.msgText);\n        if(msgsnd(msqID, &amp;sendMessage, MSG_SIZE, IPC_NOWAIT) == -1)\n          perror(\"\\nRuh roh, in child send: \");\n          exit(1);\n      }\n      else\n        perror(\"Ruh roh, in child rcv: \");\n        printf(\"\\nChild error: %d\", errno);\n        exit(1);\n    }\n  }\n  else{\n    perror(\"\\nRuh roh, fork() problem: \");\n    printf(\"\\n\");\n    exit(1);\n  }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 6701, "user_id": 3591273, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e9f02f036080c8be4e2abfcf753be75?s=128&d=identicon&r=PG", "display_name": "Nikos M.", "link": "https://stackoverflow.com/users/3591273/nikos-m"}, "reply_to_user": {"reputation": 4300, "user_id": 3184785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yT8ln.jpg?s=128&g=1", "display_name": "Ryan Vincent", "link": "https://stackoverflow.com/users/3184785/ryan-vincent"}, "edited": false, "score": 0, "creation_date": 1448481230, "post_id": 33925045, "comment_id": 55611518, "body": "@RyanVincent, re-taged question to <code>pointers</code>, instead of <code>point</code>, <code>c</code> should be the language tag"}, {"owner": {"reputation": 37741, "user_id": 3425536, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1484495923/picture?type=large", "display_name": "emlai", "link": "https://stackoverflow.com/users/3425536/emlai"}, "edited": false, "score": 1, "creation_date": 1448481988, "post_id": 33925045, "comment_id": 55611853, "body": "Remember that <code>myfood[2]</code> accesses the <i>third</i> element, i.e. the last element in your array. (<code>myfood[0]</code> would access the first.) Are you still sure you want <code>myfood[2]</code> to equal <code>&quot;yellow&quot;</code>?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 2, "creation_date": 1448484268, "post_id": 33925045, "comment_id": 55613041, "body": "Already your declaration is invalid: you are assigning three pointers to <code>char</code>, so <code>char*</code> to three <code>char</code>. Compile with all warning levels on."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5605706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d623ddb1746b392c215f6b06f44a5f?s=128&d=identicon&r=PG&f=1", "display_name": "Franc39", "link": "https://stackoverflow.com/users/5605706/franc39"}, "edited": false, "score": 0, "creation_date": 1448481799, "post_id": 33925257, "comment_id": 55611768, "body": "thank but it doesnt work.   what im doing:   int octo[2][3][2]={{{3,4},{3,5},{7,6}},{{2,3},{6,7},{9,18}}}  int hello=octo;   nothing works. not with **, *, const, &amp; , etc"}], "tags": [], "owner": {"reputation": 1, "user_id": 5605797, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/f4d1083e8fe07ec8a7a0ad33ff565891?s=128&d=identicon&r=PG", "display_name": "anonpollo", "link": "https://stackoverflow.com/users/5605797/anonpollo"}, "is_accepted": false, "score": -5, "last_activity_date": 1448481025, "creation_date": 1448481025, "answer_id": 33925257, "question_id": 33925045, "link": "https://stackoverflow.com/questions/33925045/how-to-point-to-an-entire-array/33925257#33925257", "title": "how to point to an entire array", "body": "<pre><code>const char* banana[3]={\"sweet\",\"yellow\",\"fruit\"};\nconst char* orange[3]={\"juicy\",\"orange\",\"fruit\"};\nconst char** food = banana;\ncout &lt;&lt; food[2] &lt;&lt; endl;    // \"fruit\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5605706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d623ddb1746b392c215f6b06f44a5f?s=128&d=identicon&r=PG&f=1", "display_name": "Franc39", "link": "https://stackoverflow.com/users/5605706/franc39"}, "edited": false, "score": 0, "creation_date": 1448487117, "post_id": 33925470, "comment_id": 55614443, "body": "good, but i dotn understand u create an array pointer ? when we use * , it means a pointer.  so you point *banana to these strings , then you point another variable to that pointer..."}], "tags": [], "owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "is_accepted": false, "score": 3, "last_activity_date": 1448481859, "creation_date": 1448481859, "answer_id": 33925470, "question_id": 33925045, "link": "https://stackoverflow.com/questions/33925045/how-to-point-to-an-entire-array/33925470#33925470", "title": "how to point to an entire array", "body": "<blockquote>\n  <p>how do we use a new variable, that will be an array itself, and will be assigned all the values from another array ? </p>\n</blockquote>\n\n<p>Don't. Create a <em>pointer</em>, which will <em>point</em> to the array. Avoid copying!</p>\n\n<p>Say you have these two arrays (whose types I have corrected, to be <code>const char *</code>).Then create a <em>pointer</em> to char*, and point it at one of the other arrays. Remember, an array degrades to a pointer.</p>\n\n<p>Now use it, remembering that arrays start at index 0.:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nconst char *banana[3] = {\"sweet\",\"yellow\",\"fruit\"};\nconst char *orange[3] = {\"juicy\",\"orange\",\"fruit\"};\n\nconst char **food = banana;\n\nint main(void)\n{\n    printf(\"%s\\n\", food[1]);\n    return 0;\n}\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>yellow\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5605706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7d623ddb1746b392c215f6b06f44a5f?s=128&d=identicon&r=PG&f=1", "display_name": "Franc39", "link": "https://stackoverflow.com/users/5605706/franc39"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1448485052, "creation_date": 1448480211, "last_edit_date": 1448481198, "question_id": 33925045, "link": "https://stackoverflow.com/questions/33925045/how-to-point-to-an-entire-array", "title": "how to point to an entire array", "body": "<p>how do we use a new variable, that will be an array itself, and will be assigned all the values from another array ? ( on call )</p>\n\n<p>like for example:</p>\n\n<p>a variable myfood is mine.</p>\n\n<p>there is multiples choices it can become : banana, orange, etc....</p>\n\n<pre><code>char banana[3]={\"sweet\",\"yellow\",\"fruit\"};\nchar orange[3]={\"juicy\",\"orange\",\"fruit\"};\n</code></pre>\n\n<p>now , the food i have on me is now a banana. so what i want is:</p>\n\n<pre><code>int myfood= banana;\n</code></pre>\n\n<p>but it dont work.....</p>\n\n<pre><code>int myfood[]=banana[]; //dont work either\n\nint *myfood\n\nmyfood=&amp;banana;\n\nprintf(myfood[2]); -------&gt; should equal to 'yellow';\n</code></pre>\n\n<p>all of that dont work. </p>\n\n<p>because im making a big project. I have to pass on parameters depending on the thing u currently use.</p>\n\n<p>so a variable is use, and it will be assigned the correct array depending of which thing you own ( it could be a banana, an apple, etc )..</p>\n\n<p>thanks</p>\n"}, {"tags": ["c", "hash", "md5", "nettle"], "answers": [{"tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": true, "score": 0, "last_activity_date": 1448480721, "creation_date": 1448480721, "answer_id": 33925177, "question_id": 33924952, "link": "https://stackoverflow.com/questions/33924952/why-is-my-md5-hash-static-for-the-whole-process/33925177#33925177", "title": "Why is my MD5 Hash static for the whole process?", "body": "<p><code>snprintf</code> takes the value argument. You are giving it a pointer, and it prints the <em>pointer</em>. Try</p>\n\n<pre><code>        snprintf(md5 + (i * 8), 9, \"%08X\", *(int *) (md5raw + (i * 4)));\n</code></pre>\n"}], "owner": {"reputation": 805, "user_id": 3618509, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2ebf555307f721af722397544de00285?s=128&d=identicon&r=PG&f=1", "display_name": "JavaProphet", "link": "https://stackoverflow.com/users/3618509/javaprophet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 33925177, "answer_count": 1, "score": 1, "last_activity_date": 1448480721, "creation_date": 1448479827, "question_id": 33924952, "link": "https://stackoverflow.com/questions/33924952/why-is-my-md5-hash-static-for-the-whole-process", "title": "Why is my MD5 Hash static for the whole process?", "body": "<p>I'm using nettle for MD5 hashing(I also tried SHA1 with the same issue). Whenever I hash anything, the hash is always the same, even for radically different lengths and data.</p>\n\n<pre><code>    if (rs.response-&gt;body != NULL &amp;&amp; rs.response-&gt;body-&gt;len &gt; 0) { // body is a unsigned char*, len is a size_t, I have verified both here with a printf.\n        struct md5_ctx md5ctx;\n        md5_init(&amp;md5ctx);\n        md5_update(&amp;md5ctx, rs.response-&gt;body-&gt;len, rs.response-&gt;body-&gt;data);\n        unsigned char md5raw[16];\n        md5_digest(&amp;md5ctx, 16, md5raw);\n        char md5[33];\n        md5[32] = 0;\n        for (int i = 0; i &lt; 4; i++) {\n            snprintf(md5 + (i * 8), 9, \"%08X\", md5raw + (i * 4));\n        }\n        printf(\"%s\\n\", md5);\n    }\n</code></pre>\n\n<p>I've verified that they are different values, valgrind reports no invalid reads/writes, etc. The hash changes when I restart the process, but is never different during the process.</p>\n"}, {"tags": ["c", "floating-point", "nan"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1448480485, "post_id": 33924866, "comment_id": 55611142, "body": "Are you still trying to find a way to optimize <code>isnan()</code>? Have you really benchmarked your application and discovered that this is the bottleneck?"}], "answers": [{"comments": [{"owner": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "edited": false, "score": 3, "creation_date": 1448480294, "post_id": 33924955, "comment_id": 55611031, "body": "I think your last point is key. <code>x != x</code> works for IEEE 754 floating point, but IEEE 754 is not mandated. Even existence of <code>NaN</code> itself is not guaranteed."}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "edited": false, "score": 2, "creation_date": 1448513792, "post_id": 33924955, "comment_id": 55622324, "body": "Does <code>isnan(x)</code> actually tell you, accurately, whether <code>x</code> is NaN on those platforms where <code>x != x</code> doesn&#39;t work for the same purpose?  I&#39;m imagining a compiler generating two different pieces of code for computing <code>x</code>; one for the <code>isnan(x)</code> call and one for whatever you&#39;re using it for inside that conditional."}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "edited": false, "score": 1, "creation_date": 1448514087, "post_id": 33924955, "comment_id": 55622415, "body": "Put another way, is there a program using the folliowing function <code>f</code> that causes <code>f</code> to print out &quot;0 is NaN&quot; when built with such a compiler and then run?  <code>void f(double x) { if (x != x) printf(&quot;%f is NaN\\n&quot;); }</code>"}], "tags": [], "owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "is_accepted": false, "score": 9, "last_activity_date": 1448480785, "last_edit_date": 1448480785, "creation_date": 1448479848, "answer_id": 33924955, "question_id": 33924866, "link": "https://stackoverflow.com/questions/33924866/is-x-x-a-portable-way-to-test-for-nan/33924955#33924955", "title": "Is `x!=x` a portable way to test for NaN?", "body": "<p>NaN as the only value <code>x</code> with the property <code>x!=x</code> is an IEEE 754 guarantee. Whether it is a faithful test to recognize <code>NaN</code> in C boils down to how closely the representation of variables and the operations are mapped to IEEE 754 formats and operations in the compiler(s) you intend to use.</p>\n\n<p>You should in particular worry about \u201cexcess precision\u201d and the way compilers deal with it. Excess precision is what happens when the FPU only conveniently supports computations in a wider format than the compiler would like to use for <code>float</code> and <code>double</code> types. In this case computations can be made at the wider precision, and rounded to the type's precision when the compiler feels like it in an unpredictable way.</p>\n\n<p>The C99 standard defined a way to handle this excess precision that preserved the property that only NaN was different from itself, but for a long time after 1999 (and even nowadays when the compiler's authors do not care), in presence of excess precision, <code>x != x</code> could possibly be true for any variable <code>x</code> that contains the finite result of a computation, if the compiler chooses to round the excess-precision result of the computation in-between the evaluation of the first <code>x</code> and the second <code>x</code>.</p>\n\n<p>This <a href=\"http://arxiv.org/abs/cs/0701192\" rel=\"noreferrer\">report</a> describes the dark times of compilers that made no effort to implement C99 (either because it wasn't 1999 yet or because they didn't care enough).</p>\n\n<p>This <a href=\"https://gcc.gnu.org/ml/gcc-patches/2008-11/msg00105.html\" rel=\"noreferrer\">2008 post</a> describes how GCC started to implement the C99 standard for excess precision in 2008. Before that, GCC could provide one with all the surprises described in the aforementioned report.</p>\n\n<p>Of course, if the target platform does not implement IEEE 754 at all, a NaN value may not even exist, or exist and have different properties than specified by IEEE 754. The common cases are a compiler that implements IEEE 754 quite faithfully with FLT_EVAL_METHOD set to 0, 1 or 2 (all of which guarantee that <code>x != x</code> iff <code>x</code> is NaN), or a compiler with a non-standard implementation of excess precision, where <code>x != x</code> is not a reliable test for NaN.</p>\n"}, {"comments": [{"owner": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "edited": false, "score": 1, "creation_date": 1448480444, "post_id": 33925037, "comment_id": 55611119, "body": "Do implementations actually define <code>__STDC_IEC_559__</code>, or is it like C++ versions where compilers don&#39;t want to claim to be compliant?"}, {"owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "reply_to_user": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "edited": false, "score": 0, "creation_date": 1448480620, "post_id": 33925037, "comment_id": 55611219, "body": "@Adam, valid question! gcc 5.2.1 20151028 does define it, clang 3.5.2-3 does not. For a x86_64-pc-linux-gnu target, that is."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 15468, "user_id": 321772, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c03247f45c9f291391b894375c2709ca?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/321772/adam"}, "edited": false, "score": 3, "creation_date": 1448480741, "post_id": 33925037, "comment_id": 55611287, "body": "@Adam in my experience C compilers may make claim through the definition of symbols that they do not respect in practice, for instance <code>clang -std=c99 -mno-sse2</code> claims <code>FLT_EVAL_METHOD</code> to be zero when it&#39;s not how it actually computes. I didn&#39;t think to check whether it defined <code>__STDC_IEC_559__</code>: <a href=\"http://stackoverflow.com/questions/17663780/is-there-a-document-describing-how-clang-handles-excess-floating-point-precision\" title=\"is there a document describing how clang handles excess floating point precision\">stackoverflow.com/questions/17663780/&hellip;</a>"}], "tags": [], "owner": {"reputation": 23445, "user_id": 416224, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/8dc3ac9987d21288deea853f47d8dd6e?s=128&d=identicon&r=PG&f=1", "display_name": "kay", "link": "https://stackoverflow.com/users/416224/kay"}, "is_accepted": true, "score": 4, "last_activity_date": 1448480186, "last_edit_date": 1592644375, "creation_date": 1448480186, "answer_id": 33925037, "question_id": 33924866, "link": "https://stackoverflow.com/questions/33924866/is-x-x-a-portable-way-to-test-for-nan/33925037#33925037", "title": "Is `x!=x` a portable way to test for NaN?", "body": "<p>Please refer to the normative section <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf#page=525&amp;zoom=auto,-193,767\" rel=\"nofollow noreferrer\">Annex F: IEC 60559 floating-point arithmetic</a> of the C standard:</p>\n<blockquote>\n<h3>F.1  Introduction</h3>\n<p>An implementation that defines <code>__STDC_IEC_559__</code> shall conform to the specifications in this annex.</p>\n<p>Implementations that do not define <code>__STDC_IEC_559__</code> are not required to conform to these specifications.</p>\n</blockquote>\n\n<blockquote>\n<h3>F.9.3 Relational operators</h3>\n<p>The expression <code>x \u2260 x</code> is true if <code>x</code> is a <code>NaN</code>.</p>\n<p>The expression <code>x = x</code> is false if <code>X</code> is a <code>Nan</code>.</p>\n</blockquote>\n\n<blockquote>\n<h3>F.3 Operators and functions</h3>\n<p>The <code>isnan</code> macro in <code>&lt;math.h&gt;</code> provides the <code>isnan</code> function recommended in the Appendix to IEC 60559.</p>\n</blockquote>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 3, "accepted_answer_id": 33925037, "answer_count": 2, "score": 13, "last_activity_date": 1448481065, "creation_date": 1448479541, "last_edit_date": 1495542317, "question_id": 33924866, "link": "https://stackoverflow.com/questions/33924866/is-x-x-a-portable-way-to-test-for-nan", "title": "Is `x!=x` a portable way to test for NaN?", "body": "<p>In C you can test to see if a double if NaN using <code>isnan(x)</code>.  However many places online, including for example this <a href=\"https://stackoverflow.com/a/1923933/2179021\">SO answer</a> say that you can simply use <code>x!=x</code> instead.</p>\n\n<p>Is <code>x!=x</code> in any C specification as a method that is guaranteed to test if x is NaN? I can't find it myself and I would like my code to work with different compilers.</p>\n"}, {"tags": ["c", "struct"], "answers": [{"tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 3, "last_activity_date": 1448478993, "creation_date": 1448478993, "answer_id": 33924727, "question_id": 33924689, "link": "https://stackoverflow.com/questions/33924689/getting-an-error-in-h-file-when-trying-to-compile-it-semi-colon-missing/33924727#33924727", "title": "Getting an error in .h file when trying to compile it. semi-colon missing", "body": "<p>Always declare <code>struct</code> to end with <code>;</code></p>\n\n<pre><code>struct MemPidsData\n{\n    int PID[7];\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": true, "score": 5, "last_activity_date": 1448479006, "creation_date": 1448479006, "answer_id": 33924731, "question_id": 33924689, "link": "https://stackoverflow.com/questions/33924689/getting-an-error-in-h-file-when-trying-to-compile-it-semi-colon-missing/33924731#33924731", "title": "Getting an error in .h file when trying to compile it. semi-colon missing", "body": "<p>You actually have <em>two</em> missing semicolons - it should be:</p>\n\n<pre><code>struct MemPidsData\n{\n    int PID[7];\n}; // &lt;&lt;&lt;\n\nstruct MemInfoData\n{\n    int heater;\n    int pump;\n    int fan;\n    int temperature;\n    int valve;\n}; // &lt;&lt;&lt;\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 4552184, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/467813c0954f974f59bd27245b6e7d62?s=128&d=identicon&r=PG&f=1", "display_name": "Tad Lithuania", "link": "https://stackoverflow.com/users/4552184/tad-lithuania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 33924731, "answer_count": 2, "score": 1, "last_activity_date": 1448479073, "creation_date": 1448478848, "last_edit_date": 1448479073, "question_id": 33924689, "link": "https://stackoverflow.com/questions/33924689/getting-an-error-in-h-file-when-trying-to-compile-it-semi-colon-missing", "title": "Getting an error in .h file when trying to compile it. semi-colon missing", "body": "<pre><code>struct MemPidsData\n{\nint PID[7];\n}\n\nstruct MemInfoData\n{\nint heater;\nint pump;\nint fan;\nint temperature;\nint valve;\n}\n#define MEMORY_NAME_INFO \"InfoMem\" /* Common Memmory */\n#define MEMORY_SIZE_INFO sizeof(struct MemData)\n#define MEMORY_SIZE_PIDS sizeof(struct MemData)\n#define MEMORY_NAME_PIDS \"CommonMem\" /* Common Memmory */\n</code></pre>\n\n<p>I am getting an error that semicolon is missing on the line where struct MemInfoData is defined... Please help..</p>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "edited": false, "score": 0, "creation_date": 1448479400, "post_id": 33924630, "comment_id": 55610579, "body": "On which architecture you are running?"}, {"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "reply_to_user": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "edited": false, "score": 0, "creation_date": 1448482976, "post_id": 33924630, "comment_id": 55612367, "body": "tried on a Intel i7 4700HQ (laptop quadcore) as well as on a 16-core Intel Xeon machine (two sockets of 8-cores). Can you compile, test and tell your speedup?"}, {"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "reply_to_user": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "edited": false, "score": 0, "creation_date": 1448486123, "post_id": 33924630, "comment_id": 55613961, "body": "After doing some diagnostic, I have found that If I put another loop inside, repeating 1000 times the instruction, then I get close to linear speedup. Does someone know if the original SAXPY is known to scale bad for multi-core CPUs ?"}, {"owner": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "edited": false, "score": 0, "creation_date": 1448521662, "post_id": 33924630, "comment_id": 55625165, "body": "The problem is that the algorithm is memory-bound. There is not enough computation for each fetched from memory, therefore the threads are starving for data."}, {"owner": {"reputation": 8381, "user_id": 5239503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MqgeX.jpg?s=128&g=1", "display_name": "Gilles", "link": "https://stackoverflow.com/users/5239503/gilles"}, "edited": false, "score": 1, "creation_date": 1448525931, "post_id": 33924630, "comment_id": 55627094, "body": "See <a href=\"http://stackoverflow.com/q/11576670/5239503\">this question</a> to understand why you will or won&#39;t see any performance improvement for your parallelisation, depending on the machine you run it on."}, {"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "edited": false, "score": 0, "creation_date": 1448656477, "post_id": 33924630, "comment_id": 55686292, "body": "Thanks Gilles, it was a very useful read."}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "edited": false, "score": 0, "creation_date": 1448484817, "post_id": 33925985, "comment_id": 55613291, "body": "I am cheking this give me a second"}, {"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "edited": false, "score": 0, "creation_date": 1448485154, "post_id": 33925985, "comment_id": 55613427, "body": "It was a typo of the question but not of the code, sorry for that. Nevertheless I have fixed the post now. The problem still persists, the performance values are updated because thanks to your post I found a typo on the timer wrongly placed. Still, the problem persists, with very small speedup."}, {"owner": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "reply_to_user": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "edited": false, "score": 1, "creation_date": 1448485806, "post_id": 33925985, "comment_id": 55613775, "body": "Well, you total overall execution time is too small. Consider that spawning threads is an expensive operation and you need enough computation to compensate it. If I compile the program without <code>O3</code> i get linear speedup, I don&#39;t think there is anything wrong with the way you parallelized it."}, {"owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "edited": false, "score": 0, "creation_date": 1448486675, "post_id": 33925985, "comment_id": 55614224, "body": "You are right, I am also getting linear speedup when -O3 is put down. Otherwise, its too little work to note speedup I guess. Many thanks"}], "tags": [], "owner": {"reputation": 1712, "user_id": 1580195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1e6776cfbd877dfd97a6eeffd080c9b?s=128&d=identicon&r=PG&f=1", "display_name": "simpel01", "link": "https://stackoverflow.com/users/1580195/simpel01"}, "is_accepted": true, "score": 1, "last_activity_date": 1448483849, "creation_date": 1448483849, "answer_id": 33925985, "question_id": 33924630, "link": "https://stackoverflow.com/questions/33924630/bad-speedup-on-simple-openmp-saxpy/33925985#33925985", "title": "bad speedup on simple OpenMP saxpy", "body": "<p>You forgot the <code>for</code> in your <code>#pragma omp</code> directive: </p>\n\n<pre><code>#pragma omp parallel for default(none) private(i) shared(a, N, x,y)\n</code></pre>\n\n<p>Without the <code>for</code> there is no work-sharing, each thread is going to iterate throughout the full range [1, N)</p>\n"}], "owner": {"reputation": 306, "user_id": 4412614, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-1XFCaNAJ4J4/AAAAAAAAAAI/AAAAAAAAABc/CaKjA4aESlc/photo.jpg?sz=128", "display_name": "Cristobal Navarro", "link": "https://stackoverflow.com/users/4412614/cristobal-navarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 1, "accepted_answer_id": 33925985, "answer_count": 1, "score": 0, "last_activity_date": 1448485090, "creation_date": 1448478661, "last_edit_date": 1448485090, "question_id": 33924630, "link": "https://stackoverflow.com/questions/33924630/bad-speedup-on-simple-openmp-saxpy", "title": "bad speedup on simple OpenMP saxpy", "body": "<p>I am having trouble getting a simple SAXPY program to scale its performance decently using OpenMP.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;omp.h&gt;\n\nint main(int argc, char** argv){\n    int N = atoi(argv[1]), threads = atoi(argv[2]), i;\n    omp_set_num_threads(threads);\n    double a = 3.141592, *x, *y, t1, t2;\n    x = (double*)malloc(sizeof(double)*N);\n    y = (double*)malloc(sizeof(double)*N);\n\n    for(i = 0; i &lt; N; ++i){\n        x[i] = y[i] = (double)i;\n    }\n\n    t1 = omp_get_wtime();\n    #pragma omp parallel for default(none) private(i) shared(a, N, x,y)\n    for(i = 0; i &lt; N; ++i){\n        y[i] = a*x[i] + y[i];\n    }\n    t2 = omp_get_wtime();\n\n    printf(\"%f secs\\n\", t2-t1);\n}\n</code></pre>\n\n<p>I am compiling as:</p>\n\n<pre><code>gcc main.c -lm -O3 -fopenmp -o prog\n</code></pre>\n\n<p>And the performance I get by for 10M elements is:</p>\n\n<pre><code>threads = 1  0.015097 secs\nthreads = 2  0.013954 secs\n</code></pre>\n\n<p>Any idea what is the problem I am having?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1448479320, "post_id": 33924522, "comment_id": 55610540, "body": "@Eugene Sh. it compiles and gives the result in the answer below. <code>+j</code> is valid syntax."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1448479340, "post_id": 33924522, "comment_id": 55610553, "body": "It is, but why? A typo?"}, {"owner": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "edited": false, "score": 0, "creation_date": 1448479373, "post_id": 33924522, "comment_id": 55610571, "body": "its ++j.it write by mistake.sory"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1448479471, "post_id": 33924522, "comment_id": 55610609, "body": "Why didn&#39;t you copy and paste the <i>actual code</i> instead of typing it up by hand and making mistakes in the process ?"}, {"owner": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1448479684, "post_id": 33924522, "comment_id": 55610728, "body": "@Paul R. actually I write this program from book so this happen."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1448479697, "post_id": 33924522, "comment_id": 55610735, "body": "Solve it with brackets and by splitting up complex expressions into simpler ones.  Code like this is just rubbish and should never be seen outside academia."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1448480418, "post_id": 33924522, "comment_id": 55611105, "body": "@Jayant: OK - well it doesn&#39;t make any difference to the answer in this instance, but please be more careful in future."}, {"owner": {"reputation": 40893, "user_id": 1386054, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/424ZW.jpg?s=128&g=1", "display_name": "Adrian McCarthy", "link": "https://stackoverflow.com/users/1386054/adrian-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448495485, "post_id": 33924522, "comment_id": 55617825, "body": "I&#39;m voting to close this question as off-topic because it&#39;s too localized."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "edited": false, "score": 0, "creation_date": 1448479133, "post_id": 33924633, "comment_id": 55610436, "body": "but ,(m=++i||+j&amp;&amp;++k;) contain &amp;&amp; (AND) operator which having higher precedence than  || (OR ) operator ,so how can we 1st solve OR operator?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1448479345, "post_id": 33924633, "comment_id": 55610556, "body": "The precedence is only telling that it can be rewritten as <code>m=++i || (+j&amp;&amp;++k);</code>. Which is still making the answer valid."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "edited": false, "score": 0, "creation_date": 1448479555, "post_id": 33924633, "comment_id": 55610647, "body": "@Jayant look up &quot;shortcut operators&quot;."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448479574, "post_id": 33924633, "comment_id": 55610658, "body": "@WeatherVane: ITYM <i>short circuit</i> operators ?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "edited": false, "score": 0, "creation_date": 1448479709, "post_id": 33924633, "comment_id": 55610747, "body": "I guess so Paul;) @Jayant the <code>&amp;&amp;</code> has precedence over <code>||</code> but that applies to the second and third operands: the first is still evaluated before the next pair, which won&#39;t be evaluated at all in this case."}, {"owner": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "edited": false, "score": 0, "creation_date": 1448480917, "post_id": 33924633, "comment_id": 55611358, "body": "@ Weather Vane, how can we understand that ()bracket given to which term  (++i || ++j ) &amp;&amp;++k; or ++i || (++j &amp;&amp; ++k ) while finding output on paper ."}], "tags": [], "owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1472347242, "last_edit_date": 1472347242, "creation_date": 1448478673, "answer_id": 33924633, "question_id": 33924522, "link": "https://stackoverflow.com/questions/33924522/how-to-solve-this-logical-expression/33924633#33924633", "title": "How to solve this logical expression?", "body": "<p><code>++i</code> increments the value of <code>i</code> from -3 to -2, which is true, so the remaining expression is not evaluated, and the result of the expression is true (1). Hence:</p>\n\n<pre><code>i = -2, j = 2, k = 0, m = 1\n</code></pre>\n\n<p><a href=\"http://ideone.com/TLDuqw\" rel=\"nofollow\">Live Demo</a></p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": true, "score": 1, "last_activity_date": 1448480800, "creation_date": 1448480800, "answer_id": 33925202, "question_id": 33924522, "link": "https://stackoverflow.com/questions/33924522/how-to-solve-this-logical-expression/33925202#33925202", "title": "How to solve this logical expression?", "body": "<p>Both <code>||</code> and <code>&amp;&amp;</code> force left to right operation.  Both fully evaluate their LHS operand and apply any side effects before evaluating the RHS.  Both <em>short-circuit</em>; if the result of the expression can be determined from the LHS, the RHS is not evaluated at all.</p>\n\n<p>For <code>||</code>, if the LHS evaluates to a non-zero value, then the RHS is not evaluated (<code>true OR x</code> is always <code>true</code>).</p>\n\n<p>For <code>&amp;&amp;</code>, if the LHS evaluates to a zero value, then the RHS is not evaluated (<code>false AND x</code> is always <code>false</code>).</p>\n\n<p><code>&amp;&amp;</code> has higher precedence than <code>||</code>, which has higher precedence than assignment, so the expression is <em>parsed</em> as</p>\n\n<pre><code>m = (++i || (++j &amp;&amp; ++k ))\n</code></pre>\n\n<p>and <em>evaluated</em> as follows:</p>\n\n<ol>\n<li><code>++i</code> is evaluated first (<code>||</code> forces left-to-right evaluation) and the side effect of incrementing <code>i</code> is applied;</li>\n<li>Since <code>i</code> is initially <code>-3</code>, <code>++i</code> evaluates to <code>-2</code>;</li>\n<li>Since <code>++i</code> evaluates to a non-zero value, the RHS expression <code>++j &amp;&amp; ++k</code> is not evaluated at all<sup>1</sup>;</li>\n<li>The result of an operation involving <code>||</code> or <code>&amp;&amp;</code> is a boolean value (either <code>0</code> or <code>1</code>) - since <code>++i</code> is non-zero, <code>++i || ++j &amp;&amp; ++k</code> evaluates to 1;</li>\n<li><code>1</code> is assigned to <code>m</code>.</li>\n</ol>\n\n<p>So, by the time all of this is done, the following are true:</p>\n\n<pre><code>i == -2\nj == 2  // unchanged\nk == 0  // unchanged\nm == 1\n</code></pre>\n\n<p><hr>\n<sup>1.  If <code>++i</code> had evaluated to <code>0</code>, then <code>++j &amp;&amp; ++k</code> would have been evaluated by evaluating <code>++j</code> first, and if the result was non-zero, evaluating <code>++k</code>.<br>\n</sup></p>\n"}], "owner": {"reputation": 1, "user_id": 5605548, "user_type": "registered", "profile_image": "https://graph.facebook.com/890740061003025/picture?type=large", "display_name": "Jayant ", "link": "https://stackoverflow.com/users/5605548/jayant"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "closed_date": 1448514693, "accepted_answer_id": 33925202, "answer_count": 2, "score": -4, "last_activity_date": 1472347242, "creation_date": 1448478284, "last_edit_date": 1448478927, "question_id": 33924522, "link": "https://stackoverflow.com/questions/33924522/how-to-solve-this-logical-expression", "closed_reason": "Needs more focus", "title": "How to solve this logical expression?", "body": "<p>Please tell how to solve it by associativity and precedence:</p>\n\n<pre><code>   #include&lt;stdio.h&gt;\n\n   int main()\n   {\n       int i=-3,j=2,k=0,m;\n       m=++i||+j&amp;&amp;++k;\n       printf(\"%d %d %d %d\",i,j,k,m);\n       return 0;\n   }\n</code></pre>\n"}, {"tags": ["c", "list", "linux-kernel"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1448532548, "post_id": 33933344, "comment_id": 55631336, "body": "You may also refer to this answer: <a href=\"http://stackoverflow.com/questions/33850930/correct-way-to-join-two-double-linked-list/\" title=\"correct way to join two double linked list\">stackoverflow.com/questions/33850930/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2945, "user_id": 216142, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1bae18aebc08108ae3c9b58f45407e0d?s=128&d=identicon&r=PG", "display_name": "Colin Newell", "link": "https://stackoverflow.com/users/216142/colin-newell"}, "is_accepted": false, "score": 1, "last_activity_date": 1448476854, "creation_date": 1448476854, "answer_id": 33933345, "question_id": 33933344, "link": "https://stackoverflow.com/questions/33933344/adding-items-to-a-linux-kernel-linked-list/33933345#33933345", "title": "Adding items to a Linux kernel linked list", "body": "<p>It looks like all the memory has been allocated by you at that point, so all it's really doing is hooking up the pointers which are already allocated.</p>\n\n<p>The memory is already there, all it's doing is filling it in so there isn't any real way it can fail.</p>\n"}, {"comments": [{"owner": {"reputation": 520, "user_id": 4683339, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/K4VLT.png?s=128&g=1", "display_name": "Vishal Sahu", "link": "https://stackoverflow.com/users/4683339/vishal-sahu"}, "edited": false, "score": 0, "creation_date": 1448488852, "post_id": 33933346, "comment_id": 55626683, "body": "Thanks Andreas for elaborate explanation. I had completely missed that point that I&#39;ve already allocated node containing list_head in it. Anyways your answer gave me lot more information."}, {"owner": {"reputation": 563, "user_id": 11108302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/980ee04a3bcbba679fbc594352465b29?s=128&d=identicon&r=PG&f=1", "display_name": "memememe", "link": "https://stackoverflow.com/users/11108302/memememe"}, "edited": false, "score": 0, "creation_date": 1593322618, "post_id": 33933346, "comment_id": 110735938, "body": "Great answer, but why do you pass <code>head</code> which is already <code>&amp;list_of_somethings.next</code> to <code>list_for_each</code> which starts from <code>pos=(head)-&gt;next</code>? Wouldn&#39;t we miss the first element? I guess the correct thing would be to pass <code>&amp;list_of_somethings</code> as <code>head</code> to the <code>list_for_each</code>."}, {"owner": {"reputation": 688, "user_id": 3426780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VAnc3.jpg?s=128&g=1", "display_name": "Andreas Wiese", "link": "https://stackoverflow.com/users/3426780/andreas-wiese"}, "edited": false, "score": 0, "creation_date": 1593896788, "post_id": 33933346, "comment_id": 110939318, "body": "It&#39;s simply the list&#39;s semantic, as I tried to express in the last paragraph: the &quot;first&quot; element of the list usually isn&#39;t part of the list but only a sole <code>struct list_head</code> holding the list (i.e. some <code>struct list_head</code>-typed member of another superordinate object containing this list)."}], "tags": [], "owner": {"reputation": 688, "user_id": 3426780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VAnc3.jpg?s=128&g=1", "display_name": "Andreas Wiese", "link": "https://stackoverflow.com/users/3426780/andreas-wiese"}, "is_accepted": true, "score": 14, "last_activity_date": 1448487910, "creation_date": 1448487910, "answer_id": 33933346, "question_id": 33933344, "link": "https://stackoverflow.com/questions/33933344/adding-items-to-a-linux-kernel-linked-list/33933346#33933346", "title": "Adding items to a Linux kernel linked list", "body": "<p>The <code>list</code> API does not dynamically allocate any memory.  I found this thing a bit puzzling, myself.  Problem here is that Linux is written in C, not C++, but implements things in a quite object-oriented way, but in C it looks like inside out.  It works as follows (this applies to several other Linux APIs, too, e.g. <code>kobj</code>):</p>\n\n<p>You define some <code>struct</code>, which should be member of a list.  In opposite of how you would usually think of linked lists, this object won't be put into the list by allocating some opaque list item and have a pointer pointing to your actual object, you make <code>struct list_head</code> an actual a <em>member</em> of your <code>struct</code>:</p>\n\n<pre><code>struct something {\n    struct list_head list;\n    uint8_t some_datum;\n    uint16_t some_other_datum;\n    void *a_pointer;\n};\n</code></pre>\n\n<p>Your list will be some <em>standalone</em> <code>struct list_head</code>:</p>\n\n<pre><code>static LIST_HEAD(list_of_somethings);\n</code></pre>\n\n<p>To add elements to <code>list_of_somethings</code> you now would do something like</p>\n\n<pre><code>struct something *s = kmalloc(sizeof(*s), GFP_KERNEL);\ns-&gt;some_datum = 23;\ns-&gt;some_other_datum = 0xdeadbeef;\ns-&gt;a_pointer = current;\nlist_add(&amp;s-&gt;list, &amp;list_of_somethings);\n</code></pre>\n\n<p>In other words, you have the element allocated already.  This looks completely weird, but is elegant as f*ck.  This \"design-pattern\" allows to have type-opaque lists in C, which would not be easy to do in another way: A list on its own is just a bunch of <code>struct list_head</code>s pointing to each other.  As you know which actual <code>struct</code> you are expeting as a programmer, you know which element of this <code>struct</code> is the actual <code>list_head</code> and can use the <code>container_of</code> macro to get the pointer to the eventual <code>struct</code> you put into the list:</p>\n\n<pre><code>struct list_head *p = &amp;list_of_somethings.next;\nstruct something *s = container_of(p, struct something, list);\npr_notice(\"some data = %i\\n\", s-&gt;some_data);\n</code></pre>\n\n<p>Notice that the actual <code>struct list_head</code> representing the list itself is handled specially by the iteration macros defined in <code>&lt;linux/list.h&gt;</code>, i.e.</p>\n\n<pre><code>#define list_for_each(pos, head) \\\n        for (pos = (head)-&gt;next; pos != (head); pos = pos-&gt;next)\n</code></pre>\n\n<p>The address of <code>list_of_somethings</code> will be used to determine whether iterating reached the end of the list (or actually the list-object again).\nThis is also the reason, why an empty list is defined as having <code>next</code> and <code>prev</code> point to the <code>struct list_head</code> itself.</p>\n\n<p>I needed some time to wrap my head around this, too. ;)</p>\n"}], "migrated_from": {"other_site": {"aliases": ["http://linux.stackexchange.com"], "markdown_extensions": ["Prettify"], "launch_date": 1294871917, "open_beta_date": 1282071600, "closed_beta_date": 1281466800, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon@2.png", "favicon_url": "https://cdn.sstatic.net/Sites/unix/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/unix/Img/apple-touch-icon.png", "audience": "users of Linux, FreeBSD and other Un*x-like operating systems", "site_url": "https://unix.stackexchange.com", "api_site_parameter": "unix", "logo_url": "https://cdn.sstatic.net/Sites/unix/Img/logo.png", "name": "Unix &amp; Linux", "site_type": "main_site"}, "on_date": 1448525040, "question_id": 245488}, "owner": {"reputation": 520, "user_id": 4683339, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/K4VLT.png?s=128&g=1", "display_name": "Vishal Sahu", "link": "https://stackoverflow.com/users/4683339/vishal-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5357, "favorite_count": 2, "accepted_answer_id": 33933346, "answer_count": 2, "score": 5, "last_activity_date": 1569868893, "creation_date": 1448476436, "last_edit_date": 1569868893, "question_id": 33933344, "link": "https://stackoverflow.com/questions/33933344/adding-items-to-a-linux-kernel-linked-list", "title": "Adding items to a Linux kernel linked list", "body": "<p>I am using <code>linux/list.h</code> in my code for implementing queue/stack behavior. The API for adding at head/tail is as below:</p>\n\n<pre><code>static inline void list_add(struct list_head *new, struct list_head *head)\n{\n         __list_add(new, head, head-&gt;next);\n}\n</code></pre>\n\n<p>Similar is for <code>list_add_tail</code>. Surprisingly, it returns nothing (<code>void</code>), so does it mean that addition to list in kernel using this API is always successful. I know that there is no concept of <em>full</em> here but what if memory allocation for new node is not available and other possible reasons?</p>\n"}, {"tags": ["c", "windows", "command-line", "mingw"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 3, "creation_date": 1448476105, "post_id": 33923908, "comment_id": 55608736, "body": "Check your <code>$PATH</code> variable. Is the directory <code>gcc.exe</code> is located in included in there? If not, add it. And <b>do some research first</b>. I bet there&#39;s information on that on the Internet."}, {"owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448478075, "post_id": 33923908, "comment_id": 55609834, "body": "I had PATH set to Java SDK. Now I changed it to MinGW. I can&#39;t add two PATH. Is it not possible to use both Java compiler and gcc compiler on the same computer?"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1448478143, "post_id": 33923908, "comment_id": 55609872, "body": "Of course it is. There should be many more paths listed in <code>$PATH</code> than just these two. Don&#39;t change it but <b>append a semicolon and behind that the path to the executable</b>."}, {"owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448478537, "post_id": 33923908, "comment_id": 55610108, "body": "Ok got it. Just need to use ; and add directories to other compilers: C:/compilerA/bin/;C:/compilerB/bin/"}, {"owner": {"reputation": 709, "user_id": 1879252, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/632e002a39e131007a7027386557ad1a?s=128&d=identicon&r=PG&f=1", "display_name": "Elliott de Launay", "link": "https://stackoverflow.com/users/1879252/elliott-de-launay"}, "edited": false, "score": 0, "creation_date": 1594571188, "post_id": 33923908, "comment_id": 111165924, "body": "for me I needed to remove the trailing backslash::: <code>C:\\MinGW\\bin</code> worked instead of <code>C:\\MinGW\\bin\\ </code>"}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 11650254, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IvOlp.png?s=128&g=1", "display_name": "Grzegorz Krug", "link": "https://stackoverflow.com/users/11650254/grzegorz-krug"}, "edited": false, "score": 1, "creation_date": 1618148218, "post_id": 33924719, "comment_id": 118508787, "body": "Link is outdated, Mingw is also hard to find. Next time post short description from external page to avoid suchs situations"}], "tags": [], "owner": {"reputation": 811, "user_id": 4554700, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/WLOyw.jpg?s=128&g=1", "display_name": "Sahil Arora", "link": "https://stackoverflow.com/users/4554700/sahil-arora"}, "is_accepted": true, "score": 2, "last_activity_date": 1448478983, "creation_date": 1448478983, "answer_id": 33924719, "question_id": 33923908, "link": "https://stackoverflow.com/questions/33923908/after-installing-mingw-gcc-command-is-not-recognized/33924719#33924719", "title": "After installing minGW, gcc command is not recognized", "body": "<p>You are missing on <code>Path Variable</code> settings. Refer the 'Environment Settings' section on this page :</p>\n\n<p><a href=\"http://www.mingw.org/wiki/Getting_Started\" rel=\"nofollow\">http://www.mingw.org/wiki/Getting_Started</a></p>\n"}], "owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16418, "favorite_count": 0, "accepted_answer_id": 33924719, "answer_count": 1, "score": 2, "last_activity_date": 1524519532, "creation_date": 1448476033, "last_edit_date": 1453955484, "question_id": 33923908, "link": "https://stackoverflow.com/questions/33923908/after-installing-mingw-gcc-command-is-not-recognized", "title": "After installing minGW, gcc command is not recognized", "body": "<p>I have installed minGW, and I have a file \"test.c\".</p>\n\n<p>I typed <code>gcc test.c -o demo</code> at the command prompt, while in the directory where I saved the \"test.c\" file. But it didn't work; I got this message:</p>\n\n<blockquote>\n  <p>gcc is not recognized as internal or external command, operable program or batch file</p>\n</blockquote>\n\n<p>How do I make the <code>gcc</code> command work on Windows with minGW?</p>\n"}, {"tags": ["c", "function", "recursion", "stack-overflow"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448475464, "post_id": 33923705, "comment_id": 55608348, "body": "Maybe it is called too often; every call to a function generates a seperate stack frame on, well, the stack. Then it&#39;s probably time to find a better algorithm."}, {"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448475554, "post_id": 33923705, "comment_id": 55608409, "body": "The thing is, I got this algorithm from my teacher."}], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448475665, "post_id": 33923743, "comment_id": 55608471, "body": "I found that I missed multiplying by X once, would that fix it?"}, {"owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "reply_to_user": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448475808, "post_id": 33923743, "comment_id": 55608558, "body": "doubt it,  As long as the value for n is not altered and &gt; 1, it will recurse forever"}, {"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448476104, "post_id": 33923743, "comment_id": 55608734, "body": "Since I know for sure the picture of the algorithm is right (got it from my teacher), where am I mistaken when translating it to C?"}, {"owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "reply_to_user": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448477425, "post_id": 33923743, "comment_id": 55609449, "body": "I think it&#39;s your use of the &quot;double recursion&quot;.  See answer update above"}], "tags": [], "owner": {"reputation": 2384, "user_id": 4624683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39130cd702675dc4f741e62e64479eb6?s=128&d=identicon&r=PG&f=1", "display_name": "DBug", "link": "https://stackoverflow.com/users/4624683/dbug"}, "is_accepted": false, "score": 5, "last_activity_date": 1448477581, "last_edit_date": 1448477581, "creation_date": 1448475521, "answer_id": 33923743, "question_id": 33923705, "link": "https://stackoverflow.com/questions/33923705/why-does-my-recursive-function-in-c-cause-a-stack-overflow/33923743#33923743", "title": "Why does my recursive function in C cause a stack overflow?", "body": "<p>The recursive calls always pass 2 as n, so they will always trigger another recursive call.</p>\n\n<p>I think you misinterpreted the formula.  I would interpret it as:</p>\n\n<pre><code>else if (n % 2 == 0) {\n    double v = power_adapted(x, n / 2);\n    return v * v;\n}\nelse {\n    double v = power_adapted(x, (n - 1) / 2);\n    return x * (v * v);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448475873, "post_id": 33923811, "comment_id": 55608599, "body": "I&#39;m sure the algorithm (picture in question) is right (got it from my teacher). How is my code not a translation of that? I can&#39;t seem to find my mistake."}, {"owner": {"reputation": 3642, "user_id": 3371101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeb77c0b3ce0a8041fa92a4fcd5af850?s=128&d=identicon&r=PG&f=1", "display_name": "codingEnthusiast", "link": "https://stackoverflow.com/users/3371101/codingenthusiast"}, "reply_to_user": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448476157, "post_id": 33923811, "comment_id": 55608760, "body": "Change the outer <code>power_adapted</code> call to <code>pow</code> which is a function of <code>math.h</code> or add a base case for <code>n == 2</code> to return <code>x * x</code>."}, {"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448476302, "post_id": 33923811, "comment_id": 55608845, "body": "I will try to add that base case (I&#39;m not allowed to use math.h). Could you tell my anyway where I made my mistake when translating that screenshot to C?"}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "reply_to_user": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 1, "creation_date": 1448476371, "post_id": 33923811, "comment_id": 55608883, "body": "@MartijnLuyckx The screenshot is also &quot;wrong&quot; for the same reason. Perhaps your teacher wanted you to solve the error, perhaps it&#39;s just badly-expressed. Either way the algorithm in the image assumes you have a separate way of handling x^2."}, {"owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "edited": false, "score": 0, "creation_date": 1448476395, "post_id": 33923811, "comment_id": 55608892, "body": "Thanks! Marked as corrrect"}], "tags": [], "owner": {"reputation": 3642, "user_id": 3371101, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eeb77c0b3ce0a8041fa92a4fcd5af850?s=128&d=identicon&r=PG&f=1", "display_name": "codingEnthusiast", "link": "https://stackoverflow.com/users/3371101/codingenthusiast"}, "is_accepted": true, "score": 3, "last_activity_date": 1448476273, "last_edit_date": 1592644375, "creation_date": 1448475708, "answer_id": 33923811, "question_id": 33923705, "link": "https://stackoverflow.com/questions/33923705/why-does-my-recursive-function-in-c-cause-a-stack-overflow/33923811#33923811", "title": "Why does my recursive function in C cause a stack overflow?", "body": "<p>I don't think what you're trying to accomplish makes sense.</p>\n<p>If you take a look at this part of code,</p>\n<pre><code>else if (n % 2 == 0)\n    return power_adapted(power_adapted(x, n / 2), 2);\nelse\n    return power_adapted(power_adapted(x, (n - 1) / 2), 2);\n</code></pre>\n<p>While the nested calls <em>may</em> present no problem (as a statement), the call on the outside always has <code>n = 2</code> and the base cases depend on <code>n</code>.</p>\n<h3>Solving the problem:</h3>\n<p>By taking a look at the formula provided, I think you should have a base case for <code>n == 2</code> to return <code>x * x</code> (this is the simplest change to the algorithm). So, the algorithm could be stated as follows:</p>\n<pre><code>double power_adapted(double x, int n) {\n    if (n == 0)\n        return 1;\n    else if (n == 1)\n        return x;\n    else if (n == 2)\n        return x * x;\n    else if (n % 2 == 0)\n        return power_adapted(power_adapted(x, n / 2), 2);\n    else\n        return x * power_adapted(power_adapted(x, (n - 1) / 2), 2);\n}\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 5542531, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X62a1.jpg?s=128&g=1", "display_name": "Martijn Luyckx", "link": "https://stackoverflow.com/users/5542531/martijn-luyckx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 33923811, "answer_count": 2, "score": 2, "last_activity_date": 1448477779, "creation_date": 1448475376, "last_edit_date": 1495541710, "question_id": 33923705, "link": "https://stackoverflow.com/questions/33923705/why-does-my-recursive-function-in-c-cause-a-stack-overflow", "title": "Why does my recursive function in C cause a stack overflow?", "body": "<p>I'm trying to make a function calculating x to the power n (where x could be a double, n must be an <code>int</code>). A recursive algorithm would be <a href=\"https://i.imgur.com/8MVgj8H.png\" rel=\"nofollow noreferrer\">this one</a>, but implementing it in C gave me the stack-overflow error.</p>\n\n<p>I tried finding my answer here, but the closest I found was <a href=\"https://stackoverflow.com/questions/213042/how-do-you-do-exponentiation-in-c/213897\">this</a>, which didn't satisfy my needs.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>double power_adapted(double x, int n) {\n    if (n == 0)\n        return 1;\n    else if (n == 1)\n        return x;\n    else if (n % 2 == 0)\n        return power_adapted(power_adapted(x, n / 2), 2);\n    else\n        return x * power_adapted(power_adapted(x, (n - 1) / 2), 2);\n}\n</code></pre>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1448475691, "post_id": 33923697, "comment_id": 55608489, "body": "You are calling <code>buf = (char *)malloc(MAX_LEN);</code>, but I do not see a <code>free()</code> statement anywhere.  Are you calling it?"}, {"owner": {"reputation": 61, "user_id": 3242431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/824210130/picture?type=large", "display_name": "user3242431", "link": "https://stackoverflow.com/users/3242431/user3242431"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1448475819, "post_id": 33923697, "comment_id": 55608565, "body": "@ryyker Yes, i call free(buf) outside the while loop, after all the counting is done."}, {"owner": {"reputation": 61, "user_id": 3242431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/824210130/picture?type=large", "display_name": "user3242431", "link": "https://stackoverflow.com/users/3242431/user3242431"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1448476082, "post_id": 33923697, "comment_id": 55608726, "body": "@user3121023 Yes, that solves the problem! I&#39;ve been careless. Thanks!"}], "owner": {"reputation": 61, "user_id": 3242431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/824210130/picture?type=large", "display_name": "user3242431", "link": "https://stackoverflow.com/users/3242431/user3242431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448476251, "creation_date": 1448475354, "last_edit_date": 1448476251, "question_id": 33923697, "link": "https://stackoverflow.com/questions/33923697/getting-error-when-try-to-repeatedly-read-lines-from-file-using-the-same-buffer", "title": "Getting error when try to repeatedly read lines from file using the same buffer and file pointer", "body": "<p>Here is my code:</p>\n\n<pre><code>int countTrans(FILE *fp, char *buf, int sesid){\n  char str[10];\n  int count = 0;\n  size_t len;\n\n  sprintf(str, \"A%d:\", sesid);\n  while(-1 != getline(&amp;buf, &amp;len, fp)){\n    if('T' == buf[0]){\n      if(strstr(buf, str))\n        count++;\n    }\n  }\n  return count; \n}\n\n\nint main(int argc, char **argv){\n  FILE *ifp, *ofp;\n  char *buf;\n  size_t len;\n  int count = 0, i = MAX_RAND;  // MAX_RAND = 200\n  ...\n  if(!(ifp = fopen(argv[1], \"r\"))){\n    fprintf(stderr, \"Can't open input file %s. Exit\\n\\n\", argv[1]);\n    exit(1);\n  }\n  buf = (char *)malloc(MAX_LEN);\n\n  while(i){\n    countTrans(ifp, buf, rand() % MAX_TRANS);\n    i--;\n    rewind(ifp);\n  }\n  ...\n</code></pre>\n\n<p>My purpose is to get a random session id, search that session id in a text file, and count how many time it appears, in a while loop which repeats 200 times. After the first time i malloc space for the buffer buf, i just keep passing it to the function countTrans() along with the same file pointer. </p>\n\n<p>It compiles OK, and runs for about 10 iterations until i get this error: </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>getTrans(1516,0x7fff7885d300) malloc: *** error for object 0x101b2d000: pointer being realloc'd was not allocated\n\n*** set a breakpoint in malloc_error_break to debug\n\nAbort trap: 6\n</code></pre>\n\n<p>i've checked other similar posts, most of them involve using realloc() but my code doesn't. And it seems the error occurred after the completion of the last successful countTrans() and before the start of a new iteration of countTrans(). \nDo i get a memory leak problem? </p>\n\n<p>UPDATE:</p>\n\n<p>It's a careless mistake. I forgot to initialize len inside countTrans() which should be:</p>\n\n<pre><code>  size_t len = MAX_LEN;\n</code></pre>\n\n<p>And the problem is solved. Thanks user3121023 for pointing that out.</p>\n"}, {"tags": ["c", "linux", "debugging", "ubuntu", "gdb"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1448475053, "post_id": 33923576, "comment_id": 55608122, "body": "Just use <code>numArray</code> in your code."}, {"owner": {"reputation": 83, "user_id": 4176019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a0be3e138c24c09f82b939ccc0ee7a?s=128&d=identicon&r=PG&f=1", "display_name": "jhschwartz", "link": "https://stackoverflow.com/users/4176019/jhschwartz"}, "reply_to_user": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448475216, "post_id": 33923576, "comment_id": 55608211, "body": "My god that is a simple solution. I feel so stupid. Should I leave the question open to get a solution to the optimization problem itself? (This would be to document it, not for me.)"}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 0, "creation_date": 1448475266, "post_id": 33923576, "comment_id": 55608241, "body": "Don&#39;t delete it manually, let us take care of that."}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "is_accepted": false, "score": 0, "last_activity_date": 1448515752, "last_edit_date": 1448515752, "creation_date": 1448488129, "answer_id": 33926993, "question_id": 33923576, "link": "https://stackoverflow.com/questions/33923576/gdb-returns-optimized-out-for-array-values/33926993#33926993", "title": "GDB returns &lt;optimized out&gt; for array values", "body": "<p>Will just <code>-g</code> work?  Also, leave out the <code>O0</code>.  As in <code>clang -g -std=c99 -Wall -Werror test.c -lcs50 -lm -o test</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "is_accepted": true, "score": 1, "last_activity_date": 1448509854, "creation_date": 1448509854, "answer_id": 33930278, "question_id": 33923576, "link": "https://stackoverflow.com/questions/33923576/gdb-returns-optimized-out-for-array-values/33930278#33930278", "title": "GDB returns &lt;optimized out&gt; for array values", "body": "<p>There are two possible causes I can think of:</p>\n\n<ol>\n<li>You are debugging the wrong binary (i.e. you think you are debugging <code>-O0</code> binary, but are in fact debugging an <code>-O2</code> or <code>-O3</code> binary).</li>\n<li>Your GDB is too old compared to your GCC, and doesn't understand newer debugging format.</li>\n</ol>\n\n<p>To eliminate possibility of #1, add abort() before accessing <code>numArray</code>, rebuild your program, run it under GDB, and confirm that it dies with <code>SIGABRT</code>. If it does not, my guess is correct and you are debugging a different binary from the one you think you are debugging.</p>\n"}], "owner": {"reputation": 83, "user_id": 4176019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f4a0be3e138c24c09f82b939ccc0ee7a?s=128&d=identicon&r=PG&f=1", "display_name": "jhschwartz", "link": "https://stackoverflow.com/users/4176019/jhschwartz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 33930278, "answer_count": 2, "score": 0, "last_activity_date": 1493665276, "creation_date": 1448474963, "last_edit_date": 1495540937, "question_id": 33923576, "link": "https://stackoverflow.com/questions/33923576/gdb-returns-optimized-out-for-array-values", "title": "GDB returns &lt;optimized out&gt; for array values", "body": "<p>I'm trying to complete <a href=\"https://projecteuler.net/problem=4\" rel=\"nofollow noreferrer\">Problem 4 of Project Euler</a>, and I've been trying to debug my solution for quite awhile now. The bug itself isn't part of my question \u2013 I can't figure out why GDB won't show me an array value necessary to figuring out the bug.</p>\n\n<p>Whenever gdb reaches this loop,</p>\n\n<pre><code>for (int i = numDigits; i &gt; 0; i--) {\n    numArray[i-1] = prevPalindrome % 10;\n    prevPalindrome /= 10;\n</code></pre>\n\n<p>I am unable to get a value from GDB by the command <code>print numArray</code> or <code>print numArray[0]</code> or <code>print numArray[5]</code>.</p>\n\n<p>GDB instead does the following:</p>\n\n<ul>\n<li><code>print numArray</code> returns <code>$1 = &lt;optimized out&gt;</code></li>\n<li>Both <code>print numArray[0]</code> and <code>print numArray[5]</code> return `value has been optimized out'</li>\n</ul>\n\n<p>I have already scoured StackOverflow for a way to fix this. I have attempted the following, and none have worked:</p>\n\n<ul>\n<li>My makefile already uses <code>-O0</code> (its command is <code>clang -ggdb3 -O0 -std=c99 -Wall -Werror    test.c  -lcs50 -lm -o test</code>), so I tried to use just <code>clang -O0 test.c  -lcs50 -lm -o test</code>. This did not do anything. </li>\n<li>I tried using <code>-0g</code>, and I got a compiler error.</li>\n<li>I tried making the numArray volatile. I got the code to compile, but it was still <code>&lt;optimized out&gt;</code>.</li>\n<li>I tried TUI mode <a href=\"https://stackoverflow.com/a/1354762/4176019\">at the suggestion of @Zan-Lynx</a>, and it was quite cool, but I to be honest I got lost and it was still <code>&lt;optimized out&gt;</code>.</li>\n</ul>\n\n<p>Is there something I am missing here? Shouldn't I just be able to print an array value?</p>\n\n<p>The full code is available <a href=\"https://github.com/jhschwartz/EUler/blob/master/test.c\" rel=\"nofollow noreferrer\">here</a>, with the loop in question on line 95.</p>\n"}, {"tags": ["c", "keil", "armcc"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448474798, "post_id": 33923404, "comment_id": 55608001, "body": "Sometimes it can be a text editor error, try deleting the lines and retyping."}, {"owner": {"reputation": 305, "user_id": 3392354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgBTu.png?s=128&g=1", "display_name": "Vitomakes", "link": "https://stackoverflow.com/users/3392354/vitomakes"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448477835, "post_id": 33923404, "comment_id": 55609695, "body": "Thanks @WeatherVane, not helping."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448478152, "post_id": 33923404, "comment_id": 55609880, "body": "...without using copy/paste."}, {"owner": {"reputation": 305, "user_id": 3392354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgBTu.png?s=128&g=1", "display_name": "Vitomakes", "link": "https://stackoverflow.com/users/3392354/vitomakes"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448479426, "post_id": 33923404, "comment_id": 55610590, "body": "@WeatherVane still not helping :)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1448480897, "post_id": 33923404, "comment_id": 55611347, "body": "Suspect <code>NOP</code> is <code>#define</code> someplace in <code>&quot;fw_update.h&quot; ... &quot;hal.h&quot;</code>  A simply <code>#ifdef NOP</code> before <code>#include &quot;nrf_delay.h&quot;</code> can confirm"}, {"owner": {"reputation": 305, "user_id": 3392354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgBTu.png?s=128&g=1", "display_name": "Vitomakes", "link": "https://stackoverflow.com/users/3392354/vitomakes"}, "edited": false, "score": 0, "creation_date": 1448488053, "post_id": 33923404, "comment_id": 55614920, "body": "indeed NOP was #define in registers.h ..."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1448548534, "last_edit_date": 1495541240, "creation_date": 1448548534, "answer_id": 33941227, "question_id": 33923404, "link": "https://stackoverflow.com/questions/33923404/unexpected-characters-at-end-of-line-in-keil-but-there-are-none/33941227#33941227", "title": "Unexpected characters at end of line in Keil - but there are none", "body": "<p>An <a href=\"https://stackoverflow.com/questions/33923404/unexpected-characters-at-end-of-line-in-keil-but-there-are-none#comment55614920_33923404\">unexpected</a> <code>#define</code> of <code>NOP</code> occurs in a header file.</p>\n\n<p>The 12 errors corresponded to the 12 <code>NOP</code> implying an issue with <code>NOP</code> and not some line-ending issue.  Also the occurrence of the error changed relative to header placement.</p>\n\n<p>Having such a short generic token <code>NOP</code> defined in some header file has these unfortunate effects.  IMO, if reasonably possible, re-factory the <code>#define</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 639, "user_id": 4130788, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/2aaEl.png?s=128&g=1", "display_name": "rundekugel", "link": "https://stackoverflow.com/users/4130788/rundekugel"}, "is_accepted": false, "score": 0, "last_activity_date": 1582714879, "creation_date": 1582714879, "answer_id": 60412425, "question_id": 33923404, "link": "https://stackoverflow.com/questions/33923404/unexpected-characters-at-end-of-line-in-keil-but-there-are-none/60412425#60412425", "title": "Unexpected characters at end of line in Keil - but there are none", "body": "<p>I had this error within a .s file. </p>\n\n<p>Solved error A1137E by checking the checkbox \"Assemble by using ArmClang V6\"\nIn options dialog, tab ASM</p>\n"}], "owner": {"reputation": 305, "user_id": 3392354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgBTu.png?s=128&g=1", "display_name": "Vitomakes", "link": "https://stackoverflow.com/users/3392354/vitomakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2005, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1582714879, "creation_date": 1448474319, "last_edit_date": 1448479383, "question_id": 33923404, "link": "https://stackoverflow.com/questions/33923404/unexpected-characters-at-end-of-line-in-keil-but-there-are-none", "title": "Unexpected characters at end of line in Keil - but there are none", "body": "<p>I am using Keil uVision v5.14 to compile some code for an nrf51xx cpu.\nI have always used a header file called nrf_delay.h which has some delay routines encoded in assembler.\nAll of a sudden,  receive the above error during compilation, on all the \"NOP\" lines:</p>\n\n<pre><code>#if defined ( __CC_ARM   )\nstatic __ASM void __INLINE nrf_delay_us(uint32_t volatile number_of_us)\n{\nloop\n    SUBS    R0, R0, #1\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    NOP\n    BNE    loop\n    BX     LR\n}\n#elif defined ( __ICCARM__ )\n...\n</code></pre>\n\n<p>text of error:</p>\n\n<pre><code>..\\..\\..\\Include\\nrf_delay.h(12): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(13): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(14): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(15): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(16): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(17): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(18): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(19): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(20): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(21): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(22): error: A1137E: Unexpected characters at end of line\n..\\..\\..\\Include\\nrf_delay.h(23): error: A1137E: Unexpected characters at end of line\n</code></pre>\n\n<p>The weird thing it, there are absolutely no extra characters after NOP.\nI have tried also substituting nrf_delay.h with an older version, or changing the project settings to match a working one, but no luck.</p>\n\n<p>The whole thing is enclosed between</p>\n\n<pre><code>#if defined ( __CC_ARM   )\n</code></pre>\n\n<p>but I am not sure whether \"_CC_ARM\" or \"<strong>ICCARM</strong>\" is defined. \nThe C compiler is Armcc V5.05.</p>\n\n<p><strong>update</strong></p>\n\n<p>I have started from a working project, and I have added the changes I have mad from last time step by step.\nIt seems that simply including nrf_delay.h in the new .c file of the project triggers the problem.</p>\n\n<p>However, nrf_delay.h is included in many other .c files, and nrf_delay_us() is used many times with no such a problem.</p>\n\n<p><strong>update 2 - solved, but still a mistery</strong>\nSo, I have some #defines on top of my .c file.\nIf I put it like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include \"fw_update.h\"\n#include \"registers.h\"\n#include \"nrf51.h\"\n#include \"boarddef.h\"\n#include \"hal.h\"\n#include \"nrf_delay.h\" &lt;-- this is giving the error\n</code></pre>\n\n<p>if I put it like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include \"nrf_delay.h\" &lt;-- this works!\n#include \"fw_update.h\"\n#include \"registers.h\"\n#include \"nrf51.h\"\n#include \"boarddef.h\"\n#include \"hal.h\"\n</code></pre>\n\n<p>any idea why?</p>\n"}, {"tags": ["c", "macos", "assembly"], "comments": [{"owner": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 4, "creation_date": 1448474547, "post_id": 33923397, "comment_id": 55607840, "body": "They&#39;re used for alignment purposes - i.e their inclusion means that _foo2 and _main are aligned to 16 byte boundaries, which leads to faster execution."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1448474607, "post_id": 33923397, "comment_id": 55607874, "body": "If you look at the program counter on the left, the functions are 16-byte aligned."}, {"owner": {"reputation": 158, "user_id": 2076108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zGj4b.jpg?s=128&g=1", "display_name": "ASLLOP", "link": "https://stackoverflow.com/users/2076108/asllop"}, "edited": false, "score": 0, "creation_date": 1448475057, "post_id": 33923397, "comment_id": 55608125, "body": "Great! It makes sense. Thnx for your quick answer guys!"}, {"owner": {"reputation": 158, "user_id": 2076108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zGj4b.jpg?s=128&g=1", "display_name": "ASLLOP", "link": "https://stackoverflow.com/users/2076108/asllop"}, "reply_to_user": {"reputation": 12072, "user_id": 1630963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c2d181ef6bbb9eee0c4033561c3891?s=128&d=identicon&r=PG", "display_name": "enhzflep", "link": "https://stackoverflow.com/users/1630963/enhzflep"}, "edited": false, "score": 0, "creation_date": 1448475273, "post_id": 33923397, "comment_id": 55608246, "body": "@enhzflep there is any special reason to use a strangely codified &quot;nop&quot; operation instead of simply zeros?"}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "reply_to_user": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "edited": false, "score": 0, "creation_date": 1448491421, "post_id": 33923397, "comment_id": 55616377, "body": "@MichaelPetch OS X uses clang. But they are <i>similar</i> questions."}, {"owner": {"reputation": 41564, "user_id": 3857942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hXLnN.jpg?s=128&g=1", "display_name": "Michael Petch", "link": "https://stackoverflow.com/users/3857942/michael-petch"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 2, "creation_date": 1448491566, "post_id": 33923397, "comment_id": 55616443, "body": "@ElliottFrisch  IMHO It is effectively a duplicate. The platforms may be different but the ultimate question is pretty much the same, and the answers there IMHO are better than the ones here. Unless one can find reasons why icc/clang/gcc for Intel based platforms targeting Windows/Linux/OSX(BSD) etc pad functions is somehow done for much different reasons, I&#39;ll consider this a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 2076108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zGj4b.jpg?s=128&g=1", "display_name": "ASLLOP", "link": "https://stackoverflow.com/users/2076108/asllop"}, "edited": false, "score": 0, "creation_date": 1448475524, "post_id": 33923482, "comment_id": 55608388, "body": "My question is not about nop instruction behavior."}, {"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "reply_to_user": {"reputation": 158, "user_id": 2076108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zGj4b.jpg?s=128&g=1", "display_name": "ASLLOP", "link": "https://stackoverflow.com/users/2076108/asllop"}, "edited": false, "score": 0, "creation_date": 1448475713, "post_id": 33923482, "comment_id": 55608507, "body": "The emphasis was on the words &quot;force memory alignment&quot;."}], "tags": [], "owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "is_accepted": false, "score": 2, "last_activity_date": 1448474623, "creation_date": 1448474623, "answer_id": 33923482, "question_id": 33923397, "link": "https://stackoverflow.com/questions/33923397/why-does-a-c-compiler-generate-nops-after-a-ret-instruction/33923482#33923482", "title": "Why does a C compiler generate NOPs after a RET instruction?", "body": "<blockquote>\n  <p>What are the \"nop\" instructions found right after the \"ret\" on functions foo1() and foo2()? </p>\n</blockquote>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/NOP\" rel=\"nofollow\"><code>nop</code></a> is a no-operation instruction (do nothing), from the linked Wikipedia page (emphasis mine)</p>\n\n<blockquote>\n  <p>A NOP is most commonly used for timing purposes, to <strong><em>force</strong> memory alignment</em>, to prevent hazards, to occupy a branch delay slot, to render void an existing instruction such as a jump, or as a place-holder to be replaced by active instructions later on in program development (or to replace removed instructions when refactoring would be problematic or time-consuming). </p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "is_accepted": false, "score": 0, "last_activity_date": 1448475383, "creation_date": 1448475383, "answer_id": 33923707, "question_id": 33923397, "link": "https://stackoverflow.com/questions/33923397/why-does-a-c-compiler-generate-nops-after-a-ret-instruction/33923707#33923707", "title": "Why does a C compiler generate NOPs after a RET instruction?", "body": "<p>nop is short for No Operation.  The nop instructions in this case are providing execution code alignment.  Notice that labels are on 16 byte boundaries.  On OSX, the linker (ld) should have a -segalign option that will affect this behavior.</p>\n"}, {"tags": [], "owner": {"reputation": 305, "user_id": 5601069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/575bbd8929b4c0fb5a2dd06a6fe2b185?s=128&d=identicon&r=PG&f=1", "display_name": "Enkelli", "link": "https://stackoverflow.com/users/5601069/enkelli"}, "is_accepted": false, "score": 5, "last_activity_date": 1448484293, "last_edit_date": 1448484293, "creation_date": 1448483128, "answer_id": 33925813, "question_id": 33923397, "link": "https://stackoverflow.com/questions/33923397/why-does-a-c-compiler-generate-nops-after-a-ret-instruction/33925813#33925813", "title": "Why does a C compiler generate NOPs after a RET instruction?", "body": "<p>From the <a href=\"http://www.cs.utexas.edu/~jason777/Programming/Connect%20Four/Connect%20Four/Project/2011%20-%20Assembly%20Language%20for%20x86%20Processors%206e%20(Prentice%20Hall).pdf\" rel=\"noreferrer\">Assembly language for x86 processors, Kip R. Irvine</a></p>\n\n<blockquote>\n  <p>The safest (and the most useless) instruction you can write is called NOP (no operation). It takes up 1 byte of program storage and doesn\u2019t do any work. It is <strong>sometimes used by compilers and assemblers to align code</strong> to even-address boundaries</p>\n</blockquote>\n\n<pre><code>00000000 66 8B C3 mov ax,bx  \n00000003 90 nop ; align next instruction  \n00000004 8B D1 mov edx,ecx  \n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 2076108, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zGj4b.jpg?s=128&g=1", "display_name": "ASLLOP", "link": "https://stackoverflow.com/users/2076108/asllop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "closed_date": 1448527626, "answer_count": 3, "score": 2, "last_activity_date": 1448495241, "creation_date": 1448474290, "last_edit_date": 1448495241, "question_id": 33923397, "link": "https://stackoverflow.com/questions/33923397/why-does-a-c-compiler-generate-nops-after-a-ret-instruction", "closed_reason": "Duplicate", "title": "Why does a C compiler generate NOPs after a RET instruction?", "body": "<p>On OSX 64bit, compiling a dummy C program like that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid foo1() {\n}\n\nvoid foo2() {\n}\n\nint main() {\n        printf(\"Helloooo!\\n\");\n        foo1();\n        foo2();\n        return 0;\n}\n</code></pre>\n\n<p>Produces the following ASM code (obtained disassembling the binary with otool):</p>\n\n<pre><code>(__TEXT,__text) section\n_foo1:\n0000000100000f10    55                  pushq   %rbp\n0000000100000f11    4889e5              movq    %rsp, %rbp\n0000000100000f14    897dfc              movl    %edi, -0x4(%rbp)\n0000000100000f17    5d                  popq    %rbp\n0000000100000f18    c3                  retq\n0000000100000f19    0f1f8000000000      nopl    (%rax)\n_foo2:\n0000000100000f20    55                  pushq   %rbp\n0000000100000f21    4889e5              movq    %rsp, %rbp\n0000000100000f24    5d                  popq    %rbp\n0000000100000f25    c3                  retq\n0000000100000f26    662e0f1f840000000000    nopw    %cs:(%rax,%rax)\n_main:\n0000000100000f30    55                  pushq   %rbp\n0000000100000f31    4889e5              movq    %rsp, %rbp\n0000000100000f34    4883ec10            subq    $0x10, %rsp\n0000000100000f38    488d3d4b000000      leaq    0x4b(%rip), %rdi        ## literal pool for: \"Helloooo!\\n\"\n0000000100000f3f    c745fc00000000      movl    $0x0, -0x4(%rbp)\n0000000100000f46    b000                movb    $0x0, %al\n0000000100000f48    e81b000000          callq   0x100000f68             ## symbol stub for: _printf\n0000000100000f4d    bf06000000          movl    $0x6, %edi\n0000000100000f52    8945f8              movl    %eax, -0x8(%rbp)\n0000000100000f55    e8b6ffffff          callq   _foo1\n0000000100000f5a    e8c1ffffff          callq   _foo2\n0000000100000f5f    31c0                xorl    %eax, %eax\n0000000100000f61    4883c410            addq    $0x10, %rsp\n0000000100000f65    5d                  popq    %rbp\n0000000100000f66    c3                  retq\n</code></pre>\n\n<p>What are the \"nop\" instructions found right after the \"ret\" on functions foo1() and foo2()? They are, of course, never executed since the \"ret\" instructions return from the function call. Is that any kind of padding or it has a different meaning?</p>\n"}, {"tags": ["c", "bash", "shell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1448474213, "post_id": 33923335, "comment_id": 55607649, "body": "Is this a full code? Where are the includes? Is it compiling without errors/warnings?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1448474385, "post_id": 33923335, "comment_id": 55607754, "body": "You cannot change the working directory from another process. That&#39;s why <code>cd</code> is a shell builtin, not an external command."}, {"owner": {"reputation": 2016, "user_id": 5141989, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/3dPUW.jpg?s=128&g=1", "display_name": "Mike -- No longer here", "link": "https://stackoverflow.com/users/5141989/mike-no-longer-here"}, "edited": false, "score": 0, "creation_date": 1448474642, "post_id": 33923335, "comment_id": 55607900, "body": "You might want to check your if statements involving the number of arguments. Try running your code with two sets of characters after it separated by spaces. for example: <code>&#47;mycd something whatever</code>"}, {"owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "edited": false, "score": 0, "creation_date": 1448474688, "post_id": 33923335, "comment_id": 55607935, "body": "It is compiling without errors. It&#39;s a correct program. I&#39;d like just to know why i get nothing when i type it in bash o in shell"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1448474744, "post_id": 33923335, "comment_id": 55607977, "body": "<code>ac</code> will be <code>1</code> so <code>dir</code> will point to the value of the <code>HOME</code> environment variable or will be <code>&quot;&#47;tmp&quot;</code>. Both of those are likely to succeed when passed to <code>chdir</code>, so that&#39;s why <code>chdir</code> isn&#39;t returning <code>-1</code>, so <code>perror</code> is not called."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1448475121, "post_id": 33923335, "comment_id": 55608160, "body": "@Yoan15 What did you expect it to do?"}, {"owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "edited": false, "score": 0, "creation_date": 1448475149, "post_id": 33923335, "comment_id": 55608168, "body": "okay Ian Abbott, thank you for your answer but i&#39;d like to make an internal command mycd whith output"}, {"owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "edited": false, "score": 0, "creation_date": 1448475303, "post_id": 33923335, "comment_id": 55608260, "body": "How i can do an internal command mycd with output in shell o bash ?"}, {"owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "edited": false, "score": 0, "creation_date": 1448476158, "post_id": 33923335, "comment_id": 55608762, "body": "Now it&#39;s ok. Thank you ;)"}, {"owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "edited": false, "score": 0, "creation_date": 1448480013, "post_id": 33923335, "comment_id": 55610901, "body": "Why when i try to put in shell &quot;./mycd something&quot;, i have this output something : No such file or directory ?"}], "owner": {"reputation": 23, "user_id": 5422224, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b49d8ab1a23cabab5bb0863507abf54c?s=128&d=identicon&r=PG&f=1", "display_name": "Yoan15", "link": "https://stackoverflow.com/users/5422224/yoan15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1448546024, "answer_count": 0, "score": 0, "last_activity_date": 1448475231, "creation_date": 1448474091, "last_edit_date": 1448475231, "question_id": 33923335, "link": "https://stackoverflow.com/questions/33923335/c-program-without-output-in-shell-or-in-bash", "closed_reason": "Duplicate", "title": "C program without output in shell or in bash", "body": "<p>Here is my C program (mycd):</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int ac, char * av[]){\n    char * dir;\n    int t;\n    if (ac &lt; 2){\n        dir = getenv(\"HOME\");\n        if (dir == 0)\n            dir = \"/tmp\";\n    } else if (ac &gt; 2){\n        fprintf(stderr, \"usage: %s [dir]\\n\", av[0]);\n        return 1;\n    } else\n        dir = av[1];\n    t = chdir(dir);\n    if (t &lt; 0){\n        perror(dir);\n        return 1;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>So after run when i type in shell o in bash <code>./mycd</code> i get nothing.</p>\n\n<p>Why ? </p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["c++", "c", "private-members"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 7, "creation_date": 1448473853, "post_id": 33923238, "comment_id": 55607414, "body": "You made a good design decision."}, {"owner": {"reputation": 11391, "user_id": 2508150, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6213045ef38ad15e90df7f6d7909f549?s=128&d=identicon&r=PG", "display_name": "Paolo M", "link": "https://stackoverflow.com/users/2508150/paolo-m"}, "edited": false, "score": 1, "creation_date": 1448473932, "post_id": 33923238, "comment_id": 55607463, "body": "Related: <a href=\"http://www.drdobbs.com/cpp/how-non-member-functions-improve-encapsu/184401197\" rel=\"nofollow noreferrer\">drdobbs.com/cpp/how-non-member-functions-improve-encapsu/&hellip;</a>"}, {"owner": {"reputation": 7051, "user_id": 1916449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d5611f16fc8a1b73a03e44297682824f?s=128&d=identicon&r=PG", "display_name": "arekolek", "link": "https://stackoverflow.com/users/1916449/arekolek"}, "edited": false, "score": 5, "creation_date": 1448474004, "post_id": 33923238, "comment_id": 55607503, "body": "It wouldn&#39;t hurt if you posted a simplified code sample. Certainly the cognitive load required to read this would be smaller."}, {"owner": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 1, "creation_date": 1448474147, "post_id": 33923238, "comment_id": 55607605, "body": "Whack it in a lambda and leave it private to the function itself until such time as it&#39;s needed outside?"}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "reply_to_user": {"reputation": 11533, "user_id": 1366431, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/YBopF.png?s=128&g=1", "display_name": "Leushenko", "link": "https://stackoverflow.com/users/1366431/leushenko"}, "edited": false, "score": 0, "creation_date": 1448474331, "post_id": 33923238, "comment_id": 55607725, "body": "@Leushenko Wouldn&#39;t this decrease performance? This is in a function that is called every frame in a video and is heavy in performance (detecting parts of faces)"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474398, "post_id": 33923238, "comment_id": 55607765, "body": "@Jonathan., lambdas have no impact on performance. They are simply ad-hoc defined functions. They might affect program size, though."}], "answers": [{"comments": [{"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 1, "creation_date": 1448474062, "post_id": 33923304, "comment_id": 55607546, "body": "But I will have to add it to the class definition in the header (although private this seems like exposing implementation details too much)"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 0, "creation_date": 1448474143, "post_id": 33923304, "comment_id": 55607602, "body": "Not true. The article by Sott Meyers in DDJ mentioned in one of the comments is worth a read."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474189, "post_id": 33923304, "comment_id": 55607637, "body": "@Jonathan. If it&#39;s important to you, it can be avoided by other techniques (see pimpl)"}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 1, "creation_date": 1448474233, "post_id": 33923304, "comment_id": 55607663, "body": "@RSahu Well, I&#39;m entitled to my own opinion, even in front of Scott Meyers, don&#39;t I?"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 3, "creation_date": 1448474323, "post_id": 33923304, "comment_id": 55607716, "body": "@SomeWittyUsername, we all are. If you haven&#39;t read the article, please do. It might change your opinion. I happen to agree with Scott Meyers&#39; assessments."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474339, "post_id": 33923304, "comment_id": 55607732, "body": "We are not gender studies majors, we are software developers, so it should rarely be about difference of opinions. There are defined benefits of prefering free-standing functions to class members."}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474409, "post_id": 33923304, "comment_id": 55607770, "body": "Actually turns out I do need to access instance variables, so I&#39;ve had to make it a member function, and add it to the header. (coming from objective-c, putting a private method in a public header makes me want to cry)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474460, "post_id": 33923304, "comment_id": 55607791, "body": "@Jonathan, don&#39;t cry. I have a solution for you. It is called pimpl. I hate pimpl, of course. But you might fall in love with it."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474500, "post_id": 33923304, "comment_id": 55607812, "body": "@SergeyA It&#39;s funny that everyone addresses Meyers&#39; article but no one addresses my actual answer."}, {"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474531, "post_id": 33923304, "comment_id": 55607831, "body": "@Jonathan. Assuming it&#39;s not a lot of class state you could always pass the state to the non-member function."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474555, "post_id": 33923304, "comment_id": 55607847, "body": "@SomeWittyUsername, which part of your answer remained unadressed?"}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474566, "post_id": 33923304, "comment_id": 55607852, "body": "@SergeyA, I&#39;ve seen pimpl, and fell in hate with it."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474620, "post_id": 33923304, "comment_id": 55607883, "body": "@Jonathan., OK. So you do not want to use pimpl, and you do not want to declare your private functions in the class header. Looks like C++ is not for you! :)"}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474632, "post_id": 33923304, "comment_id": 55607893, "body": "@SomeWittyUsername, at the top I said I didn&#39;t like the idea of putting it in the class definition in the header"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474679, "post_id": 33923304, "comment_id": 55607926, "body": "@SomeWittyUsername, you are suggesting to put a function into the class (as static member, I see) and we do believe in the generic case it is better to be left free-standing. What&#39;s not addressed?"}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474693, "post_id": 33923304, "comment_id": 55607938, "body": "@SergeyA, I really like a lot of C++, it is just this that I dislike severely. (though if I had a choice I&#39;d be writing this in objective-c)"}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 1, "creation_date": 1448474736, "post_id": 33923304, "comment_id": 55607972, "body": "@Jonathan. So you shouldn&#39;t like private functions at all. That&#39;s the way C++ natively works."}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "reply_to_user": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "edited": false, "score": 0, "creation_date": 1448474761, "post_id": 33923304, "comment_id": 55607985, "body": "@JamesAdkison, I thought about that, but it&#39;s about 5 different instance variables. I guess passing the instance (this) as the first parameter (like it is behind the scenes with member functions, wouldn&#39;t be a nice idea?"}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474770, "post_id": 33923304, "comment_id": 55607991, "body": "@Jonathan. on many accounts, C++ is not a true OO language (now feed me to the wolves), which actually makes it a perfect choice for me. I specifically enjoy it&#39;s non-OO."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474896, "post_id": 33923304, "comment_id": 55608044, "body": "@SergeyA  I gave at least 2 reasons for keeping it in class. &quot;Believe&quot; is not a valid contr-argument. Appealing to authority (Meyers) also isn&#39;t a valid argument"}, {"owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448474909, "post_id": 33923304, "comment_id": 55608052, "body": "@SergeyA, actually before I started doing anything in C++ I wrote a compiler (uni group project) for a custom language that would be how I wanted a language to be, and then when I got to C++ found there were quite a lot of things in it that I had liked. Just telling the world about private implementation is not good. An equivalent to objective-c extensions and I&#39;d be completely in love with C++."}, {"owner": {"reputation": 8891, "user_id": 4505712, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h9W5W.png?s=128&g=1", "display_name": "James Adkison", "link": "https://stackoverflow.com/users/4505712/james-adkison"}, "reply_to_user": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "edited": false, "score": 0, "creation_date": 1448474962, "post_id": 33923304, "comment_id": 55608075, "body": "@Jonathan. Passing the class instance is fine but obviously the non-member function won&#39;t have access to non-public state/functions (i.e., you&#39;d have to declare it a friend of the class which may not be appealing to you)."}, {"owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448475115, "post_id": 33923304, "comment_id": 55608158, "body": "Putting a function which has nothing to do with the class into the class ensures all users of the class need to recompile their code when the new function is added (even if they never call it!), and relink when implemtation changed. On the other hand, free-standing function the separate .cpp is not even pulled unless used. To me this is an immediate benefit."}, {"owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "reply_to_user": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "edited": false, "score": 0, "creation_date": 1448487854, "post_id": 33923304, "comment_id": 55614821, "body": "@SergeyA I don&#39;t see major differences here. The function is definitely used in class (otherwise there is no justification putting it there) - it&#39;s called by some other in-class function (e.g., to do some generic math that doesn&#39;t depend on class properties but rather on input). See the original question, it&#39;s just a factoring out a piece of common code."}], "tags": [], "owner": {"reputation": 17175, "user_id": 1756636, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/92f14a1f21e57ba761c7163b2d00a78a?s=128&d=identicon&r=PG&f=1", "display_name": "SomeWittyUsername", "link": "https://stackoverflow.com/users/1756636/somewittyusername"}, "is_accepted": false, "score": 0, "last_activity_date": 1448474397, "last_edit_date": 1448474397, "creation_date": 1448473995, "answer_id": 33923304, "question_id": 33923238, "link": "https://stackoverflow.com/questions/33923238/private-c-member-function-vs-c-function/33923304#33923304", "title": "Private C++ member function vs C function", "body": "<p>Yes. Putting the function in class defines scope and context of it. This makes maintenance easier and also will allow you to extend its functionality in the future without significant code rewriting. Actually, in such cases I usually prefer making the function static in the class, i.e., meeting somewhere in the middle.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 4718629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dZMe5.png?s=128&g=1", "display_name": "Kamal Sadek", "link": "https://stackoverflow.com/users/4718629/kamal-sadek"}, "is_accepted": false, "score": 4, "last_activity_date": 1448474510, "creation_date": 1448474510, "answer_id": 33923454, "question_id": 33923238, "link": "https://stackoverflow.com/questions/33923238/private-c-member-function-vs-c-function/33923454#33923454", "title": "Private C++ member function vs C function", "body": "<p>Well, if it's any addition to the argument, the newest <a href=\"https://github.com/isocpp/CppCoreGuidelines\" rel=\"nofollow\">CppCoreGuidelines</a> say that you should \"<a href=\"https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#-c5-place-helper-functions-in-the-same-namespace-as-the-class-they-support\" rel=\"nofollow\">C.5: Place helper functions in the same namespace as the class they support</a>\". So they shouldn't be a part of the actual class, but part of the namespace that they reside in.</p>\n"}, {"tags": [], "owner": {"reputation": 4259, "user_id": 2348315, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/IIlRD.jpg?s=128&g=1", "display_name": "PeterSW", "link": "https://stackoverflow.com/users/2348315/petersw"}, "is_accepted": false, "score": 1, "last_activity_date": 1448474779, "creation_date": 1448474779, "answer_id": 33923521, "question_id": 33923238, "link": "https://stackoverflow.com/questions/33923238/private-c-member-function-vs-c-function/33923521#33923521", "title": "Private C++ member function vs C function", "body": "<p>If you add it to the class then it becomes part of the classes signature.\nAs such making changes to the function signature would change the class signature. Given it would be a private function it is not likely that you would gain much by exposing it in that way.</p>\n\n<p>If though it needs to access internals of the class then having as part of the class would likely simplify its implementation.</p>\n\n<p>If it does not need to access the internals you can make add it to an anonymous namespace within the cpp file. That way the function symbol will not be exposed anywhere that is is not needed.</p>\n"}, {"tags": [], "owner": {"reputation": 5459, "user_id": 1734730, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/L8dDj.jpg?s=128&g=1", "display_name": "Nathan Cooper", "link": "https://stackoverflow.com/users/1734730/nathan-cooper"}, "is_accepted": false, "score": 1, "last_activity_date": 1449672189, "last_edit_date": 1491982277, "creation_date": 1448474797, "answer_id": 33923528, "question_id": 33923238, "link": "https://stackoverflow.com/questions/33923238/private-c-member-function-vs-c-function/33923528#33923528", "title": "Private C++ member function vs C function", "body": "<p>(Sort of an extended comment)</p>\n\n<p>You've declared a free function in the .cpp file.\nThis a good design decision as other answers point out. The clearest thing you can have is a method only visible from that .cpp file that can't see or change state. I might be tempted to put it in the same namespace as the class as per the CppCoreGuidelines. </p>\n\n<p>Equivilently, you could have declared a <code>private static</code> member function in your header file. This is <code>static</code> in the C#/Java sense rather than in either of the C senses (<a href=\"https://softwareengineering.stackexchange.com/questions/141871/false-friends-keyword-static-in-c-compared-to-c-c-and-java\">C++ has all of these meanings</a>). However, I don't see the benifit as the only thing you gain is unnecessary recompilations.</p>\n"}], "owner": {"reputation": 51650, "user_id": 191463, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f3b9829c592fd7617525afc56118a629?s=128&d=identicon&r=PG", "display_name": "Jonathan.", "link": "https://stackoverflow.com/users/191463/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1449672189, "creation_date": 1448473746, "question_id": 33923238, "link": "https://stackoverflow.com/questions/33923238/private-c-member-function-vs-c-function", "title": "Private C++ member function vs C function", "body": "<p>I have a C++ class, and in one of the member functions there is a duplicate section of code. So I've extracted this out into a function, however only this member function will call this new function. At the moment it's just a c function defined in the cpp file and not declared anyway else. </p>\n\n<p>Is there any advantage to making this a private C++ member function, the code in the function itself doesn't use any instead variables of the class.</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 3000543, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/53af8524a71601fa4c4152ec372f9ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Voz", "link": "https://stackoverflow.com/users/3000543/voz"}, "edited": false, "score": 1, "creation_date": 1448473380, "post_id": 33923097, "comment_id": 55607130, "body": "I can&#39;t believe I missed this. Thank you."}], "tags": [], "owner": {"reputation": 24913, "user_id": 1300910, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/se92W.jpg?s=128&g=1", "display_name": "huysentruitw", "link": "https://stackoverflow.com/users/1300910/huysentruitw"}, "is_accepted": true, "score": 7, "last_activity_date": 1448473248, "creation_date": 1448473248, "answer_id": 33923097, "question_id": 33923060, "link": "https://stackoverflow.com/questions/33923060/why-does-this-switch-statement-give-11-as-the-output/33923097#33923097", "title": "Why does this switch statement give 11 as the output?", "body": "<p>The <code>switch</code> starts at <code>case 5</code> and falls through (because the lack of the <code>break</code>-keyword) until the end. So: 5 + 3 + 1 + 2 - 1 + 1 = 11</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 5231413, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5Oxtm.jpg?s=128&g=1", "display_name": "Yariv Gavriel", "link": "https://stackoverflow.com/users/5231413/yariv-gavriel"}, "is_accepted": false, "score": 2, "last_activity_date": 1448473660, "creation_date": 1448473660, "answer_id": 33923214, "question_id": 33923060, "link": "https://stackoverflow.com/questions/33923060/why-does-this-switch-statement-give-11-as-the-output/33923214#33923214", "title": "Why does this switch statement give 11 as the output?", "body": "<p>In C programming language not every case contains a break. If no break appears, the flow of control will fall through to cases until a break is reached.</p>\n\n<p>Therefor if x starts as 5</p>\n\n<pre><code>case 5: x += 3;  //5+3 = 8\ncase 6: x++;     //8+1 = 9\ncase 7: x += 2;  //9+2 = 11\ncase 8: x--;    //11-1 = 10\ncase 9: x++;    //10+1 = 11\n</code></pre>\n\n<p>And the result is 11.</p>\n"}], "owner": {"reputation": 98, "user_id": 3000543, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/53af8524a71601fa4c4152ec372f9ae3?s=128&d=identicon&r=PG&f=1", "display_name": "Voz", "link": "https://stackoverflow.com/users/3000543/voz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 33923097, "answer_count": 2, "score": -1, "last_activity_date": 1448473660, "creation_date": 1448473134, "question_id": 33923060, "link": "https://stackoverflow.com/questions/33923060/why-does-this-switch-statement-give-11-as-the-output", "title": "Why does this switch statement give 11 as the output?", "body": "<p>I help teach an intro to computer science course in a university, and the professor I help gives me tests before the students, to make sure that I don't think the questions are too hard or confusing. He gave me one problem with the following code:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n\nint main(){\n  int x = 5;\n\n  switch(x){\n    case 3: x += 1;\n    case 4: x += 2;\n    case 5: x += 3;\n    case 6: x++;\n    case 7: x += 2;\n    case 8: x--;\n    case 9: x++;\n  }\n}\n</code></pre>\n\n<p>Now when I run it, I thought the output should be 10. However, when run, it outputs 11. I put print statements after each case, and the output looked like this:</p>\n\n<pre><code>8\n9\n11\n10\n11\n11\n</code></pre>\n\n<p>So my question is, can someone explain this? I feel like it's some simple thing but I cannot figure it out for the life of me.</p>\n"}, {"tags": ["c", "memory", "text", "count", "linked-list"], "comments": [{"owner": {"reputation": 51, "user_id": 3808692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001555187185/picture?type=large", "display_name": "ReiHinoX", "link": "https://stackoverflow.com/users/3808692/reihinox"}, "edited": false, "score": 0, "creation_date": 1448490051, "post_id": 33922983, "comment_id": 55615833, "body": "What does the downvote mean...did I ask a duplicate question or something?"}], "answers": [{"tags": [], "owner": {"reputation": 2385, "user_id": 1009270, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/33fcdc9c0604cf69abb15e17840d2a3c?s=128&d=identicon&r=PG", "display_name": "john elemans", "link": "https://stackoverflow.com/users/1009270/john-elemans"}, "is_accepted": false, "score": 1, "last_activity_date": 1448474422, "creation_date": 1448474422, "answer_id": 33923426, "question_id": 33922983, "link": "https://stackoverflow.com/questions/33922983/count-words-from-a-text-file-of-unknown-but-massive-size-in-c-using-linked-list/33923426#33923426", "title": "Count words from a text file of unknown but massive size in C using linked list", "body": "<p>The code has an error and MAX_TEXT_LENGTH is not needed as it is. The limit should be to make sure a single word does not exceed the length of the <em>word</em> buffer. Change the name of 'buf' to 'nextWordInFileBuffer' in your program to see if it makes more sense.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 3808692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001555187185/picture?type=large", "display_name": "ReiHinoX", "link": "https://stackoverflow.com/users/3808692/reihinox"}, "edited": false, "score": 0, "creation_date": 1448481418, "post_id": 33923706, "comment_id": 55611596, "body": "Possibly a 4gig file on a Linux VM"}, {"owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "reply_to_user": {"reputation": 51, "user_id": 3808692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001555187185/picture?type=large", "display_name": "ReiHinoX", "link": "https://stackoverflow.com/users/3808692/reihinox"}, "edited": false, "score": 0, "creation_date": 1448495588, "post_id": 33923706, "comment_id": 55617859, "body": "@ReiHinoX, I was playing with numbers for a worst-case &quot;ugly file&quot;.  :-) One could generate a 4gb file w/unique 7-char &quot;words&quot; (a-z only, but 8 chars total since you&#39;ll want a space or smth as a separator).  Assuming 1 byte per char, 6-char words only reaches 1.7gb, but 7-char words will generate about 13gb worth of unique &quot;words&quot;) so 7 is more than enough for 4gb.  The numbers are ugly for memory consumption and compute operations to generate a linked list for analysis.  A 16gb 64-bit machine could handle that with some ram left over, but seems like it would run for a long time."}, {"owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "reply_to_user": {"reputation": 51, "user_id": 3808692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001555187185/picture?type=large", "display_name": "ReiHinoX", "link": "https://stackoverflow.com/users/3808692/reihinox"}, "edited": false, "score": 0, "creation_date": 1448733300, "post_id": 33923706, "comment_id": 55705249, "body": "Sounds like fun.  I would encourage you to benchmark various content; a 4gb &quot;random&quot; file, e.g. &quot;aaaaaaa aaaaaab aaaaaac&quot; etc. filled with non-repeating  7-char &quot;words&quot;.  You could also look at pulling some text down from Project Gutenberg to benchmark, or maybe offline Wikiepdia (<a href=\"http://bit.ly/1L9SWG6\" rel=\"nofollow noreferrer\">bit.ly/1L9SWG6</a>).  Your multi-threading speedups may be limited by the IO capability, especially a on machine with a single spinning hard disk.  Instead of (or in addition to) multi-threading, consider format-aware text stripping that could deal with html, xml, maybe ms-office formats."}], "tags": [], "owner": {"reputation": 1135, "user_id": 5590742, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vNXUZ.png?s=128&g=1", "display_name": "jgreve", "link": "https://stackoverflow.com/users/5590742/jgreve"}, "is_accepted": true, "score": 1, "last_activity_date": 1448475380, "creation_date": 1448475380, "answer_id": 33923706, "question_id": 33922983, "link": "https://stackoverflow.com/questions/33922983/count-words-from-a-text-file-of-unknown-but-massive-size-in-c-using-linked-list/33923706#33923706", "title": "Count words from a text file of unknown but massive size in C using linked list", "body": "<p>To elaborate on the error John pointed out in his answer... and to add some comments to your overall questions...</p>\n\n<p><br>> I know how to count the words. I'm using a linked list\n<br>> of structs containing the word and the count. It works\n<br>> on small files, but requires me to define a maximum text\n<br>> length.\n<br>> For all I know, the text files may be in excess of\n<br>> multiple gigabytes.</p>\n\n<p>Your code looks pretty solid, except for the point below I wouldn't change much.\nI believe you MUST put an upper limit on how big any particular \"word\" can be.\nBut the overall size of the file? No problem with what you wrote; it is only memory-limitted.</p>\n\n<p>True, a text file can be multiple gigabytes (or even longer).\nBut it seems like your code will already will handle an effectively UNLIMITED number of UNIQUE words.</p>\n\n<p>btw: I like that you're lower-casing your words; minimizes the list size, finds more \"common\" words.</p>\n\n<p>Your MAX_WORD size is already 512 characters.\nSuggestion 1: consider counting the number of times (if any) you Exceed MAX_WORD size, and print out that status at the end of your run.</p>\n\n<p><br>> How can I change this to not require the #define MAX_TEXT_LENGTH?\n<br>About MAX_TEXT_LENGTH, I think that is an error.  John called that out as well in his answer.  Read on... :-)</p>\n\n<p><br>> Should I use malloc() and if so, what exactly should I apply malloc() to?\n<br>I see no need for more malloc(), you already have a nicely self-growing linked list.</p>\n\n<p>Suggestion 2: just delete MAX_TEXT_LENGTH, I don't see where you need it at all.\nIn fact, the original code looks like it allows buffer overruns on your \"buf\" variable (this would be the \"error\" part).</p>\n\n<p>More specifically, \"buf\" is only MAX_WORD in capacity, but your original code is telling getNextWord() to use MAX_TEXT_LENGTH, which is a lot (very much) greater than MAX_WORD.</p>\n\n<p>Consider modifying your code to look like the folowing:</p>\n\n<pre><code>/* Read all words from text file */\n\n/* original: */\n/* while (getNextWord(fp, buf, size)) */\n/* NOTE: remeber size was originally MAX_TEXT_LENGTH (error?). */\n\n/* You could just use MAX_WORD here and delete \"size\" while you're at it. */\nwhile (getNextWord(fp, buf, MAX_WORD))\n{\n    /* Add the word to the list */\n    addWord(buf); \n    /* Increment the total words counter */\n    totalcount++;\n}\n</code></pre>\n\n<p><br>> The final goal is to then sort everything in alphabetical order and print\n<br>> the words with frequencies, but that should be easy after I read the\n<br>> words and have my counts.\n<br>r.e. sorting, for a \"stretch goal\", see suggestion #4, below.</p>\n\n<p>Suggestion 3: Just for fun, you also might want to print a frequency chart of your word lengths at the end.\nFor example:</p>\n\n<pre><code>Freq  : Word Length\n 4851 :       1\n  205 :       2\n  104 :       3\n...etc...  \n    1 :     406\n</code></pre>\n\n<p>Suggestion 4: instead of growing your list by adding each new word at the end you may get a performance boost if you grow your linked list <i>in sorted order</i>, using strcmp() to tell if you went beyond the possible add-point for a new word.  The idea is you would avoid having to walk the entire list each time you add a word that may go in the middle somewhere.  This approach is more complex though, because you'll have to be careful about handle splicing something into mid-list, as well edge cases (like handling new inserts at beginning).</p>\n\n<p>However, it would the list would already be sorted by the time you get to the end of your input file so it may be worth giving this design approach some thought.</p>\n\n<p>Good luck, I think you wrote pretty good code.</p>\n"}], "owner": {"reputation": 51, "user_id": 3808692, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/100001555187185/picture?type=large", "display_name": "ReiHinoX", "link": "https://stackoverflow.com/users/3808692/reihinox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "accepted_answer_id": 33923706, "answer_count": 2, "score": -1, "last_activity_date": 1448475380, "creation_date": 1448472851, "question_id": 33922983, "link": "https://stackoverflow.com/questions/33922983/count-words-from-a-text-file-of-unknown-but-massive-size-in-c-using-linked-list", "title": "Count words from a text file of unknown but massive size in C using linked list", "body": "<p>I know how to count the words.  I'm using a linked list of <code>struct</code>s containing the word and the count.  It works on small files, but requires me to define a maximum text length.  For all I know, the text files may be in excess of multiple gigabytes.  How can I change this to not require the <code>#define MAX_TEXT_LENGTH</code>?  Should I use <code>malloc()</code> and if so, what exactly should I apply <code>malloc()</code> to?  The final goal is to then sort everything in alphabetical order and print the words with frequencies, but that should be easy after I read the words and have my counts.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\n#define MAX_WORD 512\n#define MAX_TEXT_LENGTH 10000\n\ntypedef struct word\n{\nchar *str;              /* Stores the word */\nint freq;               /* Stores the frequency */\nstruct word *pNext;     /* Pointer to the next word counter in the list */\n} Word;\n\n// ===========================================\n//             FUNCTION PROTOTYPES\n//============================================\n\nint getNextWord(FILE *fp, char *buf, int bufsize);   /* Given function to get words */\nvoid addWord(char *pWord);                          /* Adds a word to the list or updates exisiting word */\nvoid show(Word *pWordcounter);        /* Outputs a word and its count of occurrences */\nWord* createWordCounter(char *word);  /* Creates a new WordCounter structure */\n\n// ===========================================\n//             GLOBAL VARIABLES\n//============================================\n\nWord *pStart = NULL;                  /* Pointer to first word counter in the list */\nint totalcount = 0;                  /* Total amount of words */\nint uniquecount = 0;                /* Amount of unique words */\n\n\n// ===========================================\n//                 MAIN\n//============================================      \n\nint main (int argc, char *argv[]) {\n\n    FILE * fp;          /* File pointer */\n    fp = fopen(argv[1],\"r\");    /* Read text from here */\n    char buf[MAX_WORD];     /* buf to hold the words */\n    int size = MAX_TEXT_LENGTH; /* Size */\n\n    Word *pCounter = NULL;  /* Pointer to Word counter */\n\n    /* Read all words from text file */\n    while (getNextWord(fp, buf, size))\n    {\n        /* Add the word to the list */\n        addWord(buf); \n        /* Increment the total words counter */\n        totalcount++;\n    }\n\n    /* Loop through list and figure out the number of unique words */\n    pCounter = pStart;\n    while(pCounter != NULL)\n    {\n        uniquecount++;\n        pCounter = pCounter-&gt;pNext;\n    }\n\n    /* Print Summary */\n    printf(\"\\nSUMMARY:\\n\\n\");\n    printf(\"   %d words\\n\", totalcount);    /* Print total words */\n    printf(\"   %d unique words\\n\", uniquecount); /* Print unique words */\n\n    /* List the words and their counts */\n    pCounter = pStart;\n    while(pCounter != NULL)\n    {\n        show(pCounter);\n        pCounter = pCounter-&gt;pNext;\n    }\n    printf(\"\\n\");\n\n    /* Free the allocated  memory*/\n    pCounter = pStart;\n    while(pCounter != NULL)\n    {\n        free(pCounter-&gt;str);        \n        pStart = pCounter;           \n        pCounter = pCounter-&gt;pNext;  \n        free(pStart);                  \n    }\n    /* Close file */\n    fclose(fp);\n    return 0;\n}\n\n// ===========================================\n//                 FUNCTIONS\n//============================================\n\nvoid show(Word *pWordcounter)\n{\n    printf(\"\\n%-30s   %5d\", pWordcounter-&gt;str,pWordcounter-&gt;freq);\n}\n\nvoid addWord(char *word)\n{\n    Word *pCounter = NULL;\n    Word *pLast = NULL;\n\n    if(pStart == NULL)\n    {\n        pStart = createWordCounter(word);\n        return;\n    }\n\n    /* If the word is in the list, increment its count */\n    pCounter = pStart;\n    while(pCounter != NULL)\n    {\n        if(strcmp(word, pCounter-&gt;str) == 0)\n        {\n            ++pCounter-&gt;freq;\n            return;\n    }\n    pLast = pCounter;            \n    pCounter = pCounter-&gt;pNext;  \n}\n\n    /* Word is not in the list, add it */\n    pLast-&gt;pNext = createWordCounter(word);\n}\n\nWord* createWordCounter(char *word)\n{\n    Word *pCounter = NULL;\n    pCounter = (Word*)malloc(sizeof(Word));\n    pCounter-&gt;str = (char*)malloc(strlen(word)+1);\n    strcpy(pCounter-&gt;str, word);\n    pCounter-&gt;freq = 1;\n    pCounter-&gt;pNext = NULL;\n    return pCounter;\n}\n\nint getNextWord(FILE *fp, char *buf, int bufsize) {\n    char *p = buf;\n    char c;\n\n    //skip all non-word characters\n    do\n    {\n        c = fgetc(fp);\n        if (c == EOF) \n            return 0;\n    } while (!isalpha(c));\n\n    //read word chars\n    do\n    {\n        if (p - buf &lt; bufsize - 1)\n        *p++ = tolower(c);\n        c = fgetc(fp);\n    } while (isalpha(c));\n\n    //finalize word\n    *p = '\\0';\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "usb", "mouse"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448472423, "post_id": 33922513, "comment_id": 55606582, "body": "Can you set 8-bit fields to 16-bit values?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5390668"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448472646, "post_id": 33922513, "comment_id": 55606725, "body": "Yes, mouse resolution would be awful if you weren&#39;t able to adjust that to a bigger variable size."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448472683, "post_id": 33922513, "comment_id": 55606742, "body": "So please explain how an 8-bit field stores a 16-bit value? Is it a token representation of some kind?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448473969, "post_id": 33922513, "comment_id": 55607484, "body": "... as in <code>HID_LogicalMin( (uint16_t) -32767)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user5390668"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448474190, "post_id": 33922513, "comment_id": 55607639, "body": "It doesn&#39;t. If you look at the code above, Report Size is the number of bits to be represented in the report. I could have made it 0 - 2^16, but I prefer the origin in the center of the screen, so I use -32767 and 32767."}], "owner": {"user_type": "does_not_exist", "display_name": "user5390668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448476438, "creation_date": 1448471478, "last_edit_date": 1448476438, "question_id": 33922513, "link": "https://stackoverflow.com/questions/33922513/change-working-mouse-usb-code-x-y-from-8-bit-to-16-bit", "title": "Change working mouse usb code X &amp; Y from 8-bit to 16-bit", "body": "<p>As you can see below, I changed <code>HID_USAGE_GENERIC_X</code> to -32767 and <code>HID_USAGE_GENERIC_Y</code> to 32767 to get the greatest possible value range for a 16 bit variable. I also changed <code>HID_ReportSize</code> to 16 rather than 8. I read that <code>wMaxPacketSize</code> must be greater than the number of packets to be sent, which it should be since that value is set to 8. I believe regarding the USB desc file, I have everything set the way it should be.</p>\n\n<p>So with the original working 8-bit code, I am using a <code>uint8_t report[report_size]</code>. When I changed it, I increased the report size to 5 where it was 3 before. My understanding is that: </p>\n\n<pre><code>report[0] = mouse buttons, \nreport[1] = lower 8 bits of X, \nreport[2] = upper 8 bits of X, \nreport[3] = lower 8 bits of Y, \nreport[4] = upper 8 bits of Y.\n</code></pre>\n\n<p>Is this the correct implementation of a 16 bit X/Y 16-bit variable? I've looked online for something that may help, but nothing seems to be very thorough with what needs to be done.</p>\n\n<pre><code>/**\n * HID Mouse Report Descriptor\n */\n const uint8_t Mouse_ReportDescriptor[] = {\n    HID_UsagePage(HID_USAGE_PAGE_GENERIC),\n    HID_Usage(HID_USAGE_GENERIC_MOUSE),\n    HID_Collection(HID_Application),\n    HID_Usage(HID_USAGE_GENERIC_POINTER),\n    HID_Collection(HID_Physical),\n    HID_UsagePage(HID_USAGE_PAGE_BUTTON),\n    HID_UsageMin(1),\n    HID_UsageMax(3),\n    HID_LogicalMin(0),\n    HID_LogicalMax(1),\n    HID_ReportCount(3),\n    HID_ReportSize(1),\n    HID_Input(HID_Data | HID_Variable | HID_Absolute),\n    HID_ReportCount(1),\n    HID_ReportSize(5),\n    HID_Input(HID_Constant),\n    HID_UsagePage(HID_USAGE_PAGE_GENERIC),\n    HID_Usage(HID_USAGE_GENERIC_X),\n    HID_Usage(HID_USAGE_GENERIC_Y),\n    HID_LogicalMin( (uint16_t) -32767),     //was -127\n    HID_LogicalMax(32767),                  //was 127\n    HID_ReportSize(16),                     //Was 8\n    HID_ReportCount(2),\n    HID_Input(HID_Data | HID_Variable | HID_Relative),\n    HID_EndCollection,\n    HID_EndCollection,\n};\nconst uint16_t Mouse_ReportDescSize = sizeof(Mouse_ReportDescriptor);\n\n/**\n * USB Standard Device Descriptor\n */\nALIGNED(4) const uint8_t USB_DeviceDescriptor[] = {\n    USB_DEVICE_DESC_SIZE,           /* bLength */\n    USB_DEVICE_DESCRIPTOR_TYPE,     /* bDescriptorType */\n    WBVAL(0x0200),                  /* bcdUSB : 2.00*/\n    0x00,                           /* bDeviceClass */\n    0x00,                           /* bDeviceSubClass */\n    0x00,                           /* bDeviceProtocol */\n    USB_MAX_PACKET0,                /* bMaxPacketSize0 */\n    WBVAL(0x1FC9),                  /* idVendor */\n    WBVAL(0x0085),                  /* idProduct */\n    WBVAL(0x0100),                  /* bcdDevice : 1.00 */\n    0x01,                           /* iManufacturer */\n    0x02,                           /* iProduct */\n    0x03,                           /* iSerialNumber */\n    0x01                            /* bNumConfigurations */\n};\n\n/**\n * USB FSConfiguration Descriptor\n * All Descriptors (Configuration, Interface, Endpoint, Class, Vendor)\n */\nALIGNED(4) uint8_t USB_FsConfigDescriptor[] = {\n    /* Configuration 1 */\n    USB_CONFIGURATION_DESC_SIZE,            /* bLength */\n    USB_CONFIGURATION_DESCRIPTOR_TYPE,      /* bDescriptorType */\n    WBVAL(                                  /* wTotalLength */\n        USB_CONFIGURATION_DESC_SIZE   +\n        USB_INTERFACE_DESC_SIZE       +\n        HID_DESC_SIZE                 +\n        USB_ENDPOINT_DESC_SIZE\n        ),\n    0x01,                           /* bNumInterfaces */\n    0x01,                           /* bConfigurationValue */\n    0x00,                           /* iConfiguration */\n    USB_CONFIG_SELF_POWERED,        /* bmAttributes */\n    USB_CONFIG_POWER_MA(2),             /* bMaxPower */\n\n    /* Interface 0, Alternate Setting 0, HID Class */\n    USB_INTERFACE_DESC_SIZE,        /* bLength */\n    USB_INTERFACE_DESCRIPTOR_TYPE,  /* bDescriptorType */\n    0x00,                           /* bInterfaceNumber */\n    0x00,                           /* bAlternateSetting */\n    0x01,                           /* bNumEndpoints */\n    USB_DEVICE_CLASS_HUMAN_INTERFACE,   /* bInterfaceClass */\n    HID_SUBCLASS_BOOT,              /* bInterfaceSubClass */\n    HID_PROTOCOL_MOUSE,             /* bInterfaceProtocol */\n    0x04,                           /* iInterface */\n    /* HID Class Descriptor */\n    /* HID_DESC_OFFSET = 0x0012 */\n    HID_DESC_SIZE,                  /* bLength */\n    HID_HID_DESCRIPTOR_TYPE,        /* bDescriptorType */\n    WBVAL(0x0111),                  /* bcdHID : 1.11*/\n    0x00,                           /* bCountryCode */\n    0x01,                           /* bNumDescriptors */\n    HID_REPORT_DESCRIPTOR_TYPE,     /* bDescriptorType */\n    WBVAL(sizeof(Mouse_ReportDescriptor)),  /* wDescriptorLength */\n    /* Endpoint, HID Interrupt In */\n    USB_ENDPOINT_DESC_SIZE,         /* bLength */\n    USB_ENDPOINT_DESCRIPTOR_TYPE,   /* bDescriptorType */\n    HID_EP_IN,                      /* bEndpointAddress */\n    USB_ENDPOINT_TYPE_INTERRUPT,    /* bmAttributes */\n    WBVAL(0x0008),                  /* wMaxPacketSize */\n    HID_MOUSE_REPORT_INTERVAL,      /* bInterval */\n    /* Terminator */\n    0                               /* bLength */\n};\n</code></pre>\n"}, {"tags": ["c", "byte", "fwrite", "fread", "unsigned-integer"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1448472469, "post_id": 33922353, "comment_id": 55606622, "body": "Send a pointer to it..."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1448474593, "post_id": 33922353, "comment_id": 55607864, "body": "<code>0b11010101</code> isn&#39;t valid C. Are you using gcc by any chance?"}, {"owner": {"reputation": 673, "user_id": 5562199, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2619c0e7e0e48c2004991946d9c074e2?s=128&d=identicon&r=PG&f=1", "display_name": "unconditionalcoder", "link": "https://stackoverflow.com/users/5562199/unconditionalcoder"}, "edited": false, "score": 0, "creation_date": 1448475365, "post_id": 33922353, "comment_id": 55608302, "body": "yes I&#39;m using gcc and it compiles fine"}], "answers": [{"comments": [{"owner": {"reputation": 481, "user_id": 5916150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c209005186a84dd1820b220d7b78527e?s=128&d=identicon&r=PG&f=1", "display_name": "Arif Burhan", "link": "https://stackoverflow.com/users/5916150/arif-burhan"}, "edited": false, "score": 0, "creation_date": 1458783245, "post_id": 33923081, "comment_id": 60018275, "body": "I have used <b>fprintf()</b> to write binary, files.                                      <b>unsigned int val=0b11010101;\u2026\u2026\u2026\u2026fopen(\u2026);\u2026\u2026\u2026\u2026fprintf(fp,&quot;%c&quot;,val);</b> will work."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 3, "last_activity_date": 1448473196, "creation_date": 1448473196, "answer_id": 33923081, "question_id": 33922353, "link": "https://stackoverflow.com/questions/33922353/write-a-byte-to-a-file-in-c/33923081#33923081", "title": "Write a byte to a file in C", "body": "<p>Perhaps like this, you better not write one byte of an <code>int</code> because of endianness. Convert to <code>unsigned char</code> first.</p>\n\n<pre><code>unsigned int intval = 0b11010101;       // assuming compiler likes it\nunsigned char charval = intval;\nfwrite (&amp;charval, 1, 1, stream);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 716, "user_id": 1156096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfd2fe00e768ea764a9fedcf9792a0cd?s=128&d=identicon&r=PG", "display_name": "njh", "link": "https://stackoverflow.com/users/1156096/njh"}, "is_accepted": false, "score": 0, "last_activity_date": 1614019581, "creation_date": 1614019581, "answer_id": 66321640, "question_id": 33922353, "link": "https://stackoverflow.com/questions/33922353/write-a-byte-to-a-file-in-c/66321640#66321640", "title": "Write a byte to a file in C", "body": "<p>You can write a single byte to a file using <a href=\"https://linux.die.net/man/3/fputc\" rel=\"nofollow noreferrer\">fputc()</a>.</p>\n<p>Example:</p>\n<pre class=\"lang-c prettyprint-override\"><code>unsigned int val = 0b11010101;\nfputc(val, stream);\n</code></pre>\n<p>Tested using:</p>\n<pre class=\"lang-sh prettyprint-override\"><code>~ $ cc -Wall -o test test.c\n~ $ ./test | xxd\n00000000: d5                                       .\n</code></pre>\n"}], "owner": {"reputation": 673, "user_id": 5562199, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2619c0e7e0e48c2004991946d9c074e2?s=128&d=identicon&r=PG&f=1", "display_name": "unconditionalcoder", "link": "https://stackoverflow.com/users/5562199/unconditionalcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5212, "favorite_count": 1, "accepted_answer_id": 33923081, "answer_count": 2, "score": 0, "last_activity_date": 1614019581, "creation_date": 1448470939, "last_edit_date": 1448471181, "question_id": 33922353, "link": "https://stackoverflow.com/questions/33922353/write-a-byte-to-a-file-in-c", "title": "Write a byte to a file in C", "body": "<p>I have a byte declared as <code>unsigned int 0b11010101</code>how can I write this to a binary file as 1 byte? I know fwrite takes type <code>const void *</code>as a buffer but I don't know how to write my byte if it's represented as an unsigned int.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448470844, "post_id": 33922178, "comment_id": 55605573, "body": "Are you saying the program errors or that <code>printf(&quot;error checkresult = %d\\n&quot;,checkresult);</code> is printed?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448470936, "post_id": 33922178, "comment_id": 55605637, "body": "Note: best not to call <code>fclose(fp)</code> when <code>fp == NULL</code>."}, {"owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448471104, "post_id": 33922178, "comment_id": 55605742, "body": "program errors abort6 and i tried to debbug thats why I&#39;ve addedprintf(&quot;error checkresult = %d\\n&quot;,checkresult);"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448471126, "post_id": 33922178, "comment_id": 55605755, "body": "&quot;I notice the error when i print each struct to the screen the program prints the last struct before the return char then quits.&quot; is unclear as posted code does not <code>printf()</code> <code>artid,altartid,pc,artname</code> anywhere.  I think the issue is in unposted code."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1448471503, "post_id": 33922178, "comment_id": 55605981, "body": "Show the first few lines of the text file you are reading from but not as an image but as text please, sigh."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1448471696, "post_id": 33922178, "comment_id": 55606102, "body": "There must be a linked list somewhere as the data is printed in reverse order of the file, and <code>create_artist()</code> is not shown, nor <code>#incude</code> files nor function prototypes. Are there any?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448471698, "post_id": 33922178, "comment_id": 55606104, "body": "Suspect issue is with <code>create_artist()&#47;add_artist()</code>.  2) With <code>print_artists()</code> I would expect <code>void print_artists(struct artist *head) { while (head) { print_artist(head); head = head-&gt;next; }}</code>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448472992, "post_id": 33922178, "comment_id": 55606926, "body": "Side note: best to post true output (as text) with matching true code.  Since output is missing <code>&quot;Hello!\\n&quot;</code> it lowers the confidence that code and output match."}], "answers": [{"tags": [], "owner": {"reputation": 2190, "user_id": 5226168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3761808b7533626771b59ad6ef9541?s=128&d=identicon&r=PG&f=1", "display_name": "Anders", "link": "https://stackoverflow.com/users/5226168/anders"}, "is_accepted": true, "score": 2, "last_activity_date": 1448498230, "creation_date": 1448498230, "answer_id": 33928820, "question_id": 33922178, "link": "https://stackoverflow.com/questions/33922178/how-do-i-ignore-newline-in-txt-file-in-c/33928820#33928820", "title": "How do i ignore newline in .txt file in c", "body": "<p>When you reach the blank line before Bodenstandig, the sscanf will not match and you will exit the while loop at the \"break\".</p>\n\n<p>If sscanf does not return 2, you should check to see if the line is empty and if so skip and read the next line. Or just skip the check and ignore bad lines. The while(fgets(...) condition will become false at the end of the file, so you don't need to exit on a bad line.</p>\n\n<pre><code>if (checkresult == 2)\n{\n    ....\n}\nelse\n{\n    continue; // will go back to top while(fgets(...))\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 3063152, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/db8a9921c49e3308f176fac904d316ec?s=128&d=identicon&r=PG&f=1", "display_name": "ProtectorOfUbi", "link": "https://stackoverflow.com/users/3063152/protectorofubi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 451, "favorite_count": 0, "accepted_answer_id": 33928820, "answer_count": 1, "score": 0, "last_activity_date": 1448498230, "creation_date": 1448470467, "last_edit_date": 1448471283, "question_id": 33922178, "link": "https://stackoverflow.com/questions/33922178/how-do-i-ignore-newline-in-txt-file-in-c", "title": "How do i ignore newline in .txt file in c", "body": "<p>i am reading in from a text file and storing each element into a linked list. however when the program reaches a return char or newline the program returns an error.</p>\n\n<p>reading from text file and storing into structs. I notice the error when i print each struct to the screen the program prints the last struct before the return char then quits.</p>\n\n<pre><code>int main(int argc, const char * argv[]) {\n    printf(\"Hello!\\n\");\n\n    char filename[] = \"artist.txt\";\n\n    print_artists(read_artists(filename));\n\n    return 0;\n}\n\n    struct artist *read_artists(char *fname)\n    {\n        int maxlen = 225;\n\n        int artid = 0;\n        int altartid = 0;\n        int pc = 0;\n        char artname[80];\n\n        char data[maxlen];\n        int valid = 0; // 0 acts as true 1 acts as false\n        int checkresult = 0; //checks result of sscanf\n\n        struct artist *temphead = create_artist(0,0,0,\"0\");\n\n        FILE *fp = fopen(fname ,\"r\");\n\n        if (fp != NULL)\n        {\n            while (fgets(data,maxlen,fp))\n            {\n                checkresult = sscanf(data,\"%d\\t%[^\\t\\n]\\n\",&amp;artid,artname);\n                if (checkresult == 2)\n                {\n                    struct artist *b = NULL;\n                    b = create_artist(artid,altartid,pc,artname);\n                    temphead = add_artist(temphead,b);\n                }\n                else\n                {\n                    printf(\"error checkresult = %d\\n\",checkresult);\n                    printf(\"break out of loop valid = 1\\n\");\n                    valid = 1; // acts as boolean variable\n                    break; //breaks out of the while(fgets)\n                }\n            }\n            fclose(fp);\n            return (temphead);\n        }\n        else\n        {\n            fclose(fp);\n            printf(\"File Error\\n\");\n            return (NULL);\n        }\n\n    }\n\nvoid print_artists(struct artist *head)\n{\n    if (head != NULL)\n    {\n        struct artist *temp = head;\n        while (temp -&gt; next != NULL)\n        {\n            print_artist(temp);\n            temp = temp -&gt; next;\n        }\n        print_artist(temp);\n    }\n}\n</code></pre>\n\n<p>this is the output</p>\n\n<p><a href=\"https://i.stack.imgur.com/7LPPx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7LPPx.png\" alt=\"enter image description here\"></a></p>\n\n<p>the text file i am reading from</p>\n\n<p><a href=\"https://i.stack.imgur.com/b3PaZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b3PaZ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c", "arrays", "matrix"], "answers": [{"comments": [{"owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "edited": false, "score": 0, "creation_date": 1456816849, "post_id": 33922547, "comment_id": 59109647, "body": "When writing <code>char[] rowArray = row;</code>, you must have had some other language than C in mind."}], "tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": false, "score": 1, "last_activity_date": 1456825070, "last_edit_date": 1456825070, "creation_date": 1448471585, "answer_id": 33922547, "question_id": 33922170, "link": "https://stackoverflow.com/questions/33922170/c-programming-and-array-matrix-manipulation/33922547#33922547", "title": "C programming and array ,matrix manipulation", "body": "<p>The function accepts an array of <code>char*</code>. Note that, in C, arrays and pointers can be used interchangably most of the time.</p>\n\n<p>If you declared a pointer like <code>char* p;</code> you could use it just like an array: <code>p[5]</code>. So in your case, <code>char* input[]</code> is quite the same as an array of arrays of <code>char</code>: <code>input[2][5]</code> will take element #2 from the array (yielding a <code>char*</code>!) and from that element #5.\nOr, even more explicitly, you could as well write</p>\n\n<pre><code>char* row = input[2];\nchar element = row[5];\n</code></pre>\n\n<p>Yet, how many elements each row of the matrix will have cannot be told from what you posted. Is it a square matrix, are the rows represented as <code>\\0</code> terminated strings? You'll have to check the test question for that info.</p>\n"}], "owner": {"reputation": 43, "user_id": 5537057, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2fd8f2fffb8b63f3f7fbe7119e4a6fa?s=128&d=identicon&r=PG&f=1", "display_name": "Chandra Sagar", "link": "https://stackoverflow.com/users/5537057/chandra-sagar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456825070, "creation_date": 1448470455, "last_edit_date": 1448470469, "question_id": 33922170, "link": "https://stackoverflow.com/questions/33922170/c-programming-and-array-matrix-manipulation", "title": "C programming and array ,matrix manipulation", "body": "<p>I am trying to take an online test on techgig.com .\nThe problem is to find the minimum path from top left of the matrix to the bottom right.\nI am trying to code this using C language.\nThe minimumcost function is already given as and I am not allowed to change this .</p>\n\n<pre><code>char* minumumcost(char* input1[],int input2)\n</code></pre>\n\n<p>where input1 is the matrix and input2 is the number of rows in matrix.</p>\n\n<p>However with my limited knowledge of C , I only know how to manipulate a matrix when it is declared as a two dimensional array.</p>\n\n<p>With two dimensional array I intend to do the following operation.</p>\n\n<p>Here the cost matrix is cost[10][10]\n\\\nwhile(point1!=n &amp;&amp; point2!=n)\n      {      </p>\n\n<pre><code> if(cost[a][j+1]&lt;cost[a+1][j] &amp;&amp; cost[a][j+1]&lt;cost[a+1][j+1])\n{  \n     min=cost[a][j+1];\n     s[k]='R';\n     k++;\n     j++;\n     point1=a;\n     point2=j;\n}\nelse if(cost[a+1][j]&lt;cost[a+1][j+1] &amp;&amp; cost[a+1][j]&lt;cost[a][j+1])\n{   \n\n   min=cost[a+1][j];\n   s[k]='B';\n   k++;\n   a++;\n   point1=a;\n   point2=j;\n} \nelse  if(cost[a+1][j+1]&lt;cost[a+1][j] &amp;&amp; cost[a+1][j+1]&lt;cost[a][j+1])\n    { \n        min=cost[a+1][j];\n        s[k]='D'; \n         a++;\n         j++;  \n         k++;\n          point1=a;\n   point2=j;\n    } \n            }\n</code></pre>\n\n<p>\\\nAn example shows that the input to the matrix is given in this form.\n{5#2#3#2,8#5#5#3,1#4#7#6,3#3#6#5},4\nwhere 4 is the no of rows and the remaining is the elements of the row .</p>\n\n<p>The question is how do I do this by using input1[] ?\nPlease help me soon.\nThe test has a time limit.</p>\n"}, {"tags": ["c", "optimization", "nan"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1448470264, "post_id": 33922103, "comment_id": 55605211, "body": "Depends on the compiler. If it generates a function call, it won&#39;t be as fast, but if the compiler inlines it then it should be."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448470316, "post_id": 33922103, "comment_id": 55605244, "body": "Look at the generated assembly code. And make sure you enable optimization when you compile."}, {"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 1, "creation_date": 1448470323, "post_id": 33922103, "comment_id": 55605247, "body": "Related: <a href=\"http://stackoverflow.com/questions/26052640/why-does-gcc-implement-isnan-more-efficiently-for-c-cmath-than-c-math-h\">Why does GCC implement isnan() more efficiently for C++ &lt;cmath&gt; than C &lt;math.h&gt;?</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448470324, "post_id": 33922103, "comment_id": 55605248, "body": "Depends on your target architecture and libraries."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448470552, "post_id": 33922103, "comment_id": 55605392, "body": "@Olaf Good point. I have tried to clarify."}, {"owner": {"reputation": 81037, "user_id": 8454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2NlHs.png?s=128&g=1", "display_name": "Andy Lester", "link": "https://stackoverflow.com/users/8454/andy-lester"}, "edited": false, "score": 0, "creation_date": 1448471034, "post_id": 33922103, "comment_id": 55605695, "body": "Why don&#39;t you try it and see?  Write a program that does 1,000,000 <code>isnan</code> calls and another that does 1,000,000 equality tests and see which program is faster."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448471175, "post_id": 33922103, "comment_id": 55605787, "body": "@Barmar How exactly do I look at the assembly. I tried <code>gcc -O3 -S -o my_asm.s -lm test.c</code> and <code>objdump -S --disassemble a.out</code> but it&#39;s not pretty to look at."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 81037, "user_id": 8454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2NlHs.png?s=128&g=1", "display_name": "Andy Lester", "link": "https://stackoverflow.com/users/8454/andy-lester"}, "edited": false, "score": 0, "creation_date": 1448471242, "post_id": 33922103, "comment_id": 55605819, "body": "@AndyLester How do  I prevent the compiler from optimizing the loop out?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448471273, "post_id": 33922103, "comment_id": 55605839, "body": "@eleanora Access a <code>volatile</code> variable in the loop."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448473955, "post_id": 33922103, "comment_id": 55607476, "body": "Do you want to compare <code>isnan(x)</code> with <code>x == y</code> where <code>y = something;</code> OR compare <code>isnan(x)</code> with <code>x == y</code> where <code>y = NaN;</code>?  It sounds like you are asking about the first which is odd as that is not equivalent functionality."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448474282, "post_id": 33922103, "comment_id": 55607692, "body": "@chux It is the first. The question is if we should use something other than NaN in our code to represent unknown values."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448477115, "post_id": 33922103, "comment_id": 55609264, "body": "Is this comparison really causing a performance problem in your application? If not, why are you worrying about it? <a href=\"http://c2.com/cgi/wiki?PrematureOptimization\" rel=\"nofollow noreferrer\">Premature optimization is the root of all evil</a>"}], "answers": [{"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 2, "creation_date": 1448471392, "post_id": 33922167, "comment_id": 55605911, "body": "Not if the compiler inlines it."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1448471974, "post_id": 33922167, "comment_id": 55606287, "body": "Which only makes it just as good ... But then again that&#39;s not always applicable even on a compiler that can normally inline things."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 0, "last_activity_date": 1448470448, "creation_date": 1448470448, "answer_id": 33922167, "question_id": 33922103, "link": "https://stackoverflow.com/questions/33922103/is-isnan-as-fast-as-testing-equality/33922167#33922167", "title": "Is `isnan()` as fast as testing equality?", "body": "<p>No. The equality test is inline so you pay the price of a function call overhead calling isnan(). But equality can't be used w/o IEEE, so ...</p>\n"}, {"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1448478530, "post_id": 33922916, "comment_id": 55610104, "body": "Thank you for the very nice disassembly. Do you know if <code>x!=x</code> is supposed to work in all compilers?"}, {"owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 2, "creation_date": 1448480025, "post_id": 33922916, "comment_id": 55610905, "body": "@eleanora no, because not all of them even support NaN. There are platforms that just don&#39;t have NaNs (like TI-83+, some DSPs, etc). Also it doesn&#39;t work if you use -ffast-math or some of the related options - they break all sorts of things including usually this."}], "tags": [], "owner": {"reputation": 52741, "user_id": 555045, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/182d0ce855c8324a596648c04643e8f9?s=128&d=identicon&r=PG", "display_name": "nicomp", "link": "https://stackoverflow.com/users/555045/nicomp"}, "is_accepted": true, "score": 4, "last_activity_date": 1448472665, "creation_date": 1448472665, "answer_id": 33922916, "question_id": 33922103, "link": "https://stackoverflow.com/questions/33922103/is-isnan-as-fast-as-testing-equality/33922916#33922916", "title": "Is `isnan()` as fast as testing equality?", "body": "<p>Using GCC on x64, <code>math.h</code>'s <code>isnan(float)</code> compiles to</p>\n\n<pre><code>jmp __isnanf\n</code></pre>\n\n<p>Using tail-call optimization, but effectively calling a function. The called function will have to do something equivalent to the code a bit down, at least I don't see any faster way to implement it. That leaves the question how it compares to a comparison unanswered however.</p>\n\n<p>But that doesn't say anything about how fast \"testing if a float is NaN\" is, because there isn't just the one way to do it. The most direct way, </p>\n\n<pre><code>int isnan2(float x)\n{\n  return x != x;\n}\n</code></pre>\n\n<p>Is literally the same thing as comparing floats at the C level. But GCC makes this:</p>\n\n<pre><code>xor eax, eax\nucomiss xmm0, xmm0\nsetp    al\nret\n</code></pre>\n\n<p>Which is not quite the <em>same</em> thing as comparing two floats, but close, and in fact a bit faster. Testing for equality means the unordered case tested, as it is here, but then the z flag also has to be tested, like this (from gcc again)</p>\n\n<pre><code>xor eax, eax\nmov edx, 1\nucomiss xmm0, xmm1\nsetp    al\ncmovne  eax, edx\nret\n</code></pre>\n\n<p>Bonus: using <code>&lt;cmath&gt;</code> makes <code>isnan</code> compile to the same thing as comparing a float to itself, see the linked question for why.</p>\n\n<p><a href=\"http://goo.gl/9grsK7\" rel=\"nofollow\">Godbolt link for convenience</a></p>\n\n<p>I now see you actually had <code>double</code>, but that doesn't change anything qualitatively.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1448475005, "last_edit_date": 1495535239, "creation_date": 1448475005, "answer_id": 33923591, "question_id": 33922103, "link": "https://stackoverflow.com/questions/33922103/is-isnan-as-fast-as-testing-equality/33923591#33923591", "title": "Is `isnan()` as fast as testing equality?", "body": "<blockquote>\n  <p>The question is if we should use something other than NaN in our code to represent unknown values.  (<a href=\"https://stackoverflow.com/questions/33922103/is-isnan-as-fast-as-testing-equality/33923591#comment55607692_33922103\">OP comment</a>)</p>\n</blockquote>\n\n<p>Then you should compare <code>isnan(x)</code> with <code>x == some_constant</code>.  If that <code>some_constant</code> did not have a value of 0 or NAN, then the compare could simply be a bit compare if using typical FP representation - hard to beat that by much for speed.  </p>\n\n<p>Still, NaN is more idiomatic.</p>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "accepted_answer_id": 33922916, "answer_count": 3, "score": 1, "last_activity_date": 1448480126, "creation_date": 1448470232, "last_edit_date": 1448480126, "question_id": 33922103, "link": "https://stackoverflow.com/questions/33922103/is-isnan-as-fast-as-testing-equality", "title": "Is `isnan()` as fast as testing equality?", "body": "<p>In C, is testing if a float is NaN as fast as testing if two floats are equal?  That is is <code>isnan()</code> as fast a simple equality test between two floats?</p>\n\n<p>My particular interest is using <code>gcc</code> on a standard modern Intel/AMD platform.</p>\n\n<p>Here is a sample piece of C code.</p>\n\n<pre><code>#include &lt;math.h&gt;\nint main(double x)\n{\n  return isnan(x);\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "char"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 3, "creation_date": 1448471298, "post_id": 33922088, "comment_id": 55605860, "body": "That more looks like pure C code to me, I can&#39;t spot anything C++ specific. Also to find <i>stupid errors</i> fire up your program in the debugger and inspect stepping through line by line. Stack Overflow isn&#39;t a online debugging service."}, {"owner": {"reputation": 31368, "user_id": 3133316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30f0b31e22bec21f12f31cd30ae5b148?s=128&d=identicon&r=PG&f=1", "display_name": "PaulMcKenzie", "link": "https://stackoverflow.com/users/3133316/paulmckenzie"}, "edited": false, "score": 0, "creation_date": 1448472169, "post_id": 33922088, "comment_id": 55606404, "body": "@Ghislo, if the title is as you suggested, <code>C++</code>, then there is very little to any C++ specific things in your code.  If it is <code>C++</code>, then there are <code>C++</code> specific solutions that do not require writing loops to find if one sequence is contained in another sequence.  In addition to that, if it is <code>C++</code>, why not use <code>cin</code>, and <code>std::string</code>?  If I&#39;m wrong and it is actually a <code>C</code> program, change your title to reflect this."}, {"owner": {"reputation": 75, "user_id": 5605084, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/076c4cd68fc41edaa8264bddc7ee184d?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislo", "link": "https://stackoverflow.com/users/5605084/ghislo"}, "edited": false, "score": 0, "creation_date": 1448472592, "post_id": 33922088, "comment_id": 55606697, "body": "Actually i&#39;m following a c++ course in my university, but these are the tools that I&#39;ve learned till now. So the exercise requires me to be able to go for it with the tools I&#39;ve learned till now . I hope this isn&#39;t against the community rules!"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1448486743, "post_id": 33922088, "comment_id": 55614263, "body": "So if you want &#39;plain C&#39;, rather than C++, please <a href=\"https://stackoverflow.com/posts/33922088/edit\">edit</a> your question and remove it from your title. Note that even mentioning it in the title is not necessary - that&#39;s what tags are for. Welcome to Stack Overflow, by the way! Based in the edits that others did for you, you may want to read <a href=\"http://stackoverflow.com/help/formatting\">how to properly format your question</a> some time."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5605084, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/076c4cd68fc41edaa8264bddc7ee184d?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislo", "link": "https://stackoverflow.com/users/5605084/ghislo"}, "edited": false, "score": 1, "creation_date": 1448476398, "post_id": 33923148, "comment_id": 55608896, "body": "Thank you mate! I totally forgot about the break statement!!! Even thought i thought my bool[] initialization was right.. so i learned something!! I initialized it with a for loop!"}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 2, "last_activity_date": 1448473965, "last_edit_date": 1448473965, "creation_date": 1448473431, "answer_id": 33923148, "question_id": 33922088, "link": "https://stackoverflow.com/questions/33922088/how-can-i-make-a-comparison-between-two-c-strings-checking-also-if-a-char-has-al/33923148#33923148", "title": "How can i make a comparison between two c_strings checking also if a char has already been compared?", "body": "<p>You dont break from this loop:</p>\n\n<pre><code> for(int j = 0;j&lt;num;j++) {\n        if (word[i]==lett[j]) {\n            if (isUsable[j]) {\n                isUsable[j] = false;\n                isChecked = true;\n</code></pre>\n\n<p>This means that every 'a' in the list will be marked with <code>isUsable = false</code> when you check the first letter of <code>acab</code>. You need to have a <code>break</code> when you find the first letter:</p>\n\n<pre><code>if (isUsable[j]) {\n    isUsable[j] = false;\n    isChecked = true;\n    break;\n</code></pre>\n\n<p>The second problem is that you are not initializing your <code>isUsable</code> array correctly.</p>\n\n<p><a href=\"http://ideone.com/zUzC61\" rel=\"nofollow\">Here is a live example of it working.</a></p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 5605084, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/076c4cd68fc41edaa8264bddc7ee184d?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislo", "link": "https://stackoverflow.com/users/5605084/ghislo"}, "edited": false, "score": 1, "creation_date": 1448476496, "post_id": 33923450, "comment_id": 55608944, "body": "Thanks for the advice!"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1448474494, "creation_date": 1448474494, "answer_id": 33923450, "question_id": 33922088, "link": "https://stackoverflow.com/questions/33922088/how-can-i-make-a-comparison-between-two-c-strings-checking-also-if-a-char-has-al/33923450#33923450", "title": "How can i make a comparison between two c_strings checking also if a char has already been compared?", "body": "<p>Undefined behavior</p>\n\n<p><code>strlen(word)&gt;num</code> imposes no control about the maximum number of characters to read.  Once too many are are read - anything goes.  Its undefined behavior.</p>\n\n<pre><code>int num = 10;\nchar word[10];\ndo {\n    printf(\"Insert the word : \");\n    scanf(\" %s\", &amp;word[0]); \n} while (strlen(word)&gt;num);\n</code></pre>\n\n<p>Instead:</p>\n\n<pre><code>int num = 10;\nchar word[10];\nprintf(\"Insert the word : \");\nscanf(\"%9s\", word); \n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 5605084, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/076c4cd68fc41edaa8264bddc7ee184d?s=128&d=identicon&r=PG&f=1", "display_name": "Ghislo", "link": "https://stackoverflow.com/users/5605084/ghislo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33923148, "answer_count": 2, "score": 1, "last_activity_date": 1448555472, "creation_date": 1448470188, "last_edit_date": 1448555472, "question_id": 33922088, "link": "https://stackoverflow.com/questions/33922088/how-can-i-make-a-comparison-between-two-c-strings-checking-also-if-a-char-has-al", "title": "How can i make a comparison between two c_strings checking also if a char has already been compared?", "body": "<p>In specific, i'm actually coding a function taken from \"Scrabble\" game. I have to get the a word of 10 chars and, given the player's letters, check if that word can be made with those letters or not. I'm getting problems in checking words that have more letters of the same type. Here's my code : `</p>\n\n<pre><code>int main(int argc, char** argv) {\n\n    int num = 10;\n    char lett[num] = {'f','c','a','a','b','s','t','o','e','m'};\n    char word[10];\n    bool isUsable[num] = {true};\n\n    // Input word\n\n    do {\n        printf(\"Insert the word : \");\n        scanf(\" %s\", &amp;word[0]); \n        system(\"CLS\");\n    } while (strlen(word)&gt;num);\n\n    printf(\"your word is : %s \\n\", word);\n\n    // Verificy word\n\n    bool isChecked;\n\n    for (int i = 0;i&lt;strlen(word);i++) {\n        isChecked = false;\n\n        // compare every char of word[] with array lett[]\n\n        for(int j = 0;j&lt;num;j++) {\n\n\n            // if word[i] = lett[j] --&gt; make boolean associated to that letter not usable anymore and make the the boolean associated to the char of the word checked\n\n            if (word[i]==lett[j]) {\n\n                if (isUsable[j]) {\n                    isUsable[j] = false;\n                    isChecked = true;\n                }\n\n            }\n\n        }\n\n        // if at least one char of the word result not checked display error\n\n        if (!isChecked) {\n\n            printf(\"\\n You have not the necessary letters!\\n\");\n            system(\"pause\");\n            return 0;\n\n        }                                   \n    }       \n\n   // rest of the code ..\n\nreturn 0;\n}\n</code></pre>\n\n<p>for example, the code works for the word (\"cab\"), but won't work for the word (\"acab\"). (sorry for lessical game :D)</p>\n\n<p>I was thinking i may be wrong using a boolean array but i can't figure out how not to use it. </p>\n\n<p>I also thought there may be a solution with the use of a pointer, but i'm still not that good in managing solutions with pointers..</p>\n\n<p>The last thought was of a stupid mistake, but i couldn't find it..\nso.. anyone knows what i'm doing wrong?</p>\n"}, {"tags": ["c", "gcc", "compilation"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 6, "creation_date": 1448469396, "post_id": 33921785, "comment_id": 55604587, "body": "<code>$</code> is your shell prompt, the command is <code>gcc</code>."}, {"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 1, "creation_date": 1448469469, "post_id": 33921785, "comment_id": 55604653, "body": "<code>gcc</code> is a compiler. You can get it for Windows by looking at <a href=\"http://www.mingw.org/\" rel=\"nofollow noreferrer\">MinGW</a> and following the download/install instructions."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 6, "creation_date": 1448469482, "post_id": 33921785, "comment_id": 55604666, "body": "Don&#39;t use <code>gcc test.c -o demo</code> specially if you are a beginner, use <code>gcc -Wall -Wextra -Werror test.c -o demo</code>."}, {"owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1448469991, "post_id": 33921785, "comment_id": 55605012, "body": "@ouah so $ is used at Unix, while &gt; is used at Windows?"}, {"owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "reply_to_user": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 0, "creation_date": 1448470157, "post_id": 33921785, "comment_id": 55605139, "body": "@R_Kapp will this work? <a href=\"http://sourceforge.net/projects/mingw-w64/postdownload?source=dlp\" rel=\"nofollow noreferrer\">sourceforge.net/projects/mingw-w64/postdownload?source=dlp</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 1, "last_activity_date": 1448469888, "creation_date": 1448469888, "answer_id": 33921990, "question_id": 33921785, "link": "https://stackoverflow.com/questions/33921785/how-to-compile-a-simple-c-code-with-gcc-test-c-o-demo-command/33921990#33921990", "title": "How to compile a simple C code with &quot;$gcc test.c -o demo&quot; command?", "body": "<p>Let's split this into parts:</p>\n\n<ul>\n<li><p><code>$</code> is a character indicating that the shell is ready to receive a command. It is <strong>not</strong> part of the command.</p></li>\n<li><p><code>gcc</code> is an executable executing the GNU C compiler from the GCC toolchain.</p></li>\n<li><p><code>test.c -o demo</code> are arguments supplied to <code>gcc</code>.</p></li>\n</ul>\n\n<p>The GCC toolchain is only available natively for GNU systems such as Linux. Using <a href=\"http://www.mingw.org/\" rel=\"nofollow\">MinGW</a> or <a href=\"https://www.cygwin.com/\" rel=\"nofollow\">CygWin</a> you can ape its functionality, though.</p>\n\n<hr>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>A nice comment, which I second, to your question by @iharob:</p>\n\n<blockquote>\n  <p>Don't use <code>gcc test.c -o demo</code> specially if you are a beginner, use <code>gcc -Wall -Wextra -Werror test.c -o demo</code>.</p>\n</blockquote>\n\n<p>The additional switches make the compiler point out more warnings.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 549, "user_id": 3207158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8b7b35b7577e1966b9df77bc587d40f?s=128&d=identicon&r=PG&f=1", "display_name": "user3207158", "link": "https://stackoverflow.com/users/3207158/user3207158"}, "is_accepted": false, "score": 1, "last_activity_date": 1448489964, "creation_date": 1448489964, "answer_id": 33927416, "question_id": 33921785, "link": "https://stackoverflow.com/questions/33921785/how-to-compile-a-simple-c-code-with-gcc-test-c-o-demo-command/33927416#33927416", "title": "How to compile a simple C code with &quot;$gcc test.c -o demo&quot; command?", "body": "<p>GCC (GNU Compiler Collection. Upper case.) is a set of compilers, that can compile several languages. \n<br>\ngcc (lower case) is a command that compile the code you wrote, using the C compiler that GCC includes, into a working C program. Similar commands are g++ for C++ code, gcj for Java code, etc. \n<br>\nNote GCC is intended for Linux or other Unix-like systems (You can use it in Mac OS X with the help of xcode). If you are using Windows, consider [MinGW] (<a href=\"http://www.mingw.org/\" rel=\"nofollow\">http://www.mingw.org/</a>) or CygWin <a href=\"https://www.cygwin.com/\" rel=\"nofollow\">https://www.cygwin.com/</a>.\n<br>\nAs a beginner, if you still have trouble, consider use Dev-C++, an IDE (integrated development environment) that compiles C and C++. It does all the compiler things for you. </p>\n"}], "owner": {"reputation": 727, "user_id": 5225862, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/a53f8c630f930e3cf0e15f6c420ca266?s=128&d=identicon&r=PG&f=1", "display_name": "Coder88", "link": "https://stackoverflow.com/users/5225862/coder88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2891, "favorite_count": 0, "accepted_answer_id": 33921990, "answer_count": 2, "score": -5, "last_activity_date": 1453955266, "creation_date": 1448469304, "last_edit_date": 1453955266, "question_id": 33921785, "link": "https://stackoverflow.com/questions/33921785/how-to-compile-a-simple-c-code-with-gcc-test-c-o-demo-command", "title": "How to compile a simple C code with &quot;$gcc test.c -o demo&quot; command?", "body": "<p>On this <a href=\"http://www.tutorialspoint.com/computer_programming/computer_programming_syntax.htm\" rel=\"nofollow\">beginner tutorial</a> at TutorialsPoint, it says to save the code as test.c and compile it using \"$gcc test.c -o demo\" command at CMD.</p>\n\n<p>But I don't have $gcc. What is it?</p>\n"}, {"tags": ["c", "fopen"], "answers": [{"tags": [], "owner": {"reputation": 1733, "user_id": 1013504, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/afa2d53388f97248d1120c657c6bb719?s=128&d=identicon&r=PG", "display_name": "dkg", "link": "https://stackoverflow.com/users/1013504/dkg"}, "is_accepted": false, "score": 1, "last_activity_date": 1448468135, "creation_date": 1448468135, "answer_id": 33921352, "question_id": 33920996, "link": "https://stackoverflow.com/questions/33920996/can-not-open-files-with-c/33921352#33921352", "title": "Can not open files with c", "body": "<p>Your file denominated by <code>archivoSalida</code> is opened in read mode (<code>'r'</code>).</p>\n\n<p>You should also check the return codes of read/writes functions to be sure everything happen as wanted.</p>\n"}, {"tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": false, "score": 2, "last_activity_date": 1448468498, "creation_date": 1448468498, "answer_id": 33921479, "question_id": 33920996, "link": "https://stackoverflow.com/questions/33920996/can-not-open-files-with-c/33921479#33921479", "title": "Can not open files with c", "body": "<ol>\n<li><p>You'll want to <code>fopen</code> the output file (\"archivoSalida\") with mode <code>\"w\"</code> (for <em>write</em>) instead of <code>\"r\"</code> (for <em>read</em>). See e.g. <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/fopen.html\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/009695399/functions/fopen.html</a>.</p></li>\n<li><p>You do check if the input file could be opened (<code>if (archivo != NULL)</code>). Why don't you do the same for the output file?</p></li>\n<li><p>Upon an error, you should output <em>which</em> error occured from <code>errno</code>, e.g. via <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/perror.html\" rel=\"nofollow\"><code>perror(...)</code></a>. That should help in finding the actual problem.</p></li>\n</ol>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1448492931, "post_id": 33927368, "comment_id": 55617021, "body": "As far as I know, any implementation of the C standard library for Windows is very lenient about the direction of slashes."}, {"owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "edited": false, "score": 0, "creation_date": 1448493661, "post_id": 33927368, "comment_id": 55617269, "body": "That would make life a lot easier if that is the case.  All of my C code is on linux so I wasn&#39;t sure."}], "tags": [], "owner": {"reputation": 396, "user_id": 5596957, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f27d0deda60ca2443d4b367b0e4bacf?s=128&d=identicon&r=PG&f=1", "display_name": "Duane McCully", "link": "https://stackoverflow.com/users/5596957/duane-mccully"}, "is_accepted": false, "score": 0, "last_activity_date": 1448492325, "last_edit_date": 1448492325, "creation_date": 1448489776, "answer_id": 33927368, "question_id": 33920996, "link": "https://stackoverflow.com/questions/33920996/can-not-open-files-with-c/33927368#33927368", "title": "Can not open files with c", "body": "<p>The file names look Windows-ish.  Is it possible that all of the forward slashes (<code>/</code>) that you have in both file names should really be back slashes (<code>\\</code>)?</p>\n"}], "owner": {"reputation": 9, "user_id": 5604933, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153323583907831/picture?type=large", "display_name": "BUENO", "link": "https://stackoverflow.com/users/5604933/bueno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448492325, "creation_date": 1448467062, "last_edit_date": 1448469483, "question_id": 33920996, "link": "https://stackoverflow.com/questions/33920996/can-not-open-files-with-c", "title": "Can not open files with c", "body": "<p>Im supposed to write a program that opens an excel file, reads the numbers on the file, multiplies them by 9.8 and the shows the answer in another excel gile.</p>\n\n<p>I wrote this, and I did not get any errors in the compiler, but when I run it, it does not open any files. How do I make it open the files?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n    FILE *archivo;\n    FILE *archivoSalida;\n\n    int masa;\n    float peso;\n\n    archivo = fopen(\"C:/Users/nacho/Documents/UNAM/Informatica/proyecto/archivoEntrada.txt\", \"r\");\n    archivoSalida = fopen(\"C:/Users/nacho/Documents/UNAM/Informatica/proyecto/archivoSalida.txt\", \"r\");\n\n    if (archivo != NULL) \n    {  \n        printf(\"The file was opened succesully\");\n\n        while (fscanf(archivo,\"%d\", &amp;masa)!= EOF)\n        {\n            peso=masa*9.81;\n            fprintf(archivoSalida, \"%f\\n\", peso);\n        }\n    }\n    else\n    {\n        printf (\"Error\");\n    }\n\n\n    fclose(archivo);\n    fclose(archivoSalida);\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "networking", "linux-kernel"], "comments": [{"owner": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1448469622, "post_id": 33919656, "comment_id": 55604769, "body": "Could you be trying to <a href=\"http://www.netfilter.org/documentation/HOWTO/netfilter-hacking-HOWTO-4.html#ss4.6\" rel=\"nofollow noreferrer\">write a new netfilter module?</a>"}, {"owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "reply_to_user": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1448472065, "post_id": 33919656, "comment_id": 55606336, "body": "Thanks for the link. But again we netfilter does not have any procedures to select particular interface to send the modified frame. I think we need to add routing entries and then use netfilter."}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1448475692, "post_id": 33919656, "comment_id": 55608491, "body": "Please see <a href=\"http://stackoverflow.com/questions/18343365/zero-copy-networking-vs-kernel-bypass\">this question on &#39;user mode networking&#39;</a> for some hints.  There is the term <a href=\"https://en.wikipedia.org/wiki/Bridging_%28networking%29\" rel=\"nofollow noreferrer\">bridging</a> and <a href=\"https://www.google.ca/search?q=linux+network+bridge\" rel=\"nofollow noreferrer\">google &#39;linux network bridge&#39;</a> might be helpful (as you didn&#39;t know the term &#39;bridge&#39; before?)"}, {"owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "reply_to_user": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1448517538, "post_id": 33919656, "comment_id": 55623503, "body": "@artlessnoise I knew this term &#39;bridge&#39;. I just wanted to achieve this thing through my own kernel module so that I can achieve greater flexibility based on requirement and increase performance. All the google results shows that we need to use some commands to configure the bridge. But none is suggesting any tips or steps to follow to build a kernel module for it."}, {"owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "reply_to_user": {"reputation": 393, "user_id": 1015192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vR9UX.jpg?s=128&g=1", "display_name": "pedwards", "link": "https://stackoverflow.com/users/1015192/pedwards"}, "edited": false, "score": 0, "creation_date": 1448527055, "post_id": 33919656, "comment_id": 55627731, "body": "@pedwards Is it possible to get the broadcast ARPs using netfilter hooks or just the IP packets?"}, {"owner": {"reputation": 18888, "user_id": 1880339, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/0PkGx.png?s=128&g=1", "display_name": "artless noise", "link": "https://stackoverflow.com/users/1880339/artless-noise"}, "edited": false, "score": 0, "creation_date": 1448543540, "post_id": 33919656, "comment_id": 55638235, "body": "There are already some Linux components in the kernel that do bridging.  Why don&#39;t you like those (<code>brctl</code>, etc, not netfilter)?  Have you tried to use those?  Most everything you want exists.   Some things don&#39;t make sense to do in the kernel."}], "owner": {"reputation": 2389, "user_id": 3243499, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f14551e8ca190e92beaab157c3ebec7d?s=128&d=identicon&r=PG&f=1", "display_name": "user3243499", "link": "https://stackoverflow.com/users/3243499/user3243499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 759, "favorite_count": 1, "closed_date": 1448475703, "answer_count": 0, "score": 2, "last_activity_date": 1457269470, "creation_date": 1448463362, "last_edit_date": 1457269470, "question_id": 33919656, "link": "https://stackoverflow.com/questions/33919656/how-to-receive-modify-and-forward-ip-packets-between-ethernet-interfaces-inside", "closed_reason": "Needs more focus", "title": "How to receive, modify and forward IP packets between Ethernet Interfaces inside Kernel?", "body": "<p>I have searched on the web for the past few days. Every article or reference on the web is suggesting to go for IPTables and netfilter. I am aware of such tools and in fact used them to achieve the goal.</p>\n\n<p>But I am searching for a simple or minimalistic steps to follow the goal which is shown in the attached figure from inside the Linux kernel as a separate module.\n<a href=\"https://i.stack.imgur.com/rleya.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rleya.png\" alt=\"enter image description here\"></a></p>\n\n<p>Please note that I'm new to kernel module development and still in the learning phase. So, I'm sorry if the question is to na\u00efve or obvious.</p>\n\n<p><strong>Edited</strong></p>\n\n<p>Ok, so we can get the Ethernet frame using Netfilter hooks (Though we cannot explicitly mention which eth interface from). Since this question was put on hold and requested to narrow it down, I would like to know how can we do the following in a kernel module:</p>\n\n<ul>\n<li>Get a list of available Ethernet interfaces</li>\n<li>Select an Interface</li>\n<li>Send/inject an IP Packet to it</li>\n</ul>\n\n<p>I have done this from the userspace so I am looking for answers that are related to kernel space and not any userspace alternatives.</p>\n"}, {"tags": ["c", "pointers", "struct", "self-reference"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1448463376, "post_id": 33919592, "comment_id": 55600359, "body": "Adding some formatting will help you make your code more readable."}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1448463696, "post_id": 33919592, "comment_id": 55600592, "body": "you have to post <code>al_subList</code> and <code>al_clone</code> functions, i hope you are not returning a pointer to structs declared locally (from the stack)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448464248, "post_id": 33919592, "comment_id": 55600971, "body": "Are you aware you almost completely inhibit automatic type-checking by the compiler? This is quite a bad idea."}, {"owner": {"reputation": 58, "user_id": 5231146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ee9d9d89520e43cfd6a57014b11f60?s=128&d=identicon&r=PG&f=1", "display_name": "Killa", "link": "https://stackoverflow.com/users/5231146/killa"}, "reply_to_user": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 0, "creation_date": 1448465157, "post_id": 33919592, "comment_id": 55601616, "body": "@milevyo nope, i dont"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1448466548, "post_id": 33919592, "comment_id": 55602663, "body": "You should strongly consider using prototype declarations for the function pointer members of your <code>ArrayList</code> type."}], "answers": [{"comments": [{"owner": {"reputation": 1191, "user_id": 1494979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5a42225c94b0c8a29b03e83f683ff498?s=128&d=identicon&r=PG", "display_name": "Jupiter", "link": "https://stackoverflow.com/users/1494979/jupiter"}, "edited": false, "score": 0, "creation_date": 1448463785, "post_id": 33919745, "comment_id": 55600653, "body": "Won&#39;t the <code>struct ArrayList</code> and <code>... } ArrayList;</code> lines give a compiler error saying  something like <code>redefining the name ArrayList</code>?"}, {"owner": {"reputation": 58, "user_id": 5231146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ee9d9d89520e43cfd6a57014b11f60?s=128&d=identicon&r=PG&f=1", "display_name": "Killa", "link": "https://stackoverflow.com/users/5231146/killa"}, "edited": false, "score": 0, "creation_date": 1448464171, "post_id": 33919745, "comment_id": 55600917, "body": "i really appreciate your help, it fixed thanks!! now it works perflectly. This proyect is prerrequisite for my final exam."}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "reply_to_user": {"reputation": 58, "user_id": 5231146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ee9d9d89520e43cfd6a57014b11f60?s=128&d=identicon&r=PG&f=1", "display_name": "Killa", "link": "https://stackoverflow.com/users/5231146/killa"}, "edited": false, "score": 0, "creation_date": 1448464396, "post_id": 33919745, "comment_id": 55601070, "body": "@Killa, you have to accept the answer, or at least up vote for him (if possible)"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 1191, "user_id": 1494979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5a42225c94b0c8a29b03e83f683ff498?s=128&d=identicon&r=PG", "display_name": "Jupiter", "link": "https://stackoverflow.com/users/1494979/jupiter"}, "edited": false, "score": 0, "creation_date": 1448465811, "post_id": 33919745, "comment_id": 55602079, "body": "@Jupiter: No, <code>typedef</code>s and <code>struct</code>s use two different name spaces."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1448465870, "post_id": 33919745, "comment_id": 55602135, "body": "There is no redifinition. The identifier <code>ArrayList</code> lives in global scope, the identifier <code>struct ArrayList</code> lives in struct scope. These two scopes do not clash in C."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 1191, "user_id": 1494979, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5a42225c94b0c8a29b03e83f683ff498?s=128&d=identicon&r=PG", "display_name": "Jupiter", "link": "https://stackoverflow.com/users/1494979/jupiter"}, "edited": false, "score": 0, "creation_date": 1448466295, "post_id": 33919745, "comment_id": 55602467, "body": "@Jupiter maybe in C++ but this is C, so <code>struct ArrayList</code> is different to <code>ArrayList</code>. (I mean different syntactically. Semantically, the types are identical in this case.)"}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 4, "last_activity_date": 1448463598, "creation_date": 1448463598, "answer_id": 33919745, "question_id": 33919592, "link": "https://stackoverflow.com/questions/33919592/pointer-to-function-that-return-pointer-to-struct/33919745#33919745", "title": "pointer to function that return pointer to struct", "body": "<pre><code>typedef struct {\n    int reservedSize; // reserved size\n    int size; // Size of list\n    // ...\n    struct ArrayList* (*clone)(); //trouble1\n    struct ArrayList* (*subList)();//trouble2 \n} ArrayList;\n</code></pre>\n\n<p>By the time the compiler gets to the \"trouble\" lines there is no type named <code>struct ArrayList</code>.</p>\n\n<p>There is a struct type with no tagname being defined.</p>\n\n<p>At the end of that definition, there will be a type named <code>ArrayList</code> (a struct type with no tagname) defined.</p>\n\n<p>Solution:</p>\n\n<p>define the type <code>struct ArrayList</code></p>\n\n<pre><code>typedef struct ArrayList {             // define type with tagname\n    int reservedSize; // reserved size\n    int size; // Size of list\n    // ...\n    struct ArrayList* (*clone)(); //trouble1\n    struct ArrayList* (*subList)();//trouble2 \n} ArrayList;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "reply_to_user": {"reputation": 199084, "user_id": 56338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92fb4563ddc5ceeaa8b19b60a7a172f4?s=128&d=identicon&r=PG", "display_name": "sth", "link": "https://stackoverflow.com/users/56338/sth"}, "edited": false, "score": 0, "creation_date": 1448464109, "post_id": 33919873, "comment_id": 55600872, "body": "@sth i voted up for him. and i am inviting people to vote up for him, that what <code>All thanks goes to</code> means"}, {"owner": {"reputation": 199084, "user_id": 56338, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/92fb4563ddc5ceeaa8b19b60a7a172f4?s=128&d=identicon&r=PG", "display_name": "sth", "link": "https://stackoverflow.com/users/56338/sth"}, "edited": false, "score": 0, "creation_date": 1448465255, "post_id": 33919873, "comment_id": 55601690, "body": "Yeah I kind of confused you with the asker of the question"}], "tags": [], "owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "is_accepted": false, "score": 0, "last_activity_date": 1448463935, "creation_date": 1448463935, "answer_id": 33919873, "question_id": 33919592, "link": "https://stackoverflow.com/questions/33919592/pointer-to-function-that-return-pointer-to-struct/33919873#33919873", "title": "pointer to function that return pointer to struct", "body": "<p>All thanks goes to @pmg who points me.</p>\n\n<pre><code>typedef struct ArrayList ArrayList;\nstruct ArrayList{\n    int reservedSize; // reserved size\n    int size; // Size of list\n    void ** pElements; //pointer to list elements\n    void (*deleteArrayList)();\n    void (*add)();\n    void (*remove)();\n    void (*set)();\n    void* (*get)();\n    int (*indexOf)();\n    int (*len)();\n    void (*clear)();\n    void (*push)();\n    void* (*pop)();\n    int (*contains)();\n    int (*isEmpty)();\n    //Extras\n    int (* containsAll)();\n    struct ArrayList* (*clone)(); //trouble1\n    struct ArrayList* (*subList)();//trouble2 \n};\n</code></pre>\n"}], "owner": {"reputation": 58, "user_id": 5231146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6ee9d9d89520e43cfd6a57014b11f60?s=128&d=identicon&r=PG&f=1", "display_name": "Killa", "link": "https://stackoverflow.com/users/5231146/killa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 33919745, "answer_count": 2, "score": 0, "last_activity_date": 1448465535, "creation_date": 1448463188, "last_edit_date": 1448465535, "question_id": 33919592, "link": "https://stackoverflow.com/questions/33919592/pointer-to-function-that-return-pointer-to-struct", "title": "pointer to function that return pointer to struct", "body": "<p>I'm trying to code an kind of <code>ArrayList</code> (struct) defined as follow:</p>\n\n<pre><code>typedef struct {\n    int reservedSize; // reserved size\n    int size; // Size of list\n    void ** pElements; //pointer to list elements\n    void (*deleteArrayList)();\n    void (*add)();\n    void (*remove)();\n    void (*set)();\n    void* (*get)();\n    int (*indexOf)();\n    int (*len)();\n    void (*clear)();\n    void (*push)();\n    void* (*pop)();\n    int (*contains)();\n    int (*isEmpty)();\n    //Extras\n    int (* containsAll)();\n    struct ArrayList* (*clone)(); //trouble1\n    struct ArrayList* (*subList)();//trouble2 \n} ArrayList;\n</code></pre>\n\n<p>As you can see, two elements type <code>int</code>, and pointers to functions, but I only have troubles with the last two. I have an initializator as follows:</p>\n\n<pre><code>ArrayList* al_newArrayList(void) { \n    ArrayList* list;\n    list = (ArrayList *) malloc (sizeof(ArrayList));\n    list-&gt;size = 0;\n    list-&gt;pElements = malloc(sizeof(void *) * 10);\n    list-&gt;reservedSize = 10;\n    list-&gt;add = al_add;\n    list-&gt;deleteArrayList = al_deleteArrayList;\n    list-&gt;remove = al_remove;\n    list-&gt;set = al_set;\n    list-&gt;get = al_get;\n    list-&gt;indexOf = al_indexOf;\n    list-&gt;len = al_len;\n    list-&gt;clear = al_clear;\n    list-&gt;push = al_push;\n    list-&gt;pop = al_pop;\n    list-&gt;contains = al_contains;\n    list-&gt;isEmpty = al_isEmpty;\n    list-&gt;containsAll = al_containsAll;\n    list-&gt;clone = al_clone;//trouble1\n    list-&gt;subList = al_subList;//trouble2\n    return list;\n}\n</code></pre>\n\n<p>The program works but have a runtime error, and I have warnings about wrong referencing at:</p>\n\n<pre><code>list-&gt;clone = al_clone;//trouble1\nlist-&gt;subList = al_subList;//trouble2\n</code></pre>\n\n<p>Even those functions works but the program is closed. Do you have any idea? Wrong syntax?</p>\n"}, {"tags": ["c", "file", "linked-list"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 3, "creation_date": 1448462632, "post_id": 33919320, "comment_id": 55599765, "body": "<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\"><code>while (!feof(file))</code> is nearly always wrong.</a> Bonus comment: <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">do not cast the result of malloc in C.</a>"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1448462649, "post_id": 33919320, "comment_id": 55599780, "body": "<code>while (!feof(file))</code> is the wrong way to read a file in C. Also, check the return value from <code>fscanf</code>! And check if there really is a newline at the end of the file."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1448463789, "post_id": 33919320, "comment_id": 55600657, "body": "\\343\\203\\263 (that&#39;s a sequence of 3 characters expressed as an octal escape sequence) would be the UTF-8 encoding of \u30f3, so it looks like it&#39;s missed the last byte of the string for some reason."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448463885, "post_id": 33919320, "comment_id": 55600714, "body": "I&#39;d expect <code>fscanf(file, &quot;%d\\t%649[^\\t\\n]\\n&quot;, &amp;artist_ID, artist_name);</code>  649 vs 65"}, {"owner": {"reputation": 399, "user_id": 4628805, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1deef7f04e12d9c009a8f4fdd5200864?s=128&d=identicon&r=PG", "display_name": "Root0x", "link": "https://stackoverflow.com/users/4628805/root0x"}, "edited": false, "score": 0, "creation_date": 1448464015, "post_id": 33919320, "comment_id": 55600803, "body": "My professor told us to use that format string so that we only use 65 characters from that string"}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 1, "creation_date": 1448464248, "post_id": 33919320, "comment_id": 55600970, "body": "@Root0x but the string it&#39;s failing on is 66 bytes long...."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 1, "creation_date": 1448464286, "post_id": 33919320, "comment_id": 55600998, "body": "@ryyker 649 is 1 less than the size of <code>artist_name[650]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "is_accepted": true, "score": 3, "last_activity_date": 1448474563, "last_edit_date": 1495540760, "creation_date": 1448463145, "answer_id": 33919579, "question_id": 33919320, "link": "https://stackoverflow.com/questions/33919320/issue-reading-japanese-characters-from-file-c/33919579#33919579", "title": "Issue reading Japanese characters from file - C", "body": "<p>As the comments indicate, one problem is with <strong><em><a href=\"https://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\">while(!feof(file))</a></em></strong> The linked content will explain in detail why this is not a good idea, but in summary, quoting from one of the answers in the link:</p>\n\n<p>(!feof(file))...</p>\n\n<blockquote>\n  <p>...is wrong because it tests for something that is\n  irrelevant and fails to test for something that you need to know. The\n  result is that you are erroneously executing code that assumes that it\n  is accessing data that was read successfully, when in fact this never\n  happened. - Kerrek SB</p>\n</blockquote>\n\n<p>In your case, this usage does not cause your problem, but as Kerrek explains might happen, <em>masks</em> it.  </p>\n\n<p>You can replace that with <code>fgets(...)</code>:  </p>\n\n<pre><code>char lineBuf[1000];//make length longer or shorter for your purpose\nfile = fopen(\"/Users/Daniel/Library/Developer/Xcode/DerivedData/project_Audioscrobbler_Artists-hgwyqpinuoxayzbmvarcjxryqnrz/Build/Products/Debug/artist_data.txt\", \"r\");\nif(!file) return -1;\nwhile(fgets (lineBuf, sizeof(lineBuf), file))\n{\n    //process each line here\n    //But processing Japanese characters\n    //will require special considerations.\n    //Refer to the link below for UNICODE tips\n}\n</code></pre>\n\n<p><strong><em><a href=\"http://www.cprogramming.com/tutorial/unicode.html\" rel=\"nofollow noreferrer\">Unicode in C and C++...</a></em></strong></p>\n\n<p>In particular, you will need to use variable types that are sufficient for containing the different size characters you will be processing.  The link discusses this in great detail.</p>\n\n<p><strong><em>Here is an excerpt:</em></strong>    </p>\n\n<blockquote>\n<pre><code>\"char\" no longer means character\nI hereby recommend referring to character codes in C programs using a 32-bit unsigned integer type. Many platforms provide a\n</code></pre>\n  \n  <p>\"wchar_t\" (wide character) type, but unfortunately it is to be avoided\n  since some compilers allot it only 16 bits\u2014not enough to represent\n  Unicode. Wherever you need to pass around an individual character,\n  change \"char\" to \"unsigned int\" or similar. The only remaining use for\n  the \"char\" type is to mean \"byte\".</p>\n</blockquote>\n\n<p><strong><em>Edit:</em></strong><br>\nIn the comments above, you state <em>but the string it's failing on is 66 bytes long</em>.  Because you are reading into a 'char' array, the bytes necessary to complete the character were truncated one byte before including the last necessary byte.  ASCII characters can be contained in a single <code>char</code> space.  Japanese characters cannot.    If you were using an array of <code>unsigned int</code> instead of array of <code>char</code>, the last byte would have been included.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1448465916, "last_edit_date": 1495539880, "creation_date": 1448465481, "answer_id": 33920425, "question_id": 33919320, "link": "https://stackoverflow.com/questions/33919320/issue-reading-japanese-characters-from-file-c/33920425#33920425", "title": "Issue reading Japanese characters from file - C", "body": "<p>OP's code failed because the result of <code>fscanf()</code> was not checked.</p>\n\n<pre><code>fscanf(file, \"%d\\t%65[^\\t\\n]\\n\", &amp;artist_ID, artist_name);\n</code></pre>\n\n<p>The <code>fscanf()</code> read in 65 <code>char</code> of <code>\"\u30a8\u30ea\u30b9 \u30ec\u30b8\u30fc\u30ca\uff0f\u30a2\u30f3\u30c8\u30cb\u30aa \u30ab\u30eb\u30ed\u30b9 \u30b8\u30e7\u30d3\u30f3\"</code>.  Yet this string, encoded in UTF8, has a length of 66.  The last <code>'\u30f3'</code> is codes 227, 131, 179 (octal 343 203 263) and only the last 2 were read.  When <code>artist_name</code> is printed the following appears.</p>\n\n<pre><code>\u30a8\u30ea\u30b9 \u30ec\u30b8\u30fc\u30ca\uff0f\u30a2\u30f3\u30c8\u30cb\u30aa \u30ab\u30eb\u30ed\u30b9 \u30b8\u30e7\u30d3\\343\\203\n</code></pre>\n\n<p>Now begins the problem.  The last <code>char 179</code> remains in in <code>file</code>.  On the <em>next</em> <code>fscanf()</code>, it fails as <code>char 179</code> does not convert into a <code>int</code>  (<code>\"%d\"</code>).  So <code>fscanf()</code> returns 0.  Since code did not check the result of <code>fscanf()</code>, it does not realize <code>artist_ID</code> and <code>artist_name</code> are left over from before and so prints the same text.</p>\n\n<p>As <code>feof()</code> is never true for the <code>char 179</code> is not consumed, we have infinite loop.  </p>\n\n<p>The <code>while(!feof(file))</code> hid this problem, but did not cause it.</p>\n\n<p>The <code>fgets()</code> proposed by <a href=\"https://stackoverflow.com/a/33919579/2410359\">@ryyker</a> is a good approach.  Another is:</p>\n\n<pre><code>while (fscanf(file, \"%d\\t%65[^\\t\\n]\\n\", &amp;artist_ID, artist_name) == 2) {\n    temp = create_play(artist_ID, artist_name, 0, -1);\n    head = add_play(head, temp);\n    printf(\"%s\\n\", artist_name);\n    }\n</code></pre>\n\n<p>IOWs, validate the results of <code>*scanf()</code>.</p>\n"}], "owner": {"reputation": 399, "user_id": 4628805, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1deef7f04e12d9c009a8f4fdd5200864?s=128&d=identicon&r=PG", "display_name": "Root0x", "link": "https://stackoverflow.com/users/4628805/root0x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 33919579, "answer_count": 2, "score": 3, "last_activity_date": 1448474563, "creation_date": 1448462378, "question_id": 33919320, "link": "https://stackoverflow.com/questions/33919320/issue-reading-japanese-characters-from-file-c", "title": "Issue reading Japanese characters from file - C", "body": "<p>I am writing a program which reads a file with almost 2 million lines. The file is in the format integer ID tab with an artist name string.</p>\n\n<pre><code>6821361 Selinsgrove High School Chorus\n10151460    greek-Antique\n10236365    jnr walker &amp; the all-stars\n6878792 Grieg - Kraggerud, Kjekshus\n6880556 Mr. Oiseau\n6906305 stars on 54 (maxi single)\n10584525    Jonie Mitchel\n10299729    \u30a8\u30ea\u30b9 \u30ec\u30b8\u30fc\u30ca\uff0f\u30a2\u30f3\u30c8\u30cb\u30aa \u30ab\u30eb\u30ed\u30b9 \u30b8\u30e7\u30d3\u30f3\n</code></pre>\n\n<p>Above is an example with some items from the file (not some lines do not follow the specific format). My program work file until it gets to the last line from the example then it endlessly prints <code>\u30a8\u30ea\u30b9 \u30ec\u30b8\u30fc\u30ca\uff0f\u30a2\u30f3\u30c8\u30cb\u30aa \u30ab\u30eb\u30ed\u30b9 \u30b8\u30e7\u30d3\\343\\203</code>.</p>\n\n<pre><code>struct artist *read_artists(char *fname)\n{\n    FILE *file;\n    struct artist *temp = (struct artist*)malloc(sizeof(struct artist));\n    struct artist *head = (struct artist*)malloc(sizeof(struct artist));\n    file = fopen(\"/Users/Daniel/Library/Developer/Xcode/DerivedData/project_Audioscrobbler_Artists-hgwyqpinuoxayzbmvarcjxryqnrz/Build/Products/Debug/artist_data.txt\", \"r\");\n    if(file == 0)\n    {\n        perror(\"fopen\");\n        exit(1);\n    }\n    int artist_ID;\n    char artist_name[650];\n    while(!feof(file))\n    {\n        fscanf(file, \"%d\\t%65[^\\t\\n]\\n\", &amp;artist_ID, artist_name);\n        temp = create_play(artist_ID, artist_name, 0, -1);\n        head = add_play(head, temp);\n        printf(\"%s\\n\", artist_name);\n    }\n    fclose(file);\n    //print_plays(head);\n    return head;\n}\n</code></pre>\n\n<p>Above is my code for reading from the file. Can you please help explain what is wrong?</p>\n"}, {"tags": ["c", "perl", "web-services"], "comments": [{"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 1, "creation_date": 1448470647, "post_id": 33919268, "comment_id": 55605454, "body": "Of course. All things are possible in C. You could even write an entire operating system in C if you wanted to."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "edited": false, "score": 0, "creation_date": 1448462824, "post_id": 33919389, "comment_id": 55599933, "body": "The problem with using LIBCURL, and i apologize for not specifying it before that its not available on HP Unix machines. Also how efficient would reading the output of a STDOUT be? i know that it&#39;s a ghetto way of doing it but there should be another way to do it via C itself."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "edited": false, "score": 0, "creation_date": 1448464236, "post_id": 33919389, "comment_id": 55600962, "body": "It won&#39;t compile on HP machines? I find that hard to believe &quot;<i>libcurl is highly portable, it builds and works identically on numerous platforms, including Solaris, NetBSD, FreeBSD, OpenBSD, Darwin, <b>HPUX</b>, IRIX, AIX, Tru64, Linux, UnixWare, HURD, Windows, Amiga, OS/2, BeOs, Mac OS X, Ultrix, QNX, OpenVMS, RISC OS, Novell NetWare, DOS and more...</i>&quot;"}, {"owner": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "edited": false, "score": 0, "creation_date": 1448465177, "post_id": 33919389, "comment_id": 55601626, "body": "We do not have it available for our HPUX machines. only our Linux have it unfortunately."}, {"owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "reply_to_user": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "edited": false, "score": 0, "creation_date": 1448465310, "post_id": 33919389, "comment_id": 55601733, "body": "I don&#39;t follow. You keep saying it&#39;s not <i>available</i> to you, but it&#39;s available to whole world. The question is whether it <i>compiles</i> or not."}, {"owner": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "edited": false, "score": 0, "creation_date": 1448466241, "post_id": 33919389, "comment_id": 55602426, "body": "It doesn&#39;t compile because it does not exist on our machines. And i don&#39;t have the admin rights to install it. For some reason they will not install it on our Unix Machines. If I did have it , I bet it would compile just fine."}, {"owner": {"reputation": 420, "user_id": 2281645, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/94ECq.jpg?s=128&g=1", "display_name": "Tanner", "link": "https://stackoverflow.com/users/2281645/tanner"}, "edited": false, "score": 1, "creation_date": 1448468453, "post_id": 33919389, "comment_id": 55603964, "body": "You should be able to do a local install for your own use without admin rights."}], "tags": [], "owner": {"reputation": 320781, "user_id": 589924, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b2cf53d5a3d25f95c0db4e025aed4153?s=128&d=identicon&r=PG", "display_name": "ikegami", "link": "https://stackoverflow.com/users/589924/ikegami"}, "is_accepted": false, "score": 0, "last_activity_date": 1448462578, "last_edit_date": 1592644375, "creation_date": 1448462578, "answer_id": 33919389, "question_id": 33919268, "link": "https://stackoverflow.com/questions/33919268/calling-a-restful-web-service-in-c/33919389#33919389", "title": "Calling a Restful web service in C", "body": "<blockquote>\n<p><em>Is there anyway you can call web services in C on a Unix machine?</em></p>\n<p>Is there a way to make HTTP requests in C on a unix machine?</p>\n</blockquote>\n<p>Well, yeah. You could use libcurl, among others.</p>\n<hr />\n<blockquote>\n<p><em>One theory I have is for the C program to call a PERL script that calls and returns the output to me back to C.</em></p>\n<p>Can a C program execute a Perl script and capture its output?</p>\n</blockquote>\n<p>Yeah. Just replace the child's STDOUT with a pipe and read from the pipe.</p>\n"}], "owner": {"reputation": 125, "user_id": 2581290, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/AloEc.png?s=128&g=1", "display_name": "PopperJuan", "link": "https://stackoverflow.com/users/2581290/popperjuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448462578, "creation_date": 1448462236, "question_id": 33919268, "link": "https://stackoverflow.com/questions/33919268/calling-a-restful-web-service-in-c", "title": "Calling a Restful web service in C", "body": "<p>I have a C program that I have to convert SQL queries to instead call a web service. Is there anyway you can call web services in C on a Unix machine? Re-writing the code is not really an option for since it's a good 5000 line program. One theory I have is for the C program to call a PERL script that calls and returns the output to me back to C. What options do I have to tackle this issue?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 39, "user_id": 4451481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa2195c07ea16916ebf2759198b0701?s=128&d=identicon&r=PG&f=1", "display_name": "psofoklis11", "link": "https://stackoverflow.com/users/4451481/psofoklis11"}, "edited": false, "score": 0, "creation_date": 1448461971, "post_id": 33919119, "comment_id": 55599310, "body": "I initialize counter but the result is the same"}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 2, "creation_date": 1448462011, "post_id": 33919119, "comment_id": 55599343, "body": "Null terminate your array: <code>con[0] = &#39;\\0&#39;</code>;"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1448466241, "post_id": 33919119, "comment_id": 55602427, "body": "Also, you might need to add <code>if(token)</code> just before <code>strcat(con,&quot; &quot;);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4451481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa2195c07ea16916ebf2759198b0701?s=128&d=identicon&r=PG&f=1", "display_name": "psofoklis11", "link": "https://stackoverflow.com/users/4451481/psofoklis11"}, "edited": false, "score": 0, "creation_date": 1448461996, "post_id": 33919139, "comment_id": 55599329, "body": "I initialize counter but result is the same"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 39, "user_id": 4451481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa2195c07ea16916ebf2759198b0701?s=128&d=identicon&r=PG&f=1", "display_name": "psofoklis11", "link": "https://stackoverflow.com/users/4451481/psofoklis11"}, "edited": false, "score": 1, "creation_date": 1448462037, "post_id": 33919139, "comment_id": 55599351, "body": "@psofoklis11 Initialize con. Like <code>char con[256] = &quot;&quot;;</code>"}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 3, "last_activity_date": 1448462104, "last_edit_date": 1448462104, "creation_date": 1448461890, "answer_id": 33919139, "question_id": 33919119, "link": "https://stackoverflow.com/questions/33919119/strtok-strcat-unexpected-output/33919139#33919139", "title": "strtok() strcat() Unexpected output", "body": "<p><code>counter</code> and array <code>con</code> is uninitialized . So it will lead to erroneous results.</p>\n"}, {"tags": [], "owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "is_accepted": true, "score": 3, "last_activity_date": 1448466417, "last_edit_date": 1448466417, "creation_date": 1448461977, "answer_id": 33919168, "question_id": 33919119, "link": "https://stackoverflow.com/questions/33919119/strtok-strcat-unexpected-output/33919168#33919168", "title": "strtok() strcat() Unexpected output", "body": "<ol>\n<li><p><code>strcat</code> expects the first argument to be null-terminated, which isn't guaranteed by declaring <code>con</code>, since its uninitialized. so the invocation of <code>strcat</code> is <strong>undefined behavior</strong>. Therefore your program is undefined behavior. Do</p>\n\n<pre><code>con[0] = '\\0';\n</code></pre>\n\n<p>to resolve this issue.</p></li>\n<li><p><code>counter</code> is uninitialized. Using it in an expression is undefined behavior too.</p></li>\n</ol>\n"}], "owner": {"reputation": 39, "user_id": 4451481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa2195c07ea16916ebf2759198b0701?s=128&d=identicon&r=PG&f=1", "display_name": "psofoklis11", "link": "https://stackoverflow.com/users/4451481/psofoklis11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 33919168, "answer_count": 2, "score": 2, "last_activity_date": 1448466417, "creation_date": 1448461839, "last_edit_date": 1448464930, "question_id": 33919119, "link": "https://stackoverflow.com/questions/33919119/strtok-strcat-unexpected-output", "title": "strtok() strcat() Unexpected output", "body": "<pre><code>#include \"stdio.h\"\n#include \"string.h\"\n\nint main(){\n    int counter;\n    char *token;\n    char s[]={\"I am John\"};\n    char con[256];\n    token = strtok(s,\" \");\n    while(token != NULL){\n        if (counter==0){\n            strcat(con,token);\n            token = strtok(NULL,\" \");\n            counter++;\n        }else{\n            strcat(con,token);\n            token = strtok(NULL,\" \");\n            strcat(con,\" \");\n        }\n\n    }\n    printf(\"%s\\n\",con);\n    return 0;\n}`\n</code></pre>\n\n<p><code>printf()</code>'s output is \"I am John\"\nI would like the output to be \"am John\"</p>\n"}, {"tags": ["c++", "c", "linux", "linker-errors", "undefined-reference"], "comments": [{"owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "edited": false, "score": 4, "creation_date": 1448461360, "post_id": 33918921, "comment_id": 55598864, "body": "You have a linker error; it is not a header file but an implementation file that you are missing (be that a source file or a pre-compiled library). If you were missing a header, presumably you would have an error before the linking stage (e.g., a <code>no such function exists</code> error)."}], "answers": [{"tags": [], "owner": {"reputation": 19923, "user_id": 66519, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/83ea6683f15edb2087f6a3ad4f42605b?s=128&d=identicon&r=PG", "display_name": "ojblass", "link": "https://stackoverflow.com/users/66519/ojblass"}, "is_accepted": true, "score": 3, "last_activity_date": 1448461738, "creation_date": 1448461738, "answer_id": 33919088, "question_id": 33918921, "link": "https://stackoverflow.com/questions/33918921/how-to-find-the-missing-dependency-in-failed-compilation/33919088#33919088", "title": "How to find the missing dependency in failed compilation?", "body": "<p>The header file example you present is a compile time error.  The compiler knows about the files and can present you with what is missing.  The error you are presenting above is a link time error.  </p>\n\n<p>The one you present is a common one and it is that a symbol is not defined.  Usually this happens because a library was excluded from the linker line.  Another common source of this error is that the library you are linking to is older than the one expected for the program.</p>\n\n<p>Usually I find myself trolling Google for articles like <a href=\"https://github.com/PacificBiosciences/blasr/issues/4\" rel=\"nofollow\">this one</a> when presented with such errors.  The packaging manager does not track function level details when accounting for files or libraries.  I always thought it would be nice enhancement to inspect libraries with the nm command and put that meta data into packaging systems.  </p>\n"}, {"comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 2, "creation_date": 1448462310, "post_id": 33919095, "comment_id": 55599542, "body": "Yes, Google is what I always use. Copy the error message into the Google search field, perhaps add the program name, and you are likely to find a discussion about the error and how to solve it. When I&#39;m on Ubuntu I might also add &quot;apt-get&quot; and &quot;install&quot;, to directly find instructions on how to install the missing parts!"}], "tags": [], "owner": {"reputation": 29117, "user_id": 1587329, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/UWmiP.png?s=128&g=1", "display_name": "serv-inc", "link": "https://stackoverflow.com/users/1587329/serv-inc"}, "is_accepted": false, "score": 3, "last_activity_date": 1448474738, "last_edit_date": 1448474738, "creation_date": 1448461768, "answer_id": 33919095, "question_id": 33918921, "link": "https://stackoverflow.com/questions/33918921/how-to-find-the-missing-dependency-in-failed-compilation/33919095#33919095", "title": "How to find the missing dependency in failed compilation?", "body": "<p>(This is not a generic answer, but) In this case, <a href=\"https://www.google.de/search?q=SZ_BufftoBuffDecompress\" rel=\"nofollow\">googling SZ_BufftoBuffDecompress</a> gave, among others, the link to <a href=\"https://github.com/PacificBiosciences/blasr/issues/4\" rel=\"nofollow\">https://github.com/PacificBiosciences/blasr/issues/4</a>, where it is <a href=\"https://github.com/ylipacbio\" rel=\"nofollow\">suggested</a></p>\n\n<blockquote>\n  <p>It seems that the hdf5 library is not correctly installed. The hdf5 lib that you used requires szip library. So you may need to install szip lib first and then re-make your hdf5 package (linking it with the szip lib, -lsz). </p>\n</blockquote>\n\n<p>So it seems as though the <strong>missing dependency is szip</strong>.</p>\n\n<p>As for <strong>general searching</strong>, @Thomas Padron-McCarthy's comment sensibly advises to </p>\n\n<blockquote>\n  <p>perhaps add the program name</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>on Ubuntu I might also add <code>apt-get</code> and <code>install</code>, to directly find instructions on how to install the missing parts!</p>\n</blockquote>\n\n<p>If you <strong>only need the software</strong>, and do not feel the need to compile it yourself, have a look at the github post. <a href=\"https://github.com/sjackman\" rel=\"nofollow\">Another poster</a> </p>\n\n<blockquote>\n  <p>suggest[s] using <a href=\"http://brew.sh/\" rel=\"nofollow\">Homebrew</a> and Linuxbrew to install <a href=\"https://github.com/Homebrew/homebrew-science\" rel=\"nofollow\">science</a> software on Mac and Linux, repsectively[sic].</p>\n</blockquote>\n"}], "owner": {"reputation": 5139, "user_id": 3293148, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/a5b0a16cfd67f7e3944d886fd1bebde5?s=128&d=identicon&r=PG", "display_name": "Jasmine Lognnes", "link": "https://stackoverflow.com/users/3293148/jasmine-lognnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "accepted_answer_id": 33919088, "answer_count": 2, "score": 2, "last_activity_date": 1448474738, "creation_date": 1448461218, "last_edit_date": 1448463097, "question_id": 33918921, "link": "https://stackoverflow.com/questions/33918921/how-to-find-the-missing-dependency-in-failed-compilation", "title": "How to find the missing dependency in failed compilation?", "body": "<p>Sometimes when compiling the errors output the name of a header file that is missing, and the package it comes from can be tracked down using the Linux package manager.</p>\n\n<p>But how to find the missing dependency when the error is of the sort below, where it doesn't give you the name of the missing header file?</p>\n\n<pre><code>make[2]: *** [examples/undocumented/libshogun/base_map_parameters] Error 1\nCMakeFiles/Makefile2:916: recipe for target 'examples/undocumented/libshogun/CMakeFiles/base_map_parameters.dir/all' failed\nmake[1]: *** [examples/undocumented/libshogun/CMakeFiles/base_map_parameters.dir/all] Error 2\n../../../src/shogun/libshogun.so.17.1: undefined reference to `SZ_BufftoBuffDecompress'\n../../../src/shogun/libshogun.so.17.1: undefined reference to `SZ_encoder_enabled'\n../../../src/shogun/libshogun.so.17.1: undefined reference to `SZ_BufftoBuffCompress'\ncollect2: error: ld returned 1 exit status\nexamples/undocumented/libshogun/CMakeFiles/base_migration_dropping_and_new.dir/build.make:129: recipe for target 'examples/undocumented/libshogun/base_migration_dropping_and_new' failed\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 754, "user_id": 666066, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/fI4uL.jpg?s=128&g=1", "display_name": "KeithSmith", "link": "https://stackoverflow.com/users/666066/keithsmith"}, "edited": false, "score": 5, "creation_date": 1448461164, "post_id": 33918810, "comment_id": 55598729, "body": "Look in read_data(). Where is the storage for the upto 25 characters read by fgets()? s is a pointer. What does it point to?"}, {"owner": {"reputation": 2000, "user_id": 4487286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YHZoO.jpg?s=128&g=1", "display_name": "milevyo", "link": "https://stackoverflow.com/users/4487286/milevyo"}, "edited": false, "score": 1, "creation_date": 1448461273, "post_id": 33918810, "comment_id": 55598802, "body": "in read_data <code>char *s</code> points to anywhere or nothing"}, {"owner": {"reputation": 135, "user_id": 5200975, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/950102218381326/picture?type=large", "display_name": "KennyYang", "link": "https://stackoverflow.com/users/5200975/kennyyang"}, "edited": false, "score": 0, "creation_date": 1448461399, "post_id": 33918810, "comment_id": 55598901, "body": "so..after the first read_data(), s points to the end of the string..?"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 2, "creation_date": 1448461552, "post_id": 33918810, "comment_id": 55599022, "body": "@KennyYang: No, your <code>s</code> pointer in <code>read_data</code> is never set to point to anything. This gives what the C standard calls &quot;undefined behaviour&quot;, and anything can happen."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1448461556, "post_id": 33918810, "comment_id": 55599024, "body": "Um no. <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\">What in its description</a> makes you think so? <code>s</code> points to &#39;nothing&#39; \u2013 it has no defined value."}, {"owner": {"reputation": 135, "user_id": 5200975, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/950102218381326/picture?type=large", "display_name": "KennyYang", "link": "https://stackoverflow.com/users/5200975/kennyyang"}, "edited": false, "score": 0, "creation_date": 1448461927, "post_id": 33918810, "comment_id": 55599281, "body": "ok, I have fixed this problem by petting the s pointer in main. But I am still confused that why it points to nothing if I call the function again, which will define the s pointer again."}], "answers": [{"comments": [{"owner": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "edited": false, "score": 2, "creation_date": 1448462489, "post_id": 33919099, "comment_id": 55599664, "body": "I think that char s[25] would be more appropriate because that will match the fgets(,25,) he has. Also, KennyYang may consider defining something like #define BUFFER_LEN 25 and use BUFFER_LEN in s[] declaration as well as in fgets (..)."}, {"owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "reply_to_user": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "edited": false, "score": 0, "creation_date": 1448462919, "post_id": 33919099, "comment_id": 55600006, "body": "I agree.  That <code>#define</code> is the best approach."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1448466766, "post_id": 33919099, "comment_id": 55602836, "body": "IMHO: <code>char s[200]; ...  fgets(s,sizeof s, fptr)</code> is even better."}, {"owner": {"reputation": 2799, "user_id": 1747493, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ro2p4.jpg?s=128&g=1", "display_name": "Harald", "link": "https://stackoverflow.com/users/1747493/harald"}, "edited": false, "score": 0, "creation_date": 1448470446, "post_id": 33919099, "comment_id": 55605323, "body": "Uh! chux, that is also a very neat solution!"}], "tags": [], "owner": {"reputation": 2385, "user_id": 2565958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be3bcf62e85eadc0ff5d40429813e2a3?s=128&d=identicon&r=PG", "display_name": "donjuedo", "link": "https://stackoverflow.com/users/2565958/donjuedo"}, "is_accepted": true, "score": 0, "last_activity_date": 1448461775, "creation_date": 1448461775, "answer_id": 33919099, "question_id": 33918810, "link": "https://stackoverflow.com/questions/33918810/confusion-in-read-write-text-file-in-c/33919099#33919099", "title": "confusion in read/write text file in c", "body": "<p>In <code>read_data()</code>, replace</p>\n\n<pre><code>char *s;\n</code></pre>\n\n<p>with</p>\n\n<pre><code>char s[200];\n</code></pre>\n\n<p>and you will have a valid <code>s</code>.  This allocates 200 bytes on the stack, and you (<code>fgets()</code>) can safely write something there and use it.</p>\n"}], "owner": {"reputation": 135, "user_id": 5200975, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/950102218381326/picture?type=large", "display_name": "KennyYang", "link": "https://stackoverflow.com/users/5200975/kennyyang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 33919099, "answer_count": 1, "score": 2, "last_activity_date": 1448461775, "creation_date": 1448460960, "last_edit_date": 1448461505, "question_id": 33918810, "link": "https://stackoverflow.com/questions/33918810/confusion-in-read-write-text-file-in-c", "title": "confusion in read/write text file in c", "body": "<p>I am trying to do some simple read/write in a .txt file. I write a function for reading the content, and another for write back the content-1. </p>\n\n<p>For example, the content in the \"counter.txt\" is 20. After doing my code, I suppose the console output should show like:</p>\n\n<p>index now is:20</p>\n\n<p>index now is:19</p>\n\n<p>But that shows 20 and 0, I don't understand why. Thanks for your help!</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint read_data() {\n    FILE *fptr;\n    char *s;\n    fptr = fopen(\"counter.txt\",\"r\");\n    if (!fptr) {\n        printf(\"fail to open..\\n\");\n        exit(1);\n    }\n\n    fgets(s,25,fptr);\n    fclose(fptr);\n\n    return atoi(s);\n}\n\nvoid write_data(char *s) {\n    FILE *fptr;\n    fptr = fopen(\"counter.txt\",\"w\");\n    if (!fptr) {\n        printf(\"fail to open..\\n\");\n        exit(1);\n    }\n\n    fputs(s,fptr);\n    fclose(fptr);\n}\n\nint main(void) {\n    char index_str[5];\n    int index = read_data();\n    printf(\"index now is:%d\\n\", index);\n    sprintf(index_str,\"%d\",index-1);\n    write_data(index_str);\n\n    index = read_data();\n    printf(\"index now is:%d\\n\", index);\n    sprintf(index_str,\"%d\",index-1);\n    write_data(index_str);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "microchip", "xc8"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448458931, "post_id": 33917962, "comment_id": 55597104, "body": "Standard integer conversions and undefined behaviour."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1448459173, "post_id": 33917962, "comment_id": 55597274, "body": "This is undefined behavior if <code>int</code> is 16 bits due to the left shift. What is <code>sizeof(int)</code>?"}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1448460481, "post_id": 33917962, "comment_id": 55598258, "body": "Then it&#39;s UB. If you change <code>((int16_t)msb)</code> into <code>((uint16_t)msb)</code>, you will get rid of the undefined behavior, although it will still be implementation-defined."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 0, "creation_date": 1448460610, "post_id": 33917962, "comment_id": 55598353, "body": "the cast to <code>int16_t</code> is redundant and just reduces readability because those values will be promoted to int anyway."}], "answers": [{"comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 1, "creation_date": 1448459321, "post_id": 33918158, "comment_id": 55597402, "body": "It&#39;s only undefined if <code>int</code> is 16 bits, because integer promotion is performed before the shift."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1448459495, "post_id": 33918158, "comment_id": 55597515, "body": "@interjay, see my edit, in the other case the UB is in the conversion to <code>int16_t</code>."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1448459594, "post_id": 33918158, "comment_id": 55597590, "body": "If int is larger, the conversion to <code>int16_t</code> would be implementation defined."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1448459735, "post_id": 33918158, "comment_id": 55597709, "body": "If overflow there is in the conversion from <code>int</code> to <code>int16_t</code>, the behavior of that overflow is implementation-defined (it can be an implementation-defined signal, but it isn&#39;t one very often on modern architectures, even embedded ones)."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1448460064, "post_id": 33918158, "comment_id": 55597956, "body": "For some reason you like to use a circumlocution like \u201cnot having defined behavior\u201d for illegal uses of signed left shift, but it is explicitly named \u201cundefined behavior\u201d in the standard. As someone who insists others use the mot juste (<a href=\"http://www.openwall.com/lists/musl/2015/07/17/2\" rel=\"nofollow noreferrer\">openwall.com/lists/musl/2015/07/17/2</a> ), it would be simpler just to call it what it is called in the standard."}, {"owner": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "edited": false, "score": 0, "creation_date": 1448460157, "post_id": 33918158, "comment_id": 55598021, "body": "The shift works as expected and (((((int16_t)msb)&lt;&lt;8) + (int16_t)lsb)) evaluates correctly but not with the add of the int8_t at the end."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1448460218, "post_id": 33918158, "comment_id": 55598063, "body": "@PascalCuoq, I do that for a reason. The primary problem of code is usually that it is erroneous. UB is only a consequence of that, and I think the term is too often mystified. The primary goal of the C standard is to define behavior of code not to serve as excuse for nasal daemons."}, {"owner": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "edited": false, "score": 0, "creation_date": 1448460450, "post_id": 33918158, "comment_id": 55598237, "body": "So how should it be done?  A 16-bit value fetched as two bytes from eeprom and a signed char added to that. All being unsigned chars when fetched."}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "edited": false, "score": 0, "creation_date": 1448460624, "post_id": 33918158, "comment_id": 55598358, "body": "@Frog, this depends on the semantic that you want your operation to have. The result of the mathematical operation is a value that is larger than <code>INT16_MAX</code>. What do you want that to be?"}, {"owner": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "edited": false, "score": 0, "creation_date": 1448461012, "post_id": 33918158, "comment_id": 55598618, "body": "As I say above  msb&lt;&lt;8 + lsb is a signed 16-bit integer and hyst is a signed char.  But as it looks if I go with an intermediate uint16_t  and then cast the result to int16-t it all works.  I think gcc do a better job of this standard way or not."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448463266, "post_id": 33918158, "comment_id": 55600284, "body": "Any reason my comment was deleted?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1448463598, "post_id": 33918158, "comment_id": 55600528, "body": "@interjay: This is for PIC16 MCUs. So, <code>int</code>does have 16 bits."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 1, "last_activity_date": 1448459951, "last_edit_date": 1448459951, "creation_date": 1448459252, "answer_id": 33918158, "question_id": 33917962, "link": "https://stackoverflow.com/questions/33917962/casting-uint8-t-to-int8-t/33918158#33918158", "title": "Casting uint8_t to int8_t", "body": "<p>As Olaf correctly remarked, the shift operation may have no defined behavior if <code>int</code> has a width of 16 since you are shifting a bit into the sign bit of the <code>int16_t</code>. Then your code is erroneous and you can't deduce anything about the value that your platform might realized.</p>\n\n<p>If <code>int</code> is larger, everything is fine for the expression, you are only adding up positive values that fit into <code>int</code>. But the resulting value then will be converted back to <code>int16_t</code> due to the initialization, which results in an \"implementation defined\" conversion or the raise of a signal. So you should check your compiler documentation what your platform does in these cases, and it is probably a good idea to avoid it if you can.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448463389, "post_id": 33919022, "comment_id": 55600370, "body": "In general you should not mix signed and unsigned. If you assemble bitfields, using unsigned is often the way to go."}], "tags": [], "owner": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "is_accepted": false, "score": 0, "last_activity_date": 1448461530, "creation_date": 1448461530, "answer_id": 33919022, "question_id": 33917962, "link": "https://stackoverflow.com/questions/33917962/casting-uint8-t-to-int8-t/33919022#33919022", "title": "Casting uint8_t to int8_t", "body": "<p>OK from the comments</p>\n\n<pre><code>int16_t test;\nuint8_t msb = 0xff;\nuint8_t lsb = 0xf4;\nuint8_t hyst = 0xff; \n\ntest = (int16_t)(((uint16_t)msb)&lt;&lt;8) + (uint16_t)lsb) + (int8_t)hyst;\n</code></pre>\n\n<p>solves the problem. Thank you guys!</p>\n"}], "owner": {"reputation": 33, "user_id": 5604379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42a0fde4910674e712dcdbe760fb726b?s=128&d=identicon&r=PG", "display_name": "Frog", "link": "https://stackoverflow.com/users/5604379/frog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3052, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1448461530, "creation_date": 1448458726, "last_edit_date": 1448459267, "question_id": 33917962, "link": "https://stackoverflow.com/questions/33917962/casting-uint8-t-to-int8-t", "title": "Casting uint8_t to int8_t", "body": "<p>Using Microchip XC8 I have a construct</p>\n\n<pre><code>int16_t test;\nuint8_t msb = 0xff;\nuint8_t lsb = 0xf4;\nuint8_t hyst = 0xff; \n\ntest = ((((int16_t)msb)&lt;&lt;8) + (int16_t)lsb) + (int8_t)hyst);\n</code></pre>\n\n<p>I would expect test to be -13 (oxFFF3) as i used signed numbers but it is calculated as 0xF3.</p>\n\n<p>Why?</p>\n\n<p>Edit: Tried with gcc and the result is what I expected.</p>\n"}, {"tags": ["c", "c99", "strict-aliasing"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448458673, "post_id": 33917674, "comment_id": 55596916, "body": "Don&#39;t cast the result of <code>malloc</code> &amp; friends in C or <code>void *</code> to/from other pointers in general."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448458762, "post_id": 33917674, "comment_id": 55596975, "body": "@Olaf I write code designed to be compiled under both C and C++.  So I program in the nonexistent &quot;C/C++&quot; language, which includes the ability to use C++ as a static analyzer while building a piece of tech that can compile under C89 also.  <a href=\"http://blog.hostilefork.com/c-casts-for-the-masses/\" rel=\"nofollow noreferrer\">It&#39;s a hobby of mine...</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448458874, "post_id": 33917674, "comment_id": 55597065, "body": "So you do not use VLAs and other C99/C11 features. And you don&#39;t care about the different semantics of other contructs either. Bad approach. But as you don&#39;t do that professional, I do not mind much."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448459244, "post_id": 33917674, "comment_id": 55597340, "body": "@Olaf: I don&#39;t quite get the attitude."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1448462391, "post_id": 33917674, "comment_id": 55599592, "body": "@gnasher729: Restricting C to C89 just to make it compile with C++ for static code analysis is just a bad idea. It does not use features added since then to make your code safer and better to maintain. But if you only know how to use a hammer, every problem looks like a nail."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448463551, "post_id": 33917674, "comment_id": 55600496, "body": "@Olaf Thanks for the offer of last word: <i>&quot;A similar argument to yours could be made about C++ vs C itself.  The power, type safety, expressiveness, etc. outguns C by miles--especially these days.  But there are good reasons people don&#39;t use it for some tasks.  Then a similar argument about the safety and elegance of Haskell vs the muck of imperative C++.  And so on.  Given the mire of such discussions, it&#39;s better to save comments for the question actually being asked, when the question is perfectly clear.&quot;</i>"}], "answers": [{"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448463914, "post_id": 33918969, "comment_id": 55600738, "body": "In <a href=\"http://stackoverflow.com/a/33919291/211160\">@dbush&#39;s answer</a> he suggests that for a lone-allocated struct, the alignment would not be an issue... as malloc returns memory &quot;which is suitably aligned for any kind of variable&quot;.  It suggests the above code is okay...would you agree?"}, {"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448471397, "post_id": 33918969, "comment_id": 55605914, "body": "@HostileFork, if and only if it is obtained by <code>malloc</code>. If you then try to use the same code on variables or maybe if you use C++&#39;s <code>new</code> (as you seem also want to use C++), you may encounter a BUS error."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448478489, "post_id": 33918969, "comment_id": 55610079, "body": "Ok, thanks.  <i>(Using a C++ compiler but not the C++ allocator--unless it&#39;s debug build code running some kind of parallel check to the low-level stuff and wanting to use C++ standard library for that...)</i>"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1529531312, "post_id": 33918969, "comment_id": 88912450, "body": "Neither gcc nor clang can reliably handle all cases where storage used as one type is later used as another, even if every read is performed using the same type as the preceding write, and even if each lvalue of a different type is derived from a common lvalue after any preceding operation with a different type, and abandoned before any succeeding operation with a new type.  Even if code doesn&#39;t use aliasing as written, gcc may optimize the code so as to introduce aliasing but then fail to handle the consequences thereof."}], "tags": [], "owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "is_accepted": false, "score": 2, "last_activity_date": 1448461351, "creation_date": 1448461351, "answer_id": 33918969, "question_id": 33917674, "link": "https://stackoverflow.com/questions/33917674/can-aligned-structs-inside-a-union-be-cast-to-the-union-to-access-aligned-fields/33918969#33918969", "title": "Can aligned structs inside a union be cast to the union to access aligned fields?", "body": "<p>If <code>Foo</code> and <code>Bar</code> have different alignment, you shouldn't do that already for that reason alone. The <code>union</code> will have the maximum alignment of the two, and casting the one with the smaller value will give you a <code>union</code> that is not correctly aligned.</p>\n\n<p>Your code is not a good example for the aliasing rules, because you basically don't have aliasing here. But in general, casts to another type are always bad in cases where you may have aliasing. Your compiler may make assumptions about two (or more) pointers that a code sees. If they are of different type (with exception of <code>char</code> types) the compiler can assume that they never point to the same object.</p>\n"}, {"comments": [{"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448462972, "post_id": 33919291, "comment_id": 55600056, "body": "Okay...well I wasn&#39;t thinking of alignment specifically, but a general dislike of using a different allocated type and then casting it, so good to hear there&#39;s a go-to rule to help with that.  And I was wondering specifically about this question of malloc, vs. using a union as a stack variable...so you&#39;re saying that clause about calloc/malloc makes the above code okay in C... <i>and</i> that it would be okay if I had allocated as a union in the first place in the stack-allocation case?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448463223, "post_id": 33919291, "comment_id": 55600255, "body": "@HostileFork Yes <i>if</i> the struct was allocated dynamically <i>by itself</i> (i.e. not part of a dynamically allocated array in which case the alignment would be thrown off), then you don&#39;t have to worry about alignment issues."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1448468746, "post_id": 33919291, "comment_id": 55604150, "body": "It&#39;s worth bearing in mind that this excerpt doesn&#39;t mean you can just allocate a <code>struct Foo</code> and expect casting it to <code>struct Bar</code> to magically work, especially due to possible differences in structure padding and size differences between <code>int</code> and <code>float</code>. For that reason, again, allocate <code>union FooBar</code> if you want to be safer, not individual instances of <code>struct Foo</code> and <code>struct Bar</code>. It&#39;s one extra level of indirection in the source code, but I&#39;d say it&#39;s worth it if you want this sort of ability."}, {"owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "edited": false, "score": 0, "creation_date": 1448589314, "post_id": 33919291, "comment_id": 55657430, "body": "I actually turned out restructuring and doing what I was doing another way--due to the tenuous conditions under which this would work...largely because of the feedback here.  Thanks for the reminder on the malloc alignment issue!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 2, "last_activity_date": 1448462279, "creation_date": 1448462279, "answer_id": 33919291, "question_id": 33917674, "link": "https://stackoverflow.com/questions/33917674/can-aligned-structs-inside-a-union-be-cast-to-the-union-to-access-aligned-fields/33919291#33919291", "title": "Can aligned structs inside a union be cast to the union to access aligned fields?", "body": "<p>If you did something like this:</p>\n\n<pre><code>struct Foo foo;\nstruct Bar bar;\n...\ndetector((union FooBar*)&amp;foo);\ndetector((union FooBar*)&amp;bar);\n</code></pre>\n\n<p>Then you might have issues with alignment, since the compiler could place each of these structs on the stack in a way that might not align properly for the other.</p>\n\n<p>But because in your case you're dynamically allocating the memory for each struct, alignment is not an issue.</p>\n\n<p>From the man page for <code>malloc</code>:</p>\n\n<blockquote>\n  <p>For <code>calloc()</code> and <code>malloc()</code>, the value returned is a pointer to the\n  allocated memory, <strong>which is suitably aligned for any kind  of \n  variable</strong>,  or NULL if the request fails.</p>\n</blockquote>\n\n<p>But if you want to be sure that this won't be an issue, just declare an instance of the union instead of the containing struct anyplace where a function expecting the union would be called.</p>\n"}], "owner": {"reputation": 31218, "user_id": 211160, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Z2fk7.png?s=128&g=1", "display_name": "HostileFork says dont trust SE", "link": "https://stackoverflow.com/users/211160/hostilefork-says-dont-trust-se"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 33919291, "answer_count": 2, "score": 0, "last_activity_date": 1448468549, "creation_date": 1448457935, "last_edit_date": 1495541722, "question_id": 33917674, "link": "https://stackoverflow.com/questions/33917674/can-aligned-structs-inside-a-union-be-cast-to-the-union-to-access-aligned-fields", "title": "Can aligned structs inside a union be cast to the union to access aligned fields?", "body": "<p>I'm trying to grok what exactly you get from the easement on aligned variables in C99:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/21175830/\">Exception to strict aliasing rule in C from 6.5.2.3 Structure and union members</a></p>\n\n<p>Does it give you carte blanche on casting to that union, if the original write was done through a pointer to one of the aligned structs as below?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstruct Foo { char t; int i; };\n\nstruct Bar { char t; float f; };\n\nunion FooBar {\n    struct Foo foo;\n    struct Bar bar;\n};\n\nvoid detector(union FooBar *foobar) {\n    if (((struct Foo*)foobar)-&gt;t == 'F')\n       printf(\"Foo %d\\n\", ((struct Foo*)foobar)-&gt;i);\n    else\n       printf(\"Bar %f\\n\", ((struct Bar*)foobar)-&gt;f);\n}\n\nint main() {\n    struct Foo *foo = (struct Foo*)malloc(sizeof(struct Foo));\n    struct Bar *bar = (struct Bar*)malloc(sizeof(struct Bar));\n\n    foo-&gt;t = 'F';\n    foo-&gt;i = 1020;\n    detector((union FooBar*)foo);\n\n    bar-&gt;t = 'B';\n    bar-&gt;f = 3.04;\n    detector((union FooBar*)bar);\n\n    return 0;\n}\n</code></pre>\n\n<p>Note in the second call, <code>t</code> was written as a <em>\"bar's t\"</em> but then in order to discern which kind it has, the detector reads it as a <em>\"foo's t\"</em></p>\n\n<p>My reaction coming from C++ would be that you'd only be able to do it if you had \"allocated it as a FooBar union in the first place\".  It's counter-intuitive to me to imagine this as legal, but for dynamic allocations in C there's no such thing.  So if you can't do that, what exactly can you do with a dynamic memory allocation such as the above under this exception?</p>\n"}, {"tags": ["c", "linux", "sockets", "network-programming"], "comments": [{"owner": {"reputation": 4939, "user_id": 2906820, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2d458add2417430233cc4877e80a01d5?s=128&d=identicon&r=PG&f=1", "display_name": "rodolk", "link": "https://stackoverflow.com/users/2906820/rodolk"}, "edited": false, "score": 0, "creation_date": 1448494206, "post_id": 33917575, "comment_id": 55617445, "body": "I run a test binding to an interface with bind. It should work, you should show your code in order to figure out where the problem is."}], "answers": [{"comments": [{"owner": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448479569, "post_id": 33921305, "comment_id": 55610653, "body": "So I can&#39;t select a specific output interface using <code>bind</code> before <code>connect</code>? I don&#39;t want to use iptables to solve the problem."}, {"owner": {"reputation": 4939, "user_id": 2906820, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2d458add2417430233cc4877e80a01d5?s=128&d=identicon&r=PG&f=1", "display_name": "rodolk", "link": "https://stackoverflow.com/users/2906820/rodolk"}, "reply_to_user": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448484484, "post_id": 33921305, "comment_id": 55613144, "body": "As far as I know, you cannot do it with bind."}, {"owner": {"reputation": 4939, "user_id": 2906820, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2d458add2417430233cc4877e80a01d5?s=128&d=identicon&r=PG&f=1", "display_name": "rodolk", "link": "https://stackoverflow.com/users/2906820/rodolk"}, "reply_to_user": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448485019, "post_id": 33921305, "comment_id": 55613365, "body": "Can you try calling sendto after bind?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448505565, "post_id": 33921305, "comment_id": 55620260, "body": "@GustavoSantos What <i>is</i> the problem you&#39;re trying to solve? So far you&#39;ve only given us the non-working solution."}, {"owner": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1448540452, "post_id": 33921305, "comment_id": 55636280, "body": "@EJP I&#39;m trying to set the output interface using sockets"}, {"owner": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448540460, "post_id": 33921305, "comment_id": 55636285, "body": "Thanks @rodolk, I&#39;ve got the same results and it makes sense."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "edited": false, "score": 0, "creation_date": 1448578865, "post_id": 33921305, "comment_id": 55655128, "body": "@GustavoSantos No, I repeat, that&#39;s your presumed solution to the problem. What&#39;s the problem? Why do you think you need to do this?"}, {"owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "edited": false, "score": 0, "creation_date": 1593902753, "post_id": 33921305, "comment_id": 110940725, "body": "&quot;Source address doesn&#39;t affect routing of a packet.&quot; might be true for Linux but not for all systems. On BSD systems (FreeBSD, NetBSD but also macOS) the source address will choose an interface. See RFC 1122 and this answer/question: <a href=\"https://unix.stackexchange.com/q/258810/296146\">unix.stackexchange.com/q/258810/296146</a>"}], "tags": [], "owner": {"reputation": 4939, "user_id": 2906820, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2d458add2417430233cc4877e80a01d5?s=128&d=identicon&r=PG&f=1", "display_name": "rodolk", "link": "https://stackoverflow.com/users/2906820/rodolk"}, "is_accepted": true, "score": 2, "last_activity_date": 1448503934, "last_edit_date": 1448503934, "creation_date": 1448467995, "answer_id": 33921305, "question_id": 33917575, "link": "https://stackoverflow.com/questions/33917575/choosing-socket-output-interface-so-bindtodevice-vs-bind-before-connect/33921305#33921305", "title": "Choosing socket output interface: SO_BINDTODEVICE vs bind before connect", "body": "<p>Source address doesn't affect routing of a packet. The interface will be selected based on the destination address and host's router table. You can modify it with route command.</p>\n\n<pre><code>route default gw [gateway IP]\n</code></pre>\n\n<p>No matter which interface the socket is bound, the packet is to be routed based on route table. The interface to which the socket is bound will determine the source ip address.</p>\n\n<p>Now, I run some tests binding to loopback interface and connecting the socket to other address in the Internet and in that case connect failed with errno 22 (EINVAL). However, in other tests with two interfaces (none was loopback), and connecting to a server in the Internet, no matter which interface I bound the socket to, the packet was sent out according to the routing table, in my case following the default rule. The sources address depended on the bind.</p>\n"}, {"tags": [], "owner": {"reputation": 106086, "user_id": 15809, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2ULwK.jpg?s=128&g=1", "display_name": "Mecki", "link": "https://stackoverflow.com/users/15809/mecki"}, "is_accepted": false, "score": 1, "last_activity_date": 1593982782, "last_edit_date": 1593982782, "creation_date": 1593907378, "answer_id": 62735610, "question_id": 33917575, "link": "https://stackoverflow.com/questions/33917575/choosing-socket-output-interface-so-bindtodevice-vs-bind-before-connect/62735610#62735610", "title": "Choosing socket output interface: SO_BINDTODEVICE vs bind before connect", "body": "<p>Whether binding affects routing depend on the fact if a system uses the weak ES model or the strong ES model. Linux uses the weak ES model, whereas all BSD based systems (including macOS) uses the strong ES model. Windows used the weak ES model up to Vista, then switched to the strong ES model.</p>\n<p>Microsoft has a very detailed page about that topic, explaining the two modes and also how binding will affect routing and packet receiving in either mode:</p>\n<p><a href=\"https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc137807(v=msdn.10)?redirectedfrom=MSDN\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/previous-versions/technet-magazine/cc137807(v=msdn.10)?redirectedfrom=MSDN</a></p>\n<p>So on BSD based systems and Windows Vista and later, you can select an interface using bind but not on Linux. On Linux you have to use <code>SO_BINDTODEVICE</code> for that. A solution that would support either one of these two modes would thus be very portable.</p>\n<p>There is one pitfall, though: If the system allows that multiple interface can have the same address, then bind will not really select an interface, it will only limit the choices for interfaces. The final choice is then either performed by consulting the routing table or by some system specific interface order.</p>\n"}], "owner": {"reputation": 118, "user_id": 5569261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda5e2432f439c75d6f38d5193b9450e?s=128&d=identicon&r=PG&f=1", "display_name": "Gustavo Santos", "link": "https://stackoverflow.com/users/5569261/gustavo-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2201, "favorite_count": 3, "accepted_answer_id": 33921305, "answer_count": 2, "score": 4, "last_activity_date": 1593982782, "creation_date": 1448457620, "last_edit_date": 1495541629, "question_id": 33917575, "link": "https://stackoverflow.com/questions/33917575/choosing-socket-output-interface-so-bindtodevice-vs-bind-before-connect", "title": "Choosing socket output interface: SO_BINDTODEVICE vs bind before connect", "body": "<p>I'm trying to set a socket's output interface on a system with two interfaces. I've googled a lot and I found divergent answers. Some people say that I can <code>bind</code> a socket before calling <code>connect</code> to choose a specific interface (as in <a href=\"https://stackoverflow.com/questions/4297356/how-does-a-socket-know-which-network-interface-controller-to-use\">How does a socket know which network interface controller to use?</a>). But other people say that this isn't enough (as in <a href=\"http://codingrelic.geekhold.com/2009/10/code-snippet-sobindtodevice.html\" rel=\"nofollow noreferrer\">http://codingrelic.geekhold.com/2009/10/code-snippet-sobindtodevice.html</a> or <a href=\"https://stackoverflow.com/questions/5103990/how-to-open-a-socket-on-a-specific-interface-and-receive-both-ipv4-and-ipv6-traf\">How to open a socket on a specific interface and receive both IPv4 and IPv6 traffic</a>).</p>\n\n<p>I have a working implementation using <code>SO_BINDTODEVICE</code>. However the <code>bind</code> before <code>connect</code> solution isn't working. It seems that the source address doesn't affect routing and only the routing table is considered in this case. Someone said that this is caused by Linux's Weak end system model. According to <a href=\"http://wiki.treck.com/Appendix_C:_Strong_End_System_Model_/_Weak_End_System_Model\" rel=\"nofollow noreferrer\">http://wiki.treck.com/Appendix_C:_Strong_End_System_Model_/_Weak_End_System_Model</a> the Source Address does not specify the output interface.</p>\n\n<p>If possible I would like to have a portable solution. I know that <code>SO_BINDTODEVICE</code> is available only in Linux.</p>\n"}, {"tags": ["c", "linux", "memory", "memory-management"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1448457881, "post_id": 33917415, "comment_id": 55596368, "body": "The C++ tag is not appropriate"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 2, "creation_date": 1448457931, "post_id": 33917415, "comment_id": 55596398, "body": "Here is some good reading on the internal implementation of <code>malloc</code>: <a href=\"http://stackoverflow.com/q/3479330/335858\">link</a>."}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1448469200, "post_id": 33917485, "comment_id": 55604463, "body": "Also, Linux uses deferred page allocation, so freshly <code>malloc</code>ed memory space might not be backed by physical memory or swap space until the program actually writes to the allocated memory. Until then, it may just be occupying address space in the page table, with pages marked as &quot;copy on write&quot;."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 3, "last_activity_date": 1448529241, "last_edit_date": 1448529241, "creation_date": 1448457338, "answer_id": 33917485, "question_id": 33917415, "link": "https://stackoverflow.com/questions/33917415/where-does-malloc-return-memory/33917485#33917485", "title": "Where does malloc return memory?", "body": "<p>It is implementation specific. On Linux with <a href=\"http://www.gnu.org/software/libc/\" rel=\"nofollow\">GNU libc</a> or <a href=\"http://musl-libc.org/\" rel=\"nofollow\">musl-libc</a>, <code>malloc</code> is often calling <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"nofollow\">mmap(2)</a> <a href=\"https://en.wikipedia.org/wiki/System_call\" rel=\"nofollow\">system call</a> to get more virtual memory from the kernel. <code>free</code> is generally marking a memory zone to be reusable by future calls to <code>malloc</code> but occasionally (for big memory zones) is releasing the memory with <code>munmap</code></p>\n\n<p>Use <code>strace</code> and study the relevant source code ... (Usually, <code>malloc</code> is implemented inside some free software standard C library on Linux). I believe that <a href=\"http://musl-libc.org/\" rel=\"nofollow\">musl-libc</a> has a nicely readable implementation of <code>malloc</code></p>\n\n<p>Read more about <a href=\"https://en.wikipedia.org/wiki/Process_%28computing%29\" rel=\"nofollow\">processes</a>, <a href=\"https://en.wikipedia.org/wiki/Virtual_address_space\" rel=\"nofollow\">virtual address spaces</a>, <a href=\"https://en.wikipedia.org/wiki/Virtual_memory\" rel=\"nofollow\">virtual memory</a> and <a href=\"http://www.makelinux.net/alp/\" rel=\"nofollow\">Advanced Linux Programming</a>.</p>\n\n<p>See also <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"nofollow\">proc(5)</a> and think about the output of <code>cat /proc/$$/maps</code> and <code>cat /proc/self/maps</code></p>\n\n<p>On Linux specifically, read also about <a href=\"http://www.etalabs.net/overcommit.html\" rel=\"nofollow\">Linux memory overcommit</a>. It is a feature that I dislike and that I am disabling ...</p>\n\n<p>Be aware of <a href=\"https://en.wikipedia.org/wiki/Address_space_layout_randomization\" rel=\"nofollow\">ASLR</a>. You can disable it (e.g. to have reproducible watchpoints under GDB).</p>\n\n<p>For debugging <code>malloc</code> related issues (notably <a href=\"https://en.wikipedia.org/wiki/Memory_leak\" rel=\"nofollow\">memory leaks</a>) use <a href=\"http://valgrind.org/\" rel=\"nofollow\">valgrind</a> (and, with recent <a href=\"http://gcc.gnu.org/\" rel=\"nofollow\">GCC</a> compilers, their <code>-fsanitize=</code> <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Debugging-Options.html\" rel=\"nofollow\">debugging options</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 317, "user_id": 1630404, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/acbd49e2f65205e40ee6e3607cc192c7?s=128&d=identicon&r=PG", "display_name": "Prophet Daniel", "link": "https://stackoverflow.com/users/1630404/prophet-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1448459715, "last_edit_date": 1448459715, "creation_date": 1448457496, "answer_id": 33917536, "question_id": 33917415, "link": "https://stackoverflow.com/questions/33917415/where-does-malloc-return-memory/33917536#33917536", "title": "Where does malloc return memory?", "body": "<p>Usually it will be allocated in the virtual memory if there's one. So let's assume it has one and the memory hardware is composed by a Hard Disk and RAM. If there's no space available in the physical memory (RAM), it will be allocated in the pagefile inside the Hard Disk.</p>\n\n<p>Heap is the memory for objects and is allocated samewise. Just to clear up concepts here about the heap, imagine an embedded application without an operating system and without a virtual memory, if it's an object it will be allocated in the heap area in the physical memory (RAM), if it's not it will be allocated outside the heap area but still in the physical memory (RAM).</p>\n"}, {"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 6, "last_activity_date": 1448457700, "creation_date": 1448457700, "answer_id": 33917602, "question_id": 33917415, "link": "https://stackoverflow.com/questions/33917415/where-does-malloc-return-memory/33917602#33917602", "title": "Where does malloc return memory?", "body": "<blockquote>\n  <p>is it on the pagefile, on the physical memory?</p>\n</blockquote>\n\n<p>On operating systems with virtual memory management <code>malloc</code> has no idea of how the virtual memory that it allocates is mapped to physical memory, and that is entirely by design. <code>malloc</code> operates on a higher level than the virtual memory manager. To <code>malloc</code> all memory in the address space provided by the OS is the same.</p>\n\n<p>Some pages may start with physical mapping, only to be swapped out into a file later on, and then back into memory as needed. However, operating system does all of this transparently to your program, so <code>malloc</code> is unaware of the physical memory.</p>\n"}], "owner": {"reputation": 877, "user_id": 4875887, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bfbb2b81585e3030fc022ee1686e29d5?s=128&d=identicon&r=PG&f=1", "display_name": "Ernestina Juan", "link": "https://stackoverflow.com/users/4875887/ernestina-juan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448529241, "creation_date": 1448457143, "last_edit_date": 1448459853, "question_id": 33917415, "link": "https://stackoverflow.com/questions/33917415/where-does-malloc-return-memory", "title": "Where does malloc return memory?", "body": "<p>I am learning about <code>malloc</code> function in C. I know how to request memory with</p>\n\n<pre><code>p = malloc(number_of_bytes);\n</code></pre>\n\n<p>and to free it later when it's not used with</p>\n\n<pre><code>free(p);\n</code></pre>\n\n<p>But I want to know something a bit more theoretical than this: I know that with virtual memory, there are three possibilities: </p>\n\n<ol>\n<li><p>A virtual address can have no physical storage assigned (in pagefile or in physical memory)</p></li>\n<li><p>A virtual address can have physical storage on the pagefile</p></li>\n<li><p>A virtual address can have physical storage on physical memory</p></li>\n</ol>\n\n<p>So, my question is:</p>\n\n<p>Where does <code>malloc</code> returned memory is (I mean, is it on the pagefile, on the physical memory (heap maybe?))?</p>\n"}, {"tags": ["c", "windows", "gcc", "cygwin"], "comments": [{"owner": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 1, "creation_date": 1448455976, "post_id": 33916905, "comment_id": 55595040, "body": "What is the compilation line that you use to build it?"}, {"owner": {"reputation": 1679, "user_id": 309057, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aE2q7.jpg?s=128&g=1", "display_name": "Muhammad Nour", "link": "https://stackoverflow.com/users/309057/muhammad-nour"}, "reply_to_user": {"reputation": 6595, "user_id": 5218277, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZuEZa.jpg?s=128&g=1", "display_name": "Alex Lop.", "link": "https://stackoverflow.com/users/5218277/alex-lop"}, "edited": false, "score": 0, "creation_date": 1448456097, "post_id": 33916905, "comment_id": 55595140, "body": "gcc convert.c -o convert.exe"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448456837, "post_id": 33916905, "comment_id": 55595681, "body": "Don&#39;t learn ANSI-C anymore! That has some deprecated idioms. Learn C11 or at least C99."}, {"owner": {"reputation": 1679, "user_id": 309057, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aE2q7.jpg?s=128&g=1", "display_name": "Muhammad Nour", "link": "https://stackoverflow.com/users/309057/muhammad-nour"}, "edited": false, "score": 0, "creation_date": 1448457031, "post_id": 33916905, "comment_id": 55595795, "body": "I am reading  &quot;C programming language by Dennis Ritchie&quot; if the book is not up-to-date would you please recommend me another one!"}, {"owner": {"reputation": 2233, "user_id": 2669128, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/430a24425fb593f00def23e45c454c39?s=128&d=identicon&r=PG", "display_name": "thurizas", "link": "https://stackoverflow.com/users/2669128/thurizas"}, "edited": false, "score": 0, "creation_date": 1448458164, "post_id": 33916905, "comment_id": 55596556, "body": "look at your error....&quot;....in the dynamic link library C:\\cygwin\\home\\username\\convert.exe&quot;  It looks like Windows thinks that you build a library and not an executable.  My recommendations; (1) if you are going to use windows, ditch Cygwin and use mingw-w64 (see <a href=\"http://mingw-w64.org/doku.php\" rel=\"nofollow noreferrer\">mingw-w64.org/doku.php</a>) (2) at least at the start ditch CodeBlocks and just use a simple text editor (i.e. notepad++) and learn to compile from the command line. (3) Ritchie&#39;s book, while good, is dated,, you may want C Primer Plus 5th Ed (Prata), which has good reviews at ACCU."}, {"owner": {"reputation": 1679, "user_id": 309057, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aE2q7.jpg?s=128&g=1", "display_name": "Muhammad Nour", "link": "https://stackoverflow.com/users/309057/muhammad-nour"}, "edited": false, "score": 0, "creation_date": 1448462628, "post_id": 33916905, "comment_id": 55599759, "body": "why ditch cygwin!? I will try to compile with mingw and what compiler is being used in c primer book"}, {"owner": {"reputation": 1581, "user_id": 2848117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7uhq.png?s=128&g=1", "display_name": "Dom", "link": "https://stackoverflow.com/users/2848117/dom"}, "edited": false, "score": 1, "creation_date": 1448652185, "post_id": 33916905, "comment_id": 55684659, "body": "It works fine on my version of Cygiwn. My guess it that something isn&#39;t installed properly in Cygiwn."}], "owner": {"reputation": 1679, "user_id": 309057, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/aE2q7.jpg?s=128&g=1", "display_name": "Muhammad Nour", "link": "https://stackoverflow.com/users/309057/muhammad-nour"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 226, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1448455575, "creation_date": 1448455575, "question_id": 33916905, "link": "https://stackoverflow.com/questions/33916905/error-the-procedure-entry-point-when-running-exe-after-compiling-with-gcc", "title": "error: &quot;the procedure entry point..&quot; when running exe after compiling with gcc / cygwin", "body": "<p>I am learning c and I am using code::block</p>\n\n<p>I have wrote this code  \"from ansi c book\"</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nfloat convertToCelsius(float f);\n\nint main()\n{\n    int start = 0;\n    int step = 5;\n    int upper = 300;\n\n    printf(\"%3c\\t%6c\\n\",'F','C');\n    while(start &lt; upper){\n        printf(\"%3d\\t%6.3f\\n\", start, convertToCelsius(start));\n        start += step;\n    }\n\n\n\n    return 0;\n}\n\nfloat convertToCelsius(float f){\n    return (5.0/9)*(f-32);\n}\n</code></pre>\n\n<p>when I run the code from the IDE \"code::blocks\" it compile and run without problems \nbut when I compile the c file using gcc in cygwin and try to run the exe file it gives me this message</p>\n\n<blockquote>\n  <p>the procedure entry point __cxa_atexit could not be located in the\n  dynamic link library C:\\cygwin\\home\\username\\convert.exe</p>\n</blockquote>\n\n<p>I have search but couldn't find related direct answer</p>\n\n<p>what is the problem ?</p>\n"}, {"tags": ["c", "strtok"], "comments": [{"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 0, "creation_date": 1448455282, "post_id": 33916748, "comment_id": 55594571, "body": "Use a debugger and go through your code step by step. Or add lots of status reporting <code>printf</code>&#39;s to your program."}], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 5437096, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5451a6d95d6a10cd7f178ed88c8a9da4?s=128&d=identicon&r=PG&f=1", "display_name": "Antithesis", "link": "https://stackoverflow.com/users/5437096/antithesis"}, "edited": false, "score": 0, "creation_date": 1448456475, "post_id": 33916863, "comment_id": 55595414, "body": "Worked like a breeze. Thanks."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1448456842, "post_id": 33916863, "comment_id": 55595688, "body": "Note that you should also check that <code>sscanf</code> returns <code>3</code>, the contents of the array entry fields have indeterminate contents for a line that does not match."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 4, "last_activity_date": 1448456497, "last_edit_date": 1448456497, "creation_date": 1448455444, "answer_id": 33916863, "question_id": 33916748, "link": "https://stackoverflow.com/questions/33916748/deserializing-a-string-in-c/33916863#33916863", "title": "Deserializing a string in C", "body": "<p>One of the problems you are having is that the <a href=\"http://en.cppreference.com/w/c/string/byte/strtok\" rel=\"nofollow\"><code>strtok</code></a> function is not reentrant, which means you can't use it to tokenize two different strings. If you have <code>strtok_s</code> you could use it, or you could use simple <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow\"><code>sscanf</code></a> parsing on each line.</p>\n\n<p>Another problem is that you don't get the new line in the loop.</p>\n\n<hr>\n\n<p>You could easily replace your code with something like this:</p>\n\n<pre><code>int deserialize(RV** arr, char* msg)\n{\n    char *line = strtok(msg, \"\\n\");\n    int idx = 0;\n\n    do\n    {\n        sscanf(line, \"%d %d %d\", &amp;arr[idx]-&gt;server1, &amp;arr[idx]-&gt;server2, &amp;arr[idx]-&gt;weight);\n        ++idx;\n    } while ((line = strtok(NULL, \"\\n\")) != NULL);\n\n    return idx;  // Return the number of lines we parsed\n}\n</code></pre>\n\n<p>This assumes that there is at least one line (ending with a newline) in the message. Also note that I wrote the code of the top of my head, I haven't tested it.</p>\n"}], "owner": {"reputation": 317, "user_id": 5437096, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/5451a6d95d6a10cd7f178ed88c8a9da4?s=128&d=identicon&r=PG&f=1", "display_name": "Antithesis", "link": "https://stackoverflow.com/users/5437096/antithesis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 33916863, "answer_count": 1, "score": 1, "last_activity_date": 1448456497, "creation_date": 1448455089, "question_id": 33916748, "link": "https://stackoverflow.com/questions/33916748/deserializing-a-string-in-c", "title": "Deserializing a string in C", "body": "<p>I've data being sent in the following format</p>\n\n<pre><code>1 2 5\n1 3 6\n1 4 9\n</code></pre>\n\n<p>I'm deserializing them using the following function</p>\n\n<pre><code> void deserialize(RV** arr, char* msg){\n        int idx = 0;\n        char* line = strtok(msg, \"\\n\");\n        RV rv;\n        rv.server1 = atoi(strtok(line, \" \"));\n        rv.server2 = atoi(strtok(NULL, \" \"));\n        rv.weight = atoi(strtok(NULL, \" \"));\n        memcpy(arr[idx], &amp;rv, sizeof(rv));\n        idx++;\n\n        while (strtok(NULL, \"\\n\") != NULL){\n            //printf(\"%s\\n\", line);\n            RV rv;\n            rv.server1 = atoi(strtok(NULL, \" \"));\n            rv.server2 = atoi(strtok(NULL, \" \"));\n            rv.weight = atoi(strtok(NULL, \" \"));\n            memcpy(arr[idx], &amp;rv, sizeof(rv));\n            idx++;\n        }\n\n    }\n</code></pre>\n\n<p>This returns the first line correctly, but the rest are all 0</p>\n\n<pre><code>1 2 5\n0 0 0\n0 0 0\n</code></pre>\n\n<p>What am I doing wrong. Any help appreciated.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 14429, "user_id": 3494013, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ff6b6de2f59471e271413f74921e054a?s=128&d=identicon&r=PG&f=1", "display_name": "cadaniluk", "link": "https://stackoverflow.com/users/3494013/cadaniluk"}, "edited": false, "score": 2, "creation_date": 1448454851, "post_id": 33916595, "comment_id": 55594291, "body": "<code>void main</code>&#39;s most probably <b>wrong</b>."}, {"owner": {"reputation": 1336, "user_id": 623048, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/21e986a6c54514b362062a0a6b6e90e1?s=128&d=identicon&r=PG", "display_name": "Graham Asher", "link": "https://stackoverflow.com/users/623048/graham-asher"}, "edited": false, "score": 0, "creation_date": 1448455010, "post_id": 33916595, "comment_id": 55594389, "body": "Please change the title, and remove the codeblocks tag: this question is nothing to do with CodeBlocks."}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 4189875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7900091dbdcac647e7e62a34ad8e41e0?s=128&d=identicon&r=PG&f=1", "display_name": "BigO", "link": "https://stackoverflow.com/users/4189875/bigo"}, "is_accepted": false, "score": 2, "last_activity_date": 1448457682, "creation_date": 1448457682, "answer_id": 33917592, "question_id": 33916595, "link": "https://stackoverflow.com/questions/33916595/c-programming-language/33917592#33917592", "title": "C programming language", "body": "<p>Problem in code :\nYour format string like <code>scanf(\"%d \",&amp;marks[i][j]);</code> requires whitespace after input which causes anomaly.</p>\n\n<p>Corrected Code :</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//Computing marks and average of students using 2D arrays\nint main()\n{\n    int i,j,sum = 0,marks[3][5];\n    float avg;\n\n    printf(\"Program to compute average marks of 3 students.\\n\");\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            printf(\"Enter marks for student %d in subject %d:\\t\",i+1,j+1);\n            scanf(\"%d\",&amp;marks[i][j]);\n        }\n    }\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            sum=sum+marks[i][j];\n        }\n        avg= sum/5.0;\n        printf(\"The average marks of student %d is %f:\\n\",i+1,avg);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>as specification says </p>\n\n<blockquote>\n  <p>Number,order and type of conversion specifications must match the\n  number,order and type of parameters in the list</p>\n</blockquote>\n\n<p>. Otherwise, the result will be unpredictable and may terminate input/output function.</p>\n"}, {"tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1448458347, "creation_date": 1448458347, "answer_id": 33917824, "question_id": 33916595, "link": "https://stackoverflow.com/questions/33916595/c-programming-language/33917824#33917824", "title": "C programming language", "body": "<p>As said in comments, <code>void main()</code> is bad: you should use <code>int main()</code> and end your program with <code>return 0;</code></p>\n\n<p>But the problem is simply caused by an unnecessary space in your input format at <code>\"%d \"</code>. This removes the problem:</p>\n\n<pre><code>    scanf(\"%d\",&amp;marks[i][j]);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8833, "user_id": 337149, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3bbd41f2b74254f902cfe20acef9030b?s=128&d=identicon&r=PG", "display_name": "August Karlstrom", "link": "https://stackoverflow.com/users/337149/august-karlstrom"}, "is_accepted": false, "score": 2, "last_activity_date": 1448460621, "last_edit_date": 1448460621, "creation_date": 1448458532, "answer_id": 33917894, "question_id": 33916595, "link": "https://stackoverflow.com/questions/33916595/c-programming-language/33917894#33917894", "title": "C programming language", "body": "<p>The format string in <em>scanf</em> should be <code>\"%d\"</code> (without a space). You have also forgotten to initialize the <em>sum</em> variable. Below is a corrected version of your code including a convenient array length macro. Hope this helps.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define LEN(arr) (sizeof (arr) / sizeof (arr)[0])\n\n/*Computing marks and average of students using 2D arrays*/\n\nint main()\n{\n    int i, j, sum, marks[3][5], count;\n    float avg;\n\n    printf(\"Program to compute average marks of 3 students.\\n\");\n    for (i = 0; i &lt; LEN(marks); i++) {\n        for (j = 0; j &lt; LEN(marks[0]); j++) {\n            printf(\"Enter marks for student %d in subject %d:\\t\", i + 1, j + 1);\n            count = scanf(\"%d\", &amp;marks[i][j]);\n            if (count != 1) {\n                fprintf(stderr, \"invalid input\\n\");\n                exit(EXIT_FAILURE);\n            }\n        }\n    }\n    for (i = 0; i &lt; LEN(marks); i++) {\n        sum = 0;\n        for (j = 0; j &lt; LEN(marks[0]); j++) {\n            sum = sum + marks[i][j];\n        }\n        avg = ((float) sum) / ((float) LEN(marks[0]));\n        printf(\"The average marks of student %d is %f:\\n\", i + 1, avg);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5533385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf1c0abfd5bc246e570781451e0840f?s=128&d=identicon&r=PG&f=1", "display_name": "zoey", "link": "https://stackoverflow.com/users/5533385/zoey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448474327, "creation_date": 1448454566, "last_edit_date": 1448474327, "question_id": 33916595, "link": "https://stackoverflow.com/questions/33916595/c-programming-language", "title": "C programming language", "body": "<p>Codeblocks is asking me for an extra input than required after my first input it prompts for another input without the print statement that gets printed for every input prompt.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n//Computing marks and average of students using 2D arrays\nvoid main()\n{\n    int i,j,sum,marks[3][5];\n    float avg;\n    printf(\"Program to compute average marks of 3 students.\\n\");\n    for(i=0;i&lt;3;i++)\n    {   for(j=0;j&lt;5;j++)\n    {\n        printf(\"Enter marks for student %d in subject %d:\\t\",i+1,j+1);\n        scanf(\"%d \",&amp;marks[i][j]);\n    }\n    }\n    for(i=0;i&lt;3;i++)\n    {\n        for(j=0;j&lt;5;j++)\n        {\n            sum=sum+marks[i][j];\n        }\n        avg= sum/5.0;\n        printf(\"The average marks of student %d is %f:\\n\",i+1,avg);\n         }\n    getch();\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "divide-by-zero", "compile-time-constant", "constant-expression"], "comments": [{"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 8, "creation_date": 1448453327, "post_id": 33916113, "comment_id": 55593377, "body": "So <code>x</code> is not a constexpr variable, just making sure but otherwise the C++ standard says <code>If the second operand of &#47; or % is zero the behavior is undefined</code>"}, {"owner": {"reputation": 9784, "user_id": 227755, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4a4377b8beefc590e722a17b7fa5da66?s=128&d=identicon&r=PG", "display_name": "nurettin", "link": "https://stackoverflow.com/users/227755/nurettin"}, "edited": false, "score": 0, "creation_date": 1448453628, "post_id": 33916113, "comment_id": 55593558, "body": "Off-topic: How does it crash, by the way? Does it dereference a null pointer or something?"}, {"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "reply_to_user": {"reputation": 9784, "user_id": 227755, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4a4377b8beefc590e722a17b7fa5da66?s=128&d=identicon&r=PG", "display_name": "nurettin", "link": "https://stackoverflow.com/users/227755/nurettin"}, "edited": false, "score": 0, "creation_date": 1448453761, "post_id": 33916113, "comment_id": 55593634, "body": "@nurettin Well, it &quot;crashes&quot; in the sense that the user gets a popup message &quot;Throwable: int overflow infinity&quot; without giving any hint (line number or something) where the problem lies. It doesn&#39;t actually segfault or something :)"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 6, "creation_date": 1448456920, "post_id": 33916113, "comment_id": 55595726, "body": "I believe you cannot write a toy C++ compiler. Any C++11 conforming compiler won&#39;t be a toy; but you could write in C++ a toy compiler for your toy language! Then you are defining your language standard, and C++ standards does not matter!"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1448458577, "post_id": 33916113, "comment_id": 55596853, "body": "One variation that I would like the answerers to opine on is whether <code>if (0) { int x = 1 &#47; 0; }</code> is allowed to crash the compiler or produce a program that crashes."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 2, "creation_date": 1448460220, "post_id": 33916113, "comment_id": 55598064, "body": "@PascalCuoq: <a href=\"http://stackoverflow.com/a/18385138/2003898\">stackoverflow.com/a/18385138/2003898</a> -&gt; nope, it isn&#39;t allowed to crash, it is well defined."}, {"owner": {"reputation": 61304, "user_id": 4117728, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/66831ed13ffd9c497541220ec45c15c3?s=128&d=identicon&r=PG&f=1", "display_name": "largest_prime_is_463035818", "link": "https://stackoverflow.com/users/4117728/largest-prime-is-463035818"}, "edited": false, "score": 4, "creation_date": 1448461910, "post_id": 33916113, "comment_id": 55599273, "body": "afaik the standard does not say anything about compilers crashing, but about compiled programs crashing. I really dont think it is disallowed for a compiler to crash when he encounters e.g. <code>int x = 1*0;</code>, whether such a compiler is of any use is a different question :P"}, {"owner": {"reputation": 1113, "user_id": 4092381, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-iUd348W6B_A/AAAAAAAAAAI/AAAAAAAAAjs/0d8MLWyOoFo/photo.jpg?sz=128", "display_name": "Jordan Melo", "link": "https://stackoverflow.com/users/4092381/jordan-melo"}, "reply_to_user": {"reputation": 9784, "user_id": 227755, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4a4377b8beefc590e722a17b7fa5da66?s=128&d=identicon&r=PG", "display_name": "nurettin", "link": "https://stackoverflow.com/users/227755/nurettin"}, "edited": false, "score": 0, "creation_date": 1448463090, "post_id": 33916113, "comment_id": 55600136, "body": "@nurettin: It crashes because integer divisions by zero raises an exception in the CPU and the kernel handles this exception by killing the application that raised it. Presumably the compiler is performing constant folding and is evaluating the division by zero, causing the crash."}, {"owner": {"reputation": 1439, "user_id": 5196093, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7ovj7.png?s=128&g=1", "display_name": "Ray", "link": "https://stackoverflow.com/users/5196093/ray"}, "edited": false, "score": 1, "creation_date": 1448488988, "post_id": 33916113, "comment_id": 55615370, "body": "The implementation is not required to issue a diagnostic message when it detects undefined behavior, but the standard does permit it, and does not specify what form a diagnostic message must take.  I think it&#39;s perfectly reasonable to consider a compiler crash to be a particularly emphatic form of diagnostic message. :-)"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1448494870, "post_id": 33916113, "comment_id": 55617657, "body": "@Zaibis see Pascal&#39;s answer to the question you linked to!  (I disagree with his POV but he does explain his position well)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448501470, "post_id": 33916113, "comment_id": 55619299, "body": "By definition, you <i>cannot</i> divide by zero in a constant expression. For C, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">N1570</a> 6.6p4: &quot;Each constant expression shall evaluate to a constant that is in the range of representable values for its type.&quot; C++ has a similar rule. So <code>1 &#47; 0</code> is an <i>expression</i>, but it&#39;s not a <i>constant expression</i> (even though its subexpressions are constant expressions). If you use <code>1 &#47; 0</code> in a context that requires a constant expression, a conforming compiler must issue a diagnostic message. (Is a compile-time crash a diagnostic message?)"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448505451, "post_id": 33916113, "comment_id": 55620240, "body": "@KeithThompson well in this example a constant expression is not required, I think the OP meant was wrt to constant folding. I think the <i>constant expression</i> in the title in a red herring, though both operands on <i>integer constants</i> in C terminology and integer literals in C++. This usually allows constant folding opportunities."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448505641, "post_id": 33916113, "comment_id": 55620287, "body": "@KeithThompson there are lots of other questions, such as is undefined behavior really meant to a compile time concept. I have seen people claim it is a purely a run-time concept but I can find no wording in either standard that says that."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448505822, "post_id": 33916113, "comment_id": 55620333, "body": "@KeithThompson note that C11 also says <i>An implementation may accept other forms of constant expressions</i>."}, {"owner": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1448506698, "post_id": 33916113, "comment_id": 55620535, "body": "Hmm I didn&#39;t think of undefined behavior affecting compilers.. only the runtime behavior. Interesting."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 19932, "user_id": 2068573, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/0e6f781a205f3521290f89c84dc5f95d?s=128&d=identicon&r=PG", "display_name": "Neil Kirk", "link": "https://stackoverflow.com/users/2068573/neil-kirk"}, "edited": false, "score": 0, "creation_date": 1448506788, "post_id": 33916113, "comment_id": 55620557, "body": "@NeilKirk: <a href=\"http://stackoverflow.com/q/18385020/827263\">stackoverflow.com/q/18385020/827263</a>"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1448509569, "post_id": 33916113, "comment_id": 55621189, "body": "@KeithThompson I had forgotten about that question. Interesting to note that C++ does not define <i>behavior</i> on which your answer there partially depends on. C++ did not even <a href=\"http://stackoverflow.com/a/23415662/1708801\">define indeterminate value until C++14</a>."}, {"owner": {"reputation": 3560, "user_id": 1303846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da3b47c80b3c9d6f9e37a88b2ca51e6a?s=128&d=identicon&r=PG", "display_name": "Remember Monica", "link": "https://stackoverflow.com/users/1303846/remember-monica"}, "edited": false, "score": 0, "creation_date": 1448531819, "post_id": 33916113, "comment_id": 55630870, "body": "The code snippet on its own is obviously not a valid program and no standard applies. Since the context (whether the division is attempted at runtime) decides whether this is undefined behaviour or not, you should provide some context. In general, crashing is not allowed by either C or C++ standards."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 1, "creation_date": 1448553823, "post_id": 33916113, "comment_id": 55644753, "body": "You should clarify the constant expression portion of your question, as it has been made clear <code>1 &#47; 0</code> is not a constant expression in either C or C++. Several people are hung up on this and it does not really change the answer."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1449372034, "post_id": 33916113, "comment_id": 55977020, "body": "See my updated answer, for C we have defect report 109 which clarifies that unless we can prove the UB will be executed then we must successfully translate the program. Hat tip to Pascal for prodding me in that direction."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "edited": false, "score": 0, "creation_date": 1449521737, "post_id": 33916113, "comment_id": 56034118, "body": "Note the response to the UB mailing list from Richard Smith <a href=\"http://www.open-std.org/pipermail/ub/2014-September/000515.html\" rel=\"nofollow noreferrer\">here</a> which says <i>Also, ill-formed, NDR implies that all executions of the program have undefined behavior (if the compiler accepts it, which it&#39;s permitted to), even if they don&#39;t actually execute the UB</i> which means C++ diverges from C on this point wrt to DR 109. Not sure if this is spelled out in the normative text though."}], "answers": [{"comments": [{"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1448461857, "post_id": 33916180, "comment_id": 55599239, "body": "It might be worth also noting about just the presence of undefined constructs causes UB, or it has to be able to be invoked to cause it ;)"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1448464789, "post_id": 33916180, "comment_id": 55601352, "body": "Well it is not directly stated but I would say the opposite. regarding &quot;behavior, <b>upon use of</b> a nonportable or erroneous program construct&quot;. And in Section 3.4 behavior is defined as: &quot;external appearance or action&quot; where for calling something undefined behavior it has to be fulfilling the requirments of behavior. Where the compiler had to prove before it, at least COULD if not even CAN appear. so it fulfills the state of appearing or acting. But that is just an interpretation that sounds logical from my point of view."}, {"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 3, "creation_date": 1448481110, "post_id": 33916180, "comment_id": 55611464, "body": "&quot;From the wording on standard it seems to me that invoking is not necessary. Either there is UB or not.&quot; -- There is UB if the abstract machine would divide by zero, if the <code>&#47;</code> operator with a RHS of <code>0</code> would ever be evaluated. Not if the code never even attempts to divide by zero, not even if there is a division by zero in dead code. UB is unconditional in one sense, if there is UB anywhere then the whole program has UB and the compiler may crash or otherwise reject the program, but depending on the type of UB, whether there is UB anywhere may depend on the would-be-UB code being reached."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1448527401, "post_id": 33916180, "comment_id": 55627924, "body": "@hvd It seems you are right, unevaluated code is not necessarily UB as highlighted by user2357112&#39;s answer."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 15, "last_activity_date": 1448453754, "last_edit_date": 1448453754, "creation_date": 1448453355, "answer_id": 33916180, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression/33916180#33916180", "title": "Dividing by zero in a constant expression", "body": "<p>From C standard draft (N1570):</p>\n\n<blockquote>\n  <h3>6.5.5 Multiplicative operators</h3>\n  \n  <p>...</p>\n  \n  <ol start=\"5\">\n  <li>The result of the / operator is the quotient from the division of the first operand by the\n  second; the result of the % operator is the remainder. In both operations, <strong>if the value of\n  the second operand is zero, the behavior is undefined.</strong></li>\n  </ol>\n</blockquote>\n\n<p>And about undefined behaviour in chapter 3. Terms, definitions, and symbols:</p>\n\n<blockquote>\n  <h3>3.4.3</h3>\n  \n  <ol>\n  <li>undefined behavior<br>\n  behavior, upon use of a nonportable or erroneous program construct or of erroneous data,\n  for which this International Standard imposes no requirements</li>\n  <li>NOTE  Possible undefined behavior ranges from ignoring the situation completely with unpredictable\n  results, <strong>to behaving during translation</strong> or program execution <strong>in a documented manner characteristic of the\n  environment (with or without the issuance of a diagnostic message)</strong>, to terminating a translation or\n  execution (with the issuance of a diagnostic message).</li>\n  </ol>\n</blockquote>\n\n<p>So crashing the compiler is allowed.</p>\n"}, {"comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1448456638, "post_id": 33916186, "comment_id": 55595525, "body": "So while technically &quot;crashing is allowed&quot;, it&#39;s way more user friendly to show a proper error message instead. (But I guess that&#39;s only an option for errors recognizable while compiling.)"}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1448456700, "post_id": 33916186, "comment_id": 55595571, "body": "@Jongware I was literally writing a QOI paragraph while you made that comment."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1448458688, "post_id": 33916186, "comment_id": 55596928, "body": "I can see that the end of your answer probably says it for C++, but what do you think of a program containing <code>if (0) { int x = 1 &#47; 0; }</code> in C?"}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1448462101, "post_id": 33916186, "comment_id": 55599398, "body": "@Jongware Yes, but any error that would, without any code specifically to handle it, crash the compiler, by definition is recognizable while compiling."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "edited": false, "score": 0, "creation_date": 1448463779, "post_id": 33916186, "comment_id": 55600651, "body": "@Random832: I don&#39;t think so :) This particular construction can be recognized by a parser and so one could issue a proper error message. Anything else would amount to a <code>try .. catch</code> around the entire compiler and only tell you &quot;something probably went wrong somewhere&quot;."}, {"owner": {"reputation": 32626, "user_id": 691884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1f68638c765096502abb3e56274386?s=128&d=identicon&r=PG", "display_name": "Random832", "link": "https://stackoverflow.com/users/691884/random832"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1448466675, "post_id": 33916186, "comment_id": 55602769, "body": "@Jongware You could do a try..catch around the whole constant folding operation and note the line number."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1448466901, "post_id": 33916186, "comment_id": 55602930, "body": "I would say there is a difference between the C language and a compiler program. A program produced by a C compiler will exhibit UB when division by zero occurrs. A compiler program that crashes on division by zero is NOT ub in the language sense; it is just a bug The compiler might even be written in Fortan)."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1448466995, "post_id": 33916186, "comment_id": 55603012, "body": "@PaulOgilvie  the notes to undefined behavior in both C and C++ say <i>to terminating a translation or execution</i> now I agree that an ICE is always considered a bug but I believe it is still conforming."}, {"owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1448467226, "post_id": 33916186, "comment_id": 55603164, "body": "@ShafikYaghmour, and what if the compiler is written in Fortran? UB as quoted here only pertains to the C language and hence to programs written in that language. If the compiler is written in C, then the quotes are correct but do not pertain to the OBs program but to the compiler. &quot;Terminating a translation&quot; is a graceful termination, not a crash."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "edited": false, "score": 0, "creation_date": 1448469268, "post_id": 33916186, "comment_id": 55604506, "body": "@PaulOgilvie the problem is that the standard says <i>imposes no requirements</i> and although one could argue your way the standard does not define <i>terminating</i> and so perhaps these are possible defects. I can see that line of reasoning. The standard does not really confine UB to run-time and I don&#39;t think it can since a lot of optimization decisions and constexpr behavior depends on compiler choices wrt to UB. I agree some clarification is needed though."}, {"owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "edited": false, "score": 1, "creation_date": 1448469515, "post_id": 33916186, "comment_id": 55604691, "body": "Once I asked a question about the <a href=\"http://stackoverflow.com/questions/32154832/is-the-behaviour-of-the-compiler-undefined-with-undefined-behaviour\">behaviour of the compiler when UB is present</a>, new answers would be very welcome..."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1448471759, "post_id": 33916186, "comment_id": 55606140, "body": "Doesn&#39;t this only apply to the <i>evaluation</i> of the <code>&#47;</code> operator? It&#39;s not UB if the expression is never evaluated. For example, the standard <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note118\" rel=\"nofollow noreferrer\">explicitly notes</a> that <code>2 || 1 &#47; 0</code> is defined behavior, even though it contains as a subexpression the expression <code>1 &#47; 0</code>."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1448472250, "post_id": 33916186, "comment_id": 55606459, "body": "Also, as part of the constraints of &quot;constant expression&quot;, it says &quot;Each constant expression shall evaluate to a constant that is in the range of representable values for its type.&quot; Since this is a constraint, that means if an expression doesn&#39;t evaluate to a representable value, it&#39;s not a constant expression. <b>1 / 0 is thus not a constant expression.</b>"}, {"owner": {"reputation": 11848, "user_id": 1082851, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b7d348e29a14b30e33fcaa0560ceb671?s=128&d=identicon&r=PG", "display_name": "tpg2114", "link": "https://stackoverflow.com/users/1082851/tpg2114"}, "edited": false, "score": 0, "creation_date": 1448474966, "post_id": 33916186, "comment_id": 55608077, "body": "Intel also requests that ICE&#39;s are reported as bugs (to add to your list of those who consider it bugs)."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1448737698, "post_id": 33916186, "comment_id": 55706914, "body": "@PascalCuoq I think the standard does not specify this, we can make some guesses, Keith&#39;s and your answer to the linked question I quote and mentioned in other comments gives a good stab but clearly it is not specified. I think it is reasonable to say if the compiler can prove it won&#39;t be executed then it could act <i>as-if</i> there was no UB but we can&#39;t prove that is required."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1448738954, "post_id": 33916186, "comment_id": 55707334, "body": "@ShafikYaghmour I would approach the question from the other direction. In the presence of <code>int main(int c, char*v[]) { if (!exp1) { int y = 1 &#47; exp2; } }</code> the compiler has to behave and to generate code that behaves as long as the compiler cannot prove that <code>exp1</code> and <code>exp2</code> are never 0 simultaneously, because the program can be invoked with arguments that make only one or the other 0 and the programmer has the right to expect the program to have been generated and to work then. I do not see why there should be a discontinuity when exp1 and exp2 are compile-time constants."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1449371440, "post_id": 33916186, "comment_id": 55976908, "body": "@PascalCuoq hmmm, this is an interesting perspective and <a href=\"http://www.open-std.org/jtc1/sc22/wg14/docs/rr/dr_109.html\" rel=\"nofollow noreferrer\">defect report 109</a> agrees with you on this."}, {"owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1449372505, "post_id": 33916186, "comment_id": 55977112, "body": "@PascalCuoq interesting this ub mailing list <a href=\"http://www.open-std.org/pipermail/ub/2014-September/000515.html\" rel=\"nofollow noreferrer\">response</a> sure makes it seems like in C++ the approach is different."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1535483460, "post_id": 33916186, "comment_id": 91080005, "body": "The published Rationale for the C Standard goes into further detail about UB, and recognizes a compiler&#39;s choice of how to behave when the Standard imposes no requirements as a &quot;quality of implementation&quot; issue, noting elsewhere that an implementation could be conforming and yet be of sufficiently poor quality as to be useless."}], "tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": false, "score": 40, "last_activity_date": 1449509775, "last_edit_date": 1495540398, "creation_date": 1448453378, "answer_id": 33916186, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression/33916186#33916186", "title": "Dividing by zero in a constant expression", "body": "<p>Yes, division by zero is undefined behavior and neither the C nor C++ standard impose any requirements in such cases. Although in this case I believe you should at least issue a diagnostic(<em>see below</em>).</p>\n\n<p>Before I go quoting the standards, I should note that although this may be conformant behavior <em>quality of implementation</em> is a different issue, being merely conforming is not the same as being useful. As far as I know the gcc, clang, Visual Studio and Intel(<em>as per tpg2114</em>) team consider internal compiler errors(<em>ICEs</em>) to be bugs that should be reported. It should be noted that both current gcc and clang produce a warning for this case seemingly regardless of flags provided. In the case where both operands are literals/constants, the case we have here, it seems rather straight forward to detect and provide a diagnostic for this. clang produces the following diagnostic for this case (<em><a href=\"http://coliru.stacked-crooked.com/a/231747f2a6ed74d6\" rel=\"nofollow noreferrer\">see it live</a></em>):</p>\n\n<pre><code>warning: division by zero is undefined [-Wdivision-by-zero]\nint x = 1 / 0 ;\n          ^ ~\n</code></pre>\n\n<p>From the draft C11 standard section <code>6.5.5</code> Multiplicative operators (<em>emphasis mine</em>):</p>\n\n<blockquote>\n  <p>The result of the / operator is the quotient from the division of the first operand by the\n  second; [...] <strong>if the value of\n  the second operand is zero, the behavior is undefined.</strong></p>\n</blockquote>\n\n<p>and so it is undefined behavior.</p>\n\n<p>The draft C++ standard section <code>5.6</code> <em>[expr.mul]</em> says:</p>\n\n<blockquote>\n  <p>The binary / operator yields the quotient [...] <strong>If the second operand of / or % is zero the behavior is undefined</strong> [...]</p>\n</blockquote>\n\n<p>again undefined behavior.</p>\n\n<p>Both the draft C++ standard and draft C standard have a similar definition for undefined behavior both saying:</p>\n\n<blockquote>\n  <p>[...]for which this International Standard <strong>imposes no requirements</strong></p>\n</blockquote>\n\n<p>The phrase <em>imposes no requirements</em> seems too allow any behavior, including <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">nasal demons</a>. Both have a similar note saying something along the lines of:</p>\n\n<blockquote>\n  <p>Undefined behavior may be expected when this International Standard omits any explicit definition of\n  behavior or when a program uses an erroneous construct or erroneous data. <strong>Permissible undefined behavior\n  ranges from ignoring the situation completely with unpredictable results</strong>, to behaving during translation or\n  program execution in a documented manner characteristic of the environment (with or without the issuance of\n  a diagnostic message), <strong>to terminating a translation or execution (with the issuance of a diagnostic message)</strong>.</p>\n</blockquote>\n\n<p>So although notes are not normative, it seems like if you are going to terminate during translation, you should at least issue a diagnostic. The term <em>terminating</em> is not defined, so it is hard to argue what this allows. I don't think I have seen a case where clang and gcc have an ICE without a diagnostic.</p>\n\n<p><B>Does the code have to be executed?</B></p>\n\n<p>If we read <a href=\"https://stackoverflow.com/q/18385020/1708801\">Can code that will never be executed invoke undefined behavior?</a> we can see at least in case of C there is room for debate where the <code>1 / 0</code> has to be executed in order to invoke undefined behavior. What is worse in the C++ case the definition of <em>behavior</em> is not present so part of the analysis used for the C case can not be used for the C++ case.</p>\n\n<p>It seems that if the compiler can prove the code will never be executed then we can reason that it would be <em>as-if</em> the program did not have undefined behavior but I don't think this is provable, just reasonable behavior.</p>\n\n<p>From the C perspective <a href=\"http://www.open-std.org/jtc1/sc22/wg14/docs/rr/dr_109.html\" rel=\"nofollow noreferrer\">WG14 defect report 109</a> further clarifies this. The following code example is given:</p>\n\n<pre><code>int foo()\n{\n  int i;\n  i = (p1 &gt; p2); /* Must this be \"successfully translated\"? */\n  1/0; /* Must this be \"successfully translated\"? */\n  return 0;\n} \n</code></pre>\n\n<p>and the response included:</p>\n\n<blockquote>\n  <p>Furthermore, if every possible execution of a given program would result in undefined behavior, the given program is not strictly conforming. \n  <BR>A conforming implementation must not fail to translate a strictly conforming program simply because some possible execution of that program would result in undefined behavior. Because foo might never be called, the example given must be successfully translated by a conforming implementation. </p>\n</blockquote>\n\n<p>So in the case of C, unless it can be guaranteed that the code invoking undefined behavior will be executed then the compiler must successfully translate the program. </p>\n\n<p><B>C++ constexpr case</B></p>\n\n<p>If <code>x</code> was a constexpr variable:</p>\n\n<pre><code>constexpr int x = 1 / 0 ;\n</code></pre>\n\n<p>it would be ill-formed and gcc produces a warning and clang makes it error (<em><a href=\"http://melpon.org/wandbox/permlink/3PTo6hKwjVjCufcX\" rel=\"nofollow noreferrer\">see it live</a></em>):</p>\n\n<pre><code>error: constexpr variable 'x' must be initialized by a constant expression\nconstexpr int x = 1/ 0 ;\n             ^   ~~~~\nnote: division by zero\nconstexpr int x = 1/ 0 ;\n                  ^\nwarning: division by zero is undefined [-Wdivision-by-zero]\nconstexpr int x = 1/ 0 ;\n                  ^ ~\n</code></pre>\n\n<p>Helpfully noting that <em>division by zero is undefined</em>.</p>\n\n<p>The draft C++ standard section <code>5.19</code> Constant expressions [expr.const] says:</p>\n\n<blockquote>\n  <p>A conditional-expression e is a core constant expression unless the evaluation of e, following the rules of the\n  abstract machine (1.9), would evaluate one of the following expressions</p>\n</blockquote>\n\n<p>and includes the following bullet:</p>\n\n<blockquote>\n  <p>an operation that would have undefined behavior [Note: including, for example, signed integer overflow\n  (Clause 5), certain pointer arithmetic (5.7), division by zero (5.6), or certain shift operations (5.8)\n  \u2014end note ];</p>\n</blockquote>\n\n<p><B>Is 1 / 0 a constant expression in C11</B></p>\n\n<p><code>1 / 0</code> is not a constant expression in C11, we can see this from section <code>6.6</code> Constant expressions which says:</p>\n\n<blockquote>\n  <p>Each constant expression shall evaluate to a constant that is in the range of representable\n  values for its type.</p>\n</blockquote>\n\n<p>although, it does allow:</p>\n\n<blockquote>\n  <p>An implementation may accept other forms of constant expressions.</p>\n</blockquote>\n\n<p>So <code>1 / 0</code> is not a constant expression in either C or C++ but that does not change the answer since it is not being used in a context that requires a constant expression. I suspect the OP meant that <code>1 / 0</code> is available for constant folding since both operands are literals, this would also explain the crash.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "edited": false, "score": 3, "creation_date": 1448480730, "post_id": 33923241, "comment_id": 55611283, "body": "Another example that the OP should consider is <code>void f() { int i = 1 &#47; 0; }</code>, which may occur in a strictly conforming program that never calls <code>f</code>. Just in case the OP was considering trying to fix the bug by adding simple dead code analysis."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1448494572, "post_id": 33923241, "comment_id": 55617577, "body": "If it is guaranteed that program flow will cause UB, then the behaviour of the entire program is undefined.  (But the compiler still should not crash of course)."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 3, "creation_date": 1448529545, "post_id": 33923241, "comment_id": 55629320, "body": "I think this answer is great and all 3 points are correct, but I don&#39;t agree with the conclusion in the context of the question. If we assume that <code>1 &#47; 0</code> <i>is</i> evaluated and there is UB, then standard does not give any requirements on behaviour of program <i>or compiler</i>. While it&#39;s not good to crash compiler, it&#39;s still valid thing to do. Expression not being a constant expression is irrelevant in this case."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "reply_to_user": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 0, "creation_date": 1448563749, "post_id": 33923241, "comment_id": 55649581, "body": "@user694733: The way I read the question, there&#39;s no guarantee the expression will be evaluated. I suppose it&#39;s worth adding a note about what happens if the expression is guaranteed to be evaluated."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1535483270, "post_id": 33923241, "comment_id": 91079922, "body": "@user2357112: Although it is common for implementations to convert source text to an executable which may be executed at leisure, the Standard regards an &quot;implementation&quot; as being something which accepts the source code, converts it into some other form if convenient, and then executes it.  I don&#39;t think the Standard guarantees a &quot;sequence point&quot; between the end of translation and the start of execution."}], "tags": [], "owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "is_accepted": true, "score": 24, "last_activity_date": 1448564240, "last_edit_date": 1448564240, "creation_date": 1448473762, "answer_id": 33923241, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression/33923241#33923241", "title": "Dividing by zero in a constant expression", "body": "<p>The mere presence of <code>1 / 0</code> does not permit the compiler to crash. At most, it is permitted to assume that the expression will never be evaluated, and thus, that execution will never reach the given line.</p>\n\n<p>If the expression is guaranteed to be evaluated, the standard imposes no requirements on the program or compiler. <em>Then</em> the compiler can crash.</p>\n\n<h3>1 / 0 is only UB if evaluated.</h3>\n\n<p>The C11 standard gives an <a href=\"http://port70.net/~nsz/c/c11/n1570.html#note118\">explicit example</a> of <code>1 / 0</code> being defined behavior when unevaluated:</p>\n\n<blockquote>\n  <p>Thus, in the following initialization,</p>\n\n<pre><code>        static int i = 2 || 1 / 0;\n</code></pre>\n  \n  <p>the expression is a valid integer constant expression with value one.</p>\n</blockquote>\n\n<p>Section 6.6, footnote 118.</p>\n\n<h3>1 / 0 is not a constant expression.</h3>\n\n<p><a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.6\">Section 6.6</a> of the C11 standard, under Constraints, says</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Constant expressions shall not contain assignment, increment, decrement, function-call, or comma operators, except when they are contained within a subexpression that is not evaluated.</li>\n  <li><strong>Each constant expression shall evaluate to a constant that is in the range of representable values for its type.</strong></li>\n  </ol>\n</blockquote>\n\n<p>Since 1/0 does not evaluate to a constant in the range of values representable by an int, 1/0 is not a constant expression. This is a rule about what counts as a constant expression, like the rule about not having assignments in it. You can see that at least for C++, <a href=\"http://melpon.org/wandbox/permlink/3PTo6hKwjVjCufcX\">Clang doesn't consider 1/0 a constant expression</a>:</p>\n\n<pre><code>prog.cc:3:18: error: constexpr variable 'x' must be initialized by a constant expression\n   constexpr int x = 1/ 0 ;\n                 ^   ~~~~\n</code></pre>\n\n<h3>It wouldn't make much sense for an unevaluated 1 / 0 to be UB.</h3>\n\n<p><code>(x == 0) ? x : 1 / x</code> is perfectly well-defined, even if x is 0 and evaluating 1/x is UB. If it were the case that <code>(0 == 0) ? 0 : 1 / 0</code> were UB, that would be nonsense.</p>\n"}, {"tags": [], "owner": {"reputation": 1660, "user_id": 172821, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cf505c9af73357aad874f83044c8551c?s=128&d=identicon&r=PG", "display_name": "ddyer", "link": "https://stackoverflow.com/users/172821/ddyer"}, "is_accepted": false, "score": -1, "last_activity_date": 1449009574, "creation_date": 1449009574, "answer_id": 34031568, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression/34031568#34031568", "title": "Dividing by zero in a constant expression", "body": "<p>How the compiler should behave is unrelated to the value of the expression.  The compiler should not crash.  Period.   </p>\n\n<p>I imagine that a pedantic implementation, given an expression like this, would\ncompile to code that will execute 1/0 at run time, but I don't think that\nwould be seen as a good feature.</p>\n\n<p>So the remaining space is that the compiler should decline to compile it, and\ntreat it as some class of source code error.</p>\n"}, {"comments": [{"owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "edited": false, "score": 0, "creation_date": 1449050572, "post_id": 34032876, "comment_id": 55834373, "body": "I suppose RPN for expressions is simpler and more efficient than an AST?"}, {"owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "reply_to_user": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "edited": false, "score": 0, "creation_date": 1449052948, "post_id": 34032876, "comment_id": 55835934, "body": "@fredoverflow Well, it has its upsides and downsides. It needs little memory, it&#39;s easy to slap a unary operator on top of an expression or a binary operator with a right operand and it&#39;s easy to generate code (poor but functional) from. However, traversing it as a tree is more difficult and so is transforming it (especially inserting, deleting or rotating nodes; all the usual problems with arrays). One unexpected benefit from RPNs in arrays may be that your compiler doesn&#39;t need to support structures (to implement trees with interlinked nodes) to be able to compile itself."}], "tags": [], "owner": {"reputation": 57963, "user_id": 968261, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/16f69ca344773bd6c34970b2f6186d61?s=128&d=identicon&r=PG", "display_name": "Alexey Frunze", "link": "https://stackoverflow.com/users/968261/alexey-frunze"}, "is_accepted": false, "score": 2, "last_activity_date": 1449016357, "creation_date": 1449016357, "answer_id": 34032876, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression/34032876#34032876", "title": "Dividing by zero in a constant expression", "body": "<p>Others have already mentioned the relevant text from the standards, so, I'm not going to repeat that.</p>\n\n<p>My C compiler's expression evaluating function takes an expression in Reverse Polish Notation (array of values (numbers and identifiers) and operators) and returns two things: a flag for whether or not the expression evaluates to a constant and the value if it's a constant (0 otherwise). If the result is a constant, the whole RPN reduces to just that constant. 1/0 is not a constant expression since it doesn't evaluate to a constant integer value. The RPN is not reduced for 1/0 and stays intact.</p>\n\n<p>In C, static variables can be initialized with constant values only. So, the compiler errors out when it sees that an initializer for a static variable is not a constant. Variables of automatic storage can be initialized with non-constant expressions. In this case my compiler generates code to evaluate 1/0 (it still has the RPN for this expression!). If this code is reached at runtime, UB occurs as prescribed by the language standards. [On x86 this UB takes on the form of the division by zero CPU exception, while on MIPS this UB yields an incorrect quotient value (the CPU does not have a division by zero exception).]</p>\n\n<p>My compiler properly supports short-circuiting in ||-expressions and &amp;&amp;-expressions. So, it evaluates <code>1 || 1/0</code> as 1 and <code>0 &amp;&amp; 1/0</code> as 0, regardless of whether or not the right-hand operand of the logical operator is a constant. The expression evaluating function removes the right-hand operands of these operators (along with the operators) when they must not be evaluated and so <code>1 || 1/0</code> transforms into <code>1 != 0</code> (recall that the operands of &amp;&amp; and || undergo comparison with 0), which yields 1 and <code>0 &amp;&amp; 1/0</code> transforms into <code>0 != 0</code>, which yields 0.</p>\n\n<p>Another case to take care of is <code>INT_MIN / -1</code> and <code>INT_MIN % -1</code> (ditto for larger integer types). The quotient is not representable as a signed int (in the case of 2's complement signed integers, which is what we have in all modern CPUs) and so this is UB as well (you get the same division by zero exception on x86 at runtime). I handle this case similarly. This expression can't initialize a variable of static storage and it's thrown away if it's not evaluated in the logical &amp;&amp;/|| operator. It can initialize an automatic variable, possibly leading to UB at runtime.</p>\n\n<p>I also issue a warning when such division is encountered.</p>\n"}], "owner": {"reputation": 235985, "user_id": 252000, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/082b8ee2b0aebb430b8d4d98e6a5c32f?s=128&d=identicon&r=PG", "display_name": "fredoverflow", "link": "https://stackoverflow.com/users/252000/fredoverflow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4749, "favorite_count": 7, "accepted_answer_id": 33923241, "answer_count": 5, "score": 43, "last_activity_date": 1449509775, "creation_date": 1448453160, "question_id": 33916113, "link": "https://stackoverflow.com/questions/33916113/dividing-by-zero-in-a-constant-expression", "title": "Dividing by zero in a constant expression", "body": "<p>My toy compiler crashes if I divide by zero in a constant expression:</p>\n\n<pre><code>int x = 1 / 0;\n</code></pre>\n\n<p>Is this behaviour allowed by the C and/or C++ standards?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "edited": false, "score": 11, "creation_date": 1448452940, "post_id": 33916002, "comment_id": 55593171, "body": "Do not post code as image links. Edit your question and add code in text format."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 2, "creation_date": 1448453625, "post_id": 33916002, "comment_id": 55593557, "body": "If this is a C program, why did you tag this C++?"}], "answers": [{"comments": [{"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448453933, "post_id": 33916092, "comment_id": 55593731, "body": "If he changes his code to <code>char a[255];</code> it will work."}, {"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448453988, "post_id": 33916092, "comment_id": 55593763, "body": "Also, one should <i>not</i> use gets as it has no bounds checking!"}, {"owner": {"reputation": 6790, "user_id": 1027706, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff91cf16cbd51dad8e48e2799f97e811?s=128&d=identicon&r=PG", "display_name": "Ad N", "link": "https://stackoverflow.com/users/1027706/ad-n"}, "reply_to_user": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 1, "creation_date": 1448453995, "post_id": 33916092, "comment_id": 55593766, "body": "Yes, as long as he types an input string that is strictly less than 255 chars long ;)"}], "tags": [], "owner": {"reputation": 6790, "user_id": 1027706, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ff91cf16cbd51dad8e48e2799f97e811?s=128&d=identicon&r=PG", "display_name": "Ad N", "link": "https://stackoverflow.com/users/1027706/ad-n"}, "is_accepted": false, "score": 2, "last_activity_date": 1448454738, "last_edit_date": 1448454738, "creation_date": 1448453117, "answer_id": 33916092, "question_id": 33916002, "link": "https://stackoverflow.com/questions/33916002/why-is-it-showing-the-6-as-the-length-of-the-array-instead-of-5/33916092#33916092", "title": "why is it showing the 6 as the length of the array instead of 5?", "body": "<p><a href=\"http://www.cplusplus.com/reference/cstdio/gets/\" rel=\"nofollow\">gets()</a> adds a null character after the characters in your input string. If you type \"Jason\", which is 5 chars long, you should make your array of size \"6\", providing room for null-character appended by the function (see link).</p>\n\n<p>Your code, as it is, is exhibiting undefined behaviour when you type \"Jason\" (as you are overflowing your <code>a</code> array).</p>\n\n<hr>\n\n<p>Also, as a good practice, avoid using C-style arrays in new C++ code. Prefer <code>std::vector</code>, or in this particular case <code>std::string</code>. Those will take care of memory management for you, avoiding potential overflows as in you example.</p>\n\n<p>If you are compiling this code as C++ code, you should include your C headers using the form:</p>\n\n<pre><code>#include &lt;cstdio&gt;\n</code></pre>\n\n<p>And finally, <code>gets</code> was deprecated since C++11 standard. If you write C++ code, you should consider more recent (and safer) alternative. (thanks @Matthew Gunn for his comment).</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448454635, "post_id": 33916216, "comment_id": 55594143, "body": "<code>gets()</code> does not save the <code>&#39;\\n&#39;</code>."}], "tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 0, "last_activity_date": 1448453474, "creation_date": 1448453474, "answer_id": 33916216, "question_id": 33916002, "link": "https://stackoverflow.com/questions/33916002/why-is-it-showing-the-6-as-the-length-of-the-array-instead-of-5/33916216#33916216", "title": "why is it showing the 6 as the length of the array instead of 5?", "body": "<p>Strings in C all are terminated by a null byte (<code>\\0</code>). Your call of the <code>gets()</code> function adds this to your string automatically, and so the string <code>\"Jason\"</code> is actually an array of characters that looks like this:</p>\n\n<pre><code>{'J','a','s','o','n','\\n','\\0'}\n</code></pre>\n\n<p>You see, in actuality that is 7 characters. <code>strlen()</code> by design doesn't count the <code>\\0</code>, but its there.</p>\n"}, {"tags": [], "owner": {"reputation": 1075, "user_id": 582225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecd9b5d3527c4cfa71fcb0e0f4ebfe99?s=128&d=identicon&r=PG", "display_name": "BinaryGuy", "link": "https://stackoverflow.com/users/582225/binaryguy"}, "is_accepted": false, "score": 1, "last_activity_date": 1448453507, "creation_date": 1448453507, "answer_id": 33916226, "question_id": 33916002, "link": "https://stackoverflow.com/questions/33916002/why-is-it-showing-the-6-as-the-length-of-the-array-instead-of-5/33916226#33916226", "title": "why is it showing the 6 as the length of the array instead of 5?", "body": "<p>Since you didn't initialise the array with empty data the last element is garbage as your string isn't long enough to set the last element.</p>\n\n<p>Also remember that arrays are zero based and don't confuse the length of your array with the length of the string which is null terminated.  For example:</p>\n\n<pre><code>char someString[10] = \"jason\";\n\nsizeof(someString) // will be 10\nstrlen(someString) // will be 5\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5507224, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/bFKnq.jpg?s=128&g=1", "display_name": "sb-coder", "link": "https://stackoverflow.com/users/5507224/sb-coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1448457298, "creation_date": 1448452889, "last_edit_date": 1448454222, "question_id": 33916002, "link": "https://stackoverflow.com/questions/33916002/why-is-it-showing-the-6-as-the-length-of-the-array-instead-of-5", "title": "why is it showing the 6 as the length of the array instead of 5?", "body": "<p>I'v made a c program in which I'm calculating the length of an array.</p>\n\n<p>But when i enter a string it shows 1 extra character like when i enter <code>\"Jason\"</code> which is of 5 character long it shows 6 characters. </p>\n\n<p>Further, i have made a loop that loops through every element and there also I see 6 values in which the 6th one seems to be the garbage value.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n\nvoid main()\n{\n    char a[5];\n    int i;\n    printf(\"Enter a string: \");\n    gets(a);\n    for (i=0; a[i]!='\\0'; i++){\n        printf(Ch no %d is %c \\n\",i,a[i]);\n    }\n    printf(\"Lentgh of array = %d\",i);\n    getch();\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/FOiU5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FOiU5.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["c++", "c", "typedef"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 5, "creation_date": 1448459495, "post_id": 33915522, "comment_id": 55597514, "body": "In your three latter examples, the name &quot;y&quot; is not &quot;not yet defined&quot; or &quot;unknown&quot; - it is defined by respectively the struct, union, and enum where it occurs. (You can&#39;t subdivide <code>enum { y }</code>.) The examples have the same structure as <code>typedef int x;</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1448463316, "post_id": 33915522, "comment_id": 55600318, "body": "Try &quot;first undefined identifier outside of curly braces&quot;."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 3, "creation_date": 1448470379, "post_id": 33915522, "comment_id": 55605284, "body": "If you remove the <code>tyoedef</code> keyword, what&#39;s left is a variable declaration. The name of the typedef is the name of the variable. I&#39;m not posting this as an answer because parsing variable declarations is still non-trivial. Incidentally, <code>typedef</code> does not create a new type, just a new name for an existing type."}, {"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1448471243, "post_id": 33915522, "comment_id": 55605820, "body": "@n.m. or &quot;first undefined identifier outside of curly braces that isn&#39;t a <code>struct</code>/<code>union</code>/<code>enum</code> tag&quot;."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1448482970, "post_id": 33915522, "comment_id": 55612363, "body": "To expand on my previous comment, <code>typedef</code> is treated syntactically like a storage class specifier, like <code>extern</code>, <code>static</code>, or <code>register</code>.  Logically it&#39;s a very different thing (it creates a new name for a type rather than declaring an object). The syntactic similarity is purely for convenience."}, {"owner": {"reputation": 700, "user_id": 3474568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/he5ME.png?s=128&g=1", "display_name": "Ken Clement", "link": "https://stackoverflow.com/users/3474568/ken-clement"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1449717328, "post_id": 33915522, "comment_id": 56132351, "body": "@Keith Thompson nailed it.  The &quot;type alias&quot; that is being defined is the identifier that would be declared a variable without the typedef keyword.  If you are considering a program that would automatically identify this identifier, such a program will have to have the smarts to properly parse the entire syntax.  Simple heuristics will not do."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 0, "creation_date": 1453298965, "post_id": 33915522, "comment_id": 57540540, "body": "K&amp;R C book devotes some space to describing how to write a parser for declarations. I do not remember how exhaustive it was, but it&#39;s certainly worth looking into."}, {"owner": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "reply_to_user": {"reputation": 20507, "user_id": 1463922, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3878980c7836d9e36f3a9ac100ff36a8?s=128&d=identicon&r=PG", "display_name": "PiotrNycz", "link": "https://stackoverflow.com/users/1463922/piotrnycz"}, "edited": false, "score": 0, "creation_date": 1453316307, "post_id": 33915522, "comment_id": 57552423, "body": "@PiotrNycz: It&#39;s only similar if you consider every question similar that has questions about types in C."}, {"owner": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1453387659, "post_id": 33915522, "comment_id": 57587080, "body": "How about finding the &#39;first undefined identifier&#39; in <code>typedef struct xx { int yy; } zz;</code> \u2014 is it <code>xx</code> or <code>zz</code>?"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 8087, "user_id": 733637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444bbb295cc6185a5464e2250c1a35de?s=128&d=identicon&r=PG&f=1", "display_name": "CiaPan", "link": "https://stackoverflow.com/users/733637/ciapan"}, "edited": false, "score": 0, "creation_date": 1454321284, "post_id": 33915522, "comment_id": 57975341, "body": "@CiaPan: xx in this expression is declared as a struct (definition following immediately) and thus not undefined/unknown any more. Thus remains zz..."}], "answers": [{"comments": [{"owner": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 1, "creation_date": 1453313616, "post_id": 34902167, "comment_id": 57550943, "body": "Unless you are in some C dialect, where <code>struct _x { int y; }; typedef _x x;</code> resolves to a compile time error because you need <code>struct _x { int y; }; typedef struct _x x;</code>. Long story short: beware of trivial answers."}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "reply_to_user": {"reputation": 12119, "user_id": 5265292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0b9b1031971201aa02e13287af690946?s=128&d=identicon&r=PG&f=1", "display_name": "grek40", "link": "https://stackoverflow.com/users/5265292/grek40"}, "edited": false, "score": 0, "creation_date": 1453386223, "post_id": 34902167, "comment_id": 57585995, "body": "Absolutely true - missed that the question is tagged &#39;C&#39;, too... Edited the answer appropriately."}], "tags": [], "owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "is_accepted": false, "score": 0, "last_activity_date": 1453386163, "last_edit_date": 1453386163, "creation_date": 1453298603, "answer_id": 34902167, "question_id": 33915522, "link": "https://stackoverflow.com/questions/33915522/how-to-find-new-type-in-typedef/34902167#34902167", "title": "How to find new type in typedef", "body": "<p>Well, your y actually <strong>are</strong> defined: In your first two examples <em>y</em> is a member variable of type int within the anonymous struct/union and as such well defined. In the third example, <em>y</em> is one of the enum members and again well defined. For better understanding, imagine your typedefs would have been written as:</p>\n\n<pre><code>struct _x { int y; };\ntypedef struct _x x;\n\nunion _x { int y; }\ntypedef union _x x;\n\nenum _x { y };\ntypedef enum _x x;\n</code></pre>\n\n<p>(C++ allows simplifying this to <code>typedef _x x;</code> in all three cases, C does not, however...)</p>\n\n<p>From point of view of the typedef, it's exactly the same. The only true difference is that now the typedef'ed types have names (_x)...</p>\n"}, {"comments": [{"owner": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "edited": false, "score": 0, "creation_date": 1453316031, "post_id": 34903579, "comment_id": 57552282, "body": "Your answer is not referencing my question. From what you say, the type specifier (plus the stuff behind) introduce the typedef&#39;d type. That&#39;s not true for the struct in my examples: <code>typedef struct { int y; } x;</code> : The first time that a type specifier is fully mentioned (reading from left to right) is after the <code>int</code> (the struct is not yet completely defined). So from your answer, <code>y</code> would have been typedef&#39;d."}, {"owner": {"reputation": 3284, "user_id": 1487069, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jsf93.png?s=128&g=1", "display_name": "Carlo Wood", "link": "https://stackoverflow.com/users/1487069/carlo-wood"}, "reply_to_user": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "edited": false, "score": 0, "creation_date": 1453374373, "post_id": 34903579, "comment_id": 57577785, "body": "I said that only arrays, functions and member functions have a pre- and postfix (the qualifiers and new type appear in the middle). Since a struct is neither, the new type appears at the end. The syntax is: <code>typedef struct { ... } newtype;</code> and it doesn&#39;t matter what is between the <code>{ ... }</code>. [PS I&#39;m the author of the first (new ABI) C++ demangler that demangled 100% correctly ;). A demangler outputs types; so I know pretty sure the construction of a type as I showed at the bottom is the right way to think about this.]"}, {"owner": {"reputation": 19667, "user_id": 1312382, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FL8Fg.jpg?s=128&g=1", "display_name": "Aconcagua", "link": "https://stackoverflow.com/users/1312382/aconcagua"}, "edited": false, "score": 0, "creation_date": 1453386778, "post_id": 34903579, "comment_id": 57586448, "body": "Have you noticed? Although the type is not yet complete, the first unknown identifier still is &#39;array&#39; (would correspond to the &#39;x&#39; in the question) in all the examples. So Johannes intuition would still apply here, too (well, at least, if reading the question as &#39;find the name of...&#39;, which is what i did intuitively). At a first glance, this seems to be conflicting with the struct/union/enum case, (int array &lt;-&gt; int y), however the important difference is that we are right within a type definition which has to be completed before considering the &#39;first unknown&#39; rule..."}, {"owner": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "edited": false, "score": 0, "creation_date": 1453391311, "post_id": 34903579, "comment_id": 57589633, "body": "@CarloWood: Let&#39;s see if I can follow: A struct is none of array/function/member function (function pointers probably need to be mentioned, too), so it has no prefix. Since it has no prefix, the last thing can not be a prefix, so it must be the newly defined type. Is that what you meant? Btw: Sorry if my answer sounded unfriendly, but if my question is mostly about structs, those should clearly be mentioned in the answer."}, {"owner": {"reputation": 3284, "user_id": 1487069, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jsf93.png?s=128&g=1", "display_name": "Carlo Wood", "link": "https://stackoverflow.com/users/1487069/carlo-wood"}, "reply_to_user": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "edited": false, "score": 0, "creation_date": 1453484754, "post_id": 34903579, "comment_id": 57637364, "body": "@Johannes: I&#39;d say &#39;postfix&#39; instead of prefix. But, to summarize: each typedef begins with a (known) type followed by either the new type, or by a series of opening brackets and/or qualifiers and then the new type; optionally followed by closing brackets and/or (PARAMS) and/or [DIM] sequences."}, {"owner": {"reputation": 3284, "user_id": 1487069, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jsf93.png?s=128&g=1", "display_name": "Carlo Wood", "link": "https://stackoverflow.com/users/1487069/carlo-wood"}, "edited": false, "score": 0, "creation_date": 1453484761, "post_id": 34903579, "comment_id": 57637370, "body": "All in all not too hard to decipher thus, if it wasn&#39;t for the fact that both the first type as well as the PARAMS list can be arbitrarily complex and therefore might make it hard to decipher where they end. In the case that the leading type is a struct, then I wouldn&#39;t call it very complex as the {..} are neatly balanced and thus it&#39;s easy to find where the struct ends. Ie: <code>typedef struct foo { int (*f)(int); int y } (* const name)(struct foo&amp;);</code> clearly has as return type <code>struct foo {...}</code> and thus &#39;name&#39; is the new type."}], "tags": [], "owner": {"reputation": 3284, "user_id": 1487069, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/jsf93.png?s=128&g=1", "display_name": "Carlo Wood", "link": "https://stackoverflow.com/users/1487069/carlo-wood"}, "is_accepted": false, "score": 0, "last_activity_date": 1453303906, "last_edit_date": 1453303906, "creation_date": 1453302411, "answer_id": 34903579, "question_id": 33915522, "link": "https://stackoverflow.com/questions/33915522/how-to-find-new-type-in-typedef/34903579#34903579", "title": "How to find new type in typedef", "body": "<p>Every type exists of a non-pointer type followed by zero or more qualifiers, where the qualifiers can be *, &amp;, const, volatile and/or restrict. It is after those qualifiers that the new typename appears in a typedef. This changes the question to 'where do those qualifier appear',\nbecause they don't really appear at the end of the characters that make up the base-type, but can appear somewhere 'in the middle' when the base type is an array and/or (member)function.</p>\n\n<p>For example:</p>\n\n<pre><code>typedef int array[5]; // new type 'array' of type int[5].\ntypedef int* array[5]; // new type 'array' of type int*[5];\ntypedef int (*array)[5]; // new type 'array' of type pointer-to-int[5].\ntypedef int function(float); // new type 'function' of type int ()(float)\ntypedef int (*function)(float); // new type 'function' of type int (*)(float) or pointer-to int ()(float).\ntypedef int (Class::*member)(float); // new type 'member' of type member-function-pointer to int (Class::)(float).\n</code></pre>\n\n<p>These are the only types where the qualifiers appear in the middle, the rest has the form:</p>\n\n<pre><code>typedef SOMETYPE&lt;qualifiers here&gt; newtype_here;\n</code></pre>\n\n<p>These constructions would still be rather easy to parse if it wasn't for the fact that they can also be combined. Aka:</p>\n\n<p>An array:</p>\n\n<pre><code>TYPE name [DIM]\n</code></pre>\n\n<p>A function pointer:</p>\n\n<pre><code>RETTYPE (*name) (PARAMS)\n</code></pre>\n\n<p>An array of function pointers:</p>\n\n<pre><code>RETTYPE (*name[DIM]) (PARAMS)\n</code></pre>\n\n<p>A function returning a pointer to an array:</p>\n\n<pre><code>TYPE (*name(PARAMS)) [DIM]\n</code></pre>\n\n<p>A pointer to a function(1) returning a reference to an array of const function(2) pointers:</p>\n\n<pre><code>RETTYPE (* const (&amp;(*name)(PARAMS2))[DIM])(PARAMS1)\n</code></pre>\n\n<p>So, if you can eliminate all brackets with PARAMS which can be recognized by the fact that they start with a known type (ie: (int ...)), then the new type will either appear all the way on the right or inside the inner most pair of brackets (that aren't function (PARAMS)) after one or more qualifiers.</p>\n\n<p>Lets construct the type above in steps:</p>\n\n<p>A pointer to\n- a function(2) returning\n-   a reference to\n-     an array of\n-       a const\n-         pointer to\n-           a function(1)</p>\n\n<p>Now read it backwards:</p>\n\n<p>a function(1):</p>\n\n<pre><code>RETTYPE ( )(PARAMS1)\n         ^\n</code></pre>\n\n<p>pointer to:</p>\n\n<pre><code>RETYPE (* )(PARAMS1)\n         ^\n</code></pre>\n\n<p>(being) const:</p>\n\n<pre><code>RETTYPE (* const )(PARAMS1)\n                ^\n</code></pre>\n\n<p>an array of:</p>\n\n<pre><code>RETTYPE (* const ( )[DIM])(PARAMS1)\n                  ^\n</code></pre>\n\n<p>a reference to:</p>\n\n<pre><code>RETTYPE (* const (&amp; )[DIM])(PARAMS1)\n                   ^\n</code></pre>\n\n<p>a function(2) returning:</p>\n\n<pre><code>RETTYPE (* const (&amp; ( )(PARAMS2))[DIM])(PARAMS1)\n                     ^\n</code></pre>\n\n<p>a pointer to:</p>\n\n<pre><code>RETTYPE (* const (&amp; (* )(PARAMS2))[DIM])(PARAMS1)\n                      ^\n</code></pre>\n\n<p>then the new type-name will be put where the ^ points to.</p>\n"}], "owner": {"reputation": 2517, "user_id": 985292, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e6ca85a16a179e7fdc825f2159d5aff1?s=128&d=identicon&r=PG", "display_name": "Johannes", "link": "https://stackoverflow.com/users/985292/johannes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1453386163, "creation_date": 1448451406, "last_edit_date": 1448462975, "question_id": 33915522, "link": "https://stackoverflow.com/questions/33915522/how-to-find-new-type-in-typedef", "title": "How to find new type in typedef", "body": "<p>There are tons of tutorials on how to read typedefs, especially for function pointers. The left-right-rule always starts with \"find the newly defined type, then ...\". I understand the \"then...\" part, but not how to find the new type.</p>\n\n<p>I know this is \"intuition\", but I wanted to have a clear recipe that a computer can understand.</p>\n\n<p>My first idea: The new type is the first type you encounter that is not yet defined. True for function pointers:</p>\n\n<pre><code>typedef char (*(*x[3])(int y))[5];\n</code></pre>\n\n<p>Here, x is the first undefined identifier, so x is the new type. Now, look at this:</p>\n\n<pre><code>typedef struct { int y; } x;\ntypedef union { int y; } x;\ntypedef enum { y } x;\n</code></pre>\n\n<p>The rule does not apply here: y is the first unknown identifier, but x is the typedefed type.</p>\n\n<p>Is there a rule to find the new typedefed type in all possible typedefs?</p>\n"}, {"tags": ["c", "sorting", "memcmp"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1448450853, "post_id": 33915248, "comment_id": 55591959, "body": "maybe because sign bit is 1 for -ve numbers?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448455179, "post_id": 33915248, "comment_id": 55594509, "body": "Note: Nice <code>bubblesortA()</code>.  Try with 2 negative <code>int</code>s --&gt; <code>1, 3, -3, -1</code>.  Now try this with <code>double</code>.  You may get a sort like <code>1.0, 3.0, -1.0, -3.0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1448451602, "post_id": 33915401, "comment_id": 55592415, "body": "So,how can i fix the program to discover that negative numbers are less than positive numbers?"}], "tags": [], "owner": {"reputation": 11458, "user_id": 3435400, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/61726fe80facc93d76754f0226b49eb9?s=128&d=identicon&r=PG&f=1", "display_name": "alain", "link": "https://stackoverflow.com/users/3435400/alain"}, "is_accepted": false, "score": 6, "last_activity_date": 1448451045, "creation_date": 1448451045, "answer_id": 33915401, "question_id": 33915248, "link": "https://stackoverflow.com/questions/33915248/why-are-negative-numbers-greater-than-positive-numbers/33915401#33915401", "title": "Why are negative numbers greater than positive numbers?", "body": "<p><code>memcmp</code> compares bytes, it does not know if the bytes represent <code>int</code>s, <code>double</code>s, strings, ...</p>\n\n<p>So it can not do any better that treat the bytes as unsigned numbers. Because a negative integer is normally represented using two's-complement, the highest bit of a negative integer is set, making it bigger than any positive signed integer.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1448451212, "creation_date": 1448451212, "answer_id": 33915461, "question_id": 33915248, "link": "https://stackoverflow.com/questions/33915248/why-are-negative-numbers-greater-than-positive-numbers/33915461#33915461", "title": "Why are negative numbers greater than positive numbers?", "body": "<p>Negative numbers have sign bit (the most significant bit) set to 1. Function <code>memcmp</code> compares bytes as unsigned values. So it considers the sign bit as a value bit. As result sometimes negative numbers are greater than positive numbers. </p>\n"}, {"tags": [], "owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "is_accepted": false, "score": 0, "last_activity_date": 1448451552, "creation_date": 1448451552, "answer_id": 33915570, "question_id": 33915248, "link": "https://stackoverflow.com/questions/33915248/why-are-negative-numbers-greater-than-positive-numbers/33915570#33915570", "title": "Why are negative numbers greater than positive numbers?", "body": "<p>In the notation that numbers and negative numbers are counted, the first bit is used as signbit, a bit that indicates wether a number is negative or positive. </p>\n\n<p>It becomes clear if we look at the binary representations of 2 numbers. Its worth noting that <code>memcmp</code> just compares 2 numbers as if they were both unsigned numbers of the lenght specified.</p>\n\n<p>-27 in binary notation (8 bit notation, twos complement): <code>1110 0101</code></p>\n\n<p>+56 in binary notation : <code>0011 1000</code></p>\n\n<p>If you compare the two as if they were positive, you'll note that the -27 representation is actually bigger.</p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1448456462, "post_id": 33917021, "comment_id": 55595407, "body": "nice,i tried it and it worked.but your solution means that i have to make a similar function to each datatype i want use,right?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1448456761, "post_id": 33917021, "comment_id": 55595620, "body": "@machine_1 Yes - a compare function per type.  Could modify <code>(*compar)</code> to take a 3rd parameter, some pointer maybe, that directs the compare function is some way.  Maybe potential approaches to solve this, yet keep <code>bubblesort()</code> generic."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1448456872, "post_id": 33917021, "comment_id": 55595705, "body": "@machine_1 Suggest reading about <code>qsort()</code>, <code>bsearch()</code> and especially <a href=\"http://man7.org/linux/man-pages/man3/qsort.3.html\" rel=\"nofollow noreferrer\"><code>qsort_r()</code></a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1448457314, "post_id": 33917021, "comment_id": 55595991, "body": "@machine_1 Probably would have been better to accept <a href=\"http://stackoverflow.com/a/33915401/2410359\">@alain</a> fine answer and then have posted a new question with &quot;How can i modify the program to make it compare correctly?&quot;"}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1448455937, "creation_date": 1448455937, "answer_id": 33917021, "question_id": 33915248, "link": "https://stackoverflow.com/questions/33915248/why-are-negative-numbers-greater-than-positive-numbers/33917021#33917021", "title": "Why are negative numbers greater than positive numbers?", "body": "<p>Answering OP's appended edit</p>\n\n<blockquote>\n  <p>How can i modify the program to make it compare correctly?</p>\n</blockquote>\n\n<p>To compare two types as an anonymous bit pattern, <code>memcmp()</code> works fine.  To compare two values of some type, code needs a compare function for that type.  Following <code>qsort()</code>  style:</p>\n\n<pre><code>void bubblesortA2(void *_Buf,size_t bufSize,size_t bytes, \n    int (*compar)(const void *, const void *)))\n{\n   ....\n        // if(memcmp(ptr,ptr+bytes,bytes) &gt; 0)\n        if((*compar)(ptr,ptr+bytes) &gt; 0)\n   ....\n</code></pre>\n\n<p>To compare <code>int</code>, pass in a compare <code>int</code> function.  Notice that <code>a</code>, <code>b</code> are the addresses to the objects.</p>\n\n<pre><code>int compar_int(const void *a, const void *b) {\n  const int *ai = (const int *)a;\n  const int *bi = (const int *)b;\n  return (*ai &gt; *bi) - (*ai &lt; *bi);\n}\n</code></pre>\n\n<p>To compare <code>char</code>, pass in a compare <code>char</code> function</p>\n\n<pre><code>int compar_int(const void *a, const void *b) {\n  const char *ac = (const char *)a;\n  const char *bc = (const char *)b;\n  return (*ac &gt; *bc) - (*ac &lt; *bc);\n}\n</code></pre>\n"}], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1624, "favorite_count": 1, "accepted_answer_id": 33917021, "answer_count": 4, "score": 3, "last_activity_date": 1496497149, "creation_date": 1448450637, "last_edit_date": 1496497149, "question_id": 33915248, "link": "https://stackoverflow.com/questions/33915248/why-are-negative-numbers-greater-than-positive-numbers", "title": "Why are negative numbers greater than positive numbers?", "body": "<p>I made my bubble sort program generic. I went on testing it and it was working well until I placed a negative number in the array, and I was surprised that it was pushed to the end, making it bigger than positive numbers.  </p>\n\n<p>Obviously <code>memcmp</code> is the reason, so why does <code>memcmp()</code> regard negative numbers greater than positive numbers?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nvoid bubblesortA(void *_Buf, size_t bufSize, size_t bytes);\n\nint main(void)\n{\n    size_t n, bufsize = 5;\n    int buf[5] = { 5, 1, 2, -1, 10 };\n    bubblesortA(buf, 5, sizeof(int));\n\n    for (n = 0; n &lt; bufsize; n++)\n    {\n        printf(\"%d \", buf[n]);\n    }\n    putchar('\\n');\n\n    char str[] = \"bzqacd\";\n    size_t len = strlen(str);\n    bubblesortA(str, len, sizeof(char));\n\n    for (n = 0; n &lt; len; n++)\n    {\n        printf(\"%c \", str[n]);\n    }\n    putchar('\\n');\n    return 0;\n}\n\nvoid bubblesortA(void *buf, size_t bufSize, size_t bytes)\n{\n    size_t x, y;\n    char *ptr = (char*)buf;\n    void *tmp = malloc(bytes);\n    for (x = 0; x &lt; bufSize; x++)\n    {\n        ptr = (char *)buf;\n        for (y = 0; y &lt; (bufSize - x - 1); y++)\n        {\n            if (memcmp(ptr, ptr + bytes, bytes) &gt; 0)\n            {\n                memcpy(tmp, ptr, bytes);\n                memcpy(ptr, ptr + bytes, bytes);\n                memcpy(ptr + bytes, tmp, bytes);\n            }\n            ptr += bytes;\n        }\n    }\n    free(tmp);\n}\n</code></pre>\n\n<p><strong>Edit</strong>:<br>\nSo, How do I modify the program to make it compare correctly?</p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1448451308, "post_id": 33915239, "comment_id": 55592250, "body": "Because <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\"><i>undefined behaviour</i></a> doesn&#39;t necessarily produce a compiler time error/warning."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1448451089, "last_edit_date": 1448451089, "creation_date": 1448450757, "answer_id": 33915289, "question_id": 33915239, "link": "https://stackoverflow.com/questions/33915239/array-two-type-definition-explanation/33915289#33915289", "title": "Array two type definition explanation", "body": "<p>In your code</p>\n\n<pre><code>uint8_t data_i2c[1] = { 1, 2};\n</code></pre>\n\n<p>will give you a warning (<em>may give you an error, too, based on your compilation options</em>), because, you're using excess initializer element than that of the size of the array.</p>\n\n<p>OTOH, in case of</p>\n\n<pre><code>uint8_t data[1];\n</code></pre>\n\n<p>and</p>\n\n<pre><code>data[1] = 2;\n</code></pre>\n\n<p>because, you're trying to access out of bound memory, which is not prohibited by the <code>C</code> standard (<em><code>C</code> arrays does not have any boundary overrun checking by default, remember?</em>) but <strong>defined</strong> to produce <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behavior</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": false, "score": 0, "last_activity_date": 1448450790, "creation_date": 1448450790, "answer_id": 33915300, "question_id": 33915239, "link": "https://stackoverflow.com/questions/33915239/array-two-type-definition-explanation/33915300#33915300", "title": "Array two type definition explanation", "body": "<p>In first case initializer is used. At <em>compile time</em> compiler calculates that elements in the initializer list is more than that of the array size and hence produce error.  </p>\n\n<p>In second snippet, assignment is performed at run time and out of bound of array writing is performed. Compiler has know way to know that you are accessing array out of bound.</p>\n"}], "owner": {"reputation": 153, "user_id": 5053520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b1c6476a43711f2569c4a5bc1c7483f2?s=128&d=identicon&r=PG&f=1", "display_name": "Singe", "link": "https://stackoverflow.com/users/5053520/singe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1448451371, "answer_count": 2, "score": 0, "last_activity_date": 1448451089, "creation_date": 1448450612, "question_id": 33915239, "link": "https://stackoverflow.com/questions/33915239/array-two-type-definition-explanation", "closed_reason": "Duplicate", "title": "Array two type definition explanation", "body": "<p>I've a question about array definition. I've tryed two types of definition:</p>\n\n<p>First definition</p>\n\n<pre><code>uint8_t data_i2c[1] = { 1 };\n</code></pre>\n\n<p>Second definition</p>\n\n<pre><code>uint8_t data[1];\ndata[0] = 1;\ndata[1] = 2;\n</code></pre>\n\n<p>In the first case I've an array of 1 value, if I add another value(ex. { 1, 2 };  ) I've a compiling error.\nIn the second case I've defined array in the same way, but I've added values in a second time, If I add another value(ex. data[2] = 3; ), I've not a compiling error.</p>\n\n<pre><code>Why this difference?\n</code></pre>\n\n<p>I've also checked in debug and even if I define:</p>\n\n<pre><code>data[1] = 2;\ndata[2] = 3;\n</code></pre>\n\n<p>I can see only data[0] = 1;</p>\n\n<p>I remember that if I define any array I always have and can use value in index 0.</p>\n\n<p>I'm using Atmel Studio as compiler and C language.</p>\n"}, {"tags": ["c", "json", "linux"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 5603449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf14cc37bbeed00b64fe046d5dd2f0e2?s=128&d=identicon&r=PG&f=1", "display_name": "Zainab", "link": "https://stackoverflow.com/users/5603449/zainab"}, "edited": false, "score": 0, "creation_date": 1448453566, "post_id": 33916060, "comment_id": 55593521, "body": "Well, for the project I&#39;m using &quot;makecore&quot; compiler which is not gcc, So according to your question it seems like it&#39;s not allowed, is it?!"}], "tags": [], "owner": {"reputation": 403, "user_id": 5582108, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FNkBF.jpg?s=128&g=1", "display_name": "Viet", "link": "https://stackoverflow.com/users/5582108/viet"}, "is_accepted": false, "score": 0, "last_activity_date": 1448453031, "creation_date": 1448453031, "answer_id": 33916060, "question_id": 33915057, "link": "https://stackoverflow.com/questions/33915057/linking-json-c-library-to-my-c-project/33916060#33916060", "title": "Linking json-c library to my C project", "body": "<p>Did you use -L option to link your program with your library?</p>\n\n<p>I see you use libjson-c which was built on linux-i386 architecture. But in the error, i see the compiler search library in arm folder. Did you use right compiler?</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8304893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3aeb874a476c0349eab23e8837ee83e?s=128&d=identicon&r=PG&f=1", "display_name": "sc liu", "link": "https://stackoverflow.com/users/8304893/sc-liu"}, "is_accepted": false, "score": 0, "last_activity_date": 1552246922, "last_edit_date": 1552246922, "creation_date": 1552235957, "answer_id": 55089948, "question_id": 33915057, "link": "https://stackoverflow.com/questions/33915057/linking-json-c-library-to-my-c-project/55089948#55089948", "title": "Linking json-c library to my C project", "body": "<p>If you have the file path, e.g. <strong>/myLibDir/libjson-c.so</strong></p>\n\n<p>Add like this to Makefile:</p>\n\n<pre><code>CFLAGS += -L/myLibDir -ljson-c\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5603449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf14cc37bbeed00b64fe046d5dd2f0e2?s=128&d=identicon&r=PG&f=1", "display_name": "Zainab", "link": "https://stackoverflow.com/users/5603449/zainab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2280, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1552246922, "creation_date": 1448450016, "last_edit_date": 1448450471, "question_id": 33915057, "link": "https://stackoverflow.com/questions/33915057/linking-json-c-library-to-my-c-project", "title": "Linking json-c library to my C project", "body": "<p>I have a C project. Its source code has many c files and I want to compile them all by using Makefile, also I need to link Curl library and json-c library to this project.</p>\n\n<p>I have copied the <code>libjson-c.so</code> from my <code>/lib/i386-linux-gnu</code> since i have already installed it before and then past it in my_project \"lib\" directory, then i have copied json-c folder which include the header files from my <code>/usr/include</code> and then paste it into my_project \"include\" directory.</p>\n\n<p>Then in the \"Makefile\" I assign the <code>CFLAGS</code> to my_project \"include\" directory and my DLLs assigned to the \"Dll\" files directory and then I linked the json-c lib by adding <code>-ljson-c</code> but when I compile my project it returns:</p>\n\n<pre><code>error : \"/opt/freescale/usr/local/gcc-4.1.2-glibc-2.5-nptl-3/arm-none-linux-gnueabi/lib/gcc/arm-none-linux-gnueabi/4.1.2/../../../../arm-none-linux-gnueabi/bin/ld: cannot find -ljson-c\n</code></pre>\n\n<p>Now I'm confused about what's wrong here specially, I have already did the same with the Curl library and it works but now with the json-c it's not. So PLEASE I NEED A HELP!!!!</p>\n"}, {"tags": ["c", "select", "timeout"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 1, "creation_date": 1448449822, "post_id": 33914865, "comment_id": 55591313, "body": "select works with file descriptors. Where and how your I/O is opened? Are you sure that the I/O FD is 0?"}, {"owner": {"reputation": 95, "user_id": 3206032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0fea155e4093ee96b30d484f01f7f202?s=128&d=identicon&r=PG&f=1", "display_name": "tutur29", "link": "https://stackoverflow.com/users/3206032/tutur29"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448456273, "post_id": 33914865, "comment_id": 55595272, "body": "clearly select is not the right solution, according to Viet answer. I&#39;m now looking for other way to do it."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 3206032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0fea155e4093ee96b30d484f01f7f202?s=128&d=identicon&r=PG&f=1", "display_name": "tutur29", "link": "https://stackoverflow.com/users/3206032/tutur29"}, "edited": false, "score": 0, "creation_date": 1448455364, "post_id": 33915732, "comment_id": 55594630, "body": "OK, I see what was my mistake. But do you have any simple code of how to use timer_create ? The example given is not very clear for me.."}, {"owner": {"reputation": 403, "user_id": 5582108, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FNkBF.jpg?s=128&g=1", "display_name": "Viet", "link": "https://stackoverflow.com/users/5582108/viet"}, "reply_to_user": {"reputation": 95, "user_id": 3206032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0fea155e4093ee96b30d484f01f7f202?s=128&d=identicon&r=PG&f=1", "display_name": "tutur29", "link": "https://stackoverflow.com/users/3206032/tutur29"}, "edited": false, "score": 0, "creation_date": 1448462778, "post_id": 33915732, "comment_id": 55599885, "body": "You can try to create a simple code to test. And if you get the problem, you can ask me. I think the example in that link is simple"}], "tags": [], "owner": {"reputation": 403, "user_id": 5582108, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FNkBF.jpg?s=128&g=1", "display_name": "Viet", "link": "https://stackoverflow.com/users/5582108/viet"}, "is_accepted": false, "score": 0, "last_activity_date": 1448543901, "last_edit_date": 1448543901, "creation_date": 1448452050, "answer_id": 33915732, "question_id": 33914865, "link": "https://stackoverflow.com/questions/33914865/c-timeout-on-a-function-that-reaturn-string/33915732#33915732", "title": "C - timeout on a function that reaturn string", "body": "<p><code>select()</code> function allow a program to monitor multiple file descriptor, waiting until one or more of the file descriptors become \"ready\" for some class of I/O operation (e.g., input possible). In your code, there is no file descriptor was opened. You use wrong function and purpose</p>\n\n<p>To resolve your problem, you can use timer. Please see that link:\n<a href=\"http://man7.org/linux/man-pages/man2/timer_create.2.html\" rel=\"nofollow\">http://man7.org/linux/man-pages/man2/timer_create.2.html</a></p>\n"}], "owner": {"reputation": 95, "user_id": 3206032, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0fea155e4093ee96b30d484f01f7f202?s=128&d=identicon&r=PG&f=1", "display_name": "tutur29", "link": "https://stackoverflow.com/users/3206032/tutur29"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448543901, "creation_date": 1448449461, "question_id": 33914865, "link": "https://stackoverflow.com/questions/33914865/c-timeout-on-a-function-that-reaturn-string", "title": "C - timeout on a function that reaturn string", "body": "<p>I have a C code that send a request to a card, then store a response from the card and print it.\nTo store the return command I use :</p>\n\n<pre><code>char * returnCommand = Cmd_Debug_GetResponse();\n</code></pre>\n\n<p>No problem there.\nMy problem is when I want to set a timeout on this response. If the function \"Cmd_Debug_GetResponse()\" does not return anything in 5 seconds, I want the program to keep going to the next lines.</p>\n\n<p>I try to use <strong>select()</strong> in this way, but with no good results :\n(I wrote only the interesting part)</p>\n\n<pre><code>fd_set input_set;\nstruct timeval timeout;\nint ready_for_reading = 0;\nFD_ZERO(&amp;input_set);\nFD_SET(0, &amp;input_set);\n\ntimeout.tv_sec = 5;\ntimeout.tv_usec = 0;\nready_for_reading = select(1, &amp;input_set, NULL, NULL, &amp;timeout);\nif(ready_for_reading)\n{\n    char * returnCommand = Cmd_Debug_GetResponse();\n    printf(\"OK : %s\\n\", returnCommand);\n} else {\n    printf(\"5 secs are over\\n\");\n}\n</code></pre>\n\n<p>The code always loop on the timeout...\nCan someone tell me what is wrong, and what to do ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["c", "performance", "loops"], "comments": [{"owner": {"reputation": 19084, "user_id": 2854908, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/snzI5.jpg?s=128&g=1", "display_name": "libik", "link": "https://stackoverflow.com/users/2854908/libik"}, "edited": false, "score": 0, "creation_date": 1448451271, "post_id": 33914605, "comment_id": 55592228, "body": "Just guessing but 10e250 cause overflow which can end in having &quot;a&quot; equal zero. Which is probably faster to divide. What is value of &quot;a&quot; before executing <code>b -=  a&#47;i;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1448492484, "post_id": 33914605, "comment_id": 55616810, "body": "<a href=\"http://stackoverflow.com/questions/9314534/why-does-changing-0-1f-to-0-slow-down-performance-by-10x/9314926#9314926\" title=\"why does changing 0 1f to 0 slow down performance by 10x\">stackoverflow.com/questions/9314534/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "is_accepted": true, "score": 6, "last_activity_date": 1448451973, "creation_date": 1448451973, "answer_id": 33915700, "question_id": 33914605, "link": "https://stackoverflow.com/questions/33914605/how-can-i-speed-up-this-loop/33915700#33915700", "title": "How can I speed-up this loop?", "body": "<p>First, the most likely reason why your code is running slower than expected is that a becomes a denormalised number. And denormalised numbers are a special case that may run a lot, lot slower. It is also possible that by adding 10^251 and subtracting it again you change a to 0 and dividing zero by anything is faster (since the result doesn't need to be calculated). </p>\n\n<p>But the real speed up comes from not stupidly adding tiny, tiny numbers that have no effect whatsoever. When x = a few hundred, a will be so small that subtracting a/i from b will not make any difference. So instead of b -= a/i; you write</p>\n\n<pre><code>double old_b = b;\nb -= a / i;\nif (b == old_b) break;\n</code></pre>\n\n<p>and your time will change from seconds to much less than a millisecond. </p>\n"}, {"comments": [{"owner": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 1, "creation_date": 1448466729, "post_id": 33915743, "comment_id": 55602812, "body": "On modern processors, all multiplications take the same amount of time unless there&#39;s denormals involved. So multiplication by zero is not faster than multiplication by anything else."}, {"owner": {"reputation": 507, "user_id": 4295123, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/275fd83698dcf1dc6969a6555e142b95?s=128&d=identicon&r=PG&f=1", "display_name": "Ardit Meti", "link": "https://stackoverflow.com/users/4295123/ardit-meti"}, "reply_to_user": {"reputation": 436126, "user_id": 922184, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h7WDB.jpg?s=128&g=1", "display_name": "Mysticial", "link": "https://stackoverflow.com/users/922184/mysticial"}, "edited": false, "score": 0, "creation_date": 1448469611, "post_id": 33915743, "comment_id": 55604759, "body": "Yea I wasn&#39;t sure about that. How can you explain that changing that line: a*=0.9; to a++; makes it faster?"}], "tags": [], "owner": {"reputation": 507, "user_id": 4295123, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/275fd83698dcf1dc6969a6555e142b95?s=128&d=identicon&r=PG&f=1", "display_name": "Ardit Meti", "link": "https://stackoverflow.com/users/4295123/ardit-meti"}, "is_accepted": false, "score": 0, "last_activity_date": 1448452086, "creation_date": 1448452086, "answer_id": 33915743, "question_id": 33914605, "link": "https://stackoverflow.com/questions/33914605/how-can-i-speed-up-this-loop/33915743#33915743", "title": "How can I speed-up this loop?", "body": "<p>Adding that 10e250 it exceeds the limit of digits the double variable can support and when subtracting it will always become 0. Not sure about this but multiplication should take more time than addition so it's slowing it down, ex. if you try this :</p>\n\n<pre><code>for ( unsigned int i = 1; i &lt;= x; i++)\n{\n  a ++; //power\n  b -=  a/i;\n}\n</code></pre>\n\n<p>You will see that it will run like the second time. I guess that when you add that 10e250 and after making a = 0; the multiplication with 0 is faster then with other non-zero variable.</p>\n"}], "owner": {"reputation": 591, "user_id": 5594539, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/mU8Qa.png?s=128&g=1", "display_name": "Joozty", "link": "https://stackoverflow.com/users/5594539/joozty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 33915700, "answer_count": 2, "score": 6, "last_activity_date": 1448466624, "creation_date": 1448448790, "last_edit_date": 1448466624, "question_id": 33914605, "link": "https://stackoverflow.com/questions/33914605/how-can-i-speed-up-this-loop", "title": "How can I speed-up this loop?", "body": "<p>How can I speed-up this loop (in C)?</p>\n\n<pre><code>unsigned int x = 50000000;\ndouble a= 0.9;\ndouble b= -0.9;\nfor ( unsigned int i = 1; i &lt;= x; i++)\n{\n    a *= 0.9; //power\n    b -=  a/i;\n}\n</code></pre>\n\n<p>Execution time:  14.000 s</p>\n\n<p>I don't know why,  but when I add this 2 lines in code, execution time is only 1.000 s. </p>\n\n<pre><code>unsigned int x = 50000000;\ndouble a= 0.9;\ndouble b= -0.9;\nfor ( unsigned int i = 1; i &lt;= x; i++)\n{\n    a *= 0.9; //power\n    a += 10e250;\n    a -=10e250;\n    b -=  a/i;\n}\n</code></pre>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["c", "linux", "sockets", "network-programming"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1448448812, "post_id": 33914391, "comment_id": 55590630, "body": "First, post your code.  Second, <code>bind()</code> takes as its arguments a socket file descriptor, an address, and a length.  Thus, you <code>bind()</code> a socket to one <i>address</i>, which includes any address.  See <a href=\"http://man7.org/linux/man-pages/man2/bind.2.html\" rel=\"nofollow noreferrer\">man7.org/linux/man-pages/man2/bind.2.html</a>"}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1448449139, "post_id": 33914391, "comment_id": 55590873, "body": "Why do you want to disable the loopback device?"}, {"owner": {"reputation": 192, "user_id": 2598546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f523e9f9a12bc18cec791efb35a1ce7?s=128&d=identicon&r=PG", "display_name": "Pawel Faron", "link": "https://stackoverflow.com/users/2598546/pawel-faron"}, "edited": false, "score": 0, "creation_date": 1448449559, "post_id": 33914391, "comment_id": 55591141, "body": "I want to disable loopback because I have a lot of traffic on loopback and I&#39;m encountering packet drops."}, {"owner": {"reputation": 192, "user_id": 2598546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f523e9f9a12bc18cec791efb35a1ce7?s=128&d=identicon&r=PG", "display_name": "Pawel Faron", "link": "https://stackoverflow.com/users/2598546/pawel-faron"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1448451244, "post_id": 33914391, "comment_id": 55592216, "body": "@AndrewHenle: I want to gater traffic from all addresses but only specific interfaces. You can select one interface when using sockaddr_ll as addess."}, {"owner": {"reputation": 2190, "user_id": 5226168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3761808b7533626771b59ad6ef9541?s=128&d=identicon&r=PG&f=1", "display_name": "Anders", "link": "https://stackoverflow.com/users/5226168/anders"}, "edited": false, "score": 0, "creation_date": 1448508725, "post_id": 33914391, "comment_id": 55620968, "body": "Although I think my answer will do what was asked, I have some doubts that this will solve the packet drop issue. In fact, it seems odd there is a &quot;lot&quot; of traffic on loopback at all."}], "answers": [{"comments": [{"owner": {"reputation": 192, "user_id": 2598546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f523e9f9a12bc18cec791efb35a1ce7?s=128&d=identicon&r=PG", "display_name": "Pawel Faron", "link": "https://stackoverflow.com/users/2598546/pawel-faron"}, "edited": false, "score": 0, "creation_date": 1448535929, "post_id": 33930089, "comment_id": 55633550, "body": "Thanks for advice I have implemented the first one already but will try the second one as well, even if only for fun ;)"}], "tags": [], "owner": {"reputation": 2190, "user_id": 5226168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e3761808b7533626771b59ad6ef9541?s=128&d=identicon&r=PG&f=1", "display_name": "Anders", "link": "https://stackoverflow.com/users/5226168/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1448508524, "creation_date": 1448508524, "answer_id": 33930089, "question_id": 33914391, "link": "https://stackoverflow.com/questions/33914391/bind-to-selected-interfaces/33930089#33930089", "title": "bind to selected interfaces", "body": "<p>There is no easy way to do exactly what you want. A couple options:</p>\n\n<ol>\n<li><p>Open multiple sockets and use select() and recv()/recvfrom()/read()/etc. to receive from multiple fds in the same place you would use recv() by itself. This is the direct solution, it is verbose but can be made functionally equivalent to reading from a single socket. It would be more appropriate for production maintainable code.</p></li>\n<li><p>A sneaky trick that may work for you: You can open one socket and bind to the same port and the loopback address 127.0.0.1 or the loopback interface. Then open a second socket to the same port bound to 0.0.0.0 INADDR_ANY. Then you ignore the first socket - it will capture any packets coming in on the loopback interface because it is a more specific binding. Packets coming in from anywhere else will end up on the second socket.</p></li>\n</ol>\n\n<p>You need to use the SO_REUSEADDR option to allow this, and I would set the first sockets receive buffer to a small value. If using TCP you will have to at least listen() on the first socket.</p>\n"}], "owner": {"reputation": 192, "user_id": 2598546, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f523e9f9a12bc18cec791efb35a1ce7?s=128&d=identicon&r=PG", "display_name": "Pawel Faron", "link": "https://stackoverflow.com/users/2598546/pawel-faron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 1, "accepted_answer_id": 33930089, "answer_count": 1, "score": 1, "last_activity_date": 1448508524, "creation_date": 1448448154, "question_id": 33914391, "link": "https://stackoverflow.com/questions/33914391/bind-to-selected-interfaces", "title": "bind to selected interfaces", "body": "<p>My application bind to all interfaces using \"sockaddr_ll.sll_ifindex = 0\". What I want is either to bind socket to selected interfaces (e.g. eth0, eth1, eth4) or bind to all interfaces but except loopback.\nThe first solution to create several sockets is really hard for me because I use ring buffer. I was trying to find some solution but with no luck so far.\nAny advice is welcome.</p>\n"}, {"tags": ["c", "bluetooth", "arm", "embedded", "stm32"], "comments": [{"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1448448938, "post_id": 33914379, "comment_id": 55590710, "body": "From a quick scan of the datasheet, I&#39;d guess that with <code>OutputNState</code> you&#39;re enabling the TIM1_CH1N/TIM1_CH2N complementary outputs on PB14/15, but are you definitely also <i>disabling</i> the regular outputs which, lo and behold, share the USART1 Tx/Rx pins?"}, {"owner": {"reputation": 46, "user_id": 5603693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c92f6a7ea1e14da8324370df67909d?s=128&d=identicon&r=PG&f=1", "display_name": "sszymk", "link": "https://stackoverflow.com/users/5603693/sszymk"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1448449612, "post_id": 33914379, "comment_id": 55591176, "body": "To be exact, those are,     TIM1_CH2N/TIM1_CH3N. You are probably right, but is there any way to make it work as I want it to?"}, {"owner": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 0, "creation_date": 1448453115, "post_id": 33914379, "comment_id": 55593266, "body": "I&#39;d be a bit surprised if there wasn&#39;t, but I&#39;m not familiar enough with that device to give an actual answer. Another thing to check is whether the pin functions are muxed together or need to be selected - it could perhaps be that the timer init code &#39;steals&#39; the pin from the USART even if the actual timer output is unused."}, {"owner": {"reputation": 46, "user_id": 5603693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c92f6a7ea1e14da8324370df67909d?s=128&d=identicon&r=PG&f=1", "display_name": "sszymk", "link": "https://stackoverflow.com/users/5603693/sszymk"}, "reply_to_user": {"reputation": 18029, "user_id": 3156750, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73e00c291e7b746a34f28622a64f0492?s=128&d=identicon&r=PG&f=1", "display_name": "Notlikethat", "link": "https://stackoverflow.com/users/3156750/notlikethat"}, "edited": false, "score": 1, "creation_date": 1448457790, "post_id": 33914379, "comment_id": 55596300, "body": "Made it. I just configured USART before Timers and it started to work..."}], "answers": [{"tags": [], "owner": {"reputation": 458, "user_id": 5312070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2e7f26feb830b626b459d5122315035?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey Esaulenko", "link": "https://stackoverflow.com/users/5312070/alexey-esaulenko"}, "is_accepted": false, "score": 2, "last_activity_date": 1448893848, "creation_date": 1448893848, "answer_id": 34000965, "question_id": 33914379, "link": "https://stackoverflow.com/questions/33914379/stm32-usart1-doesnt-work-with-tim1-at-the-same-time/34000965#34000965", "title": "STM32 Usart1 doesn&#39;t work with TIM1 at the same time", "body": "<p>Never use ST's structures without complete initialization of its fields!</p>\n\n<p>In your case, there is enabled TIM1_CH2 output on PA9 pin, because you didn't specify <code>TIM_OCInitStructure.TIM_OutputState = TIM_OutputState_Disable</code>.</p>\n"}], "owner": {"reputation": 46, "user_id": 5603693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c92f6a7ea1e14da8324370df67909d?s=128&d=identicon&r=PG&f=1", "display_name": "sszymk", "link": "https://stackoverflow.com/users/5603693/sszymk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448893848, "creation_date": 1448448133, "last_edit_date": 1448448773, "question_id": 33914379, "link": "https://stackoverflow.com/questions/33914379/stm32-usart1-doesnt-work-with-tim1-at-the-same-time", "title": "STM32 Usart1 doesn&#39;t work with TIM1 at the same time", "body": "<p>I came across a problem while programming my stm32f103rbt6.</p>\n\n<p>I'm using TIM1 (PB14, PB15) to generate PWM signal (works great) and USART1 (PA9, PA10) for bluetooth communication.\nThe thing is, that I can't make PWM and USART1 TX work at the same time. Everything works perfect until I make this config:</p>\n\n<pre><code>TIM_OCInitStructure.TIM_OCMode = TIM_OCMode_PWM1;\nTIM_OCInitStructure.TIM_OutputNState = TIM_OutputNState_Enable;\nTIM_OCInitStructure.TIM_Pulse = 0;\nTIM_OCInitStructure.TIM_OCPolarity = TIM_OCPolarity_High;\nTIM_OC2Init(TIM1, &amp;TIM_OCInitStructure);\nTIM_OC2PreloadConfig(TIM1, TIM_OCPreload_Enable);\n</code></pre>\n\n<p>USART1 TX stops working after that.\nI'll appreciate any help!</p>\n"}, {"tags": ["c", "sockets", "http", "fork", "dup"], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 3306813, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yKGbF.jpg?s=128&g=1", "display_name": "Nemo", "link": "https://stackoverflow.com/users/3306813/nemo"}, "edited": false, "score": 0, "creation_date": 1448456682, "post_id": 33915489, "comment_id": 55595556, "body": "Thanks, you&#39;re right. I tested my service with a different server implementation (&quot;nc -e&quot;) and the problem remained. However, I&#39;m not sure how to solve the problem in the service. What happens is that the client doesn&#39;t close the connection, so if I try to read more bytes, my &quot;read&quot; call is blocked since the client isn&#39;t sending any more data..."}, {"owner": {"reputation": 441, "user_id": 3306813, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yKGbF.jpg?s=128&g=1", "display_name": "Nemo", "link": "https://stackoverflow.com/users/3306813/nemo"}, "edited": false, "score": 0, "creation_date": 1448458168, "post_id": 33915489, "comment_id": 55596559, "body": "Ok, I found the problem. Thanks."}], "tags": [], "owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "is_accepted": true, "score": 3, "last_activity_date": 1448451318, "creation_date": 1448451318, "answer_id": 33915489, "question_id": 33914158, "link": "https://stackoverflow.com/questions/33914158/simple-http-generic-server-using-fork-and-dup/33915489#33915489", "title": "Simple http generic server using fork and dup", "body": "<p>I guess the problems lies not in the code you have shown, but in the program you exec. A typical problem is that the client (i.e. your program) does not read the HTTP header but instead just writes the data and finishes. In this case the file descriptor to the browser gets closed while there are still unprocessed data from the server in the socket buffer. This causes the server OS to send a RST packet which then causes the ECONNRESET in the browser. If you are lucky the browser got and  rendered the response before it got the RST, so you will see the connection reset error sometimes and sometimes not.</p>\n"}], "owner": {"reputation": 441, "user_id": 3306813, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/yKGbF.jpg?s=128&g=1", "display_name": "Nemo", "link": "https://stackoverflow.com/users/3306813/nemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 33915489, "answer_count": 1, "score": 1, "last_activity_date": 1448456872, "creation_date": 1448447570, "last_edit_date": 1448456872, "question_id": 33914158, "link": "https://stackoverflow.com/questions/33914158/simple-http-generic-server-using-fork-and-dup", "title": "Simple http generic server using fork and dup", "body": "<p>I'm trying to write a very basic HTTP server. I want to separate the server and the service in two separate executable (similar to inetd).</p>\n\n<p>So I have a generic server, that forks a service and execute its code using exec. The main loop is as follows:</p>\n\n<pre><code>while(true) {\n    int client_sock;\n\n    if ((client_sock = accept(server_sock, (struct sockaddr *) NULL, NULL)) &lt; 0) {\n        return -1;\n    } \n\n    pid_t pid = fork();\n\n    if (pid == 0) {\n        close(server_sock);\n        close(0);\n        dup(client_sock);\n        close(1);\n        dup(client_sock);\n        execvp(argv[2], argv+2);\n        return -1;\n    } else if (pid &lt; 0) {\n       assert(false);\n    }\n    close(client_sock);\n}\n</code></pre>\n\n<p>The service reads on stdin, and writes on stdout and processes simple http requests. Everything seems to work fine when I connect to my server using nc. nc receives and displays the expected http reply. </p>\n\n<p>However, when I connect to my server using a web browser, the browser tells me that the server closed the connection abruptly (ECONNRESET error I believe). I'm sure that my service processed the request: I checked the execution of my service with strace, all the expected \"write(1,...)\" are there, and there are not any close(1). Even more surprising, some times, the web browser gets the reply.</p>\n\n<p>Does anything look wrong in the provided code? if not, what could cause the problem?</p>\n"}, {"tags": ["c++", "c", "eclipse", "build", "build-process"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448447063, "post_id": 33913521, "comment_id": 55589462, "body": "Do not add unrelated tags."}], "answers": [{"tags": [], "owner": {"reputation": 317, "user_id": 1630404, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/acbd49e2f65205e40ee6e3607cc192c7?s=128&d=identicon&r=PG", "display_name": "Prophet Daniel", "link": "https://stackoverflow.com/users/1630404/prophet-daniel"}, "is_accepted": false, "score": 0, "last_activity_date": 1448457123, "last_edit_date": 1448457123, "creation_date": 1448455583, "answer_id": 33916906, "question_id": 33913521, "link": "https://stackoverflow.com/questions/33913521/handling-different-build-scenarios-in-eclipse-for-c-project/33916906#33916906", "title": "Handling different build scenarios in Eclipse for C project", "body": "<p>Left click in the Project Explorer tab -> New -> C Project\n<a href=\"https://i.stack.imgur.com/EMkbZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EMkbZ.png\" alt=\"C Project creation\"></a></p>\n\n<p>A C projet will be created with 2 build configurations as default: Debug and Release.</p>\n\n<p>Left click on your project just created.\nRight click -> New -> Folder</p>\n\n<p>This way add all your folders according to your Project structure.</p>\n\n<p>Go to Properties -> C/C++ General -> Source location tab -> Add folder button</p>\n\n<p><a href=\"https://i.stack.imgur.com/XJpBW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XJpBW.png\" alt=\"Add source location\"></a></p>\n\n<p>Then select both folders available resulting in the following Project layout:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kRmIB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kRmIB.png\" alt=\"Project layout\"></a></p>\n\n<p>Go to Properties -> C/C++ General -> Includes tab -> GNU C Language -> Add button</p>\n\n<p>And finally add all your include paths resulting as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/f92Fa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/f92Fa.png\" alt=\"Add include paths\"></a></p>\n\n<p>To select which folders to be used for compilation, you rather have to select the folders that will be excluded from build. To do this right click on folder to exclude -> Resource Configurations -> Exclude From Build -> select the build configuration</p>\n\n<p><a href=\"https://i.stack.imgur.com/1Pl27.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1Pl27.png\" alt=\"enter image description here\"></a></p>\n\n<p>This way building is acomplished as required in your bullet 1 and 2 questions.</p>\n\n<p>Bullet 3 - It is possible through makefiles, although it's trickier then letting eclipse manage the build process.</p>\n\n<p>Bullet 4 - Build configurations are already stored in the Project, so when you load it again will be there available again.</p>\n\n<p>If you want to creat more build configurations right click in the Project, Build Configurations -> Manage -> New -> Copy settings from Existing Configuration</p>\n\n<p>But in my opinion you don't need to create hundreds of build configurations in your case. Maybe just the 2 regular ones, Release and Debug are enough. Selection is made by choosing which TAxx folder will not be excluded from build.</p>\n"}], "owner": {"reputation": 31, "user_id": 5412416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c5d96d49f3e6ded855b17ae14acb3a?s=128&d=identicon&r=PG&f=1", "display_name": "Manojkumar", "link": "https://stackoverflow.com/users/5412416/manojkumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448457123, "creation_date": 1448445847, "question_id": 33913521, "link": "https://stackoverflow.com/questions/33913521/handling-different-build-scenarios-in-eclipse-for-c-project", "title": "Handling different build scenarios in Eclipse for C project", "body": "<p>I am working on embedded c project. Till now I was using batch files and cmd prompt to compile the source files. Now I am planning to use Eclipse IDE for editing the code and compilation. The folder structure is as follows (refer the image)</p>\n\n<p><a href=\"https://i.stack.imgur.com/chnpE.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/chnpE.jpg\" alt=\"Folder Structure\"></a></p>\n\n<p>Delivery folder remains same for all build scenarios since it contains the main module source files.</p>\n\n<p>Test_Setup folder contains the test cases. Each TAxx had src and inc folder. In each TAxx_src folder, there is a .c file containing main function and and test functions. Currently using batch files for testing there is a batch file for each TAxx folder (in this case 4 batch files) which will compile the Delivery folder and the corresponding TAxx folder.</p>\n\n<p>In eclipse I want to keep the same folder structure. But if I give build, eclipse will throw multiple \"main\" error. Hence I am unable to give build directly.</p>\n\n<p>There is also a possibility of creating build configurations in eclipse. But since TAxx can be in 100s it will be difficult to create so many build configurations and maintain it.</p>\n\n<ol>\n<li>How to effectively handle such a build scenario in eclipse. My task is to keep the folder structure same and while giving build, I must be able to select which TAxx folder I want to use for build.</li>\n<li>Keeping the same folder structure, how can I compile Deliver folder and anyone TAxx folder?</li>\n<li>Is there an option to create build configurations automatically?</li>\n<li>After project is successful and all test cases are executed, the source code in moved to configuration management, but the eclipse project is not stored. Is there an option to export build configurations in a file so that it can be used when the project is again loaded in Eclipse?</li>\n</ol>\n\n<p>Regards\nManoj</p>\n"}, {"tags": ["c", "variables", "type-conversion", "return-type"], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 6, "last_activity_date": 1448446469, "creation_date": 1448446469, "answer_id": 33913731, "question_id": 33913454, "link": "https://stackoverflow.com/questions/33913454/what-happens-when-storing-a-functions-return-type-in-a-variable-of-a-different/33913731#33913731", "title": "What happens when storing a function&#39;s return type in a variable of a different type?", "body": "<p>C will automatically attempt a conversion from the return value of <code>round</code> (which is a <code>double</code>) to an <code>int</code>.</p>\n\n<p>It <em>might</em> get converted.</p>\n\n<p>Bear in mind that if the <code>double</code> returned is larger or smaller than that which can be held in an <code>int</code>, then the program behaviour is undefined.</p>\n\n<p>You ought to compare with <code>INT_MAX</code> and <code>INT_MIN</code> before attempting the conversion.</p>\n\n<p>Hopefully you can see now why <code>double</code> is, in fact, a sensible return type for <code>round</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "is_accepted": false, "score": 1, "last_activity_date": 1448449083, "last_edit_date": 1448449083, "creation_date": 1448446559, "answer_id": 33913760, "question_id": 33913454, "link": "https://stackoverflow.com/questions/33913454/what-happens-when-storing-a-functions-return-type-in-a-variable-of-a-different/33913760#33913760", "title": "What happens when storing a function&#39;s return type in a variable of a different type?", "body": "<p>C does not do strong typing.</p>\n\n<p>In general, when you use an object/a value of one numerical type where an object of a different numerical type is expected, C will automatically convert it.</p>\n\n<p>This may fail (e.g. if the value is not representable) or may not be desired (and hopefully lead to a compiler warning then) but in most cases it is just convenient.</p>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "is_accepted": false, "score": 3, "last_activity_date": 1448447948, "last_edit_date": 1448447948, "creation_date": 1448446639, "answer_id": 33913785, "question_id": 33913454, "link": "https://stackoverflow.com/questions/33913454/what-happens-when-storing-a-functions-return-type-in-a-variable-of-a-different/33913785#33913785", "title": "What happens when storing a function&#39;s return type in a variable of a different type?", "body": "<p>in your question when you return a <code>double</code> value from <code>round()</code> to the main function, and assign it to a <code>int</code> variable. C converts <code>double</code> to <code>int</code> and then stores the returned value.\nthis kind of conversion is called <strong>implicit conversion</strong>... I've provided a link at the end, if you'd like to know more about it</p>\n\n<p><strong>NOTE</strong>: C doesn't store different data type but:</p>\n\n<blockquote>\n  <p>1) it converts the data to holding variable data type</p>\n  \n  <p>2) and then stores it into the variable</p>\n</blockquote>\n\n<p>you can know more about these kind of conversions... here: <a href=\"http://clanguagebasics.com/c-language-tutorial/c-type-conversion-implicit-explicit-type-conversion-in-c/\" rel=\"nofollow\">conversions</a></p>\n"}], "owner": {"reputation": 287, "user_id": 4838971, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wMMxN.png?s=128&g=1", "display_name": "Mampoempan", "link": "https://stackoverflow.com/users/4838971/mampoempan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 2, "accepted_answer_id": 33913731, "answer_count": 3, "score": 1, "last_activity_date": 1448467341, "creation_date": 1448445655, "last_edit_date": 1448467341, "question_id": 33913454, "link": "https://stackoverflow.com/questions/33913454/what-happens-when-storing-a-functions-return-type-in-a-variable-of-a-different", "title": "What happens when storing a function&#39;s return type in a variable of a different type?", "body": "<p>For instance I call the function <code>round()</code> in C the manual says it returns a value of type <code>double</code>. I made an <code>int</code> variable in which I'm storing the result of this function. Everything seems to work perfectly fine, so my question is what happened here?</p>\n\n<pre><code>int rounded = round(cents);\n</code></pre>\n\n<p>Why does C even allow me to store the returned value of <code>rounds()</code> in a variable that is not of the same return type?</p>\n"}, {"tags": ["c", "algorithm"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1448445572, "post_id": 33913347, "comment_id": 55588484, "body": "Can you please elaborate on the problems you are having. Do you have build errors? Run-time errors or crashes? Unexpected results? You might want to <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>, and also how to create a <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable Example</a>. Then finally, you should learn how to format your code to make it readable, with indentation."}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 1, "creation_date": 1448446282, "post_id": 33913347, "comment_id": 55588954, "body": "Are you using a C++ compiler? your code is invalid C (the struct name does not go into global scope automatically in C)! For your own sanity use a C compiler for C code :-)"}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 1, "creation_date": 1448446764, "post_id": 33913347, "comment_id": 55589267, "body": "Setting record ID while printing it is pure evil."}, {"owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1448456260, "post_id": 33913347, "comment_id": 55595255, "body": "@pmg i&#39;m using turbo C++ actually what do recommend ?"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1448456538, "post_id": 33913347, "comment_id": 55595450, "body": "@NajlaAlKroud: I recommend a C compiler for C code (and a C++ compiler for C++ code). If you&#39;re on Windows hopefully you can use a <a href=\"https://www.visualstudio.com/en-us/products/visual-studio-express-vs.aspx\" rel=\"nofollow noreferrer\">free version of Microsoft Visual Studio</a> properly configured for C. Anyway, google for C compilers, try a few and choose the one you like best."}, {"owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1448456539, "post_id": 33913347, "comment_id": 55595451, "body": "@JoachimPileborg i&#39;m not having any errors but the output is not coming out correctly with the id instead of printing 21400001and so on it prints a random value. Sorry for any inconvenience i&#39;m just a bigger and still learning. Thank you for your feedback."}, {"owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1448456584, "post_id": 33913347, "comment_id": 55595491, "body": "@pmg okay Thanks a lot :)"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "edited": false, "score": 0, "creation_date": 1448457122, "post_id": 33913595, "comment_id": 55595865, "body": "it worked but now i&#39;m facing another problem :( Every time i enter a new person the id of the pervious person is incremented :/"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "reply_to_user": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "edited": false, "score": 0, "creation_date": 1448457305, "post_id": 33913595, "comment_id": 55595986, "body": "You have to pay attention to where you are doing the increment. See <a href=\"http://stackoverflow.com/a/33913766/25324\">Klas&#39;s answer</a>."}], "tags": [], "owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "is_accepted": true, "score": 5, "last_activity_date": 1448446039, "creation_date": 1448446039, "answer_id": 33913595, "question_id": 33913347, "link": "https://stackoverflow.com/questions/33913347/printing-with-type-long/33913595#33913595", "title": "printing with type long", "body": "<p>You are using an incorrect conversion in your program</p>\n\n<pre><code>printf(\"ID:%d\\t\",cur-&gt;ID=id++);\n// cur-&gt;ID is of type unsigned long\n// %d is used for values of type int\n</code></pre>\n\n<p>To print a value of type <code>long</code> you need to use <code>\"%ld\"</code> in the <code>printf()</code> conversion</p>\n\n<pre><code>long longvalue = 42;\nprintf(\"%ld\\n\", lonvgalue);\n</code></pre>\n\n<p>To print a value of type <code>unsigned long</code> you need to use <code>\"%lu\"</code> in the <code>printf()</code> conversion</p>\n\n<pre><code>unsigned long ulongvalue = 42;\nprintf(\"%lu\\n\", ulongvalue);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "edited": false, "score": 0, "creation_date": 1448457624, "post_id": 33913766, "comment_id": 55596202, "body": "okay i did but now i&#39;m getting a Warning that the id is assigned a value that is never used"}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "reply_to_user": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "edited": false, "score": 0, "creation_date": 1448457959, "post_id": 33913766, "comment_id": 55596418, "body": "Yeah, I&#39;ve added to my answer that you need to move the declaration of <code>id</code>."}], "tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 1, "last_activity_date": 1448457908, "last_edit_date": 1448457908, "creation_date": 1448446571, "answer_id": 33913766, "question_id": 33913347, "link": "https://stackoverflow.com/questions/33913347/printing-with-type-long/33913766#33913766", "title": "printing with type long", "body": "<p>In addition to the format specifier being wrong, you have a problem with assigning ID:s.</p>\n\n<p>Your code assigns new ID:s every time you display the list.</p>\n\n<p>I would generate the ID only once for each student record, when the record is created.</p>\n\n<p>So add this in <code>insertfront</code>:</p>\n\n<pre><code>stu-&gt;ID=id++;\n</code></pre>\n\n<p>and change the printing in <code>displaylist</code> to:</p>\n\n<pre><code>printf(\"ID:%lu\\t\",cur-&gt;ID);\n</code></pre>\n\n<p>and move the declaration of <code>id</code> either to global scope (outside of any function) or as a static variable inside <code>insertfront</code>:</p>\n\n<pre><code>static unsigned long id=214000000;\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5603105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07371b17f656d859f200e0c9a5c8f6cc?s=128&d=identicon&r=PG&f=1", "display_name": "Najla", "link": "https://stackoverflow.com/users/5603105/najla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33913595, "answer_count": 2, "score": 0, "last_activity_date": 1448457908, "creation_date": 1448445332, "last_edit_date": 1448446093, "question_id": 33913347, "link": "https://stackoverflow.com/questions/33913347/printing-with-type-long", "title": "printing with type long", "body": "<p>I'm working on my school project form data structure and I'm having a problem with the type long. \nI want to design a small project like a university registration system.\nFirst the person get to chose if he want to register or exit. \nIf he want to register then he will enter his name and gpa to select the major that is available based on his gpa and the system will generate an id automatically.</p>\n\n<p><strong>The problem is the id is not incremented correctly.</strong> </p>\n\n<p>Additional info:\nI'm using doubly linked list structure</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;stdlib.h&gt;\n#include&lt;conio.h&gt;\n#include&lt;string.h&gt;\nstruct student{\n    char name[30];\n    int GPA;\n    unsigned long ID;\n    char colloege[100];\n    student *next, *prev;\n};\nstudent *stu, *cur, *head, *tail;\nvoid insertfront();\nvoid displaylist(){\n    unsigned long id=214000000;\n    cur=head;\n    printf(\" \");\n    if(cur==NULL)\n        printf(\" \");\n    else\n        while(cur!=NULL){\n            printf(\"Name:%s\\t\",cur-&gt;name);\n            printf(\"ID:%d\\t\",cur-&gt;ID=id++);\n            printf(\"GPA:%d\\t\",cur-&gt;GPA);\n            printf(\"Colloege of:%s\\t\",cur-&gt;colloege);\n            printf(\"\\n\");\n            cur=cur-&gt;next;\n        }\n    }\n\nvoid main(){\n    clrscr();\n    int x;\n    printf(\"\\n\\t\\t\\t\\t******* King Faisal University *********\\n\");\n    while(x!=2){\n        printf(\"\\n press 1 to insert your information ,press 2 to exit\\n\");\n        scanf(\"%d\",&amp;x);\n        insertfront();\n        displaylist();\n    }\n\n    stu=NULL;\n    cur=NULL;\n    head=NULL;\n    tail=NULL;\n    getch();\n}\n\nvoid insertfront(){\n    int x,c;\n    stu=(student*)malloc(sizeof(student));\n    fflush(stdin);\n    printf(\"Enter your name:\\n\");\n    scanf(\"%[^\\n]%*c\",stu-&gt;name);\n    printf(\"Enter your GPA:\\n\");\n    scanf(\"%ul\",&amp;stu-&gt;GPA);\n    printf(\"\\n Available Colloeges\\n\");\n\n    if(stu-&gt;GPA&gt;=85)\n    {\n        printf(\"1.Colloege of Medicine\\n 2.Colloege of Engenering\\n 3.Colloege of Computer Science\\n 4.Colloege of Business\\n 5.Colloege of Art\\n\");\n        printf(\"Enter the colloege number \\n\");\n        scanf(\"%d\",&amp;c);\n        switch(c){\n            case 1:  strcpy(stu-&gt;colloege,\"Medicien\");break;\n            case 2:  strcpy(stu-&gt;colloege,\"Engenering\");break;\n            case 3:  strcpy(stu-&gt;colloege,\"Computer Science\");break;\n            case 4:  strcpy(stu-&gt;colloege,\"Business\");break;\n            case 5: strcpy(stu-&gt;colloege,\"Art\");break;\n        }\n    }\n    else if(stu-&gt;GPA&gt;=75)\n    {\n        printf(\"1.Colloege of Computer Science\\n 2.Colloege of Business\\n 3.Colloege of Art\\n\");\n        printf(\"Enter the colloege number\\n\");\n        scanf(\"%d\",&amp;c);\n        switch(c){\n            case 1:  strcpy(stu-&gt;colloege,\"Computer Science\");break;\n            case 2:  strcpy(stu-&gt;colloege,\"Business\");break;\n            case 3: strcpy(stu-&gt;colloege,\"Art\");break;\n        }\n    }\n    else\n        strcpy(stu-&gt;colloege,\"Art\");\n    if(head==NULL)\n    {\n        stu-&gt;next=NULL;\n        stu-&gt;prev=NULL;\n        head=stu;\n        tail=stu;\n    }\n    else\n    {\n        stu-&gt;next=head;\n        stu-&gt;prev=NULL;\n        head-&gt;prev=stu;\n        head=stu;\n    }\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "visual-c++", "mfc"], "comments": [{"owner": {"reputation": 4622, "user_id": 996886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lSuAl.png?s=128&g=1", "display_name": "melak47", "link": "https://stackoverflow.com/users/996886/melak47"}, "edited": false, "score": 0, "creation_date": 1448445155, "post_id": 33913180, "comment_id": 55588233, "body": "You have spaces and unescaped backslashes in your string"}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "edited": false, "score": 0, "creation_date": 1448445477, "post_id": 33913180, "comment_id": 55588432, "body": "now,comeon,it&#39;s a small copy-paste error,,,,                                                        int nRet = (int)ShellExecute( NULL, _T(&quot;open&quot;), _T(&quot;C:\\\\Documents and Settings\\\\kse8.KSE\\\\Desktop\\\\lnk file\\\\1.lnk&quot;),NULL, NULL, SW_SHOWNORMAL );                                                                                              now happy.:)                                                                                                  can i expect now a change of this &quot;-1&quot; or now no one is active"}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1448445707, "post_id": 33913180, "comment_id": 55588565, "body": "error code 2 indicates file not found."}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1448446629, "post_id": 33913180, "comment_id": 55589176, "body": "as 1.lnk refers to some file location you need to get path of it. then you can you shellexecute using that path."}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "edited": false, "score": 0, "creation_date": 1448446641, "post_id": 33913180, "comment_id": 55589184, "body": "i simply have a pdf file ,of which i have created a shortcut and renamed it as 1.lnk, both are in the same folder of desktop,when i am trying to execute the above code ,,pdf is not getting open,,,,just want to know why?"}, {"owner": {"reputation": 4224, "user_id": 3383213, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/91b489041a73ecbb02cc26af19b5f664?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/3383213/himanshu"}, "edited": false, "score": 0, "creation_date": 1448447113, "post_id": 33913180, "comment_id": 55589502, "body": "first try to give full path of pdf file not link file, is it opening or not? or you can try replacing _T(&quot;open&quot;) with NULL(it may work sometime)."}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "edited": false, "score": 0, "creation_date": 1448449134, "post_id": 33913180, "comment_id": 55590868, "body": "int nRet = (int)ShellExecute( NULL, _T(&quot;open&quot;), _T(&quot;C:\\\\Documents and Settings\\\\kse8.KSE\\\\Desktop\\\\lnk file\\\\Vol2ENG.pdf&quot;),NULL, NULL, SW_SHOWNORMAL );                                                                                                 successfully opened pdf                                                                                    and                                                                                                    even replacing_T(&quot;open&quot;) with NULL is not able to open through lnk  file"}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "edited": false, "score": 0, "creation_date": 1448449403, "post_id": 33913180, "comment_id": 55591035, "body": "not working,still not able to open through lnk file"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1448497636, "post_id": 33913180, "comment_id": 55618382, "body": "Probably the path is wrong, even if you got the backslashes right. That&#39;s why you get error 2 (path not found)"}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "reply_to_user": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1449050986, "post_id": 33913180, "comment_id": 55834631, "body": "@BarmakShemirani :- i have written the steps,,file and shorcut (renamed as 1.lnk) is in the same folder,,still it&#39;s not working,,dont know why??                               didnt get any solution and reason ??"}, {"owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "edited": false, "score": 0, "creation_date": 1449052005, "post_id": 33913180, "comment_id": 55835271, "body": "yup,,got the mistake,it&#39;s a quite silly mistake,,,,getting embarrased to share it...........i renamed the shortcut file as 1.lnk and then  passing the path as(C:\\\\...1.lnk ) instead of (C:\\\\....1.lnk.lnk ),,,,"}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1448448810, "post_id": 33913275, "comment_id": 55590629, "body": "The string literal did escape the backslashes. It just didn&#39;t show up due to formatting."}], "tags": [], "owner": {"reputation": 656, "user_id": 5573683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58e322915baddd645b3ca4c9205f25ba?s=128&d=identicon&r=PG&f=1", "display_name": "Yuriy Orlov", "link": "https://stackoverflow.com/users/5573683/yuriy-orlov"}, "is_accepted": false, "score": 0, "last_activity_date": 1448445087, "creation_date": 1448445087, "answer_id": 33913275, "question_id": 33913180, "link": "https://stackoverflow.com/questions/33913180/shellexecute-function-to-open-a-link-file-is-not-working-dont-know-why/33913275#33913275", "title": "shellexecute() function to open a link file is not working, don&#39;t know,why?", "body": "<p>You path is wrong - '\\' is a special character, to get exact this, you should double it - <code>\"C:\\\\Documents and Settings\\\\kse8.KSE\\\\Desktop\\\\lnk file\\\\1.lnk\"</code></p>\n"}], "owner": {"reputation": 15, "user_id": 4217099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26c85411cae5c102f82c8badbe485ff0?s=128&d=identicon&r=PG&f=1", "display_name": "Harish Raghav", "link": "https://stackoverflow.com/users/4217099/harish-raghav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448558635, "creation_date": 1448444804, "last_edit_date": 1448558635, "question_id": 33913180, "link": "https://stackoverflow.com/questions/33913180/shellexecute-function-to-open-a-link-file-is-not-working-dont-know-why", "title": "shellexecute() function to open a link file is not working, don&#39;t know,why?", "body": "<p>Code</p>\n\n<pre><code>int nRet = (int)ShellExecute( NULL, _T(\"open\"), _T(\"C:\\\\Documents and Settings\\\\kse8.KSE\\\\Desktop\\\\lnk file\\\\1.lnk\"),NULL, NULL, SW_SHOWNORMAL );\n</code></pre>\n\n<p>always getting </p>\n\n<blockquote>\n  <p>Error Code 2 in nRet</p>\n</blockquote>\n\n<p>don't know why \n \"1.lnk\" file which is a shortcut of a pdf is not getting open ? </p>\n\n<p>you can create these scenario simply by these steps\n1)create a shortcut of a pdf file i.e, (shift + f10) ,then \"create shortcut\"\n2)rename it as 1.lnk\nboth pdf file and shortcut are placed in the same folder of desktop.\nand then execute the command</p>\n\n<pre><code>int nRet = (int)ShellExecute( NULL, _T(\"open\"), _T(\"C:\\\\Documents and Settings\\\\kse8.KSE\\\\Desktop\\\\lnk file\\\\1.lnk\"),NULL, NULL, SW_SHOWNORMAL )\n</code></pre>\n"}, {"tags": ["php", "c"], "owner": {"reputation": 11, "user_id": 5092623, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZUme_8D-BFE/AAAAAAAAAAI/AAAAAAAAAD0/zEymmvOEXbo/photo.jpg?sz=128", "display_name": "Blank", "link": "https://stackoverflow.com/users/5092623/blank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448444763, "creation_date": 1448444763, "question_id": 33913166, "link": "https://stackoverflow.com/questions/33913166/how-to-get-php-parameter-name-from-zend-arg-info", "title": "How to get PHP parameter name from zend_arg_info", "body": "<p><strong>PHP Example</strong></p>\n\n<pre><code>&lt;?php\n\n$id = 1;\n$good = 'variable';\noutput_var_name($id); // Output string \"id\" , just variable name\noutput_var_name($good); // Output string \"good\"\n</code></pre>\n\n<p><strong>C/C++</strong></p>\n\n<pre><code>PHP_FUNCTION(output_var_name)\n{\nzend_arg_info *cur_arg_info = &amp;CG(active_op_array)-&gt;arg_info[0];\nphp_printf(\"%s\\n\", cur_arg_info-&gt;name);\n}\n</code></pre>\n\n<p>The above c/c++ code may be wrong, I hope you can understand what I mean.\nMy English is not good, but I hope to get your help! Thanks</p>\n"}, {"tags": ["c++", "c", "visual-studio-2013"], "comments": [{"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 4, "creation_date": 1448444445, "post_id": 33913003, "comment_id": 55587764, "body": "probably machine generated code to automatically disable definitions on some builds"}], "answers": [{"tags": [], "owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "is_accepted": false, "score": 2, "last_activity_date": 1448444488, "creation_date": 1448444488, "answer_id": 33913063, "question_id": 33913003, "link": "https://stackoverflow.com/questions/33913003/why-is-if-0-msc-ver-1000-defined/33913063#33913063", "title": "Why is #if 0 &amp;&amp; (_MSC_VER &gt; 1000) defined?", "body": "<p>Most likely, it is <em>generated</em> code, with the <code>0</code> injected by some stage of the build or packaging process that has discovered the feature is unnecessary on your platform.</p>\n\n<p>Why does it not instead remove the whole <code>#if</code> and keep only the <code>#else</code> body Because (in general) that would be a lot more difficult and error-prone for a simple tool to do: replacing something that probably looks like <code>#if &lt;placeholder&gt;</code> with <code>#if 0</code> is easy.</p>\n\n<p>I almost considered trying to figure out precisely what's going on in this specific case, but then I noticed it's WinNT code and decided maintaining whatever remains of my sanity was more important.</p>\n"}], "owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448444488, "creation_date": 1448444319, "last_edit_date": 1448444435, "question_id": 33913003, "link": "https://stackoverflow.com/questions/33913003/why-is-if-0-msc-ver-1000-defined", "title": "Why is #if 0 &amp;&amp; (_MSC_VER &gt; 1000) defined?", "body": "<p>I found this strange codes in <code>winnt.h</code> file in VS2013.</p>\n\n<pre><code>#ifdef STRICT\ntypedef void *HANDLE;\n#if 0 &amp;&amp; (_MSC_VER &gt; 1000)  // strange code is here...\n#define DECLARE_HANDLE(name) struct name##__; typedef struct name##__ *name\n#else\n#define DECLARE_HANDLE(name) struct name##__{int unused;}; typedef struct name##__ *name\n#endif\n</code></pre>\n\n<p>Based on my understanding, when <code>_MSC_VER</code> is defined larger than <code>1000</code> or less than <code>1000</code>, this line <code>#if 0 &amp;&amp; (_MSC_VER &gt; 1000</code> should equal to <code>#if 0</code>. Why <code>#if 0 &amp;&amp; (_MSC_VER &gt; 1000</code> is this defined in such a strange way? </p>\n"}, {"tags": ["c++", "c", "sorting", "embedded"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1448444646, "post_id": 33912982, "comment_id": 55587898, "body": "We are no clairvoyants. &quot;My code doesn&#39;t work&quot; is hard to diagnose. Use a debugger. Maybe you run into stack overflow?"}, {"owner": {"reputation": 440, "user_id": 1136909, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3d7285658e5e4fb87c95e5176bf4eb44?s=128&d=identicon&r=PG", "display_name": "Unfixable", "link": "https://stackoverflow.com/users/1136909/unfixable"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448445433, "post_id": 33912982, "comment_id": 55588395, "body": "I tested for stack overflow but I changed stack size and it&#39;s crashing at the same point so I can rule that out.  I tried to catch the exception but unfortunately exception handlers are not supported on my system. What about the compare function, is it correct? The qsort parameters are also used correctly? I will try to run the same code on the desktop now to confirm whether the basic code is working"}, {"owner": {"reputation": 174, "user_id": 5413843, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOVej.jpg?s=128&g=1", "display_name": "mattiash", "link": "https://stackoverflow.com/users/5413843/mattiash"}, "edited": false, "score": 2, "creation_date": 1448446597, "post_id": 33912982, "comment_id": 55589159, "body": "How is trainData declared? Submit the entire code for any healp."}, {"owner": {"reputation": 440, "user_id": 1136909, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3d7285658e5e4fb87c95e5176bf4eb44?s=128&d=identicon&r=PG", "display_name": "Unfixable", "link": "https://stackoverflow.com/users/1136909/unfixable"}, "edited": false, "score": 0, "creation_date": 1448447025, "post_id": 33912982, "comment_id": 55589431, "body": "Its declared like that: featureData trainData[NO_OF_TRAINDATA]; It&#39;s filled with data from a textfile, only Distance changes each iteration, Value always stays the same. I cannot copy all as it&#39;s like 2000 lines of code overall for this class."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1448447187, "post_id": 33912982, "comment_id": 55589556, "body": "Code looks OK - problems lies elsewhere..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448447258, "post_id": 33912982, "comment_id": 55589596, "body": "How <code>trainData</code> are generated? I mean: where values are retrieved?"}, {"owner": {"reputation": 2605, "user_id": 3958633, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817685ce6b5f625688fdbcd327e7afa6?s=128&d=identicon&r=PG", "display_name": "sifferman", "link": "https://stackoverflow.com/users/3958633/sifferman"}, "edited": false, "score": 1, "creation_date": 1448447564, "post_id": 33912982, "comment_id": 55589799, "body": "1. Make sure your <code>trainData</code> array is word-aligned for the processor you are using. You may need to use a #pragma to do this.  2. Make sure your <code>trainData</code> array fits in the memory (either stack or heap) that you&#39;ve allocated for it.  3. If your code always crashes on the second iteration, see if your pointer to the start of <code>trainData</code> is still valid on that iteration."}, {"owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1448481188, "post_id": 33912982, "comment_id": 55611503, "body": "@Unfixable: One subtlety is that <code>qsort</code>/<code>std::sort</code> expects a total order for the comparison function, something which the <code>C</code>/<code>C++</code> relational operators on floats fails to provide. In particular unordered IEEE-754 NaNs may have crept in, causing an optimized sorting function to overrun the array bounds while scanning for an expected sentinel."}, {"owner": {"reputation": 440, "user_id": 1136909, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3d7285658e5e4fb87c95e5176bf4eb44?s=128&d=identicon&r=PG", "display_name": "Unfixable", "link": "https://stackoverflow.com/users/1136909/unfixable"}, "reply_to_user": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "edited": false, "score": 0, "creation_date": 1448518362, "post_id": 33912982, "comment_id": 55623808, "body": "@doynax : Thank you for the idea, I resolved the issue now (See my answer) but I&#39;m curious about your advice. Actually I cannot fully understand your advice and I was wondering if you have some links that explains your comment in more detail"}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1448541454, "post_id": 33931691, "comment_id": 55636903, "body": "Main problem with these functions is that <a href=\"http://stackoverflow.com/questions/3379732/is-stdlibs-qsort-recursive\">they are probably recursive</a> so they will not be kind to the stack. Just speculation, but I think perhaps that the name std::sort causes the library implementers to think outside the box and do some clever decisions about which sort algorithm to use, while the name <code>qsort</code> really does suggest Quicksort and nothing but Quicksort, even though the C standard actually does not state how that function must be implemented internally."}], "tags": [], "owner": {"reputation": 440, "user_id": 1136909, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3d7285658e5e4fb87c95e5176bf4eb44?s=128&d=identicon&r=PG", "display_name": "Unfixable", "link": "https://stackoverflow.com/users/1136909/unfixable"}, "is_accepted": true, "score": 2, "last_activity_date": 1448518212, "creation_date": 1448518212, "answer_id": 33931691, "question_id": 33912982, "link": "https://stackoverflow.com/questions/33912982/porting-array-sorting-function-from-c-to-c-on-embedded-system/33931691#33931691", "title": "Porting array sorting function from c++ to c on embedded system", "body": "<p>I found out the problem:\nI'm running FreeRTOS and mistakenly assumed that a task in freeRTOS is allocating it's stack memory on the system stack.\nWhat I mean is that FreeRTOS internal stack is actually allocated on the heap of my device.\nAfter increasing the device heap significantly it is running without any problems.</p>\n\n<p>But I wonder about the difference between std::sort and qsort(), one was working with the smaller FreeRTOS stack while the other wasn't. I assume qsort() has a higher memory footprint which led to a stack/heap overflow.</p>\n"}], "owner": {"reputation": 440, "user_id": 1136909, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3d7285658e5e4fb87c95e5176bf4eb44?s=128&d=identicon&r=PG", "display_name": "Unfixable", "link": "https://stackoverflow.com/users/1136909/unfixable"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 33931691, "answer_count": 1, "score": 2, "last_activity_date": 1448518212, "creation_date": 1448444269, "last_edit_date": 1448446915, "question_id": 33912982, "link": "https://stackoverflow.com/questions/33912982/porting-array-sorting-function-from-c-to-c-on-embedded-system", "title": "Porting array sorting function from c++ to c on embedded system", "body": "<p>I tried to port the following C++ sorting function to C but now my embedded system goes into hard fault error while trying to sort with my new C function.\nThe function is called roughly once every second and interestingly the first loop the sorting works, it always crashes during the second iteration.</p>\n\n<p>C++ Code:</p>\n\n<pre><code>   typedef struct featureData {\n        float Value[NO_OF_ATT];\n        float Distance;\n        bool operator &lt; (const featureData&amp; rhs) const {\n            return Distance &lt; rhs.Distance;\n        }\n    } featureData;\n\n\n\nstd::sort(trainData, trainData+NO_OF_TRAINDATA);\n</code></pre>\n\n<p>C Code:</p>\n\n<pre><code>int compare_function(const void *a,const void *b) \n{\nfeatureData *x = (featureData *) a;\nfeatureData *y = (featureData *) b;\n\nif ( x-&gt;Distance &gt; y-&gt;Distance ) return 1;\nif ( x-&gt;Distance &lt; y-&gt;Distance ) return -1;\nreturn 0;\n}\n\n\n\n\n qsort(trainData, NO_OF_TRAINDATA, sizeof(*trainData), compare_function);\n</code></pre>\n\n<p>Further information:</p>\n\n<p>NO_OF_TRAINDATA = 609</p>\n\n<p>NO_OF_ATT = 22</p>\n\n<p>If I set the NO_OF_TRAINDATA to less than 50 the C function runs without any problems. This makes me believe that it's some memory size problem as I frequently run into memory problems on my embedded system.\nBut does the C quicksort (Or whatever is used by calling qsort) work differently than the std::sort in terms of memory allocation? </p>\n"}, {"tags": ["c", "opencv", "memory-leaks"], "comments": [{"owner": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 4, "creation_date": 1448444291, "post_id": 33912960, "comment_id": 55587673, "body": "please <b>DO NOT</b> use opencv&#39;s venerable c-api, but the c++ one (cv::Mat). it&#39;s no wonder, that you got memleaks like this."}, {"owner": {"reputation": 561, "user_id": 5348749, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5997a392d0ca37778764d2660b409c04?s=128&d=identicon&r=PG&f=1", "display_name": "Han Qiu", "link": "https://stackoverflow.com/users/5348749/han-qiu"}, "reply_to_user": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 0, "creation_date": 1448446569, "post_id": 33912960, "comment_id": 55589150, "body": "@berak Thanks,berak! But I&#39;m wondering why memory leak happens?I&#39;ve used cvReleaseImage() in my codes...."}, {"owner": {"reputation": 24611, "user_id": 2065121, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c92f2d7b7f3af9e4e0c7a5cb1289982b?s=128&d=identicon&r=PG", "display_name": "Roger Rowland", "link": "https://stackoverflow.com/users/2065121/roger-rowland"}, "reply_to_user": {"reputation": 35699, "user_id": 2056772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/574eff69e66401997eecd2ac405053c1?s=128&d=identicon&r=PG", "display_name": "berak", "link": "https://stackoverflow.com/users/2056772/berak"}, "edited": false, "score": 2, "creation_date": 1448449730, "post_id": 33912960, "comment_id": 55591258, "body": "As @berak said, please don&#39;t use the old C API anymore. I don&#39;t know, but I suspect that <code>dst = cvCloneImage(src)</code> does not release the previous content of <code>dst</code>, so if you do want to persist with this, insert a <code>cvReleaseImage(&amp;dst)</code> before that call if <code>dst</code> is not null."}, {"owner": {"reputation": 561, "user_id": 5348749, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5997a392d0ca37778764d2660b409c04?s=128&d=identicon&r=PG&f=1", "display_name": "Han Qiu", "link": "https://stackoverflow.com/users/5348749/han-qiu"}, "edited": false, "score": 0, "creation_date": 1448454258, "post_id": 33912960, "comment_id": 55593935, "body": "Thanks,@RogerRowland !"}, {"owner": {"reputation": 561, "user_id": 5348749, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5997a392d0ca37778764d2660b409c04?s=128&d=identicon&r=PG&f=1", "display_name": "Han Qiu", "link": "https://stackoverflow.com/users/5348749/han-qiu"}, "edited": false, "score": 0, "creation_date": 1448454635, "post_id": 33912960, "comment_id": 55594145, "body": "That&#39;s it!!!!!!!Thanks a lot!!@RogerRowland"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448529523, "post_id": 33912960, "comment_id": 55629309, "body": "Regarding this line: <code>#include &lt;stdio.h&gt;</code>, the posted code is written for C++, not C.  so remove the &#39;c&#39; tag and add the &#39;c++&#39; tag.   The proper header file to #include in c++ is &lt;cstdio&gt;"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448529925, "post_id": 33912960, "comment_id": 55629548, "body": "as you can see from the posted code, do not use tabs when indenting.  because (as easily visible in the posted code), every word processor/editor has the tab widths/tab stops set differently.   Also, for readability, suggest separating code blocks (if, else, while, do...while, switch/case/default) by a blank line"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448530093, "post_id": 33912960, "comment_id": 55629678, "body": "there are several &#39;magic&#39; numbers in the code.  Such as 60, 3, 90.  &#39;magic&#39; numbers make the code very difficult to understand, debug, maintain.  Suggest using #define statements or a enum to give the numbers meaningful names and use those meaningful names throughout the code."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448530206, "post_id": 33912960, "comment_id": 55629744, "body": "running the code with <code>valgrind</code> will expose any memory leaks and where they are located."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448530321, "post_id": 33912960, "comment_id": 55629838, "body": "When writing c++ code, it is much better to use <code>const type name=value;</code> statements than to use #define statements."}], "owner": {"reputation": 561, "user_id": 5348749, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5997a392d0ca37778764d2660b409c04?s=128&d=identicon&r=PG&f=1", "display_name": "Han Qiu", "link": "https://stackoverflow.com/users/5348749/han-qiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448444307, "creation_date": 1448444194, "last_edit_date": 1448444307, "question_id": 33912960, "link": "https://stackoverflow.com/questions/33912960/my-opencv-code-running-really-slow-maybe-memory-leak", "title": "my opencv code running really slow (maybe memory leak?)", "body": "<p>I'm writing an image amplifier that follows the mouse.But there're some problems with it.It becomes really slow as time goes by.I think the reason may be memory leak.But I don't know where is wrong and how to get it correct.I'll be grateful if anyone could help!</p>\n\n<p>This is my code:</p>\n\n<pre><code>#include &lt;cv.h&gt;\n#include &lt;highgui.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;iostream&gt;\n\nusing namespace std;\nusing namespace cv;\n\n#define Radius_0 60\n#define Radius_1 90\n\nIplImage* src = 0;\nIplImage* dst = 0;\n\nvoid  my_mouse_callback(int event, int x, int y, int flags, void * param)\n{\n    int center_x0, center_y0;\n    int center_x1, center_y1;\n    if(event == CV_EVENT_MOUSEMOVE)\n    {\n        if(x &lt;= 60) center_x0 = 60;\n        else if(x &gt;= src-&gt;width - 60) center_x0 = src-&gt;width - 60;\n        else\n            center_x0 = x;\n        if(y &lt;= 60) center_y0 = 60;\n        else if(y &gt;= src-&gt;height - 60) center_y0 = src-&gt;height - 60;\n        else\n            center_y0 = y;\n        if(x &lt;= 90) center_x1 = 90;\n        else if(x &gt;= dst-&gt;width - 90) center_x1 = src-&gt;width - 90;\n        else\n            center_x1 = x;\n        if(y &lt;= 90) center_y1 = 90;\n        else if(y &gt;= src-&gt;height - 90) center_y1 = src-&gt;height - 90;\n        else\n            center_y1 = y;\n\n        IplImage* tmp = cvCreateImage(CvSize(Radius_0*3, Radius_0*3), src-&gt;depth, src-&gt;nChannels);\n        cvZero(tmp);\n        CvPoint p0 = cvPoint(center_x0-Radius_0, center_y0-Radius_0);\n                CvPoint p1 = cvPoint(center_x0+Radius_0, center_y0+Radius_0);\n                cvSetImageROI(src,cvRect(p0.x,p0.y,p1.x-p0.x,p1.y-p0.y));\n                cvResize(src, tmp);\n        cvResetImageROI(src);\n\n        cvZero(dst);\n        dst = cvCloneImage(src);\n        uchar* DstData = (uchar *)dst-&gt;imageData;\n        uchar* TmpData = (uchar *)tmp-&gt;imageData;\n        int DstStep = dst-&gt;widthStep/sizeof(uchar);\n        int TmpStep = tmp-&gt;widthStep/sizeof(uchar);\n                int channels = dst -&gt; nChannels;\n        for(int i = center_y1-Radius_1; i &lt; center_y1+Radius_1; ++ i)\n        {\n            for(int j = center_x1-Radius_1; j &lt; center_x1+Radius_1; ++ j)\n            {\n                int r = (i - center_y1)*(i - center_y1) + (j - center_x1)*(j - center_x1);\n                if(r &lt;= Radius_1*Radius_1)\n                {\n                    int m = i + Radius_1 - center_y1;\n                    int n = j + Radius_1 - center_x1;\n                    DstData[i*DstStep+j*channels+0] = TmpData[m*TmpStep+n*channels+0];\n                    DstData[i*DstStep+j*channels+1] = TmpData[m*TmpStep+n*channels+1];\n                    DstData[i*DstStep+j*channels+2] = TmpData[m*TmpStep+n*channels+2];\n                }\n            }\n        }\n        cvShowImage(\"dst\",dst); \n        cvReleaseImage(&amp;tmp);\n    }\n}\n\nint main(int argc, char * argv[])\n{\n\n    if(argc != 2){\n        return -1;\n    }\n    src = cvLoadImage(argv[1], 1);\n    dst = cvCloneImage(src);\n    cvNamedWindow(\"dst\", 1);\n    cvShowImage(\"dst\",dst);\n        cvSetMouseCallback(\"dst\", my_mouse_callback, 0 );\n        while(1){\n                if(cvWaitKey(15) == 27)\n                        break;\n        }\n        cvDestroyAllWindows();\n        cvReleaseImage(&amp;src);\n    cvReleaseImage(&amp;dst);\n        return 0;\n}           \n</code></pre>\n"}, {"tags": ["c", "cryptography", "libsodium"], "answers": [{"tags": [], "owner": {"reputation": 1378, "user_id": 953439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LgYlS.jpg?s=128&g=1", "display_name": "Frank Denis", "link": "https://stackoverflow.com/users/953439/frank-denis"}, "is_accepted": true, "score": 1, "last_activity_date": 1449286417, "creation_date": 1449286417, "answer_id": 34100958, "question_id": 33912490, "link": "https://stackoverflow.com/questions/33912490/same-input-and-output-buffer-for-libsodium-crypto-stream-salsa20-xor/34100958#34100958", "title": "Same input and output buffer for libsodium crypto_stream_salsa20_xor", "body": "<p>Yes, it is safe to do so. This also applies to other ciphers provided by the library. Input and output buffers can be identical.</p>\n"}], "owner": {"reputation": 3063, "user_id": 4133947, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/99688fdb4523347fb5e789c3705350d4?s=128&d=identicon&r=PG&f=1", "display_name": "robert", "link": "https://stackoverflow.com/users/4133947/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 34100958, "answer_count": 1, "score": 1, "last_activity_date": 1449286417, "creation_date": 1448442847, "question_id": 33912490, "link": "https://stackoverflow.com/questions/33912490/same-input-and-output-buffer-for-libsodium-crypto-stream-salsa20-xor", "title": "Same input and output buffer for libsodium crypto_stream_salsa20_xor", "body": "<p>I am wondering whether it is safe to provide the same buffer as plaintext and ciphertext for <code>crypto_stream_salsa20_xor</code>. I have tried to look into source files. <code>crypto_stream_salsa20_xor</code> uses <code>crypto_core_salsa20</code>, but this function appears only in a header file:</p>\n\n<pre><code>grep -r \"int crypto_core_salsa\" libsodium-1.0.5\nlibsodium-1.0.5/src/libsodium/include/sodium/crypto_core_salsa2012.h:int crypto_core_salsa2012(unsigned char *out, const unsigned char *in,\nlibsodium-1.0.5/src/libsodium/include/sodium/crypto_core_salsa208.h:int crypto_core_salsa208(unsigned char *out, const unsigned char *in,\nlibsodium-1.0.5/src/libsodium/include/sodium/crypto_core_salsa20.h:int crypto_core_salsa20(unsigned char *out, const unsigned char *in,\n</code></pre>\n"}, {"tags": ["c", "directory", "parent", "stat"], "comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1448444024, "post_id": 33912482, "comment_id": 55587510, "body": "I cannot see &#39;fkdkfdjkfdkfjdfkdfjkdfjkdjkfdkjf&#39; in your &#39;ls&#39; output.  stat() cannot report on files it cannot find.  Did you mean to run stat on &#39;../fkdkfdjkfdkfjdfkdfjkdfjkdjkfdkjf&#39; ?"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448536161, "post_id": 33912482, "comment_id": 55633667, "body": "regarding <code>stat()</code>,  1) it must be passed the complete (can be relative or absolute) path,  even the current directory should be referenced as <code>.&#47;</code>  2) a directory/file must have the appropriate permission for the currently executing program to read the directory/file.  This includes any/all directories in the &#39;path&#39; parameter"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448536297, "post_id": 33912482, "comment_id": 55633758, "body": "the posted code does not cleanly compile!  always enable all warnings when compiling, then fix those warnings.  (for gcc, at a minimum use: <code>-Wall -Wextra -pedantic</code> )"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448536406, "post_id": 33912482, "comment_id": 55633844, "body": "When accessing any argv[] entry beyond argv[0] always check the value of argc to assure the command line parameter actually exists.  Otherwise could be access a NULL pointer or some random value in memory if the use did not actually enter the necessary command line parameter(s)"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1448536624, "post_id": 33912482, "comment_id": 55633977, "body": "the posted code (probably) does not want to try opening the directory entries <code>.</code> and <code>..</code>, so should check the directory name to assure it is neither of these values.  (be sure to use something like strcmp() so a file or directory name that starts with <code>.</code> is not skipped"}], "answers": [{"tags": [], "owner": {"reputation": 403, "user_id": 5582108, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/FNkBF.jpg?s=128&g=1", "display_name": "Viet", "link": "https://stackoverflow.com/users/5582108/viet"}, "is_accepted": false, "score": 1, "last_activity_date": 1448443427, "creation_date": 1448443427, "answer_id": 33912695, "question_id": 33912482, "link": "https://stackoverflow.com/questions/33912482/stat-doesnt-work-on-parent-directory/33912695#33912695", "title": "stat() doesn&#39;t work on parent directory", "body": "<p>The program a.out may has not permission to read all the files in that folder. Try to run a.out with root permission.</p>\n\n<p>And, if you want to check the error, please print the <strong>errno</strong> to get the detail of <strong>error</strong> when the <strong>lstat</strong> function does not execute success.</p>\n"}, {"comments": [{"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1448445902, "post_id": 33912936, "comment_id": 55588702, "body": "May need a &#39;/&#39; delimiter in there?"}, {"owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1448453504, "post_id": 33912936, "comment_id": 55593479, "body": "Sure! You need to construct something like <code>..&#47;filename</code>"}], "tags": [], "owner": {"reputation": 30540, "user_id": 719263, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7feab598abfc27783641fe2b796a0155?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Yun&#232;s", "link": "https://stackoverflow.com/users/719263/jean-baptiste-yun%c3%a8s"}, "is_accepted": true, "score": 4, "last_activity_date": 1448444127, "creation_date": 1448444127, "answer_id": 33912936, "question_id": 33912482, "link": "https://stackoverflow.com/questions/33912482/stat-doesnt-work-on-parent-directory/33912936#33912936", "title": "stat() doesn&#39;t work on parent directory", "body": "<p>Your <code>lstat</code> call is wrong. When you get a name from the opened directory, it is a relative name, so you need to convert it to a correct path to let <code>lstat</code> locate the file:</p>\n\n<pre><code>char path[...];\nsprintf(path,\"%s/%s\",av[1],dir-&gt;d_name);\nlstat(path,...);\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 2680243, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/KMGxV.jpg?s=128&g=1", "display_name": "raph77777", "link": "https://stackoverflow.com/users/2680243/raph77777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2171, "favorite_count": 0, "accepted_answer_id": 33912936, "answer_count": 2, "score": 0, "last_activity_date": 1448478296, "creation_date": 1448442837, "last_edit_date": 1448478296, "question_id": 33912482, "link": "https://stackoverflow.com/questions/33912482/stat-doesnt-work-on-parent-directory", "title": "stat() doesn&#39;t work on parent directory", "body": "<p>I'm trying to code the <code>ls</code> command in C, but <code>stat()</code> refuse to open any other directory.</p>\n\n<pre><code> ~/Desktop/ls$ cat bug.c \n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;dirent.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;pwd.h&gt;\n#include &lt;grp.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\nint     main(int ac, char **av)\n{\n  DIR       *d;\n  struct dirent *dir;\n  struct stat   file;\n\n  d = opendir(av[1]);\n  if (d)\n    {\n      while ((dir = readdir(d)) != NULL)\n        {\n          printf(\"%s -&gt;\", dir-&gt;d_name);\n          if (lstat(dir-&gt;d_name, &amp;file) &lt; 0)\n          printf(\" can't read file %s!\", dir-&gt;d_name);\n          printf(\"\\n\");\n        }\n    }\n  closedir(d);\n  return (0);\n}\n</code></pre>\n\n<p>When running <code>./a.out</code> . or any subfolder, it works correctly.\nBut if I write <code>./a.out ..</code> , it fails to open files...</p>\n\n<pre><code>~/Desktop/ls$ ./a.out ..\n.. -&gt;\nfkdkfdjkfdkfjdfkdfjkdfjkdjkfdkjf -&gt; can't read file fkdkfdjkfdkfjdfkdfjkdfjkdjkfdkjf!\nss -&gt; can't read file ss!\nls -&gt; can't read file ls!\n. -&gt;\ntg -&gt; can't read file tg!\n</code></pre>\n\n<p><code>./a.out /home/login/Desktop</code> doesn't work either, but <code>./a.out /home/login/Desktop/ls/</code> display correctly the content of the current folder.</p>\n\n<p>It looks like <code>a.out</code> can't open parents dir, but <code>ls -l</code> gives : </p>\n\n<pre><code>-rwxrwxr-x 1 hellomynameis hellomynameis 13360 nov.  25 09:56 a.out\n</code></pre>\n\n<p>Am I doing it the wrong way ?</p>\n\n<p>Thanks !</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4232, "user_id": 5281962, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a29ae5ecb74bea23afa60d940edc0282?s=128&d=identicon&r=PG&f=1", "display_name": "Cherubim", "link": "https://stackoverflow.com/users/5281962/cherubim"}, "edited": false, "score": 3, "creation_date": 1448444821, "post_id": 33912452, "comment_id": 55588014, "body": "Can you give few examples of minimal primes.. And explain about them more clearly"}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 3933895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3eff8d3f5166ea0f7974afbfcdd5ca?s=128&d=identicon&r=PG&f=1", "display_name": "Samidamaru", "link": "https://stackoverflow.com/users/3933895/samidamaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1448444841, "creation_date": 1448444841, "answer_id": 33913189, "question_id": 33912452, "link": "https://stackoverflow.com/questions/33912452/minimal-primes-generator-in-c/33913189#33913189", "title": "minimal primes generator in C", "body": "<p>This is because you're not telling it to print <code>min</code>.\nChange this line:</p>\n\n<pre><code>printf(\" minimal \\n\",min);\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>printf(\"%d minimal \\n\",min);\n</code></pre>\n\n<p>To achieve what I think you were trying to do.</p>\n\n<p><code>printf</code> prints variables using <a href=\"http://www.cplusplus.com/reference/cstdio/printf/\" rel=\"nofollow\">format specifiers</a>. It would be worth reading a few tutorials on how to use them :).</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5584049, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3dc803aff4394d000acc7b7ccc6a6b22?s=128&d=identicon&r=PG&f=1", "display_name": "navarian", "link": "https://stackoverflow.com/users/5584049/navarian"}, "edited": false, "score": 0, "creation_date": 1448445235, "post_id": 33913299, "comment_id": 55588281, "body": "but i remove break i have an infinity lopp"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 41, "user_id": 5584049, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3dc803aff4394d000acc7b7ccc6a6b22?s=128&d=identicon&r=PG&f=1", "display_name": "navarian", "link": "https://stackoverflow.com/users/5584049/navarian"}, "edited": false, "score": 1, "creation_date": 1448445357, "post_id": 33913299, "comment_id": 55588339, "body": "So move the <code>break</code> further down, or rethink the logic."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1448445149, "creation_date": 1448445149, "answer_id": 33913299, "question_id": 33912452, "link": "https://stackoverflow.com/questions/33912452/minimal-primes-generator-in-c/33913299#33913299", "title": "minimal primes generator in C", "body": "<p>It is because you have a <code>break</code> statement above the line in question, so it never gets executed.</p>\n\n<pre><code>printf(\"%d sub \\n\",sub);\nprintf(\"%d count \\n\",counter);\nbreak;                              // &lt;&lt;-- remove this line\nif(counter==0)\n    printf(\" minimal \\n\",min);\n</code></pre>\n\n<p>An additional problem is you don't print any value, change to this</p>\n\n<pre><code>if(counter==0)\n    printf(\"%d minimal \\n\",min);    // add format specifier\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5605342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c2b157908560b3c36d95a902ba2d4c6?s=128&d=identicon&r=PG&f=1", "display_name": "Pankan", "link": "https://stackoverflow.com/users/5605342/pankan"}, "is_accepted": false, "score": 0, "last_activity_date": 1448478217, "last_edit_date": 1448478217, "creation_date": 1448472847, "answer_id": 33922981, "question_id": 33912452, "link": "https://stackoverflow.com/questions/33912452/minimal-primes-generator-in-c/33922981#33922981", "title": "minimal primes generator in C", "body": "<p>I can also see an infinite loop at <code>while (sub!=i)</code> since sub doesn't change inside the loop.<br>\nTo further test me add a <code>printf(\"Problematic loop\")</code> inside the loop and see it yourself how many times it will print the statement without printing a number.</p>\n"}], "owner": {"reputation": 41, "user_id": 5584049, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3dc803aff4394d000acc7b7ccc6a6b22?s=128&d=identicon&r=PG&f=1", "display_name": "navarian", "link": "https://stackoverflow.com/users/5584049/navarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1448478217, "creation_date": 1448442758, "last_edit_date": 1448445470, "question_id": 33912452, "link": "https://stackoverflow.com/questions/33912452/minimal-primes-generator-in-c", "title": "minimal primes generator in C", "body": "<p>I have to find all the minimal primes that have at least two digits. A minimal prime is a prime number which subsequences are not primes. In order to correctly complete the exercise I cannot use arrays (they are prohibited) and I must <code>#define</code> the <code>maxnumb</code>. The problem I have here is that I cannot print the min. What I have so far is this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#define MAXNUMB 100\n\nint IsPrime(int number);\n\nint main (void) {\nint i,j,x,k,mask,max=1,mult,sub,c,number;\n    for (i = 11 ; i &lt; MAXNUMB; i += 2 ){\n     number=IsPrime(i);\n     if (number==1) {\n\n        int length = 0;\n        int tmp=i;\n       while (tmp != 0) {\n              tmp /= 10;\n              length++;\n            }\n\n        for (x=1;x&lt;length*2;x++) {\n            mask=x;\n            mult=1;\n            sub=0;\n            int num=i;\n            int counter=0;\n                while(num!=0) {\n                  if ( mask % 2 == 1 ) {\n                      sub += num % 10 * mult;\n                      mult *= 10; \n                   }\n\n                   num /= 10;\n                   mask /= 2;\n                }\n                while (sub!=i){\n\n\n                   int min=i;\n                   k=IsPrime(sub);\n\n                   if(k==1) \n\n                   counter+=1;\n                   printf(\"%d sub \\n\",sub);\n                   printf(\"%d count \\n\",counter);\n                   break;\n                   if(counter==0)\n                   printf(\" minimal \\n\",min);\n               }\n       }    \n     }\n   }\n   return 0;\n}\nint IsPrime(int i) {\n   int j;\n   if (i==1)\n   return 0;\n   for (j=2; j*j&lt;=i; j++) {\n    if (i % j == 0)\n           return 0;\n    }\n    if (j*j&gt;i )\n    return 1;\n}\n</code></pre>\n"}, {"tags": ["c", "getopt", "unistd.h"], "answers": [{"tags": [], "owner": {"reputation": 9554, "user_id": 3306465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MAduK.png?s=128&g=1", "display_name": "Igal S.", "link": "https://stackoverflow.com/users/3306465/igal-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1448442678, "creation_date": 1448442678, "answer_id": 33912418, "question_id": 33912306, "link": "https://stackoverflow.com/questions/33912306/argument-line-option-parsing-for-c/33912418#33912418", "title": "Argument Line Option Parsing for C", "body": "<p>In <code>getopt</code> there is no meaning for the parameters order. The common way to do it is to have one big <code>switch</code> case for <code>getopt</code> which sets various flags, and after it you can add further dependency checks of the flags.</p>\n"}, {"comments": [{"owner": {"reputation": 678, "user_id": 5345165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5542e4816ae7291b23ea21fa2553497b?s=128&d=identicon&r=PG&f=1", "display_name": "Blue Granny", "link": "https://stackoverflow.com/users/5345165/blue-granny"}, "edited": false, "score": 0, "creation_date": 1448443338, "post_id": 33912461, "comment_id": 55587087, "body": "Yeah that&#39;s what i thought as well. I hoped that there was something elegant."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1448442777, "creation_date": 1448442777, "answer_id": 33912461, "question_id": 33912306, "link": "https://stackoverflow.com/questions/33912306/argument-line-option-parsing-for-c/33912461#33912461", "title": "Argument Line Option Parsing for C", "body": "<p>No there's really no such way to enforce argument order using only <a href=\"http://man7.org/linux/man-pages/man3/getopt.3.html\" rel=\"nofollow\"><code>getopt</code></a>.</p>\n\n<p>What you <em>can</em> do is to set a flag when <code>getopt</code> returns the <code>-a</code> option to you, and check that flag when you get the <code>-b</code> option.</p>\n"}], "owner": {"reputation": 678, "user_id": 5345165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5542e4816ae7291b23ea21fa2553497b?s=128&d=identicon&r=PG&f=1", "display_name": "Blue Granny", "link": "https://stackoverflow.com/users/5345165/blue-granny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 33912461, "answer_count": 2, "score": 0, "last_activity_date": 1448452870, "creation_date": 1448442413, "last_edit_date": 1448452870, "question_id": 33912306, "link": "https://stackoverflow.com/questions/33912306/argument-line-option-parsing-for-c", "title": "Argument Line Option Parsing for C", "body": "<p>I've looked at many of the questions asked here before, and I've decided to go with <em>unistd.h</em> for <em>getopt</em>.</p>\n\n<p>However I have a need that a certain option depends on a previous option, as in </p>\n\n<pre><code>exe -a a_opt -b b_bopt\n</code></pre>\n\n<p>where the <code>-b</code> will do <code>b_opt/a_opt</code></p>\n\n<p>So it follows that <code>-a</code> must be parsed before <code>-b</code>.</p>\n\n<p>Is there a way to implement this?</p>\n\n<p>Thanks</p>\n\n<p>EDIT: The simple way is to create a flag and check it at the end, however i'm trying to see if there is a more elegant solution.</p>\n"}, {"tags": ["c", "matlab", "mex"], "comments": [{"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448442710, "post_id": 33912262, "comment_id": 55586699, "body": "What&#39;s on the first lines of 704.h that are causing the blow up? Could you post lines 1-7? It could be some non-standard c++ that the more modern compiler won&#39;t let fly anymore?"}, {"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448442991, "post_id": 33912262, "comment_id": 55586852, "body": "I&#39;d check that your specific compiler is supported by your specific version of Matlab. Also, the error you mention, &quot;C:\\users\\documents\\matlab\\StdAfx.h(19): fatal error C1083: Cannot open include file: &#39;Afx.h&#39;: No such file or directory&quot; isn&#39;t in the log you listed?"}, {"owner": {"reputation": 77, "user_id": 5177284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a3ac1b733c0cfd961207f54588c0eb23?s=128&d=identicon&r=PG&f=1", "display_name": "Mana V", "link": "https://stackoverflow.com/users/5177284/mana-v"}, "reply_to_user": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448444929, "post_id": 33912262, "comment_id": 55588082, "body": "Here is all that the 704IO.h fil contains (line 1 to 7):  &lt;br/&gt;// 704IO.h : export header file for the 704IO DLL  &lt;br/&gt; //  &lt;br/&gt;  #pragma once  &lt;br/&gt;  extern &quot;C&quot; short WINAPI EXPORT PortRead(short Rack, short Port, short Offset);  &lt;br/&gt; extern &quot;C&quot; void WINAPI EXPORT PortWrite(short Rack, short Port, short Offset, short Value);  &lt;br/&gt;"}, {"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448445205, "post_id": 33912262, "comment_id": 55588265, "body": "(1) You should put that piece of 704IO.h in the question. (2) #pragma denotes a compiler directive, and compiler directives may be <i>specific to a particular compiler</i>! My guess is that the code has a directive that&#39;s not understood by the new compiler but was understood by the old compiler."}, {"owner": {"reputation": 77, "user_id": 5177284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a3ac1b733c0cfd961207f54588c0eb23?s=128&d=identicon&r=PG&f=1", "display_name": "Mana V", "link": "https://stackoverflow.com/users/5177284/mana-v"}, "reply_to_user": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448445894, "post_id": 33912262, "comment_id": 55588697, "body": "My mistake, I edited my question about the fact that &quot;C:\\users\\documents\\matlab\\StdAfx.h(19): fatal error C1083: Cannot open include file: &#39;Afx.h&#39;: No such file or directory&quot; isn&#39;t in the error log and added the code of 704IO.h. So do you think I should change my C++ compiler or shall I simply comment the &quot;#pragma once&quot; line ?"}, {"owner": {"reputation": 1428, "user_id": 2009627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8190c74bc77d7b80ba564482448a0055?s=128&d=identicon&r=PG", "display_name": "gregswiss", "link": "https://stackoverflow.com/users/2009627/gregswiss"}, "edited": false, "score": 0, "creation_date": 1448446004, "post_id": 33912262, "comment_id": 55588758, "body": "looks like you need to define WINAPI? You can do so by including windows.h or do something like <code>#define WINAPI  __stdcall\u201d</code>. Unless it&#39;s EXPORT which is not defined?"}, {"owner": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448446489, "post_id": 33912262, "comment_id": 55589100, "body": "#pragma once should be fine. I thought the #pragma line was huge, lol. Looks like an issue with Visual Studio created header &quot;Afx.h&quot; and various windows api stuff... I&#39;ve been on linux and Mac for so long I&#39;m probably no help on this."}, {"owner": {"reputation": 1428, "user_id": 2009627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8190c74bc77d7b80ba564482448a0055?s=128&d=identicon&r=PG", "display_name": "gregswiss", "link": "https://stackoverflow.com/users/2009627/gregswiss"}, "edited": false, "score": 0, "creation_date": 1448446761, "post_id": 33912262, "comment_id": 55589265, "body": "@ManaV you should be able to comment out the Afx.h but you will probably need to replace by &quot;include &lt;windows.h&gt;&quot;..."}, {"owner": {"reputation": 77, "user_id": 5177284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a3ac1b733c0cfd961207f54588c0eb23?s=128&d=identicon&r=PG&f=1", "display_name": "Mana V", "link": "https://stackoverflow.com/users/5177284/mana-v"}, "reply_to_user": {"reputation": 1428, "user_id": 2009627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8190c74bc77d7b80ba564482448a0055?s=128&d=identicon&r=PG", "display_name": "gregswiss", "link": "https://stackoverflow.com/users/2009627/gregswiss"}, "edited": false, "score": 0, "creation_date": 1448455759, "post_id": 33912262, "comment_id": 55594897, "body": "@gregswiss I tried to replace #include &quot;StdAfx.h&quot; by #include &quot;windows.h&quot; but I still have the same error"}, {"owner": {"reputation": 77, "user_id": 5177284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a3ac1b733c0cfd961207f54588c0eb23?s=128&d=identicon&r=PG&f=1", "display_name": "Mana V", "link": "https://stackoverflow.com/users/5177284/mana-v"}, "reply_to_user": {"reputation": 4301, "user_id": 5531001, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10101959778819333/picture?type=large", "display_name": "Matthew Gunn", "link": "https://stackoverflow.com/users/5531001/matthew-gunn"}, "edited": false, "score": 0, "creation_date": 1448460030, "post_id": 33912262, "comment_id": 55597934, "body": "@matthewGunn I tried to change of compiler and I still have the same errors."}], "owner": {"reputation": 77, "user_id": 5177284, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a3ac1b733c0cfd961207f54588c0eb23?s=128&d=identicon&r=PG&f=1", "display_name": "Mana V", "link": "https://stackoverflow.com/users/5177284/mana-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448445708, "creation_date": 1448442267, "last_edit_date": 1448445708, "question_id": 33912262, "link": "https://stackoverflow.com/questions/33912262/matlab-mex-file-error-afx-h-not-found", "title": "MATLAB Mex-file error: Afx.h not found", "body": "<p>I wrote a MATLAB code that uses mex-file with a computer that uses windows 32bits, and this code worked. Then, I imported this code on an other computer that uses windows 64bits (I'm still building this code with Microsoft Windows SDK 7.1 - C++) and I have the following error: C:\\users\\documents\\matlab\\StdAfx.h(19): fatal error C1083: Cannot open include file: 'Afx.h': No such file or directory</p>\n\n<p>When I comment the line \"#include \"StdAfx.h\" in the C++ file I call from MATLAB, I have the following error log:</p>\n\n<pre><code>&gt;&gt; readTest\nBuilding with 'Microsoft Windows SDK 7.1 (C++)'.\nError using mex\nTest704.cpp\nc:\\users\\icm\\documents\\matlab\\704IO.h(6) : error C2146: syntax error : missing ';'\nbefore identifier 'EXPORT'\nc:\\users\\icm\\documents\\matlab\\704IO.h(6) : error C2146: syntax error : missing ';'\nbefore identifier 'PortRead'\nc:\\users\\icm\\documents\\matlab\\704IO.h(6) : error C4430: missing type specifier -\nint assumed. Note: C++ does not support default-int\nc:\\users\\icm\\documents\\matlab\\704IO.h(6) : error C4430: missing type specifier -\nint assumed. Note: C++ does not support default-int\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C2146: syntax error : missing ';'\nbefore identifier 'EXPORT'\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C2182: 'WINAPI' : illegal use of\ntype 'void'\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C2371: 'WINAPI' : redefinition;\ndifferent basic types\n        c:\\users\\icm\\documents\\matlab\\704IO.h(6) : see declaration of 'WINAPI'\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C2146: syntax error : missing ';'\nbefore identifier 'PortWrite'\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C4430: missing type specifier -\nint assumed. Note: C++ does not support default-int\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C2086: 'int EXPORT' : redefinition\n        c:\\users\\icm\\documents\\matlab\\704IO.h(6) : see declaration of 'EXPORT'\nc:\\users\\icm\\documents\\matlab\\704IO.h(7) : error C4430: missing type specifier -\nint assumed. Note: C++ does not support default-int\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(14) : error C2146: syntax error : missing\n';' before identifier 'theApp'\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(14) : error C4430: missing type specifier\n- int assumed. Note: C++ does not support default-int\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(14) : error C4430: missing type specifier\n- int assumed. Note: C++ does not support default-int\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(42) : warning C4244: 'argument' :\nconversion from 'double' to 'short', possible loss of data\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(42) : warning C4244: 'argument' :\nconversion from 'double' to 'short', possible loss of data\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(42) : warning C4244: 'argument' :\nconversion from 'double' to 'short', possible loss of data\nC:\\Users\\ICM\\Documents\\MATLAB\\Test704.cpp(53) : warning C4244: 'return' :\nconversion from 'double' to 'int', possible loss of data\n</code></pre>\n\n<p>And here is the code behind the \"704IO.h\" file:</p>\n\n<pre><code>// 704IO.h : export header file for the 704IO DLL\n//\n\n#pragma once\n\nextern \"C\" short WINAPI EXPORT PortRead(short Rack, short Port, short Offset);\nextern \"C\" void WINAPI EXPORT PortWrite(short Rack, short Port, short Offset, short Value);\n</code></pre>\n\n<p>I made some researches about my issues, and I think it could be a compatibility error, but I cannot find how to solve it, do you have any idea?</p>\n"}, {"tags": ["c", "linux", "shell"], "comments": [{"owner": {"reputation": 984, "user_id": 5591038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513da5d8a9b9fff5800671e7d7a091fd?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5591038/prasanna"}, "edited": false, "score": 1, "creation_date": 1448442185, "post_id": 33912024, "comment_id": 55586382, "body": "You are doing fork() twice (possibly unintentionally) inside the for loop. Can you check that?"}, {"owner": {"reputation": 41, "user_id": 4932478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jvYmXM_rqIw/AAAAAAAAAAI/AAAAAAAAABc/PpS6Qcgiw-M/photo.jpg?sz=128", "display_name": "\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1", "link": "https://stackoverflow.com/users/4932478/%ce%97%ce%bb%ce%ad%ce%ba%cf%84%cf%81%ce%b1-%ce%96%ce%b1%cf%81%ce%b1%cf%86%ce%ad%cf%84%ce%b1"}, "reply_to_user": {"reputation": 984, "user_id": 5591038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513da5d8a9b9fff5800671e7d7a091fd?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5591038/prasanna"}, "edited": false, "score": 0, "creation_date": 1448444148, "post_id": 33912024, "comment_id": 55587574, "body": "@Prasanna You are right. I changed it, but I get the same results us before."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 5, "creation_date": 1448444566, "post_id": 33912024, "comment_id": 55587852, "body": "Each part of a Linux pipelined command (e.g. <code>cat foo | wc -l</code>) creates and runs in its own <i>subshell</i> (a separate process).  If you need to do that using <code>fork</code>, then you should look at <code>dup</code> or <code>dup2</code> so that you can control the proper redirection of output from one process to the input of another that way."}, {"owner": {"reputation": 984, "user_id": 5591038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513da5d8a9b9fff5800671e7d7a091fd?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5591038/prasanna"}, "edited": false, "score": 0, "creation_date": 1448446150, "post_id": 33912024, "comment_id": 55588845, "body": "@\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1, how does your new code look now? Can you please edit the question with updated code?"}], "answers": [{"tags": [], "owner": {"reputation": 2360, "user_id": 4819357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M-St3cpKcOs/AAAAAAAAAAI/AAAAAAAAAIg/HqtjEfI3EFE/photo.jpg?sz=128", "display_name": "AndreyS Scherbakov", "link": "https://stackoverflow.com/users/4819357/andreys-scherbakov"}, "is_accepted": false, "score": 1, "last_activity_date": 1448451278, "last_edit_date": 1495535631, "creation_date": 1448450643, "answer_id": 33915250, "question_id": 33912024, "link": "https://stackoverflow.com/questions/33912024/shell-program-with-pipes-in-c/33915250#33915250", "title": "Shell program with pipes in C", "body": "<p><code>execv*</code> procedure doesn't interpret shell script string. It merely starts an executable file and passes an array of arguments to it. Thus, it cannot organize a pipeline.</p>\n\n<p>If you need \"normal\" shell command execution, you may want to use <code>system(char*)</code> procedure instead of execvp.</p>\n\n<p>Otherwise, if you need to do the pipes yourself, you may want to parse the string with '|' special characters and use pipe(), fork() and I/O redirection. Like here <a href=\"https://stackoverflow.com/questions/14300880/how-to-run-a-command-using-pipe\">How to run a command using pipe?</a></p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 4932478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jvYmXM_rqIw/AAAAAAAAAAI/AAAAAAAAABc/PpS6Qcgiw-M/photo.jpg?sz=128", "display_name": "\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1", "link": "https://stackoverflow.com/users/4932478/%ce%97%ce%bb%ce%ad%ce%ba%cf%84%cf%81%ce%b1-%ce%96%ce%b1%cf%81%ce%b1%cf%86%ce%ad%cf%84%ce%b1"}, "edited": false, "score": 1, "creation_date": 1448553109, "post_id": 33933773, "comment_id": 55644294, "body": "Thanks a lot!!!Your help was really important!!I noticed though that when i use a pipe,after the command is executed successfully(thanks for that),the shell stops working and i am back on the linux shell...I think that this is happening cause you use only one fork,and after the 2 execvp(s) there is no shell process left...Am i right??I will work on that on my own.Thanks a lot again!!"}, {"owner": {"reputation": 984, "user_id": 5591038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513da5d8a9b9fff5800671e7d7a091fd?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5591038/prasanna"}, "reply_to_user": {"reputation": 41, "user_id": 4932478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jvYmXM_rqIw/AAAAAAAAAAI/AAAAAAAAABc/PpS6Qcgiw-M/photo.jpg?sz=128", "display_name": "\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1", "link": "https://stackoverflow.com/users/4932478/%ce%97%ce%bb%ce%ad%ce%ba%cf%84%cf%81%ce%b1-%ce%96%ce%b1%cf%81%ce%b1%cf%86%ce%ad%cf%84%ce%b1"}, "edited": false, "score": 0, "creation_date": 1448583986, "post_id": 33933773, "comment_id": 55656431, "body": "That&#39;s right. You need one more fork in case you want the <code>while (1)</code> loop to work fine."}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "reply_to_user": {"reputation": 41, "user_id": 4932478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jvYmXM_rqIw/AAAAAAAAAAI/AAAAAAAAABc/PpS6Qcgiw-M/photo.jpg?sz=128", "display_name": "\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1", "link": "https://stackoverflow.com/users/4932478/%ce%97%ce%bb%ce%ad%ce%ba%cf%84%cf%81%ce%b1-%ce%96%ce%b1%cf%81%ce%b1%cf%86%ce%ad%cf%84%ce%b1"}, "edited": false, "score": 0, "creation_date": 1474067915, "post_id": 33933773, "comment_id": 66396450, "body": "@\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1\u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1 if you liked Prasanna&#39;s answer you should accept it and give points"}], "tags": [], "owner": {"reputation": 984, "user_id": 5591038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/513da5d8a9b9fff5800671e7d7a091fd?s=128&d=identicon&r=PG&f=1", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5591038/prasanna"}, "is_accepted": false, "score": 4, "last_activity_date": 1448526630, "creation_date": 1448526630, "answer_id": 33933773, "question_id": 33912024, "link": "https://stackoverflow.com/questions/33912024/shell-program-with-pipes-in-c/33933773#33933773", "title": "Shell program with pipes in C", "body": "<p>Updated your code with following corrections.</p>\n\n<ol>\n<li>Removed <code>for()</code> loop that iterated two times after <code>fork()</code> call.</li>\n<li>Removed incorrect close of pipe FDs after <code>dup2</code> calls for both parent and child processes.</li>\n<li>Aligned the command that needed to be run as per the file descriptors that were duplicated in <code>dup2()</code> calls for parent and child. Basically I needed to swap <code>execvp(argv2[0], argv2)</code> and <code>execvp(argv1[0], argv1)</code> calls.</li>\n<li>Added a <code>break;</code> statement in the for loop that searched for pipe character.</li>\n</ol>\n\n<p>The updated code is as below.</p>\n\n<pre><code>#include &lt;stdlib.h&gt;   \n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/wait.h&gt;\n\n#define MAX_CMD_LENGTH 100\n\n#define MAX_NUM_PARAMS 10\n\nint parsecmd(char* cmd, char** params) { //split cmd into array of params\n    int i,n=-1;\n    for(i=0; i&lt;MAX_NUM_PARAMS; i++) {\n        params[i] = strsep(&amp;cmd, \" \");\n        n++;\n        if(params[i] == NULL) break;\n    }\n    return(n);\n};\n\nint executecmd(char** params) {\n    pid_t pid = fork(); //fork process\n\n    if (pid == -1) { //error\n        char *error = strerror(errno);\n        printf(\"error fork!!\\n\");\n        return 1;\n    } else if (pid == 0) { // child process\n        execvp(params[0], params); //exec cmd\n        char *error = strerror(errno);\n        printf(\"unknown command\\n\");\n        return 0;\n    } else { // parent process\n        int childstatus;\n        waitpid(pid, &amp;childstatus, 0);    \n        return 1;\n    }\n};\n\nint execpipe (char ** argv1, char ** argv2) {\n    int fds[2];\n    pipe(fds);\n    int i;\n    pid_t pid = fork();\n    if (pid == -1) { //error\n        char *error = strerror(errno);\n        printf(\"error fork!!\\n\");\n        return 1;\n    } \n    if (pid == 0) { // child process\n        close(fds[1]);\n        dup2(fds[0], 0);\n        //close(fds[0]);\n        execvp(argv2[0], argv2); // run command AFTER pipe character in userinput\n        char *error = strerror(errno);\n        printf(\"unknown command\\n\");\n        return 0;\n    } else { // parent process\n        close(fds[0]);\n        dup2(fds[1], 1);\n        //close(fds[1]);\n        execvp(argv1[0], argv1); // run command BEFORE pipe character in userinput\n        char *error = strerror(errno);\n        printf(\"unknown command\\n\");\n        return 0;\n    }\n};\n\n\nint main() {    \n    char cmd[MAX_CMD_LENGTH+1];    \n    char * params[MAX_NUM_PARAMS+1];    \n    char * argv1[MAX_NUM_PARAMS+1] = {0};    \n    char * argv2[MAX_NUM_PARAMS+1] = {0};    \n    int k, y, x;    \n    int f = 1;    \n    while(1) {\n        printf(\"$\"); //prompt    \n        if(fgets(cmd, sizeof(cmd), stdin) == NULL) break; //read command, ctrl+D exit       \n        if(cmd[strlen(cmd)-1] == '\\n') { //remove newline char    \n            cmd[strlen(cmd)-1] = '\\0';    \n        }    \n        int j=parsecmd(cmd, params); //split cmd into array of params           \n        if (strcmp(params[0], \"exit\") == 0) break; //exit   \n        for (k=0; k &lt;j; k++) { //elegxos gia uparksi pipes    \n            if (strcmp(params[k], \"|\") == 0) {    \n                f = 0; y = k;      \n               printf(\"pipe found\\n\");\n               break;\n            }               \n        }\n        if (f==0) {\n            for (x=0; x&lt;k; x++) {    \n               argv1[x]=params[x];\n            }     \n            int z = 0;     \n            for (x=k+1; x&lt; j; x++) {     \n                argv2[z]=params[x];\n                z++;\n            }     \n            if (execpipe(argv1, argv2) == 0) break;    \n         } else if (f==1) {     \n             if (executecmd(params) == 0) break;\n         }\n    } // end while\n    return 0;\n}\n</code></pre>\n\n<p>If you are interested only in changes I made, here is the diff between your code and the above updated code:</p>\n\n<pre><code>--- original.c\n+++ updated.c\n@@ -4,6 +4,7 @@\n #include &lt;unistd.h&gt;\n #include &lt;errno.h&gt;\n #include &lt;sys/types.h&gt;\n+#include &lt;sys/wait.h&gt;\n\n #define MAX_CMD_LENGTH 100\n\n@@ -43,44 +44,36 @@\n     pipe(fds);\n     int i;\n     pid_t pid = fork();\n-    for (i=0; i&lt;2; i++) {\n         if (pid == -1) { //error\n             char *error = strerror(errno);\n             printf(\"error fork!!\\n\");\n             return 1;\n-         } else\n-             if (pid == 0) {\n-                 if(i ==0){\n+    } \n+    if (pid == 0) { // child process\n                      close(fds[1]);\n                      dup2(fds[0], 0);\n-                     close(fds[0]);\n-                     execvp(argv1[0], argv1);\n+        //close(fds[0]);\n+        execvp(argv2[0], argv2); // run command AFTER pipe character in userinput\n                      char *error = strerror(errno);\n                      printf(\"unknown command\\n\");\n                      return 0;\n-                 } else if(i == 1) { \n+    } else { // parent process\n                      close(fds[0]);\n                      dup2(fds[1], 1);\n-                     close(fds[1]);\n-                     execvp(argv2[0], argv2);\n+        //close(fds[1]);\n+        execvp(argv1[0], argv1); // run command BEFORE pipe character in userinput\n                      char *error = strerror(errno);\n                      printf(\"unknown command\\n\");\n                      return 0;\n                  }\n-            } else { // parent process\n-                int childstatus;\n-                waitpid(pid, &amp;childstatus, 0);\n-                return 1;\n-            }\n-    } // end for\n };\n\n\n int main() {    \n     char cmd[MAX_CMD_LENGTH+1];    \n     char * params[MAX_NUM_PARAMS+1];    \n-    char * argv1[MAX_NUM_PARAMS+1];    \n-    char * argv2[MAX_NUM_PARAMS+1];    \n+    char * argv1[MAX_NUM_PARAMS+1] = {0};    \n+    char * argv2[MAX_NUM_PARAMS+1] = {0};    \n     int k, y, x;    \n     int f = 1;    \n     while(1) {\n@@ -95,6 +88,7 @@\n             if (strcmp(params[k], \"|\") == 0) {    \n                 f = 0; y = k;      \n                printf(\"pipe found\\n\");\n+               break;\n             }               \n         }\n         if (f==0) {\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4932478, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jvYmXM_rqIw/AAAAAAAAAAI/AAAAAAAAABc/PpS6Qcgiw-M/photo.jpg?sz=128", "display_name": "\u0397\u03bb\u03ad\u03ba\u03c4\u03c1\u03b1 \u0396\u03b1\u03c1\u03b1\u03c6\u03ad\u03c4\u03b1", "link": "https://stackoverflow.com/users/4932478/%ce%97%ce%bb%ce%ad%ce%ba%cf%84%cf%81%ce%b1-%ce%96%ce%b1%cf%81%ce%b1%cf%86%ce%ad%cf%84%ce%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12417, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1448526630, "creation_date": 1448441484, "last_edit_date": 1448444522, "question_id": 33912024, "link": "https://stackoverflow.com/questions/33912024/shell-program-with-pipes-in-c", "title": "Shell program with pipes in C", "body": "<p>I have a problem with pipes. My program is a Shell program in C. I want to execute for example <code>ls | wc</code>, but what I get after running is: </p>\n\n<blockquote>\n  <p>ls: cannot access |: no such file or directory ls: cannot access wc: no such file or directory. </p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n\n<pre><code>#include &lt;stdlib.h&gt;   \n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/types.h&gt;\n\n#define MAX_CMD_LENGTH 100\n\n#define MAX_NUM_PARAMS 10\n\nint parsecmd(char* cmd, char** params) { //split cmd into array of params\n    int i,n=-1;\n    for(i=0; i&lt;MAX_NUM_PARAMS; i++) {\n        params[i] = strsep(&amp;cmd, \" \");\n        n++;\n        if(params[i] == NULL) break;\n    }\n    return(n);\n};\n\nint executecmd(char** params) {\n    pid_t pid = fork(); //fork process\n\n    if (pid == -1) { //error\n        char *error = strerror(errno);\n        printf(\"error fork!!\\n\");\n        return 1;\n    } else if (pid == 0) { // child process\n        execvp(params[0], params); //exec cmd\n        char *error = strerror(errno);\n        printf(\"unknown command\\n\");\n        return 0;\n    } else { // parent process\n        int childstatus;\n        waitpid(pid, &amp;childstatus, 0);    \n        return 1;\n    }\n};\n\nint execpipe (char ** argv1, char ** argv2) {\n    int fds[2];\n    pipe(fds);\n    int i;\n    pid_t pid = fork();\n    for (i=0; i&lt;2; i++) {\n        if (pid == -1) { //error\n            char *error = strerror(errno);\n            printf(\"error fork!!\\n\");\n            return 1;\n         } else\n             if (pid == 0) {\n                 if(i ==0){\n                     close(fds[1]);\n                     dup2(fds[0], 0);\n                     close(fds[0]);\n                     execvp(argv1[0], argv1);\n                     char *error = strerror(errno);\n                     printf(\"unknown command\\n\");\n                     return 0;\n                 } else if(i == 1) { \n                     close(fds[0]);\n                     dup2(fds[1], 1);\n                     close(fds[1]);\n                     execvp(argv2[0], argv2);\n                     char *error = strerror(errno);\n                     printf(\"unknown command\\n\");\n                     return 0;\n                 }\n            } else { // parent process\n                int childstatus;\n                waitpid(pid, &amp;childstatus, 0);\n                return 1;\n            }\n    } // end for\n};\n\n\nint main() {    \n    char cmd[MAX_CMD_LENGTH+1];    \n    char * params[MAX_NUM_PARAMS+1];    \n    char * argv1[MAX_NUM_PARAMS+1];    \n    char * argv2[MAX_NUM_PARAMS+1];    \n    int k, y, x;    \n    int f = 1;    \n    while(1) {\n        printf(\"$\"); //prompt    \n        if(fgets(cmd, sizeof(cmd), stdin) == NULL) break; //read command, ctrl+D exit       \n        if(cmd[strlen(cmd)-1] == '\\n') { //remove newline char    \n            cmd[strlen(cmd)-1] = '\\0';    \n        }    \n        int j=parsecmd(cmd, params); //split cmd into array of params           \n        if (strcmp(params[0], \"exit\") == 0) break; //exit   \n        for (k=0; k &lt;j; k++) { //elegxos gia uparksi pipes    \n            if (strcmp(params[k], \"|\") == 0) {    \n                f = 0; y = k;      \n               printf(\"pipe found\\n\");\n            }               \n        }\n        if (f==0) {\n            for (x=0; x&lt;k; x++) {    \n               argv1[x]=params[x];\n            }     \n            int z = 0;     \n            for (x=k+1; x&lt; j; x++) {     \n                argv2[z]=params[x];\n                z++;\n            }     \n            if (execpipe(argv1, argv2) == 0) break;    \n         } else if (f==1) {     \n             if (executecmd(params) == 0) break;\n         }\n    } // end while\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "shared-libraries", "dynamic-linking", "luajit"], "comments": [{"owner": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1448489140, "post_id": 33911713, "comment_id": 55615452, "body": "It might be that since the symbol is in the shared library, the executable itself doesn&#39;t export it, so LuaJIT doesn&#39;t find it. Try making sure that <code>.</code> is in <code>package.cpath</code>, requiring it from the shared library with <code>require(&quot;main&quot;)</code>."}, {"owner": {"reputation": 918, "user_id": 668125, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zuE5Z.png?s=128&g=1", "display_name": "nonchip", "link": "https://stackoverflow.com/users/668125/nonchip"}, "reply_to_user": {"reputation": 18146, "user_id": 646619, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bd61a0f309ebc135d2661710c2faf379?s=128&d=identicon&r=PG", "display_name": "Colonel Thirty Two", "link": "https://stackoverflow.com/users/646619/colonel-thirty-two"}, "edited": false, "score": 0, "creation_date": 1448577419, "post_id": 33911713, "comment_id": 55654677, "body": "@ColonelThirtyTwo the problem is i don&#39;t want to use the <code>package.cpath</code> logic for loading it from that library, but want the symbols to be &quot;just there&quot; when the executable is linked against it and loaded by <code>ld</code>. (which it happens to be not, see edit)"}], "owner": {"reputation": 918, "user_id": 668125, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/zuE5Z.png?s=128&g=1", "display_name": "nonchip", "link": "https://stackoverflow.com/users/668125/nonchip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 498, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448577258, "creation_date": 1448440414, "last_edit_date": 1448577258, "question_id": 33911713, "link": "https://stackoverflow.com/questions/33911713/link-luajit-bytecode-as-dynamic-library", "title": "link luajit bytecode as dynamic library", "body": "<p>I have:</p>\n\n<pre><code>--main.lua\nprint(\"Hello from main.lua\")\n\n\n//main.c\n#include &lt;stdio.h&gt;\n\n#include \"lua.h\"\n#include \"lauxlib.h\"\n#include \"lualib.h\"\n\nint main(int argc, char **argv)\n{\n  int status;\n  lua_State *L = luaL_newstate();\n  luaL_openlibs(L);\n  lua_getglobal(L, \"require\");\n  lua_pushliteral(L, \"main\");\n  status = lua_pcall(L, 1, 0, 0);\n  if (status) {\n    fprintf(stderr, \"Error: %s\\n\", lua_tostring(L, -1));\n    return 1;\n  }\n  return 0;\n}\n\n\n#make.sh\nluajit -b main.lua main.o\ngcc -shared -O2 -fPIC -Wall -Wl,-E -o libmyluastuff.so main.o\ngcc -O2 -Wall -Wl,-E -o out main.c -I/usr/include/luajit-2.0 -lluajit-5.1 -lm -ldl -L. -lmyluastuff\nrm -r dist\nmkdir dist\ncp out libmyluastuff.so dist\ncd dist\n./out\n</code></pre>\n\n<p>if i link the luajit-generated object into my binary, it works as expected, but if i link it as a library (still exporting with <code>-Wl,-E</code> as you can see), i get <code>Error: module 'main' not found</code>.</p>\n\n<p>what do I do wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>the resulting executable isn't linked to the library at all:</p>\n\n<pre><code>$ ldd out \n    linux-vdso.so.1 =&gt;  (0x00007ffdfadf1000)\n    libluajit-5.1.so.2 =&gt; /usr/lib/x86_64-linux-gnu/libluajit-5.1.so.2 (0x00007f52099b0000)\n    libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007f52095e6000)\n    libm.so.6 =&gt; /lib/x86_64-linux-gnu/libm.so.6 (0x00007f52092de000)\n    libdl.so.2 =&gt; /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f52090da000)\n    libgcc_s.so.1 =&gt; /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f5208ec4000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f5209c1f000)\n</code></pre>\n\n<p>i suspect gcc just optimizes it away, cause main.c doesn't directly use any symbols from it (but libluajit would if they were linked). can i force it to link it anyway?</p>\n"}, {"tags": ["c", "gtk"], "comments": [{"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1448632368, "post_id": 33911544, "comment_id": 55675321, "body": "did you find a solution for this ?"}, {"owner": {"reputation": 21, "user_id": 5603088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed6f4fc0a86d585f224b4d74a4d4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "jimmykarotte", "link": "https://stackoverflow.com/users/5603088/jimmykarotte"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1448810593, "post_id": 33911544, "comment_id": 55724335, "body": "No. Gtk Inspector shows the Icon as Gtk Image inside Gtk Box, but can&#39;t find the Checkboxes or Radio Buttons anywhere. I think it&#39;s some placeholder given from the Rendering, don&#39;t know the rendering Process at all."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1449761987, "post_id": 33911544, "comment_id": 56156266, "body": "Why didn&#39;t you use <code>gtk_image_menu_item_new ()</code>? Is it because it is deprecated? Using gtk+3.x?"}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1449762810, "post_id": 33911544, "comment_id": 56156888, "body": "I&#39;m not sure why gtk+ 3.x set <code>gtk_image_menu_item_new ()</code> as deprecated. Check this <a href=\"https://developer.gnome.org/gtk3/stable/GtkImageMenuItem.html#gtk-image-menu-item-new\" rel=\"nofollow noreferrer\">link</a>."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1449764776, "post_id": 33911544, "comment_id": 56158289, "body": "the first param to <code>gtk_icon_theme_load_icon</code> should be <code>theme</code> in your case instead of <code>icon_theme</code>."}, {"owner": {"reputation": 21, "user_id": 5603088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed6f4fc0a86d585f224b4d74a4d4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "jimmykarotte", "link": "https://stackoverflow.com/users/5603088/jimmykarotte"}, "reply_to_user": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1449821349, "post_id": 33911544, "comment_id": 56181693, "body": "Using Gtk 3.16 so i try to avoid any deprecations. Icon_theme was a typo , fixed it to theme.  Icons in the Toplevel work as expected, but not in sub-menus. As I am new to GTK i really dont know where the real drawing takes place, but i think that would need a customization anyway in the x11 / gdk / cairo ??? used by gtk. So I left the Icons away."}, {"owner": {"reputation": 19601, "user_id": 1620779, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dlgGb.png?s=128&g=1", "display_name": "sjsam", "link": "https://stackoverflow.com/users/1620779/sjsam"}, "edited": false, "score": 0, "creation_date": 1449824490, "post_id": 33911544, "comment_id": 56183348, "body": "GDK (Gnome Drawing Kit) does the image rendering interacting with the X  system underneath. I hope you already experimented with the size of icon, ie decresaing it from 36 to say 24. A good alternative will be using GtkContainer to stack up the menu items. Hell lot of a job though !"}], "answers": [{"comments": [{"owner": {"reputation": 2560, "user_id": 857853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7eb69bcd9b721d0af2839a1337a0885f?s=128&d=identicon&r=PG", "display_name": "Zharf", "link": "https://stackoverflow.com/users/857853/zharf"}, "edited": false, "score": 2, "creation_date": 1488377006, "post_id": 42533654, "comment_id": 72203194, "body": "Some explanation would be nice, code only solutions can be cryptic"}, {"owner": {"reputation": 1148, "user_id": 5383521, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/01531ac40d262787ab7659f7220505df?s=128&d=identicon&r=PG&f=1", "display_name": "flowit", "link": "https://stackoverflow.com/users/5383521/flowit"}, "edited": false, "score": 0, "creation_date": 1491316366, "post_id": 42533654, "comment_id": 73491941, "body": "@RomeoPetruca please update your answer. There is no hint how to use <i>image</i> in OPs code. Honestly, I don&#39;t think a proper alignment is possible here. The icon is deliberatly placed outside of the space that is reserved for check and radio buttons, so the only alignment possible would be to shift the menu items without icons so at least the labels align properly."}], "tags": [], "owner": {"reputation": 1, "user_id": 7641686, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RLyo7BkxLsQ/AAAAAAAAAAI/AAAAAAAAADg/3WbtuhoucyU/photo.jpg?sz=128", "display_name": "Romeo Petruca", "link": "https://stackoverflow.com/users/7641686/romeo-petruca"}, "is_accepted": false, "score": -1, "last_activity_date": 1488376619, "creation_date": 1488376619, "answer_id": 42533654, "question_id": 33911544, "link": "https://stackoverflow.com/questions/33911544/gtk3-gmenuitem-with-icon-alignment/42533654#42533654", "title": "Gtk3 GMenuItem with icon alignment", "body": "<pre><code>     gtk_icon_size_lookup( GTK_ICON_SIZE_MENU, &amp;width, &amp;height );\n     image = gtk_image_new();\n     gtk_image_clear( GTK_IMAGE( image ));\n     gtk_widget_set_size_request( image, width, height );\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5603088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ed6f4fc0a86d585f224b4d74a4d4e2d?s=128&d=identicon&r=PG&f=1", "display_name": "jimmykarotte", "link": "https://stackoverflow.com/users/5603088/jimmykarotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 421, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1488376619, "creation_date": 1448439809, "last_edit_date": 1449820604, "question_id": 33911544, "link": "https://stackoverflow.com/questions/33911544/gtk3-gmenuitem-with-icon-alignment", "title": "Gtk3 GMenuItem with icon alignment", "body": "<p>I'm new to Stackoverflow, and really learned a lot here.<br>\nSo my first Question:</p>\n\n<p>Started to Develop an Application with Gtk3.\nSearched the Web for 2 Days but can't find Examples that used the GMenu with Icons next to Items. The problem I faced its that the Icons are not left Aligned in sub-menus. See a sample below :</p>\n\n<p><a href=\"https://i.stack.imgur.com/tMzd5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tMzd5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The Icon is Loaded from Theme into a Pixbuf.</p>\n\n<p>The Application is going to be written in C and runs on Linux only.</p>\n\n<p>What can i do to Align the icon left ?</p>\n\n<pre><code>GMenu *section;\nsection = g_menu_new();\n\nGMenuItem *item;\nitem = g_menu_item_new( \"Label\", NULL );\n\nGError        *err = NULL;\nGtkIconTheme  *theme;\nGdKPixbuf     *pixbuf;\n\ntheme  = gtk_icon_theme_get_default();\npixbuf = gtk_icon_theme_load_icon( theme, \"application-exit\", 36, NULL, &amp;err);\n......\ng_menu_item_set_icon( item, G_ICON(pixbuf) );\ng_menu_append_item( section, item );\n......\ngtk_application_set_menubar( GTK_APPLICATION(app), G_MENU_MODEL(menu) );\n</code></pre>\n\n<p>Didn't found a Working Example of GMenu with Icons.<br>\nEven the GtkBuilder won't align the Icons left.<br>\nThe Menubar is attached at \" startup \" signal of the Application.  </p>\n\n<p>Gtk Reference doesn't list any Styles or Properties of GMenuItem.</p>\n\n<p>Hopefully some of the Genius here at Stack know what I am missing.</p>\n"}, {"tags": ["c", "apache"], "comments": [{"owner": {"reputation": 71156, "user_id": 1190388, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5391819cc4abe0cb43587c9ef1808dbd?s=128&d=identicon&r=PG", "display_name": "hjpotter92", "link": "https://stackoverflow.com/users/1190388/hjpotter92"}, "edited": false, "score": 0, "creation_date": 1448440294, "post_id": 33911533, "comment_id": 55585319, "body": "Can you explain what you mean by <i>global storage</i>?"}], "answers": [{"tags": [], "owner": {"reputation": 15919, "user_id": 98959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd8df86ca823b368f838da3ff25f10c?s=128&d=identicon&r=PG", "display_name": "covener", "link": "https://stackoverflow.com/users/98959/covener"}, "is_accepted": false, "score": 0, "last_activity_date": 1448477820, "creation_date": 1448477820, "answer_id": 33924402, "question_id": 33911533, "link": "https://stackoverflow.com/questions/33911533/built-in-global-storage-in-apache-httpd/33924402#33924402", "title": "Built-in global storage in Apache HTTPD", "body": "<p>In 2.4 you can use the services provided by mod_slotmem, as long as a cross-process provider like SHM is loaded.</p>\n"}], "owner": {"reputation": 53, "user_id": 2609733, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e103397b2a4e88a8aa723d6796395215?s=128&d=identicon&r=PG", "display_name": "user2609733", "link": "https://stackoverflow.com/users/2609733/user2609733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448477820, "creation_date": 1448439765, "last_edit_date": 1448441463, "question_id": 33911533, "link": "https://stackoverflow.com/questions/33911533/built-in-global-storage-in-apache-httpd", "title": "Built-in global storage in Apache HTTPD", "body": "<p>I'm developing apache httpd module. I have to deal with some global stats. I found Apache HTTPD provides a per-server, a per-directory and a per-request configuration. Is there any built-in global storage in Apache HTTPD?</p>\n"}, {"tags": ["c", "gcc", "arm"], "comments": [{"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448439985, "post_id": 33911371, "comment_id": 55585151, "body": "Cortex A9 architecture, I guess."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448440065, "post_id": 33911371, "comment_id": 55585194, "body": "@LPs: That would be ARMv7M/R/A. Still the OS is missing."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440172, "post_id": 33911371, "comment_id": 55585254, "body": "Looks like you pass invalid data."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440239, "post_id": 33911371, "comment_id": 55585293, "body": "@Olaf Could be compiled with little endian?"}, {"owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440360, "post_id": 33911371, "comment_id": 55585346, "body": "@Olaf Please look at my test results. You&#39;ll see that I passed the same data for both tests."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448440404, "post_id": 33911371, "comment_id": 55585372, "body": "@LPs: Isn&#39;t that normal now for ARM, too?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440473, "post_id": 33911371, "comment_id": 55585408, "body": "@Olaf Yes, it is, AFAIK. I found <a href=\"http://stackoverflow.com/questions/29166619/differences-between-arm-versions-armv7-only\">THIS</a> post."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448440535, "post_id": 33911371, "comment_id": 55585439, "body": "@LPs: Ok, now I got what you mean! Sorry, My CPU just runs at 1/10th clock today:-)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440592, "post_id": 33911371, "comment_id": 55585473, "body": "@RyanB: You did not show the values you pass to <code>strptime</code>."}, {"owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448440656, "post_id": 33911371, "comment_id": 55585495, "body": "@Olaf Please look into <code>make_time()</code> method."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1448441174, "post_id": 33911371, "comment_id": 55585793, "body": "1) there are no <i>methods</i> in C. 2) Sorry, I meant <code>asctime</code>, i.e. <code>t</code> and the value it generates."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448441422, "post_id": 33911371, "comment_id": 55585951, "body": "I found <a href=\"http://www-01.ibm.com/support/docview.wss?uid=isg1IZ85537\" rel=\"nofollow noreferrer\">THIS</a> Try <code>strptime(d, &quot;%m % d %Y %H:%M:%S&quot;, &amp;t);</code>"}, {"owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448441547, "post_id": 33911371, "comment_id": 55586017, "body": "@LPs I tried with <code>&quot;%m&#47;%d&#47;%Y %H:%M:%S&quot;</code>. Still the same result."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448443133, "post_id": 33911371, "comment_id": 55586947, "body": "I tried your code on my Cortex A9 embedded HW, and it works well. Could be something bugged on your libs or something not activated in your kernel?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448443789, "post_id": 33911371, "comment_id": 55587354, "body": "Is <code>__USE_XOPEN</code> defined for your armv7 sdk?"}, {"owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "reply_to_user": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1448444597, "post_id": 33911371, "comment_id": 55587871, "body": "@LPs __USE_XOPEN is already defined as 1."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1448451588, "post_id": 33911371, "comment_id": 55592409, "body": "@LP: One should not set <code>#define</code>s starting with <code>__</code> directly. Here in this case use <code>#define _XOPEN_SOURCE</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1448456204, "post_id": 33911371, "comment_id": 55595219, "body": "Note: <code>time_t make_time(char *input, char *hs) { ...printf(&quot;Invalid parameter!\\n&quot;);  return;</code> is a problem as <i>nothing</i> is returned.  Suggest <code>return -1;</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448456304, "post_id": 33911371, "comment_id": 55595302, "body": "Minor: <code>char d[17]; strcpy(d, input); strcat(d, hs);</code> is a problem if <code>strlen(hs) &gt; 8</code>."}, {"owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1448510609, "post_id": 33911371, "comment_id": 55621425, "body": "@chux Thanks. 1) I&#39;d edited the code to remove unnecessary part. 2) This is the test program because my main application doesn&#39;t work on armv7 device. Frankly, I just want to know why <code>strptime()</code> produces wrong result &amp; I am barely pass any wrong data to the char d[17]. Hence, no need to check for the data size."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1448510695, "post_id": 33911371, "comment_id": 55621445, "body": "<code>d[16] = &#39;\\0&#39;;</code> is redundant. If you already overflowed the buffer it&#39;s too late. To avoid any chance of buffer overflows influencing this, use <code>snprintf(d, sizeof d, &quot;%s%s&quot;, input, hs);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 9530, "user_id": 5264491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233d38e551f3f0f85437e4ae47353d25?s=128&d=identicon&r=PG&f=1", "display_name": "Ian Abbott", "link": "https://stackoverflow.com/users/5264491/ian-abbott"}, "edited": false, "score": 0, "creation_date": 1448473712, "post_id": 33917528, "comment_id": 55607336, "body": "It&#39;s probably consuming too many digits for each field descriptor."}], "tags": [], "owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "is_accepted": true, "score": 1, "last_activity_date": 1448509943, "last_edit_date": 1448509943, "creation_date": 1448457472, "answer_id": 33917528, "question_id": 33911371, "link": "https://stackoverflow.com/questions/33911371/strptime-produces-wrong-result-on-armv7l-environment/33917528#33917528", "title": "strptime() produces wrong result on armv7l environment", "body": "<p>I finally know why &amp; make it works. The problem is: <code>strptime()</code> seems to have no idea how to parse the following formats:</p>\n\n<pre><code>\"%m%d%Y%H:%M:%S\"\n// or\n\"%m%d%Y %H:%M:%S\"\n// or\n\"%m/%d/%Y %H:%M:%S\"\n</code></pre>\n\n<p>But, if I use this: <code>\"%m-%d-%Y %T\"</code></p>\n\n<pre><code>strptime(d, \"%m-%d-%Y %T\", &amp;t);\n</code></pre>\n\n<p>Then it works, what a shame !</p>\n\n<p>I don't know why those formats are not accepted, since doc didn't say anything about those which are not being fully implemented. Anyway, if anyone knows why, please shed me some light.</p>\n"}], "owner": {"reputation": 1237, "user_id": 2805597, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YDLob.jpg?s=128&g=1", "display_name": "RyanB", "link": "https://stackoverflow.com/users/2805597/ryanb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 33917528, "answer_count": 1, "score": 3, "last_activity_date": 1448510088, "creation_date": 1448439157, "last_edit_date": 1448510088, "question_id": 33911371, "link": "https://stackoverflow.com/questions/33911371/strptime-produces-wrong-result-on-armv7l-environment", "title": "strptime() produces wrong result on armv7l environment", "body": "<p>I have the following code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\ntime_t make_time(char *input, char *hs) {\n    struct tm t;\n\n    char d[17];\n    strcpy(d, input);\n    strcat(d, hs);\n    d[16] = '\\0';\n\n    strptime(d, \"%m%d%Y%H:%M:%S\", &amp;t);\n\n    printf(\"data: %s\", asctime(&amp;t));\n\n    return mktime(&amp;t);\n}\n\nvoid main(int argc, char *argv[]) {\n    char *s = argv[1];\n    char *e = argv[2];\n\n    time_t now = time(NULL);\n    time_t start = make_time(s, \"00:00:00\");\n    time_t end = make_time(e, \"23:59:59\");\n\n    int s1 = difftime(now, start);\n    int s2 = difftime(end, now);\n\n    int ret = 0;\n    if (s1 &gt; 0 &amp;&amp; s2 &gt; 0) {\n        ret = 1;\n    }\n\n    printf(\"Result:\\nInput: %s %s\\nDiff: start: %d; end: %d\\nret: %d\\n\", s, e, s1, s2, ret);\n\n    printf(\"\\n\");\n}\n</code></pre>\n\n<p>2 versions were built. One is for use on debian linux &amp; the other for an arm device.</p>\n\n<p>On debian linux, the result looks right:</p>\n\n<pre><code>devbox@debian:~$ ./a.out 11182015 11302015\ndata: Wed Nov 18 00:00:00 2015\ndata: Mon Nov 30 23:59:59 2015\nResult:\nInput: 11182015 11302015\ndiff: start: 665291; end: 457908\nret: 1\n</code></pre>\n\n<p>But on armv7l env, <code>strptime()</code> produces wrong result:</p>\n\n<pre><code># /tmp/a.out 11182015 11302015\ndata: ??? Jan  8 ??:??:?? 1900\ndata: ??? Jan  8 ??:??:?? 1900\nResult:\nInput: 11182015 11302015\ndiff: start: 1448437831; end: -1448437831\nret: 0\n</code></pre>\n\n<p>Is there something wrong with strptime on armv7l or is it not a standard GNU C method?</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here is the result of <code>uname</code> command:</p>\n\n<pre><code># uname -a\nLinux buildroot 3.1.0-xg3517-1.1 #1 Tue Mar 12 12:54:57 JST 2013 armv7l GNU/Linux\n</code></pre>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1448439188, "post_id": 33911343, "comment_id": 55584708, "body": "Nested functions are non-standard, non-portable and generally a bad idea."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1448439292, "post_id": 33911343, "comment_id": 55584762, "body": "Note that your <code>divide</code> function, despite returning a <code>double</code>, will truncate the division. Use <code>1.0 * a &#47; b</code> or similar instead. That also fixes the zero <code>b</code> case. Your specific problem: you&#39;re attempting to print the addresses of functions; using an incorrect format specifier to do so. Your program behaviour is undefined."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1448439499, "post_id": 33911343, "comment_id": 55584883, "body": "@Bathsheba Important point, I&#39;ll add that to my answer. :)"}], "answers": [{"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1448439863, "post_id": 33911363, "comment_id": 55585078, "body": "Upvoted, but you should also mention that they are using nested functions, which are a compiler extension."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1448439959, "post_id": 33911363, "comment_id": 55585139, "body": "@Bathsheba Right. Let me get a link to that. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1448440058, "last_edit_date": 1495540286, "creation_date": 1448439130, "answer_id": 33911363, "question_id": 33911343, "link": "https://stackoverflow.com/questions/33911343/not-getting-the-expected-result-from-function-call-return-value/33911363#33911363", "title": "Not getting the expected result from function call return value", "body": "<p><strong>TL;DR</strong> -- <code>printf (\"%d\\n\", add);</code> does not print the returned value of the previous <code>add()</code> function call, it tries to print the function address itself. Now, in case of using wrong argument to a format specifier, <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> is the end product.</p>\n\n<hr>\n\n<p>To elaborate, the main problem is the approach. As you have written</p>\n\n<pre><code>    add (num1, num2);\n    printf (\"%d\\n\", add);\n</code></pre>\n\n<p>this will not <em>add</em> <code>num1</code> and <code>num2</code> and print the result of the addition magically. You need to either</p>\n\n<ol>\n<li><p>collect the return value of the function in a variable and print that variable later.</p>\n\n<pre><code>int res = -1;\nres = add (num1, num2);\nprintf (\"%d\\n\", res);\n</code></pre></li>\n<li><p>Otherwise, you have to call the <code>add()</code> function itself as the argument to the format specifier in the format string in <code>printf()</code>, like</p>\n\n<pre><code>printf (\"%d\\n\", add (num1, num2););\n</code></pre></li>\n</ol>\n\n<p>Same goes for the other function calls in all the <code>case</code>s, too.</p>\n\n<p>Also, as mentioned by <a href=\"https://stackoverflow.com/users/2380830/bathsheba\">Mr. Bathseba</a> in the previous <a href=\"https://stackoverflow.com/questions/33911343/not-getting-the-expected-result-from-function-call-return-value/33911363#comment55584762_33911343\">comment</a>, though you're using the return type as <code>double</code> in your division function, the actual division involves the operands of type <code>int</code>, which makes the division to be performed as integer division, then the result will get promoted to <code>double</code>, which probably you don't want. You have to enforce the floating point division.</p>\n\n<p>And finally, regarding usage of nested function, it's a bad idea as this is not standard <code>C</code>. Please <a href=\"https://stackoverflow.com/a/31164686/2173917\">see this answer for more info</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 3021, "user_id": 855378, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/ezkjo.jpg?s=128&g=1", "display_name": "Tio Pepe", "link": "https://stackoverflow.com/users/855378/tio-pepe"}, "is_accepted": false, "score": 1, "last_activity_date": 1448439158, "creation_date": 1448439158, "answer_id": 33911372, "question_id": 33911343, "link": "https://stackoverflow.com/questions/33911343/not-getting-the-expected-result-from-function-call-return-value/33911372#33911372", "title": "Not getting the expected result from function call return value", "body": "<p>You are printing function addresses:</p>\n\n<pre><code>modulo (num1, num2);\nprintf (\"%d\\n\", modulo);\n</code></pre>\n\n<p>You must replace by:</p>\n\n<pre><code>int var = modulo(num1, num2);\nprintf (\"%d\\n\", var);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5599005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1865acdeaa3fd8fc7b3c776b09ebee79?s=128&d=identicon&r=PG&f=1", "display_name": "LukasS", "link": "https://stackoverflow.com/users/5599005/lukass"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1448738387, "creation_date": 1448439020, "last_edit_date": 1448738387, "question_id": 33911343, "link": "https://stackoverflow.com/questions/33911343/not-getting-the-expected-result-from-function-call-return-value", "title": "Not getting the expected result from function call return value", "body": "<p>I'm doing one of the beginner C-programming exercises, building a simple calculator that shows the menu, takes in the user's choice of operation, takes in 2 operands and shows the result. Here's what I have so far:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main(){\n\n    int add (int a,int b) {return a+b;}\n    int substract (int a,int b) {return a-b;}\n    int multiply (int a,int b) {return a*b;}\n    double divide (int a,int b) {return a/b;}\n    int modulo (int a,int b) {return a%b;}\n\n    int num1, num2, choice;\n\n    printf (\"======MENU=======\\n\");\n    printf (\"1. Add\\n\");\n    printf (\"2. Substract\\n\");\n    printf (\"3. Multiply\\n\");\n    printf (\"4. Divide\\n\");\n    printf (\"5. Modulo\\n\");\n\n    printf (\"Please, select your operation and press enter:\\n\");\n    scanf (\"%d\", &amp;choice);\n\n        switch (choice){\n            case 1:\n            printf (\"Please, enter the two operands separated by space and press enter:\\n\");\n            scanf (\"%d %d\", &amp;num1, &amp;num2);\n            add (num1, num2);\n            printf (\"%d\\n\", add);\n            break;\n            case 2:\n            printf (\"Please, enter the two operands separated by space and press enter:\\n\");\n            scanf (\"%d %d\", &amp;num1, &amp;num2);\n            substract (num1, num2);\n            printf (\"%d\\n\", substract);\n            break;\n            case 3:\n            printf (\"Please, enter the two operands separated by space and press enter:\\n\");\n            scanf (\"%d %d\", &amp;num1, &amp;num2);\n            multiply (num1, num2);\n            printf (\"%d\\n\", multiply);\n            break;\n            case 4:\n            printf (\"Please, enter the two operands separated by space and press enter:\\n\");\n            scanf (\"%d %d\", &amp;num1, &amp;num2);\n            divide (num1, num2);\n            printf (\"%lf\\n\", divide);\n            break;\n            case 5:\n            printf (\"Please, enter the two operands separated by space and press enter:\\n\");\n            scanf (\"%d %d\", &amp;num1, &amp;num2);\n            modulo (num1, num2);\n            printf (\"%d\\n\", modulo);\n            default:\n            printf (\"Invalid entry\\n\");\n            break;\n        };\n\n    scanf (\"%d\");\n    return 0;\n}\n</code></pre>\n\n<p>My issues with this code are:</p>\n\n<ol>\n<li>The program doesn't return the correct values. The addition option shows numbers over 4000000. Other operations do the same.</li>\n<li>The program should scan for an integer to be entered once the operation is complete and then end. However, it crashes once the integer has been entered.</li>\n</ol>\n"}, {"tags": ["c", "perl", "ipc", "message-queue"], "comments": [{"owner": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 2, "creation_date": 1448439124, "post_id": 33911255, "comment_id": 55584671, "body": "Please show your Perl and C code; we can&#39;t tell very much without it. What Perl module are you using to provide the <code>struct</code> keyword? Is it <a href=\"http://metacpan.org/module/Class::Struct\" rel=\"nofollow noreferrer\">Class::Struct</a>?"}, {"owner": {"reputation": 319, "user_id": 5524404, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sRuy8.jpg?s=128&g=1", "display_name": "farzane", "link": "https://stackoverflow.com/users/5524404/farzane"}, "reply_to_user": {"reputation": 123805, "user_id": 622310, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8b6d35219e1808520bc238b28161e2e6?s=128&d=identicon&r=PG", "display_name": "Borodin", "link": "https://stackoverflow.com/users/622310/borodin"}, "edited": false, "score": 1, "creation_date": 1448440049, "post_id": 33911255, "comment_id": 55585185, "body": "@Borodin i use class::struct.edit my question and now u can see my code."}], "answers": [{"comments": [{"owner": {"reputation": 319, "user_id": 5524404, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sRuy8.jpg?s=128&g=1", "display_name": "farzane", "link": "https://stackoverflow.com/users/5524404/farzane"}, "edited": false, "score": 0, "creation_date": 1448454221, "post_id": 33914482, "comment_id": 55593906, "body": "Thanks for your usefull answer.i do what u said and change my c and perl code.i send my msg like this  msgsnd($ipc_id,pack(&#39;V V a4000 V&#39;, $type_sent, $buf_size, $buffer, $last_message), 0); can u tell me its true or not pls?"}], "tags": [], "owner": {"reputation": 28131, "user_id": 1956010, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bfdcb4596e9da98cccbf9a0069fdff6c?s=128&d=identicon&r=PG", "display_name": "nwellnhof", "link": "https://stackoverflow.com/users/1956010/nwellnhof"}, "is_accepted": true, "score": 5, "last_activity_date": 1448452896, "last_edit_date": 1448452896, "creation_date": 1448448396, "answer_id": 33914482, "question_id": 33911255, "link": "https://stackoverflow.com/questions/33911255/message-queue-in-perl/33914482#33914482", "title": "Message queue in Perl", "body": "<p>Your code has multiple problems. I won't fix them all for you but I can give you some guideline on how to implement IPC in general.</p>\n\n<p>Reading binary data directly into C structs is extremely fragile. You have to care about byte order, struct padding and the size of types like <code>int</code> or <code>long</code>. Depending on your platform, both of these types could be 32-bit or 64-bit and little or big endian. So first of all, you need an exact specification of the \"on-the-wire protocol\" of your messages. To simplify things, let's use fixed-sized messages:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>mtype: 32-bit unsigned integer, little endian\nbuffer_size: 32-bit unsigned integer, little endian\nbuffer: 4000 bytes\nlast_message: 32-bit unsigned integer, little endian\n</code></pre>\n\n<p>This is just an example. You could use big endian integers as well, like most network protocols do for historical reasons. If you only want to use IPC on a single machine, you could also specify native byte order.</p>\n\n<p>Now the length of a message is fixed to 4012 bytes. To decode such a message in a portable way in C, you should read it into a <code>char</code> array and extract each field separately. You know each field's offset and size.</p>\n\n<p>Encoding such a message in Perl is easy using the <a href=\"http://perldoc.perl.org/functions/pack.html\" rel=\"nofollow\"><code>pack</code></a> function:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>my $msg = pack('V V a4000 V', $mtype, $buffer_size, $buffer, $last);\n</code></pre>\n\n<p>There's no need for <code>Class::Struct</code>. This module does not do what you expect.</p>\n"}], "owner": {"reputation": 319, "user_id": 5524404, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/sRuy8.jpg?s=128&g=1", "display_name": "farzane", "link": "https://stackoverflow.com/users/5524404/farzane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1064, "favorite_count": 1, "accepted_answer_id": 33914482, "answer_count": 1, "score": 3, "last_activity_date": 1448452896, "creation_date": 1448438644, "last_edit_date": 1448448687, "question_id": 33911255, "link": "https://stackoverflow.com/questions/33911255/message-queue-in-perl", "title": "Message queue in Perl", "body": "<p>I want to implement a message queue with Perl. I get data from stdin and send it to the queue.</p>\n\n<p>My message's structure is</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>struct message =&gt; {\n    mtype        =&gt; '$',\n    buffer_size  =&gt; '$',\n    last_message =&gt; '$',\n    buff         =&gt; '$',\n};\n</code></pre>\n\n<p>I have to receive data from the queue with a C program. My C program works well before, but now when I run it to receive data from queue it shows me something like this</p>\n\n<pre><code>age=HASH(0x1daa088) 1936942445      4000        \n</code></pre>\n\n<p>I read chunks of data with a 4000-byte buffer that I print on stdout. But instead of <code>age=HASH(0x1daa088)   1936942445</code> the program should print the size of message received.</p>\n\n<p>What happened here? Is it because the message in C is a structure and in Perl it's a hash?</p>\n\n<p>My C code:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;linux/ipc.h&gt;\n#include &lt;linux/msg.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n\n#define bufsize 4000\n\nstruct mymsgbuf {\n    long    mtype;          /* Message type */\n    int     buffer_size;\n    char    buff[bufsize];\n    int     last_message;\n} msg;\n\nint read_message( int qid, long type, struct mymsgbuf *qbuf ) {\n\n    int result, length;\n\n    /* The length is essentially the size of the structure minus   sizeof(mtype)*/\n\n    length = sizeof(struct mymsgbuf) - sizeof(long);\n\n    if ( (result = msgrcv( qid, qbuf, length, type, MSG_NOERROR)) == -1 ) {\n        return(-1);\n    }\n\n    fprintf(stderr, \"\\t%d\\t\\t%d\\t\\t%d  \\n\", qbuf-&gt;buffer_size, bufsize, qbuf-&gt;last_message);\n\n    write(1,qbuf-&gt;buff,qbuf-&gt;buffer_size);\n\n    return(result);\n}\n\nint open_queue( key_t keyval ) {\n\n    int qid;\n\n    if ( (qid = msgget( keyval, 0660 )) == -1 ) {\n        return(-1);\n    }\n\n    return(qid);\n}\n\nmain() {\n\n    int     qid;\n    key_t   msgkey;\n    msg.last_message = 0;\n\n    /* Generate our IPC key value */\n    msgkey = ftok(\"/home/joobeen/Desktop/learning\", 'm');\n\n    /* Open/create the queue */\n    if (( qid = open_queue( msgkey)) == -1) {\n        perror(\"open_queue\");\n        exit(1);\n    }\n\n    fprintf(stderr, \"byte received:\\tbuffer_size:\\tlast_message:\\n\");\n\n    /* Bombs away! */\n    while (1) {\n\n        if ( (read_message( qid,0, &amp;msg )) == -1 ) {\n            perror(\"receive_message\");\n            exit(1);\n        }\n        if ( msg.last_message == 1 )\n            break;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>My Perl code:</p>\n\n<pre class=\"lang-perl prettyprint-override\"><code>use strict;\nuse warnings;\n\nuse IPC::SysV qw(IPC_PRIVATE IPC_CREAT S_IRUSR S_IWUSR ftok);\nuse IPC::Msg;\nuse Class::Struct;\n\nstruct message =&gt; {\n    mtype        =&gt; '$',\n    buffer_size  =&gt; '$',\n    last_message =&gt; '$',\n    buff         =&gt; '$',\n};\n\nmy $key_in = ftok( \"/home/joobeen/Desktop/learning\", 'm' );\nmy ( $buffer ) = \"\";\nmy $buf_size   = 4000;\nmy $file       = shift @ARGV;\nmy $ifh;\nmy $is_stdin  = 0;\nmy $type_sent = 1;\nmy $last;\n\nif ( defined $file ) {\n    open $ifh, \"&lt;\", $file or die $!;\n}\nelse {\n    $ifh = *STDIN;\n    $is_stdin++;\n}\n\nmy $ipc_id = msgget( $key_in, IPC_CREAT | S_IRUSR | S_IWUSR );\nmy $msg = message-&gt;new(\n    mtype        =&gt; 1,\n    last_message =&gt; 0\n);\n\nprint \"\\tbyte sent\\tbuffer_size\\tlast_message\\n\";\n\nwhile ( &lt;$ifh&gt; ) {\n\n    $last = read( $ifh, $buffer, $buf_size );\n\n    $msg-&gt;buff( $buffer );\n    $msg-&gt;buffer_size( $buf_size );\n\n    if ( $last &lt; $buf_size ) {\n        $msg-&gt;last_message( 1 );\n    }\n\n    msgsnd( $ipc_id, pack( \"l! a*\", $type_sent, $msg ), 0 );\n\n    print \"\\t\", $last, \"\\t\\t\", $buf_size, \"\\t\\t\", $msg-&gt;last_message, \"\\n\";\n\n}\n\nclose $ifh unless $is_stdin;\n</code></pre>\n"}, {"tags": ["c", "runtime", "binary-tree"], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1448470569, "post_id": 33911052, "comment_id": 55605401, "body": "Did you fix your problem?  Did the answer help?"}, {"owner": {"reputation": 79, "user_id": 5532718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-vJq6k3V_LkI/AAAAAAAAAAI/AAAAAAAAABc/AjQ-LEp8ans/photo.jpg?sz=128", "display_name": "sajal garg", "link": "https://stackoverflow.com/users/5532718/sajal-garg"}, "edited": false, "score": 0, "creation_date": 1448691549, "post_id": 33911052, "comment_id": 55693885, "body": "I increased the size but still getting runtime error."}], "tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 0, "last_activity_date": 1448438136, "last_edit_date": 1448438136, "creation_date": 1448437825, "answer_id": 33911052, "question_id": 33910478, "link": "https://stackoverflow.com/questions/33910478/given-a-binary-tree-return-all-root-to-leaf-paths/33911052#33911052", "title": "Given a binary tree, return all root-to-leaf paths", "body": "<p>The <code>temp</code> array and each entry in <code>result</code> should be allocated to a larger size: it must be able to hold <code>height+1</code> integer values in decimal + 2 characters + a final <code>'\\0'</code>.  <code>height+1</code> is way too small.</p>\n\n<p>Assuming 32 bit ints, try this:</p>\n\n<pre><code>int length = (ht + 1) * 12;\nchar *temp = malloc(length);\nfor (i = 0; i &lt;= ht; i++)\n    result[i] = malloc(length);\n</code></pre>\n\n<p>You can reduce the amount of memory used by allocating each path at it is stored into the <code>result</code> array.  For this, remove the <code>for</code> loop above from <code>binaryPaths</code> and modify the line in <code>util</code> that stores the path in <code>result</code>:</p>\n\n<pre><code>if (!root-&gt;left &amp;&amp; !root-&gt;right) {\n    result[(*r)++] = strdup(temp);\n}\n</code></pre>\n\n<p>This is a much better approach since you do not return the actual allocated size but just the number of paths, so extra entries in <code>result</code> would be unreachable and cannot be freed.</p>\n\n<p>And remember to free <code>temp</code> before returning from <code>binaryTreePaths</code>.</p>\n"}], "owner": {"reputation": 79, "user_id": 5532718, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-vJq6k3V_LkI/AAAAAAAAAAI/AAAAAAAAABc/AjQ-LEp8ans/photo.jpg?sz=128", "display_name": "sajal garg", "link": "https://stackoverflow.com/users/5532718/sajal-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456749990, "creation_date": 1448435480, "last_edit_date": 1456749990, "question_id": 33910478, "link": "https://stackoverflow.com/questions/33910478/given-a-binary-tree-return-all-root-to-leaf-paths", "title": "Given a binary tree, return all root-to-leaf paths", "body": "<p>I am trying to solve this question on leetcode in c\n<a href=\"https://leetcode.com/problems/binary-tree-paths/\" rel=\"nofollow\">https://leetcode.com/problems/binary-tree-paths/</a>. \nThe code is working fine for small test cases. But for larger ones it shows a runtime error. I have tried increasing the size of the arrays but to no avail. Please help.</p>\n\n<p>The test case for which program fails is :</p>\n\n<blockquote>\n  <p>[-64,12,18,-4,-53,null,76,null,-51,null,null,-93,3,null,-31,47,null,3,53,-81,33,4,null,-51,-44,-60,11,null,null,null,null,78,null,-35,-64,26,-81,-31,27,60,74,null,null,8,-38,47,12,-24,null,-59,-49,-11,-51,67,null,null,null,null,null,null,null,-67,null,-37,-19,10,-55,72,null,null,null,-70,17,-4,null,null,null,null,null,null,null,3,80,44,-88,-91,null,48,-90,-30,null,null,90,-34,37,null,null,73,-38,-31,-85,-31,-96,null,null,-18,67,34,72,null,-17,-77,null,56,-65,-88,-53,null,null,null,-33,86,null,81,-42,null,null,98,-40,70,-26,24,null,null,null,null,92,72,-27,null,null,null,null,null,null,-67,null,null,null,null,null,null,null,-54,-66,-36,null,-72,null,null,43,null,null,null,-92,-1,-98,null,null,null,null,null,null,null,39,-84,null,null,null,null,null,null,null,null,null,null,null,null,null,-93,null,null,null,98]</p>\n</blockquote>\n\n<pre><code>int height(struct TreeNode* root){\n    if(root == NULL)\n        return 0;\n    if(root-&gt;left == NULL &amp;&amp; root-&gt;right == NULL)\n        return 1;\n    int left = height(root-&gt;left);\n    int right = height(root-&gt;right);\n    return left&gt; right? left+1: right+1;\n} \n\nvoid util(char **result, struct TreeNode* root, int i, int *r, char* temp){\n    i+= sprintf(temp+i, \"%d\", root-&gt;val);\n    printf(\"%d \",*r);\n    if(!root-&gt;left &amp;&amp; !root-&gt;right){\n        sprintf(result[(*r)++],\"%s\", temp);\n    }\n    i+= sprintf(temp+i, \"-&gt;\");\n    if(root-&gt;left){\n        util(result, root-&gt;left, i, r, temp);\n    }\n    if(root-&gt;right){\n        util(result, root-&gt;right, i, r, temp);\n    }\n}\n\nchar** binaryTreePaths(struct TreeNode* root, int* returnSize) {\n    if(root == NULL)\n        return NULL;\n    int ht = height(root);\n    int width = pow(2,ht-1);\n    char **result = malloc((width+1)* sizeof(char *));\n    int i, r=0;\n    char *temp = malloc((height+1)* sizeof(char));\n    for(i=0; i&lt;=ht; i++)\n        result[i] = malloc((height+1) * sizeof(char));\n    util(result, root, 0, &amp;r, temp);\n    *returnSize = r;\n    return result;\n}\n</code></pre>\n"}, {"tags": ["c", "bitarray"], "comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448435533, "post_id": 33910399, "comment_id": 55582928, "body": "&quot;[T]he <i>first</i> bit in the input array can end up at any position within the unsigned long in the output array&quot;? I&#39;m not sure I understand. Wouldn&#39;t the first bit be at the first position in the first long? Don&#39;t you mean the <i>last</i> bit?"}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448435737, "post_id": 33910399, "comment_id": 55583005, "body": "If the number of bits isn&#39;t a multiple of sizeof(long), what are the extra bits in the last long used for? Are they garbage (and can therefore be inverted), or do they have to be preserved as is?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1448435879, "post_id": 33910399, "comment_id": 55583066, "body": "I think the issue is that if there are 57 bits in the bit array, the bit number 0 needs to swap with bit number 56.  However, before we can do anything, we need to know whether bit 0 of the array is stored in the MSB or LSB of element 0 of the array (or, if element 0 isn&#39;t where bit 0 is, we need to understand where bit 0 is stored)."}, {"owner": {"reputation": 277, "user_id": 3117761, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5afe450bd7ce5e0e855eb37cf29aca50?s=128&d=identicon&r=PG&f=1", "display_name": "Eques", "link": "https://stackoverflow.com/users/3117761/eques"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 0, "creation_date": 1448435902, "post_id": 33910399, "comment_id": 55583074, "body": "@Thomas Padron-McCarthy, I&#39;m sorry for bad description. Let&#39;s take an example: a long is 32 bits and we need to store, say, 49 bits. That means we need an array of 2 longs (the last 15 bits of the second long are wasted). After we reverse the bits, the first bit (position 0 in array[0]) will become the last (position 16 in array[0])."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1448435930, "post_id": 33910399, "comment_id": 55583089, "body": "@Jonathan and Eques: Aha, it&#39;s about <i>reversing the order</i>! I thought it was just inverting each bit. Sorry for the misunderstanding."}, {"owner": {"reputation": 277, "user_id": 3117761, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5afe450bd7ce5e0e855eb37cf29aca50?s=128&d=identicon&r=PG&f=1", "display_name": "Eques", "link": "https://stackoverflow.com/users/3117761/eques"}, "edited": false, "score": 0, "creation_date": 1448435996, "post_id": 33910399, "comment_id": 55583126, "body": "Yes, it&#39;s about reversing the order. I will edit the question to make it clear."}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 4, "creation_date": 1448436295, "post_id": 33910399, "comment_id": 55583279, "body": "Why not just add an extra two fields to the structure to define the direction and number of bits to skip? Then create the procedures to access it to depend on the direction?"}, {"owner": {"reputation": 277, "user_id": 3117761, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5afe450bd7ce5e0e855eb37cf29aca50?s=128&d=identicon&r=PG&f=1", "display_name": "Eques", "link": "https://stackoverflow.com/users/3117761/eques"}, "reply_to_user": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1448436598, "post_id": 33910399, "comment_id": 55583444, "body": "@Ed Heal, because that means that all other algorithms (bitwise comparison, logical operations etc) will have to be redesigned."}, {"owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "edited": false, "score": 4, "creation_date": 1448450798, "post_id": 33910399, "comment_id": 55591917, "body": "Do you have control over the definition of this structure? And if you do, why store bits in <code>unsigned long *</code>, not in <code>uint8_t *</code>. That would factor out  the platform-dependent issues."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "reply_to_user": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "edited": false, "score": 1, "creation_date": 1448547147, "post_id": 33910399, "comment_id": 55640571, "body": "@DmitryGrigoryev: yes but it would probably slow down other more common operations on bit slices such as CLR, SET, OR, AND, SET, XOR... as proper alignment for the <code>array</code> member could no longer be assumed."}, {"owner": {"reputation": 2815, "user_id": 4350586, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/IvPNx.png?s=128&g=1", "display_name": "Dmitry Grigoryev", "link": "https://stackoverflow.com/users/4350586/dmitry-grigoryev"}, "edited": false, "score": 1, "creation_date": 1448553497, "post_id": 33910399, "comment_id": 55644551, "body": "Well you could pick <code>uint32_t *</code> for performance, but then you&#39;ll have to deal with little vs big endianness. Performance and portability don&#39;t really go together."}, {"owner": {"reputation": 277, "user_id": 3117761, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5afe450bd7ce5e0e855eb37cf29aca50?s=128&d=identicon&r=PG&f=1", "display_name": "Eques", "link": "https://stackoverflow.com/users/3117761/eques"}, "edited": false, "score": 0, "creation_date": 1448606435, "post_id": 33910399, "comment_id": 55661334, "body": "&lt;why store bits in unsigned long &gt; Because in terms of &quot;bits per CPU operation&quot; this is probably the fastest choice."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 3, "creation_date": 1448436628, "post_id": 33910531, "comment_id": 55583461, "body": "The variable names &quot;input&quot;, &quot;output&quot; and &quot;size&quot;/&quot;count&quot; would make more sense. Don&#39;t just copy/paste solutions from that site, it is notorious for poor code readability."}, {"owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448437635, "post_id": 33910531, "comment_id": 55583931, "body": "Thanks for the comment; basically I just did copy &amp; paste in order not to introduce errors. However, perhaps a selfmade implementation would have been better."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1448439070, "post_id": 33910531, "comment_id": 55584642, "body": "The final reversal is not so easy to do."}], "tags": [], "owner": {"reputation": 16785, "user_id": 3355476, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/YdMWy.jpg?s=128&g=1", "display_name": "Codor", "link": "https://stackoverflow.com/users/3355476/codor"}, "is_accepted": false, "score": 2, "last_activity_date": 1448435644, "creation_date": 1448435644, "answer_id": 33910531, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33910531#33910531", "title": "Reverse the order of bits in a bit array", "body": "<p>In a collection of related topics which can be found <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#BitReverseObvious\" rel=\"nofollow\">here</a>, the bits of an individual array entry could be reversed as follows.</p>\n\n<pre><code>unsigned int v;     // input bits to be reversed\nunsigned int r = v; // r will be reversed bits of v; first get LSB of v\nint s = sizeof(v) * CHAR_BIT - 1; // extra shift needed at end\n\nfor (v &gt;&gt;= 1; v; v &gt;&gt;= 1)\n{   \n  r &lt;&lt;= 1;\n  r |= v &amp; 1;\n  s--;\n}\nr &lt;&lt;= s; // shift when v's highest bits are zero\n</code></pre>\n\n<p>The reversal of the entire array could be done afterwards by rearranging the individual positions.</p>\n"}, {"comments": [{"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448435866, "post_id": 33910543, "comment_id": 55583059, "body": "The question seems be a bit concerned with efficiency (&quot;anything better than bruteforce&quot; etc), and would this lookup table really be as efficient as bit operations on longs? I don&#39;t really know one way or the other, but until I see measurements I suspect that this could be very much slower."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 2, "creation_date": 1448436036, "post_id": 33910543, "comment_id": 55583141, "body": "Lookup in a data structure, that at best is in the highest-level cache, compared to bit operations in a register."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448436040, "post_id": 33910543, "comment_id": 55583143, "body": "@ThomasPadron-McCarthy: Depends on the target, of course. On an 8 bit CPU the table will be much faster. Because thes often don&#39;t have single-cycle shifters for arbitrary counts and work on 8 bit data anyway. For 16 bit it depends. For 32 bit it will likely be slower, much slower if the CPU has bit-reverse instructions."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448436104, "post_id": 33910543, "comment_id": 55583179, "body": "@Olaf: Yes, probably very architecture-dependent. My mind always seems to be stuck in modern Intel desktop processors."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448436201, "post_id": 33910543, "comment_id": 55583228, "body": "@ThomasPadron-McCarthy: There are still some other &quot;modern&quot; processors. x86 actually is a minority."}, {"owner": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1448436286, "post_id": 33910543, "comment_id": 55583275, "body": "@Olaf: Not in my desktop computer... But yeah, I need to get out more."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448436574, "post_id": 33910543, "comment_id": 55583429, "body": "@ThomasPadron-McCarthy: if you provide an alternative, we can benchmark comparatively."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 25589, "user_id": 15727, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FFivc.jpg?s=128&g=1", "display_name": "Thomas Padron-McCarthy", "link": "https://stackoverflow.com/users/15727/thomas-padron-mccarthy"}, "edited": false, "score": 1, "creation_date": 1448436587, "post_id": 33910543, "comment_id": 55583434, "body": "@ThomasPadron-McCarthy: If you have a recent x86 CPU chances are you have an ARM core inside. But just look at your smartphone, router, washing machine,  etc."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448436731, "post_id": 33910543, "comment_id": 55583524, "body": "@Olaf: ARM inside Intel ??"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1448436972, "post_id": 33910543, "comment_id": 55583631, "body": "@YvesDaoust: I just wrote x86; not Intel. AMD uses an ARM code for the security system, not sure if Intel also uses ARM cores, I had to research on that, but it is well possible, as they have the licenses."}, {"owner": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 1, "creation_date": 1448462783, "post_id": 33910543, "comment_id": 55599892, "body": "Regardless of benchmarks it&#39;s clear to say that bitwise operations will be faster than lookups. A shift operation is 1 or 2 ops whereas lookup might be &gt; 30."}, {"owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 1, "creation_date": 1448468184, "post_id": 33910543, "comment_id": 55603796, "body": "@erip: could be even more if the data is input from the keyboard."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "reply_to_user": {"reputation": 13883, "user_id": 2883245, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NPpPG.jpg?s=128&g=1", "display_name": "erip", "link": "https://stackoverflow.com/users/2883245/erip"}, "edited": false, "score": 2, "creation_date": 1448470069, "post_id": 33910543, "comment_id": 55605078, "body": "@erip: 30 cycles sounds very pessimistic for latency to L1 cache. And even then the latency might be irrelevant; an optimized loop will likely be limited primarily by bandwidth. (or maybe even by compute)"}], "tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 8, "last_activity_date": 1448435885, "last_edit_date": 1448435885, "creation_date": 1448435700, "answer_id": 33910543, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33910543#33910543", "title": "Reverse the order of bits in a bit array", "body": "<p>My favorite solution is to fill a lookup-table that does bit-reversal on a single byte (hence 256 byte entries).</p>\n\n<p>You apply the table to 1 to 4 bytes of the input operand, with a swap. If the size isn't a multiple of 8, you will need to adjust by a final right shift.</p>\n\n<p>This scales well to larger integers.</p>\n\n<p>Example:</p>\n\n<pre><code>11 10010011 00001010 -&gt; 01010000 11001001 11000000 -&gt; 01 01000011 00100111\n</code></pre>\n\n<p>To split the number into bytes portably, you need to use bitwise masking/shifts; mapping of a struct or array of bytes onto the integer can make it more efficient.</p>\n\n<p>For brute performance, you can think of mapping up to 16 bits at a time, but this doesn't look quite reasonable.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1448439528, "last_edit_date": 1448439528, "creation_date": 1448438858, "answer_id": 33911306, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33911306#33911306", "title": "Reverse the order of bits in a bit array", "body": "<p>You must define what is the order of bits in an <code>unsigned long</code>.  You might assume that bit n is corresponds to <code>array[x] &amp; (1 &lt;&lt; n)</code> but this needs to be specified.  If so, you need to handle the byte ordering (little or big endian) if you are going to use access the array as bytes instead of unsigned long.</p>\n\n<p>I would definitely implement brute force first and measure whether the speed is an issue.  No need to waste time trying to optimize this if it is not used a lot on large arrays.  An optimized version can be tricky to implement correctly.  If you end up trying anyway, the brute force version can be used to verify correctness on test values and benchmark the speed of the <em>optimized</em> version.</p>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448465995, "post_id": 33911946, "comment_id": 55602241, "body": "Why not use an <code>uint8_t*</code> for the array instead?"}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448525908, "post_id": 33911946, "comment_id": 55627082, "body": "@Lundin OP stated that size is not multiples of 8 either, so I don&#39;t think that helps. In fact, I think the best data type for array element should be chosen depending on the size of the CPU register on target architecture."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448527093, "post_id": 33911946, "comment_id": 55627756, "body": "You can still access the data by chunks of &quot;CPU register size&quot; even if the type is <code>uint8_t</code>. You can&#39;t do the opposite though, so on small CPUs the unsigned long will be very burdensome."}, {"owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448528526, "post_id": 33911946, "comment_id": 55628616, "body": "@Lundin True, I don&#39;t think that unsigned long is an optimal data type. But with <code>uint8_t</code> on 32-bit CPU (for example) you&#39;d have to take care of the alignment manually and treat last element specially if array size is not divisible by four, if you wanted to work on 4 byte chunks."}], "tags": [], "owner": {"reputation": 13762, "user_id": 694733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0a3de8cd40d9ffb86cc1fed0c8cf2e19?s=128&d=identicon&r=PG", "display_name": "user694733", "link": "https://stackoverflow.com/users/694733/user694733"}, "is_accepted": false, "score": 2, "last_activity_date": 1448441646, "last_edit_date": 1448441646, "creation_date": 1448441241, "answer_id": 33911946, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33911946#33911946", "title": "Reverse the order of bits in a bit array", "body": "<p>The fact that the size is not multiple of <code>sizeof(long)</code> is the hardest part of the problem. This can result in a lot of bit shifting.</p>\n\n<p>But, you don't have to do that if you can introduce new struct member:</p>\n\n<pre><code>struct bit_array\n{\n    int size; /* nr of bits */\n    int offset; /* First bit position */\n    unsigned long *array; /* the container that stores bits */\n}\n</code></pre>\n\n<p>Offset would tell you how many bits to ignore at the beginning of the array. </p>\n\n<p>Then you only only have to do following steps:</p>\n\n<ol>\n<li>Reverse array elements.</li>\n<li>Swap bits of each element. There are many hacks for in the other answers, but your compiler might also provide intrisic functions to do it in fewer instructions (like RBIT instruction on some ARM cores).</li>\n<li>Calculate new starting offset. This is equal to unused bits the last element had.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 7193, "user_id": 1856325, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ZO1bm.png?s=128&g=1", "display_name": "FreeNickname", "link": "https://stackoverflow.com/users/1856325/freenickname"}, "edited": false, "score": 1, "creation_date": 1448460319, "post_id": 33916176, "comment_id": 55598125, "body": "Nice one. But the size of <code>unsigned long</code> can vary."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448466484, "post_id": 33916176, "comment_id": 55602613, "body": "This code is not portable and has great potential for subtle integer type bugs. You need to change unsigned long to <code>uint64_t</code> and also ensure that the type of all of the integer literals is <code>uint64_t</code> by using <code>const uint64_t</code> variables, instead of using magic numbers. For example, the literal <code>0x00000000FFFFFFFF</code> is a 32 bit unsigned int, not a 64 bit signed int as you might have assumed, because adding lots of zeroes in the beginning of a literal will not make it a 64 bit type. &gt;"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1448466529, "post_id": 33916176, "comment_id": 55602650, "body": "Now imagine if <code>int</code> is 64 bit on the given system: suddenly there will integer promotion of this literal and suddenly it is now a signed type. Why do use signed literals in the first place? You almost never want signed types when doing &quot;bit fiddling&quot; operations. The algorithm proposed here is pretty good, but C code like this is a ticking bomb."}], "tags": [], "owner": {"reputation": 2360, "user_id": 4819357, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-M-St3cpKcOs/AAAAAAAAAAI/AAAAAAAAAIg/HqtjEfI3EFE/photo.jpg?sz=128", "display_name": "AndreyS Scherbakov", "link": "https://stackoverflow.com/users/4819357/andreys-scherbakov"}, "is_accepted": false, "score": 8, "last_activity_date": 1448527553, "last_edit_date": 1448527553, "creation_date": 1448453337, "answer_id": 33916176, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33916176#33916176", "title": "Reverse the order of bits in a bit array", "body": "<p>I like the idea of lookup table. Still it's also a typical task for log(n) group bit tricks that may be very fast. Like:</p>\n\n<pre><code>unsigned long reverseOne(unsigned long x) {\n  x = ((x &amp; 0xFFFFFFFF00000000) &gt;&gt; 32) | ((x &amp; 0x00000000FFFFFFFF) &lt;&lt; 32);\n  x = ((x &amp; 0xFFFF0000FFFF0000) &gt;&gt; 16) | ((x &amp; 0x0000FFFF0000FFFF) &lt;&lt; 16);\n  x = ((x &amp; 0xFF00FF00FF00FF00) &gt;&gt; 8)  | ((x &amp; 0x00FF00FF00FF00FF) &lt;&lt; 8);\n  x = ((x &amp; 0xF0F0F0F0F0F0F0F0) &gt;&gt; 4)  | ((x &amp; 0x0F0F0F0F0F0F0F0F) &lt;&lt; 4);\n  x = ((x &amp; 0xCCCCCCCCCCCCCCCC) &gt;&gt; 2)  | ((x &amp; 0x3333333333333333) &lt;&lt; 2);\n  x = ((x &amp; 0xAAAAAAAAAAAAAAAA) &gt;&gt; 1)  | ((x &amp; 0x5555555555555555) &lt;&lt; 1);\n  return x;\n}\n</code></pre>\n\n<p>The underlying idea is that when we aim to reverse the order of some sequence we may swap the head and tail halves of this sequence and then separately reverse each of halves (which is done here by applying the same procedure recursively to each half).</p>\n\n<p>Here is a more portable version supporting <code>unsigned long</code> widths of 4,8,16 or 32 bytes.</p>\n\n<pre><code>#include &lt;limits.h&gt;\n\n#define ones32 0xFFFFFFFFUL\n#if (ULONG_MAX &gt;&gt; 128)\n#define fill32(x) (x|(x&lt;&lt;32)|(x&lt;&lt;64)|(x&lt;&lt;96)|(x&lt;&lt;128)|(x&lt;&lt;160)|(x&lt;&lt;192)|(x&lt;&lt;224))\n#define patt128 (ones32|(ones32&lt;&lt;32)|(ones32&lt;&lt;64) |(ones32&lt;&lt;96))\n#define patt64  (ones32|(ones32&lt;&lt;32)|(ones32&lt;&lt;128)|(ones32&lt;&lt;160))\n#define patt32  (ones32|(ones32&lt;&lt;64)|(ones32&lt;&lt;128)|(ones32&lt;&lt;192))\n#else\n#if (ULONG_MAX &gt;&gt; 64)\n#define fill32(x) (x|(x&lt;&lt;32)|(x&lt;&lt;64)|(x&lt;&lt;96))\n#define patt64  (ones32|(ones32&lt;&lt;32))\n#define patt32  (ones32|(ones32&lt;&lt;64))\n#else\n#if (ULONG_MAX &gt;&gt; 32)\n#define fill32(x) (x|(x&lt;&lt;32))\n#define patt32  (ones32)\n#else\n#define fill32(x) (x)\n#endif\n#endif\n#endif\n\nunsigned long reverseOne(unsigned long x) {\n#if (ULONG_MAX &gt;&gt; 32)\n#if (ULONG_MAX &gt;&gt; 64)\n#if (ULONG_MAX &gt;&gt; 128)\n  x = ((x &amp; ~patt128) &gt;&gt; 128) | ((x &amp; patt128) &lt;&lt; 128);\n#endif\n  x = ((x &amp; ~patt64) &gt;&gt; 64) | ((x &amp; patt64) &lt;&lt; 64);\n#endif\n  x = ((x &amp; ~patt32) &gt;&gt; 32) | ((x &amp; patt32) &lt;&lt; 32);\n#endif\n  x = ((x &amp; fill32(0xffff0000UL)) &gt;&gt; 16) | ((x &amp; fill32(0x0000ffffUL)) &lt;&lt; 16);\n  x = ((x &amp; fill32(0xff00ff00UL)) &gt;&gt; 8)  | ((x &amp; fill32(0x00ff00ffUL)) &lt;&lt; 8);\n  x = ((x &amp; fill32(0xf0f0f0f0UL)) &gt;&gt; 4)  | ((x &amp; fill32(0x0f0f0f0fUL)) &lt;&lt; 4);\n  x = ((x &amp; fill32(0xccccccccUL)) &gt;&gt; 2)  | ((x &amp; fill32(0x33333333UL)) &lt;&lt; 2);\n  x = ((x &amp; fill32(0xaaaaaaaaUL)) &gt;&gt; 1)  | ((x &amp; fill32(0x55555555UL)) &lt;&lt; 1);\n  return x;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 3324271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a825874654d3057c20cd43048106573?s=128&d=identicon&r=PG&f=1", "display_name": "Olaf Seibert", "link": "https://stackoverflow.com/users/3324271/olaf-seibert"}, "is_accepted": false, "score": 2, "last_activity_date": 1448462666, "last_edit_date": 1448462666, "creation_date": 1448462265, "answer_id": 33919280, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array/33919280#33919280", "title": "Reverse the order of bits in a bit array", "body": "<p>I would split the problem into two parts.</p>\n\n<p>First, I would ignore the fact that the number of used bits is not a multiple of 32. I would use one of the given methods to swap around the whole array like that.</p>\n\n<p>pseudocode:</p>\n\n<pre><code>for half the longs in the array:\n    take the first longword;\n    take the last longword;\n    swap the bits in the first longword\n    swap the bits in the last longword;\n\n    store the swapped first longword into the last location;\n    store the swapped last longword into the first location;\n</code></pre>\n\n<p>and then fix up the fact that the first few bits (call than number <code>n</code>) are actually garbage bits from the end of the longs:</p>\n\n<pre><code>for all of the longs in the array:\n    split the value in the leftmost n bits and the rest;\n    store the leftmost n bits into the righthand part of the previous word;\n    shift the rest bits to the left over n positions (making the rightmost n bits zero);\n    store them back;\n</code></pre>\n\n<p>You could try to fold that into one pass over the whole array of course. Something like this:</p>\n\n<pre><code>for half the longs in the array:\n    take the first longword;\n    take the last longword;\n    swap the bits in the first longword\n    swap the bits in the last longword;\n\n    split both value in the leftmost n bits and the rest;\n\n    for the new first longword:\n        store the leftmost n bits into the righthand side of the previous word;\n        store the remaining bits into the first longword, shifted left;\n\n    for the new last longword:\n        remember the leftmost n bits for the next iteration;\n        store the remembered leftmost n bits, combined with the remaining bits, into the last longword;\n\n    store the swapped first longword into the last location;\n    store the swapped last longword into the first location;\n</code></pre>\n\n<p>I'm abstracting from the edge cases here (first and last longword), and you may need to reverse the shifting direction depending on how the bits are ordered inside each longword.</p>\n"}], "owner": {"reputation": 277, "user_id": 3117761, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/5afe450bd7ce5e0e855eb37cf29aca50?s=128&d=identicon&r=PG&f=1", "display_name": "Eques", "link": "https://stackoverflow.com/users/3117761/eques"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3594, "favorite_count": 3, "answer_count": 6, "score": 16, "last_activity_date": 1448527553, "creation_date": 1448435164, "last_edit_date": 1448436036, "question_id": 33910399, "link": "https://stackoverflow.com/questions/33910399/reverse-the-order-of-bits-in-a-bit-array", "title": "Reverse the order of bits in a bit array", "body": "<p>I have a long sequence of bits stored in an array of unsigned long integers, like this</p>\n\n<pre><code>struct bit_array\n{\n    int size; /* nr of bits */\n    unsigned long *array; /* the container that stores bits */\n}\n</code></pre>\n\n<p>I am trying to design an algorithm to reverse the order of bits in *array. Problems:</p>\n\n<ul>\n<li><code>size</code> can be anything, i.e. not necessarily a multiple of 8 or 32 etc, so the first bit in the input array can end up at any position within the unsigned long in the output array;</li>\n<li>the algorithm should be platform-independent, i.e. work for any <code>sizeof(unsigned long)</code>.</li>\n</ul>\n\n<p>Code, pseudocode, algo description etc. -- anything better than bruteforce (\"bit by bit\") approach is welcome.</p>\n"}, {"tags": ["c", "coap"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 2, "creation_date": 1448434908, "post_id": 33910252, "comment_id": 55582629, "body": "<code>unsigned char *data;</code> \u2013 where do you expect <code>data</code> to point to if you didn&#39;t initialize it?"}, {"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 1, "creation_date": 1448434934, "post_id": 33910252, "comment_id": 55582647, "body": "You need to allocate some memory for <code>data</code> - <code>malloc</code> perhaps?"}, {"owner": {"reputation": 13, "user_id": 4845646, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ccb9aac1b604d83a99a34625848b7e83?s=128&d=identicon&r=PG&f=1", "display_name": "Zim", "link": "https://stackoverflow.com/users/4845646/zim"}, "reply_to_user": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 0, "creation_date": 1448435206, "post_id": 33910252, "comment_id": 55582772, "body": "@TheParamagneticCroissant already did, forgot to mention here :   data = (unsigned char*)malloc(sizeof(unsigned char)*128);     memset (data, &#39;\\0&#39;, sizeof(data));"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1448436464, "post_id": 33910252, "comment_id": 55583367, "body": "@Zim can you guarantee that the server isn&#39;t sending you this garbage?"}, {"owner": {"reputation": 13, "user_id": 4845646, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ccb9aac1b604d83a99a34625848b7e83?s=128&d=identicon&r=PG&f=1", "display_name": "Zim", "link": "https://stackoverflow.com/users/4845646/zim"}, "reply_to_user": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1448439260, "post_id": 33910252, "comment_id": 55584739, "body": "@Magisch, that is where I am confused too. The data WIreshark captured shows sdsdsdsdasasasast\\201\\005 although in leshan it displayed that as sdsdsdsdasasasast\ufffd hence \\201\\005 which was not part of payload is added and showed in leshan as \ufffd"}, {"owner": {"reputation": 7061, "user_id": 5389107, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/769c1f4253eca239d400ce3226d801b4?s=128&d=identicon&r=PG&f=1", "display_name": "user308386", "link": "https://stackoverflow.com/users/5389107/user308386"}, "edited": false, "score": 0, "creation_date": 1448439330, "post_id": 33910252, "comment_id": 55584783, "body": "@Zim In that case your problem is most likely with the server code sending stuff rather than with what you posted. Ignoring the memory allocation issues (which you commented you fixed) your problem is then outside of the scope of the code you posted."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4845646, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ccb9aac1b604d83a99a34625848b7e83?s=128&d=identicon&r=PG&f=1", "display_name": "Zim", "link": "https://stackoverflow.com/users/4845646/zim"}, "edited": false, "score": 0, "creation_date": 1448435385, "post_id": 33910383, "comment_id": 55582862, "body": "already did but the result is same."}], "tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1448435651, "last_edit_date": 1448435651, "creation_date": 1448435103, "answer_id": 33910383, "question_id": 33910252, "link": "https://stackoverflow.com/questions/33910252/c-pointer-issue-with-random-garbage/33910383#33910383", "title": "c pointer issue with random garbage", "body": "<p>In your code,</p>\n\n<pre><code>memset (data, '\\0', sizeof(data));\n</code></pre>\n\n<p>where <code>data</code> does not point to any valid memory, actually invokes undefined behavior.</p>\n\n<p>Before <em>copying into</em> (or even reading from) a memory location pointed by a pointer, you need to make sure that the pointer points to a valid memory location allocated for that particular process.</p>\n\n<p>Either use a compiler allocated memory, like</p>\n\n<pre><code> unsigned char data[256] = {0};\n</code></pre>\n\n<p>or use <code>malloc()</code> or family to get the memory allocated to the pointer. Don't forget to free it afterwards,tho.</p>\n"}], "owner": {"reputation": 13, "user_id": 4845646, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ccb9aac1b604d83a99a34625848b7e83?s=128&d=identicon&r=PG&f=1", "display_name": "Zim", "link": "https://stackoverflow.com/users/4845646/zim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "closed_date": 1448442473, "answer_count": 1, "score": -4, "last_activity_date": 1448435651, "creation_date": 1448434623, "question_id": 33910252, "link": "https://stackoverflow.com/questions/33910252/c-pointer-issue-with-random-garbage", "closed_reason": "Not suitable for this site", "title": "c pointer issue with random garbage", "body": "<p>I had written one coap client with libcoap to communicate with leshan server\nThe issue is whenever I did a PUT request, first time it is correct, but if I do a PUT request from leshan, say 12345678 is the payload it adds a garbled value after that.\nAlso if my next payload is longer, it behaves correctly and no garbled value is padded.\nif I again reduce payload size, the older size retains and garbled value padded to payload.\ncode snippet of coap client:</p>\n\n<pre><code>  unsigned char *data;\n  memset (data, '\\0', sizeof(data));\n  coap_get_data(request, &amp;size, &amp;data);\n</code></pre>\n\n<p><code>coap_get_data</code> getting data from server</p>\n\n<p>I entered payload in leshan server as <code>sdsdsdsdasasasast</code></p>\n\n<p>But the client received  : <code>sdsdsdsdasasasast\ufffd</code></p>\n\n<p>And wireshark says : <code>sdsdsdsdasasasast\\201\\005</code></p>\n\n<p>I always did a memset before inserting data into arrays, still I don't know where it got such things padded  after payload</p>\n"}, {"tags": ["c", "kernel"], "comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1448435806, "post_id": 33910158, "comment_id": 55583035, "body": "Linux kernel programmers are too &quot;special&quot; to write <code>b != 0</code>, is all."}], "answers": [{"tags": [], "owner": {"reputation": 7481, "user_id": 2527795, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8359590ce3a66e5c58407ae5c83c9bbe?s=128&d=identicon&r=PG&f=1", "display_name": "vll", "link": "https://stackoverflow.com/users/2527795/vll"}, "is_accepted": false, "score": 4, "last_activity_date": 1448434428, "creation_date": 1448434428, "answer_id": 33910190, "question_id": 33910158, "link": "https://stackoverflow.com/questions/33910158/operator-in-kernel-c/33910190#33910190", "title": "Operator !! in Kernel C", "body": "<p>This is operator <code>!</code>, which is used twice in row. If <code>b</code> is non-zero, <code>a</code> gets value 1, and if <code>b</code> is zero, <code>a</code> gets value 0.</p>\n"}], "owner": {"reputation": 809, "user_id": 2031060, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/74b9198b642d443dcfa94112a3777a90?s=128&d=identicon&r=PG", "display_name": "darthvading", "link": "https://stackoverflow.com/users/2031060/darthvading"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "closed_date": 1448434736, "answer_count": 1, "score": 0, "last_activity_date": 1448434428, "creation_date": 1448434317, "question_id": 33910158, "link": "https://stackoverflow.com/questions/33910158/operator-in-kernel-c", "closed_reason": "Duplicate", "title": "Operator !! in Kernel C", "body": "<p>I encountered the below code in C program.</p>\n\n<pre><code>int a = !! b ;\n</code></pre>\n\n<p>variable b is also an integer.\nInitially I thought it is 'not' operator with a typo :)</p>\n\n<p>Can someone help in explaining this?</p>\n"}]