[{"tags": ["c", "variadic-functions"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1531958086, "post_id": 51412451, "comment_id": 89796587, "body": "You can&#39;t do it with <code>sscanf()</code>. Use a <code>strtok()</code> loop to parse it."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1531958107, "post_id": 51412451, "comment_id": 89796588, "body": "Did you consider using sscanf in a loop?"}, {"owner": {"reputation": 107137, "user_id": 364696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7eBCp.jpg?s=128&g=1", "display_name": "ShadowRanger", "link": "https://stackoverflow.com/users/364696/shadowranger"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531959820, "post_id": 51412451, "comment_id": 89796955, "body": "As @Yunnosch notes, you can loop with <code>sscanf</code>. That said @Barmar&#39;s suggestion to use <code>strtok</code> (or <code>strtok_r</code> if available) is probably the best solution here."}], "answers": [{"tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": false, "score": 0, "last_activity_date": 1531959527, "creation_date": 1531959527, "answer_id": 51412634, "question_id": 51412451, "link": "https://stackoverflow.com/questions/51412451/how-to-pass-a-variable-number-of-arguments-to-sscanf/51412634#51412634", "title": "How to pass a variable number of arguments to sscanf?", "body": "<p>If you know there is an upper limit on the count of integers then just always <code>sscanf()</code> for that many arguments.  The return value from <code>sscanf()</code> will tell you the count that were successfully scanned, which means you don't need to procedurally generate the format string.</p>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 8834967, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xrf_YCVb2Vw/AAAAAAAAAAI/AAAAAAAAAAc/K52j8i_sYWw/photo.jpg?sz=128", "display_name": "Joy Allen", "link": "https://stackoverflow.com/users/8834967/joy-allen"}, "is_accepted": false, "score": 0, "last_activity_date": 1531967943, "creation_date": 1531967943, "answer_id": 51413547, "question_id": 51412451, "link": "https://stackoverflow.com/questions/51412451/how-to-pass-a-variable-number-of-arguments-to-sscanf/51413547#51413547", "title": "How to pass a variable number of arguments to sscanf?", "body": "<p>How about using MACRO?</p>\n\n<p>Define a <code>MACRO</code> like:</p>\n\n<pre><code>#define your_func(str, format, args...) \\\n    // do your own job \\\n    sscanf(str, format, ##args); \\\n    // do your own joy\n</code></pre>\n\n<p>Then just use it like a <code>FUNCTION</code>:</p>\n\n<pre><code>your_func(\"1.2\", \"%d.%d\", &amp;a, &amp;b);\nyour_func(\"1.2.3\", \"%d.%d.%d\", &amp;a, &amp;b, &amp;c);\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 2356635, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/a5797203c9697ebe2570a58b5bdc2b1d?s=128&d=identicon&r=PG", "display_name": "Sam D20", "link": "https://stackoverflow.com/users/2356635/sam-d20"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 954, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531967943, "creation_date": 1531957916, "last_edit_date": 1531958147, "question_id": 51412451, "link": "https://stackoverflow.com/questions/51412451/how-to-pass-a-variable-number-of-arguments-to-sscanf", "title": "How to pass a variable number of arguments to sscanf?", "body": "<p>I need to call the following function in my code that can be used to extract integers from a specified string format: </p>\n\n<pre><code>int sscanf(const char *str, const char *format, ...)\n</code></pre>\n\n<p>I need to be able to pass in a period-delimited string of numbers (i.e. 1.20.3.4) to the function, so my format string will be in the form <code>%d.%d.%d.%d</code>. </p>\n\n<p>The issue is, the numbers I pass to the function during runtime will have a random amount of numbers separated by periods. In other words, on one call I may pass <code>1.23</code>, but on the next call I may pass <code>1.23.45.6</code>. Generating the format string on the fly is an easy task, however I am unsure of whether it's possible to pass in a variable number of remaining arguments that are used to store the results of the function. </p>\n\n<p>Does anyone know if this is possible or have any other ideas?  </p>\n"}, {"tags": ["c", "pipe", "fork"], "comments": [{"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "edited": false, "score": 0, "creation_date": 1531958182, "post_id": 51412448, "comment_id": 89796604, "body": "i don&#39;t want to use an array. i just want to directly write and read from and to the pipe"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1531958296, "post_id": 51412448, "comment_id": 89796622, "body": "<code>read()</code> doesn&#39;t null-terminate the data, you can&#39;t print it with <code>%s</code> formatting."}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958311, "post_id": 51412448, "comment_id": 89796626, "body": "If you guys want, i can post the complete code"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958331, "post_id": 51412448, "comment_id": 89796629, "body": "<code>strtol()</code> also requires a null-terminated string."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1531958419, "post_id": 51412448, "comment_id": 89796647, "body": "Is there a process reading from the second pipe? If not, you may be blocking if the second pipe has filled up."}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958694, "post_id": 51412448, "comment_id": 89796697, "body": "no.the code is there but it never goes through the code because of while(0)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1531958804, "post_id": 51412448, "comment_id": 89796719, "body": "That&#39;s a problem. Pipes have limited capacity, so if the writer gets too far ahead of the reader, it&#39;s blocked until the reader catches up."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958841, "post_id": 51412448, "comment_id": 89796730, "body": "Although you should be able to write about 4KB before that happens."}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958889, "post_id": 51412448, "comment_id": 89796744, "body": "how can i fix my code?"}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531958945, "post_id": 51412448, "comment_id": 89796752, "body": "i really appreciate that you are taking the time to help me. thank you"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531959078, "post_id": 51412448, "comment_id": 89796782, "body": "You could set the pipe to non-blocking mode. But then you need more complicated code to handle the error when trying to write to a full pipe. The easier solution is to fix the reader so it reads from the pipe."}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531959220, "post_id": 51412448, "comment_id": 89796814, "body": "i am confused.Is read(fd[0][0],temp,10) not considered reading from the pipe? what underlying info am i missing from this?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531959287, "post_id": 51412448, "comment_id": 89796828, "body": "you&#39;re getting stuck when you write to <code>fd[1][1]</code>. The problem is the process that&#39;s reading from <code>fd[1][0]</code>."}, {"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531961822, "post_id": 51412448, "comment_id": 89797351, "body": "can you show me a fix? i don&#39;t know how to fix it"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531961911, "post_id": 51412448, "comment_id": 89797369, "body": "There&#39;s way too much code here for me to try to understand it all. What happens if you get rid of the <code>while(0)</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "edited": false, "score": 0, "creation_date": 1531964066, "post_id": 51413109, "comment_id": 89797807, "body": "I am not sure about the exact technical event or termination of the problem.This is just the behaviour that i expected"}], "tags": [], "owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "is_accepted": false, "score": 0, "last_activity_date": 1531963948, "creation_date": 1531963948, "answer_id": 51413109, "question_id": 51412448, "link": "https://stackoverflow.com/questions/51412448/c-how-to-read-and-write-at-the-same-time-in-multiple-pipes/51413109#51413109", "title": "c-how to read and write at the same time in multiple pipes?", "body": "<p>I found the solution.But the credit goes to Barmar for helping me and giving me hints of the possible problems in the comments. The problem as Barmar actually hinted is \"you're getting stuck when you write to fd[1][1]. The problem is the process that's reading from fd[1][0]\". Apparently, the write terminated the program knowing that there is no other processes to read the data(parent process finished executing or the process reading fd[1][0]).Therefore, Adding wait in the parent process(the other process) would solve the issue.</p>\n"}], "owner": {"reputation": 1, "user_id": 10102418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/652df4d48347e0cdfd225f86b1594787?s=128&d=identicon&r=PG&f=1", "display_name": "tony tofighi", "link": "https://stackoverflow.com/users/10102418/tony-tofighi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531963948, "creation_date": 1531957896, "last_edit_date": 1531958586, "question_id": 51412448, "link": "https://stackoverflow.com/questions/51412448/c-how-to-read-and-write-at-the-same-time-in-multiple-pipes", "title": "c-how to read and write at the same time in multiple pipes?", "body": "<p>this is just part of my program. </p>\n\n<pre><code>char temp[100];//stores the temporary value from the pipe read\nif(close(fd[0][1])==-1){//closing the write of the first pipe\n    perror(\"Error: closing the write pipe [child]-\");\n    exit(-1);\n}\nif(close(fd[1][0])==-1){//closing the read of the second pipe\n    perror(\"Error: closing the write pipe [child]-\");\n    exit(-1);\n}\n\nif(!(read(fd[0][0],temp,10)&gt;0)){//the first number read specifies the overall filter\n    fprintf(stderr,\"Error: while reading the filter\");\n    exit(-1);\n}\nfilter=strtol(temp,NULL,10);//storing the first read as the filter\nwhile(read(fd[0][0],temp,10)&gt;0){//reading the rest of the data for filtering\n    printf(\"[%d] child received %s\\n\",getpid(),temp);\n    if(strtol(temp,NULL,10)%filter!=0){//checking to see if the read number is divisible by the filter\n        //if not, we write it to the second pipe\n        if(write(fd[1][1],temp,10)==-1){\n            perror(\"Error: failed to write to pipe -\");\n            exit(-1);\n        }\n    }\n}\n\nif(close(fd[1][1])==-1){//closing the write of the second pipe\n    perror(\"Error: closing the read pipe [child]-\");\n    exit(-1);\n}\nif(close(fd[0][0])==-1){//closing the read of the first pipe\n    perror(\"Error: closing the read pipe [child]-\");\n    exit(-1);\n}\n</code></pre>\n\n<p>so i wrote 10 separate numbers(converted to string) to <code>fd[0][1]</code> in my code in the parent process (i have not showed it here but i know that it works). Now, i can only read one data from <code>fd[0][0]</code>. if i remove</p>\n\n<pre><code>if(write(fd[1][1],temp,10)==-1){\n    perror(\"Error: failed to write to pipe -\");\n    exit(-1);\n}\n</code></pre>\n\n<p>it will read all of the data. Why is this interfering with the read?if there are any other improvements in my code that i can make, let me know.</p>\n\n<p>here is the full code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;sys/wait.h&gt;\n\nint main(int argc,char*argv[]){\n/*---------------Error checking----------------*/\n//checking to see if correct number of arguments is provided\nif(argc!=2){\n    fprintf(stderr, \"Usage:\\n\\tpfact n\\n\");\n    exit(1);\n}\n\n//checking to see if correct argument is provided\nchar *leftOver;\nint checkNumber=strtol(argv[1],&amp;leftOver,10);\nint squareroot_checkNumber=sqrt((double)checkNumber);\nif(leftOver[0]!='\\0'){\n    fprintf(stderr, \"Usage:\\n\\tpfact n\\n\");\n    exit(1);\n}\n\nif(checkNumber&lt;=0){\n    fprintf(stderr, \"Usage:\\n\\tpfact n\\n\");\n    exit(1);\n}\n/*-------------------------------------------*/\nchar factors[checkNumber-1][100];\nint factor_size=0;\nstrcpy(factors[0],\"-1\");\nint child;\nint number_process=0;//keeps track of number of processes created\nint isInitialized=0;//sees if we are initialized yet or not\nint filter;//stores the number used to filter the data\n\nint fd[2][2];\n\n//create the two pipes\nif(pipe(fd[0]) == -1){\n    perror(\"Error: creating a pipe -\");\n}\n\nif(pipe(fd[1]) == -1){\n    perror(\"Error: creating a pipe -\");\n}\ndo{\n    child=fork();\n    if(child&lt;0){\n        perror(\"Error: making a child -\");\n        exit(1);\n    }\n\n    if(child&gt;0){\n        if(isInitialized==0){//not initialized yet //no data has been written to the pipe\n            isInitialized=1;//it has been initilized now\n            if(close(fd[0][0])==-1){//closing the read of the first pipe\n                perror(\"Error: closing the read pipe [parent]-\");\n                exit(-1);\n            }\n            //writing 2 to m to the pipe\n            for(int i=2;i&lt;=checkNumber;i++){\n                char number_string[100];\n                sprintf(number_string,\"%d\",i);\n                if(write(fd[0][1],number_string,10)==-1){\n                    perror(\"Error: failed to write to pipe -\");\n                    exit(-1);\n                }\n            }\n            if(close(fd[0][1])==-1){//closing the write of the first pipe after finishing writing\n                perror(\"Error: closing the write pipe [parent]-\");\n                exit(-1);\n            }\n        }else{\n            char temp_parent[100];//stores the temporary value from the pipe read\n            if(close(fd[0][0])==-1){//closing the read of the first pipe\n                perror(\"Error: closing the write first pipe [parent]-\");\n                exit(-1);\n            }\n            if(close(fd[1][1])==-1){//closing the write of the second pipe\n                perror(\"Error: closing the write second pipe [parent]-\");\n                exit(-1);\n            }\n\n            while(read(fd[1][0],temp_parent,10)&gt;0){//reading the data from the second pipe\n                //write the data to the first pipe so that it can be read by the child for filtering\n                if(write(fd[0][1],temp_parent,10)==-1){\n                    perror(\"Error: failed to write to pipe -\");\n                    exit(-1);\n                }\n                printf(\"[%d] parent received %s\\n\",getpid(),temp_parent);\n            }\n\n\n            if(close(fd[0][1])==-1){//closing the write of the first pipe\n                perror(\"Error: closing the read first pipe [parent]-\");\n                exit(-1);\n            }\n            if(close(fd[1][0])==-1){//closing the read of the second pipe\n                perror(\"Error: closing the read second pipe [parent]-\");\n                exit(-1);\n            }\n        }\n    }else if(child==0){\n\n        char temp[100];//stores the temporary value from the pipe read\n        if(close(fd[0][1])==-1){//closing the write of the first pipe\n            perror(\"Error: closing the write pipe [child]-\");\n            exit(-1);\n        }\n        if(close(fd[1][0])==-1){//closing the read of the second pipe\n            perror(\"Error: closing the write pipe [child]-\");\n            exit(-1);\n        }\n\n        if(!(read(fd[0][0],temp,10)&gt;0)){//the first number read specifies the overall filter\n            fprintf(stderr,\"Error: while reading the filter\");\n            exit(-1);\n        }\n        filter=strtol(temp,NULL,10);//storing the first read as the filter\n        while(read(fd[0][0],temp,10)&gt;0){//reading the rest of the data for filtering\n            printf(\"[%d] child received %s\\n\",getpid(),temp);\n            if(strtol(temp,NULL,10)%filter!=0){//checking to see if the read number is divisible by the filter\n                //if not, we write it to the second pipe\n                if(write(fd[1][1],temp,10)==-1){\n                    perror(\"Error: failed to write to pipe -\");\n                    exit(-1);\n                }\n            }\n        }\n\n        if(close(fd[1][1])==-1){//closing the write of the second pipe\n            perror(\"Error: closing the read pipe [child]-\");\n            exit(-1);\n        }\n        if(close(fd[0][0])==-1){//closing the read of the first pipe\n            perror(\"Error: closing the read pipe [child]-\");\n            exit(-1);\n        }\n    }\n}while(0 &amp;&amp; child==0 &amp;&amp; checkNumber/2&lt;=filter);\n\n}\n</code></pre>\n"}, {"tags": ["c", "for-loop", "optimization"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531956928, "post_id": 51412313, "comment_id": 89796330, "body": "It would be easier to assess if you showed how N and N0 are defined.  There&#39;s a good chance an optimizing compiler will do what you&#39;re doing by hand.  The only reliable ways to determine benefit are to look at the generated assembler or measure the running code.  The definitions of <code>dec</code> and <code>dec1</code> could perfectly well be inside the <code>for</code> loop \u2014 with no performance penalty."}, {"owner": {"reputation": 21, "user_id": 10102345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-am4lgS27EOc/AAAAAAAAAAI/AAAAAAAAAH8/ArFo-dE5aLI/photo.jpg?sz=128", "display_name": "Ethan B.", "link": "https://stackoverflow.com/users/10102345/ethan-b"}, "edited": false, "score": 0, "creation_date": 1531957521, "post_id": 51412313, "comment_id": 89796457, "body": "Ok, I just defined N and N0. I don&#39;t know much of assembler though, but you seem confident about the fact that there is no performance penalty. Why is that ? In the original code, am I not computing N0*j N0*N time, when I only need to compute it j time ? It seems to me there are more opertations to do, isn&#39;t there ?"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1531958541, "post_id": 51412313, "comment_id": 89796674, "body": "As noted in my answer, Common Subexpression Elimination is the process of detecting that the terms <code>j * N0</code> and <code>N0 * (N_dt0_s_dt + j)</code> are invariant during the innermost loop, and therefore can be evaluated once.  i.e. doing exactly what your second example does explicitly.  In practice, I wouldn&#39;t be at all surprised if the inner loop is actually optimized down considerably more aggressively.  Something along the lines of not actually iterating over ints at all, but instead creating a couple of anonymous pointers that address the two matrices, and iterating them directly."}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 2, "creation_date": 1531961945, "post_id": 51412313, "comment_id": 89797377, "body": "This is clearly <a href=\"https://en.wikipedia.org/wiki/Program_optimization#When_to_optimize\" rel=\"nofollow noreferrer\">Premature Optimization</a>.  Write code for readability and maintainability first, and optimize only AFTER you have profiled the code and identified a bottleneck."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531957672, "post_id": 51412377, "comment_id": 89796500, "body": "C compilers still give you a slap on the wrist if you write C++ code and present it to a C compiler."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531957880, "post_id": 51412377, "comment_id": 89796543, "body": "@JonathanLeffler touche. :)  Although the case can be made that with both MSVC ands GCC, it&#39;s the same executable doing the compilation, so optimization techniques of this sort to a large degree become language agnostic between C and C++."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531971682, "post_id": 51412377, "comment_id": 89799351, "body": "Posting invalid C code to a C question is less valuable than using compilable C code.  Drop <code>auto</code>."}], "tags": [], "owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "is_accepted": true, "score": 4, "last_activity_date": 1531957610, "last_edit_date": 1531957610, "creation_date": 1531957267, "answer_id": 51412377, "question_id": 51412313, "link": "https://stackoverflow.com/questions/51412313/is-it-really-faster-to-use-variables-as-arrays-index-in-a-for-loop-instead-of-c/51412377#51412377", "title": "Is it really faster to use variables as array&#39;s index in a for loop instead of computing them at each iteration?", "body": "<p>You'd want to look at the assembly produced to be sure.  That said, <a href=\"https://en.wikipedia.org/wiki/Common_subexpression_elimination\" rel=\"nofollow noreferrer\">Common Subexpression Elimination</a> is a very well understood optimization technique, and as far as I know, most of the commonly used compilers nowadays will do it with suitable optimization options.</p>\n\n<p>Anecdotally, optimizers are getting quite good at their jobs nowadays.  It used to be that you'd get a slap on the wrist if you wrote:</p>\n\n<pre><code>for (auto it = container.begin(); it != container.end(); it++)\n</code></pre>\n\n<p>However I've tested MSVC by writing two equivalent functions, one of which used the above, while the other used the \"approved\":</p>\n\n<pre><code>for (auto it = container.begin(); it != container.end(); ++it)\n</code></pre>\n\n<p>with no other differences.</p>\n\n<p>Not only did MSVC correctly realize that it could replace <code>it++</code> with <code>++it</code> since I didn't actually use the value, it then proceeded to notice during linkage that the two routines were now identical, so it completely elided one of them, and used the object code of the other for both invocations.</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10102345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-am4lgS27EOc/AAAAAAAAAAI/AAAAAAAAAH8/ArFo-dE5aLI/photo.jpg?sz=128", "display_name": "Ethan B.", "link": "https://stackoverflow.com/users/10102345/ethan-b"}, "edited": false, "score": 0, "creation_date": 1531962082, "post_id": 51412843, "comment_id": 89797414, "body": "It is a good point. I will look forward into this. Thanks!"}], "tags": [], "owner": {"reputation": 6882, "user_id": 3403834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xpA5S.jpg?s=128&g=1", "display_name": "user58697", "link": "https://stackoverflow.com/users/3403834/user58697"}, "is_accepted": false, "score": 3, "last_activity_date": 1531961647, "creation_date": 1531961647, "answer_id": 51412843, "question_id": 51412313, "link": "https://stackoverflow.com/questions/51412313/is-it-really-faster-to-use-variables-as-arrays-index-in-a-for-loop-instead-of-c/51412843#51412843", "title": "Is it really faster to use variables as array&#39;s index in a for loop instead of computing them at each iteration?", "body": "<p>It is not as much for an optimization, but rather for the readability. I would go one step further, and realize that in <code>dec1 = N0 *(N_dt0_s_dt + j)</code> is in fact <code>dec1 = N0 *N_dt0_s_dt + N0*j</code>, and that the first term does not depend on <code>j</code>, while <code>N0*j</code> is <code>dec</code>, leading to</p>\n\n<pre><code>    for (int N_dt0_s_dt = 0; N_dt0_s_dt &lt; N_dt; N_dt0_s_dt++)\n    {\n        int something = N0 * N_dt0_s_dt;\n        for (int j = 0; j &lt; N; j++)\n        {\n            dec = N0 * j;\n            dec1 = something + dec;\n            for (int i = 0; i &lt; N0; i++)\n            {\n                Matrix_t0[i + dec] += M_t_t0_loc[i + dec1];\n            }\n        }\n    }\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>    int something = 0;\n    for (int N_dt0_s_dt = 0; N_dt0_s_dt &lt; N_dt; N_dt0_s_dt++)\n    {\n        int something += N0;;\n        for (int j = 0; j &lt; N; j++)\n        {\n            dec = N0 * j;\n            dec1 = something + dec;\n            for (int i = 0; i &lt; N0; i++)\n            {\n                Matrix_t0[i + dec] += M_t_t0_loc[i + dec1];\n            }\n        }\n    }\n</code></pre>\n\n<p>Of course <code>something</code> is a bad name, but there is a strong hint that it represents an important concept in the problem domain. I have a suspicion of what it actually is, but without seeing more of the context I cannot be sure. You can. Try to come up with a good name, and observe the improvement of readability.</p>\n"}], "owner": {"reputation": 21, "user_id": 10102345, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-am4lgS27EOc/AAAAAAAAAAI/AAAAAAAAAH8/ArFo-dE5aLI/photo.jpg?sz=128", "display_name": "Ethan B.", "link": "https://stackoverflow.com/users/10102345/ethan-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1532054022, "accepted_answer_id": 51412377, "answer_count": 2, "score": 0, "last_activity_date": 1531961647, "creation_date": 1531956679, "last_edit_date": 1531957181, "question_id": 51412313, "link": "https://stackoverflow.com/questions/51412313/is-it-really-faster-to-use-variables-as-arrays-index-in-a-for-loop-instead-of-c", "closed_reason": "Duplicate", "title": "Is it really faster to use variables as array&#39;s index in a for loop instead of computing them at each iteration?", "body": "<p>During my internship, I have to use nested for loops, and I wrote something like this (in C) :</p>\n\n<pre><code>        for (int N_dt0_s_dt = 0; N_dt0_s_dt &lt; N_dt; N_dt0_s_dt++)\n        {\n            for (int j = 0; j &lt; N; j++)\n            {\n                for (int i = 0; i &lt; N0; i++)\n                {\n                    Matrix_t0[i + N0 * j] += M_t_t0_loc[i + N0 *(N_dt0_s_dt + j)];\n                }\n            }\n        }\n</code></pre>\n\n<p>Here, N and N0 are integers representing the matrix dimensions. N and N0 are between 200 and 500, depending on the input matrix.\n   During the review of the code, some coworker suggested the following changes :</p>\n\n<pre><code>        int dec,dec1;//to compute index\n        for (int N_dt0_s_dt = 0; N_dt0_s_dt &lt; N_dt; N_dt0_s_dt++)\n        {\n            for (int j = 0; j &lt; N; j++)\n            {\n                dec = N0 * j;\n                dec1 = N0 *(N_dt0_s_dt + j);\n                for (int i = 0; i &lt; N0; i++)\n                {\n                    Matrix_t0[i + dec] += M_t_t0_loc[i + dec1];\n                }\n            }\n        }\n    }\n</code></pre>\n\n<p>The coworker told me the latter should run faster, because we are not computing the operations needed to come up with the N0 *(N_dt0_s_dt + j) at each iteration.</p>\n\n<p>I think it is pretty legitimate, but I was asking myself if the compiler (Visual Studio) was already doing optimizations which would make those changes useless. </p>\n\n<p>Some thoughts on this would be appreciated.</p>\n"}, {"tags": ["c", "optimization", "bitwise-operators", "logical-operators"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531955373, "post_id": 51412136, "comment_id": 89795943, "body": "You&#39;re fretting about sub-micro-optimizing (nano-optimizing?).  Don&#39;t.  There are other bigger hold-ups in your code.  This is unlikely to make a measurable difference to the performance of your program."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531955379, "post_id": 51412136, "comment_id": 89795944, "body": "Any decent compiler with optimization enabled should be able to figure out that these are all equivalent and generate the same code."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531955384, "post_id": 51412136, "comment_id": 89795946, "body": "and then &quot;fastest&quot; is relative and in the eyes of the beholder, depends on a number of factors which are below the C language level.  Are you having some performance problems?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1531955393, "post_id": 51412136, "comment_id": 89795948, "body": "Way 3 is not logical OR but bitwise OR."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531955439, "post_id": 51412136, "comment_id": 89795956, "body": "@WeatherVane True, but if the types are <code>_Bool</code> they&#39;re equivalent."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531955451, "post_id": 51412136, "comment_id": 89795962, "body": "If B is a complex calculation, don&#39;t use Way 3 (<code>|=</code>)."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531955489, "post_id": 51412136, "comment_id": 89795973, "body": "@JonathanLeffler why not?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531955498, "post_id": 51412136, "comment_id": 89795974, "body": "Right. Logical OR is short-circuiting, bitwise OR has to calculate both."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531955535, "post_id": 51412136, "comment_id": 89795990, "body": "@JonathanLeffler If the compiler can determine that B has no side effects, it can optimize it away."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531955558, "post_id": 51412136, "comment_id": 89795993, "body": "@M.M: Way 3 calculates B unconditionally; the other two do not.  If B is a complex calculation, unconditionally calculating it when it is not actually needed is a bad idea, is it not?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531955656, "post_id": 51412136, "comment_id": 89796018, "body": "@JonathanLeffler Right ... I guess it depends on whether OP wants side-effects of B&#39;s calculation to occur"}, {"owner": {"reputation": 51, "user_id": 3299023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec92d121b68b10bf6f6b9993e6ffd73a?s=128&d=identicon&r=PG&f=1", "display_name": "ardera", "link": "https://stackoverflow.com/users/3299023/ardera"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531957561, "post_id": 51412136, "comment_id": 89796473, "body": "@JonathanLeffler It&#39;s incorrect that this is &quot;nano-optimization&quot;. This depends on the complexity of B. If B is difficult to compute, and this OR and assign code is practically all that is executed for the whole runtime of the program, like it is in my case, this is not nano-optimization."}, {"owner": {"reputation": 51, "user_id": 3299023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec92d121b68b10bf6f6b9993e6ffd73a?s=128&d=identicon&r=PG&f=1", "display_name": "ardera", "link": "https://stackoverflow.com/users/3299023/ardera"}, "edited": false, "score": 0, "creation_date": 1531958466, "post_id": 51412136, "comment_id": 89796656, "body": "The &quot;optimization&quot; tag is not meant like &quot;how can I optimize my code?&quot;, it&#39;s more like &quot;how does the compiler optimize this code&quot;; since I already know I can optimize it by not computing B when there&#39;s no need to.  I&#39;m not just asking so I can make my 1 OR and assign statement more readable, I was also curious how &amp; under what circumstances a C compiler optimizes these statements. For example, I know for a fact that Lua omits the RHS of the logical or when the LHS was already true, even computing the RHS would have some side-effects."}], "answers": [{"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531958776, "post_id": 51412417, "comment_id": 89796713, "body": "In all of these functions the calculation for <code>B</code> must be performed. It&#39;s not clear from the OP but they might want to short-circuit if <code>A</code> is true"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531958871, "post_id": 51412417, "comment_id": 89796740, "body": "Somewhat surprising that gcc generates different code for <code>one</code> even with max optimization. (clang generates same code for all)"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1531965170, "post_id": 51412417, "comment_id": 89798007, "body": "I usually also use clang since you can hit so many targets and compare them, but didnt this time."}], "tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 1, "last_activity_date": 1531957572, "creation_date": 1531957572, "answer_id": 51412417, "question_id": 51412136, "link": "https://stackoverflow.com/questions/51412136/fastest-way-to-logical-or-two-vars-in-c-store-in-var-1/51412417#51412417", "title": "fastest way to logical OR two vars in C &amp; store in var 1", "body": "<p>You could just try it.</p>\n\n<pre><code>#include &lt;stdint.h&gt;\n_Bool one ( _Bool A, _Bool B )\n{\n    if(!A) A = B;\n    return(A);\n}\n_Bool two ( _Bool A, _Bool B )\n{\n   A = A || B;\n   return(A);\n}\n_Bool three ( _Bool A, _Bool B )\n{\n   A |= B;\n   return(A);\n}\n</code></pre>\n\n<p>one particular target</p>\n\n<pre><code>00000000 &lt;one&gt;:\n   0:   2800        cmp r0, #0\n   2:   bf08        it  eq\n   4:   4608        moveq   r0, r1\n   6:   4770        bx  lr\n\n00000008 &lt;two&gt;:\n   8:   4308        orrs    r0, r1\n   a:   4770        bx  lr\n\n0000000c &lt;three&gt;:\n   c:   4308        orrs    r0, r1\n   e:   4770        bx  lr\n</code></pre>\n\n<p>The latter two should be faster.  Some compilers may be smarter to figure out a shortcut.  Performance is not directly governed by the high level language in this case but the compiler, settings, linker, target and the code around it, so there is no correct answer based on what you have provided and even with more information it is likely that a high performing answer can be defeated in a benchmark, since benchmarks are generally easy to manipulate.</p>\n"}], "owner": {"reputation": 51, "user_id": 3299023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec92d121b68b10bf6f6b9993e6ffd73a?s=128&d=identicon&r=PG&f=1", "display_name": "ardera", "link": "https://stackoverflow.com/users/3299023/ardera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1531957572, "creation_date": 1531955005, "question_id": 51412136, "link": "https://stackoverflow.com/questions/51412136/fastest-way-to-logical-or-two-vars-in-c-store-in-var-1", "title": "fastest way to logical OR two vars in C &amp; store in var 1", "body": "<p>considering three ways to logical OR two _Bool values A, B and additionally store the result in A again, using the C programming language, what is the fastest?</p>\n\n<p>Way 1: <code>if (!A) A = B;</code></p>\n\n<p>Way 2: <code>A = A || B;</code></p>\n\n<p>Way 3: <code>A |= B;</code></p>\n\n<p>Of course, if you now replace B with a complicated statement, way 3 would be the cleanest and most elegant method.</p>\n\n<p>However, I'd imagine a normal C compiler would calculate the value of B unconditionally in way 3, even when A is true already (meaning that it doesn't have to calculate B); because it's a bitwise operation and not a logical one.</p>\n\n<p>How's way 2 then? Does the compiler realize it doesn't have to compute B in this case?</p>\n\n<p>Way 1 is, of course, the no-risk method; but it's not that elegant either.</p>\n"}, {"tags": ["c", "permissions", "system-calls", "fuse", "stat"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531950429, "post_id": 51411407, "comment_id": 89794437, "body": "I am not on top of this, but you should post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531950696, "post_id": 51411407, "comment_id": 89794550, "body": "I can&#39;t think of any reason why changing the value of a struct member would cause a problem like this."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531951008, "post_id": 51411537, "comment_id": 89794678, "body": "But aren&#39;t there only 3 bits per category anyway? Not my DV."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531951144, "post_id": 51411537, "comment_id": 89794725, "body": "I&#39;ve added an excerpt from the documentation showing that it also contains the <code>S_IFMT</code> field that contains the file type."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 2, "last_activity_date": 1531951083, "last_edit_date": 1531951083, "creation_date": 1531950920, "answer_id": 51411537, "question_id": 51411407, "link": "https://stackoverflow.com/questions/51411407/permission-override-after-stat-is-called/51411537#51411537", "title": "Permission override after stat is called", "body": "<p>The <code>st_mode</code> member includes more than just the permissions, it also includes the file type (directory, fifo, device special file, etc.). If you simply assign <code>0777</code> to it, you'll remove the type information. You should just overwrite the permission bits.</p>\n\n<pre><code>stbuf-&gt;mode |= 0777;\n</code></pre>\n\n<p>From the documentation:</p>\n\n<blockquote>\n<pre><code> The status information word st_mode has the following bits:\n\n #define S_IFMT 0170000           /* type of file */\n #define        S_IFIFO  0010000  /* named pipe (fifo) */\n #define        S_IFCHR  0020000  /* character special */\n #define        S_IFDIR  0040000  /* directory */\n #define        S_IFBLK  0060000  /* block special */\n #define        S_IFREG  0100000  /* regular */\n #define        S_IFLNK  0120000  /* symbolic link */\n #define        S_IFSOCK 0140000  /* socket */\n #define        S_IFWHT  0160000  /* whiteout */\n #define S_ISUID 0004000  /* set user id on execution */\n #define S_ISGID 0002000  /* set group id on execution */\n #define S_ISVTX 0001000  /* save swapped text even after use */\n #define S_IRUSR 0000400  /* read permission, owner */\n #define S_IWUSR 0000200  /* write permission, owner */\n #define S_IXUSR 0000100  /* execute/search permission, owner */\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51411537, "answer_count": 1, "score": 0, "last_activity_date": 1531951083, "creation_date": 1531950247, "question_id": 51411407, "link": "https://stackoverflow.com/questions/51411407/permission-override-after-stat-is-called", "title": "Permission override after stat is called", "body": "<p>Hi I'm writing \"net raid fs\" with FUSE.</p>\n\n<p>So when syscall <code>getattr</code> is called, I'm sending it to server, server is calling <code>stat(path, stbuf)</code> syscall and it sets <code>stbuf</code> as it should do. After that I'm returning this <code>stbuf</code> to client (with socket connection) and client handles it and everything is working okay.</p>\n\n<p>But here is the problem: I want <code>stbuf-&gt;st_mode</code> (AKA permissions) always to be 0777, so I'm doing <code>stbuf-&gt;st_mode = 0777;</code> and after that sending this <code>struct</code> to client (as I did above). And program kind of freezes (server [or client] stops receiving syscalls properly).</p>\n\n<p>What to do? </p>\n"}, {"tags": ["c", "loadrunner"], "comments": [{"owner": {"reputation": 5302, "user_id": 691105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giG6N.jpg?s=128&g=1", "display_name": "James Pulley", "link": "https://stackoverflow.com/users/691105/james-pulley"}, "edited": false, "score": 0, "creation_date": 1531955145, "post_id": 51410609, "comment_id": 89795880, "body": "Not certain why you posted images of all of the dialogs.  The germain questions are (1) what does the recording log suggest &amp; (2) What happens when you hit continue....?"}, {"owner": {"reputation": 81, "user_id": 10028672, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uA6anXuHn5g/AAAAAAAAAAI/AAAAAAAAAAc/XnFLCNot63o/photo.jpg?sz=128", "display_name": "Antonio Barazarte", "link": "https://stackoverflow.com/users/10028672/antonio-barazarte"}, "reply_to_user": {"reputation": 5302, "user_id": 691105, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/giG6N.jpg?s=128&g=1", "display_name": "James Pulley", "link": "https://stackoverflow.com/users/691105/james-pulley"}, "edited": false, "score": 0, "creation_date": 1532010815, "post_id": 51410609, "comment_id": 89821703, "body": "@JamesPulley if i hit continue, IExplorer crash. Thanks James!."}], "answers": [{"tags": [], "owner": {"reputation": 75, "user_id": 9099917, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/313de2028e094590c75f0c4f31e14a7c?s=128&d=identicon&r=PG&f=1", "display_name": "twinge", "link": "https://stackoverflow.com/users/9099917/twinge"}, "is_accepted": true, "score": 2, "last_activity_date": 1533499861, "creation_date": 1533499861, "answer_id": 51697889, "question_id": 51410609, "link": "https://stackoverflow.com/questions/51410609/loadrunner-12-55-failed-to-connect-the-target-site/51697889#51697889", "title": "LoadRunner 12.55 failed to connect the target site", "body": "<p>go under recording options and set a new connection. \nAny server, all Ports (value 0) and go further with the settings (direct/proxy etc.). If you are not sure which settings you should use just try and edit them as long as the record is empy  </p>\n"}], "owner": {"reputation": 81, "user_id": 10028672, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uA6anXuHn5g/AAAAAAAAAAI/AAAAAAAAAAc/XnFLCNot63o/photo.jpg?sz=128", "display_name": "Antonio Barazarte", "link": "https://stackoverflow.com/users/10028672/antonio-barazarte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1119, "favorite_count": 0, "accepted_answer_id": 51697889, "answer_count": 1, "score": 1, "last_activity_date": 1533499861, "creation_date": 1531946233, "question_id": 51410609, "link": "https://stackoverflow.com/questions/51410609/loadrunner-12-55-failed-to-connect-the-target-site", "title": "LoadRunner 12.55 failed to connect the target site", "body": "<p>i'm recording with VUG and receive this error when click a button to acces to another page.\n<a href=\"https://i.stack.imgur.com/r54kp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r54kp.png\" alt=\"Error\"></a></p>\n\n<p><strong>here is my configuration:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/FGLXZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FGLXZ.png\" alt=\"HTTP/HTML level\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/qgOIk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qgOIk.png\" alt=\"Language\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/nPS0d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nPS0d.png\" alt=\"Correlation\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/Un4Jj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Un4Jj.png\" alt=\"HTTP properties\"></a></p>\n\n<p>If someone know how to solve it, thanks in advance.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 360, "user_id": 5875805, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4zBy.jpg?s=128&g=1", "display_name": "Tormund Giantsbane", "link": "https://stackoverflow.com/users/5875805/tormund-giantsbane"}, "edited": false, "score": 5, "creation_date": 1531945083, "post_id": 51410335, "comment_id": 89792128, "body": "<code>if (tab[7] == 3)</code> but you define <code>int tab[5]</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531945086, "post_id": 51410335, "comment_id": 89792131, "body": "What is this <code>7</code> which you are passing?"}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "edited": false, "score": 1, "creation_date": 1531945176, "post_id": 51410335, "comment_id": 89792180, "body": "Any you need to check <code>size</code> before you do that..."}, {"owner": {"reputation": 74843, "user_id": 2988730, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZOX7t.jpg?s=128&g=1", "display_name": "Mad Physicist", "link": "https://stackoverflow.com/users/2988730/mad-physicist"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531945256, "post_id": 51410335, "comment_id": 89792214, "body": "@EugeneSh. You&#39;re right. But the size check is indeed missing."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531945341, "post_id": 51410335, "comment_id": 89792245, "body": "The code does work if you do <code>index = Search(tab, 4, 3);</code> where the <code>4</code> is the maximum index into an array with 5 elements."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531945445, "post_id": 51410335, "comment_id": 89792296, "body": "....but it will not terminate in case there is no such a value there."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531945519, "post_id": 51410335, "comment_id": 89792327, "body": "... however it fails with <code>index = Search(tab, 4, 2);</code> because it reports that <code>2</code> was found, but it isn&#39;t in the array. Probably just an unlucky strike that a <code>2</code> was found before a crash."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531945605, "post_id": 51410335, "comment_id": 89792373, "body": "@WeatherVane Luckily it was among the garbage it was traversing before run out of stack :) Or it is optimized into loop as tail-recursion..."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531945656, "post_id": 51410335, "comment_id": 89792398, "body": "@EugeneSh. yes, I was editing my previous comment."}, {"owner": {"reputation": 198, "user_id": 5667025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HeBRn.jpg?s=128&g=1", "display_name": "S.Wan", "link": "https://stackoverflow.com/users/5667025/s-wan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531945859, "post_id": 51410335, "comment_id": 89792492, "body": "@WeatherVane The Search function does not stop when the size smaller than 0 so it looks like the function keeps searching until it gets another 2. Basically, the Search function needs to do the boundary check for size and return 0/-1/etc when there is no number to search."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 198, "user_id": 5667025, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/HeBRn.jpg?s=128&g=1", "display_name": "S.Wan", "link": "https://stackoverflow.com/users/5667025/s-wan"}, "edited": false, "score": 0, "creation_date": 1531945994, "post_id": 51410335, "comment_id": 89792551, "body": "@S.Wan you are right."}], "answers": [{"comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1531945884, "post_id": 51410484, "comment_id": 89792506, "body": "It&#39;s a good answer but I don&#39;t like <code>if (size &lt;= 0)</code> and consequent <code>-1</code> adjustments. <code>size == 0</code> is a valid array index."}, {"owner": {"reputation": 243, "user_id": 9642953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/---P07xriu6E/AAAAAAAAAAI/AAAAAAAAAD4/4YlSQ-DzIf8/photo.jpg?sz=128", "display_name": "Andres Salgado", "link": "https://stackoverflow.com/users/9642953/andres-salgado"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531946044, "post_id": 51410484, "comment_id": 89792565, "body": "I get what you mean, but I figured it&#39;s better to code defensively even if it&#39;s for something that &quot;should not happen.&quot; But yes, if there are no ways for negative numbers to slip in there, then <code>size == 0</code> would suffice."}, {"owner": {"reputation": 3, "user_id": 8522137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bef581a62251ec925b55842bb4c681e?s=128&d=identicon&r=PG&f=1", "display_name": "FDinis", "link": "https://stackoverflow.com/users/8522137/fdinis"}, "edited": false, "score": 0, "creation_date": 1531946679, "post_id": 51410484, "comment_id": 89792842, "body": "I didn&#39;t even notice that i was searching for a value outside of the length of the array itself, that&#39;s embarrassing... The goal of the problem was to return 1 if the value was found or 0 if not, so in the <code>if(size &lt;= 0)</code> I should return the function itself but with the <code>size -1</code> right?"}, {"owner": {"reputation": 243, "user_id": 9642953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/---P07xriu6E/AAAAAAAAAAI/AAAAAAAAAD4/4YlSQ-DzIf8/photo.jpg?sz=128", "display_name": "Andres Salgado", "link": "https://stackoverflow.com/users/9642953/andres-salgado"}, "reply_to_user": {"reputation": 3, "user_id": 8522137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bef581a62251ec925b55842bb4c681e?s=128&d=identicon&r=PG&f=1", "display_name": "FDinis", "link": "https://stackoverflow.com/users/8522137/fdinis"}, "edited": false, "score": 0, "creation_date": 1531947684, "post_id": 51410484, "comment_id": 89793322, "body": "@FDinis I am unable to produce an error with my code. Did the code compile successfully on your machine?"}], "tags": [], "owner": {"reputation": 243, "user_id": 9642953, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/---P07xriu6E/AAAAAAAAAAI/AAAAAAAAAD4/4YlSQ-DzIf8/photo.jpg?sz=128", "display_name": "Andres Salgado", "link": "https://stackoverflow.com/users/9642953/andres-salgado"}, "is_accepted": false, "score": 2, "last_activity_date": 1531945717, "creation_date": 1531945717, "answer_id": 51410484, "question_id": 51410335, "link": "https://stackoverflow.com/questions/51410335/searching-a-value-in-an-array-using-recursive-functions/51410484#51410484", "title": "searching a value in an array using recursive functions", "body": "<p>There are a couple of things that are not correct with your code. The first is that you are using <code>7</code> for the <code>size</code> parameter of your <code>Search</code> function.</p>\n\n<p>You appear to be wanting to search the array linearly starting from the last index and working your way down to index <code>0</code>, so you need to have a check for that, otherwise your function will continue to work its way down stack memory until either a segmentation fault occurs, or you finally encounter memory that happens to have <code>value</code> stored there.</p>\n\n<p>Here's one of the many fixes you can do so that the function does what you expect. I will use <code>0</code> to represent failure to find the value you are looking for:</p>\n\n<pre><code>int Search(int *tab, int tam, int valor);\n\nint main(int argc, char** argv) {\n\n    int index;\n    int tab[5] = {12, 25, 3, 14, 18};\n\n    index = Search(tab, 5, 3); // Changed 7 to 5 to reflect the size of the array.\n\n    if(index == 1)\n        printf(\"You found the value!!\\n\\n\");\n    else\n        printf(\"NO LUCK!\\n\\n\");\n}\n\nint Search(int *tab, int size, int value) {\n\n    if (size &lt;= 0) // We've searched all values in the array\n        return 0;\n    else if (tab[size - 1] == value) // Array indexing starts at 0, so need to subtract 1 here.\n        return 1;\n    else\n        return Search(tab, size - 1, value); \n\n}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8522137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bef581a62251ec925b55842bb4c681e?s=128&d=identicon&r=PG&f=1", "display_name": "FDinis", "link": "https://stackoverflow.com/users/8522137/fdinis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1531992575, "answer_count": 1, "score": -3, "last_activity_date": 1531949413, "creation_date": 1531945009, "last_edit_date": 1531947587, "question_id": 51410335, "link": "https://stackoverflow.com/questions/51410335/searching-a-value-in-an-array-using-recursive-functions", "closed_reason": "Not suitable for this site", "title": "searching a value in an array using recursive functions", "body": "<p>Can someone explain to me why this isn't working? I've messed around many times but i can't seem to make it so it actually searches. Right know it skips the recursive part of the function.</p>\n\n<pre><code>int Search(int *tab, int tam, int valor);\n\nint main(int argc, char** argv) {\n\n    int index;\n    int tab[5] = {12, 25, 3, 14, 18};\n\n    index = Search(tab, 7, 3);\n\n    if(index == 1)\n        printf(\"You found the value!!\\n\\n\");\n    else\n        printf(\"NO LUCK!\\n\\n\");\n\n}\n\nint Search(int *tab, int size, int value){\n\n    if(tab[size] == value)\n        return 1;\n    else\n        return Search(tab, size - 1, value);\n\n}\n</code></pre>\n\n<p>EDIT: Thank you for everyone who helped, I realized that when I was trying to debug I would skip over the function instead of going into the function again. It's working now!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531942608, "post_id": 51409777, "comment_id": 89790919, "body": "In first case it&#39;s array, in the second one it&#39;s a pointer."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1531942621, "post_id": 51409777, "comment_id": 89790927, "body": "Because they&#39;re different things?"}, {"owner": {"reputation": 21, "user_id": 8632747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56c93ddb818e068d4ae17f40bd8598c?s=128&d=identicon&r=PG&f=1", "display_name": "Tapabrata Mukherjee", "link": "https://stackoverflow.com/users/8632747/tapabrata-mukherjee"}, "edited": false, "score": 0, "creation_date": 1531942701, "post_id": 51409777, "comment_id": 89790973, "body": "How it is returning 8?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531942719, "post_id": 51409777, "comment_id": 89790987, "body": "Pointer is 8 byte long on your platform..."}, {"owner": {"reputation": 21, "user_id": 8632747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56c93ddb818e068d4ae17f40bd8598c?s=128&d=identicon&r=PG&f=1", "display_name": "Tapabrata Mukherjee", "link": "https://stackoverflow.com/users/8632747/tapabrata-mukherjee"}, "edited": false, "score": 0, "creation_date": 1531942906, "post_id": 51409777, "comment_id": 89791093, "body": "Yeah I get it now. Thanks!"}], "owner": {"reputation": 21, "user_id": 8632747, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d56c93ddb818e068d4ae17f40bd8598c?s=128&d=identicon&r=PG&f=1", "display_name": "Tapabrata Mukherjee", "link": "https://stackoverflow.com/users/8632747/tapabrata-mukherjee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "closed_date": 1531942658, "answer_count": 0, "score": 0, "last_activity_date": 1531942524, "creation_date": 1531942524, "question_id": 51409777, "link": "https://stackoverflow.com/questions/51409777/return-of-sizeof", "closed_reason": "Duplicate", "title": "Return of sizeof()", "body": "<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    char arr[] = \"hello\";\n    printf(\"str = %s, %ld %ld\\n\",arr, sizeof(arr), sizeof(*arr) );\n\n    return 0;\n}\n</code></pre>\n\n<p>The above program returns: <code>str = hello, 6 1</code></p>\n\n<p>whereas,</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\nint main()\n{\n    char *arr = \"hello\";\n    printf(\"str = %s, %ld %ld\\n\",arr, sizeof(arr), sizeof(*arr) );\n\n    return 0;\n}\n</code></pre>\n\n<p>this program returns <code>str = hello, 8 1</code></p>\n\n<p>Why the returns of sizeof(arr) is different in these two cases?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "edited": false, "score": 2, "creation_date": 1531942527, "post_id": 51409751, "comment_id": 89790876, "body": "Arrays can only be initialized using the <code>= { ... };</code> syntax. They cannot be assigned to using that syntax."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531942547, "post_id": 51409751, "comment_id": 89790882, "body": "You can&#39;t assign arrays in C."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531942725, "post_id": 51409751, "comment_id": 89790990, "body": "You can <code>memcpy</code> an array. Only a simple variable type can be copied with <code>=</code> unless you have the data inside a <code>struct</code>. Then you can copy the whole <code>struct</code> with <code>=</code> operator."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1531944492, "last_edit_date": 1531944492, "creation_date": 1531942782, "answer_id": 51409832, "question_id": 51409751, "link": "https://stackoverflow.com/questions/51409751/error-expected-expression-while-initializing-char-array/51409832#51409832", "title": "&lt;error: expected expression&gt; while initializing char array", "body": "<p>Arrays can only be initialized using the <code>= { ... };</code> syntax. They cannot be assigned to using that syntax. You have to assign values to each element of the array after it has been initialized.</p>\n\n<p>One way to make your program work is to use:</p>\n\n<pre><code>char note[3] = {'C', '#', '4'};\n\nchar note_stops1[12] = {'C', '#', 'D', '#', 'E', 'F', '#', 'G', '#', 'A', '#', 'B'}; \nchar note_stops2[12] = {'C', 'b', 'D', 'b', 'E', 'F', 'b', 'G', 'b', 'A', 'b', 'B'}; \n\nchar* note_stops = (note[1] == '#' ? note_stops1 : note_stops2);\n// Now use note_stops after this.\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9810989"}, "edited": false, "score": 0, "creation_date": 1531943375, "post_id": 51409856, "comment_id": 89791312, "body": "This makes sense, thank you! I would approve your answer as well if I could"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1531942897, "last_edit_date": 1531942897, "creation_date": 1531942861, "answer_id": 51409856, "question_id": 51409751, "link": "https://stackoverflow.com/questions/51409751/error-expected-expression-while-initializing-char-array/51409856#51409856", "title": "&lt;error: expected expression&gt; while initializing char array", "body": "<p>Arrays in C can't be assigned to directly.  They can be <em>initialized</em>, but not assigned to.</p>\n\n<p>You'll need to copy the elements individually.  Better yet, create two arrays, one with each set of letters, and have a pointer point the the one you want to use.</p>\n\n<pre><code>char note[3] = {'C', '#', '4'};\nchar note_stops_sharp[] = {'C', '#', 'D', '#', 'E', 'F', '#', 'G', '#', 'A', '#', 'B'};\nchar note_stops_flat[] = {'C', 'b', 'D', 'b', 'E', 'F', 'b', 'G', 'b', 'A', 'b', 'B'};\nchar *note_stops;\n\nif (note[1] == '#') {\n    note_stops = note_stops_sharp;\n} else {\n    note_stops = note_stops_flat;\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9810989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 51409832, "answer_count": 2, "score": 0, "last_activity_date": 1531944492, "creation_date": 1531942403, "question_id": 51409751, "link": "https://stackoverflow.com/questions/51409751/error-expected-expression-while-initializing-char-array", "title": "&lt;error: expected expression&gt; while initializing char array", "body": "<p>Here is a simple code snippet:</p>\n\n<pre><code>char note[3] = {'C', '#', '4'};\nchar note_stops[12];\n\nif (note[1] == '#') {\n    note_stops= {'C', '#', 'D', '#', 'E', 'F', '#', 'G', '#', 'A', '#', 'B'};  // The symbols '#' represent sharp notes. (i.e. note_stops[3] is \"D#\")\n} else {\n    note_stops= {'C', 'b', 'D', 'b', 'E', 'F', 'b', 'G', 'b', 'A', 'b', 'B'};  // The symbols 'b' represent flat notes. (i.e. note_stops[3] is \"Eb\")\n}\n</code></pre>\n\n<p>Here is error code (ignore line numbers):</p>\n\n<pre><code>compose.c:29:24: error: expected expression\n    note_letters = {'C', 'b', 'D', 'b', 'E', 'F', 'b', 'G', 'b', 'A', 'b', 'B'};\n                   ^\ncompose.c:33:24: error: expected expression\n    note_letters = {'C', '#', 'D', '#', 'E', 'F', '#', 'G', '#', 'A', '#', 'B'};\n                   ^\n</code></pre>\n\n<p>I researched this error very much, but I can't seem to find (or realize) what's exactly wrong here. What is wrong with the code?</p>\n"}, {"tags": ["html", "c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1531940670, "post_id": 51409292, "comment_id": 89789989, "body": "Use <code>&amp;lt;</code> and <code>&amp;gt;</code> ?"}, {"owner": {"reputation": 2881, "user_id": 4139335, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/n7L2R.jpg?s=128&g=1", "display_name": "Michael Warner", "link": "https://stackoverflow.com/users/4139335/michael-warner"}, "edited": false, "score": 0, "creation_date": 1531941032, "post_id": 51409292, "comment_id": 89790186, "body": "For a list of characters <a href=\"https://www.freeformatter.com/html-entities.html\" rel=\"nofollow noreferrer\">freeformatter.com/html-entities.html</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531942120, "post_id": 51409292, "comment_id": 89790699, "body": "This question&#39;s own page source renders the angled brackets in the question with <code>#include &amp;amp;lt;stdio.h&amp;amp;gt;</code> but when I made a simple test page my browser did not render it correctly, although it did when using @EugeneSh. comment. Anyway this isn&#39;t a question about C. I have mistakenly thought that the <code>&lt;code&gt;</code> tag allowed you to post unadulterated code."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531942492, "post_id": 51409292, "comment_id": 89790865, "body": ". . . but the page source code does not use the <code>&lt;code&gt;</code> tag."}], "answers": [{"tags": [], "owner": {"reputation": 379, "user_id": 8356930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f279641064ec6918020302c98729721?s=128&d=identicon&r=PG&f=1", "display_name": "Jaspreet Singh", "link": "https://stackoverflow.com/users/8356930/jaspreet-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1531942164, "creation_date": 1531942164, "answer_id": 51409690, "question_id": 51409292, "link": "https://stackoverflow.com/questions/51409292/c-code-in-html-page/51409690#51409690", "title": "C code in HTML page", "body": "<p>It\u2019s because HTML will treat \u2018&lt;\u2018 as opening tag and will try to render it. You need to convert all the applicable characters to their HTML entities to prevent this, for example \nFor showing \u2018&lt;\u2018 you need to convert it to \u2018&amp;lt;\u2019 and for \u2018>\u2019 you need to convert it to \u2018&amp;gt;\u2019. There are some other characters which you will need to encode, some languages have built in function for this, example in PHP you can use \u2018htmlentities()\u2019 function. </p>\n"}, {"tags": [], "owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "is_accepted": false, "score": 0, "last_activity_date": 1532112062, "creation_date": 1532112062, "answer_id": 51448627, "question_id": 51409292, "link": "https://stackoverflow.com/questions/51409292/c-code-in-html-page/51448627#51448627", "title": "C code in HTML page", "body": "<p>Use a verbatim <code>&lt;[CDATA[</code> your C code <code>]]&gt;</code> in your HTML page, to nest your C code.  This allows all but the sequence <code>]]&gt;</code> in the quoted block.</p>\n"}], "owner": {"reputation": 11, "user_id": 10101482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa768759f96eb426eb821f000888ab38?s=128&d=identicon&r=PG&f=1", "display_name": "Steam", "link": "https://stackoverflow.com/users/10101482/steam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 381, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1532112062, "creation_date": 1531940566, "last_edit_date": 1531956318, "question_id": 51409292, "link": "https://stackoverflow.com/questions/51409292/c-code-in-html-page", "title": "C code in HTML page", "body": "<p>I have some C code with</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n</code></pre>\n\n<p>which should be shown on a web page. For this issue I use tag <code>pre</code> and <code>code</code> but unfortunately the angle brackets disappear.</p>\n\n<pre><code>#include stdio.h\n</code></pre>\n\n<p>What can I do to show the <code>stdio.h</code> with angle brackets?</p>\n"}, {"tags": ["c", "arguments"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939209, "post_id": 51408893, "comment_id": 89789156, "body": "It is not making any sense to call <code>isdigit</code> on <code>int</code>. Also <code>atoi</code> will return <code>0</code> on failure, which you won&#39;t be able to distinguish from the &quot;real&quot; <code>0</code>. Use <code>strtol</code> instead."}, {"owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939335, "post_id": 51408893, "comment_id": 89789215, "body": "The internet says: &quot;Function isdigit() takes a single argument in the form of an integer and returns the value of type int.&quot;"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939373, "post_id": 51408893, "comment_id": 89789239, "body": "Well, I kinda misspoke. <code>isdigit</code> is actually taking an <code>int</code>, but it is interpreting it as character code. But you give it an output of <code>atoi</code> which is a number already."}, {"owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939585, "post_id": 51408893, "comment_id": 89789363, "body": "I&#39;m sorry, that doesn&#39;t make sense. <code>isdigit()</code> can&#39;t take in <code>num</code> unless I use atoi to make <code>argv[i][j]</code> an int first."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531939658, "post_id": 51408893, "comment_id": 89789418, "body": "Ok, if it doesn&#39;t check the result of following: <code>isdigit(&#39;5&#39;)</code> versus <code>isdigit(5)</code>."}, {"owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939911, "post_id": 51408893, "comment_id": 89789584, "body": "So I just don&#39;t need the <code>atoi()</code> then since it takes in a <code>char</code> apparently"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531939993, "post_id": 51408893, "comment_id": 89789629, "body": "Correct. If you want your number as string, it should be sufficient."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531940035, "post_id": 51408893, "comment_id": 89789657, "body": "Just make sure not to overflow your <code>phone</code> array, and terminate it with <code>&#39;\\0&#39;</code>"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1531940319, "post_id": 51408893, "comment_id": 89789815, "body": "the phone number may is never typed as as bunch of digits without spaces, minuses parenthesizes or dots. For exmaple (555) 340-345-6789"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531941985, "post_id": 51408893, "comment_id": 89790632, "body": "As the phone number may contain leading zeros, calling <code>atoi()</code> or <code>strtol()</code>, etc, will loose that information.  To parse 10 <i>digits</i>, code character processing."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1532094086, "post_id": 51408893, "comment_id": 89857707, "body": "<code>atoi(3)</code> needs a <code>char *</code> (a null terminated string) as parameter, and you are passing it a <code>char</code> value.  It is normal that <code>atoi()</code> doesn&#39;t work.  Check the documentation of <code>atoi(char *)</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10058533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e84df9d861a7e12fad992c9c21791f7?s=128&d=identicon&r=PG&f=1", "display_name": "sdoe", "link": "https://stackoverflow.com/users/10058533/sdoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1531999278, "last_edit_date": 1531999278, "creation_date": 1531987841, "answer_id": 51417556, "question_id": 51408893, "link": "https://stackoverflow.com/questions/51408893/parsing-only-the-numbers-from-given-arguments/51417556#51417556", "title": "Parsing only the numbers from given arguments", "body": "<p>As <a href=\"https://stackoverflow.com/users/2410359/chux\">chux</a> pointed out you have to parse the string character by character. atoi() and strtol() will read all digits (and throw away leading zeros) until a non-digit is met which makes it difficult for you to control the number of characters read.</p>\n\n<p>Try out something along the line</p>\n\n<pre><code>int main (int argc, char *argv [])\n{\n    char phone_number [14];\n    int  digit_count;       /* counter for digits */\n    int  p;                 /* pointer into phone_number */\n    int  i, a;              /* loop variables */\n    int  arg_len;           /* no. of chars in current arg */\n\n    /* loop over arguments */\n    for (a=1; a&lt;argc; a++) \n        {\n        arg_len = strlen (argv [a]);\n        phone_number [0] = '(';\n        p=1;\n        digit_count=0;\n\n        /* parse current argument */\n        for (i=0; i&lt;arg_len; i++) \n            {\n            /* safe digit */\n            if (isdigit (argv [a][i]))\n                {\n                phone_number [p] = argv[a][i];\n                p++;\n                digit_count++;\n                }\n\n            /* insert format */\n            if (p == 4)\n                {\n                phone_number [p] = ')';\n                p++;\n                }\n            if (p == 8)\n                {\n                phone_number [p] = '-';\n                p++;\n                }\n\n            /* read ten digits -&gt; finished */\n            if (digit_count == 10)\n                {\n                phone_number [p] = '\\0';\n                break;\n                }\n            }\n\n        /* check for enough digits */\n        if (digit_count &lt; 10)\n            {\n            printf (\"Argument had only %d digits\\n!\", digit_count);\n            continue;\n            }\n\n        printf (\"Phone_number (%d): %s\\n\", a, phone_number);\n        }\n}\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>$ ./a.out hi1234567890 abc123456jfhj789649 a75849gfj5\nPhone_number (1): (123)456-7890\nPhone_number (2): (123)456-7896\nArgument 3 had only 6 digits\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9263251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc55eff1c67f29f511338f8b3a15796?s=128&d=identicon&r=PG&f=1", "display_name": "kelp99", "link": "https://stackoverflow.com/users/9263251/kelp99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531999278, "creation_date": 1531939081, "last_edit_date": 1531939240, "question_id": 51408893, "link": "https://stackoverflow.com/questions/51408893/parsing-only-the-numbers-from-given-arguments", "title": "Parsing only the numbers from given arguments", "body": "<p>How do you parse out only the first 10 numbers from any given number of arguments in C, and then output it as a telephone number? For example, if a file is called <code>function</code> and the given command is <code>function hi1234567890</code> it would return <code>(123)456-7890</code>. Similarily, if the user inputs three arguments <code>function 123 hi 456</code> it might return something saying there aren't enough numbers. Here's what I have so far:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main (int argc, char *argv[]) {\n   char phone[13]; // array to store phone number\n\n   int i;\n   int j;\n   int len;\n   int num;\n\n   for(i = 1; i &lt; argc; i++) {\n      len = strlen(argv[i]);\n      for(j = 0; j &lt; len; j++) {\n         num = atoi(argv[i][j]);\n         if ( isdigit(num) != 0 ) {\n            phone[j] = argv[i][j];\n         }\n      }\n   }\n}\n</code></pre>\n\n<p>This is definitely not working, there's something wrong with the atoi() which in turn is causing the isdigit() to not work and I'm not storing it in the array correctly.</p>\n"}, {"tags": ["c++", "c", "cmake", "grpc", "c-ares"], "comments": [{"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "edited": false, "score": 0, "creation_date": 1539348191, "post_id": 51407735, "comment_id": 92481104, "body": "This has been making me miserable for a while now. :-( Anyone able to help me on this?"}, {"owner": {"reputation": 123, "user_id": 5323364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf9c3f7f70bd3463e9c836eb38186dac?s=128&d=identicon&r=PG&f=1", "display_name": "Happy", "link": "https://stackoverflow.com/users/5323364/happy"}, "edited": false, "score": 0, "creation_date": 1545300488, "post_id": 51407735, "comment_id": 94580237, "body": "Have you been able to resolve this issue? I probably met the same issue, but I can&#39;t resolve it either."}, {"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "reply_to_user": {"reputation": 123, "user_id": 5323364, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/cf9c3f7f70bd3463e9c836eb38186dac?s=128&d=identicon&r=PG&f=1", "display_name": "Happy", "link": "https://stackoverflow.com/users/5323364/happy"}, "edited": false, "score": 0, "creation_date": 1550347474, "post_id": 51407735, "comment_id": 96238129, "body": "Hi, not yet. I wasn&#39;t able resolve that yet.. :-("}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "edited": false, "score": 0, "creation_date": 1559426899, "post_id": 56386791, "comment_id": 99418634, "body": "Thanks so much for sharing this. seem like my problem is gone now. I took the same approach as you to limit the impact"}], "tags": [], "owner": {"reputation": 3035, "user_id": 131129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35d8f2b3e2651182fea52c8bfd4d06cd?s=128&d=identicon&r=PG", "display_name": "opello", "link": "https://stackoverflow.com/users/131129/opello"}, "is_accepted": false, "score": 1, "last_activity_date": 1559258080, "creation_date": 1559258080, "answer_id": 56386791, "question_id": 51407735, "link": "https://stackoverflow.com/questions/51407735/bitbake-grpc-cross-compile-configure-failing-with-error-c-arescares-references/56386791#56386791", "title": "bitbake grpc cross compile/configure failing with error c-ares::cares references the file /usr/lib/libcares.so.2.2.0", "body": "<p>I came across this issue today when building a newer gRPC in an older (daisy) BitBake environment.  The solutions I came to were either backporting <a href=\"https://git.openembedded.org/openembedded-core/commit/meta/classes/cmake.bbclass?id=c03b32bd71dbe04f2f239556fea0b53215e403d7\" rel=\"nofollow noreferrer\">this upstream change to the cmake.bbclass</a> or hacking in the updated variable definitions in a .bbappend to the cmake invocation by way of the <code>EXTRA_OECMAKE</code> variable.</p>\n\n<p>I chose the latter, as I only seemed to need this for c-ares, and wanted to limit my impact.  I did not end up digging into the difference between how c-ares and other gRPC dependencies (e.g. gflags) generate CMake export targets files.  I assume there's some way the ultimate target paths are generated within the respective projects' CMakeLists.txt files.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>diff --git a/meta/classes/cmake.bbclass b/meta/classes/cmake.bbclass\nindex b18152a8ed..5203d8aca1 100644\n--- a/meta/classes/cmake.bbclass\n+++ b/meta/classes/cmake.bbclass\n@@ -108,15 +108,15 @@ cmake_do_configure() {\n      ${OECMAKE_SITEFILE} \\\n      ${OECMAKE_SOURCEPATH} \\\n      -DCMAKE_INSTALL_PREFIX:PATH=${prefix} \\\n-     -DCMAKE_INSTALL_BINDIR:PATH=${bindir} \\\n-     -DCMAKE_INSTALL_SBINDIR:PATH=${sbindir} \\\n-     -DCMAKE_INSTALL_LIBEXECDIR:PATH=${libexecdir} \\\n+     -DCMAKE_INSTALL_BINDIR:PATH=${@os.path.relpath(d.getVar('bindir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_SBINDIR:PATH=${@os.path.relpath(d.getVar('sbindir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_LIBEXECDIR:PATH=${@os.path.relpath(d.getVar('libexecdir', True), d.getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_SYSCONFDIR:PATH=${sysconfdir} \\\n-     -DCMAKE_INSTALL_SHAREDSTATEDIR:PATH=${sharedstatedir} \\\n+     -DCMAKE_INSTALL_SHAREDSTATEDIR:PATH=${@os.path.relpath(d.getVar('sharedstatedir', True), d.  getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_LOCALSTATEDIR:PATH=${localstatedir} \\\n-     -DCMAKE_INSTALL_LIBDIR:PATH=${libdir} \\\n-     -DCMAKE_INSTALL_INCLUDEDIR:PATH=${includedir} \\\n-     -DCMAKE_INSTALL_DATAROOTDIR:PATH=${datadir} \\\n+     -DCMAKE_INSTALL_LIBDIR:PATH=${@os.path.relpath(d.getVar('libdir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_INCLUDEDIR:PATH=${@os.path.relpath(d.getVar('includedir', True), d.getVar('prefix', True))} \\\n+     -DCMAKE_INSTALL_DATAROOTDIR:PATH=${@os.path.relpath(d.getVar('datadir', True), d.getVar('prefix', True))} \\\n      -DCMAKE_INSTALL_SO_NO_EXE=0 \\\n      -DCMAKE_TOOLCHAIN_FILE=${WORKDIR}/toolchain.cmake \\\n      -DCMAKE_VERBOSE_MAKEFILE=1 \\\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 1499058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e1bfbd18c317be0d087fe2c6b4dbef0?s=128&d=identicon&r=PG", "display_name": "CyA", "link": "https://stackoverflow.com/users/1499058/cya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559258080, "creation_date": 1531934482, "last_edit_date": 1538664567, "question_id": 51407735, "link": "https://stackoverflow.com/questions/51407735/bitbake-grpc-cross-compile-configure-failing-with-error-c-arescares-references", "title": "bitbake grpc cross compile/configure failing with error c-ares::cares references the file /usr/lib/libcares.so.2.2.0", "body": "<p>I am having issues with finding c-ares dependencies when building grpc in open-embedded.Error in the log when looking for the dependency c-ares during configure is shown in the log as -</p>\n\n<p>--</p>\n\n<pre><code>Found ZLIB: ....../poky/build/tmp-glibc/sysroots/arm7/usr/lib/libz.so (found version \"1.2.8\")\nCMake Error at ....../poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake:70 (message):\n   The imported target \"c-ares::cares\" references the file\n      \"/usr/lib/libcares.so.2.2.0\"\n\nbut this file does not exist.  Possible reasons include:\n\n   * The file was deleted, renamed, or moved to another location.\n\n   * An install or uninstall procedure did not complete successfully.\n\n   * The installation package was faulty and contained\n\n    \"/home/...../poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake\"\n   but not all the files it references.\n</code></pre>\n\n<p>--</p>\n\n<p>Issue seem to be how cmake has configured the import prefix for c-ares,which is configured as below in  file - poky/build/tmp-glibc/sysroots/arm7/usr/lib/cmake/c-ares/c-ares-targets.cmake. I believe it should be the path into the target staging directory</p>\n\n<p>set(_IMPORT_PREFIX \"/usr\")</p>\n\n<p>Can someone please help me identify the issue here? what needs to be configured in the c-ares recipe in order to get the  _IMPORT_PREFIX right??\nAny help is much appreciated.\nThanks</p>\n"}, {"tags": ["c", "gcc", "parallel-processing", "openmp"], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "edited": false, "score": 0, "creation_date": 1531938985, "post_id": 51408217, "comment_id": 89789058, "body": "Yes,I removed OpenMP and got the same issue, turns out that when I write out of bound for <code>non_primes</code>, it overwrites onto <code>primes</code>. so adding a function to check if the value already exists in <code>non_primes</code>  resolves the issue for both single and multithreaded solutions."}, {"owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "reply_to_user": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "edited": false, "score": 0, "creation_date": 1531939319, "post_id": 51408217, "comment_id": 89789205, "body": "@AnkurRanjan Yes, but for it to work reliable with multithreading you have to ensure that the data access of the variables is atomic. See also the other answer."}], "tags": [], "owner": {"reputation": 2723, "user_id": 9017315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3229c3b31dc467c858d3d27f88c41c11?s=128&d=identicon&r=PG&f=1", "display_name": "Osiris", "link": "https://stackoverflow.com/users/9017315/osiris"}, "is_accepted": false, "score": 3, "last_activity_date": 1531936686, "last_edit_date": 1531936686, "creation_date": 1531936335, "answer_id": 51408217, "question_id": 51407695, "link": "https://stackoverflow.com/questions/51407695/values-stored-in-array-changed-in-openmp-gcc/51408217#51408217", "title": "values stored in array changed in OpenMP gcc", "body": "<p>If you remove OpenMP you still get the wrong output, since you are writing out of bounds of the <code>non_primes</code> array.</p>\n\n<p>It is correct that there can not be more than <code>n</code> non prime numbers less than <code>n</code>, but you are writing some values more than once.</p>\n\n<p>For example at <code>i=2</code> you write every even number except 2 in the <code>non_primes</code> array.\nAt <code>i=3</code> you write 6,9,12,15,18,.. in it, where the even numbers are now twice element of the array. You need to check if the number is already an element of the array.</p>\n"}, {"comments": [{"owner": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "edited": false, "score": 0, "creation_date": 1531939407, "post_id": 51408311, "comment_id": 89789265, "body": "Turns out the problem is that <code>primes</code> is getting overwritten by out of bound values of  <code>non_primes</code> for some reason I was not getting out of bounds exception even for single threaded execution."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "edited": false, "score": 0, "creation_date": 1531939704, "post_id": 51408311, "comment_id": 89789451, "body": "@AnkurRanjan, C does not promise exceptions for out of bounds array accesses.  In any case, that solving the out-of-bounds writing issue seems to give you the expected program behavior does not mean the data races and dependency problems can be ignored.  As someone learning about parallel programming, you should be <i>especially</i> interested in understanding these issues."}, {"owner": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "edited": false, "score": 0, "creation_date": 1531941073, "post_id": 51408311, "comment_id": 89790212, "body": "Duly noted, increasing the number of threads and giving a bigger input does indeed cause data races and dependency problems, giving negative and incorrect numbers.Thanks for mentioning that :)"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 4, "last_activity_date": 1531936700, "creation_date": 1531936700, "answer_id": 51408311, "question_id": 51407695, "link": "https://stackoverflow.com/questions/51407695/values-stored-in-array-changed-in-openmp-gcc/51408311#51408311", "title": "values stored in array changed in OpenMP gcc", "body": "<p>You have two problems, one tactical and one strategic.</p>\n\n<p><strong>The tactical problem</strong> is that OpenMP does not relieve you of caring about data races.  The OpenMP threads share variables <code>primes</code> and <code>prime_index</code>, among others.  You rely on it.  But all your threads both read and write <code>prime_index</code>, which is not atomic nor even <code>volatile</code>, without any inter-thread synchronization.  This produces a data race, and therefore the behavior of your program is undefined.  From a language perspective, that's the end of the story.  \"Undefined\" means what it says.</p>\n\n<p>In practice, the usual manifestations of data races involve different threads not seeing each others' writes to the shared variable in question, or seeing them in surprising orders.  Something along those lines appears to be what is happening here.</p>\n\n<p><strong>The strategic problem</strong> is that the Sieve of Eratosthenses is a poor choice for parallelization.  Or, at least its outer loop is.  This is because of data dependencies across (outer) loop iterations.  For the Sieve to work properly, the multiples of each prime need to be sieved out <em>in order</em>, because the associated prime test boils down, in words, to \"has candidate X been sieved out as a multiple of a lesser number?\"  You cannot answer that reliably if iterations of the outer loop run in parallel rather than serial.</p>\n\n<hr>\n\n<p>These two problems are separate and independent, in that solving the data race problem would not solve the data dependency problem, and in that it is possible, with a lot of work, to write a parallel Sieve of Eratosthenes that correctly observes data dependencies (I've actually done it, albeit in Java, not C), and that such an approach could still be broken because of data races.</p>\n\n<p>By the way, even the correct and valid parallel Sieve is affected by the data dependencies, in that satisfying them limits it to having a pretty poor speedup factor.</p>\n"}], "owner": {"reputation": 133, "user_id": 9940646, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kJl9AUYnwMU/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq33nGg7vbW5HvgvvN4RwgW4CepYXg/mo/photo.jpg?sz=128", "display_name": "Ankur Ranjan", "link": "https://stackoverflow.com/users/9940646/ankur-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531943559, "creation_date": 1531934354, "last_edit_date": 1531943559, "question_id": 51407695, "link": "https://stackoverflow.com/questions/51407695/values-stored-in-array-changed-in-openmp-gcc", "title": "values stored in array changed in OpenMP gcc", "body": "<p>I recently started exploring OpenMP using gcc.\nBasically I am executing this code for demonstrateing sieve of Eratosthenes.</p>\n\n<pre><code>void main() {\n    int n, iterate_limit;\n\n    printf(\"Enter the number limit for sieve of erathoros:\");\n    scanf(\"%d\", &amp;n);\n    iterate_limit = (int) sqrt((double) n);\n    printf(\"iterate limit is %d\\n\", iterate_limit);\n    int primes[n], prime_index = 0;\n    int non_primes[n], non_prime_index = 0;\n\n    #pragma omp parallel for\n    for (int i = 2; i &lt;= iterate_limit; i++) {\n        if (isprime(i) == 1) {\n            int num = i;\n\n            printf(\"prime is %d\\n\", i);\n            primes[prime_index] = num;\n            prime_index++;\n            num += i;\n            while (num &lt; n) {\n                non_primes[non_prime_index] = num;\n                non_prime_index++;\n                num += i;\n            }\n        }\n    }\n\n    printf(\"primes are\\n\"); \n    for (int i = 0; i &lt; prime_index; i++) {\n        printf(\"%d\\n \", primes[i]);  \n    }\n}\n</code></pre>\n\n<p>Ideally, the array <code>primes</code> should contain all the numbers whose multiples are to be eliminated, which it does for an input of 25 or 50.  But strangely enough, when giving a bigger number as input such as 99 or 125 the values in the <code>primes</code> array are different from expected.\nEven though the <code>printf(\"prime is %d\\n\",i);</code> gives valid output.\nHere is the output for 125 as input:</p>\n\n<pre><code>Enter the number limit for sieve of erathoros:125\niterate limit is 11\n[New LWP 17676]\n[New LWP 17677]\n[New LWP 17678]\nprime is 11\nprime is 5\nprime is 7\nprime is 2\nprime is 3\nprimes are\n60\n 63\n 66\n 69\n 72\n [LWP 17676 exited]\n[LWP 17677 exited]\n[LWP 17674 exited]\n[Inferior 1 (process 17674) exited normally]\n</code></pre>\n\n<p>Why I am getting 60,63,66,69,72 instead of 2,3,5,7,11?</p>\n\n<p>I am running Ubuntu 18.</p>\n\n<p>EDIT:</p>\n\n<p>As pointed out by <a href=\"https://stackoverflow.com/users/9017315/osiris\">Osiris</a>,I was not checking for duplicates in my <code>non_primes</code> array which seems to overwrite upon my <code>primes</code> array. Duplicate elimination did provide a temporary solution.\nBut increasing the input number or increasing the number of threads gave incorrect results due to data races as mentioned by <a href=\"https://stackoverflow.com/users/2402272/john-bollinger\">John Bollinger</a></p>\n"}, {"tags": ["c", "bit-manipulation", "byte", "bitwise-operators", "bit"], "comments": [{"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 3, "creation_date": 1531933398, "post_id": 51407372, "comment_id": 89786097, "body": "Your first line should be sufficient - from the &quot;Z axis data register&quot; section, <i>The sign extension bits (B[15:12], denoted as SX in the ZDATA_H bit map that follows) have the same value as the MSB (B11).</i>"}], "answers": [{"tags": [], "owner": {"reputation": 76206, "user_id": 108205, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef459127edc89cc575d80a73cd8c567a?s=128&d=identicon&r=PG", "display_name": "jsbueno", "link": "https://stackoverflow.com/users/108205/jsbueno"}, "is_accepted": false, "score": 0, "last_activity_date": 1531935397, "last_edit_date": 1531935397, "creation_date": 1531935006, "answer_id": 51407890, "question_id": 51407372, "link": "https://stackoverflow.com/questions/51407372/reading-two-8-bit-registers-into-12-bit-value-of-an-adxl362-in-c/51407890#51407890", "title": "Reading two 8 bit registers into 12 bit value of an ADXL362 in C", "body": "<p>You just have to do:</p>\n\n<pre><code>signed short number;\n\nnumber = Z_data_H &lt;&lt; 8 | Z_data_L;\n</code></pre>\n\n<p>The shift left by 8 bit combined with the lower bits you already\nhad figured out are combining the 2 bytes correctly. Just use the appropriate data size to have the C code recoginize the sign of the 12 bit number correctly.</p>\n\n<p>Note that <code>short</code> not necessarily refers to a 16bit value, depending on your compiler and architecture - so, you might want to attempt to that. </p>\n"}, {"tags": [], "owner": {"reputation": 39687, "user_id": 79566, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edad7f3ab41c3bdfdf851759dce5c33b?s=128&d=identicon&r=PG", "display_name": "bta", "link": "https://stackoverflow.com/users/79566/bta"}, "is_accepted": true, "score": 0, "last_activity_date": 1531935240, "creation_date": 1531935240, "answer_id": 51407946, "question_id": 51407372, "link": "https://stackoverflow.com/questions/51407372/reading-two-8-bit-registers-into-12-bit-value-of-an-adxl362-in-c/51407946#51407946", "title": "Reading two 8 bit registers into 12 bit value of an ADXL362 in C", "body": "<p>Your first line should be what you need:</p>\n\n<pre><code>int16_t number;\nnumber = (Z_data_H &lt;&lt; 8) | Z_data_L;\n</code></pre>\n\n<p>The sign-extension bits mean that you can read the value as if it was a 16-bit signed integer.  The <em>value</em> will simply never be outside the range of a 12-bit integer.  It's important that you leave those bits intact in order to handle negative values correctly.</p>\n"}], "owner": {"reputation": 23, "user_id": 10100961, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JRUyisAwH_g/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rtjtC8c8qQBD13ET1IYeepqe-YGA/mo/photo.jpg?sz=128", "display_name": "Reed H", "link": "https://stackoverflow.com/users/10100961/reed-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 51407946, "answer_count": 2, "score": 1, "last_activity_date": 1531935397, "creation_date": 1531933148, "last_edit_date": 1531934480, "question_id": 51407372, "link": "https://stackoverflow.com/questions/51407372/reading-two-8-bit-registers-into-12-bit-value-of-an-adxl362-in-c", "title": "Reading two 8 bit registers into 12 bit value of an ADXL362 in C", "body": "<p>I'm querying an <em>ADXL362 Digital Output MEMS Accelerometer</em> for its axis data which it holds as two 8 bit registers which combine to give a 12 bit value and I'm trying to figure out how to combine those values. I've never been good at bitwise manipulation so any help would be greatly appreciated. I would imagine it is something like this:</p>\n\n<pre><code>number = Z_data_H &lt;&lt; 8 | Z_data_L;\nnumber  = (number &amp; ~(1&lt;&lt;13)) | (0&lt;&lt;13);\nnumber  = (number &amp; ~(1&lt;&lt;14)) | (0&lt;&lt;14);\nnumber  = (number &amp; ~(1&lt;&lt;15)) | (0&lt;&lt;15);\nnumber  = (number &amp; ~(1&lt;&lt;16)) | (0&lt;&lt;16);\n</code></pre>\n\n<p><a href=\"http://www.analog.com/media/en/technical-documentation/data-sheets/ADXL362.pdf\" rel=\"nofollow noreferrer\">ADXL362 data sheet</a> (page 26)</p>\n\n<p>Z axis data register\n<img src=\"https://i.stack.imgur.com/QNqDq.png\" alt=\"Z axis data register\"></p>\n"}, {"tags": ["c", "armcc"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1531932637, "post_id": 51407170, "comment_id": 89785680, "body": "I&#39;d say you should be getting a like warning for both.  Insure all warnings are enabled."}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1531932638, "post_id": 51407170, "comment_id": 89785681, "body": "Is 0xFFFFFFFF taken as unsigned 2^32, in which case it would be outside the range of signed int? Try (int)0xFFFFFFFF"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531932968, "post_id": 51407170, "comment_id": 89785831, "body": "@chux I guess the warnings for these two things are given on different levels. Moreover it&#39;s ARM compiler where each warning type can be suppressed specifically, so one should check it is not.."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531933034, "post_id": 51407170, "comment_id": 89785871, "body": "Do you get a warning if you declare it <code>const int</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531933192, "post_id": 51407170, "comment_id": 89785975, "body": "Should be something like <code>#68-D: integer conversion resulted in a change of sign</code>.  <a href=\"http://www.keil.com/support/man/docs/armerr/armerr_dom1365070466238.htm\" rel=\"nofollow noreferrer\">Like here</a>"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1531933363, "post_id": 51407170, "comment_id": 89786079, "body": "@iVoid <code>(int)0xFFFFFFFF</code> may work, yet conceptual, I&#39;d re-code as <code>FEBRUARY = -1</code>."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531933401, "post_id": 51407170, "comment_id": 89786101, "body": "Probaby because these are two different things. First one is defining a constant, second one is assigning a variable. So different conversion rules apply here."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1531933530, "post_id": 51407170, "comment_id": 89786174, "body": "<a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.7.2.2p2\" rel=\"nofollow noreferrer\">From here</a>: <i>The expression that defines the value of an enumeration constant shall be an integer constant expression that has a value representable as an int.</i>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1531934319, "post_id": 51407170, "comment_id": 89786591, "body": "... and that&#39;s a language <i>constraint</i>, so conforming compilers are obligated to issue a diagnostic when it is violated.  Conversion of an out-of-range value to a signed integer type, whether explicit or implicit, is not a constraint violation."}, {"owner": {"reputation": 41, "user_id": 10100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398459eed6648e08a2d34f697c7fbc3?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/10100891/quest"}, "reply_to_user": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1531973969, "post_id": 51407170, "comment_id": 89799847, "body": "@iVoid,chux: Yes (int)0xFFFFFFFF does work but what is not clear to me is why an explicit cast to int is needed when 0xFFFFFFFF is still a valid int and that is the reason why &quot;int max = 0xFFFFFFFF&quot; did not give an error."}, {"owner": {"reputation": 41, "user_id": 10100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398459eed6648e08a2d34f697c7fbc3?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/10100891/quest"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531974237, "post_id": 51407170, "comment_id": 89799918, "body": "@John, Eugene: Sorry about being a bit repetitive here but I am not seeing how 0xFFFFFFFF is not a value that is representable as int. This is still -1 (assuming 2&#39;s compliment) right?"}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1531990785, "post_id": 51407170, "comment_id": 89807742, "body": "@Quest, I&#39;m hypothesizing the difference might be that you&#39;re not specifying the literal as unsigned. <code>0xFFFFFFFFU</code> is forcibly unsigned, whereas <code>0xFFFFFFFF</code> is no suffix. But as per the standard, if a hex literal without a suffix doesn&#39;t fit in <code>signed int</code>, <code>unsigned int</code> is tried next before assigning it a <code>long int</code> type. Hence, <code>0xFFFFFFFF</code> without <code>U</code> suffix is first tried for <code>signed int</code> where it doesn&#39;t fit and then <code>unsigned int</code> should be tried for type fitting, where it would fit. I&#39;m not sure why ARM&#39;s compiler treats it differently."}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1531991235, "post_id": 51407170, "comment_id": 89807998, "body": "Further reading on integer literal suffixes and <code>U</code> suffix. <a href=\"https://stackoverflow.com/questions/45621041/defending-u-suffix-after-hex-literals\" title=\"defending u suffix after hex literals\">stackoverflow.com/questions/45621041/&hellip;</a> and <a href=\"https://stackoverflow.com/questions/8108642/type-of-integer-literals-not-int-by-default\" title=\"type of integer literals not int by default\">stackoverflow.com/questions/8108642/&hellip;</a>"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "edited": false, "score": 0, "creation_date": 1532040276, "post_id": 51407170, "comment_id": 89836184, "body": "@ivoid Why do you think Arm compiler is treating it differently? It is not..."}, {"owner": {"reputation": 591, "user_id": 7791328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1TP4d.png?s=128&g=1", "display_name": "iVoid", "link": "https://stackoverflow.com/users/7791328/ivoid"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1532070892, "post_id": 51407170, "comment_id": 89843914, "body": "@EugeneSh. In this context, ARM compiler is giving the warning - I meant in that sense. But correlating with your replies on integer constant expression - I guess ARM compiler is treating it properly as per standard only."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1532090082, "post_id": 51407170, "comment_id": 89855122, "body": "first example is definition of an enumeration, which many implementations do with a limited set of values.  enums are internally represented as integers (can be of different size than <code>int</code>, e.g. byte size) and so, you can get a warning from a value as large as <code>0xffffffff</code>.  Assume your <code>enum</code>s can be limited in range."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1532618746, "post_id": 51407170, "comment_id": 90052509, "body": "@Quest, Sorry to return so late to the conversation, but no, the integer constant <code>0xFFFFFFFF</code> is <i>not</i> -1 any more than is <code>99999999</code> or any other all-nines decimal constant.  Hex constants correspond to positive numbers, but <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.4.4.1p5\" rel=\"nofollow noreferrer\">their types are determined from their values and type suffix</a>.  They are always positive, which is not only natural, but also necessary for the type determination rules to work consistently."}], "answers": [{"tags": [], "owner": {"reputation": 305, "user_id": 6729061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KV6WY.jpg?s=128&g=1", "display_name": "sbh", "link": "https://stackoverflow.com/users/6729061/sbh"}, "is_accepted": false, "score": 2, "last_activity_date": 1547393967, "creation_date": 1547393967, "answer_id": 54170427, "question_id": 51407170, "link": "https://stackoverflow.com/questions/51407170/why-does-arm-treat-0xffffffff-as-out-of-int-range-for-enums-but-not-for-assi/54170427#54170427", "title": "Why does ARM treat &quot;0xFFFFFFFF&quot; as out of &quot;int&quot; range for enums but not for assignment?", "body": "<p>Int assignment produces -1 so its technically legal. Per Arm spec enum is implemented using smallest integer type so it produces error.</p>\n\n<p>Enumerations\nAn object of type enum is implemented in the smallest integral type that contains the range of the enum. The storage type of an enum is the first of the following, according to the range of the enumerators in the enum:</p>\n\n<ul>\n<li>unsigned char if not using --enum_is_int</li>\n<li>signed char if not using --enum_is_int</li>\n<li>unsigned short if not using --enum_is_int</li>\n<li>signed short if not using --enum_is_int</li>\n<li>signed int</li>\n<li>unsigned int except C with --strict</li>\n<li>signed long long except C with --strict</li>\n<li>unsigned long long except C with --strict.</li>\n</ul>\n\n<p>Implementing enum in this way can reduce data size. The command-line option --enum_is_int forces the underlying type of enum to at least as wide as int.</p>\n"}], "owner": {"reputation": 41, "user_id": 10100891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4398459eed6648e08a2d34f697c7fbc3?s=128&d=identicon&r=PG&f=1", "display_name": "Quest", "link": "https://stackoverflow.com/users/10100891/quest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1547393967, "creation_date": 1531932340, "last_edit_date": 1531932461, "question_id": 51407170, "link": "https://stackoverflow.com/questions/51407170/why-does-arm-treat-0xffffffff-as-out-of-int-range-for-enums-but-not-for-assi", "title": "Why does ARM treat &quot;0xFFFFFFFF&quot; as out of &quot;int&quot; range for enums but not for assignment?", "body": "<p>I am trying to compile the following code in C (armcc file.c):</p>\n\n<pre><code>typedef enum A\n{\n    JANUARY,\n    FEBRUARY= 0xFFFFFFFF  /* Warning seen on this line */\n}A;\n\nint main()\n{\n    int max = 0xFFFFFFFF; /* No warning seen for this line*/\n    ...\n}\n</code></pre>\n\n<p>I get a warning only for the enum assignment and not for integer variable assignment though in my view no warning should be seen for both.</p>\n\n<p>Warning is below:</p>\n\n<blockquote>\n  <p>Warning:  <code>#66-D</code>: enumeration value is out of \"int\" range\n                            <code>FEBRUARY= 0xFFFFFFFF</code></p>\n</blockquote>\n\n<p>Am I missing something here?</p>\n"}, {"tags": ["c", "pointers", "for-loop"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531931283, "post_id": 51406889, "comment_id": 89784884, "body": "This is unreadable. Format the code properly."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1531931418, "post_id": 51406889, "comment_id": 89784974, "body": "Please don&#39;t post images of code and/or data and/or results. Instead, please use text. Thanks."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1531931441, "post_id": 51406889, "comment_id": 89784990, "body": "Rather than incrementing each pointer by <code>i</code> in each step of the loop, you should only be incrementing by 1."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1531931845, "post_id": 51406889, "comment_id": 89785257, "body": "Read <a href=\"https://ericlippert.com/2014/03/05/how-to-debug-small-programs/\" rel=\"nofollow noreferrer\">ericlippert.com/2014/03/05/how-to-debug-small-programs</a> for some tips about how to debug your code."}, {"owner": {"reputation": 58, "user_id": 9353691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796e5548ed190c3eba9311248a500254?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Yi", "link": "https://stackoverflow.com/users/9353691/sam-yi"}, "edited": false, "score": 0, "creation_date": 1531932280, "post_id": 51406889, "comment_id": 89785482, "body": "Thanks for the help everyone, and it was indeed a simple logical error, though this does beg the question of why the IDE is still outputting the correct results/misleading me to think the code is correct."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1531932703, "post_id": 51406889, "comment_id": 89785703, "body": "Because by pure luck, the memory locations you&#39;re accessing beyond the bounds of your array aren&#39;t being used by other parts of your code. It&#39;s all undefined behaviour though - sometimes your luck will hold out and other times it will fail horribly"}, {"owner": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1531932905, "post_id": 51406889, "comment_id": 89785794, "body": "If I may, can I ask why are you using all those pointers instead of, say <code>interest[i] = balance[i - 1] * monthlyInterestRate;</code> (I&#39;m not sure what&#39;s the exact formula are you trying to implement)?"}, {"owner": {"reputation": 58, "user_id": 9353691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796e5548ed190c3eba9311248a500254?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Yi", "link": "https://stackoverflow.com/users/9353691/sam-yi"}, "reply_to_user": {"reputation": 9301, "user_id": 4944425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05592a58619d128e2eee1c3c17801e76?s=128&d=identicon&r=PG&f=1", "display_name": "Bob__", "link": "https://stackoverflow.com/users/4944425/bob"}, "edited": false, "score": 0, "creation_date": 1531933066, "post_id": 51406889, "comment_id": 89785891, "body": "@Bob__ Assignment requirements.."}, {"owner": {"reputation": 58, "user_id": 9353691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796e5548ed190c3eba9311248a500254?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Yi", "link": "https://stackoverflow.com/users/9353691/sam-yi"}, "reply_to_user": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1531933479, "post_id": 51406889, "comment_id": 89786152, "body": "@ChrisTurner Yes, I don&#39;t think I thought critically enough about the difference about how the Cloud9 IDE (browser based) would store memory."}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531945042, "post_id": 51406889, "comment_id": 89792103, "body": "You must check the <b>return</b> of <code>scanf</code> (otherwise you have no way to know whether you are processing valid data) and <code>ipoint = &amp;interest[0];</code> is equivalent to <code>ipoint = interest;</code> as the array <code>interest</code> is converted to the address of its first element on access."}], "answers": [{"comments": [{"owner": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 2, "creation_date": 1531939680, "post_id": 51407244, "comment_id": 89789435, "body": "&#39;...+= i consumes lot of memory...&#39;?? Completely BS."}, {"owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "reply_to_user": {"reputation": 5994, "user_id": 5698738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tnZ9.jpg?s=128&g=1", "display_name": "Aganju", "link": "https://stackoverflow.com/users/5698738/aganju"}, "edited": false, "score": 0, "creation_date": 1531940202, "post_id": 51407244, "comment_id": 89789741, "body": "@Aganju I mean that by <code>ipoint += i; </code> ,  <code>i</code> , memory blocks are incremented by pointer <code>ipoint</code> which will cause stack smashing. instead of incrementing <code>i</code> ."}], "tags": [], "owner": {"reputation": 2465, "user_id": 5462988, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9i3ex.jpg?s=128&g=1", "display_name": "anoopknr", "link": "https://stackoverflow.com/users/5462988/anoopknr"}, "is_accepted": false, "score": 0, "last_activity_date": 1531932662, "creation_date": 1531932662, "answer_id": 51407244, "question_id": 51406889, "link": "https://stackoverflow.com/questions/51406889/why-is-my-for-loop-increment-changing-dramatically/51407244#51407244", "title": "Why is my for loop increment changing dramatically?", "body": "<p>This is due to your <code>+= i;</code> statements in <code>for-loop</code> , Change it to <code>'++'</code>. When you use <code>+= i;</code>  , Too much increment is happening for your <strong>pointers</strong> <em>(not incremented by <strong>1</strong> but by <strong>i</strong>).</em></p>\n\n<p>Modified <code>for-loop</code> :-</p>\n\n<pre><code>for (i = 1; i &lt;= number_of_payments; i++)\n{\n    ipoint ++;  // not +=i\n    bpoint ++;  // not +=i\n    ppoint ++;  // not +=i\n\n    *ipoint = *bpointprev * monthlyInterestRate;\n    *ppoint = monthlyPayment - *ipoint;\n    *bpoint = *bpointprev - *ppoint;\n\n    printf(\"%i \\t %.2f \\t %.2f \\t\\t %.2f \\t\\t %.2f\\n\", i, monthlyPayment, *ppoint, *ipoint, *bpoint);\n\n    bpointprev ++; //Iterates after logic for next calculation. not +=i\n}\n</code></pre>\n\n<p>because <code>+=i</code> consumes lot of memory <em>(Too much increment)</em> causing <strong><em>stack smashing</em></strong> error.</p>\n\n<p><strong>Output :-</strong></p>\n\n<pre><code>Enter amount of loan : $ 2000\nEnter Interest rate per year : 7.5\nEnter number of payments : 6\nMonthly payment should be $ 340.662858\n#    Payment     Principal   Interest    Balance \n1    340.66      328.16          12.50       1671.84\n2    340.66      330.21          10.45       1341.62\n3    340.66      332.28          8.39        1009.35\n4    340.66      334.35          6.31        674.99\n5    340.66      336.44          4.22        338.55\n6    340.66      338.55          2.12        0.00\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58, "user_id": 9353691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796e5548ed190c3eba9311248a500254?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Yi", "link": "https://stackoverflow.com/users/9353691/sam-yi"}, "edited": false, "score": 0, "creation_date": 1531960089, "post_id": 51411177, "comment_id": 89797018, "body": "Will do. Much appreciated."}], "tags": [], "owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "is_accepted": true, "score": 2, "last_activity_date": 1531949302, "last_edit_date": 1531949302, "creation_date": 1531949000, "answer_id": 51411177, "question_id": 51406889, "link": "https://stackoverflow.com/questions/51406889/why-is-my-for-loop-increment-changing-dramatically/51411177#51411177", "title": "Why is my for loop increment changing dramatically?", "body": "<p>You have a large number of problems with your code that are just waiting to cause problems. As you have discovered, you failed to protect your array bounds by incrementing your pointers with <code>ptr += i</code> causing you to invoke <em>Undefined Behavior</em> by accessing and writing to memory outside of the storage for your arrays. </p>\n\n<p>Take for example <code>interest</code> and <code>ipoint</code>:</p>\n\n<pre><code>double interest[7] = {0};\nipoint = &amp;interest[0];\n</code></pre>\n\n<p>So your indexes within <code>interest</code> array are as follows and <code>ipoint</code> is initialized to point to the first element in <code>interest</code>:</p>\n\n<pre><code>            +---+---+---+---+---+---+---+\ninterest    | 0 | 1 | 2 | 3 | 4 | 5 | 6 |\n            +---+---+---+---+---+---+---+\n            ^\n            |\n            ipoint\n</code></pre>\n\n<p>Within your loop you are advancing <code>ipoint += i</code>. On the first iteration of your loop, you advance <code>ipoint</code> by one:</p>\n\n<pre><code>            +---+---+---+---+---+---+---+\ninterest    | 0 | 1 | 2 | 3 | 4 | 5 | 6 |\n            +---+---+---+---+---+---+---+\n                ^\n                |\n                ipoint\n</code></pre>\n\n<p>Your second iteration, you advance by two:</p>\n\n<pre><code>            +---+---+---+---+---+---+---+\ninterest    | 0 | 1 | 2 | 3 | 4 | 5 | 6 |\n            +---+---+---+---+---+---+---+\n                        ^\n                        |\n                        ipoint\n</code></pre>\n\n<p>Your third iteration, you advance by three:</p>\n\n<pre><code>            +---+---+---+---+---+---+---+\ninterest    | 0 | 1 | 2 | 3 | 4 | 5 | 6 |\n            +---+---+---+---+---+---+---+\n                                    ^\n                                    |\n                                    ipoint\n</code></pre>\n\n<p>When <code>i = 4</code> you advance <code>ipoint</code> beyond the end of your array, and you invoke <em>Undefined Behavior</em> when you assign a value to <code>ipoint</code> and attempt to store the value in memory you do no own:</p>\n\n<pre><code>            +---+---+---+---+---+---+---+---+---+---+---+\ninterest    | 0 | 1 | 2 | 3 | 4 | 5 | 6 | out of bounds |\n            +---+---+---+---+---+---+---+---+---+---+---+\n                                                    ^\n                                                    |\n                                                    ipoint\n</code></pre>\n\n<p><strong>Note:</strong> when <em>Undefined Behavior</em> is invoked, your code can appear to work normally, or it can <code>SEGFAULT</code> (or anything in between), the operation of your code is simply <em>Undefined</em> and cannot be relied upon from that point forward.</p>\n\n<p>What you need to do is advance each of your pointers by <code>1</code>, not <code>'i'</code>. That will insure you do not write beyond your array bounds. You can fix the problem by simply changing <code>'i'</code> to <code>1</code> for each, e.g.</p>\n\n<pre><code>        ipoint += 1;\n        bpoint += 1;\n        ppoint += 1;\n</code></pre>\n\n<p>There are a number of other places you risk invoking <em>Undefined Behavior</em>. You fail to check the <strong>return</strong> of <code>scanf</code>. If you input (by accident, or a cat steps of the keyboard) anything other than a numeric value, a <em>matching failure</em> will occur, no characters will be read from <code>stdin</code> and all further prompts will be skipped and you will then proceed to process with indeterminate value which will invoke <em>Undefined Behavior</em>.</p>\n\n<p>Further, if you enter more than <code>7</code> for the <code>number_of_payments</code> or a value less than zero you invoke <em>Undefined Behavior</em>. (the results are also rather uninteresting for <code>number_of_payments = 0</code>) When taking input, not only to you have to validate the conversion succeeds, but you must validate the resulting value is within a usable range -- to avoid <em>Undefined Behavior</em>, e.g.</p>\n\n<pre><code>    printf (\"Enter number of payments : \");\n    if (scanf (\" %i\", &amp;number_of_payments) != 1) {\n        fprintf (stderr, \"error: invalide no. of payments.\\n\");\n        return 1;\n    }\n    /* validate no. pmts in range */\n    if (number_of_payments &lt; 1 || number_of_payments &gt; MAXPMTS) {\n        fprintf (stderr, \"error: no. of payments exceed MAXPMTS (%d)\\n\",\n                MAXPMTS);\n        return 1;\n    }\n</code></pre>\n\n<p>Lastly, while you are free to initialize <code>ipoint = &amp;interest[0];</code>, it is not necessary. Accessing an array, the array is converted to a pointer to its first element, so <code>ipoint = interest;</code> is all that is required. There are other issues addressed in the comments below, but putting it altogether, you could do something like the following to insure behavior is defined throughout your code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define MAXPMTS 32  /* if you need a constant, define one (or more) */\n\ndouble power (double a, double b);\n\nint main (void)\n{\n    int loanAmount = 0,             /* initialize all variables */\n        number_of_payments = 0, \n        i = 0;\n    double interestRate = 0.0, \n        monthlyInterestRate = 0.0, \n        monthlyPayment = 0.0;\n\n    /* numeric conversions consume leading whitespace (as does %s)\n     * the ' ' in the conversion doesn't hurt, but isn't required.\n     */\n\n    printf (\"Enter amount of loan : $ \");\n    if (scanf (\" %i\", &amp;loanAmount) != 1) {  /* validate conversion */\n        fprintf (stderr, \"error: invalid loan amount.\\n\");\n        return 1;\n    }\n\n    printf (\"Enter Interest rate per year : \");\n    if (scanf (\" %lf\", &amp;interestRate) != 1) {\n        fprintf (stderr, \"error: invalid interest rate.\\n\");\n        return 1;\n    }\n\n    printf (\"Enter number of payments : \");\n    if (scanf (\" %i\", &amp;number_of_payments) != 1) {\n        fprintf (stderr, \"error: invalide no. of payments.\\n\");\n        return 1;\n    }\n    /* validate no. pmts in range */\n    if (number_of_payments &lt; 1 || number_of_payments &gt; MAXPMTS) {\n        fprintf (stderr, \"error: no. of payments exceed MAXPMTS (%d)\\n\",\n                MAXPMTS);\n        return 1;\n    }\n\n    monthlyInterestRate = ((interestRate / 100) / 12); //AKA 'r' or rate.\n    monthlyPayment = (monthlyInterestRate) * (loanAmount/(1 - 1/(power((1 + \n                        monthlyInterestRate), number_of_payments))));\n\n    double interest[MAXPMTS] = {0};\n    double principal[MAXPMTS] = {0};\n    double balance[MAXPMTS] = {0};\n    balance[0] = loanAmount;\n    double  *ipoint = NULL,\n            *ppoint = NULL,\n            *bpoint = NULL,\n            *bpointprev = NULL;\n\n    ipoint = interest;\n    ppoint = principal;\n    bpoint = balance;\n    bpointprev = bpoint;\n\n    printf (\"Monthly payment should be $ %lf\\n\", monthlyPayment);\n    printf (\"# \\t Payment \\t Principal \\t Interest \\t Balance \\n\");\n\n    /* standard loop is from 0 to i &lt; number_of_payments */\n    for (i = 0; i &lt; number_of_payments; i++) {\n        ipoint += 1;\n        bpoint += 1;\n        ppoint += 1;\n\n        *ipoint = *bpointprev * monthlyInterestRate;\n        *ppoint = monthlyPayment - *ipoint;\n        *bpoint = *bpointprev - *ppoint;\n\n        /* adjust 'i + 1' for payment no. output */\n        printf (\"%i \\t %.2f \\t %.2f \\t %.2f \\t\\t %.2f\\n\",\n                i + 1, monthlyPayment, *ppoint, *ipoint, *bpoint);\n\n        bpointprev += 1; //Iterates after logic for next calculation.\n    }\n\n    return 0;\n}\n\ndouble power(double a, double b)\n{\n    double i, sum = 1;\n    for (i = 0; i &lt; b; i++) {\n        sum = sum * a;\n    }\n    return sum;\n}\n</code></pre>\n\n<p>(<strong>note:</strong> whether you loop from <code>i=1</code> to <code>i &lt;= number_of_payments</code> or from <code>i=0</code> to <code>i &lt; number_of_payments</code> is largely up to you, but it is standard for the loop variable to track the valid array indexes to protect the bounds of the array. As above, the <em>output</em> for the payment number is simply adjust by <code>i + 1</code> to produce the desired <code>1,2,3...</code>)</p>\n\n<p>(<strong>also note:</strong> in practice you want to avoid using <em>floating-point</em> math for currency. People get really upset when you lose money due to rounding errors. Integer math eliminates that problem)</p>\n\n<p>Look things over and let me know if you have further questions. </p>\n"}], "owner": {"reputation": 58, "user_id": 9353691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/796e5548ed190c3eba9311248a500254?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Yi", "link": "https://stackoverflow.com/users/9353691/sam-yi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 51411177, "answer_count": 2, "score": 1, "last_activity_date": 1531949302, "creation_date": 1531931232, "last_edit_date": 1531946425, "question_id": 51406889, "link": "https://stackoverflow.com/questions/51406889/why-is-my-for-loop-increment-changing-dramatically", "title": "Why is my for loop increment changing dramatically?", "body": "<p>I am writing a small program for amortization using pointers </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ndouble power(double a, double b);\n\nint main(void)\n{\n    int loanAmount, number_of_payments, i = 0;\n    double interestRate, monthlyInterestRate, monthlyPayment;\n    printf(\"Enter amount of loan : $ \");\n    scanf(\" %i\",&amp;loanAmount);\n    printf(\"Enter Interest rate per year : \");\n    scanf(\" %lf\",&amp;interestRate);\n    printf(\"Enter number of payments : \");\n    scanf(\" %i\",&amp;number_of_payments);\n\n    monthlyInterestRate = ((interestRate / 100) / 12); //AKA 'r' or rate.\n    monthlyPayment = (monthlyInterestRate) * (loanAmount/(1 - 1/(power((1 + \n    monthlyInterestRate), number_of_payments))));\n\n    double interest[7] = {0}; //Arbitrarily set to 7 - assuming less payments.\n    double principal[7] = {0};\n    double balance[7] = {0};\n    balance[0] = loanAmount;\n    double *ipoint,*ppoint,*bpoint,*bpointprev;\n\n    ipoint = &amp;interest[0];\n    ppoint = &amp;principal[0];\n    bpoint = &amp;balance[0];\n    bpointprev = bpoint;\n\n    printf(\"Monthly payment should be $ %lf\\n\",monthlyPayment);\n    printf(\"# \\t Payment \\t Principal \\t Interest \\t Balance \\n\");\n    for (i = 1; i &lt;= number_of_payments; i++) {\n        ipoint += i;\n        bpoint += i;\n        ppoint += i;\n\n        *ipoint = *bpointprev * monthlyInterestRate;\n        *ppoint = monthlyPayment - *ipoint;\n        *bpoint = *bpointprev - *ppoint;\n\n        printf(\"%i \\t %.2f \\t %.2f \\t\\t %.2f \\t\\t %.2f\\n\",i,monthlyPayment,*ppoint,*ipoint,*bpoint);\n\n        bpointprev += i; //Iterates after logic for next calculation.\n    }\n\n    return 0;\n}\n\ndouble power(double a, double b)\n{\n    double i, sum = 1;\n    for (i = 0; i &lt; b; i++) {\n        sum = sum * a;\n    }\n    return sum;\n}\n</code></pre>\n\n<p>and came across an issue where the IDE I am writing in runs the program fine:</p>\n\n<p>on Cloud9 IDE:</p>\n\n<p><img src=\"https://i.stack.imgur.com/kX7JL.png\" alt=\"on Cloud9 IDE, Correct\"></p>\n\n<p>but on a Unix terminal, the increment variable in my for loop jumps after what seems to be an arbitrary count:</p>\n\n<p>on Unix Terminal:</p>\n\n<p><img src=\"https://i.stack.imgur.com/wuPJz.png\" alt=\"on Unix Terminal, Error\"></p>\n\n<p>I am fairly certain it has something to do all of the pointer references I have whizzing around, but I don't know why it would affect the int variable i in the for-loop or why the IDE would handle the error so cleanly. Please educate!</p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "edited": false, "score": 0, "creation_date": 1531929735, "post_id": 51406409, "comment_id": 89783979, "body": "I&#39;ve explained why my question is not a duplicate."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1531930531, "post_id": 51406409, "comment_id": 89784462, "body": "Note that <a href=\"https://stackoverflow.com/questions/5431941/\"><code>while (!feof(file))</code> is always wrong</a>"}, {"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531930675, "post_id": 51406409, "comment_id": 89784549, "body": "I&#39;ve updated on the issue again."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531930689, "post_id": 51406409, "comment_id": 89784553, "body": "also check how many fields you have read by checking value of <code>fscanf</code> (the answer is probably 0 here)"}, {"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531930731, "post_id": 51406409, "comment_id": 89784574, "body": "@Jean-Fran&#231;oisFabre How would I be able to check that? I&#39;m kinda new."}, {"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "edited": false, "score": 0, "creation_date": 1531930823, "post_id": 51406409, "comment_id": 89784629, "body": "Every field I try to output has the same weird output."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531930994, "post_id": 51406409, "comment_id": 89784731, "body": "Johnatan answer shows how to check that (compares return value to 6)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531931501, "post_id": 51406409, "comment_id": 89785031, "body": "No \u2014 we do not want or need to see all the rest of your program."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1531931623, "post_id": 51406409, "comment_id": 89785102, "body": "If you want to parse the input, you should avoid <code>scanf</code>.  In point of fact, &quot;you should avoid <code>scanf</code>&quot; is always true."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531931703, "post_id": 51406409, "comment_id": 89785159, "body": "@HassanAlthaf  Curious, who or what text suggested <code>while (!feof(file)) {</code>?"}, {"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531931772, "post_id": 51406409, "comment_id": 89785207, "body": "@chux My lecturer at college."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531931985, "post_id": 51406409, "comment_id": 89785336, "body": "@HassanAlthaf Thanks.  Note that <i>in this case</i>, <code>while (!feof(file)) {</code> is almost OK as the <code>...\\n&quot;</code>at the end of the format will make your code &quot;work&quot; - ususally.  Tip: Don&#39;t ever do this for production code and know that   lecturers are fallible."}, {"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531932513, "post_id": 51406409, "comment_id": 89785602, "body": "@chux Haha, I&#39;m aware that lecturers teach very outdated stuff. But when your deadlines are tight, you need to somehow make it work. <i>Welcome to College....</i> If it was a higher-level language, I wouldn&#39;t have had much problems, but C is just too different from other higher-level languages like Java, C#, Python, etc..."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531933261, "post_id": 51406409, "comment_id": 89786020, "body": "@HassanAlthaf Tip: a real challenge is handling what code should do if unexpected data occurs.  How to detect it and how to gracefully cope with it?  The <code>while (!feof(file)) {</code> makes proper error detection/handling very difficult.  A significant difference from the &quot;old days&quot; is the increased prevalence of hostile data (hackers) who destroy code like this.  <a href=\"https://stackoverflow.com/questions/51406409/how-do-i-read-a-string-enclosed-within-square-braces-in-a-file-in-c-with-each-li#comment89785156_51406779\">Tread carefully</a> when speeding with those deadlines - often inefficient."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531931025, "post_id": 51406779, "comment_id": 89784754, "body": "@JohathanLeffler: is the space at start intentional?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531931145, "post_id": 51406779, "comment_id": 89784806, "body": "@Jean-Fran&#231;oisFabre: yes; it is infinitely better than the newline at the end, especially if the input will ever come from a terminal.  It skips leading white space, newlines left over from previous input, etc.  Three formats don&#39;t skip white space in <code>scanf()</code>: <code>%c</code>, <code>%[\u2026]</code>, and <code>%n</code>."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": true, "score": 3, "last_activity_date": 1531933724, "last_edit_date": 1531933724, "creation_date": 1531930834, "answer_id": 51406779, "question_id": 51406409, "link": "https://stackoverflow.com/questions/51406409/how-do-i-read-a-string-enclosed-within-square-braces-in-a-file-in-c-with-each-li/51406779#51406779", "title": "How do I read a string enclosed within square braces in a file in C with each line containing several such strings", "body": "<p>You need to use 'scan sets', which are designated by <code>%[\u2026]</code> in the format string.  You need to be careful here since the data also contains square brackets, and you want to match a negated character set \u2014 anything that isn't a close square bracket.  The basic idea is illustrated by:</p>\n\n<pre><code>while (fscanf(file, \" [%[^]]], [%[^]]], [%[^]]], [%lf], [%lf], [%[^]]]\",\n              customer.name, customer.billing_address, customer.phone_number,\n              &amp;customer.amount_paid, &amp;customer.amount_due, customer.date) == 6)\n{\n    \u2026good data to process\u2026\n}\n</code></pre>\n\n<p>The <code>%[^]]</code> means 'scan set \u2014 negated \u2014 first character is <code>]</code> \u2014 end of scan set.  The code checks that 6 values were read, stopping if there was a problem (or EOF).  Note that <a href=\"https://stackoverflow.com/questions/5431941/\"><code>while (!feof(file))</code> is always wrong</a>.</p>\n\n<p>Using commas as well as the square brackets in the data isn't really necessary; the square brackets alone would be sufficient.</p>\n\n<p>Converting this into an MCVE:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct Customer {\n    char name[50];\n    char billing_address[100];\n    char phone_number[15];\n    double amount_paid;\n    double amount_due;\n    char date[20];\n} Customer;\n\nint main(void)\n{\n    Customer customer;\n    FILE *file = stdin;   //fopen(\"customers.txt\", \"ab+\");\n\n    while (fscanf(file, \" [%49[^]]], [%99[^]]], [%14[^]]], [%lf], [%lf], [%19[^]]]\",\n                  customer.name, customer.billing_address, customer.phone_number,\n                  &amp;customer.amount_paid, &amp;customer.amount_due, customer.date) == 6)\n    {\n        printf(\"Data: &lt;&lt;%s&gt;&gt; &lt;&lt;%s&gt;&gt; &lt;&lt;%s&gt;&gt; %10.2f %10.2f &lt;&lt;%s&gt;&gt;\\n\",\n                customer.name, customer.billing_address, customer.phone_number,\n                customer.amount_paid, customer.amount_due, customer.date);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that in this version, I've added <a href=\"https://stackoverflow.com/questions/1621394/\">overflow protection</a> \u2014 the numbers in the formats like <code>%49[^]]</code> prevent overflows.  The 'off by one' on length is deliberate and necessary (and a nuisance, but hallowed by antiquity and the standard which followed the precedents of the ancient ones who gave us the standard I/O library).</p>\n\n<p>The blank at the start of the format is not an accident.  Three formats don't skip leading white space: <code>%c</code>, <code>%[\u2026]</code> and <code>%n</code>.  Putting the white space at the front gives a better user experience if the input ever comes from a terminal rather than a file.  (See <a href=\"https://stackoverflow.com/questions/5240789/scanf-leaves-the-new-line-char-in-buffer\"><code>scanf()</code> leaves the newline in the input stream</a> (amongst other questions) for more information.)</p>\n\n<p>This reads from standard input instead of a named file.  When compiled from <code>scan13.c</code> into <code>scan13</code> and run on the sample data, it produces:</p>\n\n<pre><code>$ gcc -O3 -g -std=c11 -Wall -Wextra -Werror scan13.c -o scan13\n$ cat data\n[well lol], [wtf bro? 24], [0183188383], [3000.000000], [4000.000000], [12/12/2012]\n[chow hai], [pukima jalan], [6969696969], [6969.000000], [6969699.000000], [6/9/1969]\n$ scan13 &lt; data\nData: &lt;&lt;well lol&gt;&gt; &lt;&lt;wtf bro? 24&gt;&gt; &lt;&lt;0183188383&gt;&gt;    3000.00    4000.00 &lt;&lt;12/12/2012&gt;&gt;\nData: &lt;&lt;chow hai&gt;&gt; &lt;&lt;pukima jalan&gt;&gt; &lt;&lt;6969696969&gt;&gt;    6969.00 6969699.00 &lt;&lt;6/9/1969&gt;&gt;\n$\n</code></pre>\n"}], "owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 1, "accepted_answer_id": 51406779, "answer_count": 1, "score": 2, "last_activity_date": 1531933724, "creation_date": 1531929517, "last_edit_date": 1531931599, "question_id": 51406409, "link": "https://stackoverflow.com/questions/51406409/how-do-i-read-a-string-enclosed-within-square-braces-in-a-file-in-c-with-each-li", "title": "How do I read a string enclosed within square braces in a file in C with each line containing several such strings", "body": "<p><strong>Problem File:</strong></p>\n\n<pre><code>[well lol], [wtf bro? 24], [0183188383], [3000.000000], [4000.000000], [12/12/2012]\n[chow hai], [pukima jalan], [6969696969], [6969.000000], [6969699.000000], [6/9/1969]\n</code></pre>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>typedef struct Customer {\n    char name[50];\n    char billing_address[100];\n    char phone_number[15];\n    double amount_paid;\n    double amount_due;\n    char date[20];\n} Customer;\n\nCustomer customer;\n\nFILE *file = fopen(\"customers.txt\", \"ab+\");\n\nwhile (!feof(file)) {\n    fscanf(file, \"[%s], [%s], [%s], [%lf], [%lf], [%s]\\n\", &amp;customer.name, &amp;customer.billing_address, customer.phone_number, &amp;customer.amount_paid, &amp;customer.amount_due, customer.date);\n}\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p>In the above code, what I'm trying to do is parse each record value into the appropriate field in the <code>Customer</code> structure. Now we do know that \"%s\" will not read spaces. How would I read a value like \"well lol\" in the record since <code>%s</code> will not work.</p>\n\n<p><strong>Why is it not a duplicate?</strong></p>\n\n<p>I need to parse the entire line, and not just accept one value after the other as the supposedly duplicate answer.</p>\n\n<p><strong>Update on why it's not a duplicate:</strong></p>\n\n<pre><code>while (!feof(file)) {\n        fscanf(file, \"[%[^\\\\n]], [%[^\\\\n]], [%[^\\\\n]], [%lf], [%lf], [%[^\\\\n]]\\n\", customer.name, customer.billing_address, customer.phone_number, &amp;customer.amount_paid, &amp;customer.amount_due, customer.date);\n\n    printf(\"%s\", customer.billing_address);\n    if (strcmp(customer.name, search) == 0) {\n        printf(\"FOUND!!!\");\n    }\n}\n</code></pre>\n\n<p>I've updated the code as told, but my output is still wrong. I believe there's something else wrong. Output:</p>\n\n<pre><code>SEARCH A CUSTOMER PROFILE\n=========================\nCustomer Name: a\n\ufffd\ufffd\ufffd\n</code></pre>\n"}, {"tags": ["c", "c-strings", "strcat"], "comments": [{"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 1, "creation_date": 1531927349, "post_id": 51405632, "comment_id": 89782334, "body": "<a href=\"https://en.cppreference.com/w/c/string/byte/strncat\" rel=\"nofollow noreferrer\"><code>strncat</code></a> might work for you: <code>strncat(p, &amp;s[i], 1);</code>."}, {"owner": {"reputation": 111, "user_id": 10034297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-40mFz6_yzsg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0lUxwWYxId5ocHUVGCLnveZMzBUw/mo/photo.jpg?sz=128", "display_name": "Radu Gabriel", "link": "https://stackoverflow.com/users/10034297/radu-gabriel"}, "reply_to_user": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1531927411, "post_id": 51405632, "comment_id": 89782380, "body": "That worked, thanks a lot."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531928294, "post_id": 51405632, "comment_id": 89782956, "body": "Note that the use of <code>strlen()</code> in the loop like that requires the code to evaluate the length on each iteration.  It would be <i>much</i> more sensible to know how long the string currently is so you can add the extra characters without having to call <code>strcat()</code> \u2014 which also has to scan the string on each iteration.  You have quadratic code \u2014 O(N&#178;) \u2014 because of the function calls, but the underlying algorithm only needs to be linear \u2014 O(N)."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531928464, "post_id": 51405632, "comment_id": 89783062, "body": "Note too that both <code>p</code> and <code>s</code> must be C strings \u2014 that is, a null-terminated byte sequence \u2014 because neither <code>strlen()</code> nor <code>strcat()</code> will work sanely if they&#39;re not strings.  So your last comment is misguided."}, {"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 1, "creation_date": 1531928471, "post_id": 51405632, "comment_id": 89783068, "body": "<i>&quot;How do I do that using strcat?&quot;</i> - you don&#39;t; you use a simple reader-writer loop that reads from your source buffer and conditionally writes to your  target, terminating when you&#39;re done. Don&#39;t pound nails with saws."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1531938498, "post_id": 51405632, "comment_id": 89788769, "body": "You must also first ensure that the storage allocated for p is large enough to append all of the extra characters without overrunning that space."}], "answers": [{"tags": [], "owner": {"reputation": 3879, "user_id": 7371784, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/78e670334411962158df4d1ac6803ac9?s=128&d=identicon&r=PG&f=1", "display_name": "Kristjan Kica", "link": "https://stackoverflow.com/users/7371784/kristjan-kica"}, "is_accepted": false, "score": 0, "last_activity_date": 1531928015, "creation_date": 1531928015, "answer_id": 51405906, "question_id": 51405632, "link": "https://stackoverflow.com/questions/51405632/add-one-character-from-a-string-to-the-end-of-another-string-strcat/51405906#51405906", "title": "Add one character from a string to the end of another string (strcat)", "body": "<p>First, you need addresses (the array itself is an address to the first element) to pass to the <code>strcat</code>, not a <code>char</code>. That is why you need to use the <code>&amp;</code> operator before s[i]. </p>\n\n<p>You have a working example here</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\nint main()\n{\n\n    char s[50]= \"Hello World\";\n    char p[50]= \"Hello World\";\n    for(unsigned int i=0;i&lt;strlen(s);i++){\n    if(s[i]!=' ') \n    strncat(p,&amp;s[i],1);\n    }\n    puts(p);\n    return 0;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 111, "user_id": 10034297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-40mFz6_yzsg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0lUxwWYxId5ocHUVGCLnveZMzBUw/mo/photo.jpg?sz=128", "display_name": "Radu Gabriel", "link": "https://stackoverflow.com/users/10034297/radu-gabriel"}, "edited": false, "score": 0, "creation_date": 1531949617, "post_id": 51406155, "comment_id": 89794113, "body": "I was never told about how these function works at a low level. I am preparing for a college exam next year and this kind of things are not taught in high school. Until then I just want to get good at problem solving, being able to get the idea behind it, not so much the effectiveness of the implementation. That&#39;s why I prefer the strcat, I don&#39;t need to keep another variable to keep count of the index of the second string. Thanks for your insight, anyway."}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 4, "last_activity_date": 1531928811, "creation_date": 1531928811, "answer_id": 51406155, "question_id": 51405632, "link": "https://stackoverflow.com/questions/51405632/add-one-character-from-a-string-to-the-end-of-another-string-strcat/51406155#51406155", "title": "Add one character from a string to the end of another string (strcat)", "body": "<p>A more sensible algorithm would avoid using <code>strcat()</code> or <code>strncat()</code> altogether:</p>\n\n<pre><code>int j = strlen(p);\nfor (int i = 0; s[i] != '\\0'; i++)\n{\n    if (s[i] != ' ')\n        p[j++] = s[i];\n}\np[j] = '\\0';\n</code></pre>\n\n<p>This avoids quadratic behaviour which using <code>strlen()</code> and <code>strcat()</code> (or <code>strncat()</code>) necessarily involves.  It does mean you need to keep a track of where to place characters in <code>p</code>, but the work involved in doing that is trivial.  Generally speaking, the quadratic behaviour won't be a problem on strings of 10 characters or so, but if the strings reach 1000 bytes or more, then quadratic behaviour becomes a problem (it takes 1,000,000 operations instead of 1,000 operations \u2014 that can become noticeable).</p>\n"}], "owner": {"reputation": 111, "user_id": 10034297, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-40mFz6_yzsg/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq0lUxwWYxId5ocHUVGCLnveZMzBUw/mo/photo.jpg?sz=128", "display_name": "Radu Gabriel", "link": "https://stackoverflow.com/users/10034297/radu-gabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1531928811, "creation_date": 1531927141, "last_edit_date": 1531928183, "question_id": 51405632, "link": "https://stackoverflow.com/questions/51405632/add-one-character-from-a-string-to-the-end-of-another-string-strcat", "title": "Add one character from a string to the end of another string (strcat)", "body": "<pre><code>for (unsigned int i = 0; i &lt; strlen(s); i++) {\n  if (s[i] != ' ') \n    strcat(p, s[i]);\n</code></pre>\n\n<p>I want to add the current character of the <code>s</code> string at the end of the <code>p</code> string provided it is not a space. How do I do that using <code>strcat</code>? The code above gives the following error \"invalid conversion from 'char' to 'const char*'\".</p>\n\n<p>I want to use <code>strcat</code> because this way I don't have to store an index for p string in order to know where to place the current character. I hope this makes sense.</p>\n\n<p>Also, I need to do this using array of chars, not c-strings or whatever those are called.</p>\n"}, {"tags": ["c++", "c", "file", "winapi"], "comments": [{"owner": {"reputation": 258, "user_id": 8083690, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrIvk.png?s=128&g=1", "display_name": "Sam Pagenkopf", "link": "https://stackoverflow.com/users/8083690/sam-pagenkopf"}, "edited": false, "score": 0, "creation_date": 1531926714, "post_id": 51405370, "comment_id": 89781928, "body": "Are they using a memory-mapped file? <a href=\"https://en.wikipedia.org/wiki/Memory-mapped_file\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Memory-mapped_file</a>"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1531926791, "post_id": 51405370, "comment_id": 89781979, "body": "Never use both <a href=\"https://stackoverflow.com/questions/tagged/c%2b%2b\">c++</a> and <a href=\"https://stackoverflow.com/questions/tagged/c\">c</a> ....."}, {"owner": {"reputation": 10498, "user_id": 669576, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/mRhrB.jpg?s=128&g=1", "display_name": "Johnny Mopp", "link": "https://stackoverflow.com/users/669576/johnny-mopp"}, "edited": false, "score": 0, "creation_date": 1531926795, "post_id": 51405370, "comment_id": 89781983, "body": "<code>int8_t</code> probably isn&#39;t large enough since <code>ULONG</code> is probably <code>uint32_t</code>."}, {"owner": {"reputation": 52656, "user_id": 225074, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/dea26ac1ef8259140d28aa8b5ba4f1b3?s=128&d=identicon&r=PG", "display_name": "Thomas Matthews", "link": "https://stackoverflow.com/users/225074/thomas-matthews"}, "edited": false, "score": 2, "creation_date": 1531926911, "post_id": 51405370, "comment_id": 89782049, "body": "You&#39;ve got a problem.  You tagged the C language, but the C language doesn&#39;t have <code>std::vector</code>.  I recommend you focus on one language before mixing or combing the two languages.  Also, update your language tags."}, {"owner": {"reputation": 2231, "user_id": 6909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ncdCb.png?s=128&g=1", "display_name": "Jo&#227;o Augusto", "link": "https://stackoverflow.com/users/6909/jo%c3%a3o-augusto"}, "edited": false, "score": 0, "creation_date": 1531927202, "post_id": 51405370, "comment_id": 89782239, "body": "what&#39;s the point of reading data to a vector of int8_t and read uint32_t blocks of data by using a pointer to the vector buffer.... Why don&#39;t you just read the data to a vector of uint32_t and access the values by index ?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531927100, "post_id": 51405503, "comment_id": 89782171, "body": "this makes a lot more sense. I didn&#39;t realize you could cast a pointer like that from a  vector"}, {"owner": {"reputation": 42446, "user_id": 902497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff13ece6277497484bfa2911c6183a30?s=128&d=identicon&r=PG", "display_name": "Raymond Chen", "link": "https://stackoverflow.com/users/902497/raymond-chen"}, "edited": false, "score": 0, "creation_date": 1531964931, "post_id": 51405503, "comment_id": 89797952, "body": "Beware that four <code>int8_t</code> values may not satisfy alignment requirements to be accessed as a single <code>ULONG</code>. You will need to declare the pointer as unaligned to avoid crashes on alignment-sensitive CPUs."}], "tags": [], "owner": {"reputation": 70931, "user_id": 882003, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/de71acd9a8eab73186dea35aea7a68f2?s=128&d=identicon&r=PG", "display_name": "john", "link": "https://stackoverflow.com/users/882003/john"}, "is_accepted": false, "score": 1, "last_activity_date": 1531926743, "creation_date": 1531926743, "answer_id": 51405503, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time/51405503#51405503", "title": "Read File by ULONG at a time", "body": "<p>I'm assuming that your data is binary data in the correct native format (I think that's implied by your question).</p>\n\n<p>So if your data is ULONGs don't use a char pointer use a ULONG pointer, like this</p>\n\n<pre><code>vector&lt;int8_t&gt; res;\n// some code to read into res\n\n// get the underlying data\nULONG* resData = (ULONG*)res.data();\n\n// read a ULONG\nULONG someData = *resData;\n\n// advance to the next ULONG\n++resData;\n</code></pre>\n\n<p>The important part is the use of the <code>data()</code> method to access the vectors data.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531928089, "post_id": 51405873, "comment_id": 89782820, "body": "well, that was the old code. All I have now is the path to my file.. so not sure if it is locked to memory now? Before they had the bin files loaded into the .exe itself"}, {"owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "edited": false, "score": 0, "creation_date": 1531929572, "post_id": 51405873, "comment_id": 89783855, "body": "okay think i see what you mean. Although I don&#39;t think I&#39;d have an offest because I would be right at the top of the file. I also am trying to use a pointer to do this where in this case I would have to keep recalled the read function?"}, {"owner": {"reputation": 26606, "user_id": 4603670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7eabc1427aa3c8185153cc81978289a?s=128&d=identicon&r=PG&f=1", "display_name": "Barmak Shemirani", "link": "https://stackoverflow.com/users/4603670/barmak-shemirani"}, "edited": false, "score": 0, "creation_date": 1531941699, "post_id": 51405873, "comment_id": 89790504, "body": "You also need <code>SizeofResource(NULL, resHandle)</code> to find the data size"}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 1, "last_activity_date": 1531929361, "last_edit_date": 1531929361, "creation_date": 1531927921, "answer_id": 51405873, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time/51405873#51405873", "title": "Read File by ULONG at a time", "body": "<p>You have no reason to read into a vector. Your resource is already loaded into memory, so the conformant way is to <code>memcpy</code> the relevant parts directly into your variables. Here it could be:</p>\n\n<pre><code>...\nchar* resData = (char*)LockResource(resHandle);\n...\nULONG myVar;\nint offset = ...;    // the offset in the resource where your long value resides\nmemcpy(&amp;myVar, resData+offset, sizeof(myVar));\n</code></pre>\n\n<p>That is all your ULONG variable can now be used...</p>\n\n<hr>\n\n<p>If you no longer have a resource but a file you can use unformatted io methods over an <code>ifstream</code>:</p>\n\n<pre><code>std::ifstream in(file_name, std::ios_base::in | std::ios_base_binary);\n...\nULONG myVar;\nint offset = ...;    // the offset in the resource where your long value resides\nin.seekg(offset, std::ios_base::seekdir::beg);        // position the stream at the offset\nin.read(static_cast&lt;char *&gt;(&amp;myVar), sizeof(myVar));  // and read the bytes\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9926513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/341349c4a277a57df5cb22339cda30b1?s=128&d=identicon&r=PG&f=1", "display_name": "jdoe", "link": "https://stackoverflow.com/users/9926513/jdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531929361, "creation_date": 1531926326, "last_edit_date": 1531927281, "question_id": 51405370, "link": "https://stackoverflow.com/questions/51405370/read-file-by-ulong-at-a-time", "title": "Read File by ULONG at a time", "body": "<p>I am trying to adapt to some code which creates a char * to the head of some data. And then is able to increment that pointer unsigned long at a time to read the data.</p>\n\n<p>I have been told a good way to do this is use ifstream to read the file (located somewhere on C:/) into a vector:</p>\n\n<pre><code>std::vector&lt;int8_t&gt;\n</code></pre>\n\n<p>But where my confusion is how do I then pull each piece of the file out in sizes of ULONG. I posted the logic below, this is communicating to hardware which needs data to be in that size, so they traverse the pointer at the sizeOf(ULONG) at a time until they read the end of the file(which they know by checking the file size). I know I need to somehow load this into memory.. but how do I traverse the same way</p>\n\n<p>a small snippet of their code looks like this:</p>\n\n<pre><code>char* resData;\nres = FindResource(NULL, MAKEINTRESOURCE(fpgaDevice), L\"FPGADATA\");\n  resHandle = LoadResource(NULL, res);\n  resData = (char*)LockResource(resHandle);\n</code></pre>\n\n<p>then to advance the file they advance the pointer by the size of the ULONG:</p>\n\n<pre><code>resData += sizeof(ULONG);\n</code></pre>\n\n<p>And to read the pointer simply use:</p>\n\n<pre><code>(ULONG*)resData\n</code></pre>\n"}, {"tags": ["c", "cmake", "ninja", "conan"], "answers": [{"tags": [], "owner": {"reputation": 3796, "user_id": 3215383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yAGNQ.jpg?s=128&g=1", "display_name": "drodri", "link": "https://stackoverflow.com/users/3215383/drodri"}, "is_accepted": false, "score": 0, "last_activity_date": 1531951577, "creation_date": 1531951577, "answer_id": 51411650, "question_id": 51405224, "link": "https://stackoverflow.com/questions/51405224/problems-to-generate-executable-with-ninja-using-packages-with-conan/51411650#51411650", "title": "Problems to generate executable with ninja. using packages with conan", "body": "<p>You are missing some information:</p>\n\n<ul>\n<li>The <code>${CONAN_LIBS}</code> variable that you see in the CMakeLists.txt gets its value from the dependencies <code>package_info()</code> method. As your <code>package_info()</code> method is empty, it is not passing the information to consumers, and they don't need how to link with them.</li>\n<li>You are not using a proper lib. You need to create an actual static \".lib\", \".a\" library or a shared library, and package it to the <code>\"lib\"</code> directory. Or if not packaging it (in the <code>package()</code> method) to that directory, define <code>self.cpp_info.libdirs=[\"yourlibdir\"]</code> accordingly</li>\n<li>Even if it might be possible to use OBJECT \"libraries\" in CMake, they cannot be fully used as targets (I think it has been added in very last CMake 3.12) in CMake</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 9915202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d8e3fa1009f4de6541925ebb98f60d?s=128&d=identicon&r=PG&f=1", "display_name": "Pony94", "link": "https://stackoverflow.com/users/9915202/pony94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531951577, "creation_date": 1531925942, "question_id": 51405224, "link": "https://stackoverflow.com/questions/51405224/problems-to-generate-executable-with-ninja-using-packages-with-conan", "title": "Problems to generate executable with ninja. using packages with conan", "body": "<p>I have the next problem, when i intent to generate the executable of my application, the system show me the next message :</p>\n\n<pre><code>undefined reference to `sum'\nundefined reference to `rest'\nundefined reference to `multi'\n</code></pre>\n\n<p>With the case of div, the application show me a false result.</p>\n\n<p>I can create the package, also I can compile using Cmake, and the system don't show me errors but when i intent to generate my executable the system show me those messages, and I don't know why, so I show you my consumer files like CMakeLists and conanfile. I excpect that you can help me !!</p>\n\n<p>CMakeLists. txt </p>\n\n<pre><code>CMAKE_MINIMUM_REQUIRED(VERSION 2.8)\nPROJECT(Example C)\n\ninclude(${CMAKE_BINARY_DIR}/conanbuildinfo.cmake)\nconan_basic_setup()\n\nSET(MyExample_SRC \n\"main.c\")\n\nadd_executable(example ${MyExample_SRC})\ntarget_link_libraries(example ${CONAN_LIBS})\n</code></pre>\n\n<p>conanfile.txt</p>\n\n<pre><code>[requires]\nExa/0.1@edwin/testing\n\n[generators]\ncmake\n</code></pre>\n\n<p>This the conanfile.py that I used to create my package:</p>\n\n<pre><code>from conans import ConanFile, CMake, tools\n\n\nclass ExaConan(ConanFile):\n   name = \"Exa\"\n   version = \"0.1\"\n   settings = \"os\", \"compiler\", \"build_type\", \"arch\"\n   generators = \"cmake\"\n\n    def source(self):\n        #self.run(\"CD C:/projects/connan-example/pkg\")\n        pass\n\n    def build(self):\n        self.run(\"CD C:/projects/connan-example/pkg/ &amp; Compile.bat\")\n        #cmake = CMake(self)\n        #make.configure(source_folder=\"connan-example\")\n        #cmake.build()\n\n    def package(self):\n        self.copy(\"MultiDiv.obj\", dst=\"objects\", keep_path=False)\n        self.copy(\"SumRest.c\", dst=\"source\", keep_path=False)\n        #self.copy(\"*.lib\", dst=\"lib\", keep_path=False)\n\n\n    def package_info(self):\n        #self.c_info.libs = [\"example\"]\n        pass\n</code></pre>\n\n<p>The Compile.bat is just to create the file .obj for MultDiv, and like the file shows, I'm packing MultiDiv and SumRest. When i compile and generate the executable with gcc commands, I can do it successfully </p>\n"}, {"tags": ["c", "file"], "comments": [{"owner": {"reputation": 891, "user_id": 6749481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38e30962b980293ffaff05455b7c013e?s=128&d=identicon&r=PG&f=1", "display_name": "An0num0us", "link": "https://stackoverflow.com/users/6749481/an0num0us"}, "edited": false, "score": 0, "creation_date": 1531926063, "post_id": 51405209, "comment_id": 89781433, "body": "<code>%s</code> reads <code>Any number of non-whitespace characters, stopping at the first whitespace character found.</code>"}, {"owner": {"reputation": 5821, "user_id": 3185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffc0f4eda45ce3e2ff4249afbfdac43e?s=128&d=identicon&r=PG&f=1", "display_name": "EOF", "link": "https://stackoverflow.com/users/3185968/eof"}, "edited": false, "score": 0, "creation_date": 1531926073, "post_id": 51405209, "comment_id": 89781440, "body": "Maybe you should do some research. Try reading the manpage for <code>[f]scanf()</code>, particularly the <code>%s</code> conversion specifier."}], "answers": [{"comments": [{"owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "edited": false, "score": 0, "creation_date": 1531927252, "post_id": 51405273, "comment_id": 89782271, "body": "Thanks. Worked. (y)"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 3, "last_activity_date": 1531926062, "creation_date": 1531926062, "answer_id": 51405273, "question_id": 51405209, "link": "https://stackoverflow.com/questions/51405209/why-is-c-jumping-to-the-next-printf-instead-of-waiting-for-scanf/51405273#51405273", "title": "Why is C jumping to the next printf instead of waiting for scanf?", "body": "<p>The <code>\"%s\"</code> format for <a href=\"http://en.cppreference.com/w/c/io/fscanf\" rel=\"nofollow noreferrer\"><code>scanf</code> (and family)</a> reads a <strong><em>space delimited</em></strong> word. If you want to read more than one word, you either need to use the <code>\"%[\"</code> format (which can be rather complex), or read the whole line with <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"nofollow noreferrer\"><code>fgets</code></a>.</p>\n\n<p>Remember that the previous <code>scanf</code> call will leave the ending newline in the buffer, so you need to read and discard it before calling <code>fgets</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1654, "user_id": 83037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40eb6c01263ddc795f5ce62b043d13?s=128&d=identicon&r=PG", "display_name": "vladmihaisima", "link": "https://stackoverflow.com/users/83037/vladmihaisima"}, "reply_to_user": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "edited": false, "score": 0, "creation_date": 1531926303, "post_id": 51405303, "comment_id": 89781609, "body": "See answer from Some programmer dude&quot;. You can use for example fgets function"}], "tags": [], "owner": {"reputation": 1654, "user_id": 83037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40eb6c01263ddc795f5ce62b043d13?s=128&d=identicon&r=PG", "display_name": "vladmihaisima", "link": "https://stackoverflow.com/users/83037/vladmihaisima"}, "is_accepted": false, "score": 0, "last_activity_date": 1531926127, "creation_date": 1531926127, "answer_id": 51405303, "question_id": 51405209, "link": "https://stackoverflow.com/questions/51405209/why-is-c-jumping-to-the-next-printf-instead-of-waiting-for-scanf/51405303#51405303", "title": "Why is C jumping to the next printf instead of waiting for scanf?", "body": "<p>From <code>man scanf</code></p>\n\n<pre><code>   s      Matches a sequence of non-white-space characters; the next pointer must be a pointer to character array that is long  enough  to\n          hold  the  input  sequence  and the terminating null byte ('\\0'), which is added automatically.  The input string stops at white\n          space or at the maximum field width, whichever occurs first.\n</code></pre>\n\n<p>Basically the line <code>scanf(\"%s\", customer.billing_address);</code> will read until the first space. Then the next scanf will read the rest.</p>\n"}], "owner": {"reputation": 1202, "user_id": 5234642, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/2Rtgi.jpg?s=128&g=1", "display_name": "Hassan Althaf", "link": "https://stackoverflow.com/users/5234642/hassan-althaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 51405273, "answer_count": 2, "score": -2, "last_activity_date": 1531926561, "creation_date": 1531925896, "last_edit_date": 1531926561, "question_id": 51405209, "link": "https://stackoverflow.com/questions/51405209/why-is-c-jumping-to-the-next-printf-instead-of-waiting-for-scanf", "title": "Why is C jumping to the next printf instead of waiting for scanf?", "body": "<p><strong>Firstly, here's my code:</strong></p>\n\n<pre><code>typedef struct Customer {\n    char name[50];\n    char billing_address[100];\n    char phone_number[15];\n    double amount_paid;\n    double amount_due;\n    char date[20];\n} Customer;\n\nCustomer customer;\n\nprintf(\"CREATE A CUSTOMER PROFILE\\n=========================\\n\");\n\nprintf(\"Name: \");\nscanf(\"%s\", customer.name);\n\nprintf(\"Billing Address: \");\nscanf(\"%s\", customer.billing_address);\n\nprintf(\"Phone Number: \");\nscanf(\"%s\", customer.phone_number);\n\nprintf(\"Amount Paid: \");\nscanf(\"%lf\", &amp;customer.amount_paid);\n\nprintf(\"Amount Due: \");\nscanf(\"%lf\", &amp;customer.amount_due);\n\nprintf(\"Payment Date: \");\nscanf(\"%s\", customer.date);\n\nif (strlen(customer.name) == 0 || strlen(customer.billing_address) == 0 || strlen(customer.phone_number) == 0 || strlen(customer.date) == 0) {\n    printf(\"All fields must be filled in!\");\n    create_customer_profile(is_admin);\n}\n\nFILE *file = fopen(\"customers.txt\", \"ab+\");\n\nfprintf(file, \"[%s], [%s], [%s], [%lf], [%lf], [%s]\", customer.name, customer.billing_address, customer.phone_number, customer.amount_paid, customer.amount_due, customer.date);\n\nprintf(\"The record for the customer has been saved successfully!\");\n</code></pre>\n\n<p>So basically, I was testing my application after writing this code. Here's a view at the console:</p>\n\n<pre><code>CREATE A CUSTOMER PROFILE\n=========================\nName: Hassan\nBilling Address: Jalan Barat\nPhone Number: Amount Paid: 011111111\nAmount Due: 200\nPayment Date: \"12/12/2000\"\nThe record for the customer has been saved successfully!\nProcess finished with exit code 0\n</code></pre>\n\n<p>As you see above, instead of waiting for Phone Number, the system jumps on to Amount Paid on the same line. Here's my file output:</p>\n\n<p>[Hassan], [Jalan], [Barat], [11111111.000000], [200.000000], [\"12/12/2000\"]</p>\n\n<p>For some reason, the phone number was filled with \"Barat\" instead of the address having \"Jalan Barat.\" I would love some help on why C behaves this way.</p>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>Using this input:</p>\n\n<pre><code>CREATE A CUSTOMER PROFILE\n=========================\nName: hahah\nBilling Address: lmfaooooooo\nPhone Number: 01011010101001\nAmount Paid: 010101\nAmount Due: 393993\nPayment Date: 24/12/2018\nThe record for the customer has been saved successfully!\nProcess finished with exit code 0\n</code></pre>\n\n<p>As you can see above, I did not include a space in the billing address field, and so, it works fine with this output in the file:</p>\n\n<pre><code>[hahah], [lmfaooooooo], [01011010101001], [10101.000000], [393993.000000], [24/12/2018]\n</code></pre>\n\n<p><strong>UPDATE 2:</strong></p>\n\n<p><strong>Code Updated:</strong></p>\n\n<p>printf(\"CREATE A CUSTOMER PROFILE\\n=========================\\n\");</p>\n\n<pre><code>printf(\"Name: \");\nfgets(customer.name, 50, stdin);\n\nprintf(\"Billing Address: \");\nfgets(customer.billing_address, 100, stdin);\n\nprintf(\"Phone Number: \");\nscanf(\"%s\", customer.phone_number);\n\nprintf(\"Amount Paid: \");\nscanf(\"%lf\", &amp;customer.amount_paid);\n\nprintf(\"Amount Due: \");\nscanf(\"%lf\", &amp;customer.amount_due);\n\nprintf(\"Payment Date: \");\nscanf(\"%s\", customer.date);\n</code></pre>\n\n<p><strong>Input:</strong></p>\n\n<pre><code>CREATE A CUSTOMER PROFILE\n=========================\nName: Billing Address: test\nPhone Number: 011111\nAmount Paid: 10000\nAmount Due: 50000\nPayment Date: 12/05/2019\nThe record for the customer has been saved successfully!\nProcess finished with exit code 0\n</code></pre>\n\n<p><strong>Output:</strong> </p>\n\n<pre><code>[\n], [test\n], [011111], [10000.000000], [50000.000000], [12/05/2019]\n</code></pre>\n\n<p>I used <code>fgets</code> as suggested, but as you see, for the name, it only reads a line break. How would I solve this issue?</p>\n"}, {"tags": ["c", "string", "pointers", "char", "strcpy"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 5, "creation_date": 1531925425, "post_id": 51405043, "comment_id": 89781012, "body": "Show the caller. BTW, it should return something meaningful."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 7, "creation_date": 1531925550, "post_id": 51405043, "comment_id": 89781096, "body": "What&#39;s the problem with <code>strcpy()</code> only accepting a <code>const char *</code>?  You can pass a non-const <code>char *</code> to the function and the function simply promises it won&#39;t change the data via that <code>const char *</code>.  It does no harm; you can pass const or non-const strings as the second argument."}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1531925734, "post_id": 51405043, "comment_id": 89781198, "body": "The default <code>strcpy</code> is also going to be faster too"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531925804, "post_id": 51405043, "comment_id": 89781234, "body": "What the size of <code>int</code> and <code>double</code> have to do with strings? Also you assign both of them with string literals afterwards."}, {"owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531925891, "post_id": 51405043, "comment_id": 89781298, "body": "@EugeneSh. I&#39;m trying to make sure that they both have enough space to store chars."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531925900, "post_id": 51405043, "comment_id": 89781303, "body": "Since <code>malloc()</code> expects a <code>size_t</code> argument, your <code>(int)</code> casts on the result of <code>sizeof</code> are odd.  The string <code>&quot;hey jude&quot;</code> is 9 bytes long; on most machines, <code>sizeof(double)</code> is <code>8</code> (and <code>sizeof(int)</code> is usually <code>4</code>).  That&#39;s a probable cause of trouble.  You&#39;re leaking memory; and you <b>ARE</b> trying to assign to constants (string literals).  You need to use <code>strcpy()</code> to assign <code>&quot;hello&quot;</code> and <code>&quot;hey jude&quot;</code> \u2014 and you need to make sure you&#39;ve got enough space to copy the strings into.  Hint: you&#39;ve not allocated enough space.  Change your <code>sizeof()</code> operands to <code>16</code>.  Use <code>strcpy()</code> to copy."}, {"owner": {"reputation": 26552, "user_id": 448932, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QgLLl.png?s=128&g=1", "display_name": "500 - Internal Server Error", "link": "https://stackoverflow.com/users/448932/500-internal-server-error"}, "edited": false, "score": 0, "creation_date": 1531925900, "post_id": 51405043, "comment_id": 89781304, "body": "Assigning string literals to pointers the way you do here (probably) does not do what you think it does."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531925942, "post_id": 51405043, "comment_id": 89781338, "body": "If you could assign strings with <code>=</code> you wouldn&#39;t need <code>strcpy</code>."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531925948, "post_id": 51405043, "comment_id": 89781346, "body": "Do you understand what <code>const char *</code> means in this case, and why it&#39;s a Good Thing?"}, {"owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "reply_to_user": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531926002, "post_id": 51405043, "comment_id": 89781380, "body": "@BobJarvis isn&#39;t it telling me that it wants a string literal in the calling?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531926060, "post_id": 51405043, "comment_id": 89781430, "body": "No: the <code>const char *</code> argument says &quot;I, <code>strcpy()</code>, promise not to try to modify the string passed as my second argument; I&#39;ll read it, but I won&#39;t write to it&quot;."}, {"owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1531926563, "post_id": 51405043, "comment_id": 89781807, "body": "No. The prototype for <code>strcpy</code> is <code>char * strcpy ( char * destination, const char * source)</code>. In this case <code>const char * source</code> means that <code>strcpy</code> is not allowed to modify the memory pointed to by the <code>source</code> parameter. It does not mean that <code>source</code> must be a constant, nor does it mean that <code>source</code> must be unmodifiable - it only means that <code>strcpy</code> promises that it won&#39;t change <code>source</code>. Thinking about this differently - if your contention was correct that <code>strcpy</code> can only copy <i>string constants</i> around, it would be a pretty useless routine, wouldn&#39;t it? Well - best of luck."}, {"owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "edited": false, "score": 0, "creation_date": 1531927672, "post_id": 51405043, "comment_id": 89782546, "body": "Got it. Thank you everyone. I shall use strcpy and research more into string literals."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531926319, "post_id": 51405323, "comment_id": 89781626, "body": "Strictly, of course, you should check the result of <code>malloc()</code>.  It isn&#39;t critical just at the moment \u2014 there are other bigger problems in the original code."}, {"owner": {"reputation": 1015, "user_id": 5688187, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-8yTdoOskIOk/AAAAAAAAAAI/AAAAAAAAAAA/YTYc19Rnn9Y/photo.jpg?sz=128", "display_name": "Martin V&#233;ronneau", "link": "https://stackoverflow.com/users/5688187/martin-v%c3%a9ronneau"}, "edited": false, "score": 0, "creation_date": 1531926459, "post_id": 51405323, "comment_id": 89781748, "body": "Writing to read-only memory will cause a SIGSEV. That&#39;s why you get segmentation fault on the first line of your <code>copyString</code> function : you assign to <code>str2</code> the address of a litteral const, and then you try to copy <code>str</code> over it."}, {"owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "edited": false, "score": 0, "creation_date": 1531926498, "post_id": 51405323, "comment_id": 89781769, "body": "Would this explain why if i do <code>free(str2)</code> after doing <code>str2 = &quot;hey jude&quot;;</code> gives me segfault? Because I&#39;ve assigned a literal to it?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "reply_to_user": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "edited": false, "score": 0, "creation_date": 1531926564, "post_id": 51405323, "comment_id": 89781808, "body": "@riciloma yes, plus it wouldn&#39;t be freeing the memory you&#39;ve allocated as you&#39;ve already overwritten it"}], "tags": [], "owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "is_accepted": true, "score": 3, "last_activity_date": 1531926266, "last_edit_date": 1531926266, "creation_date": 1531926192, "answer_id": 51405323, "question_id": 51405043, "link": "https://stackoverflow.com/questions/51405043/segmentation-fault-in-my-strcpy/51405323#51405323", "title": "Segmentation fault in my strcpy", "body": "<p>This is assigning a string literal to <code>str2</code> - the very thing that you claim you aren't doing. This is actually the cause of your segfault.</p>\n\n<pre><code>str2 = \"hey jude\";\n</code></pre>\n\n<p>It also is causing a memory leak as prior to this, you <code>malloc</code>'d some memory and assigned it to <code>str2</code> as well. But not enough memory to hold the string. Typically an <code>int</code> is 4 bytes and you need 9 bytes to store that string.</p>\n\n<p>What you want to do is this, which allocates as many bytes as there are in the string, plus an extra one to store the <code>\\0</code> terminating character at the end.</p>\n\n<pre><code>str2 = malloc(strlen(\"hey jude\")+1);\nstrcpy(str2,\"hey jude\");\n</code></pre>\n\n<p>or on some systems you can use POSIX function <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/strdup.html\" rel=\"nofollow noreferrer\"><code>strdup()</code></a> which effectively does the job of the above in one handy function call.</p>\n\n<pre><code>str2 = strdup(\"hey jude\");\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": false, "score": -1, "last_activity_date": 1531927754, "creation_date": 1531927754, "answer_id": 51405817, "question_id": 51405043, "link": "https://stackoverflow.com/questions/51405043/segmentation-fault-in-my-strcpy/51405817#51405817", "title": "Segmentation fault in my strcpy", "body": "<p>Let's go at it line by line and see where it goes wrong:</p>\n\n<pre><code>int main(){\n    char * str = (char*)malloc((int)sizeof(double));\n    char * str2 = (char *)malloc((int)sizeof(int));\n    str = \"hello\";\n    str2 = \"hey jude\";\n    copyStrings(str2, str);\n    free(str);\n    free(str2);\n    return 0;\n}\n</code></pre>\n\n<p><code>int main(){</code> - this is an improper definition of <code>main</code>. Should be <code>int main(int argc, char **argv)</code></p>\n\n<p><code>char * str = (char*)malloc((int)sizeof(double));</code> - defines <code>str</code>, then allocates (probably) 8 bytes of memory and assigns its address to <code>str</code>. <code>malloc</code> takes a <code>size_t</code> argument, so the cast <code>(int)sizeof(double)</code> is incorrect. Also, in C the return value of <code>malloc</code> should <strong>never</strong> be cast. So this line should be <code>char * str = malloc(sizeof(double));</code></p>\n\n<p><code>char * str2 = (char *)malloc((int)sizeof(int));</code> - all the same problems as the preceding line. Should be <code>char *str2 = malloc(sizeof(int));</code></p>\n\n<p><code>str = \"hello\";</code> - causes a memory leak, because the memory you JUST ALLOCATED two lines earlier is now irretrievably lost. You've got two options here - either don't allocate the memory when defining <code>str</code> or free it first. Let's do the latter:</p>\n\n<pre><code>free(str);\nstr = \"hello\";\n</code></pre>\n\n<p><code>str2 = \"hey jude\";</code> - same problem, similar solution:</p>\n\n<pre><code>free(str2);\nstr2 = \"hey jude\";\n</code></pre>\n\n<p><code>copyStrings(str2, str);</code> - here you're telling your routine to copy the constant string \"hello\" over the top of the constant string \"hey jude\". This will work fine <strong>on some systems</strong>, but will blow up <strong>on other systems</strong>. The question is in the treatment of the constant string \"hey jude\". If it's stored in modifiable memory the code will work just fine. If it's stored in memory which is marked as being unmodifiable, however, it will blow up. It seems that the latter is the case on your system. To fix this you probably want to go back to the previous line and change it to</p>\n\n<pre><code>str2 = malloc(20);\n</code></pre>\n\n<p>That's more memory than you'll need, but it will work just fine.</p>\n\n<p><code>free(str);</code> - you're attempting to free the constant string \"hello\", which is not dynamically allocated memory. This needed to be done prior to the assignment <code>str = \"hello\";</code>.</p>\n\n<p><code>free(str2;</code> - same problem as above. This needed to be done prior to the assignment <code>str2 = \"hey jude\";</code>.</p>\n\n<p><code>}</code> - correct</p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 833, "user_id": 4663815, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/3a9de54196ca821257905f0ba8f98997?s=128&d=identicon&r=PG&f=1", "display_name": "riciloma", "link": "https://stackoverflow.com/users/4663815/riciloma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 51405323, "answer_count": 2, "score": 1, "last_activity_date": 1531927754, "creation_date": 1531925393, "last_edit_date": 1531925753, "question_id": 51405043, "link": "https://stackoverflow.com/questions/51405043/segmentation-fault-in-my-strcpy", "title": "Segmentation fault in my strcpy", "body": "<p>I'm writing my own <code>strcpy</code> due to the fact that the default one in <code>string.h</code> only accept a <code>const char *</code> as a source string to copy from.\nI'm trying this very basic prototype (yes, the return isn't meaningful, I'm just trying things):</p>\n\n<pre><code>int copyStrings(char * dest, char * source){\n    int i=0;\n    while(source[i]!='\\0'){\n        dest[i]=source[i];\n        i++;\n    }\n    dest[i]='\\0';\n    return 0;\n}\n</code></pre>\n\n<p>and it gives me <code>SIGSEGV, Segmentation Fault</code> error in gdb, at the line <code>dest[i]=source[i]</code>, right at the <em>first</em> character. I'm pretty sure <code>dest[i]</code> isn't a string literal, so I should be able to modify it. </p>\n\n<p>What am I doing wrong?</p>\n\n<p>EDIT: here's the calling</p>\n\n<pre><code>int main(){\n    char * str = (char*)malloc((int)sizeof(double));\n    char * str2 = (char *)malloc((int)sizeof(int));\n    str = \"hello\";\n    str2 = \"hey jude\";\n    copyStrings(str2, str);\n    free(str);\n    free(str2);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "function", "input", "error-handling"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1531925270, "post_id": 51404630, "comment_id": 89780882, "body": "In your case <code>-1</code> will not interfere with valid data which is between 0 and 9."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531925433, "post_id": 51404630, "comment_id": 89781019, "body": "You have to decide whether the errors matter.  If they matter, they must be handled by the calling code.  If they don&#39;t matter, why are you bothering with the validation in the first place?  If you design the function so it can return an error state (or detect an error state), you are saying &quot;it matters&quot;.  So, calling code has to deal with the possibility of error.  If the data won&#39;t be in error, why are you checking?"}, {"owner": {"reputation": 525, "user_id": 8474071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df42baf2b66b6426f6f433228f378a87?s=128&d=identicon&r=PG&f=1", "display_name": "RayaneCTX", "link": "https://stackoverflow.com/users/8474071/rayanectx"}, "edited": false, "score": 0, "creation_date": 1531925462, "post_id": 51404630, "comment_id": 89781041, "body": "Unless the input verification is a crucial part of your algorithm, I would remove the check altogether and simply ensure that I always use the function on valid characters."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531927172, "post_id": 51404630, "comment_id": 89782218, "body": "You might consider the merits of <code>assert(isdigit((unsigned char)c));</code> in place of the <code>if</code> statement, or placed before the <code>if</code> statement.  That will tell you whether your debug testing ever spots a non-digit in the data."}], "owner": {"reputation": 161, "user_id": 5148033, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yb9AK.jpg?s=128&g=1", "display_name": "anfauglit", "link": "https://stackoverflow.com/users/5148033/anfauglit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541453676, "creation_date": 1531924140, "last_edit_date": 1541453676, "question_id": 51404630, "link": "https://stackoverflow.com/questions/51404630/validation-of-input-data-inside-or-outside-a-function-the-optimal-way", "title": "Validation of input data. Inside or outside a function, the optimal way", "body": "<p>Below is a function which converts a character representing a decimal digit into an integer which has the value of that digit.</p>\n\n<pre><code>#define CONVERSION_ERROR -1\n\nint8_t char_to_int (char c)\n{\n    if ( c &lt; '0' || c &gt; '9' ) return CONVERSION_ERROR;\n    return c - '0';\n}\n</code></pre>\n\n<p>Design-wise, how practical it is to check the function input and return error code inside the function like the one above. Usually this type of a function will be used inside an expression where you won't check for the error codes but such a return value can mess your calculations in a quite unpredictable way. Sure, you could choose something convenient, say <strong>0</strong>, for the error code, but then it will interfere with the valid data.</p>\n\n<p>On the other hand you can remove the input check from a function altogether and move it somewhere outside but by doing this you will probably make your function less self contained.</p>\n\n<p>So I wonder where is that fine line between which checks to perform inside and which outside the function?</p>\n"}, {"tags": ["c", "bit-fields"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1531922725, "post_id": 51404041, "comment_id": 89779059, "body": "Who says you can&#39;t?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531923361, "post_id": 51404041, "comment_id": 89779473, "body": "Once you&#39;ve exactly specified the number of bits, it would be kind of strange to call it <code>long</code> or <code>short</code>.  There&#39;s default <code>int</code>, and then as a departure from that there&#39;s <code>short int</code> and <code>long int</code>, and then as a totally different departure there&#39;s bitfields which are exact-sized ints, but it doesn&#39;t really make sense to apply both departures at once."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531927371, "post_id": 51404041, "comment_id": 89782348, "body": "Remember that bit-fields are weird, not least because most aspects of their behaviour are implementation defined.  One particular issue is that using plain <code>int</code> may create a signed or an unsigned bit-field \u2014 one of many aspects of implementation-defined behaviour.  Note that the implementation must specify what it does, but it may do either.  Anywhere else, <code>int</code> is equivalent to <code>signed int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531922872, "post_id": 51404134, "comment_id": 89779156, "body": "bitfield is the definition of implemented defined as <code>i = i++</code> the definition of undefined behavior."}, {"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531922946, "post_id": 51404134, "comment_id": 89779203, "body": "@Stargateur: Would you mind editing / rephrasing that comment, as I have no idea what you wanted to say there?"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531923135, "post_id": 51404134, "comment_id": 89779332, "body": "@DevSolar I think he&#39;s trying to say that bitfield specifics are the canonical example of implementation-defined behavior.  (They&#39;re not just a random example of implementation-defined behavior, he thinks they&#39;re the first thing anyone thinks of when they think of implementation-defined behavior.)"}], "tags": [], "owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "is_accepted": false, "score": 3, "last_activity_date": 1531923159, "last_edit_date": 1531923159, "creation_date": 1531922742, "answer_id": 51404134, "question_id": 51404041, "link": "https://stackoverflow.com/questions/51404041/is-it-allowed-to-use-short-or-any-other-types-in-place-of-int-in-bit-fileds/51404134#51404134", "title": "Is it allowed to use short or any other types in place of int in bit fileds", "body": "<p>From <a href=\"https://en.cppreference.com/w/c/language/bit_field\" rel=\"nofollow noreferrer\">cppreference.com</a>:</p>\n\n<blockquote>\n  <p>Bit fields can have only one of four types (possibly <code>const</code> or <code>volatile</code> qualified):</p>\n  \n  <ul>\n  <li><code>unsigned int</code>, for unsigned bit fields (<code>unsigned int b:3;</code> has the range 0..7)</li>\n  <li><code>signed int</code>, for signed bit fields (<code>signed int b:3;</code> has the range -4..3)</li>\n  <li><code>int</code>, for bit fields with implementation-defined signedness (Note that this differs from the meaning of the keyword int everywhere else, where it means \"signed int\"). For example, <code>int b:3;</code> may have the range of values 0..7 or -4..3.</li>\n  <li><code>_Bool</code>, for single-bit bit fields (<code>bool x:1;</code> has the range 0..1 and implicit conversions to and from it follow the boolean conversion rules. </li>\n  </ul>\n  \n  <p>Additional implementation-defined types may be acceptable.</p>\n</blockquote>\n\n<p>It helps somewhat to think of this in analogous terms to how you have (outside of bitfields) <code>unsigned char</code>, <code>signed char</code>, and <code>char</code> (with the latter's signed-ness being implementation defined).</p>\n"}, {"comments": [{"owner": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1531923473, "post_id": 51404289, "comment_id": 89779555, "body": "Yea... standard trumps cppreference.cpp. FWIW, I brought this up on the discussion page over there."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 0, "creation_date": 1531923619, "post_id": 51404289, "comment_id": 89779663, "body": "@DevSolar I believe <code>signed int</code> is equivalent to <code>int</code>.  On the other hand, it is implementation defined whether <code>char</code> is signed or unsigned."}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "reply_to_user": {"reputation": 59603, "user_id": 60281, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/29ebf39f3857b4fc4f51e93e7b9c4af4?s=128&d=identicon&r=PG", "display_name": "DevSolar", "link": "https://stackoverflow.com/users/60281/devsolar"}, "edited": false, "score": 2, "creation_date": 1531925719, "post_id": 51404289, "comment_id": 89781189, "body": "@DevSolar : cppreference isn&#39;t wrong about <code>int</code> having implementation defined signed-ness in the context of a bit-field. Ref. 6.7.2&#167;5 : &quot;Each of the comma-separated multisets designates the same type, except that for bit-fields, it is implementation-defined whether the specifier <code>int</code> designates the same type as <code>signed int</code> or the same type as <code>unsigned int</code>.&quot;"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531929668, "post_id": 51404289, "comment_id": 89783926, "body": "In a bit-field, I believe <code>signed int</code> is not necessarily equivalent to <code>int</code> \u2014 though that equivalence applies everywhere else."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1531923738, "last_edit_date": 1531923738, "creation_date": 1531923209, "answer_id": 51404289, "question_id": 51404041, "link": "https://stackoverflow.com/questions/51404041/is-it-allowed-to-use-short-or-any-other-types-in-place-of-int-in-bit-fileds/51404289#51404289", "title": "Is it allowed to use short or any other types in place of int in bit fileds", "body": "<p>Section 6.7.2.1p5 of the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C standard</a> dictates the types that are allowed for a bit-field:</p>\n\n<blockquote>\n  <p>A bit-field shall have a type that is a qualified or unqualified\n  version of <code>_Bool</code>, <code>signed int</code>, <code>unsigned int</code>, <strong>or some other\n  implementation-defined type</strong>. It is implementation-defined whether\n  atomic types are permitted.</p>\n</blockquote>\n\n<p>So a standard-conforming compiler <em>may</em> support <code>unsigned short</code> as a type for a bit-field, but it doesn't have to.  So yes, you <em>can</em> use <code>unsigned short</code> for a bit-field if the implementation allows it.</p>\n\n<p>For example, <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Structures-unions-enumerations-and-bit-fields-implementation.html\" rel=\"nofollow noreferrer\">gcc</a> does support it:</p>\n\n<blockquote>\n  <p><strong>4.9 Structures, Unions, Enumerations, and Bit-Fields</strong></p>\n  \n  <p>...</p>\n  \n  <ul>\n  <li><p><em>Allowable bit-field types other than _Bool, signed int, and unsigned\n  int (C99 and C11 6.7.2.1).</em></p>\n  \n  <p>Other integer types, such as long int, and enumerated types are\n  permitted even in strictly conforming mode.</p></li>\n  </ul>\n</blockquote>\n\n<p>As does <a href=\"https://msdn.microsoft.com/en-us/library/ewwyfdbe.aspx\" rel=\"nofollow noreferrer\">MCVC</a>:</p>\n\n<blockquote>\n  <p><strong>Syntax</strong></p>\n\n<pre><code>declarator  : constant-expression  \n</code></pre>\n  \n  <p><strong>Remarks</strong></p>\n  \n  <p>The (optional) declarator is the name by which the member is accessed\n  in the program. <strong>It must be an integral type (including enumerated\n  types).</strong> The constant-expression specifies the number of bits the\n  member occupies in the structure. Anonymous bit fields \u2014 that is,\n  bit-field members with no identifier \u2014 can be used for padding.</p>\n</blockquote>\n\n<p>Implementations that use integer types besides <code>int</code> can use that size to determine how much padding to use between bit-fields and other fields.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6552957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1531923738, "creation_date": 1531922476, "last_edit_date": 1531922627, "question_id": 51404041, "link": "https://stackoverflow.com/questions/51404041/is-it-allowed-to-use-short-or-any-other-types-in-place-of-int-in-bit-fileds", "title": "Is it allowed to use short or any other types in place of int in bit fileds", "body": "<p>In most of the example I have seen about bit fields\n<code>unsigned int</code> is used.</p>\n\n<pre><code>struct example\n{\n    unsigned int number: 1\n}\n</code></pre>\n\n<p>why can't we use <code>unsigned short</code> or some  other data type instead?</p>\n"}, {"tags": ["c", "inline"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531927742, "post_id": 51403967, "comment_id": 89782590, "body": "When optimizing, GCC can and does generate inline code instead of calls to (small enough) static functions without the <code>inline</code> keyword.  In fact, it can even do that for quite big functions if the function is only called once.  That&#39;s what you&#39;re seeing in Test 3."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531927796, "post_id": 51403967, "comment_id": 89782624, "body": "Have you tried higher levels of optimization (<code>-O2</code> or <code>-O3</code>) for Test 4?  Do the results change?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531929802, "post_id": 51403967, "comment_id": 89784024, "body": "Amongst other questions, see: <a href=\"https://stackoverflow.com/questions/7762731/whats-the-difference-between-static-and-static-inline-function\" title=\"whats the difference between static and static inline function\">stackoverflow.com/questions/7762731/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/6312597/is-inline-without-static-or-extern-ever-useful-in-c99\" title=\"is inline without static or extern ever useful in c99\">stackoverflow.com/questions/6312597/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/1137575/inline-functions-vs-preprocessor-macros\" title=\"inline functions vs preprocessor macros\">stackoverflow.com/questions/1137575/&hellip;</a>, <a href=\"https://stackoverflow.com/questions/216510/extern-inline\">stackoverflow.com/questions/216510/extern-inline</a>."}], "answers": [{"comments": [{"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1531923395, "post_id": 51404154, "comment_id": 89779496, "body": "How bizarre. There are places in the Linux Kernel where not honoring  inline causes incorrect code generation."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1531927590, "post_id": 51404154, "comment_id": 89782500, "body": "@Joshua: The Linux kernel is not a generic C program.  It depends on the GNU C Compiler in places \u2014 it won&#39;t compile unless the C compiler is compatible with GCC.  GCC had <code>inline</code> long before standard C did.  It&#39;s version had different semantics.  It now follows the (C99) standard semantics, though, for <code>inline</code>."}], "tags": [], "owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922828, "creation_date": 1531922828, "answer_id": 51404154, "question_id": 51403967, "link": "https://stackoverflow.com/questions/51403967/inline-vs-static-inline-c/51404154#51404154", "title": "inline vs static inline c", "body": "<p>It is one of those questionable decisions of the C Language Standards people... use of <code>inline</code> does not guarantee a function to be inlined... the keyword only suggests to the compiler that the function <em>could</em> be inlined.</p>\n\n<p>I've had lengthy exchanges on this topic with the ISO WG; this followed a MISRA guideline that requires all <code>inline</code> functions to be declared at module scope using the <code>static</code> keyword.  Their logic is that there may be circumstances where the compiler needs to not inline the function... and equally, there may be cases where that non-inlined function needs to have global scope!</p>\n\n<p>IMHO, if a programmer adds the <code>inline</code> keyword, then the suggestion is that they know what they are doing, and that function should be inline.</p>\n\n<p>As you suggest, in its current form, the <code>inline</code> keyword is effectively pointless, unless a compiler treats it seriously.</p>\n"}, {"comments": [{"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "edited": false, "score": 2, "creation_date": 1531923079, "post_id": 51404168, "comment_id": 89779291, "body": "This is a C++ answer to a C question. <code>inline</code> in C works differently from <code>inline</code> in C++."}], "tags": [], "owner": {"reputation": 3837, "user_id": 1749713, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/PqPOy.png?s=128&g=1", "display_name": "Micha\u0142 Walenciak", "link": "https://stackoverflow.com/users/1749713/micha%c5%82-walenciak"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922860, "creation_date": 1531922860, "answer_id": 51404168, "question_id": 51403967, "link": "https://stackoverflow.com/questions/51403967/inline-vs-static-inline-c/51404168#51404168", "title": "inline vs static inline c", "body": "<p>In your first test you disable optimizations. Inlining is an optimization method. Do not expect it to happen. </p>\n\n<p>Also <code>inline</code> keyword doesn't work nowadays as it used to in the past. I'd say it's only purpose is to have functions in headers without having linker errors about duplicated symbols (when more than one cpp file uses such a header).</p>\n\n<p>Let your compiler do its work. Just enable optimizations (including LTO) and do not worry about details.</p>\n"}], "owner": {"reputation": 861, "user_id": 1651499, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/abe7235d2a5944f6656545de90ebe2c4?s=128&d=identicon&r=PG", "display_name": "rem", "link": "https://stackoverflow.com/users/1651499/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1531922860, "creation_date": 1531922283, "question_id": 51403967, "link": "https://stackoverflow.com/questions/51403967/inline-vs-static-inline-c", "title": "inline vs static inline c", "body": "<p>Here are some simple tests run on a x86_64 to show assembler code generated when using inline statement : </p>\n\n<p><strong>TEST 1</strong></p>\n\n<pre><code>static inline void\nshow_text(void)\n{\n  printf(\"Hello\\n\");\n}\n\nint main(int argc, char *argv[])\n{\n  show_text();\n  return 0;\n}\n</code></pre>\n\n<p>And assembler : </p>\n\n<pre><code>gcc -O0 -fno-asynchronous-unwind-tables -S -masm=att main.c  &amp;&amp; less main.s\n\n        .file   \"main.c\"\n        .text\n        .section        .rodata\n.LC0:\n        .string \"Hello\"\n        .text\n        .type   show_text, @function\nshow_text:\n        pushq   %rbp\n        movq    %rsp, %rbp\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        nop\n        popq    %rbp\n        ret\n        .size   show_text, .-show_text\n        .globl  main\n        .type   main, @function\nmain:\n        pushq   %rbp\n        movq    %rsp, %rbp\n        subq    $16, %rsp\n        movl    %edi, -4(%rbp)\n        movq    %rsi, -16(%rbp)\n        call    show_text\n        movl    $0, %eax\n        leave\n        ret\n        .size   main, .-main\n        .ident  \"GCC: (GNU) 7.3.1 20180312\"\n        .section        .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p><strong>Test 1 result :</strong> inline suggestion not taken into account by compiler</p>\n\n<p><strong>Test 2</strong></p>\n\n<p>Same code as test 1, but with -O1 optimization flag</p>\n\n<pre><code>gcc -O1 -fno-asynchronous-unwind-tables -S -masm=att main.c  &amp;&amp; less main.s\n\n        .file   \"main.c\"\n        .text\n        .section        .rodata.str1.1,\"aMS\",@progbits,1\n.LC0:\n        .string \"Hello\"\n        .text\n        .globl  main\n        .type   main, @function\nmain:\n        subq    $8, %rsp\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        movl    $0, %eax\n        addq    $8, %rsp\n        ret\n        .size   main, .-main\n        .ident  \"GCC: (GNU) 7.3.1 20180312\"\n        .section        .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p><strong>Test 2 result :</strong> no more show_text function defined in assembler</p>\n\n<p><strong>Test 3</strong>\nshow_text not declared as inline, -O1 optimization flag</p>\n\n<p><strong>Test 3 result :</strong> no more show_text function defined in assembler, with or without inline : same generated code</p>\n\n<p><strong>Test 4</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\nstatic inline void\nshow_text(void)\n{\n  printf(\"Hello\\n\");\n  printf(\"Hello\\n\");\n  printf(\"Hello\\n\");\n  printf(\"Hello\\n\");\n  printf(\"Hello\\n\");\n  printf(\"Hello\\n\");\n}\n\nint main(int argc, char *argv[])\n{\n  show_text();\n  show_text();\n  return 0;\n}\n</code></pre>\n\n<p>produces : </p>\n\n<pre><code>gcc -O1 -fno-asynchronous-unwind-tables -S -masm=att main.c  &amp;&amp; less main.s\n\n       .file   \"main.c\"\n        .text\n        .section        .rodata\n.LC0:\n        .string \"Hello\"\n        .text\n        .type   show_text, @function\nshow_text:\n        pushq   %rbp\n        movq    %rsp, %rbp\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        leaq    .LC0(%rip), %rdi\n        call    puts@PLT\n        nop\n        popq    %rbp\n        ret\n        .size   show_text, .-show_text\n        .globl  main\n        .type   main, @function\nmain:\n        pushq   %rbp\n        movq    %rsp, %rbp\n        subq    $16, %rsp\n        movl    %edi, -4(%rbp)\n        movq    %rsi, -16(%rbp)\n        call    show_text\n        call    show_text\n        movl    $0, %eax\n        leave\n        ret\n        .size   main, .-main\n        .ident  \"GCC: (GNU) 7.3.1 20180312\"\n        .section        .note.GNU-stack,\"\",@progbits\n</code></pre>\n\n<p><strong>Test 4 result :</strong> <code>show_text</code> defined in assembler, inline suggestion not taken into account</p>\n\n<p>I understand inline keyword does not force inlining. But for <strong>Test 1</strong> results, what can prevent <code>show_text</code> code replacement in main? </p>\n\n<p>So far, I used to inline some small static functions in my C source code. But from these results it seems quite useless.\nWhy should I declare some of my small functions <code>static inline</code> when using some modern compilers (and possibly compiling optimized code)?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 6, "creation_date": 1531921621, "post_id": 51403674, "comment_id": 89778261, "body": "<a href=\"https://cdecl.org/?q=void+%28%2Aaction%29%28struct+softirq_action+%2A%29\" rel=\"nofollow noreferrer\">This</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531922021, "post_id": 51403674, "comment_id": 89778576, "body": "Start with understanding why this is a declaration, not a definition. Next check your C book, chapter Pointer -&gt; Function Pointer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1531922190, "post_id": 51403674, "comment_id": 89778693, "body": "if you are not sure you can check here: cdecl.org"}], "answers": [{"comments": [{"owner": {"reputation": 1654, "user_id": 83037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a40eb6c01263ddc795f5ce62b043d13?s=128&d=identicon&r=PG", "display_name": "vladmihaisima", "link": "https://stackoverflow.com/users/83037/vladmihaisima"}, "edited": false, "score": 0, "creation_date": 1531924520, "post_id": 51403782, "comment_id": 89780357, "body": "If you agree with the answer you should accept it and/or upvote it (click the up arrow on the left of the answer)"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1531921838, "creation_date": 1531921838, "answer_id": 51403782, "question_id": 51403674, "link": "https://stackoverflow.com/questions/51403674/how-to-understand-voidactionstruct-softirq-action/51403782#51403782", "title": "How to understand void\t(*action)(struct softirq_action *)", "body": "<p>declare action as pointer to function (taking pointer to struct softirq_action as it's only parameter) returning void</p>\n"}, {"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 4, "last_activity_date": 1531924335, "creation_date": 1531924335, "answer_id": 51404707, "question_id": 51403674, "link": "https://stackoverflow.com/questions/51403674/how-to-understand-voidactionstruct-softirq-action/51404707#51404707", "title": "How to understand void\t(*action)(struct softirq_action *)", "body": "<p>Start with the leftmost identifier and work your way out, remembering the following rules:</p>\n\n<pre><code>T *a[N];   // a is an array of pointer to T\nT (*a)[N]; // a is a pointer to an array of T\nT *f();    // f is a function returning a pointer to T\nT (*f)();  // f is a pointer to a function returning T\n</code></pre>\n\n<p>So:</p>\n\n<pre><code>       action                                -- action\n      *action                                -- is a pointer to\n     (*action)(                       )      -- a function taking\n     (*action)(                       )      --   unnamed parameter\n     (*action)(                      *)      --   is a pointer to\n     (*action)(struct softirq_action *)      --   struct softirq_action\nvoid (*action)(struct softirq_action *);     -- and returning void\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10100303, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tUD8HQbDHuQ/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pryO8KtzJernRyE-XZHDrgoeueWQ/mo/photo.jpg?sz=128", "display_name": "Michael Georgy", "link": "https://stackoverflow.com/users/10100303/michael-georgy"}, "is_accepted": false, "score": 0, "last_activity_date": 1531924726, "creation_date": 1531924726, "answer_id": 51404845, "question_id": 51403674, "link": "https://stackoverflow.com/questions/51403674/how-to-understand-voidactionstruct-softirq-action/51404845#51404845", "title": "How to understand void\t(*action)(struct softirq_action *)", "body": "<p>as the answers said: this is a declaration not a definition.\nHow to understand it ? you can follow these steps:\n1- start with the identifier followed by the asterix which is \"action\", as it is preceded by asterix so it is a pointer \n2- if it is enclosed in brackets, it is a pointer to function.\n3- read the items before the pointer name, this is the return type\n4- read the items after the pointer name, this is the function parameters.</p>\n\n<p>so to summarize: <strong>action is a pointer to function that return void &amp; take a pointer to structure as a parameter.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 2721340, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59396ee0c7c8ec1b430289cf5dc13123?s=128&d=identicon&r=PG&f=1", "display_name": "bmann", "link": "https://stackoverflow.com/users/2721340/bmann"}, "is_accepted": false, "score": 0, "last_activity_date": 1532005202, "creation_date": 1532005202, "answer_id": 51423342, "question_id": 51403674, "link": "https://stackoverflow.com/questions/51403674/how-to-understand-voidactionstruct-softirq-action/51423342#51423342", "title": "How to understand void\t(*action)(struct softirq_action *)", "body": "<p>It is a <a href=\"https://en.wikipedia.org/wiki/Function_pointer\" rel=\"nofollow noreferrer\">function pointer</a> variable (called action) which can point to any function with a <code>struct softirq_action *</code> parameter and a <code>void</code> return value.</p>\n\n<p>For example if you have this function:</p>\n\n<pre><code>void IRQ_handler(struct softirq_action *);\n</code></pre>\n\n<p>then you can give its address to the pointer like</p>\n\n<pre><code>action = &amp;IRQ_handler;\n</code></pre>\n\n<p>and call it like</p>\n\n<pre><code>action(action_struct);\n</code></pre>\n\n<p>With a function pointer you can determine in runtime which function to call.</p>\n"}], "owner": {"reputation": 31, "user_id": 10097051, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7dbf1ee440688f84b6a740527873fad7?s=128&d=identicon&r=PG&f=1", "display_name": "M xie", "link": "https://stackoverflow.com/users/10097051/m-xie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 4, "score": -2, "last_activity_date": 1532005202, "creation_date": 1531921569, "last_edit_date": 1531939303, "question_id": 51403674, "link": "https://stackoverflow.com/questions/51403674/how-to-understand-voidactionstruct-softirq-action", "title": "How to understand void\t(*action)(struct softirq_action *)", "body": "<p>This is soft interrupt in Linux kernel. How to understand the definition <code>void (*action)(struct softirq_action *);</code>?</p>\n\n<pre><code>struct softirq_action\n{\n    void (*action)(struct softirq_action *);\n};\n</code></pre>\n"}, {"tags": ["c", "loops", "character", "ascii", "extended-ascii"], "comments": [{"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 2, "creation_date": 1531918618, "post_id": 51402570, "comment_id": 89775915, "body": "What is the maximum value of an unsigned char? Not 256."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531918745, "post_id": 51402570, "comment_id": 89776011, "body": "<code>unsigned char a</code> --&gt; <code>unsigned a</code> or <code>int a</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531922502, "post_id": 51402570, "comment_id": 89778897, "body": "There is no guarantee a C implementation/environment uses ASCII at all."}, {"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 0, "creation_date": 1531932637, "post_id": 51402570, "comment_id": 89785679, "body": "For characters to have meaning, you should have in mind which Extended ASCII character set you&#39;re working with. &quot;Extended ASCII&quot; is a characteristic of certain character encodings but you can only work with one character encoding at a time.."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1531918602, "creation_date": 1531918602, "answer_id": 51402612, "question_id": 51402570, "link": "https://stackoverflow.com/questions/51402570/what-are-good-methods-in-printing-extended-ascii-characters-for-c/51402612#51402612", "title": "What are good methods in printing Extended ASCII characters for C?", "body": "<p>The loop</p>\n\n<pre><code>for (unsigned char a = 128; a &lt; 256; a++)\n</code></pre>\n\n<p>runs forever on your platform since 255 + 1 is 0 due to <em>wrap around</em> of an <code>unsigned</code> type. You <em>could</em> use the confusing (when you see it for the first time)</p>\n\n<pre><code>for (unsigned char a = 128; a &gt;= 128; a++)\n</code></pre>\n\n<p>What gets printed to your console will depend on the <em>encoding</em> your system uses (<em>probably</em> ASCII), along with how your terminal prints characters in that range.</p>\n"}, {"tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 1, "last_activity_date": 1531918613, "creation_date": 1531918613, "answer_id": 51402617, "question_id": 51402570, "link": "https://stackoverflow.com/questions/51402570/what-are-good-methods-in-printing-extended-ascii-characters-for-c/51402617#51402617", "title": "What are good methods in printing Extended ASCII characters for C?", "body": "<p>This</p>\n\n<pre><code>a &lt; 256\n</code></pre>\n\n<p>is always <code>true</code> as <code>unsigned char</code> valid range is &lt;0, 255>.</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": true, "score": 3, "last_activity_date": 1531999073, "last_edit_date": 1531999073, "creation_date": 1531925111, "answer_id": 51404964, "question_id": 51402570, "link": "https://stackoverflow.com/questions/51402570/what-are-good-methods-in-printing-extended-ascii-characters-for-c/51404964#51404964", "title": "What are good methods in printing Extended ASCII characters for C?", "body": "<p>You have an infinite loop because the maximum value representable by an <code>unsigned char</code> is 255<sup>1</sup>, and incrementing it past that point causes it to wrap around to zero, so the condition <code>a &lt; 256</code> is always true.  Your program will work as you intended if you use <code>int</code> instead:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    for (int a = 128; a &lt; 256; a++)\n        printf(\"a=%c\\n\", a); \n    return 0;\n}\n</code></pre>\n\n<p>It is perfectly fine to pass an <code>int</code> to printf's <code>%c</code>,<sup>2</sup> as long as its <em>value</em> is in the range representable by <code>unsigned char</code>, which it is.</p>\n\n<p>However, if you run this program on a modern computer, you're still likely to get \"strange characters\".  For instance, when I run it on my computer I get 128 lines of</p>\n\n<pre><code>a=\ufffd\n</code></pre>\n\n<p>This is because a <em>modern</em> computer's CLI windows expect UTF-8-encoded Unicode text, and in UTF-8, all the characters above U+007F are encoded using more than one byte.  So the terminal emulator receives what it thinks of as an invalid, incomplete byte sequence one each line, and it prints a special \"replacement character\" for them.  The simplest way to see the <em>actual</em> characters in the U+0080..U+00FF range is to use C's \"wide characters\":</p>\n\n<pre><code>#include &lt;wchar.h&gt;\n#include &lt;locale.h&gt;\nint main(void)\n{\n    setlocale(LC_ALL, \"\");\n    for (int a = 128; a &lt; 256; a++)\n        wprintf(L\"U+%04X = '%lc'\\n\", a, (wchar_t)a);\n    return 0;\n}\n</code></pre>\n\n<p><code>wprintf</code> takes care of converting from wide characters to whatever text encoding the environment expects.  This is not guaranteed to work, because C's \"wide characters\" are underspecified and ill-designed to the point where I actually recommend people do <em>not</em> use them in production code (instead, use exclusively narrow strings holding UTF-8), but for a test program like this you can usually get away with it.  I get output like this:</p>\n\n<pre><code>U+0080 = ''\nU+0081 = ''\nU+0082 = ''\n...\nU+00A0 = '\u00a0'\nU+00A1 = '\u00a1'\nU+00A2 = '\u00a2'\n...\nU+00FD = '\u00fd'\nU+00FE = '\u00fe'\nU+00FF = '\u00ff'\n</code></pre>\n\n<p>You could get something different, if your computer is insufficiently modern.  The U+0080..U+009F range is yet more useless control characters, which is why those are not showing anything.</p>\n\n<hr>\n\n<p><sup>1</sup> Technically [0, 255] is the <em>minimum</em> required range for <code>unsigned char</code>; the C standard allows for the possibility that it can represent a larger range, e.g. [0, 511].  If you had run your program on a computer where <code>unsigned char</code> had that range, it would have worked.  However, no one has manufactured such a computer in many years.  If you really want to worry about it, include <code>&lt;limits.h&gt;</code> and verify that <code>CHAR_BIT</code> is 8 and/or that <code>UCHAR_MAX</code> is 255.</p>\n\n<p><sup>2</sup> Technically, thanks to a vestigial feature of C called \"default argument promotion\", you <em>always</em> pass an <code>int</code> to <code>%c</code>, even if the variable you supply has a character type.</p>\n"}], "owner": {"reputation": 887, "user_id": 8768374, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Hyjh8IMe3Ho/AAAAAAAAAAI/AAAAAAAAAMQ/mqo_dEpoGPQ/photo.jpg?sz=128", "display_name": "Sleeping On a Giant&#39;s Shoulder", "link": "https://stackoverflow.com/users/8768374/sleeping-on-a-giants-shoulder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1342, "favorite_count": 0, "accepted_answer_id": 51404964, "answer_count": 3, "score": 3, "last_activity_date": 1531999073, "creation_date": 1531918492, "question_id": 51402570, "link": "https://stackoverflow.com/questions/51402570/what-are-good-methods-in-printing-extended-ascii-characters-for-c", "title": "What are good methods in printing Extended ASCII characters for C?", "body": "<p>First I would like to see what ASCII printable characters in C look like.</p>\n\n<p>The following is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    for (char a = 32; a &lt; 127; a++)\n        printf(\"a=%c\\n\", a); \n    return 0;\n}\n</code></pre>\n\n<hr>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    for (unsigned char a = 32; a &lt; 127; a++)\n        printf(\"a=%c\\n\", a); \n    return 0;\n}\n</code></pre>\n\n<p>The above two code snippets work nicely, telling me about ASCII printable characters.</p>\n\n<p>Now next I would like to have a look at Extended ASCII characters for C.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    for (unsigned char a = 128; a &lt; 256; a++)\n        printf(\"a=%c\\n\", a); \n\n    return 0;\n}\n</code></pre>\n\n<p>Then comes the endless loop with unknown strange characters.</p>\n\n<p>Where did I do wrong? </p>\n\n<p>I thought loop would stop when a reaches 256, but it didn't.</p>\n\n<p>And where did strange characters come from? </p>\n\n<p>How can I print Extended ASCII characters for C?</p>\n"}, {"tags": ["c", "dns", "bind", "resolv"], "comments": [{"owner": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 1, "creation_date": 1531928743, "post_id": 51401982, "comment_id": 89783250, "body": "It depends on what you are trying to learn about the DNS, but you might have a look at the getdns API as it is newer and better for all stuff related to DNSSEC."}, {"owner": {"reputation": 85, "user_id": 4516787, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1541147449/picture?type=large", "display_name": "Giulio Paoli", "link": "https://stackoverflow.com/users/4516787/giulio-paoli"}, "reply_to_user": {"reputation": 7502, "user_id": 6368697, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yq4cG.jpg?s=128&g=1", "display_name": "Patrick Mevzek", "link": "https://stackoverflow.com/users/6368697/patrick-mevzek"}, "edited": false, "score": 0, "creation_date": 1531932071, "post_id": 51401982, "comment_id": 89785380, "body": "@PatrickMevzek Thank you. I&#39;ll give a look at it."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 4516787, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1541147449/picture?type=large", "display_name": "Giulio Paoli", "link": "https://stackoverflow.com/users/4516787/giulio-paoli"}, "edited": false, "score": 0, "creation_date": 1531921044, "post_id": 51402586, "comment_id": 89777796, "body": "Thank you for the RFC. I had actually already tried using <code>struct in_addr</code>, but didn&#39;t use <code>memcpy</code>. This solved my problem! Thank you!"}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 2, "last_activity_date": 1531919393, "last_edit_date": 1531919393, "creation_date": 1531918527, "answer_id": 51402586, "question_id": 51401982, "link": "https://stackoverflow.com/questions/51401982/dns-retrieving-host-ip-address-using-resolv-h/51402586#51402586", "title": "DNS: retrieving host IP address using resolv.h", "body": "<p>You have to parse the resource record data in <code>ns_rr</code> yourself; the format is described in rfc1035 (see <a href=\"https://tools.ietf.org/html/rfc1035\" rel=\"nofollow noreferrer\">here</a>, the A rdata format is in section 3.4.1)</p>\n\n<p>In your <code>[WHAT TO DO HERE?]</code>, you could for example parse the A rdata and print the IP like this:</p>\n\n<pre><code>struct in_addr in;\nmemcpy(&amp;in.s_addr, ns_rr_rdata(rr), sizeof(in.s_addr));\nfprintf(stderr, \"%s IN A %s\\n\", ns_rr_name(rr), inet_ntoa(in));\n</code></pre>\n\n<p>If you want to support other resource record types you will have to familiarize yourself with their specific format.</p>\n"}], "owner": {"reputation": 85, "user_id": 4516787, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/1541147449/picture?type=large", "display_name": "Giulio Paoli", "link": "https://stackoverflow.com/users/4516787/giulio-paoli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 51402586, "answer_count": 1, "score": 2, "last_activity_date": 1531919393, "creation_date": 1531916721, "last_edit_date": 1531918067, "question_id": 51401982, "link": "https://stackoverflow.com/questions/51401982/dns-retrieving-host-ip-address-using-resolv-h", "title": "DNS: retrieving host IP address using resolv.h", "body": "<p>I'm trying to understand DNS queries using the <code>resolv.h</code> library in BIND.\nI'm struggling trying to parse an IP address from RRs returned by  <code>ns_parserr()</code>.\nI can successfully parse authoritative NS using the code provided by <a href=\"https://docstore.mik.ua/orelly/networking_2ndEd/dns/ch15_02.htm\" rel=\"nofollow noreferrer\">https://docstore.mik.ua/orelly/networking_2ndEd/dns/ch15_02.htm</a> , but I can't seem to be able to obtain the <code>A</code> type records and <strong>print them</strong>.\nMainly because I don't know how IP addresses are codified inside the <code>ns_rr</code> structure. Looking at the implementation, RDATA are of <code>const u_char *</code> type.\nHow to get the IP out of this record?</p>\n\n<pre><code>int main (int argc, char * argv[])\n{\n     union {\n        HEADER hdr;              \n        u_char buf[NS_PACKETSZ]; \n    } response;                  \n    int responseLen;             \n    res_init();\n    ns_msg handle;\n    responseLen =res_query(argv[1],ns_c_in,ns_t_a,(u_char *)&amp;response,sizeof(response));\n    if (responseLen&lt;0)\n        exit(-1);\n    if (ns_initparse(response.buf, responseLen, &amp;handle)&lt;0)\n    {\n        fprintf(stderr, \"ERROR PARSING RESPONSE....\");\n        perror(\"damn\");\n        exit(-1);\n\n    }\n    ns_rr rr;\n    int rrnum;\n    ns_sect section=ns_s_an;\n    for (rrnum=0;rrnum&lt;(ns_msg_count(handle,section));rrnum++)\n    {\n        if (ns_parserr(&amp;handle,ns_s_an,rrnum,&amp;rr)&lt;0)\n        {\n            fprintf(stderr, \"ERROR PARSING RRs\");\n            exit(-1);\n        }   \n\n        if (ns_rr_type(rr)==ns_t_a)\n        {\n            [WHAT TO DO HERE?]\n        }\n    }\n    return 0;   \n}\n</code></pre>\n\n<p>I usually try to fix these things by myself, but there are not many information about the <code>resolv.h</code> library on the internet, except for the cited source.\nThank you all for you support, I appreciate that.</p>\n"}, {"tags": ["c", "gcc", "x86", "x86-64", "reverse-engineering"], "comments": [{"owner": {"reputation": 17871, "user_id": 1171191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9e7708869e2b3234fbf0e34c9506742?s=128&d=identicon&r=PG", "display_name": "BoBTFish", "link": "https://stackoverflow.com/users/1171191/bobtfish"}, "edited": false, "score": 9, "creation_date": 1531913031, "post_id": 51400775, "comment_id": 89772077, "body": "The C and C++ language specifications make no mention at all of assemler, so there are no guarantees. Different compilers can do different things in many different cases, as long as the observed behaviour matches The Standard. So you would have to explore what happens in any specific case you are interested in. (<a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> is a very interesting tool to help you do that.)"}, {"owner": {"reputation": 1262, "user_id": 3940228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1455002de0a9fc115cc877f962ea4c9f?s=128&d=identicon&r=PG&f=1", "display_name": "Olivier Sohn", "link": "https://stackoverflow.com/users/3940228/olivier-sohn"}, "edited": false, "score": 2, "creation_date": 1531913040, "post_id": 51400775, "comment_id": 89772089, "body": "For completeness, can you describe in the question how the assembly was generated (which compiler, which flags?)"}, {"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 2, "creation_date": 1531913079, "post_id": 51400775, "comment_id": 89772126, "body": "Try <a href=\"https://godbolt.org/\" rel=\"nofollow noreferrer\">godbolt.org</a> to see all the different things that can happen under the hood on different compilers"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1531913109, "post_id": 51400775, "comment_id": 89772150, "body": "As always, these answers are highly dependent on the compiler version and optimization settings. I&#39;m afraid there&#39;s no way this question can really be answered other than &quot;yep, those are both valid - compilers are funny things&quot;."}, {"owner": {"reputation": 8204, "user_id": 2858773, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/5iGps.jpg?s=128&g=1", "display_name": "Ajay Brahmakshatriya", "link": "https://stackoverflow.com/users/2858773/ajay-brahmakshatriya"}, "edited": false, "score": 0, "creation_date": 1531913316, "post_id": 51400775, "comment_id": 89772307, "body": "Just so you know, the two options you posted are not equivalent."}, {"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 4, "creation_date": 1531914431, "post_id": 51400775, "comment_id": 89773042, "body": "The second version is wrong. It correctly increases the value stored in <code>[rbp-4]</code>, but then it stores the address of <code>[rbp-4]</code> (truncated to 32 bits) into <code>[rbp-4]</code> which doesn&#39;t make sense."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 4, "creation_date": 1531914623, "post_id": 51400775, "comment_id": 89773183, "body": "Can you please share the source code which produces the 2)?"}, {"owner": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 0, "creation_date": 1531923198, "post_id": 51400775, "comment_id": 89779375, "body": "first looks like release compilation, second as debug."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1531982509, "post_id": 51400775, "comment_id": 89802986, "body": "the listed <code>.s</code> file doesn&#39;t contain what you told us in 2)."}, {"owner": {"reputation": 26077, "user_id": 8157187, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9dbf5a2e56640eeb14bbe0c32fb3679b?s=128&d=identicon&r=PG&f=1", "display_name": "geza", "link": "https://stackoverflow.com/users/8157187/geza"}, "edited": false, "score": 0, "creation_date": 1531985865, "post_id": 51400775, "comment_id": 89804907, "body": "I hope that you know that you&#39;ve completely misled us by showing a different code in 2) previously. How have you came up with the original 2)?"}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 1, "last_activity_date": 1531913179, "creation_date": 1531913179, "answer_id": 51400855, "question_id": 51400775, "link": "https://stackoverflow.com/questions/51400775/the-assembly-of-b/51400855#51400855", "title": "The assembly of \u201cb++\u201d", "body": "<p>Any good compiler will optimise <code>b++</code> to <code>++b</code> if the result of the expression is discarded. You see this particularly in increments in <code>for</code> loops.</p>\n\n<p>That's what is happening in your \"one instruction\" case.</p>\n"}, {"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 2, "last_activity_date": 1531913826, "creation_date": 1531913826, "answer_id": 51401057, "question_id": 51400775, "link": "https://stackoverflow.com/questions/51400775/the-assembly-of-b/51401057#51401057", "title": "The assembly of \u201cb++\u201d", "body": "<p>The ISO standard does not mandate at all what happens under the covers. It specifies a \"virtual machine\" that acts in a certain way given the <strong><em>C</em></strong> instructions you provide to it.</p>\n\n<p>So, if your C compiler is implemented as a C-to-Dartmouth-Basic converter, <code>b++</code> is just as likely to lead to <code>10 let b = b + 1</code> as anything else :-)</p>\n\n<p>If you're compiling to common assembler code, then you're likely to see a difference depending on whether you use the result, specifically <code>b++;</code> as opposed to <code>a = b++</code> since the result of the former can be safely thrown away.</p>\n\n<p>You're also likely to see massive differences based on optimisation level.</p>\n\n<p>Bottom line, short of specifying all the things that can affect the output (including but not limited to compiler, target platform, and optimisation levels).</p>\n"}, {"comments": [{"owner": {"reputation": 401, "user_id": 9920709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e70e5b46782257add0743c0afa48776?s=128&d=identicon&r=PG&f=1", "display_name": "Jams.Liu", "link": "https://stackoverflow.com/users/9920709/jams-liu"}, "edited": false, "score": 0, "creation_date": 1531969272, "post_id": 51402869, "comment_id": 89798795, "body": "I have add comment to my question, please take another look."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 401, "user_id": 9920709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e70e5b46782257add0743c0afa48776?s=128&d=identicon&r=PG&f=1", "display_name": "Jams.Liu", "link": "https://stackoverflow.com/users/9920709/jams-liu"}, "edited": false, "score": 0, "creation_date": 1531970174, "post_id": 51402869, "comment_id": 89798980, "body": "@Jams.Liu: there&#39;s no <code>leaq    -4(%rbp), %rax</code> in the actual asm output from gcc5.3 -O0 that you showed.  It&#39;s only using LEA to copy-and-increment a register to implement <code>ret = b++</code> (where it needs to keep the value before increment), and then only because you disabled optimization so the code is bloated and terrible.  Looking at <code>-O0</code> asm is a good way to learn the <i>wrong</i> / slow way to do things in asm.  It&#39;s not intended to run fast."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 401, "user_id": 9920709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e70e5b46782257add0743c0afa48776?s=128&d=identicon&r=PG&f=1", "display_name": "Jams.Liu", "link": "https://stackoverflow.com/users/9920709/jams-liu"}, "edited": false, "score": 0, "creation_date": 1532006252, "post_id": 51402869, "comment_id": 89818285, "body": "@Jams.Liu: your updated question finally makes sense.  I added a new section at the top of my answer that answers it."}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": false, "score": 2, "last_activity_date": 1532006208, "last_edit_date": 1532006208, "creation_date": 1531919325, "answer_id": 51402869, "question_id": 51400775, "link": "https://stackoverflow.com/questions/51400775/the-assembly-of-b/51402869#51402869", "title": "The assembly of \u201cb++\u201d", "body": "<p>The first one is the output for <code>++i</code> as part of <code>ret = ++i</code>.  It doesn't need to keep the old value around, because it's doing <code>++i</code> and then <code>res=i</code>.  Incrementing in memory and then reloading that is a really stupid and inefficient way to compile that, but you compiled with optimization disabled so gcc isn't even trying to make good asm output.</p>\n\n<p>The 2nd one is the output for <code>i++</code> as part of <code>ret = i++</code>.  It needs to keep the old value of <code>i</code> around, so it loads into a register and uses <code>lea</code> to calculate <code>i+1</code> in a different register.  It could have just stored to <code>ret</code> and then incremented the register before storing back to <code>i</code>, but I guess with optimizations disabled gcc doesn't notice that.</p>\n\n<hr>\n\n<p>Previous answer to the previous vague question without source, and with bogus code:</p>\n\n<p><strong>The asm for a tiny expression like <code>b++</code> totally depends on the surrounding code in the rest of the function</strong> (or with optimization disabled, at least the rest of the statement) and whether it's a global or local, and whether it's declared <code>volatile</code>.</p>\n\n<p>And of course compiler optimization options have a massive impact; with optimization disabled, gcc makes a separate block of asm for every C statement so you can use the GDB <code>jump</code> command to go to a different source line and have the code still produce the same behaviour you'd expect from the C abstract machine.  Obviously this highly constrains code-gen: nothing is kept in registers across statements.  This is good for source-level debugging, but sucks to read by hand because of all the noise of store/reload.</p>\n\n<p>For the choice of inc vs. add, see <a href=\"https://stackoverflow.com/questions/36510095/inc-instruction-vs-add-1-does-it-matter\">INC instruction vs ADD 1: Does it matter?</a>  <code>clang -O3 -mtune=bdver2</code> uses <code>inc</code> for memory-destination increments, but with generic tuning or any Intel P6 or Sandybridge-family CPU it uses <code>add $1, (mem)</code> for better micro-fusion.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/38552116/how-to-remove-noise-from-gcc-clang-assembly-output\">How to remove &quot;noise&quot; from GCC/clang assembly output?</a>, especially the link to Matt Godbolt's CppCon2017 talk about looking at and making sense of compiler asm output.</p>\n\n<hr>\n\n<p><strong>The 2nd version in your original question looks like mostly un-optimized compiler output for this weird source:</strong></p>\n\n<pre><code> // inside some function\n int b;\n\n                   // leaq  -4(%rbp), %rax   // rax = &amp;b\n b++;              // incl   (%rax)\n b = (int)&amp;b;      // mov    %eax, -4(%rbp)\n</code></pre>\n\n<p>(<strong>The question has since been edited to different code; looks like the original was mis-typed by hand mixing an opcode from once line with an operand from another line</strong>.  I reproduce it here so all the comments about it being weird still make sense.  For the updated code, see the first half of my answer: it depends on surrounding code and having optimization disabled.  <strong>Using <code>res = b++</code> needs the old value of <code>b</code>, not the incremented value, hence different asm.</strong>)</p>\n\n<p>If that's not what your source does, then you must have left out some intervening instructions or something.  Or else the compiler is re-using that stack slot for something else.</p>\n\n<p>I'm curious what compiler you got that from, because gcc and clang typically don't like to use results they just computed.  I'd have expected <code>incl -4(%rbp)</code>.</p>\n\n<p>Also that doesn't explain <code>mov %eax, -4(%rbp)</code>.  The compiler already used the address in <code>%rax</code> for <code>inc</code>, so why would a compiler revert to a 1-byte-longer RBP-relative addressing mode instead of <code>mov %eax, (%rax)</code>?  Referencing fewer different registers that haven't been recently written is a good thing for Intel P6-family CPUs (up to Nehalem), to reduce register-read stalls.  (Otherwise irrelevant.)</p>\n\n<p>Using RBP as a frame pointer (and doing increments in memory instead of keeping simple variables in registers) looks like un-optimized code.  But it can't be from <code>gcc -O0</code>, because it computes the address <em>before</em> the increment, and those have to be from two separate C statements.</p>\n\n<p><code>b++ = &amp;b;</code> isn't valid because <code>b++</code> isn't an lvalue.  Well actually the comma operator lets you do <code>b++, b = &amp;b;</code> in one statement, but <code>gcc -O0</code> still evaluates it in order, rather than computing the address early.</p>\n\n<p>Of course with optimization enabled, <code>b</code> would have to be <code>volatile</code> to explain incrementing in memory right before overwriting it.</p>\n\n<p>clang is similar, but actually does compute that address early.  For <code>b++;</code>  <code>b = &amp;b;</code>, notice that <code>clang6.0 -O0</code> does an LEA and keeps RAX around across the increment.  I guess clang's code-gen doesn't support consistent debugging with GDB's <code>jump</code> the way gcc does.</p>\n\n<pre><code>    leaq    -4(%rbp), %rax\n    movl    -4(%rbp), %ecx\n    addl    $1, %ecx\n    movl    %ecx, -4(%rbp)\n    movl    %eax, %ecx          # copy the LEA result\n    movl    %ecx, -4(%rbp)\n</code></pre>\n\n<p>I wasn't able to get gcc or clang to emit the sequence of instructions you show in the question with unoptimized or optimized + <code>volatile</code>, <a href=\"https://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:&#39;%23include+%3Cstdint.h%3E%0A%0Avoid+foo()+%7B%0A++++int+b%3B%0A%0A++++%2B%2Bb%3B%0A++++b+%3D+(int)%26b%3B%0A%0A%7D%0A%0Avoid+one_statement()+%7B%0A++++volatile+int+b%3B%0A%0A++++%2B%2Bb,++b+%3D+(int)%26b%3B%0A%0A%7D%0A&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:36.94503171247357,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((g:!((g:!((h:compiler,i:(compiler:g81,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+gcc+8.1+(Editor+%231,+Compiler+%231)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:50.26187803965582,l:&#39;4&#39;,m:45.841716968477535,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang600,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O3++-march%3Dbdver2&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+6.0.0+(Editor+%231,+Compiler+%232)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:49.73812196034419,l:&#39;4&#39;,m:100,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,m:53.420523138833,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:clang600,filters:(b:&#39;0&#39;,binary:&#39;1&#39;,commentOnly:&#39;0&#39;,demangle:&#39;0&#39;,directives:&#39;0&#39;,execute:&#39;1&#39;,intel:&#39;1&#39;,trim:&#39;1&#39;),lang:c%2B%2B,libs:!(),options:&#39;-xc+-O0&#39;,source:1),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;x86-64+clang+6.0.0+(Editor+%231,+Compiler+%234)+C%2B%2B&#39;,t:&#39;0&#39;)),header:(),k:100,l:&#39;4&#39;,m:46.579476861167,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),k:63.05496828752643,l:&#39;3&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\"><strong>on the Godbolt compiler explorer</strong></a>.  I didn't try ICC or MSVC, though.  (Although unless that's disassembly, it can't be MSVC because it doesn't have an option to emit AT&amp;T syntax.)</p>\n"}, {"tags": [], "owner": {"reputation": 19889, "user_id": 906839, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5bce6d276ec5c9b7b97804d0add55084?s=128&d=identicon&r=PG", "display_name": "Brett Hale", "link": "https://stackoverflow.com/users/906839/brett-hale"}, "is_accepted": false, "score": 1, "last_activity_date": 1531979781, "creation_date": 1531979781, "answer_id": 51415301, "question_id": 51400775, "link": "https://stackoverflow.com/questions/51400775/the-assembly-of-b/51415301#51415301", "title": "The assembly of \u201cb++\u201d", "body": "<p>It's not typically instructive to look at un-optimized compiler output, since values (variables) will usually be updated using a load-modify-store paradigm. This might be useful initially when getting to grips with assembly, but it's not the output to expect from an <em>optimizing</em> compiler that maintains values, pointers, etc., in registers for frequent use. (see: <a href=\"https://en.wikipedia.org/wiki/Locality_of_reference\" rel=\"nofollow noreferrer\">locality of reference</a>)</p>\n\n<pre><code>/* un-optimized logic: */\n\nint i = 2;\nret = i++; /* assign ret &lt;- i, and post-increment i (ret = i; i++ (i = 3)) */\nret = ++i; /* pre-increment i, and assign ret &lt;- i  (++i (i = 4); ret = i) */\n</code></pre>\n\n<p>i.e., any modern, optimising compiler can easily determine that the final value of <code>ret</code> is <code>(4)</code>.</p>\n\n<p>Removing all the extraneous directives, etc., gcc-7.3.0 on OS X gives me:</p>\n\n<pre><code>_main:  /* Darwin x86-64 ABI adds leading underscores to symbols... */\n        movl    $4, %eax\n        ret\n</code></pre>\n\n<p>Apple's native clang, and the MacPorts clang-6.0 set up basic stack frame, but still optimise the <code>ret</code> arithmetic away:</p>\n\n<pre><code>_main:\n        pushq   %rbp\n        movq    %rsp, %rbp\n        movl    $4, %eax\n        popq    %rbp\n        retq\n</code></pre>\n\n<p>Note that the Mach-O (OS X) ABI is very similar to the ELF ABI for user-space code. Just try compiling with at least <code>-O2</code> to get a feel for 'real' (production) code.</p>\n"}], "owner": {"reputation": 401, "user_id": 9920709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e70e5b46782257add0743c0afa48776?s=128&d=identicon&r=PG&f=1", "display_name": "Jams.Liu", "link": "https://stackoverflow.com/users/9920709/jams-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1532006354, "creation_date": 1531912925, "last_edit_date": 1532006354, "question_id": 51400775, "link": "https://stackoverflow.com/questions/51400775/the-assembly-of-b", "title": "The assembly of \u201cb++\u201d", "body": "<p>In C language,what's the assemble of \"b++\".\nI got two situations:</p>\n\n<p>1) one instruction</p>\n\n<pre><code>     addl    $0x1,-4(%rbp)\n</code></pre>\n\n<p>2) three instructions</p>\n\n<pre><code>        movl    -4(%rbp), %eax\n        leal    1(%rax), %edx\n        movl    %edx, -4(%rbp)\n</code></pre>\n\n<p>Are these two situations caused by the compiler?</p>\n\n<p>my code:</p>\n\n<pre><code>int main()\n{\n    int ret = 0;\n    int i = 2;\n\n    ret = i++;\n    ret = ++i;\n    return ret;\n}\n</code></pre>\n\n<p>the .s file(++i use addl instrction, i++ use other)\uff1a</p>\n\n<pre><code>        .file   \"main.c\"\n        .text\n        .globl  main\n        .type   main, @function\nmain:\n.LFB0:\n        .cfi_startproc\n        pushq   %rbp\n        .cfi_def_cfa_offset 16\n        .cfi_offset 6, -16\n        movq    %rsp, %rbp\n        .cfi_def_cfa_register 6\n        movl    $0, -8(%rbp)   //ret\n        movl    $2, -4(%rbp)   //i\n        movl    -4(%rbp), %eax\n        leal    1(%rax), %edx\n        movl    %edx, -4(%rbp)\n        movl    %eax, -8(%rbp)\n        addl    $1, -4(%rbp)\n        movl    -4(%rbp), %eax\n        movl    %eax, -8(%rbp)\n        movl    -8(%rbp), %eax\n        popq    %rbp\n        .cfi_def_cfa 7, 8\n        ret\n        .cfi_endproc\n.LFE0:\n        .size   main, .-main\n        .ident  \"GCC: (Ubuntu 5.3.1-14ubuntu2) 5.3.1 20160413\"\n        .section        .note.GNU-stack,\"\",@progbits\n</code></pre>\n"}, {"tags": ["c++", "c", "bash"], "comments": [{"owner": {"reputation": 695058, "user_id": 20862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2343ae368d3241278581ce6c87f62a25?s=128&d=identicon&r=PG", "display_name": "Ignacio Vazquez-Abrams", "link": "https://stackoverflow.com/users/20862/ignacio-vazquez-abrams"}, "edited": false, "score": 0, "creation_date": 1531912577, "post_id": 51400575, "comment_id": 89771796, "body": "Why wouldn&#39;t you just install the missing library?"}, {"owner": {"reputation": 15373, "user_id": 822669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f66e2987d5d24e6d8a1f686154a51c21?s=128&d=identicon&r=PG", "display_name": "Sander De Dycker", "link": "https://stackoverflow.com/users/822669/sander-de-dycker"}, "edited": false, "score": 0, "creation_date": 1531913899, "post_id": 51400575, "comment_id": 89772674, "body": "as @TheTailgunner asked, can you add the exact command(s) you used to build the shared library ?"}, {"owner": {"reputation": 1178, "user_id": 1563037, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/vhb7A.png?s=128&g=1", "display_name": "gabry", "link": "https://stackoverflow.com/users/1563037/gabry"}, "edited": false, "score": 0, "creation_date": 1531917309, "post_id": 51400575, "comment_id": 89775030, "body": "You can try to statically link libstdc++ to your binary, with the gcc option -static-libstdc++"}, {"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 1, "creation_date": 1531917429, "post_id": 51400575, "comment_id": 89775124, "body": "Did you link it using g++? (You should)"}, {"owner": {"reputation": 1, "user_id": 10098929, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XH0xLEVo27s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7piZwm4xhQg5pPAyFR4RVnrP42LeQ/mo/photo.jpg?sz=128", "display_name": "Lothar Langer", "link": "https://stackoverflow.com/users/10098929/lothar-langer"}, "edited": false, "score": 0, "creation_date": 1531926211, "post_id": 51400575, "comment_id": 89781538, "body": "Thx to all of you! Looking more closely at the linker command i realized that i linked with gcc and compiled with g++. After changing that the &#39;__gxx_personality_v0&#39; problem disappeared. New problems came up concerning differences in name mangling by g++ as opposed to c but i will be able to handle those by using &#39;extern &quot;C&quot;&#39;."}], "owner": {"reputation": 1, "user_id": 10098929, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XH0xLEVo27s/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7piZwm4xhQg5pPAyFR4RVnrP42LeQ/mo/photo.jpg?sz=128", "display_name": "Lothar Langer", "link": "https://stackoverflow.com/users/10098929/lothar-langer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531912847, "creation_date": 1531912425, "last_edit_date": 1531912588, "question_id": 51400575, "link": "https://stackoverflow.com/questions/51400575/bash-dynamically-loadable-builtin-written-in-c-not-enablable", "title": "Bash dynamically loadable builtin written in c++ not enablable?", "body": "<p>I am writing a loadable builtin called <code>items</code> for <strong>bash</strong> using C++ instead of C and wrapped the relevant (interfacing) portions in an <code>extern \"C\"</code> directive. So everything builds fine and I get my shared library <code>items</code> ... only trying to enable it results in:</p>\n\n<pre><code>$ enable -f ./items items\nbash: enable: cannot open shared object ./items: ./items: undefined symbol: __gxx_personality_v0\n</code></pre>\n\n<p>Googling about <code>__gxx_personality_v0</code> gave me the hint that the involvement of <code>libstdc++</code> is missing - of course.</p>\n\n<p>My question is: Is there an easy and reasonable way to make the loadable enable or do I have to go back to plain C anyways?</p>\n"}, {"tags": ["java", "android", "c++", "c"], "comments": [{"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1531914339, "post_id": 51400454, "comment_id": 89772977, "body": "big info about lib"}, {"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "reply_to_user": {"reputation": 20970, "user_id": 2252830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7f66d50bf99dc20b5aac2f165c31676?s=128&d=identicon&r=PG", "display_name": "pskink", "link": "https://stackoverflow.com/users/2252830/pskink"}, "edited": false, "score": 0, "creation_date": 1531914809, "post_id": 51400454, "comment_id": 89773336, "body": "030d470 d _ZZNK2cv20CvtColorLoop_InvokerINS_10RGBA2mRGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE25__cv_trace_&zwnj;&#8203;location_fn279 003306b4 b _ZZNK2cv20CvtColorLoop_InvokerINS_10RGBA2mRGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE31__cv_trace_&zwnj;&#8203;location_extra_fn279 0030d4a4 d _ZZNK2cv20CvtColorLoop_InvokerINS_10mRGBA2RGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE25__cv_trace_&zwnj;&#8203;location_fn279 003306b8 b _ZZNK2cv20CvtColorLoop_InvokerINS_10mRGBA2RGBAIhEEEclERKNS_5&zwnj;&#8203;RangeEE31__cv_trace_&zwnj;&#8203;location_extra_fn279 0030cb8c d _ZZNK2cv20CvtColorLoop_InvokerINS_11Gray2RGB5x5EEclERKNS_5Ra&zwnj;&#8203;ngeEE25__cv_trace_lo&zwnj;&#8203;cation_fn279 0032f9ec b _ZZNK2cv20CvtColorLoop_I........"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531913570, "post_id": 51400846, "comment_id": 89772457, "body": "Thanks for the answer. I did all this, but the problem in this, I don&#39;t know what type return myFunction and what kind of argument take it."}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 1, "creation_date": 1531914459, "post_id": 51400846, "comment_id": 89773064, "body": "Unfortunately, If you don&#39;t have the header then it is very difficult to do"}, {"owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915097, "post_id": 51400846, "comment_id": 89773531, "body": "Even if I had this header file, how I can connect my java function or JNI function to this function which exists in .so  file? I think in this file we have C or C++ function, and want call this function."}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915369, "post_id": 51400846, "comment_id": 89773739, "body": "If you have the .h, so you have to follow the step by step in my answer or this answer to load it into the native side : <a href=\"https://stackoverflow.com/questions/45314478/how-to-load-native-library-into-native-android-code-androidstudio/50507825#50507825\" title=\"how to load native library into native android code androidstudio\">stackoverflow.com/questions/45314478/&hellip;</a>"}, {"owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "reply_to_user": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "edited": false, "score": 0, "creation_date": 1531915728, "post_id": 51400846, "comment_id": 89774006, "body": "Another thing, you don&#39;t connect your java function to the native function, but you declare (same name, same params) your C/C++ function in the java side as a native function and you call it through JNI"}], "tags": [], "owner": {"reputation": 1942, "user_id": 5458344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54c732ce4032f4b690f5b4e33e5031ec?s=128&d=identicon&r=PG&f=1", "display_name": "E.Abdel", "link": "https://stackoverflow.com/users/5458344/e-abdel"}, "is_accepted": true, "score": 1, "last_activity_date": 1531913147, "creation_date": 1531913147, "answer_id": 51400846, "question_id": 51400454, "link": "https://stackoverflow.com/questions/51400454/use-so-shared-object-file-in-android-studio/51400846#51400846", "title": "Use .so (Shared object) file in Android studio", "body": "<p>First, you need absolutly the header (.h) containing the function declaration.</p>\n\n<p>Secondly, you have to create a folder that contains your .so file, you can name it for example <code>jniLibs</code> and put it in <code>src/main/jniLibs</code>, then add the <code>sourceSets</code> to you gradle file, into the android block : </p>\n\n<pre><code>sourceSets {\n        main {\n            jniLibs.srcDirs = ['src/main/jniLibs']\n        }\n    }\n</code></pre>\n\n<p><strong>NOTE :</strong>  the jniLibs folder normally contains subfolders depending on the lib's target ABI (arm64-v8a, armeabi-v7a, x86, x86_64), so you have to know it.</p>\n\n<p>And finally you have to load the native library in the java side by adding : </p>\n\n<pre><code>   /*  Load jni .so on initialization */\n    static {\n        System.loadLibrary(\"my-native-lib-name\");\n    }\n</code></pre>\n\n<p>And declare your function to use it like below : </p>\n\n<pre><code>public static native void myFunction(String arg, int another_arg);\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7812781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4869ec9920e8c7f810d8501bbd5cf45d?s=128&d=identicon&r=PG&f=1", "display_name": "H. Qyutukyan", "link": "https://stackoverflow.com/users/7812781/h-qyutukyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 1, "accepted_answer_id": 51400846, "answer_count": 1, "score": -3, "last_activity_date": 1531913147, "creation_date": 1531912080, "question_id": 51400454, "link": "https://stackoverflow.com/questions/51400454/use-so-shared-object-file-in-android-studio", "title": "Use .so (Shared object) file in Android studio", "body": "<p>I have *.so file, which is not generated by me in my project. I know that there is a function in this lib named 'x', and I want to use this function, but don't know how.. </p>\n\n<p>P.S. </p>\n\n<p>I don't have source files that used for generating *.so file.  </p>\n"}, {"tags": ["c", "arm", "keil", "armcc"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531910868, "post_id": 51399856, "comment_id": 89770795, "body": "Why not typedef bool as int?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531911252, "post_id": 51399856, "comment_id": 89771024, "body": "@Ctx Why not use the standard type and the macros? You are not supposed to define names which are part of the standard library at all. Defining your own <code>bool</code> can break standard compliant code."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1531911353, "post_id": 51399856, "comment_id": 89771076, "body": "@Ctx not a bad idea, this &quot;types.h&quot; file also has <code>typedef unsigned char boolean;</code> along with <code>TRUE</code> and <code>FALSE</code>. Switching all my <code>bool</code>s to <code>boolean</code>s seems the best idea."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531911431, "post_id": 51399856, "comment_id": 89771126, "body": "And don&#39;t use custom headers with the same name as standard headers either. Your compiler <b>has to</b> provide a minimal set at least. If there is no <code>types.h</code>, there might be a reason why. If there is, it should work with the compiler and comply to the standard."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531911447, "post_id": 51399856, "comment_id": 89771133, "body": "@Olaf I didn&#39;t, it&#39;s a third-party file that came with an SDK kit. The <code>bool</code> type defined in this file is also used in a lot of the SDKs and if I used the type defined in <code>stdbool.h</code>, it would shadow it. Otherwise, I would use stdbool.h."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "edited": false, "score": 1, "creation_date": 1531911461, "post_id": 51399856, "comment_id": 89771140, "body": "Can I ask why this question was downvoted?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531911569, "post_id": 51399856, "comment_id": 89771223, "body": "So ask the vendor of that &quot;thing&quot; to make it C compliant! No reasonable company should accept non-standard C code. That typedef can easily break other parts of your (or maybe some other external library which <b>is</b> compliant)."}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "edited": false, "score": 0, "creation_date": 1531911915, "post_id": 51399856, "comment_id": 89771425, "body": "As reference, this is the third-party <code>types.h</code> file that gets included in the project. <a href=\"https://hastebin.com/rocosaraji.c\" rel=\"nofollow noreferrer\">hastebin.com/rocosaraji.c</a>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531912156, "post_id": 51399856, "comment_id": 89771560, "body": "1) we won&#39;t click external links. 2) Did you make sure you don&#39;t violate the copyright of the author of that file?"}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "edited": false, "score": 1, "creation_date": 1531912259, "post_id": 51399856, "comment_id": 89771615, "body": "1) If you don&#39;t want to, that&#39;s fine - others might want to see the file 2) The copyright is at the top of that file and says redistribution is fine so long as the copyright is included and not used for endorsement"}, {"owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531912620, "post_id": 51399856, "comment_id": 89771817, "body": "@Olaf Actually, I think I know why they&#39;ve done it that way - <code>stdbool.h</code> isn&#39;t available in C89, and so they may have defined it themselves so that the <code>bool</code> type is available regardless of what C standard is being used. I defined a similar enum when I was working with another micro with CodeWarrior 5.2 and was forced to use C89."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531915824, "post_id": 51399856, "comment_id": 89774081, "body": "C89 is not standard C. And this is compiled as C99 (also not standard, but maybe the best you get with proprietary commercial compilers)."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531911818, "post_id": 51400252, "comment_id": 89771374, "body": "According to the standard <code>true</code> is a macro which expands to the <b>integer constant</b> <code>1</code> which has type <code>int</code>. <code>false</code> to <code>0</code>. So, <code>true</code> <b>is</b> in fact <code>1</code>, not &quot;not <code>0</code>&quot;. You confuse the macros and <code>_Bool</code> standard type with how the result of a condition are interpreted by  compound statements, resp. the conditional operator. And the code you show makes clear what<code>s wrong with the </code>typedef. <code>(bool)50</code> evaluates to <code>1</code> according to the standard. It can **only represent the value <code>0</code> and <code>1</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531912065, "post_id": 51400252, "comment_id": 89771498, "body": "Finally: The underlying type for an <code>enum</code> is not not guaranteed to be <code>int</code>. The <i>enum-constants</i> have <code>int</code> type, but an object of a <code>enum</code> type need not. The implementation can choose a smaller type. That&#39;s one major problem with <code>enum</code>s in C. As a result such an object might not bne able to hold all values <code>int</code> can."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531912305, "post_id": 51400252, "comment_id": 89771640, "body": "@Olaf - yes but the smallest int type is char which can accommodate more than 0 and one only. The underlying type is one of the integer types. Standard says that any nonzero value is considered as true, only the the results of the logical operations are guaranteed to be <code>0</code> or <code>1</code>."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531912506, "post_id": 51400252, "comment_id": 89771754, "body": "@Olaf IMO defining type bool makes sense only in the languages which do not allow implicit type conversions (like C++ for example). Otherwise comparition to the <code>true</code> may give the incorrect results - like in my answer."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531912999, "post_id": 51400252, "comment_id": 89772052, "body": "@Olaf - and lastly I do answer the particular question where it is defined as it is defined (it is not the <code>bool</code> type from the stdint.h)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531915438, "post_id": 51400252, "comment_id": 89773801, "body": "The code is complies as C99, which makes my objections valid. And <code>char</code> is an <b>integer</b> txype, not an <code>int</code> type. In programming and expecially for beginner we should be precise. You wrote &quot;<code>bool</code> can have any value as <code>int</code> is the type behind it.&quot; which I corrected as it&#39;s plain wrong stated this general. And defining <code>bool</code> does not make sense at all, as C99+ <b>does have</b> a boolean type and <code>bool</code> as specified by the standard has different implicatgions than an <code>enum</code> or any other standard type (that&#39;s why it was added). Try <code>_Bool b = 50;</code>!"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531916787, "post_id": 51400252, "comment_id": 89774689, "body": "@Olaf it is nitpicking. The build in bool types generate completely different code than this enum one. And those are not considered in this question. Focus on the question not on the general off topic deliberations. The question is about <b>enum</b> type typedefed by the OP. Defining a bool type this way in C is a very bad idea"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531919473, "post_id": 51400252, "comment_id": 89776522, "body": "Apparently OP <b>did</b> focus on the question and my comments. See his answer, he <b>did</b> use the standard way. I&#39;d possibly kicked the vendor, but we don&#39;t know the details. After all, his way only might break the library (less likely, unless it&#39;s completely messed up), not the application or compliant code. Funny: Your last sentence is almost exactly what I wrote initially \u2026"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531920611, "post_id": 51400252, "comment_id": 89777437, "body": "@Olaf my answer is about it. Why he should not doing it this or similar way."}], "tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -2, "last_activity_date": 1531913762, "last_edit_date": 1531913762, "creation_date": 1531911404, "answer_id": 51400252, "question_id": 51399856, "link": "https://stackoverflow.com/questions/51399856/prevent-enumerated-type-mixed-with-another-type-warnings-for-boolean-values-in/51400252#51400252", "title": "Prevent &quot;enumerated type mixed with another type&quot; warnings for boolean values in Keil uVision", "body": "<p>First of all, these kind of definitions are not logically correct in C.</p>\n\n<p>C defines <code>false</code> as zero and <code>true</code> as not zero, which of course includes 1 but not only that. It can be dangerous in many situations:</p>\n\n<p>The expression <code>if(GetValue() == true)</code> only evaluates as true if the return value of the function is <code>1</code>. It is extremely dangerous, and may be the source of many difficult-to-discover errors.</p>\n\n<p><code>bool</code> can have any value as <code>int</code> is the type behind it.</p>\n\n<p>Casting does not change anything:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef enum _bool \n{ \n  false = 0, \n  true = 1 \n} bool;\n\nint main(void) {\n\n    bool x;\n\n    x = 50;\n    printf(\"%d\\n\", x);\n\n    x = (bool)50;\n    printf(\"%d\\n\", x);\n}\n</code></pre>\n\n<p><a href=\"https://ideone.com/nNHPLg\" rel=\"nofollow noreferrer\">https://ideone.com/nNHPLg</a></p>\n\n<p>You will explicitly convert the int values to zeroes or ones. For example:</p>\n\n<p><code>bool x = !!something;</code></p>\n\n<p><code>bool x = something ? true : false;</code></p>\n"}, {"tags": [], "owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "is_accepted": false, "score": 1, "last_activity_date": 1531914928, "last_edit_date": 1531914928, "creation_date": 1531914319, "answer_id": 51401211, "question_id": 51399856, "link": "https://stackoverflow.com/questions/51399856/prevent-enumerated-type-mixed-with-another-type-warnings-for-boolean-values-in/51401211#51401211", "title": "Prevent &quot;enumerated type mixed with another type&quot; warnings for boolean values in Keil uVision", "body": "<p>It felt dirty, but I resolved this by modifying the <code>types.h</code> file that came with the SDK kit by making it include <code>stdbool.h</code> instead of defining its own <code>bool</code> type. Recompiling my project produced no warnings/errors in either the third-party code that used <code>bool</code> or my own code.</p>\n\n<p>For good measure I tried modifying it in a way that should still let it work if it were compiled in a C89 project:</p>\n\n<pre><code>#if __STDC_VERSION__ &gt;= 199901L\n#include &lt;stdbool.h&gt;\n#endif\n\n// ...\n\n#if __STDC_VERSION__ &lt; 199901L\ntypedef enum _bool \n{ \n  false = 0, \n  true = 1 \n} bool;\n#endif\n</code></pre>\n"}], "owner": {"reputation": 7691, "user_id": 1636276, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b9b89d2ebb4ad79a3f0d622c96432b35?s=128&d=identicon&r=PG", "display_name": "Tagc", "link": "https://stackoverflow.com/users/1636276/tagc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1531914928, "creation_date": 1531910210, "question_id": 51399856, "link": "https://stackoverflow.com/questions/51399856/prevent-enumerated-type-mixed-with-another-type-warnings-for-boolean-values-in", "title": "Prevent &quot;enumerated type mixed with another type&quot; warnings for boolean values in Keil uVision", "body": "<p>I'm migrating an application I was developing in CodeWarrior v5.2 to Keil uVision v5.25, which uses the ARM C compiler v5.06.</p>\n\n<p>Throughout my code I've used <code>bool</code> to represent boolean values, which is defined in a <code>types.h</code> file in my project as:</p>\n\n<pre><code>typedef enum _bool \n{ \n  false = 0, \n  true = 1 \n} bool;\n</code></pre>\n\n<p>When I try to compile my code, the compiler generates warnings about lines where I implicitly assign the outcome of comparisons to variables with this type:</p>\n\n<pre><code>src\\c\\drivers\\motor.c(168): warning:  #188-D: enumerated type mixed with another type\n    const bool motorStopped = timeSinceLastEvent &gt; maxPulseWidth;\nsrc\\c\\drivers\\motor.c(169): warning:  #188-D: enumerated type mixed with another type\n    const bool motorStalled = motorStopped &amp;&amp; isMotorDriven();\n</code></pre>\n\n<p>I understand why these warnings are being generated. I'm aware that I can suppress these warnings by explicitly casting to <code>bool</code>, like:</p>\n\n<pre><code>const bool motorStopped = (bool)(timeSinceLastEvent &gt; maxPulseWidth);\n</code></pre>\n\n<p>However, doing this for every boolean condition is pretty ugly. I was wondering if there's a way I can configure Keil uVision / the ARM compiler (or modify my code) to not generate warnings about <code>bool</code>, without outright disabling warnings about mixing enumerated types with other types.</p>\n\n<p>These are the options I have available to configure the compiler:</p>\n\n<p><img src=\"https://i.stack.imgur.com/W1Dre.png\" alt=\"\"></p>\n"}, {"tags": ["c", "gcc", "fftw"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531909505, "post_id": 51399388, "comment_id": 89769965, "body": "Did you check if the out-vector is entirely written to, for example by zeroing it after allocation?"}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531909657, "post_id": 51399388, "comment_id": 89770057, "body": "i checked it, its not zero, as malloc dont initialize the memory..is that the problem? and why will that cause problem?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531909782, "post_id": 51399388, "comment_id": 89770134, "body": "No, it is not really a problem if everything works as intended. But you could check, if fftw really fills the out vector completely by setting it to some sentinel value before calling the fftw functions. The last three values look quite random."}, {"owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531910112, "post_id": 51399388, "comment_id": 89770335, "body": "i checked it too, it seems that it simply left the symmetric part unfilled.."}], "answers": [{"tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 2, "last_activity_date": 1531910655, "creation_date": 1531910655, "answer_id": 51399995, "question_id": 51399388, "link": "https://stackoverflow.com/questions/51399388/fftw-not-working-correctly-with-real-data/51399995#51399995", "title": "fftw not working correctly with real data", "body": "<p>From the <a href=\"http://www.fftw.org/fftw3_doc/One_002dDimensional-DFTs-of-Real-Data.html#One_002dDimensional-DFTs-of-Real-Data\" rel=\"nofollow noreferrer\">manual</a>:</p>\n\n<pre><code>fftw_plan fftw_plan_dft_r2c_1d(int n, double *in, fftw_complex *out, unsigned flags);\n</code></pre>\n\n<blockquote>\n  <p>Here, n is the \u201clogical\u201d size of the DFT, not necessarily the physical size of the array. In particular, the real (double) array has n elements, while the complex (fftw_complex) array has n/2+1 elements (where the division is rounded down)</p>\n</blockquote>\n\n<p>So, the symmetric part is not written (it is redundant anyway).</p>\n\n<p>In your case, this matches exactly the 5 elements you read correctly, the other 3 are left uninitialized.</p>\n\n<p>valgrind can help you detect the usage of uninitialized values in the future.</p>\n"}], "owner": {"reputation": 121, "user_id": 4810632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e40edbb3607d83790716b9641ecaf535?s=128&d=identicon&r=PG", "display_name": "user152531", "link": "https://stackoverflow.com/users/4810632/user152531"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 51399995, "answer_count": 1, "score": -1, "last_activity_date": 1531910655, "creation_date": 1531908873, "question_id": 51399388, "link": "https://stackoverflow.com/questions/51399388/fftw-not-working-correctly-with-real-data", "title": "fftw not working correctly with real data", "body": "<p>I'm trying to use fftw3.3.5 for DFT in C. but i currently have trouble while applying DFT to real data, it results in something strange, like extremly large numbers, as well as something that isn't symmetric.</p>\n\n<p>here is the test code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include &lt;fftw3.h&gt;\n\n//#define DEBUG\n\nint main()\n{\n    fftw_complex *out;\n    fftw_plan p;\n    double *in;\n    int N = 8;\n    int i;\n\n    in = (double*) fftw_malloc(sizeof(double) * N);\n    out = (fftw_complex*) fftw_malloc(sizeof(fftw_complex) * N);\n\n    for (i = 0; i &lt; N; i++)\n    {\n        in[i] = 1.0;\n    }\n\n    p = fftw_plan_dft_r2c_1d(N, in, out, FFTW_ESTIMATE);\n    fftw_execute(p);\n\n    for (i = 0; i &lt; N; i++)\n    {\n        printf(\"%6.2f+j%6.2f\\n\", out[i][0],out[i][1]);\n    }\n    printf(\"\\n\");\n    fftw_destroy_plan(p);\n    fftw_free(in);\n    fftw_free(out);\n    return 0;\n}\n</code></pre>\n\n<p>with the compile argument:</p>\n\n<pre><code>gcc -o test.exe test.c -L../lib/fftw-3.3.5-dll32 -lfftw3-3 -lm\n</code></pre>\n\n<p>it supposed to give the output as:</p>\n\n<pre><code> 8+j0\n 0+j0\n 0+j0\n 0+j0\n 0+j0\n 0+j0\n 0+j0\n 0+j0\n</code></pre>\n\n<p>but what i get is:</p>\n\n<pre><code>  8.00+j  0.00\n  0.00+j  0.00\n  0.00+j  0.00\n  0.00+j  0.00\n  0.00+j  0.00\n403786757349850460000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00+j944948400857723240000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00\n191040283242158910000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00+j89520024970316631000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00\n11715519029813030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00+j49940585465016918000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000.00\n</code></pre>\n\n<p>also if i try data with 128 samples like:</p>\n\n<pre><code>0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   -3,05175781250000e-05   0   0   -3,05175781250000e-05\n</code></pre>\n\n<p>i get (use sqrt(real^2+imag^2)/len*2) as amplitude:</p>\n\n<pre><code>3.81481e-006 3.71065e-006 3.40881e-006 2.93997e-006 2.35125e-006 1.70090e-006 1.05247e-006 4.74860e-007 1.86058e-007 4.41965e-007 6.28417e-007 6.74806e-007 5.98803e-007 4.41757e-007 2.77456e-007 2.51045e-007 3.64966e-007 4.63350e-007 4.86514e-007 4.21271e-007 2.76131e-007 7.43513e-008 1.51306e-007 3.64232e-007 5.29849e-007 6.21102e-007 6.23034e-007 5.36511e-007 3.84268e-007 2.43994e-007 3.02517e-007 4.96143e-007 6.74370e-007 7.82784e-007 7.98526e-007 7.19781e-007 5.70181e-007 4.21114e-007 4.20667e-007 5.92154e-007 7.92975e-007 9.36630e-007 9.83523e-007 9.20893e-007 7.62605e-007 5.64734e-007 4.74754e-007 6.25706e-007 8.81107e-007 1.10263e-006 1.22349e-006 1.21059e-006 1.05585e-006 7.81027e-007 4.81996e-007 5.15201e-007 9.35378e-007 1.42703e-006 1.88275e-006 2.25805e-006 2.53386e-006 2.71137e-006 2.80810e-006 2.85021e-006 2.86111e-006 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000 0.00000e+000\n</code></pre>\n\n<p>as my input is real, such a non-symmetry output should never happen...</p>\n\n<p>Can anyone point out what i do wrong and how to fix it?</p>\n"}, {"tags": ["c", "generator", "code-generation"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1531908982, "post_id": 51399313, "comment_id": 89769604, "body": "&quot;enter link description here&quot;? (But I see <code>envirnoment </code> is indeed <i>sic</i> in <a href=\"https://github.com/intel/yarpgen/blob/master/run_gen.py\" rel=\"nofollow noreferrer\">the source</a>, so that is not a typo of yours.) Also, did you set the <code>YARPGEN_HOME</code> envirnoment variable, as was suggested?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9692249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca7d3102459e9a95a735fa1e03259a0?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh", "link": "https://stackoverflow.com/users/9692249/rakesh"}, "edited": false, "score": 0, "creation_date": 1532022386, "post_id": 51399921, "comment_id": 89829000, "body": "Thanks, I have one more query what should I include in the batch script. I have  saved my batch script it contains. <code>set HOME_YARPGEN=path&#47;to&#47;dir&#47;of&#47;run_gen.py ``run_gen.py</code> when I run the batch script, it opened in my pycharm ide and gave me the same <code>File C:\\Users\\..\\Python\\Python36-32\\yarpgen-master\\yarpgen wasn&#39;t found</code> kindly help @PaulR"}, {"owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "reply_to_user": {"reputation": 1, "user_id": 9692249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca7d3102459e9a95a735fa1e03259a0?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh", "link": "https://stackoverflow.com/users/9692249/rakesh"}, "edited": false, "score": 1, "creation_date": 1532082974, "post_id": 51399921, "comment_id": 89851248, "body": "@gavafa: did you run make to build yarpgen? Where is the executable, probably YARPGEN_HOME must point there, if it is not the same directory run_gen.py is in."}], "tags": [], "owner": {"reputation": 3193, "user_id": 6608866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/395a0bd6f09706e701866702448c5924?s=128&d=identicon&r=PG&f=1", "display_name": "PaulR", "link": "https://stackoverflow.com/users/6608866/paulr"}, "is_accepted": false, "score": 1, "last_activity_date": 1532084452, "last_edit_date": 1532084452, "creation_date": 1531910396, "answer_id": 51399921, "question_id": 51399313, "link": "https://stackoverflow.com/questions/51399313/how-to-use-yarpgen-random-c-program-generator/51399921#51399921", "title": "How to use yarpgen random C program generator?", "body": "<p>The warning very likely points to the source of the problem, run_gen does not know where the other parts of yarpgen are installed.</p>\n\n<p>First, note down the directory you installed/copied yarpgen to.</p>\n\n<p>Then open a command shell. Type this:</p>\n\n<pre><code>cd &lt;where run_gen.py is&gt;\nset YARPGEN_HOME=&lt;the path you just noted down&gt;\nrun_gen.py\n</code></pre>\n\n<p>If this works, you can write a batch script, that contains the set <code>YARPGEN_HOME=...</code> line and then calls <code>run_gen.py</code>. If the directory where run_gen.py is located is not on your PATH environment variable, call run_gen.py with the full absolute path in the batch script:</p>\n\n<pre><code>set YARPGEN_HOME=&lt;the path to yarpgen&gt;\npython3 &lt;absolute_path_to&gt;\\run_gen.py\n</code></pre>\n\n<p>Then you can call your batch script.</p>\n\n<p>You may have to adjust the python3 command depending on the executable Python 3 installed on your machine (it may be just python on Windows).</p>\n\n<p>When I tried this after building with cygwin, I noticed that I had to rename yarpgen.exe to yarpgen to make it work.</p>\n"}], "owner": {"reputation": 1, "user_id": 9692249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aca7d3102459e9a95a735fa1e03259a0?s=128&d=identicon&r=PG&f=1", "display_name": "rakesh", "link": "https://stackoverflow.com/users/9692249/rakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1532084452, "creation_date": 1531908664, "last_edit_date": 1531915875, "question_id": 51399313, "link": "https://stackoverflow.com/questions/51399313/how-to-use-yarpgen-random-c-program-generator", "title": "How to use yarpgen random C program generator?", "body": "<p>I am new here.\nCould anyone help me, on how to use yarpgen to generate a random c program. </p>\n\n<p>I tried running the <code>run_gen.py</code> script that I saw <a href=\"https://github.com/intel/yarpgen/blob/master/README.md\" rel=\"nofollow noreferrer\">in the yarpgen readme</a>.\nBut, I got a warning and an error like this:</p>\n\n<pre><code>Warning: please set YARPGEN_HOME envirnoment variable to point to test generator path, using C:\\Users\\..\\Python\\Python36-32\\yarpgen-master for now\n</code></pre>\n\n<p>and </p>\n\n<pre><code>File C:\\Users\\..\\Python\\Python36-32\\yarpgen-master\\yarpgen wasn't found\n</code></pre>\n\n<p>Any help would be much appreciated.\nThanks in advance !</p>\n"}, {"tags": ["c", "arm", "cpu", "intel"], "comments": [{"owner": {"reputation": 1281, "user_id": 1356096, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTexs.png?s=128&g=1", "display_name": "YesThatIsMyName", "link": "https://stackoverflow.com/users/1356096/yesthatismyname"}, "edited": false, "score": 1, "creation_date": 1531906969, "post_id": 51398641, "comment_id": 89768287, "body": "Google is your friend ... there are so many examples how you can do it."}, {"owner": {"reputation": 96, "user_id": 4692986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f976cc3ed5010aa7e37903f8667156?s=128&d=identicon&r=PG&f=1", "display_name": "AVM", "link": "https://stackoverflow.com/users/4692986/avm"}, "edited": false, "score": 1, "creation_date": 1531907566, "post_id": 51398641, "comment_id": 89768701, "body": "you can&#39;t execute binary for some CPU for another, you must cross compile your code for both CPUs. since common section of your code that determines CPU type must run on both CPUs, you can do this by using system tools such as <code>lscpu</code> or <code>cat &#47;proc&#47;cpuinfo</code> linux command and base on the result run one of the two cross compiled programs."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531907991, "post_id": 51398641, "comment_id": 89768982, "body": "If you only need to differentiate between specific ARM cpus, you can simply read the cpuid register to check the exact model: <a href=\"http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0432c/Bhccjgga.html\" rel=\"nofollow noreferrer\">infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0432&zwnj;&#8203;c/&hellip;</a>"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 96, "user_id": 4692986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f976cc3ed5010aa7e37903f8667156?s=128&d=identicon&r=PG&f=1", "display_name": "AVM", "link": "https://stackoverflow.com/users/4692986/avm"}, "edited": false, "score": 0, "creation_date": 1531908242, "post_id": 51398641, "comment_id": 89769145, "body": "@AVM If you fiddle about it long enough, I bet someone could come up with some binary code which runs on both arm and intel to switch to the correct program section for the current architecture."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531909230, "post_id": 51398641, "comment_id": 89769776, "body": "The phrase to google on it <code>runtime CPU dispatching</code>.  (Or compile-time with <code>#ifdef __x86_64__</code> if you only need ARM vs. x86)."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 96, "user_id": 4692986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31f976cc3ed5010aa7e37903f8667156?s=128&d=identicon&r=PG&f=1", "display_name": "AVM", "link": "https://stackoverflow.com/users/4692986/avm"}, "edited": false, "score": 1, "creation_date": 1531909798, "post_id": 51398641, "comment_id": 89770142, "body": "@AVM, ctx: &quot;CPU model&quot; does not mean different architectures. I&#39;d rather assume it&#39;s specific additional features like most/all multimedia codecs can use SSE/MMX/etc. extensions on x86 which support them. Nevertheless, there is no simeple answer without much more information (whcih OP seems to not want to provide)."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531910950, "post_id": 51398641, "comment_id": 89770839, "body": "@Olaf the tags are both &quot;arm&quot; and &quot;intel&quot;, so I assume the opposite."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1531911108, "post_id": 51398641, "comment_id": 89770928, "body": "@Ctx: That&#39;s exactly what comments and (finally) close-votes are for. Apparentyl this is another fire&amp;forget question. I don&#39;t think we should waste even more time on it; we already put more into it than OP did."}, {"owner": {"reputation": 1, "user_id": 8370949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d9741784d9682e99ee25754635eb7ed?s=128&d=identicon&r=PG&f=1", "display_name": "AsmaAP", "link": "https://stackoverflow.com/users/8370949/asmaap"}, "edited": false, "score": 0, "creation_date": 1531917740, "post_id": 51398641, "comment_id": 89775324, "body": "Thank you for your answers. However, none of them helped me :("}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531957982, "post_id": 51398641, "comment_id": 89796561, "body": "re: your update.  It sounds like you just want compile-time detection, with <code>#ifdef</code> / <code>#else</code>, so the ARM binary includes one block of code and the x86-64 binary includes the other.  I close this as a duplicate of a question about that.  Update again if that&#39;s not what you were looking for."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1531907688, "post_id": 51398809, "comment_id": 89768790, "body": "This could be a comment, it&#39;s a low-quality answer, though. You basically redirect to another post. What if there is no OS? We don&#39;t even know which architecture. Please resonsider answering too broad questions. They are not a good fit for this site as we concentrate on <b>specific</b> questions with high-quality answers. Flag them for closure instead."}, {"owner": {"reputation": 1, "user_id": 8370949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d9741784d9682e99ee25754635eb7ed?s=128&d=identicon&r=PG&f=1", "display_name": "AsmaAP", "link": "https://stackoverflow.com/users/8370949/asmaap"}, "edited": false, "score": 0, "creation_date": 1531917840, "post_id": 51398809, "comment_id": 89775388, "body": "thank you I already read it and it didn&#39;t help. That&#39;s not what I&#39;m looking for."}], "tags": [], "owner": {"reputation": 197, "user_id": 6376756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdc33b08ae485a659f0940901f300e5e?s=128&d=identicon&r=PG&f=1", "display_name": "Teekeks", "link": "https://stackoverflow.com/users/6376756/teekeks"}, "is_accepted": false, "score": -1, "last_activity_date": 1531907179, "creation_date": 1531907179, "answer_id": 51398809, "question_id": 51398641, "link": "https://stackoverflow.com/questions/51398641/check-cpu-model-to-execute-a-specific-c-code/51398809#51398809", "title": "check CPU model to execute a specific C code", "body": "<p>There are many ways to achieve what you want. To check which model is present you first have to read which model you have. how to do that varies between Windows and Linux. i found this SO-topic helpful and it might also be a good start for your research: <a href=\"https://stackoverflow.com/questions/18592580/how-to-check-cpu-name-model-speed-on-windows-linux-c\">How to check CPU name, model, speed on Windows/Linux C?</a></p>\n"}, {"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": false, "score": 0, "last_activity_date": 1531936419, "creation_date": 1531936419, "answer_id": 51408236, "question_id": 51398641, "link": "https://stackoverflow.com/questions/51398641/check-cpu-model-to-execute-a-specific-c-code/51408236#51408236", "title": "check CPU model to execute a specific C code", "body": "<p>As clearly pointed out, first off you cant have a C program that runs to a point to determine ARM from x86 as that code has to already be ARM or x86.  These are different instruction sets.   You can use say python or JAVA or some other scripty/virtual machine language.  But then you have a COMPILE time decision to build for one target or the other, at that point you already know which target as you are actually running code on it, so if this is strictly ARM vs X86 there is no reason to check runtime.  Thats not to say that each architecture and/or system will have a way to check the architecture and flavor you are on ARMv6 vs ARMv7, for example, but not necessarily ARMv7 32 bit vs ARMv8 64 bit although you technically can run aarch32 and aarch64 instruction sets on most ARMv8s just not intermixed, have to have the os or execution level changes yourself to switch between them.</p>\n\n<p>You do understand there are different incompatible instruction sets, specifically the ones you described and C code is compiled to one or the other.  So you cannot have a program in C compiled for a target that can detect the other target.  You have already selected the target before you get to this point.  Now there are emulators, but they tend to target one architecture as well.  There are/were products from specific vendors that would emulate one instruction set and convert it runtime to the other, over time as you re-run that code it continues to convert it.  You could try that, but you still have to be running code for the right target on the right logic/emulator, and then have a now special detection that is not the norm to find the true underlaying architecture, not the faked emulator.</p>\n\n<p>I suspect you are thinking you can have one architecture specific module that detects the architecture to run architecture specific code.  This does not work with C in general, does not make sense to try, thus there probably isnt a good tool for this.  In particular since the solution for such a thing is either you build this into the binary file format and the operating system picks because it knows, or you wrap your binary with a target independent language like Python or JAVA or scripty language like perl, bash, etc.  that can independent of target determine the architecture (in that case solutions vary widely specific to operating system and language for starters) and then choose which binary to run.</p>\n"}], "owner": {"reputation": 1, "user_id": 8370949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d9741784d9682e99ee25754635eb7ed?s=128&d=identicon&r=PG&f=1", "display_name": "AsmaAP", "link": "https://stackoverflow.com/users/8370949/asmaap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 993, "favorite_count": 0, "closed_date": 1531957854, "answer_count": 2, "score": -4, "last_activity_date": 1531936419, "creation_date": 1531906717, "last_edit_date": 1531917655, "question_id": 51398641, "link": "https://stackoverflow.com/questions/51398641/check-cpu-model-to-execute-a-specific-c-code", "closed_reason": "Duplicate", "title": "check CPU model to execute a specific C code", "body": "<p>I want to create a C code that somehow contains two separated blocks. I want to use a function or a tool that extracts the CPU model, and based on that, the program decides which block of code it executes. I only have the idea and I don't know how to implement it ! \nThe first block of code will be executed on an Intel i7 and the second should be executed on ARM Cortex A53. \nPS : I am a beginner and I have nothing to do with hardware and similar stuff. Thank you for your help :)  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1531905092, "post_id": 51397996, "comment_id": 89767021, "body": "Note there are always 3 cubic roots for a complex number. Which one do you pick?"}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1531905950, "post_id": 51397996, "comment_id": 89767596, "body": "Are you sure <code>cbrt()</code> operates on complex numbers? The standard library function in <code>math.h</code> takes a <code>double</code> argument and returns a <code>double</code> value. Instead, try <code>x = cpow(z, 1.0&#47;3+0*I);</code>. That should at least give you <i>one</i> of the complex roots."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531906793, "post_id": 51397996, "comment_id": 89768175, "body": "What is <code>cmath.h</code>? It&#39;s not standard. You missed the generic math header, otoh. NEvertheless, what about the doucmentation of <code>cbrt</code> is unclear? What does &quot;doesn&#39;t work&quot; mean? Your compiler should warn at least, don&#39;t ignore warnings - fix them before asking."}, {"owner": {"reputation": 468, "user_id": 1487336, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/569545428cb39903e0d63a4e707bf4a8?s=128&d=identicon&r=PG", "display_name": "Lei Hao", "link": "https://stackoverflow.com/users/1487336/lei-hao"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531971075, "post_id": 51397996, "comment_id": 89799215, "body": "@Olaf I used Mac Terminal. No warnings appear. Actually it took me a while to figure out it&#39;s the cubic root. I know it looks clear from this example, but not so when being part of a large computation."}, {"owner": {"reputation": 468, "user_id": 1487336, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/569545428cb39903e0d63a4e707bf4a8?s=128&d=identicon&r=PG", "display_name": "Lei Hao", "link": "https://stackoverflow.com/users/1487336/lei-hao"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1531971449, "post_id": 51397996, "comment_id": 89799292, "body": "@Bathsheba Actually it doesn&#39;t matter for my case. It is a middle step in my computation code. The other two roots will be compensated in the final step. As long as it&#39;s a non-zero cubic root, it&#39;s fine."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531994077, "post_id": 51397996, "comment_id": 89810019, "body": "Nothiong of your response makes sense. In fact you don&#39;t reply to my comment. Read it again and try to understand what I wrote. It would make <b>a little</b> sense if you copy/pasted this code from somewhere without any underwstanding of it. In that case, I recommend to learn about the parts you use, most of them are easy to find. Only <code>cmath.h</code> is not clear, as pointed out by me and others, it&#39;s not standard and can change everything."}], "answers": [{"tags": [], "owner": {"reputation": 809, "user_id": 9466270, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UGJdFqyAs24/AAAAAAAAAAI/AAAAAAAAAEE/JCJU2OmxEk0/photo.jpg?sz=128", "display_name": "Hein Wessels", "link": "https://stackoverflow.com/users/9466270/hein-wessels"}, "is_accepted": false, "score": 1, "last_activity_date": 1531908151, "last_edit_date": 1531908151, "creation_date": 1531905644, "answer_id": 51398218, "question_id": 51397996, "link": "https://stackoverflow.com/questions/51397996/how-to-compute-a-cubic-root-of-a-complex-number-in-c/51398218#51398218", "title": "How to compute a cubic root of a complex number in C?", "body": "<p>I would look at this <a href=\"https://math.stackexchange.com/questions/1297186/cube-roots-of-complex-numbers\">answer</a> from the Mathematics Stack Exchange.</p>\n\n<p>Essentially you want to compute the <code>radius</code> and <code>angle</code> of the Eurler formula. Then divide both the <code>radius</code> and <code>angle</code> by three (see link). So first you need to convert your complex number to Euler format. I don't have time now to figure that out, but maybe this gave you an idea at where to look. </p>\n\n<p>Hope this helps!</p>\n\n<hr>\n\n<p><strong>Addition:</strong> @squeamish probably has a better idea with <a href=\"https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.3.0/com.ibm.zos.v2r3.bpxbd00/cpow.htm\" rel=\"nofollow noreferrer\">cpow</a>, but as he mentioned this will only return one of the roots.</p>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531994443, "post_id": 51401542, "comment_id": 89810302, "body": "IMO a complex root function would be problematic and against the standard&#39;s directions, because it had to return a compound type with the results. For this either a static variable had to be used (not thread-safe) or dynamic allocation which would make the function heavily depend on <code>malloc</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1532009738, "post_id": 51401542, "comment_id": 89820903, "body": "@olaf Interesting thoughts.  The complex square root exist <code>csqrt()</code> exists so returning a <code>complex</code> has standard C library precedence without a static variable nor allocation.  <code>ccbrt()</code> would have an additional challenges to precisely specify which of the 3 roots to return.  I suspect its low need has not admitted <code>ccbrt()</code> to the <a href=\"https://en.wikipedia.org/w/index.php?title=Libc&amp;redirect=no\" rel=\"nofollow noreferrer\">libc</a> club."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1532010665, "post_id": 51401542, "comment_id": 89821592, "body": "I would consider complex support in C has not really high priority. They have been made optional with C11 for a good reason. Problem with specifying which root to yield is you had to call it multiple times, causing more overhead. This is another problem for their intended usage with large scale arrays. Sure, one could pass an array to be filled, but that would also be uncommon. Finally, I&#39;m not sure how often cubic roots of <code>_Complex</code> are really needed (I doubt in fact many C programs require standard complex at all - with decreasing importance for the future (NumPy, heavy optimised libs, \u2026)."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1531917921, "last_edit_date": 1531917921, "creation_date": 1531915326, "answer_id": 51401542, "question_id": 51397996, "link": "https://stackoverflow.com/questions/51397996/how-to-compute-a-cubic-root-of-a-complex-number-in-c/51401542#51401542", "title": "How to compute a cubic root of a complex number in C?", "body": "<p><strong>cbrt doesn't work.</strong></p>\n\n<p>That function works on real values. <a href=\"https://stackoverflow.com/questions/51397996/how-to-compute-a-cubic-root-of-a-complex-number-in-c/51401542#comment89767596_51397996\">@squeamish ossifrage</a><br>\n<code>x is 1.000000 + 0.000000i</code> is a reasonable result.  </p>\n\n<pre><code>double cbrt(double x);\n</code></pre>\n\n<blockquote>\n  <p>The <code>cbrt</code> functions compute the real cube root of <code>x</code>.  C11dr \u00a77.12.7.1 2</p>\n</blockquote>\n\n<p>A good compiler with warnings fully enabled with report on the following.  <strong>Save time</strong>, enable all compiler warnings.</p>\n\n<pre><code>// warning expected such as:\n// warning: conversion to 'long double' from 'complex double' discards imaginary component [-Wconversion]\nx = cbrt(z);\n</code></pre>\n\n<hr>\n\n<p><strong>How to compute a cubic root of a complex number in C?</strong></p>\n\n<p><code>&lt;cmath.h&gt;</code> is not part of the C standard library.  Its role here is unclear.</p>\n\n<p>Code can use <code>double complex cpow(double complex, double complex);</code></p>\n\n<pre><code>x = cpow(z, 1.0/3.0);\n...\n// Ouptut\n// x is 1.219617 + 0.471711i \n</code></pre>\n\n<p>I do not find a <code>double complex ccbrt(double complex);</code> in the standard library nor access to one via type-generic math <code>&lt;tgmath.h&gt;</code>.</p>\n\n<hr>\n\n<p><strong>... to compute cubic roots ...</strong></p>\n\n<p>Emphasis on plural \"roots\" here: to compute all 'n' roots:</p>\n\n<pre><code>  int n = 3;\n  const double complex two_pi_i = 2.0 * asin(-1.0) * I;\n  double complex rotate = cexp(two_pi_i / n);\n  x = cpow(z, 1.0 / 3.0);\n  for (int k = 0; k &lt; n; k++) {\n    printf(\"x[%d] is % f + % fi \\n\", k, creal(x), cimag(x));\n    x *= rotate;\n  }\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>x[0] is  1.219617 +  0.471711i \nx[1] is  1.018322 + -0.820363i \nx[2] is -0.201294 + -1.292075i \n</code></pre>\n"}], "owner": {"reputation": 468, "user_id": 1487336, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/569545428cb39903e0d63a4e707bf4a8?s=128&d=identicon&r=PG", "display_name": "Lei Hao", "link": "https://stackoverflow.com/users/1487336/lei-hao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "accepted_answer_id": 51401542, "answer_count": 2, "score": -2, "last_activity_date": 1531917921, "creation_date": 1531905010, "question_id": 51397996, "link": "https://stackoverflow.com/questions/51397996/how-to-compute-a-cubic-root-of-a-complex-number-in-c", "title": "How to compute a cubic root of a complex number in C?", "body": "<p>As the name suggested, I'd like to compute cubic roots of a complex number in C. <strong><em>cbrt</em></strong> doesn't work. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;complex.h&gt;\n#include &lt;cmath.h&gt;\n\nint main(){\n    double complex x, z = 1+2*I;\n    x = cbrt(z);\n    printf(\"z is %f + %fi \\n\", creal(z), cimag(z));\n    printf(\"x is %f + %fi \\n\", creal(x), cimag(x));\n    return(0);\n}\n</code></pre>\n\n<p>The output is as follows.</p>\n\n<pre><code>z is 1.000000 + 2.000000i \nx is 1.000000 + 0.000000i\n</code></pre>\n"}, {"tags": ["c", "memory-management", "struct", "arm", "cmsis"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1531904741, "post_id": 51397878, "comment_id": 89766727, "body": "<code>memset(d, 0, sizeof(*d));</code> isn&#39;t going to zero your data. Use <code>calloc</code> for this"}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1531905584, "post_id": 51397878, "comment_id": 89767332, "body": "Looking at <code>arm_mat_init_f32</code> function definition here: <a href=\"https://www.cs.indiana.edu/~bhimebau/CMSIS/Documentation/DSP/html/group___matrix_init.html\" rel=\"nofollow noreferrer\">cs.indiana.edu/~bhimebau/CMSIS/Documentation/DSP/html/&hellip;</a> I wonder where is the function like <code>arm_mat_release_f32</code>? If such function doesn&#39;t exist, I can guess that <code>arm_mat_init_f32</code> just populates the <code>arm_matrix_instance_f32</code> fields and doesn&#39;t make any allocations. In this case your code is wrong, because after <code>create_dataset</code> function exits, all <code>pData</code> pointers become invalid."}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1531905698, "post_id": 51397878, "comment_id": 89767420, "body": "However, you need to know the API you are using, give some more information to get the answer."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531906941, "post_id": 51397878, "comment_id": 89768268, "body": "There is no array in your <code>struct</code>. A pointer <b>is not</b> an array. And this seems to be some bare-metal MCU system. It&#39;s generally a very bad idea to use <code>malloc</code> &amp; co on such systems."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531907270, "post_id": 51397878, "comment_id": 89768501, "body": "And that&#39;s an XY problem anyway. You use a very wrong approach."}, {"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "reply_to_user": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1531907593, "post_id": 51397878, "comment_id": 89768725, "body": "@AlexF from what I understood looking at the functions, the init function simply populates the fields, as you guessed. I don&#39;t understand though why my method would be incorrect, because the output I am passing is a pointer to the <code>dataset</code> structure, in which the pointers to <code>arm_matrix_instance_f32</code> structs should not get lost. Am I wrong?"}, {"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531908784, "post_id": 51397878, "comment_id": 89769485, "body": "@Olaf, thank you. Could you elaborate on the &#39;XY problem&#39;? What do you mean by that? If you could point me to the right approach I&#39;ll be very glad!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531909089, "post_id": 51397878, "comment_id": 89769682, "body": "@raggot: For the correct approach I had to know project details, the architecture, platform, etc. That&#39;s far beyond what this site is for. I&#39;d advise to step back and start with something simpler to leran the language properly and get some practice first. Don&#39;t try to run before you can walk. If that&#39;s an embedded project as I assume, this is even more vital: they have much less tolerance to problematic/faulty code."}, {"owner": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1531910119, "post_id": 51397878, "comment_id": 89770339, "body": "@raggot: all <code>pData</code> pointers become invalid when <code>create_dataset</code> returns, since they point to local arrays."}, {"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "reply_to_user": {"reputation": 38927, "user_id": 279313, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4ab0299c28ce807a9ca21041ed6ef085?s=128&d=identicon&r=PG", "display_name": "Alex F", "link": "https://stackoverflow.com/users/279313/alex-f"}, "edited": false, "score": 0, "creation_date": 1531915122, "post_id": 51397878, "comment_id": 89773550, "body": "@AlexF. I had missed that...! Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "edited": false, "score": 0, "creation_date": 1531907893, "post_id": 51398731, "comment_id": 89768923, "body": "Thanks for the clarification."}, {"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "edited": false, "score": 0, "creation_date": 1531908421, "post_id": 51398731, "comment_id": 89769236, "body": "This gives me the idea of where I have to put my hands. Any idea why the answer was downvoted? Perhaps there can be more elegant ways to run the initialization functions instead of hard-coding the size?"}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "reply_to_user": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "edited": false, "score": 0, "creation_date": 1531908457, "post_id": 51398731, "comment_id": 89769255, "body": "@raggot: For the downvote, I do not know, but malloc on an embedded device where memory is limited should be used very cautiously, what my initial code did not."}], "tags": [], "owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "is_accepted": false, "score": 0, "last_activity_date": 1531908498, "last_edit_date": 1531908498, "creation_date": 1531906974, "answer_id": 51398731, "question_id": 51397878, "link": "https://stackoverflow.com/questions/51397878/how-to-create-a-struct-of-structs-of-known-maximum-size/51398731#51398731", "title": "How to create a struct of structs of known maximum size", "body": "<p>Beware, pointers and arrays are different animals!</p>\n\n<p>Here, the <code>arm_matrix_instance_f32</code> contains no array but a pointer. And <code>dataset</code> contains 3 of them. Full stop.</p>\n\n<p>That means that this line is plain wrong:</p>\n\n<pre><code>dataset* d= malloc( n_matrices * (sizeof(float32_t)*n_elements + sizeof(uint16_t)*2));\n</code></pre>\n\n<p>You should instead separately allocate the struct and the arrays:</p>\n\n<pre><code>dataset* create_dataset( void ) {\n\n    dataset* d = malloc(sizeof(*d));                  // allocate memory for the structs\n    if (d == NULL) return NULL;                       // could not allocate\n    // allocate memory for the arrays (9 + 3 + 3)\n    float32_t *array = malloc(15 +  * sizeof(*array));\n    if (array == NULL) {\n        free(d);                                      // free d if array not allocated\n        return NULL;\n    }\n\n    for (int i=0; i&lt;15; i++) array[i] = 0.;           // zeroes the arrays\n\n    arm_mat_init_f32( &amp;(d-&gt;A), 3, 3, array);          // pass 9 first elements to A\n    arm_mat_init_f32( &amp;(d-&gt;B), 3, 1, array + 9);      // pass following 3 to B\n    arm_mat_init_f32( &amp;(d-&gt;C), 1, 3, array + 12);     // pass last 3 to C\n\n    return d;\n}\n</code></pre>\n\n<p>As you have allocated everything with <code>malloc</code> you will have to free it later:</p>\n\n<pre><code>void destroy_dataset(dataset *d) {\n    free(d-&gt;A.pData);      // free the array (A got the beginning of the allocated array)\n    free(d);               // and the struct\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "edited": false, "score": 0, "creation_date": 1531909225, "post_id": 51399209, "comment_id": 89769770, "body": "I like this approach. A bit verbose (I actually have 25 matrices currently, not 3) but clear and seems to take care of all memory management problems in one go. I will try it in a bit and get back to you."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "edited": false, "score": 0, "creation_date": 1531909519, "post_id": 51399209, "comment_id": 89769976, "body": "@raggot &quot;I actually have 25 matrices currently&quot; It is probably not a very good idea to have a struct of 25 identically typed elements. An array might be more appropriate."}], "tags": [], "owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "is_accepted": false, "score": 1, "last_activity_date": 1531908348, "creation_date": 1531908348, "answer_id": 51399209, "question_id": 51397878, "link": "https://stackoverflow.com/questions/51397878/how-to-create-a-struct-of-structs-of-known-maximum-size/51399209#51399209", "title": "How to create a struct of structs of known maximum size", "body": "<p>I think you should take more granular approach to this and start from allocating space for each <code>arm_matrix_instance_f32</code> separately. Consider creating a factory function for those instances. It will produce more readable code and will allow you to simply replace <code>arm_matrix_instance_f32</code> in your <code>dataset</code> with other instances.</p>\n\n<p>On the other hand if you always know the number of matrices and the maximum number of elements they contain you can use compound literals to generate your dataset:</p>\n\n<pre><code> dataset create()\n {\n     return (dataset) {\n         .A = {\n             3, 3, (float32_t [])  {\n                 1.0, 2.0, 3.0,\n                 4.0, 5.0, 6.0,\n                 7.0, 8.0, 9.0,\n             }\n         },\n         .B = {\n             3, 3, (float32_t [])  {\n                 2.0, 0.0, 0.0,\n                 0.0, 0.0, 0.0,\n                 0.0, 0.0, 0.0,\n             }\n         },\n         .C = {\n             3, 3, (float32_t [])  {\n                 2.0, 0.0, 0.0,\n                 0.0, 0.0, 0.0,\n                 0.0, 0.0, 0.0,\n             }\n         },\n\n     };\n }\n</code></pre>\n\n<p>This will free you from heap allocation/deallocation. </p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1531911984, "creation_date": 1531911984, "answer_id": 51400433, "question_id": 51397878, "link": "https://stackoverflow.com/questions/51397878/how-to-create-a-struct-of-structs-of-known-maximum-size/51400433#51400433", "title": "How to create a struct of structs of known maximum size", "body": "<p>To create a variable of type <code>dataset</code> (or any <code>struct</code> for that matter):</p>\n\n<pre><code>dataset d;\n</code></pre>\n\n<p>That's it. Nothing more to it.</p>\n\n<p>To allocate an object of type <code>dataset</code> (or any <code>struct</code> for that matter) on the heap:</p>\n\n<pre><code>dataset* dp = malloc(sizeof(dataset));\n</code></pre>\n\n<p>That's it. Nothing more to it.</p>\n\n<p>Now to <em>initialise</em> such an object properly is a different issue. But in order to initialize something, you need to create that something first. It is best to keep these two processes, creation and initialisation, mentally separated.</p>\n\n<p>So you have an uninitialised <code>struct</code> on your hands. How to initialise it? Field by field.</p>\n\n<p>Each field is a matrix, which may require its own complex initialisation, so it is beneficial to write a dedicated matrix initialisation function. Let's use one first, and write it later. Let's assume you have to allocate your dataset on the heap.</p>\n\n<pre><code>dataset* allocate_dataset() {\n       dataset* dp = malloc(sizeof(dataset));\n       if (dp == NULL) { /* report out-of-memory error */ }\n       init_matrix(&amp;dp-&gt;A, 3, 3);\n       init_matrix(&amp;dp-&gt;B, 3, 1);\n       init_matrix(&amp;dp-&gt;C, 1, 3);\n       return dp;\n}\n</code></pre>\n\n<p>Whatever is allocated on the heap must eventually be freed, so we write a symmetrical deallocation function:</p>\n\n<pre><code>void free_dataset(dataset* dp) {\n       destroy_matrix(&amp;dp-&gt;A);\n       destroy_matrix(&amp;dp-&gt;B);\n       destroy_matrix(&amp;dp-&gt;C);\n       free(dp);\n}\n</code></pre>\n\n<p>On to matrix initialisation. There is a library function that does it, but it needs a  pointer to its data array, which should be allocated somewhere. I assume it lives on the heap.</p>\n\n<pre><code>void init_matrix(arm_mat_init_f32* mp, int rows, int cols) {\n    float32_t* data = malloc(sizeof(float32_t * rows * cols);\n    if (data == NULL) { /* report out-of-memory error */ }\n    arm_mat_init_f32(mp, rows, cols, data);   \n}\n</code></pre>\n\n<p>Destroying a matrix is almost trivial:</p>\n\n<pre><code>void destroy_matrix(arm_mat_init_f32* mp) {\n    free (mp-&gt;pData);\n}\n</code></pre>\n\n<p>Again, this assumes you need to allocate your matrix data on the heap. This is not necessarily the case. Perhaps you are on an embedded device with limited memory. Now let's assume the opposite: no heap. You don't need to allocate your dataset, bit you still need to initialise it:</p>\n\n<pre><code>void init_dataset (dataset* dp);\n</code></pre>\n\n<p>And now init_matrix does nothing but calls <code>arm_mat_init_f32</code>, so we can just use the latter directly:</p>\n\n<pre><code>void init_dataset (dataset* dp) {\n    arm_mat_init_f32(&amp;dp-&gt;A, 3, 3, (float32_t[]){0,0,0, 0,0,0, 0,0,0});\n    arm_mat_init_f32(&amp;dp-&gt;B, 3, 1, (float32_t[]){0,0,0});\n    arm_mat_init_f32(&amp;dp-&gt;C, 1, 3, (float32_t[]){0,0,0});\n}\n</code></pre>\n\n<p>Destruction is not needed, but you may want to still keep destruction functions that do nothing, just in case, and call them wherever appropriate.</p>\n\n<pre><code>void destroy_dataset(dataset* dp) { \n    destroy_matrix(&amp;dp-&gt;A);\n    destroy_matrix(&amp;dp-&gt;B);\n    destroy_matrix(&amp;dp-&gt;C);\n}\n\nvoid destroy_matrix(arm_mat_init_f32* mp) { \n  (void)mp; // suppress compiler warning\n}\n</code></pre>\n\n<p>Why? Because you don't want to redo <em>all</em> of your code once you change your mind (or switch to a different device) and decide to allocate matrices on the heap. You just modify your <code>init</code> and <code>destroy</code> functions.</p>\n"}], "owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "closed_date": 1531923705, "accepted_answer_id": 51400433, "answer_count": 3, "score": 1, "last_activity_date": 1531911984, "creation_date": 1531904678, "last_edit_date": 1531908726, "question_id": 51397878, "link": "https://stackoverflow.com/questions/51397878/how-to-create-a-struct-of-structs-of-known-maximum-size", "closed_reason": "Needs more focus", "title": "How to create a struct of structs of known maximum size", "body": "<p><strong>Edit</strong>: I am now aware of the confusion I made between array and pointer. I appreciate the remarks but won't make the question more accurate, as it would lose part of the reason I wrote it.</p>\n\n<p>I am trying to initialize a struct made of structs each containing an array. More clearly, I have this matrix structure:</p>\n\n<pre><code>typedef struct\n{\n    uint16_t numRows;     /**&lt; number of rows of the matrix.     */\n    uint16_t numCols;     /**&lt; number of columns of the matrix.  */\n    float32_t *pData;     /**&lt; points to the data of the matrix. */\n} arm_matrix_instance_f32;\n</code></pre>\n\n<p>and I need to put a number of these matrix objects together into a bigger struct</p>\n\n<pre><code>typedef struct\n{\n    arm_matrix_instance_f32 A;\n    arm_matrix_instance_f32 B;\n    arm_matrix_instance_f32 C;\n} dataset;\n</code></pre>\n\n<p>For reference, this matrix definition and the initialisation function used later, come from the <code>arm_math</code> library in <a href=\"https://github.com/ARM-software/CMSIS\" rel=\"nofollow noreferrer\">CMSIS</a>.</p>\n\n<p>I am having difficulties understanding how I should create a <code>dataset</code> variable. Following the answers and discussion in this <a href=\"https://stackoverflow.com/questions/7263723/struct-with-array-of-structs-of-unknown-size\">question page</a>, I understand I cannot magically expect C to know how much memory to allocate with a declaration such as <code>dataset d</code>. </p>\n\n<p>Following only the solution to the linked question, I came up with a function to initialise enough space for a <code>dataset</code>, and with a function to create a variable of type <code>dataset</code>. I have now something like this:</p>\n\n<pre><code>dataset* create_dataset( void ) {\n\n    uint8_t n_matrices = 3;\n    uint8_t n_elements = 9;\n    dataset* d= malloc( n_matrices * (sizeof(float32_t)*n_elements + sizeof(uint16_t)*2));\n    memset(d, 0, sizeof(*d));\n\n    const float32_t zeros33_f32[9] =\n    {\n        0.0, 0.0, 0.0,\n        0.0, 0.0, 0.0,\n        0.0, 0.0, 0.0,\n    };\n    const float32_t zeros31_f32[3] =\n    {\n        0.0,\n        0.0,\n        0.0,\n    };\n    const float32_t zeros13_f32[3] =\n    {\n        0.0, 0.0, 0.0,\n    };\n\n    arm_mat_init_f32( &amp;(d-&gt;A), 3, 3, (float32_t *)zeros33_f32);\n    arm_mat_init_f32( &amp;(d-&gt;B), 3, 1, (float32_t *)zeros31_f32);\n    arm_mat_init_f32( &amp;(d-&gt;C), 1, 3, (float32_t *)zeros13_f32);\n\n    return d;\n}\n</code></pre>\n\n<p>Basically I start from the assumption that both the number of matrices and the maximum number of elements they contain are known, and consequently reserve enough memory. </p>\n\n<p>I have the following questions:</p>\n\n<ol>\n<li>Is if the overall approach correct for such nested structs? </li>\n<li>Is the allocation of space for the <code>dataset</code> struct correct? </li>\n<li>Am I actually ensuring that all <code>arm_matrix_instance_f32</code> elements contained in the <code>dataset</code> struct I create have enough space for all their elements?  </li>\n<li>I declared the struct as containing <code>A, B, C</code>. What happens if I initialise them in another order? For example, how would the struct know how much space to leave between <code>A</code> and <code>C</code> if <code>B</code> is still not declared?</li>\n</ol>\n"}, {"tags": ["c", "node.js", "networking", "ping", "latency"], "comments": [{"owner": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1531946426, "post_id": 51397858, "comment_id": 89792728, "body": "Not clear what you want. Is it perhaps that you want to calculate latency between 2 remote IP addresses?"}, {"owner": {"reputation": 7658, "user_id": 5321614, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ual5b.jpg?s=128&g=1", "display_name": "Prafulla Kumar Sahu", "link": "https://stackoverflow.com/users/5321614/prafulla-kumar-sahu"}, "reply_to_user": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1531979186, "post_id": 51397858, "comment_id": 89801403, "body": "@LuisMu&#241;oz Yes, I want to calculate latency between 2 remote IP addresses."}, {"owner": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1532026817, "post_id": 51397858, "comment_id": 89831090, "body": "Good question, I don&#39;t think there&#39;s an easy way to do this. Also not easy to ask the question in the right way :p."}, {"owner": {"reputation": 7658, "user_id": 5321614, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ual5b.jpg?s=128&g=1", "display_name": "Prafulla Kumar Sahu", "link": "https://stackoverflow.com/users/5321614/prafulla-kumar-sahu"}, "reply_to_user": {"reputation": 5895, "user_id": 2834978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05b09a797fd0c59d1627b30fb4cdba01?s=128&d=identicon&r=PG&f=1", "display_name": "Luis Mu&#241;oz", "link": "https://stackoverflow.com/users/2834978/luis-mu%c3%b1oz"}, "edited": false, "score": 0, "creation_date": 1532054139, "post_id": 51397858, "comment_id": 89838866, "body": "You are correct, I don\u2019t have an easy way to do this or ask this."}], "owner": {"reputation": 7658, "user_id": 5321614, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ual5b.jpg?s=128&g=1", "display_name": "Prafulla Kumar Sahu", "link": "https://stackoverflow.com/users/5321614/prafulla-kumar-sahu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1532097129, "creation_date": 1531904616, "last_edit_date": 1532097129, "question_id": 51397858, "link": "https://stackoverflow.com/questions/51397858/how-to-measure-latency-between-hosts-a-and-b-from-a-monitoring-host-c", "title": "How to measure latency between hosts A and B from a Monitoring host C", "body": "<p>How to measure latency between hosts A and B from a Monitoring/Observer host C?</p>\n\n<p>I have used <a href=\"https://www.npmjs.com/package/ping\" rel=\"nofollow noreferrer\">Ping</a> module here.</p>\n\n<pre><code>var ping = require('ping');\n\nvar hosts = ['192.168.1.1', 'google.com', 'yahoo.com'];\n\nhosts.forEach(function (host) {\n    ping.promise.probe(host)\n        .then(function (res) {\n            console.log(res);\n        });\n});\n</code></pre>\n\n<p>This results</p>\n\n<pre><code>{ host: 'google.com',\n  alive: true,\n  output: '\\r\\nPinging google.com [172.217.163.174] with 32 bytes of data:\\r\\nReply from 172.217.163.174: bytes=32 time=8ms TTL=55\\r\\n\\r\\nPing statistics for 172.217.163.174:\\r\\n    Packets: Sent = 1, Received = 1, Lost = 0 (0% loss),\\r\\nApproximate round trip times in milli-seconds:\\r\\n    Minimum = 8ms, Maximum = 8ms, Average = 8ms\\r\\n',\n  time: 8,\n  min: '8.000',\n  max: '8.000',\n  avg: '8.000',\n  stddev: '0.000',\n  numeric_host: '172.217.163.174' }\n{ host: 'yahoo.com',\n  alive: true,\n  output: '\\r\\nPinging yahoo.com [98.138.219.231] with 32 bytes of data:\\r\\nReply from 98.138.219.231: bytes=32 time=254ms TTL=44\\r\\n\\r\\nPing statistics for 98.138.219.231:\\r\\n    Packets: Sent = 1, Received = 1, Lost = 0 (0% loss),\\r\\nApproximate round trip times in milli-seconds:\\r\\n    Minimum = 254ms, Maximum = 254ms, Average = 254ms\\r\\n',\n  time: 254,\n  min: '254.000',\n  max: '254.000',\n  avg: '254.000',\n  stddev: '0.000',\n  numeric_host: '98.138.219.231' }\n{ host: '192.168.1.1',\n  alive: false,\n  output: '\\r\\nPinging 192.168.1.1 with 32 bytes of data:\\r\\nRequest timed out.\\r\\n\\r\\nPing statistics for 192.168.1.1:\\r\\n    Packets: Sent = 1, Received = 0, Lost = 1 (100% loss),\\r\\n',\n  time: 'unknown',\n  min: 'unknown',\n  max: 'unknown',\n  avg: 'unknown',\n  stddev: 'unknown',\n  numeric_host: '192.168.1.1' }\n</code></pre>\n\n<p>But I want to pass two IP address and calculate the latency, is there any way to do so?</p>\n\n<p><strong><em>If it is possible in any other programing language, then also I would like to know.</em></strong></p>\n"}, {"tags": ["c", "queue", "posix"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 10098096, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eQAe2gGPW7Q/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7p3Qca7-3-VwgiAnSk2_Ct8YgRRwQ/mo/photo.jpg?sz=128", "display_name": "yahor zabalotski", "link": "https://stackoverflow.com/users/10098096/yahor-zabalotski"}, "is_accepted": false, "score": 2, "last_activity_date": 1531906561, "creation_date": 1531906561, "answer_id": 51398587, "question_id": 51397663, "link": "https://stackoverflow.com/questions/51397663/posix-message-queue-receive-timeout/51398587#51398587", "title": "POSIX Message Queue Receive Timeout", "body": "<p>You can use mq_timedreceive function.</p>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 8955470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3637e741fb1fc22f7b6de4c6cf075c?s=128&d=identicon&r=PG&f=1", "display_name": "Eisenheim", "link": "https://stackoverflow.com/users/8955470/eisenheim"}, "edited": false, "score": 0, "creation_date": 1531907937, "post_id": 51398741, "comment_id": 89768951, "body": "When i use mq_timedreceive and set the O_NONBLOCK in mq_open,it returns error when no message is received."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 153, "user_id": 8955470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3637e741fb1fc22f7b6de4c6cf075c?s=128&d=identicon&r=PG&f=1", "display_name": "Eisenheim", "link": "https://stackoverflow.com/users/8955470/eisenheim"}, "edited": false, "score": 0, "creation_date": 1531910141, "post_id": 51398741, "comment_id": 89770355, "body": "@Einsenheim Yes, and <code>errno</code> should be set to <code>EAGAIN</code>.  That&#39;s how you know there was no message."}, {"owner": {"reputation": 153, "user_id": 8955470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3637e741fb1fc22f7b6de4c6cf075c?s=128&d=identicon&r=PG&f=1", "display_name": "Eisenheim", "link": "https://stackoverflow.com/users/8955470/eisenheim"}, "edited": false, "score": 0, "creation_date": 1531910884, "post_id": 51398741, "comment_id": 89770803, "body": "Thanks Andrew Henle."}, {"owner": {"reputation": 4259, "user_id": 2516916, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/90d670e62ae35e180ad6e939443cab62?s=128&d=identicon&r=PG", "display_name": "Gillespie", "link": "https://stackoverflow.com/users/2516916/gillespie"}, "edited": false, "score": 0, "creation_date": 1591198360, "post_id": 51398741, "comment_id": 109966196, "body": "These timeouts are non-monotonic though... so in something like an embedded system connected to GPS... this could cause funny behavior"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 2, "last_activity_date": 1531906994, "creation_date": 1531906994, "answer_id": 51398741, "question_id": 51397663, "link": "https://stackoverflow.com/questions/51397663/posix-message-queue-receive-timeout/51398741#51398741", "title": "POSIX Message Queue Receive Timeout", "body": "<p>In addition to <code>mq_timedreceive()</code>, you can also set the <code>O_NONBLOCK</code> when you open the queue with <code>mq_open()</code>.  Per <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mq_open.html\" rel=\"nofollow noreferrer\">the <code>mq_open()</code> documentation</a>:</p>\n\n<blockquote>\n  <p><code>O_NONBLOCK</code>\n      Determines whether an <code>mq_send()</code> or <code>mq_receive()</code> waits for resources or messages that are not currently available, or fails with errno set to <code>EAGAIN</code>; see <code>mq_send</code> and <code>mq_receive</code> for details.</p>\n</blockquote>\n\n<p>Per <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mq_receive.html\" rel=\"nofollow noreferrer\">the <code>mq_receive()</code> documentation</a>:</p>\n\n<blockquote>\n  <p>If the specified message queue is empty and <code>O_NONBLOCK</code> is set in the message queue description associated with <code>mqdes</code>, no message shall be removed from the queue, and <code>mq_receive()</code> shall return an error.</p>\n</blockquote>\n"}], "owner": {"reputation": 153, "user_id": 8955470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3637e741fb1fc22f7b6de4c6cf075c?s=128&d=identicon&r=PG&f=1", "display_name": "Eisenheim", "link": "https://stackoverflow.com/users/8955470/eisenheim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 738, "favorite_count": 0, "accepted_answer_id": 51398741, "answer_count": 2, "score": 2, "last_activity_date": 1531906994, "creation_date": 1531904075, "question_id": 51397663, "link": "https://stackoverflow.com/questions/51397663/posix-message-queue-receive-timeout", "title": "POSIX Message Queue Receive Timeout", "body": "<pre><code>if((nbytes=mq_receive (qid_recv, (pchar_t)in_buffer, msg_buffer_size, NULL)) != -1) {\n            printf(\"nbytes is %ld\\n\", nbytes);\n}else{\n     perror(\"recv_data\");\n     printf(\"nbytes is %ld\\n\", nbytes);\n</code></pre>\n\n<p>How to exit from the mq_receive if there is no message is received.Is there any possiblity for give a timeout.Thanks for your time.</p>\n"}, {"tags": ["c", "pointers", "dereference"], "comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1531901721, "post_id": 51396563, "comment_id": 89764753, "body": "@Jabberwocky <code>&quot;Hello world&quot;</code> is a <code>char</code> array, that decays to a pointer in most contexts, but that can be distinguished from one with <code>sizeof</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531910633, "post_id": 51396563, "comment_id": 89770654, "body": "The lines above will definitively generate multiple errors. That&#39;s not valid C for various reasons, (Sidnote - phrases: C does not have instructions. YOu might mean statements, but the first line is not a statement either. Even if we consider you just forgot the semicolons."}], "answers": [{"tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1531901814, "last_edit_date": 1531901814, "creation_date": 1531901090, "answer_id": 51396708, "question_id": 51396563, "link": "https://stackoverflow.com/questions/51396563/where-am-i-going-wrong-about-this-reasoning/51396708#51396708", "title": "Where am I going wrong about this reasoning?", "body": "<p>Quoting <code>C11</code>, chapter \u00a76.3.2.1</p>\n\n<blockquote>\n  <p>Except when it is the operand of the <code>sizeof</code> operator, the <code>_Alignof</code> operator, or the\n  unary <code>&amp;</code> operator, or is a string literal used to initialize an array, an expression that has\n  type <em>\u2018\u2018array of type\u2019\u2019</em> is converted to an expression with type <em>\u2018\u2018pointer to type\u2019\u2019</em> that points\n  to the initial element of the array object and is not an lvalue. [....]</p>\n</blockquote>\n\n<p>Here, the string literal, which is basically of type array of <code>char</code><sup>FootNote</sup>, while used as the RHS of the assignment operator, decays to the pointer to the first element of the array. </p>\n\n<p>Thus, the LHS (a pointer type) and RHS (a derived pointer type) are compatible, as required by the assignment operator and the statement is valid.</p>\n\n<p>That said,</p>\n\n<pre><code> str = &amp;(\"Hello World!\");\n</code></pre>\n\n<p>is not valid, as <code>&amp;(\"Hello World!\");</code> is of type <code>char (*) [13]</code> (pointer to an array of 13 <code>char</code>s), and is not the compatible type for a <code>char *</code>, the LHS of the assignment.</p>\n\n<hr>\n\n<p>FootNote:</p>\n\n<p>Quoting <code>C11</code>, \u00a76.4.5</p>\n\n<blockquote>\n  <p>In translation phase 7, a byte or code of value zero is appended to each multibyte\n  character sequence that results from a string literal or literals.78) The multibyte character\n  sequence is then used to initialize an array of static storage duration and length just\n  sufficient to contain the sequence. For character string literals, the array elements have\n  type char, and are initialized with the individual bytes of the multibyte character\n  sequence. [....]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 3, "last_activity_date": 1531902846, "last_edit_date": 1531902846, "creation_date": 1531901125, "answer_id": 51396722, "question_id": 51396563, "link": "https://stackoverflow.com/questions/51396563/where-am-i-going-wrong-about-this-reasoning/51396722#51396722", "title": "Where am I going wrong about this reasoning?", "body": "<p>The string literal <code>\"Hello World!\"</code> is an anonymous object of type <code>char [13]</code>, i.e. array of 13 chars, which implicitly decays to a pointer to the first character of the array (<code>char *</code>!) in all contexts except when the array occurs as an operand to the &amp; or in a <code>sizeof</code>/<code>_Alignof</code>.</p>\n\n<pre><code>str = &amp;(\"Hello World!\")\n</code></pre>\n\n<p>(which can be written without the parentheses <code>str = &amp;\"Hello World!\"</code>) is specifically <em>not</em> correct, because the result of <code>&amp;(\"Hello World!\")</code> is of type <code>*char (*)[13]</code>, i.e. a pointer to an array of 13 characters!</p>\n\n<p>GCC would diagnose this as </p>\n\n<pre><code>test.c:3:9: warning: assignment from incompatible pointer type [-Wincompatible-pointer-types]\n     str = &amp;\"Hello World!\";\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10018629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0rvu.png?s=128&g=1", "display_name": "LiukPet", "link": "https://stackoverflow.com/users/10018629/liukpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531902846, "creation_date": 1531900650, "last_edit_date": 1531901708, "question_id": 51396563, "link": "https://stackoverflow.com/questions/51396563/where-am-i-going-wrong-about-this-reasoning", "title": "Where am I going wrong about this reasoning?", "body": "<p>Consider to define a char pointer in C. Then the instruction:</p>\n\n<pre><code>char *str\nstr = \"Hello World!\"\n</code></pre>\n\n<p>isn't producing any error. Posing that my knowledge of C and pointer is barely acceptable, why is this instruction correct? Shouldn't it be:</p>\n\n<pre><code>str = &amp;(\"Hello World!\");\n</code></pre>\n"}, {"tags": ["c", "data-structures", "text-files"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1531901183, "post_id": 51396498, "comment_id": 89764423, "body": "That was an error.For Array.Priority = Array.IsReplace; . its supposed to set the priority to the value in Array.IsReplace"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "edited": false, "score": 0, "creation_date": 1531901315, "post_id": 51396649, "comment_id": 89764499, "body": "does it mean I should not worry about the tabs(\\t) between the raw data?"}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531901495, "post_id": 51396649, "comment_id": 89764608, "body": "@MikeM you should set a termination for your for loop. I would reccomend to check for EOF(End of File) + you have to read your strings into your struct elements UNTIL each /t gets found.  How does your text file look?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "edited": false, "score": 0, "creation_date": 1531901711, "post_id": 51396649, "comment_id": 89764748, "body": "I&#39;ve edited my question and added how my text file looks like"}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531903252, "post_id": 51396649, "comment_id": 89765696, "body": "Oh okey I understand. I updated my answer. That should work for your problem"}], "tags": [], "owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "is_accepted": true, "score": 0, "last_activity_date": 1531903358, "last_edit_date": 1531903358, "creation_date": 1531900907, "answer_id": 51396649, "question_id": 51396498, "link": "https://stackoverflow.com/questions/51396498/reading-a-text-file-line-by-line-into-a-structure-in-c/51396649#51396649", "title": "Reading a text file line by line into a structure in c", "body": "<p>Try to replace your for loop with a while loop like this:</p>\n\n<pre><code>while((fscanf(Ufptr, \"%d\\t%s\\t%d\\t%d\\t%d\\n\",&amp;Arguments...)) != EOF){\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9999696"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 51396649, "answer_count": 1, "score": 2, "last_activity_date": 1531903358, "creation_date": 1531900446, "last_edit_date": 1531903142, "question_id": 51396498, "link": "https://stackoverflow.com/questions/51396498/reading-a-text-file-line-by-line-into-a-structure-in-c", "title": "Reading a text file line by line into a structure in c", "body": "<p>I am kind of new to c programming but I want to create a c function that can read contents of a text file line by line separated by the tab delimiter(\\t) and store them into a data structure, then after clear the file but have still failed. My code is</p>\n\n<pre><code>struct Busy_list{\n    int client_socket;\n    char JOB[1024];\n    int characters;\n    int No_jobs;\n    int IsReplace;\n    int Priority;\n};\n\n\n\nchar** PriorityEvaluator(int client_socket){\nstruct Busy_list Array;\n\nFILE *Ufptr;\nUfptr = fopen(\"Unsorted_busy_list.txt\",\"r+\");\n    for(int i;!EOF;i++){\n        fscanf(Ufptr, \"%d\\t%s\\t%d\\t%d\\t%d\\n\",&amp;Array.client_socket,&amp;Array.JOB,&amp;Array.characters,&amp;Array.No_jobs,&amp;Array.IsReplace);\n    }\n    fclose(Ufptr);\n}\n</code></pre>\n\n<p><strong>My Unsorted_busy_list file contains</strong></p>\n\n<pre><code>/*\n\n4   double fish 4   1   0\n\n5   double praise   6   2   0\n\n5   replace peter 2-o,4-o   5   2   1\n\n*/\n</code></pre>\n"}, {"tags": ["c++", "c", "assembly"], "comments": [{"owner": {"reputation": 370, "user_id": 9769810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XAI8c.jpg?s=128&g=1", "display_name": "Killian G.", "link": "https://stackoverflow.com/users/9769810/killian-g"}, "edited": false, "score": 2, "creation_date": 1531900517, "post_id": 51396485, "comment_id": 89764063, "body": "Use <code>__asm__(&quot;your asm code here&quot;);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2486888"}, "edited": false, "score": 3, "creation_date": 1531900569, "post_id": 51396485, "comment_id": 89764085, "body": "There is no such thing as &quot;c/c++&quot;. Unclear what you are asking."}, {"owner": {"reputation": 9215, "user_id": 5212827, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7e9f9b0d7e2d571c9f8886dd54bd50f9?s=128&d=identicon&r=PG&f=1", "display_name": "DeiDei", "link": "https://stackoverflow.com/users/5212827/deidei"}, "edited": false, "score": 0, "creation_date": 1531900771, "post_id": 51396485, "comment_id": 89764203, "body": "This is assembly code, not machine code. The former is possible, the latter not so much."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 2, "creation_date": 1531902604, "post_id": 51396485, "comment_id": 89765281, "body": "What do you mean &quot;don&#39;t <code>p[0] = xx; p[1] = xx; p[n] = xx ...</code>&quot;?  That is how you write it in C, but with <code>0x30303030</code> instead of <code>h</code> suffix.  Some compilers would optimize the <code>memcpy</code> to immediate stores instead of an actual copy, especially if alignment was unknown or SSE was disabled.  Are you asking how to write C that will compile to that asm?  That depends entirely on your compiler.  C as a language doesn&#39;t distinguish between immediate vs. rdata, so from an abstract language perspective the question makes no sense."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1531902683, "post_id": 51396485, "comment_id": 89765321, "body": "<code>memcpy</code> from const data may actually turn into that expected machine code I guess... And what&#39;s wrong about <code>p[0]=xx;</code>, that&#39;s probably most straightforward asm-to-C &quot;translation&quot; of that code, which has highest chance to end being compiled back into similar machine code. (Ninjaed by Peter Cordes, who is even more accurate and better telling what I had on mind :) )"}], "answers": [{"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 4, "last_activity_date": 1531904964, "last_edit_date": 1531904964, "creation_date": 1531900888, "answer_id": 51396639, "question_id": 51396485, "link": "https://stackoverflow.com/questions/51396485/how-do-write-c-c-code-that-equal-this-assembly-code/51396639#51396639", "title": "how do write c/c++ code that equal this assembly code?", "body": "<blockquote>\n  <p>how do write c/c++ code that equal this machine code?</p>\n</blockquote>\n\n<p><strong>In general, you cannot.</strong></p>\n\n<p>The <a href=\"https://en.wikipedia.org/wiki/Semantics_(computer_science)\" rel=\"nofollow noreferrer\">semantics</a> of C++11 (or of C11), as defined by their respective standard (<a href=\"http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf\" rel=\"nofollow noreferrer\">n3337</a> for C++11, <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a> for C11) is of higher level than that of the x86-64 machine code (or assembler). You could ask for C++ (or C) code whose <em>observable behavior</em> is similar to the one of your assembler code (but that is a different question).</p>\n\n<p>Be aware of possible <a href=\"https://en.wikipedia.org/wiki/Optimizing_compiler\" rel=\"nofollow noreferrer\">compiler optimizations</a>, of <a href=\"https://en.wikipedia.org/wiki/Sequence_point\" rel=\"nofollow noreferrer\">sequence points</a>, of <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a>, of <a href=\"https://en.wikipedia.org/wiki/Decompiler\" rel=\"nofollow noreferrer\">decompilers</a> (they address an <a href=\"https://en.wikipedia.org/wiki/Computational_complexity_theory\" rel=\"nofollow noreferrer\">intractable</a> or <a href=\"https://en.wikipedia.org/wiki/Undecidable_problem\" rel=\"nofollow noreferrer\">undecidable</a> problem, provable to be equivalent to the <a href=\"https://en.wikipedia.org/wiki/Halting_problem\" rel=\"nofollow noreferrer\">halting</a> problem), of <a href=\"https://en.wikipedia.org/wiki/Obfuscation_(software)\" rel=\"nofollow noreferrer\">code obfuscation</a>, and of the <a href=\"https://en.wikipedia.org/wiki/As-if_rule\" rel=\"nofollow noreferrer\">as-if rule</a>. Read also about <a href=\"https://en.wikipedia.org/wiki/Static_program_analysis\" rel=\"nofollow noreferrer\">static source code analysis</a>, <a href=\"https://en.wikipedia.org/wiki/Malware_analysis\" rel=\"nofollow noreferrer\">malware analysis</a> and <a href=\"https://en.wikipedia.org/wiki/Rice%27s_theorem\" rel=\"nofollow noreferrer\">Rice's theorem</a>.</p>\n\n<p>What you might ask (but that is a very different question) is how to make some particular compiler (the version and optimization details matter of course a big lot) generate a particular piece of code. In general there is no answer (except of course <code>asm</code> instructions, whose interpretation and semantics is not defined by the standard but by your particular compiler or C or C++ implementation).</p>\n\n<p>Be aware that a programming language is a specification, not a software.</p>\n\n<p>(so you are confused, and stricto sensu your question makes no sense so is unclear).</p>\n\n<p>Notice that your assembler code might have been generated with something else that the compiler you believe has been used. For example, a postprocessor might \"transform\" the assembler code before the linker (and still keep the original C or C++ semantics).</p>\n"}], "owner": {"reputation": 9, "user_id": 5623782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4816d672b3259adcb71c1abae519b31f?s=128&d=identicon&r=PG&f=1", "display_name": "Jayce", "link": "https://stackoverflow.com/users/5623782/jayce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1531904964, "creation_date": 1531900412, "last_edit_date": 1531901220, "question_id": 51396485, "link": "https://stackoverflow.com/questions/51396485/how-do-write-c-c-code-that-equal-this-assembly-code", "title": "how do write c/c++ code that equal this assembly code?", "body": "<p>MSVC, before c++11, /O1 or /O2</p>\n\n<p>like\nmemcpy(p, \"111112244551\", n);</p>\n\n<p>but \"111112244551\" is immediate value, not in 'rdata' section.</p>\n\n<p>assembly code:\neax point to a heap memory region, not stack memroy</p>\n\n<pre><code>    mov [eax+10h], 30303030h\n    mov [eax+14h], 31323334h\n    mov [eax+18h], 35353535h\n    mov [eax+1ch], 3334h\n</code></pre>\n\n<p>How do write c/c++ code? please</p>\n\n<p>don't:</p>\n\n<p>p[0] = xx; p[1] = xx; p[n] = xx ...</p>\n\n<p>-</p>\n\n<p>-</p>\n\n<p>Additional(from IDA):</p>\n\n<pre><code>    mov     dword ptr [eax+10h], 41424344h\n    mov     dword ptr [eax+14h], 45464748h\n    mov     word ptr [eax+18h], 65h\n</code></pre>\n\n<p>I want c/c++ code.</p>\n"}, {"tags": ["c", "multithreading", "memory-management", "memory-leaks", "lock-free"], "comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531902862, "post_id": 51396364, "comment_id": 89765439, "body": "A circular buffer (fixed-size array) is the usual solution for a queue.  Garbage-collection actually makes a node-based linked list queue a lot easier by solving the deallocation problem."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1531903355, "post_id": 51396364, "comment_id": 89765770, "body": "BTW, you should probably be using C11 <code>stdatomic</code> instead of non-atomic variables with GNU C&#39;s <a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fsync-Builtins.html\" rel=\"nofollow noreferrer\">old (and not recommended anymore) <code>__sync_bool_compare_and_swap</code> builtin</a>.    <code>first = q-&gt;head;</code> ... stuff ... <code>if (first == q-&gt;head)</code> can CSE the two reads of <code>q-&gt;head</code> because it&#39;s not atomic (or <code>volatile</code>, but seriously just use <code>_Atomic</code> members in your struct.  stdatomic acquire loads would solve that.  C11 CAS gives you the current value of the memory location as well as a bool result, so you don&#39;t have to re-read it in the loop"}, {"owner": {"reputation": 158, "user_id": 6607383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5050b1917d29f6c57dc02789aeda43d?s=128&d=identicon&r=PG&f=1", "display_name": "p0wl", "link": "https://stackoverflow.com/users/6607383/p0wl"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531903377, "post_id": 51396364, "comment_id": 89765784, "body": "Thanks! I will rewrite the CAS instructions and so on. I also implemented an array-based solution but I&#39;m interested in an answer to this problem out of curiosity."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531914443, "post_id": 51396364, "comment_id": 89773049, "body": "Related: <a href=\"https://stackoverflow.com/q/50803497\">Lock Free stack implementation idea - currently broken</a> is about a node-based <i>stack</i> (very similar to queue), but BeeOnRope&#39;s answer about the memory reclamation problem is probably relevant to you, too."}], "answers": [{"tags": [], "owner": {"reputation": 158, "user_id": 6607383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5050b1917d29f6c57dc02789aeda43d?s=128&d=identicon&r=PG&f=1", "display_name": "p0wl", "link": "https://stackoverflow.com/users/6607383/p0wl"}, "is_accepted": true, "score": 1, "last_activity_date": 1531982967, "last_edit_date": 1592644375, "creation_date": 1531982967, "answer_id": 51416091, "question_id": 51396364, "link": "https://stackoverflow.com/questions/51396364/c-lock-free-queue-memory-management/51416091#51416091", "title": "C Lock-Free Queue Memory Management", "body": "<p>As <a href=\"https://stackoverflow.com/users/224132/peter-cordes\">Peter Cordes</a> pointed out in his comment, I just found the Memory reclamation problem:</p>\n<blockquote>\n<p>In contrast, memory reclamation is one of the most challenging aspects of lock-free data structure design. Lock-free algorithms (also called non-blocking algorithms) guarantee that as long as some process continues to take steps, eventually some process will complete an operation. The main difficulty in performing memory reclamation for a lock-free data structure is that a process can be sleeping while holding a pointer to an object that is about to be freed. Thus, carelessly freeing an object can cause a sleeping process to access freed memory when it wakes up, crashing the program or producing subtle errors. Since nodes are not locked, processes must coordinate to let each other know which nodes are safe to reclaim, and which might still be accessed.</p>\n<p><em>Cited from &quot;Reclaiming Memory for Lock-Free Data Structures: There has to be a Better Way&quot; by Trevor Brown, Institute of Science and Technology, Austria</em></p>\n</blockquote>\n<p>A good answer (related to a stack but essentially the same) can be found <a href=\"https://stackoverflow.com/a/50805280/\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11138330, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d152355a9f4c72fb9d95d3376db4be30?s=128&d=identicon&r=PG", "display_name": "liblfds-admin", "link": "https://stackoverflow.com/users/11138330/liblfds-admin"}, "is_accepted": false, "score": 2, "last_activity_date": 1551482097, "creation_date": 1551482097, "answer_id": 54953584, "question_id": 51396364, "link": "https://stackoverflow.com/questions/51396364/c-lock-free-queue-memory-management/54953584#54953584", "title": "C Lock-Free Queue Memory Management", "body": "<p>This looks like the Michael and Scott queue.</p>\n\n<p>Nodes cannot be freed, I can't remember exactly why offhand (obviously because they could still be referenced - but exactly where and how I forget).  They can only be placed onto a freelist.</p>\n\n<p>I've not looked closely at your implementation for correctness, but I can see there are no memory barriers, which means the implementation is wrong.</p>\n\n<p>You need to discover and read up and understand memory barriers, and then use them.</p>\n\n<p>I have written a pair of articles which will get you started.</p>\n\n<p><a href=\"https://www.liblfds.org/mediawiki/index.php?title=Article:Memory_Barriers_%28part_1%29\" rel=\"nofollow noreferrer\">https://www.liblfds.org/mediawiki/index.php?title=Article:Memory_Barriers_%28part_1%29</a></p>\n\n<p><a href=\"https://www.liblfds.org/mediawiki/index.php?title=Article:Memory_Barriers_%28part_2%29\" rel=\"nofollow noreferrer\">https://www.liblfds.org/mediawiki/index.php?title=Article:Memory_Barriers_%28part_2%29</a></p>\n"}], "owner": {"reputation": 158, "user_id": 6607383, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5050b1917d29f6c57dc02789aeda43d?s=128&d=identicon&r=PG&f=1", "display_name": "p0wl", "link": "https://stackoverflow.com/users/6607383/p0wl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 51416091, "answer_count": 2, "score": 4, "last_activity_date": 1551482097, "creation_date": 1531899956, "question_id": 51396364, "link": "https://stackoverflow.com/questions/51396364/c-lock-free-queue-memory-management", "title": "C Lock-Free Queue Memory Management", "body": "<p>To improve my C skills, I implemented a thread-safe and lock-free queue. The algorithm is from chapter 10.5 of the book \"The Art of Multiprocessor Programming\" by Maurice Herlihy and Nir Shavit which is a great book by the way.</p>\n\n<p>So far, everything worked but I need help with the following problem:</p>\n\n<h2>Problem</h2>\n\n<p>The line <code>free(first)</code> is commented out in the <code>lfq_deq()</code> Method because it can cause a segfault if the queue is used by multiple dequeuers. If threads T1 and T2 are dequeueing and T1 frees the node while T2 still uses it, T2 will produce a segfault. </p>\n\n<p>What is an elegant way of freeing this memory? Since I don't reuse the nodes, I should not have the ABA problem, right? Or do you think, it is easier to reuse the nodes and implement a known solution for the ABA problem?</p>\n\n<h2>lfq.h</h2>\n\n<p>The header provides a simple main method for testing.</p>\n\n<pre><code>#pragma once\n#include &lt;stdlib.h&gt;\n\ntypedef struct Node {\n    void* data;\n    struct Node* next;\n} lfq_node_t;\n\ntypedef struct Queue {\n    lfq_node_t* head;\n    lfq_node_t* tail;\n} lfq_t;\n\nlfq_t* lfq_new();\nvoid lfq_free(lfq_t* q);\nvoid lfq_enq(lfq_t* q, void* data);\nvoid* lfq_deq(lfq_t* q);\n</code></pre>\n\n<h2>lfq.c</h2>\n\n<pre><code>#include \"lfq.h\"\n#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n\n#define CAS(a, b, c) __sync_bool_compare_and_swap(a, b, c)\n\nlfq_t* lfq_new() {\n    lfq_t* q = malloc(sizeof(*q));\n    lfq_node_t* sentinel = malloc(sizeof(*sentinel));\n    sentinel-&gt;data = sentinel-&gt;next = NULL;\n    q-&gt;head = q-&gt;tail = sentinel;\n\n    return q;\n}\n\nvoid lfq_free(lfq_t* q) {\n    lfq_node_t *next, *node = q-&gt;head;\n    while (node != NULL) {\n        next = node-&gt;next;\n        free(node);\n        node = next;\n    }\n    free(q);\n}\n\nvoid lfq_enq(lfq_t* q, void* data) {\n    lfq_node_t *node, *last, *next;\n\n    node = malloc(sizeof(*node));\n    node-&gt;data = data;\n    node-&gt;next = NULL;\n\n    while (1) {\n        last = q-&gt;tail;\n        next = last-&gt;next;\n        if (last == q-&gt;tail) {\n            if (next == NULL) {\n                if (CAS(&amp;(last-&gt;next), next, node)) {\n                    CAS(&amp;(q-&gt;tail), last, node);\n                    return;\n                }\n            } else {\n                CAS(&amp;(q-&gt;tail), last, next);\n            }\n        }\n    }\n}\n\nvoid* lfq_deq(lfq_t* q) {\n    lfq_node_t *first, *last, *next;\n    while (1) {\n        first = q-&gt;head;\n        last = q-&gt;tail;\n        next = first-&gt;next;\n\n        if (first == q-&gt;head) {\n            if (first == last) {\n                if (next == NULL) return NULL;\n                CAS(&amp;(q-&gt;tail), last, next);\n            } else {\n                void* data = first-&gt;next-&gt;data;\n                if (CAS(&amp;(q-&gt;head), first, next)) {\n                    // free(first);\n                    return data;\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<h2>main.c</h2>\n\n<p>A simple main method to test the queue:</p>\n\n<pre><code>#include \"lfq.h\"\n#include &lt;stdio.h&gt;\n\nint main() {\n    int values[] = {1, 2, 3, 4, 5};\n    lfq_t* q = lfq_new();\n    for (int i = 0; i &lt; 5; ++i) {\n        printf(\"ENQ %i\\n\", values[i]);\n        lfq_enq(q, &amp;values[i]);\n    }\n    for (int i = 0; i &lt; 5; ++i) printf(\"DEQ %i\\n\", *(int*)lfq_deq(q));\n    lfq_free(q);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "windows", "kernel", "disassembly", "irql"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531898757, "post_id": 51395838, "comment_id": 89763028, "body": "My guess is: Because the pointer to the stack is not guaranteed to be available on interrupts &gt; APC_LEVEL. I.e. when a device interrupt kicks in, there might be no stack set up automatically."}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531899007, "post_id": 51395838, "comment_id": 89763186, "body": "@Ctx: I might be going out on the limb here, but I don&#39;t think x86/64 CPU can get too far w/o a stack."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531899148, "post_id": 51395838, "comment_id": 89763267, "body": "@Ctx - current thread kernel stack always avaible of course - impossible run any code otherwise. and thread object itself always from notpaged pool - so formally we can call this api at any irql"}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531899229, "post_id": 51395838, "comment_id": 89763312, "body": "@RbMm: That&#39;s what I thought. Maybe a typo in the document. Btw, what&#39;s <code>gs:188h</code>? Is it <code>_ETHREAD</code> pointer?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531899280, "post_id": 51395838, "comment_id": 89763347, "body": "faster here can be mean that on dpc interrupt say thread can run on special dpc stack. different from it usual. as result return value of <code>IoGetInitialStack</code> lost sense. but formal we can call it"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531899280, "post_id": 51395838, "comment_id": 89763348, "body": "@RbMm Who sets up the stack when the interrupt handler for an asynchronous device interrupt is called?"}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531899375, "post_id": 51395838, "comment_id": 89763408, "body": "@Ctx: For 64-bit long mode the new stack pointer <code>RSP</code> is taken from the <code>TSS</code> when an interrupt/exception is invoked."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531899498, "post_id": 51395838, "comment_id": 89763475, "body": "@Ctx - hardware interrupt of course begin on current kernel stack (where saved return address, flags) etc. then interrupt handler can switch stack for example. dpc (software interrupt) can switch (or not) to special stack. see also related - <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-iogetstacklimits\" rel=\"nofollow noreferrer\"><code>IoGetStackLimits</code></a> - <i>In Windows Server 2003 Service Pack 1 (SP1) and later versions of Windows, callers of IoGetStackLimits can be running at any IRQL. For earlier operating systems, the caller must be running at IRQL &lt;= APC_LEVEL.</i>"}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531899745, "post_id": 51395838, "comment_id": 89763631, "body": "Yeah, <code>IoGetStackLimits</code> is OK to be called at any IRQL but the other one is not. Must be a typo. So @RbMm you&#39;re saying if the stack is switched by a DPC, then <code>IoGetInitialStack</code> will return the wrong result. If so, how would you recommend finding the current base of the stack in that case?"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531899947, "post_id": 51395838, "comment_id": 89763737, "body": "the <code>IoGetInitialStack</code> will return correct result for current thread always. at this api can be called at any irql. but what you plan do next with return value ? say when DPC executed - system switch stack on special DPC stack - as result you can wrong interpret result of <code>IoGetStackLimits</code>"}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531900104, "post_id": 51395838, "comment_id": 89763819, "body": "<a href=\"http://www.osronline.com/article.cfm?article=529\" rel=\"nofollow noreferrer\">osronline.com/article.cfm?article=529</a> or <a href=\"https://social.msdn.microsoft.com/Forums/en-US/ac41bbe8-39d4-4739-a009-7532d22b2cd4/dpc-stack-size-and-switch?forum=wdk\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}, {"owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1531900201, "post_id": 51395838, "comment_id": 89763876, "body": "@RbMm: I need to copy the &quot;used&quot; part of the stack &quot;above&quot; the <code>RSP</code> to be able to retrieve call stack functions later (from the passive level.) Or &quot;walk the stack.&quot; But I need to know how much memory to copy from the stack. The idea was to <code>memcpy</code> it from <code>RSP</code> until the base address of the stack that I get from <code>IoGetInitialStack</code>."}], "owner": {"reputation": 821, "user_id": 3170929, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/64f78bd85dff5fd4bf8911f9b0c91177?s=128&d=identicon&r=PG", "display_name": "MikeF", "link": "https://stackoverflow.com/users/3170929/mikef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531898709, "creation_date": 1531898297, "last_edit_date": 1531898709, "question_id": 51395838, "link": "https://stackoverflow.com/questions/51395838/why-is-iogetinitialstack-function-limited-to-irql-apc-level", "title": "Why is IoGetInitialStack function limited to IRQL&lt;=APC_LEVEL?", "body": "<p>I'm trying to find the top (or base) of the stack in my callback function that is used in the Windows kernel. I thought to use <code>IoGetInitialStack</code> function for that, but unfortunately <a href=\"https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/content/wdm/nf-wdm-iogetinitialstack\" rel=\"nofollow noreferrer\">it's documentation</a> states:</p>\n\n<blockquote>\n  <p>IRQL  \"&lt;=APC_LEVEL\"</p>\n</blockquote>\n\n<p>I looked into it with a disassembler and all it seems to be doing in my copy of <code>ntoskrnl</code> is this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/SqY3V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SqY3V.png\" alt=\"enter image description here\"></a></p>\n\n<p>Why are they limiting it to <code>IRQL&lt;=APC_LEVEL</code>?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 5951, "user_id": 2361308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/99484dc9d142352778e01ac0c4948c1d?s=128&d=identicon&r=PG", "display_name": "Hearen", "link": "https://stackoverflow.com/users/2361308/hearen"}, "edited": false, "score": 0, "creation_date": 1531894445, "post_id": 51394652, "comment_id": 89760689, "body": "Welcome to StackOverflow. Please take some time to read the help pages <a href=\"https://stackoverflow.com/help/how-to-ask\">how to ask good questions</a>. Lastly please learn <a href=\"https://stackoverflow.com/help/mcve\">how to create a Minimal, Complete, and Verifiable Example</a> if it&#39;s possible."}, {"owner": {"reputation": 1447, "user_id": 6771046, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K59fa.png?s=128&g=1", "display_name": "U880D", "link": "https://stackoverflow.com/users/6771046/u880d"}, "edited": false, "score": 0, "creation_date": 1532433680, "post_id": 51394652, "comment_id": 89963951, "body": "In the past there was a somehow similiar question on the <a href=\"http://cmucam.org/boards/9/topics/7528\" rel=\"nofollow noreferrer\">CMUcam board</a>, referencing the <a href=\"http://cmucam.org/documents/36\" rel=\"nofollow noreferrer\">protocol used</a>. This might answer your question unless you are interested in <a href=\"https://stackoverflow.com/questions/tagged/i2c\">I2C programming</a> in more general."}], "owner": {"reputation": 11, "user_id": 10097541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7279b9dc407c385145de505beb615522?s=128&d=identicon&r=PG&f=1", "display_name": "Vishnu Satheesh", "link": "https://stackoverflow.com/users/10097541/vishnu-satheesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1531893952, "creation_date": 1531893952, "question_id": 51394652, "link": "https://stackoverflow.com/questions/51394652/how-to-access-pixy-cam5-data-using-i2c", "title": "How to access Pixy Cam5 data using I2C", "body": "<p>Curently I am working in EtherCAT protocol using TI AM437x IDK board. I need to interface a PIXY Camera to identify object. I tried using i2c but I am not getting output. \nCan anyone help me to do this interface. How to get details in Pixy board to my AM437x board using i2c</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531889635, "post_id": 51393780, "comment_id": 89759096, "body": "Are you asking about the basics of accessing a nested struct (i.e. how to use the <code>.</code> operator twice)? Or are you asking about how to initialise a variable of nested struct type?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531889816, "post_id": 51393780, "comment_id": 89759150, "body": "For the part about printin, please provide a code frame, i.e. a program which defines and initialises a variable of the type in question and a placeholder for printing it. Then show the desired output for the sample data. That will help to clarify what exactly you are stuck at."}], "answers": [{"tags": [], "owner": {"reputation": 3002, "user_id": 4228131, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RyKUe.jpg?s=128&g=1", "display_name": "WedaPashi", "link": "https://stackoverflow.com/users/4228131/wedapashi"}, "is_accepted": false, "score": 1, "last_activity_date": 1531893712, "last_edit_date": 1531893712, "creation_date": 1531892943, "answer_id": 51394402, "question_id": 51393780, "link": "https://stackoverflow.com/questions/51393780/how-to-deal-with-filling-a-structure-in-c-language/51394402#51394402", "title": "How to deal with filling a structure in c language", "body": "<blockquote>\n  <p>how to call and store information into structures</p>\n</blockquote>\n\n<p>You don't <em>call</em> structure. You <em>access</em> it. I understand (as I assume) that you are a beginner in C and its alright to use wrong terms initially, but going ahead you need to know some stuff so that you can at least explain your problems :-)</p>\n\n<pre><code>typedef struct {\n    char ticker[10];\n    double price;\n} StockPrice;\n\ntypedef struct {\n    char ticker[10];\n    double shares;\n} Stock;\n\ntypedef struct {\n    Stock myStocks[MAX_MY_STOCKS]; // MAX_MY_STOCKS is five.\n    double balance;\n} Portfolio;\n</code></pre>\n\n<p>First thing you'll need is an object of the type <code>Portfolio</code>.</p>\n\n<pre><code>Portfolio myPortfolio;\n</code></pre>\n\n<p>Now you have an object of the structure.\nTo <em>access</em> (Read and Write) structure members, you can use <code>.</code> operator.</p>\n\n<p>So,</p>\n\n<pre><code>myPortfolio.balance = 12.35;\n</code></pre>\n\n<p>Will set the value of <code>balance</code> to <code>12.35</code>.\nSimilarly, if you want to set the value of <code>shares</code> in 3<sup>rd</sup> index of <code>myStock</code>, you can do this:</p>\n\n<pre><code>myPortfolio.myStock[3].shared = 111.222;\n</code></pre>\n\n<p>To start with, you'll need to understand how to and when to use the <code>.</code> and <code>-&gt;</code> operators. \nC11 standard has ample information on it. Although in the beginning referring to standard can be very confusing as one may not be well-versed with the terms, but it does help.<br>\nRead through section <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.2.3\" rel=\"nofollow noreferrer\">stucture and union members</a> to see what C standard states.</p>\n\n<p>So, a bad code to write and read those values:</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n\n#define MAX_MY_STOCKS   5\n\ntypedef struct {\n    char ticker[10];\n    double price;\n} StockPrice;\n\ntypedef struct {\n    char ticker[10];\n    double shares;\n} Stock;\n\ntypedef struct {\n    Stock myStocks[MAX_MY_STOCKS]; // MAX_MY_STOCKS is five.\n    double balance;\n} Portfolio;\n\nPortfolio myPortfolio;\n\nvoid PrintPortfolio(unsigned int Index)\n{\n    int i = 0;\n    if(Index &gt;= MAX_MY_STOCKS)\n    {\n        printf(\"\\n\\n\\nStock overflow :D\");\n        return;\n    }\n\n    printf(\"\\n\\n\\n\");    \n\n    for (i = 0; i &lt; 10; i++)\n    {\n        printf(\"\\nticker %d in myStock[%d] is %X\", i, Index, myPortfolio.myStocks[Index].ticker[i]);    \n    }\n\n    printf(\"\\nshares in myStock[%d] is %lf\", Index, myPortfolio.myStocks[Index].shares);\n}\n\nint main(void) \n{\n    myPortfolio.balance = 12.34;\n    myPortfolio.myStocks[3].shares = 111.222;\n\n    printf(\"My portfolio balance is %lf\", myPortfolio.balance);\n\n    for(int i = 0; i &lt; (MAX_MY_STOCKS+1); i++)   // The deliberate extra iteration, a bit of a pun! :D\n    {\n        PrintPortfolio(i);\n    }\n\n    printf(\"\\n\\n\\n Lets use a pointer!\");\n    Portfolio *pmyPortfolio;\n    pmyPortfolio = &amp;myPortfolio;\n    printf(\"\\n\\nMy portfolio balance is %lf\", pmyPortfolio-&gt;balance);\n    return 0;\n}\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 10095982, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CeanpF9OH9c/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pUV_At-0q4vax28WEZEC8L_9Kf5w/mo/photo.jpg?sz=128", "display_name": "Jonah Simon", "link": "https://stackoverflow.com/users/10095982/jonah-simon"}, "is_accepted": false, "score": 1, "last_activity_date": 1531894414, "creation_date": 1531894414, "answer_id": 51394741, "question_id": 51393780, "link": "https://stackoverflow.com/questions/51393780/how-to-deal-with-filling-a-structure-in-c-language/51394741#51394741", "title": "How to deal with filling a structure in c language", "body": "<p>Since WedaPashi didn't cover Initializing with values I'll briefly explain. Once you declare a struct</p>\n\n<pre><code>StockPrice sp;\n</code></pre>\n\n<p>Then there is now a section of memory for all the variables in that struct. Right now all those variables have 'garbage values' meaning they could be any possible value and we can't reliably know what. As mentioned in his answer you can access the values with '.' in order to assign a value to them such as</p>\n\n<pre><code>sp.price = 12.35;\n</code></pre>\n\n<p>you can initialize arrays in the same way so we could say </p>\n\n<pre><code>sp.ticker = {'t','i','c','k','e','r','V','A','L'};\n</code></pre>\n\n<p>or in the special case of char arrays we can simply say</p>\n\n<pre><code>sp.ticker = \"tickerVal\";\n</code></pre>\n\n<p>or alternatively you can initialize all values in the struct at once such as </p>\n\n<pre><code>StockPrice sp = {\"tickerVal\", 99.35};\n</code></pre>\n\n<p>at this point sp.price is equal to 99.35, and ticker contains the string \"tickerVal\".\nIts important to note that once at least one variable has its value set in the struct then all other variables that haven't had a value assigned get a defualt value. In other words once you set at least one variable then there won't be any more 'garbage values.'</p>\n\n<p>If we want to throw this all together just to give you an idea of more complex initilizations we can say something like this:</p>\n\n<pre><code>Portfolio p = { \n    /*first value is an array initialization of stocks*/\n    {\n        {\"ticker0\\0\",0.0},     /*stock structs*/\n        {\"ticker1\\0\",1.0},     /*stock structs*/\n        {\"ticker2\\0\",2.0},     /*stock structs*/\n        {\"ticker3\\0\",3.0},     /*stock structs*/\n        {\"ticker4\\0\",4.0},     /*stock structs*/\n        {\"ticker5\\0\",5.0},     /*stock structs*/\n        {\"ticker6\\0\",6.0},     /*stock structs*/\n        {\"ticker7\\0\",7.0},     /*stock structs*/\n        {\"ticker8\\0\",8.0},     /*stock structs*/\n        {\"ticker9\\0\",9.0}      /*stock structs*/\n    },/*end of array of Stock*/\n    /*second value is double balance*/\n    100.99\n};\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 89, "user_id": 7715071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87129542ce2b44b57c1b1b45f90615cf?s=128&d=identicon&r=PG&f=1", "display_name": "BobTheBuilder", "link": "https://stackoverflow.com/users/7715071/bobthebuilder"}, "is_accepted": false, "score": 1, "last_activity_date": 1531894430, "creation_date": 1531894430, "answer_id": 51394745, "question_id": 51393780, "link": "https://stackoverflow.com/questions/51393780/how-to-deal-with-filling-a-structure-in-c-language/51394745#51394745", "title": "How to deal with filling a structure in c language", "body": "<pre><code>  #include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void) {\n    // filling by initialisation in source code:\n    Stock a = { .ticker = \"Whatever\" // caution: You only have *nine* characters;\n              , .shares = 0.0                 // you need the string terminator...\n              };\n    printf(\"Stock a has ticker %s and shares %f\\n\", a.ticker, a.shares);\n\n    // classic reassignment:\n    // you don't want to know...\n\n    // classic reassignment v1.5:\n    snprintf(a.ticker, sizeof a.ticker, \"%s\", \"Meh\");\n    a.shares = 42.0;\n\n    // reassignment v2:\n    a = (Stock){ \"under ten\", -1. }; // as in \"under ten\" characters long!\n\n    // reassignment v2.5\n    a = (Stock){ .shares = 9001.\n               , .ticker = \"to the moon\" // Zap! Nine characters or less, remember?!\n               };\n\n    // read from console:\n    while (scanf(\"%9[^ ] %lf\", a.ticker, &amp;a.shares) == 2) {\n        printf(\"You entered the ticker: { %9s, %lf }\\n\", a.ticker, a.shares);\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10097262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23b0d1fe34ba88837728950a709595c?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Bird", "link": "https://stackoverflow.com/users/10097262/carl-bird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "closed_date": 1531896748, "answer_count": 3, "score": -4, "last_activity_date": 1531894430, "creation_date": 1531889447, "question_id": 51393780, "link": "https://stackoverflow.com/questions/51393780/how-to-deal-with-filling-a-structure-in-c-language", "closed_reason": "Needs more focus", "title": "How to deal with filling a structure in c language", "body": "<p>I am having problems understanding how to call and store information into structures.</p>\n\n<pre><code>typedef struct {\n    char ticker[10];\n    double price;\n} StockPrice;\n\ntypedef struct {\n    char ticker[10];\n    double shares;\n} Stock;\n\n\ntypedef struct {\n    Stock myStocks[MAX_MY_STOCKS]; // MAX_MY_STOCKS is five.\n    double balance;\n} Portfolio;\n</code></pre>\n\n<p>I don't know exactly how to word it but i'm dealing with a structure that has another type of struct in it and would like to know how to fill and print out the structure when writing in C language. </p>\n"}, {"tags": ["c++", "c", "pointers"], "comments": [{"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "edited": false, "score": 1, "creation_date": 1531889550, "post_id": 51393777, "comment_id": 89759072, "body": "This has nothing to do with C++, so please don&#39;t use the C++ tag."}, {"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 3, "creation_date": 1531889629, "post_id": 51393777, "comment_id": 89759092, "body": "...unless you do C++, then don&#39;t use the C tag. Please read a tag&#39;s description before applying it!"}], "answers": [{"tags": [], "owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "is_accepted": false, "score": 3, "last_activity_date": 1531889702, "creation_date": 1531889702, "answer_id": 51393822, "question_id": 51393777, "link": "https://stackoverflow.com/questions/51393777/how-to-increment-character-pointer/51393822#51393822", "title": "How to increment character pointer?", "body": "<p><code>str</code> is not a pointer but an array. In many cases, the array decays to a pointer to its first element, but that doesn't make it a pointer itself.</p>\n"}, {"comments": [{"owner": {"reputation": 463, "user_id": 6337519, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/1CiVF.jpg?s=128&g=1", "display_name": "joH1", "link": "https://stackoverflow.com/users/6337519/joh1"}, "edited": false, "score": 0, "creation_date": 1532168258, "post_id": 51393829, "comment_id": 89879432, "body": "First of all, <code>sizeof()</code> is the syntax for a type (e.g. <code>sizeof(int)</code>) there are no parens when the parameter is an expression: <code>sizeof str</code> in your case is the appropriate syntax, although what you wrote compiles and runs as expected.  I&#39;d also like to add that this only works when <code>str</code> is a char array in the current scope. If it is passed to a function, it will decay to a pointer and <code>sizeof str</code> will be equivalent to <code>sizeof(char*)</code>..."}], "tags": [], "owner": {"reputation": 79, "user_id": 9626187, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "alhinai-hamed", "link": "https://stackoverflow.com/users/9626187/alhinai-hamed"}, "is_accepted": false, "score": -1, "last_activity_date": 1531917309, "last_edit_date": 1531917309, "creation_date": 1531889734, "answer_id": 51393829, "question_id": 51393777, "link": "https://stackoverflow.com/questions/51393777/how-to-increment-character-pointer/51393829#51393829", "title": "How to increment character pointer?", "body": "<p>You can simply use it as an array</p>\n\n<pre><code>int i;\nfor (i=0; i&lt;sizeof(str); i++)\n{\n        printf(\"%c\", str[i]);\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 2, "creation_date": 1531889859, "post_id": 51393834, "comment_id": 89759167, "body": "<code>for (char* ptr = str; *ptr != 0; ++ptr)</code> -- much clearer IMHO, also doesn&#39;t leak <code>ptr</code> into the surrounding scope."}, {"owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "reply_to_user": {"reputation": 15260, "user_id": 1968182, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/E5nF2.jpg?s=128&g=1", "display_name": "Ulrich Eckhardt", "link": "https://stackoverflow.com/users/1968182/ulrich-eckhardt"}, "edited": false, "score": 0, "creation_date": 1531889984, "post_id": 51393834, "comment_id": 89759203, "body": "@UlrichEckhardt Good idea, I just didn&#39;t want to change the code too much. I&#39;ll add that in."}], "tags": [], "owner": {"reputation": 4562, "user_id": 9254539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b45538511384660bfaef5092e30b7ea?s=128&d=identicon&r=PG&f=1", "display_name": "BessieTheCookie", "link": "https://stackoverflow.com/users/9254539/bessiethecookie"}, "is_accepted": true, "score": 2, "last_activity_date": 1531890162, "last_edit_date": 1531890162, "creation_date": 1531889751, "answer_id": 51393834, "question_id": 51393777, "link": "https://stackoverflow.com/questions/51393777/how-to-increment-character-pointer/51393834#51393834", "title": "How to increment character pointer?", "body": "<p><code>str</code> is a 50 element char array, not a pointer. An array decays (gets converted into) to a pointer to the first element in most circumstances, but you can't modify the decayed pointer unless you do so with a copy of that pointer.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    char str[50];\n    char* ptr = str;\n    scanf(\"%s\", str);\n    while(*ptr != 0)\n    {\n        printf(\"%c\", *ptr);\n        ptr++;\n    }\n    return 0;\n}\n</code></pre>\n\n<p>As Ulrich Eckhardt pointed out, a better way to implement this is to use a for loop:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    char str[50];\n    scanf(\"%s\", str);\n    for(char* ptr = str; *ptr != 0; ++ptr)\n    {\n        printf(\"%c\", *ptr);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>It's more clear this way, and the scope of <code>ptr</code> is limited to the loop which is good because we don't need it later.</p>\n"}], "owner": {"reputation": 135, "user_id": 9814782, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rahul Ranjan", "link": "https://stackoverflow.com/users/9814782/rahul-ranjan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "closed_date": 1531889753, "accepted_answer_id": 51393834, "answer_count": 3, "score": 0, "last_activity_date": 1531917309, "creation_date": 1531889438, "last_edit_date": 1531890141, "question_id": 51393777, "link": "https://stackoverflow.com/questions/51393777/how-to-increment-character-pointer", "closed_reason": "Duplicate", "title": "How to increment character pointer?", "body": "<p>The code gives me the error: lvalue required as increment operand</p>\n\n<p>But if I increment <code>str</code> by 1 it must point to the next character in the string.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n\nint main()\n{\n    char str[50];\n    scanf(\"%s\", str);\n    while(*str != 0)\n    {\n        printf(\"%c\", *str);\n        str++;\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "pointers", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 1488, "user_id": 9820754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43863d8d809bc1e09e5d506d9e4b5935?s=128&d=identicon&r=PG&f=1", "display_name": "black_pearl", "link": "https://stackoverflow.com/users/9820754/black-pearl"}, "edited": false, "score": 0, "creation_date": 1531892047, "post_id": 51393379, "comment_id": 89759840, "body": "Your opinion is nice."}, {"owner": {"reputation": 1488, "user_id": 9820754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43863d8d809bc1e09e5d506d9e4b5935?s=128&d=identicon&r=PG&f=1", "display_name": "black_pearl", "link": "https://stackoverflow.com/users/9820754/black-pearl"}, "edited": false, "score": 0, "creation_date": 1534298238, "post_id": 51393379, "comment_id": 90656658, "body": "great, I have a similar question, do hope you can do me a favor , <a href=\"https://stackoverflow.com/questions/51851874/c-struct-construct-error-thread-1-exc-bad-access-code-1-address-0x0\" title=\"c struct construct error thread 1 exc bad access code 1 address 0x0\">stackoverflow.com/questions/51851874/&hellip;</a>"}], "tags": [], "owner": {"reputation": 525, "user_id": 8474071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df42baf2b66b6426f6f433228f378a87?s=128&d=identicon&r=PG&f=1", "display_name": "RayaneCTX", "link": "https://stackoverflow.com/users/8474071/rayanectx"}, "is_accepted": true, "score": 1, "last_activity_date": 1531886414, "creation_date": 1531886414, "answer_id": 51393379, "question_id": 51393248, "link": "https://stackoverflow.com/questions/51393248/pre-order-traversal-issue-in-c-thread-1-exc-bad-access-code-exc-i386-gpflt/51393379#51393379", "title": "Pre order traversal issue in C: Thread 1: EXC_BAD_ACCESS (code=EXC_I386_GPFLT", "body": "<p>You need to initialize dangling children to NULL before you access then:</p>\n\n<pre><code>TreeNode seven;\nseven.data = 7;\nseven.LeftChild = NULL;\nseven.RightChild = NULL;\n</code></pre>\n\n<p>Do this with all TreeNodes you create. It will minimize errors for you. The general method is to create a constructor function that initializes tree nodes when called:</p>\n\n<pre><code>TreeNode *constructor(int data) {\n    TreeNode *T = malloc(sizeof(TreeNode));\n    if (T == NULL) {\n        /* Error */\n    }\n    T -&gt; data = data;\n    T -&gt; LeftChild = NULL; T -&gt; RightChild = NULL;\n    return T;\n}\n</code></pre>\n\n<p>I would also suggest working with pointers to TreeNode rather than allocating them on stack because it makes working with recursion slightly less cumbersome (my opinion).</p>\n"}], "owner": {"reputation": 1488, "user_id": 9820754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43863d8d809bc1e09e5d506d9e4b5935?s=128&d=identicon&r=PG&f=1", "display_name": "black_pearl", "link": "https://stackoverflow.com/users/9820754/black-pearl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 51393379, "answer_count": 1, "score": 1, "last_activity_date": 1531886414, "creation_date": 1531885432, "question_id": 51393248, "link": "https://stackoverflow.com/questions/51393248/pre-order-traversal-issue-in-c-thread-1-exc-bad-access-code-exc-i386-gpflt", "title": "Pre order traversal issue in C: Thread 1: EXC_BAD_ACCESS (code=EXC_I386_GPFLT", "body": "<p>I am learning C and data structure. Pre order traversal ,exactly.</p>\n\n<pre><code>typedef struct TreeNode{\n    int data;\n    struct TreeNode * leftChild, * rightChild;\n}TreeNode ;\n\nvoid pre_order_traversal(TreeNode *node){\n    if(node != NULL){\n        printf(\"%d\", node-&gt;data);\n        pre_order_traversal(node-&gt;leftChild);\n        pre_order_traversal(node-&gt;rightChild);\n    }\n}\n\nvoid node_example(void){\n    struct TreeNode zero, one , five, seven , eight , nine;\n    zero.data = 0;\n    one.data = 1;\n    five.data = 5;\n    seven.data = 7;\n    eight.data = 8;\n    nine.data = 9;\n\n    seven.leftChild = &amp;one;\n    seven.rightChild = &amp;nine;\n\n    one.leftChild = &amp;zero;\n    one.rightChild = &amp;five;\n\n    nine.leftChild = &amp;eight;\n\n    pre_order_traversal(&amp;seven);\n}\n</code></pre>\n\n<p>Here is the issue:</p>\n\n<blockquote>\n  <p>Thread 1: EXC_BAD_ACCESS (code=EXC_I386_GPFLT</p>\n</blockquote>\n\n<p>When executed in <code>printf(\"%d\", node-&gt;data);</code></p>\n\n<p>I am not good at C pointer, either recursion in C. </p>\n\n<p>I am not quite sure where the problem is.</p>\n\n<p>Of course I googled, the code online I have found is too complicated for me. And I still try to understand it .</p>\n\n<p>Any tip is quite welcomed.</p>\n\n<p>Proper explanation is more than expected.</p>\n"}, {"tags": ["c", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 1, "creation_date": 1531883678, "post_id": 51393035, "comment_id": 89757835, "body": "It depends on the OS, version, the socket type, and state of the socket (data pending, etc.) In general the kernel won&#39;t let anything &quot;bad&quot; happen, but I&#39;m pretty sure the results are indeterminate. You should probably post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 1, "creation_date": 1531898172, "post_id": 51393035, "comment_id": 89762679, "body": "<code>int val = receiveData(info, fd);</code> is invalid, since <code>receiveData()</code> returns void."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1532093412, "post_id": 51393325, "comment_id": 89857232, "body": "Even with just one socket and requests that must be answered (can be in parallel, even when packets are received sequentially) with some work to be done before the answer is ready."}], "tags": [], "owner": {"reputation": 100407, "user_id": 16406, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/fadf252892475e9b177d5cd5e8b24145?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Dodd", "link": "https://stackoverflow.com/users/16406/chris-dodd"}, "is_accepted": false, "score": 1, "last_activity_date": 1531885958, "creation_date": 1531885958, "answer_id": 51393325, "question_id": 51393035, "link": "https://stackoverflow.com/questions/51393035/concurrently-sending-packets/51393325#51393325", "title": "Concurrently sending packets", "body": "<p>When you have two separate sockets like this, they are independent -- the first thread will block until data is available on its socket, and the second will block until data is available on its socket.  If data arrives on one socket and not the other, then the thread blocked on the socket where data arrived will unblock (the <code>recv</code> will return) and loop until no more data is available.  If data arrives on both sockets, then both threads will continue and loop.</p>\n"}], "owner": {"reputation": 209, "user_id": 8498049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/026e998e24621716d72b732e8ae0587c?s=128&d=identicon&r=PG&f=1", "display_name": "skmiley1", "link": "https://stackoverflow.com/users/8498049/skmiley1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531926391, "creation_date": 1531883589, "last_edit_date": 1531926391, "question_id": 51393035, "link": "https://stackoverflow.com/questions/51393035/concurrently-sending-packets", "title": "Concurrently sending packets", "body": "<p>I am new to C, and want to understand how multithreading works with sockets. </p>\n\n<p>I understand how to create threads, but I do not understand how they work in this context.</p>\n\n<p>The two threads receive packets concurrently. \nWhen the first thread enters the receiveData function, and makes the recvmsg() call, will the second thread be blocked until the first thread receives the packet and exits the receiveData function?</p>\n\n<p>Is there some way to prevent additional threads from being blocked? </p>\n\n<pre><code>void * tcp (void * arg){\n    struct * info = arg;\n    // set up socket fd\n    fd = socket(AF_INET, SOCK_STREAM, 0);\n    while(True){\n        receiveData(info, fd);\n    }\n}\n\nvoid * icmp (void * arg){\n    struct * info = arg;\n    // set up socket fd\n    fd = socket(AF_INET, SOCK_RAW, IPPROTO_ICMP);\n    while(True){\n        receiveData(info, fd);\n    }\n}\n\n//function that is called by thread 1 and thread 2 concurrently\nvoid receiveData(struct * info, int fd){\n    int val = recv(fd, buf, 1000, 0);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 393, "user_id": 6145833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9ecbd610c03a6d78f960bcc933a313?s=128&d=identicon&r=PG&f=1", "display_name": "Amitoj Singh Ahuja", "link": "https://stackoverflow.com/users/6145833/amitoj-singh-ahuja"}, "edited": false, "score": 0, "creation_date": 1531882686, "post_id": 51392832, "comment_id": 89757612, "body": "please publish the code with which it  can be easily understandable as there is no statement to print simple_root and no definition of fab function"}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "reply_to_user": {"reputation": 393, "user_id": 6145833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de9ecbd610c03a6d78f960bcc933a313?s=128&d=identicon&r=PG&f=1", "display_name": "Amitoj Singh Ahuja", "link": "https://stackoverflow.com/users/6145833/amitoj-singh-ahuja"}, "edited": false, "score": 0, "creation_date": 1531882727, "post_id": 51392832, "comment_id": 89757620, "body": "@AmitojSingh, <code>fabs</code> is in the standard library."}], "answers": [{"tags": [], "owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1531882813, "creation_date": 1531882813, "answer_id": 51392943, "question_id": 51392832, "link": "https://stackoverflow.com/questions/51392832/c-making-an-equation-appears-only-once/51392943#51392943", "title": "C: Making an equation appears only once", "body": "<p>You are missing something in the comment </p>\n\n<blockquote>\n  <p>If putting the simple_root after the last else, there is a risk of error, e.g. the previous two conditions doesn't match</p>\n</blockquote>\n\n<p>This is already the case - if you don't match those two then <code>triple_root</code> and <code>simple_root</code> are already not set.  I'm not sure how they are used after this piece of code or what your error handling is.  You can either return immediately after the <code>printf</code> statement or set <code>triple_root</code> to be a <code>NaN</code>.</p>\n\n<p>Then you can move the simple_root equation below the <code>if</code> statement.  Alternatively you could put that in to a function.  A one line function is fine and can make the code easier to understand.</p>\n"}, {"tags": [], "owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "is_accepted": false, "score": 0, "last_activity_date": 1531922932, "last_edit_date": 1531922932, "creation_date": 1531884650, "answer_id": 51393165, "question_id": 51392832, "link": "https://stackoverflow.com/questions/51392832/c-making-an-equation-appears-only-once/51393165#51393165", "title": "C: Making an equation appears only once", "body": "<p>I think the following should do it. I haven't compiled it or tested it so you may need to tweak something.</p>\n\n<p>However your original formulation is much more readable and I really see no advantage to doing it this way.</p>\n\n<p>And with this approach you are always doing both of the <code>quartic_polynomial()</code> calls rather than sometimes only doing one which may be much worse computationally speaking so far as CPU usage and time than duplicating a line of code.</p>\n\n<p>I am curious if the two <code>if</code> statements could both be true. What are you to do in a case like that or can you just choose which ever you like?</p>\n\n<pre><code>{\n    int sec_1 = (fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_1) &lt; 1e-6);\n    int sec_2 = (fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_2) &lt; 1e-6);\n\n    if (! (sec_1 || sec_2)) {\n        printf(\"Something is wrong. No common root with its 2nd derivative. \\n\");\n    } else {\n        if (sec_1)\n            triple_root = secDerivRoot_1;\n        else\n            triple_root = secDerivRoot_2;\n        simple_root = -b/a - 3*triple_root;\n    } \n}\n</code></pre>\n\n<p>Another approach, if a desire to prevent one statement from being updated and the other not would be something like the following:</p>\n\n<pre><code>#define SIMPLE_ROOT_CALC  simple_root = -b/a - 3*triple_root\n\nif(fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_1)) &lt; 1e-6)\n{\n    triple_root = secDerivRoot_1;\n    SIMPLE_ROOT_CALC;\n}\nelse if (fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_2)) &lt; 1e-6)\n{\n    triple_root = secDerivRoot_2;\n    SIMPLE_ROOT_CALC;\n}       \nelse \n    printf(\"Something is wrong. No common root with its 2nd derivative. \\n\");\n</code></pre>\n\n<p>or even something like:</p>\n\n<pre><code>#define ROOT_CALC(x)  triple_root = (x); simple_root = -b/a - 3*triple_root;\n\nif(fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_1)) &lt; 1e-6)\n{\n    ROOT_CALC(secDerivRoot_1);\n}\nelse if (fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_2)) &lt; 1e-6)\n{\n    ROOT_CALC(secDerivRoot_2);\n}       \nelse \n    printf(\"Something is wrong. No common root with its 2nd derivative. \\n\");\n</code></pre>\n\n<p>or perhaps depend on evaluation short circuit with the logical Or operator:</p>\n\n<pre><code>{\n    double x;\n    if (! (((x = secDerivRoot_1), fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_1) &lt; 1e-6)) || ((x = secDerivRoot_2), fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_2) &lt; 1e-6) )) ) {\n        printf(\"Something is wrong. No common root with its 2nd derivative. \\n\");\n    } else {\n        triple_root = x;\n        simple_root = -b / a - 3 * triple_root;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 468, "user_id": 1487336, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/569545428cb39903e0d63a4e707bf4a8?s=128&d=identicon&r=PG", "display_name": "Lei Hao", "link": "https://stackoverflow.com/users/1487336/lei-hao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531923125, "creation_date": 1531881945, "last_edit_date": 1531923125, "question_id": 51392832, "link": "https://stackoverflow.com/questions/51392832/c-making-an-equation-appears-only-once", "title": "C: Making an equation appears only once", "body": "<p>I have following C code. The statement calculating <strong><em>simple_root</em></strong> appears twice. I am wondering if there is a better way to organise the code making the statement appear only once.</p>\n\n<p>If putting the <strong><em>simple_root</em></strong> after the last <strong><em>else</em></strong>, there is a risk of error, e.g. the previous two conditions doesn't match. Please correct me if I am wrong. </p>\n\n<pre><code>if(fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_1)) &lt; 1e-6)\n{\n    triple_root = secDerivRoot_1;\n    simple_root = -b/a - 3*triple_root;\n}\nelse if (fabs(quartic_polynomial(a, b, c, d, e, secDerivRoot_2)) &lt; 1e-6)\n{\n    triple_root = secDerivRoot_2;\n    simple_root = -b/a - 3*triple_root;\n}       \nelse \n    printf(\"Something is wrong. No common root with its 2nd derivative. \\n\");\n</code></pre>\n"}, {"tags": ["c", "printf", "system-calls", "memcpy"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1531887852, "post_id": 51392694, "comment_id": 89758657, "body": "The recommended idiom <code>T *p = malloc( sizeof *p );</code> would have avoided this error"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531891728, "post_id": 51392694, "comment_id": 89759729, "body": "<code>memcpy(wbuf, &amp;(stbuf-&gt;st_mode), sizeof(mode_t)); printf(&quot;(%3o)\\n&quot;, (*(mode_t*)((char*)wbuf))&amp;0777);</code> what is this?!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531891852, "post_id": 51392694, "comment_id": 89759778, "body": "That&#39;s not how you use <code>mode_t</code> - first of all, you don&#39;t even need to <i>copy</i> it anywhere, just use <code>stbuf-&gt;st_mode</code> as it were. Second: use the macros <a href=\"http://pubs.opengroup.org/onlinepubs/7908799/xsh/sysstat.h.html\" rel=\"nofollow noreferrer\">from <code>&lt;sys&#47;stat.h&gt;</code></a> to determine what the mode means"}, {"owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "edited": false, "score": 0, "creation_date": 1531896427, "post_id": 51392694, "comment_id": 89761602, "body": "If you can <i>binary and</i> <code>st_mode</code>, it&#39;s an integer, so you don&#39;t need to use <code>memcpy()</code> to copy its value. And allocating 256 bytes for <code>wbuf</code> is overkill, since it&#39;s an integer of type <code>mode_t</code> as you noted, so use <code>malloc(sizeof(mode_t))</code> would have been better. In this end, the code could be <code>mode_t *wbuf = malloc(sizeof(mode_t)); *wbuf = stbuf-&gt;st_mode;</code>"}, {"owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "edited": false, "score": 0, "creation_date": 1531896489, "post_id": 51392694, "comment_id": 89761624, "body": "Also note your <code>r1_getattr()</code> function leaks memory, remember to <code>free()</code> the buffers at some point"}, {"owner": {"reputation": 4747, "user_id": 611560, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/25ee461bdf2849f6db82054c73192ea1?s=128&d=identicon&r=PG", "display_name": "Yann Droneaud", "link": "https://stackoverflow.com/users/611560/yann-droneaud"}, "edited": false, "score": 0, "creation_date": 1531896505, "post_id": 51392694, "comment_id": 89761634, "body": "And there&#39;s no need to <code>malloc()</code> a buffer for <code>struct stat</code>, in <i>most</i> cases, it fit on stack."}], "answers": [{"tags": [], "owner": {"reputation": 525, "user_id": 8474071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df42baf2b66b6426f6f433228f378a87?s=128&d=identicon&r=PG&f=1", "display_name": "RayaneCTX", "link": "https://stackoverflow.com/users/8474071/rayanectx"}, "is_accepted": true, "score": 3, "last_activity_date": 1531884056, "creation_date": 1531884056, "answer_id": 51393100, "question_id": 51392694, "link": "https://stackoverflow.com/questions/51392694/memcpy-and-then-printf-calling-stat-writing-in-buffer/51393100#51393100", "title": "memcpy and then printf, calling stat(), writing in buffer;", "body": "<p>Simple typing error:</p>\n\n<p>Replace</p>\n\n<pre><code>struct stat *stbuf = malloc(sizeof(stat));\n</code></pre>\n\n<p>with</p>\n\n<pre><code>struct stat *stbuf = malloc(sizeof(struct stat));\n</code></pre>\n\n<p>Always funny to see the weird results we get when we use un-initialized memory :-)</p>\n"}], "owner": {"reputation": 129, "user_id": 5265507, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0rlIztzycXc/AAAAAAAAAAI/AAAAAAAAAKs/e7ajY5xdor4/photo.jpg?sz=128", "display_name": "Data Chanturia", "link": "https://stackoverflow.com/users/5265507/data-chanturia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "accepted_answer_id": 51393100, "answer_count": 1, "score": 2, "last_activity_date": 1531884056, "creation_date": 1531880781, "question_id": 51392694, "link": "https://stackoverflow.com/questions/51392694/memcpy-and-then-printf-calling-stat-writing-in-buffer", "title": "memcpy and then printf, calling stat(), writing in buffer;", "body": "<p>here are includes and my function:</p>\n\n<p>I'm trying to copy <code>stbuf-&gt;st_mode</code> in buffer with <code>memcpy</code> and when reading it back, value is not what I was trying to copy.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;string.h&gt;\n\nvoid r1_getattr(char* pth, int cfd){\n    struct stat* stbuf = malloc(sizeof(stat));\n\n    int res = stat(pth, stbuf);\n\n    printf(\"(%3o)\\n\", (stbuf-&gt;st_mode)&amp;0777);\n    char* wbuf = malloc(256);\n\n    memcpy(wbuf, &amp;(stbuf-&gt;st_mode), sizeof(mode_t));\n    printf(\"(%3o)\\n\", (*(mode_t*)((char*)wbuf))&amp;0777);\n}\n</code></pre>\n\n<p>outputs: \"(775)\" and \"( 21)\" shouldn't they be the same?</p>\n"}, {"tags": ["c"], "answers": [{"comments": [{"owner": {"reputation": 3625, "user_id": 249552, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kQlfx.png?s=128&g=1", "display_name": "jacob", "link": "https://stackoverflow.com/users/249552/jacob"}, "edited": false, "score": 0, "creation_date": 1531883614, "post_id": 51392751, "comment_id": 89757827, "body": "Unfortunately I have to have exact inputs or else this would work perfectly."}], "tags": [], "owner": {"reputation": 525, "user_id": 8474071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df42baf2b66b6426f6f433228f378a87?s=128&d=identicon&r=PG&f=1", "display_name": "RayaneCTX", "link": "https://stackoverflow.com/users/8474071/rayanectx"}, "is_accepted": false, "score": 0, "last_activity_date": 1531881262, "creation_date": 1531881262, "answer_id": 51392751, "question_id": 51392607, "link": "https://stackoverflow.com/questions/51392607/scanf-specific-error-condition-on-character-input/51392751#51392751", "title": "Scanf Specific Error Condition on Character Input", "body": "<p>A reasonably elegant solution is to require the user to append some specified character at the end of his/her input:</p>\n\n<pre><code>printf(\"Enter input followed by period: \");\nscanf(\"%lf %c %c\", &amp;number, &amp;units, &amp;period);\n</code></pre>\n\n<p>And just check that the second character is indeed a period. I realize this only works if units is too be only one character long.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 2, "creation_date": 1531889177, "post_id": 51393194, "comment_id": 89758956, "body": "You also have to check the return value of <code>scanf</code> here"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531914501, "post_id": 51393194, "comment_id": 89773094, "body": "Consider what happens with input <code>&quot;123\\n&quot;</code>.  <code>scanf(&quot;%ld %c%c&quot;</code> will wait for input of the next <i>line</i> as in <code>&quot;123\\nH\\n&quot;</code>.  Perhaps that case is acceptable or not to OP."}], "tags": [], "owner": {"reputation": 525, "user_id": 8474071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df42baf2b66b6426f6f433228f378a87?s=128&d=identicon&r=PG&f=1", "display_name": "RayaneCTX", "link": "https://stackoverflow.com/users/8474071/rayanectx"}, "is_accepted": false, "score": 1, "last_activity_date": 1531884936, "creation_date": 1531884936, "answer_id": 51393194, "question_id": 51392607, "link": "https://stackoverflow.com/questions/51392607/scanf-specific-error-condition-on-character-input/51393194#51393194", "title": "Scanf Specific Error Condition on Character Input", "body": "<p>Another possible solution for you:</p>\n\n<pre><code>scanf(\"%ld %c%c\", &amp;number, &amp;units, &amp;newline);\nif (newline != '\\n') {\n    /* ERROR */\n}\n</code></pre>\n\n<p>So essentially, you force the user to press enter after their input. Does that fit your needs?</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1531892034, "creation_date": 1531892034, "answer_id": 51394227, "question_id": 51392607, "link": "https://stackoverflow.com/questions/51392607/scanf-specific-error-condition-on-character-input/51394227#51394227", "title": "Scanf Specific Error Condition on Character Input", "body": "<blockquote>\n  <p>an elegant solution to catch the ability to enter more than 1 character.</p>\n</blockquote>\n\n<p>Read the <em>line</em> of user input with <code>fgets()</code></p>\n\n<pre><code>char buf[100];\nif (fgets(buf, sizeof buf, stdin) == NULL) {\n  Handle_EOF_or_Error();\n} else {\n</code></pre>\n\n<p>Then parse <code>buf</code> with <code>sscanf()</code> with appended <code>\" %n\"</code> to the format to record where scanning stopped - if scanning reached the end.</p>\n\n<pre><code>  int n = 0;\n  sscanf(buf \"%lf %c %n\", &amp;number, &amp;units, &amp;n);\n  if (n == 0 || buf[n]) {\n    Handle_Bad_Input(buf);\n  } else\n    // Now use `number` and `units`\n  }\n</code></pre>\n"}], "owner": {"reputation": 3625, "user_id": 249552, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/kQlfx.png?s=128&g=1", "display_name": "jacob", "link": "https://stackoverflow.com/users/249552/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 51394227, "answer_count": 3, "score": 1, "last_activity_date": 1531892034, "creation_date": 1531880060, "question_id": 51392607, "link": "https://stackoverflow.com/questions/51392607/scanf-specific-error-condition-on-character-input", "title": "Scanf Specific Error Condition on Character Input", "body": "<p>I'm having trouble reporting a specific error case when using scanf for my program.</p>\n\n<p>I need to support having an input of a decimal number, followed by a single character,</p>\n\n<pre><code>scanf(\"%lf %c\", &amp;number, &amp;units);\n</code></pre>\n\n<p>However, this will work for the case if someone enters <code>42Hello</code>, and <code>units</code> will be <code>H</code>, and <code>scanf</code> will return <code>2</code>.</p>\n\n<p>I however am looking for an elegant solution to catch the ability to enter more than 1 character.</p>\n\n<p>I've thought about accepting a string instead of a character and counting the length of the string, but I wonder if there's a better way to capture this error condition?</p>\n"}, {"tags": ["c", "function", "argv"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531877057, "post_id": 51392221, "comment_id": 89756364, "body": "&quot;the purpose of it is to take every digit past argc(5) and act as if it was a polynomial. however, it needs to take all input after argc(5) into account. it will then be passed the variable X i will calculate, but for simplicity&#39;s sake ill just assign it as 5.&quot;, don&#39;t make sense to me, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1531877150, "post_id": 51392221, "comment_id": 89756386, "body": "Open your favorite C book, when you are calling a function you need to pass all its argument, <code>calcX(argc, argv, x);</code>"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1531877263, "post_id": 51392221, "comment_id": 89756413, "body": "Try moving the function <code>calcX()</code> above <code>main()</code>.  That should change the error message you&#39;re getting, and provide more insight into what&#39;s wrong."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1531877267, "post_id": 51392221, "comment_id": 89756415, "body": "<code>calcX</code> must be declared before you call it. (Old versions of C were looser about this rule, but ignore that.) Add a declaration <code>void calcX(int argc, char*argv[], double x);</code> before <code>main</code>. Moving the entire definition of <code>calcX</code> above that of <code>main</code> would be another way to do that."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10096650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a925887616a928319b88a1e3b1b993?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Miller", "link": "https://stackoverflow.com/users/10096650/kevin-miller"}, "edited": false, "score": 0, "creation_date": 1531882432, "post_id": 51392281, "comment_id": 89757550, "body": "ill put that in in a moment, i forgot the easy way of putting the function before the main, so ill change the code up, ill get back in a bit. thanks so much!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 0, "last_activity_date": 1531877348, "creation_date": 1531877348, "answer_id": 51392281, "question_id": 51392221, "link": "https://stackoverflow.com/questions/51392221/im-having-trouble-getting-argc-and-argv-from-command-line-into-a-function-call/51392281#51392281", "title": "I&#39;m having trouble getting argc and argv from command line into a function call", "body": "<p>Two issues here.  First, <code>calcX</code> takes three arguments, but you're only passing one:</p>\n\n<pre><code>calcX(x);\n</code></pre>\n\n<p>You need to pass <code>argc</code> and <code>argv</code> as well:</p>\n\n<pre><code>calcX(argc, argv, x);\n</code></pre>\n\n<p>Second, you use the function <code>calcX</code> before you declare it, so the function is implicitly declared to take an unknown number of arguments and return an <code>int</code>.  This conflicts with the actual definition.</p>\n\n<p>To fix this, move the definition of <code>calcX</code> above <code>main</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 10096650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1a925887616a928319b88a1e3b1b993?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Miller", "link": "https://stackoverflow.com/users/10096650/kevin-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1531877348, "creation_date": 1531876918, "question_id": 51392221, "link": "https://stackoverflow.com/questions/51392221/im-having-trouble-getting-argc-and-argv-from-command-line-into-a-function-call", "title": "I&#39;m having trouble getting argc and argv from command line into a function call", "body": "<p>This is the first version of the code. the purpose of it is to take every digit past argc(5) and act as if it was a polynomial. however, it needs to take all input after argc(5) into account. it will then be passed the variable X i will calculate, but for simplicity's sake ill just assign it as 5. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(int argc, char* argv[])\n{\n\ndouble begin = atof (argv[1]); //start of graph\ndouble end = atof (argv[2]);  //end of graph\ndouble inc = atof (argv[3]); //level of incriments FIXME\ndouble low = atof (argv[4]); // lower section (what?)\ndouble high = atof (argv[5]); //higher section(what?)\n\n\n// need nested for loop use I total out of loop to get additive number.\n// NO NEGATIVE NECESSARY\ndouble sum=0;\ndouble x=5;\n\n\nprintf(\"argc :%d\\n\", argc);  //argc counts initialization character\ndouble j=argc-5-2;\nprintf(\"initial j %lf\\n\", j);\n\nfor (int i=6; i&lt;argc; i++)\n{\n        sum = sum + (atof(argv[i]) * pow(x,j));\n       j--;\n\n}\nprintf(\"%lf\\n\", sum);\n\n\n\nreturn 0;\n}\n</code></pre>\n\n<p>This is the second version of the code, where i put the calculation for x within the function cal calcX i only passed the variable x to the function, which i believe is the problem. what do i have to do so that all instances of argc and argv are passed to the function, as well as the variable x</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nint main(int argc, char* argv[])\n{\n\ndouble begin = atof (argv[1]); //start of graph\ndouble end = atof (argv[2]);  //end of graph\ndouble inc = atof (argv[3]); //level of incriments FIXME\ndouble low = atof (argv[4]); // lower section (what?)\ndouble high = atof (argv[5]); //higher section(what?)\n\ndouble width = (high-low) / inc;\ndouble x=5;\n\ncalcX(x);\n\n\nreturn 0;\n}\n\n\nvoid calcX(int argc, char*argv[], double x)\n{\ndouble sum=0;\ndouble j=argc-5-2;\nprintf(\"initial j %lf\\n\", j);\nfor (int i=6; i&lt;argc; i++)\n{\n        sum = sum + (atof(argv[i]) * pow(x,j));\n       j--;\n}\nprintf(\"%lf\\n\", sum);\n\n\n\nreturn;\n}\n</code></pre>\n\n<p>these are the errors the program gives me, looks pretty standard, but im not sure how to go about fixing it. thanks for your time.</p>\n\n<pre><code>$ gcc 2v.c\n2v.c: In function \u2018main\u2019:\n2v.c:17:1: warning: implicit declaration of function \u2018calcX\u2019 [-Wimplicit-function-declaration]\n calcX(x);\n ^~~~~\n2v.c: At top level:\n2v.c:24:6: warning: conflicting types for \u2018calcX\u2019\n void calcX(int argc, char*argv[], double x)\n      ^~~~~\n2v.c:17:1: note: previous implicit declaration of \u2018calcX\u2019 was here\n calcX(x);\n ^~~~~\n</code></pre>\n\n<p>also, if the formatting of my question was wrong please let me know what i can do to improve it</p>\n"}, {"tags": ["c", "visual-c++", "c99"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 6, "creation_date": 1531871755, "post_id": 51391689, "comment_id": 89755351, "body": "<code>__STDC_VERSION__</code> is spelled with one underscore in the middle, not two."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1531877483, "post_id": 51391689, "comment_id": 89756459, "body": "<code>__STDC_VERSION__</code> was not in the original 1989 C standard; if you&#39;re going to use it at all, you should check whether it is defined first (with <code>#ifdef</code>)."}, {"owner": {"reputation": 33, "user_id": 10096427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oda2o.jpg?s=128&g=1", "display_name": "Ahmed Hesham", "link": "https://stackoverflow.com/users/10096427/ahmed-hesham"}, "edited": false, "score": 0, "creation_date": 1531898214, "post_id": 51391689, "comment_id": 89762702, "body": "In my text book, <b>STDC__VERSION</b> is spelled with two underscores in the middle, and even for one underscore in the middle it does not work as well."}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1531903056, "post_id": 51391689, "comment_id": 89765574, "body": "@user2357112 That&#39;s not the issue.  MSVC doesn&#39;t support the macro.  It&#39;s reproducible and not a typographical error.  Please reconsider the &quot;on hold&quot;."}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1531914345, "post_id": 51391689, "comment_id": 89772987, "body": "@AhmedHesham That is an error in your textbook (probably a simple typo).  Textbooks are not infallible."}, {"owner": {"reputation": 33, "user_id": 10096427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oda2o.jpg?s=128&g=1", "display_name": "Ahmed Hesham", "link": "https://stackoverflow.com/users/10096427/ahmed-hesham"}, "edited": false, "score": 0, "creation_date": 1531924748, "post_id": 51391689, "comment_id": 89780519, "body": "Thank you all for your appreciated comments, please consider the &quot;on hold&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1531888727, "post_id": 51392504, "comment_id": 89758862, "body": "Visual C/C++ implements the C89 language standard plus the parts of C99/C11 C Runtime Library required for C++11/14/17 . For C++11/14/17 language conformance, see <a href=\"https://docs.microsoft.com/en-us/cpp/visual-cpp-language-conformance\" rel=\"nofollow noreferrer\">the Visual C++ documentation</a> as well as <a href=\"https://blogs.msdn.microsoft.com/vcblog/2018/04/09/msvc-now-correctly-reports-__cplusplus/\" rel=\"nofollow noreferrer\">this blog post</a>."}, {"owner": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1531889033, "post_id": 51392504, "comment_id": 89758921, "body": "If you read the comments in <a href=\"https://blogs.msdn.microsoft.com/vcblog/2018/07/06/msvc-preprocessor-progress-towards-conformance/\" rel=\"nofollow noreferrer\">this blog post</a>, you&#39;ll see that there are plans to support C11 in the Visual C/C++ product but the first step is to get a fully C99 conforming preprocessor which also is the last remaining part of C++11/C++14 conformance that is missing."}, {"owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "reply_to_user": {"reputation": 28528, "user_id": 3780494, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vqia1.jpg?s=128&g=1", "display_name": "Chuck Walbourn", "link": "https://stackoverflow.com/users/3780494/chuck-walbourn"}, "edited": false, "score": 0, "creation_date": 1531902360, "post_id": 51392504, "comment_id": 89765122, "body": "@ChuckWalbourn That is what I said, isn&#39;t it?  They support just the part of C they need for C++ to move on.  Thanks for the blog link, though.  I note that they don&#39;t say when to expect &quot;full C11 conformance&quot;.  It&#39;s just &quot;on the roadmap.&quot;  Not holding my breath."}, {"owner": {"reputation": 33, "user_id": 10096427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oda2o.jpg?s=128&g=1", "display_name": "Ahmed Hesham", "link": "https://stackoverflow.com/users/10096427/ahmed-hesham"}, "edited": false, "score": 0, "creation_date": 1531925042, "post_id": 51392504, "comment_id": 89780704, "body": "The comments helped clarifying the reason, thank you."}], "tags": [], "owner": {"reputation": 3531, "user_id": 1762193, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a75e9.jpg?s=128&g=1", "display_name": "Mike Housky", "link": "https://stackoverflow.com/users/1762193/mike-housky"}, "is_accepted": true, "score": 4, "last_activity_date": 1531879878, "last_edit_date": 1531879878, "creation_date": 1531879251, "answer_id": 51392504, "question_id": 51391689, "link": "https://stackoverflow.com/questions/51391689/why-is-the-predefined-macro-stdc-version-undefined/51392504#51392504", "title": "Why is the predefined macro __STDC_VERSION__ undefined?", "body": "<p>The only C standard that Visual C++ supports fully is the ANSI-89/ISO-90 first standard.  There is no official support for C99 or C11; but there is enough of C99 supported to make C++11 and C++14 work.</p>\n\n<p>What I use for source code portability is <code>#ifdef _MSC_VER</code> and expect only C89/C90 support if that's defined.  (If you need finer detail, you can test the value of _MSC_VER to see which version.  There's a <a href=\"https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B#Internal_version_numbering\" rel=\"nofollow noreferrer\">list of MSC/C++ versions and their _MSC_VER values</a> at Wikipedia.</p>\n\n<p>Obviously, that has to be tested before any of the C99 or C11 macros.  As a special note, if a Microsoft compiler defines <code>__STDC__</code> then you don't get even partial support for C99.  That macro is only defined when compiling with the <code>/Za</code> option, which disables any Microsoft extensions--including C++/C99 bits like <code>//</code> comments, mixed declarations and code in a block, or declarations in <code>for</code> statements. </p>\n"}], "owner": {"reputation": 33, "user_id": 10096427, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oda2o.jpg?s=128&g=1", "display_name": "Ahmed Hesham", "link": "https://stackoverflow.com/users/10096427/ahmed-hesham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2458, "favorite_count": 0, "closed_date": 1531892376, "accepted_answer_id": 51392504, "answer_count": 1, "score": 1, "last_activity_date": 1532020141, "creation_date": 1531871673, "last_edit_date": 1532020141, "question_id": 51391689, "link": "https://stackoverflow.com/questions/51391689/why-is-the-predefined-macro-stdc-version-undefined", "closed_reason": "Not suitable for this site", "title": "Why is the predefined macro __STDC_VERSION__ undefined?", "body": "<p>I want to know which C standard I am currently using in my Visual Studio C++, but I have a trouble using the <code>__STDC_VERSION__</code> predefined macro and other C99 predefined macros - an error indicating that this identifier is not defined appears and when I used <code>#ifndef __STDC_VERSION__</code> it seems that it is not defined. Does this mean that I am using ANSI C?</p>\n\n<p>Below is a sample code for using <code>__STDC_VERSION__</code>:</p>\n\n<pre><code>int main(void) {\n   printf(\"%d\\n\", __STDC_VERSION__);\n   return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "parallel-processing", "openmp"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 2, "creation_date": 1531867271, "post_id": 51390720, "comment_id": 89754361, "body": "Assuming a, b, c and d are independent of each other you can have 4 different threads, one for each variable running their own <code>for</code> loops"}], "answers": [{"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531893120, "post_id": 51394339, "comment_id": 89760161, "body": "yadhu, I think OP wants explicitly to use OpenMP (possibly because its design is on minimising necessary changes on existing code, I am only speculating). Using pthreads seems an appropriate way, but seems not to be what OP is asking for."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531893153, "post_id": 51394339, "comment_id": 89760176, "body": "Battu, please comment whether this is helpfully what you need."}, {"owner": {"reputation": 13, "user_id": 10096125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547dee27d807bf28f16b19747a563153?s=128&d=identicon&r=PG&f=1", "display_name": "Battu", "link": "https://stackoverflow.com/users/10096125/battu"}, "edited": false, "score": 0, "creation_date": 1531950335, "post_id": 51394339, "comment_id": 89794402, "body": "Thank you very much for your help. This is a valid solution with pthreads. However, I am working on a solution that is more platform independent. If OpenMP is supported, then we can accelerate this part. If not, we have to go in a serial way. Thank you very much!"}], "tags": [], "owner": {"reputation": 1033, "user_id": 3410010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zFRd3.jpg?s=128&g=1", "display_name": "yadhu", "link": "https://stackoverflow.com/users/3410010/yadhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1531892615, "creation_date": 1531892615, "answer_id": 51394339, "question_id": 51390720, "link": "https://stackoverflow.com/questions/51390720/openmp-parallelize-code-inside-a-for-loop/51394339#51394339", "title": "OpenMP Parallelize code inside a for loop", "body": "<p>This pretty straight forward, as @kbr mentioned in the comments each of the calculation a,b,c and d are independent, so you can separate them to different threads and pass the corresponding value as parameter. The sample code looks like this.</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include &lt;pthread.h&gt;\n\nvoid *thread_func(int *i)\n{\n    for (int j=0; j&lt;1000; j++)\n    {\n        //Instead of increment u can call whichever function you want here.\n        (*i)++;\n    }\n}\n\nint main()\n{\n    int a_old=1;\n    int b_old=1;\n    int c_old=1;\n    int d_old=1;\n    pthread_t thread[4];\n\n    pthread_create(&amp;thread[0],0,thread_func,&amp;a_old);\n    pthread_create(&amp;thread[1],0,thread_func,&amp;b_old);\n    pthread_create(&amp;thread[2],0,thread_func,&amp;c_old);\n    pthread_create(&amp;thread[3],0,thread_func,&amp;d_old);\n\n    pthread_join(&amp;thread[0],NULL);\n    pthread_join(&amp;thread[1],NULL);\n    pthread_join(&amp;thread[2],NULL);\n    pthread_join(&amp;thread[3],NULL);\n\n    printf(\"a_old %d\",a_old);\n    printf(\"b_old %d\",b_old);\n    printf(\"c_old %d\",c_old);\n    printf(\"d_old %d\",d_old);\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10096125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547dee27d807bf28f16b19747a563153?s=128&d=identicon&r=PG&f=1", "display_name": "Battu", "link": "https://stackoverflow.com/users/10096125/battu"}, "edited": false, "score": 0, "creation_date": 1531950503, "post_id": 51396650, "comment_id": 89794471, "body": "Thank you very much for your help. I tried your solution and gives me good results. The only problem that I see now is that <code>fun()</code> does not take so much time, thus for a small workload it may be an overkill. Thanks a lot!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 620382, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bf285996e4e7188feac84786a47d9f3a?s=128&d=identicon&r=PG", "display_name": "Zulan", "link": "https://stackoverflow.com/users/620382/zulan"}, "is_accepted": true, "score": 0, "last_activity_date": 1531901265, "last_edit_date": 1531901265, "creation_date": 1531900910, "answer_id": 51396650, "question_id": 51390720, "link": "https://stackoverflow.com/questions/51390720/openmp-parallelize-code-inside-a-for-loop/51396650#51396650", "title": "OpenMP Parallelize code inside a for loop", "body": "<p>Just <strong>don't</strong> parallelize the code inside the for loop - move the parallel region to the outside. This reduces the thread creation and worksharing overhead. Then you can easily apply OpenMP <code>sections</code>:</p>\n\n<pre><code>int a_old=1;\nint b_old=1;\nint c_old=1;\nint d_old=1;\n#pragma omp parallel sections\n{\n   #pragma omp section\n   for (int i=0; i&lt;1000; i++) {\n       a_new = fun(a_old);  //fun() depends only on the value of the argument\n       a_old = a_new;\n   }\n   #pragma omp section\n   for (int i=0; i&lt;1000; i++) {\n      b_new = fun(b_old);\n      b_old = b_new;\n   }\n   #pragma omp section\n   for (int i=0; i&lt;1000; i++) {\n      c_new = fun(c_old);\n      c_old = c_new;\n   }\n   #pragma omp section\n   for (int i=0; i&lt;1000; i++) {\n       d_new = fun(d_old);\n       d_old = d_new;\n   }\n}\n</code></pre>\n\n<p>There is also another simplification:</p>\n\n<pre><code>int value[4];\n#pragma omp parallel for\nfor (int abcd = 0; abcd &lt; 4; abcd++) {\n    for (int i=0; i&lt;1000; i++) {\n        value[abcd] = fun(value[abcd]);\n    }\n}\n</code></pre>\n\n<p>In either case, you might want to consider adding padding between the values to avoid false sharing if <code>fun</code> executes rather quickly.</p>\n"}], "owner": {"reputation": 13, "user_id": 10096125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/547dee27d807bf28f16b19747a563153?s=128&d=identicon&r=PG&f=1", "display_name": "Battu", "link": "https://stackoverflow.com/users/10096125/battu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 51396650, "answer_count": 2, "score": 1, "last_activity_date": 1531901265, "creation_date": 1531864417, "question_id": 51390720, "link": "https://stackoverflow.com/questions/51390720/openmp-parallelize-code-inside-a-for-loop", "title": "OpenMP Parallelize code inside a for loop", "body": "<p>I want to parallelize tasks inside a for loop using OpenMP. However, I do not want to use <code>#pragma omp parallel for</code> as the result of the (i+1)<sup>th</sup> iteration  depends on the output of the (i)<sup>th</sup> iteration. I have tried to spawn the threads inside the code, but the time of creating and destroying them every time is very high. An abstract description of my code is:</p>\n\n<pre><code>int a_old=1;\nint b_old=1;\nint c_old=1;\nint d_old=1;\nfor (int i=0; i&lt;1000; i++)\n{\n   a_new = fun(a_old);  //fun() depends only on the value of the argument\n   a_old = a_new;\n\n   b_new = fun(b_old);\n   b_old = b_new;\n\n   c_new = fun(c_old);\n   c_old = c_new;\n\n   d_new = fun(d_old);\n   d_old = d_new;\n}\n</code></pre>\n\n<p>How can I <em>efficiently</em> use threads to calculate the new values of <code>a_new, b_new, c_new, d_new</code> in parallel in each iteration ? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 1267, "user_id": 1598790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a11ea12f06eefbb34068f4c1090e2e0b?s=128&d=identicon&r=PG", "display_name": "ramrunner", "link": "https://stackoverflow.com/users/1598790/ramrunner"}, "edited": false, "score": 0, "creation_date": 1531861905, "post_id": 51390020, "comment_id": 89752624, "body": "can you please share the code that you have written until now as a self contained working example?"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 2, "creation_date": 1531862700, "post_id": 51390020, "comment_id": 89752929, "body": "This question is extremely vague.  You don&#39;t state how the program is supposed to know what button to push.  Does it have knowledge of the layout of the web page, or does it have to infer it by some analysis of the rendered image?"}, {"owner": {"reputation": 11, "user_id": 10095991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c422840ffe736f3a679c74fa1b891e5?s=128&d=identicon&r=PG&f=1", "display_name": "Reshma Shaik", "link": "https://stackoverflow.com/users/10095991/reshma-shaik"}, "edited": false, "score": 0, "creation_date": 1531863051, "post_id": 51390020, "comment_id": 89753052, "body": "Using the stdlib.h and the system(); function was able to open the web browser. I was not sure how I can script to click the buttons on the webpage. Do you think I can use the x-path of the button anyways? I didnt get proper idea to script that part. Help is appreciated. Thanks"}, {"owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 0, "creation_date": 1532351837, "post_id": 51390020, "comment_id": 89927936, "body": "You want to send mouse clicks or other input that normally comes from the user to an application. This is not part of the C language. It is dependent on the operating system and/or the window manager. You would need to specify what operating system you are using before more specific information could be given. Additionally, sending input to other applications may be subject to permissions controls, as applications should generally not be allowed to interfere with other applications."}], "answers": [{"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -1, "last_activity_date": 1531871289, "creation_date": 1531871289, "answer_id": 51391649, "question_id": 51390020, "link": "https://stackoverflow.com/questions/51390020/clicking-the-buttons-on-the-web-page-with-c/51391649#51391649", "title": "Clicking the buttons on the Web page with C", "body": "<p>To provide this functionality you need to write your own browser (or at least its engine). Forget the idea:)</p>\n\n<p>But you can  write the simple html parser to discover to buttons and simulate browser response to click. There are some html parsers written in C, for example: <a href=\"https://github.com/google/gumbo-parser\" rel=\"nofollow noreferrer\">https://github.com/google/gumbo-parser</a> You will also need the Javascript interpreter as often buttons are dynamically generated and serviced example : <a href=\"http://duktape.org/\" rel=\"nofollow noreferrer\">http://duktape.org/</a> </p>\n"}], "owner": {"reputation": 11, "user_id": 10095991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c422840ffe736f3a679c74fa1b891e5?s=128&d=identicon&r=PG&f=1", "display_name": "Reshma Shaik", "link": "https://stackoverflow.com/users/10095991/reshma-shaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531885688, "creation_date": 1531860782, "last_edit_date": 1531885688, "question_id": 51390020, "link": "https://stackoverflow.com/questions/51390020/clicking-the-buttons-on-the-web-page-with-c", "title": "Clicking the buttons on the Web page with C", "body": "<p>My task is to open a web browser and click on the buttons that are available on the web page so that the clicked button performs its inbuilt operation defined in the web page. \nWas able to open a web browser using the C program.</p>\n\n<p>But I was not able to complete the next operation using C. </p>\n\n<p>Are there any inbuilt libraries where I can use them to click on the buttons in C?</p>\n\n<p>A small provided example with explanation is appreciated.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "linux", "string", "shell", "binary"], "comments": [{"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 1, "creation_date": 1531860732, "post_id": 51389969, "comment_id": 89752093, "body": "Have you tried debugging it?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1531861093, "post_id": 51389969, "comment_id": 89752255, "body": "Depends very much on the specific file. <code>strings</code> is part of <code>binutils</code>, and as such, it knows how to parse common executable formats to go straight for the strings table; it&#39;s only for things that aren&#39;t an ELF/dwarf/etc. file where it needs to guess and just look for sequences of printable characters next to each other."}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 1, "creation_date": 1531861135, "post_id": 51389969, "comment_id": 89752275, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/33901428/608639\">Where can I find code for binary utility &#39;strings&#39; of Linux?</a> Also see <a href=\"https://sourceware.org/git/gitweb.cgi?p=binutils-gdb.git;a=blob_plain;f=binutils/strings.c;hb=HEAD\" rel=\"nofollow noreferrer\"><code>strings.c</code></a> source code."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1531861136, "post_id": 51389969, "comment_id": 89752277, "body": "<code>&#47;bin&#47;dd</code>, being an ELF file, is thus a place where <code>strings</code> is specifically syntax-aware."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1531861187, "post_id": 51389969, "comment_id": 89752304, "body": "@CharlesDuffy: and in that case it prints all contiguous strings it <i>can</i> find, so that&#39;s not a very big deal. If that were OP&#39;s problem, the reverse would be true: <code>strings</code> would print <i>less</i> strings, not more."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1531861239, "post_id": 51389969, "comment_id": 89752329, "body": "Sure, but the OP isn&#39;t asking &quot;how is my implementation of <code>strings</code> broken?&quot;, they&#39;re asking how the upstream one works. The source is a canonical answer (and <i>the only</i> complete answer) to that question."}, {"owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 4, "creation_date": 1531861598, "post_id": 51389969, "comment_id": 89752500, "body": "OP, if your motivation is to fix the code, please put some effort into debugging it. You can use <code>printf &#39;hello\\377world&#39; &gt; file</code> as a test case, where <code>strings</code> shows two strings while your code shows none."}, {"owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "reply_to_user": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 0, "creation_date": 1531861866, "post_id": 51389969, "comment_id": 89752609, "body": "@CharlesDuffy I&#39;m actually asking what is my mistake. Since <code>strings</code> can print all text, but I can&#39;t. @thatotherguy I tested it, <code>strings</code> found 2 words, but my code cannot find any."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 3, "creation_date": 1531862456, "post_id": 51389969, "comment_id": 89752835, "body": "<code>fgetc</code> returns an <code>int</code> not a <code>char</code> and @thatotherguy has your number. He chose that test case carefully. Think it through. If you can&#39;t find a debugger, use a piece of paper."}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "edited": false, "score": 1, "creation_date": 1531863635, "post_id": 51389969, "comment_id": 89753274, "body": "@Phillip, ...I edited the title to reflect the question you <i>meant</i> to ask (what was wrong with your code), not the question you <i>did</i> ask (how GNU strings works)."}, {"owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "reply_to_user": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1531866080, "post_id": 51389969, "comment_id": 89753998, "body": "@thatotherguy and @rici I understand your though and updated my code. I used <code>read</code> instead of <code>fgetc</code> and added a print block for the rest of text after EOF. Now it can find 813 words in <code>&#47;bin&#47;dd</code> file and it can find <code>hello</code> and <code>world</code> in the test file. Thank you! Can you comment why the <code>strings</code> can find 818 words but my code finds 813? Also can you suggest performance improvements for syscall usage instead of fopen and fread?"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1531866663, "post_id": 51389969, "comment_id": 89754168, "body": "This program may exhibit undefined behavior if the number of &#39;correct&#39; characters gathered equals the size of your buffer. If that happens, you <i>still</i> paste on an additional 2 characters, overwriting what is in memory at that point."}, {"owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "reply_to_user": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1531866984, "post_id": 51389969, "comment_id": 89754260, "body": "@usr2564301 Fixed in <b>EDIT1</b>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1531893391, "post_id": 51389969, "comment_id": 89760274, "body": "You should examine the source code to <code>strings.c</code>. The first thing that should jump out is your <code>isPrintable</code> is different than what <code>strings.c</code> is using. The second thing you should see is <code>strings</code> does not read the whole file. You were provided a link to the <code>strings.c</code> source file. Why are you not examining the source file?"}, {"owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "edited": false, "score": 0, "creation_date": 1531902918, "post_id": 51389969, "comment_id": 89765483, "body": "Thanks, It seems the tab character is the difference as in the answer. Thank you for your help. As a result, don&#39;t use <code>getc</code>, but <code>read</code> for precision. Now my problem is performance, If any one have suggestions, will be appreciated"}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "edited": false, "score": 1, "creation_date": 1531941475, "post_id": 51389969, "comment_id": 89790395, "body": "@phillip: there was nothing wrong with using fgetc and it will be a lot faster than read() because it buffers. So I think you didn&#39;t really absorb my comment. Let my try again: fgetc returns an <i>int</i>, not a <i>char</i>. This makes a difference. Why does it make a difference? Here&#39;s a hint: What&#39;s the value of EOF as a char?"}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "edited": false, "score": 0, "creation_date": 1531903059, "post_id": 51391129, "comment_id": 89765578, "body": "Thank you! I accept your answer since you have resolved the <code>read</code> and <code>getc</code> issue too. The additional stuff on strings.c file confused me and I missed the absence of tab char. I will be more than happy, if you give some performance advices for the <b>EDIT1</b> version."}], "tags": [], "owner": {"reputation": 100758, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 5, "last_activity_date": 1531867256, "creation_date": 1531867256, "answer_id": 51391129, "question_id": 51389969, "link": "https://stackoverflow.com/questions/51389969/implementing-my-own-strings-tool-missing-sequences-gnu-strings-finds/51391129#51391129", "title": "Implementing my own &quot;strings&quot; tool -- missing sequences GNU strings finds", "body": "<p>You have to include Tab characters. These have hex code 0x09.</p>\n\n<p>You can fix it by adding this to your printable test:</p>\n\n<pre><code>if(c &gt;= 0x20 &amp;&amp; c &lt;= 0x7e || c == 0x09)\n</code></pre>\n\n<hr>\n\n<h3>Ten minutes earlier:</h3>\n\n<p>Oh wow, I have no idea whatsoever why this program finds 813 words in this person's <code>/bin/dd</code> while <code>strings</code> finds 818. Why would anyone think I would?</p>\n\n<p>However, I do have a compiler and a Unix system, so I can do some research to try to find out.</p>\n\n<p>First I tried it on my system:</p>\n\n<pre><code>$ ./yourprogram /bin/dd &gt; yours &amp;&amp; wc -l yours\n807 yours\n\n$ strings -n 4 /bin/dd &gt; theirs &amp;&amp; wc -l theirs\n812 theirs\n</code></pre>\n\n<p>Ok, different numbers but still a difference. Then I looked at the differences:</p>\n\n<pre><code>$ diff -u yours theirs\n--- yours       2018-07-17 15:13:27.188357492 -0700\n+++ theirs      2018-07-17 15:13:56.905429280 -0700\n@@ -182,7 +182,7 @@\n ATUH\n t9[]A\\\n []A\\\n-[]A\\\n+8      []A\\\n AUAT1\n []A\\A]\n HiD$\n@@ -210,7 +210,9 @@\n XZL;t$\n \\$ I\n AUATI\n+;'u    H\n []A\\A]\n+       v*H\n</code></pre>\n\n<p>It's messy, but it shows that you find <code>[]A\\</code> while <code>strings</code> finds <code>8     []A\\</code>. Inspecting the file shows this to be a Tab character. I can then create a test case:</p>\n\n<pre><code>$ printf 'hello\\tworld' &gt; file\n\n$ strings file\nhello    world\n\n$ ./yourprogram file\nhello\nworld\n</code></pre>\n\n<p>So the program doesn't seem to recognize Tab, while <code>strings</code> does. Why doesn't the program consider it printable?</p>\n\n<p>I looked it up in <code>man ascii</code>: </p>\n\n<pre><code>Oct   Dec   Hex   Char\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n011   9     09    HT  '\\t' (horizontal tab)\n</code></pre>\n\n<p>I compared that to what the code looks for. I could have run it in a debugger or added <code>printf</code> statements to try to determine why it won't recognize 0x09, but I can see that it requires the character to be at least 0x20 to consider it printable. </p>\n\n<p>I updated <code>isPrintable</code> to add this as a special case:</p>\n\n<pre><code>    if(c &gt;= 0x20 &amp;&amp; c &lt;= 0x7e || c == 0x09)\n</code></pre>\n\n<p>And recompiled and reran:</p>\n\n<pre><code>$ ./yourprogram /bin/dd | wc -l\n812\n</code></pre>\n\n<p>Now the counts match, and I can post this as an answer and pretend like I used some Harry Potter mending charm or secret level locked ability, rather than just research and testing.</p>\n"}], "owner": {"reputation": 209, "user_id": 2311119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/045d471120d0d6ad842cb004fecb148a?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/2311119/phillip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "accepted_answer_id": 51391129, "answer_count": 1, "score": 0, "last_activity_date": 1531903275, "creation_date": 1531860522, "last_edit_date": 1531903275, "question_id": 51389969, "link": "https://stackoverflow.com/questions/51389969/implementing-my-own-strings-tool-missing-sequences-gnu-strings-finds", "title": "Implementing my own &quot;strings&quot; tool -- missing sequences GNU strings finds", "body": "<p>I want to read texts / strings in binary file programmatically.</p>\n\n<p>The exact alternative of my target is the <code>strings</code> shell command in Linux.</p>\n\n<p>When I run the <code>strings -n 4 /bin/dd</code> shell command, it prints 818 lines of text.</p>\n\n<p>How can I find all the strings in binary like <code>strings</code> command does?</p>\n\n<hr>\n\n<p>My code uses <code>read</code> instead of <code>fgetc</code> and added print block for rest of text after finding EOF.</p>\n\n<p>It can find 813 words in <code>/bin/dd</code>, but still <code>strings</code> can find 818 words. What can be the difference?</p>\n\n<p>Another question; Can you suggest performance improvements for this code? I guess <code>read(1)</code> is not the fastest way.</p>\n\n<p><strong>Latest updated code</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n\nbool isPrintable(unsigned char c)\n{\n    if(c &gt;= 0x20 &amp;&amp; c &lt;= 0x7e || c == 0x09)\n    {\n        return true;\n    }\n    return false;\n}\n\nint main(int argc, char * argv [])\n{\n    char buffer[300];\n    char *p = buffer;\n    char ch;\n    int fd;\n\n    if(argc &lt; 2)\n    {\n        printf(\"Usage: %s file\", argv[0]);\n        return 1;\n    }\n\n    fd = open(argv[1], O_RDONLY);\n    if(0 &lt;= fd)\n    {\n        while(1 == read(fd, &amp;ch, 1))\n        {\n            if(isPrintable(ch) &amp;&amp; (p - buffer &lt; sizeof(buffer) - 3))\n            {\n                *p++ = ch;\n            }\n            else\n            {\n                if(p - buffer &gt;= 4) // print collected text\n                {\n                    *p++ = '\\n';\n                    *p++ = '\\0';\n                    printf(\"%s\", buffer);\n                }\n                p = buffer;\n            }\n        }\n        if(p - buffer &gt;= 4) // print the rest, if any\n        {\n            *p++ = '\\n';\n            *p++ = '\\0';\n            printf(\"%s\", buffer);\n        }\n        close(fd);\n    }\n    else\n    {\n        printf(\"Could not open %s\\n\", argv[1]);\n        return 1;\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>Here is a performance measurement of <code>mystrings</code> and <code>strings</code>. <code>strings</code> can find more text in less time.</p>\n\n<pre><code>$ time ./mystrings /lib/i386-linux-gnu/libc-2.27.so | wc -l\n11852\nreal    0m0,917s\nuser    0m0,271s\nsys 0m0,629s\n\n$ time strings /lib/i386-linux-gnu/libc-2.27.so | wc -l\n12026\nreal    0m0,028s\nuser    0m0,027s\nsys 0m0,000s\n</code></pre>\n\n<p>Even if I use <code>fopen</code>, <code>fread</code>, <code>fclose</code> it is not so fast:</p>\n\n<pre><code>$ time ./mystrings2 /lib/i386-linux-gnu/libc-2.27.so | wc -l\n11852\nreal    0m0,084s\nuser    0m0,070s\nsys 0m0,004s\n</code></pre>\n\n<p>I'm open to any suggestions for performance improvements also.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1531859909, "post_id": 51389816, "comment_id": 89751731, "body": "You can do something like <code>ptr0 = malloc(ncol+4)</code> followed by <code>ptr = ptr0 + 4</code> after which you can access <code>ptr[-3]</code> through <code>ptr[ncol-1]</code>."}, {"owner": {"reputation": 3975, "user_id": 8513665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c39368317b0749f5d8f09735796c470e?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Gibbons", "link": "https://stackoverflow.com/users/8513665/christian-gibbons"}, "edited": false, "score": 1, "creation_date": 1531859910, "post_id": 51389816, "comment_id": 89751732, "body": "<code>nrow</code> is uninitialized."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531859968, "post_id": 51389816, "comment_id": 89751751, "body": "<code>ncol</code> is uninitialised."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1531860169, "post_id": 51389816, "comment_id": 89751840, "body": "<code>ptr[0]=(float *) malloc(nrow*ncol*sizeof(float));</code> is totally wrong. Having obtained memory for <code>float **ptr;</code> you must then do a loop for each row, to obtain memory for the number of columns."}, {"owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531860640, "post_id": 51389816, "comment_id": 89752054, "body": "@WeatherVane let&#39;s forget about this. Assume the <code>(nrow+8) * (ncol+8)</code> matrix is well allocated and initialized, how can I move the pointer to make the index starts from <code>-4</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 4, "creation_date": 1531860737, "post_id": 51389816, "comment_id": 89752094, "body": "Nope, assume nothing: please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem, to prevent what you think are off-topic comments."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531861160, "post_id": 51389816, "comment_id": 89752294, "body": "@WeatherVane <i>Having obtained memory for <code>float **ptr;</code> you must then do a loop for each row, to obtain memory for the number of columns.</i> No, there&#39;s no need to do an individual <code>malloc</code> for each row.  You can just do a loop to fill in the pointers: <code>ptr[0]=malloc(nrow*ncol*sizeof(float)); for (i=1;i&lt;nrow;i++) ptr[i] = ptr[i-1] + ncol;</code>"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531861336, "post_id": 51389816, "comment_id": 89752373, "body": "Related: <a href=\"https://stackoverflow.com/questions/3473675/are-negative-array-indexes-allowed-in-c/3473686?s=3|43.5144#3473686\" title=\"are negative array indexes allowed in c\">stackoverflow.com/questions/3473675/&hellip;</a>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531861398, "post_id": 51389816, "comment_id": 89752396, "body": "@AndrewHenle it is possible to make a DIY for that, but OP&#39;s first <code>malloc</code> does not get memory for a whole contiguous array, just an array of pointers for each row, yet to be allocated."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531861542, "post_id": 51389816, "comment_id": 89752472, "body": "@WeatherVane <i>[t]he first malloc does not get memory for a whole contiguous array, just an array of pointers for each row, yet to be allocated</i>  But the <b>second</b> <code>malloc()</code> does get enough memory for a contiguous array.  The fault in the code is never filling in the pointers past <code>ptr[0]</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531861578, "post_id": 51389816, "comment_id": 89752487, "body": "@AndrewHenle what are you on?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531861695, "post_id": 51389816, "comment_id": 89752543, "body": "@WeatherVane I&#39;m on nothing.  <code>ptr=(float **) malloc(nrow*sizeof(float*)); ptr[0]=(float *) malloc(nrow*ncol*sizeof(float));</code> gets plenty of memory for a contiguous array.  As I posted, it just doesn&#39;t fill in the pointers past <code>ptr[0]</code>.  That can be done with an almost trivial <code>for (i=1;i&lt;nrow;i++) ptr[i] = ptr[i-1] + ncol;</code>"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531861768, "post_id": 51389816, "comment_id": 89752572, "body": "@AndrewHenle so it doesn&#39;t work, unless you do something convoluted but &quot;trivial&quot;. . . Tell me the point of the first <code>malloc</code>, for the row pointers? Usually, you then loop to allocate memory for each row, as I said."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531862128, "post_id": 51389816, "comment_id": 89752723, "body": "@WeatherVane Naively calling <code>malloc()</code> for every row in a two-dimensional &quot;array&quot; is horribly inefficient.  Any n-dimensional &quot;array&quot; is almost trivial to allocate with only n calls to <code>malloc()</code>.  n-1 calls for arrays of pointers, and one call for the entire data area.  if you want to go through the trouble, it&#39;s even possible to do an n-dimensional &quot;array&quot; that&#39;s actually the common &quot;pointers to pointers to pointers to a one-dimensional array&quot; that is normally implemented with multiple <code>malloc()</code> calls in deeply-nested loops with only a single call to <code>malloc()</code>."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531862301, "post_id": 51389816, "comment_id": 89752783, "body": "@AndrewHenle that may be true, but OP first allocated memory for an array of pointers, but then ignored that and only uses the first element to allocate enough memory for a contiguous 2D array."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531862401, "post_id": 51389816, "comment_id": 89752812, "body": "@WeatherVane And then he failed to fill in the rest of the pointers.  I&#39;m guessing he copied the code and missed a <code>for</code> loop."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531862501, "post_id": 51389816, "comment_id": 89752860, "body": "@AndrewHenle you are contradicting yourself. I already wrote that the array of pointers needs to be allocated. OP either meant to allocate a single 2D array, or an array of pointers. Whether this is efficient is off-topic."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531862705, "post_id": 51389816, "comment_id": 89752932, "body": "@WeatherVane The second <code>malloc()</code> call - <code>ptr[0]=(float *) malloc(nrow*ncol*sizeof(float));</code> gets all the memory needed for a <code>nrow</code> by <code>ncol</code> two-dimensional &quot;array&quot;.  There&#39;s no need to obtain more with additional calls to <code>malloc()</code>."}, {"owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 0, "creation_date": 1531862986, "post_id": 51389816, "comment_id": 89753035, "body": "Please look at my supplementary code. It can run correctly!"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531864449, "post_id": 51389816, "comment_id": 89753509, "body": "@AndrewHenle yes it does, but 1) it wastes the allocation of the row pointers array, and 2) the first code posted won&#39;t work to index a DIY 2D array. That&#39;s why there needs to be a loop allocating memory for each row."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1531865473, "post_id": 51389816, "comment_id": 89753842, "body": "@WeatherVane <i>That&#39;s why there needs to be a loop allocating memory for each row.</i> No, there doesn&#39;t.  <code>ptr=malloc(nrow*sizeof(float*)); ptr[0]=malloc(nrow*ncol*sizeof(float)); for (i=1;i&lt;nrow;i++) ptr[i] = ptr[i-1] + ncol;</code>  Done.  Two calls to <code>malloc()</code>.  Much faster, and easy to extend to N dimensions.  Geez. <a href=\"http://c-faq.com/aryptr/dynmuldimary.html\" rel=\"nofollow noreferrer\">it&#39;s even posted to the comp.lang.c FAQ</a>."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531865767, "post_id": 51389816, "comment_id": 89753919, "body": "@AndrewHenle you missed the best part:)  One malloc means that its not possible to easily add/extend/delete/move/remove/sort or otherwise manipulate each row.  Of course, that may be irrelevant in many apps, just as the extra overhead of one-malloc-per-row may be unimportant in others."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1531866084, "post_id": 51389816, "comment_id": 89753999, "body": "@MartinJames True, and that&#39;s a trade off that needs to be addressed. My issue is with the claim that each row has to be allocated with a separate call to <code>malloc()</code> and there&#39;s no way to allocate a two-dimensional &quot;array&quot; otherwise.Of course it&#39;s possible - I posted the code in the comments.  And if you want, <a href=\"https://stackoverflow.com/questions/42094465/correctly-allocating-multi-dimensional-arrays\">you can even dynamically allocate true 2-d array with a single <code>malloc()</code> call</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1531861129, "post_id": 51389960, "comment_id": 89752269, "body": "Not sure this is working.  Try looping i from -4 to nrow+3 and j from -4 to ncol+3 in the initialize loop, you should get a segfault."}, {"owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 0, "creation_date": 1531862860, "post_id": 51389960, "comment_id": 89752997, "body": "Please look at my supplementary code. It can run correctly!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531863226, "post_id": 51389960, "comment_id": 89753125, "body": "Having  separate <code>pre&#47;post</code> variables for row and column (and of different values) would add clarity to this solution.  <code>ptr[i] += pre;  .... ptr += pre;</code> <i>looks</i> wrong."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1531863859, "post_id": 51389960, "comment_id": 89753349, "body": "Or indeed, you can make each array involved exactly the size you intend, and use pointers elements in the middle (or one position past the end) for the indexing base.  Of course, any variation on an approach like this makes it trickier to free the allocated space."}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 1, "last_activity_date": 1531861040, "last_edit_date": 1531861040, "creation_date": 1531860499, "answer_id": 51389960, "question_id": 51389816, "link": "https://stackoverflow.com/questions/51389816/pointer-subscript-starts-from-negative-value/51389960#51389960", "title": "pointer subscript starts from negative value", "body": "<p>Strictly speaking, you can't index before the start or after the end of an array.  You can however make the array bigger than you intend and put the starting pointer somewhere in the middle:</p>\n\n<pre><code>int nrow = 5, ncol = 5, pre = 4, post = 4;\nint i,j;\nfloat **ptr;\n\nptr = malloc((nrow+pre+post)*sizeof(float*));\nfor (i=0;i&lt;nrow+pre+post;i++)\n    ptr[i] = malloc((ncol+pre+post)*sizeof(float));\n    ptr[i] += pre;   // move up start of column pointers\n}\nptr += pre;  // move up start of row pointer\n\n/*initialize*/\nfor (i=0;i&lt;nrow;i++) {\n    for (j=0;j&lt;ncol;j++) {\n        ptr[i][j]=0.0;\n    }\n}\n</code></pre>\n\n<p>Note that the allocation for the columns is done once for each column, not in a bunch in the first column.  The way you had it, anything past the first column doesn't point to anything.</p>\n\n<p>Now you can safely access indexes from -4 to max + 3.</p>\n\n<p>To clean up:</p>\n\n<pre><code>ptr -= pre;\nfor (i=0;i&lt;nrow+pre+post;i++)\n    ptr[i] -= pre;\n    free(ptr[i]);\n}\nfree(ptr);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 0, "creation_date": 1531862975, "post_id": 51389989, "comment_id": 89753031, "body": "Please look at my supplementary code. It can run correctly!"}], "tags": [], "owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1531860644, "creation_date": 1531860644, "answer_id": 51389989, "question_id": 51389816, "link": "https://stackoverflow.com/questions/51389816/pointer-subscript-starts-from-negative-value/51389989#51389989", "title": "pointer subscript starts from negative value", "body": "<p>You can do something like this, but I don't think you can access the columns offset like that, you will need to point at each row.</p>\n\n<pre><code>main()\n{\n\n    int nrow,ncol;\n    int i,j;\n    float **ptr;\n    float *p;\n\n/*allocation*/\n    nrow=5;ncol=7; \n    ptr=(float **) malloc((nrow+7)*sizeof(float*));\n    for (i=0; i&lt;nrow+7;i++)\n        ptr[i]=(float *) malloc((ncol+7)*sizeof(float));\n/*initialize*/\n    ptr = &amp;ptr[4];\n    for (i=-4;i&lt;nrow+3;i++)\n        for (j=-4,p=&amp;ptr[i][4];j&lt;ncol+3;j++)\n            p[j]=0.0f;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 0, "creation_date": 1531862810, "post_id": 51390295, "comment_id": 89752978, "body": "@R Saha  Please look at my supplementary code. It can run correctly!"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 0, "creation_date": 1531863119, "post_id": 51390295, "comment_id": 89753083, "body": "@coco, You are accessing memory beyond the valid bounds. Your code is subject to undefined behavior. It may appear to work but, unfortunately, seemingly sane behavior is also under undefined behavior. I wouldn&#39;t count on any predictable behavior from that program."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531864171, "post_id": 51390295, "comment_id": 89753440, "body": "@RSahu, your &quot;you cannot&quot; seems to be predicated on the assumption that the OP&#39;s <code>nrow</code> and <code>ncol</code> represent the actual number of rows and columns allocated.  If you do not apply that interpretation, then of course the behavior the OP requests is possible via an approach such as you describe here.  The arrays simply need to be allocated large enough, which indeed the OP&#39;s sample code appears to do."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531864711, "post_id": 51390295, "comment_id": 89753608, "body": "@JohnBollinger, you are right. The OP is allocating more memory than I thought."}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "edited": false, "score": 1, "creation_date": 1531864812, "post_id": 51390295, "comment_id": 89753638, "body": "@coco, I take that comment back. Your program is not subject to undefined behavior. You are allocating more memory than I thought. Adding some more output to your program revealed some of those details. <a href=\"https://ideone.com/XgiYDs\" rel=\"nofollow noreferrer\">ideone.com/XgiYDs</a>. My answer is still valid from a conceptual stand point. You can use any pointers and indices to your heart&#39;s content as long as the combination is valid."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 1, "last_activity_date": 1531862720, "last_edit_date": 1531862720, "creation_date": 1531862125, "answer_id": 51390295, "question_id": 51389816, "link": "https://stackoverflow.com/questions/51389816/pointer-subscript-starts-from-negative-value/51390295#51390295", "title": "pointer subscript starts from negative value", "body": "<p>Let's say your array has 7 elements and is laid out as below:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>+-----+-----+-----+-----+-----+-----+-----+\n|     |     |     |     |     |     |     |\n+-----+-----+-----+-----+-----+-----+-----+\n</code></pre>\n\n<p>If a pointer points to the first element of the array, it can be indexed as:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>p\n|\nv\n+-----+-----+-----+-----+-----+-----+-----+\n|     |     |     |     |     |     |     |\n+-----+-----+-----+-----+-----+-----+-----+\np[0]  p[1]  p[2]  p[3]  p[4]  p[5]  p[6]  \n</code></pre>\n\n<p>If a pointer points to an element in the middle of the array, it can be indexed using negative values.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>                  p\n                  |\n                  v\n+-----+-----+-----+-----+-----+-----+-----+\n|     |     |     |     |     |     |     |\n+-----+-----+-----+-----+-----+-----+-----+\np[-3] p[-2] p[-1] p[0]  p[1]  p[2]  p[3]  \n</code></pre>\n\n<p>If the pointer points to one element past the last element, it can be indexed using only negative values.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>                                          p\n                                          |\n                                          v\n+-----+-----+-----+-----+-----+-----+-----+\n|     |     |     |     |     |     |     |\n+-----+-----+-----+-----+-----+-----+-----+\np[-7] p[-6] p[-5] p[-4] p[-3] p[-2] p[-1] \n</code></pre>\n\n<p>It is not valid for the pionter to point to anything before the first element. Hence, no matter where the pointer points to in the valid range of elements, a valid index cannot be less than -7 or greater than 6.</p>\n\n<p>Coming to your question</p>\n\n<blockquote>\n  <p>But how can I let the row start from <code>-4</code> and end in <code>nrow+3</code>, also let the column start from <code>-4</code> and end in <code>ncol+3</code>?</p>\n</blockquote>\n\n<p>You cannot. If a pointer points to the 5-th element of the array, you can use -4 as a valid index but then the end condition is going to be <code>nrow-4</code>/<code>ncol-4</code>. <code>nrow + &lt;some number&gt;</code>/<code>ncol + &lt;some number&gt;</code> will never be the correct end index.</p>\n\n<pre><code>float** ptr1 = &amp;(5-th row of the array);\nfor ( int i = -4; i &lt; nrow - 4; ++i )\n{\n   // OK to use ptr1[i];\n   float* ptr2 = &amp;(5-the element/column of the row)\n   for ( int j = -4; j &lt; ncol - 4; ++j )\n   {\n      // OK to use ptr2[j];\n   }\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 10011302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a246b666580f8b15eed45b6354f3ecc4?s=128&d=identicon&r=PG&f=1", "display_name": "coco", "link": "https://stackoverflow.com/users/10011302/coco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1531862767, "creation_date": 1531859784, "last_edit_date": 1531862767, "question_id": 51389816, "link": "https://stackoverflow.com/questions/51389816/pointer-subscript-starts-from-negative-value", "title": "pointer subscript starts from negative value", "body": "<pre><code>int nrow=5,ncol=7,i,j;\nfloat **ptr;\n/*allocation*/\nptr=(float **) malloc(nrow*sizeof(float*));\nptr[0]=(float *) malloc(nrow*ncol*sizeof(float));\n/*initialize*/\nfor (i=0;i&lt;nrow;i++)\n    for (j=0;j&lt;ncol;j++) ptr[i][j]=0.0;\n</code></pre>\n\n<p>We know in the above case, the row starts from <code>0</code> and ends in <code>nrow-1</code>, the column starts from <code>0</code> and ends in <code>ncol-1</code>. But how can I let the row start from <code>-4</code> and end in <code>nrow+3</code>, also let the column start from <code>-4</code> and end in <code>ncol+3</code>?</p>\n\n<p>Supplementary code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nfloat *vector(int nl, int nh){\n/* allocate a float vector with subscript range v[nl..nh] and initializing\n       this vector, eg. vector[nl..nh]=0.0 */\n    float *v;\n    int i,NR_END=0;\n\n    v=(float *)malloc((size_t) ((nh-nl+1+NR_END)*sizeof(float)));\n\n    for (i=0;i&lt;(nh-nl+1+NR_END);i++) v[i]=0.0;\n    return v-nl+NR_END;\n}\n\nint main(int argc, char *argv[])\n{\n    int i,nrow=5, row1, row2;\n    float *v;\n    row1=-4;\n    row2=nrow+3;\n    v = vector(row1,row2);\n    for (i=-4;i&lt;(nrow+4);i++) {\n        v[i]=(float)i; \n        printf(\"v[%d]=%f\\n\",i,v[i]);\n    }\nexit(0);\n}\n</code></pre>\n\n<p>If I run the above code, it'll get the correct answer:</p>\n\n<pre><code> v[-4]=-4.000000\n v[-3]=-3.000000\n v[-2]=-2.000000\n v[-1]=-1.000000\n v[0]=0.000000\n v[1]=1.000000\n v[2]=2.000000\n v[3]=3.000000\n v[4]=4.000000\n v[5]=5.000000\n v[6]=6.000000\n v[7]=7.000000\n v[8]=8.000000\n</code></pre>\n"}, {"tags": ["c", "lookup-tables"], "comments": [{"owner": {"reputation": 55516, "user_id": 892256, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/15FJW.png?s=128&g=1", "display_name": "Ed Heal", "link": "https://stackoverflow.com/users/892256/ed-heal"}, "edited": false, "score": 0, "creation_date": 1531859521, "post_id": 51389723, "comment_id": 89751548, "body": "How many 32 bit ints are there? Can you not go the mathematics?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1531859684, "post_id": 51389723, "comment_id": 89751633, "body": "What is stopping you from writing a small program to calculate that for yourself? In some systems the amount of memory available won&#39;t be enough to hold a lookup table with 2,147,483,647 strings. I suggest a rethink of the policy."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 0, "creation_date": 1531859739, "post_id": 51389723, "comment_id": 89751653, "body": "Even 2^31 <i>bytes</i> occupy 2 gigabytes. So the answer is &quot;too much to be viable&quot;."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1531860453, "post_id": 51389723, "comment_id": 89751979, "body": "This sure seems like <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">an XY problem</a>.  What&#39;s the point of converting every 32-bit <code>int</code> into a string?  You expand the storage needed from 4 bytes per <code>int</code> value to an average of 9+ bytes per <code>int</code> value, <b>and you get no more information than you had in the first place</b>."}, {"owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "edited": false, "score": 1, "creation_date": 1531860834, "post_id": 51389723, "comment_id": 89752130, "body": "Well let&#39;s say I had a lookup table initialised on startup and whenever a program wants a conversion it just uses it. Even if that&#39;s a stupid idea, I&#39;m still interested in the answer regardless."}, {"owner": {"reputation": 23582, "user_id": 758133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W8X5E.jpg?s=128&g=1", "display_name": "Martin James", "link": "https://stackoverflow.com/users/758133/martin-james"}, "edited": false, "score": 0, "creation_date": 1531865967, "post_id": 51389723, "comment_id": 89753965, "body": "@faissaloo well, you can just guesstimate it."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531870566, "post_id": 51389723, "comment_id": 89755097, "body": "@faissaloo I think the short answer is, &quot;too much&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 4142, "user_id": 9962955, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-q_I2uCDh94A/AAAAAAAAAAI/AAAAAAAAABY/7dXHe3szfmQ/photo.jpg?sz=128", "display_name": "Leo K", "link": "https://stackoverflow.com/users/9962955/leo-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1531860168, "creation_date": 1531860168, "answer_id": 51389899, "question_id": 51389723, "link": "https://stackoverflow.com/questions/51389723/how-much-ram-would-a-lookup-table-for-converting-positive-32-bit-integers-to-nul/51389899#51389899", "title": "How much RAM would a lookup table for converting positive 32 bit integers to null terminated strings take", "body": "<p>No clue how this is a 'programming' question (nor why its answer is useful), but let's try some math:</p>\n\n<p>it is not worth it creating a table of string pointers, because the pointers themselves are 8 bytes each and the longest string is 10 bytes (NOTE, not adding a 0 terminator to save space!), so it is best to store this as an array of char[10] arrays (i.e. one very long string that has the 1st number at offset 0, the 2nd at offset 10, and so on). Therefore, you need 2^31 * 10 bytes = 21,474,836,480 bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 139291, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "is_accepted": true, "score": 2, "last_activity_date": 1531877344, "creation_date": 1531877344, "answer_id": 51392280, "question_id": 51389723, "link": "https://stackoverflow.com/questions/51389723/how-much-ram-would-a-lookup-table-for-converting-positive-32-bit-integers-to-nul/51392280#51392280", "title": "How much RAM would a lookup table for converting positive 32 bit integers to null terminated strings take", "body": "<p>Let S(<em>n</em>) be the string for number <em>n</em>.</p>\n\n<p>Consider S(429,496,730) through S(4,294,967,295). By partitioning this into subranges S(429,496,730) through S(999,999,999) and S(1,000,000,000) through S(4,294,967,295), we can see they require (999,999,999\u2212429,496,730+1)\u202210 bytes and (4,294,967,295\u22121,000,000,000)\u202211 bytes (10 bytes for nine digits plus a null terminator, and similarly 11 bytes for 10 digits and a terminator.)</p>\n\n<p>This is 41,949,672,956 bytes.</p>\n\n<p>Consider how to look up any number <em>n</em> in the range 1 to 4,294,967,295. If it is in the range 429,496,730 to 999,999,999, its string starts (<em>n</em>\u2212429,496,730)*10 bytes into the table for the first subrange above. If it is above that, its string starts (<em>n</em>-1,000,000,000)\u202211 bytes into the second subrange.</p>\n\n<p>If it is less than 429,496,730, we merely add 1,000,000,000 to it and look up S(<em>n</em>+1,000,000,000). The string for S(<em>n</em>) starts at the first non-zero digit after the first byte of S(<em>n</em>+1,000,000,000).</p>\n\n<p>Thus we have proven we need at most 41,949,672,956 bytes to implement a reasonable look-up function that can easily return a pointer to a null-terminated string for any integer from 1 to 4,294,967,295.</p>\n\n<p>Additionally, it is easily seen that no string in the combined table for the two subranges is a substring of any other string, which implies that each string is needed. Therefore, 41,949,672,956 bytes is necessary and sufficient for a function that returns a pointer to prepared strings.</p>\n"}], "owner": {"reputation": 862, "user_id": 5269447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09d355fcfdfb38bfec218c4239da62f2?s=128&d=identicon&r=PG&f=1", "display_name": "0x777C", "link": "https://stackoverflow.com/users/5269447/0x777c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 51392280, "answer_count": 2, "score": -6, "last_activity_date": 1531877344, "creation_date": 1531859360, "last_edit_date": 1531860865, "question_id": 51389723, "link": "https://stackoverflow.com/questions/51389723/how-much-ram-would-a-lookup-table-for-converting-positive-32-bit-integers-to-nul", "title": "How much RAM would a lookup table for converting positive 32 bit integers to null terminated strings take", "body": "<p>So if the format: <code>{\"1\",\"2\",\"3\"}</code> was continued until 4,294,967,295 how much RAM would be used?</p>\n"}, {"tags": ["c", "while-loop", "printf", "sdl", "fflush"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 5, "creation_date": 1531858382, "post_id": 51389479, "comment_id": 89751017, "body": "<code>printf</code> output in C is generally buffered. The information is accumulated internally until such time as the output driver decides it&#39;s time to really send it out. The output buffer isn&#39;t flushed until (a) it fills up (a lot of info), (b) you print a carriage/return/line-feed, or (c) you do an explicit <code>fflush(stdout)</code>. Why not use <code>\\n</code> instead of <code>\\t</code> then you&#39;ll see the output immediately? The tab (<code>\\t</code>) output is going to be a bit messy looking. If you really must have the <code>\\t</code>, then use <code>fflush(stdout)</code> after your <code>printf</code>."}, {"owner": {"reputation": 31, "user_id": 7739810, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dwQLvwmDHUs/AAAAAAAAAAI/AAAAAAAAAGg/quhGpzW8GtU/photo.jpg?sz=128", "display_name": "Richard Robertson", "link": "https://stackoverflow.com/users/7739810/richard-robertson"}, "reply_to_user": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1531920635, "post_id": 51389479, "comment_id": 89777459, "body": "@lurker Thank you very much for your well explained answer. I never understood what fflush was used for or that \\n flushes while \\t doesn&#39;t so this is extremely helpful. Thanks again."}], "answers": [{"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": true, "score": 3, "last_activity_date": 1531924854, "last_edit_date": 1531924854, "creation_date": 1531858466, "answer_id": 51389521, "question_id": 51389479, "link": "https://stackoverflow.com/questions/51389479/printf-function-in-c-not-printing-until-while-loop-finished/51389521#51389521", "title": "Printf function in C not printing until while loop finished", "body": "<p>You are probably not flushing stdout. Add a newline to the <code>printf</code> call and you should be OK:</p>\n\n<pre><code>printf(\"While loop active.\\n\");\n/* Here ------------------^ */\n</code></pre>\n\n<p>Or if keeping \\t is essential:</p>\n\n<pre><code>printf(\"While loop active.\\t\");\nfflush(stdout);\n</code></pre>\n\n<p>Credit to @lurker for extra information.</p>\n"}], "owner": {"reputation": 31, "user_id": 7739810, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-dwQLvwmDHUs/AAAAAAAAAAI/AAAAAAAAAGg/quhGpzW8GtU/photo.jpg?sz=128", "display_name": "Richard Robertson", "link": "https://stackoverflow.com/users/7739810/richard-robertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1678, "favorite_count": 0, "closed_date": 1531858930, "accepted_answer_id": 51389521, "answer_count": 1, "score": 1, "last_activity_date": 1531924854, "creation_date": 1531858277, "last_edit_date": 1531921297, "question_id": 51389479, "link": "https://stackoverflow.com/questions/51389479/printf-function-in-c-not-printing-until-while-loop-finished", "closed_reason": "Duplicate", "title": "Printf function in C not printing until while loop finished", "body": "<p>I want to test if different loops are active, so I have a print statement that repeats every 500ms in each loop, however the print statement does not print every 500ms, it waits until the loop is finished and then prints everything at once instead of periodically.</p>\n\n<p>How do I get my program to print to the terminal periodically?</p>\n\n<p>I'm a student so my knowledge of SDL is pretty limited so thorough explanation would be appreciated. </p>\n\n<pre><code>int main(void)\n{\n    int i = 0;\n    while(i&lt;10)\n        {\n            printf(\"While loop active.\\t\"); i++;\n            SDL_Delay(500);\n        }\n    return 0;\n}\n</code></pre>\n\n<p>P.S. I saw that duplicate question but I disagree as his question suggests an issue with 'signal handling' which I know nothing about so when asking this question, I didn't think his question would have the same answer as mine. I accept the answers given are the same though.</p>\n"}, {"tags": ["c", "snmp", "net-snmp"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 0, "creation_date": 1531860360, "post_id": 51388886, "comment_id": 89751936, "body": "Show us what you have tried so far. It would be helpful to post your code than snmpget code. Check out <a href=\"http://www.net-snmp.org/wiki/index.php/TUT:Writing_a_MIB_Module\" rel=\"nofollow noreferrer\">this link</a> and <a href=\"http://www.net-snmp.org/wiki/index.php/Tutorials#Coding_Tutorials\" rel=\"nofollow noreferrer\">this link</a>"}, {"owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "edited": false, "score": 0, "creation_date": 1531861574, "post_id": 51388886, "comment_id": 89752486, "body": "@kbr the default is all I have, I am starting from scratch. I am spending most of my time just trying to include headers for this. If there is an easier way to do this without using the snmpget code, that would also be helpful."}, {"owner": {"reputation": 52302, "user_id": 11182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yfpsb.jpg?s=128&g=1", "display_name": "Lex Li", "link": "https://stackoverflow.com/users/11182/lex-li"}, "edited": false, "score": 0, "creation_date": 1531867888, "post_id": 51388886, "comment_id": 89754557, "body": "Have you even taken a look at the definition of basic types such as <code>snmp_session</code>?"}], "owner": {"reputation": 73, "user_id": 10043467, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gktkh.jpg?s=128&g=1", "display_name": "viduwoy", "link": "https://stackoverflow.com/users/10043467/viduwoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531855577, "creation_date": 1531855577, "question_id": 51388886, "link": "https://stackoverflow.com/questions/51388886/how-to-retrieve-oid-value-using-net-snmp-in-c", "title": "How to retrieve OID value using Net SNMP in C?", "body": "<p>I am new to this. I am trying to use Net-SNMP's snmpget file to retrieve an OID and store it in a variable. Where can I specify the IP address of the device I am querying? Where can I specify what OID I am looking for? And how can I store the value of the OID?</p>\n\n<p>I already know the IP address of my device and the OID I am looking for. </p>\n\n<p>Here is the code Net-SNMP provides for snmpget:</p>\n\n<pre><code>#include &lt;net-snmp/net-snmp-config.h&gt;\n\n#if HAVE_STDLIB_H\n#include &lt;stdlib.h&gt;\n#endif\n#if HAVE_UNISTD_H\n#include &lt;unistd.h&gt;\n#endif\n#if HAVE_STRING_H\n#include &lt;string.h&gt;\n#else\n#include &lt;strings.h&gt;\n#endif\n#include &lt;sys/types.h&gt;\n#if HAVE_NETINET_IN_H\n#include &lt;netinet/in.h&gt;\n#endif\n#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n#if TIME_WITH_SYS_TIME\n# include &lt;sys/time.h&gt;\n# include &lt;time.h&gt;\n#else\n# if HAVE_SYS_TIME_H\n#  include &lt;sys/time.h&gt;\n# else\n#  include &lt;time.h&gt;\n# endif\n#endif\n#if HAVE_SYS_SELECT_H\n#include &lt;sys/select.h&gt;\n#endif\n#if HAVE_NETDB_H\n#include &lt;netdb.h&gt;\n#endif\n#if HAVE_ARPA_INET_H\n#include &lt;arpa/inet.h&gt;\n#endif\n\n#include &lt;net-snmp/utilities.h&gt;\n\n#include &lt;net-snmp/net-snmp-includes.h&gt;\n\n#define NETSNMP_DS_APP_DONT_FIX_PDUS 0\n\nstatic void\noptProc(int argc, char *const *argv, int opt)\n{\n    switch (opt) {\n    case 'C':\n        while (*optarg) {\n            switch (*optarg++) {\n            case 'f':\n                netsnmp_ds_toggle_boolean(NETSNMP_DS_APPLICATION_ID, \n                      NETSNMP_DS_APP_DONT_FIX_PDUS);\n                break;\n            default:\n                fprintf(stderr, \"Unknown flag passed to -C: %c\\n\",\n                        optarg[-1]);\n                exit(1);\n            }\n        }\n        break;\n    }\n}\n\nvoid\nusage(void)\n{\n    fprintf(stderr, \"USAGE: snmpget \");\n    snmp_parse_args_usage(stderr);\n    fprintf(stderr, \" OID [OID]...\\n\\n\");\n    snmp_parse_args_descriptions(stderr);\n    fprintf(stderr,\n            \"  -C APPOPTS\\t\\tSet various application specific     behaviours:\\n\");\n    fprintf(stderr,\n            \"\\t\\t\\t  f:  do not fix errors and retry the request\\n\");\n}\n\nint\nmain(int argc, char *argv[])\n{\n    netsnmp_session session, *ss;\n    netsnmp_pdu    *pdu;\n    netsnmp_pdu    *response;\n    netsnmp_variable_list *vars;\n    int             arg;\n    int             count;\n    int             current_name = 0;\n    char           *names[SNMP_MAX_CMDLINE_OIDS];\n    oid             name[MAX_OID_LEN];\n    size_t          name_length;\n    int             status;\n    int             failures = 0;\n    int             exitval = 0;\n\n\n    /*\n     * get the common command line arguments \n     */\n    switch (arg = snmp_parse_args(argc, argv, &amp;session, \"C:\", optProc)) {\n    case NETSNMP_PARSE_ARGS_ERROR:\n        exit(1);\n    case NETSNMP_PARSE_ARGS_SUCCESS_EXIT:\n        exit(0);\n    case NETSNMP_PARSE_ARGS_ERROR_USAGE:\n        usage();\n        exit(1);\n    default:\n    break;\n    }\n\n    if (arg &gt;= argc) {\n        fprintf(stderr, \"Missing object name\\n\");\n        usage();\n        exit(1);\n    }\n    if ((argc - arg) &gt; SNMP_MAX_CMDLINE_OIDS) {\n        fprintf(stderr, \"Too many object identifiers specified. \");\n        fprintf(stderr, \"Only %d allowed in one request.\\n\",         SNMP_MAX_CMDLINE_OIDS);\n        usage();\n        exit(1);\n    }\n\n    /*\n     * get the object names \n     */\n    for (; arg &lt; argc; arg++)\n        names[current_name++] = argv[arg];\n\n    SOCK_STARTUP;\n\n\n    /*\n     * Open an SNMP session.\n     */\n    ss = snmp_open(&amp;session);\n    if (ss == NULL) {\n        /*\n         * diagnose snmp_open errors with the input netsnmp_session pointer \n         */\n        snmp_sess_perror(\"snmpget\", &amp;session);\n        SOCK_CLEANUP;\n        exit(1);\n    }\n\n\n    /*\n     * Create PDU for GET request and add object names to request.\n     */\n    pdu = snmp_pdu_create(SNMP_MSG_GET);\n    for (count = 0; count &lt; current_name; count++) {\n        name_length = MAX_OID_LEN;\n        if (!snmp_parse_oid(names[count], name, &amp;name_length)) {\n            snmp_perror(names[count]);\n            failures++;\n        } else\n            snmp_add_null_var(pdu, name, name_length);\n    }\n    if (failures) {\n        snmp_close(ss);\n        SOCK_CLEANUP;\n        exit(1);\n    }\n\n\n    /*\n     * Perform the request.\n     *\n     * If the Get Request fails, note the OID that caused the error,\n     * \"fix\" the PDU (removing the error-prone OID) and retry.\n     */\n  retry:\n    status = snmp_synch_response(ss, pdu, &amp;response);\n    if (status == STAT_SUCCESS) {\n        if (response-&gt;errstat == SNMP_ERR_NOERROR) {\n            for (vars = response-&gt;variables; vars;\n                 vars = vars-&gt;next_variable)\n                print_variable(vars-&gt;name, vars-&gt;name_length, vars);\n\n        } else {\n            fprintf(stderr, \"Error in packet\\nReason: %s\\n\",\n                    snmp_errstring(response-&gt;errstat));\n\n            if (response-&gt;errindex != 0) {\n                fprintf(stderr, \"Failed object: \");\n                for (count = 1, vars = response-&gt;variables;\n                     vars &amp;&amp; count != response-&gt;errindex;\n                     vars = vars-&gt;next_variable, count++)\n                /*EMPTY*/;\n                if (vars) {\n                    fprint_objid(stderr, vars-&gt;name, vars-&gt;name_length);\n        }\n                fprintf(stderr, \"\\n\");\n            }\n            exitval = 2;\n\n            /*\n             * retry if the errored variable was successfully removed \n             */\n            if (!netsnmp_ds_get_boolean(NETSNMP_DS_APPLICATION_ID,\n                    NETSNMP_DS_APP_DONT_FIX_PDUS)) {\n                pdu = snmp_fix_pdu(response, SNMP_MSG_GET);\n                snmp_free_pdu(response);\n                response = NULL;\n                if (pdu != NULL) {\n                    goto retry;\n        }\n            }\n        }                       /* endif -- SNMP_ERR_NOERROR */\n\n    } else if (status == STAT_TIMEOUT) {\n        fprintf(stderr, \"Timeout: No Response from %s.\\n\",\n                session.peername);\n        exitval = 1;\n\n    } else {                    /* status == STAT_ERROR */\n        snmp_sess_perror(\"snmpget\", ss);\n        exitval = 1;\n\n    }                           /* endif -- STAT_SUCCESS */\n\n\n    if (response)\n        snmp_free_pdu(response);\n    snmp_close(ss);\n    SOCK_CLEANUP;\n    return exitval;\n\n}                               /* end main() */\n</code></pre>\n"}, {"tags": ["c", "oop", "winapi"], "comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1531855249, "post_id": 51388630, "comment_id": 89749540, "body": "The Windows API is not a framework. It&#39;s an API. Other than that, you&#39;ll see lots of OOP paradigms, implemented in C. There&#39;s also inheritance (e.g. registering a window class, that delegates messages to <code>DefWindowProc</code>, the base class implementation). Still, this question is not a very good fit for Stack Overflow."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531855261, "post_id": 51388630, "comment_id": 89749546, "body": "<a href=\"https://en.wikipedia.org/wiki/Windows_API\" rel=\"nofollow noreferrer\">This</a> discusses the topic."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531855785, "post_id": 51388630, "comment_id": 89749798, "body": "@IInspectable Although, in a traditional object-oriented framework, you don\u2019t register a function pointer per instance to implement a member function; you would declare a subclass of your hypothetical <code>class UrWindow</code> that overrides the virtual member callback function."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531856020, "post_id": 51388630, "comment_id": 89749915, "body": "There&#39;s also lots of COM in the Windows API. COM immediately supports encapsulation, specialization, and polymorphism. @Davislor: You can&#39;t do that in C. In C, registering function pointers is a common way to implement custom behavior."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 1, "creation_date": 1531856638, "post_id": 51388630, "comment_id": 89750219, "body": "@IInspectable Back in the mid-\u201990s, when I was writing in Modula-2, I would have called that \u201cobject-based, but not object-oriented.\u201d"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531856760, "post_id": 51388630, "comment_id": 89750265, "body": "@Davislor: What feature specifically is missing in COM to call it <i>&quot;object-based&quot;</i> rather than <i>&quot;object-oriented&quot;</i>?"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531857017, "post_id": 51388630, "comment_id": 89750402, "body": "@IInspectable Not COM, but the Windows API functions where the equivalent of overriding member functions is supplying an arbitrary pointer to a callback function."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1531857776, "post_id": 51388630, "comment_id": 89750713, "body": "It shows pretty clear signs of having been inspired by OOP work.  Hard to trace it though, I think Xerox PARC was at least partly involved.  Smalltalk-80 and Altos work was well known when Microsoft started on Windows, message passing was a core concept in the language.  The notion of a window class was clearly inspired.  No credits were given so hard to be sure.  In general OOP was the hot topic in middle 80s."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531858533, "post_id": 51388630, "comment_id": 89751089, "body": "@Davislor: Supplying an arbitrary pointer to a callback function is precisely, how COM is implemented. You seem to be confusing the mechanics with the goal."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531859648, "post_id": 51388630, "comment_id": 89751613, "body": "@IInspectable It\u2019s been a while since I read the documentation, but I think the difference here is that conventional OOP languages <i>don\u2019t</i> let you assign arbitrary function pointers to member functions, or create new kinds of classes at runtime. The compiler statically analyzes whether your polymorphism is type-safe."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531860417, "post_id": 51388630, "comment_id": 89751962, "body": "@Davislor: That may be a choice some language designers have chosen. But that has no effect on what is and what isn&#39;t object-oriented. What&#39;s more, the .NET CLR has support to create new types, at runtime. A platform you have identified as <i>&quot;object-oriented&quot;</i> in your answer. Again, you seem to be confusing the mechanics with the goal."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531860985, "post_id": 51388630, "comment_id": 89752201, "body": "@IInspectable I also said that COM is object-oriented. Perhaps you misread me as saying the opposite? There are similarities to window classes you register with <code>RegisterClassEx()</code> and a class with a virtual <code>.WindowProc()</code> member function, but you don\u2019t have a class hierarchy where you overload them, you don\u2019t implement a selection of interfaces, and you don\u2019t use language support."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531863607, "post_id": 51388630, "comment_id": 89753264, "body": "@Davislor: I didn&#39;t misread that. According to you, COM is object-oriented. COM is implemented by supplying arbitrary pointers to callback functions. According to you, supplying arbitrary pointers to callback functions cannot build an object-oriented system. One of those statements cannot be correct."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531867223, "post_id": 51388630, "comment_id": 89754348, "body": "@IInspectable COM uses function pointers, but not all code that uses function pointers is object-oriented. In particular, COM has interfaces.  It imposes a lot more structure."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1531873414, "post_id": 51388630, "comment_id": 89755670, "body": "That is not an example of polymorphism, the API simply recasts <code>LPARAM</code> back to a <code>LPSTR</code> internally, because when <code>Msg</code> is <code>WM_SETTEXT</code> that is what <code>lParam</code> actually is. Maybe <code>HWND</code> is an object, I&#39;d bet it probably is, but the APIs are most certainly not it&#39;s methods. The methods are handled internally by the API implementation."}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1531901005, "post_id": 51388630, "comment_id": 89764334, "body": "@Havenard HWND is a pointer and the pointer is meaningless in user-mode other than to say &quot;I want to represent window XXXX with this handle!&quot;. Anyway, win32k.sys/win32kfull.sys plays a part with these GUI topics. That is why User32.dll heavily relies on Win32u and why Win32u supports system call transition (NTOSKRNL -&gt; KeServiceDescriptorTableShadow -&gt; win32k.sys). In Windows Kernel, tables track dished out handles so it knows the pointer to a structure later on when it gets given a handle - also how Windows knows when a process tries to use a handle it was not consented to use."}, {"owner": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "reply_to_user": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "edited": false, "score": 0, "creation_date": 1531915517, "post_id": 51388630, "comment_id": 89773857, "body": "@ImmortaleVBR Yes friend, we all know that <code>HWND</code> is provided to us as a pointer, the talk here is about what it really means behind the scenes. Every object is handled around as a pointer, even <code>this</code> is a pointer."}, {"owner": {"reputation": 592, "user_id": 9953712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zXEAZ.jpg?s=128&g=1", "display_name": "ImmortaleVBR", "link": "https://stackoverflow.com/users/9953712/immortalevbr"}, "reply_to_user": {"reputation": 23069, "user_id": 156811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380335e95e6be9740e56b64d667279b3?s=128&d=identicon&r=PG", "display_name": "Havenard", "link": "https://stackoverflow.com/users/156811/havenard"}, "edited": false, "score": 0, "creation_date": 1531958766, "post_id": 51388630, "comment_id": 89796711, "body": "@Havenard Don&#39;t mind me, I wasn&#39;t trying to say you said anything wrong. I didn&#39;t read any of this properly, I just glanced and didn&#39;t see anyone mention win32k.sys/win32full.sys, so just posted it. Since what I said was off-topic, I&#39;ll delete it if I am asked to and will understand."}], "answers": [{"comments": [{"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1531855415, "post_id": 51388805, "comment_id": 89749618, "body": "Calling the CLR <i>&quot;new&quot;</i> is a far stretch. It has been around for almost 2 decades. The new API is called <i>Windows Runtime</i>, which is object oriented in a more traditional meaning. Even though it&#39;s still exposed as a C interface."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 2, "creation_date": 1531856596, "post_id": 51388805, "comment_id": 89750193, "body": "@Davislor While you&#39;re listing OO API&#39;s in the Windows world, COM is probably deserving of at least an honorable mention."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531867889, "post_id": 51388805, "comment_id": 89754558, "body": "A Winsock socket is actually kernel File object, usually opened on &quot;\\Device\\Afd&quot;. You can use it with <code>ReadFile</code> and <code>WriteFile</code>, though in some cases this may come at a cost to performance."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531868005, "post_id": 51388805, "comment_id": 89754593, "body": "On the subject of kernel handles, the executive&#39;s Object Manager implements a type system. Kernel objects are instances of object types (e.g. File, Process, Event, Job), which are in turn instances of the &quot;Type&quot; metatype. The available properties and procedures (methods) are fixed. Each type is also associated with system calls to query and set an extensible set of information and behavior (e.g. <code>NtQueryInformationFile</code>, <code>NtSetInformationFile</code>), but there&#39;s no ability to subclass and extend a type."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531868846, "post_id": 51388805, "comment_id": 89754761, "body": "@eryksun <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinSock/socket-data-type-2\" rel=\"nofollow noreferrer\">The MS documentation says,</a> \u201cIn Winsock applications, a socket descriptor is not a file descriptor and must be used with the Winsock functions.\u201d Winsock2 is different.  So, Winsock has a <code>closesocket()</code> function and Winsock2 can just use the one for files."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531868985, "post_id": 51388805, "comment_id": 89754786, "body": "@eryksun Edited a clarification that \u201cWinsock\u201d meant version 1."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531869016, "post_id": 51388805, "comment_id": 89754796, "body": "I said a socket handle is for a kernel File object, not a C runtime file descriptor. They need to make this distinction clear in the documentation because otherwise people would try to pass sockets to C runtime functions that take CRT file descriptors, and vice versa, which will not work."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531869105, "post_id": 51388805, "comment_id": 89754819, "body": "Other than for historical reasons, there&#39;s no need to talk about Winsock 1.0 from the early 90s."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531869114, "post_id": 51388805, "comment_id": 89754823, "body": "@eryksun Thanks for correcting me, then. On second thought, the paragraph seems extraneous and I cut it."}, {"owner": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531869710, "post_id": 51388805, "comment_id": 89754933, "body": "Windows sockets actually are interesting here. They do kind of subclass the kernel File object, but with an object composition approach. A lot of Winsock behavior is implemented in client-side DLLs. The kernel File handle is associated with state in the client process. This is why it&#39;s still recommend to use <code>WSADuplicateSocket</code> in the source process and <code>WSASocket</code> in the target process instead of using generic handle inheritance or <code>DuplicateHandle</code>."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 29355, "user_id": 205580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/460e6e299e385fd46df156c85a1dd55f?s=128&d=identicon&r=PG", "display_name": "Eryk Sun", "link": "https://stackoverflow.com/users/205580/eryk-sun"}, "edited": false, "score": 0, "creation_date": 1531869829, "post_id": 51388805, "comment_id": 89754953, "body": "@eryksun Yes, that is similar to passing around references to polymorphic objects."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1531873050, "post_id": 51388805, "comment_id": 89755618, "body": "@ImmortaleVBR If you declared the type alias <code>using handle = std::uintptr_t;</code> or <code>using handle = const void*;</code> then wrote an API that replaced the hidden <code>this</code> pointer argument with its value cast to a <code>handle</code>, I think the API would be nearly as object-oriented as before. All you\u2019d lose is static type safety."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1531875892, "last_edit_date": 1531875892, "creation_date": 1531855241, "answer_id": 51388805, "question_id": 51388630, "link": "https://stackoverflow.com/questions/51388630/is-windows-api-an-object-oriented-framework/51388805#51388805", "title": "Is Windows API an object-oriented framework?", "body": "<p>File and window handles in Windows are similar to streams, file descriptors in Unix, <code>FILE</code> pointers in the C standard library, and so on.  There\u2019s a similarity between passing an opaque handle to library functions and calling member functions with an implicit <code>this</code> pointer.</p>\n\n<p>Another example that gets closer are window classes that you register with <code>RegisterClassEx()</code>.  This is transitional between a handle-style API and a framework like COM that everyone agrees is \u201cobject-oriented:\u201d you register a structure containing a function pointer, which is much like the member function pointers in a virtual function table.  What you don\u2019t have is any kind of class hierarchy or a selection of interfaces to implement.  You aren\u2019t overriding a default implementation, or inheriting some methods while overriding others.  You\u2019re just passing a structure containing function pointers.</p>\n\n<p>The distinction can get fuzzy.  If you look at the family of languages designed by Nicholas Wirth, Pascal is a traditional structured, imperative language inspired by Algol, and Modula, Modula-2 and Oberon evolve experimentally in an object-oriented direction.  At the time, these intermediate languages were called \u201cobject-based.\u201d By the mid-\u201990s, languages such as Delphi and Object Pascal fit the object-oriented paradigm.</p>\n\n<p>However, libraries similar to those of the late \u201970s generally are not called \u201cobject-oriented.\u201d  In particular, they don\u2019t have a class hierarchy with inheritance.  Neither does the client application manage instances itself, with their creation and destruction automated to prevent memory leaks.</p>\n\n<p>When the C API does do things similar to polymorphism and inheritance, such as being able to supply a pointer to a callback function, it does it in a different way.  In a conventional object-oriented language, you would statically define a derived class of a window that overrides a virtual member function, not supply an arbitrary function pointer to call back (although there is some similarity to the object-oriented visitor pattern).</p>\n\n<p>Things like the similarly-named \u201cwindow classes\u201d are just callbacks.  Even though all implementations of polymorphic objects are built on top of structures containing function pointers, not all programs that use callback functions are object-oriented.  An example closer to object-oriented programming is how Winsock 2 makes socket descriptors a special type of file descriptors that can be passed to the kernel file functions (with a cast).  If we had an object-oriented API that renamed the member functions as global functions, made the implicit <code>this</code> pointer an explicit argument, then cast it to an opaque handle, it\u2019d still be mostly object-oriented.  The only things it would lose would be static type safety and encapsulation.  Even more OOP-like, to the point where I would definitely call it OOP, is the Component Object Model and its successors, in which objects implement interfaces.</p>\n\n<p>There have been several \u201cobject-oriented\u201d APIs for Windows, including the Microsoft Foundation Classes, Borland\u2019s Object Windows Library, Object Linking and Embedding, the newer Component Object Model and Common Language Runtime libraries, and the even newer Windows Runtime.</p>\n"}], "owner": {"reputation": 121, "user_id": 6703696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bcd40d7740bb9ced371b78b85345cc39?s=128&d=identicon&r=PG&f=1", "display_name": "joseph_m", "link": "https://stackoverflow.com/users/6703696/joseph-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531875892, "creation_date": 1531854466, "question_id": 51388630, "link": "https://stackoverflow.com/questions/51388630/is-windows-api-an-object-oriented-framework", "title": "Is Windows API an object-oriented framework?", "body": "<p>When you create a control object (an <code>HWND</code>) in Windows API, you are not allowed to access the members of the control object directly, you can only access it through specific functions, which is a characteristic of OOP.</p>\n\n<p>Also, Windows API supports Polymorphism, for example I can have the following function:</p>\n\n<pre><code>void setHwndText(HWND hwnd)\n{\n    SendMessage(hwnd, WM_SETTEXT, 0, (LPARAM)\"Hello World\");\n}\n</code></pre>\n\n<p>The above function can change the text of many types of objects and not just one type, for example it can change the title of a window, the text of an edit control, and the caption of a button control.</p>\n\n<p>I don't know if Windows API supports Inheritance, but even if it didn't, I think the main purpose of Inheritance in OOP is to allow Polymorphism, which Windows API do support as I have showed.</p>\n\n<p>Does that mean that Windows API can be considered an object-oriented framework?</p>\n"}, {"tags": ["c", "fcntl"], "comments": [{"owner": {"reputation": 436, "user_id": 2877127, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XfI3Z.jpg?s=128&g=1", "display_name": "RLe", "link": "https://stackoverflow.com/users/2877127/rle"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531861868, "post_id": 51388456, "comment_id": 89752610, "body": "@AnttiHaapala sorry, i changed the question"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531880546, "post_id": 51388456, "comment_id": 89757102, "body": "Ok a single sentence makes it much clearer :D"}], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 2877127, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XfI3Z.jpg?s=128&g=1", "display_name": "RLe", "link": "https://stackoverflow.com/users/2877127/rle"}, "edited": false, "score": 0, "creation_date": 1531861776, "post_id": 51388990, "comment_id": 89752577, "body": "Hi, if i change the code like that, i got it print out as &quot;File is locked by pid 0&quot;. And also, both process are being &quot;locked&quot; at the same time."}], "tags": [], "owner": {"reputation": 21, "user_id": 9796918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f000a9f6e9fbc8ffc65415c9fe5461c?s=128&d=identicon&r=PG&f=1", "display_name": "Tom D", "link": "https://stackoverflow.com/users/9796918/tom-d"}, "is_accepted": false, "score": 0, "last_activity_date": 1531856054, "creation_date": 1531856054, "answer_id": 51388990, "question_id": 51388456, "link": "https://stackoverflow.com/questions/51388456/fcntl-how-to-know-which-process-hold-lock-file/51388990#51388990", "title": "fcntl how to know which process hold lock file?", "body": "<p>From the example code:</p>\n\n<pre><code>printf (\"locking\\n\");\n/* Initialize the flock structure. */\nmemset (&amp;lock, 0, sizeof(lock));\nlock.l_type = F_WRLCK;\n/* Place a write lock on the file. */\nfcntl (fd, F_SETLKW, &amp;lock);\n\nprintf (\"locked; hit Enter to unlock... \");\n</code></pre>\n\n<p>You need to change the <code>fcntl (fd, F_SETLKW, &amp;lock);</code> to:</p>\n\n<pre><code>if (fcntl (fd, F_SETLK, &amp;lock) == -1) {\n  printf (\"File is locked by pid %i\\n\", lock.l_pid);\n  return 0;\n}\n</code></pre>\n\n<p>The F_SETLKW command blocks if it cannot get the lock.  F_SETLK will return if it cannot get the lock.  Really the code should also check <code>errno == EACCESS</code> or <code>errno == EAGAIN</code> after getting the -1 return value.</p>\n"}, {"comments": [{"owner": {"reputation": 436, "user_id": 2877127, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XfI3Z.jpg?s=128&g=1", "display_name": "RLe", "link": "https://stackoverflow.com/users/2877127/rle"}, "edited": false, "score": 0, "creation_date": 1531864691, "post_id": 51390600, "comment_id": 89753599, "body": "Thanks. the part     if (fcntl(fd, F_GETLK, &amp;lock) == 0 &amp;&amp; lock.l_pid &gt; 0) works great!"}], "tags": [], "owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "is_accepted": true, "score": 3, "last_activity_date": 1531864143, "last_edit_date": 1531864143, "creation_date": 1531863706, "answer_id": 51390600, "question_id": 51388456, "link": "https://stackoverflow.com/questions/51388456/fcntl-how-to-know-which-process-hold-lock-file/51390600#51390600", "title": "fcntl how to know which process hold lock file?", "body": "<p>As the <a href=\"http://man7.org/linux/man-pages/man2/fcntl.2.html\" rel=\"nofollow noreferrer\"><code>man 2 fcntl</code></a> page describes, you can use the <code>F_GETLK</code> to obtain the process ID that has the conflicting lock (if the conflicting lock is a process-associated one). So, for example,</p>\n\n<pre><code>/* Return 0 if descriptor locked exclusively, positive PID if\n   a known process holds a conflicting lock, or -1 if the\n   descriptor cannot be locked (and errno has the reason).\n*/\nstatic pid_t  lock_exclusively(const int fd)\n{\n    struct flock  lock;\n    int           err = 0;\n\n    if (fd == -1) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    lock.l_type = F_WRLCK;\n    lock.l_whence = SEEK_SET;\n    lock.l_start = 0;\n    lock.l_len = 0;\n    if (!fcntl(fd, F_SETLK, &amp;lock))\n        return 0;\n\n    /* Remember the cause of the failure */\n    err = errno;\n\n    lock.l_type = F_WRLCK;\n    lock.l_whence = SEEK_SET;\n    lock.l_start = 0;\n    lock.l_len = 0;\n    lock.l_pid = 0;\n    if (fcntl(fd, F_GETLK, &amp;lock) == 0 &amp;&amp; lock.l_pid &gt; 0)\n        return lock.l_pid;\n\n    errno = err;\n    return -1;\n}\n</code></pre>\n\n<p>Do note that <code>fd</code> must be open for reading and writing. I recommend using <code>open(path, O_RDWR | O_NOCTTY)</code> or <code>open(path, O_WRONLY | O_NOCTTY)</code>. Closing <em>any</em> file descriptor to the same file will release the lock.</p>\n\n<p>Some may say that re-setting the <code>lock</code> memebers before the second <code>fcntl()</code> call is unnecessary, but I'd rather err on the side of caution here.</p>\n\n<p>As to how to report it, I would simply use</p>\n\n<pre><code>int    fd;\npid_t  p;\n\nfd = open(path, O_RDWR | O_NOCTTY);\nif (fd == -1) {\n    fprintf(stderr, \"%s: Cannot open file: %s.\\n\",\n                    path, strerror(errno));\n    exit(EXIT_FAILURE);\n}\n\np = lock_exclusively(fd);\nif (p &lt; 0) {\n    fprintf(stderr, \"%s: Cannot lock file: %s.\\n\",\n                    path, strerror(errno));\n    exit(EXIT_FAILURE);\n} else\nif (p &gt; 0) {\n    fprintf(stderr, \"%s: File is already locked by process %ld.\\n\",\n                    path, (long)p);\n    exit(EXIT_FAILURE);\n}\n\n/* fd is now open and exclusive-locked. */\n</code></pre>\n\n<p>The user can always run e.g. <code>ps -o cmd= -p PID</code> to see what command that is (or you can try reading <code>/proc/PID/cmdline</code> in Linux).</p>\n"}], "owner": {"reputation": 436, "user_id": 2877127, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/XfI3Z.jpg?s=128&g=1", "display_name": "RLe", "link": "https://stackoverflow.com/users/2877127/rle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1091, "favorite_count": 0, "accepted_answer_id": 51390600, "answer_count": 2, "score": 0, "last_activity_date": 1531864143, "creation_date": 1531853585, "last_edit_date": 1531861849, "question_id": 51388456, "link": "https://stackoverflow.com/questions/51388456/fcntl-how-to-know-which-process-hold-lock-file", "title": "fcntl how to know which process hold lock file?", "body": "<p>I'm new with fcntl locking and following this example to create a sample lock in linux using c code: <a href=\"http://www.informit.com/articles/article.aspx?p=23618&amp;seqNum=4\" rel=\"nofollow noreferrer\">http://www.informit.com/articles/article.aspx?p=23618&amp;seqNum=4</a></p>\n\n<p>I wonder how can we can print out which process hold the lock file and which process is waiting for lock. I consider using l_pid to figure out the process id which is holding the lock but i'm not sure the right way to do it.\nWhat is the best way to print out which process is holding the lock?</p>\n"}, {"tags": ["c", "c11"], "comments": [{"owner": {"reputation": 71860, "user_id": 366377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863018588657c38d29f22e72dc81325e?s=128&d=identicon&r=PG", "display_name": "Jens Gustedt", "link": "https://stackoverflow.com/users/366377/jens-gustedt"}, "edited": false, "score": 3, "creation_date": 1531853791, "post_id": 51388341, "comment_id": 89748837, "body": "<code>static_assert</code> is meant to be usable outside functions, too. Therefore syntactically it can&#39;t be an expression. But for my curiosity, I didn&#39;t really get why you would need that, and cannot just place it before the declaration."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531854790, "post_id": 51388341, "comment_id": 89749304, "body": "Do you have a more concrete example of where you would use this?  There may be a better way."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 2, "creation_date": 1531855202, "post_id": 51388341, "comment_id": 89749505, "body": "my guess is a <i>function-like macro</i>? Within a macro you can use a <i>very crude</i> trick - a bitfield with negative width for example, this will fail at compile time because it doesn&#39;t make any sense."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533548387, "post_id": 51388341, "comment_id": 90370120, "body": "I don&#39;t quite see why you need this, but you <i>could</i> create a function containing nothing but a static assert. The optimizer will remove it since it contains no run-rime code."}, {"owner": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "edited": false, "score": 0, "creation_date": 1533637019, "post_id": 51388341, "comment_id": 90408859, "body": "Functions can&#39;t access their callee&#39;s variables, so i can&#39;t assert over anything but global consts this way."}], "answers": [{"tags": [], "owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "is_accepted": false, "score": 6, "last_activity_date": 1531859215, "last_edit_date": 1531859215, "creation_date": 1531853389, "answer_id": 51388402, "question_id": 51388341, "link": "https://stackoverflow.com/questions/51388341/is-there-any-way-to-slip-a-static-assert-into-an-expression-in-iso-c11/51388402#51388402", "title": "Is there any way to slip a _Static_assert into an expression in ISO C11?", "body": "<p><code>_Static_assert</code> is, unfortunately, a special kind of <em>declaration</em>, not a function or an operator. You won't be able to slip it into an expression, unless you use something non-standard. E.g. compiler extensions like GCC's \"statement expressions\"</p>\n\n<pre><code>int b = ({ _Static_assert(2 &gt; 1, \"all is lost\"); 304; });\n</code></pre>\n\n<p>or</p>\n\n<pre><code>int b = (({ _Static_assert(2 &gt; 1, \"all is lost\"); }), 304);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "edited": false, "score": 0, "creation_date": 1570470637, "post_id": 58263525, "comment_id": 102915944, "body": "Nice hack. Too bad it turns out gcc thinks <code>const</code> variables that are assigned constant values aren&#39;t in fact constants, so i can&#39;t use them in static asserts."}, {"owner": {"reputation": 290304, "user_id": 187690, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/89a4da7af5bf1558b7d2704309f1f118?s=128&d=identicon&r=PG", "display_name": "AnT", "link": "https://stackoverflow.com/users/187690/ant"}, "reply_to_user": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "edited": false, "score": 1, "creation_date": 1570475103, "post_id": 58263525, "comment_id": 102917892, "body": "@L29Ah: That&#39;s not just something &quot;gcc thinks&quot;. That&#39;s how C language is defined. In C <code>const</code> variables do not form constant expressions."}], "tags": [], "owner": {"reputation": 429, "user_id": 427397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d829c64aa80b3502b79b45ce22c9e4cd?s=128&d=identicon&r=PG", "display_name": "dpercy", "link": "https://stackoverflow.com/users/427397/dpercy"}, "is_accepted": true, "score": 3, "last_activity_date": 1570422388, "creation_date": 1570422388, "answer_id": 58263525, "question_id": 51388341, "link": "https://stackoverflow.com/questions/51388341/is-there-any-way-to-slip-a-static-assert-into-an-expression-in-iso-c11/58263525#58263525", "title": "Is there any way to slip a _Static_assert into an expression in ISO C11?", "body": "<p>This is doable in ISO C11. The trick is to put <code>_Static_assert</code> in a struct declaration, in a sizeof expression:</p>\n\n<pre><code>sizeof(struct { _Static_assert(0, \"yay it failed\"); int dummy; })\n</code></pre>\n\n<p>The dummy field is necessary because <code>empty struct is a GNU extension</code>, according to <code>clang -std=c11 -Weverything</code>.</p>\n"}], "owner": {"reputation": 238, "user_id": 4095104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b0868543591a528f3c39136447fc94d?s=128&d=identicon&r=PG", "display_name": "L29Ah", "link": "https://stackoverflow.com/users/4095104/l29ah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 2, "accepted_answer_id": 58263525, "answer_count": 2, "score": 7, "last_activity_date": 1570422388, "creation_date": 1531853093, "question_id": 51388341, "link": "https://stackoverflow.com/questions/51388341/is-there-any-way-to-slip-a-static-assert-into-an-expression-in-iso-c11", "title": "Is there any way to slip a _Static_assert into an expression in ISO C11?", "body": "<p>In C11 it is legal to write, for instance:</p>\n\n<pre><code>int b = (some_function_returning_void(), 1020);\n</code></pre>\n\n<p>And you'll get back 1020.  But it won't let you write:</p>\n\n<pre><code>int b = (_Static_assert(2 &gt; 1, \"all is lost\"), 304);\n</code></pre>\n\n<p>gcc returning</p>\n\n<pre><code>error: expected expression before '_Static_assert'\n</code></pre>\n\n<p>And it would be inconvenient to use <code>_Static_assert</code> outside of an expression sometimes since you're out of luck with preprocessor macros-based pseudo-functions that verify their arguments then.</p>\n"}, {"tags": ["c", "bit-manipulation", "built-in"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1531851732, "post_id": 51387998, "comment_id": 89747831, "body": "Because it is using HW instruction"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531851831, "post_id": 51387998, "comment_id": 89747876, "body": "What&#39;s HW instruction?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531851916, "post_id": 51387998, "comment_id": 89747910, "body": "It&#39;s assembler?"}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 3, "creation_date": 1531852037, "post_id": 51387998, "comment_id": 89747969, "body": "HW = hardware instruction"}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 1, "creation_date": 1531852091, "post_id": 51387998, "comment_id": 89747996, "body": "You can use the intel intrinsic variant instead if you want something portable across other compilers: <code>_mm_popcnt_u64()</code>, and then include <code>&lt;nmmintrin.h&gt;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531852267, "post_id": 51387998, "comment_id": 89748096, "body": "I may use it on a PIC and maybe on non-intel processors. It will still work?"}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1531852388, "post_id": 51387998, "comment_id": 89748155, "body": "I&#39;m not certain of the non-intel processors part, but position independent code is not an issue. I will check on the non-intel variants"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531852398, "post_id": 51387998, "comment_id": 89748159, "body": "No, @TheCrow.  It&#39;s not even very portable across Intel-based platforms.  For instance, although I was a bit surprised to find that my GCC in fact recognized <code>nmmintrin.h</code> at all, it did not successfully compile even a trivial program that included that header."}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531853075, "post_id": 51387998, "comment_id": 89748497, "body": "@JohnBollinger I was able to reproduce that issue, but discovered the problem- the intrinsics are specified to always inline, but unless you specify an architecture the inlining fails. Use the compiler flag <code>-march=native</code> for example, to get it to compile."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1531853278, "post_id": 51387998, "comment_id": 89748584, "body": "@DillonDavis, which works for GCC specifically, at least for architectures that are actually supported.  I&#39;m not seeing how that does much to bolster the portability assertion."}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531853537, "post_id": 51387998, "comment_id": 89748695, "body": "@JohnBollinger in the original question, OP only questions portability in regards to which compiler is used. If it also needs to be portable in regards to target architecture, then intel intrinsics would not be the way to go."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531853864, "post_id": 51387998, "comment_id": 89748874, "body": "That&#39;s right, I edited my question, now it&#39;s focused on portability."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1531855929, "post_id": 51387998, "comment_id": 89749876, "body": "@DillonDavis, I&#39;m saying that &quot;it works if you can figure out the right compiler options&quot; is not a strong argument for portability."}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 0, "creation_date": 1531884087, "post_id": 51387998, "comment_id": 89757910, "body": "See salso <a href=\"https://stackoverflow.com/questions/109023/how-to-count-the-number-of-set-bits-in-a-32-bit-integer\">this question</a> for additional techniques."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1532567097, "post_id": 51387998, "comment_id": 90027394, "body": "@JohnBollinger you don&#39;t need to worry about portability on gcc/clang targets, just use <code>__builtin__popcount</code> and it&#39;ll use the bit count instruction if available, otherwise it&#39;ll use <a href=\"https://godbolt.org/g/vkjZm4\" rel=\"nofollow noreferrer\">some optimized procedure for that architecture</a>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531852568, "post_id": 51388167, "comment_id": 89748239, "body": "<code>__builtin_popcount()</code> uses a hardware instruction on platforms that have a suitable one, at least, agreed.  But I cannot agree with recommending <code>_mm_popcount_u*()</code> as being particularly more portable."}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531853398, "post_id": 51388167, "comment_id": 89748629, "body": "@JohnBollinger updated to mention the trade-off between compiler portability and architecture portability."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1532567057, "post_id": 51388167, "comment_id": 90027387, "body": "it only uses are hardware instruction if the hardware supports it, otherwise <a href=\"https://godbolt.org/g/vkjZm4\" rel=\"nofollow noreferrer\">it translates to an optimized function</a>"}], "tags": [], "owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "is_accepted": false, "score": 1, "last_activity_date": 1591263400, "last_edit_date": 1591263400, "creation_date": 1531852278, "answer_id": 51388167, "question_id": 51387998, "link": "https://stackoverflow.com/questions/51387998/count-bits-1-on-an-integer-as-fast-as-gcc-builtin-popcountint/51388167#51388167", "title": "Count bits 1 on an integer as fast as GCC __builtin__popcount(int)", "body": "<p>The <code>__builtin__popcount(unsigned int)</code> is so fast because it is a gcc extension that utilizes a builtin hardware instruction. If you are willing to trade architecture portability for compiler portability, look into the just-as-fast intel intrinsic functions, specifically:</p>\n\n<pre><code>_mm_popcnt_u32(unsigned __int32);\n_mm_popcnt_u64(unsigned __int64);\n</code></pre>\n\n<p>You must then include the <code>&lt;mmintrin.h&gt;</code> header file to use these intrinsic functions, however they will work with non-gcc compilers. You may also have to supply a target architecture to get the functions to inline (which is strictly required), using something like <code>-march=native</code>.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531857335, "post_id": 51388543, "comment_id": 89750536, "body": "Your implementation is very good, it&#39;s faster than mine for smalls inputs (which is almost all cases). Thanks!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": false, "score": 3, "last_activity_date": 1531855722, "last_edit_date": 1531855722, "creation_date": 1531854014, "answer_id": 51388543, "question_id": 51387998, "link": "https://stackoverflow.com/questions/51387998/count-bits-1-on-an-integer-as-fast-as-gcc-builtin-popcountint/51388543#51388543", "title": "Count bits 1 on an integer as fast as GCC __builtin__popcount(int)", "body": "<p>As others have mentioned,  <code>__buildin__popcount()</code> is fast because it uses a single x86 instruction.  </p>\n\n<p>If you want something faster than what you have that doesn't use anything processor or compiler specific you can create a lookup table with 256 entries:</p>\n\n<pre><code>int bitcount[] = {\n    0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4,\n    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n    1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n    2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6,\n    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n    3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7,\n    4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8,\n};\n</code></pre>\n\n<p>Then use that to get the bit count of each byte:</p>\n\n<pre><code>int countBit1Fast(int n) \n{\n    int i, count = 0;\n    unsigned char *ptr = (unsigned char *)n;\n    for (i=0;i&lt;sizeof(int);i++) {\n        count += bitcount[ptr[i]];\n    }\n    return count;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "edited": false, "score": 0, "creation_date": 1531857177, "post_id": 51388846, "comment_id": 89750468, "body": "Great answer. Thanks!"}, {"owner": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 1, "creation_date": 1531857322, "post_id": 51388846, "comment_id": 89750530, "body": "@TheCrow if you&#39;re looking to roll your own implementation instead of using a builtin, I&#39;d suggest taking a look at <a href=\"https://graphics.stanford.edu/~seander/bithacks.html#CountBitsSetNaive\" rel=\"nofollow noreferrer\">this collection</a> of bitwise arithmetic tricks."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "reply_to_user": {"reputation": 3898, "user_id": 6221024, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-JHtD0ON5o_w/AAAAAAAAAAI/AAAAAAAAABw/1B5Y7p2C-g4/photo.jpg?sz=128", "display_name": "Dillon Davis", "link": "https://stackoverflow.com/users/6221024/dillon-davis"}, "edited": false, "score": 0, "creation_date": 1531857691, "post_id": 51388846, "comment_id": 89750675, "body": "@Dillon Davis nice collection, thanks. I will surely read soon."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 5, "last_activity_date": 1531856411, "last_edit_date": 1531856411, "creation_date": 1531855394, "answer_id": 51388846, "question_id": 51387998, "link": "https://stackoverflow.com/questions/51387998/count-bits-1-on-an-integer-as-fast-as-gcc-builtin-popcountint/51388846#51388846", "title": "Count bits 1 on an integer as fast as GCC __builtin__popcount(int)", "body": "<blockquote>\n  <p>I write a algorithm (taken from \"The C Programming Language\") that counts the number of 1-bits very fast:</p>\n</blockquote>\n\n<p>I don't see why anyone would characterize your approach as \"very fast\".  It's a bit clever, and it should be faster on average than naive alternatives.  It also does not depend on the width of the representation of <code>int</code>, which is a plus.  I observe that it has undefined behavior for negative arguments, but that's a common theme for bitwise operators and functions.</p>\n\n<p>Let's analyze, supposing a non-negative argument:</p>\n\n<pre><code>int c = 0;\nfor (; n; ++c)\n    n &amp;= n - 1;\n</code></pre>\n\n<ul>\n<li><p>How many loop iterations are performed?</p>\n\n<p>1 for each 1 bit in the binary representation of the value, irrespective of <em>where</em> in the value each bit lies</p></li>\n<li><p>How much work is performed per iteration</p>\n\n<ul>\n<li>one increment of <code>c</code></li>\n<li>one comparison of <code>n</code> against zero (plus one more of these when breaking out of the loop)</li>\n<li>one decrement of <code>n</code> by 1</li>\n<li>one bitwise 'and'</li>\n</ul>\n\n<p>That ignores reads and stores, which very likely can be made free or especially cheap by keeping the operands in registers.  If we assume equal cost for each of those, that's four operations per iteration.  For random 32-bit integers, there will be an average of 16 iterations, for a total of <strong>65 operations on average</strong>.  (Best case is just one operation, but worst is 129, which is no better than a naive implementation).</p></li>\n</ul>\n\n<p><code>__builtin__popcount()</code>, on the other hand, uses <strong>a single instruction</strong> regardless of input on platforms that support it, such as yours very likely is.  Even on those that don't have a for-purpose instruction, however, it can be done faster (on average).  </p>\n\n<p>@dbush has presented one such mechanism that has similar advantages to the one you present.  In particular, it does not depend on a pre-chosen integer width, and although it does depend on <em>where</em> in the representation the 1 bits reside, it does run faster for some arguments (smaller ones) than others.  If I'm counting right, that one will average <strong>around 20 operations</strong> on random 32-bit inputs: five in each of four loop iterations (only 0.4% of random inputs would require fewer than four iterations).  I'm counting one table read per iteration there, which I assume can be served from cache, but which is probably still not as fast as an arithmetic operation on values already held in registers.</p>\n\n<p>One that is strictly computational would be:</p>\n\n<pre><code>int countBit1Fast(uint32_t n) {\n    n = (n &amp; 0x55555555u) + ((n &gt;&gt; 1) &amp; 0x55555555u);\n    n = (n &amp; 0x33333333u) + ((n &gt;&gt; 2) &amp; 0x33333333u);\n    n = (n &amp; 0x0f0f0f0fu) + ((n &gt;&gt; 4) &amp; 0x0f0f0f0fu);\n    n = (n &amp; 0x00ff00ffu) + ((n &gt;&gt; 8) &amp; 0x00ff00ffu);\n    n = (n &amp; 0x0000ffffu) + ((n &gt;&gt;16) &amp; 0x0000ffffu);\n    return n;\n}\n</code></pre>\n\n<p>That's pretty easy to count: five additions, five shifts, and ten bitwise 'and' operations, and 5 loads of constants for a total of <strong>25 operations</strong> for every input (and it goes up only to 30 for 64-bit inputs, though those are now 64-bit operations instead of 32-bit ones).  This version is, however, intrinsically dependent on a particular size of the input data type.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7336312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3060, "favorite_count": 0, "accepted_answer_id": 51388846, "answer_count": 3, "score": 4, "last_activity_date": 1591263400, "creation_date": 1531851668, "last_edit_date": 1531853823, "question_id": 51387998, "link": "https://stackoverflow.com/questions/51387998/count-bits-1-on-an-integer-as-fast-as-gcc-builtin-popcountint", "title": "Count bits 1 on an integer as fast as GCC __builtin__popcount(int)", "body": "<p>I write a algorithm (taken from \"The C Programming Language\") that counts the number of 1-bits very fast:</p>\n\n<pre><code>int countBit1Fast(int n)\n{\n    int c = 0;\n    for (; n; ++c)\n        n &amp;= n - 1;\n    return c;\n}\n</code></pre>\n\n<p>But a friend told me that <code>__builtin__popcount(int)</code> is a lot faster, but less portable. I give it a try and was MANY times faster! Why it's so fast? I want to count bits as fast as possible, but without stick to a particular compiler.</p>\n\n<p><strong>EDIT:</strong> I may use it on PIC micro-controllers and maybe on non-intel processors, so I need the maximum portability. </p>\n"}, {"tags": ["c", "makefile"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531851119, "post_id": 51387854, "comment_id": 89747558, "body": "<code>*.c</code> are not programs but source codes that cannot &quot;run&quot;."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531851119, "post_id": 51387854, "comment_id": 89747560, "body": "Define &quot;at once&quot;. Do you mean sequentially or concurrently? Can you launch them as background processes using <code>&amp;</code>? Each of these will need to be compiled first, then run. Does the failure of one to compile halt the whole process? Can you compile all of these into one executable?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531851177, "post_id": 51387854, "comment_id": 89747590, "body": "I have a feeling that the OP just wants to compile 9 different source files into 9 executables."}, {"owner": {"reputation": 3612, "user_id": 1813336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1zONI.jpg?s=128&g=1", "display_name": "cleblanc", "link": "https://stackoverflow.com/users/1813336/cleblanc"}, "edited": false, "score": 0, "creation_date": 1531851886, "post_id": 51387854, "comment_id": 89747890, "body": "You&#39;re on the right track, write a <code>Makefile</code> and then ask some questions if it&#39;s not working."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1531852126, "post_id": 51387854, "comment_id": 89748024, "body": "You&#39;re going to need to take some time to understand how the C compiler environment works and what&#39;s involved in linking executables when they have shared code."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1531852293, "post_id": 51387854, "comment_id": 89748111, "body": "Also, it would help to know exactly what you&#39;re going to do to produce nine different programs from the same source?  Will they have similar but slightly different functionality?  Or will they simply be nine copies of the same program?"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 2, "creation_date": 1531852591, "post_id": 51387854, "comment_id": 89748255, "body": "How is this question related to this seemingly very similar one?  <a href=\"https://stackoverflow.com/questions/51355296/makefile-giving-duplicate-error-c/51355386#51355386\" title=\"makefile giving duplicate error c\">stackoverflow.com/questions/51355296/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 0, "creation_date": 1531853750, "post_id": 51387854, "comment_id": 89748813, "body": "@Yunnosh - the post you pointed is from the same user!"}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531854101, "post_id": 51387854, "comment_id": 89748980, "body": "@Yunnosch : It seems sufficiently different to me; there he was attempting to link multiple <code>main()</code>&#39;s into one executable; learned from that question that cannot be none and what he actually intended is 9 independent executables.  It is probably fair to start a new question to figure our how to do that.  However the answer you linked is almost an answer to this question - except each executable only has one .c dependency."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "edited": false, "score": 0, "creation_date": 1531854621, "post_id": 51387854, "comment_id": 89749232, "body": "<a href=\"https://stackoverflow.com/questions/45813030/how-to-generate-multiple-executable-files-in-one-makefile\" title=\"how to generate multiple executable files in one makefile\">stackoverflow.com/questions/45813030/&hellip;</a> is probably a duplicate of this, asked somewhat more succinctly."}], "answers": [{"comments": [{"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1531861426, "post_id": 51388441, "comment_id": 89752407, "body": "What is <code>$(OBJ)</code>? Why is there no rule using <code>-o $@</code>?."}, {"owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1531862943, "post_id": 51388441, "comment_id": 89753020, "body": "@Jens : copy &amp; paste error collecting fragments form other examples - fixed (I think) - feel free to edit it, or post an answer of your own; this could easily be improved I think with enough make-foo, but probably best to keep it simple so the OP can see how it is works more easily."}], "tags": [], "owner": {"reputation": 76010, "user_id": 168986, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/MqorX.jpg?s=128&g=1", "display_name": "Clifford", "link": "https://stackoverflow.com/users/168986/clifford"}, "is_accepted": false, "score": 2, "last_activity_date": 1531862731, "last_edit_date": 1531862731, "creation_date": 1531853532, "answer_id": 51388441, "question_id": 51387854, "link": "https://stackoverflow.com/questions/51387854/makefile-to-build-multiple-programs-with-main-in-c/51388441#51388441", "title": "Makefile to build multiple programs with Main in C", "body": "<p>You simply need a make with 9 targets - one for each fully linked executable, each with two components ProgramN.c and programs.c, where programs.c and ProgramN.c each have a dependency programs.h.</p>\n\n<p>Something akin to the following (you need complete the <code>...</code> elided parts - and test the macros for your build environment and toolchain):</p>\n\n<pre><code># Compiler, Linker Defines\nCC      = /usr/bin/gcc\nCFLAGS  = -Wall\n\n.PHONY: all\n\n# All targets rule\nall : Program1 Program2 ... Program9\n\n# Individual Program rules\nProgram1 : Program1.o programs.o\n       $(CC) -o $@ $^\n\nProgram2 : Program2.o programs.o\n       $(CC) -o $@ $^\n...\nProgram9 : Program9.o programs.o\n       $(CC) -o $@ $^\n\n# Source file rules\nProgram1.c : programs.h\nProgram2.c : programs.h\n...\nProgram9.c : programs.h\nprograms.c : programs.h\n\n# Compile rule, (.c to .o)\n%.o: %.c\n       $(CC) -c $(CFLAGS) $*.c\n</code></pre>\n\n<p>Make has to build the pseudo target <code>all</code> to do that it finds a rule for each dependency, each of which link ProgramN.o and programs.o.  These .o files do not exist, so mak finds a rule to generate the .o files, there is a generic rule for translating.c to .o, so that is used.</p>\n"}, {"tags": [], "owner": {"reputation": 22495, "user_id": 5382650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/THfCr.png?s=128&g=1", "display_name": "Craig Estey", "link": "https://stackoverflow.com/users/5382650/craig-estey"}, "is_accepted": false, "score": 0, "last_activity_date": 1531857539, "creation_date": 1531857539, "answer_id": 51389332, "question_id": 51387854, "link": "https://stackoverflow.com/questions/51387854/makefile-to-build-multiple-programs-with-main-in-c/51389332#51389332", "title": "Makefile to build multiple programs with Main in C", "body": "<p>With <code>gmake</code> [GNU make], the make can actually be fairly compact with a secondary expansion:</p>\n\n<pre><code># mktgt/Makefile -- make file for mktgt\n#\n# SO: makefile to build multiple programs with main in c\n# SITE: stackoverflow.com\n# SO: 51387854\n\nCFLAGS += -Wall\nCFLAGS += -O2\n\nALL += Program1\nALL += Program2\n###ALL += Program3\n###ALL += Program4\n###ALL += Program5\n###ALL += Program6\n###ALL += Program7\n###ALL += Program8\n###ALL += Program9\n\nOLIST += programs.o\nHDEP += programs.h\n\nSRC = $(addsuffix,.c,$(ALL))\nOBJ = $(addsuffix,.o,$(ALL))\n\nall: $(ALL)\n\n%.o: %.c $(HDEP)\n    cc $(CFLAGS) -c $&lt;\n\n.SECONDEXPANSION:\n\n$(ALL):: $$@.o $(OLIST)\n    cc $(CFLAGS) -o $@ $^\n\nclean:\n    rm -f *.o $(ALL)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "is_accepted": false, "score": 1, "last_activity_date": 1531876874, "creation_date": 1531876874, "answer_id": 51392213, "question_id": 51387854, "link": "https://stackoverflow.com/questions/51387854/makefile-to-build-multiple-programs-with-main-in-c/51392213#51392213", "title": "Makefile to build multiple programs with Main in C", "body": "<p>The actual makefile you need is quite small:</p>\n\n<pre><code>all: Program1 Program2 Program3 Program4 Program5 Program6 Program7 Program8 Program9\n\nProgram%: Program%.o programs.o\n    $(CC) $^ -o $@\n\nProgram%.o: programs.h\nprograms.o: programs.h\n</code></pre>\n\n<p><strong>Done!</strong> To understand how this works, you must start with the commands you would use to build these executables <em>without</em> Make:</p>\n\n<pre><code>cc programs.c -c -o programs.o\ncc Program1.c -c -o Program1.o\ncc Program1.o programs.o -o Program1\n</code></pre>\n\n<p>(Assuming you use cc as your compiler.) It makes sense to build the object files in a separate step (rather than just <code>cc programs.c Program1.c -o Program1</code>) because you can reuse <code>programs.o</code> with all of the executables 1-9.</p>\n\n<p>To write this much as a makefile requires only one rule, not three, because Make already knows how to build <code>foo.o</code> from <code>foo.c</code>. But if you want Make to keep track of when files must be rebuilt, you must tell it which files these objects depend on. So you must specify rules for the object files even if you don't specify the commands in them:</p>\n\n<pre><code>programs.o: programs.h\nProgram1.o: programs.h\nProgram1: Program1.o programs.o\n    $(CC) Program1.o programs.o -o Program1\n</code></pre>\n\n<p>You can make that last rule more concise with <a href=\"https://www.gnu.org/software/make/manual/make.html#Automatic-Variables\" rel=\"nofollow noreferrer\">automatic variables</a>:</p>\n\n<pre><code>Program1: Program1.o programs.o\n    $(CC) $^ -o $@\n</code></pre>\n\n<p>And rather than writing versions of those least two for every program 1-9, you can write <a href=\"https://www.gnu.org/software/make/manual/make.html#Pattern-Rules\" rel=\"nofollow noreferrer\">pattern rules</a>:</p>\n\n<pre><code>Program%.o: programs.h\nProgram%: Program%.o programs.o\n    $(CC) $^ -o $@\n</code></pre>\n\n<p>Then just add one more rule (at the top, so that it's the default) that requires all of the programs:</p>\n\n<pre><code>all: Program1 Program2 ...\n</code></pre>\n"}], "owner": {"reputation": 337, "user_id": 9781768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed70d0c2ec5a7a9b51c4bc892703ecbe?s=128&d=identicon&r=PG&f=1", "display_name": "User9123", "link": "https://stackoverflow.com/users/9781768/user9123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 923, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1531876874, "creation_date": 1531851065, "last_edit_date": 1531851727, "question_id": 51387854, "link": "https://stackoverflow.com/questions/51387854/makefile-to-build-multiple-programs-with-main-in-c", "title": "Makefile to build multiple programs with Main in C", "body": "<p>My goal is to create a makefile that can build 9 programs at once. Ex. Program1.c, Program2.c ... Program9.c.</p>\n\n<p>Once I run make I hope to be able to type ./ProgramN (N being any program 1-9) to make any particular program run.</p>\n\n<p>All programs share the same header file used for function prototypes and struct definitions, called programs.h. Also, all functions used by the 9 programs will be in a file called programs.c. </p>\n\n<p>Can anyone give me a clue on how to do this? </p>\n"}, {"tags": ["java", "c", "java-native-interface"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531848831, "post_id": 51387073, "comment_id": 89746423, "body": "A <code>const jboolean</code> is not a <code>bool</code>. You have to pass <code>SetBooleanArrayRegion()</code> a <code>const jboolean *</code>.  So you need to create a <code>jboolean</code> array."}, {"owner": {"reputation": 29, "user_id": 7022224, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209091749629695/picture?type=large", "display_name": "Branko Andrews", "link": "https://stackoverflow.com/users/7022224/branko-andrews"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531849521, "post_id": 51387073, "comment_id": 89746748, "body": "Right, my question is then how do I convert an already existing bool array to a jboolean array"}], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1531850262, "last_edit_date": 1531850262, "creation_date": 1531849450, "answer_id": 51387433, "question_id": 51387073, "link": "https://stackoverflow.com/questions/51387073/returning-a-boolean-array-from-c-to-java/51387433#51387433", "title": "Returning a boolean array from C to Java", "body": "<blockquote>\n  <p>And I keep getting this error</p>\n  \n  <blockquote>\n    <p>[Warning] passing argument 5 of '(*env)->SetBooleanArrayRegion' from\n    incompatible pointer type.</p>\n  </blockquote>\n  \n  <p>The last argument is supposed to be \"const jboolean *buf\",</p>\n</blockquote>\n\n<p>The warning is telling you that that the the element type of the array you are passing, <code>bool</code>, is not a type compatible with <code>jboolean</code>, as those two types happen to be defined in your environment.  This is not a problem you can ignore, at least not without more details.  There is no reason to expect that the function you are calling will work as expected when you pass an argument that is mismatched in this way.</p>\n\n<blockquote>\n  <p>but I want\n  to be able to copy a regular bool array to a jboolean array.</p>\n</blockquote>\n\n<p>But that's <em>not</em> what you're doing.  You are trying to initialize a <code>jbooleanarray</code> (not \"<code>jboolean</code> array\") from a <code>bool</code> array.  To the extent that <code>bool</code> and <code>jboolean</code> are indeed incompatible, that's not possible via any available JNI function.  But you can set values in a <code>jbooleanarray</code> from a <code>jboolean</code> array, like so:</p>\n\n<pre><code>jboolean passwordProtected[] = {JNI_TRUE, JNI_FALSE, JNI_FALSE};\njbooleanArray passwords;\n\npasswords = (*env)-&gt;NewBooleanArray(env, 3); \n\n(*env)-&gt; SetBooleanArrayRegion(env, passwords, 0, 3, passwordProtected);\n</code></pre>\n\n<hr>\n\n<p>If instead of declaring one locally, you get your <code>bool</code> array from some external source, so that you cannot just switch to <code>jboolean</code>, then your best alternative is probably to obtain a <code>jboolean</code> array from the <code>jbooleanarray</code> via <code>GetBooleanArrayElements</code>, copy the values via an appropriate loop, and then finish up with <code>ReleaseBooleanArrayElements</code>:</p>\n\n<pre><code>bool passwordProtected[] = {true, false, false};\njbooleanArray passwords = (*env)-&gt;NewBooleanArray(env, 3);\njboolean *password_elements = (*env)-&gt;GetBooleanArrayElements(env, passwords, NULL); \n\nfor (int i = 0; i &lt; 3; i++) {\n    password_elements[i] = passwordProtected[i] ? JNI_TRUE : JNI_FALSE;\n}\n\n(*env)-&gt;ReleaseBooleanArrayElements(env, passwords, password_elements, 0);\n</code></pre>\n\n<p>Alternatively, use <code>Get</code>/<code>ReleaseBooleanArrayRegion</code> or <code>Get</code>/<code>ReleaseBooleanArrayCritical</code>, as best matches your needs.</p>\n"}], "owner": {"reputation": 29, "user_id": 7022224, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209091749629695/picture?type=large", "display_name": "Branko Andrews", "link": "https://stackoverflow.com/users/7022224/branko-andrews"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531850262, "creation_date": 1531848043, "last_edit_date": 1531848357, "question_id": 51387073, "link": "https://stackoverflow.com/questions/51387073/returning-a-boolean-array-from-c-to-java", "title": "Returning a boolean array from C to Java", "body": "<p>I am trying to return an array of booleans from c to java via JNI</p>\n\n<pre><code>JNIEXPORT jbooleanArray JNICALL Java_NetworkGUI_passwordProtected(JNIEnv \n*env, jobject obj)\n{\n    bool passwordProtected[3];\n\n    passwordProtected = {true, false, false} \n    jbooleanArray passwords;\n\n    passwords = (*env) -&gt; NewBooleanArray(env, 3); \n\n    (*env)-&gt; SetBooleanArrayRegion(env, passwords, 0, 3, \n     passwordProtected);\n\n    return (passwords);\n}\n</code></pre>\n\n<p>And I keep getting this error</p>\n\n<p>[Warning] passing argument 5 of '(*env)->SetBooleanArrayRegion' from incompatible pointer type. </p>\n\n<p>The last argument is supposed to be \"const jboolean *buf\", but I want to be able to copy a regular bool array to a jboolean array. </p>\n"}, {"tags": ["c", "output"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531847914, "post_id": 51386994, "comment_id": 89745993, "body": "The idea of online challenges is to challenge your skill, not make you to relay this challenge on the SO community."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531847941, "post_id": 51386994, "comment_id": 89746005, "body": "Please try to avoid using <a href=\"https://en.wikipedia.org/wiki/Magic_number_(programming)\" rel=\"nofollow noreferrer\"><i>magic numbers</i></a>. If you with the integer value <code>97</code> mean the <a href=\"https://en.cppreference.com/w/c/language/ascii\" rel=\"nofollow noreferrer\">ASCII</a> character <code>&#39;a&#39;</code> then <i>say</i> so by using the character <code>&#39;a&#39;</code> instead."}, {"owner": {"reputation": 9, "user_id": 6686000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f598890a9542fa1a432a574d260302?s=128&d=identicon&r=PG&f=1", "display_name": "PvzAKho", "link": "https://stackoverflow.com/users/6686000/pvzakho"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531848282, "post_id": 51386994, "comment_id": 89746155, "body": "@EugeneSh. Im sorry ,i had thought about this for a month, but i still dont know how to do , so i want ask someone"}, {"owner": {"reputation": 9, "user_id": 6686000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f598890a9542fa1a432a574d260302?s=128&d=identicon&r=PG&f=1", "display_name": "PvzAKho", "link": "https://stackoverflow.com/users/6686000/pvzakho"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531848329, "post_id": 51386994, "comment_id": 89746172, "body": "@Someprogrammerdude, ok, i will change this habbit"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1532059633, "post_id": 51386994, "comment_id": 89839965, "body": "as part of the text of your question, please post a link to the problem your trying to solve"}], "owner": {"reputation": 9, "user_id": 6686000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f598890a9542fa1a432a574d260302?s=128&d=identicon&r=PG&f=1", "display_name": "PvzAKho", "link": "https://stackoverflow.com/users/6686000/pvzakho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531847698, "creation_date": 1531847698, "question_id": 51386994, "link": "https://stackoverflow.com/questions/51386994/how-to-output-tromino-puzzle-in-this-special-way", "title": "How to output tromino puzzle in this special way?", "body": "<p>I am solving a tromino puzzle problem on a online judge system, and it requires all L-piece should be should be represented by a single lowercase letter (a-z), with none of the surrounding letters same as itself. Two different L-pieces can be represented by the same letter, as long as they are not adjacent.And i don't know how to do it.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\nint a[1000][1000];\nint num = 1;\nvoid tromino(int x, int y, int size, int bx, int by)\n{\n    int tx, ty, i;\n    tx = x + size/2;\n    ty = y + size/2;\n    int bx4[4] = {tx, tx-1, tx-1, tx};\n    int by4[4] = {ty-1, ty-1, ty, ty};\n    if (bx &gt;= tx&amp;&amp;by &lt; ty)\n        bx4[0] = bx, by4[0] = by;\n    else if (bx &lt; tx&amp;&amp;by &lt; ty)\n        bx4[1] = bx, by4[1] = by;\n    else if (bx &lt; tx&amp;&amp;by &gt;= ty) \n        bx4[2] = bx, by4[2] = by;\n    else\n        bx4[3] = bx, by4[3] = by;\n    for (i = 0; i &lt; 4; i++)\n    {\n        if (bx4[i] == bx&amp;&amp;by4[i] == by) continue;\n        a[by4[i]][bx4[i]] = num;\n    }\n    num++;\n    if (size &gt; 2)\n    {\n        tromino(tx, y, size/2, bx4[0], by4[0]);\n        tromino(x, y, size/2, bx4[1], by4[1]);\n        tromino(x, ty, size/2, bx4[2], by4[2]);\n        tromino(tx, ty, size/2, bx4[3], by4[3]);\n    }\n}\n\nint main()\n{\n    int size, n, bx, by, i, j;\n    scanf(\"%d%d%d\", &amp;n, &amp;by, &amp;bx);\n    size = pow(2, n);\n    by--, bx--;\n    a[by][bx] = 0;\n    tromino(0, 0, size, bx, by);\n    for (i = 0; i &lt; size; i++)\n    {\n        for (j = 0; j &lt; size; j++)\n        {\n            if (i == by&amp;&amp;j == bx)\n                printf(\"* \");\n            else \n                printf(\"%c \", 97 + a[i][j]%26);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>The first input is the size of the board (2^n * 2^n)\nThe second the third is the the row and the column in which the ``hole'' is located.</p>\n\n<pre><code>    for (i = 0; i &lt; size; i++)\n    {\n        for (j = 0; j &lt; size; j++)\n        {\n            if (i == by&amp;&amp;j == bx)\n                printf(\"* \");\n            else \n                printf(\"%c \", 97 + a[i][j]%26);\n        }\n        printf(\"\\n\");\n    }\n}\n</code></pre>\n\n<p>The character which represent 'L-piece' will be adjacent in some case.</p>\n"}, {"tags": ["python", "c"], "answers": [{"comments": [{"owner": {"reputation": 1128, "user_id": 1952282, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/857b0ee320c8b9a9f6043e58fdef55d5?s=128&d=identicon&r=PG", "display_name": "Bayko", "link": "https://stackoverflow.com/users/1952282/bayko"}, "edited": false, "score": 0, "creation_date": 1531847968, "post_id": 51386913, "comment_id": 89746025, "body": "You are just copy pasting answers. That is not cool"}, {"owner": {"reputation": 704, "user_id": 10066306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0qwkzfjPgio/AAAAAAAAAAI/AAAAAAAAACw/Vwji8zvJWSw/photo.jpg?sz=128", "display_name": "Andre Motta", "link": "https://stackoverflow.com/users/10066306/andre-motta"}, "reply_to_user": {"reputation": 1128, "user_id": 1952282, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/857b0ee320c8b9a9f6043e58fdef55d5?s=128&d=identicon&r=PG", "display_name": "Bayko", "link": "https://stackoverflow.com/users/1952282/bayko"}, "edited": false, "score": 0, "creation_date": 1531848256, "post_id": 51386913, "comment_id": 89746140, "body": "I flagged as a duplicate but i didn&#39;t know it is not good practice to bring out the best answer from another thread. I stand corrected and will delete this"}, {"owner": {"reputation": 1098, "user_id": 429596, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2f3dc2de9fad3266e19c054da2d76f38?s=128&d=identicon&r=PG", "display_name": "Fadecomic", "link": "https://stackoverflow.com/users/429596/fadecomic"}, "edited": false, "score": 0, "creation_date": 1531851470, "post_id": 51386913, "comment_id": 89747722, "body": "I understand I can manually parse <code>args</code>, but what this solution assumes that the only thing passed to bar is the arbitrary length tuple. What happens when the function has more than one argument? What about when there are keyword arguments, which would normally be handled by <code>PyArg_ParseTupleAndKeywords</code>?"}], "tags": [], "owner": {"reputation": 704, "user_id": 10066306, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0qwkzfjPgio/AAAAAAAAAAI/AAAAAAAAACw/Vwji8zvJWSw/photo.jpg?sz=128", "display_name": "Andre Motta", "link": "https://stackoverflow.com/users/10066306/andre-motta"}, "is_accepted": false, "score": 1, "last_activity_date": 1531848339, "last_edit_date": 1531848339, "creation_date": 1531847344, "answer_id": 51386913, "question_id": 51386835, "link": "https://stackoverflow.com/questions/51386835/pass-a-list-or-tuple-of-arbitrary-length-to-python-extension-written-in-c/51386913#51386913", "title": "Pass a list or tuple of arbitrary length to Python extension written in C", "body": "<p>Please refer to this thread for detailed explanations, but this was flagged as a duplicate</p>\n\n<p><a href=\"https://stackoverflow.com/questions/8001923/python-extension-module-with-variable-number-of-arguments\">Python extension module with variable number of arguments</a></p>\n"}], "owner": {"reputation": 1098, "user_id": 429596, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2f3dc2de9fad3266e19c054da2d76f38?s=128&d=identicon&r=PG", "display_name": "Fadecomic", "link": "https://stackoverflow.com/users/429596/fadecomic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "closed_date": 1531933705, "answer_count": 1, "score": 0, "last_activity_date": 1531848339, "creation_date": 1531847078, "question_id": 51386835, "link": "https://stackoverflow.com/questions/51386835/pass-a-list-or-tuple-of-arbitrary-length-to-python-extension-written-in-c", "closed_reason": "Duplicate", "title": "Pass a list or tuple of arbitrary length to Python extension written in C", "body": "<p>If I am extending Python in C, I can parse arguments provided on the Python side using functions like <code>PyArg_ParseTuple()</code>. However, this only allows me to specify scalar arguments, or tuple arguments of known length. How do I deal with the case where the user calls my function from Python with a tuple of arbitrary length? For example:</p>\n\n<pre><code>import foo\nfoo.bar([1, 2, 3]) \nfoo.bar([4, 5])\n</code></pre>\n\n<p>Here, <code>bar()</code> is defined in C, and its arguments are parsed using <code>PyArg_ParseTuple()</code>, which copies the argument values to a local variable. I have to specify the argument format and an address into which to copy the parsed value. For instance:</p>\n\n<pre><code>int i,j;\nPyArg_ParseTuple(args, \"i\", &amp;i)\n/* or */\nPyArg_ParseTuple(args, \"(ii)\", &amp;i, &amp;j);\n</code></pre>\n\n<p>But what I want is something like this:</p>\n\n<pre><code>int *i;\nint ni;\nPyArg_ParseTuple(args, \"(i...)\", &amp;ni, i);\n</code></pre>\n\n<p>where i is an array, and ni is the number of elements in the array. Is this possible?</p>\n"}, {"tags": ["c", "pointers", "segmentation-fault", "structure", "allocation"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 3, "creation_date": 1531845702, "post_id": 51386404, "comment_id": 89744808, "body": "I am afraid you probably will have to spend some effort in turning this into a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, putting more weight on the &quot;M&quot;."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1531845706, "post_id": 51386404, "comment_id": 89744812, "body": "<code>Structure_delete (target);</code> is suspicious.  Did you want <code>Structure_delete (&amp;target);</code>?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1531845793, "post_id": 51386404, "comment_id": 89744863, "body": "Also note, that <code>List_create&#47;delete</code> are not provided."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531845876, "post_id": 51386404, "comment_id": 89744905, "body": "Consider allocating to the size of an object rather than the size of a type. <code>neuron-&gt;inputs = (double *) Structure_create (neuron-&gt;inputsCount * sizeof (double));</code> --&gt; <code>neuron-&gt;inputs = Structure_create (sizeof *(neuron-&gt;inputs) * neuron-&gt;inputsCount);</code>.  It is easier to code correctly, review and maintain."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531846007, "post_id": 51386404, "comment_id": 89744967, "body": "<code>Structure_delete (target);</code> is correct i think, target is already a pointer of pointer. I&#39;m editing to add List_create / delete."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531846218, "post_id": 51386404, "comment_id": 89745095, "body": "Oops <a href=\"https://stackoverflow.com/questions/51386404/nested-structures-allocation-deallocation-causing-crash#comment89744812_51386404\">here</a>, I meant do you want <code>Structure_delete (*target);</code> in <code>NeuralLayer_delete ()</code>?"}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "edited": false, "score": 0, "creation_date": 1531846499, "post_id": 51386404, "comment_id": 89745251, "body": "It seems that you forgot to add the code for <code>List_add</code> and <code>List_get</code>."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531846549, "post_id": 51386404, "comment_id": 89745277, "body": "I don&#39;t think so, all my delete functions sets the pointer to NULL, so they need a pointer on a pointer of the structure to delete, a double pointer, <code>Structure_delete(*target)</code> would be a simple pointer, memory would be free but after the function ends, pointer isn&#39;t NULL and contains an address we can&#39;t access anymore."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1531846894, "post_id": 51386404, "comment_id": 89745450, "body": "OK, I afraid the code is too big and complex to be considered <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531847035, "post_id": 51386404, "comment_id": 89745529, "body": "It&#39;s just some nested structures creation / destruction. Want me to remove things ?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 1, "creation_date": 1531849396, "post_id": 51386404, "comment_id": 89746683, "body": "Run your code through valgrind.  If you&#39;re mismanaging memory, it will tell you where."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531847941, "post_id": 51386904, "comment_id": 89746004, "body": "What a beginner&#39;s mistake I made, that&#39;s what I meant, I imported List from another project. It&#39;s fixed, but still have the crash."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531848467, "post_id": 51386904, "comment_id": 89746249, "body": "I added printf in delete functions and reduced the number of neurons per layer. When neurons of the first layer are deleted, &quot;Layer deleted&quot; isn&#39;t printed."}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531848825, "post_id": 51386904, "comment_id": 89746418, "body": "@Azhatoth, I think I found the other problem. Please see the updated answer."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531850301, "post_id": 51386904, "comment_id": 89747165, "body": "<code>Structure_delete (&amp; (* target)-&gt;neurons);</code> would be a triple pointer,"}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 1, "creation_date": 1531850397, "post_id": 51386904, "comment_id": 89747212, "body": "@Azhatoth, yes but your field is already a double pointer because it&#39;s an array of pointers, so you have to take address of this pointer when freeing the array."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 1, "creation_date": 1531851010, "post_id": 51386904, "comment_id": 89747507, "body": "I tried C++, I don&#39;t like it, I don&#39;t like OO, I don&#39;t know why, I learned Java, some C++, python, C is always the king to me. Rather than run away from difficulties, i prefer to face them, and learn."}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531851712, "post_id": 51386904, "comment_id": 89747824, "body": "@Azhatoth, you are actually already using OO style just in C. All of your structs are objects and the functions that work with them are methods. I don&#39;t think that using languages that support higher levels of abstraction is running away from difficulties, but rather leaving the mechanical aspects of programming to the compiler so you can focus on your actual task. I mean, you don&#39;t think that you are running away from difficulties by using C instead of the assembler or binary code? :)"}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531852201, "post_id": 51386904, "comment_id": 89748058, "body": "I don&#39;t see it like OO style, just well organized code :p If I wanted to do OO style in C, I would put pointers to methods inside of my structures. I&#39;m using Structure_function naming convention so I can easily find the code of the function, in the Structure.c file. I&#39;m using opaque structures sometimes when the complicated intern stuff doesn&#39;t need to be seen, when the goal of the structure is to be easily used, and I like having interfaces-like."}, {"owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531863246, "post_id": 51386904, "comment_id": 89753134, "body": "Found the ultimate bug, everything works fine now. In <code>NeuralLayer_create</code>, the line <code>layer-&gt;neurons = Structure_create (layer-&gt;neuronsCount * sizeof (NeuralLayer *));</code> meant to be <code>layer-&gt;neurons = Structure_create (layer-&gt;neuronsCount * sizeof (Neuron *));</code> <code>NeuralLayer-&gt;neurons</code> is obviously an array of neurons, don&#39;t know how I could write <code>sizeof(anotherStructure)</code>"}, {"owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "reply_to_user": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "edited": false, "score": 0, "creation_date": 1531889283, "post_id": 51386904, "comment_id": 89758988, "body": "@Azhatoth, I actually saw that but it couldn&#39;t cause any crash because sizeof pointers even to different structs is always the same."}], "tags": [], "owner": {"reputation": 5360, "user_id": 9435815, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xaQWU.jpg?s=128&g=1", "display_name": "r3mus n0x", "link": "https://stackoverflow.com/users/9435815/r3mus-n0x"}, "is_accepted": false, "score": 1, "last_activity_date": 1531849512, "last_edit_date": 1531849512, "creation_date": 1531847317, "answer_id": 51386904, "question_id": 51386404, "link": "https://stackoverflow.com/questions/51386404/nested-structures-allocation-deallocation-causing-crash/51386904#51386904", "title": "Nested structures allocation / deallocation causing crash", "body": "<p>It seems that your <code>List_get</code> function isn't traversing the list properly:</p>\n\n<pre><code>return List_get (list, index - 1);\n</code></pre>\n\n<p>while it should be:</p>\n\n<pre><code>return List_get (list-&gt;next, index - 1);\n</code></pre>\n\n<p>Also, in <code>NeuralLayer_delete</code> function:</p>\n\n<pre><code>Structure_delete ((* target)-&gt;neurons);\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>Structure_delete (&amp;(* target)-&gt;neurons);\n</code></pre>\n\n<hr/>\n\n<p><strong>As a side note</strong>: as you've already discovered this kind of \"very manual\" memory management is very brittle and error-prone. Consider transitioning to C++ in the future. It has <a href=\"https://en.cppreference.com/w/cpp/language/raii\" rel=\"nofollow noreferrer\">RAII pattern</a> and <a href=\"https://en.cppreference.com/w/cpp/memory\" rel=\"nofollow noreferrer\">smart pointers</a> for more robust resource management. It also provides <a href=\"https://en.cppreference.com/w/cpp/container/vector\" rel=\"nofollow noreferrer\">dynamic array (vector)</a> and <a href=\"https://en.cppreference.com/w/cpp/container/list\" rel=\"nofollow noreferrer\">linked list</a> containers so you won't have to invent them (and make beginner mistakes :)) yourself. They are also likely to provide better performance.</p>\n"}], "owner": {"reputation": 1, "user_id": 8108987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643c965e57014a787b29b91e09f270aa?s=128&d=identicon&r=PG&f=1", "display_name": "Azhatoth", "link": "https://stackoverflow.com/users/8108987/azhatoth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531850975, "creation_date": 1531845449, "last_edit_date": 1531848281, "question_id": 51386404, "link": "https://stackoverflow.com/questions/51386404/nested-structures-allocation-deallocation-causing-crash", "title": "Nested structures allocation / deallocation causing crash", "body": "<p>I'm back into C after a long break, and I said to myself \"what about learning some deep learning ?\".\nSo, I have these structures:</p>\n\n<ul>\n<li>Neuron, containing and array of inputs, an array of weights and the number of inputs,</li>\n<li>NeuralLayer, containing an array of neurons, and the number of neurons,</li>\n<li>NeuralNetwork, containing a List of NeuralLayer.</li>\n</ul>\n\n<p>Previously the network was an array of layers, but since the number of layers might be unknown, I now use a list.</p>\n\n<p>I wanted the network be used as follow: create, add layer by layer, output, delete.</p>\n\n<pre><code>// A neuron is an array of inputs, an array of weights, and the size of its arrays\ntypedef struct Neuron {\n    double * inputs;    \n    double * weights;\n    size_t inputsCount;\n} Neuron;\n\n\n\n\n// Creates a Neuron and returns it\nNeuron * Neuron_create (size_t inputsCount) { \n    Neuron * neuron;\n    size_t weightsIndex;\n\n    neuron = Structure_create (sizeof (Neuron));\n\n    neuron-&gt;inputsCount = inputsCount;\n    neuron-&gt;inputs = (double *) Structure_create (neuron-&gt;inputsCount * sizeof (double));\n    neuron-&gt;weights = (double *) Structure_create (neuron-&gt;inputsCount * sizeof (double));\n\n    for (weightsIndex = 0; weightsIndex &lt; inputsCount; weightsIndex++) \n        neuron-&gt;weights [weightsIndex] = rand () / (RAND_MAX / 1.0); // On creation, random weights are used\n\n    return neuron;\n}\n\n\n// Deletes the neuron and sets its pointer to NULL\nvoid Neuron_delete (Neuron ** target) {\n    if ((NULL == target) || (NULL == * target))\n        return;\n\n    printf (\"    Deleting neuron: %p\\n\", * target);\n\n    Structure_delete (&amp; (* target)-&gt;inputs); \n    Structure_delete (&amp; (* target)-&gt;weights); \n    Structure_delete (target);\n\n    printf (\"    Neuron deleted\\n\");\n}\n</code></pre>\n\n<hr>\n\n<pre><code>// A layer is an array of Neurons and its size\ntypedef struct NeuralLayer {\n\n    size_t neuronsCount;\n    Neuron ** neurons;\n} NeuralLayer;\n\n\n\n\n// Creates a Layer and returns it\nNeuralLayer * NeuralLayer_create (size_t neuronsCount, size_t inputsCount) {\n\n    NeuralLayer * layer;\n    size_t neuronsIndex;\n\n    layer = Structure_create (sizeof (NeuralLayer));\n    layer-&gt;neuronsCount = neuronsCount;\n    layer-&gt;neurons = Structure_create (layer-&gt;neuronsCount * sizeof (NeuralLayer *));\n\n    for (neuronsIndex = 0; neuronsIndex &lt; neuronsCount; neuronsIndex++)\n        layer-&gt;neurons [neuronsIndex] = Neuron_create (inputsCount); \n\n    return layer;\n}\n\n\n// Deletes the layer and sets its pointer to NULL\nvoid NeuralLayer_delete (NeuralLayer ** target) {\n\n    if ((NULL == target) || (NULL == * target))\n        return;\n\n    printf (\"  Deleting layer: %p\\n\", * target);\n\n    for (size_t neuronIndex = 0; neuronIndex &lt; (* target)-&gt;neuronsCount; neuronIndex++) {\n        Neuron * buffer = (* target)-&gt;neurons [neuronIndex];\n        Neuron_delete (&amp; buffer);\n    }      \n\n    Structure_delete ((* target)-&gt;neurons); \n    Structure_delete (target);\n\n    printf (\"  Layer deleted\\n\");\n}\n</code></pre>\n\n<hr>\n\n<pre><code>// The network is simply a List of layers\ntypedef struct NeuralNetwork {\n    List * layers;\n} NeuralNetwork;\n\n\n\n\n// Allocs the empty network and returns it\nNeuralNetwork * NeuralNetwork_create (void) {\n    NeuralNetwork * network;\n\n    network = Structure_create (sizeof (NeuralNetwork));\n    network-&gt;layers = List_create ();\n\n    return network;\n}\n\n\n// Deletes the network and sets its pointer to NULL\nvoid NeuralNetwork_delete (NeuralNetwork ** target) {\n    if ((NULL == target) || (NULL == * target))\n        return;\n\n    printf (\"Deleting network: %p\\n\", * target);\n\n    // For each layer, delete layer\n    for (size_t layerIndex = 0; layerIndex &lt; List_size ((* target)-&gt;layers); layerIndex++) {\n        NeuralLayer * buffer = List_get ((* target)-&gt;layers, layerIndex); // I'm using opaque structures\n        NeuralLayer_delete (&amp; buffer);\n    }\n\n    List_delete (&amp; (* target)-&gt;layers);\n    Structure_delete (target);\n\n    printf (\"Network deleted\\n\");\n}\n\n\n// We only need to know how many neurons the new layer will contain, they will have as many inputs as the number of neurons in the previous layer\nvoid NeuralNetwork_addLayer (NeuralNetwork * dest, size_t neuronsCount) {\n    if (NULL == dest-&gt;layers)\n        List_add (&amp; dest-&gt;layers, NeuralLayer_create (neuronsCount, 1));\n\n    else {\n        NeuralLayer * previousLayer = List_get (dest-&gt;layers, List_size (dest-&gt;layers) - 1);\n        size_t inputsCount = NeuralLayer_getNeuronsCount (previousLayer);\n        NeuralLayer * newLayer = NeuralLayer_create (neuronsCount, inputsCount);\n        List_add (&amp; dest-&gt;layers, newLayer);\n    }\n}\n</code></pre>\n\n<p>And my main:</p>\n\n<pre><code>int main (int argc, char * argv []) {\n    NeuralNetwork * network = NeuralNetwork_create (); \n    NeuralNetwork_addLayer (network, 4); // First layer are inputs, one for each pixel\n    NeuralNetwork_addLayer (network, 3); // Hidden layer of 15 neurons\n    NeuralNetwork_addLayer (network, 2); // Output layer, \n\n    NeuralNetwork_delete (&amp; network);\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Program crash during deallocation, NeuralNetwork_delete() calls NeuralLayer_delete() which calls Neuron_delete(), something is wrong with allocation / deallocation.</p>\n\n<p>Oh, i forgot the base memory functions:</p>\n\n<pre><code>// Allocates memory, checks it and returns it\n// Have to change the name, i don't use it only to alloc structures\nvoid * Structure_create (size_t size) {\n    void * structure;\n\n    structure = malloc (size);\n    if (NULL == structure) {\n        printf (\"Memory allocation failed, aborting.\\n\");\n        system (\"PAUSE\");\n        exit (EXIT_FAILURE);\n    }\n\n    return structure;\n}\n\n\n\n// Free the memory and sets the pointer to NULL\nvoid Structure_delete (void ** target) {\n    if ((NULL == target) || (NULL == * target))\n        return;\n\n    free (* target);\n    * target = NULL;\n}\n</code></pre>\n\n<p>What am I doing wrong ? </p>\n\n<p>EDIT: Adding List_create / delete</p>\n\n<pre><code>typedef struct List {\n    void * content;\n    List * next;\n    List * previous;\n} List;\n\n\n\n\n// Create a single item and inits it\nstatic List * _List_createItem (void * content);\n\n\n\n// Returns NULL to hide implementation\nList * List_create (void) {\n    return (List* )NULL;\n}\n\n\nvoid List_delete (List ** target) {\n    if (NULL == target) {\n        printf (\"Tried to delete NULL list\\n\");\n        return;\n    }\n\n    else if (NULL == * target)\n        return;\n\n    List_delete (&amp; (* target)-&gt;next);\n    Structure_delete (target); \n}\n\n\nvoid * List_get (const List * const list, size_t index) {\n    if (NULL == list) {\n        printf (\"Tried to get from List with index out of range\\n\");\n        return NULL;\n    }\n\n    else if (0 == index) \n        return list-&gt;content;\n\n    return List_get (list, index - 1);\n}\n\n\n// If the list was empty, it becomes a new list, so we need pointer to pointer\nvoid List_add (List ** dest, void * content) {\n    if (NULL == dest) {\n        printf (\"Tried to add item on NULL pointer\\n\");\n        return;\n    }\n\n    else if ((NULL != * dest) &amp;&amp; (NULL == (* dest)-&gt;next)) {\n        (* dest)-&gt;next = _List_createItem (content);\n        (* dest)-&gt;next-&gt;previous = * dest;\n    }\n\n    else if (NULL == * dest) \n        * dest = _List_createItem (content);\n\n    else\n        List_add (&amp; (* dest)-&gt;next, content);\n}\n\n\nstatic List * _List_createItem (void * content) {    \n    List * item;\n\n    item = (List *)Structure_create (sizeof (List));\n    item-&gt;content = content;\n    item-&gt;next = NULL;\n    item-&gt;previous = NULL;\n\n    return item;\n}\n</code></pre>\n"}, {"tags": ["c", "command-line", "main"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1531840809, "post_id": 51385040, "comment_id": 89741956, "body": "<code>argv[]</code> is array of pointers to <i>strings</i>, not integers."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1531841841, "post_id": 51385040, "comment_id": 89742636, "body": "Change the <code>%d</code> to <code>%s</code> to print the argument strings."}], "answers": [{"comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1531841883, "post_id": 51385184, "comment_id": 89742660, "body": "It&#39;s more likely to be useful to change the <code>%d</code> in the format to <code>%s</code> so that the entire argument string is printed."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531847076, "post_id": 51385184, "comment_id": 89745566, "body": "Actually your side note is <i>incorrect</i>. <code>main</code> defaults to returning <code>0</code> in C, so not returning anything is perfectly OK."}, {"owner": {"reputation": 7205, "user_id": 9288200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1c4dc5d3f7433e18f4aa04319ebaec?s=128&d=identicon&r=PG&f=1", "display_name": "Ondrej K.", "link": "https://stackoverflow.com/users/9288200/ondrej-k"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531853185, "post_id": 51385184, "comment_id": 89748547, "body": "@AnttiHaapala: Thanks for the hint. I&#39;ve extended the answer accordingly. Even tough, I&#39;d really say, esp if someone is trying to learn, perhaps it&#39;d be better to not complicate it with nuances of specific standard details and just from the get go stick to relatively simple: be consistent, even if it means typing few extra characters."}], "tags": [], "owner": {"reputation": 7205, "user_id": 9288200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1c4dc5d3f7433e18f4aa04319ebaec?s=128&d=identicon&r=PG&f=1", "display_name": "Ondrej K.", "link": "https://stackoverflow.com/users/9288200/ondrej-k"}, "is_accepted": true, "score": 0, "last_activity_date": 1531853464, "last_edit_date": 1531853464, "creation_date": 1531841196, "answer_id": 51385184, "question_id": 51385040, "link": "https://stackoverflow.com/questions/51385040/unexpected-result-when-parsing-argument-in-main-function-in-c/51385184#51385184", "title": "Unexpected result when parsing argument in main function in C", "body": "<p>Dereference your pointer:</p>\n\n<pre><code>printf(\"%d\\n\", *argv[i]);\n</code></pre>\n\n<p>You may also be a little surprised, as you will get a numerical value represented by the (first) character printed; for instance for <code>1</code> it is <code>49</code>.</p>\n\n<p>In general you can tell your compiler to tell you a bit more by enabling more warnings.  For instance <code>gcc -Wall</code> would tell you:</p>\n\n<blockquote>\n  <p>warning: format \u2018%d\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018char *\u2019 [-Wformat=]\n   printf(\"%d\\n\", argv[i]);</p>\n</blockquote>\n\n<p>Which would actually be a pretty solid hint.</p>\n\n<p>And a side note: if you declare your <code>main</code> as <code>int</code>, you should return one too. ;) (But see EDIT2 for details).</p>\n\n<hr>\n\n<p>EDIT: I guess I should have mentioned that with the actual output surprise in the second paragraph.</p>\n\n<p>If verbatim reprint of the argument(s) is what you actually wanted. You'd use <code>%s</code> in your formatting string as <a href=\"https://stackoverflow.com/users/15168/jonathan-leffler\">Jonathan Leffler</a> pointed out in the comment. In that case, you want the argument passed to be pointer to a string again (i.e. you do not use the <code>*</code> dereference operator).</p>\n\n<hr>\n\n<p>EDIT2: As pointed out by <a href=\"https://stackoverflow.com/users/918959/antti-haapala\">Antti Haapala</a> regarding the closing \"Side note\".</p>\n\n<p>When using C99 or C11 you do not have to explicitly return (a value) for your <code>main</code> (and we're talking about <code>main</code>) that has been declared to return <code>int</code>. In that case default of <code>0</code> will be assumed. You really only need to do that for when adhering to C89 standard or other functions. For sake of simplicity though and/or when not sure what your target compiler configuration is, you won't be wrong being (type) consistent between your declared and actually returned value type. And again. <code>gcc -Wall</code> for example would let you know about that.</p>\n"}], "owner": {"reputation": 73, "user_id": 10018629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0rvu.png?s=128&g=1", "display_name": "LiukPet", "link": "https://stackoverflow.com/users/10018629/liukpet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 51385184, "answer_count": 1, "score": 0, "last_activity_date": 1531853464, "creation_date": 1531840760, "last_edit_date": 1531840873, "question_id": 51385040, "link": "https://stackoverflow.com/questions/51385040/unexpected-result-when-parsing-argument-in-main-function-in-c", "title": "Unexpected result when parsing argument in main function in C", "body": "<p>I have really simple code to understand command line arguments parsing of main in C language:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(int argc, char* argv[]){\n\nfor(int i=1; i &lt; argc; i++)\nprintf(\"%d\\n\", argv[i]);\n\nprintf(\"Number of arguments: %d\\n\", argc);\n\n}\n</code></pre>\n\n<p>Having compiled and executed in a terminal passing 3 integers (eg. 1, 2, 3), I obtain the following strange result:</p>\n\n<pre><code>1175842993\n1175842995\n1175842997\nNumber of arguments: 4\n</code></pre>\n\n<p>I know that the solution is lying right straightforwardly towards my eyes, but it's been a hour that I cannot actual figure it out! Any hints? Thanks!</p>\n"}, {"tags": ["c", "directive"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531839907, "post_id": 51384719, "comment_id": 89741367, "body": "What are you trying to accomplish by doing this?"}, {"owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "reply_to_user": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1531839960, "post_id": 51384719, "comment_id": 89741397, "body": "@dbush depending on compilers and targets, some compilers recongnize #warning and other recongnize #warn for example"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1531840456, "post_id": 51384719, "comment_id": 89741707, "body": "You can add an additional preprocessing stage to your build pipeline, before compiling."}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 4, "last_activity_date": 1531840246, "creation_date": 1531840246, "answer_id": 51384850, "question_id": 51384719, "link": "https://stackoverflow.com/questions/51384719/how-to-define-a-directive-as-an-other-directive-in-c/51384850#51384850", "title": "How to define a directive as an other directive in C?", "body": "<p>There's no way to create your own preprocessor directives.  The <code>#define</code> directive allows you to define new source symbols only.</p>\n\n<p>What you're currently doing is the proper way to handle differing directives on different compilers.</p>\n"}, {"comments": [{"owner": {"reputation": 4732, "user_id": 8477999, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f8172e1919af53269de92316dcf03a03?s=128&d=identicon&r=PG&f=1", "display_name": "Gem Taylor", "link": "https://stackoverflow.com/users/8477999/gem-taylor"}, "edited": false, "score": 0, "creation_date": 1531849113, "post_id": 51385104, "comment_id": 89746552, "body": "I&#39;m not sure how universal _Pragma is, either, but nice idea."}], "tags": [], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "is_accepted": false, "score": 0, "last_activity_date": 1531840962, "creation_date": 1531840962, "answer_id": 51385104, "question_id": 51384719, "link": "https://stackoverflow.com/questions/51384719/how-to-define-a-directive-as-an-other-directive-in-c/51385104#51385104", "title": "How to define a directive as an other directive in C?", "body": "<p>In general it's not possible, however you can effective generate <code>#pragma</code> directives with the <code>_Pragma keyword</code>.</p>\n\n<pre><code>#define PRAGMA(...) _Pragma(#__VA_ARGS__)\nPRAGMA(message \"my message\")\n//as if you wrote: #pragma message \"my message\"\n</code></pre>\n\n<p>With this in mind, your compiler might have pragmas that allow you to emulate <code>#warn</code> or <code>#error</code>\n(<code>#pragma GCC warning \"message\"</code> or <code>#pragma GCC error \"message\"</code>).</p>\n\n<p>If your compiler doesn't have such pragmas, you can always fail a compilation by expanding to something relatively context-free that's not compilable, e.g., <code>char ERROR[-1];</code> (negative array sizes are illegal).</p>\n"}], "owner": {"reputation": 798, "user_id": 4838002, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/13678927e03a38773999fe049196977b?s=128&d=identicon&r=PG&f=1", "display_name": "mikmik", "link": "https://stackoverflow.com/users/4838002/mikmik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 51384850, "answer_count": 2, "score": 2, "last_activity_date": 1531840962, "creation_date": 1531839852, "last_edit_date": 1531839979, "question_id": 51384719, "link": "https://stackoverflow.com/questions/51384719/how-to-define-a-directive-as-an-other-directive-in-c", "title": "How to define a directive as an other directive in C?", "body": "<p>How can I define a directive as an other directive in C ?</p>\n\n<p>ex : I want to define </p>\n\n<pre><code>#define #warning #warn\n</code></pre>\n\n<p>I get an error </p>\n\n<pre><code>error #41: expected an identifier\n</code></pre>\n\n<p>for compilers and targets for example, some compilers recognize <code>#warning</code> and other recognize <code>#warn</code>.</p>\n\n<p>I already have a way to do this but I want to make it generic</p>\n\n<pre><code>#if PLATFORMS_TOOLCHAIN == PLATFORMS_ticgt\n  #warn \"RAM is not initialized at startup, test will possibly fail\"\n#else\n  #warning \"RAM is not initialized at startup, test will possibly fail\"\n#endif\n</code></pre>\n"}, {"tags": ["c++", "sql", "c", "odbc"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8969424"}, "edited": false, "score": 1, "creation_date": 1531843562, "post_id": 51384665, "comment_id": 89743683, "body": "why do you have C++ and C tags for your question? Remove them if not necessary. If you need them, improve your post by asking language specific doubts on where you are stuck"}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1531845345, "post_id": 51384665, "comment_id": 89744640, "body": "Please show that &quot;This works perfectly fine&quot; as a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. It might even be a reason to keep the C tag or the C++ tag. Do not forget to also provide the code for setting up the database including sample content."}], "owner": {"reputation": 1, "user_id": 4135440, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000890763225/picture?type=large", "display_name": "Micha\u0142 Wyle\u017co\u0142", "link": "https://stackoverflow.com/users/4135440/micha%c5%82-wyle%c5%bco%c5%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531839693, "creation_date": 1531839693, "question_id": 51384665, "link": "https://stackoverflow.com/questions/51384665/odbc-null-value-binding-for-where-clause", "title": "Odbc null value binding for where clause", "body": "<p>I'm trying to achieve batch deleting of rows with ODBC binding. What i'm doing is: Bind all columns with array of values and then execute statement.</p>\n\n<p>Let's say i've got query: <code>Delete From Table Where primary_key=? and second_primary_key=?</code> and then bind values <code>(1, 2, 3, 4)</code> for first column and then <code>(4, 3, 2, 1)</code> for second column. </p>\n\n<p>This works perfectly fine until i stumbled upon column with nullable value. For those, if any row contains null value i bind <code>SQL_NULL_DATA</code>. I guess it doesn't work as <code>primary_key = null</code> always returns true.</p>\n\n<p>My question is: \n<strong>Is it possible to force ODBC to interpret this situation as: primary_key=? or primary_key is null? Or do i have to search through all values and append sql query manually?</strong></p>\n"}, {"tags": ["c", "loops", "for-loop", "while-loop", "terminate"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531839672, "post_id": 51384597, "comment_id": 89741230, "body": "&quot;There is nothing when I press Escape&quot; --&gt; post the sample input used - every key pressed would help."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1531839966, "post_id": 51384597, "comment_id": 89741400, "body": "<a href=\"https://stackoverflow.com/a/35954128/2877364\">Related answer</a>, and a possibly-useful <a href=\"https://answers.yahoo.com/question/index?qid=20120819083250AAcUZia&amp;guccounter=1\" rel=\"nofollow noreferrer\">search result</a>"}, {"owner": {"reputation": 11, "user_id": 9836042, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-NU_uZ8-YGL0/AAAAAAAAAAI/AAAAAAAAAUg/tn3GifMOzpE/photo.jpg?sz=128", "display_name": "Shane Price", "link": "https://stackoverflow.com/users/9836042/shane-price"}, "edited": false, "score": 0, "creation_date": 1531840046, "post_id": 51384597, "comment_id": 89741448, "body": "This was answered here: <a href=\"https://stackoverflow.com/questions/20579502/the-c-program-should-exit-as-soon-as-he-presses-esc\" title=\"the c program should exit as soon as he presses esc\">stackoverflow.com/questions/20579502/&hellip;</a>"}, {"owner": {"reputation": 484, "user_id": 7367458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo9f20mtkGs/AAAAAAAAAAI/AAAAAAAABLk/hatpI770yr8/photo.jpg?sz=128", "display_name": "imans77", "link": "https://stackoverflow.com/users/7367458/imans77"}, "edited": false, "score": 0, "creation_date": 1531840116, "post_id": 51384597, "comment_id": 89741484, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26783701/how-to-use-escape-key-to-end-a-loop-in-c\">How to use Escape Key to end a Loop in C</a>"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 484, "user_id": 7367458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo9f20mtkGs/AAAAAAAAAAI/AAAAAAAABLk/hatpI770yr8/photo.jpg?sz=128", "display_name": "imans77", "link": "https://stackoverflow.com/users/7367458/imans77"}, "edited": false, "score": 0, "creation_date": 1531840192, "post_id": 51384597, "comment_id": 89741531, "body": "@imans77 I don&#39;t think that&#39;s a duplicate, since it doesn&#39;t include <code>scanf</code>.  I can&#39;t find an exact duplicate (though I may be missing it).  <b>Md. Shamvil Hossain,</b> what OS and compiler are you using?  Some of the answers are platform-specific."}, {"owner": {"reputation": 246, "user_id": 3497428, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d267a94a33ff1faae21293a6e861834c?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Shamvil Hossain", "link": "https://stackoverflow.com/users/3497428/md-shamvil-hossain"}, "edited": false, "score": 0, "creation_date": 1531840237, "post_id": 51384597, "comment_id": 89741565, "body": "I am using windows and compiler is codeblocks"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1531840265, "post_id": 51384597, "comment_id": 89741588, "body": "@cxw of course it doesn&#39;t include scanf because scanf wouldn&#39;t work."}, {"owner": {"reputation": 484, "user_id": 7367458, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo9f20mtkGs/AAAAAAAAAAI/AAAAAAAABLk/hatpI770yr8/photo.jpg?sz=128", "display_name": "imans77", "link": "https://stackoverflow.com/users/7367458/imans77"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1531840372, "post_id": 51384597, "comment_id": 89741654, "body": "@cxw So I thought it was a duplicate because I thought what he was trying to achieve was ending the loop <b>without buffer</b>. which the <code>scanf</code> can&#39;t handle, so he must use another buffer-free stuff like <code>getchar</code> or something. That was my opinion about it :-?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1531840403, "post_id": 51384597, "comment_id": 89741672, "body": "@cxw the question is about how to do it, not about how to do it with scanf."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1531840629, "post_id": 51384597, "comment_id": 89741828, "body": "The real answer to this question is &quot;don&#39;t, it&#39;s not a beginner&#39;s task&quot;."}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 2, "creation_date": 1531841488, "post_id": 51384597, "comment_id": 89742400, "body": "This has nothing to do with scanf.  To expand on n.m.&#39;s comment (that this is not a beginner&#39;s task), you need to realize that hitting the escape key sends an interrupt to the OS but sends no information at all to your program.  To get that information, you will need to do different things depending on the platform you&#39;re running on.  (There are libraries that abstract away the differences, however.)  Rather than aborting on <code>esc</code> it would be easier to terminate the program on end of input.  Not only is that easier, it is also more idiomatic and more useful."}], "answers": [{"comments": [{"owner": {"reputation": 246, "user_id": 3497428, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d267a94a33ff1faae21293a6e861834c?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Shamvil Hossain", "link": "https://stackoverflow.com/users/3497428/md-shamvil-hossain"}, "edited": false, "score": 0, "creation_date": 1531840926, "post_id": 51385030, "comment_id": 89742023, "body": "can you provide full program please??"}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "reply_to_user": {"reputation": 246, "user_id": 3497428, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d267a94a33ff1faae21293a6e861834c?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Shamvil Hossain", "link": "https://stackoverflow.com/users/3497428/md-shamvil-hossain"}, "edited": false, "score": 0, "creation_date": 1531841125, "post_id": 51385030, "comment_id": 89742159, "body": "@Md.ShamvilHossain I did, I am currently on my Smartphone so I am not able to check my code above (but it should work)."}], "tags": [], "owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "is_accepted": false, "score": 0, "last_activity_date": 1531841083, "last_edit_date": 1531841083, "creation_date": 1531840738, "answer_id": 51385030, "question_id": 51384597, "link": "https://stackoverflow.com/questions/51384597/c-program-terminate-while-press-escape/51385030#51385030", "title": "C program terminate while press escape", "body": "<p>Check out the function <code>kbhit();</code> and <code>getch();</code></p>\n\n<p>A possible solution would be:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n\nint main(){\n\nchar ch;\nint k;\nwhile (1) {\n\n    if (kbhit) {\n\n        scanf(\"%d\",&amp;k);\n        printf(\"%d\\n\", k); \n\n        // Stores the pressed key in ch\n        ch = getch();\n\n        // Terminates the loop\n        // when escape is pressed\n        if (int(ch) == 27)\n            break;\n\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 246, "user_id": 3497428, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d267a94a33ff1faae21293a6e861834c?s=128&d=identicon&r=PG&f=1", "display_name": "Md. Shamvil Hossain", "link": "https://stackoverflow.com/users/3497428/md-shamvil-hossain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 906, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1531841083, "creation_date": 1531839496, "last_edit_date": 1531840452, "question_id": 51384597, "link": "https://stackoverflow.com/questions/51384597/c-program-terminate-while-press-escape", "title": "C program terminate while press escape", "body": "<p>I am a beginner in C.  I wrote a C program in Code::Blocks on Windows which will take a <code>int</code> input and print it on the next line.  I want to run the loop until I press escape, but I can not do that. My code is:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;\n\nint main(void)\n{\n    int k;\n    do {\n        scanf(\"%d\",&amp;k);\n        printf(\"%d\\n\", k);      // print  value\n    } while (k != 27);          // end when Esc pressed\n\n    return 0;\n}\n</code></pre>\n\n<p>The loop is working.  I input an integer and it prints it on the next line.  But it is not terminating by pressing the escape key. There is nothing when I press Escape. I want to run the program until I press the escape, while still accepting <code>int</code>-type inputs from the user.  How can I terminate the program on pressing escape?</p>\n"}, {"tags": ["c", "go", "unsafe-pointers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531838837, "post_id": 51384245, "comment_id": 89740660, "body": "You use <code>unsafe.Pointer</code> when you need it. If you&#39;re converting <i>unsafely</i> between types, then you&#39;re going to need to use the unsafe package to &quot;remove&quot; the type in order to complete the conversion."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839305, "post_id": 51384245, "comment_id": 89740981, "body": "&quot;The fact that it works doesn&#39;t make me confident that its safer&quot; -- why? It&#39;s safer because it&#39;s a valid type conversion. Try it with a different type than can&#39;t be converted and see the difference."}, {"owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839629, "post_id": 51384245, "comment_id": 89741202, "body": "So how exactly is <code>*byte =&gt; *uint8 =&gt; *C.uchar</code> less of a valid conversion than <code>*byte =&gt; *uint8 =&gt; *ArbitraryType =&gt; *C.uchar</code> ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531839819, "post_id": 51384245, "comment_id": 89741318, "body": "I don&#39;t understand what you mean. If you change the type (to uint32 for example) without using unsafe, you&#39;ll get an error like <code>cannot convert &amp;buf[0] (type *uint32) to type *_Ctype_uchar</code>"}, {"owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1531841172, "post_id": 51384245, "comment_id": 89742185, "body": "Well, yes, that&#39;s when you want to interpret the input object as a regular pointer and then convert it to something else. I suppose it is really just a NOP for []byte -&gt; uint8_t* conversions"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1531841712, "post_id": 51384245, "comment_id": 89742552, "body": "Sorry, I&#39;m still not following you. You can&#39;t convert <code>[]byte -&gt; uint8_t* </code>, but you&#39;re not doing that, you&#39;re converting <code>*byte -&gt; *uint8</code> which is safe. (and yes, <code>uint8</code>, <code>byte</code> and <code>C.uchar</code> are all the same type, which is why the conversion succeeds). Also note that many type conversions are &quot;NOP&quot;, since you&#39;re not doing any action other than changing the declared type for the compiler. (the exceptions are all laid out in the spec: <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 133105, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1532023121, "last_edit_date": 1532023121, "creation_date": 1532021840, "answer_id": 51428826, "question_id": 51384245, "link": "https://stackoverflow.com/questions/51384245/c-ucharbuffer0-vs-c-ucharunsafe-pointerbuffer0/51428826#51428826", "title": "(*C.uchar)(&amp;buffer[0]) vs (*C.uchar)(unsafe.Pointer(&amp;buffer[0]))", "body": "<p>The Go documention is littered with warnings against using package <code>unsafe</code> to needlessly defeat Go's type system. <code>unsafe.Pointer</code> is clearly identified as unsafe for a reason.</p>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/unsafe/\" rel=\"nofollow noreferrer\">Package unsafe</a></p>\n  \n  <p>Package unsafe contains operations that step around the type safety of\n  Go programs.</p>\n  \n  <p>Packages that import unsafe may be non-portable and are not protected\n  by the Go 1 compatibility guidelines.</p>\n  \n  <p><a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\">type Pointer</a></p>\n  \n  <p>Pointer therefore allows a program to defeat the type system and read\n  and write arbitrary memory. It should be used with extreme care.</p>\n  \n  <hr>\n  \n  <p><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">Command cgo</a></p>\n  \n  <p><a href=\"https://golang.org/cmd/cgo/#hdr-Passing_pointers\" rel=\"nofollow noreferrer\">Passing pointers</a></p>\n  \n  <p>Go is a garbage collected language, and the garbage collector needs to\n  know the location of every pointer to Go memory. Because of this,\n  there are restrictions on passing pointers between Go and C.</p>\n  \n  <p>[These] rules are checked dynamically at runtime.</p>\n  \n  <p>It is possible to defeat this enforcement by using the unsafe package,\n  and of course there is nothing stopping the C code from doing anything\n  it likes. However, programs that break these rules are likely to fail\n  in unexpected and unpredictable ways.</p>\n</blockquote>\n\n<hr>\n\n<p>Let's review a realistic example.</p>\n\n<p>Here's a C function that receives a bytes buffer.</p>\n\n<pre><code>void printbuf(size_t len, unsigned char *buf)\n</code></pre>\n\n<p>In Go, using cgo and preserving type safety with matching types, we could write,</p>\n\n<pre><code>var buf []byte\n\nC.printbuf(C.size_t(len(buf)), (*C.uchar)(&amp;buf[0]))\n</code></pre>\n\n<p>However, that's still unsafe, <code>buf[0]</code> will be out of range if <code>len(buf) == 0</code>. When <code>buf</code> is initialized to it's zero-value the array pointer will also be <code>nil</code>.  We can neatly encapsulate the integrity checks in a Go function, which the Go gc optimizing compiler will inline.</p>\n\n<pre><code>func cbuf(buf []byte) (size C.size_t, ptr *C.uchar) {\n    var bufptr *byte\n    if cap(buf) &gt; 0 {\n        bufptr = &amp;(buf[:1][0])\n    }\n    return C.size_t(len(buf)), (*C.uchar)(bufptr)\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>bufsize, bufptr := cbuf(buf)\nC.printbuf(bufsize, bufptr)\n</code></pre>\n\n<p>Defeating the type system by using <code>unsafe.Pointer</code> is unsafe. For example,</p>\n\n<pre><code>C.printbuf(C.size_t(len(buf)), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n</code></pre>\n\n<p>The <code>buf</code> type could be any indexed type: array, pointer to array, slice, string or map. Even worse, the size, if not one byte, will be wrong. Now it gets get really ugly,</p>\n\n<pre><code>C.printbuf(C.size_t(len(buf)*int(unsafe.Sizeof(buf[0]))), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n</code></pre>\n\n<p>And we haven't taken into account nil pointers and out of range values.</p>\n\n<p>Next the code review: code should be correct, maintainable, robust, reasonably efficient, and, most importantly, readable. Don't expect the code review of <code>unsafe.Pointer</code> usage to go well.</p>\n\n<hr>\n\n<p>Let's hear your rationale for the use of unsafe.Pointer for this purpose.</p>\n\n<hr>\n\n<p><strong>Sample code</strong>:</p>\n\n<p><code>printbuf.go</code>:</p>\n\n<pre><code>package main\n\n/*\n#include &lt;stdio.h&gt;\n\nvoid printbuf(size_t len, unsigned char *buf) {\n    printf(\"%lu [\", len);\n    if (!buf) {\n        len = 0;\n    }\n    size_t maxwidth = 16;\n    size_t width = len &lt;= maxwidth ? len : maxwidth;\n    for (size_t i = 0; i &lt; width; i++) {\n        if (i &gt; 0) {\n            printf(\" \");\n        }\n        printf(\"%02X\", buf[i]);\n    }\n    if (width &lt; len) {\n        printf(\" ...\");\n    }\n    printf(\"]\\n\");\n}\n*/\nimport \"C\"\n\nimport (\n    \"unsafe\"\n)\n\n// NOTE: -gcflags='-m' : can inline cbuf : inlining call to cbuf\nfunc cbuf(buf []byte) (size C.size_t, ptr *C.uchar) {\n    var bufptr *byte\n    if cap(buf) &gt; 0 {\n        bufptr = &amp;(buf[:1][0])\n    }\n    return C.size_t(len(buf)), (*C.uchar)(bufptr)\n}\n\nfunc main() {\n\n    var buf []byte // zero-value = nil, len = 0, cap = 0\n\n    bufsize, bufptr := cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 0) // len = 0, cap = 0\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 0, 32) // len = 0\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    buf = make([]byte, 32) // len &gt; 0\n    for i := range buf {\n        buf[i] = byte(i)\n    }\n\n    bufsize, bufptr = cbuf(buf)\n    C.printbuf(bufsize, bufptr)\n\n    if len(buf) &gt; 0 {\n\n        C.printbuf(C.size_t(len(buf)), (*C.uchar)(&amp;buf[0]))\n\n        C.printbuf(C.size_t(len(buf)), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n\n        C.printbuf(C.size_t(len(buf)*int(unsafe.Sizeof(buf[0]))), (*C.uchar)(unsafe.Pointer(&amp;buf[0])))\n\n    }\n\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0 []\n0 []\n0 []\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n32 [00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F ...]\n</code></pre>\n"}], "owner": {"reputation": 738, "user_id": 678950, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/e0161297463503b10774dd9b236d301c?s=128&d=identicon&r=PG", "display_name": "Diamondo25", "link": "https://stackoverflow.com/users/678950/diamondo25"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1729, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1532023121, "creation_date": 1531838531, "question_id": 51384245, "link": "https://stackoverflow.com/questions/51384245/c-ucharbuffer0-vs-c-ucharunsafe-pointerbuffer0", "title": "(*C.uchar)(&amp;buffer[0]) vs (*C.uchar)(unsafe.Pointer(&amp;buffer[0]))", "body": "<p>We have a discussion here over using (or not) <code>unsafe.Pointer</code> for passing pointers to byte arrays from Go to C. </p>\n\n<p>What is the biggest reason (not) to use <code>unsafe.Pointer()</code> ? I would take consistency as a reason, as you'd call an 'external' function, even in a different language, and you want to guarantee that its a Pointer type.</p>\n\n<p>However, due to the Go language style looking a bit like C, using a straight cast using <code>(*C.uchar)(&amp;buffer[0]))</code> is valid <em>and</em> works. The fact that it works doesn't make me confident that its <em>safer</em> than using <code>unsafe.Pointer()</code>. </p>\n\n<p>Maybe I'm a bit confused/conflicted by the Go casts looking like function calls, and <code>Pointer</code> being defined as <code>type Pointer *ArbitraryType</code> <em>actually</em> says <code>(*ArbitraryType)&amp;buffer[0]</code> and does <em>not</em> actually invoke any command to do the 'conversion' but really just helps explaining what is going on, on a functional level, kind of like a macro <em>could</em> do.</p>\n"}, {"tags": ["javascript", "c", "memory-management", "emscripten"], "answers": [{"comments": [{"owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "edited": false, "score": 0, "creation_date": 1531916992, "post_id": 51388222, "comment_id": 89774830, "body": "@Alon Zakai - I&#39;d be interested to know if the above solution seems correct to you."}], "tags": [], "owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "is_accepted": true, "score": 0, "last_activity_date": 1531852605, "creation_date": 1531852605, "answer_id": 51388222, "question_id": 51384045, "link": "https://stackoverflow.com/questions/51384045/handling-output-buffers-in-emscripten/51388222#51388222", "title": "Handling output buffers in emscripten", "body": "<p>OK. I figured this out. For future emscripteners, you want to do something like the following.</p>\n\n<pre><code>var out_data_ptr = Module._malloc(8)\nvar out_data_array = new Uint32Array(Module.HEAPU32.buffer, out_data_ptr, 2)\nwrap_get_result_buffer(context, out_data_ptr, out_data_ptr + 4)\nvar response_uint8_array = new Uint8Array(Module.HEAPU8.buffer, out_data_array[0], out_data_array[1])\nModule._free(out_data_ptr)\n</code></pre>\n\n<p>The theory of operations here is that we create a two element array that will store the 'slots' to be filled in by calling <code>get_result_buffer</code>, and then construct a view over that exposing it as two <code>number</code> compatible elements. We then pass those in to our <code>get_result_buffer</code> function as lifted above with <code>cwrap</code>. After that, the heap memory that the <code>context</code> refers to is reachable from those slots, which can then be used to construct a <code>Uint8Array</code> that provides JS level access to the bytes in the result.</p>\n"}], "owner": {"reputation": 10953, "user_id": 776473, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/dbfcfc0e3c4b2b0baef2383fbc97f687?s=128&d=identicon&r=PG", "display_name": "acm", "link": "https://stackoverflow.com/users/776473/acm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 51388222, "answer_count": 1, "score": 0, "last_activity_date": 1531852605, "creation_date": 1531837969, "question_id": 51384045, "link": "https://stackoverflow.com/questions/51384045/handling-output-buffers-in-emscripten", "title": "Handling output buffers in emscripten", "body": "<p>Lets say I have a C API as follows:</p>\n\n<pre><code>void get_result_buffer(context* ctx, void** result, size_t* result_size);\n</code></pre>\n\n<p>Where <code>context</code> is some arbitrary opaque context type holding state. The intended way to call this is</p>\n\n<pre><code>context* ctx = ...;\n\ndo_something_with_context(ctx, ...);\n\nvoid* result_buffer = 0;\nsize_t result_buffer_size = 0;\nget_result_buffer(ctx, &amp;result_buffer, &amp;result_buffer_size);\n\n/* Now result_buffer and result_buffer_size are meaningful and populated with the results of having called `do_something_with_context`. */\n</code></pre>\n\n<p>The <code>result_buffer</code> is owned by the <code>context</code> object, so the caller doesn't need to free it. Now I'd like to be able to call <code>get_result_buffer</code> from Emscripten. I can easily enough set up <code>cwrap</code> for this, it looks something like:</p>\n\n<pre><code>wrap_get_result_buffer = something.cwrap(\n    'get_result_buffer',\n    null,\n    ['number', 'number', 'number']\n)\n</code></pre>\n\n<p>But I'm unclear how I can set things up so that the out parameters \"work\" in JS. Ideally, at the end, I'd have something that looks like a byte buffer containing a copy of the data pointed to by the <code>result</code> out parameter, with a length as described by the <code>result_size</code> out parameter.</p>\n\n<p>It seems that the values that I pass in need to be allocated somehow, and then I would pass the resulting allocation handle in as the <code>number</code> type parameters, but I have no idea how to do that in the JS/Emscripten layer. Similarly, after the call, I'd expect that those values have now been updated by the transpiled C code, but I'm unclear on how to extract the now populated data into some sort of JS byte array.</p>\n\n<p>Any guidance on how to do this or pointers to example code?</p>\n"}, {"tags": ["c", "printf", "variadic-functions"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1531837639, "post_id": 51383847, "comment_id": 89739730, "body": "There is no such a guarantee in the standard. <a href=\"http://port70.net/~nsz/c/c11/n1570.html#7.21.6.12p2\" rel=\"nofollow noreferrer\">port70.net/~nsz/c/c11/n1570.html#7.21.6.12p2</a> - <i>... argument list replaced by arg, <b>which shall have been initialized</b> by the va_start macro ...</i>"}], "answers": [{"comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1531843722, "post_id": 51384416, "comment_id": 89743782, "body": "Thanks.  That works in this over simplified example, but not for me, alas (because of other arguments, etc)."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 3, "last_activity_date": 1531839006, "creation_date": 1531839006, "answer_id": 51384416, "question_id": 51383847, "link": "https://stackoverflow.com/questions/51383847/is-vsprintf-guaranteed-not-to-access-va-list-if-format-string-makes-no-refer/51384416#51384416", "title": "Is vsprintf() guaranteed not to access va_list if format string makes no % references?", "body": "<p>If you don't have varargs passed to your function - your function isn't defined with <code>...</code> as the last parameter - there's simply never any need for any use of <code>va_list</code> or <code>va_start()</code> in that function.  If you want to pass an empty set of variable arguments, simply call the varargs function directly without any variable arguments - e.g., <code>printf(\"\\n\");</code>.</p>\n\n<p>For example, instead of </p>\n\n<pre><code>void foo ( void ) {\n    va_list ap;     /* no way to initialize this */\n\n    somefuncVA(\"\", ap);\n}\n</code></pre>\n\n<p>you can just write</p>\n\n<pre><code>void foo ( void ) {\n    vfoo(\"\");\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1531843265, "last_edit_date": 1531843265, "creation_date": 1531840632, "answer_id": 51384994, "question_id": 51383847, "link": "https://stackoverflow.com/questions/51383847/is-vsprintf-guaranteed-not-to-access-va-list-if-format-string-makes-no-refer/51384994#51384994", "title": "Is vsprintf() guaranteed not to access va_list if format string makes no % references?", "body": "<pre><code>int vsprintf(char * restrict s, const char * restrict format, va_list arg);\n</code></pre>\n\n<blockquote>\n  <p>If the format string passed to <code>vsprintf()</code> ... contains no %-references, is it guaranteed that the <code>va_list</code> argument is not accessed.</p>\n</blockquote>\n\n<p>No.</p>\n\n<blockquote>\n  <p>The <code>vsprintf</code> function is equivalent to <code>sprintf</code>, with the variable argument list\n  replaced by <code>arg</code>, which <strong>shall have been initialized</strong> by the <code>va_start</code> macro .....<br>\n  C11dr \u00a77.21.6.13</p>\n</blockquote>\n\n<p>Since the below code does not adhere to the spec, the result is <em>undefined behavior</em> (UB).  No guarantees.  <a href=\"https://stackoverflow.com/questions/51383847/is-vsprintf-guaranteed-not-to-access-va-list-if-format-string-makes-no-refer#comment89739730_51383847\">@Eugene Sh.</a></p>\n\n<pre><code>va_list ap;\n//                                    vv-- ap not initialized\n(void)vsnprintf(str, sizeof(str), \"\", ap);\n</code></pre>\n\n<hr>\n\n<blockquote>\n  <p>Is <code>vsprintf()</code> guaranteed not to access <code>va_list</code> if format string makes no % references?</p>\n</blockquote>\n\n<p>With a properly passed <code>va_list arg</code>, <code>vsprintf()</code> acts like <code>sprintf()</code>.  Code like the following is OK.  It is permissible to pass extra arguments.  Via  <code>vsprintf()</code>, they (the extra arguments) are not accessed, yet <code>va_list arg</code> may be accessed.</p>\n\n<pre><code>sprintf(buf, \"format without percent\", 1.2345, 456)`\n</code></pre>\n"}], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 51384994, "answer_count": 2, "score": 3, "last_activity_date": 1531843265, "creation_date": 1531837423, "last_edit_date": 1531841364, "question_id": 51383847, "link": "https://stackoverflow.com/questions/51383847/is-vsprintf-guaranteed-not-to-access-va-list-if-format-string-makes-no-refer", "title": "Is vsprintf() guaranteed not to access va_list if format string makes no % references?", "body": "<p>If the format string passed to <code>vsprintf()</code> (and variants thereof) contains no %-references, is it guaranteed that the va_list argument is not accessed?</p>\n\n<p>Put another way, is:</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\nint main ( void ) {\n    char    str[16];\n    va_list ap;         /* never initialized */\n\n    (void)vsnprintf(str, sizeof(str), \"\", ap);\n    return 0;\n}\n</code></pre>\n\n<p>a standard-conforming program?  or is there undefined behavior there?</p>\n\n<p>The example above is obviously silly, but imagine a function which can be called by both a variadic function and a fixed-args function, grossly simplified into something like:</p>\n\n<pre><code>void somefuncVA ( const char * fmt, va_list ap ) {\n    char    str[16];\n    int     n;\n\n    n = vsnprintf(str, sizeof(str), fmt, ap);\n    /* potentially do something with str */\n}\n\nvoid vfoo ( const char * fmt, ... ) {\n    va_list ap;\n\n    va_start(fmt, ap);\n    somefuncVA(fmt, ap);\n}\n\nvoid foo ( void ) {\n    va_list ap;     /* no way to initialize this */\n\n    somefuncVA(\"\", ap);\n}\n</code></pre>\n"}, {"tags": ["c", "gcc", "gcc-warning"], "comments": [{"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 0, "creation_date": 1531831559, "post_id": 51381625, "comment_id": 89735231, "body": "Interestingly clang <a href=\"https://wandbox.org/permlink/jFGdJNaoPEMcdoRy\" rel=\"nofollow noreferrer\">gets</a> it right."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 6, "creation_date": 1531831846, "post_id": 51381625, "comment_id": 89735401, "body": "Try <code>printf(&quot;b[10] = %d\\n&quot;, b[10]);</code>  9 is one past the end of the array, and is an allowable address (although it&#39;s still undefined to actually dereference it...)."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1531832549, "post_id": 51381625, "comment_id": 89735915, "body": "@AndrewHenle But b[9] is a dereference, &amp;b[9] would be valid. Some more oddness added to the question."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1531832919, "post_id": 51381625, "comment_id": 89736180, "body": "One past the end of the array may be treated differently - and in your first case, not quite correctly.  See the paragraphs on pointer arithmetic in the C standard:  <a href=\"https://port70.net/~nsz/c/c11/n1570.html#6.5.6p8\" rel=\"nofollow noreferrer\">https://port70.net/~nsz/c/c11/n1570.html#6.5.6p8</a>"}, {"owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "edited": false, "score": 5, "creation_date": 1531834453, "post_id": 51381625, "comment_id": 89737338, "body": "The different warnings are probably from different gcc versions. The behaviours of <i>both</i> your samples are undefined by the standards, so compilers are not actually <i>required</i> to do anything in particular with them - warnings are not required.  The problem for a compiler-developer is that undefined behaviour can manifest in an unlimited number of ways.  It is therefore difficult for a compiler to quickly (in the sense of programmers not whinging that it takes too long to compile) work out which warning is &quot;best&quot;."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1531834529, "post_id": 51381625, "comment_id": 89737392, "body": "@GoswinvonBrederlow: I think I fixed a typo; do please rollback if I&#39;m mistaken."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531834866, "post_id": 51381625, "comment_id": 89737650, "body": "Same gcc in both cases. Antti Haapala is probably right about the array being optimized away when not otherwise used making the out-of-bounds error disappear."}], "answers": [{"comments": [{"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 2, "creation_date": 1531832750, "post_id": 51381701, "comment_id": 89736061, "body": "Obviously. The question is specifically about the warning gcc shows. Not about the behavior or validity of the code. Gcc does now about out-of-bounds errors and the question is why it doesn&#39;t use it here. See the update for more strangeness."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 2, "creation_date": 1531832809, "post_id": 51381701, "comment_id": 89736109, "body": "@GoswinvonBrederlow: The gcc warning is correct. b[9] is uninitialised."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531832914, "post_id": 51381701, "comment_id": 89736177, "body": "It&#39;s really not uninitialised. It&#39;s out-of-bounds. dereferencing it is plain wrong."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 1, "creation_date": 1531832976, "post_id": 51381701, "comment_id": 89736220, "body": "@GoswinvonBrederlow: We can agree to disagree on that point. Your question is now more interesting now you&#39;ve added &amp;b[9] &amp;c."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1531838576, "post_id": 51381701, "comment_id": 89740449, "body": "True <code>b[9]</code> is uninitialized.  It is also outside the <code>b[]</code> array.  <a href=\"https://stackoverflow.com/a/51384188/2410359\">I tried</a> to &quot;initialize&quot;  <code>b[9]</code> and still have only 9 elements.  Result supports &quot;warning text is a little misleading, but not technically incorrect.&quot;"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531880708, "post_id": 51381701, "comment_id": 89757151, "body": "<a href=\"https://stackoverflow.com/questions/3144904/may-i-take-the-address-of-the-one-past-the-end-element-of-an-array\" title=\"may i take the address of the one past the end element of an array\">stackoverflow.com/questions/3144904/&hellip;</a>"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 16, "last_activity_date": 1531832918, "last_edit_date": 1531832918, "creation_date": 1531831389, "answer_id": 51381701, "question_id": 51381625, "link": "https://stackoverflow.com/questions/51381625/why-uninitialized-instead-of-out-of-bounds/51381701#51381701", "title": "Why uninitialized instead of out-of-bounds?", "body": "<p>The behaviour on reading <code>b[9]</code> or <code>b[10]</code> is <em>undefined</em>.</p>\n\n<p>Your compiler is issuing a warning (it doesn't have to), although the warning text is a little misleading, but not technically incorrect. In my opinion, it's rather clever. (A C compiler is <em>not</em> required to issue a diagnostic for out of bounds access.)</p>\n\n<p>Regarding <code>&amp;b[9]</code>, the compiler is <em>not</em> allowed to dereference that, and must evaluate it as <code>b + 9</code>. You are allowed to set a pointer one past the end of an array. The behaviour of setting a pointer to <code>&amp;b[10]</code> is <em>undefined</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1533572044, "post_id": 51382741, "comment_id": 90384820, "body": "I agree. gcc -O0 code is slow, unreadable, skips a lot of warnings and has little relevance to anything you want to ship. You should always use -Os or -O2."}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": true, "score": 56, "last_activity_date": 1531835244, "last_edit_date": 1531835244, "creation_date": 1531834371, "answer_id": 51382741, "question_id": 51381625, "link": "https://stackoverflow.com/questions/51381625/why-uninitialized-instead-of-out-of-bounds/51382741#51382741", "title": "Why uninitialized instead of out-of-bounds?", "body": "<p>I believe this could be the case here: in the first code, GCC notices that you don't need the entire char array at all, just <code>b[9]</code>, so it can replace the code with </p>\n\n<pre><code>char b_9; // = ???\nprintf(\"b[9] = %d\\n\", b_9);\n</code></pre>\n\n<p>Now, this is a <em>completely</em> legal transform, because as the array was accessed out of bounds, the behaviour is <strong>completely undefined</strong>. Only in latter phase does it then notice that this variable, which is a substitute for <code>b[9]</code>, is uninitialized, and issues the diagnostics message.</p>\n\n<p>Why I believe this? Because if I add <em>just</em> any code that will <em>reference</em> the array's address in <em>memory</em>, for example <code>printf(\"%p\\n\", &amp;b[8]);</code> anywhere, the array now is fully realized in memory, and compiler will diagnose <em>array subscript is above array bounds</em>.</p>\n\n<hr>\n\n<p>What I find even more interesting is that GCC does not diagnose out-of-bounds access at all unless optimizations are enabled. This would again suggest that whenever you're writing a program new program you should compile it with optimizations enabled to make the bugs highly visible instead of keeping them hidden with debug mode ;)</p>\n"}, {"tags": [], "owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "is_accepted": false, "score": -2, "last_activity_date": 1531867425, "last_edit_date": 1531867425, "creation_date": 1531834509, "answer_id": 51382786, "question_id": 51381625, "link": "https://stackoverflow.com/questions/51381625/why-uninitialized-instead-of-out-of-bounds/51382786#51382786", "title": "Why uninitialized instead of out-of-bounds?", "body": "<p>When you compile the code with -O2 the triviality of the example makes this variable optimized out. So the warning is 100% correct </p>\n"}, {"comments": [{"owner": {"reputation": 25103, "user_id": 1340389, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/5d0e5b16679b92b24c8262e1e6aa2aa7?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/1340389/kevin"}, "edited": false, "score": 0, "creation_date": 1531889183, "post_id": 51384188, "comment_id": 89758958, "body": "Re accessing the &quot;next&quot; member: That is legal because: 1. A pointer to the first member is equivalent to a pointer to the whole struct, 2. Any object can be safely cast to char array and dereferenced to inspect the byte representation, 3. <code>e.c</code> coincidentally happens to be a char array, so 4. You are type punning the whole struct into an array of char."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1531838368, "creation_date": 1531838368, "answer_id": 51384188, "question_id": 51381625, "link": "https://stackoverflow.com/questions/51381625/why-uninitialized-instead-of-out-of-bounds/51384188#51384188", "title": "Why uninitialized instead of out-of-bounds?", "body": "<p>Some additional experimental results.</p>\n\n<hr>\n\n<p>Using <code>char b[9]</code> instead of <code>char b[]</code> appears to make no difference, gcc still warns the same with <code>char b[9]</code>.</p>\n\n<p>Interestingly, initializing the one-passed element via the \"next\" member in a <code>struct</code> 1) does quiet the  \"uninitialized\" warning and 2) does not warn about accessioning outside the array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\ntypedef struct {\n  char c[9];\n  char d[9];\n} TwoNines;\n\nint main(void) {\n  char b[9] = { 'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!' };\n  printf(\"b[] size %zu\\n\", sizeof b);\n  printf(\"b[9] = %d\\n\", b[9]);   // 'b[9]' is used uninitialized in this function [-Wuninitialized]\n\n  TwoNines e = { { 'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!' }, //\n                 { 'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!' } };\n\n  printf(\"e size %zu\\n\", sizeof e);\n  printf(\"e.c[9] = %d\\n\", e.c[9]);   // No warning.\n\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>b[] size 9\nb[9] = 0\ne size 18    // With 18, we know `e` is packed.\ne.c[9] = 78  // 'N'\n</code></pre>\n\n<hr>\n\n<p>Notes:<br>\ngcc -std=c11 -O3 -g3 -pedantic -Wall -Wextra -Wconversion -c -fmessage-length=0 -v -MMD -MP ...<br>\ngcc/gcc-7.3.0-2.i686</p>\n"}], "owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2295, "favorite_count": 2, "accepted_answer_id": 51382741, "answer_count": 4, "score": 44, "last_activity_date": 1531867425, "creation_date": 1531831124, "last_edit_date": 1531834846, "question_id": 51381625, "link": "https://stackoverflow.com/questions/51381625/why-uninitialized-instead-of-out-of-bounds", "title": "Why uninitialized instead of out-of-bounds?", "body": "<p>In the code below why is <code>b[9]</code> uninitialized instead of out-of-bounds?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n    printf(\"b[9] = %d\\n\", b[9]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiler call:</p>\n\n<pre><code>% gcc -O2 -W -Wall -pedantic -c foo.c\nfoo.c: In function \u2018main\u2019:\nfoo.c:6:5: warning: \u2018b[9]\u2019 is used uninitialized in this function [-Wuninitialized]\n     printf(\"b[9] = %d\\n\", b[9]);\n% gcc --version\ngcc (Ubuntu 5.4.0-6ubuntu1~16.04.6) 5.4.0 20160609\nCopyright (C) 2015 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.  There is NO\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n</code></pre>\n\n<p>Update: Now this is odd:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid foo(char *);\n\nint main(void)\n{\n    char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n    foo(&amp;b[9]);\n    foo(&amp;b[10]);\n    printf(\"b[9] = %d\\n\", b[9]);\n    printf(\"b[10] = %d\\n\", b[10]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Compiling this results in the warnings one would expect:</p>\n\n<pre><code>% gcc -O2 -W -Wall -pedantic -c foo.c\nfoo.c: In function \u2018main\u2019:\nfoo.c:9:5: warning: array subscript is above array bounds [-Warray-bounds]\n     foo(&amp;b[10]);\n     ^\nfoo.c:10:29: warning: array subscript is above array bounds [-Warray-bounds]\n     printf(\"b[9] = %d\\n\", b[9]);\n                             ^\nfoo.c:11:29: warning: array subscript is above array bounds [-Warray-bounds]\n     printf(\"b[10] = %d\\n\", b[10]);\n</code></pre>\n\n<p>Suddenly gcc sees the out-of-bounds for what it is.</p>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531831341, "post_id": 51381587, "comment_id": 89735078, "body": "Please be more specific when you ask a question on this site. Try to code your idea and provide then the code and/or the errors."}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531831837, "post_id": 51381757, "comment_id": 89735396, "body": "That is not neccessary. If you declare an array f.e. in the main and pass the array to the function you can modify it as many times as you want as the stack will be cleared, but the array will be overwritten in the main as you pass an &#39;adress&#39; (passing by reference, not by value) to the function."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 1, "creation_date": 1531831969, "post_id": 51381757, "comment_id": 89735492, "body": "@Alan as asked &quot;a function that contain an array.&quot;"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1531833164, "post_id": 51381757, "comment_id": 89736355, "body": "There is a flaw though, because OP wants to use the array <i>after the call</i>. So the function should return a pointer to the array."}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531834494, "post_id": 51381757, "comment_id": 89737359, "body": "Thanks a lot but I want to use the result of the modified array another time.That I want to modify a part of the array in each call (many call) until all the array is modified.Please help.I have 2 week blocked I cannot solve this problem"}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531834712, "post_id": 51381757, "comment_id": 89737526, "body": "in each call I sould conserve the new tab until in the last call I have the array completely changed. I should have a function like this"}, {"owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "edited": false, "score": 0, "creation_date": 1531842999, "post_id": 51381757, "comment_id": 89743369, "body": "please the array that I want to return the value of each call is a struct array"}], "tags": [], "owner": {"reputation": 121, "user_id": 10093131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c6dbab030b10326f16c5a6459919d4?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/10093131/new-learner"}, "is_accepted": false, "score": 2, "last_activity_date": 1532108462, "last_edit_date": 1532108462, "creation_date": 1531831561, "answer_id": 51381757, "question_id": 51381587, "link": "https://stackoverflow.com/questions/51381587/change-the-value-of-an-array-in-a-function-in-many-times/51381757#51381757", "title": "change the value of an array in a function in many times", "body": "<p>Yes, you can...!\nJust declare an array as <code>static</code> so after the completion of the function execution, the array stack frame won't be cleared.\ne.g.</p>\n\n<pre><code>void modify_array(void)\n{\n    static int a[16]={/*'initialise here'*/};\n    {\n    /*'modify array here'*/\n    }\n} \n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9709580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e719cda3d7d321496f21875e8600cc6f?s=128&d=identicon&r=PG&f=1", "display_name": "kais", "link": "https://stackoverflow.com/users/9709580/kais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1532108735, "creation_date": 1531831008, "last_edit_date": 1532108735, "question_id": 51381587, "link": "https://stackoverflow.com/questions/51381587/change-the-value-of-an-array-in-a-function-in-many-times", "title": "change the value of an array in a function in many times", "body": "<p>Can I write a function that contains an array for example with the size of <code>16</code>? In each call of the function, I want to modify a part of the array. I want to call the function <code>4 times</code> until the whole array is changed. I should store the result of each call and use the new array after the call until all the array is changed.  </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1531831038, "post_id": 51381559, "comment_id": 89734862, "body": "Can you show some code? most likely, <code>void *</code> is being used as a placeholder."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531831088, "post_id": 51381559, "comment_id": 89734908, "body": "If you have a pointer to <code>void</code>, how would <i>compiler</i> know what it is <i>really</i> pointing at? The compiler can&#39;t know that, only you as the programmer can know that."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531831209, "post_id": 51381559, "comment_id": 89734980, "body": "As for why? A common thing these days with large multi-core processors is <i>threads</i>. And most thread-creation function can pass a pointer to <i>something</i> to the function running the thread, but the thread-creation function don&#39;t know <i>what</i> you want to pass a pointer to, so it have to use the generic &quot;any pointer&quot; <code>void *</code>."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531831316, "post_id": 51381559, "comment_id": 89735052, "body": "Or how about the memory allocation function <a href=\"http://en.cppreference.com/w/c/memory/malloc\" rel=\"nofollow noreferrer\"><code>malloc</code></a>? It allocates a chumk of memory and returns a pointer to the first byte of the memory. But it doesn&#39;t know what you want to use the memory for, so it returns a generic any pointer with the type <code>void *</code>. Then it&#39;s up to you to use that pointer by assigning it to a variable of the correct type."}, {"owner": {"reputation": 81, "user_id": 9332875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PFMeMfvQxH0/AAAAAAAAAAI/AAAAAAAAAAc/j20-H1G6EC8/photo.jpg?sz=128", "display_name": "Sumit Wadhwa", "link": "https://stackoverflow.com/users/9332875/sumit-wadhwa"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531831329, "post_id": 51381559, "comment_id": 89735068, "body": "@Someprogrammerdude hi, thanks for you comment. Can you expand on the why part? Also, if you could provide me references to learn more about it? Thanks for your time"}, {"owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "edited": false, "score": 1, "creation_date": 1531835546, "post_id": 51381559, "comment_id": 89738177, "body": "In general, you are exactly right.  In general, if you want a pointer to type <i>T</i>, you should use a pointer to type <i>T</i>.  Too much code uses <code>void *</code> unnecessarily, leading to confusion, unportability, and bugs.  Don&#39;t assume from the bad code you see that passing void pointers around, and casting them all over the place, is the right thing to do.  It&#39;s not.  (There are <i>specific</i> situations where you need <code>void *</code>, of course -- the canonical example is <code>malloc</code> -- but those situations are, well, specific.)"}], "owner": {"reputation": 81, "user_id": 9332875, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-PFMeMfvQxH0/AAAAAAAAAAI/AAAAAAAAAAc/j20-H1G6EC8/photo.jpg?sz=128", "display_name": "Sumit Wadhwa", "link": "https://stackoverflow.com/users/9332875/sumit-wadhwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "closed_date": 1531831095, "answer_count": 0, "score": 1, "last_activity_date": 1531831116, "creation_date": 1531830924, "last_edit_date": 1531831116, "question_id": 51381559, "link": "https://stackoverflow.com/questions/51381559/why-use-void-pointer-when-you-still-have-to-typecast-while-dereferencing", "closed_reason": "Duplicate", "title": "why use void pointer when you still have to typecast while dereferencing", "body": "<p><strong>Noob alert;</strong></p>\n\n<p>I'm learning C and came across <code>void*</code></p>\n\n<p>What I don't understand is that, if I'm <code>referencing an int variable</code> with a <code>void pointer</code>, why can't I simply <code>dereference ALSO with a void pointer</code>. And if I want to, I have to typecast.</p>\n\n<p><strong>so why would I ever want to use <code>void*</code> to begin with If I'm always going to typecast it with, let's say an Integer. And why not just use <code>int*</code> all the time</strong></p>\n\n<p>Code:</p>\n\n<pre><code> int main()\n {\n    int i = 10;\n    void* p = &amp;i;\n\n    printf(\"%i\", *(int*)p); // typecasting before dereferencing\n    return 0;\n }\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "multidimensional-array"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7362922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cNkCCY97GkA/AAAAAAAAAAI/AAAAAAAAcpY/AQEKvvixtYM/photo.jpg?sz=128", "display_name": "Aravind Ekan", "link": "https://stackoverflow.com/users/7362922/aravind-ekan"}, "edited": false, "score": 0, "creation_date": 1531831905, "post_id": 51381427, "comment_id": 89735443, "body": "Hi is there any other method apart from fgets?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 25, "user_id": 7362922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cNkCCY97GkA/AAAAAAAAAAI/AAAAAAAAcpY/AQEKvvixtYM/photo.jpg?sz=128", "display_name": "Aravind Ekan", "link": "https://stackoverflow.com/users/7362922/aravind-ekan"}, "edited": false, "score": 1, "creation_date": 1531832067, "post_id": 51381427, "comment_id": 89735576, "body": "@AravindEkan To read lines using standard C functions only, the best solution is <code>fgets</code>. You <i>can</i> use <code>scanf</code> (and family) but it becomes much more complex, and without a field-width limiter can also easily cause buffer overflows."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1531839558, "post_id": 51381427, "comment_id": 89741147, "body": "3rd problem, no width limit.  <code>&quot;%[^\\n]&quot;</code> is then akin to <code>gets()</code>.  Yes, better to use <code>fgets()</code>."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 7, "last_activity_date": 1531830582, "creation_date": 1531830582, "answer_id": 51381427, "question_id": 51381353, "link": "https://stackoverflow.com/questions/51381353/how-to-input-two-strings-separated-by-new-line-in-c/51381427#51381427", "title": "How to input two strings separated by new line in C", "body": "<p>You have two major problems:</p>\n\n<ol>\n<li><p>The <code>\"%[\"</code> format ends with the closing <code>\"]\"</code>, there should be no <code>\"s\"</code> at the end.</p></li>\n<li><p>The <code>\"%[\"</code> format doesn't skip leading space, like that newline which will be present after the first line you read.</p></li>\n</ol>\n\n<p>Both these issues can be easily solve by using <a href=\"http://en.cppreference.com/w/c/io/fgets\" rel=\"noreferrer\"><code>fgets</code></a> to read whole lines instead.</p>\n"}, {"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1531832722, "post_id": 51382059, "comment_id": 89736037, "body": "Never <i>ever</i> use <code>gets</code>. <a href=\"https://stackoverflow.com/questions/1694036/why-is-the-gets-function-so-dangerous-that-it-should-not-be-used\">It&#39;s a dangerous function</a>, and has therefore been removed from the C standard (and was deprecated long before)."}], "tags": [], "owner": {"reputation": 121, "user_id": 10093131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57c6dbab030b10326f16c5a6459919d4?s=128&d=identicon&r=PG&f=1", "display_name": "new_learner", "link": "https://stackoverflow.com/users/10093131/new-learner"}, "is_accepted": false, "score": -2, "last_activity_date": 1531832452, "creation_date": 1531832452, "answer_id": 51382059, "question_id": 51381353, "link": "https://stackoverflow.com/questions/51381353/how-to-input-two-strings-separated-by-new-line-in-c/51382059#51382059", "title": "How to input two strings separated by new line in C", "body": "<p>use gets(arr[i]) instead of scanf.</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 4481061, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/58rVj.jpg?s=128&g=1", "display_name": "Pulkit Kansal", "link": "https://stackoverflow.com/users/4481061/pulkit-kansal"}, "is_accepted": true, "score": 1, "last_activity_date": 1531885436, "last_edit_date": 1531885436, "creation_date": 1531884926, "answer_id": 51393190, "question_id": 51381353, "link": "https://stackoverflow.com/questions/51381353/how-to-input-two-strings-separated-by-new-line-in-c/51393190#51393190", "title": "How to input two strings separated by new line in C", "body": "<p>You already have suggestions to not use <code>scanf</code>. However, if you 'must' use <code>scanf</code> then you can consider the following approach:</p>\n\n<ul>\n<li>For dynamic memory allocation you should use malloc</li>\n<li>the newline character stays in the stdin and hence needs to be flushed or handled/ignored</li>\n</ul>\n\n<p>Here is the updated code.</p>\n\n<pre><code>int main()\n{\n    int n,i = 0;\n    scanf(\"%d\", &amp;n);\n\n    scanf(\"%*[\\n]\"); \n    /*this will read the \\n in stdin and not store it anywhere. So the next call to \n     * scanf will not be interfered with */\n\n    char **inputs;\n    inputs = malloc(n * sizeof(char *));\n\n    for (i = 0; i &lt; n; i++)\n    {\n       inputs[i] = malloc(100 * sizeof(char));\n    }\n\n\n    for(i = 0; i &lt; n; i++)\n    {\n        scanf(\"%*[\\n]\");\n        scanf(\"%100[^\\n]\", inputs[i]);\n    }\n\n    for(i = 0; i &lt; n; i++)\n    {\n        printf(\"%s\\n\", inputs[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7362922, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cNkCCY97GkA/AAAAAAAAAAI/AAAAAAAAcpY/AQEKvvixtYM/photo.jpg?sz=128", "display_name": "Aravind Ekan", "link": "https://stackoverflow.com/users/7362922/aravind-ekan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2061, "favorite_count": 0, "accepted_answer_id": 51393190, "answer_count": 3, "score": 1, "last_activity_date": 1531885436, "creation_date": 1531830331, "last_edit_date": 1531830497, "question_id": 51381353, "link": "https://stackoverflow.com/questions/51381353/how-to-input-two-strings-separated-by-new-line-in-c", "title": "How to input two strings separated by new line in C", "body": "<p>How can I input 2 strings which are separated by a new line?</p>\n\n<p>My Problem:</p>\n\n<p>First I need to give how many strings I need to get and then I need to get those strings then display it.</p>\n\n<p>I tried this:</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n\n    int n,i = 0;\n    scanf(\"%d\", &amp;n);\n    char arr[n][100];\n    for(int i = 0; i &lt; n; i++)\n    {\n        scanf(\"%[^\\n]s\", arr[i]);\n    }\n\n    for(int i = 0; i &lt; n; i++)\n    {\n        printf(\"%s\\n\", arr[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p><strong>My Input is :</strong></p>\n\n<pre><code>2 I am\nAravind\n</code></pre>\n\n<p><strong>My Output is:</strong></p>\n\n<pre><code>I am\n\u00fe\n</code></pre>\n\n<p>First Line I got correct one but second line it shows some garbage value. Help me to solve this.</p>\n"}, {"tags": ["c", "misra"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531830115, "post_id": 51381231, "comment_id": 89734197, "body": "better to wrap your macro code in <code>do {} while(0)</code> for starters so it&#39;s considered as one sole &quot;instruction&quot; in conditions."}, {"owner": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531837784, "post_id": 51381231, "comment_id": 89739847, "body": "@Jean-Fran&#231;oisFabre  I get the following message &quot;Violates MISRA 2004 Required Rule 19.4, Disallowed definition for macro &#39;DO_WAKEUP_SYNCHRONISIEREN&#39;&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1531986451, "post_id": 51381338, "comment_id": 89805237, "body": "As an (perhaps interesting) aside, MISRA C:2012 has relaxed this requirement - although personally, I would still advise using braces or parentheses to bound the macro unless otherwise required"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 1040, "user_id": 1614319, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff0ff3e7d5ad91f5432ad168d4f4c9f5?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1614319/andrew"}, "edited": false, "score": 0, "creation_date": 1531987745, "post_id": 51381338, "comment_id": 89805989, "body": "maybe they did so so it was possible to define <code>case x: do_##x()</code> stuff... Dunno. This rule sounded like a good idea to me, and every rule has exceptions."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1533635744, "post_id": 51381338, "comment_id": 90408077, "body": "do while(0) was removed from MISRA-C with version 2012. Earlier MISRA-C recommended using this practice, but it was criticized since do while(0) allows you to write control/loop statements that are not compound statements, which is in turn required by a different MISRA rule. The whole purpose of the do while(0) trick is to allow code such as <code>if(x) macro(); else</code>. But MISRA-C compatible code would have to be <code>if(x) { macro(); }  else</code>. And so the do-while(0) trick is harmful, as it blocks the compiler from detecting MISRA-C violations."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1533644891, "post_id": 51381338, "comment_id": 90413826, "body": "Thanks for the clarification. The whole purpose of the <code>do while(0)</code> trick (that&#39;s heavily covered here on SO) is to allow block and still force a <code>;</code> in the end, which you cannot ensure with <code>if(x) { macro(); } else</code>. As you said, there&#39;s no perfect world, and sometimes rules contradict each other like you mentionned. Rules are there to be violated with some justification when you know what you&#39;re doing."}], "tags": [], "owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "is_accepted": true, "score": 5, "last_activity_date": 1531925145, "last_edit_date": 1531925145, "creation_date": 1531830284, "answer_id": 51381338, "question_id": 51381231, "link": "https://stackoverflow.com/questions/51381231/misra-19-4-clarification/51381338#51381338", "title": "MISRA 19.4 clarification", "body": "<p>it looks like the rule is:</p>\n\n<pre><code>#define B A\n</code></pre>\n\n<blockquote>\n  <p>The above is not a permitted form of macro definition under this rule because A is not a constant, braced initializer, parenthesized expression, type qualifier, storage class specifier or <strong>do-while-zero construct</strong></p>\n</blockquote>\n\n<pre><code>#define B (A)\n</code></pre>\n\n<blockquote>\n  <p>The above is permitted. The replacement list is a parenthesised expression.</p>\n</blockquote>\n\n<p>an extension of this would be (even without MISRA constraints I'd do this, but I just noticed that the rule states it: \"do-while-zero construct\", IMHO it's not obvious at first glance what \"do-while-zero construct\" means when you're not aware of that...):</p>\n\n<pre><code>#define DO_WAKEUP_SYNCHRONISIEREN do {proc.id = process_WAKEUP;proc.priority.level = PRIO_AKTIV_1;proc.priority.param=0u;(void)prio_mapF_put_in_matrix(proc);} while(0)\n</code></pre>\n\n<p>so the instruction block cannot be \"partially called\" by constructs like this:</p>\n\n<pre><code>if (flag) DO_WAKEUP_SYNCHRONISIEREN;\n</code></pre>\n\n<p>which would give headaches to anyone trying to understand the bug.</p>\n\n<p>And at the same time it forces to add a <code>;</code> as opposed to a simple <code>{}</code> block. So the macro looks very much like a function call (also read <a href=\"https://stackoverflow.com/questions/9495962/why-use-do-while-0-in-macro-definition\">Why use do { } while (0) in macro definition?</a>).</p>\n"}], "owner": {"reputation": 97, "user_id": 9430021, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ankit Shah", "link": "https://stackoverflow.com/users/9430021/ankit-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1440, "favorite_count": 0, "accepted_answer_id": 51381338, "answer_count": 1, "score": -1, "last_activity_date": 1531925145, "creation_date": 1531829964, "last_edit_date": 1531923025, "question_id": 51381231, "link": "https://stackoverflow.com/questions/51381231/misra-19-4-clarification", "title": "MISRA 19.4 clarification", "body": "<p>I want to use the following MACRO in my file</p>\n\n<pre><code>#define DO_WAKEUP_SYNCHRONISIEREN proc.id = process_WAKEUP;proc.priority.level = PRIO_AKTIV_1;proc.priority.param=0u;(void)prio_mapF_put_in_matrix(proc)\n</code></pre>\n\n<p>I know that it is a violation of MISRA-C:2004 Rule 19.4 - but I need to use this and to solve the violation.</p>\n\n<p>Is there any way I can use the MACRO and also solve the MISRA-C violation?</p>\n\n<p>MISRA-C:2004 Rule 19.4 is </p>\n\n<blockquote>\n  <p>C macros shall only expand to a braced initialiser, a constant,\n  a string literal, a parenthesised expression, a type qualifier, a\n  storage class specifier, or a do-while-zero construct.</p>\n</blockquote>\n"}, {"tags": ["c", "casting"], "comments": [{"owner": {"reputation": 17209, "user_id": 1055118, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/44Trt.jpg?s=128&g=1", "display_name": "doctorlove", "link": "https://stackoverflow.com/users/1055118/doctorlove"}, "edited": false, "score": 0, "creation_date": 1531829311, "post_id": 51380958, "comment_id": 89733614, "body": "Yes - though padding as you mention, and possible endiand-ness issues. The cast &quot;pretends&quot; this first byte is the start of the struct."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1531829539, "post_id": 51380958, "comment_id": 89733777, "body": "A quick scan of the linked code reveals what appears to me to be a lot of undefined behavior and strict aliasing violations."}], "answers": [{"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1531831335, "creation_date": 1531831335, "answer_id": 51381681, "question_id": 51380958, "link": "https://stackoverflow.com/questions/51380958/c-libpcap-api-casting-packet-to-structconfusing/51381681#51381681", "title": "C libpcap API casting packet to struct(confusing)", "body": "<blockquote>\n  <p>Lets say I have this struct</p>\n\n<pre><code>struct 16bits{ \n int8_t a;\n int8_t b;\n }\n</code></pre>\n  \n  <p>and a 16bit sequence</p>\n\n<pre><code>0001 0011 0111 1111\n</code></pre>\n  \n  <p>and if I cast it to 16bits struct it would look like this ?</p>\n\n<pre><code>a = 0001 0011\nb = 0111 1111\n</code></pre>\n</blockquote>\n\n<p>I assume you mean something like:</p>\n\n<pre><code>// this points at your 16-bit sequence\nunsigned char *input_data = ...\n\nstruct 16bits *output_data = ( struct 16bits * ) input_data;\n\nuint8_t a_bits = output_data-&gt;a;\nuint8_t b_bits = output_data-&gt;b;\n</code></pre>\n\n<p>In general, no you cannot assume you can do that.  In general, that would be <a href=\"https://stackoverflow.com/questions/98650/what-is-the-strict-aliasing-rule\">a strict aliasing violation</a> and undefined behavior.  The \"strict aliasing\" rule basically says you can't treat memory as something it's not - but with the exception that you can always access anything one <code>char</code> at a time.  An <code>int</code> is not a <code>float</code>.</p>\n\n<p>In addition, as you mention there can be padding between fields in a structure.</p>\n\n<p>In your specific example, though, it's almost certain to \"work\" on just about any platform, though, because <code>int8_t</code> is almost certainly a <code>signed char</code>, there's almost certainly no padding in the <code>struct 16bits</code>, and any memory can always be accessed as a <code>char</code> value.</p>\n\n<p>Replace the <code>char</code> types with types such as <code>double</code> or <code>int64_t</code>, though, and you can run into alignment as well as padding issues.  On some platforms, such strict aliasing violations can cause code to fail with <code>SIGSEGV</code> or <code>SIGBUS</code>. </p>\n\n<p>Assuming 8-bit <code>char</code> values so <code>int8_t</code> is actually a <code>char</code>, a fully standards-compliant way of accessing any data type as applied to your 16-bit sequence as two 8-bit values would be</p>\n\n<pre><code>// assume this points to your 16-bit sequence\nunsigned char *input_data = ...\n\n// create a structure that we can actually copy the bits into\nstruct 16bits output_data;\n\nmemcpy( &amp;output_data, input_data, sizeof( output_data ) );\n</code></pre>\n\n<p>Note that if the structure contains elements of a type other that <code>char</code>, there may be padding.  And if you use something like <code>#pragma pack</code> to eliminate the padding, <a href=\"https://stackoverflow.com/questions/7793511/are-there-performance-issues-when-using-pragma-pack1\">you can wind up with code that doesn't run on some platforms.</a></p>\n\n<p>Code such as that in the link you provided is rampant - and it's actually undefined behavior.  But it \"works\" because the x86 platform most popular published code is written on is very, very, very forgiving of misaligned accesses (although there is still a performance penalty).  But that type of code won't work well at all on any platform that does have alignment requirements.  Just <a href=\"https://www.google.com/search?q=pragma%20pack%20sigbus\" rel=\"nofollow noreferrer\">Google <code>pragma pack sigbus</code></a> and you'll find lots of examples of programmers surprised when code that ran just fine on x86 fails on ARM or SPARC platforms, for example.</p>\n"}], "owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1531831335, "creation_date": 1531829164, "question_id": 51380958, "link": "https://stackoverflow.com/questions/51380958/c-libpcap-api-casting-packet-to-structconfusing", "title": "C libpcap API casting packet to struct(confusing)", "body": "<p>After reading this tutorial</p>\n\n<p><code>(https://www.tcpdump.org/pcap.html)</code> </p>\n\n<p>On the very bottom the author is casting a <code>u_char *packet</code> pointer into a struct. </p>\n\n<p>Does such casting work like this</p>\n\n<p>Lets say I have this struct</p>\n\n<pre><code>struct 16bits{ \n int8_t a;\n int8_t b;\n }\n</code></pre>\n\n<p>and a 16bit sequence</p>\n\n<pre><code>0001 0011 0111 1111\n</code></pre>\n\n<p>and if I cast it to 16bits struct it would look like this ?</p>\n\n<pre><code>a = 0001 0011\nb = 0111 1111\n</code></pre>\n\n<p>The question is if I understand the authors casting correctly.</p>\n\n<p>I am aware about padding in structs, but lets think the compiler doesn't add it for a moment</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1531823817, "post_id": 51379237, "comment_id": 89729947, "body": "Why do you thing the given reason is <i>improper</i>?"}, {"owner": {"reputation": 396, "user_id": 8454073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcaBH.jpg?s=128&g=1", "display_name": "Ankita Mehta", "link": "https://stackoverflow.com/users/8454073/ankita-mehta"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1531823962, "post_id": 51379237, "comment_id": 89730043, "body": "@SouravGhosh because check out the below answer it is the proper reason the referencing and dereferencing part it was not clear in the above reason."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 2, "creation_date": 1531825472, "post_id": 51379237, "comment_id": 89730998, "body": "Nothing was clear, anyway, just a suggestion: start reading some good book."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531827793, "post_id": 51379237, "comment_id": 89732590, "body": "Please next time when asking a question, use the keywords from your title in Google with <code>site:stackoverflow.com</code> to find previous questions with excellent answers that exist on Stack Overflow. Your question will be met more positively if you can demonstrate that you&#39;ve done your research."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 2, "last_activity_date": 1531823771, "creation_date": 1531823771, "answer_id": 51379267, "question_id": 51379237, "link": "https://stackoverflow.com/questions/51379237/what-is-the-use-of-ampersn-in-scanf-in-c-language/51379267#51379267", "title": "what is the use of [ampersn] in scanf() in c language", "body": "<p>In <code>c</code> <strong>all</strong> function parameters are passed by value.</p>\n\n<p>That means that a function cannot modify the parameters passed by the caller.</p>\n\n<p>What it <em>can</em> do, other than making use of <code>return</code>, is to accept <em>pointer</em> types (to arrays or objects) as parameters, and modify those arrays or objects by <em>dereferencing</em> those pointers.</p>\n\n<p>This is the approach used by <code>scanf</code>. <code>scanf</code> also makes use of <code>return</code> as well.</p>\n"}, {"tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 3, "last_activity_date": 1531824446, "last_edit_date": 1531824446, "creation_date": 1531824013, "answer_id": 51379337, "question_id": 51379237, "link": "https://stackoverflow.com/questions/51379237/what-is-the-use-of-ampersn-in-scanf-in-c-language/51379337#51379337", "title": "what is the use of [ampersn] in scanf() in c language", "body": "<p>In C you can only pass arguments <em>by value</em>. That means as you pass an argument to a function, the value is <em>copied</em>.</p>\n\n<p>C doesn't have pass by reference, but it can be emulated using pointers.</p>\n\n<p>For example</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid f1(int a)\n{\n    a = 123;  // Modify local copy\n}\n\nvoid f2(int *a)\n{\n    *a = 234;  // Modify value where a is pointing\n}\n\nint main(void)\n{\n    int a1 = 0, a2 = 0;\n\n    f1(a1);\n    f2(&amp;a2);\n\n    printf(\"a1 = %d, a2 = %d\\n\", a1, a2);\n}\n</code></pre>\n\n<p>The above program would print</p>\n\n<pre>\na1 = 0, a2 = 234\n</pre>\n\n<p>That's because when <code>f1</code> modifies the value of its argument, it only modifies its local copy. The original (the variable <code>a1</code> in the <code>main</code> function) is not modified.</p>\n\n<p>The function <code>f2</code> on the other hand emulates pass by reference. When calling <code>f2</code> we pass a pointer to the variable <code>a2</code> by using the address-of operator <code>&amp;</code>. Then the function can dereference that pointer to get where it is pointing (the variable <code>a2</code> in the <code>main</code> function) and modify it.</p>\n\n<p>Because the <code>scanf</code> function needs to modify variables, you can not pass copies of their current values, you need to pass pointers to the variables like when calling <code>f2</code> in the above example.</p>\n"}], "owner": {"reputation": 396, "user_id": 8454073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcaBH.jpg?s=128&g=1", "display_name": "Ankita Mehta", "link": "https://stackoverflow.com/users/8454073/ankita-mehta"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "closed_date": 1531827528, "answer_count": 2, "score": -1, "last_activity_date": 1533206754, "creation_date": 1531823672, "last_edit_date": 1533206754, "question_id": 51379237, "link": "https://stackoverflow.com/questions/51379237/what-is-the-use-of-ampersn-in-scanf-in-c-language", "closed_reason": "Duplicate", "title": "what is the use of [ampersn] in scanf() in c language", "body": "<p>why we use <code>&amp; (ampersn)</code> sign in <code>scanf()</code> while storing value.</p>\n\n<p>PS : I know it is used to store value of variable at proper address.</p>\n\n<p>Is there any other proper reason? </p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 7, "creation_date": 1531818784, "post_id": 51377396, "comment_id": 89726485, "body": "<code>if (printf(&quot;I love &quot;)) printf(&quot;food&quot;);</code>"}, {"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1531819099, "post_id": 51377396, "comment_id": 89726687, "body": "@mch Great answer, simple and clean code!"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 3, "creation_date": 1531819360, "post_id": 51377396, "comment_id": 89726876, "body": "@Jean-Fran&#231;oisFabre not quite, the (admittedly stupid) exam question asks to replace <code>condition</code> and nothing else."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1531819645, "post_id": 51377396, "comment_id": 89727071, "body": "@Jabberwocky aaah I see your point now."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1531819676, "post_id": 51377396, "comment_id": 89727094, "body": "@mch make that an answer."}, {"owner": {"reputation": 69264, "user_id": 256138, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ed9e8c0ff767e38f8fade11f5af00a45?s=128&d=identicon&r=PG", "display_name": "rubenvb", "link": "https://stackoverflow.com/users/256138/rubenvb"}, "edited": false, "score": 6, "creation_date": 1531820430, "post_id": 51377396, "comment_id": 89727623, "body": "Is this a question for an exam &quot;how to program the worst way possible&quot;?"}, {"owner": {"reputation": 7829, "user_id": 4950584, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xTMYK-wVa7U/AAAAAAAAAAI/AAAAAAAAAGA/x2vE5BBF-hM/photo.jpg?sz=128", "display_name": "Chris Turner", "link": "https://stackoverflow.com/users/4950584/chris-turner"}, "edited": false, "score": 0, "creation_date": 1531820553, "post_id": 51377396, "comment_id": 89727717, "body": "Is that all the code you get in the question?"}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 2, "creation_date": 1531853533, "post_id": 51377396, "comment_id": 89748692, "body": "Please inform your instructor that approximately the entire internet thinks this is a bad exam question and they should feel bad for having asked it."}], "answers": [{"comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531828166, "post_id": 51377861, "comment_id": 89732845, "body": "nice, that kind of programming is discouraged. Can be useful when you cannot change the code directly, but only with macros."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1531828464, "post_id": 51377861, "comment_id": 89733032, "body": "@Jean-Fran&#231;oisFabre: Whoever asks such exam questions should be forced to teach whitespace instead (with a whiteboard/paper handouts to students only). Provided there is no additional code which makes this at least a bit more reasonable. Note there <b>has to be</b> more, because the snippet in the question is apparently no valid C program."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1531828577, "post_id": 51377861, "comment_id": 89733110, "body": "it&#39;s true that there are a million more interesting things to ask at an exam. Smartass teachers..."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1531828898, "post_id": 51377861, "comment_id": 89733321, "body": "@Jean-Fran&#231;oisFabre: _Smart_a**?? Definitively only the second part."}], "tags": [], "owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "is_accepted": true, "score": 5, "last_activity_date": 1531819839, "creation_date": 1531819839, "answer_id": 51377861, "question_id": 51377396, "link": "https://stackoverflow.com/questions/51377396/can-we-go-back-and-execute-the-if-condition-after-executing-the-else-condition-b/51377861#51377861", "title": "Can we go back and execute the if condition after executing the else condition by just changing the if condition?", "body": "<p>You can change <code>condition</code> to <code>printf(\"I love \")</code>. <code>printf</code> returns the number of printed characters, which will be 7, so the condition is true. </p>\n\n<pre><code>if (printf(\"I love \"))\n    printf(\"food\");\nelse\n   printf(\"I love\");\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10092676"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "closed_date": 1531828194, "accepted_answer_id": 51377861, "answer_count": 1, "score": 2, "last_activity_date": 1531916659, "creation_date": 1531818590, "last_edit_date": 1531916659, "question_id": 51377396, "link": "https://stackoverflow.com/questions/51377396/can-we-go-back-and-execute-the-if-condition-after-executing-the-else-condition-b", "closed_reason": "Needs details or clarity", "title": "Can we go back and execute the if condition after executing the else condition by just changing the if condition?", "body": "<p>I had the following question for my C exam:</p>\n\n<p>What should you write in place of 'condition' to print the statement 'I love food' in just one execution? You cannot add any more code.</p>\n\n<pre><code>    if(condition)\n    printf(\"food\");\n    else\n    printf(\"I love\");\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "char"], "comments": [{"owner": {"reputation": 6855, "user_id": 3125194, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ca2177750fa502328461e68d385e6d9?s=128&d=identicon&r=PG&f=1", "display_name": "Marian", "link": "https://stackoverflow.com/users/3125194/marian"}, "edited": false, "score": 1, "creation_date": 1531818136, "post_id": 51377179, "comment_id": 89726035, "body": "<code>a</code> terminates with zero character, so it is one character longer than <code>b</code>."}, {"owner": {"reputation": 2605, "user_id": 4846598, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56c681dc497676a33de782f84bc7a87f?s=128&d=identicon&r=PG&f=1", "display_name": "Hearner", "link": "https://stackoverflow.com/users/4846598/hearner"}, "edited": false, "score": 0, "creation_date": 1531818166, "post_id": 51377179, "comment_id": 89726058, "body": "<a href=\"https://en.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow noreferrer\">See here what is \\0</a>"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531819032, "post_id": 51377179, "comment_id": 89726638, "body": "Conventionally, <code>*(pa + 9)</code> is written using array index notation: <code>pa[9]</code>."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531830841, "post_id": 51377179, "comment_id": 89734744, "body": "<code>*(pb+9)</code> is undefined behavior so whatever output you get is meaningless."}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531818291, "post_id": 51377231, "comment_id": 89726146, "body": "*NULL terminator"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "reply_to_user": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 0, "creation_date": 1531818324, "post_id": 51377231, "comment_id": 89726171, "body": "@Alan negative, don&#39;t mix up the <code>NULL</code> pointer and the <code>NUL</code> character, it&#39;s two different things."}, {"owner": {"reputation": 18493, "user_id": 388661, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61df8d728c699c39c4c73507da598712?s=128&d=identicon&r=PG", "display_name": "davmac", "link": "https://stackoverflow.com/users/388661/davmac"}, "reply_to_user": {"reputation": 559, "user_id": 6865330, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OGNmd.png?s=128&g=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6865330/alan"}, "edited": false, "score": 3, "creation_date": 1531818593, "post_id": 51377231, "comment_id": 89726367, "body": "@Alan as Jabberwocky says <code>NULL</code> is different to the <code>NUL</code> character, but confusingly &quot;the null character&quot; is the same thing as <code>NUL</code>. So you can say &quot;NUL terminator&quot; or &quot;null terminator&quot;, both are correct (but &quot;NULL terminator&quot; isn&#39;t). <a href=\"https://en.wikipedia.org/wiki/Null_character\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Null_character</a>"}], "tags": [], "owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "is_accepted": false, "score": 7, "last_activity_date": 1531818387, "last_edit_date": 1531818387, "creation_date": 1531818064, "answer_id": 51377231, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from/51377231#51377231", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<p>It's almost the same.</p>\n\n<p>This array is <code>NUL</code> terminated:</p>\n\n<pre><code>char a[] = \"Nice you!\";\n</code></pre>\n\n<p>This array is not <code>NUL</code> terminated:</p>\n\n<pre><code>char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n</code></pre>\n\n<p>The exact equivalent of array <code>a</code> is this:</p>\n\n<pre><code>char c[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!', 0};\n                                                         ^ NUL terminator\n</code></pre>\n\n<p>In your code <code>*(pb + 9)</code> accesses one element beyond the array, therefore the behaviour of your program is undefined.</p>\n"}, {"tags": [], "owner": {"reputation": 9095, "user_id": 8542346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11b206b49cec657d28a5876f8330780e?s=128&d=identicon&r=PG&f=1", "display_name": "H.S.", "link": "https://stackoverflow.com/users/8542346/h-s"}, "is_accepted": false, "score": 6, "last_activity_date": 1531820800, "last_edit_date": 1531820800, "creation_date": 1531818155, "answer_id": 51377266, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from/51377266#51377266", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<blockquote>\n  <p><em>I think a[] and b[] are exactly the same....</em></p>\n</blockquote>\n\n<p>No, they are not same. The difference is null terminating character.  </p>\n\n<p>This </p>\n\n<pre><code>char a[] = \"Nice you!\";\n</code></pre>\n\n<p>is equivalent to this</p>\n\n<pre><code>char a[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!', '\\0'};\n                                                          ^^^ \n</code></pre>\n\n<p>The last element of array <code>a</code> is null terminated character - <code>'\\0'</code>.</p>\n\n<p>In this</p>\n\n<pre><code>char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n</code></pre>\n\n<p>the last element of array <code>b</code> is <code>'!'</code> character.</p>\n\n<p>Array <code>a</code> is a <strong>string</strong><sup>1)</sup> and array <code>b</code> is <strong>array of characters</strong>.</p>\n\n<p>When we omit the dimension, compiler computes it for us based on the size of the initializer. So, the dimension of array <code>a</code> will be <code>10</code> whereas the dimension of array <code>b</code> will be <code>9</code>.</p>\n\n<p>In your program, you are accessing the array <code>b</code> beyond its size using pointer <code>pb</code>:</p>\n\n<pre><code>printf(\"*(pb + 9)= %d\\n\", *(pb + 9));\n</code></pre>\n\n<p><code>*(pb + 9)</code> -> <code>p[9]</code> -> accessing <code>10th</code> element of array <code>b</code> causes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow noreferrer\">undefined behavior</a> as you try to access array out of bound.</p>\n\n<hr>\n\n<p>1) C language does not have native <em>string</em> type. In C, strings are actually one-dimensional array of characters terminated by a null character <code>'\\0'</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 1, "creation_date": 1531819223, "post_id": 51377292, "comment_id": 89726776, "body": "<code>NULL</code> and <code>\\0</code> are not exactly the same. <code>&#39;\\0&#39;</code> is an <code>int</code> but <code>NULL</code> is usually a <code>(void*) 0</code>."}, {"owner": {"reputation": 8391, "user_id": 7896849, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Q2qxc.jpg?s=128&g=1", "display_name": "Sreeram TP", "link": "https://stackoverflow.com/users/7896849/sreeram-tp"}, "reply_to_user": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "edited": false, "score": 0, "creation_date": 1531819306, "post_id": 51377292, "comment_id": 89726831, "body": "yeah. Sorry. I meant to say null character"}], "tags": [], "owner": {"reputation": 8391, "user_id": 7896849, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/Q2qxc.jpg?s=128&g=1", "display_name": "Sreeram TP", "link": "https://stackoverflow.com/users/7896849/sreeram-tp"}, "is_accepted": false, "score": 1, "last_activity_date": 1531819327, "last_edit_date": 1531819327, "creation_date": 1531818234, "answer_id": 51377292, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from/51377292#51377292", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<p>Both <code>a</code> and <code>b</code> are same. </p>\n\n<p>There is a slight difference though. The array <code>a</code> will have <code>Null Character</code> ie <code>\\0</code> in it's last location. </p>\n\n<p>Where as the array <code>b</code> will be having <code>!</code> at it's last index</p>\n"}, {"tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": false, "score": 1, "last_activity_date": 1531818414, "creation_date": 1531818414, "answer_id": 51377352, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from/51377352#51377352", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<blockquote>\n  <p><strong>I think a[] and b[] are exactly the same</strong></p>\n</blockquote>\n\n<p>No, they're not the same.</p>\n\n<pre><code>char a[] = \"Nice you!\";\n</code></pre>\n\n<p>Is a character array that meets all the criteria for a C \"string\" - it's terminated implicitly by a <code>'\\0'</code> character.  You can safely print it with calls such as <code>puts( a )</code>.</p>\n\n<pre><code>char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n</code></pre>\n\n<p>is just a character array.  It is <strong>not</strong> implicitly terminated with a <code>'\\0'</code> character.  Trying to print it with something like <code>puts( b )</code> is undefined behavior.</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531828102, "post_id": 51379148, "comment_id": 89732805, "body": "It is not <code>NULL</code>, <code>NULL</code> is a null pointer constant; you mean <code>NUL</code>."}, {"owner": {"reputation": 116, "user_id": 9577824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SVv9v.jpg?s=128&g=1", "display_name": "fardinabir", "link": "https://stackoverflow.com/users/9577824/fardinabir"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531841219, "post_id": 51379148, "comment_id": 89742213, "body": "would you please tell the diffrence between <code>NULL</code> and <code>NUL</code> ?"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531843008, "post_id": 51379148, "comment_id": 89743374, "body": "<code>NULL</code> is a macro defined in <code>&lt;stdlib.h&gt;</code> which expands to a null pointer constant. The null character is also known as <a href=\"https://en.wikipedia.org/wiki/Null_character\" rel=\"nofollow noreferrer\"><code>NUL</code></a>. Of course there is no constant by the name <code>NUL</code> in headers - use <code>0</code> or <code>&#39;\\0&#39;</code> for <i>that</i>."}], "tags": [], "owner": {"reputation": 116, "user_id": 9577824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SVv9v.jpg?s=128&g=1", "display_name": "fardinabir", "link": "https://stackoverflow.com/users/9577824/fardinabir"}, "is_accepted": false, "score": 0, "last_activity_date": 1531841139, "last_edit_date": 1531841139, "creation_date": 1531823407, "answer_id": 51379148, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from/51379148#51379148", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<p>Yup, <code>a[]</code> and <code>b[]</code> are almost same.</p>\n\n<p>Here, <code>a[]</code> is a string ( though there is no data type in C named string ) . It acts like an automatic array of characters when you declare <code>a[]</code> like this <code>char a[] = \"Nice you!\"</code> and compiler puts a <code>NUL</code> (<code>'\\0'</code>) which defines the end of the string.</p>\n\n<p>But, when you are declaring something like this <code>char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'}</code>   it means you very declaring an array of character in your way , not in the way of built in <code>char</code> array. So, it doesn't hold a <code>NUL</code> (<code>'\\0'</code>) after <code>'!'</code> . In fact what the second array <code>b[]</code> will print is undefined .</p>\n\n<p>Thank you...!</p>\n"}], "owner": {"reputation": 887, "user_id": 8768374, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh4.googleusercontent.com/-Hyjh8IMe3Ho/AAAAAAAAAAI/AAAAAAAAAMQ/mqo_dEpoGPQ/photo.jpg?sz=128", "display_name": "Sleeping On a Giant&#39;s Shoulder", "link": "https://stackoverflow.com/users/8768374/sleeping-on-a-giants-shoulder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1531841139, "creation_date": 1531817951, "last_edit_date": 1531819598, "question_id": 51377179, "link": "https://stackoverflow.com/questions/51377179/is-an-array-initialized-from-a-string-literal-identical-to-one-initialized-from", "title": "Is an array initialized from a string literal identical to one initialized from individual characters?", "body": "<p>There are two arrays:</p>\n\n<pre><code>char a[] = \"Nice you!\";     \nchar b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n</code></pre>\n\n<p>I think <code>a[]</code> and <code>b[]</code> are exactly the same. So here's my code to see what is after the final element of each array:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    char a[] = \"Nice you!\";\n    char b[] = {'N', 'i', 'c', 'e', ' ', 'y', 'o', 'u', '!'};\n\n    char *pa;\n    char *pb;\n    pa = a;\n    pb = b;\n    printf(\"*(pa + 9)= %d\\n\", *(pa + 9));\n    printf(\"*(pb + 9)= %d\\n\", *(pb + 9));\n\n    return 0;\n}\n</code></pre>\n\n<p>Is my understanding correct? I am not so sure and need confirmation.</p>\n"}, {"tags": ["c", "struct", "padding"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1531816638, "post_id": 51376721, "comment_id": 89725080, "body": "For your specific compiler (and version of it) you can use <a href=\"http://en.cppreference.com/w/c/types/offsetof\" rel=\"nofollow noreferrer\"><code>offsetof</code></a> to find out. Note that it&#39;s highly implementation-specific."}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1531817009, "post_id": 51376721, "comment_id": 89725334, "body": "Very often compilers have the struct packing mechanism"}, {"owner": {"reputation": 23378, "user_id": 4850040, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/acYd0.png?s=128&g=1", "display_name": "Toby Speight", "link": "https://stackoverflow.com/users/4850040/toby-speight"}, "edited": false, "score": 0, "creation_date": 1531818006, "post_id": 51376721, "comment_id": 89725949, "body": "Even for a given compiler (version), the result is usually target-specific."}, {"owner": {"reputation": 199, "user_id": 7276869, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0fae8650ad0ef7bf4dac718e0c2521e9?s=128&d=identicon&r=PG&f=1", "display_name": "Urvika G", "link": "https://stackoverflow.com/users/7276869/urvika-g"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1531819489, "post_id": 51376721, "comment_id": 89726963, "body": "@Someprogrammerdude THANKYOU!! That solves it :)"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531819588, "post_id": 51376721, "comment_id": 89727031, "body": "Also use <code>sizeof</code> to check for padding after the last member."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1531829211, "post_id": 51376721, "comment_id": 89733545, "body": "We are not a &quot;do my homework&quot; service."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1531831341, "post_id": 51376721, "comment_id": 89735079, "body": "@Someprogrammerdude It&#39;s not so much implementation-specific. The alignment and padding is part of the architectures calling convention, the ABI of C object files if you will. Without common rules object files from different compilers couldn&#39;t be linked together. That still leaves a lot of 32bit systems to choose from though."}], "answers": [{"comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1531818631, "post_id": 51377308, "comment_id": 89726396, "body": "Why the <code>char pad_0[2]</code>? The <code>uint8_t</code> doesn&#39;t have any alignment prerequisite."}, {"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1531820313, "post_id": 51377308, "comment_id": 89727522, "body": "The compiler adds 2 bytes to fill the 32 bits. If you want, you can also see it as <code>uint16_t</code> instead of 2 chars but in the end it&#39;s the same thing...2 bytes"}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1531820425, "post_id": 51377308, "comment_id": 89727613, "body": "<a href=\"https://ideone.com/Ywr2XP\" rel=\"nofollow noreferrer\">ideone.com/Ywr2XP</a> One of the most common architecturs (linux 64 bits + gcc) doesn&#39;t insert padding."}, {"owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1531820786, "post_id": 51377308, "comment_id": 89727893, "body": "I don&#39;t know if the compiler may even reorder structure members to optimize"}], "tags": [], "owner": {"reputation": 908, "user_id": 3589567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CKIds.png?s=128&g=1", "display_name": "Alejandro Blasco", "link": "https://stackoverflow.com/users/3589567/alejandro-blasco"}, "is_accepted": false, "score": -1, "last_activity_date": 1531818293, "creation_date": 1531818293, "answer_id": 51377308, "question_id": 51376721, "link": "https://stackoverflow.com/questions/51376721/struct-padding-in-32-bit-system/51377308#51377308", "title": "Struct Padding in 32 Bit System", "body": "<p>Padding is on by default. It inserts \"gaps\" into your structure automatically. It comes out as though there were a fourth intervening variable, like this:</p>\n\n<pre><code>struct abc\n{\n    uint16_t  port_no;    // 2 Bytes\n    char pad_0[2];        // 2 Bytes\n    uint8_t   src_mac[6]; // 6 Bytes\n    char pad_1[2];        // 2 Bytes\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1531818924, "post_id": 51377382, "comment_id": 89726566, "body": "On ideone it is the same :-) <a href=\"https://ideone.com/Ywr2XP\" rel=\"nofollow noreferrer\">ideone.com/Ywr2XP</a> Linux 64 bits+gcc"}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531835033, "post_id": 51377382, "comment_id": 89737792, "body": "The struct has size 8 (on most systems) so no padding outside the struct either."}], "tags": [], "owner": {"reputation": 212, "user_id": 9418834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970882a6adb3bf98785773db9f554a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Paul", "link": "https://stackoverflow.com/users/9418834/n-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1531818829, "last_edit_date": 1531818829, "creation_date": 1531818519, "answer_id": 51377382, "question_id": 51376721, "link": "https://stackoverflow.com/questions/51376721/struct-padding-in-32-bit-system/51377382#51377382", "title": "Struct Padding in 32 Bit System", "body": "<p>That depends on the architecture of the system.</p>\n\n<p>On a 32-bit MIPS your structure would have no \npadding whatsoever because <code>uint16_t</code> must be aligned \neven addresses and <code>uint8_t</code> need not be aligned at all.</p>\n\n<p>However a variable of type <code>struct abc</code> would be aligned at \neven addresses thereby eventually forcing padding outside the \nstruct (say, when <code>struct abc</code> is a member of a surrounding struct).</p>\n"}, {"tags": [], "owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "is_accepted": false, "score": 0, "last_activity_date": 1531832237, "creation_date": 1531832237, "answer_id": 51381980, "question_id": 51376721, "link": "https://stackoverflow.com/questions/51376721/struct-padding-in-32-bit-system/51381980#51381980", "title": "Struct Padding in 32 Bit System", "body": "<p>In C/C++ every type has a size and an alignment that can differ from architecture to architecture, kernel or even just C/C++ ABI. </p>\n\n<p>Gcc provides a function <code>__alignof__</code> and C++11 has an <code>alignof(type-id)</code> function oficially that can be used to print the alignment requirement for a type. Plain C doesn't seem to have that but each type still has that property.</p>\n\n<p>In memory every type has to be aligned to at least the alignment requirement and the compiler will insert padding into structs that ensure that is the case. The struct as a whole then has the largest alignment required for any of its members and a size that includes padding to a multiple of the alignment of the struct.</p>\n\n<p>Generally an uint16_t has a 2 byte aligment requirement and chars a 1 byte alignment requirement. So th struct has a 2 byte alignment requirement and no padding is needed at all. Giving a total size of 8 byte for the struct.</p>\n\n<p>But beware that the calling conventions for an architecture can require more alignment or padding for one reason or another.</p>\n"}], "owner": {"reputation": 199, "user_id": 7276869, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/0fae8650ad0ef7bf4dac718e0c2521e9?s=128&d=identicon&r=PG&f=1", "display_name": "Urvika G", "link": "https://stackoverflow.com/users/7276869/urvika-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 550, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1531832237, "creation_date": 1531816506, "last_edit_date": 1531817056, "question_id": 51376721, "link": "https://stackoverflow.com/questions/51376721/struct-padding-in-32-bit-system", "title": "Struct Padding in 32 Bit System", "body": "<p>If there is a <code>C</code> structure like</p>\n\n<pre><code>struct abc\n{\nuint16_t                    port_no; //2 Bytes\nuint8_t                     src_mac[6]; //6 Bytes\n}\n</code></pre>\n\n<p>How would the compiler apply padding to align into 4 byte word on 32 bit sys:</p>\n\n<p>Will it be </p>\n\n<pre><code>2 Bytes\nPad[2]\n6 Bytes\nPad[2]\n</code></pre>\n\n<p>or </p>\n\n<pre><code>2 Byte\n6 Byte\n</code></pre>\n"}, {"tags": ["c", "libpcap"], "comments": [{"owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "edited": false, "score": 0, "creation_date": 1531819062, "post_id": 51376598, "comment_id": 89726665, "body": "Can we reproduce the problem? What are the parameters to <code>packetProc</code> function, so I can get the same results as you do? I guess <code>u_char</code> is <code>unsigned char</code>? Are you sure you have no padding in your structs? Can you post sizeofs of <code>struct iphdr</code>, <code>struct ethhdr</code>, <code>struct udphdr</code>, .... ? Why do you have <code>struct question</code> with <code>char * name</code> pointer, are you sure in the packed there&#39;s a <code>char *</code> pointer to some location?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1531821057, "post_id": 51376598, "comment_id": 89728106, "body": "Another point: You cannot assume, that the IP header has a fixed size, there could be IP options enlarging the header. The correct way to determine the size is <code>IP_header-&gt;ihl * 4</code>, not <code>sizeof(struct iphdr)</code>. You have to check, of course, that you do not overrun any packet boundaries, since the field is filled by the remote peer."}], "answers": [{"tags": [], "owner": {"reputation": 66560, "user_id": 9072753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EPmGy.jpg?s=128&g=1", "display_name": "KamilCuk", "link": "https://stackoverflow.com/users/9072753/kamilcuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1531819879, "creation_date": 1531819879, "answer_id": 51377875, "question_id": 51376598, "link": "https://stackoverflow.com/questions/51376598/c-libpcap-api-extracting-dns-query/51377875#51377875", "title": "C libpcap API extracting DNS query", "body": "<pre><code>struct question{\n    char * name;\n    uint16_t type;\n    uint16_t cls;\n};\n</code></pre>\n\n<p>the way you use this struct is invalid. <code>char *</code> is a pointer to memory location containing characters. DNS query does not have a pointer value to your computer memory location containing characters, the query <strong>contains</strong> those characters. However the length of the DNS query name (ie. <code>char name[how much should be put here]</code>) is calculated from the length of the udp message. You can:</p>\n\n<pre><code>struct question_after_name_s { \n        uint16_t type;\n        uint16_t cls;\n};\n\n...\nconst size_t namepos = 2*6; // name position in bytes form the beginning of the DNS query, this should be equal to 'sizeof(struct ethhdr) + sizeof(struct iphdr)   +  sizeof(struct udphdr) + sizeof(struct dnshdr)-1 ' from your code\nchar *name = (char*)&amp;packet[namepos]; // the pointer name should point to the location in packet after namepos bytes\nconst size_t packetlen = header-&gt;len; // I guess this is received DNS query length obtained from libcap\nconst size_t querytypeandclasslen = 2*2; // length of the query type and query class, should be equal to sizeof(struct question_after_name_s)\nconst size_t namelen = packetlen - namepos - querytypeandclasslen;\nprintf(\"DNS query name = '%.*s'\\n\", namelen, name);\nstruct question_after_name_s *ptr = (void*)&amp;packet[namepos + namelen];\n//or\nstruct question_after_name_s *ptr = (void*)&amp;packet[];\n</code></pre>\n\n<p>Of course such casting is correct only, if your compiler does not insert any padding between members of the structure (hope you use gcc compiler with <code>attribute((packed))</code> on those structs) and you call <code>ntohl</code> family functions or <code>be16toh</code> family functions to convert between the packet endianess and your host endianess.</p>\n"}], "owner": {"reputation": 69, "user_id": 10092274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/604afb6082e9cb70cc4b99a9d827b9de?s=128&d=identicon&r=PG&f=1", "display_name": "camixetew", "link": "https://stackoverflow.com/users/10092274/camixetew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1531819879, "creation_date": 1531816065, "question_id": 51376598, "link": "https://stackoverflow.com/questions/51376598/c-libpcap-api-extracting-dns-query", "title": "C libpcap API extracting DNS query", "body": "<p>I am trying to extract a DNS query from an captured DNS packet with libpcap api, however there must be a problem with my structures, after the last cast (using struct question) the <code>char* name</code>  pointer is pointing  at <strong>correct adress</strong>, the start of the query name, however it contains only </p>\n\n<pre><code>42 45 20 00\n</code></pre>\n\n<p>but it should</p>\n\n<pre><code>20 45 48 45 50 45 50 45 48 45 4d 45 46 43 4f 45 44 45 50 45 4e 43 41 43 41 43\n41 43 41 43 41 41 41 00 00 20 00 01\n</code></pre>\n\n<p>The code is here  </p>\n\n<pre><code>struct dnshdr{\n    uint16_t id;\n    uint16_t flags;\n    uint16_t ques;\n    uint16_t anRR;\n    uint16_t auRR;\n    uint16_t addRR;\n};\n\nstruct question{\n    char * name;\n    uint16_t type;\n    uint16_t cls;\n};\n\n\n\nvoid packetProc(u_char *args, const struct pcap_pkthdr *header,const u_char *packet){\n   struct iphdr *IP_header;\n   struct udphdr *UDP_header;\n   struct dnshdr *DNS_header;\n   struct question *ques;\n\n   IP_header =  (struct iphdr*)    (packet + sizeof(struct ethhdr));\n   UDP_header = (struct udphdr*)   (packet + sizeof(struct iphdr)  + sizeof(struct ethhdr));\n   DNS_header = (struct dnshdr*)   (packet + sizeof(struct iphdr)  + sizeof(struct ethhdr)  +  sizeof(struct udphdr) );\n   ques =       (struct question*) (packet + sizeof(struct ethhdr) + sizeof(struct iphdr)   +  sizeof(struct udphdr) + sizeof(struct dnshdr)-1 ); //fatal       \n}\n</code></pre>\n\n<p>I am honestly puzzled what to do here</p>\n"}, {"tags": ["c", "performance-testing", "benchmarking"], "comments": [{"owner": {"reputation": 711, "user_id": 4802475, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZETd6.png?s=128&g=1", "display_name": "Paradowski", "link": "https://stackoverflow.com/users/4802475/paradowski"}, "edited": false, "score": 1, "creation_date": 1531815480, "post_id": 51376418, "comment_id": 89724374, "body": "If you are seeking memory leaks, you can use Valgrind: <a href=\"https://stackoverflow.com/questions/5134891/how-do-i-use-valgrind-to-find-memory-leaks\" title=\"how do i use valgrind to find memory leaks\">stackoverflow.com/questions/5134891/&hellip;</a>"}, {"owner": {"reputation": 1632, "user_id": 2429333, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5eb897104dc190de7ea7da0ac29a59ae?s=128&d=identicon&r=PG", "display_name": "pbn", "link": "https://stackoverflow.com/users/2429333/pbn"}, "edited": false, "score": 2, "creation_date": 1531815488, "post_id": 51376418, "comment_id": 89724379, "body": "Check out valgrind massif tool."}, {"owner": {"reputation": 284, "user_id": 10052249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a1QwN.jpg?s=128&g=1", "display_name": "Daniel B", "link": "https://stackoverflow.com/users/10052249/daniel-b"}, "edited": false, "score": 0, "creation_date": 1531824545, "post_id": 51376418, "comment_id": 89730398, "body": "Not memory leaks, rather classifying 3 different implementations of the same functionality based on time/memory. For times it&#39;s easy I just print out differences from the <code>get_cpu_time()</code> return before/after."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531829529, "post_id": 51376418, "comment_id": 89733769, "body": "calling <code>get_cpu_time</code> could be significant overhead in small functions, and maybe block some optimizations when inlining the function.  <code>perf record</code> can be useful, especially if you use it for top-down profiling (where parent functions get the actual costs of their children, like you get from instrumenting with <code>get_cpu_time</code> but without any source changes)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531830125, "post_id": 51376418, "comment_id": 89734209, "body": "@TobySpeight: I thought this question was potentially interesting so I edited it.  Does rephrasing it to not directly ask for a tool or library recommendation help?  The question is still basically written so a tool recommendation fits naturally as an answer, because some kind of profiler like valgrind or cachegrind is probably needed to do anything more than just find the total memory footprint on entry/exit.  (But you <i>can</i> do that with some OS-dependent system calls.)"}, {"owner": {"reputation": 284, "user_id": 10052249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a1QwN.jpg?s=128&g=1", "display_name": "Daniel B", "link": "https://stackoverflow.com/users/10052249/daniel-b"}, "edited": false, "score": 0, "creation_date": 1531850267, "post_id": 51376418, "comment_id": 89747153, "body": "Thanks for the top-notch rewording. How can I un-hold the question?"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1531854598, "post_id": 51376418, "comment_id": 89749224, "body": "this isnt a stackoverflow question really, although it looks really close to being re-opened.  you do seem to assume that the things you are trying to measure are, thinking of the words, more static?  simply changing a line of code, sometimes just changing a constant in the function can change the size and/or performance of the whole program.  benchmarking is for the most part bogus, for many reasons, but just the amount of code required to measure the things you want to measure will affect either the size or performance of your function."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 0, "creation_date": 1531854713, "post_id": 51376418, "comment_id": 89749269, "body": "change a few lines of code in another function, related or not and at least your performance measurements go out the window.   your heap usage may be affected by the system and what was available at the time, or not.  stack usage...is affected by the functions you call from that function, so certainly changing other functions affects the measurements you took on this function.  really trying to see what the value of all this is."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 2, "creation_date": 1531854874, "post_id": 51376418, "comment_id": 89749343, "body": "valgrind or that kind of approach is a relatively easy way to see stack usage, but you have to use the tool right and make sure you measuring what you think you are measuring (and not measuring other functions usage instead, like the test code that wraps the function under test)."}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1531855138, "post_id": 51376418, "comment_id": 89749473, "body": "Obviously none of this is a C language thing, each of these questions are heavily dependent on the system and libraries.  Cache usage if measurable at all starts with what the chip can provide and how would  you possibly design for that and why would you design for that?  thats the kind of thing you would do in a chip sim not in silicon, where you can add whatever monitors you want and can have a chance at connecting the dots between the function under test and the operating system and other code running in the system."}], "owner": {"reputation": 284, "user_id": 10052249, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a1QwN.jpg?s=128&g=1", "display_name": "Daniel B", "link": "https://stackoverflow.com/users/10052249/daniel-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 363, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531855432, "creation_date": 1531815366, "last_edit_date": 1531830197, "question_id": 51376418, "link": "https://stackoverflow.com/questions/51376418/memory-usage-per-function-in-c", "title": "Memory usage per-function in C?", "body": "<p>How can I measure the memory usage of individual C functions?</p>\n\n<p>Especially peak dynamic and/or stack allocation during the function, not just a heap allocation delta from entry to exit.  Memory usage isn't like CPU usage where <code>get_cpu_time</code> at the start/end of a function does tell you something useful for large functions.</p>\n\n<p>Over multiple calls to a function, max and median or mean would be interesting, especially if we can see how it scales with a function arg.</p>\n\n<p>Total cache footprint touched during execution would also be interesting.</p>\n"}, {"tags": ["c", "memory-leaks", "jansson"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 1, "creation_date": 1531817716, "post_id": 51376136, "comment_id": 89725762, "body": "You should look for reference counting in the jansson documentation. <code>json_decref</code> is your friend."}, {"owner": {"reputation": 323, "user_id": 9375884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "H.Tibat", "link": "https://stackoverflow.com/users/9375884/h-tibat"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531819668, "post_id": 51376136, "comment_id": 89727084, "body": "Your right. Also I had used <code>json_array_append_new</code> to add a string to an array. Dose <code>json_array_append_new</code> decrease reference of it value?"}, {"owner": {"reputation": 323, "user_id": 9375884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "H.Tibat", "link": "https://stackoverflow.com/users/9375884/h-tibat"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531819869, "post_id": 51376136, "comment_id": 89727222, "body": "Its look <code>json_array_append_new</code> doesn&#39;t decrease the reference count, and do <code>reference stealing</code>."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531822870, "post_id": 51376136, "comment_id": 89729352, "body": "Yes, it &quot;steals&quot; the reference. But otherwise it would <b>in</b>crease the reference."}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531823211, "post_id": 51376136, "comment_id": 89729568, "body": "If you don&#39;t want the reference stealing, use the version without suffix <code>_new</code>."}, {"owner": {"reputation": 323, "user_id": 9375884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "H.Tibat", "link": "https://stackoverflow.com/users/9375884/h-tibat"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1532156816, "post_id": 51376136, "comment_id": 89876965, "body": "&quot;However, some functions steal the reference, i.e. they have the same result as if the user called json_decref() on the argument right after calling the function.&quot; <a href=\"https://jansson.readthedocs.io/en/2.10/apiref.html#reference-count\" rel=\"nofollow noreferrer\">jansson.readthedocs.io/en/2.10/apiref.html#reference-count</a>"}], "owner": {"reputation": 323, "user_id": 9375884, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "H.Tibat", "link": "https://stackoverflow.com/users/9375884/h-tibat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531814390, "creation_date": 1531814390, "question_id": 51376136, "link": "https://stackoverflow.com/questions/51376136/when-json-string-allocated-memory-is-freed", "title": "When json_string() allocated memory is freed?", "body": "<p>This is a stack trace of calling json_string() :</p>\n\n<ol>\n<li><p>json_string(const char *value)</p></li>\n<li><p>json_stringn(value, strlen(value))</p></li>\n<li><p>json_stringn_nocheck(value, len)</p></li>\n<li><p>string_create(value, len, 0)</p></li>\n</ol>\n\n<p><code>string_create</code> then call json_strndup(value,len) to duplicate value of string.</p>\n\n<p><strong>The problem is there that I couldn't find out when this allocated memory for <code>value</code> is freed.</strong></p>\n"}, {"tags": ["python", "c", "compiler-errors", "cython"], "comments": [{"owner": {"reputation": 508, "user_id": 7683374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2014b72f925e6a1171ad42b59ae487a1?s=128&d=identicon&r=PG", "display_name": "RottenCandy", "link": "https://stackoverflow.com/users/7683374/rottencandy"}, "edited": false, "score": 0, "creation_date": 1531814638, "post_id": 51375798, "comment_id": 89723885, "body": "What you could possibly do is download the package with <code>pip download package_name</code> and then modify the <code>setup.py</code> file to use <code>clang</code> before installing it locally."}, {"owner": {"reputation": 31, "user_id": 4766819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10152602496176572/picture?type=large", "display_name": "Ananth Ravi Kumar", "link": "https://stackoverflow.com/users/4766819/ananth-ravi-kumar"}, "reply_to_user": {"reputation": 508, "user_id": 7683374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2014b72f925e6a1171ad42b59ae487a1?s=128&d=identicon&r=PG", "display_name": "RottenCandy", "link": "https://stackoverflow.com/users/7683374/rottencandy"}, "edited": false, "score": 0, "creation_date": 1531815450, "post_id": 51375798, "comment_id": 89724352, "body": "How would I go about modifying <code>setup.py</code> to use <code>clang</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "edited": false, "score": 0, "creation_date": 1531856131, "post_id": 51381377, "comment_id": 89749970, "body": "yes! although Anaconda still uses MSVC on windows, not GCC (<a href=\"https://conda.io/docs/user-guide/tutorials/build-windows.html#microsoft-visual-studio\" rel=\"nofollow noreferrer\">conda.io/docs/user-guide/tutorials/&hellip;</a>)"}, {"owner": {"reputation": 31, "user_id": 4766819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10152602496176572/picture?type=large", "display_name": "Ananth Ravi Kumar", "link": "https://stackoverflow.com/users/4766819/ananth-ravi-kumar"}, "edited": false, "score": 0, "creation_date": 1531900000, "post_id": 51381377, "comment_id": 89763763, "body": "Thanks very much for pointing that out. The issue here is that the module I&#39;m trying to build require a C99-compliant compiler; running the build with MSVC (which to my understanding is not C99-compliant) results in error regarding variable length arrays and others, which is why I wanted to use <code>clang</code>. Any suggestions on how about to go about building it then?  Additionally, running <code>python setup.py build_ext -c clang</code> returns an error <code>error: don&#39;t know how to compile C&#47;C++ code on platform &#39;nt&#39; with &#39;clang&#39; compiler</code>. Any idea what the issue is?"}, {"owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "edited": false, "score": 0, "creation_date": 1531911007, "post_id": 51381377, "comment_id": 89770867, "body": "<code>python setup.py build_ext --help-compiler</code> to see what compilers setuptools is able to choose from. It may be it just does not have clang support, tho it may be possible to use <code>CC=clang</code> variable and <code>-c unix</code>. For C99 support, later versions of MSVC do support it, but VS 9 (2008) does not which is required for Python 2.7. If you need support for that and C99 at the same time, windows is not an option."}, {"owner": {"reputation": 38434, "user_id": 3657742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/027d13e2b9077479fa7857166c272c16?s=128&d=identicon&r=PG&f=1", "display_name": "chrisb", "link": "https://stackoverflow.com/users/3657742/chrisb"}, "edited": false, "score": 0, "creation_date": 1531924326, "post_id": 51381377, "comment_id": 89780203, "body": "Right - also depending on exactly which part of C99 noncompliance is an issue, there are plenty of hacks/workarounds floating around the internet - e.g. a <code>&lt;stdint.h&gt;</code> replacement that&#39;s often useful - <a href=\"https://github.com/pandas-dev/pandas/blob/3cb64bd2953fd264a3d0762806e800f58800641d/pandas/_libs/src/headers/ms_stdint.h\" rel=\"nofollow noreferrer\">github.com/pandas-dev/pandas/blob/&hellip;</a>"}, {"owner": {"reputation": 31, "user_id": 4766819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10152602496176572/picture?type=large", "display_name": "Ananth Ravi Kumar", "link": "https://stackoverflow.com/users/4766819/ananth-ravi-kumar"}, "edited": false, "score": 0, "creation_date": 1532280307, "post_id": 51381377, "comment_id": 89903632, "body": "Sorry for raising this thread back from the dead. The errors I&#39;m getting are <code>error C2057: expected constant expression</code>, <code>cannot allocate an array of constant size 0</code> and <code>unknown size</code> when attempting to compile with <code>MSVC</code> that ships with VS2017. Is this still an issue with C99 compilance, or am I moving in the wrong direction here?"}, {"owner": {"reputation": 31, "user_id": 4766819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10152602496176572/picture?type=large", "display_name": "Ananth Ravi Kumar", "link": "https://stackoverflow.com/users/4766819/ananth-ravi-kumar"}, "edited": false, "score": 0, "creation_date": 1532280406, "post_id": 51381377, "comment_id": 89903660, "body": "@danny additionally, I tried <code>set CC=clang</code> and compiling with the <code>--compiler=unix</code> flag, to no avail; I get an even weirder error:  <code>File &quot;C:\\Users\\anant_000\\Anaconda3\\lib\\distutils\\sysconfig.py&quot;, line 211, in customize_compiler     archiver = ar + &#39; &#39; + ar_flags TypeError: unsupported operand type(s) for +: &#39;NoneType&#39; and &#39;str&#39;</code>"}], "tags": [], "owner": {"reputation": 4536, "user_id": 4165324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8d50177f8e05b2c515b26455ba250ce?s=128&d=identicon&r=PG&f=1", "display_name": "danny", "link": "https://stackoverflow.com/users/4165324/danny"}, "is_accepted": false, "score": 2, "last_activity_date": 1531911065, "last_edit_date": 1531911065, "creation_date": 1531830414, "answer_id": 51381377, "question_id": 51375798, "link": "https://stackoverflow.com/questions/51375798/setting-clang-as-default-compiler-used-in-pip-install-on-windows/51381377#51381377", "title": "Setting Clang as default compiler used in pip install on Windows", "body": "<p>Do not do it. </p>\n\n<p>It <em>can</em> be done on the command line by setting compiler:</p>\n\n<p><code>python setup.py build_ext -c &lt;compiler&gt;</code></p>\n\n<p><code>python setup.py build_ext --help-compiler</code> to see available options.</p>\n\n<p><strong>However</strong>, the same compiler used to build the python distribution <strong>must</strong> be used for all extensions as the extension modules will be loaded by the interpreter.</p>\n\n<p>If they are built by a different compiler, <strong>they cannot be safely loaded</strong> by the python interpreter.</p>\n\n<p>In the case of Anaconda, its python distribution is built with MSVC, so the same compiler used by the anaconda environment should be used for extensions. In that case, activating the anaconda environment should suffice, though compiler can be set explicitly as above.</p>\n\n<p>See <a href=\"https://wiki.python.org/moin/WindowsCompilers\" rel=\"nofollow noreferrer\">Windows Compilers python wiki entry</a>.</p>\n"}], "owner": {"reputation": 31, "user_id": 4766819, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10152602496176572/picture?type=large", "display_name": "Ananth Ravi Kumar", "link": "https://stackoverflow.com/users/4766819/ananth-ravi-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1587, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1531911065, "creation_date": 1531813185, "question_id": 51375798, "link": "https://stackoverflow.com/questions/51375798/setting-clang-as-default-compiler-used-in-pip-install-on-windows", "title": "Setting Clang as default compiler used in pip install on Windows", "body": "<p>Visual Studio 2017 now ships with <code>clang</code>, and I was wondering if it is possible to set <code>clang</code> to be the default compiler used when trying to install a python package with <code>Cython</code> dependencies via <code>pip install</code>.</p>\n\n<p>As far as I can tell the issue seems to be that <code>pip</code> doesn't know where to look for <code>clang</code>; it defaults to the path containing the <code>MSVC</code> compiler to compile the <code>.c</code> files specified in the package <code>setup.py</code>. Is there any way I can either 1) set the path to the compiler to be used, or 2) specify that <code>clang</code> should be used explicitly?</p>\n\n<p>I'm working on Windows 10, using the Anaconda distribution and Python 3.6. Any help would be much appreciated! </p>\n"}, {"tags": ["c", "arduino-uno"], "comments": [{"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531813520, "post_id": 51375726, "comment_id": 89723199, "body": "Please show us your current effort and tell us, where <b>exactly</b> you have a problem. Hint: The echo starts with &quot;at&quot; or &quot;AT&quot; while the actual output is a line starting with &quot;+&quot;"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531813656, "post_id": 51375726, "comment_id": 89723289, "body": "You might avoid the echo with a &quot;ATE0&quot; command on that AT channel."}, {"owner": {"reputation": 53, "user_id": 7478839, "user_type": "registered", "profile_image": "https://graph.facebook.com/606718959479194/picture?type=large", "display_name": "KE Keronei", "link": "https://stackoverflow.com/users/7478839/ke-keronei"}, "reply_to_user": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1531814872, "post_id": 51375726, "comment_id": 89724024, "body": "@Gerhardh, if i can shut the echo the its better, let me add the actual code in a moment."}], "owner": {"reputation": 53, "user_id": 7478839, "user_type": "registered", "profile_image": "https://graph.facebook.com/606718959479194/picture?type=large", "display_name": "KE Keronei", "link": "https://stackoverflow.com/users/7478839/ke-keronei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1531812984, "creation_date": 1531812984, "question_id": 51375726, "link": "https://stackoverflow.com/questions/51375726/filter-atcsq-response", "title": "Filter AT+CSQ response", "body": "<p>I am working on a project and am using Arduino UNO and some other components. I need some communication and have employed a Huawei MU509 module. I haven't employed GSM library for varied reasons, I need to check the signal strength at an interval of 5sec, I use  <code>AT+CSQ</code> and i get something like the following response which is ok.</p>\n\n<p><code>AT+CSQ</code></p>\n\n<p><code>+CSQ: 9,99</code></p>\n\n<p><code>OK</code></p>\n\n<p>The challenge comes in when i want to display this info in a more readable format, probably a percentage will work.\nI have a function that takes the input of the format <code>+CSQ: 9,99</code> and returns 9 which i can handle very nicely, however my module responds in this format</p>\n\n<p>-echos the command</p>\n\n<p>-followed by response</p>\n\n<p>-OK</p>\n\n<p>meaning my function wont figure out the actual input.\nI'm requesting a workaround to filter this output and get the response that would fit my function, or rather a solution that would simply provide me with the signal strength in a format that i can convert to percentage and display to the user. </p>\n"}, {"tags": ["c", "linux", "modbus"], "comments": [{"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 0, "creation_date": 1531828224, "post_id": 51374105, "comment_id": 89732886, "body": "You will have to scan, but even then there is nothing guaranteed to be supported by all devices.   Loop through all addresses (1-247) and issue something like a (1) Read Input Register 0 or (2) Read Device Identification.   If you know the &quot;set&quot; of devices on the bus it will make it easier to pick a known supported function."}, {"owner": {"reputation": 196, "user_id": 9832392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rc42MEOwdL0/AAAAAAAAAAI/AAAAAAAAAOQ/c4XMpY2_sMM/photo.jpg?sz=128", "display_name": "Umair", "link": "https://stackoverflow.com/users/9832392/umair"}, "reply_to_user": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 0, "creation_date": 1531829846, "post_id": 51374105, "comment_id": 89733989, "body": "@Marker, I am doing the same way, but there is a problem. if there is no device at a particular address then I have wait until <b>timeout</b>. I am looking for a way to avoid this waiting for the timeout. So far it really seems unavoidable!!!!"}, {"owner": {"reputation": 937, "user_id": 9242445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2IaxD.jpg?s=128&g=1", "display_name": "Marker", "link": "https://stackoverflow.com/users/9242445/marker"}, "edited": false, "score": 0, "creation_date": 1531917691, "post_id": 51374105, "comment_id": 89775293, "body": "Yes, I don&#39;t think there is any other way other than waiting for the timeout."}], "answers": [{"tags": [], "owner": {"reputation": 183, "user_id": 8495629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QN4Mh.jpg?s=128&g=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/8495629/ken"}, "is_accepted": true, "score": 1, "last_activity_date": 1531923806, "creation_date": 1531923806, "answer_id": 51404508, "question_id": 51374105, "link": "https://stackoverflow.com/questions/51374105/get-all-modbus-connected-devices-with-unknown-addresses/51404508#51404508", "title": "Get all Modbus connected devices with unknown addresses", "body": "<p>Modbus avoids collisions by only letting the slaves talk if they've first been addressed by the master. That means that there's no way to broadcast a message or passively listen like you would with Ethernet. You can poll each address like you and @Marker said. Just pay attention to the error code and set the timeout to 1 or 2 sec.</p>\n\n<p>The best bet would be to trace out the serial link and see what all devices are on the network. You'd know how many slaves to expect when polling, and you'd the manufacturer and model info. With that info you can get the manual and know what each register is for. If the device has a keypad style interface, you might could also find out the slave address.</p>\n"}], "owner": {"reputation": 196, "user_id": 9832392, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Rc42MEOwdL0/AAAAAAAAAAI/AAAAAAAAAOQ/c4XMpY2_sMM/photo.jpg?sz=128", "display_name": "Umair", "link": "https://stackoverflow.com/users/9832392/umair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 51404508, "answer_count": 1, "score": 1, "last_activity_date": 1531923806, "creation_date": 1531806748, "last_edit_date": 1531894801, "question_id": 51374105, "link": "https://stackoverflow.com/questions/51374105/get-all-modbus-connected-devices-with-unknown-addresses", "title": "Get all Modbus connected devices with unknown addresses", "body": "<p>I have a Linux machine, On Modbus RTU(over rs485) multiple devices are connected to this Linux machine. I do not know the addresses of connected devices. I want to get a list of connected devices. Is there any way to get all connected devices?</p>\n\n<p>I am using libmodbus.</p>\n\n<p>here is code to read to one device with a known address.</p>\n\n<pre><code>  modbus_t *modbusCtxPtr=NULL;\n  int modbus_id=9; // Modbus address \n\n  modbusCtxPtr = modbus_new_rtu(TTYDEVICE, BAUDRATE, 'N', 8, STOPBITS);\n  if (modbusCtxPtr == NULL) \n  {\n     errorAndLogLogger(TTY_ERROR, \"ERROR - Unable to create the libmodbus context.\");\n     return;\n  }\n  if (modbus_set_slave(modbusCtxPtr, modbus_id) == -1)\n        errorAndLogLogger(TTY_ERROR, \"ERROR - Error in setting slave id.\");\n  if (modbus_connect(modbusCtxPtr) == -1)\n        errorAndLogLogger(TTY_ERROR, \"ERROR - Modbus Connection failed.\");\n\n  /* Here, I called read register over Modbus, function. */\n</code></pre>\n"}, {"tags": ["c", "pointers", "bitwise-operators"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 4, "creation_date": 1531806845, "post_id": 51374085, "comment_id": 89719625, "body": "There are no bitwise operators here. The <code>&amp;</code> symbol is the address-of operator."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 3, "creation_date": 1531806914, "post_id": 51374085, "comment_id": 89719652, "body": "This code is actually Undefined Behaviour, but the intent probably was to select the least significant 32 bits of a 64-bit integer"}, {"owner": {"reputation": 33488, "user_id": 6110094, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wozpD.png?s=128&g=1", "display_name": "0___________", "link": "https://stackoverflow.com/users/6110094/0"}, "edited": false, "score": 0, "creation_date": 1531820164, "post_id": 51374085, "comment_id": 89727416, "body": "It is not bitwise operator as it does not operate on the bits level - and <code>&amp;</code> has a complete different meaning here;"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531807547, "post_id": 51374134, "comment_id": 89719894, "body": "could you tell me the python equivalent?"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531807633, "post_id": 51374134, "comment_id": 89719922, "body": "Well, no, because Python does not have pointers, for one thing. We&#39;d need a bit of a wider context (for instance, exactly what <code>x</code> is - a struct, an int32, an int64, a float...? All of those would be dealt with differently in Python.)"}, {"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531807712, "post_id": 51374134, "comment_id": 89719961, "body": "in this context it is an int64"}, {"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531807731, "post_id": 51374134, "comment_id": 89719966, "body": "lol to make it worse it&#39;s unsigned, I&#39;m dealing with some kind of encryption code"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 2, "creation_date": 1531807846, "post_id": 51374134, "comment_id": 89720012, "body": "Then probably <code>x &amp; (2 ** 32 - 1)</code>, if on little-endian processor. (EDIT: @ajxs&#39; <code>0xFFFFFFFF</code> is equivalent to this.)"}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "edited": false, "score": 0, "creation_date": 1531808017, "post_id": 51374134, "comment_id": 89720095, "body": "It won&#39;t really matter to you whether it&#39;s signed or unsigned, this code just operates on the bit level, the context of said bits is up to the application."}], "tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 3, "last_activity_date": 1531806906, "creation_date": 1531806906, "answer_id": 51374134, "question_id": 51374085, "link": "https://stackoverflow.com/questions/51374085/what-does-this-line-of-code-mean-bitwise-operator/51374134#51374134", "title": "What does this line of code mean (Bitwise Operator)", "body": "<pre><code>&amp;(x)                  // get address of `x` as a pointer to whatever x is\n(unsigned int*)(...)  // cast it to a pointer to `unsigned int`\n*(...)                // then read that address' contents as if it was `unsigned int`\n</code></pre>\n\n<p>I'd use <code>union</code> if really needed, and only if I knew the CPU architecture, otherwise this is very very unsafe :P</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 2, "creation_date": 1531807818, "post_id": 51374145, "comment_id": 89719996, "body": "There is so this code is basically splitting the 64 bit int it&#39;s dealing with into the first half of the 64 bits and the second half if the 64 bits"}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "reply_to_user": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531807922, "post_id": 51374145, "comment_id": 89720047, "body": "That&#39;s correct. More specifically, this is getting the &#39;lower&#39; 32 bits. I&#39;ve updated the answer to give a simple implementation in Python."}, {"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531808050, "post_id": 51374145, "comment_id": 89720105, "body": "the hiword one uses x+1 do I just use that in place of x here."}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "reply_to_user": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 1, "creation_date": 1531808218, "post_id": 51374145, "comment_id": 89720187, "body": "Try this:     <code>def HIWORD(x):          return (x &amp; 0xFFFFFFFF00000000) &gt;&gt; 32</code>"}, {"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531808557, "post_id": 51374145, "comment_id": 89720342, "body": "one more question for you. This code uses an unsigned long long int. Is that necessary in python. Or do their ints automatically adjust."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1531812418, "post_id": 51374145, "comment_id": 89722523, "body": "<i>it&#39;s a fairly common idiom</i>  Ugh. Anyone writing that doesn&#39;t understand C.  Depending on what&#39;s passed to the macro, it&#39;s either useless, or undefined behavior and a strict aliasing violation, and if it doesn&#39;t blow up it will return the wrong results on a big-endian system."}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "edited": false, "score": 0, "creation_date": 1531812663, "post_id": 51374145, "comment_id": 89722663, "body": "I certainly didn&#39;t say it&#39;s correct, but google it and you&#39;ll see it&#39;s used all over the place!"}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1531822600, "post_id": 51374145, "comment_id": 89729175, "body": "@ajxs: There is only one integer type in Python from user&#39;s perspective, <code>int</code>, which autopromotes transparently to biginteger (i.e. size limited by available memory). (You can get int64 from C if you use <code>numpy</code> library.)"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "reply_to_user": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "edited": false, "score": 0, "creation_date": 1531834586, "post_id": 51374145, "comment_id": 89737436, "body": "@Amadan i.e. there is now <i>one</i> integer type in Python 3 which is <i>always</i> big integer consuming as much memory as is needed to exactly store its value"}, {"owner": {"reputation": 212, "user_id": 9418834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970882a6adb3bf98785773db9f554a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Paul", "link": "https://stackoverflow.com/users/9418834/n-paul"}, "edited": false, "score": 0, "creation_date": 1531838186, "post_id": 51374145, "comment_id": 89740132, "body": "This macro is /not/ getting the lower DWORD ( 32bits ) of a 64 bit variable. It merely gets the <code>unsigned int</code> at the same starting address as the specified variable. The return value heavily depends on the implementation: for example <code>int8_t foo; int32_t bar = LODWORD(foo);</code> reads beyond the memory occupied by <code>foo</code>. Also on some macines <code>int</code> has only 16 bytes."}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "reply_to_user": {"reputation": 212, "user_id": 9418834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970882a6adb3bf98785773db9f554a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Paul", "link": "https://stackoverflow.com/users/9418834/n-paul"}, "edited": false, "score": 0, "creation_date": 1531870869, "post_id": 51374145, "comment_id": 89755165, "body": "@N.Paul You&#39;re totally correct. The original asker was asking for hints as to the intent of the macro, and I think judging by the name and the code that we can discern this is what it <i>intends</i> to do. I certainly wouldn&#39;t encourage it&#39;s use, but based on the context of the question that doesn&#39;t matter."}, {"owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "reply_to_user": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531870879, "post_id": 51374145, "comment_id": 89755167, "body": "@user3851290, if this answer helped you can you please select it as the accepted answer?"}], "tags": [], "owner": {"reputation": 2476, "user_id": 5931673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/aTpXN.jpg?s=128&g=1", "display_name": "ajxs", "link": "https://stackoverflow.com/users/5931673/ajxs"}, "is_accepted": true, "score": 3, "last_activity_date": 1531807863, "last_edit_date": 1531807863, "creation_date": 1531806942, "answer_id": 51374145, "question_id": 51374085, "link": "https://stackoverflow.com/questions/51374085/what-does-this-line-of-code-mean-bitwise-operator/51374145#51374145", "title": "What does this line of code mean (Bitwise Operator)", "body": "<p>It's a macro for getting the lower <code>DWORD</code> ( 32bits ) of a 64 bit variable, there's most likely an associated <code>HIDWORD</code> macro as well to get the higher 32 bits. Other comments have pointed out some flaws with the macro, but it's a fairly common idiom for accomplishing this.</p>\n\n<p>Some equivalent Python code might be:</p>\n\n<pre><code>def LODWORD(x):\n    return x &amp; 0xFFFFFFFF\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1531809511, "post_id": 51374648, "comment_id": 89720830, "body": "If <code>foo</code> is not an <code>int</code> or <code>unsigned int</code> then the code is <i>undefined behaviour</i>"}, {"owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "edited": false, "score": 0, "creation_date": 1531809800, "post_id": 51374648, "comment_id": 89721008, "body": "it is an unsigned int"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 1, "creation_date": 1531810289, "post_id": 51374648, "comment_id": 89721294, "body": "And if <code>foo</code> is an <code>int</code> or <code>unsigned int</code>, the result is simply a cast to <code>unsigned</code> of little use, otherwise it is a <i>type-punned</i> <code>X</code> in violation of the <i>strict-aliasing rule</i>."}], "tags": [], "owner": {"reputation": 212, "user_id": 9418834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8970882a6adb3bf98785773db9f554a5?s=128&d=identicon&r=PG&f=1", "display_name": "N. Paul", "link": "https://stackoverflow.com/users/9418834/n-paul"}, "is_accepted": false, "score": 0, "last_activity_date": 1531809238, "creation_date": 1531809238, "answer_id": 51374648, "question_id": 51374085, "link": "https://stackoverflow.com/questions/51374085/what-does-this-line-of-code-mean-bitwise-operator/51374648#51374648", "title": "What does this line of code mean (Bitwise Operator)", "body": "<p>First by using <code>#define</code> defines a macro that does substitution. It is a macro with an argument, a so-called \"function-like macro\".\nAfter the <code>#define</code> when an expression <code>LODWORD(whatever you write here)</code> occurs it will be replaced by <code>(*((unsigned int*)&amp;(whatever you write here)))</code> before the code is fed into the compiler. This is called \"macro expansion\". The compiler will only see expanded expressions.</p>\n\n<p>The macro expanded expression of <code>LODWORD(foo)</code> does the following:</p>\n\n<p><code>(foo)</code> is common idiom in macros: Put arguments into parentheses to avoid operator precedence errors.</p>\n\n<p><code>&amp;(foo)</code> means \"the address of <code>(foo)</code>\" (a \"pointer\"). This creates a value that represents the memory location of <code>foo</code>. It is of type \"pointer to the type of <code>foo</code>\" .</p>\n\n<p><code>(unsigned int*)&amp;(foo)</code> converts \"the adress of <code>foo</code>\" into \"the address of the <code>unsigned int</code> <code>foo</code>\". The operator <code>(insigned int*)</code> is called a \"cast operator\". It changes the result type \"pointer to the type of <code>foo</code>\" into \"pointer to an <code>unsigned int</code>\".</p>\n\n<p><code>((unsigned int*)&amp;(foo))</code> overrides operator precedence. Now you have \"pointer to an <code>unsigned int</code> at the memory location of <code>foo</code>.</p>\n\n<p><code>*((unsigned int*)&amp;(foo))</code> returns the value of the  <code>unsigned int</code> at the memory location of <code>foo</code> (even if <code>foo</code> is not an unsigned integer and even if that memory location violates alignment requirements for an <code>unsigned int</code>). </p>\n\n<p><code>(*((unsigned int*)&amp;(foo)))</code> is yet another common idiom in macros: Put the entire expression into parentheses to avoid operator precedence errors. Then the macro can always be used as if it was a function.</p>\n"}], "owner": {"reputation": 51, "user_id": 3851290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20420bb658596d7f8c265ebc11c5f836?s=128&d=identicon&r=PG&f=1", "display_name": "user3851290", "link": "https://stackoverflow.com/users/3851290/user3851290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 51374145, "answer_count": 3, "score": 1, "last_activity_date": 1531809238, "creation_date": 1531806686, "question_id": 51374085, "link": "https://stackoverflow.com/questions/51374085/what-does-this-line-of-code-mean-bitwise-operator", "title": "What does this line of code mean (Bitwise Operator)", "body": "<pre><code>#define LODWORD(x) (*((unsigned int*)&amp;(x)))\n</code></pre>\n\n<p>I'm translating C code to python and can't quite get this. If anyone can explain how to read this or what it means it'd be greatly appreciated.</p>\n"}, {"tags": ["c", "assembly", "transpiler", "68000", "amiga"], "comments": [{"owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531806580, "post_id": 51373906, "comment_id": 89719535, "body": "The code is way too big to do it manually. No just have it automatically converted would be fine. I don&#39;t mind if it becomes crappy C. As long as it becomes portable"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531806690, "post_id": 51373906, "comment_id": 89719574, "body": "Why don&#39;t you just write an emulator?"}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1531807300, "post_id": 51373906, "comment_id": 89719794, "body": "Regarding subroutines; can&#39;t you create C functions for anything that&#39;s referenced by a <code>BSR</code>/<code>JSR</code> and translate the jumps into C function calls? For other types of branches it seems to me like <code>goto</code> would be easier to work with than switch-cases."}, {"owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "edited": false, "score": 0, "creation_date": 1531807371, "post_id": 51373906, "comment_id": 89719828, "body": "Then I need to find a binary somewhere. Find some 68000 emulator. Inherit all that code and have a huge dependency. And of course... It&#39;s less of a challenge ;^)"}, {"owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1531807542, "post_id": 51373906, "comment_id": 89719888, "body": "@michael tricky part is of course that goto&#39;s only jump in the current scope. The branches might actually jump over a function, or who knows, right into one (I hope I didn&#39;t do that back then). With my idea of having a huge switch statement I could even &#39;emulate&#39; the stackpointer(a7), and implement RTS by popping the last switch value and going through the switch statement again."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1531808072, "post_id": 51373906, "comment_id": 89720115, "body": "I&#39;d go with a 68000 emulator (google that)."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 2, "creation_date": 1531808533, "post_id": 51373906, "comment_id": 89720330, "body": "there are open source 68k core emulators, but they may be only under GPL-like license (so it depends what&#39;s your plan with the final product)... if your code was not some black magic trickery, it may be easier to emulate the core, and put SDL layer on top of that, displaying memory state from emulator... i.e. you would create amiga emulator in the end.. hmmm... Anyway, generally disassembly asm into C usually turns to crap, especially if the assembly was optimized, but you may google if there is some 68k &quot;decompiler&quot; and see what the output would look, maybe would need only &quot;weeks&quot; of work.."}, {"owner": {"reputation": 9461, "user_id": 8422330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0f90445d03447c587d1e595d531f69?s=128&d=identicon&r=PG&f=1", "display_name": "prl", "link": "https://stackoverflow.com/users/8422330/prl"}, "edited": false, "score": 0, "creation_date": 1531808959, "post_id": 51373906, "comment_id": 89720539, "body": "If you search for 68000 decompiler, you might find something that will help."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1531809070, "post_id": 51373906, "comment_id": 89720604, "body": "I&#39;m sure <i>most</i> of your jumps other than BSR/JSR are within functions so <code>goto</code> + C labels should be totally fine.  A few manual fixes total for the whole program might be required for the occasional jump into another function, but that&#39;s fine, you&#39;re already planning to spend some time porting the graphics output.  The decompiler you cobble together does <i>not</i> need to be 100% automatic, as long as problems turn into won&#39;t-compile errors in C, rather than subtle gotchas.  Labels within functions and <code>if() goto</code> will make your C look very much like asm, unlike a giant <code>switch</code>."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531809415, "post_id": 51373906, "comment_id": 89720781, "body": "Obviously the hard part of making actual separate C functions for each asm function is detecting which registers or memory locations hold args, and which are just stale.  (And call-preserved vs. clobbered).  If you used custom calling conventions on a per-function basis when it was convenient, this will be harder to decompile."}, {"owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1531810996, "post_id": 51373906, "comment_id": 89721712, "body": "@PeterCordes I&#39;d just make 20 or so global variables called a0-a7 and d0-d7, sr, etc and just do method calls without any arguments. The subroutine would then just continue with the global &#39;register&#39; variables.  It&#39;s true-er to the source."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531811619, "post_id": 51373906, "comment_id": 89722071, "body": "@Toad That&#39;s not really a reason. If you choose to do so, it&#39;s because you decide not to write the emulator from scratch."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531811736, "post_id": 51373906, "comment_id": 89722141, "body": "After all, compilers (without optimizations) are basically interpreters specialized for the particular input."}, {"owner": {"reputation": 119882, "user_id": 3545273, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RDWxl.png?s=128&g=1", "display_name": "Serge Ballesta", "link": "https://stackoverflow.com/users/3545273/serge-ballesta"}, "edited": false, "score": 2, "creation_date": 1531813316, "post_id": 51373906, "comment_id": 89723059, "body": "Your requirement is not far from writing a compiler: you have an input language (68k assembly), and you want programs written using that language to be executed on various plaforms. Assembly languages have normally a not too complex syntax, you could try to use the good old lex+yacc to parse it. After all, yacc name means Yet Another Compiler Compiler... But IMHO, it will be harder than directly using an emulator..."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 1, "creation_date": 1531819538, "post_id": 51373906, "comment_id": 89726991, "body": "I think it boils down to the using/writing emulator, because what your original proposal is, is exactly that, emulating 68k core. But then you need to emulate lot more, as that code was originally running inside Amiga computer, so you must emulate also memory and the peripherals chips like blitter/copper/disk-system/etc.. (depending what your games did use), and for any top quality Amiga game you would very soon end with complete Amiga emulator, probably even being picky about timing of the emulation... so maybe you should first check if there&#39;s something already done which can be reused?"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531831627, "post_id": 51373906, "comment_id": 89735269, "body": "Yeah global vars for registers should work, nice idea!  You can manually clean up a few important function (important for performance or readability), or ones used in the code you&#39;re modifying anyway.  Link-time / whole-program optimization by modern compilers might be able to do a decent job optimizing away useless spill/reload of the globals around every function call, and at the end of every function when compiling nasty source that assigns them.  For regs you never use for arg passing / return, you could have your decompiler use local vars."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531831858, "post_id": 51373906, "comment_id": 89735410, "body": "Hopefully you can map stack-allocated locals in your asm source to local vars with automatic storage in the C output.  You&#39;d really like <code>sp</code> to <i>not</i> be part of the C program&#39;s state, with all stack ops turned into local variable allocation, or alloca or C99 VLAs for variable-size subtractions.  But C can&#39;t directly express the pattern of pushing items on the stack one at a time, then popping them off in reverse order.  (i.e. using the call-stack as a stack data structure, which is easy in asm.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1531832023, "post_id": 51373906, "comment_id": 89735542, "body": "At worst you can model a stack frame (within each function separately) as a char array that you memcpy to/from if you have unaligned or overlapping accesses.  This assumes your asm is not totally evil and doesn&#39;t do stuff like modifying the parent stack frame directly, relative to SP without having the caller passed a pointer."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531835565, "post_id": 51373906, "comment_id": 89738188, "body": "Here is a crazy idea. Make every opcode a function that modifies global variables. and uses continuation-passing-style. That makes it possible to implement BSR/JSR and RET in C."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 0, "creation_date": 1531860304, "post_id": 51373906, "comment_id": 89751907, "body": "Seriously this comment thread shows why this stack needs to start enforcing the policy about answers in comments. No, your half-answer is not a comment. Either write it when it&#39;s done, or find a <i>discussion forum</i>."}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "edited": false, "score": 0, "creation_date": 1531866539, "post_id": 51373906, "comment_id": 89754118, "body": "How many lines of code are we talking about?"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "reply_to_user": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "edited": false, "score": 0, "creation_date": 1532103476, "post_id": 51373906, "comment_id": 89863497, "body": "@pipe Generally, such cases indicates that something is wrong with the <b>question</b>. Indeed it is. To fix that is also quite easy -- post a (CW if you want) answer."}, {"owner": {"reputation": 600, "user_id": 5725780, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FKaUq.png?s=128&g=1", "display_name": "pipe", "link": "https://stackoverflow.com/users/5725780/pipe"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1532181143, "post_id": 51373906, "comment_id": 89882932, "body": "@user202729 We already know something is wrong with the question - it&#39;s even put on hold. Still there&#39;s a lot of &quot;helpful&quot; people who just <i>can&#39;t</i> stop themselves from filling up the comment section with their opinions. Some of them with an surprisingly high reputation, showing they should have been here long enough to know the policy."}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1533675871, "post_id": 51373906, "comment_id": 90431531, "body": "I did something similar for a decompression code: <a href=\"http://jotd.pagesperso-orange.fr/misc/fimp_c.zip\" rel=\"nofollow noreferrer\">jotd.pagesperso-orange.fr/misc/fimp_c.zip</a>. Source code included (except for the awk conversion script)"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1533675929, "post_id": 51373906, "comment_id": 90431556, "body": "I did something similar (SDL) but not the same processor (6502) to make old games that I didn&#39;t even write run: <a href=\"http://jotd.pagesperso-orange.fr/oric_remakes.html\" rel=\"nofollow noreferrer\">jotd.pagesperso-orange.fr/oric_remakes.html</a>. Full source code of everything here."}, {"owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "edited": false, "score": 0, "creation_date": 1533790730, "post_id": 51373906, "comment_id": 90477363, "body": "Great! This is exactly how I envisioned it. Great that the original basic lines are in the comments so you can actually follow quite nicely even though the C is at times cryptic."}], "owner": {"reputation": 14489, "user_id": 71883, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4e3e632f1a04007b2fed7b1479aed5b6?s=128&d=identicon&r=PG", "display_name": "Toad", "link": "https://stackoverflow.com/users/71883/toad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 1, "closed_date": 1531813530, "answer_count": 0, "score": 6, "last_activity_date": 1531806634, "creation_date": 1531805799, "last_edit_date": 1531806634, "question_id": 51373906, "link": "https://stackoverflow.com/questions/51373906/how-to-convert-my-old-amiga-68000-game-to-portable-c", "closed_reason": "Needs more focus", "title": "How to convert my old amiga 68000 game to portable c", "body": "<p>A long time ago, I've made some games for the Commodore Amiga. All done in 68000 assembly (So I still have the sources)</p>\n\n<p>I want to port these games to modern platforms, and instead of hosting an emulator, I thought of converting the Assembly to C, and adding an SDL layer. </p>\n\n<p>Any thoughts on how to tackle the 68000 -> C conversion part? (Not manually but automatically. As in a transpiler)</p>\n\n<p>I was thinking of just creating a bunch of variables with similar names as the registers and then converting things like this:</p>\n\n<pre><code> MOVE.l #23, d7\n</code></pre>\n\n<p>into </p>\n\n<pre><code> MOVEL(23, d7);\n</code></pre>\n\n<p>The only thing I'm not sure how it would work is branches and subroutines.\nI think I could get it working with a very big switch statement, and having any label I could potentially jump to being a case statement.</p>\n\n<p>Any thoughts? Any prior art I could draw inspiration from?</p>\n"}, {"tags": ["c", "arrays", "pointers", "pointer-arithmetic", "errata"], "comments": [{"owner": {"reputation": 49163, "user_id": 57159, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/699a9b2caefb52530d1c872bb2932d21?s=128&d=identicon&r=PG", "display_name": "Ian Ringrose", "link": "https://stackoverflow.com/users/57159/ian-ringrose"}, "edited": false, "score": 0, "creation_date": 1531813708, "post_id": 51373516, "comment_id": 89723334, "body": "The case I could think of when it could make any difference is with the use of memory checking tools and code checking tool as they do try to take into account the intended meaning of the code."}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 15, "creation_date": 1531819130, "post_id": 51373516, "comment_id": 89726714, "body": "&quot;the generated machine code is different.&quot; is probably wrong for most contemporary compilers."}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 2, "creation_date": 1531836857, "post_id": 51373516, "comment_id": 89739154, "body": "To me the &quot;adds i to the address&quot; means that is moves i bytes. But what actually happens is that it adds i * sizeof(&amp;vector[0]) bytes. As others have pointed out the C standard declares a[i] as *(a + i) so the passage is just plain confusing."}, {"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "reply_to_user": {"reputation": 480272, "user_id": 1968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd630f72eef3790bfb4ef38d08c7f85?s=128&d=identicon&r=PG", "display_name": "Konrad Rudolph", "link": "https://stackoverflow.com/users/1968/konrad-rudolph"}, "edited": false, "score": 2, "creation_date": 1531837735, "post_id": 51373516, "comment_id": 89739815, "body": "@KonradRudolph I have lots of questions about pointers from books and published blogs that I think are errata if you want to ruin to your <i>week</i>.  <a href=\"https://stackoverflow.com/q/51227140/124486\">stackoverflow.com/q/51227140/124486</a> More in the pipeline too."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1531841051, "post_id": 51373516, "comment_id": 89742112, "body": "The compiler will generate different code if the subscript is a constant expression (such as <code>a[5]</code>) because it can compute the offset at compile time, but I don&#39;t see how <code>a[i]</code> and <code>*(a + i)</code> would be handled differently without knowing the value of <code>i</code> at translation time."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1531843426, "post_id": 51373516, "comment_id": 89743612, "body": "@JohnBode It should generate the same code if it&#39;s a constant expression in <code>*(a + 5)</code>. Comparing <code>a[5]</code> with <code>*(a + i)</code> is apples and oranges."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531845059, "post_id": 51373516, "comment_id": 89744486, "body": "@Barmar: Some compilers may sometimes benefit from e.g. replacing <code>a[i+5]</code> with <code>(a+5)[i]</code>, for a couple of reasons: (1) The compiler can recognize (a+5) as a constant, while ti would be slightly harder to split out the expression <code>i+5</code> into a constant and non-constant portion.  Looking for an indexing expression of the form (const+x) or (x+const) shouldn&#39;t be too hard, but would require a bit of extra work.  Additionally, if <code>i</code> is unsigned, then <code>a[i+5]</code> must behave predictably with values from UINT_MAX-4 to UINT_MAX, but <code>(a+5)[i]</code> need not do so."}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531848309, "post_id": 51373516, "comment_id": 89746163, "body": "@Barmar: &quot;I don&#39;t see how <code>a[i]</code> and <code>*(a + i)</code> would be handled differently <i>from each other</i> without knowing the value of <code>i</code> at translation time&quot; - better?  I wasn&#39;t comparing <code>a[5]</code> to <code>*(a + i)</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1531848686, "post_id": 51373516, "comment_id": 89746352, "body": "@JohnBode You brought up the issue of the subscript being a constant expression. That point applies equally to both syntaxes."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531863138, "post_id": 51373516, "comment_id": 89753090, "body": "Whether compilers in fact will or will not generate different code misses the point.  The book asserts that different machine code will be generated <i>because the two syntax alternatives mean different things</i>.  It is that justification that is utterly and egregiously wrong."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1531880243, "post_id": 51373516, "comment_id": 89757036, "body": "Currently this is on HNQ, and I think the title is very ambiguous. I suggest &quot;Array <b>indexing</b> syntax (<i>otherwise it may be array initialization syntax</i>) vs pointer syntax, and <b>assembly</b> (<i>otherwise it may be C</i>) code generation. /// Initially when look at the question I thought it was &quot;I&#39;m writing a C code generation. Should I use <code>int[] a={1,2,3};</code> or <code>int* a=new int[]{1,2,3};</code>?&quot; or something like that."}], "answers": [{"comments": [{"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1531804939, "post_id": 51373661, "comment_id": 89718913, "body": "As far as I can tell, the paragraph about <code>sizeof</code> is 100% correct. I haven&#39;t read page 84, but the part above the heading looks at least somewhat correct. Added together, that&#39;s still less than half the page."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1531805057, "post_id": 51373661, "comment_id": 89718948, "body": "I didn&#39;t mean there was anything wrong with your answer; I was agreeing with your larger point. Less than half the page was reasonable and the rest wasn&#39;t just misleading or overly simplified but outright wrong."}, {"owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "edited": false, "score": 3, "creation_date": 1531825816, "post_id": 51373661, "comment_id": 89731202, "body": "I wouldn&#39;t say it&#39;s <i>wrong</i>, but incomplete. The thing is, <i>some</i> compiler might really generate different machine code for <code>x[y]</code> than for <code>*(x+y)</code> (actually, ditto for <code>*(y+x)</code> and <code>y[x]</code>). IOW, if we prefix the whole quote with &quot;On some compilers...&quot;, it would actually be right."}, {"owner": {"reputation": 4173, "user_id": 4450651, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l6IMB.jpg?s=128&g=1", "display_name": "red0ct", "link": "https://stackoverflow.com/users/4450651/red0ct"}, "edited": false, "score": 3, "creation_date": 1531842990, "post_id": 51373661, "comment_id": 89743358, "body": "Also the everyday way is to use this book as a stand for a cup of hot coffee."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "edited": false, "score": 1, "creation_date": 1531843563, "post_id": 51373661, "comment_id": 89743684, "body": "@srdjan.veljkovic Almost anything is possible if you qualify it with &quot;on some compilers&quot;. It could conceivably generate different code depending on the phase of the moon. If the book had said &quot;machine code <i>might</i> be different&quot; it wouldn&#39;t be much of an issue."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 5, "creation_date": 1531844292, "post_id": 51373661, "comment_id": 89744087, "body": "If a union contains an array, gcc will generate different machine code for <code>theUnion.anArray[i]</code> and <code>*(theUnion.anArray+i)</code>.  Only in the former case will gcc be smart enough to recognize that an access to <code>anArray[i]</code> might affect the union and its other members."}, {"owner": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1531850825, "post_id": 51373661, "comment_id": 89747421, "body": "@supercat That honestly sounds like a bug on GCC&#39;s part, but cool example anyway!"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 1, "creation_date": 1531851792, "post_id": 51373661, "comment_id": 89747860, "body": "@NicHartley: GCC uses a code-generation/execution model that treats an lvalue expressions of the form <code>aggregate.member</code> or <code>aggregate.member[index]</code>, or <code>aggregate.member[index1][index2]</code>, etc. as operations upon the aggregate, but is unable to recognize a pointer to an aggregate member as having any relation to the aggregate, even in cases where the pointer is used <i>immediately</i>.  The Standard treats support for such constructs as a Quality of Implementation issue, and gcc is designed around the fact that the Standard allows low-quality implementations."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5760, "user_id": 1863564, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XU4XS.png?s=128&g=1", "display_name": "Fund Monica&#39;s Lawsuit", "link": "https://stackoverflow.com/users/1863564/fund-monicas-lawsuit"}, "edited": false, "score": 0, "creation_date": 1531853703, "post_id": 51373661, "comment_id": 89748793, "body": "@NicHartley: See my answer for more info about gcc&#39;s behavior.  It would be nice to know whether gcc&#39;s authors regard the fact that they regard the ability to &quot;flatten&quot; a 2d array using pointer syntax as a design feature or a &quot;missed optimization&quot;, and what they would require of code that needs the flattened behavor."}, {"owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1531860463, "post_id": 51373661, "comment_id": 89751985, "body": "@Barmar Sure, I just tried to make a minimal change to the original text. To fix it with &quot;might&quot; you would have to change several sentences. But, generating different code here is not the same as relying on the phase of the moon and I can&#39;t explain that in a comment, so I tried to explain it in an answer."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "edited": false, "score": 0, "creation_date": 1531862596, "post_id": 51373661, "comment_id": 89752890, "body": "@srdjan.veljkovic, the book cited by the OP claims that the two syntax variations mean something different, and that <i>therefore</i> different code will be generated.  The antecedent of that &quot;therefore&quot; is absolutely, positively wrong.  The fact that the asserted consequence may sometimes be realized anyway is pretty much irrelevant."}, {"owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1531866013, "post_id": 51373661, "comment_id": 89753981, "body": "@JohnBollinger I actually didn&#39;t read the book, only the cited text in the question. It says &quot;different code is generated for different syntax&quot;, but, there&#39;s no explanation <i>why</i> (is it because of different meanings, or because of the phase of the moon). That&#39;s why I think the <i>quote</i> (passage) is not <i>wrong</i>, but, incomplete (which is, essentially, the reason for this question)."}, {"owner": {"reputation": 455, "user_id": 2158499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/807f9d3dd7b288a186f00400adfa0ef7?s=128&d=identicon&r=PG", "display_name": "sdenham", "link": "https://stackoverflow.com/users/2158499/sdenham"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1531874642, "post_id": 51373661, "comment_id": 89755882, "body": "@DanielH Fair enough; but then it is a <a href=\"https://en.wikipedia.org/wiki/Curate%27s_egg\" rel=\"nofollow noreferrer\">curate&#39;s egg</a>, and the thing about a partly-bad egg is that it is really not good at all."}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 96, "last_activity_date": 1549182761, "last_edit_date": 1549182761, "creation_date": 1531804504, "answer_id": 51373661, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51373661#51373661", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>The quote is just wrong. Pretty tragic that such garbage is still published in this decade. In fact, the C Standard defines <code>x[y]</code> as <code>*(x+y)</code>.</p>\n\n<p>The part about lvalues later on the page is completely and utterly wrong too.</p>\n\n<p>IMHO, the best way to use this book is to put it in a recycling bin or burn it.</p>\n"}, {"comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 4, "creation_date": 1531805000, "post_id": 51373716, "comment_id": 89718930, "body": "This makes assumptions about a specific compiler and optimizations, but it&#39;s generally the same thing I did. I wasn&#39;t satisfied, because such a test makes assumptions about a language based on byte code for an architecture."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 2, "creation_date": 1531805292, "post_id": 51373716, "comment_id": 89719017, "body": "Interesting note: both according to the quote and in practice, <code>i[vector]</code> also works, although it would be terrible style to do that in most cases. You cannot start at the location <code>i</code> and move <code>vector</code> positions from this location."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 3, "creation_date": 1531806522, "post_id": 51373716, "comment_id": 89719511, "body": "&quot;I wasn&#39;t satisfied, because such a test makes assumptions about a language based on byte code for an architecture&quot; the point is that we are talking about generated assembly, which is as implementation-specific as you can get. The only thing you can do about such a claim - besides noting the equivalency of observable behavior mandated by the standard - is to look at the output of various compilers."}, {"owner": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "reply_to_user": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "edited": false, "score": 0, "creation_date": 1531842301, "post_id": 51373716, "comment_id": 89742944, "body": "@DanielH - it does work, and IIRC that syntax was featured a few times in the <i>International Obfuscated C Code Contest</i>.  (Sometimes in the form <code>&#39;c&#39;[someptr]</code> or worse.)  I have this vague memory of once checking in code that did <code>n[&quot;0123456789ABCDEF&quot;]</code> largely to mess with a friend who was doing a code review ... I guess looking back I shouldn&#39;t be proud of that ... I only wish I could remember what his reaction was ..."}, {"owner": {"reputation": 6440, "user_id": 27302, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0ee0b2f006682f28d5a6ba5634ade513?s=128&d=identicon&r=PG", "display_name": "Daniel H", "link": "https://stackoverflow.com/users/27302/daniel-h"}, "reply_to_user": {"reputation": 4411, "user_id": 751579, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/iux9g.png?s=128&g=1", "display_name": "davidbak", "link": "https://stackoverflow.com/users/751579/davidbak"}, "edited": false, "score": 0, "creation_date": 1531842697, "post_id": 51373716, "comment_id": 89743180, "body": "@davidbak Yep, it does, but the OP\u2019s book\u2019s description would imply it doesn\u2019t. And, you know, you shouldn\u2019t do it anyway."}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "edited": false, "score": 0, "creation_date": 1532408116, "post_id": 51373716, "comment_id": 89949891, "body": "@AnttiHaapala and for the sake of completeness, I just did a similar test using MSVC, and it too generates the exact same code for both forms: <code>movsxd rax,dword ptr [i]</code> <code>mov edx,dword ptr vector[rax * 4]</code>"}], "tags": [], "owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "is_accepted": false, "score": 33, "last_activity_date": 1531806241, "last_edit_date": 1531806241, "creation_date": 1531804901, "answer_id": 51373716, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51373716#51373716", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>I've got 2 C files: <code>ex1.c</code></p>\n\n<pre><code>% cat ex1.c\n#include &lt;stdio.h&gt;\n\nint main (void) {\n    int vector[5] = { 1, 2, 3, 4, 5 };\n    printf(\"%d\\n\", vector[3]);\n}\n</code></pre>\n\n<p>and <code>ex2.c</code>,</p>\n\n<pre><code>% cat ex2.c\n#include &lt;stdio.h&gt;\n\nint main (void) {\n    int vector[5] = { 1, 2, 3, 4, 5 };\n    printf(\"%d\\n\", *(vector + 3));\n}\n</code></pre>\n\n<p>And I compile both into assembly, and show the difference in generated assembly code</p>\n\n<pre><code>% gcc -S ex1.c; gcc -S ex2.c; diff -u ex1.s ex2.s\n--- ex1.s       2018-07-17 08:19:25.425826813 +0300\n+++ ex2.s       2018-07-17 08:19:25.441826756 +0300\n@@ -1,4 +1,4 @@\n-       .file   \"ex1.c\"\n+       .file   \"ex2.c\"\n        .text\n        .section        .rodata\n .LC0:\n</code></pre>\n\n<p>Q.E.D.</p>\n\n<hr>\n\n<p>The C standard very explicitly states <a href=\"http://port70.net/~nsz/c/c11/n1570.html#6.5.2.1p2\" rel=\"noreferrer\">(C11 n1570 6.5.2.1p2)</a>:</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>A postfix expression followed by an expression in square brackets <code>[]</code> is a subscripted designation of an element of an array object. <strong>The definition of the subscript operator <code>[]</code> is that <code>E1[E2]</code> is identical to <code>(*((E1)+(E2)))</code></strong>. Because of the conversion rules that apply to the binary <code>+</code> operator, if <code>E1</code> is an array object (equivalently, a pointer to the initial element of an array object) and <code>E2</code> is an integer, <code>E1[E2]</code> designates the <code>E2</code>-th element of <code>E1</code> (counting from zero). </li>\n  </ol>\n</blockquote>\n\n<hr>\n\n<p>Additionally, the <em>as-if rule</em> applies here - if the behaviour of the program is the same, the compiler can generate the same code even though the semantics <em>weren't</em> the same.</p>\n"}, {"comments": [{"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531836726, "post_id": 51377886, "comment_id": 89739057, "body": "No. The as-if rule applies. If the optimizer is smart enough it can generate the same code. In the above example most compilers are since a[i] is simply parsed into the same pre-optimized data as *(a+i)."}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "reply_to_user": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 1, "creation_date": 1531837139, "post_id": 51377886, "comment_id": 89739369, "body": "@GoswinvonBrederlow &quot;<i>If</i> the optimizer is smart enough it can generate the same code. In the above example <i>most</i> compilers are&quot; - That&#39;s basically what I was trying to say :)"}], "tags": [], "owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "is_accepted": false, "score": 6, "last_activity_date": 1531837048, "last_edit_date": 1531837048, "creation_date": 1531819903, "answer_id": 51377886, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51377886#51377886", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>I <em>think</em> what the original text may be referring to is some optimizations which some compiler may or may not perform.</p>\n\n<p>Example:</p>\n\n<pre><code>for ( int i = 0; i &lt; 5; i++ ) {\n  vector[i] = something;\n}\n</code></pre>\n\n<p>vs.</p>\n\n<pre><code>for ( int i = 0; i &lt; 5; i++ ) {\n  *(vector+i) = something;\n}\n</code></pre>\n\n<p>In the first case, an optimizing compiler may detect that the array <code>vector</code> is iterated over element by element and thus generate something like</p>\n\n<pre><code>void* tempPtr = vector;\nfor ( int i = 0; i &lt; 5; i++ ) {\n  *((int*)tempPtr) = something;\n  tempPtr += sizeof(int); // _move_ the pointer; simple addition of a constant.\n}\n</code></pre>\n\n<p>It might even be able to use the target CPU's pointer post-increment instructions where available.</p>\n\n<p>For the second case, it is \"harder\" for the compiler to see that the <em>address</em> that's calculated via some \"arbitrary\" pointer arithmetics expression shows the same property of monotonically advancing a fixed amount in each iteration. It might thus not find the optimization and calculate <code>((void*)vector+i*sizeof(int))</code> in each iteration which uses an additional multiplication. In this case there's no (temporary) pointer that gets \"moved\" but only a temporary address re-calculated.</p>\n\n<p>However, the statement probably does not universally hold for all C compilers in all versions.</p>\n\n<p>Update:</p>\n\n<p>I checked the above example.\nIt appears that <em>without</em> optimizations enabled at least gcc-8.1 x86-64 generates more code (2 extra instructions) for the second (pointer-arithmethics) form than the first (array index).</p>\n\n<p>See: <a href=\"https://godbolt.org/g/7DaPHG\" rel=\"noreferrer\">https://godbolt.org/g/7DaPHG</a></p>\n\n<p>However, with any optimizations turned <em>on</em> (<code>-O</code>...<code>-O3</code>) the generated code is the same (length) for both.</p>\n"}, {"comments": [{"owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "edited": false, "score": 1, "creation_date": 1531838705, "post_id": 51378981, "comment_id": 89740556, "body": "You mention the old C FAQ, that&#39;s a <b>really</b> good find. But you don&#39;t tal about why they&#39;re different even in that context: you just say <i>(Of course those two cases generate different code, because arrays and pointers are different.)</i> perhaps some explaining would be good."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1531844713, "post_id": 51378981, "comment_id": 89744311, "body": "The Standard may treat the expressions as equivalent, but many compilers merely interpret that as suggesting that in the cases where the Standard would define the behavior of one, it defines the behavior of both.  The Standard doesn&#39;t impose any requirements on the behavior of accessing elements of non-character arrays within unions (or, for that matter, any non-character union members) but such arrays would be rather useless if they didn&#39;t exhibit type-punning behavior like other members .  GCC will process <code>someUnion.array[i]</code> that way, but does not do so for <code>*(someUnion.arr+i)</code>."}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 1, "creation_date": 1533026356, "post_id": 51378981, "comment_id": 90182841, "body": "&quot;are perfectly identical and can be expected to generate identical code under all circumstances&quot; - That&#39;s not what the standard says. The definition is about <i>semantics</i>, so in both cases you <i>will</i> definitely end up with the same array contents. <i>How</i> this is achieved is up to the compiler and can be quite different from compiler to compiler, platform to platform and between optimization levels."}], "tags": [], "owner": {"reputation": 29251, "user_id": 3923896, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4139ee1298ce4b0690a788cb97d47569?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Summit", "link": "https://stackoverflow.com/users/3923896/steve-summit"}, "is_accepted": false, "score": 19, "last_activity_date": 1531841497, "last_edit_date": 1531841497, "creation_date": 1531822924, "answer_id": 51378981, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51378981#51378981", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>The cited passage is quite wrong.  The expressions <code>vector[i]</code> and <code>*(vector+i)</code> are perfectly identical and can be expected to generate identical code under all circumstances.</p>\n\n<p>The expressions <code>vector[i]</code> and <code>*(vector+i)</code> are identical <em>by definition</em>.  This is a central and fundamental property of the C programming language.  Any competent C programmer understands this.  Any author of a book entitled <em>Understand and Using C Pointers</em> must understand this.  Any author of a C compiler will understand this.  The two fragments will generate identical code not by accident, but because virtually any C compiler will, in effect, translate one form into the other almost immediately, such that by the time it gets to its code generation phase, it won't even know which form had been used initially.  (I would be pretty surprised if a C compiler ever generated significantly different code for <code>vector[i]</code> as opposed to <code>*(vector+i)</code>.)</p>\n\n<p>And in fact, the cited text contradicts itself.  As you noted, the two passages</p>\n\n<blockquote>\n  <p>The notation <code>vector[i]</code> generates machine code that starts at location <code>vector</code> , moves <code>i</code> positions from this location, and uses its content.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>The notation <code>*(vector+i)</code> generates machine code that starts at location <code>vector</code>, adds <code>i</code> to the address, and then uses the contents at that address.</p>\n</blockquote>\n\n<p>say basically the same thing.</p>\n\n<p>His language is eerily similar to that in <a href=\"http://c-faq.com/aryptr/aryptr2.html\" rel=\"noreferrer\">question 6.2</a> of the old <a href=\"http://c-faq.com/\" rel=\"noreferrer\">C FAQ list</a>:</p>\n\n<blockquote>\n  <p>...when the compiler sees the expression <code>a[3]</code>, it emits code to start at the location \"<code>a</code>\", move three past it, and fetch the character there. When it sees the expression <code>p[3]</code>, it emits code to start at the location \"<code>p</code>\", fetch the pointer value there, add three to the pointer, and finally fetch the character pointed to.</p>\n</blockquote>\n\n<p>But of course the key difference here is that <em><code>a</code> is an array and <code>p</code> is a pointer</em>.  The FAQ list is talking not about <code>a[3]</code> versus <code>*(a+3)</code>, but rather about <code>a[3]</code> (or <code>*(a+3)</code>) where <code>a</code> is an array, versus <code>p[3]</code> (or <code>*(p+3)</code>) where <code>p</code> is a pointer.  (Of course those two cases generate different code, because arrays and pointers are different.  As the FAQ list explains, fetching an address from a pointer variable is fundamentally different from using the address of an array.)</p>\n"}, {"tags": [], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "is_accepted": false, "score": 6, "last_activity_date": 1531847088, "creation_date": 1531847088, "answer_id": 51386841, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51386841#51386841", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>The Standard specifies the behavior of <code>arr[i]</code> when <code>arr</code> is an array object as being equivalent to decomposing <code>arr</code> to a pointer, adding <code>i</code>, and dereferencing the result.  Although the behaviors would be equivalent in all Standard-defined cases, there are some cases where compilers process actions usefully even though the Standard does require it, and the handling of <code>arrayLvalue[i]</code> and <code>*(arrayLvalue+i)</code> may differ as a consequence.</p>\n\n<p>For example, given</p>\n\n<pre><code>char arr[5][5];\nunion { unsigned short h[4]; unsigned int w[2]; } u;\n\nint atest1(int i, int j)\n{\nif (arr[1][i])\n    arr[0][j]++;\nreturn arr[1][i];\n}\nint atest2(int i, int j)\n{\nif (*(arr[1]+i))\n    *((arr[0])+j)+=1;\nreturn *(arr[1]+i);\n}\nint utest1(int i, int j)\n{\n    if (u.h[i])\n        u.w[j]=1;\n    return u.h[i];\n}\nint utest2(int i, int j)\n{\n    if (*(u.h+i))\n        *(u.w+j)=1;\n    return *(u.h+i);\n}\n</code></pre>\n\n<p>GCC's generated code for test1 will assume that arr[1][i] and arr[0][j] cannot alias, but the generated code for test2 will allow for pointer arithmetic to access the entire array,  On the flip side, gcc will recognize that in utest1, lvalue expressions u.h[i] and u.w[j] both access the same union, but it's not sophisticated enough to notice the same about *(u.h+i) and *(u.w+j) in utest2.</p>\n"}, {"tags": [], "owner": {"reputation": 2240, "user_id": 3499640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff85dddff0538584dfeb0dfc0946a341?s=128&d=identicon&r=PG&f=1", "display_name": "srdjan.veljkovic", "link": "https://stackoverflow.com/users/3499640/srdjan-veljkovic"}, "is_accepted": false, "score": 3, "last_activity_date": 1531859826, "creation_date": 1531859826, "answer_id": 51389829, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51389829#51389829", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>Let me try to answer this \"in the narrow\" (others have already described why the description \"as-is\" is somewhat lacking/incomplete/misleading):</p>\n\n<blockquote>\n  <p>In what context would any compiler generate different code for those two? </p>\n</blockquote>\n\n<p>A \"not-very-optimizing\" compiler might generate different code in just about any context, because, while parsing, there's a difference: <code>x[y]</code> is one expression (index into an array), while <code>*(x+y)</code> are <em>two</em> expressions (add an integer to a pointer, then dereference it). Sure, it's not very hard to recognize this (even while parsing) and treat it the same, but, if you're writing a simple/fast compiler, then you avoid putting \"too much smarts into it\". As an example:</p>\n\n<pre><code>char vector[] = ...;\nchar f(int i) {\n    return vector[i];\n}\nchar g(int i) {\n    return *(vector + i);\n}\n</code></pre>\n\n<p>Compiler, while parsing <code>f()</code>, sees the \"indexing\" and may generate something like (for some 68000-like CPU):</p>\n\n<pre><code>MOVE D0, [A0 + D1] ; A0/vector, D1/i, D0/result of function\n</code></pre>\n\n<p>OTOH, for <code>g()</code>, compiler sees two things: first a dereference (of \"something yet to come\") and then the adding of integer to pointer/array, so being not-very-optimizing, it could end up with:</p>\n\n<pre><code>MOVE A1, A0   ; A1/t = A0/vector\nADD A1, D1    ; t += i/D1\nMOVE D0, [A1] ; D0/result = *t\n</code></pre>\n\n<p>Obviously, this is very implementation dependent, some compiler might also dislike using complex instructions as used for <code>f()</code> (using complex instructions makes it harder to debug the compiler), the CPU might not have such complex instructions, etc.</p>\n\n<blockquote>\n  <p>Is there a difference between \"move\" from base, and \"add\" to base?</p>\n</blockquote>\n\n<p>The description in the book is arguably not well-worded. But, I think the author wanted to describe the distinction shown above - indexing (\"move\" from base) is one expression, while \"add and then dereference\" are two expressions.</p>\n\n<p>This is about <em>compiler implementation</em>, <em>not</em> language definition, the distinction which should have also been explicitly indicated in the book.</p>\n"}, {"comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1532272684, "post_id": 51396103, "comment_id": 89901404, "body": "And did you try optimizations?"}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "reply_to_user": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1532335360, "post_id": 51396103, "comment_id": 89917699, "body": "no, sorry the examples are to trivial, everything would be optimized out. If you like, you can try it at <a href=\"https://godbolt.org\" rel=\"nofollow noreferrer\">Compiler Explorer</a>"}, {"owner": {"reputation": 11138, "user_id": 1015327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d71e011fc61cad60c5ffc9bf48c5ef?s=128&d=identicon&r=PG", "display_name": "JimmyB", "link": "https://stackoverflow.com/users/1015327/jimmyb"}, "edited": false, "score": 0, "creation_date": 1533025894, "post_id": 51396103, "comment_id": 90182589, "body": "Declare the array as <code>volatile</code> and the code will not be optimized away."}, {"owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "edited": false, "score": 0, "creation_date": 1533040980, "post_id": 51396103, "comment_id": 90192519, "body": "with -O&gt;1 assembler output is for both: ` mov eax, DWORD PTR vector[rip+4]`"}], "tags": [], "owner": {"reputation": 1894, "user_id": 8473031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4878bfc9d6a80397a8446111fffa4dd?s=128&d=identicon&r=PG&f=1", "display_name": "RoQuOTriX", "link": "https://stackoverflow.com/users/8473031/roquotrix"}, "is_accepted": false, "score": 2, "last_activity_date": 1531899070, "creation_date": 1531899070, "answer_id": 51396103, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51396103#51396103", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>I tested the Code for some compiler variations, most of them give me the same assembly code for both instructions (tested for x86 with no optimization). \nInteresting is, that the gcc 4.4.7 does exactly, what you mentioned:\nExample:</p>\n\n<p><a href=\"https://i.stack.imgur.com/WauFq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WauFq.png\" alt=\"C-Code\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/STjM7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/STjM7.png\" alt=\"Assembly code\"></a></p>\n\n<p>Other langauges like ARM or MIPS are doing sometimes the same, but I didn`t tested it all. So it seems their was a difference, but later versions of gcc \"fixed\" this bug.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5924948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d948c236c087f7bd4b6dd9a2e9b7062?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Thanki", "link": "https://stackoverflow.com/users/5924948/jay-thanki"}, "is_accepted": false, "score": -2, "last_activity_date": 1532369801, "last_edit_date": 1532369801, "creation_date": 1532364235, "answer_id": 51483648, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation/51483648#51483648", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>This is a sample array syntax as used in C.</p>\n\n<pre><code>int a[10] = {1,2,3,4,5,6,7,8,9,10};\n</code></pre>\n"}], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3444, "favorite_count": 3, "answer_count": 8, "score": 55, "last_activity_date": 1549182761, "creation_date": 1531803607, "last_edit_date": 1531845614, "question_id": 51373516, "link": "https://stackoverflow.com/questions/51373516/array-syntax-vs-pointer-syntax-and-code-generation", "title": "Array-syntax vs pointer-syntax and code generation?", "body": "<p>In the book, <a href=\"http://shop.oreilly.com/product/0636920028000.do\" rel=\"noreferrer\"><em>\"Understanding and Using C Pointers\"</em> by Richard Reese</a> it says on page 85,</p>\n\n<blockquote>\n<pre><code>int vector[5] = {1, 2, 3, 4, 5};\n</code></pre>\n  \n  <p>The code generated by <code>vector[i]</code> is different from the code generated by <code>*(vector+i)</code> . The notation <code>vector[i]</code> generates machine code that starts at location vector , <em>moves</em> <code>i</code> positions from this location, and uses its content. The notation <code>*(vector+i)</code> generates machine code that starts at location <code>vector</code> , <em>adds</em> <code>i</code> to the address, and then uses the contents at that address. While the result is the same, the generated machine code is different. This difference is rarely of significance to most programmers.</p>\n</blockquote>\n\n<p>You can see the <a href=\"https://books.google.com/books?id=K4P32IpvyNMC&amp;lpg=PA85&amp;ots=_AkgkJGpYl&amp;dq=The%20notation%20vector%2Bi%20generates%20machine%20code%20that%20starts%20at%20location%20vector%20%2C%20adds%20i%20to%20the%20address%2C%20and%20then%20uses%20the%20contents%20at%20that%20address.%20While%20the%20result%20is%20the%20same%2C%20the%20generated%20machine%20code%20is%20different.%20This%20difference%20is%20rarely%20of%20significance%20to%20most%20programmers.%20What&amp;pg=PA85#v=onepage&amp;q=The%20notation%20vector+i%20generates%20machine%20code%20that%20starts%20at%20location%20vector%20,%20adds%20i%20to%20the%20address,%20and%20then%20uses%20the%20contents%20at%20that%20address.%20While%20the%20result%20is%20the%20same,%20the%20generated%20machine%20code%20is%20different.%20This%20difference%20is%20rarely%20of%20significance%20to%20most%20programmers.%20What&amp;f=false\" rel=\"noreferrer\">excerpt here</a>. What does this passage mean? In what context would any compiler generate different code for those two? Is there a difference between \"move\" from base, and \"add\" to base? I was unable to get this to work on GCC -- generating different machine code.</p>\n"}, {"tags": ["c", "ada", "function-call"], "comments": [{"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 0, "creation_date": 1531812886, "post_id": 51373246, "comment_id": 89722798, "body": "Show us the signature of the C function and your import statement for the function. Also the definition of the type <code>uu_u8</code>."}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531830937, "post_id": 51373246, "comment_id": 89734809, "body": "The signature of the C function: __s32 read_i2c_block_data(int file, __u8 command, __u8 length, __u8 *values)"}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531831048, "post_id": 51373246, "comment_id": 89734874, "body": "import statement: with i2c_interface_c; use i2c_interface_c;"}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531831100, "post_id": 51373246, "comment_id": 89734922, "body": "definition of uu_u8:   subtype uu_s8 is signed_char;"}, {"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 0, "creation_date": 1531831165, "post_id": 51373246, "comment_id": 89734957, "body": "If the signature has a return value, your import is wrong because as you call it, <code>call_c_func</code> is a procedure when it needs to be a function. Your import statement is the subprogram definition of <code>call_c_func</code> on the Ada side, not some <code>with</code> statement. We do not know the contents of <code>i2c_interface_c</code>, you need to show it."}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 1, "creation_date": 1531831176, "post_id": 51373246, "comment_id": 89734965, "body": "Simon, when I add all to the declaration of block I get:  &quot;all&quot; is not permitted for anonymous access types"}, {"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 0, "creation_date": 1531831247, "post_id": 51373246, "comment_id": 89735012, "body": "Also, the list of arguments on the C side does not match at all with the single parameter you call it with on the Ada side."}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531831332, "post_id": 51373246, "comment_id": 89735069, "body": "Here it is flyx:  function read_i2c_block_data      (file : int;       command : asm_generic_int_ll64_h.uu_u8;       length : asm_generic_int_ll64_h.uu_u8;       values : access asm_generic_int_ll64_h.uu_u8) return asm_generic_int_ll64_h.uu_s32;  -- i2c_interface.c:90    pragma Import (C, read_i2c_block_data, &quot;read_i2c_block_data&quot;);"}, {"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 0, "creation_date": 1531831362, "post_id": 51373246, "comment_id": 89735095, "body": "Well that&#39;s not <code>call_c_func</code>, is it? It has a different number of parameters."}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531831407, "post_id": 51373246, "comment_id": 89735130, "body": "Sorry, I was trying to be brief. Here is the actual way I call the function: result := read_i2c_block_data(Interfaces.C.int(fd), uu_u8(LSM9DS0_OUT_X_L_M), uu_u8(block&#39;Length), block(1));"}, {"owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "edited": false, "score": 0, "creation_date": 1531831417, "post_id": 51373246, "comment_id": 89735135, "body": "You should read up how to create a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "edited": false, "score": 0, "creation_date": 1531831819, "post_id": 51373246, "comment_id": 89735383, "body": "The call to the C function executes. The error occurs when I try to access the block array."}, {"owner": {"reputation": 22472, "user_id": 40851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/RwWVj.jpg?s=128&g=1", "display_name": "Simon Wright", "link": "https://stackoverflow.com/users/40851/simon-wright"}, "edited": false, "score": 0, "creation_date": 1531836171, "post_id": 51373246, "comment_id": 89738632, "body": "It\u2019d help if you edited the question in a coherent way instead of teasing us with random snippets of code."}], "answers": [{"tags": [], "owner": {"reputation": 23530, "user_id": 347964, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/bE90m.png?s=128&g=1", "display_name": "flyx", "link": "https://stackoverflow.com/users/347964/flyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1531831939, "creation_date": 1531831939, "answer_id": 51381890, "question_id": 51373246, "link": "https://stackoverflow.com/questions/51373246/ada-arrays-of-access-type/51381890#51381890", "title": "Ada arrays of access type", "body": "<p>From your comments, it is clear that you use a wrong array type.</p>\n\n<p>Your array on the Ada side is an array of pointers to <code>uu_8</code>. However, on the C side, <code>__u8*</code> is expected, i.e. a pointer to a <code>__u8</code> value. The types are not compatible.</p>\n\n<p>In C, arrays are typically passed as pointer to the first element. This is the case here. So what you actually need on the Ada side is an array with <code>uu_8</code> values in it:</p>\n\n<pre><code>type My_Array is array (Integer range &lt;&gt;) of uu_8;\npragma Convention (C, My_Array);\n\nBlock : My_Array := (1 =&gt; 1, 2 =&gt; 2, 3 =&gt; 3, 4 =&gt; 4, 5 =&gt; 5, 6 =&gt; 6);\n\nfunction read_i2c_block_data\n  (file : int;\n   command : asm_generic_int_ll64_h.uu_u8;\n   length : asm_generic_int_ll64_h.uu_u8;\n   values : in out My_Array) return asm_generic_int_ll64_h.uu_s32;\npragma Import (C, read_i2c_block_data, \"read_i2c_block_data\");\n</code></pre>\n\n<p>The compiler will map your Ada array to a pointer to the first element when having convention C and used in a function imported with C calling convention. <code>in out</code> tells Ada that the C function may modify the array.</p>\n"}], "owner": {"reputation": 3, "user_id": 10014833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82bfd3869eca0f61fa1510b670b265ff?s=128&d=identicon&r=PG&f=1", "display_name": "A Mara", "link": "https://stackoverflow.com/users/10014833/a-mara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 0, "accepted_answer_id": 51381890, "answer_count": 1, "score": 0, "last_activity_date": 1531831939, "creation_date": 1531801847, "last_edit_date": 1531802415, "question_id": 51373246, "link": "https://stackoverflow.com/questions/51373246/ada-arrays-of-access-type", "title": "Ada arrays of access type", "body": "<p>Ada Coders,</p>\n\n<p>I am trying to pass an array of pointers to a C function from Ada. I am new to Ada.</p>\n\n<p>Here's the code:</p>\n\n<pre><code>with Interfaces.C; use Interfaces.C;\nwith asm_generic_int_ll64_h; use asm_generic_int_ll64_h;\n\nblock : array(Integer range 1 .. 6) of access uu_u8;\none : aliased uu_u8 := uu_u8(1);\ntwo : aliased uu_u8 := uu_u8(2);\nthree : aliased uu_u8 := uu_u8(3);\nfour : aliased uu_u8 := uu_u8(4);\nfive : aliased uu_u8 := uu_u8(5);\nsix : aliased uu_u8 := uu_u8(6);\n\nans : uu_u8;\n\nbegin\n\nblock(1) := one'Access;\nblock(2) := two'Access;\nblock(3) := three'Access;\nblock(4) := four'Access;\nblock(5) := five'Access;\nblock(6) := six'Access;\n\ncall_c_func(block(1));\n\nans := block(1).all;\n</code></pre>\n\n<p>The last line causes an error:</p>\n\n<blockquote>\n  <p>raised STORAGE_ERROR : stack overflow (or erroneous memory access)</p>\n</blockquote>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["c", "gtk3"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1531802207, "post_id": 51373189, "comment_id": 89718286, "body": "Your code (last code chunk with <code>main</code>) does not seems to be some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> (so please improve it to make it one). Your <code>motion_notify_event</code> is not used from your <code>main</code> (or installed as a callback). Please <b>edit your question</b> to provide some <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 2649, "user_id": 4022617, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/nk22l.png?s=128&g=1", "display_name": "dgnuff", "link": "https://stackoverflow.com/users/4022617/dgnuff"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1531804770, "post_id": 51373189, "comment_id": 89718874, "body": "@BasileStarynkevitch On the contrary, it already is.  As stated in the second paragraph of the OP&#39;s post, the first two code chunks are showing how he has been able to intercept motion events to presumably lock the window size, and are nothing directly to do with the code in the third chunk.  They are merely an example of work done to solve a somewhat related problem.  <b>As it stands</b>, that third chunk is a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete and Verifiable example</a>"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1531805075, "post_id": 51373189, "comment_id": 89718950, "body": "I am able to compile (in isolation) the last chunk with  <code>gcc $(pkg-config --cflags gtk+-x11-3.0) -Og -g george.c $(pkg-config --libs gtk+-x11-3.0) -o george</code>. When I debug that with a breakpoint on <code>motion_notify_event</code>, that function is unknown and the breakpoint is never reached. So indeed the last chunk is an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> but it does not call (or link) the <code>motion_notify_event</code> of the first chunk"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1531805188, "post_id": 51373189, "comment_id": 89718987, "body": "Now we have an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and I upvoted the question. Thanks GeorgeS!"}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531805640, "post_id": 51373189, "comment_id": 89719142, "body": "I upvoted but <i>please</i> indent your code properly!"}, {"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1531810961, "post_id": 51373189, "comment_id": 89721685, "body": "<a href=\"https://developer.gnome.org/gdk3/stable/gdk3-Windows.html#gdk-window-set-cursor\" rel=\"nofollow noreferrer\">gdk_window_set_cursor?</a> Also related <a href=\"https://developer.gnome.org/gtk3/stable/GtkPaned.html#GtkPaned--c-shrink\" rel=\"nofollow noreferrer\">GtkPaned property &quot;shrink&quot;</a>"}, {"owner": {"reputation": 16265, "user_id": 7478597, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yBOIj.jpg?s=128&g=1", "display_name": "Scheff", "link": "https://stackoverflow.com/users/7478597/scheff"}, "edited": false, "score": 0, "creation_date": 1531811562, "post_id": 51373189, "comment_id": 89722048, "body": "In addition to David: Out of curiosity, I digged a bit into the source code <a href=\"https://code.woboq.org/gtk/gtk/gtk/gtkpaned.c.html#_GtkPanedPrivate\" rel=\"nofollow noreferrer\">gtkpaned.c</a> on woboq and found a <code>GdkWindow *handle</code> in <code>_GtkPanedPrivate</code>. I assume if the cursor of this window would be changed this might solve your issue. Btw. is there any chance using these new CSS features? (When I developed in GTK+ 2 these were not yet available - so no experience...)"}, {"owner": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "edited": false, "score": 0, "creation_date": 1532000142, "post_id": 51373189, "comment_id": 89814123, "body": "Does it have to be GtkPaned? Why not use <a href=\"https://developer.gnome.org/gtk3/3.22/GtkBox.html\" rel=\"nofollow noreferrer\">GtkBox</a> if you don&#39;t want to resize it?"}, {"owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "reply_to_user": {"reputation": 698, "user_id": 1981374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1afd547bb1f448490439e0093eba3a70?s=128&d=identicon&r=PG", "display_name": "pan-mroku", "link": "https://stackoverflow.com/users/1981374/pan-mroku"}, "edited": false, "score": 0, "creation_date": 1532394032, "post_id": 51373189, "comment_id": 89946951, "body": "@pan-mroku, The GtkBox is not easy to adjust the size of childs I want."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "edited": false, "score": 0, "creation_date": 1532393807, "post_id": 51376385, "comment_id": 89946907, "body": "If I set the paned sesitive to FALSE, it will also disable the response of the button on the paned."}, {"owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "edited": false, "score": 0, "creation_date": 1532394241, "post_id": 51376385, "comment_id": 89946996, "body": "I want to put some buttons on the child of paned object."}], "tags": [], "owner": {"reputation": 1, "user_id": 9129883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab9c2c05628c5463176a2c615ef27ec3?s=128&d=identicon&r=PG&f=1", "display_name": "KennyG", "link": "https://stackoverflow.com/users/9129883/kennyg"}, "is_accepted": false, "score": 0, "last_activity_date": 1531815278, "creation_date": 1531815278, "answer_id": 51376385, "question_id": 51373189, "link": "https://stackoverflow.com/questions/51373189/how-to-prevent-mouse-icon-to-be-changed/51376385#51376385", "title": "How to prevent mouse icon to be changed?", "body": "<p>According to the Glade under CentOS 7, Widget flags property \"Sensitive\" is your answer.</p>\n\n<p>Please try gtk_widget_set_sensitive(your widget, FALSE).</p>\n\n<p><a href=\"https://i.stack.imgur.com/HPo4Y.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}], "owner": {"reputation": 99, "user_id": 9059380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9c19710bf2f6da97bf39183e3ea4029?s=128&d=identicon&r=PG&f=1", "display_name": "GeorgeS", "link": "https://stackoverflow.com/users/9059380/georges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1531815278, "creation_date": 1531801321, "last_edit_date": 1531806189, "question_id": 51373189, "link": "https://stackoverflow.com/questions/51373189/how-to-prevent-mouse-icon-to-be-changed", "title": "How to prevent mouse icon to be changed?", "body": "<p>Is it possible to prevent mouse cursor icon to be changed above paned separator ? --> I want to disable the resizing function of paned object.</p>\n\n<p>By the way, I have already find the way to response to resizing action by add \"notify\" event, likes this :</p>\n\n<hr>\n\n<pre><code>#include &lt;gtk/gtk.h&gt;\nstatic gboolean motion_notify_event(GtkWidget *widget, GdkEventMotion *event);\nint main (int argc, char *argv[]) {\n    GtkWidget *toplevel;\n    gtk_init (&amp;argc, &amp;argv);\n    toplevel = gtk_window_new(GTK_WINDOW_TOPLEVEL);\n\n    GtkWidget *hpaned = gtk_vpaned_new();\n    GtkWidget *frame1 = gtk_frame_new(NULL);\n    GtkWidget *frame2 = gtk_frame_new(NULL);\n    gtk_frame_set_shadow_type(GTK_FRAME(frame1), GTK_SHADOW_NONE);\n    gtk_frame_set_shadow_type(GTK_FRAME(frame2), GTK_SHADOW_NONE);\n    gtk_paned_pack1(GTK_PANED(hpaned), frame1, FALSE, FALSE);\n    gtk_paned_pack2(GTK_PANED(hpaned), frame2, TRUE, TRUE);\n    gtk_widget_set_size_request(frame1, 50, 50);\n\n    g_signal_connect(G_OBJECT(hpaned), \"notify\",  G_CALLBACK(motion_notify_event), NULL);\n\n    gtk_container_add(GTK_CONTAINER(toplevel), hpaned);\n    gtk_widget_show_all(toplevel);\n    gtk_main();\n    return 0;\n}\n\nstatic gboolean motion_notify_event(GtkWidget *widget, GdkEventMotion *event)\n{\n    gtk_paned_set_position(GTK_PANED(widget), 50);\n    return TRUE;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/TxItM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TxItM.png\" alt=\"mouse icon is showing resizing\"></a></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 1, "creation_date": 1531806202, "post_id": 51373162, "comment_id": 89719376, "body": "It is because <b>you didn&#39;t convert to characters</b> and 27 in base 5 is <b><code>192</code></b> which you convert backwards into <code>{2, 0, 1}</code>."}, {"owner": {"reputation": 116557, "user_id": 918959, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/b9051b2917c3d55d55b3d7042fa49f6c?s=128&d=identicon&r=PG", "display_name": "Antti Haapala", "link": "https://stackoverflow.com/users/918959/antti-haapala"}, "edited": false, "score": 0, "creation_date": 1531807128, "post_id": 51373162, "comment_id": 89719727, "body": "Oops meant to write <b>102</b> above :D"}, {"owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "edited": false, "score": 0, "creation_date": 1531837088, "post_id": 51373162, "comment_id": 89739334, "body": "And the loop ends when it hits the 0 in the middle."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 6373297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85f21da512b5a5443f293612c3853c4?s=128&d=identicon&r=PG&f=1", "display_name": "George Allen", "link": "https://stackoverflow.com/users/6373297/george-allen"}, "edited": false, "score": 0, "creation_date": 1531803003, "post_id": 51373271, "comment_id": 89718443, "body": "Your method of conversion is better than mine but I think you are misunderstanding. I am storing each value as a number knowingly. I was planing to convert them after I solved this current problem. How does the way I store a value in a string effect where my string ends?"}, {"owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "reply_to_user": {"reputation": 7, "user_id": 6373297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85f21da512b5a5443f293612c3853c4?s=128&d=identicon&r=PG&f=1", "display_name": "George Allen", "link": "https://stackoverflow.com/users/6373297/george-allen"}, "edited": false, "score": 0, "creation_date": 1531803667, "post_id": 51373271, "comment_id": 89718587, "body": "The character &#39;\\0&#39; is the numeric value 0, so the &quot;string&quot; &quot;ends&quot; when the first 0 occurs in the number.  You should pass <code>itob</code> an int pointer and fill it with the length of the array, and not terminate the array with any value.  Also imo since it is an array of ints you should consider using a different type than char, maybe uint8_t, just to be that much clearer about your intentions."}], "tags": [], "owner": {"reputation": 4625, "user_id": 1861521, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dda04c7abdfe8b05f4a258b7a01900a6?s=128&d=identicon&r=PG", "display_name": "jcarpenter2", "link": "https://stackoverflow.com/users/1861521/jcarpenter2"}, "is_accepted": false, "score": 5, "last_activity_date": 1531802414, "last_edit_date": 1531802414, "creation_date": 1531802013, "answer_id": 51373271, "question_id": 51373162, "link": "https://stackoverflow.com/questions/51373162/for-loops-detects-0-earlier-than-expected/51373271#51373271", "title": "For loops detects &#39;\\0&#39; earlier than expected", "body": "<p>Basically you are mixing integer values and char values.  In <code>itob</code> you are storing each digit as a number &lt; base, not as an actual character, with the line <code>string[i] = value % base;</code>.  For known base &lt;= 10 that line should be changed to <code>string[i] = '0' + value % base</code>.  Or for base &lt;= 36 you could change that to the two lines <code>static char chars[] = \"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; string[i] = chars[value % base]</code>.  Either way make sure to check that base is in range before proceeding.</p>\n\n<p>Then you must change the second %d in your printf to %c  to denote that you are printing a char.</p>\n\n<p>Also note the number will be stored little-endian, least significant digit first.</p>\n\n<p>Edit: Also change <code>string[++i] = '\\0'</code> to <code>string[i] = '\\0'</code> because <code>i</code> is already pointing to the index after all of the appended characters.</p>\n"}, {"tags": [], "owner": {"reputation": 678, "user_id": 8400707, "user_type": "registered", "profile_image": "https://graph.facebook.com/1603106016403126/picture?type=large", "display_name": "Junhee Shin", "link": "https://stackoverflow.com/users/8400707/junhee-shin"}, "is_accepted": false, "score": 1, "last_activity_date": 1531802766, "creation_date": 1531802766, "answer_id": 51373366, "question_id": 51373162, "link": "https://stackoverflow.com/questions/51373162/for-loops-detects-0-earlier-than-expected/51373366#51373366", "title": "For loops detects &#39;\\0&#39; earlier than expected", "body": "<p>if you want to get the string as char[], print as %c format and set the digit character like this.</p>\n\n<pre><code>string[i] = value % base + '0' ;\n</code></pre>\n\n<p>if you want to get the digit as int[], you can print as %d and set the digit you coded.\nand the last character index is wrong.</p>\n\n<p>string[i]='\\0'; // not ++i</p>\n\n<p>and you should reverse the string array or\nprint reverse.  </p>\n\n<pre><code>for (i=strlen(string)-1; i&gt;=0; i--)\nprintf(\"%c\", string[i]) ;\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6373297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a85f21da512b5a5443f293612c3853c4?s=128&d=identicon&r=PG&f=1", "display_name": "George Allen", "link": "https://stackoverflow.com/users/6373297/george-allen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1531802766, "creation_date": 1531801089, "question_id": 51373162, "link": "https://stackoverflow.com/questions/51373162/for-loops-detects-0-earlier-than-expected", "title": "For loops detects &#39;\\0&#39; earlier than expected", "body": "<p>According to the book \"The C Programming language\" written by K&amp;R you can designate the end of a character array by writing '\\0' to the last variable in the Array. After writing values to an array I ended it with a '\\0' like so.</p>\n\n<pre><code>void itob(int value, char string[], int base)//writes integer c into string s with a base of b \n\n{\n    int i;\n    for (i=0; value; i++) {\n\n        string[i] = value % base; //Writes remainder of value / base to character array\n        value = value / base;\n    }\n\n    string[++i] = '\\0'; // Ends string with EOF\n\n}\n</code></pre>\n\n<p>Why then when I print the character's values in a for loop does it stop after a single iteration? Similarly when I print the string as a whole it stops after a single value.  </p>\n\n<pre><code>int main()\n{\n    int i = 0;\n\n    char string[MAXLINE]; // Max line defined as 1000\n    int value;\n    int base; \n\n    printf(\"Enter Value \");\n    scanf(\"%d\", &amp;value);\n\n    printf(\"\\nEnter Base \");\n    scanf(\"%d\", &amp;base);\n\n    itob(value, string, base);\n\n    for (i = 0; string[i] != '\\0'; i++) { \n    printf(\"Char %d = %d\\n\" , i, string[i]);}\n\n    printf(\"\\n%d in base %d = %s\" , value, base, string); \n\n\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>Enter Value 27\n\nEnter Base 5\n\nChar 0 = 2\n\n27 in base 5 is = \n</code></pre>\n"}, {"tags": ["c", "multithreading", "sockets"], "comments": [{"owner": {"reputation": 26680, "user_id": 1806780, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/NCB41.jpg?s=128&g=1", "display_name": "Sami Kuhmonen", "link": "https://stackoverflow.com/users/1806780/sami-kuhmonen"}, "edited": false, "score": 1, "creation_date": 1531799944, "post_id": 51372978, "comment_id": 89717752, "body": "It doesn\u2019t depend on any data shared (assuming dest won\u2019t change) and doesn\u2019t modify any data so it won\u2019t need any synchronization."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1531800007, "post_id": 51372978, "comment_id": 89717779, "body": "Not for UDP, but if you don&#39;t sequentialize your TCP sends you can end up with mixed data at the other end. NB <code>sendto()</code> with TCP ignores the destination arguments, and may cause EISCONN unless they are NULL and zero."}], "answers": [{"comments": [{"owner": {"reputation": 209, "user_id": 8498049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/026e998e24621716d72b732e8ae0587c?s=128&d=identicon&r=PG&f=1", "display_name": "skmiley1", "link": "https://stackoverflow.com/users/8498049/skmiley1"}, "edited": false, "score": 0, "creation_date": 1531876042, "post_id": 51373255, "comment_id": 89756162, "body": "So, the two threads will be able to send packets on their separate sockets concurrently without any issues correct? What happens if one thread enters sendMsg and the send() call is taking a while? Will the other thread be blocked until the first thread exits?"}], "tags": [], "owner": {"reputation": 89, "user_id": 7715071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87129542ce2b44b57c1b1b45f90615cf?s=128&d=identicon&r=PG&f=1", "display_name": "BobTheBuilder", "link": "https://stackoverflow.com/users/7715071/bobthebuilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1531801887, "creation_date": 1531801887, "answer_id": 51373255, "question_id": 51372978, "link": "https://stackoverflow.com/questions/51372978/multithreaded-sender/51373255#51373255", "title": "Multithreaded sender", "body": "<p>You seem to be a little unclear about how mutex works. A mutex is not applied on a piece of code, but a piece of data used within the code. Here the function is called by both threads, but there is no shared data between the threads. So as @Sami Kuhmonen said in a comment above, you don't need to use mutexes here. </p>\n\n<p>You might need a mutex in future if, say, in case there was a third thread that pushed data into a (say) queue which your thread would then access from the queue and send to the connected computer. Then you would need to synchronise the way these threads push and pop data into and from the queue.</p>\n"}, {"tags": [], "owner": {"reputation": 4651, "user_id": 4262344, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70dad663dd1685c6b4f9675d01253e78?s=128&d=identicon&r=PG&f=1", "display_name": "Goswin von Brederlow", "link": "https://stackoverflow.com/users/4262344/goswin-von-brederlow"}, "is_accepted": false, "score": 0, "last_activity_date": 1531837787, "creation_date": 1531837787, "answer_id": 51383978, "question_id": 51372978, "link": "https://stackoverflow.com/questions/51372978/multithreaded-sender/51383978#51383978", "title": "Multithreaded sender", "body": "<p>If you read the manpage for sendmsg you might see the following sentence:</p>\n\n<blockquote>\n  <p>If  the  message  is too long to pass atomically through the underlying protocol, the error EMSGSIZE is returned, and the message is not transmitted.</p>\n</blockquote>\n\n<p>Atomically means that the package is always send in one blob with no other data being able to insert itself in the middle. So no matter how many threads use sendmsg the kernel will mix packets.</p>\n"}], "owner": {"reputation": 209, "user_id": 8498049, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/026e998e24621716d72b732e8ae0587c?s=128&d=identicon&r=PG&f=1", "display_name": "skmiley1", "link": "https://stackoverflow.com/users/8498049/skmiley1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1531837787, "creation_date": 1531799452, "question_id": 51372978, "link": "https://stackoverflow.com/questions/51372978/multithreaded-sender", "title": "Multithreaded sender", "body": "<p>I am working on sending traffic (such as UDP/TCP packets) from one machine to another. I am writing a C application which has 1 thread for each traffic type. I want these two threads to concurrently send packets. </p>\n\n<p>Do I need to use any synchronization primitives such as a mutex lock within the sendMsg function since it is being called from each thread?</p>\n\n<pre><code>sockaddr_in dest;\n\n void * udp(void * arg){\n     struct * info = arg;\n     int fd = socket(AF_INET, SOCK_DGRAM, 0);\n     //set up socket info\n     while(1){\n         sendMsg(udpInfo, fd);\n     }\n  }\n\n void * tcp(void * arg){\n     struct * info = arg;\n     int fd = socket(AF_INET, SOCK_STREAM, 0);\n     // set up socket info\n     while(1){\n         sendMsg(tcpInfo, fd);\n     }\n}\n\n     void sendMsg(struct * info, int fd){\n         sendTo(fd, \"hello\", strlen(\"hello\") + 1, 0, (struct sockaddr*)&amp;dest, sizeof(dest));\n\n     }\n</code></pre>\n"}]