[{"tags": ["c", "ffmpeg", "aac"], "answers": [{"tags": [], "owner": {"reputation": 422, "user_id": 613253, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wnDxZ.png?s=128&g=1", "display_name": "Mockarutan", "link": "https://stackoverflow.com/users/613253/mockarutan"}, "is_accepted": true, "score": 0, "last_activity_date": 1483654579, "creation_date": 1483654579, "answer_id": 41495699, "question_id": 41273273, "link": "https://stackoverflow.com/questions/41273273/aac-encoding-with-ffmpeg-result-in-super-short-file/41495699#41495699", "title": "aac encoding with ffmpeg result in super short file", "body": "<p>So I found it, in line 75, this was missing:</p>\n\n<pre><code>    time_base.num = per_frame_audio_samples;\n    time_base.den = aud_codec_context-&gt;sample_rate;\n    aud_codec_context-&gt;time_base = time_base;\n</code></pre>\n\n<p>per_frame_audio_samples = 1024 in my case.</p>\n"}], "owner": {"reputation": 422, "user_id": 613253, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/wnDxZ.png?s=128&g=1", "display_name": "Mockarutan", "link": "https://stackoverflow.com/users/613253/mockarutan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 41495699, "answer_count": 1, "score": -1, "last_activity_date": 1483654579, "creation_date": 1482360746, "question_id": 41273273, "link": "https://stackoverflow.com/questions/41273273/aac-encoding-with-ffmpeg-result-in-super-short-file", "title": "aac encoding with ffmpeg result in super short file", "body": "<p>So I'm having problem with AAC encoding. I'm trying to encode some synthetic sound waves, but it does not work as expected. The file I get gives just a super short sound when played in VLC. When I play is in ffplay is plays like I expect, but it says \"duration: 00:00:00.05\" which I suppose says 5 ms. But I encode a lot more than that, and it played more. So VLC plays a super short sound, ffplay plays a longer file (the expected length), but displays it with super short duration, what's going on?</p>\n\n<p>Source: <a href=\"http://pastebin.com/M5MKkEL3\" rel=\"nofollow noreferrer\">http://pastebin.com/M5MKkEL3</a></p>\n\n<p>One of the things that looks wrong to me is this:\nIf you look for the variable \"audio_time\", if you breakpoint it and read it every encode frame, you will get this:</p>\n\n<p>..<br />\nEncode frame 8: 0.00010416666666666666<br />\nEncode frame 9: 0.00012500000000000000<br />\n(and so on)</p>\n\n<p>The diff is: ~0.00002085, which is a 1/1000 of a the diff I expected from ~47 samples frames per second, which is what the encoder wants with 48k sample rate (48k / 1024 = ~47).</p>\n\n<p>So why do I get a thousand of the expected data encoded?</p>\n\n<p>Feel free to point anything suspicious out!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 8, "creation_date": 1482360234, "post_id": 41273149, "comment_id": 69747781, "body": "Simply <code>sscanf(string + n, ...)</code> instead of <code>sscanf(string, ...)</code>, where <code>n</code> is the desired start position."}, {"owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "reply_to_user": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1482360561, "post_id": 41273149, "comment_id": 69747901, "body": "I don&#39;t have <code>n</code>, @MichaelWalz. I want the new call to sscanf() start from where the previous call finished."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1482360594, "post_id": 41273149, "comment_id": 69747910, "body": "So why didn&#39;t you ask for this in your question ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482360612, "post_id": 41273149, "comment_id": 69747919, "body": "Remember that  <code>n &lt;= strlen(string)</code> in the above <a href=\"http://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte#comment69747781_41273149\">good comment</a> must be true"}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1482362637, "post_id": 41273149, "comment_id": 69748601, "body": "@Arham - what do you have so far.  Please add some code or examples of what you are trying to parse.  It&#39;ll make the question easier to answer and allow others to come up with possibly better options.  scanf is not always the best approach."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1482363939, "post_id": 41273149, "comment_id": 69748944, "body": "oops yes, I was confused. <code>%n</code> is the way to go... [deleted comment]"}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 0, "last_activity_date": 1482361750, "last_edit_date": 1482361750, "creation_date": 1482360560, "answer_id": 41273230, "question_id": 41273149, "link": "https://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte/41273230#41273230", "title": "Is there a version of sscanf() that doesn&#39;t start from the first byte?", "body": "<blockquote>\n  <p>Is there any function (standard or non-standard) for this purpose?</p>\n</blockquote>\n\n<p>No, there isn't. You'll have to track how much to offset from your string and use it when calling <code>sscanf</code>.</p>\n\n<pre><code>sscanf(string + offset, ...);\n</code></pre>\n\n<p>To keep track of the offset, you can use the <code>%n</code> format specifier to let <code>sscanf</code> tell you how many characters it consumed.</p>\n\n<pre><code>int offset = 0;\nint n = 0;\nsscanf(string + offset, \"....%n\", ... &amp;n);\noffset += n;\n\n...\n\nsscanf(string + offset, \"....%n\", ... &amp;n);\noffset += n;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482361759, "post_id": 41273231, "comment_id": 69748352, "body": "A variant of <code>sscanf()</code> could have an internal static variable, similar to the way <code>strtok()</code> works."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 0, "last_activity_date": 1482360565, "creation_date": 1482360565, "answer_id": 41273231, "question_id": 41273149, "link": "https://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte/41273231#41273231", "title": "Is there a version of sscanf() that doesn&#39;t start from the first byte?", "body": "<p>C strings don't have a concept of current access position, except as you provide externally.  There cannot, therefore, be any variant of <code>sscanf()</code> that takes an inherent current access position into account.  In principle, there could be a variant that accepts a starting position as an additional argument, but that would be superfluous because, as @MichaelWalz observes, you can use routine pointer arithmetic to do that with <code>sscanf()</code> itself.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482361376, "post_id": 41273330, "comment_id": 69748220, "body": "Consider <code>if (sscanf(string, &quot;%d%dXYZ%n&quot;, &amp;x, &amp;y, &amp;length) == 2)</code>.  This approach does not work as <code>length</code> may not be set."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482361663, "post_id": 41273330, "comment_id": 69748320, "body": "@chux If the conversions don&#39;t all succeed, it probably doesn&#39;t make sense to continue where you left off, so it&#39;s a moot point."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482362449, "post_id": 41273330, "comment_id": 69748547, "body": "@barmar The 2 conversions can succeed with <code>if (sscanf(&quot;123 456&quot;, &quot;%d%dXYZ%n&quot;, &amp;x, &amp;y, &amp;length) == 2)</code>, yet <code>length</code> is not changed and subsequent use can lead to UB.  Testing the return value of <code>sscanf()</code> is not sufficient nor moot when the scan needs to match text after specifiers.  Initializing the <code>length</code> and testing if it changed is sufficient for <code>sscanf()</code>."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482362698, "post_id": 41273330, "comment_id": 69748625, "body": "@chux Doesn&#39;t the return value include the <code>%n</code> variable? So if everything succeeds, it should return <code>3</code>, not <code>2</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482362949, "post_id": 41273330, "comment_id": 69748703, "body": "@Barmar No.  With <code>sscanf(&quot;123 456&quot;, &quot;%d%dXYZ%n&quot;..</code> and <code>sscanf(&quot;123 456XYZ&quot;, &quot;%d%dXYZ%n&quot;...</code> both return 2. The first does not change <code>length</code>.  The 2nd does.   &quot;Execution of a <code>%n</code> directive does not increment the assignment count returned at the completion of execution of the <code>fscanf</code> function.&quot; 11 &#167;7.21.6.2 12 which applies to <code>sscanf()</code>.  Hence the need to initialize and check if <code>length</code> is valid."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 7, "last_activity_date": 1482361579, "last_edit_date": 1482361579, "creation_date": 1482361040, "answer_id": 41273330, "question_id": 41273149, "link": "https://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte/41273330#41273330", "title": "Is there a version of sscanf() that doesn&#39;t start from the first byte?", "body": "<p>In simple cases, you can use the <code>\"%n\"</code> specifier for that, like this</p>\n\n<pre><code>int x, y, length;\nif (sscanf(string, \"%d%d%n\", &amp;x, &amp;y, &amp;length) == 2) ...\n</code></pre>\n\n<p>Now <code>length</code> will have the \"<em>position</em>\" into the string so you can continue from there the next time</p>\n\n<pre><code>if (sscanf(string + length, \"%d%d%n\", &amp;x, &amp;y, &amp;length) == 2) ...\n</code></pre>\n\n<p>In more complex cases you might need more than just <code>sscanf()</code>, or depending on the platform you are on you have <a href=\"http://man7.org/linux/man-pages/man3/fmemopen.3.html\" rel=\"noreferrer\">fmemopen(3)</a> so you can use <code>fscanf()</code> while having a string like you wish and interact with it as if it was a file.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1482363980, "last_edit_date": 1482363980, "creation_date": 1482361239, "answer_id": 41273367, "question_id": 41273149, "link": "https://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte/41273367#41273367", "title": "Is there a version of sscanf() that doesn&#39;t start from the first byte?", "body": "<p>Using <code>\"%n</code> is the usual way to handle scanning a string from where a previous partial scan finished as <code>\"%n\"</code> records the offset of the scanning up to that point.  </p>\n\n<p>Append that to the end of the format and test if the index value changed from -1.  This works for simple and complex formats.</p>\n\n<pre><code>int scanf_buffer_2_step(const char * buffer) {\n  int i;\n  double d;\n\n  // Initialize to a value that a successful scan would never use.\n  int n = -1;\n\n  // append                vv       vv\n  sscanf(buffer, \"Index:%d,%n\", &amp;i, &amp;n);\n\n  // Test for success\n  if (n &lt; 0) return 1; // fail\n\n  // Advance pointer to next string position\n  buffer += n; \n\n  // Do it some more    \n  n = -1;\n  sscanf(buffer, \" Data:%lf End of the line %n\", &amp;d, &amp;n);\n  if (n &lt; 0) return 1; // fail\n  buffer += n; // Advance pointer to next string position\n\n  if (buffer[0] != '\\0') return 1; // fail (extra data)\n\n  printf(\"(%i %f)\", i, d);\n  return 0;\n}\n\nint main(void) {\n  printf(\"%d\\n\", scanf_buffer_2_step(\"Index:1, Data:123.456 End of the line\"));\n  printf(\"%d\\n\", scanf_buffer_2_step(\"Index:1, Data:123.456 End of the line extra\"));\n  printf(\"%d\\n\", scanf_buffer_2_step(\"Index:1,\"));\n  return 0;\n}\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>(1 123.456000)0\n1\n1\n</code></pre>\n\n<hr>\n\n<p>For the final scanning, consider appending <code>\" %n\"</code> if white-space, like a <code>'\\n'</code> is allowed at the end of the string.</p>\n\n<p>For <code>fscanf()</code>, additionally issues occur like checking the return value for <code>EOF</code>.</p>\n"}], "owner": {"reputation": 388, "user_id": 7327855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86effa5599d1be976fbd2ce27a93945?s=128&d=identicon&r=PG", "display_name": "apadana", "link": "https://stackoverflow.com/users/7327855/apadana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1170, "favorite_count": 0, "accepted_answer_id": 41273330, "answer_count": 4, "score": 0, "last_activity_date": 1482363980, "creation_date": 1482360149, "last_edit_date": 1482361960, "question_id": 41273149, "link": "https://stackoverflow.com/questions/41273149/is-there-a-version-of-sscanf-that-doesnt-start-from-the-first-byte", "title": "Is there a version of sscanf() that doesn&#39;t start from the first byte?", "body": "<p>In C, <code>fscanf()</code> doesn't necessarily read a file from its first byte; It reads the file from its current <em>access position</em>. I need a version of <code>sscanf()</code> that does the same with strings. Is there any function (standard or non-standard) for this purpose?</p>\n\n<p>Update: It seems that I haven't asked the question quite well. I don't know the numeric value of the place/offset where this kind of <code>sscanf()</code> should start reading from; I want it to read from where the previous call to it finished. Thanks.</p>\n"}, {"tags": ["c", "linux", "32-bit", "format-string"], "comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1482359781, "post_id": 41273046, "comment_id": 69747607, "body": "Probably none, it would typically use a register"}, {"owner": {"reputation": 1201, "user_id": 5617858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c164765e31d5deae3a0a3fa63ad99?s=128&d=identicon&r=PG&f=1", "display_name": "mik1904", "link": "https://stackoverflow.com/users/5617858/mik1904"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1482360159, "post_id": 41273046, "comment_id": 69747747, "body": "What do you mean?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 5, "creation_date": 1482360184, "post_id": 41273046, "comment_id": 69747757, "body": "C knows nothing about stacks.  (Indeed, <code>register</code> keyword notwithstanding, it knows nothing about registers, either.)  Your code exhibits undefined behavior because there are insufficient arguments for the format.  Anything could happen.  You can study the behavior of a particular version of a particular implementation, but you cannot generalize that.  And as for me, I don&#39;t find studying manifestations of undefined behavior very intersting."}, {"owner": {"reputation": 1201, "user_id": 5617858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c164765e31d5deae3a0a3fa63ad99?s=128&d=identicon&r=PG&f=1", "display_name": "mik1904", "link": "https://stackoverflow.com/users/5617858/mik1904"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482360521, "post_id": 41273046, "comment_id": 69747888, "body": "@JohnBollinger I&#39;m doing an system security course on my 2nd of my MSc and we are looking at format string vulnerability and in this case using %x it actually prints 4 bytes from the stack"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 5, "creation_date": 1482360546, "post_id": 41273046, "comment_id": 69747894, "body": "Typically the first few arguments are passed in <a href=\"https://en.wikipedia.org/wiki/Processor_register\" rel=\"nofollow noreferrer\">registers</a>, not the stack"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1482360621, "post_id": 41273046, "comment_id": 69747923, "body": "From the manual:: <code>o, u, x, X               The unsigned int argument is converted to  unsigned  octal  (o),               unsigned  decimal  (u),  or unsigned hexadecimal (x and X) </code> --- so %x expects an unsigned int."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482360895, "post_id": 41273046, "comment_id": 69748028, "body": "@mik1904, maybe in your case it does print 4 bytes from the stack, and in that case I guess you have then answered your own question.  Anyway, if you want to pose a question about a particular C implementation then it is incumbent on you to <i>specify the implementation</i>.  I&#39;ll not help you with such a question, but perhaps someone else will."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1482360952, "post_id": 41273046, "comment_id": 69748043, "body": "@M.M Does it typically use registers for variadic functions like <code>printf</code>?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482361151, "post_id": 41273046, "comment_id": 69748117, "body": "@Barmar Yes, <a href=\"http://stackoverflow.com/questions/20301201/calling-printf-from-inline-asm-x64\">see here for example</a>"}, {"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "edited": false, "score": 1, "creation_date": 1482363390, "post_id": 41273046, "comment_id": 69748814, "body": "The OP specifies 32-bit Linux.  It doesn&#39;t specify a processor architecture, but doesn&#39;t Linux on ia32 typically use cdecl, in which all parameters are passed on the stack?"}, {"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 3, "creation_date": 1482364120, "post_id": 41273046, "comment_id": 69748995, "body": "@JohnBollinger: For one who is studying software security, the manifestations of undefined behaviour are <i>very</i> interesting.  If one wants to abuse a software bug to get RCE, or if one wants to implement a migitation that makes it more difficult to do so, then one needs to understand what actually happens on various platforms when undefined behaviour is invoked.  However, you are correct that the OP should have been more precise about what platform it is using.  Since it it outside of the semantics of C, this sort of question might be more appropriate on <a href=\"https://security.stackexchange.com\">security.stackexchange.com</a>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "edited": false, "score": 0, "creation_date": 1482366532, "post_id": 41273046, "comment_id": 69749594, "body": "@user3553031: &quot;32 bit Linux&quot; covers many very different architectures already. Including: x86, multiple ARM-versions, PPC, MIPS, SuperH to state the most common. All have very different ABIs, the RISC often use registers for the first arguments. The question is far too broad."}], "answers": [{"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 2, "last_activity_date": 1482368655, "creation_date": 1482368655, "answer_id": 41274331, "question_id": 41273046, "link": "https://stackoverflow.com/questions/41273046/c-format-string-vulnerability-how-many-bytes-does-x-read-from-the-stack/41274331#41274331", "title": "C format string vulnerability: How many bytes does %x read from the stack?", "body": "<p>As far as the C standard is concerned, the question is not meaningful.</p>\n\n<p>A <code>%x</code> format specifier requires a corresponding argument of type <code>unsigned int</code>. (<code>unsigned int</code> and <code>int</code> are more or less interchangeable as arguments, as long as the value is within the representable range of both types.)  The standard doesn't explicitly say so, but it doesn't define the behavior.</p>\n\n<p><em>If</em> a particular compiler generates code that passes <code>unsigned int</code> arguments to variadic functions on the <em>stack</em> (a term the C standard doesn't use), then <code>printf</code> might read <code>sizeof (unsigned int)</code> bytes from the stack for each <code>%x</code> specifier. On other implementations, it might attempt to read arguments from registers, or from somewhere else. Also, <code>sizeof (unsigned int)</code> can vary from one implementation to another. In principle, it could even vary with compile-time optimization levels.</p>\n\n<p>If you want to know about how something like <code>printf(\"%x\")</code> will actually behave, you'll need to specify the particular implementation you're using, both the target OS and hardware and the compiler you're using. \"32-bit Linux\" is not nearly specific enough. Since C implementations are not required to document this, it might be difficult to get the details.</p>\n"}], "owner": {"reputation": 1201, "user_id": 5617858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/669c164765e31d5deae3a0a3fa63ad99?s=128&d=identicon&r=PG&f=1", "display_name": "mik1904", "link": "https://stackoverflow.com/users/5617858/mik1904"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "closed_date": 1482401770, "answer_count": 1, "score": -2, "last_activity_date": 1482395542, "creation_date": 1482359640, "last_edit_date": 1482395542, "question_id": 41273046, "link": "https://stackoverflow.com/questions/41273046/c-format-string-vulnerability-how-many-bytes-does-x-read-from-the-stack", "closed_reason": "Not suitable for this site", "title": "C format string vulnerability: How many bytes does %x read from the stack?", "body": "<p>my doubt is the following:\nassuming Ubuntu 14.04 32bit and x_86 intel atom cpu how many bytes does the format %x read from stack?\nI know that I can read what's in the stack by using:</p>\n\n<pre><code>formatstring=\"%x\";\nprintf(formatstring);\n</code></pre>\n\n<p>As I put more <code>%x</code> in the formatstring, more data are read from the stack.\nSince <code>%x</code> takes <code>4 bytes</code>, every <code>%x</code> should read <code>4 bytes</code> from the stack, so for example if the 1st <code>%x</code> read what's written at the address <code>0x0</code> the <code>2nd</code> will read what's at address <code>0x4</code> and so on.. (obviously the numbers are just for me to make the explanation easier). Is this assumption correct? It seems not since when I tried in an exercise to calculate the address of a var doing  <code>known_address + (numberof %x untill_the_var_value_is_printed )* 4</code> I found a wrong address.</p>\n"}, {"tags": ["c", "terminal", "scanf", "fgets"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1482361070, "post_id": 41273016, "comment_id": 69748082, "body": "You could call <code>fgets()</code> in a loop, concatenating the input to the result string."}], "answers": [{"comments": [{"owner": {"reputation": 1017, "user_id": 2945973, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/KamaT.jpg?s=128&g=1", "display_name": "dbconfession", "link": "https://stackoverflow.com/users/2945973/dbconfession"}, "edited": false, "score": 0, "creation_date": 1482360948, "post_id": 41273111, "comment_id": 69748041, "body": "Perfect! Thank you. So in general should a <code>getchar()</code> loop be used when accepting terminal input?  What scenarios then are <code>fgets()</code> and/or <code>scanf()</code> better used for?"}, {"owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "reply_to_user": {"reputation": 1017, "user_id": 2945973, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/KamaT.jpg?s=128&g=1", "display_name": "dbconfession", "link": "https://stackoverflow.com/users/2945973/dbconfession"}, "edited": false, "score": 0, "creation_date": 1482361681, "post_id": 41273111, "comment_id": 69748323, "body": "<code>scanf</code> is for formatted input (int, double, etc.), <code>fgets</code> is for line input, <code>getchar</code> is for simple character input. Usually <code>scanf</code>, <code>fgets</code> are superior, but <code>getchar</code> has its own use cases"}, {"owner": {"reputation": 1017, "user_id": 2945973, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/KamaT.jpg?s=128&g=1", "display_name": "dbconfession", "link": "https://stackoverflow.com/users/2945973/dbconfession"}, "edited": false, "score": 0, "creation_date": 1482364441, "post_id": 41273111, "comment_id": 69749065, "body": "So in general, if I want to take line input, I&#39;m using <code>fgets()</code>. I&#39;d only use <code>scanf()</code> is there are any formatted input (numbers, decimal numbers etc) correct?"}, {"owner": {"reputation": 172529, "user_id": 140750, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4c7af12cad08c95bc206a9636d164224?s=128&d=identicon&r=PG", "display_name": "William Pursell", "link": "https://stackoverflow.com/users/140750/william-pursell"}, "edited": false, "score": 0, "creation_date": 1482365495, "post_id": 41273111, "comment_id": 69749339, "body": "You should only use <code>scanf</code> if you are in a university course learning how to use <code>scanf</code>.  It has no place in production code."}, {"owner": {"reputation": 1017, "user_id": 2945973, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/KamaT.jpg?s=128&g=1", "display_name": "dbconfession", "link": "https://stackoverflow.com/users/2945973/dbconfession"}, "edited": false, "score": 0, "creation_date": 1482445649, "post_id": 41273111, "comment_id": 69787900, "body": "Is <code>getline()</code> relatively new? The Keringhan+Ritchie C book has an example that creates a function called getline(). The book includes the <code>stdio.h</code> library, which is where <code>getline()</code> is. I can only create my own <code>getline()</code> function if i remove the <code>stdio.h</code> library. I&#39;m assuming the example is out-dated?"}], "tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": true, "score": 4, "last_activity_date": 1482364449, "last_edit_date": 1482364449, "creation_date": 1482359965, "answer_id": 41273111, "question_id": 41273016, "link": "https://stackoverflow.com/questions/41273016/c-when-executing-c-file-in-terminal-how-can-i-add-line-break-to-input-when-prom/41273111#41273111", "title": "C When executing C file in terminal, how can I add line break to input when prompted by fgets() or scanf()?", "body": "<p>Usually that can't be done with <code>fgets</code> and <code>scanf</code>, but you can use <code>getchar</code> instead:</p>\n\n<pre><code>int ch;\nint idx = 0;\nwhile( ( (ch = getchar()) != EOF ) &amp;&amp; idx &lt; MAX_BYTES)\n{\n    string[idx++] = ch;\n}\nprintf(\"%s\", string);\n</code></pre>\n\n<p>Note <code>getchar</code> will accept any input including <code>\\n</code> and the <code>while</code> loop terminates when <code>EOF</code> ie <kbd>Ctrl+D</kbd> from <code>stdin</code>. You then copy each character to the buffer accordingly.</p>\n"}], "owner": {"reputation": 1017, "user_id": 2945973, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/KamaT.jpg?s=128&g=1", "display_name": "dbconfession", "link": "https://stackoverflow.com/users/2945973/dbconfession"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 41273111, "answer_count": 1, "score": 2, "last_activity_date": 1482364449, "creation_date": 1482359518, "question_id": 41273016, "link": "https://stackoverflow.com/questions/41273016/c-when-executing-c-file-in-terminal-how-can-i-add-line-break-to-input-when-prom", "title": "C When executing C file in terminal, how can I add line break to input when prompted by fgets() or scanf()?", "body": "<p><strong>Scenario 1</strong></p>\n\n<pre><code>char string[MAX_BYTES] = \"This is a string\\nthat I'm using\\nfor scenario 1\";\n</code></pre>\n\n<p><strong>Scenario 2</strong></p>\n\n<pre><code>printf(\"Enter string: \");\nfgets(string, MAX_BYTES, stdin);\n</code></pre>\n\n<p>If I provide the string in-code (scen. 1), I can line break with '<code>\\n'</code>.</p>\n\n<p>But if prompting in terminal with <code>fgets()</code> or <code>scanf()</code> (scen. 2), pressing <code>enter</code> continues the execution of code.  </p>\n\n<p>How can I add a line break to input without triggering the rest of the code?</p>\n"}, {"tags": ["c", "cmake", "raspberry-pi", "cross-compiling", "libusb-1.0"], "comments": [{"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482370349, "post_id": 41272450, "comment_id": 69750483, "body": "<code>apt-get install libusb1.0-dev</code>. Looking into output closer, the auto tools are using <code>pkg-config</code> to determine path of the header. Your system has no development library installed. The rest is your home work."}, {"owner": {"reputation": 3, "user_id": 7327602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fd9a5330c44ddf3e682332e95d485f?s=128&d=identicon&r=PG&f=1", "display_name": "Unknownymous", "link": "https://stackoverflow.com/users/7327602/unknownymous"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482388829, "post_id": 41272450, "comment_id": 69755740, "body": "@0andriy libusb1.0-dev is already installed (both in the host and the faked rootfs). Sorry, I thought it was clear from the fact that both libusb1.0a and libusb1.0/libusb.h are there."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482394148, "post_id": 41272450, "comment_id": 69758335, "body": "You comment adjusting <code>CMAKE_CFLAGS</code> for search headers under <code>&#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;usr&#47;include</code>. So compiler doesn&#39;t search there. Also, as <code>&#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;</code> is actually a sysroot (isn&#39;t it?), tell that to CMake <b>directly</b>: <code>set(CMAKE_SYSROOT &quot;&#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;&quot;)</code>. With that CMake will automatically add appropriate options for compiler and linker, and will automatically treat this path as <i>CMAKE_FIND_ROOT_PATH</i>."}, {"owner": {"reputation": 3, "user_id": 7327602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fd9a5330c44ddf3e682332e95d485f?s=128&d=identicon&r=PG&f=1", "display_name": "Unknownymous", "link": "https://stackoverflow.com/users/7327602/unknownymous"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482403969, "post_id": 41272450, "comment_id": 69764395, "body": "Thanks @tsyvarev. The line is commented out because it was one of the things I tried to make it work, but it makes no difference. I just tried the <code>CMAKE_SYSROOT</code> suggestion and unfortunately it makes no difference either... :("}, {"owner": {"reputation": 5817, "user_id": 4742108, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/GvE0m.jpg?s=128&g=1", "display_name": "Velkan", "link": "https://stackoverflow.com/users/4742108/velkan"}, "edited": false, "score": 0, "creation_date": 1482407687, "post_id": 41272450, "comment_id": 69766772, "body": "See what&#39;s passed to the compiler with <code>make VERBOSE=1</code>."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482408422, "post_id": 41272450, "comment_id": 69767249, "body": "That could be a problem: message <code>- Includes: &#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;usr&#47;include&#47;libusb-1.0</code> for <i>libusb</i> means that header is <b>expected</b> to be included as <code>#include &lt;libusb.h&gt;</code>. And this path should be added into header&#39;s search path. But error message tells, that the header is <b>actually</b> included as <code>#include &lt;libusb-1.0&#47;libusb.h&gt;</code>. As workaround you may try to edit CMake cache and replace path <code>&#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;usr&#47;include&#47;libusb-1.0</code> with <code>&#47;home&#47;unknown&#47;rpi&#47;rootfs&#47;usr&#47;include</code>. You need to reconfigure the project (run <code>cmake</code>) after that modification."}, {"owner": {"reputation": 3, "user_id": 7327602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fd9a5330c44ddf3e682332e95d485f?s=128&d=identicon&r=PG&f=1", "display_name": "Unknownymous", "link": "https://stackoverflow.com/users/7327602/unknownymous"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482473684, "post_id": 41272450, "comment_id": 69794780, "body": "Thanks @Tsyvarev, yes, I didn&#39;t realize that! I&#39;m wondering why find_package works differently when cross compiling. I did a <i>dirty</i> workaround, as I need to both build the project for the PC and the Raspberry Pi."}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 0, "last_activity_date": 1482478381, "creation_date": 1482478381, "answer_id": 41297095, "question_id": 41272450, "link": "https://stackoverflow.com/questions/41272450/c-cross-compile-for-raspberry-pi-with-cmake-fails-to-find-header-file/41297095#41297095", "title": "C cross compile for raspberry pi with cmake fails to find header file", "body": "<h2>Problem</h2>\n\n<p>From the <code>cmake --trace</code> output one can see, that <code>Findlibusb-1.0.cmake</code> script, which search <em>libusb-1.0</em> library, detects include directory for the library's headers via </p>\n\n<pre><code>find_path(LIBUSB_1_INCLUDE_DIR NAMES libusb.h ...)\n</code></pre>\n\n<p>This means, that the script <strong>expects</strong> <code>libusb.h</code> header to be included as</p>\n\n<pre><code>#include &lt;libusb.h&gt;\n</code></pre>\n\n<p>(The same conclusion can be deduced from the output of <code>cmake</code> call: line </p>\n\n<pre><code>- Includes: /home/unknown/rpi/rootfs/usr/include/libusb-1.0\n</code></pre>\n\n<p>already includes <code>libusb-1.0</code> suffix for the include path.)</p>\n\n<p>But error message shows, that <code>cm.c</code> file <strong>actually includes</strong> the header as</p>\n\n<pre><code>#include &lt;libusb-1.0/libusb.h&gt;\n</code></pre>\n\n<p>This means, that <code>Findlibusb-1.0.cmake</code> script you use (which is shipped with CMake itself) <strong>is not compatible</strong> with actual usage of the library in you project.</p>\n\n<h2>Ideal solution</h2>\n\n<p>You need to ship your project with <em>compatible</em> <code>Findlibusb-1.0.cmake</code> script, which uses</p>\n\n<pre><code>find_path(LIBUSB_1_INCLUDE_DIR NAMES libusb-1.0/libusb.h ...)\n</code></pre>\n\n<p>for detect include path. E.g., the <a href=\"https://github.com/otherlab/pcl/blob/master/cmake/Modules/Findlibusb-1.0.cmake\" rel=\"nofollow noreferrer\">one</a> from PCL library. (At the beginning of your project's <code>CMakeLists.txt</code> you need to adjust <code>CMAKE_MODULE_PATH</code> variable for find the script.)</p>\n\n<h2>As fast workaround</h2>\n\n<p>You may replace path <code>/home/unknown/rpi/rootfs/usr/include/libusb-1.0</code> with <code>/home/unknown/rpi/rootfs/usr/include</code> in the CMake cache. (After modification of the cache you need to rerun <code>cmake</code>).</p>\n\n<p>Because cached value is likely used in <code>include_directories()</code> call from your project, proper directory will be used instead. </p>\n\n<hr>\n\n<blockquote>\n  <p>I'm wondering why find_package works differently when cross compiling.</p>\n</blockquote>\n\n<p>More likely that <code>find_package</code> works identical on PC and when cross-compiling, but on PC you get path <code>/usr/include</code> being included by other means (e.g., it is included by default).</p>\n"}], "owner": {"reputation": 3, "user_id": 7327602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71fd9a5330c44ddf3e682332e95d485f?s=128&d=identicon&r=PG&f=1", "display_name": "Unknownymous", "link": "https://stackoverflow.com/users/7327602/unknownymous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1548, "favorite_count": 0, "accepted_answer_id": 41297095, "answer_count": 1, "score": 0, "last_activity_date": 1482478381, "creation_date": 1482356896, "last_edit_date": 1482453343, "question_id": 41272450, "link": "https://stackoverflow.com/questions/41272450/c-cross-compile-for-raspberry-pi-with-cmake-fails-to-find-header-file", "title": "C cross compile for raspberry pi with cmake fails to find header file", "body": "<p>I'm trying to port a program that runs fine in x86 architecture (<a href=\"http://en.wikipedia.org/wiki/Linux_Mint\" rel=\"nofollow noreferrer\">Linux Mint</a> 17.1) to a Raspberry Pi (Raspbian Jessie Lite). I'm using <a href=\"http://en.wikipedia.org/wiki/CMake\" rel=\"nofollow noreferrer\">CMake</a>, so I just followed the nice guide in <a href=\"http://amgaera.github.io/blog/2014/04/10/cross-compiling-for-raspberry-pi-on-64-bit-linux/\" rel=\"nofollow noreferrer\">Crafty Bytes</a>.</p>\n\n<p>My toolchain-raspberrypi.cmake looks like this:</p>\n\n<pre><code>SET(CMAKE_SYSTEM_NAME Linux)\nSET(CMAKE_SYSTEM_VERSION 1)\n\n# Specify the cross compiler\nSET(CMAKE_C_COMPILER $ENV{HOME}/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/arm-linux-gnueabihf-gcc)\n\n#SET(CMAKE_C_FLAGS \"-L$ENV{HOME}/rpi/rootfs/usr/lib/arm-linux-gnueabihf -I$ENV{HOME}$ENV{HOME}/rpi/rootfs/usr/include\")\n\n# Where is the target environment\nSET(CMAKE_FIND_ROOT_PATH $ENV{HOME}/rpi/rootfs)\nSET(CMAKE_EXE_LINKER_FLAGS \"${CMAKE_EXE_LINKER_FLAGS} --sysroot=${CMAKE_FIND_ROOT_PATH}\")\nSET(CMAKE_SHARED_LINKER_FLAGS \"${CMAKE_SHARED_LINKER_FLAGS} --sysroot=${CMAKE_FIND_ROOT_PATH}\")\nSET(CMAKE_MODULE_LINKER_FLAGS \"${CMAKE_MODULE_LINKER_FLAGS} --sysroot=${CMAKE_FIND_ROOT_PATH}\")\n\n# Search for programs only in the build host directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_PROGRAM NEVER)\n\n# Search for libraries and headers only in the target directories\nSET(CMAKE_FIND_ROOT_PATH_MODE_LIBRARY ONLY)\nSET(CMAKE_FIND_ROOT_PATH_MODE_INCLUDE ONLY)\n</code></pre>\n\n<p>CMake generates the Makefiles and seems to find all the required libraries:</p>\n\n<pre><code>$ cmake -D CMAKE_BUILD_TYPE=Debug -D CMAKE_TOOLCHAIN_FILE=/home/unknown/rpi/toolchain-raspberrypi.cmake ..\n-- The C compiler identification is GNU 4.8.3\n-- Check for working C compiler: /home/unknown/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/arm-linux-gnueabihf-gcc\n-- Check for working C compiler: /home/unknown/rpi/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin/arm-linux-gnueabihf-gcc -- works\n-- Detecting C compiler ABI info\n-- Detecting C compiler ABI info - done\n-- Looking for include file stdlib.h\n-- Looking for include file stdlib.h - found\n-- Looking for sys/types.h\n-- Looking for sys/types.h - found\n-- Looking for stdint.h\n-- Looking for stdint.h - found\n-- Looking for stddef.h\n-- Looking for stddef.h - found\n-- Check size of intmax_t\n-- Check size of intmax_t - done\n-- Check size of uintmax_t\n-- Check size of uintmax_t - done\n-- Check size of pid_t\n-- Check size of pid_t - done\n-- Found Lua51: /home/unknown/rpi/rootfs/usr/lib/arm-linux-gnueabihf/liblua5.1.so;/home/unknown/rpi/rootfs/usr/lib/arm-linux-gnueabihf/libm.so (found version \"5.1.5\")\n-- Luaudio_INCLUDE_DIRS:     /home/unknown/rpi/rootfs/usr/include/lua5.1\n-- LUA_LIBRARIES:         /home/unknown/rpi/rootfs/usr/lib/arm-linux-gnueabihf/liblua5.1.so;/home/unknown/rpi/rootfs/usr/lib/arm-linux-gnueabihf/libm.so\n-- Found libusb-1.0:\n--  - Includes: /home/unknown/rpi/rootfs/usr/include/libusb-1.0\n--  - Libraries: /home/unknown/rpi/rootfs/usr/lib/libusb-1.0.a\n-- Found PkgConfig: /usr/bin/pkg-config (found version \"0.26\")\n-- checking for one of the modules 'check'\n-- Looking for include file pthread.h\n-- Looking for include file pthread.h - found\n-- Looking for pthread_create\n-- Looking for pthread_create - not found\n-- Looking for pthread_create in pthreads\n-- Looking for pthread_create in pthreads - not found\n-- Looking for pthread_create in pthread\n-- Looking for pthread_create in pthread - found\n-- Found Threads: TRUE\n-- Found libusb-1.0:\n--  - Includes: /home/unknown/rpi/rootfs/usr/include/libusb-1.0\n--  - Libraries: /home/unknown/rpi/rootfs/usr/lib/libusb-1.0.a\n-- Configuring done\n-- Generating done\n-- Build files have been written to: /home/unknown/projects/ha/workspace/ha/build-rpi\n</code></pre>\n\n<p>But when I run make I get an error trying to locate a library header:</p>\n\n<pre><code>$ make\nScanning dependencies of target ha\n[  2%] Building C object src/CMakeFiles/ha.dir/log.c.o\n[  5%] Building C object src/CMakeFiles/ha.dir/cm.c.o\n/home/unknown/projects/ha/workspace/ha/src/cm.c:13:31: fatal error: libusb-1.0/libusb.h: No such file or directory\n #include &lt;libusb-1.0/libusb.h&gt;\n                               ^\ncompilation terminated.\nmake[2]: *** [src/CMakeFiles/ha.dir/cm.c.o] Error 1\nmake[1]: *** [src/CMakeFiles/ha.dir/all] Error 2\nmake: *** [all] Error 2\n</code></pre>\n\n<p>I'm totally stuck here. The files are there:</p>\n\n<pre><code>$ ls ~/rpi/rootfs/usr/include/libusb-1.0/ -l\ntotal 72\n-rw-r--r-- 1 unknown unknown 70156 jun 22  2014 libusb.h\n\n$ ls ~/rpi/rootfs/usr/lib/libusb-1.0.a -l\n-rw-r--r-- 1 unknown unknown 109920 jun 22  2014 /home/unknown/rpi/rootfs/usr/lib/libusb-1.0.a\n</code></pre>\n\n<p>And when running CMake with the <code>--trace</code> flag, it seems to find <a href=\"http://en.wikipedia.org/wiki/Libusb\" rel=\"nofollow noreferrer\">libusb</a> related files:</p>\n\n<pre><code>/home/unknown/projectes/ha/workspace/ha/src/CMakeLists.txt(8):  find_package(libusb-1.0 REQUIRED )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(46):  if(LIBUSB_1_LIBRARIES AND LIBUSB_1_INCLUDE_DIRS )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(49):  else(LIBUSB_1_LIBRARIES AND LIBUSB_1_INCLUDE_DIRS )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(50):  find_path(LIBUSB_1_INCLUDE_DIR NAMES libusb.h PATHS /usr/include /usr/local/include /opt/local/include /sw/include PATH_SUFFIXES libusb-1.0 )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(62):  find_library(LIBUSB_1_LIBRARY NAMES usb-1.0 usb PATHS /usr/lib /usr/local/lib /opt/local/lib /sw/lib )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(72):  set(LIBUSB_1_INCLUDE_DIRS ${LIBUSB_1_INCLUDE_DIR} )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(75):  set(LIBUSB_1_LIBRARIES ${LIBUSB_1_LIBRARY} )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(79):  if(LIBUSB_1_INCLUDE_DIRS AND LIBUSB_1_LIBRARIES )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(80):  set(LIBUSB_1_FOUND TRUE )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(83):  if(LIBUSB_1_FOUND )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(84):  if(NOT libusb_1_FIND_QUIETLY )\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(85):  message(STATUS Found libusb-1.0: )\n-- Found libusb-1.0:\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(86):  message(STATUS  - Includes: ${LIBUSB_1_INCLUDE_DIRS} )\n--  - Includes: /home/unknown/rpi/rootfs/usr/include/libusb-1.0\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(87):  message(STATUS  - Libraries: ${LIBUSB_1_LIBRARIES} )\n--  - Libraries: /home/unknown/rpi/rootfs/usr/lib/libusb-1.0.a\n/usr/share/cmake-2.8/Modules/Findlibusb-1.0.cmake(96):  mark_as_advanced(LIBUSB_1_INCLUDE_DIRS LIBUSB_1_LIBRARIES )\n/home/unknown/projectes/ha/workspace/ha/src/CMakeLists.txt(10):  INCLUDE_DIRECTORIES(${LIBUSB_1_INCLUDE_DIRS} )\n</code></pre>\n\n<p>I'm a newcomer to CMake and so far I've not been able to find any helpful entry in this site nor anywhere else regarding this same problem.</p>\n\n<p>Any clue?</p>\n"}, {"tags": ["c", "multithreading", "pthreads", "condition-variable"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482358042, "post_id": 41272325, "comment_id": 69746859, "body": "How is this related to C++?"}, {"owner": {"reputation": 33, "user_id": 6500239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff4fafd8d325870b654fcb460db6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Amnon Nahmias", "link": "https://stackoverflow.com/users/6500239/amnon-nahmias"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482359038, "post_id": 41272325, "comment_id": 69747275, "body": "i removed the tag, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7327839, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6DsxDN2dhUE/AAAAAAAAAAI/AAAAAAAAAa4/mWKBaIrvHwg/photo.jpg?sz=128", "display_name": "Tripnull", "link": "https://stackoverflow.com/users/7327839/tripnull"}, "is_accepted": false, "score": 1, "last_activity_date": 1482358106, "creation_date": 1482358106, "answer_id": 41272739, "question_id": 41272325, "link": "https://stackoverflow.com/questions/41272325/about-the-usage-of-pthread-cond-wait/41272739#41272739", "title": "About the usage of pthread_cond_wait", "body": "<p>I believe this is because threads may be spuriously woken up before the condition is met. Man, talk about \"gotcha's\".</p>\n\n<p>From the Open Group documentation:<br>\n\"Spurious wakeups from the pthread_cond_wait() or pthread_cond_timedwait() functions may occur.\"</p>\n\n<p>Source:<br>\n<a href=\"http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_cond_wait.html\" rel=\"nofollow noreferrer\">http://pubs.opengroup.org/onlinepubs/007908775/xsh/pthread_cond_wait.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482358353, "post_id": 41272745, "comment_id": 69747000, "body": "Spurrious wakeups are part of the reason, but not the whole reason."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482358436, "post_id": 41272745, "comment_id": 69747038, "body": "@JohnBollinger Are you referring to the reasons mentioned here:  <a href=\"http://stackoverflow.com/a/8594644/4756299\">stackoverflow.com/a/8594644/4756299</a> ?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482358608, "post_id": 41272745, "comment_id": 69747110, "body": "I am asserting that &quot;A thread blocked in pthread_cond_wait returns because of a call to signal or broadcast, however after reacquiring the mutex the underlying predicate is found to no longer be true&quot; (quoted from your SO reference) is not properly classified as a &quot;spurrious wakeup&quot;.  Your Wikipedia article seems to agree with me on that detail of terminology."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482358976, "post_id": 41272745, "comment_id": 69747250, "body": "@JohnBollinger To me, that seems too much like a distinction without a difference - <code>pthread_cond_wait()</code> returned, but the predicate condition is <code>false</code>.  I don&#39;t see how the calling code can discern any difference between that and a &quot;true&quot; spurious wakeup."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482359433, "post_id": 41272745, "comment_id": 69747460, "body": "The term &quot;spurrious wakeup&quot; is ordinarily used with a specific meaning much narrower than the one you have used.  Heck, even the quote in your post uses it that way.  If we want to be able to talk about that particular kind of event, then it&#39;s important to not dilute the meaning of the term that specifically refers to it.  More significantly, the <i>other</i> reason for re-checking the condition is much more important in practice, but lumping it in with spurrious wakeups as you have done obscures it."}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 1, "last_activity_date": 1482358140, "last_edit_date": 1495540799, "creation_date": 1482358140, "answer_id": 41272745, "question_id": 41272325, "link": "https://stackoverflow.com/questions/41272325/about-the-usage-of-pthread-cond-wait/41272745#41272745", "title": "About the usage of pthread_cond_wait", "body": "<p>Spurious wakeups.</p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/8594591/why-does-pthread-cond-wait-have-spurious-wakeups\">Why does pthread_cond_wait have spurious wakeups?</a> and also <a href=\"https://en.wikipedia.org/wiki/Spurious_wakeup\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Spurious_wakeup</a>:</p>\n\n<blockquote>\n  <p><strong>Spurious wakeup</strong> describes a complication in the use of condition variables as provided by certain multithreading APIs such as POSIX\n  Threads and the Windows API.</p>\n  \n  <p>Even after a condition variable appears to have been signaled from a\n  waiting thread's point of view, the condition that was awaited may\n  still be false. One of the reasons for this is a spurious wakeup; that\n  is, a thread might be awoken from its waiting state even though no\n  thread signaled the condition variable. For correctness it is\n  necessary, then, to verify that the condition is indeed true after the\n  thread has finished waiting. Because spurious wakeup can happen\n  repeatedly, this is achieved by waiting inside a loop that terminates\n  when the condition is true ...</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1482358728, "last_edit_date": 1482358728, "creation_date": 1482358329, "answer_id": 41272785, "question_id": 41272325, "link": "https://stackoverflow.com/questions/41272325/about-the-usage-of-pthread-cond-wait/41272785#41272785", "title": "About the usage of pthread_cond_wait", "body": "<blockquote>\n  <p>Is there a reason for using a while loop on the condition? why not just use a single if statement?</p>\n</blockquote>\n\n<p>The idea behind condition variables is to suspend thread execution until a given condition is satisfied.  The condition is not built into the variable, however -- it must be provided by the programmer.</p>\n\n<p>If the relevant condition is <em>already</em> satisfied, then there is no need to suspend operation.  The key here, however, is that when the thread resumes, the condition might <em>still</em> not be satisfied, either because something changed between the condition variable being signaled and the thread being able to proceed, or because the thread awoke spurriously (this is allowed to happen, though it rarely does).  The program therefore checks the condition again upon every wakeup to see whether it must resume waiting.</p>\n"}], "owner": {"reputation": 33, "user_id": 6500239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ff4fafd8d325870b654fcb460db6eaf?s=128&d=identicon&r=PG&f=1", "display_name": "Amnon Nahmias", "link": "https://stackoverflow.com/users/6500239/amnon-nahmias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "accepted_answer_id": 41272745, "answer_count": 3, "score": 2, "last_activity_date": 1482359019, "creation_date": 1482356371, "last_edit_date": 1482359019, "question_id": 41272325, "link": "https://stackoverflow.com/questions/41272325/about-the-usage-of-pthread-cond-wait", "title": "About the usage of pthread_cond_wait", "body": "<p>I'm trying to wrap my head around pthread condition variables.\nI've seen some code examples that use pthread_cond_wait and pthread_cond_signal and all of them look like this:</p>\n\n<pre><code>while (condition)\n{\n    // Assume that the mutex is locked before the following call\n    pthread_cond_wait(&amp;cond, &amp;mutex);\n}\n</code></pre>\n\n<p>Is there a reason for using a while loop on the condition? why not just use a single if statement?</p>\n"}, {"tags": ["c++", "c", "makefile", "build", "dependencies"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 0, "creation_date": 1482359270, "post_id": 41272426, "comment_id": 69747372, "body": "make -f Makefile_abc  dep -fMakefile_abc,   same result"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 0, "creation_date": 1482359277, "post_id": 41272426, "comment_id": 69747377, "body": "The why on earth didn&#39;t you mention that you&#39;d tried that?  And are you sure you got the spelling correct?  There was a <code>Makefile_abc</code> and a <code>Makefile_bac</code> in the question at one time.  What error did you get when you tried that?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 1, "creation_date": 1482359305, "post_id": 41272426, "comment_id": 69747390, "body": "The way you need to use it is when you invoke <code>makedepend</code> in the makefile: <code>makedepend -fMakefile_abc main.c</code>.  All your command line did is read the makefile twice."}, {"owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 0, "creation_date": 1482360508, "post_id": 41272426, "comment_id": 69747884, "body": "So, what you are saying is, if I use a standard make file name (Makefile), I can use a target name (dep) in command line.   e.g.,   make dep.      But if I use a non-standard makefile name like Makefile_abc, then I cannot use target name in command line, and I have to use individual source file names in the command line, like main.c.  Is that right."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "reply_to_user": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 1, "creation_date": 1482361159, "post_id": 41272426, "comment_id": 69748122, "body": "@LaeeqKhan there are two different uses of the &#39;-f Makefile_abc&#39; (1) on the make command line to tell make thich makefile to use to find the target dep ; and (2) in the recipe for the dep target to tell makedepend which makefile needs to get the dependencies appended to."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1482366181, "post_id": 41272426, "comment_id": 69749508, "body": "@ComeRaczy: Thanks for the edit while I was offline.  That&#39;s what I intended."}, {"owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1482424608, "post_id": 41272426, "comment_id": 69777861, "body": "@ComeRaczy,   Jonathan Leffler, Thanks for help. So the final command line would be,    make -f Makefile_abc  dep -f Makefile_abc   but this does not work, I get the error &quot;[mM]akefile is not present&quot;. Do you think, I may be doing something wrong.  Also, do you think we can use the option &quot;-f&quot; twice on the command line? How will make or shell know which file to use for reading target, and which one to use for appending dependencies. Just wondering ..."}, {"owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 0, "creation_date": 1482426813, "post_id": 41272426, "comment_id": 69779212, "body": "@JonathanLeffler: Thanks. Just to clarify for others, there is one &quot;-f&quot; flag that will go inside the Makefile_abc along with makeappend command, and, there is another &quot;-f&quot; flag that will go on the command line indicating the makefile to read. In my case, both these &quot;-f&quot; flags specify the same file &quot;Makefile_abc&quot;. Thanks everybody."}, {"owner": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "reply_to_user": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "edited": false, "score": 0, "creation_date": 1482427822, "post_id": 41272426, "comment_id": 69779786, "body": "@LaeeqKhan, now that you have figured it out, you should considering an alternative. makedepend has had its use but in some cases it can become a real pain (e.g. when you forget to run <code>make dep</code>). with any reasonably recent version of gcc (and other compilers) there is a much better solution: <code>-MMD -MP</code>. There are lots of SO posts describing that method, both <a href=\"http://stackoverflow.com/questions/11855386/using-g-with-mmd-in-makefile-to-automatically-generate-dependencies\">how</a> and <a href=\"http://stackoverflow.com/questions/12106141/is-g-mmd-better-than-include-scanning\">why</a>"}, {"owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "reply_to_user": {"reputation": 1552, "user_id": 2362671, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0585760afe78ec9aafe1836b826ed495?s=128&d=identicon&r=PG", "display_name": "Come Raczy", "link": "https://stackoverflow.com/users/2362671/come-raczy"}, "edited": false, "score": 0, "creation_date": 1482433437, "post_id": 41272426, "comment_id": 69782520, "body": "@ComeRaczy: Thanks, will look at those alternatives. Best Regards"}], "tags": [], "owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "is_accepted": false, "score": 1, "last_activity_date": 1482425209, "last_edit_date": 1482425209, "creation_date": 1482356788, "answer_id": 41272426, "question_id": 41272316, "link": "https://stackoverflow.com/questions/41272316/how-to-use-makedepend-in-a-non-standard-makefile-name/41272426#41272426", "title": "How to use makedepend in a non-standard makefile name", "body": "<p>This is a basic 'read the manual' question.</p>\n\n<p>Looking at <a href=\"https://linux.die.net/man/1/makedepend\" rel=\"nofollow noreferrer\">makedepend(1)</a>, you need <code>-fMakefile_abc</code> in the recipe for the target <code>dep</code> (optionally with a space between <code>-f</code> and <code>Makefile_abc</code>):</p>\n\n<pre><code>dep:\n        makedepend -fMakefile_abc main.c\n</code></pre>\n\n<p>To update the dependencies, you'd run:</p>\n\n<pre><code>$ make -f Makefile_abc dep\n</code></pre>\n\n<p>This would cause <code>make</code> to run:</p>\n\n<pre><code>makedepend -fMakefile_abc main.c\n</code></pre>\n\n<p>(Note that the 'standard' \u2014 most common \u2014 name for the target is <code>depend</code> rather than <code>dep</code>, so you'd normally run <code>make -fMakefile_abc depend</code> or, with a plain <code>makefile</code> file, <code>make depend</code>.)</p>\n\n<p>If you're using GNU Make, you might also add another line to <code>Makefile_abc</code>:</p>\n\n<pre><code>.PHONY: dep     # Or depend, depending\u2026\n</code></pre>\n\n<p>This tells <code>make</code> that there won't be a file <code>dep</code> created by the rule.</p>\n\n<p>You can often get information about how to run a command by using <code>makedepend --help</code> or <code>makedepend -:</code> \u2014 the first may (or may not) give a useful help message outlining options, and the second is very unlikely to be a valid option which should generate a 'usage' message that summarizes the options.</p>\n"}], "owner": {"reputation": 147, "user_id": 5419528, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/03be5dd0869252203ae007b990ca1bc9?s=128&d=identicon&r=PG&f=1", "display_name": "Laeeq Khan", "link": "https://stackoverflow.com/users/5419528/laeeq-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482425209, "creation_date": 1482356325, "last_edit_date": 1482356669, "question_id": 41272316, "link": "https://stackoverflow.com/questions/41272316/how-to-use-makedepend-in-a-non-standard-makefile-name", "title": "How to use makedepend in a non-standard makefile name", "body": "<p>I am trying to use <code>makedepend</code> in a makefile named <code>Makefile_abc</code>.\nNormally when I have to build a target <code>trg</code>, I say</p>\n\n<pre><code>make -f Makefile_abc trg\n</code></pre>\n\n<p>and this works beautifully.\nI have added following lines in this makefile.</p>\n\n<pre><code>dep:\n    makedepend  main.c\n</code></pre>\n\n<p>Now, when I do,</p>\n\n<pre><code>make -f Makefile_abc  dep\n</code></pre>\n\n<p>I get the error,</p>\n\n<pre><code>makedepend: error:  [mM]akefile is not present\nmake: *** [depend] Error 1\n</code></pre>\n\n<p>If I rename my makefile as Makefile, then following command works fine,</p>\n\n<pre><code>make depend\n</code></pre>\n\n<p>So, I am looking for a way to use makedepend on non-standard makefile names.</p>\n"}, {"tags": ["c", "compiler-errors"], "comments": [{"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1482355733, "post_id": 41272142, "comment_id": 69745780, "body": "<code>int myrand(){ ... }</code> is a function that returns an <code>int</code>. The compiler is expecting a <code>return</code> statement, like <code>return r;</code> perhaps"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482355733, "post_id": 41272142, "comment_id": 69745781, "body": "The function should return an <code>int</code> value."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482355767, "post_id": 41272142, "comment_id": 69745798, "body": "Congratulations.  Did you have a question to go along with those disclosures?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7327615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ecdc3b15d88994408f4c3512de77c4?s=128&d=identicon&r=PG&f=1", "display_name": "yari", "link": "https://stackoverflow.com/users/7327615/yari"}, "edited": false, "score": 0, "creation_date": 1482356023, "post_id": 41272181, "comment_id": 69745898, "body": "Thank you very much, just saw this error by myself)"}], "tags": [], "owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1482356025, "last_edit_date": 1482356025, "creation_date": 1482355742, "answer_id": 41272181, "question_id": 41272142, "link": "https://stackoverflow.com/questions/41272142/compiler-error-control-reaches-end-of-non-void-function/41272181#41272181", "title": "compiler error: control reaches end of non-void function", "body": "<p>Add a return statement.</p>\n\n<pre><code>int myrand(){\n\n    srand(time(NULL));\n    int r = rand()%2;\n    return r;\n}\n</code></pre>\n\n<p>Without it, the \"random\" value you print doesn't come from <code>rand()</code>, but from the undefined behavior that is omitting the return statement. [Well, technically, depending on architecture, the return value of <code>rand</code> can be propagated in a register]</p>\n\n<p>While the <a href=\"/questions/tagged/c\" class=\"post-tag\" title=\"show questions tagged &#39;c&#39;\" rel=\"tag\">c</a> standard may allow omitting it without demanding a hard error, this is still ill-advised.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 7327615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ecdc3b15d88994408f4c3512de77c4?s=128&d=identicon&r=PG&f=1", "display_name": "yari", "link": "https://stackoverflow.com/users/7327615/yari"}, "edited": false, "score": 0, "creation_date": 1482356041, "post_id": 41272185, "comment_id": 69745910, "body": "thank you, just saw this)"}], "tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482355749, "creation_date": 1482355749, "answer_id": 41272185, "question_id": 41272142, "link": "https://stackoverflow.com/questions/41272142/compiler-error-control-reaches-end-of-non-void-function/41272185#41272185", "title": "compiler error: control reaches end of non-void function", "body": "<p>I found the error after much research and reading through manuals, turns out control reaches end of non-void function.</p>\n\n<pre><code>int myrand(){\n\n    srand(time(NULL));\n    int r = rand()%2;\n    return r; // add this\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7327615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91ecdc3b15d88994408f4c3512de77c4?s=128&d=identicon&r=PG&f=1", "display_name": "yari", "link": "https://stackoverflow.com/users/7327615/yari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 821, "favorite_count": 0, "closed_date": 1482355810, "answer_count": 2, "score": -1, "last_activity_date": 1482356025, "creation_date": 1482355569, "question_id": 41272142, "link": "https://stackoverflow.com/questions/41272142/compiler-error-control-reaches-end-of-non-void-function", "closed_reason": "Duplicate", "title": "compiler error: control reaches end of non-void function", "body": "<p>I have this code and the compiler gives me the next error: </p>\n\n<blockquote>\n  <p>functions.c:12:1: warning: control reaches end of non-void function \n       [-Wreturn-type]\n  }</p>\n</blockquote>\n\n<p>Code: </p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;time.h&gt;\n\nint myrand(){\n\n    srand(time(NULL));\n    int r = rand()%2;\n\n}\n</code></pre>\n\n<p>This function is invoked from another .c file here:</p>\n\n<pre><code>printf(\"%d here \\n\", myrand());\n</code></pre>\n"}, {"tags": ["c", "list", "pointers", "struct", "structure"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482354648, "post_id": 41271942, "comment_id": 69745243, "body": "So you are off by one somewhere."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1482354682, "post_id": 41271942, "comment_id": 69745259, "body": "How is <code>Person</code> defined?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482354763, "post_id": 41271942, "comment_id": 69745301, "body": "Note that in the first pair of <code>printf()</code> calls, you used <code>(*p_list + p1)</code>.  In <code>Person1 = (p_list +  p1);</code> (with its unnecessary parentheses), you don&#39;t have the <code>*</code>, which changes the meaning \u2014 dramatically. If <code>p1</code> is 0, it might work; if it is larger, it most likely won&#39;t."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482354805, "post_id": 41271942, "comment_id": 69745329, "body": "Yeah I guess its an off by one error, but i cant find it... I mean it worked for putting out the names in the first go, so i only want a pointer to the entire struct instead of just the name..."}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 0, "creation_date": 1482354940, "post_id": 41271942, "comment_id": 69745400, "body": "Invoking undefined behavior does not guarantee a crash."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482354973, "post_id": 41271942, "comment_id": 69745417, "body": "And if i set Person1 = (*p_list + p1); it gives me a warning and if i run it, I get that memory violation instantly..."}, {"owner": {"reputation": 5074, "user_id": 5522303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c236ba3d52af53355a4d1a44a5145b04?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/5522303/kevin"}, "edited": false, "score": 0, "creation_date": 1482355731, "post_id": 41271942, "comment_id": 69745777, "body": "because <code>Person1</code> is a <code>Person**</code> (as is <code>p_list + p1</code>) whereas <code>*p_list + p1</code> is a <code>Person*</code>. Ignoring the warning leads to undefined behavior because the types are different. <code>Person1</code> should be a <code>Person*</code> instead."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482356084, "post_id": 41271942, "comment_id": 69745935, "body": "Yeah that worked, thanks!  If I was stupid enough and required the rest of the function that Person1 and Person to are Person** how would i make that work?"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482355812, "post_id": 41272139, "comment_id": 69745814, "body": "Okay, that makes sense... But how to fix it? The suggestion of replacing Person1 = (p_list + p1); with Person1 = (*p_list + p1); doenst work because the compiler tells me those are incompatible pointer types"}, {"owner": {"reputation": 16, "user_id": 4267093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17e3361ddb39b792cd661a13093363b?s=128&d=identicon&r=PG&f=1", "display_name": "ddbc", "link": "https://stackoverflow.com/users/4267093/ddbc"}, "reply_to_user": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482356127, "post_id": 41272139, "comment_id": 69745958, "body": "Indeed they are incompatible. Declare Person1, Person2 as Person* ( not **). Then *p_list is a pointer to a Person and *p_list + p1 points to (hopefully) a valid Person."}, {"owner": {"reputation": 16, "user_id": 4267093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17e3361ddb39b792cd661a13093363b?s=128&d=identicon&r=PG&f=1", "display_name": "ddbc", "link": "https://stackoverflow.com/users/4267093/ddbc"}, "reply_to_user": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482356242, "post_id": 41272139, "comment_id": 69746011, "body": "You&#39;ll need to edit (*Person1)-&gt;name_  to just Person1-&gt;name_ as well."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482356312, "post_id": 41272139, "comment_id": 69746053, "body": "yeah that part seems to work now, thanks. Since all the sub functions require a Person** I should just write example <code>silbings(&amp;Person1, &amp;Person2)</code> ?"}, {"owner": {"reputation": 16, "user_id": 4267093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17e3361ddb39b792cd661a13093363b?s=128&d=identicon&r=PG&f=1", "display_name": "ddbc", "link": "https://stackoverflow.com/users/4267093/ddbc"}, "reply_to_user": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482356443, "post_id": 41272139, "comment_id": 69746110, "body": "Sorry, that is more of a strategy question."}, {"owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "edited": false, "score": 0, "creation_date": 1482358696, "post_id": 41272139, "comment_id": 69747145, "body": "Well it works now, thanks. I still have to fix a few Nullpointer exceptions, but thats managable"}], "tags": [], "owner": {"reputation": 16, "user_id": 4267093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17e3361ddb39b792cd661a13093363b?s=128&d=identicon&r=PG&f=1", "display_name": "ddbc", "link": "https://stackoverflow.com/users/4267093/ddbc"}, "is_accepted": true, "score": 0, "last_activity_date": 1482355564, "creation_date": 1482355564, "answer_id": 41272139, "question_id": 41271942, "link": "https://stackoverflow.com/questions/41271942/list-of-struct-and-pointers/41272139#41272139", "title": "List of struct and pointers", "body": "<p>As written Person1 and Person2 point indiscriminately into memory. Chances are you are getting lucky with the values of p1 and the pointer ends up pointing ( by dumb chance the way the memory lays ) to the other name. The other value of p2 pushes the value of the pointer into an area of memory which you aren't allowed to access.</p>\n"}], "owner": {"reputation": 105, "user_id": 7151570, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Q0nsu.jpg?s=128&g=1", "display_name": "Lucy The Brazen", "link": "https://stackoverflow.com/users/7151570/lucy-the-brazen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 41272139, "answer_count": 1, "score": -1, "last_activity_date": 1482355564, "creation_date": 1482354563, "last_edit_date": 1482355030, "question_id": 41271942, "link": "https://stackoverflow.com/questions/41271942/list-of-struct-and-pointers", "title": "List of struct and pointers", "body": "<p>I have a function which gets a pointer pointer to a person list, and two ints which contain the position of two persons in that list.</p>\n\n<pre><code>int relation(Person **p_list, int p1, int p2)\n{\n\nprintf(\"At \u00dcbergabe: %s\\n\", (*p_list + p1)-&gt;name_); //Prints name person1\nprintf(\"At \u00dcbergabe: %s\\n\", (*p_list + p2)-&gt;name_); //Prints name person2\n\nint relative;\nPerson **Person1;\nPerson **Person2;\n\nPerson1 = (p_list + p1);\nPerson2 = (p_list + p2);\n\nprintf(\"Post \u00dcbergabe: %s\\n\", (*Person1)-&gt;name_); //Prints name person2\nprintf(\"Post \u00dcbergabe: %s\\n\", (*Person2)-&gt;name_); //memory error\n\nreturn PLZ_WORK;\n}\n</code></pre>\n\n<p>And i dont get it... i would get if both would produce a memory error... but i dont get why the first person is now the second one, and the second violates my memory...</p>\n\n<p>Edit:</p>\n\n<pre><code>typedef struct _Person_\n{\nchar name_[MAX_NAME];\nchar sex_;\n}Person;\n</code></pre>\n"}, {"tags": ["c", "binding", "fortran"], "comments": [{"owner": {"reputation": 24099, "user_id": 3157076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mB4zi.png?s=128&g=1", "display_name": "francescalus", "link": "https://stackoverflow.com/users/3157076/francescalus"}, "edited": false, "score": 1, "creation_date": 1482354281, "post_id": 41271552, "comment_id": 69745040, "body": "If you replace <code>module procedure </code> with <code>procedure</code>?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482354289, "post_id": 41271552, "comment_id": 69745043, "body": "Well yes, if the procedure body is not in the (a) module, then it&#39;s not a module procedure.  Putting an interface to the procedure in the module doesn&#39;t change that."}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "edited": false, "score": 0, "creation_date": 1482354847, "post_id": 41271911, "comment_id": 69745353, "body": "I just don&#39;t understand why it works fine with the module keyword (found somewhere on the internet) if I only consider the operator overloading. Seems quite inconsistent, isn&#39;t it ?"}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "reply_to_user": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "edited": false, "score": 0, "creation_date": 1482356056, "post_id": 41271911, "comment_id": 69745917, "body": "@Thomas <code>module procedure</code>  refers only to module procedures, i.e. procedures which are really inside the module. <code>procedure</code> is more general and refers to any procedure for which you have an explicit interface."}, {"owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "edited": false, "score": 1, "creation_date": 1482357798, "post_id": 41271911, "comment_id": 69746752, "body": "Then I shall consider that the fact that the operator overloading was working was indeed a compiler bug, i.e. my compiler is a bit too permissive ?"}, {"owner": {"reputation": 5480, "user_id": 2643582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4109e2c614151bab2fe602ae9a1bc2d7?s=128&d=identicon&r=PG", "display_name": "Steve Lionel", "link": "https://stackoverflow.com/users/2643582/steve-lionel"}, "edited": false, "score": 0, "creation_date": 1482371432, "post_id": 41271911, "comment_id": 69750763, "body": "Possibly. Which compiler and version were you using?"}, {"owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "edited": false, "score": 0, "creation_date": 1482395110, "post_id": 41271911, "comment_id": 69758863, "body": "I am using gfortran 4.9"}], "tags": [], "owner": {"reputation": 5480, "user_id": 2643582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4109e2c614151bab2fe602ae9a1bc2d7?s=128&d=identicon&r=PG", "display_name": "Steve Lionel", "link": "https://stackoverflow.com/users/2643582/steve-lionel"}, "is_accepted": true, "score": 2, "last_activity_date": 1482354390, "creation_date": 1482354390, "answer_id": 41271911, "question_id": 41271552, "link": "https://stackoverflow.com/questions/41271552/fortran-derived-type-constructor-defined-though-c-function/41271911#41271911", "title": "Fortran derived type constructor defined though C function", "body": "<p>An external procedure isn't a module procedure. I think this is what you want:</p>\n\n<pre><code>module my_module\n  use iso_c_binding\n  type, bind(c) :: my_double\n     real(c_double) :: x\n  end type my_double\n\n    interface\n       type(my_double) function my_module_fortran_new_my_double (v) bind ( c )\n         use iso_c_binding\n         import :: my_double\n         real (c_double), intent(in) :: v\n       end function my_module_fortran_new_my_double\n       type(my_double) function my_module_fortran_add (v1,v2) bind ( c )\n         use iso_c_binding\n         import :: my_double\n         type (my_double), intent(in) :: v1,v2\n       end function my_module_fortran_add\n  end interface\n\n  interface my_double\n   procedure my_module_fortran_new_my_double\n  end interface\n  interface operator (+)\n    procedure :: my_module_fortran_add\n  end interface operator (+)\n\nend module my_module\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 41271911, "answer_count": 1, "score": 1, "last_activity_date": 1482355922, "creation_date": 1482352928, "last_edit_date": 1482355922, "question_id": 41271552, "link": "https://stackoverflow.com/questions/41271552/fortran-derived-type-constructor-defined-though-c-function", "title": "Fortran derived type constructor defined though C function", "body": "<p>I want to define a derived type constructor through a C function. In the following example, I managed to defined a overloaded addition operator through a C interface. Altough the syntax is quite similar, the definition of the constructor fails under gfortran 4.9 with the following error:</p>\n\n<pre><code>test.f90:7.52:\n\n    module procedure my_module_fortran_new_my_double\n                                                    1\nError: 'my_module_fortran_new_my_double' at (1) is not a module procedure\n</code></pre>\n\n<p>After some time spend in googling or looking at previous post at stack overflow, I did not find any solution. I would be very pleased if someone could tell me what triggers this error and how to correct it.</p>\n\n<p>Here is the source code of my module:</p>\n\n<pre><code>module my_module\n  use iso_c_binding\n  type, bind(c) :: my_double\n     real(c_double) :: x\n  end type my_double\n  interface my_double\n    module procedure my_module_fortran_new_my_double\n  end interface\n  interface operator (+)\n     module procedure my_module_fortran_add\n  end interface operator (+)\n  interface\n     type(my_double) function my_module_fortran_new_my_double (v) bind ( c )\n       use iso_c_binding\n       import :: my_double\n       real (c_double), intent(in) :: v\n     end function my_module_fortran_new_my_double\n     type(my_double) function my_module_fortran_add (v1,v2) bind ( c )\n       use iso_c_binding\n       import :: my_double\n       type (my_double), intent(in) :: v1,v2\n     end function my_module_fortran_add\n  end interface\nend module my_module\n</code></pre>\n"}, {"tags": ["c", "linked-list"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1482351937, "post_id": 41271277, "comment_id": 69743756, "body": "There are numerous questions about how to reverse the items in a singly-linked list.  Are you sure you can&#39;t find any of them."}, {"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482352074, "post_id": 41271277, "comment_id": 69743830, "body": "Well I have found many ways, and I tried to apply some of them.. The one that looks closest to a solution I think is the one I posted here, but still can&#39;t seem to make it work.. Thanks for the suggestion, and I am still focused on reading here and there to find the solution ! !"}], "answers": [{"comments": [{"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482352490, "post_id": 41271358, "comment_id": 69744096, "body": "Thank you so much, it was just in front of my eyes but couldn&#39;t spot the problem!"}, {"owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "reply_to_user": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482353549, "post_id": 41271358, "comment_id": 69744656, "body": "@baskon1 - of the 16 questions you&#39;ve asked so far on StackOverflow, you&#39;ve only accepted 1 answer. While you are not required to accept an answer, you should make an effort to when an answer resolves the issues you are facing."}, {"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482353718, "post_id": 41271358, "comment_id": 69744755, "body": "Sorry! Will do it from now on! Thanks!"}], "tags": [], "owner": {"reputation": 109324, "user_id": 21926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6e61d47f9a6ec0a7a286835e51f3332?s=128&d=identicon&r=PG", "display_name": "Sean Bright", "link": "https://stackoverflow.com/users/21926/sean-bright"}, "is_accepted": true, "score": 1, "last_activity_date": 1482352034, "creation_date": 1482352034, "answer_id": 41271358, "question_id": 41271277, "link": "https://stackoverflow.com/questions/41271277/reverse-algorithm-for-a-linked-list-in-c/41271358#41271358", "title": "Reverse algorithm for a linked list in C", "body": "<p>This code is obviously wrong, because you're passing <code>NULL</code> to <code>reverselist</code>:</p>\n\n<pre><code>LIST1* head = NULL;\nhead=reverselist(head);\n</code></pre>\n\n<p>I'm guessing that this should be:</p>\n\n<pre><code>current = reverselist(list1);\n</code></pre>\n\n<p>(You don't need the <code>head</code> variable here because you are never using it)</p>\n"}], "owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 41271358, "answer_count": 1, "score": 0, "last_activity_date": 1482352034, "creation_date": 1482351685, "last_edit_date": 1482351985, "question_id": 41271277, "link": "https://stackoverflow.com/questions/41271277/reverse-algorithm-for-a-linked-list-in-c", "title": "Reverse algorithm for a linked list in C", "body": "<p>I am trying to reverse a linked list in c, that I created by copying the data from a structure.</p>\n\n<p>I have created the following function named <code>reverselist</code>, after reading a lot of suggestions about reversing a list, but after applying it, and trying again to print I get nothing printed on my screen. </p>\n\n<p>I don't want to just print the file, but I want the linked list permanently changed. Can someone spot out what is the problem in my code? </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n\nint i,j,temp;\n\ntypedef struct{\n    int nr;\n}PASSENGERS;\n\ntypedef struct list1{\n    int nr;\n    struct list1 *next;\n}LIST1;\n\n\nLIST1* reverselist (LIST1 *head)\n{\n    LIST1 *cursor=NULL;\n    LIST1 *next;\n    while(head){\n        next=head-&gt;next;\n        head-&gt;next=cursor;\n        cursor=head;\n        head=next;\n    }\n    return cursor;\n}\n\nint main()\n{\n    PASSENGERS passenger[53];\n    for (j=0;j&lt;53;j++)\n        passenger[j].nr=j+1;\n\n    PASSENGERS *start=NULL;\n    char selection;\n    do{\n        printf(\"0. Exit and Print File\\n\");\n        scanf(\" %c\",&amp;selection);\n    } while (selection!='0');\n\n    LIST1 *list1, *start=NULL;\n    for (i=0;i&lt;53;i++){\n        list1 = (LIST1 *) malloc (sizeof(LIST1));\n        list1-&gt;next = NULL;\n        list1-&gt;nr = passenger[i].nr;\n\n        if (start ==NULL)\n            start = list1;\n        else //add new node at the beginning of list\n        {\n            list1-&gt;next = start;\n            start = list1;\n        }\n    }\n\n    LIST1 *current = list1;\n    printf(\"The original list is:\");\n    while (current !=NULL) /* Printing the names on the list ok*/\n    {\n        printf(\"%d\\n\",current-&gt;nr);\n        current = current-&gt;next;\n    }\n\n    LIST1* head = NULL;\n    head=reverselist(head);\n\n    printf(\"The reversed list is:\");\n\n    while (current !=NULL){\n        printf(\"%d\\n\",current-&gt;nr);\n        current = current-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "function"], "comments": [{"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "edited": false, "score": 6, "creation_date": 1482349526, "post_id": 41270757, "comment_id": 69742494, "body": "Post what you&#39;ve attempted so far along with the input, expected output, and actual output."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 2, "creation_date": 1482349570, "post_id": 41270757, "comment_id": 69742514, "body": "Of course it is possible to do this very basic thing. Do you know about <code>for</code> loops? Any loop for that matter will do the job."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482349725, "post_id": 41270757, "comment_id": 69742591, "body": "There is no coding reason why a &quot;sentence&quot; has to be output all in one instruction. The outside world won&#39;t know about that, all it will see is a single sentence."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482349897, "post_id": 41270757, "comment_id": 69742689, "body": "Why do you need to print every number? If <code>N</code> is 42000 that will be unwieldy. People can usually understand something like &quot;The range of number is (1 thru 42000).&quot;"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482351041, "post_id": 41270757, "comment_id": 69743291, "body": "Sidenote: <code>()</code> are called parentheses in the standard. <code>[]</code> are called brackets."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482351080, "post_id": 41270757, "comment_id": 69743313, "body": "@Olaf the brackets used in a &quot;sentence&quot;  are not part of the C syntax."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482351151, "post_id": 41270757, "comment_id": 69743358, "body": "C is turing-complete, so of course you can output what you show. That does not mean you can print in with a single output function call. You need to learn the basics of the C language to accomplish this output."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482351242, "post_id": 41270757, "comment_id": 69743400, "body": "@WeatherVane: It is in general a good idea to stick to common nomenclature. This question <b>is</b> about C, is it? (An you might have noticed the &quot;sidenote&quot; intro, which provides additional information, not a correction)."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482351317, "post_id": 41270757, "comment_id": 69743443, "body": "@Olaf the common nomenclature is &quot;brackets&quot;. The language (or high-brow) nomenclature is &quot;parentheses&quot;. You are picking holes where none exist."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482351618, "post_id": 41270757, "comment_id": 69743592, "body": "@WeatherVane: With all due respect, but I prefer the definition of <a href=\"https://www.merriam-webster.com/dictionary/parenthesis\" rel=\"nofollow noreferrer\">Merriam-Webster</a>. Parentheses is unambigous, while brackets has various semantics, this can be missleading. And it is not me picking on a hole which has a &quot;closed&quot; sign on it already. Who is the worse nit-picker? The nit-picker or the one nit-picking on the nit-picker? :-)"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482353706, "post_id": 41270757, "comment_id": 69744748, "body": "The C spec calls <code>()</code> parentheses and <code>[]</code> brackets.  Perhaps &quot;but inside the brackets the variables should be able to change&quot; is better stated as &quot;but inside the <i>parentheses</i> the <i>values</i> should <i>not be fixed, but 1 to <code>N</code></i>&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1482351642, "creation_date": 1482351642, "answer_id": 41271269, "question_id": 41270757, "link": "https://stackoverflow.com/questions/41270757/how-can-i-insert-dynamic-output-inside-printf/41271269#41271269", "title": "How can I insert dynamic output inside printf?", "body": "<p>Most people would just break the output up over multiple <code>printf</code> calls.</p>\n\n<pre><code>printf( \"The range of numbers is (%d\", 1 );\nfor ( int i = 1; i &lt; N; i++ )\n  printf( \", %d\", i+1 );\nputs( \")\" );\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 7286185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2245ec3f6de61e431a6a6a782ca760ea?s=128&d=identicon&r=PG&f=1", "display_name": "BellaconBud", "link": "https://stackoverflow.com/users/7286185/bellaconbud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1482384258, "answer_count": 1, "score": -1, "last_activity_date": 1482351642, "creation_date": 1482349458, "last_edit_date": 1482349883, "question_id": 41270757, "link": "https://stackoverflow.com/questions/41270757/how-can-i-insert-dynamic-output-inside-printf", "closed_reason": "Not suitable for this site", "title": "How can I insert dynamic output inside printf?", "body": "<p>Suppose I have a function that prints all integers from 1 to N , N - user input integer.</p>\n\n<p>This function is of <code>void</code> type: </p>\n\n<pre><code>void number(int integer)\n</code></pre>\n\n<p>So I want to print on the screen : </p>\n\n<blockquote>\n  <p>\"The range of number is (1 2 3 ..... N) \" . </p>\n</blockquote>\n\n<p>As you can see, it is supposed to print only one sentence, but inside the brackets the variables should be able to change, as the user wishes. </p>\n\n<p>I have tried to wrap my head around it, but I just can't get it done, and cannot integrate one into another.</p>\n\n<p>So I'm curious at this point if it's even possible to do it in C at all.</p>\n"}, {"tags": ["c", "atoi", "string-conversion"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1482345785, "post_id": 41269776, "comment_id": 69740419, "body": "use <code>strtol(argv[2], NULL, 8);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 4, "creation_date": 1482346029, "post_id": 41269821, "comment_id": 69740546, "body": "And the third argument is particularly important here, because the conventional representation for numeric modes is octal, whether there is a leading zero or not.  Converting a numeric mode string as if it were expressed in decimal is likely to produce an unintended result."}, {"owner": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "edited": false, "score": 0, "creation_date": 1482348579, "post_id": 41269821, "comment_id": 69741983, "body": "Both mode=strtol(argv[2], NULL, 8) and mode=strtol(argv[2], NULL, 0) are making the number go decimal so if I introduce 0664 they set my mode to 436. How can I fix this?"}, {"owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "reply_to_user": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "edited": false, "score": 0, "creation_date": 1482349175, "post_id": 41269821, "comment_id": 69742315, "body": "@EduardoRamos I just tested this and it works properly.  How are you checking the value?"}, {"owner": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "edited": false, "score": 0, "creation_date": 1482349397, "post_id": 41269821, "comment_id": 69742432, "body": "Yeah, it does work. The printf() fooled me. Thank you so much!"}], "tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 7, "last_activity_date": 1482346134, "last_edit_date": 1482346134, "creation_date": 1482345844, "answer_id": 41269821, "question_id": 41269776, "link": "https://stackoverflow.com/questions/41269776/how-to-convert-a-numeric-string-starting-with-0-to-an-octal-number/41269821#41269821", "title": "How to convert a numeric string starting with 0 to an octal number", "body": "<p>The <code>atoi</code> function assumes the string is the decimal representation of a number.  If you want to convert from different bases, use <code>strtol</code>.</p>\n\n<pre><code>mode = strtol(argv[2], NULL, 0);\n</code></pre>\n\n<p>The third argument specifies the number base.  If this value is 0, it will treat the string as hexadecimal if it starts with <code>0x</code>, octal if it starts with <code>0</code>, and decimal otherwise.</p>\n\n<p>If you expect the string to always be the octal representation, then set the base to 8.</p>\n\n<pre><code>mode = strtol(argv[2], NULL, 8);\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 7256731, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-kqOYXoYkmrM/AAAAAAAAAAI/AAAAAAAAANk/DgRGAEkiRKM/photo.jpg?sz=128", "display_name": "Eduardo Ramos", "link": "https://stackoverflow.com/users/7256731/eduardo-ramos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 476, "favorite_count": 0, "accepted_answer_id": 41269821, "answer_count": 1, "score": 4, "last_activity_date": 1482348035, "creation_date": 1482345669, "last_edit_date": 1482348035, "question_id": 41269776, "link": "https://stackoverflow.com/questions/41269776/how-to-convert-a-numeric-string-starting-with-0-to-an-octal-number", "title": "How to convert a numeric string starting with 0 to an octal number", "body": "<p>I am trying to do this:</p>\n\n<pre><code>void main(int argc, char *argv[]){\nint mode,f;\n\nmode = atoi(argv[2]);\n\nif((f = open(\"fichero.txt\",O_CREAT, mode))==-1){    \n    perror(\"Error\");\n    exit(1);\n}\n\n}\n</code></pre>\n\n<p>However, when I introduce a number like 0664, mode equals 664. How can I keep that leading zero?</p>\n"}, {"tags": ["c", "algorithm", "weighted-average"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1482344924, "post_id": 41269504, "comment_id": 69739906, "body": "<code>aver = (aver + 2 * new_value) &#47; 3;</code>"}, {"owner": {"reputation": 19081, "user_id": 6246044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMZMd.jpg?s=128&g=1", "display_name": "Rory Daulton", "link": "https://stackoverflow.com/users/6246044/rory-daulton"}, "edited": false, "score": 0, "creation_date": 1482344941, "post_id": 41269504, "comment_id": 69739917, "body": "By &quot;twice the weight of all the previous values&quot; do you mean twice as much as the <i>combined</i> weights of all the others or twice as much as the <i>last</i> value?"}, {"owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482347252, "post_id": 41269504, "comment_id": 69741211, "body": "Twice as much as last value."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482347361, "post_id": 41269504, "comment_id": 69741275, "body": "A &quot;running average&quot; would use a filter like in the first comment, or would use a ring buffer and sum its values, in which case you sum the most recent value twice and divide by <code>(n + 1)</code>. Of course, you would not increase <code>n</code> beyond the ring buffer size."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482347783, "post_id": 41269504, "comment_id": 69741504, "body": "Can you show the result you expect for some sample data?  Suppose the incoming values were these 10: <code>1.11 8.63 4.31 5.54 7.79 8.35 3.79 6.40 3.15 6.29</code> \u2014 what would you expect to be calculated (printed)?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482347831, "post_id": 41269504, "comment_id": 69741538, "body": "From the question, the latest value is obviously important to you. Unless the algorithm &quot;forgets&quot; earlier values, new values will affect the running average less and less, even if you double them. There many ways of filtering an input value: the type in the first comment is quick to react to &quot;spikes&quot; and slow to recover."}, {"owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482461309, "post_id": 41269504, "comment_id": 69791745, "body": "Sorry.  I made a mistake.  I need &quot;twice as much as the combined weights&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1482351022, "post_id": 41270229, "comment_id": 69743282, "body": "@EugeneSh.  Doubtful overflow is an issue given that OP wants an answer based on <i>all previous</i> which implies that a summation of all samples is not a range issue.  If anything, more likely to incur a precision issue.  True that a running average is more like <code>average = (1-tau)*average + tau*sample</code>  <a href=\"https://en.wikipedia.org/wiki/Low-pass_filter#Discrete-time_realization\" rel=\"nofollow noreferrer\">Low-pass_filter</a>, yet OP did not ask about that"}, {"owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482371841, "post_id": 41270229, "comment_id": 69750852, "body": "But, to me it looks like over time the new_value will have less and less affect on average_special.  I need newest value to have TWICE the affect on the average as all previous values."}, {"owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482372112, "post_id": 41270229, "comment_id": 69750922, "body": "EugeneSh:  That looks familier.  So in: average = (1-tau)*average + tau*sample   then tau is a weighting factor? tau=0.5: sample same weight as average.   tau=2/3: then sample has twice weight of average?  Sweet!"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482384683, "post_id": 41270229, "comment_id": 69754200, "body": "@DougNull There is ambiguity in &quot;newest value to have TWICE the affect on the average as all previous values&quot;.  The &quot;average as all previous values&quot; is <code>sum&#47;n</code> prior to <code>sum += new_value;</code>, no getting around that.  It appears you want 2 things, some output that has &quot;TWICE the affect <i>of</i> the average.  <code>output = (2*new_value + sum&#47;n)&#47;3</code> and a running <code>sum</code> to later calculate the average."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "edited": false, "score": 0, "creation_date": 1482384836, "post_id": 41270229, "comment_id": 69754256, "body": "@DougNull But in the larger sense, what you are <i>asking</i> for is likely not what is <i>needed</i>.  The <code>output = (1-tau)*output + tau*sample</code> is very standard code (perhaps with some adjustment for integer math) and appears to be what you <i>need</i>."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1482347478, "last_edit_date": 1592644375, "creation_date": 1482347478, "answer_id": 41270229, "question_id": 41269504, "link": "https://stackoverflow.com/questions/41269504/how-to-get-weighted-average-where-latest-value-is-weighted-twice-as-all-previous/41270229#41270229", "title": "How to get weighted average where latest value is weighted twice as all previous?", "body": "<blockquote>\n<p>a running average where the newest value has twice the weight of all the previous values, ...</p>\n<p>how to I get an average where the <code>new_value</code> is weighted to be twice the weighting of the previous average?</p>\n</blockquote>\n<p>Compute the special average on the sum and the latest.</p>\n<pre><code>int sum = 0;\nint n = 0;\nfloat average_special = 0.0;\nfor(;;) {\n  float new_value = some_function();\n  sum += new_value;\n  ++n;\n  average_special = (sum + new_value) / (n+1);  \n}\n</code></pre>\n"}], "owner": {"reputation": 7081, "user_id": 746100, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/6w5Y7.jpg?s=128&g=1", "display_name": "Doug Null", "link": "https://stackoverflow.com/users/746100/doug-null"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 41270229, "answer_count": 1, "score": 0, "last_activity_date": 1558030568, "creation_date": 1482344727, "last_edit_date": 1558030568, "question_id": 41269504, "link": "https://stackoverflow.com/questions/41269504/how-to-get-weighted-average-where-latest-value-is-weighted-twice-as-all-previous", "title": "How to get weighted average where latest value is weighted twice as all previous?", "body": "<p>I've used this before, but just can't remember it, and can't find it anywhere.</p>\n\n<p>It's a running average where the newest value has twice the weight of all the previous values (combined), so that as time passes the oldest values have less and less effect. And I don't have enough memory to store the older values.</p>\n\n<p>TO GET AVERAGE:</p>\n\n<pre><code>int sum=0;\nint n = 0;\nfloat aver = 0;\nfor(;;){\n  float new_value = some_function();\n  sum += new_value;\n  ++n;\n  aver = sum / n;  \n}\n</code></pre>\n\n<p>But how to I get an average where the new_value is weighted to be twice the weighting of the previous average?</p>\n\n<pre><code>float aver = 0;\nfor(;;){\n  float new_value = some_function();\n  aver = aver * ??? + new_value * ???;\n\n}\n</code></pre>\n"}, {"tags": ["c", "function", "typedef"], "comments": [{"owner": {"reputation": 15720, "user_id": 19719, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3355303796cad8b9ea85993abc9030aa?s=128&d=identicon&r=PG&f=1", "display_name": "indiv", "link": "https://stackoverflow.com/users/19719/indiv"}, "edited": false, "score": 1, "creation_date": 1482344105, "post_id": 41269283, "comment_id": 69739457, "body": "Are you asking how to declare a function using the function pointer typedef?"}, {"owner": {"reputation": 1197, "user_id": 719812, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/u8qN0.png?s=128&g=1", "display_name": "Davide Andrea", "link": "https://stackoverflow.com/users/719812/davide-andrea"}, "reply_to_user": {"reputation": 15720, "user_id": 19719, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/3355303796cad8b9ea85993abc9030aa?s=128&d=identicon&r=PG&f=1", "display_name": "indiv", "link": "https://stackoverflow.com/users/19719/indiv"}, "edited": false, "score": 0, "creation_date": 1482344416, "post_id": 41269283, "comment_id": 69739631, "body": "&gt; Are you asking how to declare a function using the function pointer typedef?    ... Yes"}], "answers": [{"tags": [], "owner": {"reputation": 158911, "user_id": 1687119, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f9c3036c1979d65847da3bdc271bb5b9?s=128&d=identicon&r=PG", "display_name": "dbush", "link": "https://stackoverflow.com/users/1687119/dbush"}, "is_accepted": true, "score": 3, "last_activity_date": 1482344726, "last_edit_date": 1482344726, "creation_date": 1482344119, "answer_id": 41269321, "question_id": 41269283, "link": "https://stackoverflow.com/questions/41269283/using-a-defined-function-type-in-a-function-declaration/41269321#41269321", "title": "Using a defined function type in a function declaration", "body": "<p>If you define the typedef like this:</p>\n\n<pre><code>typedef uint32_t (funct_t)(bool);   // note the missing * before the type name\n</code></pre>\n\n<p>You can declare the function like this:</p>\n\n<pre><code>funct_t a_funct;\n</code></pre>\n\n<p>Note that when you define the function, you still need to spell out the parameters.</p>\n\n<pre><code>uint32_t a_funct(bool x)\n{\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1197, "user_id": 719812, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/u8qN0.png?s=128&g=1", "display_name": "Davide Andrea", "link": "https://stackoverflow.com/users/719812/davide-andrea"}, "edited": false, "score": 0, "creation_date": 1482345213, "post_id": 41269563, "comment_id": 69740081, "body": "You are right. I edited my post to make that correction. Thank you."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 2, "last_activity_date": 1482344971, "creation_date": 1482344971, "answer_id": 41269563, "question_id": 41269283, "link": "https://stackoverflow.com/questions/41269283/using-a-defined-function-type-in-a-function-declaration/41269563#41269563", "title": "Using a defined function type in a function declaration", "body": "<blockquote>\n  <p>I defined a function type:  </p>\n</blockquote>\n\n<pre><code>typedef uint32_t (*funct_t)(bool);\n</code></pre>\n\n<p>No, you did not declare a function. You declared pointer to a function type.</p>\n\n<p>To declare a function type you could write</p>\n\n<pre><code>typedef uint32_t funct_t(bool);\n</code></pre>\n\n<p>and then you can use the type to declare the function <code>a_funct</code></p>\n\n<pre><code>funct_t  a_funct;\n</code></pre>\n\n<p>Take into account that you may not use a typedef of a function type to define a function.</p>\n"}], "owner": {"reputation": 1197, "user_id": 719812, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/u8qN0.png?s=128&g=1", "display_name": "Davide Andrea", "link": "https://stackoverflow.com/users/719812/davide-andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 41269321, "answer_count": 2, "score": 2, "last_activity_date": 1482346786, "creation_date": 1482343983, "last_edit_date": 1482345182, "question_id": 41269283, "link": "https://stackoverflow.com/questions/41269283/using-a-defined-function-type-in-a-function-declaration", "title": "Using a defined function type in a function declaration", "body": "<p>I defined a pointer to a function type:</p>\n\n<pre><code> typedef uint32_t (*funct_t)(bool);\n</code></pre>\n\n<p>I declared a function that uses the same interface:</p>\n\n<pre><code>uint32_t a_funct(bool);\n</code></pre>\n\n<p>I need to use the pointer to a function type instead. How can I do that?</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 941, "user_id": 2350638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W2JfO.png?s=128&g=1", "display_name": "wiredolphin", "link": "https://stackoverflow.com/users/2350638/wiredolphin"}, "edited": false, "score": 0, "creation_date": 1482343895, "post_id": 41269196, "comment_id": 69739336, "body": "You have different options here. Is the function signature fixed? Otherwise you could pass a second argument to each function which contains the last position within the array, i.e. another pointer which will be updated by each function."}, {"owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "reply_to_user": {"reputation": 941, "user_id": 2350638, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/W2JfO.png?s=128&g=1", "display_name": "wiredolphin", "link": "https://stackoverflow.com/users/2350638/wiredolphin"}, "edited": false, "score": 0, "creation_date": 1482344009, "post_id": 41269196, "comment_id": 69739398, "body": "the signature is fixed but were it not how would I return multiple arguments?"}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1482424712, "post_id": 41269196, "comment_id": 69777924, "body": "The function returns 1 or never returns (but probably runs into undefined behaviour sooner or later). The code as shown does not make sense."}], "answers": [{"comments": [{"owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482344027, "post_id": 41269250, "comment_id": 69739407, "body": "global is not an option unfortunately"}], "tags": [], "owner": {"reputation": 527, "user_id": 864802, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/808a56cb6b9771861970068fa0591fb5?s=128&d=identicon&r=PG&f=1", "display_name": "baliman", "link": "https://stackoverflow.com/users/864802/baliman"}, "is_accepted": false, "score": 0, "last_activity_date": 1482343867, "creation_date": 1482343867, "answer_id": 41269250, "question_id": 41269196, "link": "https://stackoverflow.com/questions/41269196/save-pointer-address-from-another-function/41269250#41269250", "title": "save pointer address from another function", "body": "<p>You can return a struct containing the state and the pointer or you can make a global pointer</p>\n"}, {"tags": [], "owner": {"reputation": 483, "user_id": 7303706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c75cd3ace7c90a1975f1a4c714c9087?s=128&d=identicon&r=PG&f=1", "display_name": "Neme", "link": "https://stackoverflow.com/users/7303706/neme"}, "is_accepted": false, "score": 1, "last_activity_date": 1482344776, "last_edit_date": 1482344776, "creation_date": 1482344015, "answer_id": 41269292, "question_id": 41269196, "link": "https://stackoverflow.com/questions/41269196/save-pointer-address-from-another-function/41269292#41269292", "title": "save pointer address from another function", "body": "<p>I'm afraid you have to use double pointers. Either by changing the argument to be a char**, in which case the function would look a lot uglier, or by adding a new \"out\" argument of type char**, which is the address of the pointer where the new value of the pointer will be stored - sort of simulating another return value.</p>\n\n<p>Here's the first option:</p>\n\n<pre><code>int func(char **p) {\n    while (**p != 's')\n        ++*p;\n    return **p == 's' ? 1 : -1;\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482344337, "post_id": 41269323, "comment_id": 69739583, "body": "when you say fixed signature do you mean that it is not a function with variable arguments length?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482344378, "post_id": 41269323, "comment_id": 69739607, "body": "@Yos I mean, if you cannot change the function from <code>int func(char *p)</code> to anything else."}, {"owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482344845, "post_id": 41269323, "comment_id": 69739865, "body": "I didn&#39;t still don&#39;t understand what&#39;s fixed signature. do you mean if I&#39;m using overloading?"}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482345009, "post_id": 41269323, "comment_id": 69739956, "body": "@Yos I literally  mean, if someone has told you you cannot change the prototype of this function."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "edited": false, "score": 0, "creation_date": 1482345087, "post_id": 41269323, "comment_id": 69740002, "body": "@Yos Ok, then ignore the comment."}, {"owner": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1482351893, "post_id": 41269323, "comment_id": 69743728, "body": "Using char**p as an argument is dangerous if the caller passes a pointer that was allocated using malloc or calloc, since you will lose the reference to the original pointer and thus can never free it."}, {"owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "reply_to_user": {"reputation": 4046, "user_id": 4971422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4abf51a937ddda51cc6813445605c50?s=128&d=identicon&r=PG&f=1", "display_name": "FredK", "link": "https://stackoverflow.com/users/4971422/fredk"}, "edited": false, "score": 0, "creation_date": 1482354562, "post_id": 41269323, "comment_id": 69745195, "body": "@FredK Plenty of things in c are dangerous, but this sort of thing is done a lot. A good comment on the API would be (and is almost always) required."}], "tags": [], "owner": {"reputation": 26959, "user_id": 1294207, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Inny3.jpg?s=128&g=1", "display_name": "Fantastic Mr Fox", "link": "https://stackoverflow.com/users/1294207/fantastic-mr-fox"}, "is_accepted": true, "score": 1, "last_activity_date": 1482344125, "creation_date": 1482344125, "answer_id": 41269323, "question_id": 41269196, "link": "https://stackoverflow.com/questions/41269196/save-pointer-address-from-another-function/41269323#41269323", "title": "save pointer address from another function", "body": "<p>You can edit the pointer:</p>\n\n<pre><code>// The ** means a pointer to a pointer, you can now edit the pointer.\nint func(char **p) {\n    // Mauybe check for the end of the string here as well.\n    while(*(*p) != 's') {\n       // We dereference our pointer and edit it here.\n       (*p)++;\n    }\n    return (*(*p) == 's') ? 1 : -1\n}\n</code></pre>\n\n<p>At the end of this function your <code>p</code> will point at the position where the loop stopped. You would call it like this:</p>\n\n<pre><code>char *p = someString;\nint myInt = func(&amp;p);\n</code></pre>\n\n<p><strong>If the function signature is fixed</strong> then this is not possible without the use of a global, or the same loop in your second function to \"re-find\" this position.</p>\n"}, {"comments": [{"owner": {"reputation": 483, "user_id": 7303706, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5c75cd3ace7c90a1975f1a4c714c9087?s=128&d=identicon&r=PG&f=1", "display_name": "Neme", "link": "https://stackoverflow.com/users/7303706/neme"}, "edited": false, "score": 1, "creation_date": 1482344692, "post_id": 41269347, "comment_id": 69739769, "body": "I think you&#39;re actually incrementing p (not *p), which won&#39;t change the original pointer."}], "tags": [], "owner": {"reputation": 2522, "user_id": 5976576, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9ec90d5b8c13f25c3eae9fe8a9df6fc8?s=128&d=identicon&r=PG&f=1", "display_name": "MotKohn", "link": "https://stackoverflow.com/users/5976576/motkohn"}, "is_accepted": false, "score": 0, "last_activity_date": 1482347901, "last_edit_date": 1482347901, "creation_date": 1482344208, "answer_id": 41269347, "question_id": 41269196, "link": "https://stackoverflow.com/questions/41269196/save-pointer-address-from-another-function/41269347#41269347", "title": "save pointer address from another function", "body": "<p>how about pointer to a pointer:</p>\n\n<pre><code>int func(char **p) {\n    while(**p != 's')\n       (*p)++;\n    return (**p == 's') ? 1 : -1;\n}\n</code></pre>\n\n<p>You would call it using:</p>\n\n<pre><code>func(&amp;pointer);\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 41269323, "answer_count": 4, "score": 1, "last_activity_date": 1482424636, "creation_date": 1482343689, "question_id": 41269196, "link": "https://stackoverflow.com/questions/41269196/save-pointer-address-from-another-function", "title": "save pointer address from another function", "body": "<p>I have a function which receives a pointer to a char array. The function increments the pointer so that it traverses n length through the array. In the end the function returns an int which signifies certain state. The problem is I have other functions who also receive a pointer to the same char array and they need to start traversing it exactly where another function left off. So I need to somehow save the address of the pointer. I can't return the pointer because the function returns int. I'm wondering if I can still somehow pull this off or I need to use structs in order to save several data types (int and pointer address).</p>\n\n<p>Here's an example of such a function:</p>\n\n<pre><code>int func(char *p) {\n    while(*p != 's')\n       p++;\n    return (*p == 's') ? 1 : -1\n}\n</code></pre>\n"}, {"tags": ["c", "file", "types", "deque"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482343653, "post_id": 41269092, "comment_id": 69739198, "body": "You are storing always the same pointer in your deque; you&#39;re just changing what&#39;s in the memory to which it points.  You need to not just <code>strcpy()</code>, but create a new object to copy the data into.  If you have <code>strdup()</code> then that should help.  Otherwise, for each string, <code>malloc()</code>sufficient memory to <code>strcpy()</code> into, and enqueue the pointer to that space."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1482343927, "post_id": 41269092, "comment_id": 69739356, "body": "<i>The code works. The only thing is that...</i>. The conventional description of this situation would be <i>The code doesn&#39;t work</i>."}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1547460065, "creation_date": 1547460065, "answer_id": 54179219, "question_id": 41269092, "link": "https://stackoverflow.com/questions/41269092/can-deque-store-char-in-c/54179219#54179219", "title": "Can deque store char* in C?", "body": "<p>You are storing always the same pointer in your deque; you&#39;re just changing what&#39;s in the memory to which it points.  You need to not just <code>strcpy()</code>, but create a new object to copy the data into.  If you have <code>strdup()</code> then that should help.  Otherwise, for each string, <code>malloc()</code>sufficient memory to <code>strcpy()</code> into, and enqueue the pointer to that space.\n                    &ndash;&nbsp;John Bollinger</p>\n"}], "owner": {"reputation": 105, "user_id": 7326996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b302bba5dcbb506d735e747ceaa90143?s=128&d=identicon&r=PG&f=1", "display_name": "Daniella", "link": "https://stackoverflow.com/users/7326996/daniella"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547460065, "creation_date": 1482343302, "question_id": 41269092, "link": "https://stackoverflow.com/questions/41269092/can-deque-store-char-in-c", "title": "Can deque store char* in C?", "body": "<p>I need a deque of strings read from a txt file. They are read successfully (I checked it by printing them out in while. </p>\n\n<pre><code>    while ((read = getdelim(&amp;word, &amp;len, ' ', fp)) != -1) \n{\n    printf(\"!%s\\n\", word); \n    strcpy(s, word);\n    printf(\" read string is : %s\\n\", s);\n    deque_push_back(d,s);\n}\n</code></pre>\n\n<p>The code works. The only thing is that when I'm trying to print the deque, all the values are \"aaa\", but here's the actual contents of my file:\nhhh aaa hfhf hhh nnn bbbb aaa bbb aaa</p>\n\n<p>I tryed out to push values this way:</p>\n\n<pre><code>int i;\nfor (i = 0; i &lt; 10; i++)\n{ \n    char * s = \"ssss\";\n    deque_push_back(d,s);\n}\ns = \"llll\";\ndeque_push_back(d,s);\n</code></pre>\n\n<p>This code works totally fine and all the values in my deque are correct.</p>\n\n<p>I have no idea what's the problem and will be really thankfull if someone can help me.</p>\n"}, {"tags": ["c", "file", "csv"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482343267, "post_id": 41268962, "comment_id": 69738953, "body": "It might be wise to check the return value from <code>malloc</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482343324, "post_id": 41268962, "comment_id": 69738977, "body": "You should consider running your program under a memory-use analyzer such as Valgrind (maybe on a smaller file first).  I suspect you&#39;ll find that the program uses more memory -- maybe a lot more -- than the file&#39;s on-disk representation.  Valgrind will tell you about that, and it will also alert you to any memory leaks that may be affecting you."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482343376, "post_id": 41268962, "comment_id": 69739012, "body": "So you don&#39;t check if <code>malloc</code> returns a valid memory block and now wonder why you code crashes? I refuse to answer such a question."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1482343574, "post_id": 41268962, "comment_id": 69739147, "body": "Your code is asking for about 32Gb of <i>contiguous</i> memory."}, {"owner": {"reputation": 79, "user_id": 7317167, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9cc0bb1f60d1053162f249c22b56ae?s=128&d=identicon&r=PG&f=1", "display_name": "EngineerExtraordinaire", "link": "https://stackoverflow.com/users/7317167/engineerextraordinaire"}, "edited": false, "score": 0, "creation_date": 1482345972, "post_id": 41268962, "comment_id": 69740514, "body": "Are you trying to read the entirety of the file into memory? If so why? Is it a requirement, because you could probably chunk it."}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482358733, "post_id": 41269637, "comment_id": 69747161, "body": "Or better yet, make the arguments being passed <code>size_t *</code> as well as defining <code>len</code> as <code>size_t len;</code>."}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 3, "last_activity_date": 1482345951, "last_edit_date": 1482345951, "creation_date": 1482345251, "answer_id": 41269637, "question_id": 41268962, "link": "https://stackoverflow.com/questions/41268962/reading-huge-csv-files-in-c/41269637#41269637", "title": "Reading huge CSV files in c", "body": "<p>You have integer overflow. I presume your <code>int</code> must be 32 bits, because you would otherwise not have needed to use</p>\n\n<pre><code>long int len;\n</code></pre>\n\n<p>for the memory calculation</p>\n\n<pre><code>len = (*numObjs) * (*numCoords);\n</code></pre>\n\n<p>The calculation from the figures you provide is <code>200000000 * 20 = 4000000000</code>. That is performed as an <code>int</code> calculation (the type of the operands), <em>before</em> being assigned to <code>len</code>, and the product is out of the range of 32 bit <code>int</code>.</p>\n\n<p>You would need to cast one of the operands first:</p>\n\n<pre><code>len = (long int)(*numObjs) * (*numCoords);\n</code></pre>\n\n<p>or use <code>unsigned</code> types.</p>\n"}], "owner": {"reputation": 1, "user_id": 7326818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71b4a4c130ca57d1cd9e9df8a408cce7?s=128&d=identicon&r=PG&f=1", "display_name": "D. Chris", "link": "https://stackoverflow.com/users/7326818/d-chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1482345951, "creation_date": 1482342802, "question_id": 41268962, "link": "https://stackoverflow.com/questions/41268962/reading-huge-csv-files-in-c", "title": "Reading huge CSV files in c", "body": "<p>I'm trying to read double data from .csv files through a function that I created in C.\n I have tested the program with many files and up untill 100000000 rows and 20 columns (file size about 14.5 GB) I haven\u2019t had  any problems, but if I insert a larger file with 200000000 rows and 20 columns for example, I get a  segmentation fault.\n I\u2019m running the program in a system which has 52 GB of memory, so it's big enough for these files. \nFor the compilation I use:\n gcc read_files.c -D_FILE_OFFSET_BITS=64\n also before the execution I used ulimit -a unlimited.</p>\n\n<p>The code is: </p>\n\n<pre><code>double** file_read(char *filename,int  *numObjs,int  *numCoords,int line_length, int lines_to_skip,int attr_to_skip) \n{\n    double **objects;\n    long int     i, j, len;\n    ssize_t numBytesRead;\n    int done=0; \n    FILE *infile;\n    char *line, *ret;\n    char * pch;\n\n    if ((infile = fopen(filename, \"r\")) == NULL) {\n            fprintf(stderr, \"Error: no such file (%s)\\n\", filename);\n            return NULL;\n    }\n\n    line = (char*) malloc(line_length);\n\n    len = (*numObjs) * (*numCoords);\n\n    objects    = (double**)malloc((*numObjs) * sizeof(double*));\n    objects[0] = (double*) malloc(len * sizeof(double));\n    for (i=1; i&lt;(*numObjs); i++)\n        objects[i] = objects[i-1] + (*numCoords);\n\n    for(i=0;i&lt;lines_to_skip;i++)\n       fgets(line, line_length, infile);\n\n    i=0;\n    j=0;\n\n    while (fgets(line, line_length, infile) != NULL &amp;&amp; i&lt;*numObjs ) \n    {     \n             pch=strtok(line, \",;\");\n             while (pch != NULL &amp;&amp; j&lt;(*numCoords))\n             {\n                objects[i][j]=atof(pch);\n                pch = strtok (NULL, \",;\");\n                j++;\n             }\n             i++;\n             j=0;\n             done=0;\n    }\n\n\n    fclose(infile);\n    free(line);\n\n\n    return objects;\n}\n</code></pre>\n\n<p>After many tests, I am sure that the segmentation fault occurs inside the while loop but I can't understand why. Any ideas?\nThanks in advance</p>\n"}, {"tags": ["c", "output", "codeblocks"], "comments": [{"owner": {"reputation": 45919, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1482342785, "post_id": 41268730, "comment_id": 69738689, "body": "This might help: <a href=\"http://stackoverflow.com/q/13295869/4996248\">stackoverflow.com/q/13295869/4996248</a>"}, {"owner": {"reputation": 169, "user_id": 5739173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c05917dfc2384ddce2b715819b3292?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5739173/mike"}, "edited": false, "score": 0, "creation_date": 1482343003, "post_id": 41268730, "comment_id": 69738804, "body": "If your using gcc execute program like this  ./main &gt; \u201cHello.txt\u201d"}], "owner": {"reputation": 101, "user_id": 7326942, "user_type": "registered", "profile_image": "https://graph.facebook.com/817907888325186/picture?type=large", "display_name": "Andrea Leo", "link": "https://stackoverflow.com/users/7326942/andrea-leo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 254, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482342027, "creation_date": 1482341943, "last_edit_date": 1482342027, "question_id": 41268730, "link": "https://stackoverflow.com/questions/41268730/codeblocks-output-file", "title": "CodeBlocks output file", "body": "<p>I have a file that is called \"Hello.c\". There is a way to force CodeBlocks in order to create a file \"Hello.txt\" automatically where there is the output of my program?</p>\n"}, {"tags": ["c", "algorithm", "linked-list"], "comments": [{"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1482340106, "post_id": 41268010, "comment_id": 69737259, "body": "Your question is not clear. Also what is LIST1 ?  Please share code that can be understood easily."}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1482340237, "post_id": 41268010, "comment_id": 69737341, "body": "We need a linked-list.stackoverflow.com so we can filter out half of the incoming questions."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1482340281, "post_id": 41268010, "comment_id": 69737356, "body": "Using a doubly linked list would do the trick by traversing it backwards. Also (this is more like workaround) you could traverse the <code>passengers</code> array backwards when creating the list, but you would need 2 loops: 1 to get last index (the last record whose <i>fullname</i> is not <code>NULL</code>), and the 2nd: looping from the index found by previous loop to <i>0</i>. Hmm, but there&#39;s recursivity in neither 2 approaches."}, {"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482340571, "post_id": 41268010, "comment_id": 69737509, "body": "Thanks for the comments everyone, I am pretty new at this, but no excuses for this.."}, {"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482340599, "post_id": 41268010, "comment_id": 69737529, "body": "I added some more information to my code!"}, {"owner": {"reputation": 1233, "user_id": 4333131, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh3.googleusercontent.com/-jo6W76SziW4/AAAAAAAAAAI/AAAAAAAAABw/6j5r6ZJyBMg/photo.jpg?sz=128", "display_name": "Surajeet Bharati", "link": "https://stackoverflow.com/users/4333131/surajeet-bharati"}, "edited": false, "score": 0, "creation_date": 1482341675, "post_id": 41268010, "comment_id": 69738095, "body": "So, did you get any error or something in your code?"}, {"owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "edited": false, "score": 0, "creation_date": 1482342580, "post_id": 41268010, "comment_id": 69738578, "body": "No, as the question states I would like to know if there is an optimal way to reverse the linked list! The code works, but it doesn&#39;t print out anything because it finds NULL in the first element.."}, {"owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 1, "creation_date": 1482342723, "post_id": 41268010, "comment_id": 69738654, "body": "The code after <code>&#47;&#47;Recursive algorithm</code> is not recursive."}, {"owner": {"reputation": 3572, "user_id": 6515554, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-iCYFFUhmkC0/AAAAAAAAAAI/AAAAAAAABR0/bmaKQzMDoe4/photo.jpg?sz=128", "display_name": "Greg Schmit", "link": "https://stackoverflow.com/users/6515554/greg-schmit"}, "reply_to_user": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "edited": false, "score": 0, "creation_date": 1482343046, "post_id": 41268010, "comment_id": 69738832, "body": "I am seconding @jxh. Your &#39;recursive&#39; code is <i>iterative</i>, not <i>recursive</i>. Recursion does result in reverse traversal of a singly linked list (if you wait for the recursion to return before printing)."}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1482342391, "creation_date": 1482342391, "answer_id": 41268857, "question_id": 41268010, "link": "https://stackoverflow.com/questions/41268010/recursive-algorithm-for-linked-list-in-c/41268857#41268857", "title": "Recursive Algorithm for Linked List in C", "body": "<p>Assuming a singly linked list, indeed recursive traversal will print it in reverse order...if the stack has enough space of course:</p>\n\n<pre><code>void printListRev(struct LIST *p)\n{\n    if (!p) return;\n    printListRev(p-&gt;next);\n    printf(\"%s\\n\", p-&gt;data);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64283, "user_id": 315052, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/AB5ST.png?s=128&g=1", "display_name": "jxh", "link": "https://stackoverflow.com/users/315052/jxh"}, "is_accepted": false, "score": 1, "last_activity_date": 1482343005, "creation_date": 1482343005, "answer_id": 41269014, "question_id": 41268010, "link": "https://stackoverflow.com/questions/41268010/recursive-algorithm-for-linked-list-in-c/41269014#41269014", "title": "Recursive Algorithm for Linked List in C", "body": "<p>You do not need a recursive algorithm to reverse your list. You can just change how you are inserting into your list.</p>\n\n<p>This is how you are inserting items into your list:</p>\n\n<pre><code>        list1 = make_list_item_from(passengers[i]);\n        list1-&gt;next = start;\n        start = list1;\n        i++;\n</code></pre>\n\n<p>Assuming <code>passengers</code> is sorted, inserting at the front of the list results in a list that is in reverse of the order of passengers.</p>\n\n<p>To counter this, you can walk <code>passengers</code> backwards as you insert into your list. Alternatively, you can maintain a reference to the last item of the list, and add your new items to the end of your list.</p>\n"}], "owner": {"reputation": 300, "user_id": 7152488, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/6138ddf9897793ae2b5630b09bf64a1e?s=128&d=identicon&r=PG&f=1", "display_name": "baskon1", "link": "https://stackoverflow.com/users/7152488/baskon1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482343005, "creation_date": 1482339398, "last_edit_date": 1482341227, "question_id": 41268010, "link": "https://stackoverflow.com/questions/41268010/recursive-algorithm-for-linked-list-in-c", "title": "Recursive Algorithm for Linked List in C", "body": "<p>I have a structure which I name passengers, which is sorted in alphabetical order, and I <strong>copy</strong> it to a linked list with the same elements as structure.\nWhat would be the best algorithm to reverse the order of the elements of the list, so that I can print it out in alphabetical order easily? Now of course my printing doesn't work if the first value it encounters is NULL</p>\n\n<pre><code>typedef struct               \n{\n    char fullname[40];\n    unsigned short phonenr[10]; \n    unsigned int seatnr;        \n}PASSENGERS;       \n\n\ntypedef struct list1\n{\n    char fullname[40];\n    struct list1 *next;\n}LIST1;\n\nint main()\n{\n    selectsortnm(passenger); /*A function I use to sort alphabetically*/\n    LIST1 *list1, *start=NULL;\n    int i=0;\n    while (strcmp(passenger[i].fullname,\"\\0\")!=0);\n    {\n        list1 = (LIST1 *) malloc (sizeof(LIST1));\n        list1-&gt;next = NULL;\n        strcpy(list1-&gt;fullname,passenger[i].fullname);\n        if (start ==NULL)\n        {\n            start = list1;\n            i++;\n        }\n        else \n        {\n            list1-&gt;next = start;\n            start = list1;\n            i++;\n        }\n    }\n\n    //Recursive algorithm\n\n    LIST1 *current = list1;\n    while (current !=NULL)\n    {\n        printf(\"%s\",current-&gt;fullname);\n        current = current-&gt;next;\n    }\n}\n</code></pre>\n"}, {"tags": ["c", "compare"], "comments": [{"owner": {"reputation": 117, "user_id": 7243005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1395253587181364/picture?type=large", "display_name": "Neacsu Mihai", "link": "https://stackoverflow.com/users/7243005/neacsu-mihai"}, "reply_to_user": {"reputation": 6975, "user_id": 3121023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f52448806175b9aa66c86d40cf0829f1?s=128&d=identicon&r=PG&f=1", "display_name": "user3121023", "link": "https://stackoverflow.com/users/3121023/user3121023"}, "edited": false, "score": 0, "creation_date": 1482339407, "post_id": 41267960, "comment_id": 69736873, "body": "@user3121023 I get the same outcome"}, {"owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 2, "creation_date": 1482339528, "post_id": 41267960, "comment_id": 69736942, "body": "Did this code compile properly?, string compare should be  (strcmp(alegere, &quot;Numere&quot;) == 0).."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 1, "creation_date": 1482339552, "post_id": 41267960, "comment_id": 69736954, "body": "<code>#include &lt;string.h&gt;</code>"}, {"owner": {"reputation": 117, "user_id": 7243005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1395253587181364/picture?type=large", "display_name": "Neacsu Mihai", "link": "https://stackoverflow.com/users/7243005/neacsu-mihai"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482339623, "post_id": 41267960, "comment_id": 69736992, "body": "@WeatherVane I had it, just forgot to type it here."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482339722, "post_id": 41267960, "comment_id": 69737042, "body": "Anything else you forgot, such as a <code>)</code>? Please post the <a href=\"http://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that shows the problem. &quot;Verifiable&quot; means by <i>you</i> so that we are not answering a fictitious question."}, {"owner": {"reputation": 117, "user_id": 7243005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1395253587181364/picture?type=large", "display_name": "Neacsu Mihai", "link": "https://stackoverflow.com/users/7243005/neacsu-mihai"}, "reply_to_user": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1482339768, "post_id": 41267960, "comment_id": 69737066, "body": "@HardikSanghvi Yes.. I forgot that ), but it still does not do what it is suposed to do."}, {"owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1482339787, "post_id": 41267960, "comment_id": 69737076, "body": "use:- scanf (&quot;%s&quot;, alegere);"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1482339804, "post_id": 41267960, "comment_id": 69737081, "body": "Yes it does. After the suggested corrections I enter <code>Numere</code> and it prints <code>a</code>."}, {"owner": {"reputation": 406, "user_id": 6422468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d8622bb1b203d0548d5938c30588f8c?s=128&d=identicon&r=PG&f=1", "display_name": "Hardik Sanghvi", "link": "https://stackoverflow.com/users/6422468/hardik-sanghvi"}, "edited": false, "score": 0, "creation_date": 1482339972, "post_id": 41267960, "comment_id": 69737185, "body": "There is an unused variable &#39;a&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482339880, "post_id": 41268122, "comment_id": 69737127, "body": "&amp;alegere[0] &lt;==&gt; alegere + 0 &lt;==&gt; alegere"}, {"owner": {"reputation": 117, "user_id": 7243005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1395253587181364/picture?type=large", "display_name": "Neacsu Mihai", "link": "https://stackoverflow.com/users/7243005/neacsu-mihai"}, "edited": false, "score": 0, "creation_date": 1482339964, "post_id": 41268122, "comment_id": 69737180, "body": "Sry, I wrote it fast. The 3rd hint you wrote was my problem, now I understand why it wasn&#39;t working"}], "tags": [], "owner": {"reputation": 2640, "user_id": 5195699, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f85291bb71f55981b1d412f1efcb7603?s=128&d=identicon&r=PG&f=1", "display_name": "R_Kapp", "link": "https://stackoverflow.com/users/5195699/r-kapp"}, "is_accepted": true, "score": 3, "last_activity_date": 1482340799, "last_edit_date": 1482340799, "creation_date": 1482339722, "answer_id": 41268122, "question_id": 41267960, "link": "https://stackoverflow.com/questions/41267960/a-program-that-compares-2-strings-in-c/41268122#41268122", "title": "A program that compares 2 strings in C", "body": "<p>Three things:</p>\n\n<ol>\n<li>As suggested in the comments, you should use <code>\"%9s\"</code> instead of <code>\"%s\"</code> in your <code>scanf</code>. This ensures that the number of characters input does not overflow your array <code>alegere</code> which only has room for 10 characters. (Why 9 instead of 10? Because C-strings are <a href=\"https://en.wikipedia.org/wiki/Null-terminated_string\" rel=\"nofollow noreferrer\">null terminated</a>.)</li>\n<li>You are missing a <code>)</code> in your call to <code>strcmp</code>.</li>\n<li><code>&amp;alegere[10]</code> does not do what you want; <code>&amp;alegere[10]</code> is the memory address of <code>alegere[10]</code>, or one past the end of your array. This means that your <code>scanf</code> invokes undefined behavior. Replace this with either <code>&amp;alegere[0]</code> or, more simply <code>alegere</code>.</li>\n</ol>\n\n<p>Corrected code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char alegere[10];\n    printf (\"Alege natura matricei tale: (Numere/Caractere)\");\n    scanf (\"%9s\", alegere);\n    if (strcmp(alegere, \"Numere\") == 0){\n        printf(\"a\");\n    } else\n        printf (\"b\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1711, "user_id": 3171693, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b3f51428576d48dd6bc1a5851faa717a?s=128&d=identicon&r=PG&f=1", "display_name": "Dilip Kumar", "link": "https://stackoverflow.com/users/3171693/dilip-kumar"}, "is_accepted": false, "score": 3, "last_activity_date": 1482340305, "last_edit_date": 1482340305, "creation_date": 1482339735, "answer_id": 41268125, "question_id": 41267960, "link": "https://stackoverflow.com/questions/41267960/a-program-that-compares-2-strings-in-c/41268125#41268125", "title": "A program that compares 2 strings in C", "body": "<ol>\n<li>Braces issue change this</li>\n</ol>\n\n<blockquote>\n  <p><code>if (strcmp(alegere, \"Numere\" == 0)</code></p>\n</blockquote>\n\n<p>to </p>\n\n<pre><code>if (strcmp(alegere, \"Numere\") == 0)\n</code></pre>\n\n<p>2. Scan Memory is not pointing to the start of the address</p>\n\n<blockquote>\n  <p><code>scanf (\"%s\", &amp;alegere[10]);</code>\n  to \n  <code>scanf (\"%s\", alegere);</code> // %9s is a very good suggestion by other users</p>\n</blockquote>\n"}], "owner": {"reputation": 117, "user_id": 7243005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1395253587181364/picture?type=large", "display_name": "Neacsu Mihai", "link": "https://stackoverflow.com/users/7243005/neacsu-mihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 41268122, "answer_count": 2, "score": -1, "last_activity_date": 1482340799, "creation_date": 1482339221, "last_edit_date": 1482339600, "question_id": 41267960, "link": "https://stackoverflow.com/questions/41267960/a-program-that-compares-2-strings-in-c", "title": "A program that compares 2 strings in C", "body": "<p>This is my program:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(){\n    char alegere[10];\n    int a;\n    printf (\"Alege natura matricei tale: (Numere/Caractere)\");\n    scanf (\"%s\", &amp;alegere[10]);\n    if (strcmp(alegere, \"Numere\") == 0){\n        printf(\"a\");\n    } else \n        printf (\"b\");\n    return 0;\n}\n</code></pre>\n\n<p>It should compare my string that I'm writing from the keyboard with the string\" Numere\", but if i tipe the string \"Numere\" or any other string the outcome will be the same, i will get printed \"b\"... So what am i doing wrong?</p>\n"}, {"tags": ["c", "file", "compression", "huffman-code"], "comments": [{"owner": {"reputation": 83072, "user_id": 1413395, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6wNQa.jpg?s=128&g=1", "display_name": "\u03c0\u03ac\u03bd\u03c4\u03b1 \u1fe5\u03b5\u1fd6", "link": "https://stackoverflow.com/users/1413395/%cf%80%ce%ac%ce%bd%cf%84%ce%b1-%e1%bf%a5%ce%b5%e1%bf%96"}, "edited": false, "score": 0, "creation_date": 1482338776, "post_id": 41267816, "comment_id": 69736507, "body": "Welcome to Stack Overflow. Please take the time to read <a href=\"http://stackoverflow.com/tour\">The Tour</a> and refer to the material from the <a href=\"http://stackoverflow.com/help/asking\">Help Center</a> what and how you can ask here."}, {"owner": {"reputation": 8329, "user_id": 4096935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001603122463/picture?type=large", "display_name": "Webert Lima", "link": "https://stackoverflow.com/users/4096935/webert-lima"}, "edited": false, "score": 2, "creation_date": 1482339321, "post_id": 41267816, "comment_id": 69736819, "body": "what is it writing and what is it reading? I don&#39;t get how you&#39;ve concluded that."}], "answers": [{"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482363925, "last_edit_date": 1482363925, "creation_date": 1482339050, "answer_id": 41267911, "question_id": 41267816, "link": "https://stackoverflow.com/questions/41267816/fprintflong-writes-8-bytes-and-fscanflong-reads-6-bytes-why/41267911#41267911", "title": "fprintf(long) writes 8 bytes and fscanf(long) reads 6 bytes why?", "body": "<p>You're reading and writing characters, not binary.</p>\n\n<p>For example, maybe when you write data, you write the number 57,843,249 (8 digits).  But when you read data, you read 875,345 (6 digits).</p>\n"}], "owner": {"reputation": 21, "user_id": 7313812, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3111b9692b513a1806f509d1fb599c7d?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Trisolini", "link": "https://stackoverflow.com/users/7313812/christian-trisolini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1482363925, "creation_date": 1482338690, "last_edit_date": 1482340903, "question_id": 41267816, "link": "https://stackoverflow.com/questions/41267816/fprintflong-writes-8-bytes-and-fscanflong-reads-6-bytes-why", "title": "fprintf(long) writes 8 bytes and fscanf(long) reads 6 bytes why?", "body": "<p>I'm writing a Huffman algorithm and when I write my file header, I store the length of my file because there will be some spare bits and I need to know where to stop.</p>\n\n<p>This happens instead when I write the length of my file: It writes 8 bytes, but when I read, it reads only 6.</p>\n\n<pre><code>long totChar;\nlong size;\n\nfprintf(outfile, \"%ld\", totChar);\n\nfscanf(cmpfile, \"%ld\", &amp;size);\n</code></pre>\n\n<p>I'm sure that works because if I add for example:</p>\n\n<pre><code>fgetc(cmpfile); \\\\compressed file\nfgetc(cmpfile);\n</code></pre>\n\n<p>and then I start reading, the decompression is successful.</p>\n"}, {"tags": ["c", "openssl", "ssl-certificate", "ocsp"], "answers": [{"tags": [], "owner": {"reputation": 3001, "user_id": 340528, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/2OL0C.jpg?s=128&g=1", "display_name": "user8472", "link": "https://stackoverflow.com/users/340528/user8472"}, "is_accepted": false, "score": 0, "last_activity_date": 1484131672, "creation_date": 1484131672, "answer_id": 41588802, "question_id": 41267460, "link": "https://stackoverflow.com/questions/41267460/how-to-handle-both-traditional-ocsp-and-ocsp-stapling-on-client-side/41588802#41588802", "title": "How to handle both traditional OCSP and OCSP stapling on client side", "body": "<p>I am not sure if this makes sense. The point of OCSP stapling is that the response is appended to the initial TLS handshake, cf. <a href=\"https://en.wikipedia.org/wiki/OCSP_stapling\" rel=\"nofollow noreferrer\">Wikipedia</a>. Thus, the validity of the TLS handshake must be established prior to the evaluation of its content. Consequently, OpenSSL first triggers the <code>verify_callback()</code> to verify the handshake itself and only then (if the handshake is found to be valid) triggers the OCSP callback function to let you verify the additional datum contained in the handshake.</p>\n\n<p>Otherwise, if the TLS handshake fails why would you need to submit any traditional OCSP request, anyways?</p>\n\n<p>If you insist on manually submitting an OCSP request to a third party then this needs to be done after the TLS handshake has completed (probably before you send any further data on that connection or process any data that you have received). Or before you even attempt to connect to the remote server (provided you know the certificate in advance, of course) -- this workflow obsoletes the need to use OCSP stapling.</p>\n"}], "owner": {"reputation": 31, "user_id": 7326621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3ab53d50159c692b42dfd3557e2e70a?s=128&d=identicon&r=PG&f=1", "display_name": "shanzter", "link": "https://stackoverflow.com/users/7326621/shanzter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 609, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1484293512, "creation_date": 1482337517, "last_edit_date": 1495541788, "question_id": 41267460, "link": "https://stackoverflow.com/questions/41267460/how-to-handle-both-traditional-ocsp-and-ocsp-stapling-on-client-side", "title": "How to handle both traditional OCSP and OCSP stapling on client side", "body": "<p>Currently, I have an implementation where I send an OCSP request in the <code>verify_callback(int preverify_ok, X509_STORE_CTX *x509_ctx)</code> function for every intermediate and end-entity certificate. The <code>verify_callback</code> function is set using the <code>SSL_CTX_set_verify()</code> function. </p>\n\n<p>Now, I would like to add OCSP stapling to my implementation. I saw the post <a href=\"https://stackoverflow.com/questions/9607516/openssl-certificate-revocation-check-in-client-program-using-ocsp-stapling\">OpenSSL certificate revocation check in client program using OCSP stapling</a> on how to include OCSP Stapling. </p>\n\n<p>The issue with adding the above OCSP callback is that the <code>verify_callback()</code> first gets called prior to OCSP Stapling callback function.</p>\n\n<p>My question is how can I have both of them in such a way that, if there is no OCSP stapling response from the server, then the client will itself send the OCSP request. </p>\n\n<p>Is there a way to check if the OCSP stapling is supported or not before we reach the <code>verify_callback()</code> function?</p>\n"}, {"tags": ["c", "int"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482338675, "post_id": 41267458, "comment_id": 69736447, "body": "Looks like an XY-problem. Why do you <b>think</b> you want this?"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482338490, "post_id": 41267486, "comment_id": 69736335, "body": "Bitfield base types <code>_Bool</code>, <code>int</code> and <code>unsigned int</code> are guaranteed. So on an implementation with 128 bit <code>int</code>, there will be a 128 bit bitfield. An implementation can provide more types. Considering some support a 128 bit integer on smaller architectures, there might be also a 128 bit bitfield."}], "tags": [], "owner": {"reputation": 976, "user_id": 7326410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7da5572305882ad4135f63f3787318d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Bullock", "link": "https://stackoverflow.com/users/7326410/michael-bullock"}, "is_accepted": true, "score": 3, "last_activity_date": 1482337910, "last_edit_date": 1482337910, "creation_date": 1482337603, "answer_id": 41267486, "question_id": 41267458, "link": "https://stackoverflow.com/questions/41267458/in-c-can-you-have-a-128-bit-bitfield/41267486#41267486", "title": "In C, can you have a 128-bit bitfield", "body": "<p>A bitfield must fit within a single <code>int</code>, so you're out of luck unless <code>int</code> is 128 bits on your platform.</p>\n\n<p>(You were also missing a <code>;</code> at the end of the <code>struct</code> prior to the edit.)</p>\n"}, {"comments": [{"owner": {"reputation": 8362, "user_id": 2993960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/svN5z.jpg?s=128&g=1", "display_name": "Fiddling Bits", "link": "https://stackoverflow.com/users/2993960/fiddling-bits"}, "edited": false, "score": 0, "creation_date": 1482337861, "post_id": 41267512, "comment_id": 69735939, "body": "Read the entire standard? How about a snippet?"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482338639, "post_id": 41267512, "comment_id": 69736428, "body": "1) The standard does allow 128 bit <code>int</code>, so there can be 128 bit bit-fields. 2) The standard allows an implementation to support other types for bit-fields. So <code>__int128</code> can be used as bitfield. Conclusion: the standard does not disallow it! (The actual question would be what use it would have)."}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1482339655, "last_edit_date": 1495542823, "creation_date": 1482337672, "answer_id": 41267512, "question_id": 41267458, "link": "https://stackoverflow.com/questions/41267458/in-c-can-you-have-a-128-bit-bitfield/41267512#41267512", "title": "In C, can you have a 128-bit bitfield", "body": "<p>Not legal in standard C11 (on most platforms; in principle, an <code>int</code> might be 128 bits, but I never met a platform having that). Read <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">n1570</a> (draft specification).</p>\n\n<p>But on <em>some platforms</em> recent compilers (e.g. <a href=\"http://gcc.gnu.org/\" rel=\"nofollow noreferrer\">GCC</a> 6) provide <a href=\"https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html#_005f_005fint128\" rel=\"nofollow noreferrer\"><code>__int128</code>  as an extension</a>. You won't use that as a bitfield, but as some kind of integral type.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/a/41265826/841108\">this</a> answer to a related question.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 761, "favorite_count": 0, "closed_date": 1482337755, "accepted_answer_id": 41267486, "answer_count": 2, "score": 0, "last_activity_date": 1482339655, "creation_date": 1482337514, "last_edit_date": 1482337700, "question_id": 41267458, "link": "https://stackoverflow.com/questions/41267458/in-c-can-you-have-a-128-bit-bitfield", "closed_reason": "Duplicate", "title": "In C, can you have a 128-bit bitfield", "body": "<p>Is the following code legal?</p>\n\n<pre><code>struct BigInt {\n     uint64_t a : 128;\n};\n</code></pre>\n"}, {"tags": ["c", "linux", "gcc", "pthreads", "glibc"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482337004, "post_id": 41267121, "comment_id": 69735454, "body": "Why would you use <code>-pthread</code> (or <code>-lpthread</code>) for a program that doesn&#39;t actually use pthreads?  And given, then, that your program in fact does use pthreads, why is there an issue?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1482337016, "post_id": 41267121, "comment_id": 69735460, "body": "To my understanding the only reason you&#39;d want this is to have a <i>universal build command</i>, which is never a good idea. I mean it&#39;s either your executable is multi threaded or not. You should not have to rely on gcc&#39;s smart linkage."}, {"owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482342635, "post_id": 41267121, "comment_id": 69738608, "body": "@JohnBollinger Generic project builds."}], "answers": [{"comments": [{"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 5, "creation_date": 1482358522, "post_id": 41267371, "comment_id": 69747075, "body": "&quot;The idea that you should use GCC&#39;s special option -pthread instead of -lpthread is outdated by probably some decade and a half (with respect to glibc, that is).&quot; -- this is correct, but <i>only</i> applies to glibc. If you build for other platforms, you could easily get in trouble by <i>not</i> using <code>-pthread</code>, so it&#39;s preferable to use <code>-pthread</code> instead of <code>-lpthread</code>, because the former is <i>always</i> correct, and the latter is not necessarily."}], "tags": [], "owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "is_accepted": true, "score": 10, "last_activity_date": 1482338963, "last_edit_date": 1482338963, "creation_date": 1482337207, "answer_id": 41267371, "question_id": 41267121, "link": "https://stackoverflow.com/questions/41267121/pthread-lpthread-and-minimal-dynamic-linktime-dependencies/41267371#41267371", "title": "-pthread, -lpthread and minimal dynamic linktime dependencies", "body": "<p>The idea that you should use GCC's special option <code>-pthread</code> instead of <code>-lpthread</code> is outdated by probably some decade and a half (with respect to glibc, that is). In modern glibc, the switch to threading is entirely dynamic, based on whether the pthreads library is linked or not. Nothing in the glibc headers changes its behavior based on whether <code>_REENTRANT</code> is defined.</p>\n\n<p>As an example of the dynamic switching, consider <code>FILE *</code> streams. Certain operations on streams are locking, like <code>putc</code>. Whether you're compiling a single-threaded program or not, it calls the same <code>putc</code> function; it is not re-routed by the preprocessor to a \"pthread-aware\" <code>putc</code>. What happens is that do-nothing stub functions are used to go through the motions of locking and unlocking. These functions get overridden to real ones when the threading library is linked in.</p>\n\n<hr>\n\n<hr>\n\n<p>I just did a cursory <code>grep</code> through the include file tree of a glibc installation. In <code>features.h</code>, <code>_REENTRANT</code> causes <code>__USE_REENTRANT</code> to be defined. In turn, exactly one thing seems to depend on whether <code>__USE_REENTRANT</code> is present, but has a parallel condition which also enables it. Namely, in <code>&lt;unistd.h&gt;</code> there is this:</p>\n\n<pre><code>#if defined __USE_REENTRANT || defined __USE_POSIX199506\n/* Return at most NAME_LEN characters of the login name of the user in NAME.\n   If it cannot be determined or some other error occurred, return the error\n   code.  Otherwise return 0.\n\n   This function is a possible cancellation point and therefore not\n   marked with __THROW.  */\nextern int getlogin_r (char *__name, size_t __name_len) __nonnull ((1));\n#endif\n</code></pre>\n\n<p>This looks dubious and is obsolete; I can't find it in the master branch of the glibc git repo.</p>\n\n<p>And, oh look, <strong>just mere days ago</strong> (December 6) a commit was made on this topic:</p>\n\n<p><a href=\"https://sourceware.org/git/?p=glibc.git;a=commit;h=c03073774f915fe7841c2b551fe304544143470f\" rel=\"noreferrer\">https://sourceware.org/git/?p=glibc.git;a=commit;h=c03073774f915fe7841c2b551fe304544143470f</a></p>\n\n<pre><code>Make _REENTRANT and _THREAD_SAFE aliases for _POSIX_C_SOURCE=199506L.\n\nFor many years, the only effect of these macros has been to make\nunistd.h declare getlogin_r.  _POSIX_C_SOURCE &gt;= 199506L also causes\nthis function to be declared.  However, people who don't carefully\nread all the headers might be confused into thinking they need to\ndefine _REENTRANT for any threaded code (as was indeed the case a long\ntime ago).\n</code></pre>\n\n<p>Among the changes:</p>\n\n<pre><code>--- a/posix/unistd.h\n+++ b/posix/unistd.h\n@@ -849,7 +849,7 @@ extern int tcsetpgrp (int __fd, __pid_t __pgrp_id) __THROW;\n    This function is a possible cancellation point and therefore not\n    marked with __THROW.  */\n extern char *getlogin (void);\n-#if defined __USE_REENTRANT || defined __USE_POSIX199506\n+#ifdef __USE_POSIX199506\n /* Return at most NAME_LEN characters of the login name of the user in NAME.\n    If it cannot be determined or some other error occurred, return the error\n    code.  Otherwise return 0.\n</code></pre>\n\n<p><strong>See?</strong> :)</p>\n"}, {"tags": [], "owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "is_accepted": false, "score": 5, "last_activity_date": 1482347448, "creation_date": 1482347448, "answer_id": 41270222, "question_id": 41267121, "link": "https://stackoverflow.com/questions/41267121/pthread-lpthread-and-minimal-dynamic-linktime-dependencies/41270222#41270222", "title": "-pthread, -lpthread and minimal dynamic linktime dependencies", "body": "<p>The other answer explains that <code>-pthread</code> (at both compile and link time) is functionally equivalent to <code>-lpthread</code> (at link time only) <strong>when the C library is the GNU C library</strong>.  But that's not the only C library in the world.</p>\n\n<p>I do not know whether any of the <em>current</em> generation of POSIX-compliant operating systems require anything more than <code>-lpthread</code> at link time for a threaded application, but if you use <code>-pthread</code> at both compile and link time, you will at least make life easier for people trying to keep old iron running.</p>\n\n<p>Having said that, old iron will also be happier if you <em>don't</em> use <code>-pthread</code> (or <code>-lpthread</code>) on programs that don't need to use threads.  \"Generic project builds\" are not a good idea.</p>\n\n<p>The problem of shared libraries getting pulled in when they don't need to be is best solved by <code>-Wl,--as-needed</code> (with GNU-compatible linkers).  This is only not on by default for backward compatibility's sake.</p>\n"}], "owner": {"reputation": 51929, "user_id": 1084774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/13403db744d8aa130bb317576cc1df30?s=128&d=identicon&r=PG", "display_name": "PSkocik", "link": "https://stackoverflow.com/users/1084774/pskocik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1479, "favorite_count": 2, "accepted_answer_id": 41267371, "answer_count": 2, "score": 7, "last_activity_date": 1482347448, "creation_date": 1482336351, "last_edit_date": 1495540799, "question_id": 41267121, "link": "https://stackoverflow.com/questions/41267121/pthread-lpthread-and-minimal-dynamic-linktime-dependencies", "title": "-pthread, -lpthread and minimal dynamic linktime dependencies", "body": "<p>This <a href=\"https://stackoverflow.com/questions/23250863/difference-between-pthread-and-lpthread-while-compiling\">answer</a> suggest <code>-pthread</code> is preferable to <code>-lpthread</code> because predefined macros.</p>\n\n<p>Empirically, <code>-pthread</code> gives me only one extra macro: <code>#define _REENTRANT 1</code>\nand it also appears to force <code>libpthread.so.0</code> as a dynamic linktime dependency.</p>\n\n<p>When I compile with <code>-lpthread</code>, that dependency is only added if I actually call any of the <code>pthread</code> functions.</p>\n\n<p>This is preferably to me, because then I wouldn't have to treat multithreaded programs differently in my build scripts.</p>\n\n<p>So my question is, what else is there to <code>-pthread</code> vs <code>-lpthread</code> and is it possible to use use <code>-pthread</code> without forcing said dynamic linktime dependency?</p>\n\n<p>Demonstration:</p>\n\n<pre><code>$ echo 'int main(){ return 0; }' | c gcc -include pthread.h -x c - -lpthread &amp;&amp; ldd a.out | grep pthread\n$ echo 'int main(){  return pthread_self(); }' | c gcc -include pthread.h -x c - -lpthread &amp;&amp; ldd a.out | grep pthread\nlibpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x0000003000c00000)\n$ echo 'int main(){ return 0; }' | c gcc -include pthread.h -x c - -pthread &amp;&amp; ldd a.out | grep pthread\nlibpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x0000003000c00000) \n</code></pre>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 2324, "user_id": 2272652, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vKcw7.jpg?s=128&g=1", "display_name": "Christian Grabowski", "link": "https://stackoverflow.com/users/2272652/christian-grabowski"}, "edited": false, "score": 0, "creation_date": 1482348944, "post_id": 41267069, "comment_id": 69742181, "body": "I don&#39;t <i>think</i> there&#39;s an easy way other than CGO without doing something hacky. You don&#39;t need gcc for CGO, you can set CGO&#39;s compiler by setting the env var <code>CC=&lt;desired compiler&gt;</code>.  I don&#39;t know much about windows&#39; c compiler though, or env vars in windows for that matter."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482349086, "post_id": 41267069, "comment_id": 69742269, "body": "You can certainly convert the strings, but the problem is that LPCTSTR is conditionally a typedef for LPCSTR or LPCWSTR. Do you have any way to ensure the type?"}, {"owner": {"reputation": 3436, "user_id": 1520878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/6822b07182b8c0ae366325f2ae4fab4f?s=128&d=identicon&r=PG", "display_name": "brooks94", "link": "https://stackoverflow.com/users/1520878/brooks94"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1482355619, "post_id": 41267069, "comment_id": 69745733, "body": "@JimB, yes, I think the type of the string is implied by the function I&#39;m calling that has either an &quot;A&quot; or &quot;W&quot; suffix for the two types of data."}], "answers": [{"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 1, "last_activity_date": 1482356957, "creation_date": 1482356957, "answer_id": 41272464, "question_id": 41267069, "link": "https://stackoverflow.com/questions/41267069/convert-c-string-to-go-string-without-cgo/41272464#41272464", "title": "Convert C string to Go string without CGO", "body": "<p>If you can get a pointer to a cstring without CGO, and you can get the length of the string too, then perhaps you should create a byte slice from the cstring first.  </p>\n\n<pre><code>import (\n    \"reflect\"\n    \"unsafe\"\n)\n\nfunc ToByteSlice() []byte {\n    var bytes []byte\n\n    shdr := (*reflect.SliceHeader)(unsafe.Pointer(&amp;bytes))\n    shdr.Cap = int(stringlen)\n    shdr.Len = int(stringlen)\n    shdr.Data = uintptr(unsafe.Pointer(cpointer))\n\n    return bytes\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1482358347, "post_id": 41272645, "comment_id": 69746995, "body": "nice. Why might copy be needed unless you just want a string?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1482358461, "post_id": 41272645, "comment_id": 69747053, "body": "@Mark: converting it to a string implicitly makes a copy of the bytes. If you return a slice directly from the array, it will point to the original memory location which may or may not be safe to access later."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1482358566, "last_edit_date": 1482358566, "creation_date": 1482357721, "answer_id": 41272645, "question_id": 41267069, "link": "https://stackoverflow.com/questions/41267069/convert-c-string-to-go-string-without-cgo/41272645#41272645", "title": "Convert C string to Go string without CGO", "body": "<p>If you have an 8 bit string, you can convert the LPCTSTR pointer to a <code>[]byte</code> of the proper size, and copy it to a new string or slice.</p>\n\n<pre><code>a := (*[1 &lt;&lt; 30-1]byte)(unsafe.Pointer(lpctstr))\nsize := bytes.IndexByte(a[:], 0)\n// if you just want a string\n// goString := string(a[:size:size])\n\n// if you want a slice pointing to the original memory location without a copy\n// goBytes := a[:size:size]\n\ngoBytes := make([]byte, size)\ncopy(goBytes, a)\n</code></pre>\n\n<p>If the LPCTSTR points to an LPCWSTR which contains 16bit unicode characters, you can convert that with the utf16 package.</p>\n\n<pre><code>a := (*[1 &lt;&lt; 30-1]uint16)(unsafe.Pointer(lpctstr))\nsize := 0\nfor ; size &lt; len(a); size++ {\n    if a[size] == uint16(0) {\n        break\n    }\n}   \nrunes := utf16.Decode(a[:size:size])\ngoString := string(runes)\n</code></pre>\n"}], "owner": {"reputation": 3436, "user_id": 1520878, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/6822b07182b8c0ae366325f2ae4fab4f?s=128&d=identicon&r=PG", "display_name": "brooks94", "link": "https://stackoverflow.com/users/1520878/brooks94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 1, "accepted_answer_id": 41272645, "answer_count": 2, "score": 2, "last_activity_date": 1482358566, "creation_date": 1482336191, "question_id": 41267069, "link": "https://stackoverflow.com/questions/41267069/convert-c-string-to-go-string-without-cgo", "title": "Convert C string to Go string without CGO", "body": "<p>I'm using the Go Windows syscall libraries to get data out of a function in a DLL.  This all works great, but I can't figure out a way to convert a LPCTSTR (pointer to C String) into a proper Go string <em>without using CGO</em>.</p>\n\n<p>I'd like to avoid CGO if at all possible, because the two options for CGO code on Windows (cross-compiling, and installing gcc on windows) are still fairly complex.</p>\n"}, {"tags": ["c", "debugging", "gdb", "pthreads"], "answers": [{"tags": [], "owner": {"reputation": 1754, "user_id": 4605946, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pNIMp.png?s=128&g=1", "display_name": "space_voyager", "link": "https://stackoverflow.com/users/4605946/space-voyager"}, "is_accepted": false, "score": 1, "last_activity_date": 1482340882, "creation_date": 1482340882, "answer_id": 41268458, "question_id": 41266824, "link": "https://stackoverflow.com/questions/41266824/gdb-breakpoint-in-routine-of-a-simple-pthread/41268458#41268458", "title": "GDB breakpoint in routine of a simple Pthread?", "body": "<p>Solved it, there wasn't much a problem after all. Here are instructions, if anyone has a similar issue:</p>\n\n<ol>\n<li>Compile with <code>gcc -ggdb main.c -o main -lpthread</code> (yes, that's <code>-ggdb</code> and not <code>-g</code>, it appears to make a difference)</li>\n<li>Run the debugger with <code>gdb main</code> or, in Emacs, with <code>M-x gdb</code> (and the command <code>gdb -i=mi main</code>)\n\n<ul>\n<li>Hugely important here: Emacs has by default the variable <code>gdb-non-stop-setting</code> <a href=\"https://www.gnu.org/software/emacs/manual/html_node/emacs/Multithreaded-Debugging.html#Multithreaded-Debugging\" rel=\"nofollow noreferrer\">set to <code>t</code></a>, which means it tries to run GDB in non-stop mode. According to docs, this is NOT what I want - I want all-stop mode. Thus, either do a <code>set-variable</code> or put <code>(setq gdb-non-stop-setting nil)</code> in your init file (e.g. <code>~/.emacs.d/init.el</code>). Only once this is done should you launch <code>M-x gdb</code> from inside Emacs...</li>\n</ul></li>\n<li><code>(gdb) b 9</code> to set the breakpoint to line 9</li>\n<li><code>(gdb) r</code> to run the program. Execution will stop when one of the threads reaches line 9, i.e. <code>tid = (long)threadid;</code>. All other threads will also stop! Perfect!</li>\n<li><code>(gdb) c</code> to continue. Execution will stop when another thread reaches line 9. Great!</li>\n<li>Continue doing whatever, we have the desired behavior now :)</li>\n</ol>\n"}], "owner": {"reputation": 1754, "user_id": 4605946, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/pNIMp.png?s=128&g=1", "display_name": "space_voyager", "link": "https://stackoverflow.com/users/4605946/space-voyager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1482340882, "creation_date": 1482335446, "question_id": 41266824, "link": "https://stackoverflow.com/questions/41266824/gdb-breakpoint-in-routine-of-a-simple-pthread", "title": "GDB breakpoint in routine of a simple Pthread?", "body": "<p>I have the following code (<a href=\"https://computing.llnl.gov/tutorials/pthreads/\" rel=\"nofollow noreferrer\">source</a>):</p>\n\n<pre><code>#include &lt;pthread.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define NUM_THREADS 5\n\nvoid *PrintHello(void *threadid) {\n  long tid;\n  tid = (long)threadid;\n  printf(\"Hello World! It's me, thread #%ld\\n\", tid);\n  pthread_exit(NULL);\n}\n\nint main(int argc, char *argv[]) {\n  pthread_t threads[NUM_THREADS];\n  int rc;\n  long t;\n  for (t=0; t&lt;NUM_THREADS; t++) {\n    printf(\"In main: creating thread %ld\\n\", t);\n    rc = pthread_create(&amp;threads[t], NULL, PrintHello, (void *)t);\n    if (rc) {\n      printf(\"ERROR; return code from pthread_create() is %d\\n\", rc);\n      exit(-1);\n    }\n  }\n\n  // wait for all threads to die\n  pthread_exit(NULL);\n}\n</code></pre>\n\n<p>I compile with <code>gcc -g main.c -o main -lpthread</code>. I am using GDB for debugging. What I want is to place a breakpoint at the second line of PrintHello, i.e. at <code>tid = (long)threadid</code>, and have the execution stop there (whatever the thread) and let me do stuff like look at the value of variable <code>threadid</code>.</p>\n\n<p>I want to achieve this in Emacs' GDB implementation - which we may assume for the purposes of this question as simply GDB (don't worry that it's run inside Emacs). So far I can place the breakpoint at the desired line, and sometimes the little arrow showing the current line where the program is at does indeed stop at this line:</p>\n\n<p><img src=\"https://i.imgur.com/NfXkkp0.png\" alt=\"arrow\"></p>\n\n<p>However when I type into the GDB prompt <code>print threadid</code> I get back <code>No symbol \"threadid\" in current context.</code> and the arrow jumps immediately to some breakpoint that I set in main():</p>\n\n<p><img src=\"https://i.imgur.com/2ugEQ6D.png\" alt=\"im2\"></p>\n\n<p>My guess is that this occurs because the \"pausing\" of program execution happens for the main thread, which is not the thread running <code>PrintHello</code>. <code>PrintHello</code> is run by thread <code>t</code> - since this is not the thread paused by GDB, it prints the hello world message and exists immediately. By the time I get around to typing <code>print threadid</code>, this thread is already dead and the program is back in main()... hence the effect.</p>\n\n<p>I tried to resolve this by typing something like <code>break &lt;LineNumber&gt; thread &lt;ThreadID&gt;</code> but this is no good since in this program the created threads last for a split second. So I am never actually at a point where <code>info thread</code> shows anything except the main thread. It's simply not humanly possible to \"catch\" the program at a point where there is the main thread and a newly created thread running <code>PrintHello</code> - since this situation lasts for I guess a few microseconds.</p>\n\n<p>Please help me to achieve this simple debug objective of halting execution of whatever thread is executing <code>PrintHello</code> at the line <code>tid = (long)threadid;</code>.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 2, "creation_date": 1482335128, "post_id": 41266629, "comment_id": 69734107, "body": "Terminate your string (and don&#39;t forget the added space needed to do it.). And lose the  <code>printf</code> after your allocation; it invokes UB."}, {"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 1, "creation_date": 1482335350, "post_id": 41266629, "comment_id": 69734266, "body": "Then try responding with 1234567890 to the first question. You&#39;ll learn a whole lot of lessons from debugging that :)"}, {"owner": {"reputation": 10816, "user_id": 2441511, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44cfa49eb110e0c602a31ba8cc1c57c5?s=128&d=identicon&r=PG", "display_name": "user2441511", "link": "https://stackoverflow.com/users/2441511/user2441511"}, "edited": false, "score": 0, "creation_date": 1482335785, "post_id": 41266629, "comment_id": 69734560, "body": "I changed your question title to reflect your problem more clearly. :)"}], "answers": [{"tags": [], "owner": {"reputation": 845, "user_id": 1289198, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/ed1ed50abd03457dd455c60a4e80d7c6?s=128&d=identicon&r=PG", "display_name": "yakoudbz", "link": "https://stackoverflow.com/users/1289198/yakoudbz"}, "is_accepted": false, "score": 5, "last_activity_date": 1482337406, "last_edit_date": 1482337406, "creation_date": 1482335347, "answer_id": 41266794, "question_id": 41266629, "link": "https://stackoverflow.com/questions/41266629/c-program-that-prints-string-behaves-strangely/41266794#41266794", "title": "C program that prints string behaves strangely", "body": "<p>This is a totally undefined behavior:</p>\n\n<pre><code>    char* user_length = (char*)malloc( length );\n    printf(\"Strlen - %d\\n\" , strlen( user_length ) );\n</code></pre>\n\n<p>You just allocate an array which can be filled by any character (remaining of some data in RAM) and ask for the length of the string in this array, which is equivalent to finding the first null character ('\\0') in the array.</p>\n\n<p>Now that I explain that <code>strlen</code> search for the first null character, you must understand that a string always finish with <code>'\\0'</code>. When you fill in your <code>user_length</code> array of character, you must put <code>'\\0'</code> or simply <code>0</code> at the end in order to make it a legal string.</p>\n\n<p>Also, <code>user_length</code> is a terrible name for a string, one would expect a number corresponding to some length.\nWith all that in mind, I would have done that :</p>\n\n<pre><code>int main(){\n\n    srand( time( NULL ) );\n\n    int length , i ;\n    char alph[] = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n    int alph_length = strlen( alph );\n\n    do{\n        printf(\"How many character do you want to print? &gt;&gt;\");\n        int num_scanned = scanf(\"%d\" , &amp;length );\n\n        if(num_scanned!=1 || length&lt;=0 || length&gt;alph_length) // if the user put some shit, exit\n            return -1;\n\n\n        char* user_string = (char*)malloc( length+1 );\n\n        for( i = 0 ; i &lt; length ; i++ ){\n            user_string[i]  = alph[ rand()%alph_length ];\n        }\n        user_string[length] = '\\0';\n\n        printf(\"string - %s\\n\"\n               \"strlen - %zu\\n\\n\" , user_string, strlen( user_string ) );\n\n        free( user_string );\n\n    }while( 1 );\n\n    return 0;\n}\n</code></pre>\n\n<p>Note that I corrected multiple other things ;-)</p>\n"}, {"tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": false, "score": 3, "last_activity_date": 1482335515, "creation_date": 1482335515, "answer_id": 41266846, "question_id": 41266629, "link": "https://stackoverflow.com/questions/41266629/c-program-that-prints-string-behaves-strangely/41266846#41266846", "title": "C program that prints string behaves strangely", "body": "<pre><code>   char* user_length = malloc( length  + 1); // &lt;-- give room for the terminating '\\0', and dont cast the return of malloc\n    // dont use user_length yet, it contains garbage for the moment\n\n    printf(\"Strlen - %d\\n\" , length); \n    for( i = 0 ; i &lt; length ; i++ ){\n        *( user_length + i ) = alph[ rand()%strlen( alph ) ]; // ok\n    }\n\n    user_length [length] = '\\0'; // &lt;-- null-terminate your string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "is_accepted": false, "score": 0, "last_activity_date": 1482336188, "creation_date": 1482336188, "answer_id": 41267067, "question_id": 41266629, "link": "https://stackoverflow.com/questions/41266629/c-program-that-prints-string-behaves-strangely/41267067#41267067", "title": "C program that prints string behaves strangely", "body": "<p>You forgot to zero-terminate the result, which makes both <code>strlen</code> and the printing of it undefined.<br>\nTerminate it properly, and remember to allocate space for the terminator (and don't cast the result of <code>malloc</code>):</p>\n\n<pre><code>char* user_length = malloc(length + 1);\nuser_length[length] = 0;\n</code></pre>\n\n<p>(\"User length\" is a strange name for this string, by the way.)</p>\n\n<p>Note that you can generate this without storing anything, though:</p>\n\n<pre><code>do {\n    printf(\"How many character do you want to print? &gt;&gt;\");\n    scanf(\"%d\" , &amp;length );\n\n    printf(\"String: \");\n    for( i = 0 ; i &lt; length ; i++ ){\n        printf(\"%c\", alph[rand() % strlen(alph)]);\n    }\n    printf(\"\\n\");\n} while(1);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7326346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce721f60fc56cb3f6afb444ba820b5?s=128&d=identicon&r=PG&f=1", "display_name": "Kanzaki", "link": "https://stackoverflow.com/users/7326346/kanzaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1482338016, "creation_date": 1482334926, "last_edit_date": 1482338016, "question_id": 41266629, "link": "https://stackoverflow.com/questions/41266629/c-program-that-prints-string-behaves-strangely", "title": "C program that prints string behaves strangely", "body": "<p>I just work out with this c program. But it behaves really strangely.</p>\n\n<p><strong>This program suppose to print out <code>a-zA-Z0-9</code> randomly with length depend on the user.</strong></p>\n\n<p><strong><em>Consider the following code.</em></strong></p>\n\n<pre><code>int main(){\n\n    srand( (unsigned)time( NULL ) );\n\n    int length , i ;\n    char alph[] = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\";\n\n    do{\n\n        printf(\"How many character do you want to print? &gt;&gt;\");\n        scanf(\"%d\" , &amp;length );\n\n        char* user_length = (char*)malloc( length );\n\n        printf(\"Strlen - %d\\n\" , strlen( user_length ) );\n\n        for( i = 0 ; i &lt; length ; i++ ){\n\n            *( user_length + i ) = alph[ rand()%strlen( alph ) ];\n        }\n\n        printf(\"\\nString - %s\\n\" , user_length );\n        printf(\"strlen - %d\\n\\n\" , strlen( user_length ) );\n\n        free( user_length );\n\n    }while( 1 );\n\n    return 0;\n}\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/Bi1O3.png\" alt=\"This is the result I get. (click to view)\">\n<br/><br/>\nThe only problem is that the <code>user_length</code> does not contain \"length\" number of element</p>\n\n<p>I can't figure out the errors. Can someone help me to solve this?</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 0, "creation_date": 1482335232, "post_id": 41266527, "comment_id": 69734182, "body": "1. <code>int sizemes</code> is declared both out and inside the function. 2. <code>*(pMesaleat+i) =randascii;</code> where <code>randascii</code> is an <code>int</code> while <code>*(pMesaleat + i)</code> is a <code>char</code>. As an answer you shouldn&#39;t use arrays <code>char mesaleat[31]</code> but instead use <a href=\"http://man7.org/linux/man-pages/man3/malloc.3.html\" rel=\"nofollow noreferrer\">malloc</a>. e.g. <code>char *pMesaleat = (char*)malloc(sizeofmes * sizeof(char))</code>."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1482335398, "post_id": 41266527, "comment_id": 69734295, "body": "@CristiFati: That is nonsense! Such a small array is better automatic. OP can use a VLA to make the length variable: <code>char mesaleat[sizemes]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482335615, "post_id": 41266672, "comment_id": 69734441, "body": "As a sidenote: Best way to deal with compilers not supporting VLAs: wipe from disc. Any modern C11 compiler also supports C99 mode and none of them does not support VLAs in C11 mode."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": false, "score": 4, "last_activity_date": 1482335031, "creation_date": 1482335031, "answer_id": 41266672, "question_id": 41266527, "link": "https://stackoverflow.com/questions/41266527/adjusting-the-size-of-an-array-according-to-a-variable/41266672#41266672", "title": "Adjusting the size of an array according to a variable", "body": "<p>C99 supports variable length arrays (it's optional in C11 and you can check if it's not supported using the macro <code>__STDC_NO_VLA__</code>).\nSo, you can do:</p>\n\n<pre><code>int sizemes = 31;\nchar mesaleat[sizemes];\n</code></pre>\n\n<p>If your implementation doesn't support VLA (or using C89) then you can resort to <code>malloc()</code>:</p>\n\n<pre><code>char *mesaleat = malloc(sizemes * sizeof *mesaleat);\nif (!mesaleat) {\n    /* error */\n}\n</code></pre>\n\n<p>and so on.</p>\n\n<p>Note: Call <code>free()</code> on <code>mesaleat</code> once you are done with it.</p>\n"}, {"tags": [], "owner": {"reputation": 1130, "user_id": 4699016, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/itgis.png?s=128&g=1", "display_name": "Uchiha Itachi", "link": "https://stackoverflow.com/users/4699016/uchiha-itachi"}, "is_accepted": true, "score": 0, "last_activity_date": 1482344104, "creation_date": 1482344104, "answer_id": 41269318, "question_id": 41266527, "link": "https://stackoverflow.com/questions/41266527/adjusting-the-size-of-an-array-according-to-a-variable/41269318#41269318", "title": "Adjusting the size of an array according to a variable", "body": "<p>You declare <code>sizmes</code> twice, which you don't want to do.  The compiler will not know which one to use.  You should also declare your pointers outside of the function if you're going to need them later.  Either way, you want to make sure you <code>Free</code> them when done to avoid memory leaks.  Declare and initialize them outside of the function, and then utilize it within, like below:</p>\n\n<pre><code>int sizemes = 31;\nchar *pMesaleat;\n\nchar letrarand()\n{\n\n    char mesaleat[sizemes] = { ' ' };\n\n    pMesaleat = mesaleat;\n    int numaleat = 0;\n    int randascii = 0;\n    srand(time(NULL)):                                                          \n\n    for (int i = 0; i &lt; sizemes; i++)\n    {\n        numaleat= rand() % 26;\n        randascii = numaleat + 65;\n        *(pMesaleat+i) = randascii;\n        printf(\"%c \\t\",*(pMesaleat+i));\n    }\n\nreturn 0;\n}\n\nif (pMesaleat)\n    Free(pMesaleat);\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 5629923, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/uQVrQ.jpg?s=128&g=1", "display_name": "Henrique", "link": "https://stackoverflow.com/users/5629923/henrique"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 41269318, "answer_count": 2, "score": 0, "last_activity_date": 1482344104, "creation_date": 1482334585, "question_id": 41266527, "link": "https://stackoverflow.com/questions/41266527/adjusting-the-size-of-an-array-according-to-a-variable", "title": "Adjusting the size of an array according to a variable", "body": "<p>This is probably a really newbie question, but I really couldn't apply any of the other answers to my case.</p>\n\n<p>Say that I have this chunk of code:</p>\n\n<pre><code> int sizemes=0;\n\n char letrarand()\n{\n    int sizemes = 31;\n    char mesaleat[31] = { ' ' };\n    char *pMesaleat;\n    pMesaleat = mesaleat;\n    int  numaleat = 0, i=0;\n    int randascii = 0;\n    srand(time(NULL));                                                          \n\n    for (i = 0; i &lt; 31; i++)\n        {\n            numaleat= rand() % 26;\n            randascii = numaleat + 65;\n            *(pMesaleat+i) =randascii;\n            printf(\"%c \\t\",*(pMesaleat+i));\n\n        }\n    return 0;\n}\n</code></pre>\n\n<p>Where letrarand is a function that will create an array of 31 elements and assign a random capital letter to each one of those elements. Right now that works, but I want to be able to adjust the size of the array according to the variable sizeofmes, so that if that variable(which is outside of the function) is 15 the array will have 15 elements and so on. For some reason, i can't do that, any ideas?</p>\n"}, {"tags": ["c", "performance", "recursion", "difference"], "comments": [{"owner": {"reputation": 67949, "user_id": 297696, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/782a7a5f79b342bb12dc0aaae3a0c34d?s=128&d=identicon&r=PG", "display_name": "wkl", "link": "https://stackoverflow.com/users/297696/wkl"}, "edited": false, "score": 0, "creation_date": 1482335008, "post_id": 41266469, "comment_id": 69734017, "body": "A quick glance: your original solution is the naive/standard implementation, which runs in exponential time based on size of stack."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482335682, "post_id": 41266469, "comment_id": 69734491, "body": "I didn&#39;t know the mathlib has a ready-made <code>towers_of_hanoi</code> function ..."}, {"owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482335950, "post_id": 41266469, "comment_id": 69734680, "body": "@Olaf It has really? :O"}], "answers": [{"tags": [], "owner": {"reputation": 2512, "user_id": 5771617, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/fUXWF.jpg?s=128&g=1", "display_name": "lu5er", "link": "https://stackoverflow.com/users/5771617/lu5er"}, "is_accepted": false, "score": 1, "last_activity_date": 1482335733, "last_edit_date": 1495540799, "creation_date": 1482334881, "answer_id": 41266616, "question_id": 41266469, "link": "https://stackoverflow.com/questions/41266469/what-makes-speed-of-these-recursive-pieces-so-different/41266616#41266616", "title": "What makes speed of these recursive pieces so different?", "body": "<p>Firstly I would suggest you to draw the recursion tree. See how big it becomes for pegs = 30. Refer to <a href=\"https://stackoverflow.com/questions/12383044/complexity-for-towers-of-hanoi\">Complexity for towers of Hanoi?</a>\nIt has a complexity of O(2^n).\n<a href=\"http://www.iitk.ac.in/esc101/08Jan/lecnotes/lecture32.pdf\" rel=\"nofollow noreferrer\">http://www.iitk.ac.in/esc101/08Jan/lecnotes/lecture32.pdf</a></p>\n\n<p>The second solution is not computing it in the traditional way. It is making a single call. T(n-1) + c = O(n^2)</p>\n\n<p>So, 2^30 vs 30^2. Guess, which one is faster!</p>\n\n<p>See for yourself. </p>\n\n<p>add a counter to the functions like\n(make 'c' and 'd' global)</p>\n\n<pre><code>float power(int multi)\n{\n    printf(\"d = %d\\n\",d);\n    d++;\n    if(!multi)\n    {\n        return 1;\n    }\n\n    else\n    {\n        return 2 * power(multi - 1);\n    } \n}\n\nfloat count_moves(int layers)\n{\n    printf(\"c = %d\\n\",c);\n    c++;\n    if(!layers)\n    {\n        return 0;\n    }\n\n    else\n    {\n        return power(layers - 1) + count_moves(layers - 1);\n    }\n}\n</code></pre>\n\n<p>and see the number of times they are called.</p>\n"}, {"tags": [], "owner": {"reputation": 97034, "user_id": 427332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e11b58e11decc7b4c352d3ac3b2d0b90?s=128&d=identicon&r=PG", "display_name": "Tommy", "link": "https://stackoverflow.com/users/427332/tommy"}, "is_accepted": false, "score": 0, "last_activity_date": 1482335279, "creation_date": 1482335279, "answer_id": 41266773, "question_id": 41266469, "link": "https://stackoverflow.com/questions/41266469/what-makes-speed-of-these-recursive-pieces-so-different/41266773#41266773", "title": "What makes speed of these recursive pieces so different?", "body": "<p>Ignoring the pointless parameters, the first algorithm is <code>count = (n &gt; 0) ? TOH(n-1)+TOH(n-1)+1 : 0</code>. Each call to <code>TOH</code> results in two further calls to <code>TOH</code>. Its complexity is O(2^n). Each time that <code>n</code> goes up by one, costs will double.</p>\n\n<p>The second is <code>(layers &gt; 0) ? [something linear] + count_moves(layers - 1) : 0</code>. It's two tail-recursive methods but each call to either generates at most one further call. But it's \"do this n times, and for each time, do this other thing n times\" so that's n*n. It's O(n^2).</p>\n\n<p>O(2^n) goes up a lot more quickly than O(n^2).</p>\n"}, {"tags": [], "owner": {"reputation": 7568, "user_id": 4391743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/K5Ouu.png?s=128&g=1", "display_name": "Isabelle Newbie", "link": "https://stackoverflow.com/users/4391743/isabelle-newbie"}, "is_accepted": false, "score": 0, "last_activity_date": 1482335747, "creation_date": 1482335747, "answer_id": 41266925, "question_id": 41266469, "link": "https://stackoverflow.com/questions/41266469/what-makes-speed-of-these-recursive-pieces-so-different/41266925#41266925", "title": "What makes speed of these recursive pieces so different?", "body": "<p>Your first version follows the scheme that would actually compute the sequence of steps to move the rings. But you don't explicitly compute these steps; indeed, your <code>TOH</code> version ignores its arguments! (Except for passing them to recursive calls which also ignore them except for passing them to recursive calls.)</p>\n\n<p>This means that <code>TOH</code>'s return value only depends on its first argument <code>n</code>. This also means that your two recursive calls with <code>n-1</code> will return the same value, so it suffices to all <code>TOH</code> once and use the return value twice. Changing the body of the <code>if</code> inside <code>TOH</code> to this:</p>\n\n<pre><code>int tmp = TOH(n-1, x, y, z);\ncount = tmp + 1 + tmp;\n</code></pre>\n\n<p>makes your code terminate immediately with the same answer as before. Note that you will probably get arithmetic overflow above an initial <code>n</code> value of 31.</p>\n\n<p>By the way, GCC at level <code>-O3</code> seems to be smart enough to perform this optimization automagically on your original code, with no changes whatsoever.</p>\n"}], "owner": {"reputation": 21, "user_id": 7326387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b933d8a9309f7de8c096da9b62f8ceb2?s=128&d=identicon&r=PG&f=1", "display_name": "Elmun", "link": "https://stackoverflow.com/users/7326387/elmun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1482335747, "creation_date": 1482334430, "last_edit_date": 1482335572, "question_id": 41266469, "link": "https://stackoverflow.com/questions/41266469/what-makes-speed-of-these-recursive-pieces-so-different", "title": "What makes speed of these recursive pieces so different?", "body": "<p>I have to work out a recursive function to apply on an assignment(for which im not allowed to use the standard math library about the tower of Hanoi. I stumbled upon the following code which i thought would be a good piece for the assignment to work with, however it is impossible to run it for (n > 30) as it's just so slow:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint TOH(int,char,char,char);\n\nint main()\n{\n    int n;\n    printf(\"\\nEnter number of disks:\");\n    scanf(\"%d\",&amp;n);\n    int c = TOH(n,'A','C','B');\n    printf(\"\\nTotal number of moves = %d \\n \", c);\n    return 0;\n}\n\nint TOH(int n,char x,char y,char z)\n{\n    int count = 0;\n\n    if(n&gt;0){\n    count = TOH(n-1, x, z, y);\n    count++;\n    count += TOH(n-1, z, y, x);\n    }\n    return count;\n}\n</code></pre>\n\n<p>While looking for a solution for the speed, i stumbled upon this code, which runs instantly while using recursion. I'm lost on where this difference in speed comes from:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nfloat count_moves(int);\nfloat power(int);\n\nint main()\n{\n    int STACKS;\n    printf(\"\\nEnter numbers of disks: \");\n    scanf(\"%d\", &amp;STACKS);\n    float total = count_moves(STACKS);\n    printf(\"\\nTotal number of moves: %.0f\\n\", total);\n    return 0;\n}\n\nfloat power(int multi)\n{\n    if(!multi)\n    {\n        return 1;\n    }\n\n    else\n    {\n        return 2 * power(multi - 1);\n    } \n}\n\nfloat count_moves(int layers)\n{\n    if(!layers)\n    {\n        return 0;\n    }\n\n    else\n    {\n        return power(layers - 1) + count_moves(layers - 1);\n    }\n}\n</code></pre>\n\n<p>How is the second one able to instantly print something in the console, while the second one takes longer the bigger a number i make n/STACKS?</p>\n"}, {"tags": ["c", "arrays", "split", "char"], "comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 2, "creation_date": 1482334544, "post_id": 41266467, "comment_id": 69733701, "body": "You tagged this [C], but used the <code>new</code> keyword, which is C++ only."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 2, "creation_date": 1482334625, "post_id": 41266467, "comment_id": 69733754, "body": "What defines the start of <code>&quot;abcdef&quot;</code>?  It is clearly not <i>space</i>, because <i>space</i> marks the beginning of string &#39;&quot;123&quot;&#39;.  On what basis should we skip over <code>&quot;123&quot;</code>, and only match <code>&quot;abcdef&quot;</code>?"}, {"owner": {"reputation": 57, "user_id": 6443627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b988f265bf01cfcd175e4a1fb5291734?s=128&d=identicon&r=PG&f=1", "display_name": "mo.proxy", "link": "https://stackoverflow.com/users/6443627/mo-proxy"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482334750, "post_id": 41266467, "comment_id": 69733844, "body": "123 is a sample. The delimiter between those strings is white space."}, {"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 3, "creation_date": 1482334868, "post_id": 41266467, "comment_id": 69733923, "body": "If you want the first string delimited by whitespace, then it is <code>&quot;123&quot;</code>.   So (again), how are you saying the expected result is <code>&quot;abcdef&quot;</code>?  Or maybe you want the first 3 strings skipped?  Or maybe you want the first string that ends with a <code>&quot;&#47;&quot;</code>?  You have not been clear."}, {"owner": {"reputation": 28355, "user_id": 4788546, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2jWn.jpg?s=128&g=1", "display_name": "CristiFati", "link": "https://stackoverflow.com/users/4788546/cristifati"}, "edited": false, "score": 1, "creation_date": 1482335933, "post_id": 41266467, "comment_id": 69734664, "body": "You should have more examples of that string to establish a pattern (one could be: <i>some_junk 1st_text_that_we_care_about/some_numeric_junk-&gt;2nd_text_that&zwnj;&#8203;_we_care_about/some_&zwnj;&#8203;other_junk</i>)."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482356432, "post_id": 41266467, "comment_id": 69746107, "body": "What you need is an alphabetic character string or a character string between the characters you specify E.g(Between <code>&#39;&gt;&#39;</code> and <code>&#39;&#47;&#39;</code>)?"}, {"owner": {"reputation": 57, "user_id": 6443627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b988f265bf01cfcd175e4a1fb5291734?s=128&d=identicon&r=PG&f=1", "display_name": "mo.proxy", "link": "https://stackoverflow.com/users/6443627/mo-proxy"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482383410, "post_id": 41266467, "comment_id": 69753744, "body": "@abelenky what i need is all of strings separated by white spaces. all of &quot;123&quot;s are in desired format except that one is different. I need only two part of it as mentioned above."}], "answers": [{"tags": [], "owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "is_accepted": false, "score": 1, "last_activity_date": 1482335849, "creation_date": 1482335849, "answer_id": 41266963, "question_id": 41266467, "link": "https://stackoverflow.com/questions/41266467/split-parse-a-char-array-and-get-value-between-two-tokens-c/41266963#41266963", "title": "split/parse a char array and get value between two tokens C", "body": "<p><a href=\"http://ideone.com/jPEk4d\" rel=\"nofollow noreferrer\">IDEOne Code</a></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n\n    char text[]=\"123 123 123 abcdef/456-&gt;ghijklm/789 123 123\";\n    char* ptr = strtok(text, \" \");\n    char* slash;\n\n    char* str1;\n    char* str2;\n\n    while(ptr)\n    {\n        if (slash = strstr(ptr, \"/\"))\n        {\n            *slash = '\\0';\n            str1 = ptr;\n            ptr = ++slash;\n            break;\n        }\n        ptr = strtok(NULL, \" \");\n    }\n\n    str2 = strtok(ptr, \"&gt;\");\n    while(ptr)\n    {\n        if (slash = strstr(ptr, \"/\"))\n        {\n            *slash = '\\0';\n            str2 = ptr;\n            break;\n        }\n        ptr = strtok(NULL, \" \");\n    }\n\n    printf(\"Found a: %s; and b: %s\\n\", str1, str2);\n    return 0;\n}\n</code></pre>\n\n<p><strong><em>Output</em></strong></p>\n\n<pre><code>Found a: abcdef; and b: ghijklm\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482361051, "post_id": 41273301, "comment_id": 69748076, "body": "<i>&quot;However A and B are not included&quot;</i>, what are A and B?  Not seen in your function."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 58292, "user_id": 34824, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/ri8DI.jpg?s=128&g=1", "display_name": "abelenky", "link": "https://stackoverflow.com/users/34824/abelenky"}, "edited": false, "score": 0, "creation_date": 1482362510, "post_id": 41273301, "comment_id": 69748564, "body": "@abelenky Thanks,  I fixed that typo."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": false, "score": 2, "last_activity_date": 1482362594, "last_edit_date": 1482362594, "creation_date": 1482360924, "answer_id": 41273301, "question_id": 41266467, "link": "https://stackoverflow.com/questions/41266467/split-parse-a-char-array-and-get-value-between-two-tokens-c/41273301#41273301", "title": "split/parse a char array and get value between two tokens C", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nchar *between(const char *str, char start, char end){\n//return between start and end. However, start and end are not included.\n    const char *s = NULL, *e;\n    if(!str || !*str) return NULL;\n    if((e = strchr(str+1, end)) == NULL)\n        return NULL;//end character not found\n    for(int i = e-str-1; i &gt;= 0; --i){\n        if(str[i] == start){\n            s = str + i + 1;\n            break;\n        }\n    }\n    if(!s)\n        return between(e, start, end);//start character not found\n    int len = e - s;\n    char *ret = malloc(len + 1);\n    if(ret){\n        memcpy(ret, s, len);\n        ret[len] = 0;\n    }\n    return ret;\n}\n\nint main(void){\n    const char *data = \"123 123 123 abcdef/456-&gt;ghijklm/789 123 123\";\n    char *str1 = between(data, ' ', '/');\n\n    if(str1){\n        printf(\"str1: '%s'\\n\", str1);\n        char *str2 = between(data, '&gt;', '/');//use strstr+strlen+1 for after str1, or save search position\n        if(str2)\n            printf(\"str2: '%s'\\n\", str2);\n        free(str1);free(str2);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1482376976, "creation_date": 1482376976, "answer_id": 41275314, "question_id": 41266467, "link": "https://stackoverflow.com/questions/41266467/split-parse-a-char-array-and-get-value-between-two-tokens-c/41275314#41275314", "title": "split/parse a char array and get value between two tokens C", "body": "<p>So from what I understand, you just want to extract the fully alphabetic strings from your <code>char []</code> array. If this is the case, you can just parse the words using <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_strtok.htm\" rel=\"nofollow noreferrer\"><code>strtok</code></a>, and test if the string has all alphabetic letters using <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_isalpha.htm\" rel=\"nofollow noreferrer\"><code>isalpha</code></a> from <code>&lt;ctype.h&gt;</code>. </p>\n\n<p>Something like this could work:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ctype.h&gt;\n\nint\nmain(int argc, char *argv[]) {\n    char data[] = \"123 123 123 abcdef/456-&gt;ghijklm/789 123 123\";\n    char *word;\n    const char *delim = \" /-&gt;\";\n    int i, validlet, strnum = 1;\n\n    word = strtok(data, delim);\n    while (word) {\n        validlet = 0;\n        for (i = 0; word[i]; i++) {\n            if (!isalpha(word[i])) {\n                break;\n            }\n            validlet++;\n        }\n        if (validlet == strlen(word)) {\n            printf(\"Found str %d: %s\\n\",strnum, word);\n            strnum++;\n        }\n        word = strtok(NULL, delim);\n    }\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1261, "user_id": 5516527, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4591edc85fb163dffe4606be4c4179bf?s=128&d=identicon&r=PG&f=1", "display_name": "m.r226", "link": "https://stackoverflow.com/users/5516527/m-r226"}, "is_accepted": true, "score": 1, "last_activity_date": 1482642698, "last_edit_date": 1482642698, "creation_date": 1482642371, "answer_id": 41318813, "question_id": 41266467, "link": "https://stackoverflow.com/questions/41266467/split-parse-a-char-array-and-get-value-between-two-tokens-c/41318813#41318813", "title": "split/parse a char array and get value between two tokens C", "body": "<p>So, if you want all the strings and just some part of one of them,  you can use the following piece of code if and only if the location of '<em>abcdef/456->ghijklm/789</em>' in <strong><em>data</em></strong> array is fixed:</p>\n\n<pre><code>                //data =\"123 123 123 123 123 123 123\" abcdef/456-&gt;ghijklm/789 123\");\n                char temp[/*strlen(data)*/];\n                char temp2[/*strlen(data)*/];\n                char *splitPtr, *p, *abcdef, *ghijklm, _789;\n                splitPtr = data;\n                splitCounter = 0;\n                for (char *p = strtok_r(data, \" \", &amp;splitPtr); p; p = strtok_r(NULL, \" \", &amp;splitPtr)) {\n                    if (splitCounter == _the_location_of_special_text) {\n                        strcpy(temp, p);                        \n                        abcdef = strtok(temp, \"/\");\n                        char *gt = strchr(p, '&gt;')+1;\n                        int index = (int)(gt - p);                        \n                        strcpy(temp2, p+index);\n\n                        ghijklm = strtok(temp2, \"/\");\n\n                        _789 = strrchr( p, '/' )+1;\n                    }\n                    else {\n                    //use the p as 123\n                         }\n                    splitCounter += 1;\n                }\n                printf (\"Part 1: %s\\n,Part 2: %s\\n,Part 3: %s\\n\", abcdef, ghijklm , _789);\n</code></pre>\n\n<p>The output:</p>\n\n<p>Part 1: abcdef </p>\n\n<p>Part 2: ghijklm </p>\n\n<p>Part 3: 789</p>\n"}], "owner": {"reputation": 57, "user_id": 6443627, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b988f265bf01cfcd175e4a1fb5291734?s=128&d=identicon&r=PG&f=1", "display_name": "mo.proxy", "link": "https://stackoverflow.com/users/6443627/mo-proxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 2, "accepted_answer_id": 41318813, "answer_count": 4, "score": 1, "last_activity_date": 1482642698, "creation_date": 1482334421, "last_edit_date": 1482383484, "question_id": 41266467, "link": "https://stackoverflow.com/questions/41266467/split-parse-a-char-array-and-get-value-between-two-tokens-c", "title": "split/parse a char array and get value between two tokens C", "body": "<p>So, after some searching and googling, i can not figure out how to extract a value between two tokens in a char array. here is some of my code:</p>\n\n<pre><code>    char *data= (char *) malloc( 50);\n    strcpy(data, \"123 123 123 abcdef/456-&gt;ghijklm/789 123 123\");\n</code></pre>\n\n<p>I need to extract \"abcdef\" as Str1 and \"ghijkm\" as Str2.</p>\n\n<p>The first solution that everyone recommend is strtok as follow:</p>\n\n<pre><code>str1 = strtok(temp, \"/\");    // str1=abcdef\n</code></pre>\n\n<p>but how about the secound one? i mean str2, so.</p>\n\n<p>Q1: How do i extract ghijkmn as str2?</p>\n\n<p>Q2: Is there any other existing utility function I can leverage? or any other solution to deal with this kind of situation?</p>\n\n<p>[Added:]\nWhat i need is all of strings separated by white spaces. all of \"123\"s are in desired format except that one is different. I need only two part of it as mentioned above.</p>\n"}, {"tags": ["c", "linux", "shared-libraries", "static-libraries", "cross-compiling"], "comments": [{"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1482336677, "post_id": 41266459, "comment_id": 69735210, "body": "Did you consider sharing the C source code?"}], "answers": [{"tags": [], "owner": {"reputation": 4425, "user_id": 6277831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c21010f99314f291650d4cd9e3b2735?s=128&d=identicon&r=PG", "display_name": "lostbard", "link": "https://stackoverflow.com/users/6277831/lostbard"}, "is_accepted": false, "score": 1, "last_activity_date": 1482334746, "creation_date": 1482334746, "answer_id": 41266573, "question_id": 41266459, "link": "https://stackoverflow.com/questions/41266459/c-link-library-independant-to-build/41266573#41266573", "title": "C Link Library Independant to Build", "body": "<p>If you are using functions from within libraries, you have the option of either using the dynamic library (and require it to be installed, or install yourself) </p>\n\n<p>or use static libraries which will get combined with your program (if you can build static libs)</p>\n\n<p>Most often issues with trying to build with static libs, is that you may also need to static link with any other libs that that library also depends on.</p>\n"}, {"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482336538, "creation_date": 1482336538, "answer_id": 41267177, "question_id": 41266459, "link": "https://stackoverflow.com/questions/41266459/c-link-library-independant-to-build/41267177#41267177", "title": "C Link Library Independant to Build", "body": "<p>When talking cross comparability, you want to <em>avoid</em> static linking. Because those libraries could already be built and debugged on ARM systems. You simply install the already working shared libraries for that architecture on to the system, and then your program will work fine.</p>\n\n<p>You also face the problem that those shared libraries, are dependent on <em>other</em> shared libraries. Those too you would also have to rebuild. So by the end of the day you'll have a 3GB executable.</p>\n\n<p>I recommended you do some practice with packaging (oh no he said it). Create a .deb or .rpm that will install the dependent libraries for you.</p>\n"}], "owner": {"reputation": 303, "user_id": 4693151, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/68067bad908acb1ca2d6c4595ae556da?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/4693151/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1482336538, "creation_date": 1482334407, "question_id": 41266459, "link": "https://stackoverflow.com/questions/41266459/c-link-library-independant-to-build", "title": "C Link Library Independant to Build", "body": "<p>I want do develop a executable in C and share this executable, that it can run on other target Systems. The devepoment system is Linux 64Bit and the target system is a Linux ARM system. I developed it because of laziness using shared libraries but if i share it, for sure it wont work, because the shared objects are missing. I tried to Change from shared to static libraries by building up the library from source, because it didn't offer static libraries, but when i try to build the Project, it gives undefined reference error. This should be related to the missing Header files. But if i include the Header files in the build process, there is the same Problem when i distribute them. </p>\n\n<p>Is there a posibility to use libraries but build a independant executable, where i don't have to install or copy other stuff but the executable to to target System?</p>\n\n<p>Cross-compiling works fine, just the library makes Problems.</p>\n"}, {"tags": ["c", "arrays", "pointers", "dynamic-memory-allocation", "memcpy"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1482333675, "post_id": 41266109, "comment_id": 69733064, "body": "You allocate 9 elements. Count how many fields you assign values to!"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482333749, "post_id": 41266109, "comment_id": 69733125, "body": "&quot;memcpy copies a static allocated array into my p&quot; - Where did you get this from? <code>memcpy</code> copies whatever you pass to it. The compound literal is a temporary automatic object."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1482333791, "post_id": 41266109, "comment_id": 69733160, "body": "@Olaf How is that, the <code>9 * sizeof(float)</code> takes care of the amount, or did I miss anything? Agree, there is excess, but that should not be a problem, correct?"}, {"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482333842, "post_id": 41266109, "comment_id": 69733196, "body": "@Olaf this is what i have been taught. don&#39;t bash me"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482333844, "post_id": 41266109, "comment_id": 69733197, "body": "@SouravGhosh: I refer to the assignments. <code>p[0] ... p[9]</code> (no idea why OP uses the additions)! Accessing unallocated memory is <b>always</b> a problem!"}, {"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1482333907, "post_id": 41266109, "comment_id": 69733249, "body": "@Sourav  in the first code i didn&#39;t write all the values, as you can see it was just an e.g. , so Olaf rushed with his conclusion"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482333913, "post_id": 41266109, "comment_id": 69733253, "body": "@Olaf Ahh, right, I thought OP was <i>avaoiding</i> that, so I did not check that part. Your comment stands then. :)"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482333988, "post_id": 41266109, "comment_id": 69733305, "body": "@CatalinGhita: In which way did I &quot;rush&quot;?? And use the index-operator; it is the same as the additions (that&#39;s how it is defined!) and way easier to read. Also make the compound literal <code>const</code>, otherwise you might make the resulting code even worse."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482334117, "post_id": 41266109, "comment_id": 69733387, "body": "@SouravGhosh: As I understand he wants to use a different approach for the first code. Strangely, he uses only 9 elements in the compound literal."}, {"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "edited": false, "score": 0, "creation_date": 1482334175, "post_id": 41266109, "comment_id": 69733441, "body": "@ you made me count how many fields i used. in the first code i only used  3 fields and i realise it isn&#39;t correct. But again, i was looking for the main ideea, not the fact that i intentionally missed the other 6 values."}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482334559, "post_id": 41266109, "comment_id": 69733713, "body": "Nice Stuff @CatalinGhita. It is also good to check the return value of the <code>void*</code> pointer from <code>malloc()</code>, just to be super safe."}, {"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482334800, "post_id": 41266109, "comment_id": 69733875, "body": "@RoadRunner yes thank you."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482335668, "post_id": 41266109, "comment_id": 69734479, "body": "Suggest changing your post from <code>*(p+9)=9;</code> --&gt; <code>*(p+8)=9;</code>. That coding mis-step is distracting."}, {"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482335783, "post_id": 41266109, "comment_id": 69734559, "body": "@chux you are right thank you"}], "answers": [{"comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 2, "creation_date": 1482334688, "post_id": 41266171, "comment_id": 69733796, "body": "The compound literal <b>is</b> an array!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482342668, "post_id": 41266171, "comment_id": 69738622, "body": "@Olaf Right. Basis of my answer: <i>&quot;my array.....&quot;</i> which refers to <code>p</code> which is wrong. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 3, "last_activity_date": 1482334020, "last_edit_date": 1482334020, "creation_date": 1482333648, "answer_id": 41266171, "question_id": 41266109, "link": "https://stackoverflow.com/questions/41266109/dynamic-allocation-of-array-issue-c/41266171#41266171", "title": "Dynamic allocation of array issue C", "body": "<p>First of all, you don't have an(y) <strong>array</strong>, all you have a pointer to a memory of particular size.</p>\n\n<p>Secondly, as you mentioned, (<em>emphasis mine</em>)</p>\n\n<blockquote>\n  <p><em>memcpy copies a static allocated array <strong>into</strong> my <code>p</code></em></p>\n</blockquote>\n\n<p>so, yes, the pointer still has (<em>or points to</em>) the dynamically allocated memory. </p>\n\n<p>As we see from <code>C11</code>, chapter \u00a77.24.2.1</p>\n\n<blockquote>\n  <p>The <code>memcpy</code> function copies <code>n</code> characters from the object pointed to by <code>s2</code> into the\n  object pointed to by <code>s1</code>. [...]</p>\n</blockquote>\n\n<p>So, we can see, the <em>objects</em> themselves are not changed / replaced, it's only the contents that gets copied.</p>\n"}, {"tags": [], "owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "is_accepted": false, "score": 0, "last_activity_date": 1482334982, "last_edit_date": 1482334982, "creation_date": 1482334670, "answer_id": 41266553, "question_id": 41266109, "link": "https://stackoverflow.com/questions/41266109/dynamic-allocation-of-array-issue-c/41266553#41266553", "title": "Dynamic allocation of array issue C", "body": "<p>If your initialisation values are constant, you can use a compound literal. However, the code is error-prone. If you forget one element in the literal, you will access the array out-of bounds. This invokes <em>undefined behaviour</em>.</p>\n\n<p>Change three things:</p>\n\n<pre><code>// use a macro for the length. In general don't use magic numbers!\n#define ARRAY_LEN 9\n\n// change the compound literal to:\n... (static const float [ARRAY_LEN]){ ... }\n</code></pre>\n\n<p>this avoids copying the literal every time your function executes. It also makes the literal immutable so the compiler can check if you try to assign values to it.</p>\n\n<p>Note: <code>mempcy</code> does not \"copy a static(ally) allocated array ...\". Neither is that a requirement for your array, nor is the compound literal you use a static object, but automatic.</p>\n\n<p><strong>Caution:</strong> Always check the result of functions which can encounter an error if anything the function does is used for further processing. <code>malloc</code> can return a <em>null pointer</em> on error. Handle this situation appropriately!</p>\n"}, {"comments": [{"owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "edited": false, "score": 0, "creation_date": 1482337419, "post_id": 41267100, "comment_id": 69735673, "body": "why <code>sizeof *p</code> instead of <code>sizeof(float)</code> ?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "edited": false, "score": 0, "creation_date": 1482338695, "post_id": 41267100, "comment_id": 69736456, "body": "@CatalinGhita  With <code>p</code> as a pointer, <code>p = malloc(sizeof *p * COUNT)</code> is always right, easier for review and less work to update.  If you saw code <code>q = malloc(sizeof *q * COUNT)</code>  vs. <code>r = malloc(sizeof (double) * COUNT)</code>, you would know the first is correct by just at the line.  The 2nd would need you to search for the declaration of <code>r</code> to know if it is correct.  With the 2nd, if the type pointer to should change, the coder is obligated to edit all related <code>*alloc()</code> calls."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 6, "last_activity_date": 1482341700, "last_edit_date": 1482341700, "creation_date": 1482336285, "answer_id": 41267100, "question_id": 41266109, "link": "https://stackoverflow.com/questions/41266109/dynamic-allocation-of-array-issue-c/41267100#41267100", "title": "Dynamic allocation of array issue C", "body": "<blockquote>\n  <p>my array still remains dynamically allocated?</p>\n</blockquote>\n\n<pre><code>float *p;\np = malloc(9 * sizeof(float));\nmemcpy ( p, (float[]){2,60,-23,55,7,9,-2.55,-66.9,9}, 9 * sizeof(float));\n</code></pre>\n\n<p>Yes.  The value of pointer <code>p</code> remains unchanged.  It still points to the memory dynamically allocated.<br>\n<code>p[0]</code>, the first element now has the value of <code>2.0f</code>,<br>\n<code>p[1]</code>, the next element now has the value of <code>60.0f</code>, etc.</p>\n\n<hr>\n\n<p>Some coding suggestions:</p>\n\n<pre><code>int main(void) {\n#define COUNT 9\n  float *p = malloc(sizeof *p * COUNT);\n  if (p) {\n    memcpy(p, (float[COUNT] ) { 2, 60, -23, 55, 7, 9, -2.55f, -66.9f, 9 },\n        sizeof *p * COUNT);\n    //...\n  }\n  free(p);\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 644, "user_id": 7201671, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/io92V.jpg?s=128&g=1", "display_name": "Catalin Ghita", "link": "https://stackoverflow.com/users/7201671/catalin-ghita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 41267100, "answer_count": 3, "score": 7, "last_activity_date": 1521140549, "creation_date": 1482333480, "last_edit_date": 1521140549, "question_id": 41266109, "link": "https://stackoverflow.com/questions/41266109/dynamic-allocation-of-array-issue-c", "title": "Dynamic allocation of array issue C", "body": "<p>To be clear, my code works perfectly. The issue that concerns me is that i am unsure of my array allocation type.</p>\n\n<p>My task is rather simple: i am required to do some operations within a dynamically allocated array.</p>\n\n<p>Yet, the values are already given in the array. So therefore i am required to add these values in it.</p>\n\n<p>To keep my vector dynamically allocated and to avoid the following situation:</p>\n\n<pre><code>float *p;\n p = malloc(9 * sizeof(float));\n* p=2;\n* (p+1)=60;\n* (p+2)=-23;\n.\n.\n.\n* (p+8)=9;\n</code></pre>\n\n<p>I tried doing this :</p>\n\n<pre><code>float *p;\np = malloc(9 * sizeof(float));\nmemcpy (p, (float[]) {2 ,60 ,-23, 55, 7, 9, -2.55, -66.9, 9}, 9 * sizeof(float));\n</code></pre>\n\n<p>Now I am unsure because memcpy copies a static allocated array into my <code>p</code>. My  question is then: my array still remains dynamically allocated?</p>\n\n<p>EDIT: My question refers to 2nd code.</p>\n"}, {"tags": ["c", "char"], "comments": [{"owner": {"reputation": 15451, "user_id": 6879826, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/WzqBC.png?s=128&g=1", "display_name": "ad absurdum", "link": "https://stackoverflow.com/users/6879826/ad-absurdum"}, "edited": false, "score": 0, "creation_date": 1482333709, "post_id": 41265571, "comment_id": 69733093, "body": "What about <code>fgetwc()</code>?"}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "edited": false, "score": 0, "creation_date": 1482333831, "post_id": 41265571, "comment_id": 69733190, "body": "Good question format, but some minor things: avoid <code>feof</code> (<a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a>), make <code>j</code> something different like <code>is_converting</code> or something because <code>j</code> is usually an iterator."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1482339561, "post_id": 41265571, "comment_id": 69736961, "body": "Look at using <code>fread()</code> rather than <code>fscanf()</code>. Since you are using UTF-8 with multi-byte characters you will need to have a mechanism to read the byte stream in and then process the characters one at a time and recognizing multi-byte characters in the UTF-8 stream. See also <a href=\"http://stackoverflow.com/questions/10948234/utf8-processing-in-c\">UTF8 processing C</a> and see also this blog posting <a href=\"http://www.nubaria.com/en/blog/?p=289\" rel=\"nofollow noreferrer\">Using UTF-8 as the internal representation for strings in C and C++ with Visual Studio</a>."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1482340497, "post_id": 41265571, "comment_id": 69737476, "body": "<a href=\"https://linuxprograms.wordpress.com/2012/05/12/using-scanf-and-wchar_t-to-read-and-print-utf-8-strings/\" rel=\"nofollow noreferrer\">C: Using scanf and wchar_t to read and print UTF-8 strings</a> has a short demo program that demonstrates use of <code>setlocale(LC_ALL, &quot;&quot;);</code> along with the <code>%ls</code> format specifier as in <code>scanf(&quot;%ls&quot;,string);</code>."}], "answers": [{"comments": [{"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1482335793, "post_id": 41266625, "comment_id": 69734568, "body": "that&#39;s assuming UTF16 is the encoding being used on the text files :) OP doesn&#39;t specify that."}, {"owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "reply_to_user": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 1, "creation_date": 1482336059, "post_id": 41266625, "comment_id": 69734774, "body": "@AhmedMasud good point. While I was writing this question I learned that it is impossible to get the encoding of a text file without guessing. My knowledge is limited, but OP may be in a real pickle without the use of some guessing libraries."}, {"owner": {"reputation": 77, "user_id": 6401629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d37306e5b00668cd2542ea98c048ee9?s=128&d=identicon&r=PG&f=1", "display_name": "BinX", "link": "https://stackoverflow.com/users/6401629/binx"}, "edited": false, "score": 0, "creation_date": 1482337128, "post_id": 41266625, "comment_id": 69735516, "body": "My text files are written in UTF-8 !"}], "tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 1, "last_activity_date": 1482338495, "last_edit_date": 1482338495, "creation_date": 1482334910, "answer_id": 41266625, "question_id": 41265571, "link": "https://stackoverflow.com/questions/41265571/how-to-change-multicharacter-signs-by-other-ones-in-c/41266625#41266625", "title": "How to change multicharacter signs by other ones in C?", "body": "<p>You're on the right track, but you need to look at characters differently than strings.</p>\n\n<pre><code>strcmp(carac[0], &amp;a[i])\n</code></pre>\n\n<p>(Pretending <code>i = 2</code>) As you know this compares the string <code>\"\u221e\"</code> with <code>&amp;a[2]</code>. But you forget that <code>&amp;a[2]</code> is the address of the second character of the string, and strcmp works by scanning the entire string until it hits a null terminator. So <code>\"\u221e\"</code> actually ends up getting compared with <code>\"abc\u221e\u222av=|)\"</code> because <code>a</code> is only null terminated at the very end.</p>\n\n<p>What you should do is not use strings, but expand each character (8 bits) to a short (16 bits). And then you can compare them with your UTF-16 characters</p>\n\n<pre><code>if( 8734 = *((short *)&amp;a[i])) { /* character is infinity */ }\n</code></pre>\n\n<p>The reason for that 8734 is because that's the <a href=\"http://www.fileformat.info/info/unicode/char/221e/index.htm\" rel=\"nofollow noreferrer\">UTF16 value of infinity</a>.</p>\n\n<p><strong>VERY IMPORTANT NOTE:</strong>\nDepending if your machine is big-endian or little-endian matters for this case. If 8734 (0x221E) does not work, give 7714 (0x1E22) a try.</p>\n\n<p><strong>Edit</strong> Something else I overlooked is you're scanning the entire string at once. \"%s: String of characters. This will read subsequent characters until a whitespace is found (whitespace characters are considered to be blank, newline and tab).\" (<a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_fscanf.htm\" rel=\"nofollow noreferrer\">source</a>)</p>\n\n<pre><code>//feof = false.\nfscanf(flot,\"%s\",&amp;a[i]); \n//feof = ture.\n</code></pre>\n\n<p>That means you never actually iterate. You need to go back and rethink your scanning procedure. </p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 6401629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d37306e5b00668cd2542ea98c048ee9?s=128&d=identicon&r=PG&f=1", "display_name": "BinX", "link": "https://stackoverflow.com/users/6401629/binx"}, "edited": false, "score": 0, "creation_date": 1482358010, "post_id": 41267752, "comment_id": 69746847, "body": "That really helped to solve my problem ! I&#39;ve just changed a few things in your code"}], "tags": [], "owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "is_accepted": true, "score": 4, "last_activity_date": 1482339216, "last_edit_date": 1482339216, "creation_date": 1482338471, "answer_id": 41267752, "question_id": 41265571, "link": "https://stackoverflow.com/questions/41265571/how-to-change-multicharacter-signs-by-other-ones-in-c/41267752#41267752", "title": "How to change multicharacter signs by other ones in C?", "body": "<p>First of all, get the terminology right. Proper terminology is a bit confusing, but at least other people will understand what you are talking about.</p>\n\n<p>In C, <code>char</code> is the same as <em>byte</em>. However, a <em>character</em> is something abstract like <code>\u221e</code> or <code>\u00a4</code> or <code>c</code>. One character may contain a few bytes (that is a few <code>char</code>s). Such characters are called multi-byte ones.</p>\n\n<p>Converting a character to a sequence of bytes (<em>encoding</em>) is not trivial. Different systems do it differently; some use <a href=\"https://en.wikipedia.org/wiki/UTF-8\" rel=\"nofollow noreferrer\">UTF-8</a>, while others may use <a href=\"https://en.wikipedia.org/wiki/UTF-16\" rel=\"nofollow noreferrer\">UTF-16</a> big-endian, UTF-16 little endian, a 8-bit <a href=\"https://en.wikipedia.org/wiki/Code_page\" rel=\"nofollow noreferrer\">codepage</a> or any other <em>encoding</em>.</p>\n\n<p>When your C program has something inside quotes, like <code>\"\u221e\"</code> - it's a C-string, that is, several <em>bytes</em> terminated by a zero byte. When your code uses <code>strcmp</code> to compare strings, it compares each byte of both strings, to make sure they are equal. So, if your source code and your input file use different encodings, the strings (byte sequences) won't match, even though you will see the same character when examining them!</p>\n\n<hr>\n\n<p>So, to rule out any encoding mismatches, you might want to use a sequence of bytes instead of a character in your source code. For example, if you know that your input file uses the UTF-8 encoding:</p>\n\n<pre><code>char *carac[]={\n    \"\\xe2\\x88\\x9e\", // \u221e\n    \"=\",\n    \"\\xe2\\x88\\xaa\"}; // \u222a\n</code></pre>\n\n<p>Alternatively, make sure the encodings (of your source code and your program's input file) are the same.</p>\n\n<hr>\n\n<p>Another, less subtle, problem: when comparing strings, you actually have a big string and a small string, and you want to check whether the big string starts with the small string. Here <code>strcmp</code> does the wrong thing! You must use <code>strncmp</code> here instead:</p>\n\n<pre><code>if (strncmp(carac[0], &amp;a[i], strlen(carac[0])) == 0)\n{\n    fprintf(flot3, \"\\xC2\\xA4\"\"c\"); // \u00a4c\n}\n</code></pre>\n\n<hr>\n\n<p>Another problem (actually, a major bug): the <code>fscanf</code> function reads a <strong>word</strong> (text delimited by spaces) from the input file. If you only examine the first byte in this word, the other bytes will not be processed. To fix, make a loop over all bytes:</p>\n\n<pre><code>fscanf(flot,\"%s\",a);\nfor (i = 0; a[i] != '\\0'; )\n{\n    if (strncmp(&amp;a[i], \"|(\", 2)) // start pattern\n    {\n        now_replacing = 1;\n        i += 2;\n        continue;\n    }\n    if (now_replacing)\n    {\n        if (strncmp(&amp;a[i], whatever, strlen(whatever)))\n        {\n            fprintf(...);\n            i += strlen(whatever);\n        }\n    }\n    else\n    {\n        fputc(a[i], output);\n        i += 1; // processed just one char\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 6401629, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5d37306e5b00668cd2542ea98c048ee9?s=128&d=identicon&r=PG&f=1", "display_name": "BinX", "link": "https://stackoverflow.com/users/6401629/binx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 41267752, "answer_count": 2, "score": 4, "last_activity_date": 1482339216, "creation_date": 1482331831, "last_edit_date": 1482338423, "question_id": 41265571, "link": "https://stackoverflow.com/questions/41265571/how-to-change-multicharacter-signs-by-other-ones-in-c", "title": "How to change multicharacter signs by other ones in C?", "body": "<p>I've got an <strong>UTF-8 text file containing several signs that i'd like to change by other ones</strong> (only those between |(  and |)  ), but the problem is that some of these signs are not considered as characters but as multi-character signs. (By this i mean they can't be put between '\u221e' but only like this \"\u221e\", so char * ?)</p>\n\n<p>Here is my textfile :</p>\n\n<pre><code>Text : |(abc\u221e\u222av=|)\n</code></pre>\n\n<p>For example :</p>\n\n<p><strong>\u221e</strong> should be changed by <strong>\u00a4c</strong></p>\n\n<p><strong>\u222a</strong> by <strong>\u00b8!</strong></p>\n\n<p><strong>=</strong> changed by <strong>\"</strong>  </p>\n\n<p>So as some signs(\u221e and \u222a) are multicharacters, i decided to use fscanf to get all the text word by word. The problem with this method is that I have to put space between each character ... My file should look like this :</p>\n\n<pre><code>Text : |( a b c \u221e \u222a v = |)\n</code></pre>\n\n<p>fgetc can't be used because characters like \u221e can't be considered as one single character.If i use it I won't be able to strcmp a char with each sign (char * ), i tried to convert my char to char* but strcmp !=0.</p>\n\n<p>Here is my code in C to help you understanding my problem :</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(void){\n    char *carac[]={\"\u221e\",\"=\",\"\u222a\"}; //array with our signs\n    FILE *flot,*flot3;\n    flot=fopen(\"fichierdeTest2.txt\",\"r\"); // input text file\n    flot3=fopen(\"resultat.txt\",\"w\"); //output file\n    int i=0,j=0;\n    char a[1024]; //array that will contain each read word.\n    while(!feof(flot))\n    {\n        fscanf(flot,\"%s\",&amp;a[i]);\n        if (strstr(&amp;a[i], \"|(\") != NULL){ // if the word read contains |(  then j=1\n            j=1;\n            fprintf(flot3,\"|(\");\n        }\n        if (strcmp(&amp;a[i], \"|)\") == 0)\n            j=0;\n        if(j==1) { //it means we are between |( and |) so the conversion can begin\n            if (strcmp(carac[0], &amp;a[i]) == 0) { fprintf(flot3, \"\u00a4c\"); }\n            else if (strcmp(carac[1], &amp;a[i]) == 0) { fprintf(flot3,\"\\\"\" ); }\n            else if (strcmp(carac[2], &amp;a[i]) == 0) { fprintf(flot3, \" \u00b8!\"); }\n            else fprintf(flot3,\"%s\",&amp;a[i]); // when it's a letter, number or sign that doesn't need to be converted\n        }\n        else { // when we are not between |( and |) just copy the word to the output file with a space after it\n            fprintf(flot3, \"%s\", &amp;a[i]);\n            fprintf(flot3, \" \");\n        }\n        i++;\n    }\n}\n</code></pre>\n\n<p>Thanks a lot for the future help !</p>\n\n<p><strong>EDIT :</strong> Every sign will be changed correctly if i put a space between each them but without ,it won't work, that's what i'm trying to solve.</p>\n"}, {"tags": ["c", "newline", "string-formatting", "fgets"], "comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 1, "creation_date": 1482331353, "post_id": 41265333, "comment_id": 69731501, "body": "Are there 2 characters (<code>&#39;\\&#39;</code> and <code>&#39;n&#39;</code>) or 1 character (<code>&#39;\\n&#39;</code>) in the file?"}, {"owner": {"reputation": 202, "user_id": 7207370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295d4f0c4d7c66572dcc0b0740b01edb?s=128&d=identicon&r=PG", "display_name": "Speedphoenix", "link": "https://stackoverflow.com/users/7207370/speedphoenix"}, "edited": false, "score": 0, "creation_date": 1482332053, "post_id": 41265333, "comment_id": 69731963, "body": "in the file it&#39;s written as \\n I also tried addint \\\\ or \\t in the file but it would print \\\\ and \\t instead of a tabulation or a single back-slash"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482333516, "post_id": 41265333, "comment_id": 69732964, "body": "<code>&#39;\\n&#39;</code> <b>is</b> the linebreak/newline character. I don&#39;t see a problem at all. <b>Never ever</b> use a string from external source as <code>printf</code> format string! That is one of the most typical security holes in C."}], "answers": [{"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 202, "user_id": 7207370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295d4f0c4d7c66572dcc0b0740b01edb?s=128&d=identicon&r=PG", "display_name": "Speedphoenix", "link": "https://stackoverflow.com/users/7207370/speedphoenix"}, "edited": false, "score": 0, "creation_date": 1482332132, "post_id": 41265421, "comment_id": 69732011, "body": "@LeonardoJeanteur So it&#39;s the single character \\ followed by the single character n? That&#39;s what I mean, the run-time library or any existing standard string function don&#39;t translate it to a newline. You have to do that translation yourself."}, {"owner": {"reputation": 202, "user_id": 7207370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295d4f0c4d7c66572dcc0b0740b01edb?s=128&d=identicon&r=PG", "display_name": "Speedphoenix", "link": "https://stackoverflow.com/users/7207370/speedphoenix"}, "edited": false, "score": 0, "creation_date": 1482332332, "post_id": 41265421, "comment_id": 69732149, "body": "I missread your answer sorry. I deleted my comment, thank you for your answer"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1482331346, "creation_date": 1482331346, "answer_id": 41265421, "question_id": 41265333, "link": "https://stackoverflow.com/questions/41265333/c-how-to-make-fgets-read-a-n-line-break-from-a-file/41265421#41265421", "title": "C: How to make fgets read a \\n line break from a file?", "body": "<p>That's because escape characters in string and character literals are handled by the <em>compiler</em> when it parses your code. It's not something that exists in the library or run-time code for all strings.</p>\n\n<p>If you want to translate e.g. the <em>two</em> characters <code>\\n</code> that you read from a file, then you need to handle it yourself in your code. For example by going over the string character by character and looking for <code>'\\\\'</code> followed by <code>'n'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44, "user_id": 5569509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d4d86e0fabcfe649fefa7d3b9f50a?s=128&d=identicon&r=PG&f=1", "display_name": "Hast", "link": "https://stackoverflow.com/users/5569509/hast"}, "is_accepted": true, "score": 3, "last_activity_date": 1482331642, "creation_date": 1482331642, "answer_id": 41265516, "question_id": 41265333, "link": "https://stackoverflow.com/questions/41265333/c-how-to-make-fgets-read-a-n-line-break-from-a-file/41265516#41265516", "title": "C: How to make fgets read a \\n line break from a file?", "body": "<p>fgets just sees the \\ and the n as normal characters.\nYou have to translate it by your self to a linefeed character. Maybe with help of strstr() or similar.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482339838, "post_id": 41267155, "comment_id": 69737102, "body": "When end-of-file is encountered and <code>gets()</code> returns <code>EOF</code>, this code will assigned <code>EOF</code> to <code>str[i++]</code> as if it was a character.  Not good programming.  Check the result of <code>fgetc()</code> like <code>int ch = fgetc(); if (ch == EOF) break; str[i++] = ch;</code>.  BTW <code>feof(fic)</code> is not needed here as it has detected problems too late."}], "tags": [], "owner": {"reputation": 1, "user_id": 7326269, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MRpvgGUc_T4/AAAAAAAAAAI/AAAAAAAAAEQ/4z7Gvq4V6s0/photo.jpg?sz=128", "display_name": "siddhesh amrale", "link": "https://stackoverflow.com/users/7326269/siddhesh-amrale"}, "is_accepted": false, "score": 0, "last_activity_date": 1482342908, "last_edit_date": 1482342908, "creation_date": 1482336457, "answer_id": 41267155, "question_id": 41265333, "link": "https://stackoverflow.com/questions/41265333/c-how-to-make-fgets-read-a-n-line-break-from-a-file/41267155#41267155", "title": "C: How to make fgets read a \\n line break from a file?", "body": "<p>The compiler is scanning the text file and storing the data/text as it is in str string. The compiler does not take <code>\\n</code> as an escape sequence. So if you want to go to the next line whenever <code>\\n</code> appears then you should scan character by character, and if <code>\\n</code> appears you should <code>printf(\"\\n\")</code>. </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    char str[30];\n    int i = 0;\n    FILE *fic = NULL;\n    fic = fopen(\"text.txt\", \"r\");\n    while(!feof(fic)){\n        str[i++] = getc(fic);\n        if(i &gt; 30){    //Exit the loop to avoid writing outside of the string\n            break;\n        }\n    }\n    str[i - 1] = '\\0';\n    fclose(fic);\n\n    for(i = 0; str[i] != '\\0'; i++){\n        if(str[i] == 'n' &amp;&amp; str[i - 1] == '\\\\'){\n            printf(\"\\n\");\n            continue;\n        }\n        if(str[i] == '\\\\' &amp;&amp; str[i + 1] == 'n'){\n            printf(\"\\n\");\n            continue;\n        }\n        printf(\"%c\",str[i]);\n    }\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 202, "user_id": 7207370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/295d4f0c4d7c66572dcc0b0740b01edb?s=128&d=identicon&r=PG", "display_name": "Speedphoenix", "link": "https://stackoverflow.com/users/7207370/speedphoenix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2175, "favorite_count": 0, "accepted_answer_id": 41265516, "answer_count": 3, "score": 0, "last_activity_date": 1482342908, "creation_date": 1482331092, "last_edit_date": 1482332523, "question_id": 41265333, "link": "https://stackoverflow.com/questions/41265333/c-how-to-make-fgets-read-a-n-line-break-from-a-file", "title": "C: How to make fgets read a \\n line break from a file?", "body": "<p>I have a program (console), where I put all the text in a separate .txt file.</p>\n\n<p>I use <code>fgets()</code> to read a string from the file, but when the file contains a \\n and I later print the string, it prints \\n instead of a linebreak</p>\n\n<p>Here is an example:</p>\n\n<pre><code>FILE* fic = NULL;\nchar str[22]; //str is the string we will use\n\n//open the file\nfic = fopen (\"text.txt\", \"r\");\n\n//read from the file\nfgets(str, size, fic);\n\nprintf(str);\n</code></pre>\n\n<p>If this is what I have in my text.txt:</p>\n\n<pre><code>This is \\n an example\n</code></pre>\n\n<p>However what comes out on the console is</p>\n\n<pre><code>This is \\n an example\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>This is \n an example\n</code></pre>\n\n<p><strong>Edit:</strong>\nin the file it's written as \\n. I also tried addint \\ or \\t in the file but it would print \\ and \\t instead of a tabulation or a single back-slash</p>\n"}, {"tags": ["c", "int"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1482331030, "post_id": 41265244, "comment_id": 69731280, "body": "No, you can&#39;t.."}, {"owner": {"reputation": 62488, "user_id": 45249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/81039d357ce18bee9dd8fac6c1c56290?s=128&d=identicon&r=PG", "display_name": "mouviciel", "link": "https://stackoverflow.com/users/45249/mouviciel"}, "edited": false, "score": 0, "creation_date": 1482331035, "post_id": 41265244, "comment_id": 69731288, "body": "The difficult part would be to redefine arithmetic operators for these types."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482331053, "post_id": 41265244, "comment_id": 69731300, "body": "Can someone post a generalized answer saying why or why not?"}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 1, "creation_date": 1482331161, "post_id": 41265244, "comment_id": 69731372, "body": "Do you have a brick in your backpack? No? Why not? Because you just don&#39;t have it!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "edited": false, "score": 1, "creation_date": 1482332814, "post_id": 41265244, "comment_id": 69732486, "body": "I assume by &quot;complex&quot; you mean complicated, rather than functions taking <code>std::complex&lt;double&gt;</code> or such?"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 2, "creation_date": 1482333061, "post_id": 41265244, "comment_id": 69732685, "body": "@Hurkyl, in C there is no <code>std::complex&lt;double&gt;</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1084944"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1482333216, "post_id": 41265244, "comment_id": 69732779, "body": "@Colin: It does have the &quot;or such&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 4, "creation_date": 1482331104, "post_id": 41265317, "comment_id": 69731329, "body": "This isn&#39;t standard C. You can&#39;t portably use <code>uint8_t</code> for bit-fields."}, {"owner": {"reputation": 44802, "user_id": 2752075, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5oQlf.png?s=128&g=1", "display_name": "HolyBlackCat", "link": "https://stackoverflow.com/users/2752075/holyblackcat"}, "edited": false, "score": 2, "creation_date": 1482332066, "post_id": 41265317, "comment_id": 69731972, "body": "Here is a standard reference for that: <code>C11  6.7.2.1  5</code> <i>&quot;A bit-field shall have a type that is a qualified or unqualified version of <code>_Bool</code>, <code>signed int</code>, <code>unsigned int</code>, or some other implementation-defined type. It is implementation-defined whether atomic types are permitted.&quot;</i> This restriction was lifted in C++: <code>C++14  9.6  3</code> <i>&quot;... A bit-field shall have integral or enumeration type ...&quot;</i>."}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1482332486, "post_id": 41265317, "comment_id": 69732254, "body": "@Lundin Thanks, Both, Updated."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482334156, "post_id": 41265317, "comment_id": 69733422, "body": "@Colin__s if I pack this structure, will it take up 4 bits?"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1482334226, "post_id": 41265317, "comment_id": 69733475, "body": "@MarkYisri, no, it will take up at minimum the <code>sizeof(unsigned int)</code>.  <code>sizeof(char)</code> is 1 due to the standard, and char bits is at minimum 8 due to the standard."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482334265, "post_id": 41265317, "comment_id": 69733507, "body": "@Colin__s then what is the use of a bitfield?"}, {"owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1482334327, "post_id": 41265317, "comment_id": 69733557, "body": "@MarkYisri you could pack 8 * 4 bit values inside one 32 bit value without having to do the bit twiddling yourself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482334392, "post_id": 41265317, "comment_id": 69733595, "body": "@Colin__s and then do a bitmask to ensure only the correct 4 bits are visible?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "reply_to_user": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "edited": false, "score": 0, "creation_date": 1482334396, "post_id": 41265317, "comment_id": 69733600, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/131169/discussion-between-mark-yisri-and-colin-s\">continue this discussion in chat</a>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482341241, "post_id": 41265317, "comment_id": 69737849, "body": "This answer does not address OP&#39;s 1st half question &quot;Is there a general way in C to make a number greater than 64 bits ...?&quot;.  Curious that this answer is accepted."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482408233, "post_id": 41265317, "comment_id": 69767140, "body": "@chux I accepted it because he says that you cannot make it smaller in his answer. &quot;<i>but, the base datatype they&#39;re stored in will not be any smaller.</i>&quot;"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482419888, "post_id": 41265317, "comment_id": 69774496, "body": "@MarkYisri Hmm. &quot;but, the base datatype they&#39;re stored in will not be any smaller.&quot; does not address the issue to &quot;Is there a general way in C to make a number greater than 64 bits ...?&quot;  Oh, well."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "reply_to_user": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482493187, "post_id": 41265317, "comment_id": 69803779, "body": "@chux my question also has &quot;<i>or smaller than 8 bits?</i>&quot;"}], "tags": [], "owner": {"reputation": 3123, "user_id": 2097041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8L21m.jpg?s=128&g=1", "display_name": "Colin", "link": "https://stackoverflow.com/users/2097041/colin"}, "is_accepted": true, "score": 2, "last_activity_date": 1482332434, "last_edit_date": 1482332434, "creation_date": 1482331056, "answer_id": 41265317, "question_id": 41265244, "link": "https://stackoverflow.com/questions/41265244/is-there-a-general-way-in-c-to-make-a-number-greater-than-64-bits-or-smaller-tha/41265317#41265317", "title": "Is there a general way in C to make a number greater than 64 bits or smaller than 8 bits?", "body": "<p>You can use bitfields within a structure to get fields narrower than a uint8_t, but, the base datatype they're stored in will not be any smaller.</p>\n\n<pre><code>struct SmallInt\n{\n   unsigned int a : 4;\n};\n</code></pre>\n\n<p>will give you a structure with a member called a that is 4 bits wide.</p>\n"}, {"tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 2, "last_activity_date": 1482342103, "last_edit_date": 1495539961, "creation_date": 1482332603, "answer_id": 41265826, "question_id": 41265244, "link": "https://stackoverflow.com/questions/41265244/is-there-a-general-way-in-c-to-make-a-number-greater-than-64-bits-or-smaller-tha/41265826#41265826", "title": "Is there a general way in C to make a number greater than 64 bits or smaller than 8 bits?", "body": "<p>In practice, if you want very wide numbers (but that is <em>not specified</em> in standard C11) you probably want to use some <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">arbitrary-precision</a> arithmetic <em>external</em> library (a.k.a. bignums). I recommend using <a href=\"http://gmplib.org/\" rel=\"nofollow noreferrer\">GMPlib</a>.</p>\n\n<p>In some cases, for tiny ranges of numbers, you might use bitfields inside <code>struct</code> to have tiny integers. Practically speaking, they can be costly (the compiler would emit shift and bitmask instructions to deal with them). </p>\n\n<p>See also <a href=\"https://stackoverflow.com/a/41267512/841108\">this answer</a> mentioning <code>__int128_t</code> as an extension in some compilers.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "edited": false, "score": 0, "creation_date": 1482334130, "post_id": 41265924, "comment_id": 69733403, "body": "can GMP do 4 bits?"}, {"owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "edited": false, "score": 0, "creation_date": 1482334897, "post_id": 41265924, "comment_id": 69733943, "body": "@MarkYisri: It can certainly represent <i>values</i> that are at most 4 bits wide, but so can the native integer types.  Again, no <i>object</i> can be less than 8 bits wide.  MP libraries are geared more for working with values that <i>can&#39;t</i> fit in the native types."}], "tags": [], "owner": {"reputation": 105028, "user_id": 134554, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1894f68e0b15fd3d5b27bfcb021fa11c?s=128&d=identicon&r=PG", "display_name": "John Bode", "link": "https://stackoverflow.com/users/134554/john-bode"}, "is_accepted": false, "score": 3, "last_activity_date": 1482332925, "last_edit_date": 1482332925, "creation_date": 1482332860, "answer_id": 41265924, "question_id": 41265244, "link": "https://stackoverflow.com/questions/41265244/is-there-a-general-way-in-c-to-make-a-number-greater-than-64-bits-or-smaller-tha/41265924#41265924", "title": "Is there a general way in C to make a number greater than 64 bits or smaller than 8 bits?", "body": "<p>Individual storage units (bytes) are no less than <code>CHAR_BITS</code> bits wide<sup>1</sup>; even if you create a <code>struct</code> with a single 4-bit bitfield, the associated object will always take up a full storage unit. </p>\n\n<p>There are multiple precision libraries such as <a href=\"https://gmplib.org/\" rel=\"nofollow noreferrer\">GMP</a> that allow you to work with values that can't fit into 32 or 64 bits.  Might want to check them out.  </p>\n\n<p><hr>\n<sup></p>\n\n<ol>\n<li>8 bits minimum, but may be wider.\n</ol>\n\n<p></sup></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6754053"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "accepted_answer_id": 41265317, "answer_count": 3, "score": -2, "last_activity_date": 1482342103, "creation_date": 1482330827, "question_id": 41265244, "link": "https://stackoverflow.com/questions/41265244/is-there-a-general-way-in-c-to-make-a-number-greater-than-64-bits-or-smaller-tha", "title": "Is there a general way in C to make a number greater than 64 bits or smaller than 8 bits?", "body": "<blockquote>\n  <p>First of all, I am aware that what I am trying to do might be outside the C standard.</p>\n</blockquote>\n\n<p>I'd like to know if it is possible to make a <code>uint4_t</code>/<code>int4_t</code> or <code>uint128_t</code>/<code>int128_t</code> type in C.</p>\n\n<p>I know I could do this using bitshifts and complex functions, but can I do it without those?</p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482330873, "post_id": 41265207, "comment_id": 69731173, "body": "<code>structarr</code> is of type <code>char *</code>, did you mean <code>structvar</code>?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482330899, "post_id": 41265207, "comment_id": 69731192, "body": "Unrelated to your problem, but your loop reading input will require the user to input the same data <i>twice</i>."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1482330976, "post_id": 41265207, "comment_id": 69731243, "body": "Since none of the function parameters is a struct, this question doesn&#39;t make any sense. Please edit it so it becomes clear what you mean."}, {"owner": {"reputation": 461, "user_id": 6466848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/641805695972642/picture?type=large", "display_name": "angry somoan", "link": "https://stackoverflow.com/users/6466848/angry-somoan"}, "edited": false, "score": 0, "creation_date": 1482331240, "post_id": 41265207, "comment_id": 69731430, "body": "i really don&#39;t know how to name it. I wanted to be able to specify struct members in function arguments to append strings to them."}], "answers": [{"comments": [{"owner": {"reputation": 461, "user_id": 6466848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/641805695972642/picture?type=large", "display_name": "angry somoan", "link": "https://stackoverflow.com/users/6466848/angry-somoan"}, "edited": false, "score": 0, "creation_date": 1482331407, "post_id": 41265363, "comment_id": 69731540, "body": "That&#39;s something I ican work on! So it isn&#39;t possible to pass member (in this example above member &#39;city&#39;) in function arguments?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 461, "user_id": 6466848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/641805695972642/picture?type=large", "display_name": "angry somoan", "link": "https://stackoverflow.com/users/6466848/angry-somoan"}, "edited": false, "score": 0, "creation_date": 1482331459, "post_id": 41265363, "comment_id": 69731577, "body": "@angrysomoan No it&#39;s not possible to pass the symbol of a member."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 0, "last_activity_date": 1482331175, "creation_date": 1482331175, "answer_id": 41265363, "question_id": 41265207, "link": "https://stackoverflow.com/questions/41265207/struct-variable-and-struct-member-in-function-definition/41265363#41265363", "title": "Struct variable and struct member in function definition", "body": "<p>As for your problem (as I understand it), it really can't be done. Consider making the <code>takeString</code> function only take a single string argument, and read input into that string.</p>\n\n<p>Then pass the correct string from the array and structure to the function. This can be done by <em>another</em> function which takes a pointer (or index) to the structure to read.</p>\n\n<p>Perhaps something like this pseudo-code:</p>\n\n<pre><code>void takeString(char *string)\n{\n    scanf(\"...\", string);\n}\n\nvoid takeStructure(int arrayIndex)\n{\n    ...\n    takeString(gifts[arrayIndex].city);\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 461, "user_id": 6466848, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/641805695972642/picture?type=large", "display_name": "angry somoan", "link": "https://stackoverflow.com/users/6466848/angry-somoan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 41265363, "answer_count": 1, "score": -1, "last_activity_date": 1482331175, "creation_date": 1482330744, "question_id": 41265207, "link": "https://stackoverflow.com/questions/41265207/struct-variable-and-struct-member-in-function-definition", "title": "Struct variable and struct member in function definition", "body": "<p>Consider the code:</p>\n\n<pre><code>#define STRINGMAX 50\n\nstruct GIFTS {\n    char whofor[STRINGMAX];\n    char city[STRINGMAX];\n    float weight;\n    struct DIMENSIONS {\n        float width;\n        float length;\n        float height;\n    } dim;\n} gifts[STRINGMAX];\n</code></pre>\n\n<p>And function definition:</p>\n\n<pre><code>void takeString(char * structvar, char structarr[], int arrpos) {\n    while (scanf(\"%[^\\n]%*c]\", structarr[arrpos].structvar) != EOF) {\n        scanf(\"%[^\\n]%*c]\", structarr[arrpos].structvar);\n    }\n\n}\n</code></pre>\n\n<p>It gives me an error: </p>\n\n<blockquote>\n  <p>request for member \u2018structvar\u2019 in something not a structure or union</p>\n</blockquote>\n\n<p>Is there any way to pass a struct member in this case? I've seen some similar topics here about doing that, but i wasn't able to introduce that ideas into my code (I'm a complete C beginner).\nI would appreciate any help, especially an clear example in code.</p>\n\n<p>Btw. I know i shouldn't use scanf, but it's just for example. I'll do something else when I'll know how to pass the struct member in function parameter.</p>\n"}, {"tags": ["c++", "c", "encoding", "base64"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482330033, "post_id": 41264901, "comment_id": 69730573, "body": "Be careful with <code>malloc(0)</code>. It&#39;s implementation defined if it will return a null pointer or a non-null pointer."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 3, "creation_date": 1482330063, "post_id": 41264901, "comment_id": 69730589, "body": "Can you elaborate the &quot;it doesn&#39;t work&quot;-part?"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482330098, "post_id": 41264901, "comment_id": 69730608, "body": "the output that is given doesn&#39;t match the expected output.."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330223, "post_id": 41264901, "comment_id": 69730701, "body": "I think, it is just an encoding problem... try to save the source file as utf-8 and see, if the problem vanishes"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482330247, "post_id": 41264901, "comment_id": 69730721, "body": "Have you tried stepping through the code line by line in a debugger, while monitoring variables and their values? Also, please don&#39;t post images of text. Copy-paste the actual text as text."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330289, "post_id": 41264901, "comment_id": 69730750, "body": "<code>echo &quot;aOnsbG9=&quot; | recode base64..data | recode latin1..utf8</code> results in <code>h&#233;&#236;lo</code>"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482330313, "post_id": 41264901, "comment_id": 69730770, "body": "please explain how I can save the source file as utf-8 on vs2010 professional cause i&#39;m unsure how to do it?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330496, "post_id": 41264901, "comment_id": 69730895, "body": "Hm, wait a minute, does the data come from the file <code>hello.txt</code>? Then you will have to save <i>that</i> as utf-8. I assumed, that the source is <code>*str1</code> before..."}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330502, "post_id": 41264901, "comment_id": 69730898, "body": "@Ctx, when i use an online base64 decoder, it results in <code>hlo</code>"}, {"owner": {"reputation": 5006, "user_id": 289099, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kFqGO.jpg?s=128&g=1", "display_name": "pattivacek", "link": "https://stackoverflow.com/users/289099/pattivacek"}, "edited": false, "score": 0, "creation_date": 1482330526, "post_id": 41264901, "comment_id": 69730919, "body": "Re: VS source file encoding: <a href=\"http://stackoverflow.com/questions/840065/how-to-change-source-file-encoding-in-csharp-project-visual-studio-msbuild-ma\" title=\"how to change source file encoding in csharp project visual studio msbuild ma\">stackoverflow.com/questions/840065/&hellip;</a>"}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1482330532, "post_id": 41264901, "comment_id": 69730922, "body": "@Hawk I would recommend Notepad++ for this task. In VS2010 you should be able to call &quot;File-&gt;Save File as&quot; and there click on the little arrow on the &quot;Save&quot;-Button and select &quot;Save with Encoding&quot;"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1482330640, "post_id": 41264901, "comment_id": 69730997, "body": "@SimonKraemer, i saved the <code>.txt</code> file using notepad++.."}, {"owner": {"reputation": 5013, "user_id": 4181011, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0C2A9.jpg?s=128&g=1", "display_name": "Simon Kraemer", "link": "https://stackoverflow.com/users/4181011/simon-kraemer"}, "edited": false, "score": 0, "creation_date": 1482330797, "post_id": 41264901, "comment_id": 69731106, "body": "With the correct encoding? You can change it in the &quot;Encoding&quot; menu"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330799, "post_id": 41264901, "comment_id": 69731108, "body": "@Hawk But did you make sure that it is saved as utf-8?"}, {"owner": {"reputation": 3590, "user_id": 2700399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f6zBy.jpg?s=128&g=1", "display_name": "Bart van Nierop", "link": "https://stackoverflow.com/users/2700399/bart-van-nierop"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330800, "post_id": 41264901, "comment_id": 69731109, "body": "@Ctx there seems to be an issue there, <i>h&#233;&#236;lo</i>, UTF-8 encoded, is <code>aMOpw6xsbw==</code> in base64."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 3590, "user_id": 2700399, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/f6zBy.jpg?s=128&g=1", "display_name": "Bart van Nierop", "link": "https://stackoverflow.com/users/2700399/bart-van-nierop"}, "edited": false, "score": 0, "creation_date": 1482330870, "post_id": 41264901, "comment_id": 69731168, "body": "@BartvanNierop Yes it is... I am not sure if I understand what you want to express?"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482330870, "post_id": 41264901, "comment_id": 69731169, "body": "@Ctx, saved it as <code>Unicode(utf-8 without signature) -Codepage 65001</code>, all files just saved as that..got a new output."}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482330964, "post_id": 41264901, "comment_id": 69731231, "body": "the output still differs from expected output..and now when i decode online, i get <code>hllo</code> so only the special char missing"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482331351, "post_id": 41264901, "comment_id": 69731498, "body": "@Hawk My suspicion is still, that the source file is not properly utf-8 encoded... the <code>&#233;</code> should be encoded as <code>c3 a9</code>, while it seems to be encoded as <code>c3 e9</code>. Please make sure, that <code>hello.txt</code> is properly encoded (for example with a hexeditor)"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482331450, "post_id": 41264901, "comment_id": 69731568, "body": "@Ctx, even when i try to hardcode the non-ascii string into the program, it still doesn&#39;t output the correct encoding. When i use a different encoder and the same file, it works.."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482331518, "post_id": 41264901, "comment_id": 69731613, "body": "Can you upload the file hello.txt somewhere?"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482332147, "post_id": 41264901, "comment_id": 69732019, "body": "<a href=\"http://m.uploadedit.com/ba3s/1482332062143.txt\" rel=\"nofollow noreferrer\">m.uploadedit.com/ba3s/1482332062143.txt</a>  link to uploaded file"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1482332977, "post_id": 41264901, "comment_id": 69732609, "body": "<code>aMPpbGxv</code> is <i>NOT</i> UTF-8."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482333332, "post_id": 41264901, "comment_id": 69732857, "body": "@Hawk The file seems to be valid utf-8... I honestly do not know where this breaks then, assumed, that the file you uploaded is guaranteed unmodified the file you use. One last guess: try <code>fopen(&quot;hello.txt&quot;, &quot;rbB&quot;);</code>and see if that changes something"}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482333768, "post_id": 41264901, "comment_id": 69733137, "body": "i get Invalid FileOpen mode, some runtime error from vs.."}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1482333816, "post_id": 41264901, "comment_id": 69733177, "body": "@SamVarshavchik, that is the encoded format of the file i am encoding. It doesn&#39;t encode the special characters located within"}, {"owner": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1482333990, "post_id": 41264901, "comment_id": 69733306, "body": "Well, whatever encoded format that is, it&#39;s not UTF-8. <code>h&#233;llo</code> in UTF-8 and base64-encoded is <code>aMOpbGxv</code>. There&#39;s no issue with the shown C++ code. You have an issue with properly encoding the file, which is outside the scope of this question. This has nothing to do with C++."}, {"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "reply_to_user": {"reputation": 83151, "user_id": 3943312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc00b38b94ca7b6f820622b0a8af8ded?s=128&d=identicon&r=PG", "display_name": "Sam Varshavchik", "link": "https://stackoverflow.com/users/3943312/sam-varshavchik"}, "edited": false, "score": 0, "creation_date": 1482334073, "post_id": 41264901, "comment_id": 69733364, "body": "@SamVarshavchik, when i use a different C library and the same file, it prints the expected output so I highly doubt the issue is in the file.."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482334320, "post_id": 41264901, "comment_id": 69733553, "body": "Another guess: Maybe a typo in the <code>b64_table</code>? Can you show this table, too?"}], "answers": [{"comments": [{"owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "edited": false, "score": 0, "creation_date": 1482338729, "post_id": 41266696, "comment_id": 69736481, "body": "damn..thanks a lot..finally..all this time i was stressing out..appreciate the time you took to look through it.."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 3, "last_activity_date": 1482335078, "creation_date": 1482335078, "answer_id": 41266696, "question_id": 41264901, "link": "https://stackoverflow.com/questions/41264901/base64-doesnt-work-when-encoding-special-characters/41266696#41266696", "title": "Base64 doesn&#39;t work when encoding special characters", "body": "<p>The problem lies in the function b64_encode:</p>\n\n<pre><code>buf[2]=( ( tmp[1]&amp;0x0f )&lt;&lt;2 )+( ( tmp[1]&amp;0xc0 )&gt;&gt;6 );\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>buf[2]=( ( tmp[1]&amp;0x0f )&lt;&lt;2 )+( ( tmp[2]&amp;0xc0 )&gt;&gt;6 );\n</code></pre>\n\n<p>Be sure to fix this at both ocurrences.</p>\n"}], "owner": {"reputation": 132, "user_id": 2968769, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/bshT1.jpg?s=128&g=1", "display_name": "Hawk", "link": "https://stackoverflow.com/users/2968769/hawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 847, "favorite_count": 0, "accepted_answer_id": 41266696, "answer_count": 1, "score": 2, "last_activity_date": 1482335078, "creation_date": 1482329854, "last_edit_date": 1482330923, "question_id": 41264901, "link": "https://stackoverflow.com/questions/41264901/base64-doesnt-work-when-encoding-special-characters", "title": "Base64 doesn&#39;t work when encoding special characters", "body": "<p>I am working with a base64 library that I found on GitHub <a href=\"https://github.com/littlstar/b64.c\" rel=\"nofollow noreferrer\">Link to b64.c</a> and it works okay when I am encoding ascii strings but when I try to encode a binary file such as an image, it doesn't work. Below is the code snippet I am using to read in the file.</p>\n\n<p><strong>hello.txt</strong></p>\n\n<pre><code>h\u00e9llo\n</code></pre>\n\n<p>hello.txt has the only one special character. It works okay if the special character was just a regular character.</p>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>int main()\n{\n    FILE *fp=NULL;\n    char *buf=NULL, *str1=\"h\u00e9llo\", *str2=\"hello\";\n    int i=0;\n    size_t fsize=0, bytes_read=0;\n\n    fp=fopen(\"hello.txt\", \"rb\");\n    fseek(fp, 0, SEEK_END);\n    fsize=ftell(fp);\n    rewind(fp);\n    buf=(char*)malloc(sizeof(char)*(fsize));\n    //buf[fsize]='\\0';\n    bytes_read=fread(buf, 1, fsize, fp);\n    if( bytes_read!=fsize ) exit(-1);\n    fclose(fp);\n    printf(\"encoded=%s\\n\", b64_encode((const unsigned char*)buf, fsize));\n\n    getchar();\n    return 0;\n}\n</code></pre>\n\n<p><strong>encode.c // has the function base64_encode</strong></p>\n\n<pre><code>char *b64_encode(const unsigned char* src, size_t len)\n{\n    int i=0, j=0;\n    char *enc=NULL;\n    size_t size=0;\n    unsigned char buf[4], tmp[3];\n\n    // alloc\n    enc=(char*)malloc(0);\n    if( enc==NULL )\n    {\n        perror(\"enc\");\n\n        return NULL;\n    }\n\n    while( len-- )\n    {\n        tmp[i++]=*(src++);\n        if( i==3 )\n        {\n            buf[0]=( tmp[0]&amp;0xfc )&gt;&gt;2;\n            buf[1]=( ( tmp[0]&amp;0x03 )&lt;&lt;4 )+( ( tmp[1]&amp;0xf0 )&gt;&gt;4 );\n            buf[2]=( ( tmp[1]&amp;0x0f )&lt;&lt;2 )+( ( tmp[1]&amp;0xc0 )&gt;&gt;6 );\n            buf[3]=tmp[2]&amp;0x3f;\n\n            /*\n             * alloc 4 bytes for 'enc' and then translate\n             * each encoded buffer part by index from\n             * the base64 table into 'enc' unsigned char array\n            */\n            enc=(char*)realloc(enc, size+4);\n            for( i=0; i&lt;4; ++i )\n            {\n                enc[size++]=b64_table[buf[i]];\n            }\n\n            // reset index\n            i=0;\n        }\n    }\n\n    if( i&gt;0 )\n    {\n        // fill 'tmp' with '\\0' at most 3 times\n        for( j=i; j&lt;3; ++j )\n        {\n            tmp[j]='\\0';\n        }\n\n        // perform same codes as above\n        buf[0]=( tmp[0]&amp;0xfc )&gt;&gt;2;\n        buf[1]=( ( tmp[0]&amp;0x03 )&lt;&lt;4 )+( ( tmp[1]&amp;0xf0 )&gt;&gt;4 );\n        buf[2]=( ( tmp[1]&amp;0x0f )&lt;&lt;2 )+( ( tmp[1]&amp;0xc0 )&gt;&gt;6 );\n        buf[3]=tmp[2]&amp;0x3f;\n\n        // same write to enc with new allocation\n        for( j=0; j&lt;i+1; ++j )\n        {\n            enc=(char*)realloc(enc, size+1);\n            enc[size++]=b64_table[buf[j]];\n        }\n\n        while( ( i++ )&lt;3 )\n        {\n            enc=(char*)realloc(enc, size+1);\n            enc[size++]='=';\n        }\n    }\n\n    enc=(char*)realloc(enc, size+1);\n    enc[size]='\\0';\n\n    return enc;\n}\n</code></pre>\n\n<p><strong>ouput by program</strong></p>\n\n<pre><code>aOnsbG9=\n</code></pre>\n\n<p><strong>after saving with utf-8</strong></p>\n\n<pre><code>aMPpbGxv  \n</code></pre>\n\n<p><strong>expected output</strong></p>\n\n<pre><code>aMOpbGxv\n</code></pre>\n\n<p><strong>PS. I read the file in as binary since it has special characters and because later on I would like to read in binary data such as images or videos.</strong></p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482329528, "post_id": 41264761, "comment_id": 69730229, "body": "and <code>strtok()</code>, maybe"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482329563, "post_id": 41264761, "comment_id": 69730253, "body": "This &quot;how&quot; is too broad, VTC. Also, show your efforts till time.,"}, {"owner": {"reputation": 44, "user_id": 5569509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d4d86e0fabcfe649fefa7d3b9f50a?s=128&d=identicon&r=PG&f=1", "display_name": "Hast", "link": "https://stackoverflow.com/users/5569509/hast"}, "edited": false, "score": 0, "creation_date": 1482329835, "post_id": 41264761, "comment_id": 69730442, "body": "See this one <a href=\"http://stackoverflow.com/questions/9210528/split-string-with-delimiters-in-c\" title=\"split string with delimiters in c\">stackoverflow.com/questions/9210528/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 5568230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d108b055440cb6ff73ac628540133cc9?s=128&d=identicon&r=PG&f=1", "display_name": "Salai Dhiraviyam", "link": "https://stackoverflow.com/users/5568230/salai-dhiraviyam"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1482331162, "post_id": 41264761, "comment_id": 69731373, "body": "@SouravGhosh, Thank you. strtok() function full fill the need."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6794537"}, "is_accepted": false, "score": 1, "last_activity_date": 1482330138, "creation_date": 1482330138, "answer_id": 41264998, "question_id": 41264761, "link": "https://stackoverflow.com/questions/41264761/c-program-how-can-i-read-characters-part-by-part-from-a-string/41264998#41264998", "title": "C program - how can I read characters part by part from a string", "body": "<p>You can use loop. Insert the characters until you get a space. You can try this.</p>\n\n<pre><code>int i,j=0;\nint len = strlen(source);\nint k=0;\nfor(int i=0;i&lt;len;i++){\n    if(source[i] == ' ')\n        { \n          k++;\n          j=0;\n        }\n    else\n      destination[k][j++]=source[i];\n   }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5568230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d108b055440cb6ff73ac628540133cc9?s=128&d=identicon&r=PG&f=1", "display_name": "Salai Dhiraviyam", "link": "https://stackoverflow.com/users/5568230/salai-dhiraviyam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1482330138, "creation_date": 1482329456, "question_id": 41264761, "link": "https://stackoverflow.com/questions/41264761/c-program-how-can-i-read-characters-part-by-part-from-a-string", "title": "C program - how can I read characters part by part from a string", "body": "<pre><code>#include&lt;stdio.h&gt;  \n\nvoid main()   \n{\n\nchar source[30]=\"salai word2 word3\";   \nchar destination[20][20];   \n\nprintf(\" \\n\\source is: %s\\n\\n\", source);   \ngetch();  \n}\n</code></pre>\n\n<p>In the above program, char variable \"source\" contains three words(separated by space). How can I read the words from \"source\" and store in another char array \"destination\". Expectation as follows:</p>\n\n<pre><code>strcpy(destination[0], salai)   \nstrcpy(destination[1], word2)  \nstrcpy(destination[2], word3)\n</code></pre>\n"}, {"tags": ["c", "process", "semaphore"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7204691, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-O44plazlBEk/AAAAAAAAAAI/AAAAAAAAA-g/QoDYxoqqIz0/photo.jpg?sz=128", "display_name": "Mathieu Rousseau", "link": "https://stackoverflow.com/users/7204691/mathieu-rousseau"}, "edited": false, "score": 0, "creation_date": 1482340049, "post_id": 41266325, "comment_id": 69737229, "body": "Thanks, I&#39;ll try to do that."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1482334058, "creation_date": 1482334058, "answer_id": 41266325, "question_id": 41264757, "link": "https://stackoverflow.com/questions/41264757/processes-does-not-seem-to-decrement-semaphore/41266325#41266325", "title": "Processes does not seem to decrement semaphore", "body": "<p>You're using System V semaphores, which is ... quaint.  SysV semaphores have a couple of features that POSIX semaphores do not have, but I find the POSIX semaphore API considerably easier to use.  (On the other hand, I kinda like the SysV style for shared-memory segments, even though it, too, has a few quirks.)</p>\n\n<p>As long as you're using SysV semaphores, you really ought to pay more attention to the docs for <code>semctl()</code>.  In particular:</p>\n\n<blockquote>\n  <p>The fourth argument is optional and depends upon the operation\n  requested. If required, it is of type <code>union semun</code>, which the\n  application shall explicitly declare:</p>\n\n<pre><code>union semun {\n    int val;\n    struct semid_ds *buf;\n    unsigned short  *array;\n} arg;\n</code></pre>\n</blockquote>\n\n<p>(<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/semctl.html\" rel=\"nofollow noreferrer\">POSIX specification for <code>semctl()</code></a>)</p>\n\n<p>When you use the four-arg form to try to set the initial value of your semaphore, you pass a plain <code>int</code>.  That <em>might</em> appear to work, but it's non-conforming, so the behavior is undefined.</p>\n\n<p>Additionally, since you intend for your shared-memory segment and semaphore to be inherited by child processes across the <code>fork()</code>s, as opposed to being opened independently, I recommend using key <code>IPC_PRIVATE</code> for each instead of specifying an application-specific key, though that won't be related to the misbehavior you observe.</p>\n\n<p>But I think <strong>the main problem you face here is that you do nothing to ensure that the child processes complete their work before the main process examines the results</strong>.  The easiest and most natural way to achieve that in this case would be for the main program, after forking <em>all</em> the children, to <code>wait()</code> or <code>waitpid()</code> for each of them.</p>\n\n<p>As a bonus, you should then be able to get rid of the semaphore altogether, for although the child processes all access the same shared memory segment, no two access the same part of it.  Therefore, they do not need to synchronize with respect to each other.  The successful waits will be sufficient to ensure that the parent properly synchronizes with all the children.</p>\n"}], "owner": {"reputation": 141, "user_id": 7204691, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-O44plazlBEk/AAAAAAAAAAI/AAAAAAAAA-g/QoDYxoqqIz0/photo.jpg?sz=128", "display_name": "Mathieu Rousseau", "link": "https://stackoverflow.com/users/7204691/mathieu-rousseau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 41266325, "answer_count": 1, "score": 1, "last_activity_date": 1482334058, "creation_date": 1482329444, "last_edit_date": 1495542824, "question_id": 41264757, "link": "https://stackoverflow.com/questions/41264757/processes-does-not-seem-to-decrement-semaphore", "title": "Processes does not seem to decrement semaphore", "body": "<p>I've got a problem with my c program.<br>\n<em>I already wrote a subject about the same program here (I had problems with fork) : <a href=\"https://stackoverflow.com/questions/41132029/wrong-data-output-when-forking_\">https://stackoverflow.com/questions/41132029/wrong-data-output-when-forking</em></a></p>\n\n<p>I'm simulating an F1 practice. Whith fork now, I've got some irrelevant data (1/3 of cars have a wrong time (0min0s0ms).<br>\nI think it's a problem of concurrency so I tried to <em>implements a semaphore</em>.\nThe purpose of that is to only allow 1 process at a time to write in the Shared Memory.</p>\n\n<p>But now, I have all the output data that are wrong</p>\n\n<p>For instance:</p>\n\n<ul>\n<li>Pilote numbers are incorrect for most (a lot have n\u00b00).</li>\n<li>They all have unrealistic best times (0min 0sec 0ms).</li>\n</ul>\n\n<p>One thing I noticed is that if I remove the <em>sem operation</em> that increase the semaphore of 1 <em>(sem + 1)</em>, <strong>no process is blocked before writing in the Shared Memory</strong> but they should because the semaphore is never incremented <em>(it's only still decrementing)</em>.</p>\n\n<p>Here's the programm that \"make the race\":</p>\n\n<pre><code>/* /!\\ COMPILER AVEC -lm &amp;&amp; -lpthread /!\\ */\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;wait.h&gt;\n\n#include \"CourseF1.h\"\n#include \"ResultCourse.h\"\n\n#define MAX_PILOTES 22\n#define MAX_TOURS 44\n\nint semid;\n\nfloat ranf() { // PRNG for floats [0, 1].\n    float r = rand() / (float) RAND_MAX;\n    return r;\n}\n\n/**\n*\n* method based on Box-Muller transformation: https://en.wikipedia.org/wiki/Box%E2%80%93Muller_transform\n*\n**/\nfloat randGaussien(float m, float s) { /* median m, standard deviation s */\n    float x1, x2, w, y1, result;\n    float y2;\n    int use_last = 0;\n\n    if (use_last) /* use value of last call */\n    {\n        y1 = y2;\n        use_last = 0;\n    }\n    else\n    {\n        do {\n            x1 = 2.0 * ranf() - 1.0;\n            x2 = 2.0 * ranf() - 1.0;\n            w = x1 * x1 + x2 * x2;\n        } while ( w &gt;= 1.0 );\n\n        w = sqrt( (-2.0 * log( w ) ) / w );\n        y1 = x1 * w;\n        y2 = x2 * w;\n        use_last = 1;\n    }\n\n    result = ( m + y1 * s );\n    if (result &lt; 0) {\n        return 0.0;\n    }\n    return result;\n}\n\n\nint genTime(const int min, const int max) {\n    return ((rand() % (max-min + 1)) + min); // Generate a random number between min and max\n}\n\nint genRaceEvents(const int max) { // Decide about race events\n    return rand() % max; // Generate a number between 0 and max - 1\n}\n\nint compareBest(const void *p1, const void *p2) { // Compare the best times\n    const struct Pilote *elem1 = p1;\n    const struct Pilote *elem2 = p2;\n\n    if (elem1-&gt;best &lt; elem2-&gt;best) return -1;\n    if (elem1-&gt;best &gt; elem2-&gt;best) return 1;\n    return 0;\n}\n\nint compareTot(const void *p1, const void *p2) { // Compare the total times\n    const struct Pilote *elem1 = p1;\n    const struct Pilote *elem2 = p2;\n\n    if (elem1-&gt;totalTime &lt; elem2-&gt;totalTime) return -1;\n    if (elem1-&gt;totalTime &gt; elem2-&gt;totalTime) return 1;\n    return 0;\n}\n\nvoid fillTab(struct Pilote tabToFill[], struct Pilote tabFiller[], const int start, const int stop) {\n    for (int i = start; i &lt; stop; i++) {\n        tabToFill[i] = tabFiller[i];\n    }\n}\n\nint run(Pilote *p, char* name) {\n    struct sembuf sem_op; // sembuf struct for semaphore operations\n\n    sem_op.sem_num = 0;\n    sem_op.sem_op = -1; // sem - 1\n    sem_op.sem_flg = 0;\n\n    if (semop(semid, &amp;sem_op, 1) == -1) { // sem operation\n        perror(\"Error when decrementing semaphore\");\n    }\n\n    /* Instantiation of Pilote struct values */\n    p-&gt;s1 = 3 * 60 * 3600 + 1;\n    p-&gt;bestS1 = 3 * 60 * 3600 + 1;\n    p-&gt;s2 = 3 * 60 * 3600 + 1;\n    p-&gt;bestS2 = 3 * 60 * 3600 + 1;\n    p-&gt;s3 =  3 * 60 * 3600 + 1;\n    p-&gt;bestS3 = 3 * 60 * 3600 + 1;\n    p-&gt;best =  3 * 60 * 3600 + 1;\n    p-&gt;totalTime = 0;\n    p-&gt;isPit = 0;\n    p-&gt;hasGivenUp = 0;\n    p-&gt;hasGivenUpDuringRace = 0;\n    p-&gt;numberOfPits = 0;\n\n    for (int i = 0; i &lt; MAX_TOURS; i++) { // For every lap\n\n        p-&gt;isPit = 0; // At first he doesn't pit\n\n        if (!(p-&gt;hasGivenUp)) { // If the pilote didn't give up\n\n            int givingUpEvent = genRaceEvents(500); // Generate a number between 0 and 499\n\n            if (givingUpEvent == 14 &amp;&amp; strcmp(name, \"Race\") == 0) { // If the pilote has given up (during race)\n                p-&gt;best = 3 * 60 * 3600;\n                p-&gt;hasGivenUpDuringRace = 1;\n                return 0; // Stop le pilote\n            }\n\n            else if (givingUpEvent == 14) { // If the pilote has given up (but not during race)\n                p-&gt;best = 3 * 60 * 3600 + 3;\n                p-&gt;hasGivenUp = 1;\n                return 0; // Stop the pilote\n            }\n        }\n\n        if (p-&gt;numberOfPits &lt; 2) { // Max 2 stops\n            p-&gt;isPit = genRaceEvents(250); // Generate a number between 0 and 249\n\n            if (p-&gt;isPit) {\n                p-&gt;numberOfPits++;\n                if ((strcmp(name, \"Practices\") == 0)|| (strcmp(name, \"Qualifs\") == 0)) continue; // Next iteration\n            }\n\n        }\n\n        // We do a lap\n        int S1 = 0.275 * (103000 + randGaussien(5000, 2000)); // Portion of circuit * Gauss curve (min time + fun(median, standard deviation))\n        int S2 = 0.459 * (103000 + randGaussien(5000, 2000));\n        int S3 = 0.266 * (103000 + randGaussien(5000, 2000));\n\n        if ((strcmp(name, \"Race\") == 0) &amp;&amp; (p-&gt;isPit)) { // If we are during race and the pilote pit\n            S1 += genTime(20 * 3600, 25 * 3600); // We add between 20 and 25sec at Sector 1\n        }\n\n        p-&gt;s1 = S1; // Notify time of S1\n        p-&gt;s2 = S2; // Notify time of S2\n        p-&gt;s3 = S3; // etc...\n\n        int lap = S1 + S2 + S3;\n\n        if (p-&gt;bestS1 &gt; S1) p-&gt;bestS1 = S1; // If it's its best S1, we modify the best S1\n        if (p-&gt;bestS2 &gt; S2) p-&gt;bestS2 = S2; // etc\n        if (p-&gt;bestS3 &gt; S3) p-&gt;bestS3 = S3; // etc\n\n        if (p-&gt;best &gt; lap) p-&gt;best = lap; // If it's its best lap time, we modify the best lap time, \n\n        if ((strcmp(name, \"Race\") == 0)) {\n            p-&gt;totalTime += lap; // add the lap time to the total race time\n        }\n\n    } // End of for loop\n\n    sem_op.sem_num = 0;\n    sem_op.sem_op = 1; // sem + 1\n    sem_op.sem_flg = 0;\n    if (semop(semid, &amp;sem_op, 1) == -1) { // sem operation\n        perror(\"Error when incrementing semaphore\");\n    }   \n}\n\nint main(int argc, char const *argv[]) {\n    //srand (time(NULL)); // Useful for random number generation\n\n    printf(\"========================================\\n\");\n    for (int i = 0; i &lt; 22; i++) {\n        printf(\"Random: %d\\n\", genRaceEvents(100));\n    }\n    printf(\"=========================================\\n\");\n\n    // Variables for the race\n    int pilotes_numbers[MAX_PILOTES]  = {44, 6, 5, 7, 3, 33, 19, 77, 11, 27, 26, 55, 14, 22, 9, 12, 20, 30, 8, 21, 31, 94}; // Tab containing pilotes numbers\n    struct Pilote Q2[16]; // Tab of pilotes for Q2\n    struct Pilote Q3[10]; // Tab of pilotes for Q3\n    struct Pilote mainRun[MAX_PILOTES]; // Tab of pilotes for other race, practices\n    struct Pilote *pilotesTab; // pointer to SM\n    pid_t tabPID[MAX_PILOTES]; // Tab of PID\n    int shmid = 0; // SM id\n    key_t key; // Key for SM and Semaphores\n\n     /**\n     * Shared memory\n     */\n\n    // Key generation for Shared Memory\n    key = ftok(argv[0], 123); // argv[O] =&gt; name of the program launched, ID (char)\n\n    // SM initialization\n    shmid = shmget(key, MAX_PILOTES * sizeof(Pilote), IPC_CREAT | 0644); \n\n    if (shmid == -1) {\n        perror(\"Erreur when allocating SM.\");\n        return 0;\n    }\n\n    // Attach SM segment\n    pilotesTab = shmat(shmid, NULL, 0);\n\n    /**\n     * Semaphores\n     */\n\n    // Semaphores initialization (1 semaphore)\n    semid = semget(key, 1, IPC_CREAT | 0640); // key, number of semaphores, perm \n\n    if(semid == -1) { // Erreur\n        perror(\"Error when creating semaphore\");\n        return 0;\n    }\n\n    // Set semaphore value to 1\n    int rv = semctl(semid, 0, SETVAL, 1); // semid, sem number, operation type, union semun \n\n    if (rv == -1) { // sif return value == -1\n        perror(\"Error when affecting value to the semaphore\");\n        return 0;\n    }\n\n\n\n    /**\n     * Fork\n     */\n\n    int j;\n    for (j = 0; j &lt; MAX_PILOTES; j++) { /* Create 22 processes */\n\n        tabPID[j] = fork();\n\n        if (tabPID[j] == -1) { // Error\n            perror(\"Error when forking\\n\");\n            return 0;\n        }\n\n       if (tabPID[j] == 0) { // Child\n            // https://stackoverflow.com/questions/8623131/why-is-rand-not-so-random-after-fork\n            srand(time(NULL) ^ (getpid() &lt;&lt; 16));\n            pilotesTab[j].pilote_id = pilotes_numbers[j]; // Pilote number initialization\n            run(&amp;pilotesTab[j], \"Practices\");\n\n            exit(0);\n        } \n    } /* End of 22 processes */\n\n    printf(\"==================================================== \\n\");\n    fillTab(mainRun, pilotesTab, 0, MAX_PILOTES); // Fill the tab before sorting + show to the console\n    showResults(mainRun, MAX_PILOTES, \"Practices\");\n    printf(\"====================================================\\n\");\n\n    /**\n     * END TEST\n     */\n    semctl(semid, 0, IPC_RMID); // Semaphore remove\n    shmdt(pilotesTab); // SM detach\n    shmctl(shmid, IPC_RMID, 0); // SM remove\n    return 0;\n}\n</code></pre>\n\n<p>And here's the code that show the output in the console:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/ipc.h&gt;\n#include &lt;sys/shm.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/sem.h&gt;\n#include &lt;time.h&gt;\n#include &lt;string.h&gt;\n#include &lt;math.h&gt;\n#include &lt;semaphore.h&gt;\n\n#include \"CourseF1.h\"\n#include \"ResultCourse.h\"\n\n#define MAX_PILOTES 22\n\nvoid showResults(struct Pilote tab[], int nbElems, char* name) {\n\n    if (strcmp(name, \"Race\") != 0) { // NOT in Race\n        qsort(tab, nbElems, sizeof(Pilote), compareBest);\n\n        for (int k = 0; k &lt; nbElems; k++) {\n\n            // If the pilote gave up during session\n            // But did a time\n            if (tab[k].hasGivenUp) {\n                printf(\n                    \"%d) voiture n\u00b0%d : Best S1 =&gt; %ds%dms | Best S2 =&gt; %ds%dms | Best S3 =&gt; %ds%dms | Best Lap =&gt; %dm%ds%dms || DNF\\n\", \n                    k+1,\n                    tab[k].pilote_id, \n                    (tab[k].bestS1/1000)%60, tab[k].bestS1-(tab[k].bestS1/1000)*1000,\n                    (tab[k].bestS2/1000)%60, tab[k].bestS2-(tab[k].bestS2/1000)*1000,\n                    (tab[k].bestS3/1000)%60, tab[k].bestS3-(tab[k].bestS3/1000)*1000,\n                    tab[k].best/60000, (tab[k].best/1000)%60, tab[k].best-(tab[k].best/1000)*1000\n                );\n                continue; \n            }\n\n            // If the pilote gave up during first lap\n            // HACK TIME to place it at the end of the list\n            if (tab[k].hasGivenUp &amp;&amp; tab[k].best == (3 * 60 * 3600) + 1) {\n                printf(\"%d) voiture n\u00b0%d : // Abandon durant le premier tour de la session =&gt; Pas de temps // \\n\",\n                    k+1,\n                    tab[k].pilote_id\n                );\n                continue;\n            }\n\n            // If everything is OK\n            printf(\n                \"%d) voiture n\u00b0%d : Best S1 =&gt; %ds%dms | Best S2 =&gt; %ds%dms | Best S3 =&gt; %ds%dms | Best Lap =&gt; %dm%ds%dms \\n\", \n                k+1,\n                tab[k].pilote_id, \n                (tab[k].bestS1/1000)%60, tab[k].bestS1-(tab[k].bestS1/1000)*1000,\n                (tab[k].bestS2/1000)%60, tab[k].bestS2-(tab[k].bestS2/1000)*1000,\n                (tab[k].bestS3/1000)%60, tab[k].bestS3-(tab[k].bestS3/1000)*1000,\n                tab[k].best/60000, (tab[k].best/1000)%60, tab[k].best-(tab[k].best/1000)*1000\n            ); \n        }\n\n    } else { // IN race\n        for (int k = 0; k &lt; nbElems; k++) {\n            qsort(tab, nbElems, sizeof(Pilote), compareTot);\n\n            if (tab[k].hasGivenUpDuringRace) {\n                printf(\"%d) voiture n\u00b0%d: DNF (n'a pas pu finir l'entieret\u00e9 de la course pour cause d'abandon)\\n\",\n                    k+1,\n                    tab[k].pilote_id\n                );\n                continue;\n            } \n\n            printf(\n                \"%d) voiture n\u00b0%d : Best S1 =&gt; %ds%dms | Best S2 =&gt; %ds%dms | Best S3 =&gt; %ds%dms | Best Lap =&gt; %dm%ds%dms || Total =&gt; %dm%ds%dms \\n\", \n                k+1,\n                tab[k].pilote_id, \n                (tab[k].bestS1/1000)%60, tab[k].bestS1-(tab[k].bestS1/1000)*1000,\n                (tab[k].bestS2/1000)%60, tab[k].bestS2-(tab[k].bestS2/1000)*1000,\n                (tab[k].bestS3/1000)%60, tab[k].bestS3-(tab[k].bestS3/1000)*1000,\n                tab[k].best/60000, (tab[k].best/1000)%60, tab[k].best-(tab[k].best/1000)*1000,\n                tab[k].totalTime/60000, (tab[k].totalTime/1000)%60, tab[k].totalTime-(tab[k].totalTime/1000)*1000\n            ); \n        }\n    }\n\n}\n</code></pre>\n\n<p>And here's the buggy output in console: </p>\n\n<pre><code>1: voiture n\u00b044: (0m0s0ms)\n2: voiture n\u00b06: (0m0s0ms)\n3: voiture n\u00b05: (0m0s0ms)\n4: voiture n\u00b00: (0m0s0ms)\n5: voiture n\u00b03: (0m0s0ms)\n6: voiture n\u00b00: (0m0s0ms)\n7: voiture n\u00b00: (0m0s0ms)\n8: voiture n\u00b00: (0m0s0ms)\n9: voiture n\u00b00: (0m0s0ms)\n10: voiture n\u00b00: (0m0s0ms)\n11: voiture n\u00b00: (0m0s0ms)\n12: voiture n\u00b00: (0m0s0ms)\n13: voiture n\u00b00: (0m0s0ms)\n14: voiture n\u00b00: (0m0s0ms)\n15: voiture n\u00b00: (0m0s0ms)\n16: voiture n\u00b00: (0m0s0ms)\n17: voiture n\u00b00: (0m0s0ms)\n18: voiture n\u00b00: (0m0s0ms)\n19: voiture n\u00b00: (0m0s0ms)\n20: voiture n\u00b00: (0m0s0ms)\n21: voiture n\u00b00: (0m0s0ms)\n22: voiture n\u00b00: (0m0s0ms)\n</code></pre>\n\n<p>Hope that it's clear enough and that you will be able to help me.<br>\nThanks.</p>\n"}, {"tags": ["c++", "c", "linux", "qt", "sockets"], "comments": [{"owner": {"reputation": 2375, "user_id": 3985859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34af6d164c53c629e625c11a3d11bbcc?s=128&d=identicon&r=PG&f=1", "display_name": "Karsten Koop", "link": "https://stackoverflow.com/users/3985859/karsten-koop"}, "edited": false, "score": 0, "creation_date": 1482337435, "post_id": 41264645, "comment_id": 69735685, "body": "Qt also has <a href=\"http://doc.qt.io/qt-5/qtcpsocket.html\" rel=\"nofollow noreferrer\">support for sockets</a>, it might be preferable to use that if you already have a Qt app. One advantage is that you can use signals to handle incoming data."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6147175, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ppOVt.png?s=128&g=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/6147175/samuel"}, "edited": false, "score": 0, "creation_date": 1482330358, "post_id": 41264838, "comment_id": 69730794, "body": "Okay i will test it."}, {"owner": {"reputation": 23, "user_id": 6147175, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ppOVt.png?s=128&g=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/6147175/samuel"}, "edited": false, "score": 0, "creation_date": 1482332245, "post_id": 41264838, "comment_id": 69732087, "body": "Working perfectly, thanks.  Just will now have to use the appropriate sockets library for windows."}], "tags": [], "owner": {"reputation": 2952, "user_id": 3200088, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/WlD9X.jpg?s=128&g=1", "display_name": "Gio", "link": "https://stackoverflow.com/users/3200088/gio"}, "is_accepted": true, "score": 0, "last_activity_date": 1482336389, "last_edit_date": 1482336389, "creation_date": 1482329664, "answer_id": 41264838, "question_id": 41264645, "link": "https://stackoverflow.com/questions/41264645/graphic-app-in-c-and-code-in-c-qt-programming/41264838#41264838", "title": "Graphic app in C++ and code in C **Qt Programming**", "body": "<p>Within you Qt/C++ application, you can include you C-file as follows:</p>\n\n<pre><code>extern \"C\" {\n#include \"myCHeaderFile.h\n} /* extern \"C\" */\n</code></pre>\n\n<p>You can than simply access the C-functions within your C++/Qt file.</p>\n"}], "owner": {"reputation": 23, "user_id": 6147175, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ppOVt.png?s=128&g=1", "display_name": "Samuel", "link": "https://stackoverflow.com/users/6147175/samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 41264838, "answer_count": 1, "score": -1, "last_activity_date": 1482336389, "creation_date": 1482329087, "question_id": 41264645, "link": "https://stackoverflow.com/questions/41264645/graphic-app-in-c-and-code-in-c-qt-programming", "title": "Graphic app in C++ and code in C **Qt Programming**", "body": "<p>i have an application to realise with sockets in c, and i'm confortable with C++ and Qt, is it possible to do both C and C++ on Qt.</p>\n\n<p>there is a sample from the code is on C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;arpa/inet.h&gt;\n\n#define PORT 9600\n\nint main(int argc, char *argv[]){\n    int sock_cnx; /* Socket pour ouverture de connexion */\n\n    struct sockaddr_in serveraddr;\n    struct sockaddr_in clientaddr;\n\n    int newfd;\n    char buf[1024];\n    int nbytes;\n    int addrlen;\n    int i, j;\n\n    /* Ensemble des descripteurs qu\u2019on souhaite surveiller en lecture */\n    fd_set surveil_fds;\n\n    /* Ensemble des descripteurs qu\u2019on va utiliser dans SELECT */\n    fd_set read_fds; \n\n    /* Memorise le plus grand descripteur : a utiliser dans SELECT*/\n    int fdmax; \n\n    addrlen = sizeof(clientaddr);\n\n    /* Ouverture de la socket du serveur */\n    if ((sock_cnx = socket(AF_INET,SOCK_DGRAM,0)) == -1){\n        perror(\"Erreur socket\");\n        exit(1);\n    }\n\n    bzero(&amp;serveraddr, sizeof(serveraddr));\n\n    serveraddr.sin_family = AF_INET;\n    serveraddr.sin_port = htons(PORT);\n    serveraddr.sin_addr.s_addr = htonl (INADDR_ANY);\n\n    bzero(&amp;(serveraddr.sin_zero), 8);\n\n    /* Bind */\n    if (bind(sock_cnx, (struct sockaddr *)&amp;serveraddr, sizeof(serveraddr)) == -1) {\n        perror(\"Erreur Bind\");\n        exit(1);\n    }\n    ........\n    return 0;\n}\n</code></pre>\n\n<p>i already created my interface for the app on Qt. </p>\n"}, {"tags": ["c", "clang-format"], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 2306355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5e84d62f5b0be9b2d31bd363695f455?s=128&d=identicon&r=PG", "display_name": "datosh", "link": "https://stackoverflow.com/users/2306355/datosh"}, "reply_to_user": {"reputation": 6824, "user_id": 3202093, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/100004496564514/picture?type=large", "display_name": "sp2danny", "link": "https://stackoverflow.com/users/3202093/sp2danny"}, "edited": false, "score": 0, "creation_date": 1482399504, "post_id": 41264995, "comment_id": 69761507, "body": "You are right, the second line should contain a valid <code>float</code> and the third a valid <code>string</code> to initialize the values. Although it is wrong in the clang docs as well. Maybe I should request a fix there first and then change my answer accordingly."}], "tags": [], "owner": {"reputation": 407, "user_id": 2306355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5e84d62f5b0be9b2d31bd363695f455?s=128&d=identicon&r=PG", "display_name": "datosh", "link": "https://stackoverflow.com/users/2306355/datosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1482330122, "last_edit_date": 1592644375, "creation_date": 1482330122, "answer_id": 41264995, "question_id": 41264554, "link": "https://stackoverflow.com/questions/41264554/multiple-successive-declarations-definitions-on-same-indentation-level/41264995#41264995", "title": "Multiple successive declarations/definitions on same indentation level", "body": "<p>Just overread the correct option. From <a href=\"http://clang.llvm.org/docs/ClangFormatStyleOptions.html\" rel=\"nofollow noreferrer\">Clang Format Options website</a>:</p>\n<blockquote>\n<p>AlignConsecutiveDeclarations (bool):</p>\n<p>If true, aligns consecutive declarations.</p>\n<p>This will align the declaration names of consecutive lines. This will result in formattings like</p>\n<pre><code>int         aaaa = 12;\nfloat       b = 23;\nstd::string ccc = 23;\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 407, "user_id": 2306355, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5e84d62f5b0be9b2d31bd363695f455?s=128&d=identicon&r=PG", "display_name": "datosh", "link": "https://stackoverflow.com/users/2306355/datosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 41264995, "answer_count": 1, "score": 2, "last_activity_date": 1482335554, "creation_date": 1482328831, "last_edit_date": 1482335554, "question_id": 41264554, "link": "https://stackoverflow.com/questions/41264554/multiple-successive-declarations-definitions-on-same-indentation-level", "title": "Multiple successive declarations/definitions on same indentation level", "body": "<p>I'm trying to clean up my C codebase using clang-format (version 3.8.) on Ubuntu 14.04. As a requirement I need clang-format to maintain (or better enforce) the indentation of multiple successive declarations/definitions. For example: </p>\n\n<pre><code>void foo() \n{\n    int        a;\n    float      b;\n    myLongType c;\n}\n</code></pre>\n\n<p>After running clang-format I get the following output:</p>\n\n<pre><code>void foo() \n{\n    int a;\n    float b;\n    myLongType c;\n}\n</code></pre>\n\n<p>Is there an option that I'm not aware of to keep/enforce this formatting?</p>\n\n<p>If this is not possible, is it possible to extend the functionality of clang-format locally (as it is with clang-tidy?) or do I have to open a feature request? </p>\n\n<p>I know that this kind of formatting is mostly used in C code bases, and although the help message states \"A tool to format <strong>C</strong>/C++/Java/...\", all the options seem to be mainly targeted to C++.</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 2503, "user_id": 3700563, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1f0a11869957330c6018b71ec9310138?s=128&d=identicon&r=PG&f=1", "display_name": "JJF", "link": "https://stackoverflow.com/users/3700563/jjf"}, "edited": false, "score": 0, "creation_date": 1482328301, "post_id": 41264323, "comment_id": 69729376, "body": "It&#39;s not really clear what you&#39;re asking.  If you have a large program it could very well have hundreds of code files.  Why is that a problem?"}, {"owner": {"reputation": 11660, "user_id": 2055998, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/2Vx3A.jpg?s=128&g=1", "display_name": "PM 77-1", "link": "https://stackoverflow.com/users/2055998/pm-77-1"}, "edited": false, "score": 1, "creation_date": 1482328320, "post_id": 41264323, "comment_id": 69729403, "body": "You use a <a href=\"http://www.cs.colby.edu/maxwell/courses/tutorials/maketutor/\" rel=\"nofollow noreferrer\"><code>make file</code></a>"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "edited": false, "score": 1, "creation_date": 1482328496, "post_id": 41264323, "comment_id": 69729541, "body": "I marked this as a duplicate of a corresponding C++ question, but everything from the answers to the duplicate question applies to C as well."}, {"owner": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1482328572, "post_id": 41264323, "comment_id": 69729600, "body": "This question is much simpler compared to the duplicate, and has much simpler and straightforward answers, too."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 35543, "user_id": 149530, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b6c8b04130af49735de5be666d67c00?s=128&d=identicon&r=PG", "display_name": "Michael Foukarakis", "link": "https://stackoverflow.com/users/149530/michael-foukarakis"}, "edited": false, "score": 0, "creation_date": 1482328663, "post_id": 41264323, "comment_id": 69729651, "body": "@MichaelFoukarakis I think once you get into 100+ files, as OP suggests, it&#39;s no longer simple."}, {"owner": {"reputation": 1059, "user_id": 1259152, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/OemYc.jpg?s=128&g=1", "display_name": "olegst", "link": "https://stackoverflow.com/users/1259152/olegst"}, "edited": false, "score": 0, "creation_date": 1482328666, "post_id": 41264323, "comment_id": 69729653, "body": "gcc has -o option to specify output file name. Just compile files one by one. If there are too many files, use some build tool - GNU make, for example."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482328775, "post_id": 41264323, "comment_id": 69729722, "body": "What you outline is a consequence of multiple files being needed to build your program.  You might find that the files can be grouped into libraries which you compile in separate directories \u2014 keeping the source in separate directories and maybe the headers in an &#39;include&#39; directory \u2014 which can reduce the clutter per directory.  With static libraries, you can sometimes avoid keeping all the object files around after you&#39;ve built the library. That doesn&#39;t seem to be an option for shared libraries."}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 1059, "user_id": 1259152, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/OemYc.jpg?s=128&g=1", "display_name": "olegst", "link": "https://stackoverflow.com/users/1259152/olegst"}, "edited": false, "score": 1, "creation_date": 1482328781, "post_id": 41264323, "comment_id": 69729729, "body": "@olegst I think there is a benefit in going for the build tool right away, before the project becomes too large to manage. The sooner one learns about make/cmake/automake/etc, the easier his life becomes."}], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 1259152, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/OemYc.jpg?s=128&g=1", "display_name": "olegst", "link": "https://stackoverflow.com/users/1259152/olegst"}, "edited": false, "score": 1, "creation_date": 1482328741, "post_id": 41264402, "comment_id": 69729694, "body": "I&#39;d recommend good old make for the beginning."}, {"owner": {"reputation": 146, "user_id": 7325979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVCqV.jpg?s=128&g=1", "display_name": "Trucy", "link": "https://stackoverflow.com/users/7325979/trucy"}, "reply_to_user": {"reputation": 1059, "user_id": 1259152, "user_type": "registered", "accept_rate": 37, "profile_image": "https://i.stack.imgur.com/OemYc.jpg?s=128&g=1", "display_name": "olegst", "link": "https://stackoverflow.com/users/1259152/olegst"}, "edited": false, "score": 0, "creation_date": 1482329017, "post_id": 41264402, "comment_id": 69729886, "body": "I didn&#39;t know if I should recommand it as OP said that they wanted to compile hundreds of files, I tried to answer the question. Maybe I should have took in count that OP is new to C\u2026"}], "tags": [], "owner": {"reputation": 146, "user_id": 7325979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vVCqV.jpg?s=128&g=1", "display_name": "Trucy", "link": "https://stackoverflow.com/users/7325979/trucy"}, "is_accepted": true, "score": 2, "last_activity_date": 1482328379, "creation_date": 1482328379, "answer_id": 41264402, "question_id": 41264323, "link": "https://stackoverflow.com/questions/41264323/c-an-alternativebetter-way-to-compile-files/41264402#41264402", "title": "C: An alternative(better) way to compile files?", "body": "<p>If you have a lot of source files to compile you might want to check tools like <a href=\"https://www.gnu.org/software/automake/manual/html_node/index.html#Top\" rel=\"nofollow noreferrer\">Automake</a> or <a href=\"https://cmake.org/\" rel=\"nofollow noreferrer\">CMake</a>. They will take care of compiling the right files in the right objects, AND they will only compile the files you edited.</p>\n"}], "owner": {"reputation": 844, "user_id": 5290519, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q6KEV.png?s=128&g=1", "display_name": "Rainning", "link": "https://stackoverflow.com/users/5290519/rainning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1482328439, "accepted_answer_id": 41264402, "answer_count": 1, "score": 0, "last_activity_date": 1482328379, "creation_date": 1482328104, "last_edit_date": 1482328305, "question_id": 41264323, "link": "https://stackoverflow.com/questions/41264323/c-an-alternativebetter-way-to-compile-files", "closed_reason": "Duplicate", "title": "C: An alternative(better) way to compile files?", "body": "<p>I'm new to C.</p>\n\n<p>I've split my sorting program into three .c files <code>compare_functions.c</code>, <code>insertion_sort.c</code> and <code>main.c</code>, which includes the two.</p>\n\n<p>In order to get the executable, I try the followings: (only related files in the current folder)</p>\n\n<pre><code>gcc -c insertion_sort.c compare_functions.c main.c\ngcc *.o -o main.out\n</code></pre>\n\n<p>In addition to two headers <code>compare_functions.h</code>, <code>insertion_sort.h</code>, finally there are nine files in the folder, after <code>ls</code> them:</p>\n\n<pre><code>compare_functions.c insertion_sort.c    main.c\ncompare_functions.h insertion_sort.h    main.o\ncompare_functions.o insertion_sort.o    main.out\n</code></pre>\n\n<p>Finally the <code>./main.out</code> just work fine but, say, if I have a program much larger(ie. a hundred of .c file), finally there will be a mess with 100*3 files, is the way described above still suitable?</p>\n"}, {"tags": ["c", "pic", "low-level", "low-level-io", "pic24"], "comments": [{"owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "edited": false, "score": 6, "creation_date": 1482328308, "post_id": 41264319, "comment_id": 69729382, "body": "What is your problem? Please add a question"}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1482328911, "post_id": 41264319, "comment_id": 69729824, "body": "<i>Hertz</i>  is the unit for frequency and <i>second</i> is the unit for time, so your question title doesn&#39;t make sense."}, {"owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "edited": false, "score": 0, "creation_date": 1482329478, "post_id": 41264319, "comment_id": 69730196, "body": "Yes I am currently converting frequency units from hertz to second(period). Formula goes something like this T=1/i and T/2=delay/msec"}, {"owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "edited": false, "score": 1, "creation_date": 1482894558, "post_id": 41264319, "comment_id": 69911515, "body": "you are using floating point on a PIC, is there any flash/rom left for any real code?"}, {"owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "edited": false, "score": 0, "creation_date": 1483436712, "post_id": 41264319, "comment_id": 70087026, "body": "Plenty of it actually."}], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "edited": false, "score": 0, "creation_date": 1482329045, "post_id": 41264570, "comment_id": 69729897, "body": "I have fix it to an endless loop while(1){ codehere }, however the speaker just does, umm.. flatulent sounds..."}, {"owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "edited": false, "score": 0, "creation_date": 1482329060, "post_id": 41264570, "comment_id": 69729907, "body": "Sounds a bit like a metronome if I have to be honest."}], "tags": [], "owner": {"reputation": 99, "user_id": 2252489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1101da32e6a4aba7853d5d49be53eeca?s=128&d=identicon&r=PG", "display_name": "Bill Birch", "link": "https://stackoverflow.com/users/2252489/bill-birch"}, "is_accepted": false, "score": 2, "last_activity_date": 1482328879, "creation_date": 1482328879, "answer_id": 41264570, "question_id": 41264319, "link": "https://stackoverflow.com/questions/41264319/c-hertz-to-seconds-and-how-to-get-the-proper-time-for-a-delay/41264570#41264570", "title": "C - Hertz to Seconds and how to get the proper time for a delay?", "body": "<p>You need a loop! </p>\n\n<pre><code>repeat for note length:\n   on\n   delay\n   off\n   delay\n</code></pre>\n\n<p>Also consider calculating the required period for each note off-line and enter it as an integer instead of in Hz - the CPU wont be wasting time in floating point calculations</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1482331539, "creation_date": 1482331539, "answer_id": 41265483, "question_id": 41264319, "link": "https://stackoverflow.com/questions/41264319/c-hertz-to-seconds-and-how-to-get-the-proper-time-for-a-delay/41265483#41265483", "title": "C - Hertz to Seconds and how to get the proper time for a delay?", "body": "<p>The middle A note is normally a 440 Hz tone. If you toggle your piezo speaker on and off 440 times per second, the delay between successive toggles is 1/880 of a second, which is 1.13636363636 ms. This shows two things:</p>\n\n<ul>\n<li>your calculations are way off; and</li>\n<li>timer resolution of one millisecond is way too coarse for this application.</li>\n</ul>\n\n<p>Of course you need a loop to play a tone with some duration.</p>\n"}, {"tags": [], "owner": {"reputation": 62072, "user_id": 16007, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e859640aaeb4b305e163a990be827cf9?s=128&d=identicon&r=PG&f=1", "display_name": "old_timer", "link": "https://stackoverflow.com/users/16007/old-timer"}, "is_accepted": true, "score": 1, "last_activity_date": 1482898943, "creation_date": 1482898943, "answer_id": 41355301, "question_id": 41264319, "link": "https://stackoverflow.com/questions/41264319/c-hertz-to-seconds-and-how-to-get-the-proper-time-for-a-delay/41355301#41355301", "title": "C - Hertz to Seconds and how to get the proper time for a delay?", "body": "<p>first off you are trying to use square waves to make sine waves.  So it is always going to sound a bit wrong if you aim specifically for the target frequency with the timer.  make a 440Hz square wave it doesnt \"sound\" like a 440Hz sine wave.  Maybe the physics will round it off but, I am betting not as much as you want.</p>\n\n<p>You can if you have the speed. Do the one bit DAC thing from the 90s or whenever that was.  If you can make your square waves go faster than the speaker can physically move you can say sprinkle more ones than zeros for a while say pushing the speaker out a bit at a controlled rate then more zeros than ones for a while teasing the speaker in.  The speaker becomes a physical low pass filter.  You can probably use the PWM in the microcontroller to help with this.  But you need to dynamically change it and this is  PIC so you are likely to run out of resources before you can code up a lot of tables for clean sound.</p>\n\n<p>To do the square wave thing, you need to change the output pin at half the frequency.  Do not do the calculations at runtime, do then on your calculator or let the toolchain do it.  Say you are running your processor/timer at 1Mhz, and you want 440Hz on a pin.  You need the period to be 1/440.  hz is cycles per second so inverting that makes it seconds per cycle.  0.00227272 (repeating) seconds per cycle or period, so you need it high for half and low for half (or vice versa, doesnt matter) so \nthat means 0.00113636... between output state changes.  If your timer was 1Mhz that is 1/1Million seconds per cycle.  Or one microsecond. how many microseconds in 0.00113636... 1136.  So every 1136 timer ticks you change state, you read the docs on the timer and have it count down or up or whatever 1136 counts (usually these are zero based numbers so 1135 and then count the zero and then the interrupt or status flag or whatever).  you can also probably poll a counter that counts to/from all ones to/from all zeros and rolls over, subtract then from now and mask it with the number of bits that are counting and the difference is the time.  with a 16 bit counter  (start-now)&amp;0xFFFF is the difference so long as your desired time is enough less than 0xFFFF.  1136 would certainly be.  wait until the start minus now (if it is a down counter or now mins start if up counter).  </p>\n\n<p>Pre-compute your count times for a half cycle of each of these frequencies you want.  when you make a tone you have to in some way loop every cycle on for the half period, off for half period, on for half period off for half period.</p>\n\n<p>Depending on the speaker and your frequency it should sorta work.  If you want to try the one bit thing</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/1-bit_DAC\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/1-bit_DAC</a></p>\n\n<p>you could start with a triangle wave do a say 66% duty cycle for 1/4th of the 1136 microseconds, a 33% duty cycle for 1/2 of the 1136 microseconds then 66% for the final 1/4th.  Or one time do a 1/4th then do 1/2 at one duty cycle then 1/2 at another.  You should be able to find or write a low pass filter, not that you would know what the speaker properties are but you can get a feel for how to generate the slower wave within the higher.  After a triangle you could try a trapezoid.  ramp up at some rate, do a 50% for a bit, then ramp down, repeat for the other half of the period.</p>\n\n<p>For experimental purposes, find or pre-compute a sequence covering the whole period, you could have code that generates some few hundred or thousand lines of code, with a pic you can be fairly if not exactly deterministic X number of microseconds can be achived by executing exactly Y number of instructions or the right mix of Y instructions  like</p>\n\n<pre><code>on\non\noff\non\noff\non\non\noff\n</code></pre>\n\n<p>then the last instruction jumps to the top, again experimental, but you may find if you do it right you get a cleaner sound, perhaps much cleaner than a square wave.</p>\n\n<p>you can add a simple R/C filter, literally two components, to convert your bit stream into an analog waveform that you then feed the speaker or amplify then feed the speaker, the feature here is you can look at it on  a scope.</p>\n\n<p>The other path you can take on the cheap and easy is a resistor ladder, instead of one bit you output basically the analog value for that place in the period and use a resistor ladder to turn that into an analog signal.</p>\n\n<p>Or just use a real dac.  based on how fast you can feed the dac pre-compute the number of values you need to send for one period, and make a table and just send them, in a loop until you are done with that frequency.</p>\n\n<p>so with all that back to your code.  you are trying to use some I guess millisecond library function?  so lets say that is what you want to do.  </p>\n\n<p>440Hz as we saw is 0.00113636 seconds for a half period, so that would be 1millisecond on then one millisecond off, your code should do this</p>\n\n<pre><code>for(i=0;i&lt;nperiods;i++)\n{\non\ndelay_ms(1)\noff\ndelay_ms(1)\n}\n</code></pre>\n\n<p>any other delays in there just make it wrong...for a square wave.  for others then I doubt you will have hardcoded delays.</p>\n\n<p>So there are a number of problems with the above, first off a millisecond delay is way to slow for what you are trying you need a microsecond delay and you need to understand how long it takes for the overhead in the loop, our math showed 1136 microseconds for 440hz, with some truncating of accuracy.  but the code that does the delay, esp on a slow mcu like this takes many clock cycles, if this is C code and not asm then many many more, plus the code to turn the gpio pin on and off, you have to subtract/tune those out.  A scope will help, if you start off with 1136 and the scope is showing a period of 3000us instead of 2272.7 then you need to subtract that out and try again.  so a delay of 772 instead of 1136.  that kind of thing.</p>\n\n<p>Middle C is 261.6Hz according to google, right or wrong lets run with it.  that is 3823 microseconds.  feeding your note function 255, which I assume is what the defines are for gives 1.9 I assume milliseconds.  which is right as far as milliseconds goes. which gets truncated to 1 millisecond or 2000 microseconds which is 500hz which is of course way off.  that define should have been 261 or 262 not 255 anyway right?</p>\n\n<p>hmmm so you are trying to make a high pulse then a fixed length low pulse of 200ms?  so if you fed it note E and assumed that the code took no time to run.  it would be high for 2 ms then low for 200, and assuming you repeated that that is a 1% duty cycle at the frequency of 1/201ms or 4.97...Hz, the piano frequencies</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Piano_key_frequencies\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Piano_key_frequencies</a></p>\n\n<p>dont show a note at 5hz.  I am sure it is close to some harmonic down there, but pretty low.</p>\n\n<p>A would be 3ms high 200 low or a frequency of 1/203ms or 4.9hz</p>\n\n<p>Other than the math, doing runtime floating point on a pic (or anywhere that doesnt have an fpu) is extremely costly, the math alone probably takes longer than your entire cycle. absolutely no reason to compute that runtime.  you could have easily made the defines with the math or used your calculator and made the defines with hardcoded hand computed numbers.  It still wouldnt have worked with a fixed low period esp one that is so significantly large compared to the numbers you need.  with millisecond delay assuming the code ran instantly.  on delay 1ms off delay 1ms is 500hz.  on, delay 2, off delay 2, 250hz, delay 3 is 166, delay 4 is 125 and so on.  you are not going to hit many real notes assuming the code ran instantly which it doesnt and using a millisecond delay.  </p>\n\n<p>to make the pressure wave you want to basically have the speaker pushed out from its resting state for half the cycle and sucked back in from its resting state for half the cycle, ideally in a sine fashion so that it slowly goes out and comes back then pulls in and goes out.  going from reseting state to out only will work sure, but you still need to have the duty cycle right to get close with a square wave.  so understand the timers you have, with a pic you can easily hand code some loops that burn clock cycles as they are deterministic from what I remember.  start with the frequency of your processor, what is it?  how many processor cycles for one period of your note?  same as the 440hz to 1mhz math above.  0.0011363636 times 1million (seconds per half period times ticks per second the seconds cancel out and you get ticks per half period math works on units just like numbers)  if your mcu is running at 2million clock ticks per second then it is 2million times 0.001136363636...</p>\n\n<p>THEN figure out how to turn it on wait that number of cpu clocks then off and wait that number of cpu clocks.  feed that into your piezo or other and see how it sounds. </p>\n\n<p>If you had 16 bit registers which I bet you dont but assuming a 1mhz clock you would</p>\n\n<pre><code>load reg with some number\ntop\nsubtract reg,1\ncompare with zero\nbranch to top\n</code></pre>\n\n<p>in assembly of course.  assuming one clock cycle for the subtract and compare each then two for the branch lets say that is four per loop, so 1136/4 = 284.  load the register with the pre-computed value 284.</p>\n\n<p>hand code some assembly</p>\n\n<pre><code>top:\ngpio on\nload reg,284\none:\nsub reg,1\ncmp reg,0\nbne one\ngpio off\nload reg,284\ntwo:\nsub reg,1\ncmp reg,0\nbne two\njmp top\n</code></pre>\n\n<p>crude but it would get you started down the path.  </p>\n\n<p>if you dont have 16 bit registers but 8 bit instead, 1mhz 1136/0x100 = 4 remainder 112 that would come out quite nice if this processor takes 4 clocks per loop as I have fantasized above.  each delay would be</p>\n\n<pre><code>mov reg,0xFF\nA:\nsub reg,1\ncmp reg,0\nbne A\nmov reg,28\nB:\nsub reg,1\ncmp reg,0\nbne B\n</code></pre>\n\n<p>there are no doubt countless resources here and other places describing delay loops for the PIC family members.</p>\n\n<p>You could just wing it and see the sounds change</p>\n\n<pre><code>#define DELX 300\nvolatile unsigned int x;\nwhile(1)\n{\n    output_high(PIN_D1);\n    for(x=0;x&lt;DELX;x++) continue; \n    output_low(PIN_D1);\n    for(x=0;x&lt;DELX;x++) continue; \n}\n</code></pre>\n\n<p>and play with different numbers for the define.  the tone should change, the quality may not be that great or maybe much better than what you have now, but it should change if audible at all.  there are likely cliffs that you will hit I assume it is an 8 bit processor so counting to 200 is WAYY different then counting to 300, it is not going to be a frequency that is one and a half times lower.  possible it wont be linear, might be depends on the compiler, but it might be linear segments with kinks here and there. 100 to 200 might be linear and 300 to 400 but 200 to 300 might not be.</p>\n\n<p>This is probably linear though</p>\n\n<pre><code>volatile unsigned int x;\nunsigned int y,z;\nfor(z=0;z&lt;1000;z++)\nfor(y=0;y&lt;100;y++)\n{\n    output_high(PIN_D1);\n    for(x=0;x&lt;z;x++) continue; \n    output_low(PIN_D1);\n    for(x=0;x&lt;z;x++) continue; \n}\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 7046249, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/2e8e5bfa55373da4b28a5987adb5e16e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Carr", "link": "https://stackoverflow.com/users/7046249/joe-carr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1996, "favorite_count": 0, "accepted_answer_id": 41355301, "answer_count": 3, "score": 0, "last_activity_date": 1482898943, "creation_date": 1482328091, "last_edit_date": 1482387999, "question_id": 41264319, "link": "https://stackoverflow.com/questions/41264319/c-hertz-to-seconds-and-how-to-get-the-proper-time-for-a-delay", "title": "C - Hertz to Seconds and how to get the proper time for a delay?", "body": "<p>I am playing around with a PIC 24 and currently I have a bit of a problem with converting hertz to seconds and then using it as a delay for a signal send to a piezo piece(buzzer, zoomer, speaker, etc) and I would like to make it play certain notes.</p>\n\n<p>I want to know if I am doing my conversion from hertz to seconds(mseconds in the code provided) and if I am doing my signal processing properly. </p>\n\n<p>Here is the code where I am troubled with:</p>\n\n<p>My hertz to int conversion:</p>\n\n<pre><code>int16 note(int i)\n{\n   float time = (1.0/i);\n\n   int fin = ((time/2) * 1000);\n\n   return fin;\n}\n</code></pre>\n\n<p>and here is how I send the signal to the pic24 I am using:</p>\n\n<pre><code>void main()\n{\nInitMCU();\n\n output_high(PIN_D1);\n delay_ms(note(E));\n output_low(PIN_D1);\n delay_ms(200); \n output_high(PIN_D1);\n delay_ms(note(E));\n output_low(PIN_D1);\n delay_ms(200);\n}\n</code></pre>\n\n<p>Here is how I have defined the notes:</p>\n\n<pre><code>#define C 255 //do\n#define D 227 //re\n#define E 204 //mi\n#define F 191\n#define G 170\n#define A 153\n#define B 136\n#define C2 127\n</code></pre>\n"}, {"tags": ["c", "list", "for-loop", "nodes", "sign"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482328220, "post_id": 41264297, "comment_id": 69729321, "body": "Think about what happens when <code>n</code> is the last node in the list, and <code>n-&gt;next</code> is a null pointer."}, {"owner": {"reputation": 257, "user_id": 7231463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00de634f69a0e0ef96b93f978ccc02c?s=128&d=identicon&r=PG&f=1", "display_name": "NoIdea", "link": "https://stackoverflow.com/users/7231463/noidea"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482328606, "post_id": 41264297, "comment_id": 69729623, "body": "Worked thanks to you!"}], "answers": [{"tags": [], "owner": {"reputation": 23064, "user_id": 3177124, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/65014fdf3cfd04b1452620aeb54dcede?s=128&d=identicon&r=PG&f=1", "display_name": "abligh", "link": "https://stackoverflow.com/users/3177124/abligh"}, "is_accepted": true, "score": 2, "last_activity_date": 1482381124, "last_edit_date": 1482381124, "creation_date": 1482380623, "answer_id": 41275764, "question_id": 41264297, "link": "https://stackoverflow.com/questions/41264297/counting-the-sign-changes-in-a-list-in-c/41275764#41275764", "title": "Counting the sign changes in a list in C", "body": "<p>This is in essence a fence post problem. The number of possible sign changes is one less than the number of elements in the list, so as you are checking on each item, you can tell you are doing something wrong. The problem in fact occurs when checking the last item on the list - it attempts to check for a sign change to the 'next' item, and there isn't one, as <code>n-&gt;next</code> is <code>NULL</code>.</p>\n\n<p>This can be fixed by a simple change to the terminating condition in the <code>for</code> loop as follows:</p>\n\n<pre><code>int number_of_sign_changes(DoubleList* list) {\n    int changes = 0;\n    for (DoubleNode *n = list-&gt;first; n != NULL &amp;&amp; n-&gt;next != NULL; n = n-&gt;next) {\n        if ((n-&gt;value &gt;= 0) &amp;&amp; (n-&gt;next-&gt;value &lt; 0)) {\n            changes += 1;\n        } else if ((n-&gt;value &lt; 0) &amp;&amp; (n-&gt;next-&gt;value &gt;= 0)) {\n            changes += 1;\n        } \n    }\n    return changes;\n}\n</code></pre>\n"}], "owner": {"reputation": 257, "user_id": 7231463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00de634f69a0e0ef96b93f978ccc02c?s=128&d=identicon&r=PG&f=1", "display_name": "NoIdea", "link": "https://stackoverflow.com/users/7231463/noidea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 41275764, "answer_count": 1, "score": 1, "last_activity_date": 1482381124, "creation_date": 1482328054, "last_edit_date": 1482328355, "question_id": 41264297, "link": "https://stackoverflow.com/questions/41264297/counting-the-sign-changes-in-a-list-in-c", "title": "Counting the sign changes in a list in C", "body": "<p>I have to get the number of sign changes in a list of doubles. For example if there is a list like that: \"1, -1, -1, 1\" there are 2 sign changes, between the adjacent elements. I tried it like this but for some reason the program crashes if I try to compile it:</p>\n\n<pre><code>int number_of_sign_changes(DoubleList* list) {\n    int changes = 0;\n    for (DoubleNode *n = list-&gt;first; n != NULL; n = n-&gt;next) {\n        if ((n-&gt;value &gt;= 0) &amp;&amp; (n-&gt;next-&gt;value &lt; 0)) {\n            changes += 1;\n        } else if ((n-&gt;value &lt; 0) &amp;&amp; (n-&gt;next-&gt;value &gt;= 0)) {\n            changes += 1;\n        } \n    }\n    return changes;\n}\n</code></pre>\n\n<p>The loop definitely works. I tried it in other functions but here it won't work. Does anyone have an idea? Btw you could actually put the 2 if statements into 1 and I tried that aswell but same problem.</p>\n"}, {"tags": ["c", "printf", "c89", "size-t", "c-libraries"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 5, "creation_date": 1482326886, "post_id": 41263896, "comment_id": 69728442, "body": "The <code>z</code> prefix was added in C99 I believe."}, {"owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1482326955, "post_id": 41263896, "comment_id": 69728484, "body": "@KerrekSB Ok.  It doesn&#39;t seem to be annotated.  <a href=\"http://en.cppreference.com/w/cpp/io/c/fprintf\" rel=\"nofollow noreferrer\">en.cppreference.com/w/cpp/io/c/fprintf</a>"}, {"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1482327384, "post_id": 41263896, "comment_id": 69728777, "body": "Why should a C++ reference say anything about a C standard?"}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1482327423, "post_id": 41263896, "comment_id": 69728798, "body": "<a href=\"https://linux.die.net/man/3/printf\" rel=\"nofollow noreferrer\">The Man</a> has it..."}, {"owner": {"reputation": 15295, "user_id": 3436922, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Y8KQX.jpg?s=128&g=1", "display_name": "LPs", "link": "https://stackoverflow.com/users/3436922/lps"}, "edited": false, "score": 0, "creation_date": 1482327494, "post_id": 41263896, "comment_id": 69728851, "body": "<a href=\"http://www.cplusplus.com/articles/iz3hAqkS/\" rel=\"nofollow noreferrer\">Here a some history</a>"}, {"owner": {"reputation": 43188, "user_id": 273767, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/363e49843e26763a496164190940ece4?s=128&d=identicon&r=PG", "display_name": "Cubbi", "link": "https://stackoverflow.com/users/273767/cubbi"}, "edited": false, "score": 1, "creation_date": 1482339353, "post_id": 41263896, "comment_id": 69736837, "body": "Now marked on cppreference"}, {"owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "reply_to_user": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1482345038, "post_id": 41263896, "comment_id": 69739973, "body": "@mch Right.  I meant to post the C reference."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1482866783, "post_id": 41264434, "comment_id": 69903737, "body": "Note that the above code would be sufficient, though not necessarily efficient, on any platform where <code>unsigned long</code> was large enough to accommodate the largest possible value of <code>n</code> (regardless of whether it was large enough to handle the full range of <code>size_t</code>).  There is no guarantee, however, that <code>size_t</code> won&#39;t be larger than <code>unsigned long</code>, and there might not be any guarantee that <code>n</code> would always fit in <code>unsigned long</code>.  I don&#39;t know how often that would be a problem [many programs could run into different trouble if they calculate the size of sprintf buffers..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1482866829, "post_id": 41264434, "comment_id": 69903760, "body": "...based upon a presumption that the maximum length of a decimal-formatted unsigned long is 10 digits and the value to be output ends up being longer than that]."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1522404214, "post_id": 41264434, "comment_id": 86152090, "body": "For better portability, use <code>printf(&quot;%llu\\n&quot;, (unsigned long long)n);</code>, unless you know that the size is small, such as <code>sizeof(int)</code> in which case you can simply write <code>printf(&quot;%u\\n&quot;, (unsigned)n);</code>"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 3, "creation_date": 1537776618, "post_id": 41264434, "comment_id": 91891588, "body": "@chqrlie <code>unsigned long long</code> didn&#39;t exist in C89 - that&#39;s the reason I suggested <code>unsigned long</code>. If <code>unsigned long long</code> is available (C99), then <code>%zu</code> specifier for <code>size_t</code> would also be available. Thus there&#39;s no need to cast to <code>unsigned long long</code> here at all."}], "tags": [], "owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "is_accepted": true, "score": 18, "last_activity_date": 1482328458, "creation_date": 1482328458, "answer_id": 41264434, "question_id": 41263896, "link": "https://stackoverflow.com/questions/41263896/is-the-zu-specifier-required-for-printf/41264434#41264434", "title": "Is the %zu specifier required for printf?", "body": "<blockquote>\n  <p>If size_t exists shouldn't  zu also be available in printf?</p>\n</blockquote>\n\n<p><code>size_t</code> existed at least since C89 but the respective format specifier <code>%zu</code> (specifically the length modifier <code>z</code>) was added to the standard only since C99.</p>\n\n<p>So, if you can't use C99 (or C11) and had to print <code>size_t</code> in C89, you just have to fallback to other existing types, such as:</p>\n\n<pre><code>printf(\"%lu\\n\", (unsigned long)n);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1537820582, "post_id": 49568870, "comment_id": 91914910, "body": "The problem is actually located in the C library. A common case where <code>%zu</code> is not supported is older versions of MinGW that use gcc in combination with the system&#39;s Microsoft C library, which until very recently did not support most C99 extensions."}], "tags": [], "owner": {"reputation": 43, "user_id": 8564030, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-rYFJIpdFEHM/AAAAAAAAAAI/AAAAAAAAAAc/QseRe56CgVI/photo.jpg?sz=128", "display_name": "Praveen Kumar Rana", "link": "https://stackoverflow.com/users/8564030/praveen-kumar-rana"}, "is_accepted": false, "score": -3, "last_activity_date": 1522395598, "last_edit_date": 1522395598, "creation_date": 1522387606, "answer_id": 49568870, "question_id": 41263896, "link": "https://stackoverflow.com/questions/41263896/is-the-zu-specifier-required-for-printf/49568870#49568870", "title": "Is the %zu specifier required for printf?", "body": "<p>This is working fine. In my system, it's printing the expected value.\nYou may be getting the error due to the compiler. I am using the <strong>GCC</strong> compiler. If you have this only and trying to get the output the first update the GCC and then try. It will work.</p>\n\n<p><img src=\"https://i.stack.imgur.com/xu3js.png\" alt=\"Your program input\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/knf0d.png\" alt=\"The output of the program\"></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13555247, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gjn4pQiGtxzqQxoVhB7PGD77ILzMU5a7NopRk3Z-g=k-s128", "display_name": "Crazy_but_true", "link": "https://stackoverflow.com/users/13555247/crazy-but-true"}, "is_accepted": false, "score": -1, "last_activity_date": 1599631900, "creation_date": 1599631900, "answer_id": 63805693, "question_id": 41263896, "link": "https://stackoverflow.com/questions/41263896/is-the-zu-specifier-required-for-printf/63805693#63805693", "title": "Is the %zu specifier required for printf?", "body": "<p>size_t is returned by sizeof(). %zu specifier prints the length.So to return the size of n,the code should read: #include &lt;stdio.h&gt;</p>\n<p>int main(void) { size_t n=123; printf(&quot;%zu\\n&quot;,sizeof (n)); return 0;` }</p>\n"}], "owner": {"reputation": 31428, "user_id": 908939, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/etRsI.jpg?s=128&g=1", "display_name": "Trevor Hickey", "link": "https://stackoverflow.com/users/908939/trevor-hickey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31206, "favorite_count": 2, "protected_date": 1599632075, "accepted_answer_id": 41264434, "answer_count": 3, "score": 13, "last_activity_date": 1599631900, "creation_date": 1482326846, "last_edit_date": 1482327529, "question_id": 41263896, "link": "https://stackoverflow.com/questions/41263896/is-the-zu-specifier-required-for-printf", "title": "Is the %zu specifier required for printf?", "body": "<p>We are using C89 on an embedded platform. I attempted to print out a <code>size_t</code>, but it did not work:  </p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void) {\n    size_t n = 123;\n    printf(\"%zu\\n\",n);\n    return 0;\n}\n</code></pre>\n\n<p>Instead of <code>123</code>, I got <code>zu</code>.<br>\nOther specifiers work correctly.  </p>\n\n<p>If <code>size_t</code> exists shouldn't  <code>zu</code> also be available in <code>printf</code>?<br>\nIs this something I should contact my library vendor about, or is a library implementation allowed to exclude it?</p>\n"}, {"tags": ["c", "gtk", "vala", "gobject"], "comments": [{"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1482328421, "post_id": 41263888, "comment_id": 69729480, "body": "You have to specify the methods as <code>public override Gtk...</code> (note the override keyword). Also the method signature must match exactly, so you have to use <code>unowned</code> where the parent method uses <code>unowned</code> and you can&#39;t just introduce nullable (<code>?</code>) where the parent method doesn&#39;t use nullable ..."}, {"owner": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "reply_to_user": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1482329164, "post_id": 41263888, "comment_id": 69729975, "body": "Even adding <code>override</code> and removing nullable results in <code>error: PreferencesStyleProvider.get_icon_factory: no suitable method found to override</code>. And if I can&#39;t return <code>null</code>, how to meet the documented requirements?"}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1482329734, "post_id": 41263888, "comment_id": 69730372, "body": "You can return null, since Gtk.IconFactory is a class type, are you by any chance using the experimental non-null mode? The VAPI file needs fixing anyway, it should be nullable in the vapi file."}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1482329827, "post_id": 41263888, "comment_id": 69730428, "body": "Also I just now realize that Gtk.StyleProvider is not an abstract class, but an interface. Sorry about that, to implement interfaces <code>override</code> is not necessary AFAIK."}, {"owner": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "reply_to_user": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "edited": false, "score": 0, "creation_date": 1482330387, "post_id": 41263888, "comment_id": 69730811, "body": "I don&#39;t see <code>--enable-experimental-non-null</code> in the <code>valac</code> command."}], "answers": [{"comments": [{"owner": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "edited": false, "score": 0, "creation_date": 1482330497, "post_id": 41265046, "comment_id": 69730896, "body": "Looks like I picked a wrong class to use for my first Vala interface experience!"}, {"owner": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "edited": false, "score": 0, "creation_date": 1482331880, "post_id": 41265046, "comment_id": 69731852, "body": "Thank you, it works for me now as well! This explains several Vala concepts clearly!"}, {"owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "reply_to_user": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "edited": false, "score": 0, "creation_date": 1482340587, "post_id": 41265046, "comment_id": 69737521, "body": "You&#39;re welcome, that&#39;s what SO is for, we always look forward to help users with well-described problems/questions :)."}], "tags": [], "owner": {"reputation": 13704, "user_id": 426242, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CEL49.jpg?s=128&g=1", "display_name": "Jens M&#252;hlenhoff", "link": "https://stackoverflow.com/users/426242/jens-m%c3%bchlenhoff"}, "is_accepted": true, "score": 1, "last_activity_date": 1482330521, "last_edit_date": 1482330521, "creation_date": 1482330259, "answer_id": 41265046, "question_id": 41263888, "link": "https://stackoverflow.com/questions/41263888/inheriting-interface-in-vala-incompatible-with-base-method/41265046#41265046", "title": "Inheriting interface in Vala - incompatible with base method", "body": "<p>This compiles without errors or warnings on my system (Vala 0.32.1):</p>\n\n<pre><code>public class DerivedStyleProvider : GLib.Object, Gtk.StyleProvider\n{\n    public unowned Gtk.IconFactory get_icon_factory (Gtk.WidgetPath path)\n    {\n        // Evil cast to work around buggy declaration in VAPI file\n        return (Gtk.IconFactory) null;\n    }\n\n    public Gtk.StyleProperties get_style (Gtk.WidgetPath path)\n    {\n        // Evil cast to work around buggy declaration in VAPI file\n        return (Gtk.StyleProperties) null;\n    }\n\n    bool get_style_property (Gtk.WidgetPath path,\n                    Gtk.StateFlags state,\n                    GLib.ParamSpec pspec,\n                    out GLib.Value value)\n    {\n        // I just assigned something here to make the compiler happy, you should make sure to use a correct value\n        value = Value (typeof (string));\n        return false; //TODO\n    }\n}\n</code></pre>\n\n<p>I made these changes:</p>\n\n<ul>\n<li>Derive from <code>GLib.Object</code> in addition to the interface.</li>\n<li>Use <code>unowned</code> on the first method.</li>\n<li>Remove the nullable from the return types.</li>\n<li>Cast null into the actual class types. (Which is not pretty, but the problem is with the vapi file.)</li>\n<li>Assign a dummy value to the out parameter to make compiling warning free ;)</li>\n</ul>\n"}], "owner": {"reputation": 5290, "user_id": 1381158, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/006e901151b153171d7a5918b56c511c?s=128&d=identicon&r=PG", "display_name": "Inductiveload", "link": "https://stackoverflow.com/users/1381158/inductiveload"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 41265046, "answer_count": 1, "score": 1, "last_activity_date": 1482330521, "creation_date": 1482326818, "last_edit_date": 1482327423, "question_id": 41263888, "link": "https://stackoverflow.com/questions/41263888/inheriting-interface-in-vala-incompatible-with-base-method", "title": "Inheriting interface in Vala - incompatible with base method", "body": "<p>I'm trying to implement a <code>Gtk.StyleProvider</code> in Vala. The \"base class\" (in C) looks like:</p>\n\n<pre><code>GtkIconFactory *        gtk_style_provider_get_icon_factory ()\nGtkStyleProperties *    gtk_style_provider_get_style ()\ngboolean                gtk_style_provider_get_style_property ()\n</code></pre>\n\n<p>and in VAPI:</p>\n\n<pre><code>[CCode (cheader_filename = \"gtk/gtk.h\")]\npublic interface StyleProvider {\n    public abstract unowned Gtk.IconFactory get_icon_factory (Gtk.WidgetPath path);\n    public abstract unowned Gtk.StyleProperties get_style (Gtk.WidgetPath path);\n    public abstract bool get_style_property (Gtk.WidgetPath path, Gtk.StateFlags state, GLib.ParamSpec pspec, GLib.Value value);\n}\n</code></pre>\n\n<p>Where the first two methods should only return <code>NULL</code> according to the documentation for <code>GtkStyleProvider</code>.</p>\n\n<p>Thus, I wrote some Vala like this:</p>\n\n<pre><code>public class DerivedStyleProvider : Gtk.StyleProvider\n{\n    public Gtk.IconFactory? get_icon_factory (Gtk.WidgetPath path)\n    {\n        return null;\n    }\n\n    public Gtk.StyleProperties? get_style (Gtk.WidgetPath path)\n    {\n        return null;\n    }\n\n    bool get_style_property (Gtk.WidgetPath path,\n                    Gtk.StateFlags state,\n                    GLib.ParamSpec pspec,\n                    out GLib.Value value)\n    {\n        return false; //TODO\n    }\n}\n</code></pre>\n\n<p>I have a problem with the first two methods. If I have them as written here (with a <code>?</code>), then I get the following error:</p>\n\n<pre><code>error: overriding method `DerivedStyleProvider.get_icon_factory' is incompatible \nwith base method `Gtk.StyleProvider.get_icon_factory': Base method expected \nreturn type `Gtk.IconFactory', but `Gtk.IconFactory?' was provided.\n    public Gtk.IconFactory? get_icon_factory (Gtk.WidgetPath path)\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The <code>gtk_style_provider_get_style()</code> method is the same.</p>\n\n<p>If I remove the <code>?</code>, I get the following two errors per method:</p>\n\n<pre><code>error: overriding method `DerivedsStyleProvider.get_icon_factory' \nis incompatible with base method `Gtk.StyleProvider.get_icon_factory': Base \nmethod expected return type `Gtk.IconFactory', but `Gtk.IconFactory' was provided.\n        public Gtk.IconFactory get_icon_factory (Gtk.WidgetPath path)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsrc/Preferences.vala:138.3-138.14: warning: `null' incompatible with \nreturn type `Gtk.IconFactory`\n                return null;\n                ^^^^^^^^^^^\n</code></pre>\n\n<p>The first error especially is a bit strange to me, as the upshot is \"error: expected TYPE, got TYPE\"!</p>\n\n<p>Adding <code>unowned</code> to the first two methods still results in similar errors.</p>\n\n<p>How should I implement a <code>Gtk.StyleProvider</code> interface in Vala?</p>\n"}, {"tags": ["javascript", "c++", "c", "arrays", "emscripten"], "answers": [{"tags": [], "owner": {"reputation": 1364, "user_id": 519531, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RJH9g.jpg?s=128&g=1", "display_name": "Alexander Wallin", "link": "https://stackoverflow.com/users/519531/alexander-wallin"}, "is_accepted": true, "score": 1, "last_activity_date": 1482333122, "last_edit_date": 1482333122, "creation_date": 1482332473, "answer_id": 41265774, "question_id": 41263856, "link": "https://stackoverflow.com/questions/41263856/why-does-emscripten-throw-errors-for-some-number-added-to-an-allocated-float32ar/41265774#41265774", "title": "Why does Emscripten throw errors for some number added to an allocated Float32Array?", "body": "<p>This was a nice 101 memory management lesson.</p>\n\n<p>I am allocating 32 bytes, but since a <code>Float32Array</code> contain 32-bit (4 byte) numbers, I only allocate 25% of the memory I need. This means that when I write numbers to the last 3 quarters of the array, I overwrite memory somewhere else in the application, which sometimes causes an error and sometimes not.</p>\n\n<p>So, changing</p>\n\n\n\n<pre class=\"lang-js prettyprint-override\"><code>let ptr = Module._malloc(bufferLength)\n</code></pre>\n\n<p>to</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>let ptr = Module._malloc(bufferLength * Float32Array.BYTES_PER_ELEMENT)\n</code></pre>\n\n<p>does the trick.</p>\n"}], "owner": {"reputation": 1364, "user_id": 519531, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/RJH9g.jpg?s=128&g=1", "display_name": "Alexander Wallin", "link": "https://stackoverflow.com/users/519531/alexander-wallin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 41265774, "answer_count": 1, "score": 0, "last_activity_date": 1482333122, "creation_date": 1482326717, "last_edit_date": 1482332873, "question_id": 41263856, "link": "https://stackoverflow.com/questions/41263856/why-does-emscripten-throw-errors-for-some-number-added-to-an-allocated-float32ar", "title": "Why does Emscripten throw errors for some number added to an allocated Float32Array?", "body": "<h2>Update:</h2>\n\n<p>\u2193 <a href=\"http://#answer-41265774\" rel=\"nofollow noreferrer\">This has been resolved</a> \u2193, but I couldn't accept my own answer immediately.</p>\n\n<hr>\n\n<p>I am learning how to pass <code>TypeArray</code>s between JavaScript and \"C++\" compiled using Emscripten. In this process I ran into an error I don't know what to make of.</p>\n\n<p>This is the basically what I'm doing:</p>\n\n\n\n<pre class=\"lang-js prettyprint-override\"><code>let bufferLength = 32\nlet ptr = Module._malloc(bufferLength)\nlet buf = new Float32Array(Module.HEAPF32.buffer, ptr, bufferLength)\n\nfor (let i = 0; i &lt; bufferLength; i++) {\n  // The multiplier (here 1.234) sometimes causes an error,\n  // and sometimes it doesn't\n  buf[i] = i * 1.234\n}\n\n// Here is where the error is thrown and Module._abort()\n// is invoked\nModule._free(ptr)\n</code></pre>\n\n<p>I have set up a repo where this is reproducable: <a href=\"https://github.com/alexanderwallin/emcc-f32-buffer-error\" rel=\"nofollow noreferrer\">https://github.com/alexanderwallin/emcc-f32-buffer-error</a>. The repo tests the multipliers <code>[1.1, 1.2, 1.3, 1.4]</code>, where <code>1.1</code> and <code>1.4</code> causes errors.</p>\n\n<p><code>Module</code> in this case is an empty C file compiled using <code>emcc -o empty.js empty.c</code>.</p>\n\n<p>This is the console output:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>- - - - - - - \n\nf32-ptr-tests.js:24 testing multiplier: 1.1\nf32-ptr-tests.js:34 ... did fill array\nf32-ptr-tests.js:41 oh nose!\nf32-ptr-tests.js:42 abort() at Error\n    at jsStackTrace (file:///path/to/emcc-f32-ptr-error/empty.js:1173:13)\n    at stackTrace (file:///path/to/emcc-f32-ptr-error/empty.js:1190:22)\n    at Object.abort (file:///path/to/emcc-f32-ptr-error/empty.js:9814:44)\n    at _abort (file:///path/to/emcc-f32-ptr-error/empty.js:1796:22)\n    at _free (file:///path/to/emcc-f32-ptr-error/empty.js:8998:3)\n    at Object.asm._free (file:///path/to/emcc-f32-ptr-error/empty.js:9602:19)\n    at file:///path/to/emcc-f32-ptr-error/f32-ptr-tests.js:36:12\n(anonymous) @ f32-ptr-tests.js:42\nf32-ptr-tests.js:45 \n\n\nf32-ptr-tests.js:23 - - - - - - - \n\nf32-ptr-tests.js:24 testing multiplier: 1.2\nf32-ptr-tests.js:34 ... did fill array\nf32-ptr-tests.js:38 all good\nf32-ptr-tests.js:45 \n\n\nf32-ptr-tests.js:23 - - - - - - - \n\nf32-ptr-tests.js:24 testing multiplier: 1.3\nf32-ptr-tests.js:34 ... did fill array\nf32-ptr-tests.js:38 all good\nf32-ptr-tests.js:45 \n\n\nf32-ptr-tests.js:23 - - - - - - - \n\nf32-ptr-tests.js:24 testing multiplier: 1.4\nf32-ptr-tests.js:34 ... did fill array\nf32-ptr-tests.js:41 oh nose!\nf32-ptr-tests.js:42 abort() at Error\n    at jsStackTrace (file:///path/to/emcc-f32-ptr-error/empty.js:1173:13)\n    at stackTrace (file:///path/to/emcc-f32-ptr-error/empty.js:1190:22)\n    at Object.abort (file:///path/to/emcc-f32-ptr-error/empty.js:9814:44)\n    at _abort (file:///path/to/emcc-f32-ptr-error/empty.js:1796:22)\n    at _free (file:///path/to/emcc-f32-ptr-error/empty.js:8998:3)\n    at Object.asm._free (file:///path/to/emcc-f32-ptr-error/empty.js:9602:19)\n    at file:///path/to/emcc-f32-ptr-error/f32-ptr-tests.js:36:12\n</code></pre>\n\n<p>What is happening here?</p>\n"}, {"tags": ["c", "arrays", "memory-management", "memory-leaks"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482326240, "post_id": 41263681, "comment_id": 69728003, "body": "Please don&#39;t spam with language tag. Only add the relevant tag."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1482326292, "post_id": 41263681, "comment_id": 69728043, "body": "Possible Overflow?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1482326312, "post_id": 41263681, "comment_id": 69728062, "body": "As for your problem, first of all you should run a debug-build in a debugger to locate where in your code the crash happens. Then examine the involved variables to see if they are all looking okay. Finally edit your question to include those details."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1482326354, "post_id": 41263681, "comment_id": 69728088, "body": "Oh, and you <i>do</i> know that the <code>^</code> operator is the <i>bitwise xor</i> operator and not exponentiation?"}, {"owner": {"reputation": 13373, "user_id": 570767, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c426ae136671acf7156b3f758fe0d505?s=128&d=identicon&r=PG", "display_name": "Azodious", "link": "https://stackoverflow.com/users/570767/azodious"}, "edited": false, "score": 0, "creation_date": 1482326665, "post_id": 41263681, "comment_id": 69728308, "body": "<code>scanf(&quot; %lld&quot;, &amp;a);</code> why extra space?"}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1482327042, "post_id": 41263681, "comment_id": 69728537, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/11607854/conditional-check-for-i-28-fails-when-i-is-512\">Conditional check for &quot;i == (2^8)&quot; fails when i is 512?</a>"}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1482327093, "post_id": 41263681, "comment_id": 69728571, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2027877/mathematical-power-operator-not-working-as-expected\">mathematical power operator not working as expected</a>."}, {"owner": {"reputation": 486140, "user_id": 1187415, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/LpTRB.png?s=128&g=1", "display_name": "Martin R", "link": "https://stackoverflow.com/users/1187415/martin-r"}, "edited": false, "score": 0, "creation_date": 1482327241, "post_id": 41263681, "comment_id": 69728680, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/4843304/why-is-my-power-operator-not-working/25108773#25108773\">Why is my power operator (^) not working?</a>."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6562627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c149302b20e3c0cc5263a21e559c31?s=128&d=identicon&r=PG&f=1", "display_name": "Salmaan", "link": "https://stackoverflow.com/users/6562627/salmaan"}, "edited": false, "score": 0, "creation_date": 1482529735, "post_id": 41263736, "comment_id": 69819488, "body": "after using the pow() function although it does not crash but it does show every digit = 0. why is it so?"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1482326383, "creation_date": 1482326383, "answer_id": 41263736, "question_id": 41263681, "link": "https://stackoverflow.com/questions/41263681/why-is-the-following-c-code-not-working-i-cant-figure-out-the-error/41263736#41263736", "title": "why is the following C code not working? I can&#39;t figure out the error.", "body": "<p><code>^</code> means bit-wise XOR. If you want to take the power of something, use the <code>pow()</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 7825, "user_id": 3684343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bee557e309dc42d91a706c70c8c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "mch", "link": "https://stackoverflow.com/users/3684343/mch"}, "edited": false, "score": 0, "creation_date": 1482328175, "post_id": 41263912, "comment_id": 69729296, "body": "It is worth mentoning that it does not crash on <code>i = 4</code> at <code>&#47; 10^(14-i)</code>, because <code>&#47;</code> has a higher precedence than <code>^</code>."}], "tags": [], "owner": {"reputation": 26971, "user_id": 3073272, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/hofYF.jpg?s=128&g=1", "display_name": "GorvGoyl", "link": "https://stackoverflow.com/users/3073272/gorvgoyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1482326910, "creation_date": 1482326910, "answer_id": 41263912, "question_id": 41263681, "link": "https://stackoverflow.com/questions/41263681/why-is-the-following-c-code-not-working-i-cant-figure-out-the-error/41263912#41263912", "title": "why is the following C code not working? I can&#39;t figure out the error.", "body": "<p>Though Lundin mentioned the desired code but the actual problem for your run-time error is this:  </p>\n\n<ul>\n<li><p><code>(10^(15-i))</code> gives 0 when <code>i = 5</code>   <em>(<code>10^10</code> remember the XOR rule?)</em></p></li>\n<li><p>so <code>(a % (10^(15-i)))</code> becomes <code>a%0</code> which is classical divide by zero run-time error.</p></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 6562627, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09c149302b20e3c0cc5263a21e559c31?s=128&d=identicon&r=PG&f=1", "display_name": "Salmaan", "link": "https://stackoverflow.com/users/6562627/salmaan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1482326910, "creation_date": 1482326189, "last_edit_date": 1482326228, "question_id": 41263681, "link": "https://stackoverflow.com/questions/41263681/why-is-the-following-c-code-not-working-i-cant-figure-out-the-error", "title": "why is the following C code not working? I can&#39;t figure out the error.", "body": "<p>I don't know where the problem lies. The code compiles without any error, but while running it, it asks me for a number but when I hit enter after giving an input it crashes. Can anybody tell me where the problem lies? I think there is some memory problems but I can't figure out where. Thanks in advance.    </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint main(void)\n{ \n    int n[16];\n    long long a;\n    printf(\"enter your credit card number \\n\");\n    scanf(\" %lld\", &amp;a);\n    int i;\n    for ( i = 0; i &lt; 15; i++)\n    {\n        n[i] = (a % (10^(15-i))) / 10^(14-i);\n    }\n    int m = (n[1] + n[3] + n[5] + n[7] + n[9] + n[11] + n[13]);\nint w = 2 * m;\nint k = w % 10;\nint l = n[0] + n[2] + n[4] + n[6] + n[8] + n[10] + n[12] + n[14];\nint z = k + l;\nif (z % 10 == 0)\n{\n    printf(\"you card is valid\");\n}\nelse\n{\n    printf(\"go get a new card\");\n}\nreturn 0;\n}\n</code></pre>\n"}, {"tags": ["c", "singly-linked-list", "prefix", "infix-notation", "negative-integer"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 2, "creation_date": 1482326039, "post_id": 41263576, "comment_id": 69727864, "body": "<i>&quot;I have been trying a lot&quot;</i> - Then you&#39;ll have <i>something</i> to show for it, however minuscule. Please post it in your question."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482326181, "post_id": 41263576, "comment_id": 69727957, "body": "Prefix notation can be easily implemented using stacks. Single-linked list are very good as stacks. Think a little about that, preferably using pen and paper, while you search the Internet for any of the thousands of examples that are available."}], "owner": {"reputation": 3, "user_id": 7084313, "user_type": "registered", "profile_image": "https://graph.facebook.com/1808421199376570/picture?type=large", "display_name": "Ruby", "link": "https://stackoverflow.com/users/7084313/ruby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482325923, "creation_date": 1482325869, "last_edit_date": 1482325923, "question_id": 41263576, "link": "https://stackoverflow.com/questions/41263576/prefix-to-infix-conversion-using-singly-linked-list-handling-double-digit-and-ne", "title": "prefix to infix conversion using singly linked list handling double digit and negative digits in C", "body": "<p>I have been trying a lot but I cannot come up with an algorithm to convert prefix to Infix using singly linked list. Also I have to deal with integers -99 to 99. Can anyone at least provide me an algorithm to for this. Thank you very much!!\nI am coding in C</p>\n"}, {"tags": ["c++", "c", "malloc", "dynamic-memory-allocation", "calloc"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 4, "creation_date": 1482325584, "post_id": 41263448, "comment_id": 69727573, "body": "In C+ why you want <code>calloc()</code>?"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 4, "creation_date": 1482325610, "post_id": 41263448, "comment_id": 69727592, "body": "C or C++?  In C++ manual memory allocations, espcially the *alloc functions are frowned upon."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1482325666, "post_id": 41263448, "comment_id": 69727627, "body": "The general rule is that if you have a problem P you use a solution X that solves P, and not Y that happens to solve P as a side effect. There&#39;s no substitute for critical thinking; programming by recipe book rarely works."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482325733, "post_id": 41263448, "comment_id": 69727673, "body": "If it&#39;s for memory you don&#39;t need zero-initialized, why even chance paying extra for it?"}, {"owner": {"reputation": 7421, "user_id": 6782754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99008d0e4c4c15ab03d77938ad9e345b?s=128&d=identicon&r=PG", "display_name": "Gerhardh", "link": "https://stackoverflow.com/users/6782754/gerhardh"}, "edited": false, "score": 0, "creation_date": 1482325750, "post_id": 41263448, "comment_id": 69727691, "body": "How should <code>calloc</code> break any program that works fine with <code>malloc</code>? Everyone who uses <code>malloc</code> should be aware that he cannot rely on the content of the buffer. If it happens to be all zeroes that is just one possible result of random content."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482325772, "post_id": 41263448, "comment_id": 69727711, "body": "@NathanOliver: I&#39;m a C++ programmer, thought I&#39;d also add the <code>C</code> tag because the question is about <code>C</code> functions. I&#39;m well aware of C++ memory management best practices, but there&#39;s one case when I feel <code>malloc</code> is the best way to allocate memory: when I need to allocate a buffer of a fixed size that&#39;s encapsulated in one of my classes."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482325843, "post_id": 41263448, "comment_id": 69727747, "body": "@VioletGiraffe - You&#39;ll have to run that by me to see the merit of <code>malloc</code>. I&#39;ll just use <code>::operator new</code> if I really have to."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1482325844, "post_id": 41263448, "comment_id": 69727748, "body": "@VioletGiraffe If you need a fixed sized buffer <code>std::unique_ptr&lt;T[]&gt;</code> is the way I would go.  Now you have built in memory management."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482326131, "post_id": 41263448, "comment_id": 69727925, "body": "@NathanOliver: and runtime overhead. But yeah, I get the point."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1482326283, "post_id": 41263448, "comment_id": 69728031, "body": "@VioletGiraffe What run time overhead?  If you have a manually allocated pointer you still have to delete it at some point.  <code>std::unique_ptr</code> just binds that deletion to the pointers scope so you do not have to remember about it.  a <code>std::unique_ptr</code> with a default deleter should be just as efficient as doing it yourself with the benefit of not really being able to get it wrong."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482326874, "post_id": 41263448, "comment_id": 69728426, "body": "@NathanOliver: Is there no additional overhead in the unique pointer? No service structures, no thread-safety mechanisms? I have a hard time believing it&#39;s merely <code>class unique_ptr {T* _ptr};</code>"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482327093, "post_id": 41263448, "comment_id": 69728570, "body": "@NathanOliver: In the interest of full disclosure, it&#39;s worth looking at the actual runtime cost that unique_ptr has over raw pointers: The facility for dynamic ownership transfer has a dynamic cost, namely something like <code>p = make_unique&lt;...&gt;(...);</code> needs to perform a null check on <code>p</code> first, even if you statically know already that it is null. Moreover, passing unique pointers across function calls in inferior on the Itanium ABI, because the object has to go on the stack, while a raw pointer is passed in a register. (That&#39;s an implementation mistake, not a design mistake, but still.)"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 1, "creation_date": 1482327138, "post_id": 41263448, "comment_id": 69728606, "body": "@VioletGiraffe It pretty much is like you have it.  There is no thread safety, no atomic reference counting, no null checks,  It is meant to be as light weight as possible.  It does store the deleter in the structure but thanks to empty base class optimization if it is just a empty deleter like a call to <code>delete[]</code> then that  doesn&#39;t even make the size of the pointer bigger.  In gcc <code>sizeof(std::unique_ptr&lt;int[]&gt;)</code> is <code>8</code> which is the same size as a single pointer(64 bit)."}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482327161, "post_id": 41263448, "comment_id": 69728616, "body": "@NathanOliver: Of course all this is very rarely significant compared to the enormous conceptual advantage that type-based ownership semantics afford us."}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1482327215, "post_id": 41263448, "comment_id": 69728661, "body": "@KerrekSB Thanks for that.  I forgot about that case."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 0, "creation_date": 1482327944, "post_id": 41263448, "comment_id": 69729146, "body": "@NathanOliver: thanks, that&#39;s good to know."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1482329156, "post_id": 41263448, "comment_id": 69729968, "body": "You don&#39;t care about performance until you know where your bottleneck is."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1482330011, "post_id": 41263448, "comment_id": 69730556, "body": "@n.m.: that approach often results in a program that&#39;s one large bottleneck as a whole, possibly with no clearly defined hot spots. Having said that - yes, early optimization is evil."}], "answers": [{"comments": [{"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482326708, "post_id": 41263521, "comment_id": 69728334, "body": "I&#39;m more interested in lazy allocation that <code>calloc()</code> provides."}, {"owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "reply_to_user": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482327513, "post_id": 41263521, "comment_id": 69728861, "body": "@VioletGiraffe Then you definitely want <code>malloc</code>.  On Linux <code>malloc</code> returns a pointer not even pointing to real memory.  The memory becomes real the first time the program accesses it."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "reply_to_user": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482327757, "post_id": 41263521, "comment_id": 69729032, "body": "@VioletGiraffe calloc() doesn&#39;t do lazy allocation on any common platform as of yet. malloc() however does."}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1482327818, "post_id": 41263521, "comment_id": 69729068, "body": "@nos: I have links to two articles (well, an article and an SO answer) in my question that state otherwise. Are they false?"}], "tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": false, "score": 0, "last_activity_date": 1482325676, "creation_date": 1482325676, "answer_id": 41263521, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc/41263521#41263521", "title": "Is calloc better than malloc?", "body": "<p>It's all about what you want to do with the memory. <code>malloc</code> returns uninitialized (and possibly not even real yet) memory.  <code>calloc</code> return real, zero'ed memory.  If you need it zero'ed, then yes, <code>calloc</code> is your best option.  If you don't, why pay for zero'ing with a latency hit when you don't need it?</p>\n"}, {"tags": [], "owner": {"reputation": 96886, "user_id": 2296458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/wbG2s.png?s=128&g=1", "display_name": "Cory Kramer", "link": "https://stackoverflow.com/users/2296458/cory-kramer"}, "is_accepted": false, "score": 3, "last_activity_date": 1482325749, "creation_date": 1482325749, "answer_id": 41263538, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc/41263538#41263538", "title": "Is calloc better than malloc?", "body": "<p>The main difference between <code>malloc</code> and <code>calloc</code> is that <code>calloc</code> will zero-initialize your buffer, and <code>malloc</code> will leave the memory uninitialized.</p>\n\n<p>This gets to the common programming idiom of \"<strong>don't pay for what you don't use</strong>\". In other words, why zero-initialize something (which has a cost) if you don't necessarily need to (yet)?</p>\n\n<p>As a side note since you tagged C++: manual memory usage using <code>new/delete</code> is frowned upon in modern C++ (except in rare cases of memory pools, etc). Use of <code>malloc/free</code> is even more rare and should be used very sparingly.</p>\n"}, {"comments": [{"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482326773, "post_id": 41263547, "comment_id": 69728365, "body": "The zero-initialization aspect is quite clear. But what about lazy memory allocation that <code>calloc()</code> provides?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482327135, "post_id": 41263547, "comment_id": 69728602, "body": "@VioletGiraffe AFAIK, that is the property of the memory allocator, and applicable equally with <code>malloc()</code> and /or <code>calloc()</code> for a particular platform. Can you elaborate?"}, {"owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "edited": false, "score": 0, "creation_date": 1482327741, "post_id": 41263547, "comment_id": 69729021, "body": "The links are in my question: <a href=\"http://stackoverflow.com/a/2688522/634821\">stackoverflow.com/a/2688522/634821</a> and <a href=\"https://vorpus.org/blog/why-does-calloc-exist/\" rel=\"nofollow noreferrer\">vorpus.org/blog/why-does-calloc-exist</a>"}, {"owner": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 1, "creation_date": 1482327742, "post_id": 41263547, "comment_id": 69729024, "body": "If you need the first character in a <code>char</code> array to be <code>&#39;\\0&#39;</code>, just do it. <code>calloc</code> is overkill for such a simple initialization."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 68702, "user_id": 1593860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1361e47a8bf06d20ffda9a686ceb7e68?s=128&d=identicon&r=PG", "display_name": "Pete Becker", "link": "https://stackoverflow.com/users/1593860/pete-becker"}, "edited": false, "score": 0, "creation_date": 1482327843, "post_id": 41263547, "comment_id": 69729082, "body": "@PeteBecker that was one example scenario, we can find more complex scenarios for sure where we need the whole memory to be initialized. :)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 10, "last_activity_date": 1482327426, "last_edit_date": 1482327426, "creation_date": 1482325779, "answer_id": 41263547, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc/41263547#41263547", "title": "Is calloc better than malloc?", "body": "<p>This is really a situation-dependent decision. Rule of thumb is</p>\n\n<ul>\n<li><p>If you're first <em>writing into</em> the allocated memory, <code>malloc()</code> is better (less possible overhead).</p>\n\n<p>Example: Consider the following scenario</p>\n\n<pre><code>char * pointer = NULL;\n\n//allocation\n\nstrcpy(pointer, source);\n</code></pre>\n\n<p>here, allocation can be very well using <code>malloc()</code>.</p></li>\n<li><p>If there's a possibility of read-before-write with the allocated memory, go for <code>calloc()</code>, as it initializes memory. This way you can avoid the problem with unitialized memory read-before-write scenario which invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"noreferrer\">undefined behavior</a>.</p>\n\n<p>Example:</p>\n\n<pre><code>char * pointer = NULL;\n\n//allocation\n\nstrcat(pointer, source);\n</code></pre>\n\n<p>Here, <code>strcat()</code> needs the first argument to be a <em>string</em> already, and using <code>malloc()</code> to allocate cannot guarantee that. As <code>calloc()</code> zero-initializes the memory, it will serve the purpose here and thus, <code>calloc()</code> is the way to go for this case.</p></li>\n</ul>\n\n<p>To elaborate the second scenario, quoting from <code>C11</code>, chapter \u00a77.24.3.1 (<em>follow my emphasis</em>)</p>\n\n<blockquote>\n  <p>The <code>strcat()</code> function appends a copy of the string pointed to by <code>s2</code> (including the\n  terminating null character) to the <strong>end of the string pointed to by <code>s1</code></strong>. The initial character\n  of <code>s2</code> overwrites the null character at the end of <code>s1</code>. [....]</p>\n</blockquote>\n\n<p>So, in this case, the destination pointer should be a pointer to a string. Allocating via <code>calloc()</code> guarantees that while allocating using <code>malloc()</code> cannot guarantee that, as we know, from chapter \u00a77.22.3.4</p>\n\n<blockquote>\n  <p>The <code>malloc</code> function allocates space for an object whose size is specified by <code>size</code> and\n  <strong>whose value is indeterminate.</strong></p>\n</blockquote>\n\n<hr>\n\n<p>EDIT:</p>\n\n<p>One possible scenario where <code>malloc()</code> is advised over <code>calloc()</code>, is writing test stubs used for unit / integration testing. In that case, use of <code>calloc()</code> can hide potential bugs which arrive with cases similar to the later one.</p>\n"}, {"tags": [], "owner": {"reputation": 495, "user_id": 2231575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e679e8628e96f97ef0ec59c27e5393cf?s=128&d=identicon&r=PG", "display_name": "Mike Tyukanov", "link": "https://stackoverflow.com/users/2231575/mike-tyukanov"}, "is_accepted": false, "score": 2, "last_activity_date": 1482393516, "last_edit_date": 1495542734, "creation_date": 1482393516, "answer_id": 41278303, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc/41278303#41278303", "title": "Is calloc better than malloc?", "body": "<p>Use <code>calloc</code> for zero-filled allocations, but only when the zero-filling is really needed.</p>\n\n<p>You should always use <code>calloc(count,size)</code> instead of <code>buff=malloc(total_size); memset(buff,0,total_size)</code>.</p>\n\n<p>The call to zero-<code>memset</code> is the key. Both <code>malloc</code> and <code>calloc</code> are translated into OS calls which do lots of optimizations, use hardware tricks whenever possible, etc. But there is little that OS can do with <code>memset</code>. </p>\n\n<p>On the other hand, when do you need to zero-fill the allocated memory? The only common use is for zero-ended arbitrary length elements, such as C-strings. If that's the case, sure, go with <code>calloc</code>. </p>\n\n<p>But if you allocate the structures in which the elements are either fixed-length or carry the length of arbitrary-sized elements with them (such as C++ strings and vectors), zero-filling is not helpful at all, and if you try to rely on it, it can lead to tricky bugs. </p>\n\n<p>Suppose you write your custom linked list, and decide to skip the zeroing of the pointer to the next node by allocating the memory for the node with <code>calloc</code>. It works fine, then someone uses it with custom placement new, which doesn't zero-fill.  Trouble is, sometimes it will be zero-filled, and can pass all the usual testing, go in production, and there it will crash, crash sometimes, the dreaded unrepeatable bug.</p>\n\n<p>For debug purposes, zero-filling is usually not that good, either. 0 is too common, you rarely can write something like <code>assert(size);</code> because it's usually a valid value, too, you handle it with <code>if(!size)</code>, not with asserts. On the debugger it won't catch your eye, either, there are usually zeros everywhere in your memory. The best practice is to avoid unsigned types for the lengths (signed lengths can be useful for runtime error handling and some of the most common overflow checks, too). So, while <code>buff=malloc(total_size); memset(buff,0,total_size)</code> is to be avoided, the following is OK:</p>\n\n<pre><code>const signed char UNINIT_MEM=MY_SENTINEL_VALUE;\nbuff=malloc(total_size);\n#if DEBUG_MEMORY\nmemset(buff,UNINIT_MEM,total_size);\n#endif\n</code></pre>\n\n<p>In debug mode, runtime library or even OS do this for you sometimes, for example check <a href=\"https://stackoverflow.com/questions/370195/when-and-why-will-an-os-initialise-memory-to-0xcd-0xdd-etc-on-malloc-free-new\">this excellent post on VC++-specific sentinel values</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 1, "last_activity_date": 1482398721, "creation_date": 1482398721, "answer_id": 41279714, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc/41279714#41279714", "title": "Is calloc better than malloc?", "body": "<p>malloc() is far more common in C code than calloc().</p>\n\n<p>A text search for \"malloc\" will miss the calloc() calls.</p>\n\n<p>Replacement libraires will often have mymalloc(), myrealloc(), myfree() but not mycalloc().</p>\n\n<p>Zero-initialisation of pointers and reals isn't actually guaranteed to have the expected effect, though on every major platform all bits zero is NULL for a pointer and 0.0 for a real.</p>\n\n<p>calloc() tends to hide bugs. Debug malloc usually sets a fill pattern like DEADBEEF which evaluates to a large negative number and doesn't look like real data. So the program quickly crashes and, with a debugger, the error is flushed out.</p>\n"}], "owner": {"reputation": 28830, "user_id": 634821, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d6d6c32f9917c7209b1bd9dfe888c293?s=128&d=identicon&r=PG", "display_name": "Violet Giraffe", "link": "https://stackoverflow.com/users/634821/violet-giraffe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3592, "favorite_count": 2, "answer_count": 5, "score": 14, "last_activity_date": 1598960699, "creation_date": 1482325461, "last_edit_date": 1598960699, "question_id": 41263448, "link": "https://stackoverflow.com/questions/41263448/is-calloc-better-than-malloc", "title": "Is calloc better than malloc?", "body": "<p>I have just learned about the C <code>calloc()</code> function the other day. Having read its description and how it differs from <code>malloc</code> (<a href=\"https://stackoverflow.com/a/2688522/634821\">1</a>, <a href=\"https://vorpus.org/blog/why-does-calloc-exist/\" rel=\"nofollow noreferrer\">2</a>), I get the idea that, as a non-embedded programmer, I should <em>always</em> use <code>calloc()</code>. But is that really the case?</p>\n\n<p>One reservation I have is the extra delay for accessing the <code>calloc()</code>-ed memory, but I also wonder if there are cases when switching from <code>malloc()</code> to <code>calloc()</code> will break the program in some more serious way.</p>\n\n<p>P. S. The zero-initializing aspect of <code>calloc()</code> is quite clear to me. What I'm interested in learning about is the other difference between <code>calloc()</code> and <code>malloc()</code> - lazy memory allocation provided by <code>calloc()</code>. Please don't post an answer if you're going to focus purely on the memory initialization aspect.</p>\n"}, {"tags": ["c", "macos", "mono", "dynamic-linking", "mach-o"], "answers": [{"tags": [], "owner": {"reputation": 3143, "user_id": 5512384, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/CFi4N.jpg?s=128&g=1", "display_name": "jvarela", "link": "https://stackoverflow.com/users/5512384/jvarela"}, "is_accepted": false, "score": 2, "last_activity_date": 1603999081, "last_edit_date": 1603999081, "creation_date": 1482435089, "answer_id": 41290439, "question_id": 41263368, "link": "https://stackoverflow.com/questions/41263368/finding-virtual-memory-address-of-variable-on-osx/41290439#41290439", "title": "Finding virtual memory address of variable on osx", "body": "<p>For security reasons and to prevent buffer overflow attacks and other exploits, you can't know that, because of a security measure called PIE or ASLR (address space layout randomization). However, this can be disabled for debugging purposes. LLDB and GDB do/did it in order to debug executables. The way this can be done with a CLI app is as follows:</p>\n<ol>\n<li>Copy or download this python script from GitHub\n<a href=\"https://github.com/thlorenz/chromium-build/blob/master/mac/change_mach_o_flags.py\" rel=\"nofollow noreferrer\">https://github.com/thlorenz/chromium-build/blob/master/mac/change_mach_o_flags.py</a></li>\n<li>Save the python script, for example, next to your executable</li>\n<li>If so, open Terminal and <code>cd</code> to where your executable is</li>\n<li>enter <code>chmod +x ./change_mach_o_flags.py</code> to make the script executable</li>\n<li>enter <code>./change_mach_o_flags.py --no-pie ./YourExecutable</code></li>\n</ol>\n<p>Now the addresses of your executable should not be randomized anymore. Because of that, to calculate the addresses of your static / global variables is possible. To do that, do the following in Terminal (I am assuming you are using a 64-bit machine):</p>\n<ol>\n<li><p><code>otool -v -l ./YourExecutable | open -f</code>(this will generate a file text with the commands inside your executable of how to layout DATA, TEXT, etc. in memory)</p>\n</li>\n<li><p>Look for the section you are interested in. Look at the <code>addr</code> field. If it contains let's say <code>0x0000000100001020</code> then the variable will be placed exactly there with ASLR disabled.</p>\n</li>\n</ol>\n<p>I am not sure if this works with dylibs but you can try it. Now I ran out of time, but I can try at home and see if this is doable with dylibs.</p>\n"}], "owner": {"reputation": 377, "user_id": 1221009, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5b51b641661fba219045004aac9eed83?s=128&d=identicon&r=PG", "display_name": "GooKSL", "link": "https://stackoverflow.com/users/1221009/gooksl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1603999081, "creation_date": 1482325141, "question_id": 41263368, "link": "https://stackoverflow.com/questions/41263368/finding-virtual-memory-address-of-variable-on-osx", "title": "Finding virtual memory address of variable on osx", "body": "<p>Consider the following code in mono/domain.c:</p>\n\n<pre><code>static MonoDomain *mono_root_domain = NULL;\n   ...\nMonoDomain* mono_get_root_domain (void)\n{\n        return mono_root_domain;\n}\n</code></pre>\n\n<p>My task is to read the struct data pointed by the mono_root_domain pointer in runtime from another process. (Attaching, reading, locating dylibs, etc. from this other process is solved already)</p>\n\n<p>Looking into the generated libmono dylib I can find the corresponding symbol:</p>\n\n<p><a href=\"https://i.stack.imgur.com/r7OCE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r7OCE.png\" alt=\"_mono_root_domain symbol\"></a></p>\n\n<p>This symbol points to the address of 0x2621A8 which in the local relocation section (__DATA, __bss):</p>\n\n<p><a href=\"https://i.stack.imgur.com/dBBYk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dBBYk.png\" alt=\"local_relocation\"></a></p>\n\n<p>This points to the address of 0x1A7690 (__TEXT, __symbol_stub):\n<a href=\"https://i.stack.imgur.com/k13Pv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k13Pv.png\" alt=\"indirect stup\"></a></p>\n\n<p>The target is\n<a href=\"https://i.stack.imgur.com/0jeOS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0jeOS.png\" alt=\"target\"></a></p>\n\n<p>so 0x1A7DF8 (__TEXT, __stub_helper):\n<a href=\"https://i.stack.imgur.com/Q6ul5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q6ul5.png\" alt=\"enter image description here\"></a></p>\n\n<p>At this point I am completely lost of how to retrieve the actual pointer to the MonoDomain struct. Any help is appreciated.</p>\n"}, {"tags": ["c", "memory-management"], "comments": [{"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482324626, "post_id": 41263113, "comment_id": 69726935, "body": "You need to allocate space for <code>matrix[i]</code>."}, {"owner": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "reply_to_user": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482325274, "post_id": 41263113, "comment_id": 69727361, "body": "@RoadRunner that space is already allocated by malloc. I&#39;m trying to set the pointer to be the same as the value that matrix[nrows + i ...] points"}, {"owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "edited": false, "score": 0, "creation_date": 1482326883, "post_id": 41263113, "comment_id": 69728438, "body": "@ C.P. I wrote an answer below."}], "answers": [{"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 0, "last_activity_date": 1482330277, "last_edit_date": 1482330277, "creation_date": 1482325558, "answer_id": 41263476, "question_id": 41263113, "link": "https://stackoverflow.com/questions/41263113/set-pointers-on-dynamic-matrix/41263476#41263476", "title": "Set pointers on Dynamic Matrix", "body": "<p>I think there are a couple of problems with your code.</p>\n\n<ul>\n<li><p>You can simplify this line:</p>\n\n<pre><code>matrix = malloc(row_pointer_bytes + nrows * single_row_elements_bytes);\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>matrix = malloc(row_pointer_bytes);\n</code></pre>\n\n<p>Which allocates space for <code>uint8_t*</code> many rows in the matrix. </p>\n\n<blockquote>\n  <p>The <a href=\"https://www.tutorialspoint.com/c_standard_library/c_function_malloc.htm\" rel=\"nofollow noreferrer\"><code>malloc()</code></a> function only requires <code>size_t</code> amount of bytes needed to allocate requested memory on the heap, and returns a pointer to it. </p>\n</blockquote>\n\n<p>and that can simply be allocated by knowing how many rows are needed in the matrix, in this case <code>nrows</code>.  </p></li>\n<li><p>Additionally, your for loop:</p>\n\n<pre><code>for(i = 0; i &lt; nrows; i++)\n    matrix[i] = matrix[nrows + i * single_row_elements_bytes];\n</code></pre>\n\n<p>Doesn't allocate memory for <code>matrix[i]</code>, since each row has <code>n</code> columns, and you need to allocate memory for those columns. </p>\n\n<p>This should instead be:</p>\n\n<pre><code>for(i = 0; i &lt; nrows; i++)\n    matrix[i] = malloc(single_row_elements_bytes);\n</code></pre></li>\n<li><p>Another issue is how are allocating <code>single_row_elements_bytes</code>. Instead of:</p>\n\n<pre><code>size_t single_row_elements_bytes = ncols * sizeof **matrix; //**matrix is uint8_t**\n</code></pre>\n\n<p>This needs allocate <code>uint8_t</code> bytes for <code>n</code> columns, not <code>uint8_t**</code> bytes. It can be this instead:</p>\n\n<pre><code>size_t single_row_elements_bytes = ncols * sizeof(uint8_t);\n</code></pre></li>\n</ul>\n\n<p>Having said this, your code will compile if written like this. This is an example I wrote to test the code.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nuint8_t **NewMatrix(unsigned nrows, unsigned ncols);\n\nint\nmain(int argc, char *argv[]) {\n    uint8_t **returnmatrix;\n    unsigned nrows = 2, ncols = 2;\n    int i, j;\n\n    returnmatrix = NewMatrix(nrows, ncols);\n\n    for (i = 0; i &lt; nrows; i++) {\n        for (j = 0; j &lt; ncols; j++) {\n            printf(\"Enter number for row %d column %d: \", i+1, j+1);\n\n            /* format speficier for uint8_t, from &lt;inttypes.h&gt; */\n            if (scanf(\"%\"SCNu8\"\", &amp;returnmatrix[i][j]) != 1) {\n                printf(\"Invalid 8 bit number.\\n\");\n                exit(EXIT_FAILURE);\n            }\n        }\n    }\n\n    printf(\"\\nYour matrix:\\n\");\n    for (i = 0; i &lt; nrows; i++) {\n        for (j = 0; j &lt; ncols; j++) {\n            printf(\"%d \", returnmatrix[i][j]);\n        }\n        printf(\"\\n\");\n    }\n\n    /* Good to free at the end */\n    free(returnmatrix);\n\n    return 0;\n}\n\nuint8_t \n**NewMatrix(unsigned nrows, unsigned ncols) {\n    int i;\n    uint8_t **matrix;\n\n    size_t row_pointer_bytes = nrows * sizeof * matrix;\n    size_t column_row_elements_bytes = ncols * sizeof(uint8_t);\n\n    matrix = malloc(row_pointer_bytes);\n\n    /* Good to check return value */\n    if (!matrix) {\n        printf(\"Cannot allocate memory for %d rows.\\n\", nrows);\n        exit(EXIT_FAILURE);\n    }\n\n    for(i = 0; i &lt; nrows; i++) {\n        matrix[i] = malloc(column_row_elements_bytes);\n        if (!matrix[i]) {\n            printf(\"Cannot allocate memory for %d columns.\\n\", ncols);\n            exit(EXIT_FAILURE);\n        } \n    } \n\n    return matrix;\n}\n</code></pre>\n\n<p>Input:</p>\n\n<pre><code>Enter number for row 1 column 1: 1\nEnter number for row 1 column 2: 2\nEnter number for row 2 column 1: 3\nEnter number for row 2 column 2: 4\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Your matrix:\n1 2\n3 4\n</code></pre>\n\n<p>Compiled with:</p>\n\n<pre><code>gcc -Wall -o matrix matrix.c\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "edited": false, "score": 0, "creation_date": 1482331534, "post_id": 41264172, "comment_id": 69731623, "body": "why do you use size_t instead of unsigned? Thought it was just sizeof() return type (and also for malloc input)"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "edited": false, "score": 0, "creation_date": 1482335684, "post_id": 41264172, "comment_id": 69734494, "body": "@C.P. It is a bit pedantic, but <code>size_t</code> is the most portable/correct type to use when describing the size of an array, or when iterating through an array. This is indeed related to <code>sizeof</code>, becase <code>sizeof(array)</code> is required to return the number of bytes used in an array, and therefore <code>size_t</code> must always be large enough to handle the size of the largest possible array on the given system. Suppose for example that you have a 16 bit system where unsigned int is 65535, but at the same time the system allows arrays that are larger than 64kb."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "edited": false, "score": 0, "creation_date": 1482335880, "post_id": 41264172, "comment_id": 69734628, "body": "Although the main reason for using <code>size_t</code> is probably to remain compatible with standard library functions, for example <code>memcpy</code> and <code>strlen</code>."}, {"owner": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "edited": false, "score": 0, "creation_date": 1482670910, "post_id": 41264172, "comment_id": 69846305, "body": "I finally decided to implement the solution you proposed in &quot;Function to dynamically allocate matrix&quot;, but, how could I set &quot;matrix&quot; as a input parameter to a function?"}, {"owner": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "edited": false, "score": 0, "creation_date": 1482671079, "post_id": 41264172, "comment_id": 69846333, "body": "e.g. to implement a function to print the matrix, taking the matrix and number of rows and columns as inputs"}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": true, "score": 0, "last_activity_date": 1482327675, "last_edit_date": 1495535433, "creation_date": 1482327675, "answer_id": 41264172, "question_id": 41263113, "link": "https://stackoverflow.com/questions/41263113/set-pointers-on-dynamic-matrix/41264172#41264172", "title": "Set pointers on Dynamic Matrix", "body": "<p>Apart from various bugs mentioned in another answer, you are allocating the 2D array incorrectly. You are actually not allocating a 2D array at all, but instead a slow, fragmented look-up table.</p>\n\n<p>The correct way to allocate a 2D array dynamically is described at <a href=\"https://stackoverflow.com/questions/12462615/how-do-i-correctly-set-up-access-and-free-a-multidimensional-array-in-c\">How do I correctly set up, access, and free a multidimensional array in C?</a>. Detailed explanation about how this works and how array pointers work is explained at <a href=\"https://stackoverflow.com/a/32050859/584518\">Function to dynamically allocate matrix</a>.</p>\n\n<p>Here is an example using the above described techniques, for your specific case:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid NewMatrix (size_t nrows, size_t ncols, uint8_t (**matrix)[nrows][ncols])\n{\n  *matrix = malloc ( sizeof (uint8_t[nrows][ncols]) );\n}\n\n\nint main (void) \n{\n  size_t r = 3;\n  size_t c = 4;\n\n  uint8_t (*arr_ptr)[r][c];\n  NewMatrix(r, c, &amp;arr_ptr);\n  uint8_t (*matrix)[c] = arr_ptr[0];\n\n  uint8_t count=0;\n  for(size_t i=0; i&lt;r; i++)\n  {\n    for(size_t j=0; j&lt;c; j++)\n    {\n      matrix[i][j] = count;\n      count++;\n      printf(\"%2.\"PRIu8\" \", matrix[i][j]);\n    }\n    printf(\"\\n\");\n  }\n\n  free(arr_ptr);\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7319311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1672af7ac351f29ae184e51e55cfe23?s=128&d=identicon&r=PG&f=1", "display_name": "vsj", "link": "https://stackoverflow.com/users/7319311/vsj"}, "is_accepted": false, "score": 0, "last_activity_date": 1482334460, "last_edit_date": 1482334460, "creation_date": 1482329473, "answer_id": 41264769, "question_id": 41263113, "link": "https://stackoverflow.com/questions/41263113/set-pointers-on-dynamic-matrix/41264769#41264769", "title": "Set pointers on Dynamic Matrix", "body": "<pre><code>    for (i=0;i&lt;nrows;i++)\n            matrix[i] = (uint8_t *)malloc(ncols * sizeof(uint8_t));\n</code></pre>\n\n<p>The below 2 lines have to be replaced by the above 2 lines</p>\n\n<pre><code>    for(i = 0; i &lt; nrows; i++)\n          matrix[i] = matrix[nrows + i * single_row_elements_bytes];\n</code></pre>\n\n<p>with <code>(nrows + i * single_row_elements_bytes)</code> as the allocation size, and with <code>nrows = 5</code> and <code>ncols =5</code>, say, a total of 65 bytes are allocated.\nThis include 40 bytes to store row pointers(assuming a 64bit pointer size) and rest 25 bytes to store contents of each r,c element. But the memory for column pointer (pointer to each element in that row) is not allocated.</p>\n\n<p>So, dereferencing <code>matrix[i][j]</code> will seg fault.</p>\n"}], "owner": {"reputation": 43, "user_id": 7325736, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/82ab44d32adcc58f32f8c492b2e38e1e?s=128&d=identicon&r=PG&f=1", "display_name": "C. P.", "link": "https://stackoverflow.com/users/7325736/c-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 41264172, "answer_count": 3, "score": 0, "last_activity_date": 1482334460, "creation_date": 1482324212, "question_id": 41263113, "link": "https://stackoverflow.com/questions/41263113/set-pointers-on-dynamic-matrix", "title": "Set pointers on Dynamic Matrix", "body": "<p>I'm trying to make a dynamic size matrix of 1-byte elements. To do so I defined the following function. The problem comes when I try to set the first \"nrows\" elements of the matrix to point the corresponding row (so I can do matrix[i][j]). It looks like that  <code>matrix[i] = matrix[nrows + i * single_row_elements_bytes];</code> doesn't work well enough (the program compiles but throws an core-segment-violation error). How can I make this work?</p>\n\n<pre><code>uint8_t **NewMatrix(unsigned nrows, unsigned ncols)\n{\n\n    uint8_t **matrix;\n    size_t row_pointer_bytes = nrows * sizeof *matrix;\n    size_t single_row_elements_bytes = ncols * sizeof **matrix;\n\n    matrix = malloc(row_pointer_bytes + nrows * single_row_elements_bytes);\n\n    unsigned i;\n\n    for(i = 0; i &lt; nrows; i++)\n        matrix[i] = matrix[nrows + i * single_row_elements_bytes];\n\n    return matrix;\n}\n</code></pre>\n"}, {"tags": ["c", "makefile", "extern", "undefined-reference"], "comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482324205, "post_id": 41263035, "comment_id": 69726674, "body": "I can&#39;t help but notice that <code>main.c</code> doesn&#39;t include <code>incapAche.h</code>"}, {"owner": {"reputation": 23, "user_id": 4711465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7569854488e6ad35b2af8eb1302dad5f?s=128&d=identicon&r=PG&f=1", "display_name": "Dado", "link": "https://stackoverflow.com/users/4711465/dado"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482331604, "post_id": 41263035, "comment_id": 69731669, "body": "i forgot it, changed"}, {"owner": {"reputation": 30739, "user_id": 186193, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/df61dcc6eec08cb7d62f1959b89ae843?s=128&d=identicon&r=PG", "display_name": "Ferenc Deak", "link": "https://stackoverflow.com/users/186193/ferenc-deak"}, "edited": false, "score": 0, "creation_date": 1482332388, "post_id": 41263035, "comment_id": 69732191, "body": "if you just compile the files as they are above (of course fixing issues like MAX_CONNECTIONS, aux, http ...) this links nicely. The problem must be somewhere else."}, {"owner": {"reputation": 23, "user_id": 4711465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7569854488e6ad35b2af8eb1302dad5f?s=128&d=identicon&r=PG&f=1", "display_name": "Dado", "link": "https://stackoverflow.com/users/4711465/dado"}, "edited": false, "score": 0, "creation_date": 1482338958, "post_id": 41263035, "comment_id": 69736599, "body": "do you have some idea?"}], "owner": {"reputation": 23, "user_id": 4711465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7569854488e6ad35b2af8eb1302dad5f?s=128&d=identicon&r=PG&f=1", "display_name": "Dado", "link": "https://stackoverflow.com/users/4711465/dado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 354, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482331466, "creation_date": 1482323964, "last_edit_date": 1482331466, "question_id": 41263035, "link": "https://stackoverflow.com/questions/41263035/clang-error-undefined-reference-to", "title": "clang : error : undefined reference to", "body": "<p>/************************/</p>\n\n<pre><code>incapAche.h\n\n...\n#ifdef INCaPACHE_2_1\n...\nextern int no_response_threads[];\n...\n#endif\n...\n</code></pre>\n\n<p>/***************************/</p>\n\n<pre><code>threads.c \n\n#include \"incApache.h\"\n\n#ifdef INCaPACHE_2_1\nint client_sockets[MAX_CONNECTIONS]; \nint no_response_threads[MAX_CONNECTIONS];\n#endif\n....\n</code></pre>\n\n<p>/*************************/</p>\n\n<pre><code>main.c\n\n#include \"incApache.h\"\n...\n\n#ifdef INCaPACHE_2_1\n    no_response_threads[i] = 0;\n#endif\n\n....\n</code></pre>\n\n<p>/******************************************/</p>\n\n<pre><code>Makefile\n\nCC=clang \nCFLAGS= -DHTML_404='\"404_Not_Found.html\"' \\\n    -DHTML_501='\"501_Method_Not_Implemented.html\"' \\\n    -DIMAGE='\"uncadunca.jpg\"' \\\n    -DSTYLE='\"000_style.css\"' \\\n    -DPRETEND_TO_BE_ROOT \\\n    -DINCaPACHE_2_1 \\\n    # -DDEBUG -g \\\n    -g3 -O0 -Wall -pedantic \nOBJS=aux.o http.o main.o threads.o\nBIN_DIR=bin\nEXE=$(BIN_DIR)/incapache\n\n.PHONY: clean tgz-students tgz-full\n\nall: $(EXE)\n\n$(EXE): $(OBJS) $(BIN_DIR)\n   $(CC) $(CFLAGS) -o $(EXE) $(OBJS) -lpthread\n   sudo chown root $(EXE)\n   sudo chmod u+s $(EXE)\n\naux.o: aux.c incApache.h\nhttp.o: http.c incApache.h\nmain.o: main.c incApache.h\nthreads.o: threads.c incApache.h\n</code></pre>\n\n<p>But i get this linking error main.c:(.text+0x5b2): undefined reference to `no_response_threads'\nclang: error: linker command failed with exit code 1 , I can t figure out why</p>\n"}, {"tags": ["c++", "c", "codeblocks", "pcap", "winpcap"], "comments": [{"owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "edited": false, "score": 1, "creation_date": 1482324050, "post_id": 41262935, "comment_id": 69726563, "body": "I&#39;ve voted to close as &quot;too broad&quot;.  Alternatively you may be asking for recommendations for a tool - which would be &quot;off topic&quot;.  <i>You</i> need to decide how you are going to parse the pcap files."}], "answers": [{"tags": [], "owner": {"reputation": 26087, "user_id": 1312406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5418f577abfa7c529dd026723462b440?s=128&d=identicon&r=PG", "display_name": "Paul Evans", "link": "https://stackoverflow.com/users/1312406/paul-evans"}, "is_accepted": true, "score": 0, "last_activity_date": 1482324465, "creation_date": 1482324465, "answer_id": 41263181, "question_id": 41262935, "link": "https://stackoverflow.com/questions/41262935/parse-pcap-files-to-sip-message-in-c/41263181#41263181", "title": "Parse pcap files to sip message in c++", "body": "<p>Your might want to check out libpcap.  You can parse a pcap file with:</p>\n\n<pre><code>pcap_t *pcap = pcap_open_offline(pcap_filename, errbuf);\nint link_layer_type = pcap_datalink(pcap);\npcap_loop(pcap, -1, pcap_handler, NULL);\npcap_close(pcap);\n</code></pre>\n\n<p>where pcap_handler is your call back function:</p>\n\n<pre><code>typedef void (*pcap_handler)(u_char *user, const struct pcap_pkthdr *h, const u_char *bytes); \n</code></pre>\n\n<p>Find details <a href=\"https://linux.die.net/man/3/pcap_loop\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 45, "user_id": 7271712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd736ddbd81f41d3ba6a7b9abd4a2b53?s=128&d=identicon&r=PG&f=1", "display_name": "cthulhu", "link": "https://stackoverflow.com/users/7271712/cthulhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 41263181, "answer_count": 1, "score": 0, "last_activity_date": 1482324465, "creation_date": 1482323636, "question_id": 41262935, "link": "https://stackoverflow.com/questions/41262935/parse-pcap-files-to-sip-message-in-c", "title": "Parse pcap files to sip message in c++", "body": "<p>i want to parse some information from pcap file to my project.\nI'm creating analizer that can find errors in sip calls. I created the class that can hold such information (not all of them for now). I use Windows and Codeblocks c++ and have installed the pcap library for windows.\nWhat is the easiest way to achieve this ?</p>\n\n<pre><code>class Messege\n    {\n    private:\n        int number;\n        string cseq;\n        string method;\n        string callId;\n        string source;\n        string destination;\n        string request;\n\n    public:\n        //set\n        void setCseq (string newCseq){cseq=newCseq;};\n        void setNumber (int newNumber){number=newNumber;};\n        void setMethod (string newMethod){method=newMethod;};\n        void setSource (string newSource){source=newSource;};\n        void setDestination (string newDestination){destination = newDestination;};\n        void setCallId (string newCallId){callId = newCallId;};\n        void setRequest (string newRequest){request = newRequest;};\n\n        //get\n        int getNumber (){return number;};\n        string getCseq (){return cseq;};\n        string getMethod (){return method;};\n        string getSource (){return source;};\n        string getDestination () {return destination;};\n        string getCallId (){return callId;};\n        string getRequest (){return request;};\n    };\n</code></pre>\n"}, {"tags": ["c", "list", "sum", "double", "nodes"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 6, "creation_date": 1482322634, "post_id": 41262640, "comment_id": 69725698, "body": "<code>next</code> is <code>NULL</code> on the second iteration."}, {"owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "edited": false, "score": 0, "creation_date": 1482322700, "post_id": 41262640, "comment_id": 69725741, "body": "Can you provide the definition of DoubleList?"}, {"owner": {"reputation": 106438, "user_id": 1275169, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4c6dbda4e65af6d2ceaabdfad538b319?s=128&d=identicon&r=PG&f=1", "display_name": "P.P", "link": "https://stackoverflow.com/users/1275169/p-p"}, "edited": false, "score": 0, "creation_date": 1482322731, "post_id": 41262640, "comment_id": 69725761, "body": "You probably mean something like: <code>for (DoubleNode *n = list-&gt;first; n != NULL; n = n-&gt;next) {</code> (notice the<code>n = n-&gt;next</code>)."}, {"owner": {"reputation": 48960, "user_id": 2522554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cebe27d4fdd15bb1fb77bab95ff493?s=128&d=identicon&r=PG", "display_name": "bansi", "link": "https://stackoverflow.com/users/2522554/bansi"}, "edited": false, "score": 1, "creation_date": 1482322733, "post_id": 41262640, "comment_id": 69725762, "body": "may be you missed <code>next = n-&gt;next</code>"}, {"owner": {"reputation": 257, "user_id": 7231463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00de634f69a0e0ef96b93f978ccc02c?s=128&d=identicon&r=PG&f=1", "display_name": "NoIdea", "link": "https://stackoverflow.com/users/7231463/noidea"}, "edited": false, "score": 0, "creation_date": 1482322839, "post_id": 41262640, "comment_id": 69725836, "body": "` typedef struct DoubleList {     DoubleNode* first;     DoubleNode* last;    } DoubleList;`"}, {"owner": {"reputation": 257, "user_id": 7231463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00de634f69a0e0ef96b93f978ccc02c?s=128&d=identicon&r=PG&f=1", "display_name": "NoIdea", "link": "https://stackoverflow.com/users/7231463/noidea"}, "edited": false, "score": 0, "creation_date": 1482322962, "post_id": 41262640, "comment_id": 69725913, "body": "Oh yes! The n-&gt;next was missing. Thank you very much!"}, {"owner": {"reputation": 2988, "user_id": 452414, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rDMfs.png?s=128&g=1", "display_name": "babon", "link": "https://stackoverflow.com/users/452414/babon"}, "edited": false, "score": 0, "creation_date": 1482323013, "post_id": 41262640, "comment_id": 69725934, "body": "Personally, I don&#39;t like <code>DoubleNode *n = list-&gt;first</code>, you most probably want to pass in the first element of the linked list to <code>sum()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 15044, "user_id": 416574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80e6a3e7975350dea41b2cf3fa46c407?s=128&d=identicon&r=PG", "display_name": "pstrjds", "link": "https://stackoverflow.com/users/416574/pstrjds"}, "is_accepted": false, "score": 1, "last_activity_date": 1482322716, "creation_date": 1482322716, "answer_id": 41262672, "question_id": 41262640, "link": "https://stackoverflow.com/questions/41262640/sum-of-all-elements-of-a-list-in-c/41262672#41262672", "title": "Sum of all elements of a list in C", "body": "<p>You need to ensure you get the next element in your loop. I am guessing that the <code>next</code> pointer is <code>n-&gt;next</code>:</p>\n\n<pre><code>for (DoubleNode *n = list-&gt;first; n != NULL; n = n-&gt;next) {\n    sum += n-&gt;value;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13373, "user_id": 570767, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c426ae136671acf7156b3f758fe0d505?s=128&d=identicon&r=PG", "display_name": "Azodious", "link": "https://stackoverflow.com/users/570767/azodious"}, "is_accepted": false, "score": 1, "last_activity_date": 1482322733, "creation_date": 1482322733, "answer_id": 41262679, "question_id": 41262640, "link": "https://stackoverflow.com/questions/41262640/sum-of-all-elements-of-a-list-in-c/41262679#41262679", "title": "Sum of all elements of a list in C", "body": "<p>Change </p>\n\n<pre><code>for (DoubleNode *n = list-&gt;first; n != NULL; n = next)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>for (DoubleNode *n = list-&gt;first; n != NULL; n = n-&gt;next)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4154, "user_id": 3844480, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ho59A.jpg?s=128&g=1", "display_name": "ilim", "link": "https://stackoverflow.com/users/3844480/ilim"}, "is_accepted": true, "score": 2, "last_activity_date": 1482322804, "creation_date": 1482322804, "answer_id": 41262696, "question_id": 41262640, "link": "https://stackoverflow.com/questions/41262640/sum-of-all-elements-of-a-list-in-c/41262696#41262696", "title": "Sum of all elements of a list in C", "body": "<p>You should fix your loop as follows.</p>\n\n<pre><code>double sum(DoubleList* list) {\n    double sum = 0;\n    for (DoubleNode *n = list-&gt;first; n != NULL; n = n-&gt;next) {\n        sum += n-&gt;value;\n    }\n    return sum;\n}\n</code></pre>\n\n<p>The sample code above assumes DoubleNode <em>has</em> an attribute named next and is of type DoubleNode*, that stores the pointer to the next element.</p>\n"}], "owner": {"reputation": 257, "user_id": 7231463, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a00de634f69a0e0ef96b93f978ccc02c?s=128&d=identicon&r=PG&f=1", "display_name": "NoIdea", "link": "https://stackoverflow.com/users/7231463/noidea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 41262696, "answer_count": 3, "score": 1, "last_activity_date": 1482322836, "creation_date": 1482322573, "last_edit_date": 1482322836, "question_id": 41262640, "link": "https://stackoverflow.com/questions/41262640/sum-of-all-elements-of-a-list-in-c", "title": "Sum of all elements of a list in C", "body": "<p>I need to get the sum of a list that only contains doubles.\nFor some reason that doesn't work, though:</p>\n\n<pre><code>double sum(DoubleList* list) {\n    DoubleNode *next = NULL;  \n    double sum = 0;\n    for (DoubleNode *n = list-&gt;first; n != NULL; n = next) {\n        sum += n-&gt;value;\n    }\n    return sum;\n}\n</code></pre>\n"}, {"tags": ["c++", "c", "xcode", "terminal"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482323243, "post_id": 41262609, "comment_id": 69726071, "body": "Does <code>export TERM=vt100</code> change something?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7139187"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482323529, "post_id": 41262609, "comment_id": 69726268, "body": "\u0130ts give me &quot;invalid preprocessing directive&quot; error"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482323595, "post_id": 41262609, "comment_id": 69726308, "body": "I meant in the shell before starting the executable, set the environmentvariable <code>TERM</code> to the value <code>vt100</code>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1482323600, "post_id": 41262609, "comment_id": 69726313, "body": "Learn how to use Terminal. The XCode terminal emulator isn&#39;t very full of features. Right-click your application in the project tree. There should be an item similar to &quot;Open directory in Terminal&quot;. When Terminal has opened, type <code>.&#47;your_application_name</code>. (The &quot;./&quot; are important.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7139187"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1482324079, "post_id": 41262609, "comment_id": 69726581, "body": "@Ctx \u0131m sorry \u0131 am new for Xcode can u explain step by step ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7139187"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1482324169, "post_id": 41262609, "comment_id": 69726642, "body": "@molbdnilo \u0131 find this my project name is xca but when \u0131 use your commend ./xca \u0131 mean &quot;-bash: /.xca: No such file or directory&quot; I&#39;m am getting this error"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1482325100, "post_id": 41262609, "comment_id": 69727229, "body": "@haktans4 Did you write <code>&#47;.</code> or <code>.&#47;</code>? They look alike but mean very different things."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7139187"}, "reply_to_user": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1482325303, "post_id": 41262609, "comment_id": 69727387, "body": "@molbdnilo \u0131 tried bought of them but \u0131 am getting same error \u0131 tried &quot;./xca.xcodeproj&quot; to"}], "owner": {"user_type": "does_not_exist", "display_name": "user7139187"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1482323104, "creation_date": 1482322454, "last_edit_date": 1482323104, "question_id": 41262609, "link": "https://stackoverflow.com/questions/41262609/xcode-ncurses-text-editor-exampleerror-opening-terminal-unknown", "title": "Xcode ncurses text editor example&quot;Error opening terminal: unknown&quot;", "body": "<p>Im trying to build and run simple ncurses project in XCODE.\n\u0131 use command line tool and c language.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;ncurses.h&gt;\n</code></pre>\n\n<p>imported ncurses.h in to my main and \u0131 added the library.\nbut when \u0131 trying to build and run Xcode give me this error.\nHow can \u0131 fix this with commend line tool or other way?\nI don't know how to use Terminal</p>\n"}, {"tags": ["android", "c", "bluetooth", "apk", "mouse"], "comments": [{"owner": {"reputation": 9541, "user_id": 1568530, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001179991520/picture?type=large", "display_name": "Vladyslav Matviienko", "link": "https://stackoverflow.com/users/1568530/vladyslav-matviienko"}, "edited": false, "score": 0, "creation_date": 1482320351, "post_id": 41261925, "comment_id": 69724213, "body": "1. you can&#39;t convert the application to APK. it does not work this way. 2. You should be able somehow to reverse it, but you will need to edit the mouse driver for example, or at least get root access."}, {"owner": {"reputation": 21, "user_id": 7325314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65301feae02dd4d811222378cefc760e?s=128&d=identicon&r=PG&f=1", "display_name": "John Spencer Schimdt", "link": "https://stackoverflow.com/users/7325314/john-spencer-schimdt"}, "reply_to_user": {"reputation": 9541, "user_id": 1568530, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001179991520/picture?type=large", "display_name": "Vladyslav Matviienko", "link": "https://stackoverflow.com/users/1568530/vladyslav-matviienko"}, "edited": false, "score": 0, "creation_date": 1482321524, "post_id": 41261925, "comment_id": 69724941, "body": "Thank you for replying @VladMatvienko! Well, I already have root access to my phone. However, I don&#39;t know where to start. I&#39;ll try to surf again in the internet about the mouse driver."}, {"owner": {"reputation": 9541, "user_id": 1568530, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001179991520/picture?type=large", "display_name": "Vladyslav Matviienko", "link": "https://stackoverflow.com/users/1568530/vladyslav-matviienko"}, "edited": false, "score": 0, "creation_date": 1482328103, "post_id": 41261925, "comment_id": 69729248, "body": "if you have root, then you might be able to use some linux instructions. But you can&#39;t use 3rd party linux software on Android, only the standard one, and even not all since Android is not full linux"}, {"owner": {"reputation": 435, "user_id": 2818480, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000191343416/picture?type=large", "display_name": "Khaled Hayek", "link": "https://stackoverflow.com/users/2818480/khaled-hayek"}, "edited": false, "score": 0, "creation_date": 1533560754, "post_id": 41261925, "comment_id": 90377649, "body": "Did you solve it ? @JohnSpencerSchimdt"}], "owner": {"reputation": 21, "user_id": 7325314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65301feae02dd4d811222378cefc760e?s=128&d=identicon&r=PG&f=1", "display_name": "John Spencer Schimdt", "link": "https://stackoverflow.com/users/7325314/john-spencer-schimdt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 744, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1482320224, "creation_date": 1482320224, "question_id": 41261925, "link": "https://stackoverflow.com/questions/41261925/is-it-possible-to-reverse-the-x-and-y-axis-of-the-mouse-on-android", "title": "Is it possible to reverse the x and y axis of the mouse on Android?", "body": "<p>Good day!</p>\n\n<p>Is it possible to reverse the x and y axis of the mouse such that when I hover the mouse to the right, the cursor will go to the left? I'm using a generic bluetooth mouse that I found on ebay. I already searched the web and all I found was on Windows, OSX, and Linux. I'm thinking of using Sakasa App and convert it to apk but I highly doubt that it'll work. Thank you so much! :)</p>\n\n<p>P.S Sorry for my grammar if there's any.</p>\n"}, {"tags": ["c", "binding", "fortran", "operator-keyword", "fortran-iso-c-binding"], "comments": [{"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1482320949, "post_id": 41261605, "comment_id": 69724598, "body": "Welcome. Don&#39;t put any greetings or your name under your post, your name is appended automatically below. Also don&#39;t copy tags to the title. It is good to tell us in which way is the  example &quot;non-working&quot;. Report any error messages you received."}, {"owner": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1482321507, "post_id": 41261605, "comment_id": 69724929, "body": "You are just missing the import statement in the interface block, add it and it compiles fine."}, {"owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "reply_to_user": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1482322972, "post_id": 41261605, "comment_id": 69725921, "body": "Thanks you very much for the help. It indeed works well now."}, {"owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "reply_to_user": {"reputation": 49888, "user_id": 721644, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KSRQT.jpg?s=128&g=1", "display_name": "Vladimir F", "link": "https://stackoverflow.com/users/721644/vladimir-f"}, "edited": false, "score": 0, "creation_date": 1482323142, "post_id": 41261605, "comment_id": 69726004, "body": "Sorry for the duplicate: I though the issue was related to C bindings, this is obviously not the case. Regards."}], "owner": {"reputation": 95, "user_id": 6225954, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3cb4218fe73c4a1ac594b907dd90235e?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6225954/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "closed_date": 1482321482, "answer_count": 0, "score": 0, "last_activity_date": 1482320841, "creation_date": 1482319253, "last_edit_date": 1482320841, "question_id": 41261605, "link": "https://stackoverflow.com/questions/41261605/fortran-operator-overloading-based-in-c-function", "closed_reason": "Duplicate", "title": "Fortran operator overloading based in C function", "body": "<p>I want to expose a C++ class to Fortran. From various searches, I have seen that the most direct way is to use intermediate C functions.</p>\n\n<p>My question is the following: considering a simple C struct describe below and a C function call <code>add</code>, how can I declare a Fortran module which would declare an associated Fortran derived type and use the <code>add</code> function for operator overloading ?</p>\n\n<pre><code>struct my_double{  double x; }\n\nmy_double add(const my_double*, const my_double*);\n</code></pre>\n\n<p>The (non working) solution I came up to is something like this:</p>\n\n<pre><code>module my_module\n  use iso_c_binding\n  type, bind(c) :: my_double\n     real(c_double) :: x\n  end type my_double\n  interface operator (+)\n    module procedure add\n  end interface operator (+)\n  interface\n     type(my_double) function add (v1,v2) bind ( c )\n       use iso_c_binding\n       type (my_double), intent(in) :: v1,v2\n       type (my_double)  :: v3\n    end function add\n  end interface\nend module my_module\n</code></pre>\n\n<p>Does anyone have an advice on how to make this work ?</p>\n"}, {"tags": ["c", "unix", "concurrency"], "comments": [{"owner": {"reputation": 437, "user_id": 7018835, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2309ee7ad6ccc069ed9145bb33078b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Anjaneyulu", "link": "https://stackoverflow.com/users/7018835/anjaneyulu"}, "edited": false, "score": 0, "creation_date": 1482315945, "post_id": 41260437, "comment_id": 69721372, "body": "You must change the signal at the beginning of the code so that it  can execute as soon as SIGUSR is received"}, {"owner": {"reputation": 21, "user_id": 7325076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466317ac3d697f79d4482e2b638b94e3?s=128&d=identicon&r=PG&f=1", "display_name": "Eli Nax 9", "link": "https://stackoverflow.com/users/7325076/eli-nax-9"}, "reply_to_user": {"reputation": 437, "user_id": 7018835, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2309ee7ad6ccc069ed9145bb33078b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Anjaneyulu", "link": "https://stackoverflow.com/users/7018835/anjaneyulu"}, "edited": false, "score": 1, "creation_date": 1482316612, "post_id": 41260437, "comment_id": 69721874, "body": "Thank you very much. This actually worked! I found the sys call pause() to be very useful but my book didn&#39;t even have an example of its use."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 2, "creation_date": 1482318942, "post_id": 41260437, "comment_id": 69723420, "body": "<code>write(1,&quot;I made a new child\\n&quot;,50);</code> will write a lot of junk to file descriptor 1 as the length of <code>&quot;I made a new child\\n&quot;</code> is much less than 50.  It&#39;s technically undefined behavior and can cause your program to fail."}, {"owner": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "reply_to_user": {"reputation": 437, "user_id": 7018835, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2309ee7ad6ccc069ed9145bb33078b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Anjaneyulu", "link": "https://stackoverflow.com/users/7018835/anjaneyulu"}, "edited": false, "score": 1, "creation_date": 1482319857, "post_id": 41260437, "comment_id": 69723946, "body": "@Anjaneyulu: &quot;<i>You must change the signal at the beginning of the code ...</i>&quot; this restriction is a bit tight. The signal handler needs to be install latest just before calling <code>fork()</code>."}, {"owner": {"reputation": 437, "user_id": 7018835, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2309ee7ad6ccc069ed9145bb33078b6b?s=128&d=identicon&r=PG&f=1", "display_name": "Anjaneyulu", "link": "https://stackoverflow.com/users/7018835/anjaneyulu"}, "reply_to_user": {"reputation": 66473, "user_id": 694576, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PpOGj.jpg?s=128&g=1", "display_name": "alk", "link": "https://stackoverflow.com/users/694576/alk"}, "edited": false, "score": 0, "creation_date": 1482322902, "post_id": 41260437, "comment_id": 69725885, "body": "@alk yest the signal handler not the signal"}], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1547456401, "creation_date": 1547456401, "answer_id": 54178314, "question_id": 41260437, "link": "https://stackoverflow.com/questions/41260437/unix-and-signal-handlers-c/54178314#54178314", "title": "Unix and Signal Handlers (C)", "body": "<p>You must change the signal at the beginning of the code so that it can execute as soon as SIGUSR is received \u2013 Anjaneyulu</p>\n\n<p>&quot;<i>You must change the signal at the beginning of the code ...</i>&quot; this restriction is a bit tight. The signal handler needs to be install latest just before calling <code>fork()</code>.\n                    &ndash;&nbsp;alk</p>\n"}], "owner": {"reputation": 21, "user_id": 7325076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466317ac3d697f79d4482e2b638b94e3?s=128&d=identicon&r=PG&f=1", "display_name": "Eli Nax 9", "link": "https://stackoverflow.com/users/7325076/eli-nax-9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1547456401, "creation_date": 1482315706, "question_id": 41260437, "link": "https://stackoverflow.com/questions/41260437/unix-and-signal-handlers-c", "title": "Unix and Signal Handlers (C)", "body": "<p>I'm a student and I am trying to understand signals within a course about Unix programming. </p>\n\n<p>To start, I wanted to test a simple example: a process makes a child and needs a confirmation of the actual creation.\nI fork, and within the child I send a SIGUSR1 to the father with\nkill(getppid(), SIGUSR1);\nThen, within the father, I wrote a pause(); sys call to block the process until a signal is received, and then I wrote the \n(sigaction(SIGUSR1, &amp;sa, NULL) check.</p>\n\n<p>Problem is, the signal is sent and the program stops, with no handler execution.</p>\n\n<p>I compile it with</p>\n\n<pre><code>$gcc -Wall -o test test.c\n</code></pre>\n\n<p>I get no warnings, and the output is</p>\n\n<pre><code>$I am the father\n$I am the child\n$User defined signal 1\n</code></pre>\n\n<p>I know I could do this in other ways (with sleep sys call, etc.), but I just want to understand why this code doesn't work.</p>\n\n<pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;signal.h&gt;\n\nvoid new_child (int sig){\n    write(1,\"I made a new child\\n\",50);\n}\n\nint main(){\n    pid_t child;\n    struct sigaction sa;            \n    sigemptyset(&amp;sa.sa_mask);\n    sa.sa_flags = 0;\n    sa.sa_handler = new_child;\n    switch(child = fork()){\n        case -1:\n            printf(\"Error.\\n\");\n            exit(EXIT_FAILURE);\n        case 0:\n            printf(\"I am the child\\n\");\n            kill(getppid(), SIGUSR1);\n            break;\n        default:\n            printf(\"I am the father\\n\");\n            pause();\n            if (sigaction(SIGUSR1, &amp;sa, NULL) == -1){\n                printf(\"Signal error.\\n\");\n                exit(EXIT_FAILURE);\n            }\n            printf(\"I'm done.\");\n            kill (child, SIGKILL);\n            exit(EXIT_SUCCESS);\n    }\n}\n</code></pre>\n\n<p>I know this question has already been asked, but I cannot seem to find a solution that works in my case.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 5, "creation_date": 1482315631, "post_id": 41260377, "comment_id": 69721122, "body": "you forgot the <code>break;</code> between the cases."}, {"owner": {"reputation": 42480, "user_id": 148423, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/6ed1f9b5afd258d0b73ad1eae10ac384?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/148423/joe"}, "edited": false, "score": 4, "creation_date": 1482315655, "post_id": 41260377, "comment_id": 69721145, "body": "All your variables are ints, so the division will be integer division. Percentages are probably best done as floats (which you can format as ints with <code>printf</code>)."}, {"owner": {"reputation": 1331, "user_id": 1820586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/78d078382e0c9425380ba637d04c9159?s=128&d=identicon&r=PG&f=1", "display_name": "csblo", "link": "https://stackoverflow.com/users/1820586/csblo"}, "edited": false, "score": 2, "creation_date": 1482315732, "post_id": 41260377, "comment_id": 69721202, "body": "It seems like homework"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7325053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9773e0d2dfaa888bf4636b0834d29b?s=128&d=identicon&r=PG&f=1", "display_name": "brlz", "link": "https://stackoverflow.com/users/7325053/brlz"}, "edited": false, "score": 0, "creation_date": 1482317625, "post_id": 41260404, "comment_id": 69722560, "body": "Well kinda jumped the gun there. @Bathsheba Edited the post, mind having a look over it? It still outputs only 0.00&#39;s"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 13, "user_id": 7325053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9773e0d2dfaa888bf4636b0834d29b?s=128&d=identicon&r=PG&f=1", "display_name": "brlz", "link": "https://stackoverflow.com/users/7325053/brlz"}, "edited": false, "score": 0, "creation_date": 1482317948, "post_id": 41260404, "comment_id": 69722776, "body": "Your <code>printf</code> formatters are incorrect: the first one is an <code>int</code>."}, {"owner": {"reputation": 13, "user_id": 7325053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9773e0d2dfaa888bf4636b0834d29b?s=128&d=identicon&r=PG&f=1", "display_name": "brlz", "link": "https://stackoverflow.com/users/7325053/brlz"}, "edited": false, "score": 0, "creation_date": 1482318270, "post_id": 41260404, "comment_id": 69723005, "body": "Thanks alot for the help ;)"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": true, "score": 3, "last_activity_date": 1482316335, "last_edit_date": 1482316335, "creation_date": 1482315606, "answer_id": 41260404, "question_id": 41260377, "link": "https://stackoverflow.com/questions/41260377/counting-vowels-in-text-without-arrays-c/41260404#41260404", "title": "Counting vowels in text without arrays (C)", "body": "<p>You need to insert <code>break</code> statements between the cases.</p>\n\n<p>Otherwise the program will execute all the statements below the one first entered. Actually this is a good feature. It allows you to consider multiple labels at the same time. Putting this together you get:</p>\n\n<pre><code> switch (current){\n case 'a': case 'A':\n    cntA += 1;\n    break; // Don't follow through to the other cases.\n case 'b': case 'B': /*etc*/\n</code></pre>\n\n<p>After this, note that <code>(cntA / cntAll) * 100;</code> will evaluate the expression in parentheses in <strong>integer arithmetic</strong>, which will truncate it to 0 in most cases. The fix is to write it as</p>\n\n<p><code>100 * cntA / cntAll;</code></p>\n\n<p>This will still truncate to an integer. If that's not tolerable then consider using the floating point expression <code>100.0 * cntA / cntAll</code> and change your <code>printf</code> formatters accordingly. Using floating point is arguably better anyway as it obviates the potential for overflow when evaluating <code>100 * cntA</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 7325053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9773e0d2dfaa888bf4636b0834d29b?s=128&d=identicon&r=PG&f=1", "display_name": "brlz", "link": "https://stackoverflow.com/users/7325053/brlz"}, "edited": false, "score": 0, "creation_date": 1482315914, "post_id": 41260410, "comment_id": 69721341, "body": "Well guess im kinda dumb, forgot that totally. Thanks"}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": false, "score": 1, "last_activity_date": 1482315626, "creation_date": 1482315626, "answer_id": 41260410, "question_id": 41260377, "link": "https://stackoverflow.com/questions/41260377/counting-vowels-in-text-without-arrays-c/41260410#41260410", "title": "Counting vowels in text without arrays (C)", "body": "<p><code>case</code> labels <em>falls through</em> to the next one below it without a <code>break</code>.</p>\n\n<p>So if you read an <code>'a'</code> then <em>all</em> the cases in your <code>switch</code> will be executed.</p>\n\n<p>You need something like</p>\n\n<pre><code>switch (current) {                              // check for vowel &amp; increase vowelcount\ncase 'a':\n    cntA += 1;\n    break;   // &lt;-- Note break here\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1820, "user_id": 3849158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q1Gcg.png?s=128&g=1", "display_name": "izlin", "link": "https://stackoverflow.com/users/3849158/izlin"}, "is_accepted": false, "score": 1, "last_activity_date": 1482316009, "last_edit_date": 1482316009, "creation_date": 1482315829, "answer_id": 41260488, "question_id": 41260377, "link": "https://stackoverflow.com/questions/41260377/counting-vowels-in-text-without-arrays-c/41260488#41260488", "title": "Counting vowels in text without arrays (C)", "body": "<p>First thing i notice is that you are missing <code>break</code> on every switch case. This will lead to wrong behaviour.\nSecond thing:</p>\n\n<pre><code>pA = (cntA / cntAll) * 100; \n</code></pre>\n\n<p>will calculate <code>cntS/cntAll</code> first which is <code>&lt;0</code>. This value will be interpreted as integer so you always have <code>0*100</code> which is 0. You can rewrite it as</p>\n\n<pre><code>pA = (cntA * 100 ) / cntAll; \n</code></pre>\n\n<p>In that case you don't have to cast to float to get the right result. Note that for large <code>cntA</code> you may overflow.</p>\n"}], "owner": {"reputation": 13, "user_id": 7325053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd9773e0d2dfaa888bf4636b0834d29b?s=128&d=identicon&r=PG&f=1", "display_name": "brlz", "link": "https://stackoverflow.com/users/7325053/brlz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 41260404, "answer_count": 3, "score": -1, "last_activity_date": 1482318391, "creation_date": 1482315508, "last_edit_date": 1482318391, "question_id": 41260377, "link": "https://stackoverflow.com/questions/41260377/counting-vowels-in-text-without-arrays-c", "title": "Counting vowels in text without arrays (C)", "body": "<p>i have to write a program that counts all vowels in a text &amp; gives out the percentage of every vowel for the whole text.\nFor whatever reason we are not allowed to use arrays, but instead should do it with getchar().</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main() {\n\n    int current;\n    int cntAll = 0;\n    int cntA = 0, cntE = 0, cntI = 0, cntO = 0, cntU = 0;\n    int pA = 0, pE = 0, pI = 0, pO = 0, pU = 0;\n\n    printf(\"Enter Text: \");         \n\n    while ((current = getchar()) != EOF){\n        if (isspace(current)) continue;                     // check for whitespace, if whitespace continue\n        else {\n            switch (current) {                              // check for vowel &amp; increase vowelcount\n            case 'a':\n                cntA += 1;\n            case 'A':\n                cntA += 1;\n            case 'e':\n                cntE += 1;\n            case 'E':\n                cntE += 1;\n            case 'i':\n                cntI += 1;\n            case 'I':\n                cntI += 1;\n            case 'o':\n                cntO += 1;\n            case 'O':\n                cntO += 1;\n            case 'u':\n                cntU += 1;\n            case 'U':\n                cntU += 1;\n            }\n        }\n\n            cntAll++;\n    }\n\n    pA = (cntA / cntAll) * 100; \n    pE = (cntE / cntAll) * 100;\n    pI = (cntI / cntAll) * 100;\n    pO = (cntO / cntAll) * 100;\n    pU = (cntU / cntAll) * 100;\n\n    printf(\"\\nLetters: %d\\nPercentage A: %d\\nPercentage E: %d\\nPercentage I: %d\\nPercentage O: %d\\nPercentage U: %d\\n\",cntAll,pA,pE,pI,pO,pU);\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>Increasing the cntAll value works without problems, but it doesn't count the individual vowels for whatever reason.\nWould appreciate any help!</p>\n\n<p>Edited:</p>\n\n<pre><code>   #include &lt;stdio.h&gt;\n#include &lt;ctype.h&gt;\n\nint main() {\n\n    int current;\n    int cntAll = 0;\n    int cntA = 0, cntE = 0, cntI = 0, cntO = 0, cntU = 0;\n    double pA = 0, pE = 0, pI = 0, pO = 0, pU = 0;\n\n    printf(\"Enter Text: \");         \n\n    while ((current = getchar()) != EOF){\n        if (isspace(current)) continue;                     \n        else {\n            switch (current) {                              \n            case 'a':case 'A':\n                cntA += 1;\n                break;\n            case 'e':case 'E':\n                cntE += 1;\n                break;\n            case 'i':case 'I':\n                cntI += 1;\n                break;\n            case 'o':case 'O':\n                cntO += 1;\n                break;\n            case 'u':case 'U':\n                cntU += 1;\n                break;\n            }\n        }\n\n            cntAll++;\n    }\n\n    pA = 100.0 * cntA / cntAll;\n    pE = 100.0 * cntE / cntAll;\n    pI = 100.0 * cntI / cntAll;\n    pO = 100.0 * cntO / cntAll;\n    pU = 100.0 * cntU / cntAll;\n\n    printf(\"\\nLetters: %d\\nPercentage A: %.2lf\\nPercentage E: %.2lf\\nPercentage I: %.2lf\\nPercentage O: %.2lf\\nPercentage U: %.2lf\\n\",cntAll,pA,pE,pI,pO,pU);\n    system(\"PAUSE\");\n    return 0;\n}\n</code></pre>\n\n<p>cheers</p>\n"}, {"tags": ["c", "pointers", "enums"], "comments": [{"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 1, "creation_date": 1482313993, "post_id": 41259648, "comment_id": 69719877, "body": "working, compiled with g++"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 1, "creation_date": 1482313998, "post_id": 41259648, "comment_id": 69719881, "body": "<code>ARRAY_LENGTH</code> missed, I assumed it is <code>#define ARRAY_LENGTH(A) sizeof(A) &#47; sizeof(*A)</code>"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 1, "creation_date": 1482314028, "post_id": 41259648, "comment_id": 69719906, "body": "same as e.jahandar, using visual c++"}, {"owner": {"reputation": 25137, "user_id": 4498831, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/jDBV2.png?s=128&g=1", "display_name": "Boiethios", "link": "https://stackoverflow.com/users/4498831/boiethios"}, "edited": false, "score": 1, "creation_date": 1482314407, "post_id": 41259648, "comment_id": 69720198, "body": "Works with gcc <a href=\"http://rextester.com/FWMH25274\" rel=\"nofollow noreferrer\">rextester.com/FWMH25274</a>"}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482314844, "post_id": 41259648, "comment_id": 69720501, "body": "Plus one to all. I can&#39;t understand why I thought that it did not work. If you want to improve it, please see <a href=\"http://codereview.stackexchange.com/questions/150480/generic-enum-to-text-lookup-in-c\" title=\"generic enum to text lookup in c\">codereview.stackexchange.com/questions/150480/&hellip;</a>"}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482315118, "post_id": 41259648, "comment_id": 69720707, "body": "You know, you can spare yourself some of the repetition, and allow for easy addition of macro values if you just use <a href=\"http://www.drdobbs.com/the-new-c-x-macros/184401387\" rel=\"nofollow noreferrer\">XMacros</a>. If the string should match the enums toke, the preprocessor can do that easily as well."}], "answers": [{"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1482315438, "post_id": 41260125, "comment_id": 69720955, "body": "@Mawg - a <code>const char *</code> can point to a literal, placed by the compiler at some indeterminate location. There is no dynamic allocation."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482416051, "post_id": 41260125, "comment_id": 69771957, "body": "I really do like @Lundin&#39;s &quot;readable way&quot; , but will award this the answer as it is clsoest in spirit to my original question, and because it handles invalid indices"}], "tags": [], "owner": {"reputation": 9740, "user_id": 1459996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/df2798299346f952d526d49a27fbde4e?s=128&d=identicon&r=PG", "display_name": "Kirill Kobelev", "link": "https://stackoverflow.com/users/1459996/kirill-kobelev"}, "is_accepted": true, "score": 2, "last_activity_date": 1482455223, "last_edit_date": 1482455223, "creation_date": 1482314810, "answer_id": 41260125, "question_id": 41259648, "link": "https://stackoverflow.com/questions/41259648/generic-enum-to-text-lookup-in-c/41260125#41260125", "title": "Generic enum to text lookup in C", "body": "<p>I always use the approach that is described below. Note that the data structure and the function are the same for all enums.</p>\n\n<pre><code>struct enum_datum  \n{\n    int    enum_val;\n    char  *enum_name;\n};\n\nchar *GetEnumName(enum_datum *table, int value)\n{\n   while (table-&gt;enum_name != NULL)\n   {\n      if (table-&gt;enum_val == value)\n         return enum_name;\n      table++;\n   }\n   return NULL;\n}\n</code></pre>\n\n<p>After that for each specific enum you need to define:</p>\n\n<pre><code>typedef enum {\n    north, south, east, west\n} E_directions;\n\nenum_datum E_directions_datum[] = \n{\n    { north, \"north\" },\n    { south, \"south\" },\n    { east,  \"east\"  },\n    { west,  \"west\"  },\n    { some_value_not_important, NULL }, // The end of the array marker.\n};\n\nchar *GetDirectionName(E_directions dir)\n{\n    return GetEnumName(E_directions_datum, dir);\n}\n</code></pre>\n\n<p>Note that the string may not be exactly the same as the name of the enumerator. In my own projects sometimes I have several <code>enum_datum</code> arrays for the same enum. This allows getting more and less detailed messages without seriously complicating the overall design.</p>\n\n<p>And pretty much that is it. The major advantage is simplicity.</p>\n"}, {"comments": [{"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482315372, "post_id": 41260232, "comment_id": 69720897, "body": "You know, unless the code is a jumbled mess of inconsistent indentation and/or naming. I find &quot;readability&quot; to be highly subjective."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482315449, "post_id": 41260232, "comment_id": 69720967, "body": "@StoryTeller Of course. However, there is an industry consensus among the vast majority of C programmers saying that function-like macros reduce readability and is generally considered bad practice."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 0, "creation_date": 1482315578, "post_id": 41260232, "comment_id": 69721074, "body": "I don&#39;t know. This particular controlled use of function-like macros doesn&#39;t feel as awful as the general case. But a good answer nonetheless."}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482315885, "post_id": 41260232, "comment_id": 69721318, "body": "An excellent answer!  I do like your &quot;readable way&quot;, although I might still wrap it in a function, for bounds checking, etc. After several decades of C coding, I wasn&#39;t even aware of <code>designated initializers</code> :-(  <a href=\"https://gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html\" rel=\"nofollow noreferrer\">gcc.gnu.org/onlinedocs/gcc/Designated-Inits.html</a>    Do I have your permission to base upon this for commerical porpoises?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1482316087, "post_id": 41260232, "comment_id": 69721505, "body": "@Mawg The content posted here now belongs to SO and not to me. I think you are fine to use it, but I&#39;m no expert on software licenses. There&#39;s probably some info over at Meta about that."}, {"owner": {"reputation": 147719, "user_id": 817643, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3ec3655af26685ce29823b04cb6c78d5?s=128&d=identicon&r=PG", "display_name": "StoryTeller - Unslander Monica", "link": "https://stackoverflow.com/users/817643/storyteller-unslander-monica"}, "edited": false, "score": 1, "creation_date": 1482316181, "post_id": 41260232, "comment_id": 69721564, "body": "^^ <a href=\"http://meta.stackexchange.com/questions/12527/do-i-have-to-worry-about-copyright-issues-for-code-posted-on-stack-overflow\">Here&#39;s one answer</a> about copyright"}, {"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1482415906, "post_id": 41260232, "comment_id": 69771873, "body": "The &quot;readable way&quot; is the most elgenat and maintainable - but runs into problerms if I should ever have an invalid index. I do like it <b><i>very</i></b> much, though"}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1502801033, "post_id": 41260232, "comment_id": 78343821, "body": "<code>[north] = {north, STR_DIRECTION[north]}</code> should probably be <code>[north] = {north, STR_DIRECTION[0]}</code>, it the idea is to work regardless of the ordering?"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1502801675, "post_id": 41260232, "comment_id": 78344241, "body": "@Lou Indeed the idea is to not hard-code any numbers in the initializer list so that it is not accidentally broken during maintenance later on. Hence the comment &quot;use designated initializers to guarantee data integrity even if item order is changed&quot;."}, {"owner": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1502801832, "post_id": 41260232, "comment_id": 78344347, "body": "Ok, I get it, the assumption is that <code>STR_DIRECTION</code> will also be rearranged and that enum values will always be sequential. I thought you were demonstrating a version where enums can get arbitrary values, but strings would be at fixed places."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 3792, "user_id": 1488067, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/8JllV.jpg?s=128&g=1", "display_name": "Lou", "link": "https://stackoverflow.com/users/1488067/lou"}, "edited": false, "score": 0, "creation_date": 1502802065, "post_id": 41260232, "comment_id": 78344507, "body": "@Lou No the enum must have values 0 to n but can otherwise be re-ordered. Otherwise the <code>directions_n</code> trick wouldn&#39;t work and the static assert would kick in."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 5, "last_activity_date": 1482315716, "last_edit_date": 1482315716, "creation_date": 1482315122, "answer_id": 41260232, "question_id": 41259648, "link": "https://stackoverflow.com/questions/41259648/generic-enum-to-text-lookup-in-c/41260232#41260232", "title": "Generic enum to text lookup in C", "body": "<p>There are two \"canonical\" ways to do this. One which is readable and one which avoids code repetition.</p>\n\n<hr>\n\n<p><em>Readable way</em></p>\n\n<p>The \"readable way\" is what I would recommend. It builds up an enum with a corresponding look-up table, where the enumeration constants match the look-up table indices:</p>\n\n<pre><code>typedef enum\n{\n    north,\n    south,\n    east,\n    west,\n    directions_n // only used to keep track of the amount of enum constants\n} direction_t;\n\nconst char* STR_DIRECTION [] =  // let array size be based on number of items\n{\n  \"north\",\n  \"south\",\n  \"east\",\n  \"west\"\n};\n\n\n#define ARRAY_ITEMS(array) (sizeof(array) / sizeof(*array))\n...\n// verify integrity of enum and look-up table both:\n_Static_assert(directions_n == ARRAY_ITEMS(STR_DIRECTION), \n               \"direction_t does not match STR_DIRECTION\");\n</code></pre>\n\n<p>You can still have a struct based on this if you want:</p>\n\n<pre><code>typedef struct\n{\n  direction_t dir;\n  const char* str;\n} dir_struct_t;\n\nconst dir_struct_t DIRS [directions_n] = \n{ // use designated initializers to guarantee data integrity even if item order is changed:\n  [north] = {north, STR_DIRECTION[north]},\n  [south] = {south, STR_DIRECTION[south]},\n  [east]  = {east,  STR_DIRECTION[east]},\n  [west]  = {west,  STR_DIRECTION[west]}\n};\n</code></pre>\n\n<hr>\n\n<p><em>No code-repetition way</em></p>\n\n<p>The other alternative is to use so-called \"X-macros\", which is not really recommended other than as a last resort, since they tend make the code severely unreadable, particularly to those who aren't used at such macros.</p>\n\n<p>This code is equivalent to my example above:</p>\n\n<pre><code>#define DIRECTION_LIST \\\n  X(north), \\\n  X(south), \\\n  X(east),  \\\n  X(west),         // trailing commma important here! (and ok in enums since C99)\n\ntypedef enum\n{\n  #define X(dir) dir\n    DIRECTION_LIST\n  #undef X\n  directions_n // only used to keep track of the amount of enum constants\n} direction_t;\n\ntypedef struct\n{\n  direction_t dir;\n  const char* str;\n} dir_struct_t;\n\nconst dir_struct_t DIRS [directions_n] = \n{\n  #define X(dir) {dir, #dir}\n    DIRECTION_LIST\n  #undef X\n};\n</code></pre>\n\n<p>This macro version gets rid of the explicit string look-up table. </p>\n"}], "owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 1, "accepted_answer_id": 41260125, "answer_count": 2, "score": 3, "last_activity_date": 1482455223, "creation_date": 1482313527, "last_edit_date": 1492087236, "question_id": 41259648, "link": "https://stackoverflow.com/questions/41259648/generic-enum-to-text-lookup-in-c", "title": "Generic enum to text lookup in C", "body": "<p>[Update]</p>\n\n<ol>\n<li>the code given does actually work. I was mistaken when I thought that it did not. My bad; sorry++. If you can improve the code, please do so at <a href=\"https://codereview.stackexchange.com/questions/150480/generic-enum-to-text-lookup-in-c\">https://codereview.stackexchange.com/questions/150480/generic-enum-to-text-lookup-in-c</a></li>\n<li>We <strong><em>must</em></strong> declare our strings at compile time. We code embedded systems and are not allowed to <code>malloc()</code>. Sorry for not being so clear.</li>\n</ol>\n\n<hr>\n\n<p>[Update++] I will probably accept one of the answers below. I forgot to state, though, that our enums are non-contiguous and have a wide range, which can make a difference</p>\n\n<hr>\n\n<p>The intertubes, and this site, are awash with questions asking for to get text from an enum.</p>\n\n<p>I cannot find a canonical way to do this (and would accept one as answer to this question), so let's see if we can cobble one together between us.</p>\n\n<p>Throughout our code, we have multiple arrays of structures, containing pairs of enums and corresponding strings. </p>\n\n<p>The problem is that the strings have different lengths, so we code a lookup function for each one, which for loops over an array of structures, trying to match the enum and returning the corresponding text if a match is found.</p>\n\n<p>Let\u2019s take the following two contrived examples:</p>\n\n<pre><code>// +=+=+=+=+=+=+=+=+=+=+=+=+=+=\ntypedef enum\n{\n    north,\n    south,\n    east,\n    west\n} E_directions;\n\nstruct direction_datum\n{\n    E_directions direction;\n    char         direction_name[6];\n};\n\nstruct direction_datum direction_data[] =\n{\n    {north, \"north\"},\n    {south, \"south\"},\n    {east,  \"east\"},\n    {west,  \"west\"},\n};\n\n// +=+=+=+=+=+=+=+=+=+=+=+=+=+=\ntypedef enum\n{\n    hearts,\n    spades,\n    diamonds,\n    clubs,\n} E_suits;\n\nstruct suit_datum\n{\n    E_suits suit;\n    char    suit_name[9];\n};\n\nstruct suit_datum suit_data[] =\n{\n    {hearts,   \"hearts\"},\n    {spades,   \"spades\"},\n    {diamonds, \"diamonds\",},\n    {clubs,    \"clubs\"},\n};\n</code></pre>\n\n<p>Apart from the string length, they are similar/identical, so, in theory, we should be able to code a generic function to loop over either <code>direction_data</code> or <code>suit_data</code>, given an index and return the corresponding text. </p>\n\n<p>I am thinking something like this \u2013 but it doesn\u2019t work (the enum value in the struct always seems to be zer0, so obviously my pointer arithmetic is off).</p>\n\n<p>What am I doing wrongly?</p>\n\n<pre><code>char *Get_text_from_enum(int enum_value, \n                         void *array, \n                         unsigned int array_length, \n                         unsigned int size_of_array_entry)\n{\n    unsigned int i;\n    unsigned int offset;\n\n    for (i = 0; i &lt; array_length; i++)\n    {\n        offset = i * size_of_array_entry;\n\n        if ((int) * ((int *) (array+ offset)) == enum_value)\n            return (char *)  (array + offset + sizeof(int));\n    }\n\n    return NULL;\n}\n\n\nprintf(\"Expect south,    got %s\\n\", \n          Get_text_from_enum(south,    \n                             direction_data, \n                             ARRAY_LENGTH(direction_data),  \n                             sizeof(direction_data[0])));\n\nprintf(\"Expect diamonds, got %s\\n\", \n          Get_text_from_enum(diamonds, \n                             suit_data,      \n                             ARRAY_LENGTH(suit_data),       \n                             sizeof(suit_data[0])));\n</code></pre>\n"}, {"tags": ["c", "performance", "file", "parsing", "memory-management"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1482313141, "post_id": 41259379, "comment_id": 69719245, "body": "The usual approach is to create an event-based parser with flex/yacc. These only hold the necessary information in RAM (tokens on the stack etc). How much exactly mainly depends on the grammar."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 0, "creation_date": 1482315152, "post_id": 41259379, "comment_id": 69720729, "body": "It might be operating system specific. See also <a href=\"http://stackoverflow.com/a/41237690/841108\">this answer</a> mentioning some useful syscalls on Linux. But you probably could read the file line by line e.g. with <a href=\"http://man7.org/linux/man-pages/man3/getline.3.html\" rel=\"nofollow noreferrer\">getline(3)</a>. Look also at the references in <a href=\"http://stackoverflow.com/a/41208995/841108\">that answer</a>."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1482315407, "post_id": 41259379, "comment_id": 69720923, "body": "And you should define the syntax and lexemes of your parsed text file."}, {"owner": {"reputation": 4446, "user_id": 2171120, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/geJy2.png?s=128&g=1", "display_name": "mirabilos", "link": "https://stackoverflow.com/users/2171120/mirabilos"}, "edited": false, "score": 0, "creation_date": 1482499582, "post_id": 41259379, "comment_id": 69807004, "body": "I\u2019d have said mmap, but then, the file might still be larger than mmap allows (especially on 32/36-bit platforms, but most contemporary 64-bit platforms also don\u2019t allow for full 64-bit addressing). Streaming is likely the solution\u2026 you could also write away temporary information into a file (also stream), and then read that in a second pass\u2026 it depends on both what you actually need to do (problem domain) and the environment (OS, etc)."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482500719, "post_id": 41259379, "comment_id": 69807542, "body": "Your method for determining the file size is not compliant with the <a href=\"http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf\" rel=\"nofollow noreferrer\">C Standard</a>, and is in fact undefined behavior.  Per <b>7.21.9.2  The <code>fseek</code> function</b> - &quot;A binary stream need not meaningfully support <code>fseek</code> calls with a <code>whence</code> value of <code>SEEK_END</code>.&quot;  Also, footnote 268 states &quot;Setting the file position  indicator  to  end-of-file, as with <code>fseek(file,  0,  SEEK_END)</code>, has undefined behavior for a binary stream...&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1482487449, "post_id": 41259636, "comment_id": 69800789, "body": "Note however that this buffer will not be null terminated, so the parser needs to compare the offset to the file size for each byte instead of relying on the presence of a line or string terminator."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1482487701, "post_id": 41259636, "comment_id": 69800924, "body": "@chqrlie Indeed, it is zero terminated in <i>almost</i> all cases; when the file is not a multiple of the page size. However, when it is, it might be not."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1482493515, "post_id": 41259636, "comment_id": 69803952, "body": "@chux: if the file size is not a mutiple of the page size, I am not sure it is OK to read a byte beyond the end of the mmapped area. It might be OK on most systems, but it might cause a segmentation fault on systems with finer granularity."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1482495720, "post_id": 41259636, "comment_id": 69805154, "body": "@chqrlie The mmap granularity is never smaller than &quot;page size&quot; and the rest of a page is filled with zero bytes."}], "tags": [], "owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "is_accepted": true, "score": 12, "last_activity_date": 1482313503, "creation_date": 1482313503, "answer_id": 41259636, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41259636#41259636", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>If you wish to stick with your current design, an option might be to <code>mmap()</code> the file instead of reading it into a memory buffer.</p>\n\n<p>You could change the function <code>dump_file_to_array</code> to the following (linux-specific):</p>\n\n<pre><code>char *dump_file_to_array(FILE *fp, size_t f_size) {\n   buf = mmap(NULL, f_size, PROT_READ, MAP_SHARED, fileno(fp), 0);\n   if (buf == MAP_FAILED)\n       return NULL;\n   return buf;\n}\n</code></pre>\n\n<p>Now you can read over the file, the memory manager will take automatically care to only hold the relevant potions of the file in memory.\nFor Windows, similar mechanisms exist.</p>\n"}, {"tags": [], "owner": {"reputation": 24802, "user_id": 232918, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b5897762377de1c8ffb9a98673262e91?s=128&d=identicon&r=PG", "display_name": "doron", "link": "https://stackoverflow.com/users/232918/doron"}, "is_accepted": false, "score": 2, "last_activity_date": 1482314270, "creation_date": 1482314270, "answer_id": 41259920, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41259920#41259920", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>Chances you are parsing the file line-by line. So read in a large block (4k or 16k) and parse all the lines in that. Copy the small remainder to the beginning of the 4k or 16k buffer and read in the rest of the buffer. Rinse and repeat.</p>\n\n<p>For JSON or XML you will need an event based parser that can accept multiple blocks or input.</p>\n"}, {"comments": [{"owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 2, "creation_date": 1482315609, "post_id": 41260167, "comment_id": 69721099, "body": "<code>std::ifstream</code> is C++, No?"}, {"owner": {"reputation": 843, "user_id": 3110416, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/125f445ef3b132c1fd48991b7ceb1a83?s=128&d=identicon&r=PG&f=1", "display_name": "Alex C", "link": "https://stackoverflow.com/users/3110416/alex-c"}, "reply_to_user": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "edited": false, "score": 0, "creation_date": 1482316055, "post_id": 41260167, "comment_id": 69721469, "body": "@machine_1 Yes it&#39;s c++, fgets is fine and you don&#39;t need to copy all in RAM. If you really need to do that, you may try mmap with MAP_HUGETLB but that WILL FAIL too if the system has insufficient memory."}], "tags": [], "owner": {"reputation": 843, "user_id": 3110416, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/125f445ef3b132c1fd48991b7ceb1a83?s=128&d=identicon&r=PG&f=1", "display_name": "Alex C", "link": "https://stackoverflow.com/users/3110416/alex-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1482315659, "last_edit_date": 1482315659, "creation_date": 1482314922, "answer_id": 41260167, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41260167#41260167", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>First of all I wouldn't suggest holding such big files in RAM but instead using streams. This because buffering is usually done by the library as well as by the kernel. </p>\n\n<p>If you are accessing the file sequentially, which seems to be the case, then you probably know that all modern systems implement read-ahead algorithms so just reading the whole file ahead of time IN RAM may in most cases just waste time.</p>\n\n<p>You didn't specify the use-cases you have to cover so I'm going to have to assume that using  streams like </p>\n\n<pre><code>std::ifstream\n</code></pre>\n\n<p>and doing the parsing on the fly will suit your needs. As a side note, also make sure your operations on files that are expected to be large are done in separate threads.</p>\n"}, {"tags": [], "owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "is_accepted": false, "score": 2, "last_activity_date": 1482493673, "last_edit_date": 1482493673, "creation_date": 1482488625, "answer_id": 41299581, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41299581#41299581", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>There are multiple issues with your approach.</p>\n\n<p>The concept of <em>maximum</em> and <em>available</em> memory are not so evident: technically, you are not limited by the RAM size, but by the quantity of memory your environment will let you allocate and use for your program.  This depends on various factors:</p>\n\n<ul>\n<li>What ABI you compile for: the maximum memory size accessible to your program is limited to less than 4 GB if you compile for 32-bit code, even if your system has more RAM than that.</li>\n<li>What quota the system is configured to let your program use. This may be less than available memory.</li>\n<li>What strategy the system uses when more memory is requested than is physically available: most modern systems use virtual memory and share physical memory between processes and system tasks (such as the disk cache) using very advanced algorithms that cannot be describe in a few lines.  It is possible on some systems for your program to allocate and use more memory than is physically installed on the motherboard, swapping memory pages to disk as more memory is accessed, at a huge cost in lag time.</li>\n</ul>\n\n<p>There are further issues in your code:</p>\n\n<ul>\n<li>The type <code>long</code> might be too small to hold the size of the file: on Windows systems, <code>long</code> is 32-bit <strong>even</strong> on 64-bit versions where memory can be allocated in chunks larger than 2GB.  You must use  different API to request the file size from the system.</li>\n<li>You read the file with an series of calls to <code>fgets()</code>.  This is inefficient, a single call to <code>fread()</code> would suffice.  Furthermore, if the file contains embedded null bytes ('\\0' characters), chunks from the file will be missing in memory. However you could not deal with embedded null bytes if you use string functions such as <code>strstr()</code> and <code>strcpy()</code> to handle your string deletion task.</li>\n<li>the condition in <code>while (ptr = strstr(ptr, pattern))</code> is an assignment.  While not strictly incorrect, it is poor style as it confuses readers of your code and prevents life saving warnings by the compiler where such assignment-conditions are coding errors.  You might think that could never happen, but anyone can make a typo and a missing <code>=</code> in a test is difficult to spot and has dire consequences.</li>\n<li>you short-hand use of the ternary operator in place of <code>if</code> statements is quite confusing too: <code>outputfile ? fp = fopen(outputfile, \"w\") : fp = fopen(filename, \"w\");</code></li>\n<li>rewriting the input file in place is risky too: if anything goes wrong, the input file will be lost.</li>\n</ul>\n\n<p>Note that you can implement the filtering on the fly, without a buffer, albeit inefficiently:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nint main(int argc, char *argv[]) {\n    if (argc &lt; 2) {\n        fprintf(stderr, \"usage: delpat PATTERN &lt; inputfile &gt; outputfile\\n\");\n        return 1;\n    }\n    unsigned char *pattern = (unsigned char*)argv[1];\n    size_t i, j, n = strlen(argv[1]);\n    size_t skip[n + 1];\n    int c;\n\n    skip[0] = 0;\n    for (i = j = 1; i &lt; n; i++) {\n        while (memcmp(pattern, pattern + j, i - j)) {\n            j++;\n        }\n        skip[i] = j;\n    }\n\n    i = 0;\n    while ((c = getchar()) != EOF) {\n        for (;;) {\n            if (i &lt; n &amp;&amp; c == pattern[i]) {\n                if (++i == n) {\n                    i = 0; /* match found, consumed */\n                }\n                break;\n            }\n            if (i == 0) {\n                putchar(c);\n                break;\n            }\n            for (j = 0; j &lt; skip[i]; j++) {\n                putchar(pattern[j]);\n            }\n            i -= skip[i];\n        }\n    }\n    for (j = 0; j &lt; i; j++) {\n        putchar(pattern[j]);\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2704, "user_id": 6794772, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2d8db2b0d48b6e1b25657fda9ec4ae02?s=128&d=identicon&r=PG&f=1", "display_name": "Dellowar", "link": "https://stackoverflow.com/users/6794772/dellowar"}, "is_accepted": false, "score": 0, "last_activity_date": 1482513873, "creation_date": 1482513873, "answer_id": 41305514, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41305514#41305514", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>An alternative solution: If you're on linux systems, and you have a decent amount of swap space, just open the whole bad boy up. It will consume your ram and also consume harddrive space (swap). Thus you can have the entire thing open at once, just not all of it will be on the ram.</p>\n\n<p>Pros</p>\n\n<ul>\n<li>If an unexpected shut down occurred, the memory on the swap space is recoverable.</li>\n<li>RAM is expensive, HDDs are cheap, so the application would put less strain on your expensive equipment</li>\n<li>Virus could not harm your computer because there would be no room in RAM for them to run</li>\n<li>You'll be taking full advantage of the Linux operating system by using the swap space. Normally the swap space module is not used and all it does is clog up precious ram.</li>\n<li>The additional energy that is needed to utilize the entirety of the ram can warm the immediate area. Useful during winter time</li>\n<li>You can add \"Complex and Special Memory Allocation Engineering\" to your resume.</li>\n</ul>\n\n<p>Cons</p>\n\n<ul>\n<li>None</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1482516408, "creation_date": 1482516408, "answer_id": 41305986, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41305986#41305986", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>Consider treating the file as an external array of <em>lines</em>.</p>\n\n<p>Code can use an array of line indexes.  This index array can be kept in memory at a fraction of the size of the large file.  Access to <em>any</em> line is accomplished quickly via this lookup, a seek with <code>fsetpos()</code> and an <code>fread()/fgets()</code>.  As the lines are edited, the new lines can be saved, in any order, in temporary text file.  Saving of the file reads both the original file and temp one in sequence to form and write the new file.</p>\n\n<pre><code>typedef struct {\n  int attributes; // not_yet_read, line_offset/length_determined, \n                  // line_changed/in_other_file, deleted, etc.\n  fpos_t line_offset;   // use with  fgetpos() fsetpos()\n  unsigned line_length; // optional field as code could re-compute as needed.\n} line_index;\n\nsize_t line_count;\n// read some lines\nline_index *index = malloc(sizeof *index * line_count);\n// read more lines\nindex = realloc(index, sizeof *index * line_count);\n// edit lines, save changes to appended temporary file.\n// ...\n// Save file -weave the contents of the source file and temp file to the new output file.\n</code></pre>\n\n<p>Additionally, with <em>enormous</em> files, the array <code>line_index[]</code> itself can be realized in disk memory too.  Access to is easily computed.  In an extreme sense, only 1 <em>line</em> of the file needs to in memory at any time.</p>\n"}, {"tags": [], "owner": {"reputation": 307, "user_id": 4920739, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0771c643189144477a376f168c3adda8?s=128&d=identicon&r=PG&f=1", "display_name": "vguberinic", "link": "https://stackoverflow.com/users/4920739/vguberinic"}, "is_accepted": false, "score": 0, "last_activity_date": 1482932409, "creation_date": 1482932409, "answer_id": 41363316, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41363316#41363316", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>You mentioned state-machine. Every finite-state-automata can be optimized to have minimal (or no) lookahead.</p>\n\n<p>Is it possible to do this in Lex? It will generate output c file which you can compile.</p>\n\n<p>If you don't want to use Lex, you can always do following:</p>\n\n<ol>\n<li>Read n chars into (ring?) buffer where n is size of pattern.</li>\n<li>Try to match buffer with pattern</li>\n<li>If match goto 1</li>\n<li>Print buffer[0], read char, goto 2</li>\n</ol>\n\n<p>Also for very long patterns and degenerate inputs strstr can be slow. In that case you might want to look into more advanced sting matching aglorithms.</p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 7062591, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AVayJ.jpg?s=128&g=1", "display_name": "Avanti Patil", "link": "https://stackoverflow.com/users/7062591/avanti-patil"}, "is_accepted": false, "score": 0, "last_activity_date": 1483089969, "creation_date": 1483089969, "answer_id": 41393745, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram/41393745#41393745", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>mmap() is a pretty good way of working on files with large sizes.\nIt provides  you with lot of flexibility but you need to be cautious with page size. <a href=\"https://www.safaribooksonline.com/library/view/linux-system-programming/0596009585/ch04s03.html\" rel=\"nofollow noreferrer\">Here</a> is a good article which talks about more specifics. </p>\n"}], "owner": {"reputation": 3853, "user_id": 2474248, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BDsoE.jpg?s=128&g=1", "display_name": "machine_1", "link": "https://stackoverflow.com/users/2474248/machine-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 2, "accepted_answer_id": 41259636, "answer_count": 8, "score": 8, "last_activity_date": 1483089969, "creation_date": 1482312843, "last_edit_date": 1482674535, "question_id": 41259379, "link": "https://stackoverflow.com/questions/41259379/how-to-parse-files-that-cannot-fit-entirely-in-memory-ram", "title": "How to parse files that cannot fit entirely in memory RAM", "body": "<p>I have created a framework to parse text files of reasonable size that can fit in memory RAM, and for now, things are going well. I have no complaints, however what if I encountered a situation where I have to deal with large files, say, greater than 8GB(which is the size of mine)?\nWhat would be an efficient approach to deal with such large files?</p>\n\n<p>My framework:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n\nint Parse(const char *filename,\n    const char *outputfile);\n\nint main(void)\n{\n    clock_t t1 = clock();\n    /* ............................................................................................................................. */\n    Parse(\"file.txt\", NULL);\n    /* ............................................................................................................................. */\n    clock_t t2 = clock();\n    fprintf(stderr, \"time elapsed: %.4f\\n\", (double)(t2 - t1) / CLOCKS_PER_SEC);\n    fprintf(stderr, \"Press any key to continue . . . \");\n    getchar();\n    return 0;\n}\n\nlong GetFileSize(FILE * fp)\n{\n    long f_size;\n    fseek(fp, 0L, SEEK_END);\n    f_size = ftell(fp);\n    fseek(fp, 0L, SEEK_SET);\n    return f_size;\n}\n\nchar *dump_file_to_array(FILE *fp,\n    size_t f_size)\n{\n    char *buf = (char *)calloc(f_size + 1, 1);\n    if (buf) {\n        size_t n = 0;\n        while (fgets(buf + n, INT_MAX, fp)) {\n            n += strlen(buf + n);\n        }\n    }\n    return buf;\n}\n\nint Parse(const char *filename,\n    const char *outputfile)\n{\n    /* open file for reading in text mode */\n    FILE *fp = fopen(filename, \"r\");\n    if (!fp) {\n        perror(filename);\n        return 1;\n    }\n    /* store file in dynamic memory and close file */\n    size_t f_size = GetFileSize(fp);\n    char *buf = dump_file_to_array(fp, f_size);\n    fclose(fp);\n    if (!buf) {\n        fputs(\"error: memory allocation failed.\\n\", stderr);\n        return 2;\n    }\n    /* state machine variables */\n    // ........\n\n    /* array index variables */\n    size_t x = 0;\n    size_t y = 0;\n    /* main loop */\n    while (buf[x]) {\n        switch (buf[x]) {\n            /* ... */\n        }\n        x++;\n    }\n    /* NUL-terminate array at y */\n    buf[y] = '\\0';\n    /* write buffer to file and clean up */\n    outputfile ? fp = fopen(outputfile, \"w\") :\n                 fp = fopen(filename, \"w\");\n    if (!fp) {\n        outputfile ? perror(outputfile) :\n                     perror(filename);\n    }\n    else {\n        fputs(buf, fp);\n        fclose(fp);\n    }\n    free(buf);\n    return 0;\n}\n</code></pre>\n\n<p>Pattern deletion function based on the framework:</p>\n\n<pre><code>int delete_pattern_in_file(const char *filename,\n    const char *pattern, const char *outputfile)\n{\n    /* open file for reading in text mode */\n    FILE *fp = fopen(filename, \"r\");\n    if (!fp) {\n        perror(filename);\n        return 1;\n    }\n    /* copy file contents to buffer and close file */\n    size_t f_size = GetFileSize(fp);\n    char *buf = dump_file_to_array(fp, f_size);\n    fclose(fp);\n    if (!buf) {\n        fputs(\"error - memory allocation failed\", stderr);\n        return 2;\n    }\n    /* delete first match */\n    size_t n = 0, pattern_len = strlen(pattern);\n    char *tmp, *ptr = strstr(buf, pattern);\n    if (!ptr) {\n        fputs(\"No match found.\\n\", stderr);\n        free(buf);\n        return -1;\n    }\n    else {\n        n = ptr - buf;\n        ptr += pattern_len;\n        tmp = ptr;\n    }\n    /* delete the rest */\n    while (ptr = strstr(ptr, pattern)) {\n        while (tmp &lt; ptr) {\n            buf[n++] = *tmp++;\n        }\n        ptr += pattern_len;\n        tmp = ptr;\n    }\n    /* copy the rest of the buffer */\n    strcpy(buf + n, tmp);\n    /* open file for writing and print the processed buffer to it */\n    outputfile ? fp = fopen(outputfile, \"w\") :\n                 fp = fopen(filename, \"w\");\n    if (!fp) {\n        outputfile ? perror(outputfile) :\n                     perror(filename);\n    }\n    else {\n        fputs(buf, fp);\n        fclose(fp);\n    }\n    free(buf);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sd-card", "stm32", "stm32f4discovery", "stm32f4"], "comments": [{"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482313918, "post_id": 41259087, "comment_id": 69719818, "body": "Do you get this error regardless of what sector is written ? Try to write to another sector. Try with other SD card ?"}, {"owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "reply_to_user": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482314396, "post_id": 41259087, "comment_id": 69720191, "body": "Still the same. I didn&#39;t try to replace the SD card but I can read it on a computer so I guess it is okay."}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482316633, "post_id": 41259087, "comment_id": 69721891, "body": "Your PC does not use HAL library to communicate with the SD card. I would try with another SD card to see if you have better luck."}, {"owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "reply_to_user": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482320571, "post_id": 41259087, "comment_id": 69724370, "body": "Maybe would it be because I&#39;m using an SD card of 8 GB and thus is considered as an MMC card, and hence I should use an other configuration? In STM32CUBEx I picked the SDIO configuration and not SDMMC configuration."}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482320765, "post_id": 41259087, "comment_id": 69724483, "body": "I am unsure about this. But I know that the HAL drivers can be a little dodgy sometimes."}, {"owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "reply_to_user": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482322250, "post_id": 41259087, "comment_id": 69725418, "body": "I&#39;ll try with an other sd card before changing the code, and I&#39;ll update here"}, {"owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "reply_to_user": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "edited": false, "score": 0, "creation_date": 1482329677, "post_id": 41259087, "comment_id": 69730323, "body": "Tried to replace SD card and still doesn&#39;t work..."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "edited": false, "score": 0, "creation_date": 1482350281, "post_id": 41265127, "comment_id": 69742877, "body": "I don&#39;t find those define values in any of the built in file, could it be defined with a different name ?"}, {"owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "reply_to_user": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "edited": false, "score": 0, "creation_date": 1482393845, "post_id": 41265127, "comment_id": 69758191, "body": "Yes, they can, or they might not be definitions at all. Try and look through your code and find the part where the clocks are being initialized (search for RCC_OscInitTypeDef).  I am unsure about where this takes place when you use CubeMX to generate code."}], "tags": [], "owner": {"reputation": 379, "user_id": 6887540, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ixWUU.png?s=128&g=1", "display_name": "staringlizard", "link": "https://stackoverflow.com/users/6887540/staringlizard"}, "is_accepted": false, "score": 0, "last_activity_date": 1482330519, "creation_date": 1482330519, "answer_id": 41265127, "question_id": 41259087, "link": "https://stackoverflow.com/questions/41259087/writing-data-to-micro-sd-card-from-microcontroller-stm32f401ret6/41265127#41265127", "title": "Writing data to micro SD card from microcontroller STM32F401RET6", "body": "<p>Make sure that your sdio clock is within valid limits (see function SystemClock_Config):</p>\n\n<pre><code>/* PLL_VCO = (HSE_VALUE or HSI_VALUE / PLL_M) * PLL_N */\n#define PLL_M      8\n#define PLL_N      336\n\n/* SYSCLK = PLL_VCO / PLL_P */\n#define PLL_P      2\n\n/* USB OTG FS, SDIO and RNG Clock =  PLL_VCO / PLLQ */\n#define PLL_Q      7\n</code></pre>\n\n<p>When using the defines above when initialize the clock (RCC_OscInitTypeDef) the SDIO clock will be 336 / (7*2) = 25Mhz</p>\n\n<p>(Given that PLL_M is the same as the HSE / HSI)</p>\n\n<p>If the frequency is too high (>50Mhz) then perhaps you will get errors in the communication which will explain your symptoms.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5774870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/404e10b62f9819ada71b2f677ff2b90b?s=128&d=identicon&r=PG&f=1", "display_name": "\u015eener Deliba\u015f", "link": "https://stackoverflow.com/users/5774870/%c5%9eener-deliba%c5%9f"}, "is_accepted": false, "score": 0, "last_activity_date": 1513349225, "creation_date": 1513349225, "answer_id": 47834696, "question_id": 41259087, "link": "https://stackoverflow.com/questions/41259087/writing-data-to-micro-sd-card-from-microcontroller-stm32f401ret6/47834696#47834696", "title": "Writing data to micro SD card from microcontroller STM32F401RET6", "body": "<pre><code>I didnt use usart for my project, i write the value to sd card and read the value ,\nyou must arrange the code for your expectations, my code is \n\n\n#include \"main.h\"\n#include \"stm32f4xx_hal.h\"\n\n/* USER CODE BEGIN Includes */\n\n/* USER CODE END Includes */\n\n/* Private variables ---------------------------------------------------------*/\nSD_HandleTypeDef hsd;\n\n\n/* USER CODE BEGIN PV */\n/* Private variables --------------------------------------------------------*/\nuint8_t to_send[512] = \"sener suat sd card\";\nuint8_t to_receive[512];\nuint8_t sener[3]={7,5,4};\n\n/* USER CODE END PV */\n\n/* Private function prototypes -----------------------------------------------*/\nvoid SystemClock_Config(void);\nstatic void MX_GPIO_Init(void);\nstatic void MX_SDIO_SD_Init(void);\nstatic void MX_USART2_UART_Init(void);\n\n/* USER CODE BEGIN PFP */\n/* Private function prototypes -----------------------------------------------*/\n\n/* USER CODE END PFP */\n\n/* USER CODE BEGIN 0 */\n\n/* USER CODE END 0 */\n\nint main(void)\n{\n\n  /* USER CODE BEGIN 1 */\n\n  /* USER CODE END 1 */\n\n  /* MCU Configuration----------------------------------------------------------*/\n\n  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */\n  HAL_Init();\n\n  /* USER CODE BEGIN Init */\n\n\n  /* USER CODE END Init */\n\n  /* Configure the system clock */\n  SystemClock_Config();\n\n  /* USER CODE BEGIN SysInit */\n\n  /* USER CODE END SysInit */\n\n  /* Initialize all configured peripherals */\n  MX_GPIO_Init();\n  MX_SDIO_SD_Init();\n\n  /* USER CODE BEGIN 2 */\n   uint32_t address = 0x55;\n  HAL_SD_MspInit(&amp;hsd);\n  HAL_SD_Init(&amp;hsd);\n  HAL_SD_WriteBlocks(&amp;hsd,to_send,address,1,500);\n  HAL_Delay(100);\n  HAL_SD_ReadBlocks(&amp;hsd,to_receive,address,1,500);\n  /* USER CODE END 2 */\n\n  /* Infinite loop */\n  /* USER CODE BEGIN WHILE */\n  while (1)\n  {\n  /* USER CODE END WHILE */\n  /* USER CODE BEGIN 3 */\n\n  }\n\n\n}\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 5908652, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-HKL4fhlUSHc/AAAAAAAAAAI/AAAAAAAAAGg/tIiwkpSxvxs/photo.jpg?sz=128", "display_name": "Armand Chocron", "link": "https://stackoverflow.com/users/5908652/armand-chocron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1779, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1513349225, "creation_date": 1482311972, "question_id": 41259087, "link": "https://stackoverflow.com/questions/41259087/writing-data-to-micro-sd-card-from-microcontroller-stm32f401ret6", "title": "Writing data to micro SD card from microcontroller STM32F401RET6", "body": "<p>I am using the board Nucleo F401RE based on micro-controller STM32F401RET6. I connected to the board a Micro SD slot, and interested in writing data to the SD Card and read data from it. I used the software STM32CubeX to generate code and in particular the SD library with built-in functions. I tried to write a simple code which writes an array to a specific array and tries to read the same data afterwords. The code is as follows:</p>\n\n<pre><code>uint32_t to_send[512] = {1, 2, 3, 4, 5};\nuint32_t to_receive[512];\n\nint main(void)\n{\n\n  /* Reset of all peripherals, Initializes the Flash interface and the Systick. */\n  HAL_Init();\n\n  /* Configure the system clock */\n  SystemClock_Config();\n\n  /* Initialize all configured peripherals */\n  MX_GPIO_Init();\n  MX_USART2_UART_Init();\n  MX_SDIO_SD_Init();\n\n  char buffer[14] = \"Hello, world\\n\";\n  uint64_t address = 0x00; \n  HAL_SD_ErrorTypedef write_result = HAL_SD_WriteBlocks(&amp;hsd, to_send, address, 512, 1);\n  HAL_SD_ErrorTypedef read_result = HAL_SD_ReadBlocks(&amp;hsd, to_receive, 0x00, 512, 1);\n  HAL_UART_Transmit(&amp;huart2, (uint8_t *) &amp;write_result, 1, 1000);\n  HAL_UART_Transmit(&amp;huart2, (uint8_t *) &amp;read_result, 1, 1000);\n\n\n  while (1)\n  {\n      //HAL_UART_Transmit(&amp;huart2, (uint8_t *)buffer, 14, 1000);\n      HAL_UART_Transmit(&amp;huart2, (uint8_t *)to_receive, 512, 1000);\n\n\n}\n</code></pre>\n\n<p>Though, I don't succeed in writing the data, the function HAL_SD_WriteBlocks() returns the value SD_CMD_CRC_FAIL, which means that : \"Command response received (but CRC check failed)\". What am I missing ? I checked the hardware configuration many times and the micro SD card is correctly connected to the microcontroller. I can add the implementation of the HAL built-in functions if needed. Thank you.</p>\n"}, {"tags": ["c", "gcc-warning"], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312357, "post_id": 41259148, "comment_id": 69718717, "body": "quick question. I want to run in the linux with gcc but I have got some segmant fault,"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312457, "post_id": 41259148, "comment_id": 69718778, "body": "@grander3 That is another problem entirely, and something you should post a new question about. But before you do that, please use a debugger to find out <i>where</i> the crash happens. In the source you show, indicate the location of the crash with a comment. Also show the values of all involved variables at the point of the crash. Oh, and when you catch the crash, be sure to walk up the callstack to <i>your</i> code."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312525, "post_id": 41259148, "comment_id": 69718826, "body": "@grander3 Also please <a href=\"http://stackoverflow.com/tour\">take the tour</a> and <a href=\"http://stackoverflow.com/help/how-to-ask\">read about how to ask good questions</a>. That will help you here on stackoverflow.com."}, {"owner": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312601, "post_id": 41259148, "comment_id": 69718872, "body": "There is no error when I compile with gcc, but when I run the execute file, there is a segment error happen"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312736, "post_id": 41259148, "comment_id": 69718973, "body": "@grander3 I understand, and you need to learn how to use a debugger to find out where in the code the crash happens. You might want to find <a href=\"https://www.cs.cmu.edu/~gilpin/tutorial/\" rel=\"nofollow noreferrer\">a gdb tutorial</a> to help you with that (search for <code>gdb tutorial</code> for more alternatives)."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "reply_to_user": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "edited": false, "score": 0, "creation_date": 1482312854, "post_id": 41259148, "comment_id": 69719042, "body": "@grander3 Oh, and remember that <code>fopen</code> can <i>fail</i> and will then return a null pointer. You should not dereference or otherwise use null pointers, except to test if they are null."}], "tags": [], "owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "is_accepted": true, "score": 2, "last_activity_date": 1482312651, "last_edit_date": 1482312651, "creation_date": 1482312186, "answer_id": 41259148, "question_id": 41258963, "link": "https://stackoverflow.com/questions/41258963/the-issue-convert-buffer-to-hex-string-in-c/41259148#41259148", "title": "the issue convert buffer to hex string in c", "body": "<p>The major problem here is that your <code>char</code> type seems to be <code>signed</code> (if <code>char</code> is <code>signed</code> or <code>unsigned</code> is implementation specific). That means that values larger equal or larger than <code>0x80</code> will be treated as negative values (with <a href=\"https://en.wikipedia.org/wiki/Two&#39;s_complement\" rel=\"nofollow noreferrer\">two's complement</a> systems).</p>\n\n<p>And when you pass such a value to <code>printf</code> and the value is <a href=\"http://en.cppreference.com/w/c/language/conversion#Integer_promotions\" rel=\"nofollow noreferrer\">promoted</a> to an <code>int</code> it is sign-extended. So <code>0xff</code> becomes <code>0xffffffff</code>, which is then printed.</p>\n\n<p>If you use <code>unsigned char</code> for your values instead, then values like <code>0xff</code> are not extended when being promoted to <code>unsigned int</code>. So <code>0xff</code> is promoted to <code>0x000000ff</code>, and the leading zeroes are not printed.</p>\n\n<hr>\n\n<p>Another issue is that you are using the wrong format for <code>printf</code>. The format <code>\"%x\"</code> is for <code>unsigned int</code> and not <code>unsigned char</code>. If you read e.g. <a href=\"http://en.cppreference.com/w/c/io/fprintf\" rel=\"nofollow noreferrer\">this <code>printf</code> (and family) reference</a> you will see a big table with all the formatting code and the different size prefixes for different types. To print an <code>unsigned char</code> you should use the <code>hh</code> prefix, as in <code>\"%hhx\"</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 7324862, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/c8f16d90b6cad4fe552c067654adeb7d?s=128&d=identicon&r=PG&f=1", "display_name": "grander3", "link": "https://stackoverflow.com/users/7324862/grander3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 41259148, "answer_count": 1, "score": 0, "last_activity_date": 1489099361, "creation_date": 1482311546, "last_edit_date": 1592644375, "question_id": 41258963, "link": "https://stackoverflow.com/questions/41258963/the-issue-convert-buffer-to-hex-string-in-c", "title": "the issue convert buffer to hex string in c", "body": "<p>I'm trying to convert buffer to hex string in c as the below,\nthe below image is the input file\n<img src=\"https://i.stack.imgur.com/9FLUE.jpg\" alt=\"enter image description here\" />\nit's a binary file.</p>\n<pre><code>#include &quot;stdio.h&quot;\n#include &quot;stdlib.h&quot;\n\n#include &quot;string.h&quot;\n#include &quot;fcntl.h&quot;\n\n\n#if defined(_MSC_VER)\n#include &lt;BaseTsd.h&gt;\ntypedef SSIZE_T ssize_t;\n#endif\n\n#define  BUFF_SIZE   5     \n\nint main()\n{\n    char     buff[BUFF_SIZE];\n    int      fd;\n    ssize_t  rd_size;\n    FILE *rfp;\n    FILE *ofp;\n    ofp = fopen(&quot;output.txt&quot;, &quot;w&quot;);\n    rfp = fopen(&quot;test.bin&quot;, &quot;rb&quot;);\n\n\n         while ( 4== (fread(buff, 1, 4, rfp)))\n        {\n            fprintf(ofp, &quot;%02X%02X%02X%02X \\n&quot;, buff[0], buff[1], buff[2], buff[3]);\n        }\n    \n    fclose(ofp);\n    fclose(rfp);\n    return 0;\n}\n</code></pre>\n<p>then I use above code, I've got bin to hex file\nbut I've got the problem at result.</p>\n<pre><code>04002B2B \n000001FFFFFFFF \n00030003 \n00000000 \n00000000 \n00000000 \n00000300 \n00000000 \n00000000 \n00000000 \n00000000 \n00000000 \n00000000 \n00000000 \n00500050 \n00500050 \n00500050 \n00500050 \n00000000 \nFFFFFF80002000 \n00000000 \n08700F00 \n00000000 \n00000000 \n00000001 \n00000002 \n00000003 \n00000004 \n00000005 \n00000006 \n00000007 \nFFFFFF800FFFFFFFF01E \n087007FFFFFF80 \n00320032 \n0BFFFFFFB80820 \n00050005 \n2DFFFFFFC7114D \n00FFFFFFC20118 \n00001B58 \n</code></pre>\n<p>As you can see that the above file,     especially I don't want to &quot;000001FFFFFFFF &quot; this output. But I don't know what am I supposed to do</p>\n<h1>update</h1>\n<p>I want to run in the linux. but if I make a execute file, I got the segmant error.\nCan you let me know what am I supposed to do?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1482310103, "post_id": 41258545, "comment_id": 69717288, "body": "You told us what you want, and you showed us what you have. But what is your <i>problem</i>? What is your <i>question</i>?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1482310132, "post_id": 41258545, "comment_id": 69717319, "body": "20 characters for an e-mail address is a bit stingy isn&#39;t it?"}, {"owner": {"reputation": 53, "user_id": 7276683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/793989ffe2939c9a1f7c17afb3822415?s=128&d=identicon&r=PG&f=1", "display_name": "orgee", "link": "https://stackoverflow.com/users/7276683/orgee"}, "edited": false, "score": 0, "creation_date": 1482310345, "post_id": 41258545, "comment_id": 69717447, "body": "well, problem is I can&#39;t run the code This with files is new to me so I cant really figure out what the problem is. About the 20 char for email is will be fixed later on. Righ now I just need to write in the file and read the amount of bytes used,"}, {"owner": {"reputation": 53, "user_id": 7276683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/793989ffe2939c9a1f7c17afb3822415?s=128&d=identicon&r=PG&f=1", "display_name": "orgee", "link": "https://stackoverflow.com/users/7276683/orgee"}, "edited": false, "score": 0, "creation_date": 1482311306, "post_id": 41258545, "comment_id": 69718026, "body": "problem is solved, I made some fixes and now works like I want it too!"}], "answers": [{"tags": [], "owner": {"reputation": 23946, "user_id": 3100312, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/486be6e961e6c8a2e4705058600e666f?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Ogilvie", "link": "https://stackoverflow.com/users/3100312/paul-ogilvie"}, "is_accepted": false, "score": 1, "last_activity_date": 1482312311, "last_edit_date": 1482312311, "creation_date": 1482311343, "answer_id": 41258910, "question_id": 41258545, "link": "https://stackoverflow.com/questions/41258545/about-about-binary-files-in-c/41258910#41258910", "title": "About about binary files in C", "body": "<p>With <code>myfile = fopen(\"students.dat\", \"wb\");</code> in the loop, you open the file again and again. Then you write to the file, overwriting anything that was in the file, so the file only contains your last write. Probably (possibly) your second call of <code>fopen</code> fails as the \"file is already open by another process\" but since you don't check the return value of the open call, you don't notice.</p>\n\n<p>I suggest you read about the <code>fopen</code> call and especially the open modes.</p>\n\n<p>As for hints (without providing a full solution): place the open call before the loop. You may have to check whether the file exists and decide whether to truncate the file or open it in read/write mode. Likewise, place the <code>fclose</code> call after the loop, so you only close it after you are done working with it.</p>\n\n<p>You must also check the return value of open to know whether it has suceeded or not.\n<hr>\nAs to what you write: you write a string <code>program</code> but tell the write call it has the size of <code>struct student</code>. That isn't correct. Also, to pass a pointer to an array to a function, you only need to mention the name of the array; the compiler will translate this into the address of the array, so you don't need to use the address-of operator (<code>&amp;</code>).\n<hr>\nConcerning your <code>case 2:</code> you make the same mistake of opening the file multiple times (and of not checking whether the calls succeeded). <code>freopen</code> closes the file associated with the handle (that file is already closed, so this could invoke an error) and opens the new file. Then you call <code>fopen</code> on the file again, probably causing an error. At the end of the <code>case</code> you must close the file.</p>\n"}], "owner": {"reputation": 53, "user_id": 7276683, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/793989ffe2939c9a1f7c17afb3822415?s=128&d=identicon&r=PG&f=1", "display_name": "orgee", "link": "https://stackoverflow.com/users/7276683/orgee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482312311, "creation_date": 1482309941, "question_id": 41258545, "link": "https://stackoverflow.com/questions/41258545/about-about-binary-files-in-c", "title": "About about binary files in C", "body": "<p>What I want to do in my program is to add a person ( or more ) and thereafter see the amount of bytes used, when going to (2), case 2. \nMy #include \"header.h\" is:</p>\n\n<pre><code>struct student {\n    long long int personalnumber;\n    char name[20];\n    char gender[20];\n    char program[20];\n    int age;\n    char email[20];\n};\n</code></pre>\n\n<p>What I do here is start the program, click 1, write all the information the program asks for, maybe add two students (therefor the loop). when I click (n) the program should go back to the options. When Clicking 2 the amount of bytes used in the binary file should be printed out. Main function is here:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include \"header.h\"\n\nint main()\n{\n\n    int val, age;\n    long long int personalnumber, size;\n    char email[20], program[20], gender[20], name[20], n;\n\n    do\n    {\n\n        system(\"cls\");\n\n        printf(\"1:  Add\\n\\n\");\n        printf(\"2.  info\\n\\n\");\n\n        scanf(\"%d\", &amp;val);\n        getchar();\n\n        switch (val)\n        {\n        case 1:\n\n            system(\"cls\");\n            printf(\"Add a new student to the database\\n\");\n\n            struct student s1;\n\n            FILE *myfile;\n            myfile = fopen(\"students.dat\", \"wb\");          \n            if (myfile == NULL)                                     \n            {\n                printf(\"Could not open the file!\\n\");\n                system(\"pause\"); \n                exit(1);\n            }           \n            while (1)\n            {\n                printf(\"\\nEnter student personalnumber: \");\n                scanf(\"%lld\", &amp;s1.personalnumber);\n                getchar();\n                printf(\"Enter name of student: \");\n                fgets(&amp;s1.name, 20, stdin);\n                printf(\"Enter the gender of the student: \");\n                fgets(&amp;s1.gender, 20, stdin);\n                printf(\"Enter the Program of the student: \");\n                fgets(&amp;s1.program, 20, stdin);\n                printf(\"Enter the Age of the student: \");\n                scanf(\"%d\", &amp;s1.age);\n                getchar();\n                printf(\"Enter the students Email: \");\n                fgets(&amp;s1.email, 20, stdin);\n\n                myfile = fopen(\"students.dat\", \"wb\");\n                fwrite(&amp;program, sizeof(struct student), 1, myfile);\n\n                printf(\"Do you wish to add more students? Enter y or n\");\n                n = getchar();\n                getchar();\n\n                if (n == 'n')\n                {\n                    break;\n                }\n            }\n            fclose(myfile);\n\n            system(\"pause\");\n            break;\n\n        case 2:\n\n            freopen(\"students.dat\", \"rb\", myfile);\n            system(\"cls\");\n            printf(\"bytes:\\n\\n\");\n\n            myfile = fopen(\"students.dat\", \"rb\");\n            fseek(myfile, 0, SEEK_END);\n            size = ftell(myfile);\n            rewind(myfile);\n            printf(\"Size of file is: %lld\", size);\n\n            system(\"pause\");\n\n            break;\n        }\n\n    } while (val != 3);\n\n    system(\"pause\");\n    return 0;\n\n}\n</code></pre>\n"}, {"tags": ["python", "c", "performance", "if-statement", "mapping"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1482308182, "post_id": 41257961, "comment_id": 69716214, "body": "The second solution does not work. Consider what happens if <code>s</code> is the biggest positive integer, then <code>s+1</code> overflows and you have undefined behaviour! So, between a working solution and a not-working one, choose the working one."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1482308384, "post_id": 41257961, "comment_id": 69716325, "body": "I was talking about mapping the range -1, 0, 1 to -1, -1, 1 (first line), sorry if it&#39;s vague"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1482308661, "post_id": 41257961, "comment_id": 69716461, "body": "@AsoneTuhid: If I were you I&#39;d add that mapping to the actual question."}], "answers": [{"tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1482308797, "last_edit_date": 1482308797, "creation_date": 1482307984, "answer_id": 41258016, "question_id": 41257961, "link": "https://stackoverflow.com/questions/41257961/if-else-vs-math-in-mapping-small-sequences/41258016#41258016", "title": "if else vs math in mapping small sequences", "body": "<p>If performance <em>really</em> matters that much, I think it would be difficult to beat code that transforms {-1, 0, 1} to {-1, -1, 1} by</p>\n\n<ol>\n<li>Subtracting 1.</li>\n<li>Extracting the sign bit.</li>\n</ol>\n\n<p>In C you could thump that out with a couple of inline assembly statements, depending on your platform.</p>\n\n<p>That will probably beat the equivalent ternary conditional (actually <code>s &lt;= 0 ? -1 : 1</code>) as an incorrect branch branch prediction will cause the CPU to dump the pipeline.</p>\n\n<p>With a micro-optimisation like this you need to answer it with <em>profiling</em>, set up an adequate testing framework and measure the performance to an appropriate statistically significant level.</p>\n"}, {"comments": [{"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1482308593, "post_id": 41258025, "comment_id": 69716426, "body": "Considering that s can only have values of -1, 0 and 1, is it faster to use     s &lt; 0 or     s == -1 ?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1482308711, "post_id": 41258025, "comment_id": 69716485, "body": "Why did I not think of the array method? Have an upvote!"}, {"owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "reply_to_user": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1482308751, "post_id": 41258025, "comment_id": 69716516, "body": "@AsoneTuhid, both relational expressions evaluate to either 0 or 1, the OP wants -1 or 1."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1482308860, "post_id": 41258025, "comment_id": 69716575, "body": "Nice, didn&#39;t think of that, would it be faster than if/else though?"}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1482308860, "post_id": 41258025, "comment_id": 69716577, "body": "Now the OP has provided the function, I think you need <code>s &lt;= 0</code> and <code>{-1, -1, 1}</code> as the array."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1482308895, "post_id": 41258025, "comment_id": 69716591, "body": "@AsoneTuhid: There are very few things faster in life than looking up an element from an array. This is the best answer, IMHO."}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1482309029, "post_id": 41258025, "comment_id": 69716681, "body": "@Bathsheba &quot;There are very few things faster in life than looking up an element from an array.&quot;   even in python?"}, {"owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "edited": false, "score": 0, "creation_date": 1482309151, "post_id": 41258025, "comment_id": 69716746, "body": "Sorry, i&#39;ll go eat some quiche in shame"}], "tags": [], "owner": {"reputation": 9740, "user_id": 1459996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/df2798299346f952d526d49a27fbde4e?s=128&d=identicon&r=PG", "display_name": "Kirill Kobelev", "link": "https://stackoverflow.com/users/1459996/kirill-kobelev"}, "is_accepted": false, "score": 4, "last_activity_date": 1482429358, "last_edit_date": 1482429358, "creation_date": 1482308021, "answer_id": 41258025, "question_id": 41257961, "link": "https://stackoverflow.com/questions/41257961/if-else-vs-math-in-mapping-small-sequences/41258025#41258025", "title": "if else vs math in mapping small sequences", "body": "<p>The <code>?</code> operator will be slightly faster because it involves less number of instructions and our days processors are often smart enough not to break the pipeline, although it should look this way:</p>\n\n<pre><code>int r = (s &lt; 0) ? -1 : 1;\n</code></pre>\n\n<p>Parenthesis are for clarity.</p>\n\n<p>In case if <code>s</code> can be only -1, 0 or 1, I would recommend:</p>\n\n<pre><code>int v[] = { -1, 1, 1 };\nint r = v[s+1];\n</code></pre>\n\n<p>This will never break the CPU pipeline.</p>\n"}, {"tags": [], "owner": {"reputation": 44820, "user_id": 4492932, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8938ef2681650e100bc9f83434ef272?s=128&d=identicon&r=PG", "display_name": "DYZ", "link": "https://stackoverflow.com/users/4492932/dyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1482308542, "last_edit_date": 1482308542, "creation_date": 1482308173, "answer_id": 41258067, "question_id": 41257961, "link": "https://stackoverflow.com/questions/41257961/if-else-vs-math-in-mapping-small-sequences/41258067#41258067", "title": "if else vs math in mapping small sequences", "body": "<p>In Python, the boolean operator is >5 times faster than math:</p>\n\n<pre><code>%timeit (math.ceil((s + 1) / 2) * 2 - 1)\n# 1000000 loops, best of 3: 381 ns per loop\n\n%timeit (-1 if s &lt; 0 else 1)\n#10000000 loops, best of 3: 70.1 ns per loop\n</code></pre>\n\n<p>In Python, you can also use direct dictionary lookup, which is surprisingly almost as good as the boolean if:</p>\n\n<pre><code>d = {-1:-1, 0:-1, 1:1}\n%timeit d[s]\n#10000000 loops, best of 3: 73.8 ns per loop\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 50347, "user_id": 1763356, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zGWG9.png?s=128&g=1", "display_name": "Veedrac", "link": "https://stackoverflow.com/users/1763356/veedrac"}, "is_accepted": false, "score": 1, "last_activity_date": 1482343973, "creation_date": 1482343973, "answer_id": 41269281, "question_id": 41257961, "link": "https://stackoverflow.com/questions/41257961/if-else-vs-math-in-mapping-small-sequences/41269281#41269281", "title": "if else vs math in mapping small sequences", "body": "<p>Modern compilers are not idiotic. They won't give silly unnecessary jumps for conditional moves, for example. (That's not to say they're smart, though.) Given <code>return x == -1 ? -1 : 1;</code>, Clang and GCC respectively produce</p>\n\n<pre><code>sgn:                                    # @sgn\n    cmp     edi, -1\n    mov     eax, 1\n    cmove   eax, edi\n    ret\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sgn:\n    xor     eax, eax\n    cmp     edi, -1\n    setne   al\n    lea     eax, [rax-1+rax]\n    ret\n</code></pre>\n\n<p>These are pretty good, but I'd expect a shift + <code>or</code> to be faster. <code>return (2 * -(x &lt; 0)) + 1;</code> compiles to</p>\n\n<pre><code>sgn:                                    # @sgn\n    sar     edi, 30\n    or      edi, 1\n    mov     eax, edi\n    ret\n</code></pre>\n\n<p>and</p>\n\n<pre><code>sgn:\n    mov     eax, edi\n    sar     eax, 31\n    or      eax, 1\n    ret\n</code></pre>\n\n<p>respectively. These are pretty damn fast.</p>\n\n<p>The same will not be true on CPython, since that's an interpreter.</p>\n"}], "owner": {"reputation": 469, "user_id": 7324619, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1fceecbf4e9c3c61e8ee1335da9d83ec?s=128&d=identicon&r=PG&f=1", "display_name": "Asone Tuhid", "link": "https://stackoverflow.com/users/7324619/asone-tuhid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1482429358, "creation_date": 1482307758, "last_edit_date": 1482308760, "question_id": 41257961, "link": "https://stackoverflow.com/questions/41257961/if-else-vs-math-in-mapping-small-sequences", "title": "if else vs math in mapping small sequences", "body": "<p>I recently had to transform the sign of an integer into either -1 or 1</p>\n\n<p>I wonder, is it faster to do it via an if else statement or by doing a calculation?</p>\n\n<pre><code>#if else#\ns == -1 ? -1 : 1\n\n#calculation#\nceil((s + 1) / 2) * 2 - 1\n</code></pre>\n\n<p>I know it's quite a simple example but sometimes you need to map larger intervals and, intuitively, it just seems that the math will be faster at lest for the smaller ones.</p>\n\n<p>Also, how is the relative speed affected by the language used (eg. Python vs C).</p>\n"}, {"tags": ["c", "multithreading", "unix", "signals", "reentrancy"], "comments": [{"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1482307926, "post_id": 41257768, "comment_id": 69716112, "body": "Off-topic, but... since C has zero based arrays, it should be <code>key_len = i;</code> not <code>key_len = i - 1;</code>"}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1482308761, "post_id": 41257768, "comment_id": 69716522, "body": "@KlasLindb&#228;ck I use <code>i - 1</code> because I want to <code>strncmp</code> the <i>key</i> part of <i>key=value</i>. <code>i</code> at the time the loop breaks is at the position of the <code>=</code> sign, so I need to subtract 1 from the index."}, {"owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 1, "creation_date": 1482313307, "post_id": 41257768, "comment_id": 69719355, "body": "<code>strncmp</code> wants the number of characters, not the index of the last character. If you have <code>foo=bar</code> then you get <code>i = 3</code> and <code>key_len = 2</code> and your <code>strncmp</code> will only compare the 2 first characters..."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "reply_to_user": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "edited": false, "score": 0, "creation_date": 1482319605, "post_id": 41257768, "comment_id": 69723805, "body": "@KlasLindb&#228;ck Ah of course, thanks for pointing that out. Like you said, off topic, but a good error to fix up!"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482321454, "post_id": 41257768, "comment_id": 69724909, "body": "What does <code>malloc()</code> being async-signal-unsafe have to do with blocking signals?  I&#39;m missing something."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482321668, "post_id": 41257768, "comment_id": 69725035, "body": "I might be getting that confused with reentrancy. Isn&#39;t it true that if <code>malloc</code> is interrupted (by a signal perhaps, hence my confusion) then it cannot be resumed safely because it could mess up the stack?."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1482324560, "post_id": 41257768, "comment_id": 69726891, "body": "@DanielPorteous If <code>malloc()</code> does get interrupted by a signal, that will be invisible to the caller."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482324649, "post_id": 41257768, "comment_id": 69726955, "body": "Right. I think I was getting confused with not being allowed to call <code>malloc()</code> from within a signal handler, in which case not being async-signal safe is a problem."}], "answers": [{"comments": [{"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482321860, "post_id": 41262255, "comment_id": 69725156, "body": "I&#39;m just using <code>environ</code> as it is supplied naturally following a call to <code>execve</code>, I&#39;m not sure if that entails <code>malloc</code>. Thanks for pointing this out though, I had a vibe that the way I was adding a new element to <code>environ</code> was insufficient."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482322275, "post_id": 41262255, "comment_id": 69725432, "body": "I will update my question to reflect these suggestions, perhaps bypassing the <code>newEnviron</code> steps and just working directly with <code>environ</code>. I feel the code still has a ways to go however."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482322650, "post_id": 41262255, "comment_id": 69725706, "body": "@DanielPorteous If you work directly on <code>environ</code> itself, the code won&#39;t be thread-safe.  Strictly speaking, even <code>environ = newEnviron;</code> isn&#39;t necessarily thread-safe as updating a pointer value is not necessarily an atomic operation."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482322881, "post_id": 41262255, "comment_id": 69725868, "body": "Even though I&#39;m using a mutex to control access to environ? As long as I make sure all my threads are respecting these mutexes as well, it will be thread safe yes? If not, if it&#39;s not too much trouble could you explain why it wouldn&#39;t be?"}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482324453, "post_id": 41262255, "comment_id": 69726839, "body": "@DanielPorteous Yes, even though you&#39;re using a mutex.  Because your mutex only protects <i>your</i> update code, not anything that reads the environment nor any code that updates the environment through other means.  Because of the potential for other threads to read the environment, the array of pointers the <code>environ</code> points to must be valid at all times."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482324734, "post_id": 41262255, "comment_id": 69726999, "body": "I see your point. Even if I did happen to be able to confirm all the threads won&#39;t misbehave, it&#39;s certainly much more robust to minimise the thread-unsafe time. I&#39;ll update the code accordingly, thanks. I&#39;ll leave the question open for a while longer of course to see if anyone else notices anything, but soon I&#39;ll mark your answer as correct, you&#39;ve been incredibly helpful."}, {"owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482325449, "post_id": 41262255, "comment_id": 69727487, "body": "Update: Seems like environ is indeed not created by malloc by default, the realloc is causing a big &quot;invalid pointer&quot; error. Might have to revert to editing <code>environ</code> itself despite the thread safety risks. Not sure how to increase the size of <code>environ</code> though."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "edited": false, "score": 0, "creation_date": 1482330195, "post_id": 41262255, "comment_id": 69730688, "body": "@DanielPorteous If you&#39;re running glibc/Linux, the source code for <code>putenv()</code> can be found at <a href=\"https://fossies.org/dox/glibc-2.24/putenv_8c_source.html\" rel=\"nofollow noreferrer\">fossies.org/dox/glibc-2.24/putenv_8c_source.html</a> and the actual environment implementation at <a href=\"https://fossies.org/dox/glibc-2.24/setenv_8c_source.html\" rel=\"nofollow noreferrer\">fossies.org/dox/glibc-2.24/setenv_8c_source.html</a>"}], "tags": [], "owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "is_accepted": true, "score": 3, "last_activity_date": 1482321312, "creation_date": 1482321312, "answer_id": 41262255, "question_id": 41257768, "link": "https://stackoverflow.com/questions/41257768/thread-safe-reentrant-async-signal-safe-putenv/41262255#41262255", "title": "Thread safe, reentrant, async-signal safe putenv", "body": "<p>This code is a problem:</p>\n\n<pre><code>// If we get here, the env var didn't already exist, so we add it.\n// Note that malloc isn't async-signal safe. This is why we block signals.\nenviron[i] = malloc(sizeof(char *));\nenviron[i] = string;\n</code></pre>\n\n<p>It creates a <code>char *</code> on the heap, assigns the address of that <code>char *</code> to <code>environ[i]</code>, then overwrites that value with the address contained in <code>string</code>.  That's not going to work.  It doesn't guarantee that <code>environ</code> is NULL-terminated afterwards.</p>\n\n<p>Because <a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html\" rel=\"nofollow noreferrer\"><code>char **environ</code> is a pointer to an array of pointers</a>.  The last pointer in the array is <code>NULL</code> - that's how code can tell it's reached the end of the list of environment variables.</p>\n\n<p>Something like this should work better:</p>\n\n<pre><code>unsigned int envCount;\n\nfor ( envCount = 0; environ[ envCount ]; envCount++ )\n{\n    /* empty loop */;\n}\n\n/* since environ[ envCount ] is NULL, the environ array\n   of pointers has envCount + 1 elements in it */\nenvCount++;\n\n/* grow the environ array by one pointer */\nchar ** newEnviron = realloc( environ, ( envCount + 1 ) * sizeof( char * ) );\n\n/* add the new envval */\nnewEnviron[ envCount - 1 ] = newEnvval;\n\n/* NULL-terminate the array of pointers */\nnewEnviron[ envCount ] = NULL;\n\nenviron = newEnviron;\n</code></pre>\n\n<p>Note that there's no error checking, and it assumes the original <code>environ</code> array was obtained via a call to <code>malloc()</code> or similar.  If that assumption is wrong, the behavior is undefined.</p>\n"}], "owner": {"reputation": 3146, "user_id": 3846032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lgCDn.png?s=128&g=1", "display_name": "Daniel Porteous", "link": "https://stackoverflow.com/users/3846032/daniel-porteous"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 41262255, "answer_count": 1, "score": 4, "last_activity_date": 1482326336, "creation_date": 1482306983, "last_edit_date": 1482326336, "question_id": 41257768, "link": "https://stackoverflow.com/questions/41257768/thread-safe-reentrant-async-signal-safe-putenv", "title": "Thread safe, reentrant, async-signal safe putenv", "body": "<p>I apologise in advance for what will be a bit of a code dump, I've trimmed as much unimportant code as possible:</p>\n\n<pre><code>// Global vars / mutex stuff\nextern char **environ;\npthread_mutex_t env_mutex = PTHREAD_MUTEX_INITIALIZER;\n\nint\nputenv_r(char *string)\n{\n    int len;\n    int key_len = 0;\n    int i;\n\n    sigset_t block;\n    sigset_t old;\n\n    sigfillset(&amp;block);\n    pthread_sigmask(SIG_BLOCK, &amp;block, &amp;old);\n\n    // This function is thread-safe\n    len = strlen(string);\n\n    for (int i=0; i &lt; len; i++) {\n        if (string[i] == '=') {\n            key_len = i; // Thanks Klas for pointing this out.\n            break;\n        }\n    }\n    // Need a string like key=value\n    if (key_len == 0) {\n        errno = EINVAL; // putenv doesn't normally return this err code\n        return -1;\n    }\n\n    // We're moving into environ territory so start locking stuff up.\n    pthread_mutex_lock(&amp;env_mutex);\n\n    for (i = 0; environ[i] != NULL; i++) {\n        if (strncmp(string, environ[i], key_len) == 0) {\n            // Pointer assignment, so if string changes so does the env. \n            // This behaviour is POSIX conformant, instead of making a copy.\n            environ[i] = string;\n            pthread_mutex_unlock(&amp;env_mutex);\n            return(0);\n        }\n    }\n\n    // If we get here, the env var didn't already exist, so we add it.\n    // Note that malloc isn't async-signal safe. This is why we block signals.\n    environ[i] = malloc(sizeof(char *));\n    environ[i] = string;\n    environ[i+1] = NULL;\n    // This ^ is possibly incorrect, do I need to grow environ some how?\n\n    pthread_mutex_unlock(&amp;env_mutex);\n    pthread_sigmask(SIG_SETMASK, &amp;old, NULL);\n\n    return(0);\n}\n</code></pre>\n\n<p>As the title says, I'm trying to code a thread safe, async-signal safe reentrant version of <code>putenv</code>. The code works in that it sets the environment variable like <code>putenv</code> would, but I do have a few concerns:</p>\n\n<ol>\n<li>My method for making it async-signal safe feels a bit ham-handed, just blocking all signals (except SIGKILL/SIGSTOP of course). Or is this the most appropriate way to go about it.</li>\n<li>Is the location of my signal blocking too conservative? I know <code>strlen</code> isn't guaranteed to be async-signal safe, meaning that my signal blocking has to occur beforehand, but perhaps I'm mistaken.</li>\n<li>I'm fairly sure that it is thread safe, considering that all the functions are thread-safe and that I lock interactions with <code>environ</code>, but I'd love to be proven otherwise.</li>\n<li>I'm really not too sure about whether it's reentrant or not. While not guaranteed, I imagine that if I tick the other two boxes it'll most likely be reentrant?</li>\n</ol>\n\n<p>I found another solution to this question <a href=\"https://github.com/damnever/Note/blob/master/apue.3e/exercises/11.2_implement_putenv_r.c\" rel=\"nofollow noreferrer\">here</a>, in which they just set up the appropriate signal blocking and mutex locking (<em>sick rhymes</em>) and then call <code>putenv</code> normally. Is this valid? If so, it's obviously far simpler than my approach.</p>\n\n<p>Sorry about the large block of code, I hope I've established a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. I'm missing a bit of error checking in my code for brevity's sake. Thanks!</p>\n\n<hr>\n\n<p>Here is the rest of the code, including a main, if you wish to test the code yourself:</p>\n\n<pre><code>#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;pthread.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;signal.h&gt;\n\n// Prototypes\nstatic void thread_init(void);\nint putenv_r(char *string);\n\nint\nmain(int argc, char *argv[]) {\n\n    int ret = putenv_r(\"mykey=myval\");\n    printf(\"%d: mykey = %s\\n\", ret, getenv(\"mykey\"));\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "input", "output"], "comments": [{"owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "edited": false, "score": 1, "creation_date": 1482306980, "post_id": 41257681, "comment_id": 69715668, "body": "Use a library like <code>curses</code> or <code>ncurses</code>. Or if you are not using a <code>unixoid</code> then the equivalent for your OS."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 4, "creation_date": 1482306983, "post_id": 41257681, "comment_id": 69715674, "body": "It&#39;s not possible using standard C, even if you make <code>stdin</code> unbuffered. You have to use operating system dependent functions."}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 0, "creation_date": 1482307828, "post_id": 41257681, "comment_id": 69716069, "body": "you can modify terminal behaviour using the stty command."}], "answers": [{"tags": [], "owner": {"reputation": 5754, "user_id": 2867061, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/cd59dfa471d99e7c625b5dcb191ec8ae?s=128&d=identicon&r=PG&f=1", "display_name": "user31264", "link": "https://stackoverflow.com/users/2867061/user31264"}, "is_accepted": true, "score": 1, "last_activity_date": 1482307041, "creation_date": 1482307041, "answer_id": 41257781, "question_id": 41257681, "link": "https://stackoverflow.com/questions/41257681/print-something-exactly-after-1-character-in-standard-output-in-c/41257781#41257781", "title": "print something exactly after 1 character in standard output in C", "body": "<blockquote>\n  <p>I would like to print a exactly after a user pressed a</p>\n</blockquote>\n\n<p>You cannot do it without using third party libraries, as the cin file, if it is a terminal, receives data only after the user presses enter.  You may use some branch of <code>curses</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": false, "score": 1, "last_activity_date": 1482308177, "creation_date": 1482308177, "answer_id": 41258068, "question_id": 41257681, "link": "https://stackoverflow.com/questions/41257681/print-something-exactly-after-1-character-in-standard-output-in-c/41258068#41258068", "title": "print something exactly after 1 character in standard output in C", "body": "<p>getchar() doesn't care about ENTER, it just processes whatever comes through stdin. Line buffering tends to be OS/terminal defined behavior.</p>\n\n<p>Many compilers/platforms support the non-standard getch() that does not require ENTER (bypasses platform buffering).</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;conio.h&gt;  //provides non standard getch() function\nusing namespace std;\n\nint main()\n{  \n  cout &lt;&lt; \"Password \";  \n  string name;\n  while(true){\n      char ch = getch();    \n\n      if(ch=='\\r'){  // found Enter key\n         cout &lt;&lt; endl &lt;&lt; \"Password is: \" &lt;&lt; name &lt;&lt;endl; \n         break;\n      }\n\n      name+=ch;             \n      cout &lt;&lt; \"*\";\n     }\n  getch();\n  return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 1142, "user_id": 5863693, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/101741963312f7ee577a74925672d234?s=128&d=identicon&r=PG&f=1", "display_name": "Yos", "link": "https://stackoverflow.com/users/5863693/yos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 41257781, "answer_count": 2, "score": 0, "last_activity_date": 1482308177, "creation_date": 1482306643, "question_id": 41257681, "link": "https://stackoverflow.com/questions/41257681/print-something-exactly-after-1-character-in-standard-output-in-c", "title": "print something exactly after 1 character in standard output in C", "body": "<p>I have a very simple program in C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main() {\n  char c;\n  int i;\n\n  if( (c = getchar()) == 'a')\n    printf(\"pressed a\");\n\n  return 0;\n}\n</code></pre>\n\n<p>I would like to print <code>a</code> exactly after a user pressed <code>a</code> however this is printed only after I press enter. I need to write a much more complicated program where certain keyword a user types in the standard input will invoke certain commands (e.g.: quit/print/read characters) but I don't want to read the whole line in order to execute those commands. I'm learning a university course in C so we can't use any non-standard libraries.</p>\n"}, {"tags": ["c", "windows", "dll", "directory", "cross-compiling"], "comments": [{"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1482310296, "post_id": 41257605, "comment_id": 69717419, "body": "Probably you don&#39;t need to <i>install</i> anything, you just have to take care your dll and it&#39;s dependencies are in the dll search path (<a href=\"https://msdn.microsoft.com/en-us/library/7d83bc18.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/7d83bc18.aspx</a>). I don&#39;t know Java, but see point 1 and 2 in the link: have you tried just putting the dll next to the main executable?"}, {"owner": {"reputation": 73, "user_id": 1815513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b88fe4c75ca98ce102e2ddc00d106931?s=128&d=identicon&r=PG", "display_name": "VikNop", "link": "https://stackoverflow.com/users/1815513/viknop"}, "reply_to_user": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1482331143, "post_id": 41257605, "comment_id": 69731362, "body": "Java applications are usually packaged as JAR or WAR files, depending on whether the application is a web app or not."}, {"owner": {"reputation": 73, "user_id": 1815513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b88fe4c75ca98ce102e2ddc00d106931?s=128&d=identicon&r=PG", "display_name": "VikNop", "link": "https://stackoverflow.com/users/1815513/viknop"}, "reply_to_user": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1482331443, "post_id": 41257605, "comment_id": 69731564, "body": "The only &quot;executable&quot; that I&#39;m aware of is the Java virtual machine."}, {"owner": {"reputation": 31465, "user_id": 128384, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/cf6f92bfb2a16c0e2c6ca7aef4440862?s=128&d=identicon&r=PG", "display_name": "stijn", "link": "https://stackoverflow.com/users/128384/stijn"}, "edited": false, "score": 0, "creation_date": 1482331994, "post_id": 41257605, "comment_id": 69731930, "body": "If the VM sets the current working directory to the JAR path it should find dlls there. Or apparently in java.library.path: <a href=\"http://stackoverflow.com/questions/6092200/how-to-fix-an-unsatisfiedlinkerror-cant-find-dependent-libraries-in-a-jni-pro\" title=\"how to fix an unsatisfiedlinkerror cant find dependent libraries in a jni pro\">stackoverflow.com/questions/6092200/&hellip;</a>"}], "owner": {"reputation": 73, "user_id": 1815513, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b88fe4c75ca98ce102e2ddc00d106931?s=128&d=identicon&r=PG", "display_name": "VikNop", "link": "https://stackoverflow.com/users/1815513/viknop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482316754, "creation_date": 1482306388, "last_edit_date": 1495541637, "question_id": 41257605, "link": "https://stackoverflow.com/questions/41257605/where-should-i-put-a-dll-that-is-cross-compiled-from-source", "title": "Where should I put a DLL that is cross-compiled from source?", "body": "<p>I really want to use the <a href=\"https://github.com/openvenues/libpostal\" rel=\"nofollow noreferrer\">libpostal</a> library as part of my Java application via the <a href=\"https://github.com/openvenues/jpostal\" rel=\"nofollow noreferrer\">jpostal</a> binding. While I can work around the fact that jpostal uses Gradle instead of Maven, I'm not sure where to proceed after I've cross compiled a libpostal DLL using a Linux machine.</p>\n\n<p>According <a href=\"https://stackoverflow.com/questions/38230041/what-is-the-equivalent-of-usr-lib-on-windows\">the answer to this question</a>, the process of installing a DLL on Windows is very convoluted.</p>\n\n<p>If anyone has good idea as to where I can put the DLL so that my Java application using jpostal can find it, please tell me.</p>\n\n<p>P.S: My Java application will run on a CentOS machine in production but for development, testing, and demoing I'm using my laptop and desktop which run Windows. Of course if I can't get libpostal to work on Windows, then I can always go the virtual machine route.</p>\n"}, {"tags": ["c", "memory"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482303591, "post_id": 41256789, "comment_id": 69713952, "body": "<code>mmap()</code> has nothing to do with <code>malloc()</code> and <code>free()</code>.  What does it have to do with your question?"}, {"owner": {"reputation": 3933, "user_id": 7186598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5f869a58e83c9ef8ddd17c4c7879ef1?s=128&d=identicon&r=PG&f=1", "display_name": "Gerrit0", "link": "https://stackoverflow.com/users/7186598/gerrit0"}, "edited": false, "score": 0, "creation_date": 1482303653, "post_id": 41256789, "comment_id": 69713979, "body": "Alex&#39;s answer <a href=\"http://stackoverflow.com/questions/2215259/will-malloc-implementations-return-free-ed-memory-back-to-the-system\">here</a> may be what you are looking for."}, {"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1482305035, "post_id": 41256789, "comment_id": 69714647, "body": "@JohnBollinger <code>malloc()</code> will call <code>mmap()</code> if request memory size is great than <code>M_MMAP_THRESHOLD</code>."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482326253, "post_id": 41256789, "comment_id": 69728007, "body": "@CharlesLiuChina, when you pose a question that is specific to a particular implementation -- as apparently you have -- then it behooves you to tag it appropriately (i.e. [glibc]).  Neither C nor POSIX specifies the behavior you describe."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1482305552, "post_id": 41257109, "comment_id": 69714921, "body": "I have read the source of <code>ptmalloc</code>, my project has a situation: each item is about <code>54K</code>, and 60000 items is loaded from database every 2 minutes. There are two points to do swapping for fresh items. Point <code>A</code> points to <code>54K * 60000 = about 3G</code> memory, <code>B</code> reload items from database, and take another <code>3G</code>, and then <code>A</code> swaps with <code>B</code> and <code>B</code> is <code>free</code>(d). But these <code>54K</code> items is <code>malloc</code>(ed) through <code>brk()</code> system call which won&#39;t be returned back to OS after <code>free</code>(d). So, I am going to decrease <code>M_MMAP_THRESHOLD</code> to make these <code>54K</code> items <code>free</code>(d) through <code>munmap</code>."}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "reply_to_user": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1482306020, "post_id": 41257109, "comment_id": 69715195, "body": "@CharlesLiuChina why do you want to use mmap-ed functionality. When a process needs memory, some room is created by moving the upper bound of the heap forward, using the brk() or sbrk() system calls. Because a system call is expensive in terms of CPU usage, a better strategy is to call brk() to grab a large chunk of memory and then split it as needed to get smaller chunks. This is exactly what malloc() does. It aggregates a lot of smaller malloc() requests into fewer large brk() calls. Doing so yields a significant performance improvement."}, {"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1482306218, "post_id": 41257109, "comment_id": 69715299, "body": "I know that, but the OS needs that memory. I get a small RAM."}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "reply_to_user": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1482306567, "post_id": 41257109, "comment_id": 69715476, "body": "@CharlesLiuChina Okay, but there are two disadvantage also to use mmap, 1. deallocated space is not placed on the free list for reuse by later allocations; 2. memory may be wasted because mmap(2) allocations must be page-aligned."}, {"owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "edited": false, "score": 0, "creation_date": 1482306753, "post_id": 41257109, "comment_id": 69715568, "body": "Yes, that&#39;s absolutely right."}], "tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": false, "score": 2, "last_activity_date": 1482304507, "creation_date": 1482304507, "answer_id": 41257109, "question_id": 41256789, "link": "https://stackoverflow.com/questions/41256789/is-memory-malloc-through-mmap-returned-to-os-immediately-after-calling-free/41257109#41257109", "title": "Is memory malloc() through mmap() returned to OS immediately after calling free()?", "body": "<p>Be aware that mmap is a system call which might be quite expensive. malloc implementations take care to avoid calling it too often, that is why they manage previously free-d zones to reuse them later (in further malloc-s) without any syscall. <strong>In practice, most malloc implementations manage differently big allocations (e.g. more than a megabyte), which are often mmap-ed at malloc and munmap-ed at free time.</strong> </p>\n\n<p><strong>mmap-ed at malloc, memory is immediately returned to the OS, when you do free (internal munmap).</strong></p>\n\n<p>You could study the source code of some malloc. </p>\n"}, {"tags": [], "owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "is_accepted": true, "score": 2, "last_activity_date": 1482305585, "creation_date": 1482305585, "answer_id": 41257399, "question_id": 41256789, "link": "https://stackoverflow.com/questions/41256789/is-memory-malloc-through-mmap-returned-to-os-immediately-after-calling-free/41257399#41257399", "title": "Is memory malloc() through mmap() returned to OS immediately after calling free()?", "body": "<p>According to <a href=\"http://man7.org/linux/man-pages/man3/mallopt.3.html\" rel=\"nofollow noreferrer\">http://man7.org/linux/man-pages/man3/mallopt.3.html</a></p>\n\n<blockquote>\n  <p>For allocations greater than or equal to the limit specified (in\n  bytes) by M_MMAP_THRESHOLD that can't be satisfied from the free list,\n  the memory-allocation functions employ mmap(2) instead of increasing\n  the program break using sbrk(2).</p>\n  \n  <p>Allocating memory using mmap(2) has the significant advantage that the\n  allocated <strong>memory blocks can always be independently released back to\n  the system</strong>.  (By contrast, the heap can be trimmed only if memory is\n  freed at the top end.)  On the other hand, there are some\n  disadvantages to the use of mmap(2): <strong>deallocated space is not placed\n  on the free list</strong> for reuse by later allocations;</p>\n</blockquote>\n\n<p>So the large allocations which should be done with help of mmap, has nothing to do with malloc's list of free or used blocks, and they're come back to system when freed.</p>\n"}], "owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 384, "favorite_count": 0, "closed_date": 1482342310, "accepted_answer_id": 41257399, "answer_count": 2, "score": 2, "last_activity_date": 1482305585, "creation_date": 1482303093, "question_id": 41256789, "link": "https://stackoverflow.com/questions/41256789/is-memory-malloc-through-mmap-returned-to-os-immediately-after-calling-free", "closed_reason": "Needs details or clarity", "title": "Is memory malloc() through mmap() returned to OS immediately after calling free()?", "body": "<p>Is memory <code>malloc()</code> through <code>mmap()</code> returned to OS immediately after calling <code>free()</code>?</p>\n"}, {"tags": ["c", "linux", "unix", "signals"], "comments": [{"owner": {"reputation": 28476, "user_id": 6862601, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ppP5k.jpg?s=128&g=1", "display_name": "codeforester", "link": "https://stackoverflow.com/users/6862601/codeforester"}, "edited": false, "score": 0, "creation_date": 1482303215, "post_id": 41256644, "comment_id": 69713777, "body": "Use a signal handler where you set a flag that indicates that you need to return to select() step.  The rest of the code can check for this flag and jump accordingly."}], "answers": [{"tags": [], "owner": {"reputation": 26945, "user_id": 771073, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/412bf39694cbe9d1fc0374deda225b18?s=128&d=identicon&r=PG", "display_name": "Martin Bonner supports Monica", "link": "https://stackoverflow.com/users/771073/martin-bonner-supports-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1482303579, "creation_date": 1482303579, "answer_id": 41256904, "question_id": 41256644, "link": "https://stackoverflow.com/questions/41256644/c-stop-executing-and-jump-to-specific-point-in-program-on-receiving-a-signal/41256904#41256904", "title": "C: Stop executing and jump to specific point in program on receiving a signal", "body": "<p>How about:</p>\n\n<ul>\n<li>When Program 2 starts up, it performs most of the initialization, and then forks a copy of itself.</li>\n<li>The child process creates the socket and connects to it, then selects, and runs as normal.</li>\n<li>When the child process receives <code>SIGUSR1</code> it exits with an exit status that indicates a restart is required.</li>\n<li>The parent process just sits waiting for the child to exit, and if the exit status indicates a restart is required, forks another child.  (Any other exit status causes the parent to exit with the same status).</li>\n</ul>\n\n<p>Discussion:</p>\n\n<ul>\n<li>Restart will be quite slow (need to create sockets etc).</li>\n<li>Process 1 will need to be aware that the message queue will get disconnected when it sends <code>SIGUSR1</code></li>\n<li>This should be very reliable, and portable across Posix.</li>\n<li>The <code>fork</code> bit is really only an optimization.  You could make the parent process be some sort of script - in which case the model could even be ported to Windows (obviously the script would be different, but the source of program 2 would be portable).</li>\n</ul>\n\n<p>The only other alternative is to have some sort of flag which Process 2 polls \"frequently\".  If the flag is set, the process throws an exception (C++), or <code>longjmp</code>s (C) back to the <code>select</code> call.  The flag is set in the signal handler.</p>\n\n<p>The issue with that approach is that a) it breaks if something happens to stop you polling the flag; b) it is quite hard to write code that is exception safe or which doesn't leak resources if you <code>longjmp</code> through it.</p>\n"}], "owner": {"reputation": 465, "user_id": 3050164, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/efDzZ.jpg?s=128&g=1", "display_name": "Anirban", "link": "https://stackoverflow.com/users/3050164/anirban"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 41256904, "answer_count": 1, "score": 2, "last_activity_date": 1482303579, "creation_date": 1482302555, "last_edit_date": 1482302824, "question_id": 41256644, "link": "https://stackoverflow.com/questions/41256644/c-stop-executing-and-jump-to-specific-point-in-program-on-receiving-a-signal", "title": "C: Stop executing and jump to specific point in program on receiving a signal", "body": "<p>I have written a code where two independent programs (say 1 &amp; 2) are communicating via message queues. Each programs sends a message of a specific <code>mtype</code> and waits for response of specific <code>mtype</code>. Based on the <code>mtype</code> functions are invoked. program 2 initially waits on <code>select()</code> on the message queue waiting for message chain initiation from program 1 and after each successfull communication chain via message queues comes back to <code>select()</code> waiting for program 1's initiation of next communication chain.</p>\n\n<p>I want that program 2 must return to <code>select()</code> by stopping execution wherever it was in between a communication chain on receiving a specific signal (say <code>SIGUUSR1</code>) from program 1 in case program 1 finds an error in current chain and wants a reset and later would initiate a new communication chain. </p>\n\n<p>On receiving this signal program 2 returns from all functions it is in and straight jumps to <code>select()</code>.</p>\n\n<p>I regret for not sharing a code snippet, but I hope I have made my point.</p>\n\n<p>Thanks...</p>\n"}, {"tags": ["c", "gcc", "compiler-errors"], "comments": [{"owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "edited": false, "score": 6, "creation_date": 1482302069, "post_id": 41256512, "comment_id": 69713245, "body": "This is your problem: <code>int(sqrt(double(a)))</code>. Try: <code>(int)sqrt((double)a)</code>"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 5, "creation_date": 1482302107, "post_id": 41256512, "comment_id": 69713261, "body": "It looks like you are compiling it as C++ in one case (Visual C++) and as C in the other (gcc). It fails because you are using C++ casts which are not valid in C."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 2, "creation_date": 1482302381, "post_id": 41256512, "comment_id": 69713368, "body": "BTW, <code>sqrt</code> should only be computed once (before the loop). Or test on <code>i*i &lt;= a</code>; and you should declare <code>bool primer_number(int a)</code>"}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "reply_to_user": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1482302625, "post_id": 41256512, "comment_id": 69713483, "body": "and by the way, it should be <code>i &lt;=</code> not <code>i &lt;</code>, otherwise you will consider any  number that is square of a prime as a prime. Definitely, the test SHOULD be <code>i*i &lt;= a</code> as per @BasileStarynkevitch."}], "answers": [{"comments": [{"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482302915, "post_id": 41256589, "comment_id": 69713633, "body": "Does this classify <code>9</code> as a non-prime number? I dont think so. I suggest <code>for (i = 2; i*i &lt;= a; ++i)</code>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482303043, "post_id": 41256589, "comment_id": 69713692, "body": "@A.S.H, it sure does."}, {"owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "edited": false, "score": 0, "creation_date": 1482303130, "post_id": 41256589, "comment_id": 69713743, "body": "Ah, sorry, I mean it should not, but it does. I edited my question :) (added &quot;non-&quot;)"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 0, "creation_date": 1482306840, "post_id": 41256589, "comment_id": 69715601, "body": "AFAIK Visual Studio treats C code always as &quot;special&quot; C++ Code, because it has no C-compiler."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1549044815, "last_edit_date": 1549044815, "creation_date": 1482302285, "answer_id": 41256589, "question_id": 41256512, "link": "https://stackoverflow.com/questions/41256512/errorexpected-expression-before-int-when-casting-float-or-double-into-integer/41256589#41256589", "title": "Error:expected expression before &#39;int&#39; when casting float or double into integer in C", "body": "<p><code>int(sqrt(double(a)))</code> is a valid expression in C++ but not in C. Perhaps Visual Studio 2015 has some non-standard extensions that allows such an expression in C or you are compiling the file as though it is a C++ file.</p>\n\n<pre><code>double x=3.14159265359;\nfloat y=1.41421;\nint z=(int)x;  //correct syntax to cast double to int\nz=(int)y;  // there should be no syntax error \n</code></pre>\n\n<p>Change it to <code>(int)sqrt(a)</code>.</p>\n\n<pre><code>for (i = 2; i&lt; (int)sqrt(a)); i++)\n{\n  if (a%i == 0) return m = 1;\n}\n</code></pre>\n\n<p><strike>\n<strong>Suggestions for further cleanup</strong></p>\n\n<p>You can get better performance by moving the call to <code>sqrt(a)</code> out of the loop. Also, you don't need the variable <code>m</code> at all.</p>\n\n<pre><code>int primer_number(int a)\n{\n   int i;\n   int end = (int)sqrt(a);\n   for (i = 2; i &lt; end; i++)\n   {\n     if (a%i == 0) return 1;\n   }\n\n   return 0;\n}\n</code></pre>\n\n<p></strike></p>\n\n<p><strong>PS</strong> The logic used in the function is wrong. You can use a slightly modified logic:</p>\n\n<pre><code>int primer_number(int a)\n{\n   int i;\n   for (i = 2; i*i &lt;= a; i++)\n   {\n      if (a%i == 0) return 1;\n   }\n   return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3937311, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PQP0.jpg?s=128&g=1", "display_name": "Yinjie Hu", "link": "https://stackoverflow.com/users/3937311/yinjie-hu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5446, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1549044815, "creation_date": 1482301960, "last_edit_date": 1549044605, "question_id": 41256512, "link": "https://stackoverflow.com/questions/41256512/errorexpected-expression-before-int-when-casting-float-or-double-into-integer", "title": "Error:expected expression before &#39;int&#39; when casting float or double into integer in C", "body": "<p>This code is to show the primer number between 500 and 1000.</p>\n\n<p>When I build this code on gcc 6.2.1 it return an error but when I build it on Visual Studio 2015 it's successful.</p>\n\n<pre><code>    #include &lt;stdio.h&gt;\n    #include &lt;math.h&gt;\n    int primer_number(int a)\n    {\n      int i, m = 0;\n      for (i = 2; i&lt;int(sqrt(double(a))); i++)\n      {\n        if (a%i == 0) return m = 1;\n      }\n    return m;\n    }\n\n   int main(void)\n   {\n    int i;\n    for (i = 500; i &lt;= 1000; i++)\n    {\n        if (primer_number(i) == 0) printf(\"%d\\n\", i);\n    }\n   }\n</code></pre>\n\n<p>Screenshot Here <a href=\"https://i.stack.imgur.com/4y0QP.png\" rel=\"nofollow noreferrer\">gcc 6.2.1</a></p>\n\n<pre><code>x=3.14159265359;\nfloat y=1.41421;\nint z=int(x);\nz=int(y);\n</code></pre>\n\n<p>Your error messages:</p>\n\n<pre><code>cfile.c:605:10: error: expected expression before \u2018int\u2019\n    int z=int(x);\n          ^~~\ncfile.c:606:6: error: expected expression before \u2018int\u2019\n    z=int(y);\n      ^~~\n</code></pre>\n"}, {"tags": ["python", "c", "struct"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1482300758, "post_id": 41256218, "comment_id": 69712736, "body": "any help <a href=\"http://stackoverflow.com/questions/7198388/accessing-bitfields-while-reading-writing-binary-data-structures\" title=\"accessing bitfields while reading writing binary data structures\">stackoverflow.com/questions/7198388/&hellip;</a> ?? possibly a dupe."}, {"owner": {"reputation": 369, "user_id": 4335727, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c797fe90e127fb464c21e3ecb993fa58?s=128&d=identicon&r=PG&f=1", "display_name": "jim ying", "link": "https://stackoverflow.com/users/4335727/jim-ying"}, "reply_to_user": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 1, "creation_date": 1482302221, "post_id": 41256218, "comment_id": 69713311, "body": "3q. I have seen it.  Now find a link maybe better, <a href=\"http://varx.org/wordpress/2016/02/03/bit-fields-in-python/\" rel=\"nofollow noreferrer\">varx.org/wordpress/2016/02/03/bit-fields-in-python</a>"}, {"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 0, "creation_date": 1482319466, "post_id": 41256218, "comment_id": 69723723, "body": "Just read the whole thing as an unsigned, then mask and shift. Like the linked article does. The portability of bit fields is questionable though."}], "owner": {"reputation": 369, "user_id": 4335727, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c797fe90e127fb464c21e3ecb993fa58?s=128&d=identicon&r=PG&f=1", "display_name": "jim ying", "link": "https://stackoverflow.com/users/4335727/jim-ying"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1403, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1482300493, "creation_date": 1482300493, "question_id": 41256218, "link": "https://stackoverflow.com/questions/41256218/python-how-to-pack-struct-with-bit-field-width", "title": "python how to pack struct with bit field width?", "body": "<pre><code>//c struct code with filed width:\n\n    struct{\n      unsigned int x:1;\n      unsigned int y:25;\n      unsigned int z:6;\n    };\n</code></pre>\n\n<p>Now I want to rewrite it in python, pack it and send to network,</p>\n\n<p>The package struct in python, can pack/unpack data types.</p>\n\n<p>such as:</p>\n\n<pre><code>struct.pack('!I10s',1,'hello')\n</code></pre>\n\n<p>But I don't know how to deal with struct with filed width as the c struct example. Any one know?</p>\n"}, {"tags": ["c", "data-structures", "tree"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482300630, "post_id": 41256089, "comment_id": 69712692, "body": "See <a href=\"http://stackoverflow.com/questions/597318/\">What are the benefits of a relative path such as <code>&quot;..&#47;include&#47;header.h&quot;</code> for a header?</a>. The implementation details should be hidden from the consumers of your code \u2014 it shouldn&#39;t matter whether it is a multi-walk tree or a LCRS tree that is used behind the scenes.  It matters for your tree implementation code, but not for the consumer code.  Writing a completely general purpose tree implementation probably isn&#39;t sensible.  Write one that meets your current requirements."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482300778, "post_id": 41256089, "comment_id": 69712742, "body": "You&#39;ll need functions to create a tree, destroy a tree, add an item, remove an item, various traversal operations (pre-order, in-order, post-order, BFS, etc), various search operations.  You&#39;ll need to consider whether you&#39;re dealing with generic items or with a specific item type \u2014 how are you going to do comparisons.  Do you have to parse the data in order to be able to add an item?  If so, how will that be done?  Adding a file path to a tree modelling a file system hierarchy is very different from a simple binary search tree.  What are you trying to handle?"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482301115, "post_id": 41256089, "comment_id": 69712875, "body": "@JonathanLeffler Actual code written, can be seen <a href=\"https://github.com/shamhub/Computing/tree/master/7_Tree/Rooted_tree/Rooted_tree_Implementation_c\" rel=\"nofollow noreferrer\">here</a>. It does not reflect the structure of the code in the query. The way code posted in the query is for simplicity  to get the intent. Do you think the structure of code in shared link looks fine?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482301563, "post_id": 41256089, "comment_id": 69713034, "body": "The code doesn&#39;t compile \u2014 it doesn&#39;t look good. It doesn&#39;t have header guards in place. It includes four superfluous headers. As the consumer, I need header guards around: <code>typedef struct Tree Tree; Tree *newTree(void); void insert(Tree *, void *item); void* delete(Tree *, void *item); void preOrder(Tree*);</code> except that the <code>preOrder()</code> function needs to know what to do when it visits a node, so it needs a function pointer to the &#39;visitor function&#39;, and I had to fix the prototype for <code>delete()</code> \u2014 adding the second argument and the semicolon.  Somewhere along the line you need a comparator."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482305830, "post_id": 41256089, "comment_id": 69715075, "body": "@JonathanLeffler Made the working changes <a href=\"https://github.com/shamhub/Computing/tree/master/7_Tree/Rooted_tree/Rooted_tree_Implementation_c\" rel=\"nofollow noreferrer\">here</a>, included header guard in <code>.h</code> files only"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482309388, "post_id": 41256089, "comment_id": 69716885, "body": "@JonathanLeffler am using rooted tree in a contract of state propagation tree"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482309471, "post_id": 41256089, "comment_id": 69716924, "body": "Multi walk tree for state propagation tree. LCRS tree for priority queue"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1482300593, "creation_date": 1482299891, "last_edit_date": 1482300593, "question_id": 41256089, "link": "https://stackoverflow.com/questions/41256089/list-of-operations-rooted-tree", "title": "List of operations - Rooted tree", "body": "<p>Here is the code directory structure,</p>\n\n<pre><code>$ ls\nlcrsImpl.c  multiWalkImpl.c  tree.h\n</code></pre>\n\n<p>For the below two rooted tree representations,</p>\n\n<pre><code>#include\"../../list/list.h\"\n\n#if defined(LCRS)\n  typedef struct SiblingTreeNode{\n    struct SiblingTreeNode *parent;\n    void *item;\n    struct SiblingTreeNode *firstChild;\n    struct SiblingTreeNode *nextSibling;\n  }Node;\n\n  typedef struct LCRSTree{\n    Node *root;\n    int size;\n  }Tree;\n\n#elif defined(MULTI_WALK)\n   typedef struct treeNode{\n    struct treeNode *parent;\n    void *item\n    List **childList;\n  }Node;\n\n  typedef struct multiWalkTree{\n    Node *root;\n    int size\n  }Tree;\n#else\n  #error \"Wrong representation \"\n#endif\n</code></pre>\n\n<hr>\n\n<p><code>Tree</code> abstraction can be re-used by other abstractions.</p>\n\n<p>Question:</p>\n\n<p>To write a <code>Tree</code> abstraction using two representations(mentioned above),</p>\n\n<p>As per the real world experience, What are the important(common) operations that need to be implemented on rooted tree? </p>\n\n<p>Can you provide the signature(function declaration) of those operations?</p>\n\n<p><em>Note - This would help me continue my implementation</em></p>\n"}, {"tags": ["c", "string", "memory-leaks"], "comments": [{"owner": {"reputation": 45460, "user_id": 1670129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32370783314a7efabe09b6cfadb11b12?s=128&d=identicon&r=PG&f=1", "display_name": "Igor Tandetnik", "link": "https://stackoverflow.com/users/1670129/igor-tandetnik"}, "edited": false, "score": 2, "creation_date": 1482299625, "post_id": 41256027, "comment_id": 69712358, "body": "Case 1 exhibits undefined behavior: you don&#39;t call <code>free()</code> on the same pointer that you got from <code>malloc()</code>. Whereas in case 2, you do."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1482299717, "post_id": 41256027, "comment_id": 69712387, "body": "1) <code>str = &quot;string&quot;;</code> It was overwritten with a pointer to a string literal."}, {"owner": {"reputation": 348, "user_id": 6025530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76903b2b126b59e3c8cafcd287317743?s=128&d=identicon&r=PG&f=1", "display_name": "nikniknik2016", "link": "https://stackoverflow.com/users/6025530/nikniknik2016"}, "edited": false, "score": 0, "creation_date": 1482299963, "post_id": 41256027, "comment_id": 69712484, "body": "case1. <code>str = &quot;string&quot;</code> - wrong because it is no copy string operation; must be <code>strcpy(str, &quot;string&quot;)</code> as in the case2"}, {"owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "reply_to_user": {"reputation": 348, "user_id": 6025530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76903b2b126b59e3c8cafcd287317743?s=128&d=identicon&r=PG&f=1", "display_name": "nikniknik2016", "link": "https://stackoverflow.com/users/6025530/nikniknik2016"}, "edited": false, "score": 0, "creation_date": 1482300047, "post_id": 41256027, "comment_id": 69712504, "body": "@nikniknik2016 std::string? It is C not C++."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 0, "creation_date": 1482301114, "post_id": 41256080, "comment_id": 69712874, "body": "yes i tried to free  that memory but i got munmap_chunk() error"}, {"owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "edited": false, "score": 1, "creation_date": 1482301244, "post_id": 41256080, "comment_id": 69712915, "body": "yes i tried to free  that memory but i got munmap_chunk() error and i got reason why it is happening so only those pointers can be free by free function which are return by malloc and its friend function that are calloc,realloc                                                                                                  thank u for your help"}], "tags": [], "owner": {"reputation": 517, "user_id": 7312355, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/57ce505140904fd60f4e0d002b9a842e?s=128&d=identicon&r=PG&f=1", "display_name": "599644", "link": "https://stackoverflow.com/users/7312355/599644"}, "is_accepted": false, "score": 2, "last_activity_date": 1482299858, "creation_date": 1482299858, "answer_id": 41256080, "question_id": 41256027, "link": "https://stackoverflow.com/questions/41256027/memory-leak-when-initialise-string/41256080#41256080", "title": "Memory leak when initialise string", "body": "<pre><code> str = (char*)malloc(10);\n str = \"string\"; &lt;-- You just lost the pointer to the malloced memory. ie. memory leak.\n free(str); &lt;-- Here you are trying to free the `\"string\"` itself. Not possible.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "is_accepted": true, "score": 3, "last_activity_date": 1482307423, "last_edit_date": 1482307423, "creation_date": 1482300159, "answer_id": 41256141, "question_id": 41256027, "link": "https://stackoverflow.com/questions/41256027/memory-leak-when-initialise-string/41256141#41256141", "title": "Memory leak when initialise string", "body": "<p>Both are not same. </p>\n\n<p>In this case, <code>strcpy(str, \"string\")</code> is correct way to copy the \"string\" to str. str is allocated then you free it. so no memory is leaking.</p>\n\n<p>In case of <code>str = \"string\"</code>, memory allocated to str will lost and it will cause memory leak. </p>\n"}, {"tags": [], "owner": {"reputation": 43502, "user_id": 377953, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hm9UN.jpg?s=128&g=1", "display_name": "taskinoor", "link": "https://stackoverflow.com/users/377953/taskinoor"}, "is_accepted": false, "score": 4, "last_activity_date": 1482300186, "creation_date": 1482300186, "answer_id": 41256143, "question_id": 41256027, "link": "https://stackoverflow.com/questions/41256027/memory-leak-when-initialise-string/41256143#41256143", "title": "Memory leak when initialise string", "body": "<p><code>str = \"string\";</code></p>\n\n<p>After this <code>str</code> points to different memory location(on many platforms it will be read only memory). So it no longer points to memory that you allocated via <code>malloc</code>. When you call <code>free(str)</code> you are trying to free some memory that you aren't suppose to. This is an undefined behavior. It may do nothing, or it may crash. And the malloced memory is being leaked.</p>\n\n<p><code>strcpy(str,\"string\");</code></p>\n\n<p>Here the string is copied to already allocated memory pointed by <code>str</code>. You own this memory, you copied data to it and then you free it. So there is no problem here.</p>\n\n<p>So the basic difference between the two cases is that in first case <code>str</code> points to a different location than the allocated one.</p>\n"}], "owner": {"reputation": 139, "user_id": 5561224, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5973048e8814a3a077e1e840b1dc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "Sanket Joshi", "link": "https://stackoverflow.com/users/5561224/sanket-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 1, "accepted_answer_id": 41256141, "answer_count": 3, "score": 1, "last_activity_date": 1482307423, "creation_date": 1482299574, "last_edit_date": 1482299808, "question_id": 41256027, "link": "https://stackoverflow.com/questions/41256027/memory-leak-when-initialise-string", "title": "Memory leak when initialise string", "body": "<p>Case 1 : I have written following c program and when I checked for memory leak I got memory leakage at this line <code>str = (char*)malloc(10);</code> even when I have written statement to free that memory</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char *str;\n    str = (char*)malloc(10);\n    str = \"string\";\n    printf(\"length : %ld\\n\",strlen(str));\n    free(str);\n    return 0;\n}\n</code></pre>\n\n<p>Case 2:</p>\n\n<p>When I replaced <code>str=\"string\"</code> with <code>strcpy()</code> there is no any leak why it is so?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nint main()\n{\n    char *str;\n    str = (char*)malloc(10);\n    strcpy(str,\"string\");\n    printf(\"length : %ld\\n\",strlen(str));\n    free(str);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "getchar"], "comments": [{"owner": {"reputation": 6951, "user_id": 3475381, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b6a1c5d19f4ae8c6a1dbf097487c96d7?s=128&d=identicon&r=PG&f=1", "display_name": "Gaurav Sehgal", "link": "https://stackoverflow.com/users/3475381/gaurav-sehgal"}, "edited": false, "score": 4, "creation_date": 1482298732, "post_id": 41255834, "comment_id": 69712015, "body": "After you see <code>I&#39;m waiting for a character:</code>, do you type in a character?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482298763, "post_id": 41255834, "comment_id": 69712029, "body": "No - it works fine - see <a href=\"http://ideone.com/AlgWkH\" rel=\"nofollow noreferrer\">ideone.com/AlgWkH</a>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1482298827, "post_id": 41255834, "comment_id": 69712045, "body": "try <code>printf(&quot;I&#39;m waiting for a character: &quot;);fflush(stdout);</code>"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482299111, "post_id": 41255834, "comment_id": 69712167, "body": "Notes: <code>int main()</code> is a deprecated signature. Use prototype-style declarations: <code>int main(void)</code> (for all functions, not just <code>main</code>). <code>return</code> is not a function, but a statement. Don&#39;t use parentheses around the argument, this can result in strange error messages for typos. The function-syle was used for K&amp;R C, today it is more of a bad habit."}, {"owner": {"reputation": 1404, "user_id": 1867076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SfVUT.jpg?s=128&g=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/1867076/prometheus"}, "edited": false, "score": 0, "creation_date": 1482303009, "post_id": 41255834, "comment_id": 69713672, "body": "First of all, you should change your <code>int c;</code> to <code>char c;</code>. Other than that, you can run your application with no problem at all."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1404, "user_id": 1867076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SfVUT.jpg?s=128&g=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/1867076/prometheus"}, "edited": false, "score": 1, "creation_date": 1482303073, "post_id": 41255834, "comment_id": 69713705, "body": "@Prometheus you are dead wrong."}, {"owner": {"reputation": 1404, "user_id": 1867076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SfVUT.jpg?s=128&g=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/1867076/prometheus"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1482303220, "post_id": 41255834, "comment_id": 69713778, "body": "because of ..? @n.m."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1404, "user_id": 1867076, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/SfVUT.jpg?s=128&g=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/1867076/prometheus"}, "edited": false, "score": 1, "creation_date": 1482303610, "post_id": 41255834, "comment_id": 69713965, "body": "@Prometheus <a href=\"http://stackoverflow.com/questions/18013167/why-must-the-variable-used-to-hold-getchars-return-value-be-declared-as-int\" title=\"why must the variable used to hold getchars return value be declared as int\">stackoverflow.com/questions/18013167/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482305744, "post_id": 41255834, "comment_id": 69715027, "body": "@4386427 Thanks for your response and screen shot of my code with your output."}, {"owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482305935, "post_id": 41255834, "comment_id": 69715141, "body": "@4386427 I took your code from your link and pasted it into both code::blocks and IDEone, however I AGAIN got the same output as per my OP. Why would the same piece of code work differently for you than it does for me?"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482306225, "post_id": 41255834, "comment_id": 69715304, "body": "On ideone: Did you remember to put an &#39; a&#39; into the &quot;input&quot; tab?"}, {"owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482307476, "post_id": 41255834, "comment_id": 69715895, "body": "@4386427 Sorry, can you please be more specific? I&#39;ve only been learning for one week :)"}, {"owner": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482309124, "post_id": 41255834, "comment_id": 69716730, "body": "At ideone there are an input tab and an output tab just below the code window. After writing the code, click the input tab and type the <code>a</code> the run the program"}, {"owner": {"reputation": 2048, "user_id": 4961259, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9b82c25cbde4d52888e6eccc44764b80?s=128&d=identicon&r=PG&f=1", "display_name": "Kami Kaze", "link": "https://stackoverflow.com/users/4961259/kami-kaze"}, "edited": false, "score": 1, "creation_date": 1482316868, "post_id": 41255834, "comment_id": 69722031, "body": "do you enter a character on your keyboard and then press enter when you run it  on your pc?"}, {"owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482350838, "post_id": 41255834, "comment_id": 69743190, "body": "@4386427 Thanks for your suggestion, I did what you said, it worked, but I&#39;m not satisfied enough to move on, something is still not right. Thanks for your help though! :)"}, {"owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "reply_to_user": {"reputation": 32303, "user_id": 4386427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d2d2716ce8bcf5967e7b3c00bd0095b5?s=128&d=identicon&r=PG&f=1", "display_name": "4386427", "link": "https://stackoverflow.com/users/4386427/4386427"}, "edited": false, "score": 0, "creation_date": 1482356506, "post_id": 41255834, "comment_id": 69746145, "body": "@4386427 Actually I&#39;ve come to realise that your response was answer I needed, thank you so much, I can now move one :)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5732970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b892be91856dd2bb85bcb5ac7f572b?s=128&d=identicon&r=PG&f=1", "display_name": "Jitendra", "link": "https://stackoverflow.com/users/5732970/jitendra"}, "is_accepted": false, "score": 1, "last_activity_date": 1482300510, "creation_date": 1482300510, "answer_id": 41256220, "question_id": 41255834, "link": "https://stackoverflow.com/questions/41255834/c-for-dummies-getchar-function-not-working/41256220#41256220", "title": "&#39;C for Dummies&#39; getchar() function not working", "body": "<p>Please enter any key, then 2nd printf will show the result. getchar() is expecting input from user, controller reach at 2nd line &amp; waiting for input.</p>\n"}], "owner": {"reputation": 1, "user_id": 7323838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dcfd9c94c29268947b2539c15fd60c0?s=128&d=identicon&r=PG&f=1", "display_name": "KylieSomething", "link": "https://stackoverflow.com/users/7323838/kyliesomething"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 758, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482302673, "creation_date": 1482298552, "last_edit_date": 1482298752, "question_id": 41255834, "link": "https://stackoverflow.com/questions/41255834/c-for-dummies-getchar-function-not-working", "title": "&#39;C for Dummies&#39; getchar() function not working", "body": "<p>I'm currently in the very early stages of learning C programming and am working my way through \"Beginning Programming with C for Dummies\" using Code::Blocks.\nThe first activity in Chapter 7, <em>Fetching characters with <code>getchar()</code></em>, asks us to copy the code exactly as it's presented in the book; see below:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()    \n{\n    int c;\n\n    printf(\"I'm waiting for a character: \");\n    c = getchar();\n    printf(\"I waited for the '%c' character.\\n\", c);\n    return (0);\n}\n</code></pre>\n\n<p>The output I get is:</p>\n\n<pre><code>I'm waiting for a character: \n</code></pre>\n\n<p>However according to the book, the output that I <em>should</em> be seeing is the character's ASCII code value. It then asks that I change the <code>%c</code> placeholder to <code>%d</code> to display the value, but still I get the same outcome as before. I could probably recite the code with my eyes closed I've checked it through that may times; I simply cannot see where I'm going wrong.</p>\n\n<p>Am I right in thinking that the <code>getchar()</code> function isn't being recognized? Or that the code isn't being read after the first <code>printf</code> statement? Any guidance is welcome as I don't want to move on until I've understood the problem.</p>\n"}, {"tags": ["c", "linux-kernel", "cross-compiling", "device"], "comments": [{"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 0, "creation_date": 1482298995, "post_id": 41255583, "comment_id": 69712122, "body": "can you post what is at /arch/mips/include/asm/mipsregs.h:871:33"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482305775, "post_id": 41255583, "comment_id": 69715041, "body": "For include a header under <code>include&#47;uapi</code>, one should use directive <code>#include &lt;uapi&#47;..&gt;</code>. So it is impossible to confuse this file with non-uapi one. As for type <code>u16</code>, for <i>mips</i> its definition is accessible with follow headers chain: <code>include&#47;linux&#47;types.h</code> - &gt; <code>include&#47;uapi&#47;linux&#47;types.h</code> -&gt; <code>arch&#47;mips&#47;include&#47;asm&#47;types.h</code> -&gt; <code>include&#47;asm-generic&#47;int-ll64.h</code>. Not sure why given definition is not available in your case. Please, provide complete error message (with chain of files, where error has been arised)."}, {"owner": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 0, "creation_date": 1482306901, "post_id": 41255583, "comment_id": 69715636, "body": "<b>u16</b> type is never declared by Linux headers included by user space(uapi) and for user space use <b>__u16</b> is used instead."}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 1676, "user_id": 3264809, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/d36a2da1d4a8b8336b4684eac4c9fee8?s=128&d=identicon&r=PG&f=1", "display_name": "Sumit Gemini", "link": "https://stackoverflow.com/users/3264809/sumit-gemini"}, "edited": false, "score": 0, "creation_date": 1482310684, "post_id": 41255583, "comment_id": 69717670, "body": "@SumitGemini: <b>u16</b> type is declared in <code>include&#47;asm-generic&#47;int-ll64.h</code>, which is <b>not</b> an <i>uapi</i>-header, thus it isn&#39;t used by user space. <i>uapi</i>-variant of this header (<code>include&#47;uapi&#47;asm-generic&#47;int-ll64.h</code>) doesn&#39;t contain definition of this type."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 1, "creation_date": 1482366517, "post_id": 41255583, "comment_id": 69749585, "body": "@Tsyvarev, their <i>Makefile</i> and command line to call compiler is probably wrong. They most likely are trying to compile it as a (user space) application. <b>u16</b> is internal type for Linux kernel. User space should use <b>__u16</b> instead."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 1, "creation_date": 1482366618, "post_id": 41255583, "comment_id": 69749622, "body": "@anbu, not enough context."}, {"owner": {"reputation": 51, "user_id": 5610474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/26d5ad23475b3d248a11aaf86772fc36?s=128&d=identicon&r=PG&f=1", "display_name": "anbu", "link": "https://stackoverflow.com/users/5610474/anbu"}, "reply_to_user": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "edited": false, "score": 0, "creation_date": 1482388969, "post_id": 41255583, "comment_id": 69755795, "body": "@Tsyvarev If I define &#39;unsigned short u16&#39; in header file arch/mips/include/uapi/asm/types.h, definition is available to driver. So, arch/include/asm/types.h able to include arch/mips/include/uapi/asm/types.h but not include/asm-generic/int-ll64.h ?"}, {"owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482392629, "post_id": 41255583, "comment_id": 69757623, "body": "anbu: I agree with @0andriy in that your <i>usage of headers</i> is <i>likely</i> <b>wrong</b>. Linux kernel is a complex thing, and it operates correctly only with proper usage. But information you provide is insufficient for give more detailed help. Please, <a href=\"https://stackoverflow.com/posts/41255583/edit\">edit</a> your question and include information I have asked in the first comment."}, {"owner": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482423576, "post_id": 41255583, "comment_id": 69777116, "body": "@anbu, <i>asm-generic</i> folder <b>is not</b> for direct use! You have to run <code>make ARCH=mips ...</code> to do this properly."}, {"owner": {"reputation": 51, "user_id": 5610474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/26d5ad23475b3d248a11aaf86772fc36?s=128&d=identicon&r=PG&f=1", "display_name": "anbu", "link": "https://stackoverflow.com/users/5610474/anbu"}, "reply_to_user": {"reputation": 3561, "user_id": 2511795, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30c869f55cbcf82a7bc4536d563daa0a?s=128&d=identicon&r=PG", "display_name": "0andriy", "link": "https://stackoverflow.com/users/2511795/0andriy"}, "edited": false, "score": 0, "creation_date": 1482842593, "post_id": 41255583, "comment_id": 69892725, "body": "@0andriy In mipsisa32-be-elf.inc file, given the path /kernel/include/uapi in -isystem. This helps to solve the above compilation issue."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5610474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/26d5ad23475b3d248a11aaf86772fc36?s=128&d=identicon&r=PG&f=1", "display_name": "anbu", "link": "https://stackoverflow.com/users/5610474/anbu"}, "is_accepted": true, "score": 0, "last_activity_date": 1482842755, "creation_date": 1482842755, "answer_id": 41345495, "question_id": 41255583, "link": "https://stackoverflow.com/questions/41255583/compiling-a-driver-for-mips-architecture-on-4-4-kernel/41345495#41345495", "title": "Compiling a driver for MIPS architecture on 4.4 kernel", "body": "<p>In mipsisa32-be-elf.inc file, given the path /kernel/include/uapi in -isystem compilation flag. This helps to solve the above compilation issue.</p>\n"}], "owner": {"reputation": 51, "user_id": 5610474, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/26d5ad23475b3d248a11aaf86772fc36?s=128&d=identicon&r=PG&f=1", "display_name": "anbu", "link": "https://stackoverflow.com/users/5610474/anbu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 41345495, "answer_count": 1, "score": 0, "last_activity_date": 1482842755, "creation_date": 1482297343, "last_edit_date": 1482304237, "question_id": 41255583, "link": "https://stackoverflow.com/questions/41255583/compiling-a-driver-for-mips-architecture-on-4-4-kernel", "title": "Compiling a driver for MIPS architecture on 4.4 kernel", "body": "<p>I am compiling a driver for MIPS architecture on 4.4 kernel. It seems compiler is not including </p>\n\n<pre><code>/linux-4.4.34/include/linux/types.h \n</code></pre>\n\n<p>but instead it includes </p>\n\n<pre><code>/linux-4.4.34/include/uapi/linux/types.h \n</code></pre>\n\n<p>Because of this I see below error.I did not include the path <code>/linux-4.4.34/include/uapi</code> in driver makefile.Could someone explain how can driver include the path <code>/include/linux</code> and not <code>/include/uapi/linux</code> ?</p>\n\n<pre><code>./arch/mips/include/asm/mipsregs.h:871:33: error: unknown type name 'u16'\n</code></pre>\n"}, {"tags": ["c", "avr"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "edited": false, "score": 0, "creation_date": 1482298489, "post_id": 41255575, "comment_id": 69711926, "body": "Thank you. Always something simple. Works great"}], "tags": [], "owner": {"reputation": 28373, "user_id": 4926357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f559694d3ca65b39220166b865276d?s=128&d=identicon&r=PG&f=1", "display_name": "A.S.H", "link": "https://stackoverflow.com/users/4926357/a-s-h"}, "is_accepted": true, "score": 4, "last_activity_date": 1482297593, "last_edit_date": 1482297593, "creation_date": 1482297291, "answer_id": 41255575, "question_id": 41255538, "link": "https://stackoverflow.com/questions/41255538/need-help-processing-char-strings-with-printf/41255575#41255575", "title": "Need help processing CHAR strings with printf", "body": "<p>You need to provide a buffer for your string.</p>\n\n<pre><code>char bt_string[256]; // &lt;-- or any size that you are sure will be enough for what you will put in.\n</code></pre>\n\n<p>eventually, for safety you can use <code>snpritf</code> to avoid any buffer overflow:</p>\n\n<pre><code>#define MAX_BT_STRING 256\nchar bt_string[MAX_BT_STRING];\nsnprintf(bt_string, MAX_BT_STRING,\"  Error: cmd=%02hX, res=%02hX\\n\", CMD_SEND_CID, res);\nbluetooth_println(bt_string);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "edited": false, "score": 0, "creation_date": 1482298689, "post_id": 41255773, "comment_id": 69712000, "body": "thank you for seeing that. It was a typo when entering the question."}], "tags": [], "owner": {"reputation": 2903, "user_id": 3824053, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/uso1K.png?s=128&g=1", "display_name": "Douglas Su", "link": "https://stackoverflow.com/users/3824053/douglas-su"}, "is_accepted": false, "score": 1, "last_activity_date": 1482298631, "last_edit_date": 1495539944, "creation_date": 1482298232, "answer_id": 41255773, "question_id": 41255538, "link": "https://stackoverflow.com/questions/41255538/need-help-processing-char-strings-with-printf/41255773#41255773", "title": "Need help processing CHAR strings with printf", "body": "<p><code>char *str</code> and <code>char str[]</code> are distinctly different. Check <a href=\"https://stackoverflow.com/q/1704407/3824053\">this question</a> for more details.</p>\n\n<p>In your problem, you declared bt_string as <code>const char *bt_string = \"test\"</code>, where <code>bt_string</code> is pointer which points to the first char in string \"test\". This string has a size of 5 bytes(don't forget the terminator \\0);</p>\n\n<p>In the next step: </p>\n\n<pre><code>sprintf(bt_string, \"  Error: cmd=%02hX, res=%02hX\\n\", CMD_SEND_CID, res);\n</code></pre>\n\n<p>You dump more than 5 bytes to bt_string which only has 5 bytes available space. The parts beyond 5 bytes will overwrite the contents after bt_string, which may lead to some serious situation or nothing, it depends on what is followed.</p>\n\n<p>To settle this problem, you have to allocate enough memory space:</p>\n\n<ol>\n<li>allocate on stack as A.S.H answered. the content is determined after function finished.</li>\n<li>allocate via malloc;</li>\n<li>use static key word to force the string stored either in BSS section or DATA section.</li>\n</ol>\n"}], "owner": {"reputation": 39, "user_id": 6727609, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9e7c4ad3c34cfa2a3df8c7d901733bb1?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie", "link": "https://stackoverflow.com/users/6727609/eddie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 41255575, "answer_count": 2, "score": -1, "last_activity_date": 1482298713, "creation_date": 1482297114, "last_edit_date": 1482298713, "question_id": 41255538, "link": "https://stackoverflow.com/questions/41255538/need-help-processing-char-strings-with-printf", "title": "Need help processing CHAR strings with printf", "body": "<p>I'm using softserial to communicate with a bluetooth modem and I am pushing strings to the serial by using the following code:</p>\n\n<pre><code>char bt_string = \"test\";\nbluetooth_println(bt_string);\n</code></pre>\n\n<p>I need to be able to replace the string with</p>\n\n<pre><code>printf(\"  Error: cmd=%02hX, res=%02hX\\n\", CMD_SEND_CID, res);\n</code></pre>\n\n<p>I have tried the following code</p>\n\n<pre><code>char bt_string;\nsprintf(bt_string, \"  Error: cmd=%02hX, res=%02hX\\n\", CMD_SEND_CID, res);\nbluetooth_println(bt_string);\n</code></pre>\n\n<p>But it fails to output anything. I'm obviously misunderstanding something. Thanks for any help.</p>\n"}, {"tags": ["c", "shared-libraries", "exit"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 4, "creation_date": 1482296643, "post_id": 41255423, "comment_id": 69711311, "body": "Yes it will exit the whole program."}, {"owner": {"reputation": 1667, "user_id": 4490542, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/8925b87f1bc4c6a3bc6956628c9d3b6f?s=128&d=identicon&r=PG&f=1", "display_name": "e.jahandar", "link": "https://stackoverflow.com/users/4490542/e-jahandar"}, "edited": false, "score": 3, "creation_date": 1482296672, "post_id": 41255423, "comment_id": 69711327, "body": "Yes, the shared libraries are executed in context of your process, therefore exiting from a shared library will affect whole process"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482299411, "post_id": 41255423, "comment_id": 69712261, "body": "Where is the library function called from?"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482300081, "post_id": 41255423, "comment_id": 69712513, "body": "See <a href=\"http://stackoverflow.com/questions/31501142/should-we-use-exit-in-c\">Should we use <code>exit()</code> in C</a> \u2014 and there&#39;s an analogous <a href=\"http://stackoverflow.com/questions/30250934/how-to-end-c-code\">How to end C++ code</a>.  Both have cross-references to related questions."}, {"owner": {"reputation": 17713, "user_id": 226648, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/3196df423fd95dc4fce7dfadb8ec9953?s=128&d=identicon&r=PG", "display_name": "el.pescado", "link": "https://stackoverflow.com/users/226648/el-pescado"}, "edited": false, "score": 0, "creation_date": 1482303235, "post_id": 41255423, "comment_id": 69713791, "body": "You can&#39;t exit part of code. You can only exit whole process."}], "answers": [{"tags": [], "owner": {"reputation": 546, "user_id": 4215019, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3d2e423ecf4e280e028136509fe47fe3?s=128&d=identicon&r=PG&f=1", "display_name": "leuage", "link": "https://stackoverflow.com/users/4215019/leuage"}, "is_accepted": true, "score": 2, "last_activity_date": 1482306275, "creation_date": 1482306275, "answer_id": 41257579, "question_id": 41255423, "link": "https://stackoverflow.com/questions/41255423/if-exit0-of-shared-library-exits-program-too/41257579#41257579", "title": "if exit(0) of shared library exits program too?", "body": "<p>Yes it  terminates the calling process immediately.SIGCHLD signal will be  send to process which  inherited by process 1 or init.</p>\n"}], "owner": {"reputation": 143, "user_id": 5532096, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203982417439699/picture?type=large", "display_name": "Kalrav J Parsana", "link": "https://stackoverflow.com/users/5532096/kalrav-j-parsana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 41257579, "answer_count": 1, "score": 3, "last_activity_date": 1482306275, "creation_date": 1482296520, "last_edit_date": 1482304961, "question_id": 41255423, "link": "https://stackoverflow.com/questions/41255423/if-exit0-of-shared-library-exits-program-too", "title": "if exit(0) of shared library exits program too?", "body": "<p>I have one program that uses shared library. In shared library, error case they have written exit(0). So if that function is called then exit(0) will be executed of shared library. </p>\n\n<p>Will it exit my program too ?</p>\n"}, {"tags": ["c", "memory"], "answers": [{"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 0, "last_activity_date": 1482297136, "creation_date": 1482297136, "answer_id": 41255544, "question_id": 41255305, "link": "https://stackoverflow.com/questions/41255305/is-top-displaying-wrong-result-after-calling-malloc-trim/41255544#41255544", "title": "Is top displaying wrong result after calling malloc_trim()?", "body": "<p>According to <a href=\"https://linux.die.net/man/3/malloc_trim\" rel=\"nofollow noreferrer\">its docs</a>,</p>\n\n<blockquote>\n  <p>The <code>malloc_trim()</code> function <strong>attempts</strong> to release free memory <strong>at the top of the heap</strong></p>\n</blockquote>\n\n<p>(emphasis added).</p>\n\n<p>It cannot release memory that has allocated memory above it on the heap, and therefore it does not guarantee to return anything to the system.  I'm inclined to think that little, if any, of the memory you want to release is at the top of the heap, though it's also possible that the memory is not actually free.</p>\n\n<p>Note also that <code>malloc_trim()</code> is a GNU extension.</p>\n"}], "owner": {"reputation": 221, "user_id": 7017891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/24d64160e3aa5677ba9502cf30802e2c?s=128&d=identicon&r=PG&f=1", "display_name": "CharlesLiuChina", "link": "https://stackoverflow.com/users/7017891/charlesliuchina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 41255544, "answer_count": 1, "score": 0, "last_activity_date": 1482297136, "creation_date": 1482295900, "question_id": 41255305, "link": "https://stackoverflow.com/questions/41255305/is-top-displaying-wrong-result-after-calling-malloc-trim", "title": "Is top displaying wrong result after calling malloc_trim()?", "body": "<p>I <code>free</code> memory about <code>3G</code>and then use <code>malloc_trim(0)</code> to return heap memory to system and watching resident memory usage with <code>top</code>. But the resident memory doesn't decrease. These memory is <code>malloc()</code>ed every time for about <code>54K</code> which is less than <code>128K</code>. And it is <code>malloc()</code>ed with <code>brk()</code> system call.</p>\n"}, {"tags": ["c", "strlen"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482295291, "post_id": 41255186, "comment_id": 69710899, "body": "Welcome to stack overflow. Please take a <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and how to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Don&#39;t post picture when you can post text and please avoid &quot;Need help&quot;, &quot;I have a little problem, with this and I wanted to know if any of you could fix it will be very appreciated !&quot;, &quot;Hi everyone today&quot; and never do this &quot;If you can help me to fix I will donate over paypal :)&quot;. Thanks."}, {"owner": {"reputation": 4328, "user_id": 920069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd39f0db1f22e1314746491df063602a?s=128&d=identicon&r=PG", "display_name": "Retired Ninja", "link": "https://stackoverflow.com/users/920069/retired-ninja"}, "edited": false, "score": 0, "creation_date": 1482295429, "post_id": 41255186, "comment_id": 69710939, "body": "So, skip printing every other one."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 1, "creation_date": 1482300917, "post_id": 41255186, "comment_id": 69712799, "body": "Do not destroy your question after you have answers.  That is absolutely not kosher on SO."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482579017, "post_id": 41255186, "comment_id": 69828956, "body": "You can&#39;t ask for help and try to hide your question after. Your new edit don&#39;t change the meaning of your question. But this is really suspicious. If you put some private information you can read this <a href=\"https://stackexchange.com/legal/terms-of-service#15CopyrightPolicy\">stackexchange.com/legal/terms-of-service#15CopyrightPolicy</a>."}], "answers": [{"tags": [], "owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "is_accepted": false, "score": 3, "last_activity_date": 1482296075, "last_edit_date": 1482296075, "creation_date": 1482295752, "answer_id": 41255285, "question_id": 41255186, "link": "https://stackoverflow.com/questions/41255186/need-help-for-strlen/41255285#41255285", "title": "Need help for strlen", "body": "<p>Your XOR operation is encrypting the static string literal on every odd iteration and then decrypting it on ever even iteration.  Use a tmp buffer to avoid modifying the string literal.  I don't recall the rules, but I think that attempting to modify the memory contents of a string literal is entering <em>undefined behavior</em> territory.  So it's best to avoid this type of coding to begin with.</p>\n\n<p>Change this set of code:</p>\n\n<pre><code>char *encMess = \",Z8J'Z$/3J.8Z:J&amp;Z((3J-ZJ9?(9)8#(/J&gt;ZJ'3J3Z?&gt;?(/PJ9!3+)8Z\";\n\nfor (int i = 0; i &lt; strlen(encMess); i++)\n{\n    encMess[i] ^= key;\n}\n\nchar buf[64];\nsnprintf(buf, sizeof(buf), \"~r~%s\", encMess);\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>char tmp[64];\nconst char *encMess = \",Z8J'Z$/3J.8Z:J&amp;Z((3J-ZJ9?(9)8#(/J&gt;ZJ'3J3Z?&gt;?(/PJ9!3+)8Z\";\n\nstrcpy(tmp, encMess, 64);\nsize_t len = strlen(encMess);\n\nfor (int i = 0; i &lt; len; i++)\n{\n    tmp[i] ^= key;\n}\n\nchar buf[64];\nsnprintf(buf, sizeof(buf), \"~r~%s\", tmp);\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7323813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e557ac308cc81504a0228cc42d0abd?s=128&d=identicon&r=PG&f=1", "display_name": "Kervin Smith", "link": "https://stackoverflow.com/users/7323813/kervin-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 2, "closed_date": 1482300942, "answer_count": 1, "score": -5, "last_activity_date": 1482478543, "creation_date": 1482294957, "last_edit_date": 1482478543, "question_id": 41255186, "link": "https://stackoverflow.com/questions/41255186/need-help-for-strlen", "closed_reason": "Needs details or clarity", "title": "Need help for strlen", "body": "<p>I have a problem, with this and I wanted to know if any of you could fix it will be very appreciated!</p>\n\n<p>I am trying to encrypt a message to send to people in my game</p>\n\n<p><strong>Problem:</strong> When I try to send my message the 1st time gonna works and show the text on Letter and the second time is gonna show the encrypted text and I don't want people see that</p>\n\n<p><code>(\"ZFDKWEK,CSJ,$MS(,,,)\")</code></p>\n\n<pre><code>if (MessageEnc)\n                    {\n                    if (GET_GAME_TIMER() &gt;= destroy_tick2){\n                       destroy_tick2 = GET_GAME_TIMER() + 82000;\n                        int i = 0;\n                        for (i = 0;i&lt;18;i++)\n                        {\n                        if (i == PlayerId()) continue;\n                        int Handle = GetPlayerHandle(i);\n                        if(!DoesEntityExist(Handle)) continue;\n                        char key = 'j'; //Key\n                        char *encMess = \"ZFDKWEK,CSJ,$MS(,,,)\";\n\n                        for (int i = 0; i &lt; strlen(encMess); i++)\n                        {\n                            encMess[i] ^= key;\n                        }\n                        char buf[64];\n                    snprintf(buf, sizeof(buf), \"~r~%s\", encMess);\n                    NETWORK::NETWORK_HANDLE_FROM_PLAYER(i,  &amp;networkHandle, 13);\n                    NETWORK::NETWORK_SEND_TEXT_MESSAGE(buf, &amp;networkHandle);    \n                    printf(encMess);                        \n                    }\n                    }\n                    }\n</code></pre>\n"}, {"tags": ["c"], "owner": {"reputation": 11, "user_id": 7315914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5126805a3c0f1a20ea571bf718972170?s=128&d=identicon&r=PG&f=1", "display_name": "mgw2016", "link": "https://stackoverflow.com/users/7315914/mgw2016"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482294980, "creation_date": 1482294575, "last_edit_date": 1482294980, "question_id": 41255122, "link": "https://stackoverflow.com/questions/41255122/obtain-a-real-time-audio-output-from-a-speaker", "title": "Obtain a real time Audio output from a speaker", "body": "<p>I'm currently editing an example code to get the output sound from a speaker.</p>\n\n<p>The input is given from a microphone. </p>\n\n<p>The process is expected to be done in real time.</p>\n\n<p>Can someone please help to change this code to give the expected output?</p>\n\n<p>This code is originally designed to output a given sound file.</p>\n\n<pre><code>#include \"stdio.h\"\n#include \"usbstk5505.h\"\n#include \"usbstk5505_i2s.h\"\n#include \"csl_i2s.h\"\n\nextern Int16 AIC3204_rset( Uint16 regnum, Uint16 regval);\n\n/*\n *\n *  AIC3204 Loop\n *      Loops audio from LINE IN to LINE OUT\n *\n */\nInt16 aic3204_loop_linein( )\n{\nInt16 sec, msec;\nInt16 sample, data1, data2;\n\n/* Configure AIC3204 */\nAIC3204_rset( 0, 0 );      // Select page 0\nAIC3204_rset( 1, 1 );      // Reset codec\nAIC3204_rset( 0, 1 );      // Select page 1\nAIC3204_rset( 1, 8 );      // Disable crude AVDD generation from DVDD\nAIC3204_rset( 2, 1 );      // Enable Analog Blocks, use LDO power\nAIC3204_rset( 0, 0 );\n\n/* PLL and Clocks config and Power Up  */\nAIC3204_rset( 27, 0x0d );  // BCLK and WCLK are set as o/p; AIC3204(Master)\nAIC3204_rset( 28, 0x00 );  // Data ofset = 0\nAIC3204_rset( 4, 3 );      // PLL setting: PLLCLK &lt;- MCLK, CODEC_CLKIN &lt;-PLL CLK\nAIC3204_rset( 6, 7 );      // PLL setting: J=7\nAIC3204_rset( 7, 0x06 );   // PLL setting: HI_BYTE(D=1680)\nAIC3204_rset( 8, 0x90 );   // PLL setting: LO_BYTE(D=1680)\nAIC3204_rset( 30, 0x88 );  // For 32 bit clocks per frame in Master mode ONLY\n                           // BCLK=DAC_CLK/N =(12288000/8) = 1.536MHz = 32*fs\nAIC3204_rset( 5, 0x91 );   // PLL setting: Power up PLL, P=1 and R=1\nAIC3204_rset( 13, 0 );     // Hi_Byte(DOSR) for DOSR = 128 decimal or 0x0080 DAC oversamppling\nAIC3204_rset( 14, 0x80 );  // Lo_Byte(DOSR) for DOSR = 128 decimal or 0x0080\nAIC3204_rset( 20, 0x80 );  // AOSR for AOSR = 128 decimal or 0x0080 for decimation filters 1 to 6\nAIC3204_rset( 11, 0x82 );  // Power up NDAC and set NDAC value to 2\nAIC3204_rset( 12, 0x87 );  // Power up MDAC and set MDAC value to 7\nAIC3204_rset( 18, 0x87 );  // Power up NADC and set NADC value to 7\nAIC3204_rset( 19, 0x82 );  // Power up MADC and set MADC value to 2\n\n/* DAC ROUTING and Power Up */\nAIC3204_rset( 0, 1 );      // Select page 1\nAIC3204_rset( 0x0c, 8 );   // LDAC AFIR routed to HPL\nAIC3204_rset( 0x0d, 8 );   // RDAC AFIR routed to HPR\nAIC3204_rset( 0, 0 );      // Select page 0\nAIC3204_rset( 64, 2 );     // Left vol=right vol\nAIC3204_rset( 65, 0 );     // Left DAC gain to 0dB VOL; Right tracks Left\nAIC3204_rset( 63, 0xd4 );  // Power up left,right data paths and set channel\nAIC3204_rset( 0, 1 );      // Select page 1\nAIC3204_rset( 0x10, 00 );  // Unmute HPL , 0dB gain\nAIC3204_rset( 0x11, 00 );  // Unmute HPR , 0dB gain\nAIC3204_rset( 9, 0x30 );   // Power up HPL,HPR\nAIC3204_rset( 0, 0 );      // Select page 0\nUSBSTK5505_wait( 100 );    // wait\n\n/* ADC ROUTING and Power Up */\nAIC3204_rset( 0, 1 );      // Select page 1\nAIC3204_rset( 0x34, 0x30 );// STEREO 1 Jack\n                           // IN2_L to LADC_P through 40 kohm\nAIC3204_rset( 0x37, 0x30 );// IN2_R to RADC_P through 40 kohmm\nAIC3204_rset( 0x36, 3 );   // CM_1 (common mode) to LADC_M through 40 kohm\nAIC3204_rset( 0x39, 0xc0 );// CM_1 (common mode) to RADC_M through 40 kohm\nAIC3204_rset( 0x3b, 0 );   // MIC_PGA_L unmute\nAIC3204_rset( 0x3c, 0 );   // MIC_PGA_R unmute\nAIC3204_rset( 0, 0 );      // Select page 0\nAIC3204_rset( 0x51, 0xc0 );// Powerup Left and Right ADC\nAIC3204_rset( 0x52, 0 );   // Unmute Left and Right ADC\nAIC3204_rset( 0, 0 );    \nUSBSTK5505_wait( 100 );    // Wait\n\n/* Initialize I2S */\nUSBSTK5505_I2S_init();\n\n/* Play Tone */\nfor ( sec = 0 ; sec &lt; 5 ; sec++ )\n{\n    for ( msec = 0 ; msec &lt; 1000 ; msec++ )\n    {\n        for ( sample = 0 ; sample &lt; 48 ; sample++ )\n        {\n            /* Read 16-bit left channel Data */\n            USBSTK5505_I2S_readLeft(&amp;data1);\n\n            /* Read 16-bit right channel Data */\n            USBSTK5505_I2S_readRight(&amp;data2);\n\n            /* Write 16-bit left channel Data */\n            USBSTK5505_I2S_writeLeft(data1);\n\n            /* Write 16-bit right channel Data */\n            USBSTK5505_I2S_writeRight(data2);\n        }\n    }\n}\nUSBSTK5505_I2S_close();  // Disble I2S\nAIC3204_rset( 1, 1 );    // Reset codec\n\nreturn 0;\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["c", "hashmap", "hashtable"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1482293988, "post_id": 41254971, "comment_id": 69710539, "body": "Macros are a mechanism for repeating <i>code</i>.  They are not data structures.  It is unlikely that you can implement a general-purpose hash table without relying on some kind of dynamic memory allocation."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482294066, "post_id": 41254971, "comment_id": 69710558, "body": "Additionally, that a data structure contains pointers says nothing whatever about dynamic allocation."}, {"owner": {"reputation": 91, "user_id": 1666515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd34ea358abd3fe9e8d956485aa1068a?s=128&d=identicon&r=PG", "display_name": "mctwynne", "link": "https://stackoverflow.com/users/1666515/mctwynne"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482294295, "post_id": 41254971, "comment_id": 69710613, "body": "@JohnBollinger Your first point makes sense. If you take a look at the link I posted you&#39;ll see what I meant by that. Re: pointers...I meant that since it contains pointers, if you try to add an item to the map without dynamic allocation it will be invalid if you attempt to use that map outside the function those items are in, correct?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482294303, "post_id": 41254971, "comment_id": 69710616, "body": "Well, it&#39;s possible but not without limitation and a lot of tricks."}, {"owner": {"reputation": 91, "user_id": 1666515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd34ea358abd3fe9e8d956485aa1068a?s=128&d=identicon&r=PG", "display_name": "mctwynne", "link": "https://stackoverflow.com/users/1666515/mctwynne"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482294525, "post_id": 41254971, "comment_id": 69710672, "body": "@Stargateur Thanks a lot! That&#39;s what I thought, but being relatively new to C I wasn&#39;t sure if I was missing something obvious that someone could point out to me. Cheers!"}, {"owner": {"reputation": 91, "user_id": 1666515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd34ea358abd3fe9e8d956485aa1068a?s=128&d=identicon&r=PG", "display_name": "mctwynne", "link": "https://stackoverflow.com/users/1666515/mctwynne"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482294710, "post_id": 41254971, "comment_id": 69710714, "body": "@JohnBollinger Is my assumption about pointers in the previous comment correct?"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482294842, "post_id": 41254971, "comment_id": 69710746, "body": "@blackspirerider Possible don&#39;t mean that I will recommend it. C is not design to do that. You will have overhead and a lot of bug issue. Maybe you should try to do a generic linked list before try this."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482295059, "post_id": 41254971, "comment_id": 69710819, "body": "@blackspirerider, the need for dynamic allocation, if it exists, follows from how you intend to use the hash table.  It does not derive from whether the data structure with which you implement the hash table contains pointers."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482295143, "post_id": 41254971, "comment_id": 69710852, "body": "@blackspirerider, you are correct, however, that automatic variables do not survive the return of the function call in which they are declared.  If you want an object that can do so then it must be dynamically allocated."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1482296164, "post_id": 41254971, "comment_id": 69711152, "body": "Overall, my point is that what you present as two different approaches are non-apposite.  Very likely, your example pointer-based implementation uses a data structure containing pointers, similar to the one you present as an alternative.  You just don&#39;t manipulate it directly in that case.  You might even find that the macros perform dynamic memory management.  You&#39;re comparing apples and architecture."}, {"owner": {"reputation": 91, "user_id": 1666515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd34ea358abd3fe9e8d956485aa1068a?s=128&d=identicon&r=PG", "display_name": "mctwynne", "link": "https://stackoverflow.com/users/1666515/mctwynne"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482297445, "post_id": 41254971, "comment_id": 69711578, "body": "@JohnBollinger, thanks a lot for taking the time to explain that! I see where my assumptions started to break down."}, {"owner": {"reputation": 81087, "user_id": 104458, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/cc46b8a10ecb92e61aaeb1efe436a0c8?s=128&d=identicon&r=PG", "display_name": "selbie", "link": "https://stackoverflow.com/users/104458/selbie"}, "edited": false, "score": 0, "creation_date": 1482299646, "post_id": 41254971, "comment_id": 69712364, "body": "Consider taking a look at the glib hash table.  It&#39;s there for the taking. <a href=\"https://github.com/GNOME/glib/blob/master/glib/ghash.c\" rel=\"nofollow noreferrer\">github.com/GNOME/glib/blob/master/glib/ghash.c</a>"}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1482319659, "post_id": 41254971, "comment_id": 69723828, "body": "A <i>generic</i> hashtable in C is a bad idea. The <i>neat</i> implementation will require function pointers, which are slow, since these functions cannot be inlined. To allow inlining of functions you&#39;ll either have to write the code manually, or use a code generator, or macros. Which can get messy."}], "answers": [{"comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1482294317, "post_id": 41255053, "comment_id": 69710622, "body": "I&#39;m not sure I follow you.  Are your examples supposed to be presenting members of a struct?  If so, they don&#39;t work."}, {"owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1482295260, "post_id": 41255053, "comment_id": 69710885, "body": "That&#39;s why I didn&#39;t put them in a <code>struct</code> :) You can&#39;t define the struct this way, since the lengths of fields are not known at compile time. (because C doesn&#39;t have generic types!) You can fake it though by allocating the right size yourself and filling out the fields manually. You can also help yourself by making only the lengths a struct and casting the beginning of the allocated memory to that struct."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 2, "creation_date": 1482295748, "post_id": 41255053, "comment_id": 69711029, "body": "Well, C structs can have flexible array members (at most one each), so your assertion is not quite correct.  But in any case, now I&#39;m <i>sure</i> I don&#39;t follow what you&#39;re actually suggesting, or how it serves the OP&#39;s objective better than the alternatives he presented."}], "tags": [], "owner": {"reputation": 30697, "user_id": 31667, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/082b069c287878a1bd5731f44c8f10e7?s=128&d=identicon&r=PG", "display_name": "viraptor", "link": "https://stackoverflow.com/users/31667/viraptor"}, "is_accepted": false, "score": 1, "last_activity_date": 1482295283, "last_edit_date": 1482295283, "creation_date": 1482294186, "answer_id": 41255053, "question_id": 41254971, "link": "https://stackoverflow.com/questions/41254971/generic-hashtable-in-c/41255053#41255053", "title": "Generic hashtable in C", "body": "<p>C does not have generic data types, so what you want to do (no extra allocations and no <code>void*</code> casting) is not really possible. You can use macros to generate the right data functions/structs on the fly, but you're trying to avoid macros as well.</p>\n\n<p>So you need to give up at least one of your ideas.</p>\n\n<p>You could have a generic data structure without extra allocations by allocating something like:</p>\n\n<pre><code>size_t key_len;\nsize_t val_len;\nchar key[];\nchar val[];\n</code></pre>\n\n<p>in one go and then handing out either void pointers, or adding an api for each specific type.</p>\n\n<p>Alternatively, if you have a limited number of types you need to handle, you could also tag the value with the right one so now each entry contains:</p>\n\n<pre><code>size_t key_len;\nsize_t val_len;\nint val_type;\nchar key[];\nchar val[];\n</code></pre>\n\n<p>but in the API at least you can verify that the requested type is the right one.</p>\n\n<p>Otherwise, to make everything generic, you're left with either macros, or changing the language.</p>\n"}, {"tags": [], "owner": {"reputation": 9740, "user_id": 1459996, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/df2798299346f952d526d49a27fbde4e?s=128&d=identicon&r=PG", "display_name": "Kirill Kobelev", "link": "https://stackoverflow.com/users/1459996/kirill-kobelev"}, "is_accepted": false, "score": 2, "last_activity_date": 1482298143, "last_edit_date": 1482298143, "creation_date": 1482296415, "answer_id": 41255400, "question_id": 41254971, "link": "https://stackoverflow.com/questions/41254971/generic-hashtable-in-c/41255400#41255400", "title": "Generic hashtable in C", "body": "<p>C does not provide what you need directly, nevertheless you may want to do something like this:</p>\n\n<p>Imagine that your hash table is a fixed size array of double linked lists and it is OK that items are always allocated/destroyed on the application layer. These conditions will not work for every case, but in many cases they will. Then you will have these data structures and sketches of functions and protototypes:</p>\n\n<pre><code>struct HashItemCore\n{\n    HashItemCore  *m_prev;\n    HashItemCore  *m_next;\n};\n\nstruct HashTable\n{\n    HashItemCore  m_data[256];    // This is actually array of circled\n                                  // double linked lists.\n    int     (*GetHashValue)(HashItemCore *item);\n    bool    (*CompareItems)(HashItemCore *item1, HashItemCore *item2);\n    void    (*ReleaseItem)(HashItemCore *item);\n};\n\nvoid  InitHash(HashTable *table)\n{\n    // Ensure that user provided the callbacks.\n    assert(table-&gt;GetHashValue != NULL &amp;&amp; table-&gt;CompareItems != NULL &amp;&amp; table-&gt;ReleaseItem != NULL);\n\n    // Init all double linked lists. Pointers of empty list should point to themselves.\n    for (int i=0; i&lt;256; ++i)\n       table-&gt;m_data.m_prev = table-&gt;m_data.m_next = table-&gt;m_data+i;\n}\n\nvoid  AddToHash(HashTable *table, void *item);\nvoid *GetFromHash(HashTable *table, void *item);\n....\nvoid *ClearHash(HashTable *table);\n</code></pre>\n\n<p>In these functions you need to implement the logic of the hash table. While working they will be calling user defined callbacks to find out the index of the slot and if items are identical or not.</p>\n\n<p>The users of this table should define their own structures and callback functions for every pair of types that they want to use:</p>\n\n<pre><code>struct HashItemK1V1\n{\n     HashItemCore m_core;\n     K1 key;\n     V1 value;\n};\n\nint CalcHashK1V1(void *p)\n{\n     HashItemK1V1 *param  = (HashItemK1V1*)p;\n     // App code.\n}\n\nbool CompareK1V1(void *p1, void *p2)\n{\n     HashItemK1V1 *param1  = (HashItemK1V1*)p1;\n     HashItemK1V1 *param2  = (HashItemK1V1*)p2;\n     // App code.\n}\n\nvoid FreeK1V1(void *p)\n{\n     HashItemK1V1 *param  = (HashItemK1V1*)p;\n     // App code if needed.\n     free(p);\n}\n</code></pre>\n\n<p>This approach will not provide type safety because items will be passed around as  void pointers assuming that every application structure starts with <code>HashItemCore</code> member. This will be sort of hand made polymorphysm. This is maybe not perfect, but this will work.</p>\n\n<p>I implemented this approach in C++ using templates. But if you will strip out all fancies of C++, in the nutshell it will be exactly what I described above. I used my table in multiple projects and it worked like charm.</p>\n"}, {"tags": [], "owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "is_accepted": false, "score": 2, "last_activity_date": 1482320262, "creation_date": 1482320262, "answer_id": 41261941, "question_id": 41254971, "link": "https://stackoverflow.com/questions/41254971/generic-hashtable-in-c/41261941#41261941", "title": "Generic hashtable in C", "body": "<p>A generic hashtable in C is a bad idea.</p>\n\n<ul>\n<li>a <em>neat</em> implementation will require function pointers, which are slow, since these functions cannot be inlined (the general case will need at least two function calls <em>per hop</em>: one to compute the hash value and one for the final compare)</li>\n<li>to allow inlining of functions you'll either have to\n\n<ul>\n<li>write the code manually</li>\n<li>or use a code generator</li>\n<li>or macros. Which can get messy</li>\n</ul></li>\n</ul>\n\n<p>IIRC, the linux kernel uses macros to create and maintain (some of?) its hashtables.</p>\n"}], "owner": {"reputation": 91, "user_id": 1666515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd34ea358abd3fe9e8d956485aa1068a?s=128&d=identicon&r=PG", "display_name": "mctwynne", "link": "https://stackoverflow.com/users/1666515/mctwynne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2606, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1482320262, "creation_date": 1482293559, "last_edit_date": 1482295196, "question_id": 41254971, "link": "https://stackoverflow.com/questions/41254971/generic-hashtable-in-c", "title": "Generic hashtable in C", "body": "<p>I'm trying to create a generic hash table in C. I've read a few different implementations, and came across a couple of different approaches.</p>\n\n<p>The first is to use macros like this: <a href=\"http://attractivechaos.awardspace.com/khash.h.html\" rel=\"nofollow noreferrer\">http://attractivechaos.awardspace.com/khash.h.html</a></p>\n\n<p>And the second is to use a struct with 2 void pointers like this:</p>\n\n<pre><code>struct hashmap_entry\n{\n    void *key;\n    void *value;\n};\n</code></pre>\n\n<p>From what I can tell this approach isn't great because it means that each entry in the map requires at least 2 allocations: one for the key and one for the value, regardless of the data types being stored. (Is that right???)</p>\n\n<p>I haven't been able to find a decent way of keeping it generic without going the macro route. Does anyone have any tips or examples that might help me out?</p>\n"}, {"tags": ["c", "clang", "llvm", "llvm-clang", "clang-static-analyzer"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 2, "creation_date": 1482293662, "post_id": 41254948, "comment_id": 69710466, "body": "I don&#39;t think it&#39;s possible. To generate the code, the compiler needs information that is located in include files."}, {"owner": {"reputation": 360, "user_id": 2613746, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BIsQ4.jpg?s=128&g=1", "display_name": "Quentin Mayo", "link": "https://stackoverflow.com/users/2613746/quentin-mayo"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482293950, "post_id": 41254948, "comment_id": 69710531, "body": "Maybe so. However, I was hoping someone could teach me the tricks of the trade. Either there is a &quot;trick of the trade&quot; when it comes to security and source analysis or there is a lot security papers that are FULL of bologna."}, {"owner": {"reputation": 114796, "user_id": 214671, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f82954c7134fbe63282dc033fd52f3ab?s=128&d=identicon&r=PG", "display_name": "Matteo Italia", "link": "https://stackoverflow.com/users/214671/matteo-italia"}, "edited": false, "score": 0, "creation_date": 1482304724, "post_id": 41254948, "comment_id": 69714501, "body": "Notice that usually you don&#39;t need to manually patch the makefiles - a few environment variables, and, in the worst case, PATH tricks and appropriately-named scripts can go a long way. Stuff like <code>scanbuild</code> can mostly automate this with the clang static analyzer. Also, nowadays if it compiles in gcc you can usually manage to make clang compile it - often the worst you need are just a couple of defines to make the code think it&#39;s gcc. Finally, there are tools like Psyche-c that are being developed, but they are still highly experimental."}], "answers": [{"tags": [], "owner": {"reputation": 511, "user_id": 7297569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9798b8e7b391ce57a9533e9e691bdb8a?s=128&d=identicon&r=PG&f=1", "display_name": "A.N", "link": "https://stackoverflow.com/users/7297569/a-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1482304132, "creation_date": 1482304132, "answer_id": 41257027, "question_id": 41254948, "link": "https://stackoverflow.com/questions/41254948/bypass-c-errors-to-generate-clang-debugging-information/41257027#41257027", "title": "Bypass C errors to generate clang debugging information", "body": "<p>Recently I used <strong>clang-tidy</strong> for source code analysis of one of our projects. The project uses GNU compiler and we didn't wanted to move away from that. So the process that I followed was below:</p>\n\n<p>1) Use <strong>bear</strong> to generate the <strong>compilation database</strong> i.e. compile_commands.json which is used by clang-tidy </p>\n\n<p>2) By pass the include files that we don't want to analyze by <strong>including them as system files</strong> i.e. use --isystem for their inclusion and project specific files using -I. (If you can't change the Make files you could change the compile_commands.json by a simple find and replace)</p>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 360, "user_id": 2613746, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/BIsQ4.jpg?s=128&g=1", "display_name": "Quentin Mayo", "link": "https://stackoverflow.com/users/2613746/quentin-mayo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482304132, "creation_date": 1482293344, "last_edit_date": 1482297408, "question_id": 41254948, "link": "https://stackoverflow.com/questions/41254948/bypass-c-errors-to-generate-clang-debugging-information", "title": "Bypass C errors to generate clang debugging information", "body": "<pre><code>TL:DR\n</code></pre>\n\n<p>Can you generate clang debugging information(CFGs, PDGs) when the original source file have DEPENDENCY errors from missing header files that cause compilation issues such as undeclared identifiers and unknown types? The files are syntactically  correct. Is there a flag that maybe set all undeclared identifiers to INTs for debugging?</p>\n\n<hr>\n\n<p>I am using Clang to analyze source code packages. Usually, I modify the makefile so clang generates debugging information using the command below </p>\n\n<pre><code>clang -emit-llvm -g -S -ferror-limit=0 -I somefile some_c_file\n</code></pre>\n\n<p>However, this approach is very makefile focused and if developer does not support Clang in that given build version, I have to figure out how to generate the debugging information.</p>\n\n<p>This is not good for automation. For things such as OpenSSL where they include dozen of files(headers) and custom configurations for the given platform, this is not practical. I want to suppress or ignore the errors if possible since I know the build version's file under test is syntactically  correct.   </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "file", "filenames", "inode", "minix"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7330102, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41ekg.png?s=128&g=1", "display_name": "Katia Pod", "link": "https://stackoverflow.com/users/7330102/katia-pod"}, "is_accepted": false, "score": -1, "last_activity_date": 1482405836, "creation_date": 1482405836, "answer_id": 41282032, "question_id": 41254456, "link": "https://stackoverflow.com/questions/41254456/retrieve-a-files-inode-number-by-the-filename-on-minix/41282032#41282032", "title": "Retrieve a file&#39;s inode number by the filename on MINIX", "body": "<p>You can add the user input as an argument to the sys_call. If i understand correctly it is a school assignment, so you might just:</p>\n\n<p>int do_stat(char * filename) {\n...\n}</p>\n"}, {"tags": [], "owner": {"reputation": 179, "user_id": 6275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sqYLd.png?s=128&g=1", "display_name": "man0s", "link": "https://stackoverflow.com/users/6275376/man0s"}, "is_accepted": true, "score": 1, "last_activity_date": 1564831830, "last_edit_date": 1564831830, "creation_date": 1482408145, "answer_id": 41282772, "question_id": 41254456, "link": "https://stackoverflow.com/questions/41254456/retrieve-a-files-inode-number-by-the-filename-on-minix/41282772#41282772", "title": "Retrieve a file&#39;s inode number by the filename on MINIX", "body": "<p>I've found a solution to my problem, i was not able to understand the way fetch_name() parameters work(vname1,vname1_length and fullpath).\nSo in order to do that I looked into /usr/src/vfs/params.h\n<code>#define name          m3_p1\n #define flength       m2_l1\n #define name1         m1_p1\n #define name2         m1_p2\n #define name_length   m3_i1\n #define name1_length  m1_i1\n #define name2_length  m1_i2\n #define nbytes        m1_i2</code></p>\n\n<p>\u03a5ou can see name1 stands for m1_p1 and name1_length stands for m1_i1 message variables.</p>\n\n<p>As for fetch_name function,i looked /usr/src/vfs/utility.c</p>\n\n<pre><code>int fetch_name(vir_bytes path, size_t len, char *dest)\n{\n/* Go get path and put it in 'dest'.  */\nint r;\n</code></pre>\n\n<p>So fetch_name actually gets the path (filename from the user) and converts it to fullpath of the file.</p>\n\n<p>The question now is what's actually size_t len variable is...I looked it up  online and i found out that it's the strlen of the path variable!</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7347122, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bf9009fc4736221821b7ed3f689cd92?s=128&d=identicon&r=PG&f=1", "display_name": "crazy_penguin", "link": "https://stackoverflow.com/users/7347122/crazy-penguin"}, "is_accepted": false, "score": 0, "last_activity_date": 1482866957, "creation_date": 1482866957, "answer_id": 41351074, "question_id": 41254456, "link": "https://stackoverflow.com/questions/41254456/retrieve-a-files-inode-number-by-the-filename-on-minix/41351074#41351074", "title": "Retrieve a file&#39;s inode number by the filename on MINIX", "body": "<p>It's the strlen(name) + 1 as stored in m.m1_i1</p>\n"}], "owner": {"reputation": 179, "user_id": 6275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sqYLd.png?s=128&g=1", "display_name": "man0s", "link": "https://stackoverflow.com/users/6275376/man0s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 41282772, "answer_count": 3, "score": 4, "last_activity_date": 1585144722, "creation_date": 1482289598, "last_edit_date": 1585144722, "question_id": 41254456, "link": "https://stackoverflow.com/questions/41254456/retrieve-a-files-inode-number-by-the-filename-on-minix", "title": "Retrieve a file&#39;s inode number by the filename on MINIX", "body": "<p>I want to create a new system call in VFS server which will be given a filename as a parameter and will print this certain file's inode number in MINIX3.2.1.\nI examined the code of the do_stat() function(inside /usr/src/servers/vfs/stadir.c) and i found out that i have to assign to a vnode struct variable the faction eat_path() in order to access v_inode_nr which is the inode number.In order to do that how am i able to assign the file i am looking for,where to put the user input filename(m_in.m1_p1)?</p>\n\n<p>Here is the do_stat() function inside stadir.c</p>\n\n<pre><code>int do_stat() {\n  /* Perform the stat(name, buf) system call. */\n  int r;\n  struct vnode *vp;\n  struct vmnt *vmp;\n  char fullpath[PATH_MAX];\n  struct lookup resolve;\n  int old_stat = 0;\n  vir_bytes vname1, statbuf;\n  size_t vname1_length;\n\n  vname1 = (vir_bytes)job_m_in.name1;\n  vname1_length = (size_t)job_m_in.name1_length;\n  statbuf = (vir_bytes)job_m_in.m1_p2;\n\n  lookup_init(&amp;resolve, fullpath, PATH_NOFLAGS, &amp;vmp, &amp;vp);\n  resolve.l_vmnt_lock = VMNT_READ;\n  resolve.l_vnode_lock = VNODE_READ;\n\n  if (job_call_nr == PREV_STAT)\n    old_stat = 1;\n\n  if (fetch_name(vname1, vname1_length, fullpath) != OK)\n    return (err_code);\n  if ((vp = eat_path(&amp;resolve, fp)) == NULL)\n    return (err_code);\n  r = req_stat(vp-&gt;v_fs_e, vp-&gt;v_inode_nr, who_e, statbuf, old_stat);\n\n  unlock_vnode(vp);\n  unlock_vmnt(vmp);\n\n  put_vnode(vp);\n  return r;\n}\n</code></pre>\n"}, {"tags": ["c", "assembly", "x86-64"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 4, "creation_date": 1482287747, "post_id": 41254158, "comment_id": 69709102, "body": "&quot;Normally I would have read more documentation but I simple am in lack of the time&quot; - So you outsource debugging to us? That&#39;s not how stack overflow works! We are not a debugging service. See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 52454, "user_id": 547981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90042f6f33a9f87769fac02096ceea68?s=128&d=identicon&r=PG", "display_name": "Jester", "link": "https://stackoverflow.com/users/547981/jester"}, "edited": false, "score": 1, "creation_date": 1482287770, "post_id": 41254158, "comment_id": 69709112, "body": "Use the debugger to single step the code and verify the exit condition. Not sure why you expect it to stop, <code>3n+1</code> will grow to infinity even if you sometimes divide by <code>2</code>. PS: <code>rbx</code> is a callee-saved register. PS #2: using <code>idiv</code> for dividing by 2 is frowned upon :) PS #3: similarly for <code>imul</code> and <code>3</code>."}, {"owner": {"reputation": 14339, "user_id": 1466970, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/V1J6z.jpg?s=128&g=1", "display_name": "Richard Chambers", "link": "https://stackoverflow.com/users/1466970/richard-chambers"}, "edited": false, "score": 0, "creation_date": 1482288050, "post_id": 41254158, "comment_id": 69709182, "body": "What is the call interface for your C compiler when a function is called? Do you need to push the argument value onto the stack before doing the call to <code>collatz()</code> or is it passed in register <code>rdi</code>? What I would do is write the <code>collatz()</code> function in C and then run it through the entire program through the compiler to generate assembler output and see what the compiler is doing with the recursive call."}, {"owner": {"reputation": 15145, "user_id": 4271923, "user_type": "registered", "profile_image": "https://graph.facebook.com/543414580/picture?type=large", "display_name": "Ped7g", "link": "https://stackoverflow.com/users/4271923/ped7g"}, "edited": false, "score": 0, "creation_date": 1482290737, "post_id": 41254158, "comment_id": 69709755, "body": "You work with <code>noOfOp</code> as if it is a qword, but it&#39;s <code>int</code> in C. I never believe <code>int</code>s when I&#39;m accessing ASM... <code>uint64_t</code> is preferred by me (&quot;stdint.h&quot; include)."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1482358071, "post_id": 41254158, "comment_id": 69746869, "body": "Your code has a lot of the same performance problems as this <a href=\"http://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat\">slow-but-working hand-written asm vs. C++ question</a>.  See my answer there (and a couple of the others) for how to make it fast."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482358126, "post_id": 41254158, "comment_id": 69746898, "body": "So which instruction is <code>0x00000000004006c3 in is_odd ()</code>, and what are the register values at that point?  You got half way to giving useful debugging information, but stopped just short.  (See <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>: I&#39;m not going to spend my time looking at everything in your code when you can&#39;t be bothered to tell me exactly how it crashed.)"}], "answers": [{"tags": [], "owner": {"reputation": 221394, "user_id": 366904, "user_type": "moderator", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3f8912af19fe86b7b34a0b011a962460?s=128&d=identicon&r=PG", "display_name": "Cody Gray", "link": "https://stackoverflow.com/users/366904/cody-gray"}, "is_accepted": false, "score": 2, "last_activity_date": 1482314948, "last_edit_date": 1592644375, "creation_date": 1482314414, "answer_id": 41259978, "question_id": 41254158, "link": "https://stackoverflow.com/questions/41254158/collatz-function-in-assembly-segmentation-fault/41259978#41259978", "title": "Collatz function in assembly - segmentation fault", "body": "<p>Two problems that I see just from inspecting the code:</p>\n<ol>\n<li><p><code>noOfOp</code> is declared as an <code>int</code>, which will be a 32-bit type on x86-64. Your assembly code, however, is treating it as if it were a 64-bit type. Specifically, where you increment it by one using <code>incq</code>. That should instead be <code>incl noOfOp</code> or <code>addl $1, noOfOp</code>.</p>\n<p>Along the same lines, your <code>collatz</code> function is prototyped as returning an <code>int</code>, but your code suggests that you are trying to return a 64-bit value in <code>rax</code>. This won't cause any problems, because the caller will just use only the lower 32 bits, but it may cause correctness problems.</p>\n</li>\n<li><p>You are ignoring the calling convention when recursively calling the <code>collatz</code> function. Assuming that you are on Linux, the applicable one would be <a href=\"https://www.uclibc.org/docs/psABI-x86_64.pdf\" rel=\"nofollow noreferrer\">the System V AMD64 calling convention</a>. Here, the <code>RBP</code> and <code>RBX</code> registers are callee-save. Therefore, you need to preserve their contents. Do be sure to familiarize yourself with the calling convention and follow its rules.</p>\n<p>As one of the commenters suggested, it may be easiest to write the function first in C or C++, before translating it to assembly. This will also make it easier to debug, and it also makes it possible to see what code the compiler emits. You can check the compiler's output against your own hand-written assembly code.</p>\n</li>\n</ol>\n<p>There may be additional problems with your code that I didn't spot. You can find them for yourself by single-stepping through your code with a debugger. You are already using GDB, so this should be simple to do.</p>\n"}, {"comments": [{"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1482358599, "post_id": 41267404, "comment_id": 69747107, "body": "If you compile your C with optimization enabled, it&#39;s hard to imagine that it would be slower than this asm.  At least you&#39;re not using DIV anymore, but you&#39;re making a recursive call for every step!!  There&#39;s a lot of other inefficiency here, like branching on odd/even.  But even if you&#39;re going to do that, you could lay out your branches better, and do the tests more efficiently.  (e.g. <code>test $1, %edi</code> to test the low bit, instead of a move and AND.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482358664, "post_id": 41267404, "comment_id": 69747132, "body": "If you&#39;re going to use IMUL instead of LEA (which is what you should really be using), at least use the immediate-operand form: <code>imul $3, %rdx, %rdi</code>.  (Yes, <a href=\"http://www.felixcloutier.com/x86/IMUL.html\" rel=\"nofollow noreferrer\">imul-immediate</a> is special, and has room for a separate read-only source and write-only destination instead of operating in-place like <code>add $4, %eax</code> and the other original 8086 immediate instructions that use one of the operand fields as extra opcode bits in the machine-code encoding.)"}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482359042, "post_id": 41267404, "comment_id": 69747277, "body": "Anyway, like I commented on the question, <b>see <a href=\"http://stackoverflow.com/questions/40354978/why-is-this-c-code-faster-than-my-hand-written-assembly-for-testing-the-collat/40355466#40355466\">my answer on another Collatz asm question</a> for exactly how to optimize the crap out of it for Intel Haswell, or AMD Bulldozer-family</b>.  (The optimal asm differs for different microarchitectures).  Many people contributed some great ideas for algorithmic improvements, like always doing two steps at once since <code>3*odd_n+1</code> is always even."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482361599, "post_id": 41267404, "comment_id": 69748300, "body": "Oh, reading Cody&#39;s answer, I just realized you&#39;re incrementing your counter <i>in memory</i> every iteration, instead of keeping it in one of the 15 general purpose registers (not including the stack pointer).  That gives you a latency bottleneck of ~6 cycles for <code>inc</code> with a memory destination, and is probably the overall bottleneck in your code (plus the time you spend returning out of that deep recursive call tree after doing the useful work.)"}, {"owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482447344, "post_id": 41267404, "comment_id": 69788404, "body": "Thank you Peter! Lots of great stuff. By skipping the recursive call for the odd numbers I shaved off a lot of time. However the difference in time between <code>imul</code> and <code>lea</code> was not noticeable as was the case with keeping the counter in a register instead of memory (which I don&#39;t know why I didn&#39;t do in the first place and which I don&#39;t know why is not faster..). The <code>gcc -O2</code> (and <code>gcc -O3</code>, no difference for me) was twice as fast as my code which in turn was twice as fast as no optimization from compiling the original code."}, {"owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482447407, "post_id": 41267404, "comment_id": 69788423, "body": "But my assignment has just been due and is now uploaded, so I went with what I had written. However I will definitely look into the optimized compiler-code to study how it is doing it. I would guess it tries to completely eliminate recursion. Thank you again."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482456722, "post_id": 41267404, "comment_id": 69790821, "body": "Yes, the most efficient way for a compiler to implement tail-recursion is with a loop.  If LEA wasn&#39;t faster, are you sure you did it right?  e.g. <code>lea 1(%rdi, %rdi, 2), %rdi</code> to do <code>rdi = 3*rdi + 1</code>.  As I pointed out in the Collatz asm-optimization answer I linked, <code>lea (%rdi, %rdi, 2), %rdi</code> / <code>inc %rdi</code> is actually lower latency on Intel SnB-family CPUs than doing the +1 as part of the LEA."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482456866, "post_id": 41267404, "comment_id": 69790856, "body": "Did you also get rid of the conditional branch, and use a <code>cmov</code> instead?  That should help a lot.  (Run <code>perf stat .&#47;your_program</code> and look at the mispredicted-branch percentage).  If your code is still branching on odd/even, that might be the major bottleneck and further improvements to the calculation will only make a small difference.  (This is also covered in my answer on the linked question, as well as the major algorithmic improvement of always doing a <code>shr $1, %rdi</code> after a 3N+1 without having to check for odd.  Or combining that shift into part of the 3N+1 calc...)"}, {"owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1482520352, "post_id": 41267404, "comment_id": 69816409, "body": "Thank you again Peter. I think that maybe the branching and the one recursive call was the reason why it made no difference between using <code>imul</code> or <code>lea</code>. However with my new implementation after having better time reading through your (and a lot of other people&#39;s) excellent answers and comments on the thread, I got rid of recursion and implemented some of those great ideas and tricks. The new program is now 30% faster than that generated with <code>gcc -O3</code>. I cannot believe how much more efficient this is. You guys are truly brilliant people."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1482527479, "post_id": 41267404, "comment_id": 69818808, "body": "cool, clad you had fun playing with asm tuning :)  Intel Sandybridge-family has fewer &quot;weird&quot; bottlenecks than some earlier architectures, so often there&#39;s less trial-and-error with performance counters.  Looking at perf counters to see how close you&#39;re coming to the theoretical max 4 uops per clock is fun, though :)"}], "tags": [], "owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "is_accepted": false, "score": 0, "last_activity_date": 1482338539, "last_edit_date": 1482338539, "creation_date": 1482337323, "answer_id": 41267404, "question_id": 41254158, "link": "https://stackoverflow.com/questions/41254158/collatz-function-in-assembly-segmentation-fault/41267404#41267404", "title": "Collatz function in assembly - segmentation fault", "body": "<p>Thank you for all the answers. I apologize if my question did not follow Stack Overflow guidelines.<br>\nI meant that normally I would not bother others with this if I had more time. Instead I sought guidance - not presumed debugging service - that could lead me on the right path.</p>\n\n<p>For anyone interested I got the program to work. I went with a different approach than originally posted and made some changes for speed up. Below is the new assembly code.</p>\n\n<pre><code>.section .text\n.global collatz\n\ncollatz:\n    pushq   %rbp            # save old base pointer\n    movq    %rsp, %rbp      # create new base pointer\n    subq    $16, %rsp       # local variable space\n\n    cmpq    $1, %rdi        # compare n to 1\n    je      is_one          # if n = 1, jump to is_one\n                            # else n &gt; 1\n    incl    noOfOp          # increment noOfOp\n    movq    %rdi, %rax      # move n to rax\n    andq    $1, %rax        # AND 1 with n\n    jz      is_even         # if n is even jump to is_even\n                            # else n is odd\n    movq    $3, %rdx        # move 3 to rdx\n    imul    %rdx, %rdi      # n = 3 * n\n    incq    %rdi            # n = 3n + 1\n    call    collatz         # recursive call: collatz(3n+1)\n    leave                   # remake stack\n    ret                     # return\n\nis_even:\n    sarq    %rdi            # arithmetic right shift by 1 - divide n by 2\n    call    collatz         # recursive call: collatz(n/2)\n    leave                   # remake stack\n    ret                     # return\n\nis_one:\n    movl    noOfOp, %eax    # set return value to noOfOp\n    movl    $0, noOfOp      # reset noOfOp\n    leave                   # remake stack\n    ret                     # return\n</code></pre>\n\n<p>This works and is approx. 30% faster than the code I have written only in C. But I know from the assignment that I can shave off even more time making it more effective. If anyone has any ideas how to do so feel free to comment.</p>\n\n<p>Thank you again. </p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "is_accepted": false, "score": 1, "last_activity_date": 1482520279, "creation_date": 1482520279, "answer_id": 41306746, "question_id": 41254158, "link": "https://stackoverflow.com/questions/41254158/collatz-function-in-assembly-segmentation-fault/41306746#41306746", "title": "Collatz function in assembly - segmentation fault", "body": "<p>After what Peter suggested in the comments above, I read what him and other brilliant people discussed in another thread of the same topic. This is the code I ended up with after implementing some of those ideas. This is now 30% faster than that compiled with <code>gcc -O3</code>. I cannot believe how much more faster the program can be these different \"tricks\"  - I truly learned a lot about efficiency. Thank you to those who helped. </p>\n\n<pre><code>.section .text\n.global collatz\n\ncollatz:\n    pushq   %rbp                    # save old base pointer\n    movq    %rsp, %rbp              # create new base pointer\n    subq    $16, %rsp               # local variable space  \n    movq    $-1, %r10               # start counter at -1\n\nwhile_loop:\n    incq    %r10                    # increment counter\n    leaq    (%rdi, %rdi, 2), %rdx   # rdx = 2 * n + n\n    incq    %rdx                    # rdx = 3n+1\n    sarq    %rdi                    # rdi = n/2\n    cmovc   %rdx, %rdi              # if CF, rdi = rdx\n                                    # (if CF was set during right shift (i.e. n is odd) set rdi to 3n+1)\n                                    # else keep rdi to n/2\n    jnz     while_loop              # if n =/= 1 do loop again:\n                                    # Z flag is only set if sarq shifts when n is 1 making result 0.\n                                    # else\n    movq    %r10, %rax              # set return value to counter\n    leave                           # remake stack\n    ret                             # return\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5999697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d91b8040c7e3f232e4c957770980b23?s=128&d=identicon&r=PG&f=1", "display_name": "MikL", "link": "https://stackoverflow.com/users/5999697/mikl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "answer_count": 3, "score": -6, "last_activity_date": 1482520279, "creation_date": 1482287193, "question_id": 41254158, "link": "https://stackoverflow.com/questions/41254158/collatz-function-in-assembly-segmentation-fault", "title": "Collatz function in assembly - segmentation fault", "body": "<p>I am trying to write a hybrid program between C and x86-64 assembly language. This program should calculate the largest stopping time of a number between 1 and given parameter <em>n</em> using the Collatz function. The main function is written in C and in its for-loop it calls an external function written in assembly.</p>\n\n<p>However, I am getting a segmentation fault when running the compiled hybrid program for values larger than 2. Using <em>gdb</em> I've found the error to be when I make the recursive call. This is the error I am getting:</p>\n\n<pre><code>Program received signal SIGSEGV, Segmentation fault.\n0x00000000004006c3 in is_odd ()\n</code></pre>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint noOfOp = 0;\n\nextern int collatz(long long n);\n\n// The main function. Main expects one parameter n.\n// Then, it computes collatz(1), colllatz(2), ..., collataz(n) and finds the\n// a number m, 1 &lt;= m &lt;= n with the maximum stopping time.\nint main(int argc, char *argv[]){\n    if (argc != 2) {\n        printf(\"Parameter \\\"n\\\" is missing. \\n\");\n        return -1;\n    } else {\n        int max=0;\n        long long maxn=0;\n        int tmp=0;\n        long long n = atoll(argv[1]);\n        for (long long i=1 ; i&lt;=n ; i++) {\n            tmp = collatz(i);\n            if (tmp &gt; max) {\n                max = tmp;\n                maxn=i;\n            }\n        }\n        printf(\"The largest stopping time between 1 and %lld was %lld \", n,maxn);\n        printf(\"with the stopping time of %d. \\n\", max);\n    }\n}\n</code></pre>\n\n<p>And this is the x86-64 assembly code I've written. I expect this code to reflect my lack of proper understanding of assembly, yet. This is an assignment in class of which we have been given four days to complete on this new topic. Normally I would have read more documentation but I simple am in lack of the time. And assembly language is hard.</p>\n\n<pre><code>.section .text\n.global collatz\n\ncollatz:\n    pushq   %rbp            # save old base pointer\n    movq    %rsp, %rbp      # create new base pointer\n    subq    $16, %rsp       # local variable space\n\n\n    cmpq    $1, %rdi        # compare n to 1\n    je      is_one          # if n = 1, return noOfOp\n\n    incq    noOfOp          # else n &gt; 1, then increment noOfOp\n    movq    %rdi, %rdx      # move n to register rdx\n    cqto                    # sign extend rdx:rax\n    movq    $2, %rbx        # move 2 to register rbx\n    idivq   %rbx            # n / 2 -- quotient is in rax, remainder in rdx\n    cmpq    $1, %rdx        # compare remainder to 1\n    je      is_odd          # if n is odd, jump to is_odd\n    jl      is_even         # else n is even, jump to is_even\n    leave                   # remake stack\n    ret                     # return\n\n\nis_odd:\n    movq    %rdi, %rdx      # move n to register rdx\n    cqto                    # sign extend rdx:rax\n    movq    $3, %rbx        # move 3 to register rbx\n    imulq   %rbx            # n * 3 -- result is in rax:rdx\n    movq    %rax, %rdi      # move n to register rdi\n    incq    %rdi            # n = n + 1\n    call    collatz         # recursive call: collatz(3n+1) &lt;---- this is where the segmentation fault seems to happen\n    leave                   # remake stack\n    ret                     # return\n\nis_even:\n    movq    %rax, %rdi      # n = n / 2 (quotient from n/2 is still in rax)\n    call    collatz         # recursive call: collatz(n/2) &lt;---- I seem to have gotten the same error here by commenting out most of the stuff in is_odd\n    leave                   # remake stack\n    ret                     # return\n\nis_one:\n    movq    noOfOp, %rax    # set return value to the value of noOfOp variable\n    leave                   # remake stack\n    ret                     # return\n</code></pre>\n\n<p>I appreciate any and all the help and suggestions I can get.</p>\n"}, {"tags": ["python", "c", "gcc", "mingw"], "comments": [{"owner": {"reputation": 1686, "user_id": 3551483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/I4c4V.png?s=128&g=1", "display_name": "Fang", "link": "https://stackoverflow.com/users/3551483/fang"}, "edited": false, "score": 0, "creation_date": 1482285838, "post_id": 41253963, "comment_id": 69708631, "body": "&quot;during compilation&quot; is misleading because it&#39;s clearly a linker error"}, {"owner": {"reputation": 7503, "user_id": 3874768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nmQTg.jpg?s=128&g=1", "display_name": "repzero", "link": "https://stackoverflow.com/users/3874768/repzero"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482285854, "post_id": 41253963, "comment_id": 69708641, "body": "@Stargateur I can download it and try it...have you tried with it with including python?..just a thought.."}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482285863, "post_id": 41253963, "comment_id": 69708645, "body": "ld didn&#39;t find python2 and util library you should add <code>-L path_to_python_lib -L path_to_util_lib</code>"}, {"owner": {"reputation": 7503, "user_id": 3874768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nmQTg.jpg?s=128&g=1", "display_name": "repzero", "link": "https://stackoverflow.com/users/3874768/repzero"}, "edited": false, "score": 0, "creation_date": 1482285885, "post_id": 41253963, "comment_id": 69708654, "body": "@Fang..I will edited question heading"}, {"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 1, "creation_date": 1482286173, "post_id": 41253963, "comment_id": 69708719, "body": "@repzero with python, it would ask to config cmakelist with python. It&#39;s could be hard indeed. It was just saying, in my experience compile on windows with gcc is really painful. I prefer use visual studio on windows and gcc/clang on linux with a good cmake to generate project configuration."}, {"owner": {"reputation": 7503, "user_id": 3874768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nmQTg.jpg?s=128&g=1", "display_name": "repzero", "link": "https://stackoverflow.com/users/3874768/repzero"}, "reply_to_user": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482286384, "post_id": 41253963, "comment_id": 69708774, "body": "@Stargateur I will try this with visual studio in the meantime....I appreciate the tip"}], "owner": {"reputation": 7503, "user_id": 3874768, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nmQTg.jpg?s=128&g=1", "display_name": "repzero", "link": "https://stackoverflow.com/users/3874768/repzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1482285909, "creation_date": 1482285391, "last_edit_date": 1482285909, "question_id": 41253963, "link": "https://stackoverflow.com/questions/41253963/gcccannot-find-lpython2-7-when-including-python-headers-during-linking", "title": "gcc:cannot find -lpython2.7 when including python headers during linking", "body": "<p>I am trying to port python codes on windows to c codes and the convert it to an executable on <strong>windows 7</strong>. In linux I can do this easily, but in windows, this is totally new for me plus I am not good with compilers.</p>\n\n<p>I download minGW and installed the compiler collection which includes gcc.</p>\n\n<p>Below shows how I am trying to include python headers when compiling the .c file</p>\n\n<pre><code>C:\\Users\\repzero&gt;gcc -Os -I C:\\Python27\\include  -o C:\\Users\\repzero\\hello.o C:\\Users\\repzero\\hello.c -lpython2.7 -lpthread -lm -lutil\n</code></pre>\n\n<p>I get the errors</p>\n\n<pre><code>c:/mingw/bin/../lib/gcc/mingw32/5.3.0/../../../../mingw32/bin/ld.exe: cannot find -lpython2.7\nc:/mingw/bin/../lib/gcc/mingw32/5.3.0/../../../../mingw32/bin/ld.exe: cannot find -lutil\ncollect2.exe: error: ld returned 1 exit status\n</code></pre>\n\n<p><strong>Additional information</strong></p>\n\n<p>Here is my command line which I used to port python codes to c does (This generates hello.c) <strong>this works fine</strong></p>\n\n<pre><code>cython --embed -o hello.c hello.py\n</code></pre>\n\n<p>How can I alleviate those errors?</p>\n"}, {"tags": ["c", "overflow"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 6, "creation_date": 1482283743, "post_id": 41253787, "comment_id": 69708162, "body": "<code>0x12345678 * 0x12345678</code> --&gt; <code>0x12345678ULL * 0x12345678</code>"}, {"owner": {"reputation": 1642, "user_id": 3928184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-opJFz3zFjGI/AAAAAAAAAAI/AAAAAAAAAr0/2zAUOWaRv90/photo.jpg?sz=128", "display_name": "bjd2385", "link": "https://stackoverflow.com/users/3928184/bjd2385"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1482283874, "post_id": 41253787, "comment_id": 69708197, "body": "@BLUEPIXY I&#39;ve never seen that before, but it fixes the warning. Thank you."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1482313853, "post_id": 41253787, "comment_id": 69719757, "body": "@bjd2385 The key here is to understand what type that C uses for the <i>calculation</i>, which is determined based on the types of the operands. What type you store the end result in doesn&#39;t affect the type used for the calculation."}, {"owner": {"reputation": 1642, "user_id": 3928184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-opJFz3zFjGI/AAAAAAAAAAI/AAAAAAAAAr0/2zAUOWaRv90/photo.jpg?sz=128", "display_name": "bjd2385", "link": "https://stackoverflow.com/users/3928184/bjd2385"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1482327252, "post_id": 41253787, "comment_id": 69728689, "body": "@Lundin That makes a lot of sense. Even though my answer has been down voted (unsurprisingly), I&#39;ve still learned an important concept here."}], "answers": [{"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1482313702, "post_id": 41254784, "comment_id": 69719652, "body": "<code>0x12345678</code> is of type (signed) <code>int</code> on a 32 bit machine, not unsigned. Unlike <code>0x82345678</code> which is of type <code>unsigned int</code>."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1482328763, "post_id": 41254784, "comment_id": 69729713, "body": "@lundin - agreed."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1482328738, "last_edit_date": 1495535439, "creation_date": 1482292070, "answer_id": 41254784, "question_id": 41253787, "link": "https://stackoverflow.com/questions/41253787/why-do-i-get-an-integer-overflow-and-how-do-i-fix-it/41254784#41254784", "title": "Why do I get an integer overflow, and how do I fix it?", "body": "<p>[After accept correction per <a href=\"https://stackoverflow.com/questions/41253787/why-do-i-get-an-integer-overflow-and-how-do-i-fix-it/41254784?noredirect=1#comment69719652_41254784\">@Lundin</a>] comment</p>\n\n<p>On your machine, <code>0x12345678</code> is narrower than <code>unsigned long long</code> - certainly a <code>signed long</code> or maybe <code>int</code>.</p>\n\n<p>A <code>signed long  * signed long</code> is still an <code>signed long</code> and can suffer from <em>signed integer</em> overflow, which is UB.  The range of your <code>signed long</code> is less than the mathematical product of <code>0x12345678 * 0x12345678</code>. By using <code>ULL</code> suffix, the math is done at least with <code>unsigned long long</code> math.  <a href=\"https://stackoverflow.com/questions/41253787/why-do-i-get-an-integer-overflow-and-how-do-i-fix-it#comment69708162_41253787\">@BLUEPIXY</a></p>\n\n<pre><code>printf(\"%llu\\n\", 0x12345678ULL * 0x12345678);\n// or if the constant can not be changed\nprintf(\"%llu\\n\", 1ULL * SOME_BIG_CONSTANT * SOME_BIG_CONSTANT);\n</code></pre>\n\n<hr>\n\n<p>Pedantic note: When printing integer types that <em>might</em> wider than <code>int/unsigned</code>, insure the final computed result matches the specifier.  Consider that SOME_BIG_CONSTANT might be wider than <code>unsigned long long</code>.  Or leave the cast off, and cope with the potential compiler warning.</p>\n\n<pre><code>printf(\"%llu\\n\", (unsigned long long) (1ULL * SOME_BIG_CONSTANT * SOME_BIG_CONSTANT));\n</code></pre>\n\n<p>See also <a href=\"https://stackoverflow.com/a/40633261/2410359\">Why write 1,000,000,000 as 1000*1000*1000 in C?</a><br>\nand <a href=\"https://stackoverflow.com/a/40637622/2410359\">There are reasons not to use 1000 * 1000 * 1000</a></p>\n"}], "owner": {"reputation": 1642, "user_id": 3928184, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-opJFz3zFjGI/AAAAAAAAAAI/AAAAAAAAAr0/2zAUOWaRv90/photo.jpg?sz=128", "display_name": "bjd2385", "link": "https://stackoverflow.com/users/3928184/bjd2385"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 41254784, "answer_count": 1, "score": 1, "last_activity_date": 1482328738, "creation_date": 1482283576, "question_id": 41253787, "link": "https://stackoverflow.com/questions/41253787/why-do-i-get-an-integer-overflow-and-how-do-i-fix-it", "title": "Why do I get an integer overflow, and how do I fix it?", "body": "<p>Trying to compile the following line in my code breaks:</p>\n\n<pre><code>printf(\"%llu\\n\", 0x12345678 * 0x12345678);\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>program.c:45:34: warning: integer overflow in expression [-Woverflow]\n     printf(\"%llu\\n\", (0x12345678 * 0x12345678));\n</code></pre>\n\n<p>How do I fix this?</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1482284323, "post_id": 41253786, "comment_id": 69708295, "body": "floating point calc only accurate to 7 digits <a href=\"http://stackoverflow.com/questions/9765744/precision-in-c-floats\">stackoverflow.com/questions/9765744/precision-in-c-floats</a>"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1482284705, "post_id": 41253786, "comment_id": 69708367, "body": "There&#39;s nothing random or undefined, and the result you&#39;re getting is very nearly correct (off by one part in 100 million). It&#39;s just a rounding error. If you used <code>double</code> rather than <code>float</code> you&#39;d get the exact result, though you could still get rounding errors for larger input values."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482284911, "post_id": 41253786, "comment_id": 69708418, "body": "There are a large number of questions of which this could be a duplicate; the one I chose has the merit of being one of the oldest on SO (and it has excellent answers).  Incidentally, the result would be the same on a 64-bit system; the problem is that <code>float</code> (almost always) uses 4 bytes which doesn&#39;t give very many decimal digits of precision."}], "answers": [{"tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": true, "score": 2, "last_activity_date": 1482283796, "creation_date": 1482283796, "answer_id": 41253806, "question_id": 41253786, "link": "https://stackoverflow.com/questions/41253786/mathematic-operation-between-integer-and-float-in-a-32-bit-system/41253806#41253806", "title": "Mathematic operation between integer and float in a 32-bit system", "body": "<p>The entire calculation goes to float, then gets cast to a 64 bit integer. But floats can't accurately represent large integers, unless they happen to be powers of two.</p>\n"}], "owner": {"reputation": 55, "user_id": 7323473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b98d5b5276b95b47d98c09bcc97690f6?s=128&d=identicon&r=PG&f=1", "display_name": "Jackie.Y", "link": "https://stackoverflow.com/users/7323473/jackie-y"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1482284834, "accepted_answer_id": 41253806, "answer_count": 1, "score": 0, "last_activity_date": 1482284413, "creation_date": 1482283557, "last_edit_date": 1482284413, "question_id": 41253786, "link": "https://stackoverflow.com/questions/41253786/mathematic-operation-between-integer-and-float-in-a-32-bit-system", "closed_reason": "Duplicate", "title": "Mathematic operation between integer and float in a 32-bit system", "body": "<p>On a 32-bit system, I found that the operation below always return the correct value when a &lt; 2^31 but returns random results where a is larger.</p>\n\n<pre><code>uint64_t a = 14227959735;\nuint64_t b = 32768;\nfloat c = 256.0;\nuint64_t d = a - b/ c; // d returns 14227959808\n</code></pre>\n\n<p>I believe the problem here is that the int-to-float operation returns undefined behavior, but could someone help explain why it gives such a value?</p>\n"}, {"tags": ["c", "undefined-behavior", "variadic-functions"], "comments": [{"owner": {"reputation": 17298, "user_id": 1540468, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f7d0c7668a2f3b53cf22c01ae63f32b?s=128&d=identicon&r=PG", "display_name": "Paul Rooney", "link": "https://stackoverflow.com/users/1540468/paul-rooney"}, "edited": false, "score": 1, "creation_date": 1482282811, "post_id": 41253660, "comment_id": 69707979, "body": "You passed an invalid length. There should be 10 subsequent arguments, but there are only 3. So its using garbage values."}], "answers": [{"comments": [{"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "edited": false, "score": 1, "creation_date": 1482284138, "post_id": 41253699, "comment_id": 69708250, "body": "Most likely, those other numbers that you&#39;re adding into <code>sum</code> are whatever else is on the call stack -- things like the saved return address and possibly even the current value of <code>sum</code> itself.  On some platforms, you may be throwing in a some register contents too.  This is strongly dependent on your operating system, compiler, and machine architecture; C does not define the structure of the call stack or even require that one exists."}], "tags": [], "owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "is_accepted": true, "score": 4, "last_activity_date": 1482284715, "last_edit_date": 1482284715, "creation_date": 1482282830, "answer_id": 41253699, "question_id": 41253660, "link": "https://stackoverflow.com/questions/41253660/why-does-this-gnu-c-variadic-function-return-a-huge-number/41253699#41253699", "title": "Why does this GNU C variadic function return a huge number?", "body": "<p>You have undefined behavior.</p>\n\n<p>You sent <code>10</code> as first argument, but you call <code>addEmUp()</code> with only 3 additional arguments.</p>\n\n<pre><code>printf(\"%d\\n\", addEmUp(3, 10, 10, 10));\n</code></pre>\n\n<hr>\n\n<p>When you have an undefined behavior, you can't know what will happen. When your function <code>addEmUp()</code> get too far with <code>va_arg()</code>. You can cause a lot of thought:</p>\n\n<ul>\n<li>segmentation fault</li>\n<li>wrong behavior (what you get)</li>\n<li>etc</li>\n</ul>\n\n<p>Like @user3553031 say in comment:</p>\n\n<blockquote>\n  <p>Most likely, those other numbers that you're adding into sum are whatever else is on the call stack -- things like the saved return address and possibly even the current value of sum itself. This is strongly dependent on your operating system, compiler, and machine architecture; C does not define the structure of the call stack or even require that one exists.</p>\n</blockquote>\n"}], "owner": {"reputation": 2635, "user_id": 1435711, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/9fac7fe4c7290024faee8bfe6367f130?s=128&d=identicon&r=PG", "display_name": "Username", "link": "https://stackoverflow.com/users/1435711/username"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 41253699, "answer_count": 1, "score": 0, "last_activity_date": 1482285111, "creation_date": 1482282499, "last_edit_date": 1482285111, "question_id": 41253660, "link": "https://stackoverflow.com/questions/41253660/why-does-this-gnu-c-variadic-function-return-a-huge-number", "title": "Why does this GNU C variadic function return a huge number?", "body": "<p>I'm looking at <a href=\"http://www.gnu.org/software/libc/manual/html_node/Variadic-Example.html#Variadic-Example\" rel=\"nofollow noreferrer\">this example</a> of a variadic function in C, written GNU.org. My OS is Debian 8.6.</p>\n\n<p>Here's my slight variation on it, filename is <code>ex.c</code>:</p>\n\n<pre><code>#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n\nint addEmUp(int count,...){\n    va_list ap; // where list of arguments are stored\n    int i, sum;\n\n    va_start(ap,count); // initialize the argument list\n\n    sum=    0;\n    for(i=0; i&lt;count; i++)\n        sum += va_arg(ap,int);  // get the next argument value\n\n    va_end(ap); // clean up\n\n    return sum;\n}\n\nint main(void){\n    printf(\"%d\\n\", addEmUp(3,4,5,6));\n    printf(\"%d\\n\", addEmUp(10, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10));\n    printf(\"%d\\n\", addEmUp(10,10,10,10));\n    return 0;\n}\n</code></pre>\n\n<p>Here's my makefile <code>_example.mak</code>:</p>\n\n<pre><code>CFLAGS=-Wall -g\nCFILE=ex\n\nrun:\n    cc $(CFILE).c -o $(CFILE) $(CFLAGS)\n    ./$(CFILE)\n    rm -f $(CFILE)\n</code></pre>\n\n<p>The output when I open the terminal and run <code>make -f _example.mak</code>:</p>\n\n<pre><code>./ex\n15\n55\n1141373223\nrm -f ex\n</code></pre>\n\n<p>Why does the third <code>addEmUp()</code> print <code>1141373223</code>? </p>\n"}, {"tags": ["c", "text-files", "binary-tree", "binary-search-tree"], "comments": [{"owner": {"reputation": 16936, "user_id": 7076153, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/erPUC.png?s=128&g=1", "display_name": "Stargateur", "link": "https://stackoverflow.com/users/7076153/stargateur"}, "edited": false, "score": 0, "creation_date": 1482282163, "post_id": 41253582, "comment_id": 69707814, "body": "Don&#39;t <code>typedef</code> a pointer please <code>typedef struct Node *binary_tree;</code>. It&#39;s really painful to read."}, {"owner": {"reputation": 28720, "user_id": 4561314, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6ad3771ba6e8e823dbcae710c1cde4da?s=128&d=identicon&r=PG", "display_name": "stackoverflowuser2010", "link": "https://stackoverflow.com/users/4561314/stackoverflowuser2010"}, "edited": false, "score": 0, "creation_date": 1482282342, "post_id": 41253582, "comment_id": 69707862, "body": "The capability you are describing is called &quot;serialization&quot;. You can create a binary tree, serialize it to a file on disk, and the deserialize it back into memory. There are many language-independent algorithms to do so. Just google &quot;binary tree serialization&quot; for a first approximation."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "edited": false, "score": 0, "creation_date": 1482357461, "post_id": 41253776, "comment_id": 69746590, "body": "I tried this method,and it doesnt work,the program crash after displaying garbage value(random value)."}], "tags": [], "owner": {"reputation": 6013, "user_id": 3310281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9b8b4ec03e2c7a424fdc428eb55f2e8?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm McLean", "link": "https://stackoverflow.com/users/3310281/malcolm-mclean"}, "is_accepted": false, "score": 1, "last_activity_date": 1482283487, "creation_date": 1482283487, "answer_id": 41253776, "question_id": 41253582, "link": "https://stackoverflow.com/questions/41253582/saving-c-binary-search-tree-to-txt-file/41253776#41253776", "title": "Saving C Binary search tree to txt file", "body": "<p>Nested parentheses and trees are alternative representations for the same thing.</p>\n\n<p>So writing a tree is easy</p>\n\n<pre><code>   void writenode(Node *node)\n   {\n      printf(\"{\");\n      printf(\"%d \", node-.value);\n      if(node-&gt;left)\n         writenode(node-&gt;left);\n      if(node-&gt;right)\n         writenode(node-&gt;right);\n      printf(\"}\");\n    }\n</code></pre>\n\n<p>Reading is quite a bit harder. You have to detect malformed input, and construct the children recursively.</p>\n"}, {"tags": [], "owner": {"reputation": 496, "user_id": 7285157, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3Zlfg.jpg?s=128&g=1", "display_name": "Dulguun", "link": "https://stackoverflow.com/users/7285157/dulguun"}, "is_accepted": false, "score": 1, "last_activity_date": 1482288934, "creation_date": 1482288934, "answer_id": 41254383, "question_id": 41253582, "link": "https://stackoverflow.com/questions/41253582/saving-c-binary-search-tree-to-txt-file/41254383#41254383", "title": "Saving C Binary search tree to txt file", "body": "<p>The easiest way to save binary tree to a <code>txt</code> file is saving them as an array. Only downside is you will waste space because it will save the binary tree as <a href=\"http://web.cecs.pdx.edu/~sheard/course/Cs163/Doc/FullvsComplete.html\" rel=\"nofollow noreferrer\">complete binary tree</a>.</p>\n\n<p>It is easy to write and even to read. Because left, right child and parent of node at <code>i</code>th index can be found as:</p>\n\n<pre><code>int left(int i) {\n    return 2*i + 1;\n}\nint right(int i) {\n    return 2*i + 2;\n}\nint parent(int i) {\n    return (i-1)/2;\n}\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/e8maD.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/e8maD.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 2903, "user_id": 3824053, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/uso1K.png?s=128&g=1", "display_name": "Douglas Su", "link": "https://stackoverflow.com/users/3824053/douglas-su"}, "is_accepted": false, "score": 0, "last_activity_date": 1482295934, "creation_date": 1482295934, "answer_id": 41255317, "question_id": 41253582, "link": "https://stackoverflow.com/questions/41253582/saving-c-binary-search-tree-to-txt-file/41255317#41255317", "title": "Saving C Binary search tree to txt file", "body": "<p>For a sparse binary tree(Binary tree which has rare nodes but height is very), One method is save its preorder and postorder traversals and then rebuild this binary tree from these two traversals to avoid saving many NULL bytes as suggested by Dulguun. </p>\n\n<p>Some examples: <a href=\"http://www.geeksforgeeks.org/full-and-complete-binary-tree-from-given-preorder-and-postorder-traversals/\" rel=\"nofollow noreferrer\">Construct Full Binary Tree from given preorder and postorder traversals\n</a></p>\n"}], "owner": {"reputation": 71, "user_id": 7231480, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/91348ab660b7bcca80facfdf0fcf3d0b?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher M.", "link": "https://stackoverflow.com/users/7231480/christopher-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1499, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1482295934, "creation_date": 1482281948, "question_id": 41253582, "link": "https://stackoverflow.com/questions/41253582/saving-c-binary-search-tree-to-txt-file", "title": "Saving C Binary search tree to txt file", "body": "<p>I am doing a C BST library and im trying to do a function that will save the binary search tree into a text file.I am quite confuse on how to do it.Heres my tree structure:</p>\n\n<pre><code>struct Node {\n    int value;\n    struct Node *left;\n    struct Node *right;\n};\n\ntypedef struct Node TNode;\ntypedef struct Node *binary_tree;\n</code></pre>\n\n<p>Creation of the tree:</p>\n\n<pre><code>binary_tree NewBinaryTree(int value_root) {\n    binary_tree newRoot = malloc(sizeof(TNode));\n    if (newRoot) {\n        newRoot-&gt;value = value_root;\n        newRoot-&gt;left = NULL;\n        newRoot-&gt;right = NULL;\n    }\n    return newRoot;\n}\n</code></pre>\n\n<p>Adding elements to it:</p>\n\n<pre><code>void Insert(binary_tree *tree, int val) {\n    if (*tree == NULL) {\n        *tree = (binary_tree)malloc(sizeof(TNode));\n        (*tree)-&gt;value = val;\n        (*tree)-&gt;left = NULL;\n        (*tree)-&gt;right = NULL;\n    } else {\n        if (val &lt; (*tree)-&gt;value) {\n            Insert(&amp;(*tree)-&gt;left, val);\n        } else {\n            Insert(&amp;(*tree)-&gt;right, val);\n        }\n    }\n}\n</code></pre>\n\n<p>I did a start of the function but I dont know how to do this:</p>\n\n<pre><code>void savetree(binary_tree *tree, char * filename)\n{\nFILE *afile;\nint remainn, counter, readsize, i;\nint *bb;\n\nafile = fopen(filename, \"wb\");\nif (afile) {\n    bb = calloc(sizeof(int), BBSIZE);  //BBSIZE =4096\n    remainn = treesize(tree);\n    counter = 0;\n    while (remainn &gt; 0) {\n        if (remainn &gt; BBSIZE) {\n            readsize = BBSIZE;\n        } else {\n            readsize = remainn;\n        }\n</code></pre>\n\n<p>Heres the treesize function:</p>\n\n<pre><code>int treesize( binary_tree tree )\n{\n    if( tree == NULL )\n    {\n        return (0) ;\n    }\n    else\n    {\n        return( 1 + treesize( tree-&gt;left ) + treesize( tree-&gt;right ) ) ;\n    }\n}\n</code></pre>\n\n<p>This savetree function is not completed but im not sure on how to complete it/if what I did is correct.</p>\n\n<p>thank you</p>\n"}, {"tags": ["c", "pointers", "struct", "linux-kernel", "linux-device-driver"], "comments": [{"owner": {"reputation": 137, "user_id": 5708483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f148a5808bc7348b1e3694f5288f1fce?s=128&d=identicon&r=PG&f=1", "display_name": "Vale132", "link": "https://stackoverflow.com/users/5708483/vale132"}, "edited": false, "score": 0, "creation_date": 1482289916, "post_id": 41253497, "comment_id": 69709576, "body": "It looks like I need to create my own <code>struct net_device_ops</code> and then assign <code>dev-&gt;netdev_ops</code> the address of that <code>struct</code>. So in general I need to learn more about how data structures are passed around in the kernel. Any links to such info would be appreciated. It seems like most of the tutorials I find have outdated kernel APIs."}], "answers": [{"tags": [], "owner": {"reputation": 44923, "user_id": 3440745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e5b88faef87b734150f28962f0c8e5?s=128&d=identicon&r=PG&f=1", "display_name": "Tsyvarev", "link": "https://stackoverflow.com/users/3440745/tsyvarev"}, "is_accepted": true, "score": 1, "last_activity_date": 1482306580, "creation_date": 1482306580, "answer_id": 41257657, "question_id": 41253497, "link": "https://stackoverflow.com/questions/41253497/read-only-error-in-assigning-driver-function-to-netdev-ops-function-pointer/41257657#41257657", "title": "&quot;Read only&quot; error in assigning driver function to netdev_ops function pointer", "body": "<blockquote>\n  <p>How can I \"override the ndo_*() functions\"</p>\n</blockquote>\n\n<p>Define your own variable of type <code>struct net_device_ops</code>, setup its fields(hooks actually) which you want to override, and assign this variable to <code>dev-&gt;netdev_ops</code>.</p>\n\n<p>Note, that according to <a href=\"http://lxr.free-electrons.com/source/include/linux/netdevice.h?v=4.4#L780\" rel=\"nofollow noreferrer\">description</a> for <code>struct net_device_ops</code>, the only field <code>.ndo_start_xmit</code> is required to be set, other fields you may leave non-initialized (that is NULL).</p>\n"}], "owner": {"reputation": 137, "user_id": 5708483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f148a5808bc7348b1e3694f5288f1fce?s=128&d=identicon&r=PG&f=1", "display_name": "Vale132", "link": "https://stackoverflow.com/users/5708483/vale132"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 41257657, "answer_count": 1, "score": 0, "last_activity_date": 1482306580, "creation_date": 1482281236, "question_id": 41253497, "link": "https://stackoverflow.com/questions/41253497/read-only-error-in-assigning-driver-function-to-netdev-ops-function-pointer", "title": "&quot;Read only&quot; error in assigning driver function to netdev_ops function pointer", "body": "<p>I'm experimenting with network drivers in a qemu VM running Ubuntu 16.04.1. <code>uname -r</code> gives 4.4.0-31-generic as the kernel version.</p>\n\n<p>In <a href=\"http://lxr.free-electrons.com/source/include/linux/netdevice.h?v=4.4\" rel=\"nofollow noreferrer\">linux/netdevice.h for that kernel version</a>, I found the comment</p>\n\n<p>\"@netdev_ops:    Includes several pointers to callbacks,\n                  if one wants to override the ndo_*() functions\"</p>\n\n<p>However, in my code, an assignment such as <code>dev-&gt;netdev_ops-&gt;ndo_open = netmod_open</code> (where netmod_open is the open method in my own driver) gives the compiler error:</p>\n\n<p><code>assignment of member 'ndo_open' in read-only object</code></p>\n\n<p>Further, <code>netdev_ops</code> is declared as <code>const</code> in the source:</p>\n\n<pre><code>const struct net_device_ops *netdev_ops;\n</code></pre>\n\n<p>How can I \"override the ndo_*() functions\" if the struct containing their pointers is <code>const</code>?</p>\n"}, {"tags": ["c", "linux", "daemon", "xserver", "idle-timer"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482279793, "post_id": 41253266, "comment_id": 69707212, "body": "Not clear what your problem is. But there is a bad smell of an XY-problem."}, {"owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482284904, "post_id": 41253266, "comment_id": 69708416, "body": "I need to use XScreenSaverQueryInfo to check system IDLE status, but i can&#39;t make it to work starting my app as a DAEMON.  when i start it from terminal, its works."}, {"owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482285054, "post_id": 41253266, "comment_id": 69708455, "body": "code follows:   xidle = XOpenDisplay(0); if (xidle) { \tXScreenSaverInfo *info = XScreenSaverAllocInfo(); \tXScreenSaverQueryInfo(xidle, DefaultRootWindow(xidle), info); \tret = (info-&gt;idle&gt;60000? (info-&gt;idle&gt;900000? 2 : 1) : 0); }"}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482286434, "post_id": 41253266, "comment_id": 69708787, "body": "The idle status is a matter of the OS, not the window-system/GUI. As I wrote: XY-problem."}, {"owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "reply_to_user": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1482287013, "post_id": 41253266, "comment_id": 69708915, "body": "Ok, i&#39;m using raspbian (Debian Based) for raspberry Pi. How to solve this?"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "is_accepted": true, "score": 0, "last_activity_date": 1482728716, "creation_date": 1482728716, "answer_id": 41326631, "question_id": 41253266, "link": "https://stackoverflow.com/questions/41253266/xopendisplay-fails-when-run-from-daemon-c-language/41326631#41326631", "title": "XOpenDisplay fails when run from daemon (C language)", "body": "<p>Just awnsering my own question, if anyone having the same issue as me.</p>\n\n<p>Detecting System Inactivity (Idle) outside X graphical interface, is just a matter of USB Keyboard / mouse activity by monitoring their IRQs (usually IRQ 1 /IRQ 12) on /proc/interrupt or more easy (supporting other USB Input like even Joysticks!) by monitoring /proc/stat  on \"softirq\" line, second numeric column that contains numeric amount of bytes transferred when these devices has some / any input (mouse moving or key pressed / released)</p>\n\n<p>This achieved easily in C by time to time, fopen / fread on these fields comparing the values with old ones.</p>\n\n<p>Thanks a lot to my intensive researchs on Linux internals &amp; User Olaf that have a huge knowledge on discover the obvious.</p>\n"}], "owner": {"reputation": 3, "user_id": 3083702, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/05aea30dbe94a43b43b104e0f9461d00?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogarcia234", "link": "https://stackoverflow.com/users/3083702/eduardogarcia234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "closed_date": 1483269299, "accepted_answer_id": 41326631, "answer_count": 1, "score": -2, "last_activity_date": 1482728716, "creation_date": 1482279279, "question_id": 41253266, "link": "https://stackoverflow.com/questions/41253266/xopendisplay-fails-when-run-from-daemon-c-language", "closed_reason": "Needs details or clarity", "title": "XOpenDisplay fails when run from daemon (C language)", "body": "<p>i'm working in a simple project on my raspberry pi, which flash some leds in differ ways on some system events (like disk reading, ethernet communications, processor overload), and these leds need to be shut off some time after system is idle (these leds will behave varying their intensity when no sys activity detected).</p>\n\n<p>To achieve idle detection, i'm using XScreenSaver, until here, everything works flawlessly. </p>\n\n<p>As my project needed to be executed as daemon (etc/init.d) and needed to run with root privileges (because the pigpio library) the communication with X Server (via XOpenDisplay) is returning NULL every time, even when system is ready and in graphical interface. On terminal, running this manually, everything works perfectly.</p>\n\n<p>as my research goes, i've understood that isn't possible to access X Server when there is no console available at boot time, and there is no way to access it for security reasons.</p>\n\n<p>so i ask, how i could achieve this (detect idle time) on a simplest way possible? ( i tried self restart, tried setting DISPLAY variable on start script nothing seems to work.)  I'm new on linux development and can't figure how to properly solve this.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1482279485, "post_id": 41253211, "comment_id": 69707119, "body": "What do these numbers 3 1 2 3 mean?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 0, "creation_date": 1482279659, "post_id": 41253211, "comment_id": 69707174, "body": "@VladfromMoscow Number of trials and number of nest box."}, {"owner": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482280023, "post_id": 41253211, "comment_id": 69707266, "body": "The first number means how many boxes i have to print, and the others are its size. The size of the box is (4n-3)x(4n-3)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482284295, "post_id": 41253653, "comment_id": 69708285, "body": "It works cool on running, but the site where i have to add contains more test cases, and has a unique compiler, so it gives me somehow: Wrong result. Tried to translate the task, i hope its understandable:"}, {"owner": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482284300, "post_id": 41253653, "comment_id": 69708288, "body": "Write a program, which draws target tables, based on input.  The input&#39;s first round holds a number, which is the counter of tests. The next rounds are the test cases. Any test is less then 50, and positive.  On the output draw a (4n - 3) x (4n - 3) size target table, which borders made of &#39;*&#39; (star) characters, the free places are &#39; &#39; (space) characters. The space between target table borders are always 1 character wide, two borders never touch. The output of the test are separated with one empty row. Warning: the last target table is not followed by an empty row!"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482284597, "post_id": 41253653, "comment_id": 69708349, "body": "<i>the last target table is not followed by an empty row!</i> ? Do it yourself."}, {"owner": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482311376, "post_id": 41253653, "comment_id": 69718067, "body": "Yea l&#39;ve been really tired, couldnt get it how it works, and tried to understand your code, since im fairly beginner in programming. Noticed i have to put a (t&gt;0) in front of the last putchar(&#39;\\n&#39;); and its accepted on the site. Thanks alot BLUEPIXY."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "edited": false, "score": 0, "creation_date": 1482311699, "post_id": 41253653, "comment_id": 69718283, "body": "Or <code>if(t)</code>. Accept(Click V)  this answer if your problem has been solved with this answer."}], "tags": [], "owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "is_accepted": true, "score": 1, "last_activity_date": 1482282459, "creation_date": 1482282459, "answer_id": 41253653, "question_id": 41253211, "link": "https://stackoverflow.com/questions/41253211/printing-out-characters-in-a-target-table-pattern/41253653#41253653", "title": "Printing out characters in a target table pattern", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdbool.h&gt;\n\nbool online(int size, int r, int c){\n    if(size &lt; 1)\n        return false;\n    int last = size-1;\n    if((r == 0 || r == last) &amp;&amp; (0 &lt;= c &amp;&amp; c &lt;= last))\n        return true;\n    if((c == 0 || c == last) &amp;&amp; (0 &lt;= r &amp;&amp; r &lt;= last))\n        return true;\n    return online(size-4, r-2, c-2);\n}\n\nint main(void){\n    int t, n, size;\n    scanf(\"%d\", &amp;t);\n    while(t--){\n        scanf(\"%d\", &amp;n);\n        size = 4*n-3;//1 + 4*(size-1);\n        for(int r = 0; r &lt; size; ++r){\n            for(int c = 0; c &lt; size; ++c){\n                if(online(size, r, c))\n                    putchar('*');\n                else\n                    putchar(' ');\n            }\n            putchar('\\n');\n        }\n        putchar('\\n');\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7323343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4242036c28dccfc2875247805c421f7e?s=128&d=identicon&r=PG&f=1", "display_name": "Zymeth Zsolti", "link": "https://stackoverflow.com/users/7323343/zymeth-zsolti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 41253653, "answer_count": 1, "score": 0, "last_activity_date": 1482282459, "creation_date": 1482278922, "last_edit_date": 1482279392, "question_id": 41253211, "link": "https://stackoverflow.com/questions/41253211/printing-out-characters-in-a-target-table-pattern", "title": "Printing out characters in a target table pattern", "body": "<p>I have to do a code in c, which is printing out <strong>target table</strong> pattern. </p>\n\n<pre><code>So input for example:\n\n3\n1\n2\n3\n\n\nand the output:\n\n*\n\n*****\n*   *\n* * *\n*   *\n*****\n\n*********\n*       *\n* ***** *\n* *   * *\n* * * * *\n* *   * *\n* ***** *\n*       *\n*********\n</code></pre>\n\n<p>I have done several tries, but its not working, cant do the mid-zones.<br>\nI've done this code, and for 1-2 its working, but i cant do for 2+.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n\nint main()\n{\n    int n,i,k;\n    int p=0;\n    int j=0,l=0;\n    int d=0;\n    scanf(\"%d\",&amp;n);\n    for(i=0; i&lt;n; i++)\n    {\n        scanf(\"%d\",&amp;k);\n        d=((4*k)-3)*((4*k)-3);\n            p=((4*k)-3);\n        for(j=0; j&lt;p; j++)\n        {\n            if(j==0 || j==p-1)\n            {\n                for(l=0; l&lt;p; l++)\n                    printf(\"*\");\n                        printf(\"\\n\");\n            }\n\n            if(j==p/2+1)\n            {\n                    for(l=0; l&lt;p; l++)\n                        {\n                        if(l%2==0) \n                            printf(\"*\");\n                        else printf(\" \");\n                        }\n                    printf(\"\\n\");\n            }\n            if(j&gt;0 &amp;&amp; j&lt;p/2)\n            {\n                    for(l=0; l&lt;p; l++)\n                    {   \n                        if(l==0 || l==p-1)\n                            printf(\"*\");\n                        else printf(\" \");\n                    }\n                    printf(\"\\n\");\n                        }\n                        if(j&gt;p/2 &amp;&amp; j&lt;p-1)\n            {\n                    for(l=0; l&lt;p; l++)\n                    {   \n                        if(l==0 || l==p-1)\n                            printf(\"*\");\n                        else printf(\" \");\n                    }\n                    printf(\"\\n\");\n                        }\n\n        }\n    }\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "bison", "lex"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 2, "creation_date": 1482278067, "post_id": 41253026, "comment_id": 69706742, "body": "Don&#39;t post links to, or pictures of, text here. Post the text. It is a complete waste of your time, which I don&#39;t care about, and our bandwidth, which I do."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482278452, "post_id": 41253026, "comment_id": 69706842, "body": "Is the &#39;<code>yacc</code>&#39; you&#39;re using actually Bison in disguise?  What do you get from <code>yacc --version</code>?  And is the &#39;<code>lex</code>&#39; you&#39;re using actually Flex in disguise?  What do you get from <code>lex --version</code>?  It may matter; original AT&amp;T Yacc and Lex are slightly different from Bison and Flex (and note that the tag for this Flex is <a href=\"https://stackoverflow.com/questions/tagged/flex-lexer\">flex-lexer</a> not <a href=\"https://stackoverflow.com/questions/tagged/flex\">flex</a>; the other is for Adobe Flex).  And one difference is the type of <code>yytext</code>.  However, the declaration vs no declaration may be a separate issue \u2014 except that it is crucial to use the correct declaration."}, {"owner": {"reputation": 13, "user_id": 7323232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae72b67f90648a46a2075cc9092762c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Nemoy", "link": "https://stackoverflow.com/users/7323232/michael-nemoy"}, "edited": false, "score": 0, "creation_date": 1482278879, "post_id": 41253026, "comment_id": 69706952, "body": "I wrote that im using flex and bison but now im added the versions."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1482279798, "post_id": 41253026, "comment_id": 69707213, "body": "But your tags said <a href=\"https://stackoverflow.com/questions/tagged/yacc\">yacc</a>. Fixed that for you too. But your command line says <code>yacc</code>. Please make up your mind. Please fix the image as requested too."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7323232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae72b67f90648a46a2075cc9092762c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Nemoy", "link": "https://stackoverflow.com/users/7323232/michael-nemoy"}, "edited": false, "score": 0, "creation_date": 1482281051, "post_id": 41253114, "comment_id": 69707532, "body": "i make those changes and now i got new error: In function &#39;yylex&#39;: request for member &#39;text&#39; in somthing not a structure or union."}, {"owner": {"reputation": 13, "user_id": 7323232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae72b67f90648a46a2075cc9092762c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Nemoy", "link": "https://stackoverflow.com/users/7323232/michael-nemoy"}, "edited": false, "score": 0, "creation_date": 1482281275, "post_id": 41253114, "comment_id": 69707595, "body": "i use it like this: [0-9]+ { yylval = strdup(yytext); return NUM; } and it worked thnks ."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "reply_to_user": {"reputation": 13, "user_id": 7323232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae72b67f90648a46a2075cc9092762c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Nemoy", "link": "https://stackoverflow.com/users/7323232/michael-nemoy"}, "edited": false, "score": 0, "creation_date": 1482281556, "post_id": 41253114, "comment_id": 69707682, "body": "So you need to declare <code>text</code> as a member of the union, as I said above. You need to look into how to use the yyunion and how to strongly type your parse tree nodes. It will help you in the long run."}], "tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 3, "last_activity_date": 1482282695, "last_edit_date": 1482282695, "creation_date": 1482278200, "answer_id": 41253114, "question_id": 41253026, "link": "https://stackoverflow.com/questions/41253026/use-yytext-in-bison-code/41253114#41253114", "title": "use yytext in bison code", "body": "<p>You should not use <code>yytext</code> in grammar rules at all. It won't always have the value you think it might have. You should save it in the <code>yyunion</code> in the scanner:</p>\n\n<pre><code>[0-9]+ { yylval.text = strdup(yytext); return NUM; }\n</code></pre>\n\n<p>and similarly for the other rules that need it, and then use it in the parser like this:</p>\n\n<pre><code>| NUM {$$=mknode($1, NULL, NULL);}\n</code></pre>\n\n<p>using the usual techniques for declaring the <code>YYUNION</code> and typing the nodes.</p>\n"}], "owner": {"reputation": 13, "user_id": 7323232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ae72b67f90648a46a2075cc9092762c?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Nemoy", "link": "https://stackoverflow.com/users/7323232/michael-nemoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2334, "favorite_count": 0, "accepted_answer_id": 41253114, "answer_count": 1, "score": -1, "last_activity_date": 1482282695, "creation_date": 1482277650, "last_edit_date": 1482280775, "question_id": 41253026, "link": "https://stackoverflow.com/questions/41253026/use-yytext-in-bison-code", "title": "use yytext in bison code", "body": "<p>When I trying to compile my code in yacc&amp;lex I get this error:\n<a href=\"https://i.stack.imgur.com/MLKBz.png%60\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MLKBz.png%60\" alt=\"this error\"></a></p>\n\n<p>yacc Code:</p>\n\n<pre><code>%{\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#define YYSTYPE struct node*\ntypedef struct node{\n    char *token;\n    struct node *left;\n    struct node *right;\n} node;\nnode* mknode(char* token, node *left, node *right);\nvoid Printtree(node *tree);\nint yyerror();\n%}\n%token NUM PLUS MINUS\n%left PLUS MINUS\n%%\nS:exp {printf(\"OK\\n\"); Printtree($1);};\nexp:exp PLUS exp {$$=mknode(\"+\",$1,$3);}\n    | exp MINUS exp{$$=mknode(\"-\",$1,$3);}\n    | NUM {$$=mknode(yytext, NULL, NULL);};\n%%\n#include \"lex.yy.c\"\nint main(){\n    return yyparse();\n}\nnode *mknode (char *token, node *left, node *right){\n    node *newnode = (node*)malloc(sizeof(node));\n    char *newstr = (char*)malloc(sizeof(token)+1);\n    strcpy (newstr, token);\n    newnode-&gt;left=left;\n    newnode-&gt;right=right;\n    newnode-&gt;token=newstr;\n    return newnode;\n}\nvoid Printtree(node* tree){\n    printf(\"%s\\n\", tree-&gt;token);\n    if (tree-&gt;left)\n        Printtree(tree-&gt;left);\n    if (tree-&gt;right)\n        Printtree(tree-&gt;right);\n}\nint yyerror(){\n    printf(\"ERROR\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>and the lex Code</p>\n\n<pre><code>%%\n[0-9]+ return NUM;\n\\+ return PLUS;\n\\- return MINUS;\n%%\n</code></pre>\n\n<p>when i trying to change the yytext to $1 is compiled but when i run the code and type for example 5+6 is saying: (segmentation fault (core dumped))</p>\n\n<p>using ubuntu 64:</p>\n\n<p>lex compile with flex version lex 2.6.0:</p>\n\n<pre><code>lex subProject.lex\n</code></pre>\n\n<p>and yacc compile with bison version bison(GNU Bison) 3.0.4:</p>\n\n<pre><code>yacc subProject.yacc\n</code></pre>\n\n<p>and the error maker:</p>\n\n<pre><code>cc subProject -o y.tab.c -ll -Ly\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 1, "creation_date": 1482276633, "post_id": 41252808, "comment_id": 69706332, "body": "<code>fgets</code> does not compare strings. For <code>strcmp</code> it does not matter <b>how</b> the strings are created. And what about the documentation of the functions don&#39;t you understand?"}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1482276633, "post_id": 41252808, "comment_id": 69706333, "body": "Try <code>printf(&quot;&lt;%s&gt;\\n&quot;,string);</code> to see what you are reading with <code>fgets()</code>."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1482277049, "post_id": 41252808, "comment_id": 69706465, "body": "<code>strcmp(string,&quot;mother\\n&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 16091, "user_id": 4975822, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c04e8c4c984d36bea8a6239574980fbd?s=128&d=identicon&r=PG&f=1", "display_name": "artm", "link": "https://stackoverflow.com/users/4975822/artm"}, "is_accepted": false, "score": 3, "last_activity_date": 1482276369, "creation_date": 1482276369, "answer_id": 41252824, "question_id": 41252808, "link": "https://stackoverflow.com/questions/41252808/string-compare-in-c-with-fgets/41252824#41252824", "title": "String compare in c with fgets", "body": "<pre><code> if(string ==\"mother\")  // won't work\n</code></pre>\n\n<p>You can't compare C strings directly with <code>==</code>. Use standard library function <code>strcmp</code> instead</p>\n\n<pre><code>if( 0 == strcmp(string, \"mother\") )\n{\n    printf( \"equal\" );\n}\n</code></pre>\n\n<p>Also you would need to remove <code>\\n</code> from <code>fgets</code>, otherwise the string comparison deems to false.</p>\n\n<pre><code>fgets(string,20,stdin);\nstring[strcspn(string, \"\\n\")] = 0;   // without this, `strcmp` would return false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "is_accepted": false, "score": 0, "last_activity_date": 1482276450, "creation_date": 1482276450, "answer_id": 41252837, "question_id": 41252808, "link": "https://stackoverflow.com/questions/41252808/string-compare-in-c-with-fgets/41252837#41252837", "title": "String compare in c with fgets", "body": "<p>From the man page for <code>fgets()</code>:</p>\n\n<pre><code>fgets()  reads in at most one less than size characters from stream and\nstores them into the buffer pointed to by s.  Reading  stops  after  an\nEOF  or a newline.  If a newline is read, it is stored into the buffer.\nA terminating null byte ('\\0') is stored after the  last  character  in\nthe buffer.\n</code></pre>\n\n<p>Have you checked if there is a newline character appended to your input?  <code>\"mother\"</code> is not the same as <code>\"mother\\n\"</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 2, "creation_date": 1482277208, "post_id": 41252860, "comment_id": 69706508, "body": "Suggest <code>if(len &gt; 1</code> --&gt; <code>if(len &gt; 0</code>"}], "tags": [], "owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "is_accepted": false, "score": 0, "last_activity_date": 1482329211, "last_edit_date": 1482329211, "creation_date": 1482276570, "answer_id": 41252860, "question_id": 41252808, "link": "https://stackoverflow.com/questions/41252808/string-compare-in-c-with-fgets/41252860#41252860", "title": "String compare in c with fgets", "body": "<p><code>fgets</code> does not remove the new-line (<code>\\n</code>) from the input. You should remove it (if present) before comparing the strings:</p>\n\n<pre><code>char string[20];\nfgets(string,20,stdin);\n\nint len = strlen(string);\n// len-1 is the last character before the original \\0\nif(len &gt; 0 &amp;&amp; string[len-1] == '\\n'){\n    // remove the new-line by ending the string sooner\n    string[len-1] = '\\0';\n}\n\nif(strcmp(string,\"mother\")==0)\n</code></pre>\n\n<p>Your second attempt, comparing two strings using <code>==</code> directly will definitely not work.</p>\n"}, {"tags": [], "owner": {"reputation": 22954, "user_id": 5238915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fncqh.jpg?s=128&g=1", "display_name": "RoadRunner", "link": "https://stackoverflow.com/users/5238915/roadrunner"}, "is_accepted": false, "score": 1, "last_activity_date": 1482286222, "creation_date": 1482286222, "answer_id": 41254057, "question_id": 41252808, "link": "https://stackoverflow.com/questions/41252808/string-compare-in-c-with-fgets/41254057#41254057", "title": "String compare in c with fgets", "body": "<p>As others have said, you can't compare strings with <code>==</code>. In order for your code to work, you need to strip the <code>\\n</code> character appended from <code>fgets()</code>. Otherwise you are comparing:</p>\n\n<pre><code>if (strcmp(\"mother\\n\", \"mother\") == 0) {\n</code></pre>\n\n<p>Which will always be false, unless you remove the <code>\\n</code> character.</p>\n\n<p>Since <code>fgets()</code> returns <code>NULL</code> if unsuccessful when reading input from the user, it is also safe to check that, like this:</p>\n\n<pre><code>if (fgets(string, 20, stdin) == NULL) {\n    /* Exit program */\n}\n</code></pre>\n\n<p>You can also add some extra error checking for <code>fgets()</code>, such as checking for buffer overflow, which can be checked like this:</p>\n\n<pre><code>slen = strlen(string);\nif (slen &gt; 0) {\n    if (string[slen-1] == '\\n') {\n        string[slen-1] = '\\0';\n    } else {\n        /* Exit program */\n    }\n}\n</code></pre>\n\n<p>After these considerations, your code can possibly look like this:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\n#define BUFFSIZE 20\n\nint\nmain(int argc, char *argv[]) {\n    char string[BUFFSIZE];\n    size_t slen;\n    const char *compare = \"mother\";\n\n    printf(\"Enter a string: \");\n    if (fgets(string, BUFFSIZE, stdin) == NULL) {\n        printf(\"Error reading string into buffer.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    slen = strlen(string);\n    if (slen &gt; 0) {\n        if (string[slen-1] == '\\n') {\n            string[slen-1] = '\\0';\n        } else {\n            printf(\"Buffer overflow. Exceeded buffer size of %d.\\n\", BUFFSIZE);\n            exit(EXIT_FAILURE);\n        }\n    } \n\n    if (!*string) {\n        printf(\"No string entered.\\n\");\n        exit(EXIT_FAILURE);\n    }\n\n    printf(\"My string = %s.\\n\", string);\n    if (strcmp(string, compare) == 0) {\n        printf(\"They are the same.\\n\");\n    } else {\n        printf(\"They are not the same.\\n\");\n    }\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 7269235, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/114c66e128556bd9b07232479450666d?s=128&d=identicon&r=PG&f=1", "display_name": "NewUser2810", "link": "https://stackoverflow.com/users/7269235/newuser2810"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4251, "favorite_count": 0, "closed_date": 1515361587, "answer_count": 4, "score": -1, "last_activity_date": 1515356399, "creation_date": 1482276280, "last_edit_date": 1515356399, "question_id": 41252808, "link": "https://stackoverflow.com/questions/41252808/string-compare-in-c-with-fgets", "closed_reason": "Duplicate", "title": "String compare in c with fgets", "body": "<p>this is just a simple code i just wrote and i dont understand why it wont give me true when i type mother in the stream. It's logical for me when they compare each other it must be the same or?<br>\nthis is my simple code:</p>\n\n<pre><code> char string[20];\n fgets(string,20,stdin);\n\n printf(\"%s\",string);\n\n if(strcmp(string,\"mother\")==0)\n {\n   printf(\"they are the same\");\n }\n else\n {\n     printf(\"they are not\");\n }\n</code></pre>\n\n<p>i also tried with </p>\n\n<pre><code> if(string ==\"mother\")\n \\\\do something\n</code></pre>\n\n<p>but it wont just give me true can someone help me</p>\n"}, {"tags": ["c", "winforms", "case-sensitive"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482275211, "post_id": 41252606, "comment_id": 69705913, "body": "What is the problem? You want to print it <code>qwe</code> or you don&#39;t want it to print it?"}, {"owner": {"reputation": 11, "user_id": 7315076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2633931721acd99a2d6d77ea6e706fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Berkay Menev\u015fe", "link": "https://stackoverflow.com/users/7315076/berkay-menev%c5%9fe"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482275241, "post_id": 41252606, "comment_id": 69705923, "body": "when i print A , i want it to print qwe.but when i press &#39;a&#39; , i dont want it to print qwe."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1482275333, "post_id": 41252606, "comment_id": 69705953, "body": "You should check the state of <code>shift</code> key as well then. Perhaps <code>Caps lock</code> too."}, {"owner": {"reputation": 11, "user_id": 7315076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2633931721acd99a2d6d77ea6e706fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Berkay Menev\u015fe", "link": "https://stackoverflow.com/users/7315076/berkay-menev%c5%9fe"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1482275416, "post_id": 41252606, "comment_id": 69705970, "body": "So caps lock being on or off won&#39;t make a difference and i need to make another check on if VK_SHIFT is being pushed?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1482277070, "post_id": 41252606, "comment_id": 69706473, "body": "&#39;a&#39; and &#39;A&#39; are the same key... unless your keyboard has separate keys for &#39;a&#39; and &#39;A&#39;?"}, {"owner": {"reputation": 25134, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1482284578, "post_id": 41252606, "comment_id": 69708345, "body": "@BerkayMenev\u015fe you should post the solution you&#39;ve found as a self-answer instead of editing it into the question."}, {"owner": {"reputation": 11, "user_id": 7315076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2633931721acd99a2d6d77ea6e706fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Berkay Menev\u015fe", "link": "https://stackoverflow.com/users/7315076/berkay-menev%c5%9fe"}, "edited": false, "score": 0, "creation_date": 1482291440, "post_id": 41252606, "comment_id": 69709927, "body": "Hmm sorry it was my first question so i dont know what you mean by post the solution.if you explain how to do it to me i will do it next time"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "edited": false, "score": 0, "creation_date": 1482488702, "post_id": 41252606, "comment_id": 69801433, "body": "A question is a question. Post the answer as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 1, "last_activity_date": 1482488818, "creation_date": 1482488818, "answer_id": 41299625, "question_id": 41252606, "link": "https://stackoverflow.com/questions/41252606/how-can-i-make-getkeystate-understand-the-capital-and-noncapital-letters/41299625#41299625", "title": "How can I make GetKeyState understand the capital and noncapital letters", "body": "<p>Thanks @EugeneSh., solution is to check the state of <code>VK_CAPITAL</code>, see if <kbd>Shift</kbd> is on:</p>\n\n<pre><code>if((GetAsyncKeyState('A') &amp; 0x41) &amp;&amp; GetKeyState(VK_CAPITAL)) {\n    key_pressed=KEY_A; printf(\"qwe\");\n}\nif((GetAsyncKeyState('B') &amp; 0x8008) &amp;&amp; !GetKeyState(VK_CAPITAL)) {\n    key_pressed=KEY_B; printf(\"asd\");\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7315076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2633931721acd99a2d6d77ea6e706fd9?s=128&d=identicon&r=PG&f=1", "display_name": "Berkay Menev\u015fe", "link": "https://stackoverflow.com/users/7315076/berkay-menev%c5%9fe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1482488818, "creation_date": 1482275102, "last_edit_date": 1482488702, "question_id": 41252606, "link": "https://stackoverflow.com/questions/41252606/how-can-i-make-getkeystate-understand-the-capital-and-noncapital-letters", "title": "How can I make GetKeyState understand the capital and noncapital letters", "body": "<p>Hey guys I'm using Codeblocks from C. I read <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms646301(v=vs.85).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/windows/desktop/ms646301(v=vs.85).aspx</a> but I can't understand what I need to change in this code to make it case-sensitive.</p>\n\n<pre><code>void getInput()\n{\n    while(1)\n    {\n        if((GetAsyncKeyState('A') &amp; 0x8008)) {\n            printf(\"qwe\");\n        }\n    }\n}\n</code></pre>\n\n<p>Code works and I don't get any errors. Only problem is this doesn't differentiate between pressing <code>a</code> or <code>A</code>, it will print <code>qwe</code> in both cases. How can I fix this?</p>\n"}, {"tags": ["c", "variadic"], "comments": [{"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 0, "creation_date": 1482275174, "post_id": 41252585, "comment_id": 69705901, "body": "You have a bug in your implementation of that function. I suggest to start by reading the appropriate manuals around <code>&lt;stdarg.h&gt;</code>."}, {"owner": {"reputation": 165665, "user_id": 721269, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/346ca03edfbde2a468adc289867ab975?s=128&d=identicon&r=PG", "display_name": "David Schwartz", "link": "https://stackoverflow.com/users/721269/david-schwartz"}, "edited": false, "score": 5, "creation_date": 1482275333, "post_id": 41252585, "comment_id": 69705954, "body": "Give us enough code to replicate the error."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 4, "creation_date": 1482275489, "post_id": 41252585, "comment_id": 69705993, "body": "Where&#39;s the declaration of the function?  Your call relies on the implicit conversion of <code>0</code> to <code>0.0</code> under the scope of a prototype.  Omitting the prototype where the function is called is inherently undefined behaviour; you must <i>always</i> have a prototype in scope before calling a variadic function.  Your function is crashing, but you&#39;ve not shown how you&#39;ve implemented the function.  How do you expect us to help you debug it?  There are lots of things you could be doing wrong; many of them could lead to a crash.  Please include an MCVE (<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) that reproduces the crash."}, {"owner": {"reputation": 10627, "user_id": 1537925, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U8DRJ.png?s=128&g=1", "display_name": "The Vee", "link": "https://stackoverflow.com/users/1537925/the-vee"}, "edited": false, "score": 1, "creation_date": 1482276300, "post_id": 41252585, "comment_id": 69706247, "body": "You can see that the <code>sizeData</code> got misaligned, this looks more like some pointer (<code>0x402099</code>). If this function is declared in a different translation unit, my guess is that the declaration does not agree with the definition. Try passing something like <code>3.14</code> for <code>sec</code> and debugging again. But first, compile your program with all warnings enabled."}, {"owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482280933, "post_id": 41252585, "comment_id": 69707502, "body": "@JonathanLeffler: surprisingly, I think there&#39;s enough information here to answer the mismatch between caller and callee arg values.  (Well spotted with the implicit declaration, I hadn&#39;t considered the possibility that the OP left that out.  Did you clue in to that from gdb&#39;s arg mismatch?)"}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1482286784, "post_id": 41252585, "comment_id": 69708855, "body": "@PeterCordes: the problems GDB was having suggested something along those lines.  I&#39;d&#39;ve preferred to get the info from the OP, but your inference is probably correct."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "edited": false, "score": 0, "creation_date": 1482330145, "post_id": 41253448, "comment_id": 69730645, "body": "Thanks Peter! I made the changes you listed and work perfectly (the <i>double</i> number (duh), the function declaration) . Sorry if i couldn&#39;t answer before, yesterday was a chaotic day D:"}], "tags": [], "owner": {"reputation": 240639, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 2, "last_activity_date": 1482290979, "last_edit_date": 1482290979, "creation_date": 1482280772, "answer_id": 41253448, "question_id": 41252585, "link": "https://stackoverflow.com/questions/41252585/c-variadic-function-compiles-but-gives-segmentation-fault/41253448#41253448", "title": "C - Variadic function compiles but gives segmentation fault", "body": "<p>Based on the gdb output, it looks like the caller didn't have a prototype for the function it was calling.  As @JonathanLeffler noticed, you wrote <code>0</code> instead of <code>0.0</code>, so it's passing an integer where the callee is expecting a <code>double</code>.</p>\n\n<hr>\n\n<p>Judging from the pointer value, this is probably on x86-64 Linux with the System V calling convention, where the register assigned for an arg is determined by it being e.g. the third <em>integer</em> arg.  (See the <a href=\"/questions/tagged/x86\" class=\"post-tag\" title=\"show questions tagged &#39;x86&#39;\" rel=\"tag\">x86</a> wiki for ABI/calling convention docs).</p>\n\n<p>So if the caller and callee disagree about the function signature, they will disagree about which arg goes in which register, which I think explains why gdb is showing args that don't match the caller.</p>\n\n<hr>\n\n<p>In this case, the caller puts <code>\"Connect\"</code> (the address) in RCX, because it's the 4th integer/pointer arg with that implicit declaration.</p>\n\n<p>The caller looks for the value of <code>service</code> in RDX, because its caller's 3rd integer/pointer arg.</p>\n\n<p><code>sec</code> is 0.0 in the callee apparently by chance.  It's just using whatever was sitting in XMM0.  Or maybe <em>possibly</em> uninitialized stack space, since the caller would have set <code>AL=0</code> to indicate that no FP args were passed in registers (necessary for variadic functions only).  Note <code>al</code> = number of fp register args includes the fixed non-variadic args when the prototype is available.  Compiling your call <em>with</em> the prototype available includes a <code>mov eax, 1</code> before the <code>call</code>.  See the source+asm for compiling with/without the prototype <a href=\"http://gcc.godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,options:(colouriseAsm:&#39;0&#39;,compileOnChange:&#39;0&#39;),source:&#39;//+compile+both+ways+to+see+the+difference:%0A//+only+one+of+the+gcc+windows+uses+-DUSE_PROTO%0A%0A%23ifdef+USE_PROTO%0Avoid+mqbLog(char+*type,%0A++++++++++++int++numContext,%0A++++++++++++double+sec,%0A++++++++++++char+*service,%0A++++++++++++int+++sizeData,%0A++++++++++++char+*data,%0A++++++++++++char+*fmt,%0A++++++++++++...%0A++++++++++++)%3B%0A%23endif%0A%0Avoid+foo()+%7B%0A++mqbLog(%22LOG_INFORMATION%22,0,0,%22Connect%22,%0A+++++++++0,%22%22,%22Parameter+received%22)%3B++%0A%7D&#39;),l:&#39;5&#39;,n:&#39;1&#39;,o:&#39;C%2B%2B+source+%231&#39;,t:&#39;0&#39;)),k:33.333333333333336,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g62,filters:(b:&#39;0&#39;,commentOnly:&#39;0&#39;,directives:&#39;0&#39;,intel:&#39;0&#39;),options:&#39;-DUSE_PROTO+-xc+-Wall+-Wextra+-O3&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%231+with+x86-64+gcc+6.2&#39;,t:&#39;0&#39;)),k:33.333333333333336,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;),(g:!((h:compiler,i:(compiler:g62,filters:(b:&#39;0&#39;,commentOnly:&#39;0&#39;,directives:&#39;0&#39;,intel:&#39;0&#39;),options:&#39;-UUSE_PROTO+-xc+-Wall+-Wextra+-O3&#39;),l:&#39;5&#39;,n:&#39;0&#39;,o:&#39;%231+with+x86-64+gcc+6.2&#39;,t:&#39;0&#39;)),k:33.33333333333333,l:&#39;4&#39;,n:&#39;0&#39;,o:&#39;&#39;,s:0,t:&#39;0&#39;)),l:&#39;2&#39;,n:&#39;0&#39;,o:&#39;&#39;,t:&#39;0&#39;)),version:4\" rel=\"nofollow noreferrer\">on the Godbolt compiler explorer</a>.</p>\n\n<p>In a different calling convention (e.g. <code>-m32</code> with stack args), things would break at least a badly because those args would be passed on the stack, but <code>int</code> and <code>double</code> are different sizes.</p>\n\n<hr>\n\n<p>Writing <code>0.0</code> for the FP args would make the implicit declaration match the definition.  <strong>But don't do this, it's still a terrible idea to call undeclared functions</strong>.  Use <code>-Wall</code> to have the compiler tell you when your code does bad things.</p>\n\n<p>You function might still crash; who knows what other bugs you have in code that's not shown?</p>\n\n<hr>\n\n<p>When your code crashes, you should look at the asm instruction it crashed on to figure out which pointer was bad \u2014 e.g. run <code>disas</code> in gdb.  Even if you don't understand it yourself, including that in a debugging-help question (along with register values) can help a lot.</p>\n"}], "owner": {"reputation": 27, "user_id": 6377586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29678ff17c8a832774b49b7110f4fabe?s=128&d=identicon&r=PG&f=1", "display_name": "Alan Bry", "link": "https://stackoverflow.com/users/6377586/alan-bry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 41253448, "answer_count": 1, "score": -3, "last_activity_date": 1482290979, "creation_date": 1482274974, "last_edit_date": 1482275756, "question_id": 41252585, "link": "https://stackoverflow.com/questions/41252585/c-variadic-function-compiles-but-gives-segmentation-fault", "title": "C - Variadic function compiles but gives segmentation fault", "body": "<p>I have a variadic function in C to write in a log file, but as soon as it is invoked, it gives a segmentation fault in the header.</p>\n\n<p>In the main process, the call has this format: </p>\n\n<pre><code>mqbLog(\"LOG_INFORMATION\",0,0,\"Connect\",0,\"\",\"Parameter received\");  \n</code></pre>\n\n<p>and the function is defined this way:</p>\n\n<pre><code>void mqbLog(char *type,\n            int  numContext,\n            double sec,\n            char *service,\n            int   sizeData,\n            char *data,\n            char *fmt,\n            ...\n            )\n{  \n    //write the log in the archive\n}\n</code></pre>\n\n<p>It compiles OK. When I debug the process, the call to the <code>mqbLog</code> function is done, and it gives me the segmentation fault in the open bracket of the function, so I can ask about the function values:</p>\n\n<pre><code>(gdb) p type\n$1 = 0x40205e \"LOG_INFORMATION\"\n(gdb) p numContext\n$2 = 0\n(gdb) p sec\n$3 = 0\n(gdb) p service\n$4 = 0x0\n(gdb) p sizeData\n$5 = 4202649\n(gdb) p data\n$6 = 0x0\n</code></pre>\n\n<p>Any ideas will be gratefully received.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482273283, "post_id": 41252269, "comment_id": 69705282, "body": "I think old versions of the C standard didn&#39;t say that extra elements should be zeroed."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1482273286, "post_id": 41252269, "comment_id": 69705283, "body": "Hint: what happens when you write <code>char string[] = { &#39;t&#39;, &#39;e&#39;, &#39;s&#39;, &#39;t&#39; };</code>? Would this be good to pass to printf()?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 1, "creation_date": 1482273313, "post_id": 41252269, "comment_id": 69705295, "body": "@Jens That&#39;s different, because it doesn&#39;t specify the array size."}, {"owner": {"reputation": 1101, "user_id": 2367906, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d55426325cd9ba964101cc36d28dedef?s=128&d=identicon&r=PG&f=1", "display_name": "adnan_e", "link": "https://stackoverflow.com/users/2367906/adnan-e"}, "reply_to_user": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "edited": false, "score": 0, "creation_date": 1482273319, "post_id": 41252269, "comment_id": 69705298, "body": "@Jens that&#39;s different, you didn&#39;t specify the array length."}, {"owner": {"reputation": 61555, "user_id": 648658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/75ee864ee3bef78f2a144398789fed25?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/648658/jens"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1482273377, "post_id": 41252269, "comment_id": 69705324, "body": "@Barmar Exactly my point. It&#39;s defensive programming. You can switch from one to the other without ill effect."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1482274024, "post_id": 41252269, "comment_id": 69705527, "body": "@Barmar: C90 says (&#167;6.5.7 Initialization): <i>If there are fewer initializers in a brace-enclosed list than there are members of an aggregate, the remainder of the aggregate shall be initialized implicitly the same as objects that have static storage duration.</i>  (Aggregate means &#39;structure or array&#39; in this context.)"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1482274267, "post_id": 41252269, "comment_id": 69705613, "body": "@JonathanLeffler I mean really old, like K&amp;R."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1482275049, "post_id": 41252269, "comment_id": 69705855, "body": "@Barmar: Since C90 largely standardized what K&amp;R said happened (at least in the language), I&#39;d be surprised to find that K&amp;R 1st Edition didn&#39;t say the equivalent of what the C90 standard says (and even more surprised to find a compiler of that era that didn&#39;t implement what the standard says should happen).  However, my K&amp;R1 is at home and I&#39;m not, so I can&#39;t readily verify that just yet.  I doubt if it is critical to anyone except antiques like myself who worked with such ancient compilers."}], "answers": [{"tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 1, "last_activity_date": 1482273356, "creation_date": 1482273356, "answer_id": 41252315, "question_id": 41252269, "link": "https://stackoverflow.com/questions/41252269/why-do-we-put-the-null-terminator-in-brace-enclosed-char-array-initialization/41252315#41252315", "title": "Why do we put the null terminator in brace enclosed char array initialization", "body": "<p>Adding null terminator is absolutely unnecessary when you specify the size of your character array explicitly, and allocate more chars than is needed for the payload portion of your string. In this situation the standard requires that the remaining chars be initialized with zeros.</p>\n\n<p>The only time when it is necessary is when you want the size of a null-terminated array to be determined automatically by the compiler, i.e.</p>\n\n<pre><code>char string[] = {'t', 'e', 's', 't', '\\0' };\n//         ^^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10627, "user_id": 1537925, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U8DRJ.png?s=128&g=1", "display_name": "The Vee", "link": "https://stackoverflow.com/users/1537925/the-vee"}, "is_accepted": true, "score": 4, "last_activity_date": 1482273832, "last_edit_date": 1482273832, "creation_date": 1482273364, "answer_id": 41252316, "question_id": 41252269, "link": "https://stackoverflow.com/questions/41252269/why-do-we-put-the-null-terminator-in-brace-enclosed-char-array-initialization/41252316#41252316", "title": "Why do we put the null terminator in brace enclosed char array initialization", "body": "<p>You're right (see \"Initialization from brace-enclosed lists\" <a href=\"http://en.cppreference.com/w/c/language/array_initialization\" rel=\"nofollow noreferrer\">here</a>). But it's a good practice because this would also compile without complaints:</p>\n\n<pre><code>char string[4] = {'t', 'e', 's', 't'};\n</code></pre>\n\n<p>but wouldn't null-terminate anything, which would lead to errors whenever you would use that as a string. If you say</p>\n\n<pre><code>char string[4] = {'t', 'e', 's', 't', '\\0'};\n</code></pre>\n\n<p>the compiler will know it's an error because the <code>'\\0'</code> won't fit.</p>\n\n<p>Note that it's superior even to</p>\n\n<pre><code>char string[100] = \"test\";\n</code></pre>\n\n<p>for the same reason:</p>\n\n<pre><code>char string[4] = \"test\";\n</code></pre>\n\n<p>does the same as the first example, not the second!</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user743382"}, "is_accepted": false, "score": 2, "last_activity_date": 1482273401, "creation_date": 1482273401, "answer_id": 41252319, "question_id": 41252269, "link": "https://stackoverflow.com/questions/41252269/why-do-we-put-the-null-terminator-in-brace-enclosed-char-array-initialization/41252319#41252319", "title": "Why do we put the null terminator in brace enclosed char array initialization", "body": "<p>It's to prevent silly mistakes. The first null character is required if the characters are to be interpreted as a string.</p>\n\n<pre><code>char string[4] = {'t', 'e', 's', 't'};\n</code></pre>\n\n<p>will happily compile, but will not be null-terminated.</p>\n\n<pre><code>char string[4] = {'t', 'e', 's', 't', '\\0'};\n</code></pre>\n\n<p>will fail to compile, which is the point.</p>\n\n<p>By explicitly specifying the null character, the compiler will verify that the array is large enough for its intended purpose.</p>\n"}], "owner": {"reputation": 1101, "user_id": 2367906, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d55426325cd9ba964101cc36d28dedef?s=128&d=identicon&r=PG&f=1", "display_name": "adnan_e", "link": "https://stackoverflow.com/users/2367906/adnan-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 41252316, "answer_count": 3, "score": 1, "last_activity_date": 1482276752, "creation_date": 1482273122, "last_edit_date": 1482276752, "question_id": 41252269, "link": "https://stackoverflow.com/questions/41252269/why-do-we-put-the-null-terminator-in-brace-enclosed-char-array-initialization", "title": "Why do we put the null terminator in brace enclosed char array initialization", "body": "<p>I noticed that in many books and online tutorials when C strings are initialized using brace enclosed lists, it is done like this:</p>\n\n<pre><code>char string[100] = {'t', 'e', 's', 't', '\\0' };\n</code></pre>\n\n<p>Shouldn't all unspecified values automatically be set to 0 (aka <code>'\\0'</code>)?</p>\n\n<p>I tested this on multiple versions of GCC and MSVC, all values are indeed set to zero, but I'm wondering if there's a specific reason for explicitly writing the null terminator when initializing.</p>\n"}]