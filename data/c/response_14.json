[{"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1429142113, "post_id": 29662972, "comment_id": 47465428, "body": "You may want to read about the <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow noreferrer\"><code>realloc</code></a> function. Also, you <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc/605858#605858\">should not cast the result of <code>malloc</code> (or <code>realloc</code>)</a>."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1429142297, "post_id": 29662972, "comment_id": 47465486, "body": "It looks like you are using a C++ compiler to compile C. (struct definitions are not typedefs in C, in C++ they are)"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429142808, "post_id": 29662972, "comment_id": 47465634, "body": "so you fixed your assert problem then - did you update the question or accept an answer? Just looked - no you didnt"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 2, "creation_date": 1429143080, "post_id": 29662972, "comment_id": 47465709, "body": "By the way, don&#39;t use <code>assert</code> as a method to check for errors from functions, in &quot;release&quot; builds the <code>assert</code> <i>preprocessor macro</i> does nothing. It might be okay for simple school or book assignments, but using it instead of a proper <code>if</code> check in real life is a big no-no. Better learn it early to get good habits going from the start."}], "answers": [{"tags": [], "owner": {"reputation": 3825, "user_id": 768323, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b6242b58eadb9496f67ef57398d1c506?s=128&d=identicon&r=PG", "display_name": "Paul Nikonowicz", "link": "https://stackoverflow.com/users/768323/paul-nikonowicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1429142144, "creation_date": 1429142144, "answer_id": 29663004, "question_id": 29662972, "link": "https://stackoverflow.com/questions/29662972/resizing-an-array-within-a-struct-in-c/29663004#29663004", "title": "Resizing an array within a struct in C", "body": "<p>What about using <a href=\"http://www.tutorialspoint.com/c_standard_library/c_function_realloc.htm\" rel=\"nofollow\">realloc</a>?</p>\n\n<blockquote>\n  <p>The C library function void *realloc(void *ptr, size_t size) attempts to resize the memory block pointed to by ptr that was previously allocated with a call to malloc or calloc.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429142463, "post_id": 29663016, "comment_id": 47465533, "body": "While you&#39;re technically correct, assigning back to the original pointer you reallocate can lead to memory leaks. Think about the case when <code>realloc</code> fail, then the original pointer will be lost."}, {"owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429142701, "post_id": 29663016, "comment_id": 47465597, "body": "@JoachimPileborg quite right, but as OP is using <code>assert</code> to test his <code>malloc</code>s he can also just use <code>assert</code> on the result of <code>realloc</code> and bail (albeit uncleanly) out of the program entirely."}], "tags": [], "owner": {"reputation": 7792, "user_id": 249237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QjPtI.png?s=128&g=1", "display_name": "Kninnug", "link": "https://stackoverflow.com/users/249237/kninnug"}, "is_accepted": false, "score": 1, "last_activity_date": 1429142234, "creation_date": 1429142234, "answer_id": 29663016, "question_id": 29662972, "link": "https://stackoverflow.com/questions/29662972/resizing-an-array-within-a-struct-in-c/29663016#29663016", "title": "Resizing an array within a struct in C", "body": "<p>Fortunately, you don't need to move memory around yourself: <a href=\"http://en.cppreference.com/w/c/memory/realloc\" rel=\"nofollow\"><code>realloc</code></a> does that for you.</p>\n\n<p>In your case a typical usage would be:</p>\n\n<pre><code>v-&gt;capacity = newCap;\nv-&gt;data = realloc(v-&gt;data, newCap * sizeof *v-&gt;data); /* same as sizeof(TYPE) */\n</code></pre>\n\n<p>Note that you don't have to (and shouldn't) cast the result of malloc/calloc or realloc.</p>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 1539300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23602ded3acb980df308d961edc946ef?s=128&d=identicon&r=PG", "display_name": "alenz316", "link": "https://stackoverflow.com/users/1539300/alenz316"}, "is_accepted": false, "score": 0, "last_activity_date": 1429142638, "last_edit_date": 1495535045, "creation_date": 1429142638, "answer_id": 29663081, "question_id": 29662972, "link": "https://stackoverflow.com/questions/29662972/resizing-an-array-within-a-struct-in-c/29663081#29663081", "title": "Resizing an array within a struct in C", "body": "<p>Use <code>realloc()</code>!</p>\n\n<p><a href=\"https://stackoverflow.com/questions/9142805/do-we-lost-data-in-a-buffer-after-reallocing\">See this question and answer</a> to better understand <code>realloc</code> and how its used.</p>\n"}, {"tags": [], "owner": {"reputation": 2792, "user_id": 3125367, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/650027e104822e3cd1be56bb90fa5271?s=128&d=identicon&r=PG&f=1", "display_name": "user3125367", "link": "https://stackoverflow.com/users/3125367/user3125367"}, "is_accepted": false, "score": 0, "last_activity_date": 1429144870, "last_edit_date": 1429144870, "creation_date": 1429143741, "answer_id": 29663251, "question_id": 29662972, "link": "https://stackoverflow.com/questions/29662972/resizing-an-array-within-a-struct-in-c/29663251#29663251", "title": "Resizing an array within a struct in C", "body": "<p>Dynamic generic arrays in C are unexpectedly easy.</p>\n\n<p>Appending/inserting elements:</p>\n\n<pre><code>size_t size = 0, count = 0;\nmytype_t *items; // array of mytype_t\n\nmytype_t foo1, foo2, foo3;\n\ncarray_grow(items, size, count += 1); // grow to 1\nitems[0] = foo3;\n\ncarray_grow(items, size, count += 2); // grow to 3\ncarray_insert(items, count, 0, 2); // shift 2 up at 0\nitems[0] = foo1;\nitems[1] = foo2;\n</code></pre>\n\n<p>Removing elements:</p>\n\n<pre><code>carray_remove(items, count, 0, 2); // remove 2 at 0\ncarray_grow(items, size, count -= 2); // shrink to 1\n</code></pre>\n\n<p>Free it completely?</p>\n\n<pre><code>carray_grow(items, size, count = 0);\n</code></pre>\n\n<p>Backend (few defines and single function ahead):</p>\n\n<pre><code>int carray_xgrow(void **datap, size_t *sizep, size_t esize, size_t count);\n// 0 or -1/errno(realloc)\n\n#define carray_grow(array, size, count) carray_xgrow((void **)&amp;(array), &amp;(size), sizeof((array)[0]), count)\n// 0 or -1/errno(realloc)\n\n#define carray_move(array, from, to, n) memmove(&amp;(array)[to], &amp;(array)[from], sizeof((array)[0]) * (n))\n#define carray_insert(array, count, i, n) carray_move(array, i, (i)+(n), (count)-(i)-(n))\n#define carray_remove(array, count, i, n) carray_move(array, (i)+(n), i, (count)-(i)-(n))\n\nint\ncarray_xgrow(void **datap, size_t *sizep, size_t esize, size_t count)\n{\n    assert(datap != NULL);\n    assert(sizep != NULL);\n    assert(esize &gt; 0);\n\n    size_t size = *sizep;\n    {\n        size_t cap = size / esize;\n\n        if (cap &gt;= count * 2) // regrow at 1/2\n            cap = 0;\n\n        while (cap &lt; count) // grow by 3/2\n            cap = (cap &lt; 2) ? (cap + 1) : (cap * 3 / 2);\n\n        size = cap * esize;\n    }\n\n    if (size != *sizep) {\n        if (size) {\n            void *data = realloc(*datap, size);\n            if (data == NULL) return -1;\n            *datap = data;\n            *sizep = size;\n        }\n        else {\n            free(*datap);\n            *datap = NULL;\n            *sizep = 0;\n        }\n    }\n    return 0;\n}\n</code></pre>\n\n<p>(Note size in bytes, but cap and count in elements.)</p>\n\n<p>EDIT: removed minor dependencies</p>\n"}], "owner": {"reputation": 15, "user_id": 4776084, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/27e5318e2d29831bcaf58d5c68d60ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Derkus", "link": "https://stackoverflow.com/users/4776084/derkus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1429144870, "creation_date": 1429141921, "question_id": 29662972, "link": "https://stackoverflow.com/questions/29662972/resizing-an-array-within-a-struct-in-c", "title": "Resizing an array within a struct in C", "body": "<p>I am having problems wrapping my brain around proper use of pointers with arrays in C.</p>\n\n<p>The project I am working on is building a simple Dynamic Array and the functions to go along with it. However I do not seem to be able to find the correct syntax/functions to update the array size dynamically. Here is the relevent code:</p>\n\n<p>Array Creation:</p>\n\n<pre><code>    struct DArray\n{\n    TYPE *data;     /* pointer to the data array */\n    int size;       /* Number of elements in the array */\n    int capacity;   /* capacity ofthe array */\n};\n\n\nvoid initDArray(DArray *v, int capacity)\n{\n    assert(capacity &gt; 0);\n    assert(v!= 0);\n    v-&gt;data = (TYPE *) malloc(sizeof(TYPE) * capacity);\n    assert(v-&gt;data != 0);\n    v-&gt;size = 0;\n    v-&gt;capacity = capacity;\n}\n\n\nDArray* createDArray(int cap)\n{\n    assert(cap &gt; 0);\n    DArray *r = (DArray *)malloc(sizeof( DArray));\n    assert(r != 0);\n    initDArray(r,cap);\n    return r;\n}\n</code></pre>\n\n<p>And the problem bit, in its current non-working form:</p>\n\n<pre><code>    void _DArraySetCapacity(DArray *v, int newCap)\n{\n\n    TYPE * newptr = createDArray(newCap);\n    newptr = (TYPE *) malloc(sizeof(TYPE) * newCap);\n    v-&gt;capacity = newCap;\n    v-&gt;data = newptr;\n\n}\n</code></pre>\n\n<p>My method being to create a temporary pointer with increased memory allocation then copy the existing date to it and point the data pointer at the new location. I suspect I may be looking at the issue in entirely the wrong way.</p>\n\n<p>Any help tips or pointers (pun intended) would be appreciated. Thanks in advance.</p>\n"}, {"tags": ["java", "c", "arrays", "performance", "sorting"], "comments": [{"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 7, "creation_date": 1429142008, "post_id": 29662971, "comment_id": 47465395, "body": "Where have you heard that? It&#39;s almost always the opposite being said. Right or wrong, C is the gold standard for speed."}, {"owner": {"reputation": 849, "user_id": 3919702, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/hLta4.png?s=128&g=1", "display_name": "The name&#39;s Bob. MS Bob.", "link": "https://stackoverflow.com/users/3919702/the-names-bob-ms-bob"}, "edited": false, "score": 2, "creation_date": 1429142011, "post_id": 29662971, "comment_id": 47465396, "body": "Java is <i>not</i> faster then C. Care to post your code? You&#39;re probably doing something inefficiently."}, {"owner": {"reputation": 44714, "user_id": 581994, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d2ae9ac6fb51918297a0ce5dada0eb22?s=128&d=identicon&r=PG", "display_name": "Hot Licks", "link": "https://stackoverflow.com/users/581994/hot-licks"}, "edited": false, "score": 3, "creation_date": 1429142174, "post_id": 29662971, "comment_id": 47465448, "body": "Ah, yes, the ol&#39; benchmark wars!!  This battle has been going on for maybe 20 years now.  Depending on the context, either one can &quot;win&quot;.  But it suffices to say that &quot;the performance is lousy&quot; is not a valid reason to reject Java as a programming language.  Performance is far more dependent on the function being performed and how well the programmer matches the implementation to the resources at hand."}, {"owner": {"reputation": 22219, "user_id": 14663, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/611db642b9164a9425f953071a5939ff?s=128&d=identicon&r=PG", "display_name": "WW.", "link": "https://stackoverflow.com/users/14663/ww"}, "edited": false, "score": 1, "creation_date": 1429142184, "post_id": 29662971, "comment_id": 47465452, "body": "I think the first sentence is meant to read &quot;saying Java is generally slower than C&quot;"}, {"owner": {"reputation": 53905, "user_id": 2864740, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/e7a05a144f218bde07b659bc98e1ca7d?s=128&d=identicon&r=PG&f=1", "display_name": "user2864740", "link": "https://stackoverflow.com/users/2864740/user2864740"}, "edited": false, "score": 0, "creation_date": 1429142214, "post_id": 29662971, "comment_id": 47465463, "body": "Java <i>can</i> be faster than C <a href=\"http://benchmarksgame.alioth.debian.org/u32/java.php\" rel=\"nofollow noreferrer\">in <i>certain</i> benchmarks</a>. Overall: no (although it is well within a factor unlike some dynamic languages), in specific cases: yes."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 3, "creation_date": 1429142279, "post_id": 29662971, "comment_id": 47465479, "body": "Shows us your code. Your single point result doesn&#39;t mean a thing unless they can be reproduced and examined in a broader context."}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 0, "creation_date": 1429142513, "post_id": 29662971, "comment_id": 47465548, "body": "Also provide the compiler options you used with the code. When talking about performance compiler options can be very important."}, {"owner": {"reputation": 5028, "user_id": 2228592, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/e75c3b57e65836c9172ee3958094f911?s=128&d=identicon&r=PG", "display_name": "cclloyd", "link": "https://stackoverflow.com/users/2228592/cclloyd"}, "edited": false, "score": 0, "creation_date": 1429144095, "post_id": 29662971, "comment_id": 47466004, "body": "Ok well I added my code and (generally) what compilers I used, since I can&#39;t check right now."}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 0, "creation_date": 1429144319, "post_id": 29662971, "comment_id": 47466071, "body": "@cclloyd Just saw and wrote a short answer. Your comparison is flawed since Java optimized by default while gcc doesn&#39;t. When you use optimizations in your C code it should be fairer."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 1, "creation_date": 1429148443, "post_id": 29662971, "comment_id": 47467115, "body": "... Which is the language that has been used to write the powerful Java capabilities (Like JIT and others)!!? :) I think C or C++ then ..."}], "answers": [{"comments": [{"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429143005, "post_id": 29663048, "comment_id": 47465685, "body": "Yes but C doesn&#39;t need JIT ... A C program, when compiled, is already compiled ... Java is &quot;interpreted&quot;, precompiled if you want, but uses another software that act using the code! A compiled C is already what the CPU want! ..."}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429143178, "post_id": 29663048, "comment_id": 47465731, "body": "@SergioFormiggini yes, what is your point?"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429143811, "post_id": 29663048, "comment_id": 47465917, "body": "My point is about speed ... It is quite obvious that a C code is faster than a Java code. The problem may be seen on the basis of the advantage to use Java versus C that depends on what is to be developed!"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 2, "creation_date": 1429143891, "post_id": 29663048, "comment_id": 47465946, "body": "@SergioFormiggini you&#39;re wrong, java application could run faster neither c one, I&#39;ve explained when it is possible in answer"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429143897, "post_id": 29663048, "comment_id": 47465949, "body": "I.E. I&#39;ve tried to develop a program to compute a lot of prime numbers. I made it in Java and in C. What&#39;s the faster on your opinion?"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429144061, "post_id": 29663048, "comment_id": 47465992, "body": "But I think that for applications Java is a good way because has more functionality than C! But for MCUs, at now, the best way is C and sometimes assembler!"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429146450, "post_id": 29663048, "comment_id": 47466598, "body": "It&#39;s no way to demonstrate that Java is faster than C! It&#39;s not possible! The only way a Java function is faster than a C function is that the C function was written in a wrong way!!! That&#39;s all!!!"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429146531, "post_id": 29663048, "comment_id": 47466620, "body": "I think it would intersting a challenge with simple program ... :)"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429148267, "post_id": 29663048, "comment_id": 47467075, "body": "An other add ... Which is the language that has been used to write the powerful Java capabilities (Like JIT and others)!!?"}, {"owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429154091, "post_id": 29663048, "comment_id": 47468644, "body": "@SergioFormiggini check out this question and answer to find out when java is faster <a href=\"http://stackoverflow.com/questions/29656648/java-8-times-faster-with-arrays-than-stdvector-in-c-what-did-i-do-wrong\" title=\"java 8 times faster with arrays than stdvector in c what did i do wrong\">stackoverflow.com/questions/29656648/&hellip;</a>"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429155326, "post_id": 29663048, "comment_id": 47468973, "body": "I&#39;ve downloaded the code! Is true, java seems faster of the C++ code that uses STL vectors ... Why does the C++ code use STL vectors and doesn&#39;t use bool array as is in the Java code? ... I think this is the trick! I think if the code will be written in C is faster!"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429168430, "post_id": 29663048, "comment_id": 47474178, "body": "At now, I have to accept that with this code Java is faster ... I think that the problem might be something about the FP ... I will investigate!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4842163"}, "edited": false, "score": 0, "creation_date": 1430988172, "post_id": 29663048, "comment_id": 48303933, "body": "If we&#39;re talking purely theory, a JIT has some potential advantages that a statically-compiled language doesn&#39;t. For example, it might be able unroll a loop of N iterations, where N is a runtime value determined by user input, but can be guaranteed to be a constant within a given context. In practice, the theoretical advantages of a JIT are often outweighed by more practical things. In that example shown, <code>vector&lt;bool&gt;</code> is a slow but memory-saving version compressing each byte to a single bit. It&#39;s an extremely flawed comparison, and an array of bools/vector&lt;char&gt; is typically vastly faster."}, {"owner": {"reputation": 279, "user_id": 2195463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5ad2a47cf87bd6f2637af70376231e2e?s=128&d=identicon&r=PG", "display_name": "user2195463", "link": "https://stackoverflow.com/users/2195463/user2195463"}, "edited": false, "score": 0, "creation_date": 1602732563, "post_id": 29663048, "comment_id": 113815076, "body": "I don&#39;t really notice the speed difference, but what I notice is that the every time a Java IDE or some program runs the PC fan goes high and all the CPU&#39;s are close to max."}], "tags": [], "owner": {"reputation": 20558, "user_id": 2864275, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p2xKk.png?s=128&g=1", "display_name": "I\u0142ya Bursov", "link": "https://stackoverflow.com/users/2864275/i%c5%82ya-bursov"}, "is_accepted": false, "score": 1, "last_activity_date": 1429142376, "creation_date": 1429142376, "answer_id": 29663048, "question_id": 29662971, "link": "https://stackoverflow.com/questions/29662971/java-faster-than-c/29663048#29663048", "title": "Java faster than C?", "body": "<p>first of all it is totally wrong to compare languages, sometimes you can compare compilers for the same language, but not languages itself</p>\n\n<p>anyway, java could be faster just because it has JIT, which means during run-time java gathers some statistics and could perform additional optimizations or caching which are almost impossible with c compilers</p>\n\n<p>though some c compilers have profiler-guided optimization loop and final result of such optimization will/could run faster neither java code</p>\n"}, {"tags": [], "owner": {"reputation": 966, "user_id": 3858391, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ILmjN.png?s=128&g=1", "display_name": "DripDrop", "link": "https://stackoverflow.com/users/3858391/dripdrop"}, "is_accepted": false, "score": 3, "last_activity_date": 1429142627, "creation_date": 1429142627, "answer_id": 29663079, "question_id": 29662971, "link": "https://stackoverflow.com/questions/29662971/java-faster-than-c/29663079#29663079", "title": "Java faster than C?", "body": "<p>They are 2 different languages in design, and should be treated as such.</p>\n\n<p>C is a low-level, executable-compiled language, that can do low-level hardware operations such as dynamic memory allocation, and accessing hardware drivers at a very low level. C is normally faster than Java, if it is written efficiently, but it always depends on the compiler. Some compilers support optimization on the compile time, to produce more efficient code, by removing redundant code and other unnecessary artefacts.</p>\n\n<p>One reason that people say C is faster is because you can do allot more with it, such as use low-level multi threading, memory allocation (Via <code>malloc</code>), and other operations that could speed up the program's operation considerably.</p>\n\n<p>Java, on the other hand, is compiled to JVM bytecode, which depends entirely on the JVM (Written in C++) for it's speed. Java has allot less low-level functionality than C, and therefore loses speed in some cases, where C would run allot faster.</p>\n\n<p>Overall, the general reasons your program could lose performance in C is the fact that you </p>\n\n<ol>\n<li>Used a bad compiler</li>\n<li>Wrote inefficient code</li>\n<li>Used slower functions, structures, etc.</li>\n</ol>\n\n<p>But, in most cases, C normally runs considerably faster, and is known to have that over Java, which is one reason it lies at the core of most operating systems, and other advanced software.</p>\n"}, {"comments": [{"owner": {"reputation": 5028, "user_id": 2228592, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/e75c3b57e65836c9172ee3958094f911?s=128&d=identicon&r=PG", "display_name": "cclloyd", "link": "https://stackoverflow.com/users/2228592/cclloyd"}, "edited": false, "score": 0, "creation_date": 1429153844, "post_id": 29663313, "comment_id": 47468572, "body": "Why does the C sort chars instead of integers like the array is?"}], "tags": [], "owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "is_accepted": false, "score": 9, "last_activity_date": 1429166467, "last_edit_date": 1429166467, "creation_date": 1429144249, "answer_id": 29663313, "question_id": 29662971, "link": "https://stackoverflow.com/questions/29662971/java-faster-than-c/29663313#29663313", "title": "Java faster than C?", "body": "<p>Your comparison of their runtime is unfair and flawed. You use default compiler options but Java and C differ on what optimizations they enable by default. And in general measuring performance without optimizations turned on is completely useless of itself, the output could completely change in the real world depending on which can be optimized more.</p>\n\n<p>Java uses a JIT to optimize your code while it runs even with default options.</p>\n\n<p>For gcc the default optimization option is <code>-O0</code> which means there weren't any optimizations done at all. Try using <code>-O2</code> or <code>-O3</code> for a more fair comparison.</p>\n\n<p>For example results on my machine are:  </p>\n\n<ul>\n<li>C code with default compiler options = 12.5secs.</li>\n<li>C code with <code>-O3</code> to enable optimization = 4.5secs.</li>\n<li>Java code = 8.5 secs.</li>\n</ul>\n"}], "owner": {"reputation": 5028, "user_id": 2228592, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/e75c3b57e65836c9172ee3958094f911?s=128&d=identicon&r=PG", "display_name": "cclloyd", "link": "https://stackoverflow.com/users/2228592/cclloyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3658, "favorite_count": 1, "closed_date": 1429152177, "answer_count": 3, "score": -5, "last_activity_date": 1516087613, "creation_date": 1429141919, "last_edit_date": 1516087613, "question_id": 29662971, "link": "https://stackoverflow.com/questions/29662971/java-faster-than-c", "closed_reason": "Opinion-based", "title": "Java faster than C?", "body": "<p>Everything I had heard so far is people saying Java is generally slower than C, with some exceptions (Like involving code that does nothing).  So I went out to test it.  I had an array of 100,000 integers between 0 and 999,999.  I used a double for loop to sort them from smallest to largest, in both C and java (compiled on OS X).</p>\n\n<p>The results were Java generally finishing in half the time.  Out of 5 runs with different arrays Java took around 17 seconds while C took around 32 seconds (That includes the time allocating and populating the array from a file which for both was negligible).</p>\n\n<p>So what would have made the Java code run faster than C? Is there something I'm missing, or some underlying technology I've heard nothing about?</p>\n\n<p>Edit:  Also not sure if it matters, but I timed it using the time command, not any custom code. Ex: <code>$time java SortArray</code></p>\n\n<p>And as for compiler options, I can't access that command line right now, but it was default gcc options on OS X 10.10:</p>\n\n<p><strong><code>gcc sortarray.c -o sortarray</code></strong></p>\n\n<p>And I just used default javac to compile the Java.</p>\n\n<p><strong><code>javac SortArray.java</code></strong></p>\n\n<p>C:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define SIZE 32\n\nint main()\n{\n    FILE* file = fopen(\"bigarray.txt\", \"r\");\n    int arraySize = 100000;\n    int array[100000] = {};\n    int i, j, temp;\n    char inputBuffer[SIZE];\n    for (i = 0; i &lt; arraySize; i++) {\n        fgets(inputBuffer, SIZE, file);\n        array[i] = strtod(inputBuffer, NULL);\n    }\n\n    for (i = 0; i &lt; arraySize; i++)\n        for (j = i + 1; j &lt; arraySize; j++)\n            if (array[i] &gt; array[j]) {\n                int temp = array[i];\n                array[i] = array[j];\n                array[j] = temp;\n            }\n\n    for (i = 0; i &lt; arraySize; i++)\n        printf(\"%d, \", array[i]);\n\n    return 0;\n}\n</code></pre>\n\n<p>Java:</p>\n\n<pre><code>import java.io.*;\nimport java.util.Scanner;\n\npublic class SortArray {\npublic static void main(String[] args) throws IOException {\n    System.out.println(\"Hello world\");\n    Scanner s = new Scanner(new File(\"bigarray.txt\"));\n\n    int[] array = new int[100000];\n    for(int i=0; i&lt;100000; i++) {\n        array[i] = s.nextInt();\n    }\n\n\n    for(int i=0; i&lt;array.length; i++) {\n        for(int j=i+1; j&lt;array.length; j++) {\n            if (array[i] &gt; array[j]) {\n                int temp = array[i];\n                array[i] = array[j];\n                array[j] = temp;\n            }\n        }\n    }\n\n    for(int i=0; i&lt;array.length; i++) {\n        System.out.print(array[i] + \", \");\n    }\n\n}\n}\n</code></pre>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 0, "creation_date": 1429140333, "post_id": 29662691, "comment_id": 47464826, "body": "Try &quot;fileName = &amp;argv[i]&quot;"}, {"owner": {"reputation": 6874, "user_id": 1942027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc12ed2dd9e8cf4e2fe7c33e65c75210?s=128&d=identicon&r=PG&f=1", "display_name": "user1942027", "link": "https://stackoverflow.com/users/1942027/user1942027"}, "edited": false, "score": 1, "creation_date": 1429140743, "post_id": 29662691, "comment_id": 47464973, "body": "Can&#39;t see anything wrong with the shown code but it seems like the compiler thinks that <code>fileName</code> is of type <code>struct FILE *</code>, might want to check if you got multiple declarations or some macro magic in a header."}, {"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 0, "creation_date": 1429141926, "post_id": 29662691, "comment_id": 47465372, "body": "<code>while (c == fgetc(fileName) != &#39;Z&#39;)</code> What is this? Did you mean <code>while ((c = fgetc(fileName)) != &#39;Z&#39;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 29810, "user_id": 423170, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H9kNQ.png?s=128&g=1", "display_name": "Frxstrem", "link": "https://stackoverflow.com/users/423170/frxstrem"}, "is_accepted": false, "score": 1, "last_activity_date": 1429141539, "creation_date": 1429141539, "answer_id": 29662923, "question_id": 29662691, "link": "https://stackoverflow.com/questions/29662691/why-am-i-getting-a-segmentation-fault-in-my-c-program/29662923#29662923", "title": "Why am I getting a segmentation fault in my C program?", "body": "\n\n<p>First of all, what is likely a source of segmentation faults in your program is the fact that you improperly call <code>fgetc</code> with the file name as an argument. You need to open a file pointer first, and then pass <em>it</em> to <code>fgetc</code> to read a character:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>FILE *fp = fopen(fileName); // open the file\n\n// ...\n\nint ch  = fgetc(fp); // read a character, using fp instead of fileName\n</code></pre>\n\n<p>This is what causes most of your errors.</p>\n\n<p>In addition, all functions must have a return type in C. If you don't want to return anything, you need to use the return type <code>void</code>:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>// |\n// V\nvoid parseCommandLine(int argc, char* argv[]) {\n  // ...\n}\n\n// |\n// V\nvoid processOptions(char* str) {\n  // ...\n}\n</code></pre>\n\n<p>And lastly, you need to declare or define a function before you can use it. So in your program, you call <code>processOptions</code> inside <code>parseCommandLine</code>, even though <code>parseCommandLine</code> occurs before <code>processOptions</code> in your program. In this case, you need to put a declaration of <code>processOptions</code> somewhere above the definition of <code>parseCommandLine</code> in your program:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>void processOptions(char* str); // declaration of processOptions()\n                                // notice that there's no function body\n\nvoid parseCommandLine(int argc, char* argv[]) {  // definition of\n                                                 // parseCommandLine()\n  // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3443614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059026380/picture?type=large", "display_name": "jmartin450", "link": "https://stackoverflow.com/users/3443614/jmartin450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1429141539, "creation_date": 1429140159, "question_id": 29662691, "link": "https://stackoverflow.com/questions/29662691/why-am-i-getting-a-segmentation-fault-in-my-c-program", "title": "Why am I getting a segmentation fault in my C program?", "body": "<p>I'm working on a word count program in C. It simulates the wc command in Linux/Unix. It compiles fine, but when I try to run it, it gives me a segmentation fault message. The program is supposed to run like this:</p>\n\n<pre><code>./mywc -c test.txt\n1 2 12 test.txt /* 1 is number of lines, 2 is number of words, 12 is number of chars */\n</code></pre>\n\n<p>My code looks like this:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* Enumerators */\nenum { FALSE, TRUE };\nenum { STDIN, STDOUT, STDERR };\n\n#define BUFFER_SIZE 4096\n#define NAME_SIZE 12\n#define MAX_LINES 100000\n\n#define IN 1\n#define OUT 0\n\n/* Globals */\nchar *fileName = NULL; // File name\nchar tmpName [NAME_SIZE];\nint option = FALSE; // Return true if option is provided in command line\nint charOption = FALSE; // Return true if -c is provided in command line\nint wordOption = FALSE; // Return true if -w is provided in command line\nint lineOption = FALSE; // Return true if -l is provided in command line\nint standardInput = FALSE;\nint c = 0; // Character being scanned\nint nl = 0; // Number of lines in file\nint nw = 0; // Number of words in file\nint nc = 0; // Number of chars in file\nint lineStart[MAX_LINES];\nint fileOffset = 0;\nint fd;\n\nparseCommandLine(int argc, char* argv[]) {\n    int i;\n\n    for (i = 1; i &lt; argc; i++) {\n      if (argv[i][0] == '-')\n        processOptions(argv[i]);\n      else if (fileName == NULL)\n        fileName = argv[i];\n      else\n        usageError();\n    }\n    standardInput = (fileName == NULL);\n}\n\nprocessOptions(char* str) {\n    int j;\n\n    for (j = 1; str[j] != '\\0'; j++) {\n      switch (str[j]) {\n        case 'c':\n          charOption = TRUE;\n          while ( EOF != (str[j] = fgetc(fileName) ) )\n            nc++;\n          break;\n        case 'l':\n          charOption = TRUE;\n          while (c == fgetc(fileName) != 'Z')\n            if (c == '\\n')\n                nl++;\n          break;\n        case 'w':\n          charOption = TRUE;\n          int state = 0;\n          while (c == fgetc(fileName) != 'Z') {\n            ++nc;\n            if (c == '\\n')\n                nl++;\n            if (c == ' ' || c == '\\n' || c == '\\t')\n                state = 0;\n            else if (state == 0) {\n                state = 1;\n                ++nw;\n            }\n          }\n          break;\n        default:\n          usageError();\n          break;\n        }\n    }\n}\n\nusageError() {\n    fprintf(stderr, \"Usage: mywc -lwc [argv[1]]\\n\");\n    exit(1);\n;}\n\nint main(int argc, char *argv[]) {\n    int i;\n\n    parseCommandLine(argc, argv);\n    processOptions(argv[1]);\n    fd = open(fileName, O_RDONLY); /* Open file */\n\n    int flag[3] = {lineOption,wordOption,charOption};\n    int stats[3] = {nl,nw,nc};\n\n    if (!option)\n        printf(\"%d %d %d %s\\n\",nl,nw,nc,fileName);\n    else {\n        for (i = 0; i &lt; 3; i++) {\n            if (flag[i])\n                printf(\"%d \",stats[i]);\n        }\n        printf(\"%s\\n\",fileName);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>If I could get some help on what could possibly be causing this error so my program can run correctly, I would be grateful. Also, I need some hints on getting rid of a few warnings in my program:</p>\n\n<pre><code>mywc.c: In function \u2018parseCommandLine\u2019:\nmywc.c:41:15: warning: assignment from incompatible pointer type\n      fileName = argv[i];\n               ^\nmywc.c: In function \u2018main\u2019:\nmywc.c:96:15: warning: passing argument 1 of \u2018open\u2019 from incompatible pointer type\n     fd = open(fileName, O_RDONLY); /* Open file */\n               ^\nIn file included from mywc.c:3:0:\n/usr/include/fcntl.h:146:12: note: expected \u2018const char *\u2019 but argument is of type \u2018struct FILE *\u2019\n extern int open (const char *__file, int __oflag, ...) __nonnull ((1));\n            ^\nmywc.c:102:9: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 5 has type \u2018struct FILE *\u2019 [-Wformat=]\n         printf(\"%d %d %d %s\\n\",nl,nw,nc,fileName);\n         ^\nmywc.c:108:9: warning: format \u2018%s\u2019 expects argument of type \u2018char *\u2019, but argument 2 has type \u2018struct FILE *\u2019 [-Wformat=]\n         printf(\"%s\\n\",fileName);\n         ^\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "edited": false, "score": 0, "creation_date": 1429139335, "post_id": 29662463, "comment_id": 47464466, "body": "<a href=\"http://stackoverflow.com/questions/24302160/scanf-on-an-istream-object/24318630#24318630\">Never use <code>scanf</code> for anything</a>.  If replacing all uses of <code>fscanf</code> with a combination of <code>fgets</code>, <code>strtof</code>/<code>strtol</code>, and manual parsing does not magically make the problem go away, ask a new question."}, {"owner": {"reputation": 9308, "user_id": 235700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31ab02b76dcfedbe47d2b7335a6277f3?s=128&d=identicon&r=PG", "display_name": "slugonamission", "link": "https://stackoverflow.com/users/235700/slugonamission"}, "edited": false, "score": 0, "creation_date": 1429139374, "post_id": 29662463, "comment_id": 47464487, "body": "In <code>fscanf</code>, when reading <code>cdata[i].hem</code> and <code>cdata[i].dir</code>, you still need to put the <code>&amp;</code> because you&#39;re reading a char, not a string. Also, arrays start at 0, not 1 ;)"}, {"owner": {"reputation": 305833, "user_id": 68587, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7d9fd158e03cbde94f7e0b33b78222af?s=128&d=identicon&r=PG", "display_name": "John Kugelman", "link": "https://stackoverflow.com/users/68587/john-kugelman"}, "edited": false, "score": 1, "creation_date": 1429139381, "post_id": 29662463, "comment_id": 47464489, "body": "What debugging have you done? Do you have any leads? Where do you think the problem might be? You&#39;re going to need to narrow the problem down. It&#39;s good question asking etiquette and it&#39;s also smart in general: cut out irrelevant sections of code; try to isolate the bug and identify the problematic code."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429139560, "post_id": 29662463, "comment_id": 47464546, "body": "why the down vote, its a clear, well documented question. It might well be &#39;oh boy not another fscanf issue&#39; but then just reply &#39;dup of xxx&#39;"}, {"owner": {"reputation": 121127, "user_id": 388520, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/dd7cc06b1b1c347e172c6ba532937173?s=128&d=identicon&r=PG", "display_name": "zwol", "link": "https://stackoverflow.com/users/388520/zwol"}, "reply_to_user": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429292750, "post_id": 29662463, "comment_id": 47547706, "body": "@pm100 There is enough information here that one <i>could</i> solve the OP&#39;s problem (indeed, you may have done just that) but the big pile of poorly formatted code is off-putting, and personally it doesn&#39;t seem like the OP has tried hard enough to debug it themselves to justify the amount of work I would have to put in."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429293835, "post_id": 29662463, "comment_id": 47548358, "body": "compared to most questions by people with rep == 1 this is awesome"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4793999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yaIfHm5BqE4/AAAAAAAAAAI/AAAAAAAAJTQ/pavnNUTdURo/photo.jpg?sz=128", "display_name": "AMDguy", "link": "https://stackoverflow.com/users/4793999/amdguy"}, "edited": false, "score": 0, "creation_date": 1429139935, "post_id": 29662535, "comment_id": 47464693, "body": "I skip the first line of the input file because I already read the &quot;8&quot; into the program as the control number for the array. I start reading the data with that for loop at Montreal"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "reply_to_user": {"reputation": 1, "user_id": 4793999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yaIfHm5BqE4/AAAAAAAAAAI/AAAAAAAAJTQ/pavnNUTdURo/photo.jpg?sz=128", "display_name": "AMDguy", "link": "https://stackoverflow.com/users/4793999/amdguy"}, "edited": false, "score": 0, "creation_date": 1429142728, "post_id": 29662535, "comment_id": 47465607, "body": "lines in input file has nothing to do with population of the array - you are adding entries 1 - 8 of an array (cdata) that has entries 0 - 7. You skip the first one and run off the end"}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1429139426, "creation_date": 1429139426, "answer_id": 29662535, "question_id": 29662463, "link": "https://stackoverflow.com/questions/29662463/using-arrays-for-and-if-structures-with-input-file/29662535#29662535", "title": "Using Arrays, For and If Structures with Input File", "body": "<p>Is there a reason you skip the first entry</p>\n\n<pre><code>for(i=1; i&lt;=ncities; i++ )\n</code></pre>\n\n<p>and not</p>\n\n<pre><code> for(i=0; i&lt;ncities; i++ )\n</code></pre>\n\n<p>You run off the end of the array you have allocated (cos its hard coded to 8 entries)</p>\n"}], "owner": {"reputation": 1, "user_id": 4793999, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-yaIfHm5BqE4/AAAAAAAAAAI/AAAAAAAAJTQ/pavnNUTdURo/photo.jpg?sz=128", "display_name": "AMDguy", "link": "https://stackoverflow.com/users/4793999/amdguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "closed_date": 1429163444, "answer_count": 1, "score": -3, "last_activity_date": 1429140087, "creation_date": 1429139030, "last_edit_date": 1429140087, "question_id": 29662463, "link": "https://stackoverflow.com/questions/29662463/using-arrays-for-and-if-structures-with-input-file", "closed_reason": "Not suitable for this site", "title": "Using Arrays, For and If Structures with Input File", "body": "<p>I'm working on a program in C that calculates the surface distance between any two cities on earth. The program is given a .txt input file containing the names of cities and their respective coordinates in both degrees and minutes. From the input file, all of the data must be read into an array through fscanf. I wrote the program based off of my knowledge of C using For and If statements but it isn't outputing correctly.</p>\n\n<p>This is my input file:</p>\n\n<pre><code>8\nMontreal       45.0 30.5 N  73.0 33.2 W\nLondon         51.0 30.7 N   0.0  7.2 W\nChicago        41.0 52.7 N  87.0 37.8 W\nMelbourne      37.0 48.8 S 144.0 57.8 E\nVladivostok    43.0  8.2 N 131.0 54.7 E \nJohannesburg   26.0 12.2 S  28.0  2.8 E\nLos-Angeles    34.0  2.6 N 118.0 13.8 W\nRio-de-Janeiro 22.0 54.2 S  43.0 12.6 W\n</code></pre>\n\n<p>And this is my program so far which runs without syntax error</p>\n\n<pre><code>/******************************************************************************\n\n   PROGRAM DESCRIPTION:\n   This program computes the distance between two cities.  Longitude and\n   latitude coordinates are converted from degrees and minutes to radians\n   relative to the North pole and the prime meridian which passes through\n   Greenwich, England.  After converting the cities positions to radians,\n   the angular separation is calculated between two cities.  Finally, the\n   surface distance between the two cities is calculated.  The results are\n   printed to the computer screen.\n\n   DESCRIPTION OF VARIABLES FOR STRUCTURE:\n   NAME         | TYPE      | DESCRIPTION\n   ----------------------------------------------------------------------------\n   hem          | char      | hemisphere of a city in the structure\n   dir          | char      | longitude direction of a city in the structure\n   cname        | char      | array of city names in the structure\n   latdeg       | double    | latitude coordinates in degrees in the structure\n   latmin       | double    | latitude coordinates in minutes in the structure\n   londeg       | double    | longitude coordinates in degrees in the structure\n   lonmin       | double    | longitude coordinates in minutes in the structure\n\n   DESCRIPTION OF VARIABLES FOR MAIN FUNCTION:\n   NAME         | TYPE      | DESCRIPTION\n   ----------------------------------------------------------------------------\n   earth_radius | symbolic  | radius of the earth \n   pi           | symbolic  | math constant\n   cdata        | structure | array of cities read from input file\n   i            | int       | loop control variable\n   ncities      | int       | number of cites read from the input file  \n   sep_angle    | double    | computed separation angle between two cities\n   distance     | double    | computed surface distance between two cities\n   alpha1       | double    | computed latitude of first city in radians\n   alpha2       | double    | computee latitude of second city in radians\n   beta1        | double    | computed longitude of first city in radians\n   beta2        | double    | computed longitude of second city in radians\n   city_data    | pointer   | pointer variable for input file\n******************************************************************************/   \n\n/* Preprocessor directives */\n#include &lt;stdio.h&gt;\n#include &lt;math.h&gt;\n#define inputfile \"c:\\\\engr 200\\\\cities.txt\"\n#define pi 3.141592654\n#define earth_radius 3958.89\n\n/* Define the structure for cities */\nstruct cities\n{\n       char hem, dir, cname[8];\n       double latdeg, latmin, londeg, lonmin; \n};\n\n/* Main function */\nint main(void)\n{\n   /* Declare the structure */\n   struct cities cdata[8];\n\n   /* Declare variables */\n   double sep_angle, distance, alpha1, alpha2, beta1, beta2;\n   int i, ncities;\n   FILE *city_data;\n\n   /* Open input file */\n   city_data = fopen(inputfile,\"r\");\n\n   /* Verify input file and read input data */\n   if(city_data == NULL)\n   {\n      printf(\"\\n\\nError opening input file.\");\n      printf(\"\\nProgram terminated.\");\n      printf(\"\\n\\n\\nPress Enter to quit.\\n\");\n      getchar(); getchar();\n      return 0;\n   }\n   else\n   {\n      /* Read control number from input file */\n      fscanf(city_data,\"%i\",&amp;ncities);\n\n      /* Read city data into array structure from input file */\n      for(i=1; i&lt;=ncities; i++ )\n      {\n      fscanf(city_data, \"%s %3.0f %3.0f %c %3.0f %3.0f %c\",cdata[i].cname,\n      &amp;cdata[i].latdeg,&amp;cdata[i].latmin,cdata[i].hem,&amp;cdata[i].londeg,\n      &amp;cdata[i].lonmin,cdata[i].dir);\n      }\n   }\n\n   /* Print main headings to computer screen */\n   printf(\"CITY                 LATITUDE      LONGITUDE\\n\\n\");\n\n   /* Compute and print distance between 2 cities */\n   for(i=1; i&lt;=ncities; i = i + 2 )\n   {\n      /* Print two cities to computer screen */\n      printf(\"%-15s    %3.0f\u00f8 %4.1f'%c    %3.0f\u00f8 %4.1f'%c\"\n             \"\\n%-15s    %3.0f\u00f8 %4.1f'%c    %3.0f\u00f8 %4.1f'%c\\n\",\n             cdata[i].cname,cdata[i].latdeg,cdata[i].latmin,\n             cdata[i].hem,cdata[i].londeg,cdata[i].lonmin,cdata[i].dir,\n             cdata[i+1].cname,cdata[i+1].latdeg,cdata[i+1].latmin,\n             cdata[i+1].hem,cdata[i+1].londeg,cdata[i+1].lonmin,\n             cdata[i+1].dir);\n\n      /* Convert latitude to radians for city 1 */\n      if(cdata[i].hem == 'N')\n      {alpha1 = (90.0-cdata[i].latdeg)*(pi / 180.0 );}\n      else\n      {alpha1 = (90.0+cdata[i].latdeg)*(pi / 180.0 );}\n\n      /* Convert latitude to radians for city 2 */\n      if(cdata[i+1].hem == 'N')\n      {alpha2 = (90.0-cdata[i+1].latdeg)*(pi / 180.0 );}\n      else\n      {alpha2 = (90.0+cdata[i+1].latdeg)*(pi / 180.0 );}\n\n      /* Convert longitude to radians for city 1 */           \n      if(cdata[i].dir == 'W')\n      {beta1 = (cdata[i].londeg)*(pi / 180.0 );}\n      else\n      {beta1= (360.0-cdata[i].londeg)*(pi / 180.0 );}\n\n      /* Convert longitude to radians for city 2 */      \n      if(cdata[i+1].dir == 'W')\n      {beta2= (cdata[i+1].londeg)*(pi / 180.0 );}\n      else \n      {beta2= (360.0-cdata[i+1].londeg)*(pi / 180.0 );}\n\n      /* Compute angular separation between city 1 and city 2 */\n      sep_angle = ((acos(cos(alpha1))*(cos(alpha2)))+((sin(alpha1))*(sin(alpha2))\n      *(cos(beta2-beta1))));\n\n      /* Compute the distance between city 1 and city 2 */\n      distance = earth_radius*sep_angle;\n\n      /* Print distance between city 1 and city 2 to computer screen */\n      printf(\"Distance between the two cities = %6.1f miles\\n\\n\\n\",distance);\n   }\n\n   /* Close input file */\n   fclose(city_data);\n\n   /* Exit program */\n   printf(\"\\n\\n\\nPress Enter to quit.\\n\");\n   getchar(); getchar();\n   return 0;\n}\n/*********************************************************************/\n</code></pre>\n\n<p>After I compile and run the .exe, all that shows up is:</p>\n\n<pre><code>CITY                 LATITUDE      LONGITUDE \nMontreal             0000000000080980980385690835600000 etc.\n</code></pre>\n\n<p>and the rest is all random zeros and huge numbers :/</p>\n\n<p>I'm supposed to get something like this:</p>\n\n<pre><code>CITY                 LATITUDE      LONGITUDE \nMontreal             45\u00b0 30.5'N   73\u00b0 33.2'W\nLondon               51\u00b0 30.7'N   0.0  7.2'W\nDistance between the two cities = xxxx.x miles\n\nChicago              41\u00b0 52.7'N   87\u00b0 37.8'W \nMelbourne            37\u00b0 48.8'S  144\u00b0 57.8'E\nDistance between the two cities = xxxx.x miles \n\nand so on for the rest of the cities in the input file.....\n</code></pre>\n\n<p>What could be causing this? Let me know if there is anything else that I should add.</p>\n\n<p>Edit: I think that they program derails itself while reading in the data with fscanf</p>\n"}, {"tags": ["c", "sockets", "tcp", "recv", "errno"], "comments": [{"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 0, "creation_date": 1429139008, "post_id": 29662425, "comment_id": 47464342, "body": "<code>linux&#47;Mac Terminal</code> using <code>gcc</code>"}], "answers": [{"comments": [{"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 0, "creation_date": 1429140677, "post_id": 29662644, "comment_id": 47464942, "body": "Thanks. I had seen this information on search, but i was unsure how to incorporate getting these errors to be displayed"}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 1, "creation_date": 1429140835, "post_id": 29662644, "comment_id": 47464995, "body": "I got the error back with perror <code>Socket operation on non-socket</code>. I will investigate this further."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "reply_to_user": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 0, "creation_date": 1429148742, "post_id": 29662644, "comment_id": 47467206, "body": "I think this means that fd3 (referring to your codeline here in the post) contians a non-valid socket value or initialization! You have to verify if the socket() function that generates it didn&#39;t return -1. If -1 is returned when you call the socket() function you have to verify the errno etc, etc. \u2013"}], "tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": true, "score": 3, "last_activity_date": 1429139949, "creation_date": 1429139949, "answer_id": 29662644, "question_id": 29662425, "link": "https://stackoverflow.com/questions/29662425/how-to-debug-tcp-recv/29662644#29662644", "title": "How to debug TCP recv()", "body": "<p>Here is the man(ual) explanation of error relevants to recv!</p>\n\n<blockquote>\n  <p>ERRORS\n         These are some standard errors generated by the  socket  layer.   Addi\u2010\n         tional  errors may be generated and returned from the underlying proto\u2010\n         col modules; see their manual pages.</p>\n\n<pre><code>   EAGAIN or EWOULDBLOCK\n          The socket is marked nonblocking and the receive operation would\n          block, or a receive timeout had been set and the timeout expired\n          before data was received.  POSIX.1-2001 allows either  error  to\n          be  returned for this case, and does not require these constants\n          to have the same value, so a portable application  should  check\n          for both possibilities.\n\n   EBADF  The argument sockfd is an invalid descriptor.\n\n   ECONNREFUSED\n          A remote host refused to allow the network connection (typically\n          because it is not running the requested service).\n\n   EFAULT The  receive  buffer  pointer(s)  point  outside  the  process's\n          address space.\n\n   EINTR  The  receive  was interrupted by delivery of a signal before any\n          data were available; see signal(7).\n\n   EINVAL Invalid argument passed.\n\n   ENOMEM Could not allocate memory for recvmsg().\n\n   ENOTCONN\n          The socket is associated with a connection-oriented protocol and\n          has not been connected (see connect(2) and accept(2)).\n\n   ENOTSOCK\n          The argument sockfd does not refer to a socket.\n</code></pre>\n</blockquote>\n\n<p>You may use perror() and strerror() to manage an error string when recv returns -1.</p>\n\n<p>See the relevant man(ual) for explanation:</p>\n\n<p><a href=\"http://unixhelp.ed.ac.uk/CGI/man-cgi?perror%203\" rel=\"nofollow\">perror</a></p>\n\n<p><a href=\"http://unixhelp.ed.ac.uk/CGI/man-cgi?strerror%203\" rel=\"nofollow\">strerror</a></p>\n"}], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "accepted_answer_id": 29662644, "answer_count": 1, "score": 1, "last_activity_date": 1429139949, "creation_date": 1429138827, "question_id": 29662425, "link": "https://stackoverflow.com/questions/29662425/how-to-debug-tcp-recv", "title": "How to debug TCP recv()", "body": "<p>I have a <code>client - server - server socket</code> simulation with bidirectional communication.</p>\n\n<p>My line</p>\n\n<pre><code>recv(fd3, serv3_buf, BUFSIZE - 1, 0);\n</code></pre>\n\n<p>returns <code>-1</code></p>\n\n<p>How can you debug <code>recv</code> using <code>errno.h</code>?</p>\n"}, {"tags": ["c++", "c", "arrays", "arduino"], "comments": [{"owner": {"reputation": 86085, "user_id": 128940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d35101b4060dc3af0d5c1b7c42c4935?s=128&d=identicon&r=PG&f=1", "display_name": "Beta", "link": "https://stackoverflow.com/users/128940/beta"}, "edited": false, "score": 2, "creation_date": 1429137402, "post_id": 29662007, "comment_id": 47463802, "body": "You should never write this much code before testing any of it. You&#39;re trying to get at least two new things working at the same time; develop them in isolation, then hook them together."}], "answers": [{"tags": [], "owner": {"reputation": 1915, "user_id": 4475902, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/8283da1024358bce8d1a286b923c360c?s=128&d=identicon&r=PG&f=1", "display_name": "Konrad", "link": "https://stackoverflow.com/users/4475902/konrad"}, "is_accepted": false, "score": 1, "last_activity_date": 1429137692, "last_edit_date": 1429137692, "creation_date": 1429137148, "answer_id": 29662076, "question_id": 29662007, "link": "https://stackoverflow.com/questions/29662007/3d-array-for-arduino/29662076#29662076", "title": "3D array for Arduino", "body": "<p>Under <code>void loop()</code>, you are declaring <code>xSeed</code>, <code>ySeed</code>, and <code>zSeed</code> inside the <code>if</code> block, which makes the variables local to that if block, which means they go out of scope when you exit the if block. Declare them before (outside) the if block instead, before <code>ledBuffer</code>, at the beginning of the <code>void loop()</code> function, since you are trying to use those variables before you have told the compiler that they exist, hence the compiler's message that they were \"not declared in this scope\"</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Also, it seems you want all these functions to operate on the same <code>ledBuffer</code> 3D array. You should consider declaring it as a global variable (if you are using C), or if you are using C++, perhaps consider making it a class, with <code>ledBuffer</code> as an attribute/field.</p>\n"}, {"tags": [], "owner": {"reputation": 4251, "user_id": 4605105, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-_cFfGx1khYs/AAAAAAAAAAI/AAAAAAAAGt0/vfQ_28nwAEE/photo.jpg?sz=128", "display_name": "&#212;rel", "link": "https://stackoverflow.com/users/4605105/%c3%94rel"}, "is_accepted": false, "score": 0, "last_activity_date": 1429142695, "creation_date": 1429142695, "answer_id": 29663093, "question_id": 29662007, "link": "https://stackoverflow.com/questions/29662007/3d-array-for-arduino/29663093#29663093", "title": "3D array for Arduino", "body": "<p>I have tried to split your code and factorized it. I don't have an Arduino build system I can't test my code.\nI don't understand your mapping x, y, z to pin number I have tried one.</p>\n\n<pre><code>/* Struct for global conf */\nstatic struct {                                                                \n    int ledBuffer[4][4][4];                                                    \n    int ledXY[4][4];                                                           \n    int ledZ[4];                                                               \n} _G;                                                                          \n\nvoid setup() {                                                                 \n    _G.ledXY = {                                                               \n        {22, 24, 26, 28} ,                                                     \n        {30, 32, 34, 36},                                                      \n        {23, 25, 27, 29},                                                      \n        {31, 33, 35, 37}                                                       \n    };                                                                         \n    _G.ledZ = {38,40,42,44};                                                   \n\n    //sets all used pins as output                                                  \n    for(int i = 0; i &lt; 4; i++){                                                \n        pinMode(_G.ledZ[i], OUTPUT);                                           \n        for (int j = 0; j &lt; 4; j++) {                                          \n            pinMode(_G.ledXY[i][j], OUTPUT);                                   \n        }                                                                      \n    }                                                                          \n    allOn(); /* switch on all led*/                                                                   \n    allOff(); /* switch off all led */                                                                  \n}                                                                              \n\nvoid loop() {                                                                  \n    static int xSeed;                                                          \n    static int ySeed;                                                          \n    static int zSeed;                                                          \n\n    _G.ledBuffer[xSeed][ySeed][zSeed] = 0;                                     \n\n    if (zSeed == 0)                                                            \n    {                                                                          \n        xSeed = random(0, 3);                                                  \n        ySeed = random(0, 3);                                                  \n        zSeed = random(0, 3);                                                  \n    } else {                                                                   \n        zSeed--;                                                               \n    }                                                                          \n    _G.ledBuffer[xSeed][ySeed][zSeed] = 1;                                     \n\n    doLight();                                                                 \n} \n\nstatic void doLight();                                                         \n\n    for (int step = 0; step &lt; 80; step++) { /* Perhaps use sleep instead */                                   \n        allOff();                                                              \n        for(int i = 0; i &lt; 4; i++){                                            \n            for(int j = 0; j &lt; 4; j++){                                        \n                for(int k = 0; i &lt; 4; i++){                                    \n                    digitalSwitch(i, j, k, ledBuffer[i][j][k]);                \n                }                                                              \n            }                                                                  \n        }                                                                      \n    }                                                                          \n}                                                                              \n\nstatic void digitalSwitch(int x, int y, int z, int on) {\n    /* convert x y z to the correct pin*/                       \n    digitalWrite(_G.ledXY[x][y], _G.[ledZ[z]], on ? HIGH : LOW);               \n}                                                                              \n\n\nstatic void _all(int on) {                                                     \n    for(int i = 0; i &lt; 4; i++){                                                \n        for(int j = 0; j &lt; 4; j++){                                            \n            for(int k = 0; i &lt; 4; i++){                                        \n                digitalSwitch(i, j, k, on);                                    \n            }                                                                  \n        }                                                                      \n    }                                                                          \n}                                                                              \nint allOff(){                                                                  \n    _all(0);                                                                   \n};                                                                             \n\nint allOn(){                                                                   \n    _all(1);                                                                   \n};     \n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2473971"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429142695, "creation_date": 1429136734, "last_edit_date": 1429142673, "question_id": 29662007, "link": "https://stackoverflow.com/questions/29662007/3d-array-for-arduino", "title": "3D array for Arduino", "body": "<p>Currently I am working on my 4x4x4 led cube, I wanted to write my own code for it but currently I am stuck on using 3D arrays. I declare several arrays in void setup(), and I have tried putting them in the void loop() as well. Still, when trying to compile it keeps returning errors.</p>\n\n<p>In short, the code is supposed to generate a random point with a XYZ value. Then it has to write it to an buffer, this buffer has to project and multiplex it onto the led cube.</p>\n\n<p>I made the lines that return the errors bold.</p>\n\n<p>The errors are:</p>\n\n<pre><code>LedCube1.0.ino: In function 'void loop()':    \nLedCube1.0.ino:41:3: error: 'ledBuffer' was not declared in this scope    \nLedCube1.0.ino:41:13: error: 'xSeed' was not declared in this scope    \nLedCube1.0.ino:41:20: error: 'ySeed' was not declared in this scope    \nLedCube1.0.ino:41:27: error: 'zSeed' was not declared in this scope    \nLedCube1.0.ino:42:7: error: 'rainstep' was not declared in this scope    \nLedCube1.0.ino: In function 'int allOff()':    \nLedCube1.0.ino:76:9: error: 'ledBuffer' was not declared in this scope\nLedCube1.0.ino: In function 'int allOn()':\nLedCube1.0.ino:86:9: error: 'ledBuffer' was not declared in this scope    \nError compiling.\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>void setup() {                                                                 \n    //sets all pins as output                                                  \n    for(int a=22;a&lt;53;a++){                                                    \n        pinMode(a, OUTPUT);                                                    \n    }                                                                          \n    //declares the sizes of the cube                                           \n    int width = 4;                                                             \n    int depth = 4;                                                             \n    int height = 4;                                                            \n    int ledBuffer[4][4][4] = {  //creates a buffer that can store values generated by a function \n        {                                                                      \n            {0,0,0,0}, {0,0,0,0}, {0,0,0,0}, {0,0,0,0}                         \n        },                                                                     \n        {                                                                      \n            {0,0,0,0}, {0,0,0,0}, {0,0,0,0}, {0,0,0,0}                         \n        },                                                                     \n        {                                                                      \n            {0,0,0,0}, {0,0,0,0}, {0,0,0,0}, {0,0,0,0},                        \n        },                                                                     \n        {                                                                      \n            {0,0,0,0}, {0,0,0,0}, {0,0,0,0}, {0,0,0,0},                        \n        }                                                                      \n    };                                                                         \n    //defines to which connector each layer is connected                       \n    int ledXY[4][4] = {                                                        \n        {22,24,26,28} ,                                                        \n        {30,32,34,36},                                                         \n        {23,25,27,29},                                                         \n        {31,33,35,37}                                                          \n    };                                                                         \n    int ledZ[4] = {38,40,42,44};                                               \n    //create variables to start generating raindrops                           \n    int rainstep = 0;                                                          \n    int xSeed = 0;                                                             \n    int ySeed = 0;                                                             \n    int zSeed = 0;                                                             \n}  \n\nvoid loop() {                                                                  \n    //generatedrop                                                             \n    ledBuffer[xSeed][ySeed][zSeed] = 0;                                        \n    if (rainstep == 0)                                                         \n    {                                                                          \n        int xSeed=random(0,3);                                                 \n        int ySeed=random(0,3);                                                 \n        int zSeed=random(0,3);                                                 \n    }                                                                          \n    else                                                                       \n    {                                                                          \n        zSeed = zSeed - rainstep;                                              \n    }                                                                          \n    ledBuffer[xSeed][ySeed][zSeed] = 1;                                        \n\n    //updatecube                                                               \n    for(int i=0; i&lt;80;i++){                                                    \n        int currentZ = i%4;                                                    \n        allOff;                                                                \n        for(int j=0;j&lt;4;j++){                                                  \n            for(int k=0; i&lt;4;i++){                                             \n                if(ledBuffer[i][j][k]==0){                                     \n                    digitalWrite(ledBuffer[i][j][k],HIGH);                     \n                }else{                                                         \n                    digitalWrite(ledBuffer[i][j][k],LOW);                      \n                }                                                              \n            }                                                                  \n        }                                                                      \n    }                                                                          \n}                                      \n\n//function declares entire array 0                                             \nint allOff(){                                                                  \n    for(int c=0;c&lt;4;c++){                                                      \n        for(int d=0;d&lt;4;d++){                                                  \n            for(int e=0;e&lt;4;e++){                                              \n                ledBuffer[c][d][e]=0;                                          \n            }                                                                  \n        }                                                                      \n    }                                                                          \n};                                                                             \n//function declares entire array 1                                             \nint allOn(){                                                                   \n    for(int c=0;c&lt;4;c++){                                                      \n        for(int d=0;d&lt;4;d++){                                                  \n            for(int e=0;e&lt;4;e++){                                              \n                ledBuffer[c][d][e]=1;                                          \n            }                                                                  \n        }                                                                      \n    }                                                                          \n};                 \nI re\n</code></pre>\n\n<p>Can someone help me or at least point me in the right direction.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "edited": false, "score": 0, "creation_date": 1429138123, "post_id": 29661960, "comment_id": 47464045, "body": "What type is <code>main_dict</code>? Where are your <code>#include</code> statements? With the error that you are seeing there is clearly code that you&#39;ve decided to not include in your post."}], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1429137773, "creation_date": 1429137773, "answer_id": 29662215, "question_id": 29661960, "link": "https://stackoverflow.com/questions/29661960/error-dereferencing-pointer-to-incomplete-type-in-c/29662215#29662215", "title": "ERROR Dereferencing pointer to incomplete type in c", "body": "<blockquote>\n  <p>What means this error?</p>\n</blockquote>\n\n<p>The forward declaration </p>\n\n<pre><code>typedef struct _Dictionary_t *Dictionary;\n</code></pre>\n\n<p>doesn't give a clue as to what members <code>struct _Dictionary_t</code> might have.</p>\n\n<p>You cannot use <code>main_dict-&gt;size</code> unless the definition of <code>struct</code> is visible at that point in the code. Since the definition of the <code>struct</code> is in <code>dictionary.c</code>, its definition is not visible to anything in <code>main.c</code>.</p>\n\n<blockquote>\n  <p>How I can fix it?</p>\n</blockquote>\n\n<p><strong>Solution 1</strong></p>\n\n<p>Move the definition of the <code>struct</code> to the .h file.</p>\n\n<p><strong>Solution 2</strong></p>\n\n<p>Provide functions that allow you to get and set the members of the <code>struct</code>.</p>\n\n<p>In <strong>dictionary.h</strong>:</p>\n\n<pre><code>void setDictionarySize(Dictionary dict, int size);\nint getDictionarySize((Dictionary dict);\n</code></pre>\n\n<p>Implement them in <strong>dictioary.c</strong>.</p>\n\n<p>Use the function in <strong>main.c</strong>. Replace</p>\n\n<pre><code>a = main_dict-&gt;size;\n</code></pre>\n\n<p>by</p>\n\n<pre><code>a = getDictionarySize(main_dict);\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 4794013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e9dafdb0535861901e7e910f30d683b7?s=128&d=identicon&r=PG&f=1", "display_name": "LP-AC-J", "link": "https://stackoverflow.com/users/4794013/lp-ac-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 822, "favorite_count": 0, "closed_date": 1429180349, "answer_count": 1, "score": -1, "last_activity_date": 1429137773, "creation_date": 1429136496, "last_edit_date": 1429137181, "question_id": 29661960, "link": "https://stackoverflow.com/questions/29661960/error-dereferencing-pointer-to-incomplete-type-in-c", "closed_reason": "Duplicate", "title": "ERROR Dereferencing pointer to incomplete type in c", "body": "<p>I Have this error: dereferencing pointer to incomplete type main_dict ->size = 0;</p>\n\n<p>What means this error? How I can fix it?</p>\n\n<p><strong>dictionary.c</strong></p>\n\n<pre><code>struct _Dictionary_t {  \n  char **dict;\n  int size;\n};\n\nDictionary dict_new (void){\n\n  Dictionary dict_new = NULL;\n  dict_new = calloc(1,sizeof(struct _Dictionary_t));\n  assert(dict_new != NULL);\n  dict_new -&gt; dict = NULL; \n  return (dict_new);\n}\n</code></pre>\n\n<p><strong>dictionary.h</strong></p>\n\n<pre><code>typedef struct _Dictionary_t *Dictionary;\n\nDictionary dict_new (void);\n</code></pre>\n\n<p><strong>main.c</strong></p>\n\n<pre><code>int main(void){\n\n  int a;\n  main_dict = dict_new();\n  a = main_dict-&gt;size;\n  if(a == 0){\n      printf(\"I'll be here if I fix the error \\n\")\n  }    \n  return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "sorting", "subroutine"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4793947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TBX87.jpg?s=128&g=1", "display_name": "IdislikeCalot", "link": "https://stackoverflow.com/users/4793947/idislikecalot"}, "edited": false, "score": 0, "creation_date": 1429138871, "post_id": 29662207, "comment_id": 47464299, "body": "I like that swap function but I&#39;m not sure i understand it.  Could you explain the asterisks? Pointers?"}, {"owner": {"reputation": 7817, "user_id": 4789373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-f_OQrxbHhFQ/AAAAAAAAAAI/AAAAAAAAABA/NY38t7ooQ5c/photo.jpg?sz=128", "display_name": "FalconUA", "link": "https://stackoverflow.com/users/4789373/falconua"}, "reply_to_user": {"reputation": 41, "user_id": 4793947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TBX87.jpg?s=128&g=1", "display_name": "IdislikeCalot", "link": "https://stackoverflow.com/users/4793947/idislikecalot"}, "edited": false, "score": 0, "creation_date": 1429139655, "post_id": 29662207, "comment_id": 47464590, "body": "Asterisk in declaration means that it&#39;s a pointer to a type. Technically, an array is a pointer. For example, <code>int *age</code> -&gt; age is a pointer to integer, <code>int age[100]</code> -&gt; age is also a pointer to integer<code>char ** name</code> -&gt; so name is a pointer to a pointer to char (in declaration <code>char name[100][100]</code> -&gt; name is also a pointer to a pointer to char)."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1429141432, "post_id": 29662207, "comment_id": 47465202, "body": "Suggestion: rather the use 100 and 100 for name size and user_array size, use 2 different constants: Easier for new folks to follow your nice example/"}, {"owner": {"reputation": 41, "user_id": 4793947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TBX87.jpg?s=128&g=1", "display_name": "IdislikeCalot", "link": "https://stackoverflow.com/users/4793947/idislikecalot"}, "edited": false, "score": 0, "creation_date": 1429143551, "post_id": 29662207, "comment_id": 47465845, "body": "Ok thanks guys I&#39;m with option two only because it was written already. I really will read into the strut idea."}], "tags": [], "owner": {"reputation": 7817, "user_id": 4789373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-f_OQrxbHhFQ/AAAAAAAAAAI/AAAAAAAAABA/NY38t7ooQ5c/photo.jpg?sz=128", "display_name": "FalconUA", "link": "https://stackoverflow.com/users/4789373/falconua"}, "is_accepted": true, "score": 3, "last_activity_date": 1429137728, "creation_date": 1429137728, "answer_id": 29662207, "question_id": 29661959, "link": "https://stackoverflow.com/questions/29661959/best-or-most-efficient-way-to-sort-parallel-arrays-using-subroutines-in-c/29662207#29662207", "title": "Best or most efficient way to sort parallel arrays using subroutines in C?", "body": "<p>Instead of using a bunch of arrays, you can just put everything you need into a <code>struct</code>, make an array of <code>structs</code>. For example:</p>\n\n<pre><code>struct user {\n    char name[100];\n    int age;\n};\n\nstruct user user_array[100];\n</code></pre>\n\n<p>Or, if you don't want to change the whole code, just make a swap function somwhere, and in your sorting algorithm, instead of swapping elements directly, just call a swap function. For example, assume that you have </p>\n\n<pre><code>char name[100][100];\nint age[100];\n</code></pre>\n\n<p>The swap function will look like</p>\n\n<pre><code>void swap_users(int a, int b, char ** name, int * age)\n{\n    int age_tmp;\n    char *name_tmp;\n    age_tmp  = age [a]; age [a] = age [b]; age [b] = age_tmp;\n    name_tmp = name[a]; name[a] = name[b]; name[b] = name_tmp;\n}\n</code></pre>\n\n<p>And your sorting algorithm will look like:</p>\n\n<pre><code>void some_sorting_algorithm()\n{\n    // do something ...\n    // do something ...\n    // maybe some loop? ...\n        swap_users(x, y, name, age);\n    // continue the loop or doing something\n}\n</code></pre>\n\n<p><strong>PS</strong>: hope I understood your question correctly.</p>\n"}], "owner": {"reputation": 41, "user_id": 4793947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TBX87.jpg?s=128&g=1", "display_name": "IdislikeCalot", "link": "https://stackoverflow.com/users/4793947/idislikecalot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "closed_date": 1429171708, "accepted_answer_id": 29662207, "answer_count": 1, "score": -1, "last_activity_date": 1429137728, "creation_date": 1429136495, "question_id": 29661959, "link": "https://stackoverflow.com/questions/29661959/best-or-most-efficient-way-to-sort-parallel-arrays-using-subroutines-in-c", "closed_reason": "Needs details or clarity", "title": "Best or most efficient way to sort parallel arrays using subroutines in C?", "body": "<p>Ok so the user enter a name and an age. The output needs printed in ascending order. I've done bubble sort but I do not know how to keep track of the ages with the names. Is one sort method better or easy than another one?</p>\n"}, {"tags": ["c", "multithreading", "sockets", "fork", "tftp"], "answers": [{"comments": [{"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429138617, "post_id": 29662357, "comment_id": 47464205, "body": "Thanks sir, much appreciated."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429139165, "post_id": 29662357, "comment_id": 47464403, "body": "Sir, do you have any idea why prints <code>Retransmitting Packet #</code> 2 times in the second iteration and then stops? I mean it only waits 10 seconds not 15..."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429139655, "post_id": 29662357, "comment_id": 47464591, "body": "Sir, please check my comment"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140488, "post_id": 29662357, "comment_id": 47464874, "body": "Can&#39;t see anything obvious. Please put a printf inside the &quot;else if (result==-1)&quot; case to check whether a non-timeout error is occuring."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140623, "post_id": 29662357, "comment_id": 47464924, "body": "I mean it should print <code>Retransmitting Packet #</code> 3 times in 15 seconds. It seems like the first 2 <code>recvfrom</code> take their 5 seconds, while the third doesn&#39;t."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140707, "post_id": 29662357, "comment_id": 47464954, "body": "Yes I understand. That&#39;s why I ask you to put a printf in the &quot;else if&quot; case. Because if a non-timeout error occurs then it will go into that case and not print &quot;Retransmitting Packet&quot;."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140806, "post_id": 29662357, "comment_id": 47464986, "body": "Sir, it is printed three times, but the second and third are almost printed together. I did put something in the else if case but it didnot even got there."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140910, "post_id": 29662357, "comment_id": 47465021, "body": "it seems like the RCVTIMEO is reset to zero, but how"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140933, "post_id": 29662357, "comment_id": 47465029, "body": "Ok, I thought you said it was only printed twice. Did you actually time it? To see whether it is really 10 seconds or 15 seconds? Because printfs can be buffered and do not necessarily show as soon as they are called."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429140960, "post_id": 29662357, "comment_id": 47465043, "body": "Yes, sir. almost 10 seconds"}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429143188, "post_id": 29662357, "comment_id": 47465734, "body": "anything new? @Alan Au"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429144148, "post_id": 29662357, "comment_id": 47466028, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/75339/discussion-between-alan-au-and-user3490561\">continue this discussion in chat</a>."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "reply_to_user": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 1, "creation_date": 1429164639, "post_id": 29662357, "comment_id": 47471969, "body": "@user3490561, The reason of double printing at the end is you begin the print message with <code>\\n</code> instead of at the end of printed message, and as such, no flushing of buffer at the end of printing is done (it&#39;s accumulated to the next printing command).  STDIO, by default, works flushing buffers only on <code>\\n</code>, when output is to a tty, so better put the <code>\\n</code> at the end of message (or use <b>fflush(3)</b> behind <b>printf(3)</b> to force the printing)  There is an automatic <code>fflush()</code> call at the end of the server (on exit), so the reason of the two prints in sequence (the buffered one and the final)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429165001, "post_id": 29662357, "comment_id": 47472146, "body": "If you want to synchronize your timeout messages to the time they occur, just finish your printing in a <code>\\n</code> instead of putting it in the beginning.  Other way, you are synchronizing only the end of line (you get an initial <code>\\n</code> with the first timeout, without message)"}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429165153, "post_id": 29662357, "comment_id": 47472227, "body": "@LuisColorado I already asked about this a few comments up. The OP said that all the print msgs came within 10 seconds (expected 15). That is, they came early, not late. So this means it can&#39;t have waited for 15 seconds. So it would seem buffered prints are not the issue."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429165400, "post_id": 29662357, "comment_id": 47472344, "body": "@AlanAu, I tried to answer the question of having two simultaneous timeout messages at the end of the server program.  And this is the right answer to that question.  The messages where buffered in stdio stomach.  (The server marks the final timeout and dies, causing the buffered message and this final one to be emitted.) I have not checked in depth this code, so I cannot see the issue you comment."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429181908, "post_id": 29662357, "comment_id": 47482906, "body": "@LuisColorado Thanks sir, it solved part of the problem (The two prints). The other part was that it doesn&#39;t wait 5 seconds before the printing &quot;Gave up transmission&quot;, and that was caused by not executing the recvfrom if that was the third iteration; since it is in the beginning of the loop. This was solved by getting it out before the loop and repeating it in the first if condition after the sendto call."}, {"owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "edited": false, "score": 0, "creation_date": 1429181935, "post_id": 29662357, "comment_id": 47482926, "body": "@AlanAu Check the solution and thanks sir for your time."}], "tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": true, "score": 2, "last_activity_date": 1429138447, "creation_date": 1429138447, "answer_id": 29662357, "question_id": 29661925, "link": "https://stackoverflow.com/questions/29661925/issue-with-timeout-and-re-transmission-in-tftp/29662357#29662357", "title": "Issue With Timeout and Re-transmission in TFTP", "body": "<p>Likely caused by this:</p>\n\n<pre><code>struct timeval tv;\ntv.tv_sec = 5;\n</code></pre>\n\n<p>tv is allocated on the stack. Stack memory is uninitialised and thus has random values in it. So you need to explicitly set tv.tv_usec to 0.</p>\n"}, {"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429165083, "post_id": 29662991, "comment_id": 47472194, "body": "TFTP uses UDP, not TCP, so there&#39;s no connection to close and kill the server.  Your answer is invalid for this case.  Killing the client does nothing on the server side.  Receiving ICMP unreachable port might not be enough to kill the server."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1429142053, "creation_date": 1429142053, "answer_id": 29662991, "question_id": 29661925, "link": "https://stackoverflow.com/questions/29661925/issue-with-timeout-and-re-transmission-in-tftp/29662991#29662991", "title": "Issue With Timeout and Re-transmission in TFTP", "body": "<p>the OP;''s method of testing is to kill the client.  However, that kills the socket.  Not a good method of testing.</p>\n\n<p>the linux man page for getaddrinfo contains an example for the server code and for the client code for an echo service.   The basic logic can be applied to tftp service.   </p>\n\n<p>Do remember that tftp has several states.  Those states should be reflected in the code logic.</p>\n"}], "owner": {"reputation": 336, "user_id": 3490561, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e0cdca916206f35fc46a16b03deb8ebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3490561", "link": "https://stackoverflow.com/users/3490561/user3490561"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 29662357, "answer_count": 2, "score": 0, "last_activity_date": 1429142053, "creation_date": 1429136319, "last_edit_date": 1429136781, "question_id": 29661925, "link": "https://stackoverflow.com/questions/29661925/issue-with-timeout-and-re-transmission-in-tftp", "title": "Issue With Timeout and Re-transmission in TFTP", "body": "<p>I wrote a simple TFTP server that only handles read requests (RRQ) and it is working fine. The server is supposed to re-transmit the current data packet again, if no ACK is received within 5 seconds. The server should also re-transmit the packet three times before giving up. I tried to suspend the client in the middle of a transmission session to see if the server would re-transmit the data packet again and it didn't. The problem seems to be that the server doesn't continue in the <code>while</code> loop. I tried to test if it escapes the loop and it didn't. I really can't figure out why doesn't it iterates through the loop again.</p>\n\n<p>Here's the code I've written so far...</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;time.h&gt;\n\n#define TIMEOUT 5000\n#define RETRIES 3\n\nvoid sendFile (char *Filename, char *mode, struct sockaddr_in client, int tid)\n{\n    struct timeval tv;\n    tv.tv_sec = 5;\n    char path[70] = \"tmp/\";\n    char filebuf [1024];\n    int count = 0, i;  // Number of data portions sent \n    unsigned char packetbuf[1024];\n    char recvbuf[1024];\n    socklen_t recv_size;\n\n    int sock = socket(PF_INET, SOCK_DGRAM, 0);\n    socklen_t optionslength = sizeof(tv);\n    setsockopt(sock, SOL_SOCKET, SO_RCVTIMEO, &amp;tv, optionslength);\n\n    FILE *fp;\n    char fullpath[200];\n    strcpy(fullpath, path);\n    strncat(fullpath, Filename, sizeof(fullpath) -1);\n    fp = fopen(fullpath, \"r\");\n    if (fp == NULL)\n        perror(\"\");\n\n    memset(filebuf, 0, sizeof(filebuf));\n    while (1)\n    {   \n        int acked = 0;\n        int ssize = fread(filebuf, 1 , 512, fp);\n        count++;        \n        sprintf((char *) packetbuf, \"%c%c%c%c\", 0x00, 0x03, 0x00, 0x00);\n        memcpy((char *) packetbuf + 4, filebuf, ssize);\n        packetbuf[2] = (count &amp; 0xFF00) &gt;&gt; 8;\n        packetbuf[3] = (count &amp; 0x00FF);\n\n        int len = 4 + ssize;        \n\n        memset(recvbuf, 0, 1024);\n        printf(\"\\nSending Packet #%d\", count);\n        sendto(sock, packetbuf, len, 0, (struct sockaddr *) &amp;client, sizeof(client));\n\n        for (i=0; i&lt;3; i++)\n        {\n            int result = recvfrom(sock, recvbuf, 1024, 0, (struct sockaddr *) &amp;client, &amp;recv_size);\n\n            if ((result == -1) &amp;&amp; ((errno == EAGAIN) || (errno == EWOULDBLOCK)))\n            {\n                printf(\"\\nRetransmitting Packet #%d\",count);\n                sendto(sock, packetbuf, len, 0, (struct sockaddr *) &amp;client, sizeof(client));\n            }\n\n            else if (result == -1)\n            {\n\n            }\n\n            else \n            {\n                if (tid == ntohs(client.sin_port))\n                {\n                    printf(\"\\nReceived Ack #%d\",count);\n                    acked++;\n                    break;\n                }\n\n                else\n                    continue;\n            }\n        }\n\n        if (acked!=1)\n        {\n            puts(\"\\nGave Up Transmission\");\n            break;\n        }\n\n        if (ssize != 512)\n        {\n            break;\n\n        }\n    }\n}\n\n\nint main()\n{\n    int udpSocket, nBytes, tid, pid, status;\n    char buffer[1024], filename[200], mode[20], *bufindex, opcode;\n    struct sockaddr_in serverAddr, client;\n    struct sockaddr_storage serverStorage;\n    socklen_t addr_size;\n\n    udpSocket = socket(AF_INET, SOCK_DGRAM, 0);\n\n    serverAddr.sin_family = AF_INET;\n    serverAddr.sin_port = htons(69);\n    serverAddr.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\n    memset(serverAddr.sin_zero, '\\0', sizeof serverAddr.sin_zero); \n\n    bind(udpSocket, (struct sockaddr *) &amp;serverAddr, sizeof(serverAddr));\n    pid = fork();\n\n    while(1)\n    {\n        int client_len = sizeof(client);\n        memset (buffer, 0, 1024);\n        nBytes = 0;\n        while (errno == EAGAIN || nBytes == 0)\n        {\n            waitpid(-1, &amp;status, WNOHANG);\n            nBytes = recvfrom(udpSocket,buffer,1024,0,(struct sockaddr *)&amp;client, &amp;client_len);\n\n        }\n\n        bufindex = buffer;\n        bufindex++;\n\n        // Record the client port...\n        tid = ntohs(client.sin_port); \n\n        // Extracting the opcode from the packet...     \n        opcode = *bufindex++;\n\n        // Extracting the filename from the packet...\n        strncpy(filename, bufindex, sizeof(filename)-1);\n\n        bufindex += strlen(filename) + 1;\n\n        // Extracting the mode from the packet...       \n        strncpy(mode, bufindex, sizeof(mode)-1);\n\n        // If we received an RRQ...\n        if (opcode == 1)\n        {\n            puts(\"Received RRQ Packet\");\n            pid = fork();\n            if (pid == 0)\n            {\n                sendFile(filename, mode, client, tid);\n                exit(1);\n            }\n        }\n    }   \n\n    return 0;\n}\n</code></pre>\n\n<p>Note: You can use the standard TFTP client that comes with linux to test the server.</p>\n\n<p>Thanks in advance :)</p>\n"}, {"tags": ["c", "arrays", "types", "c11"], "comments": [{"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1429136254, "post_id": 29661760, "comment_id": 47463373, "body": "This sounds like a bad idea - what do you hope to achieve by not allocating and de-allocating appropriate arrays for each use case ?"}, {"owner": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 0, "creation_date": 1429136428, "post_id": 29661760, "comment_id": 47463445, "body": "The application is extremely performance sensitive. This would avoid creating and destroying objects, and it would also keep the working space smaller for cache considerations. I understand that I can reuse dynamically allocated space, but one large space saves calculations of more exact upper bounds on the space needed."}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1429136777, "post_id": 29661760, "comment_id": 47463572, "body": "Sounds like premature optimisation, and effectively all you are doing is overlaying your own memory management scheme on top of the system&#39;s. You may also lose out on the system&#39;s memory-related optimisations too, e.g. lazy allocation, zero pages, copy-on-write, etc. I suggest writing clean functional code first, and then only apply optimisation hacks later if they prove to be necessary."}], "answers": [{"comments": [{"owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "edited": false, "score": 1, "creation_date": 1429136921, "post_id": 29662022, "comment_id": 47463633, "body": "Another possible solution is to use a union array. Then aliasing should be legal."}, {"owner": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "edited": false, "score": 0, "creation_date": 1429137120, "post_id": 29662022, "comment_id": 47463713, "body": "Thanks for that example. So can it be shown from the standard that alignment is the only possible problem? Because I could just do something to ensure proper alignment, like what Veritas said."}, {"owner": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "reply_to_user": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "edited": false, "score": 2, "creation_date": 1429137335, "post_id": 29662022, "comment_id": 47463779, "body": "@jack technically an implementation can do anything when optimizing if you don&#39;t follow strict aliasing rules."}, {"owner": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "reply_to_user": {"reputation": 2050, "user_id": 3024983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/px3w6.jpg?s=128&g=1", "display_name": "Veritas", "link": "https://stackoverflow.com/users/3024983/veritas"}, "edited": false, "score": 0, "creation_date": 1429137546, "post_id": 29662022, "comment_id": 47463849, "body": "@Veritas, so it seems that making an array of the union of the four integer types would have lots of padding, would this work if it were a union of four objects where each where an array of the appropriate number of one of the four integer types?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "edited": false, "score": 3, "creation_date": 1429137696, "post_id": 29662022, "comment_id": 47463901, "body": "@jack: Yes, in an array of unions of integers, each element would have the size of the largest integer type. A union of arrays would work. Creating the array at startup with <code>malloc</code> would be simpler. Is the design of your application such that you need large arrays of each of several integer types <b>and</b> you&#39;re using only one of them at a time? That seems unusual."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1429137990, "post_id": 29662022, "comment_id": 47464002, "body": "For the recent comment &quot;union of arrays&quot; +1, that is a reasonable approach to solve OP dilemma."}, {"owner": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "edited": false, "score": 0, "creation_date": 1429138017, "post_id": 29662022, "comment_id": 47464014, "body": "@Keith Thompson Ya, this is mostly the case. There are some cases where it seems I could be a little more efficient by using one half for one type and the other for a different type, but it doesn&#39;t seem like overlapping memory usage that much is really going to work out. But I get most of what I want using the array for different types in a serial fashion."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 3, "last_activity_date": 1429138272, "last_edit_date": 1429138272, "creation_date": 1429136845, "answer_id": 29662022, "question_id": 29661760, "link": "https://stackoverflow.com/questions/29661760/c11-standard-guarantees-for-casting-one-array-type-to-another/29662022#29662022", "title": "C11 standard guarantees for casting one array type to another", "body": "<p>First off, you're not talking about casting <em>arrays</em>.  You're talking about casting <em>pointers</em>.</p>\n\n<p>The standard does not guarantee that what you're doing is safe. You can treat an array of <code>unsigned long long</code> as, for example, an array of <code>unsigned char</code>, but there's no guarantee that you can treat it as an array of <code>unsigned int</code>.</p>\n\n<p>Consider a hypothetical implementation with <code>CHAR_BIT==8</code>, <code>sizeof (unsigned int) == 4</code>, and <code>sizeof (unsigned long long) == 8</code>.  Assume <code>unsigned int</code> requires strict 4-byte alignment. But the underlying machine has no direct support for 64-bit quantities, so all operations on <code>unsigned long long</code> are done in software. Because of this, the required alignment for <code>unsigned long long</code> is, let's say, 2 bytes.</p>\n\n<p>So an array of <code>unsigned long long</code> might start at an address that's not a multiple of 4 bytes, and therefore you can't safely treat it as an array of <code>unsigned int</code>.</p>\n\n<p>I don't suggest that this is a <em>plausible</em> implementation. Even if 64-bit integers are implemented in software, it would probably make sense for them to have at least 32-bit alignment. But nothing in what I've described violates the standard; the hypothetical implementation could be conforming.</p>\n\n<p>If you're using a C11 compiler (as indicated by the tag on your question), you could statically assert that</p>\n\n<pre><code>_Alignof (unsigned long long) &gt; _Alignof (unsigned int)\n</code></pre>\n\n<p>and so forth.</p>\n\n<p>Or you could use <code>malloc</code> during startup to allocate your array, guaranteeing that it's properly aligned for any type.</p>\n\n<p>Stealing an idea from the comments, you could define a union of array types, something like:</p>\n\n<pre><code>#define BYTE_COUNT some_big_number\nunion arrays {\n    unsigned char      ca[BYTE_COUNT];\n    unsigned short     sa[BYTE_COUNT  / sizeof (unsigned short)];\n    unsigned int       ia[BYTE_COUNT  / sizeof (unsigned int)];\n    unsigned long      la[BYTE_COUNT  / sizeof (unsigned long)];\n    unsigned long long lla[BYTE_COUNT / sizeof (unsigned long long)];\n};\n</code></pre>\n\n<p>Or you could define your arrays for the type of data you want to store in them.</p>\n"}], "owner": {"reputation": 282, "user_id": 4702391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/eb7837ca573f143504b49087dabb4666?s=128&d=identicon&r=PG&f=1", "display_name": "jack", "link": "https://stackoverflow.com/users/4702391/jack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 29662022, "answer_count": 1, "score": 1, "last_activity_date": 1429138272, "creation_date": 1429135559, "last_edit_date": 1429136869, "question_id": 29661760, "link": "https://stackoverflow.com/questions/29661760/c11-standard-guarantees-for-casting-one-array-type-to-another", "title": "C11 standard guarantees for casting one array type to another", "body": "<p>So I have an application where I use a lot of arrays of chars, shorts, ints, and long longs, all unsigned. Rather than allocating space for each and deallocating, my thought is to have a static array of unsigned long longs. I would then cast this as needed as an array of the appropriate type. Is there a way to prove this is compliant with the standard?</p>\n\n<p>I am statically asserting that char, short, int, and long long are of sizes 1, 2, 4, and 8, respectively, and that their alignment requirements do not exceed their sizes. I would like to know if I can prove the validity of my approach with no further static assertions.</p>\n\n<p>EDIT: I thought I'd add that the standard defines object representation as a copy of an object as an array of unsigned char. It seems that this justifies using an unsigned long long array as either that or an unsigned char array, although I cannot absolutely rule out problems associated with using the object representation in context of the object itself rather than in a copy (which is how 6.2.6.1.4 discusses the object representation). This is, however, all I can find, and it does not help at all with the two intermediate integer sizes.</p>\n"}, {"tags": ["c", "zos", "xlc"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1429146560, "post_id": 29661695, "comment_id": 47466628, "body": "What do you mean by &quot;expanded&quot;?  According to this link (<a href=\"http://www-01.ibm.com/support/knowledgecenter/SSQ2R2_9.0.0/com.ibm.tpf.toolkit.compilers.doc/ref/user_guide_zos/cbcugmst164.htm%23HDRSHOWINC\" rel=\"nofollow noreferrer\">www-01.ibm.com/support/knowledgecenter/SSQ2R2_9.0.0/&hellip;</a>), the option only specifies whether or not the files processed are displayed as they&#39;re processed. If so, the easy solution is to filter out the files you don&#39;t want to see with something like grep."}, {"owner": {"reputation": 55, "user_id": 4746729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d5eff0844a0662b19c432be551ea8c?s=128&d=identicon&r=PG", "display_name": "djacks", "link": "https://stackoverflow.com/users/4746729/djacks"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1429152327, "post_id": 29661695, "comment_id": 47468175, "body": "I want the entire contents of the &#39;copybooks&#39; in userinc1 and userinc2 to be displayed in the compiler output but I don&#39;t want the 2 system .h files to be expanded in the compiler output (many thousand of lines) grep.... This is z/OS not a Unix system!"}, {"owner": {"reputation": 476, "user_id": 12121251, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDRRdwD19WhZSZE2xvp4dgsLxDR6APnRrLJ2mR2FQ=k-s128", "display_name": "Milos Lalovic", "link": "https://stackoverflow.com/users/12121251/milos-lalovic"}, "edited": false, "score": 0, "creation_date": 1570222747, "post_id": 29661695, "comment_id": 102858408, "body": "The compiler on z/OS does not support selective showing of include files in the source listing. You get all or none."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4746729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d5eff0844a0662b19c432be551ea8c?s=128&d=identicon&r=PG", "display_name": "djacks", "link": "https://stackoverflow.com/users/4746729/djacks"}, "edited": false, "score": 0, "creation_date": 1429195893, "post_id": 29666506, "comment_id": 47494085, "body": "No,  SHOWINC on z/OS does not take any parameters.    Looks like there is no means to accomplish this."}], "tags": [], "owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "is_accepted": false, "score": 0, "last_activity_date": 1429164224, "creation_date": 1429164224, "answer_id": 29666506, "question_id": 29661695, "link": "https://stackoverflow.com/questions/29661695/ibm-xl-c-compiler-how-do-i-expand-user-includes-but-not-system-includes/29666506#29666506", "title": "IBM XL C compiler - how do I expand user includes but not system includes", "body": "<pre><code>SHOWINC=USR\n</code></pre>\n\n<p>should do what you want. At least it does on XL C for AIX.</p>\n"}], "owner": {"reputation": 55, "user_id": 4746729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15d5eff0844a0662b19c432be551ea8c?s=128&d=identicon&r=PG", "display_name": "djacks", "link": "https://stackoverflow.com/users/4746729/djacks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429164224, "creation_date": 1429135247, "last_edit_date": 1429135352, "question_id": 29661695, "link": "https://stackoverflow.com/questions/29661695/ibm-xl-c-compiler-how-do-i-expand-user-includes-but-not-system-includes", "title": "IBM XL C compiler - how do I expand user includes but not system includes", "body": "<p>Searched all the IBM manuals but surprisingly can't find the answer.\nI have the following:</p>\n\n<pre><code>#include &lt; stdlib.h&gt;  \n#include &lt; stdio.h&gt;   \n\n#include  \"userinc1\" \n#include  \"userinc2\" \n</code></pre>\n\n<p>There is a compile option  - which has a default of NOSHOWINC \nIf I change this to SHOWINC and recompile - I get everything expanded from all 4 includes above. I only want the user includes to be expanded..</p>\n\n<p>So far not spotted any option to do this - so any help would be appreciated.\nThis is the IBM XL C compiler running on z/OS.</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1429135172, "post_id": 29661635, "comment_id": 47462939, "body": "<code>fgets()</code> is not in the posted code."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429135221, "post_id": 29661635, "comment_id": 47462967, "body": "You have presented two source files, but they don&#39;t make up even <i>one</i> program."}, {"owner": {"reputation": 77, "user_id": 4076456, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2FMFjpYNC8Y/AAAAAAAAAAI/AAAAAAAAAGM/xOpvPfCG22c/photo.jpg?sz=128", "display_name": "Tom Plutz", "link": "https://stackoverflow.com/users/4076456/tom-plutz"}, "edited": false, "score": 0, "creation_date": 1429135226, "post_id": 29661635, "comment_id": 47462971, "body": "im sorry. must not have copied it all. give me a moment"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1429135493, "post_id": 29661635, "comment_id": 47463081, "body": "<code>numberText=getGuess();printf(&quot;user input: %d\\n&quot;, numberText);</code>"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1429135691, "post_id": 29661635, "comment_id": 47463158, "body": "Or if @BLUEPIXY was too terse for you, the <code>getGuess()</code> function <i>returns</i> the value of the guess.  It doesn&#39;t communicate it in any other way.  Your code ignores the return value, but assumes that variable <code>answer</code> has somehow been set to that value."}, {"owner": {"reputation": 77, "user_id": 4076456, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2FMFjpYNC8Y/AAAAAAAAAAI/AAAAAAAAAGM/xOpvPfCG22c/photo.jpg?sz=128", "display_name": "Tom Plutz", "link": "https://stackoverflow.com/users/4076456/tom-plutz"}, "edited": false, "score": 0, "creation_date": 1429135986, "post_id": 29661635, "comment_id": 47463255, "body": "Ohh! Thanks so much, I was wondering about it not using the return value but did not think of that."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 1, "creation_date": 1429136078, "post_id": 29661635, "comment_id": 47463299, "body": "the playgame() function is recursive, it should be a do ... while loop instead.  The recursive feature has no positive exit other than the user guessing the correct number.  Which, a user could guess all 255 possible numbers before guessing the right number.   even then the user might keep re-guessing the same incorrect number, so the program never ends.  even recursion 255 deep is not a good plan.  the unlimited recursion of the posted code is a VERY BAD idea."}, {"owner": {"reputation": 77, "user_id": 4076456, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2FMFjpYNC8Y/AAAAAAAAAAI/AAAAAAAAAGM/xOpvPfCG22c/photo.jpg?sz=128", "display_name": "Tom Plutz", "link": "https://stackoverflow.com/users/4076456/tom-plutz"}, "edited": false, "score": 0, "creation_date": 1429136270, "post_id": 29661635, "comment_id": 47463381, "body": "Yeah, am still new to programming, will do that instead."}], "answers": [{"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1429141028, "last_edit_date": 1495539816, "creation_date": 1429141028, "answer_id": 29662847, "question_id": 29661635, "link": "https://stackoverflow.com/questions/29661635/taking-input-using-fgets-and-saves-different-than-inputted/29662847#29662847", "title": "Taking input using fgets(); and saves different than inputted", "body": "<p>No assignment </p>\n\n<pre><code>getGuess();\nif( answer &gt; numberText)\n</code></pre>\n\n<p>Should be</p>\n\n<pre><code>answer = getGuess();\nif( answer &gt; numberText)\n</code></pre>\n\n<p>Wrote up answer from comments and moved to community, so OP can close this.</p>\n\n<p>Credit: <a href=\"https://stackoverflow.com/users/2402272/john-bollinger\">@John Bollinger</a>\n<a href=\"https://stackoverflow.com/users/971127/bluepixy\">@BLUEPIXY</a></p>\n"}], "owner": {"reputation": 77, "user_id": 4076456, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-2FMFjpYNC8Y/AAAAAAAAAAI/AAAAAAAAAGM/xOpvPfCG22c/photo.jpg?sz=128", "display_name": "Tom Plutz", "link": "https://stackoverflow.com/users/4076456/tom-plutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 29662847, "answer_count": 1, "score": -1, "last_activity_date": 1429243580, "creation_date": 1429134965, "last_edit_date": 1429243580, "question_id": 29661635, "link": "https://stackoverflow.com/questions/29661635/taking-input-using-fgets-and-saves-different-than-inputted", "title": "Taking input using fgets(); and saves different than inputted", "body": "<p>I am taking 2 programs and linking them for a homework assignment, and it asks for user input, and saves a different value than the input. The code in program 1 is the professor's other than the print statements for debugging and others have had no issues with it. But i am curious why its not saving correctly.</p>\n\n<p><strong>program 1:</strong></p>\n\n<pre><code>#include        &lt;stdlib.h&gt;\n#include        &lt;stdio.h&gt;\n\n#define         TEXT_LEN        256\n\n\n//\n//      Declarations go here:\n//\n\n//  PURPOSE:  To hold the computer's answer.\nextern int      answer;\n\n//  PURPOSE:  To, in a loop:\n//      (1) get an integer that from the user by calling 'getGuess()',\n//      (2) increment 'count',\n//      (3) compare the user's guess with 'answer'\n//        (3a) if they are equal, print how may guesses the user used and\n//             quit the loop,\n//        (3b) if the guess too high print print \"Too high!\\n\"\n//        (3c) if the guess too low print print \"Too low!\\n\"\n//      No parameters.  No return value.\nextern\nvoid            playGame        ();\n\n\n//\n//      Function and variables go here:\n//\n\n//  PURPOSE:  To keep track of the number of guesses the user used.\nint             count   = 0;\n\n\n//  PURPOSE:  To set 'answer' to the computer's answer.  No parameters.  No\n//      return value.\nvoid            generateAnswer  ()\n{\n  answer        = rand() % 256;\n  printf(\"answer: %d\",answer);\n}\n//  PURPOSE:  To ask the user for an integer, and to return it.  No parameters.\nint     getGuess    ()\n{\n  char  numberText[TEXT_LEN];\n\n  printf(\"Please guess my number in 0..255: \");\n  fgets(numberText,TEXT_LEN,stdin);\n  return(strtol(numberText,NULL,10));\n}\n\n\n int    main    ()\n{\n  generateAnswer();\n  playGame();\n  return(EXIT_SUCCESS);\n}\n</code></pre>\n\n<p><strong>program 2:</strong></p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n#define         TEXT_LEN        256\n\nint answer;\nint count;\nvoid playGame();\nint numberText;\n\nvoid playGame()\n{\n printf(\"user input: %d\",numberText);\n getGuess();\n if( answer &gt; numberText)\n {\n  printf(\"Too Low!\");\n  count += 1;\n }\n if( answer &lt; numberText)\n {\n  printf(\"Too High!\");\n  count += 1;\n }\n if (answer == numberText)\n {\n  count += 1;\n  printf(\"Just right! It took %d tries\",count);\n  return;\n }\n playGame();\n}\n</code></pre>\n\n<p><strong>output:</strong>\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[tplutz@cdmlinux CSC374]$ ./whole\n    answer: 103user input: 0Please guess my number in 0..255: 23\n    user input : -1078133976 Too Low!user input: 0Please guess my number in     0..255: 150\n    user input : -1078133992 Too Low!user input: 0Please guess my number in 0..255: 103\n    user input : -1078134008 Too Low!user input: 0Please guess my number in 0..255:`\n</code></pre>\n"}, {"tags": ["c", "assert"], "comments": [{"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 6, "creation_date": 1429134593, "post_id": 29661531, "comment_id": 47462696, "body": "Please show <a href=\"https://stackoverflow.com/help/mcve\">a complete example</a> that we can try compile and execute.  Do reduce it to the minimal amount of code needed to reproduce the error, though.  The above snippet doesn&#39;t make sense for me."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1429134675, "post_id": 29661531, "comment_id": 47462737, "body": "Are you sure it&#39;s that line, and not some other <code>createDynArr</code> call?"}, {"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 0, "creation_date": 1429134707, "post_id": 29661531, "comment_id": 47462753, "body": "so what&#39;s the value in <code>cap</code> at that point?"}, {"owner": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "edited": false, "score": 0, "creation_date": 1429134917, "post_id": 29661531, "comment_id": 47462833, "body": "If you&#39;re sure that <code>cap</code> has an int value, try to do a cast to int inside the assert."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "reply_to_user": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "edited": false, "score": 0, "creation_date": 1429135116, "post_id": 29661531, "comment_id": 47462913, "body": "@BtcSources What would be the point of doing this?"}, {"owner": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1429135228, "post_id": 29661531, "comment_id": 47462972, "body": "@5gon12eder since we don&#39;t know why the assertion has failed, just try to figure out if the problem has something to do with the type of value being valued inside the expression."}, {"owner": {"reputation": 175, "user_id": 4793368, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8d2eca5667d00af150026bbdb9bde1a4?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4793368/john-doe"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1429135415, "post_id": 29661531, "comment_id": 47463046, "body": "@5gon12eder I added more details. very odd."}, {"owner": {"reputation": 175, "user_id": 4793368, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8d2eca5667d00af150026bbdb9bde1a4?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4793368/john-doe"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1429135473, "post_id": 29661531, "comment_id": 47463070, "body": "@user2357112 That is the only time I call createDynArr in main sadly"}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429135663, "post_id": 29661531, "comment_id": 47463141, "body": "compiles and runs fine for me <a href=\"http://ideone.com/k9JB06\" rel=\"nofollow noreferrer\">ideone.com/k9JB06</a>"}, {"owner": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "edited": false, "score": 0, "creation_date": 1429135870, "post_id": 29661531, "comment_id": 47463215, "body": "Same here, just worked fine. Compiled with: <code>gcc version 4.6.3</code>."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 1, "creation_date": 1429136107, "post_id": 29661531, "comment_id": 47463311, "body": "Your example is still incomplete and insufficient to provide useful help.  Please read through the help page linked in my previous comment and improve your question accordingly.  The error is very likely in a part of your program where you don&#39;t expect it but we can only tell you if we can see it.  The most likely thing to happen is that while you are trying to create the minimal example, the error will suddenly go away.  Congratulations: you have found the error yourself; it was on the last line you have deleted before that.  You might also find it helpful to run your program in a debugger."}, {"owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "edited": false, "score": 0, "creation_date": 1429138827, "post_id": 29661531, "comment_id": 47464287, "body": "run it under a debugger - you are not running the code you think you are, the debugger will show you what code you are actually running"}], "answers": [{"comments": [{"owner": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "edited": false, "score": 0, "creation_date": 1429135440, "post_id": 29661694, "comment_id": 47463060, "body": "Since this is <code>c</code> and type is <code>int</code>, this isn&#39;t an object but a primitive type. Having said that, shouldn&#39;t just return &quot;false&quot; (then, 0 as int value) the logic expression evaluation?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "edited": false, "score": 0, "creation_date": 1429135552, "post_id": 29661694, "comment_id": 47463105, "body": "@Btc Sources I am sorry I have not understood what you said."}, {"owner": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1429136233, "post_id": 29661694, "comment_id": 47463361, "body": "He could also have a stack corruption."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 21714, "user_id": 1392132, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/QF6FZ.jpg?s=128&g=1", "display_name": "5gon12eder", "link": "https://stackoverflow.com/users/1392132/5gon12eder"}, "edited": false, "score": 0, "creation_date": 1429136412, "post_id": 29661694, "comment_id": 47463439, "body": "@5gon12eder  More likely that he uses an expression where int is converted to unsigned int (or size_t) and then when the function is called the value again is converted to int and becomes negative."}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1429136788, "last_edit_date": 1429136788, "creation_date": 1429135245, "answer_id": 29661694, "question_id": 29661531, "link": "https://stackoverflow.com/questions/29661531/assertion-crashing-my-program-even-if-condition-is-true/29661694#29661694", "title": "Assertion crashing my program even if condition is true", "body": "<p>I see the only reason that you are using a value that when placed in an object of type int becomes a negative value. That is it seems that you are using an integer value that is greater than <code>INT_MAX</code></p>\n\n<p>As for your code snippet if to update some details (as for example using structure tag and so on) then it will compile and run successfully.</p>\n\n<p>You should look at the assert message. It shows what is the actual value of cap.:)</p>\n"}], "owner": {"reputation": 175, "user_id": 4793368, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8d2eca5667d00af150026bbdb9bde1a4?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4793368/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1429136788, "creation_date": 1429134481, "last_edit_date": 1429135373, "question_id": 29661531, "link": "https://stackoverflow.com/questions/29661531/assertion-crashing-my-program-even-if-condition-is-true", "title": "Assertion crashing my program even if condition is true", "body": "<p>I have a function where I assert (using assert.h) that a passed argument is greater than 0:</p>\n\n<pre><code>DynArr* createDynArr(int cap)\n{\n    assert(cap &gt; 0);\n    ...\n}\n</code></pre>\n\n<p>when this line runs in main..</p>\n\n<pre><code>DynArr *dyn;\ndyn = createDynArr(2);\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>main: dynamicArray.c:46: createDynArr: Assertion 'cap &gt; 0' failed.\nAbort(core dumped)\n</code></pre>\n\n<p>why is it doing this?</p>\n\n<p>edit - here is a more complete example.</p>\n\n<p>This is the struct and the full implementation of the function in file dynamicArray.c:</p>\n\n<pre><code>struct DynArr\n{\n    TYPE *data;     /* pointer to the data array */\n    int size;       /* Number of elements in the array */\n    int capacity;   /* capacity ofthe array */\n};\n\nDynArr* createDynArr(int cap)\n{\n    assert(cap &gt; 0);\n    DynArr *r = (DynArr *)malloc(sizeof( DynArr));\n    assert(r != 0);\n    initDynArr(r,cap);\n    return r;\n}\n\nvoid initDynArr(DynArr *v, int capacity)\n{\n    assert(capacity &gt; 0);\n    assert(v!= 0);\n    v-&gt;data = (TYPE *) malloc(sizeof(TYPE) * capacity);\n    assert(v-&gt;data != 0);\n    v-&gt;size = 0;\n    v-&gt;capacity = capacity;\n}\n</code></pre>\n\n<p>In a separate file, testDynArr.c, I have main function in which I try to create a DynArr struct and give it capacity of 2:</p>\n\n<pre><code>int main(int argc, char* argv[]){\n\n    DynArr *dyn;\n    dyn = createDynArr(2);\n\n    printf(\"\\n\\nTesting addDynArr...\\n\");\n\n\n  ...\n}\n</code></pre>\n\n<p>I link these files like so:</p>\n\n<pre><code>gcc -o main dynamicArray.c testDynArr.c \n</code></pre>\n\n<p>and then run main which gives the assert error.  </p>\n"}, {"tags": ["c", "arrays", "pointers", "struct"], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 0, "creation_date": 1429218977, "post_id": 29661558, "comment_id": 47509252, "body": "Are there any good reason for using an array instead of the malloc function?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 1, "creation_date": 1429219065, "post_id": 29661558, "comment_id": 47509298, "body": "@user4793972, well, the array here is allocated on the stack and is automatically deallocated when your function exits, whereas if you use malloc you get memory from the heap, and need to deallocate it yourself or else it leaks."}], "tags": [], "owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "is_accepted": false, "score": 2, "last_activity_date": 1429134594, "creation_date": 1429134594, "answer_id": 29661558, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/29661558#29661558", "title": "Cast struct to array?", "body": "<p>The buffer is just serving as an area of memory -- that it's an array of characters is unimportant to this code; it could be an array of any other type, <em>as long as it were the correct size</em>.</p>\n\n<p>The struct defines how you're using that memory -- as a bitfield, it presents that with extreme specificity.</p>\n\n<p>That said, presumably you're sending this structure out over the network -- the code that does the network IO probably expects to be passed a buffer that's in the form of a character array, because that's intrinsically the sanest option -- network IO being done in terms of sending <em>bytes</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 4218, "user_id": 865281, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/435568f417505b4ccd67ee51253b5f5e?s=128&d=identicon&r=PG", "display_name": "Xaqq", "link": "https://stackoverflow.com/users/865281/xaqq"}, "reply_to_user": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 1, "creation_date": 1429136210, "post_id": 29661577, "comment_id": 47463353, "body": "@user4793972 if you are using malloc, then you must not take the address of the pointer <code>&amp;buffer</code> but the pointer itself (because it points to memory allocated by <code>malloc</code>): <code>ptr = (struct dns_header *)buffer</code>."}, {"owner": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 0, "creation_date": 1429218569, "post_id": 29661577, "comment_id": 47509036, "body": "I got it to work with malloc now. Thanks for pointing that out."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 0, "creation_date": 1429222669, "post_id": 29661577, "comment_id": 47510947, "body": "@user4793972 you can accept the answer if it was helpful."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1429134706, "creation_date": 1429134706, "answer_id": 29661577, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/29661577#29661577", "title": "Cast struct to array?", "body": "<p>Suppose you want to allocate space for the struct so you could </p>\n\n<pre><code>ptr = malloc(sizeof(struct dns_header)); \n</code></pre>\n\n<p>which will return a pointer to the allocated memory, </p>\n\n<pre><code>ptr = (struct dns_header *) &amp;buffer; \n</code></pre>\n\n<p>is almost the same, except that in this case it's allocated in the stack, and it's not necessary to take the address of the array, it can be </p>\n\n<pre><code>ptr = (struct dns_header *) &amp;buffer[0];\n</code></pre>\n\n<p>or just </p>\n\n<pre><code>ptr = (struct dns_header *) buffer;\n</code></pre>\n\n<p>there is no problem in that though, because the addresses will be the same.</p>\n"}, {"comments": [{"owner": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 0, "creation_date": 1429218748, "post_id": 29661879, "comment_id": 47509136, "body": "Is it better to use an array instead of malloc?"}, {"owner": {"reputation": 233489, "user_id": 14122, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/5e2861b08f37fa306fbf5384994af688?s=128&d=identicon&r=PG", "display_name": "Charles Duffy", "link": "https://stackoverflow.com/users/14122/charles-duffy"}, "reply_to_user": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "edited": false, "score": 2, "creation_date": 1429219153, "post_id": 29661879, "comment_id": 47509363, "body": "@user4793972, re: &quot;better&quot;, that depends on the details. Here, we know exactly how much space we need at compile time -- this wouldn&#39;t be possible at all if you needed to allocate a dynamically determined amount of space, and it also wouldn&#39;t work if we needed any code to be able to refer to the buffer after the function exited (as it is, any pointers into that buffer will become invalid... or, rather, the behavior of accessing them will become undefined... as soon as the function exits)."}], "tags": [], "owner": {"reputation": 4218, "user_id": 865281, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/435568f417505b4ccd67ee51253b5f5e?s=128&d=identicon&r=PG", "display_name": "Xaqq", "link": "https://stackoverflow.com/users/865281/xaqq"}, "is_accepted": true, "score": 4, "last_activity_date": 1429136122, "creation_date": 1429136122, "answer_id": 29661879, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/29661879#29661879", "title": "Cast struct to array?", "body": "<p>Your <code>buffer</code> is simply a contiguous array of raw bytes. They have no semantic from the <code>buffer</code> point of view: you cannot do something like <code>buffer-&gt;ra = 1</code>.</p>\n\n<p>However, from a <code>struct dns_header *</code> point of view those bytes would become meaningful. What you are doing with <code>ptr = (struct dns_header *) &amp;buffer;</code> is mapping your pointer to your data.</p>\n\n<p><code>ptr</code> will now points on the beginning of your array of data. It means that when you write a value (<code>ptr-&gt;ra = 0</code>), you are actually modifying byte 0 from <code>buffer</code>.</p>\n\n<p>You are casting the view of a <code>struct dns_header</code> pointer of your <code>buffer</code> array. </p>\n"}, {"tags": [], "owner": {"reputation": 44162, "user_id": 991484, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/fc34739487a5e7e115acdbadf95c8fb3?s=128&d=identicon&r=PG", "display_name": "dtech", "link": "https://stackoverflow.com/users/991484/dtech"}, "is_accepted": false, "score": 1, "last_activity_date": 1429136591, "creation_date": 1429136591, "answer_id": 29661976, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/29661976#29661976", "title": "Cast struct to array?", "body": "<blockquote>\n  <p>The line I don't understand is ptr = (struct dns_header *) &buffer;</p>\n</blockquote>\n\n<p>You take the address of the array and pretend like it is a pointer to a <code>dns_header</code>. It is basically raw memory access, which is unsafe, but OK if you know what you are doing. Doing so will grant you access to write a <code>dns_header</code> in the beginning of the array.</p>\n\n<p>Ideally, it should be an array of <code>dns_header</code>s not a byte array.  You have to be cautious about the fact that <code>dns_header</code> contains bit fields, the implementation of which is not enforced by the standard, it is entirely up to the compiler vendors. Although bit field implementations are fairly \"sane\", there is no guarantee, so the size of a byte array might actually be mismatched with your intent. </p>\n"}, {"comments": [{"owner": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1429149330, "post_id": 29662637, "comment_id": 47467351, "body": "Matt are you saying that <code>ptr-&gt;q_count = htons(1);</code> violates strict aliasing because <code>ptr</code> and <code>buffer</code> both point to the same memory location under different types and <code>q_count</code> is not type qualified as a <code>char</code> or because there is something else inherently wrong with the  <code>ptr-&gt;q_count = htons(1);</code> assignment itself?"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 68403, "user_id": 3422102, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tg0Gt.png?s=128&g=1", "display_name": "David C. Rankin", "link": "https://stackoverflow.com/users/3422102/david-c-rankin"}, "edited": false, "score": 0, "creation_date": 1429150290, "post_id": 29662637, "comment_id": 47467616, "body": "@DavidC.Rankin <code>ptr-&gt;q_count</code> has type <code>unsigned short</code>, but it is accessing memory of type <code>unsigned char</code>"}], "tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1429139916, "creation_date": 1429139916, "answer_id": 29662637, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/29662637#29662637", "title": "Cast struct to array?", "body": "<p>Adding to the other answers posted:</p>\n\n<p>This code is illegal since ANSI C. <code>ptr-&gt;q_count = htons(1);</code> violates the strict aliasing rule. </p>\n\n<p>It is only permitted to use an <code>unsigned short</code> lvalue (i.e. the expression <code>ptr-&gt;q_count</code>) to access memory that either has no declared type (e.g. <code>malloc</code>'d space), or has declared type of <code>short</code> or <code>unsigned short</code> or compatible.</p>\n\n<p>To use this code as-is, you should pass <code>-fno-strict-aliasing</code> to gcc or clang. Other compilers may or may not have a similar flag.</p>\n\n<p>An improved version of the same code (which also has some forwards-compatibility to the structure size changing) is:</p>\n\n<pre><code>struct dns_header d = { 0 };\nd.q_count = htons(1);\n\nunsigned char *buffer = (unsigned char *)&amp;d;\n</code></pre>\n\n<p>This is legal because the strict aliasing rule permits <code>unsigned char</code> to alias anything.</p>\n\n<p>Note that <code>buffer</code> is currently unused in this code. If your code is actually a smaller snippet of larger code then <code>buffer</code> may have to be defined differently. In any case, it could be in a union with <code>d</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 627, "user_id": 4406891, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0N0qT.png?s=128&g=1", "display_name": "explogx", "link": "https://stackoverflow.com/users/4406891/explogx"}, "is_accepted": false, "score": 0, "last_activity_date": 1606685229, "last_edit_date": 1606685229, "creation_date": 1590853122, "answer_id": 62104796, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array/62104796#62104796", "title": "Cast struct to array?", "body": "<p>A struct directly references a <em>contiguous block</em> of memory and each field within a struct is located at a certain fixed offset from the start. Variables can then be accessed via a struct pointer or by the struct declared name which returns the same address.</p>\n<p>Here we declare a <em>packed</em> struct which references a <em>contiguous block</em> of memory:</p>\n<pre class=\"lang-c prettyprint-override\"><code>#pragma pack(push, 1)\nstruct my_struct\n{\n    unsigned char b0;\n    unsigned char b1;\n    unsigned char b2;\n    unsigned char b3;\n    unsigned char b4;\n};\n#pragma pack(pop)\n</code></pre>\n<p>Pointers can then be used to refer to the struct by its address. See this example:</p>\n<pre class=\"lang-c prettyprint-override\"><code>int main(void)\n{\n    struct my_struct *ptr;\n    unsigned char buffer[5];\n\n    ptr = (struct my_struct *) buffer;\n\n    ptr-&gt;b0 = 'h';\n    ptr-&gt;b1 = 'e';\n    ptr-&gt;b2 = 'l';\n    ptr-&gt;b3 = 'l';\n    ptr-&gt;b4 = 'o';\n\n    for (int i = 0; i &lt; 5; i++)\n    {\n        putchar(buffer[i]); // Print &quot;hello&quot;\n    }\n\n    return 0;\n}\n</code></pre>\n<p>Here we explicitly map <code>1:1</code> the struct contiguous block of memory to the contiguous block of memory pointed by <code>buffer</code> (using the address to the first element).</p>\n<p>An array address and the name of the address are numerically identical but have different types. These two lines are thus equivalent:</p>\n<pre class=\"lang-c prettyprint-override\"><code>ptr = (struct my_struct *) buffer;\nptr = (struct my_struct *) &amp;buffer;\n</code></pre>\n<p>This is usually not a problem if we use the address <em>as it</em> and cast it appropriately. Dereferencing an array address of type <em>pointer to array-of-type</em> yields the same pointer but with a different type <em>array-of-type</em>.</p>\n<p>Although it might seem convenient to manipulate memory in this fashion, it is <em>strongly</em> discouraged as the resulting code becomes painfully difficult to understand. If you really have no choice, I suggest using an union to specify that the struct is to be used in a particular manner.</p>\n"}], "owner": {"reputation": 125, "user_id": 4793972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1081d5cd56aadd8d61ad5c1aea9d748?s=128&d=identicon&r=PG&f=1", "display_name": "user4793972", "link": "https://stackoverflow.com/users/4793972/user4793972"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7169, "favorite_count": 1, "accepted_answer_id": 29661879, "answer_count": 6, "score": 6, "last_activity_date": 1606685229, "creation_date": 1429134412, "question_id": 29661516, "link": "https://stackoverflow.com/questions/29661516/cast-struct-to-array", "title": "Cast struct to array?", "body": "<p>I'm currently learning C and I have trouble understanding the following code:</p>\n\n<pre><code>struct dns_header\n{\n    unsigned char ra : 1;\n    unsigned char z : 1;\n    unsigned char ad : 1;\n    unsigned char cd : 1;\n    unsigned char rcode : 4;\n    unsigned short q_count : 16;\n\n};\n\nint main(void)\n{\n    struct dns_header *ptr;\n    unsigned char buffer[256];\n\n    ptr = (struct dns_header *) &amp;buffer;\n\n    ptr-&gt;ra = 0;\n    ptr-&gt;z = 0;\n    ptr-&gt;ad = 0;\n    ptr-&gt;cd = 0;\n    ptr-&gt;rcode = 0;\n    ptr-&gt;q_count = htons(1);\n\n}\n</code></pre>\n\n<p>The line I don't understand is <code>ptr = (struct dns_header *) &amp;buffer;</code></p>\n\n<p>Can anyone explain this in detail?</p>\n"}, {"tags": ["c", "io", "endianness"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1429135829, "post_id": 29661143, "comment_id": 47463199, "body": "Shouldn&#39;t your other example counteract what you are saying by using another type? Anyway, all <code>fread</code> does is read <code>size * count</code> elements so you don&#39;t have to do the multiply yourself, and you can count in &#39;natural&#39; numbers of the &#39;natural&#39; size of your object."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429140857, "post_id": 29661143, "comment_id": 47465004, "body": "endianess deals with the order of individual bytes within an integer (that&#39;s larger than 1 byte). You seem to be dealing with individual bytes (chars) in both examples, in which there&#39;s no endianess issue. Though if you&#39;re doing funny stuff later on with that char array, you should tell us what you do,"}], "answers": [{"comments": [{"owner": {"reputation": 4244, "user_id": 4577158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MFS4a.jpg?s=128&g=1", "display_name": "Ulfalizer", "link": "https://stackoverflow.com/users/4577158/ulfalizer"}, "reply_to_user": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "edited": false, "score": 0, "creation_date": 1429134543, "post_id": 29661307, "comment_id": 47462669, "body": "Yeah, still depends on the interpretation of the data. I was assuming a plain <code>char</code> array with independent elements."}], "tags": [], "owner": {"reputation": 4244, "user_id": 4577158, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MFS4a.jpg?s=128&g=1", "display_name": "Ulfalizer", "link": "https://stackoverflow.com/users/4577158/ulfalizer"}, "is_accepted": false, "score": 0, "last_activity_date": 1429133486, "last_edit_date": 1495542576, "creation_date": 1429133486, "answer_id": 29661307, "question_id": 29661143, "link": "https://stackoverflow.com/questions/29661143/fread-and-endianness-will-freadpointer-sizeofsome-1-file-pointer-have-the-s/29661307#29661307", "title": "fread and endianness: will fread(pointer,sizeof(some),1,file pointer) have the same result?", "body": "<p>Endianess won't matter for either case when reading into a <code>char</code> array. For cases where endianess does matter, how you specify the total size won't matter. </p>\n\n<p>It's more of a historical artifact that <code>fread()</code> takes both a <code>size</code> and an <code>nmemb</code> parameter. The only difference you're likely to see is in the return value, which is a count in <code>size</code> units.</p>\n\n<p>Excuse the self-plug, but you can find some source code analysis for glibc in <a href=\"https://stackoverflow.com/a/29030076/4577158\">this answer</a>. The gist of it is that <code>size</code> and <code>nmemb</code> are simply multiplied together, with the separated values only being used to calculate the return value.</p>\n"}, {"tags": [], "owner": {"reputation": 17910, "user_id": 3963067, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e536542e9baa5c52499d61fb64f51d3?s=128&d=identicon&r=PG&f=1", "display_name": "gmoniava", "link": "https://stackoverflow.com/users/3963067/gmoniava"}, "is_accepted": false, "score": 1, "last_activity_date": 1429135990, "last_edit_date": 1429135990, "creation_date": 1429133552, "answer_id": 29661322, "question_id": 29661143, "link": "https://stackoverflow.com/questions/29661143/fread-and-endianness-will-freadpointer-sizeofsome-1-file-pointer-have-the-s/29661322#29661322", "title": "fread and endianness: will fread(pointer,sizeof(some),1,file pointer) have the same result?", "body": "<blockquote>\n  <p>For fread(something,sizeof(char),30,fp), endianness matters, but for\n  the above code, does endianness matter?</p>\n</blockquote>\n\n<p>Why do you think those two snippets are different as far as endianness is concerned? To me they both read 30 bytes of data - albeit slightly differently, one specifies in arguments to read one element of size 30 and the other one, specifies it other way around. </p>\n\n<p>But again till now you have just read some number of bytes. Now how you interpret these bytes is where endianness might come in. Read more on endianness: <a href=\"http://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow\">here</a>. Then it depends if you just read some ASCII text endianness might not apply, if you read integer written in binary way endianness might be concern.</p>\n\n<p>ps Also you might want to specify <code>rb</code> in <code>fopen</code></p>\n"}], "owner": {"reputation": 43, "user_id": 4793913, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5fa06aaa681cf2dfed75b7711afec9?s=128&d=identicon&r=PG&f=1", "display_name": "Usqampa Damuth", "link": "https://stackoverflow.com/users/4793913/usqampa-damuth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429135990, "creation_date": 1429132836, "question_id": 29661143, "link": "https://stackoverflow.com/questions/29661143/fread-and-endianness-will-freadpointer-sizeofsome-1-file-pointer-have-the-s", "title": "fread and endianness: will fread(pointer,sizeof(some),1,file pointer) have the same result?", "body": "<p>Suppose I have:</p>\n\n<pre><code>FILE* fp = fopen(\"myfile.bin\", \"r\");\nchar something[30];\nfread(something,sizeof(char)*30,1,fp);\n</code></pre>\n\n<p>For fread(something,sizeof(char),30,fp), endianness matters, but for the above code, does endianness matter? </p>\n"}, {"tags": ["c", "segmentation-fault"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429134407, "post_id": 29661037, "comment_id": 47462606, "body": "BTW <code>nsertT(*ppRoot, *pNew)</code> : 1st argument type might <code>NodeT **</code>"}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1429135963, "post_id": 29661037, "comment_id": 47463251, "body": "&quot;The code won&#39;t run so I cannot debug&quot; -- but it <i>does</i> run, else you would not get a run-time error! Are you confusing &#39;running&#39; with &#39;compiling&#39; or something like that?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4212166, "user_type": "registered", "profile_image": "https://graph.facebook.com/1850585459/picture?type=large", "display_name": "Kdiggity", "link": "https://stackoverflow.com/users/4212166/kdiggity"}, "edited": false, "score": 0, "creation_date": 1429136273, "post_id": 29661182, "comment_id": 47463382, "body": "That fixed it. Thanks so much!"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": true, "score": 4, "last_activity_date": 1429132950, "creation_date": 1429132950, "answer_id": 29661182, "question_id": 29661037, "link": "https://stackoverflow.com/questions/29661037/segmentation-fault-with-fgets-from-input-file-in-c/29661182#29661182", "title": "segmentation fault with fgets from input file in C", "body": "<p>The problem is that although you are checking <code>pNew</code> allocation for <code>NULL</code>, you never actually <em>allocate</em> memory to it.</p>\n\n<p>Add a call to <code>malloc</code> assigning to <code>pNew</code> and the memory check ahead of <code>sscanf</code> call to fix this problem:</p>\n\n<pre><code>while (fgets(szInputBuffer, 100, pfileInventory) != NULL)\n{\n        pNew = malloc(sizeof(Stock));\n        if (pNew == NULL)\n                exitError(\"Memory allocation error\", \"\");\n\n        iScanfCnt = sscanf(szInputBuffer, \"%6s %ld %lf %30[^\\n]\\n\"\n                , pNew-&gt;szStockNumber\n                , &amp;pNew-&gt;lStockQty\n                , &amp;pNew-&gt;dUnitPrice\n                , pNew-&gt;szStockName);\n\n        if (iScanfCnt &lt; 4)\n                exitError(ERR_INVALID_INVENTORY_DATA, \"\\n\");\n\n        printT(insertT(*ppRoot, *pNew));\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4212166, "user_type": "registered", "profile_image": "https://graph.facebook.com/1850585459/picture?type=large", "display_name": "Kdiggity", "link": "https://stackoverflow.com/users/4212166/kdiggity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 29661182, "answer_count": 1, "score": 0, "last_activity_date": 1429179676, "creation_date": 1429132472, "last_edit_date": 1429132974, "question_id": 29661037, "link": "https://stackoverflow.com/questions/29661037/segmentation-fault-with-fgets-from-input-file-in-c", "title": "segmentation fault with fgets from input file in C", "body": "<p>This function uses <code>fgets</code> to input data from a file and store it in a structure. I am getting a segmentation fault and I cannot figure out why. The program won't run so I have not been able to debug. Here is the code for the function: </p>\n\n<pre><code>void getInventory(NodeT **ppRoot, char *pszInventoryFileName)\n{\n    char szInputBuffer[100];       // input buffer for reading data\n    int iScanfCnt;                 // returned by sscanf\n    FILE *pfileInventory;          // Stream Input for Inventory data.\n    Stock *pNew = NULL;\n\n    /* open the Inventory stream data file */\n    if (pszInventoryFileName == NULL)\n            exitError(ERR_MISSING_SWITCH, \"-i\");\n\n    pfileInventory = fopen(pszInventoryFileName, \"r\");\n    if (pfileInventory == NULL)\n            exitError(ERR_INVENTORY_FILENAME, pszInventoryFileName);\n\n    /* get inventory data until EOF\n    ** fgets returns null when EOF is reached.\n    */\n    while (fgets(szInputBuffer, 100, pfileInventory) != NULL)\n    {\n            iScanfCnt = sscanf(szInputBuffer, \"%6s %ld %lf %30[^\\n]\\n\"\n                    , pNew-&gt;szStockNumber\n                    , &amp;pNew-&gt;lStockQty\n                    , &amp;pNew-&gt;dUnitPrice\n                    , pNew-&gt;szStockName);\n\n            if (iScanfCnt &lt; 4)\n                    exitError(ERR_INVALID_INVENTORY_DATA, \"\\n\");\n\n            if (pNew == NULL)\n                    exitError(\"Memory allocation error\", \"\");\n\n            printT(insertT(*ppRoot, *pNew));\n    }\n}\n</code></pre>\n\n<p>The <code>printT</code> and <code>insertT</code> functions are recursive but the program fails before it get that far. And here is the data from the input file:</p>\n\n<pre><code>PPF001 100 9.95 Popeil Pocket Fisherman\nSBB001 300 14.95 Snuggie Brown\nSBG002 400 14.95 Snuggie Green\nBOM001 20 29.95 Bass-O-Matic\nMCW001 70 12.45 Miracle Car Wax\nTTP001 75 9.95 Topsy Turvy Planter\nNHC001 300 9.95 Electric Nose Hair Clipper\nSSX001 150 29.95 Secret Seal\n</code></pre>\n\n<p>Why does this code give me a segmentation fault?</p>\n"}, {"tags": ["c", "linux", "keyboard-events", "modifier-key"], "answers": [{"tags": [], "owner": {"reputation": 300, "user_id": 3536552, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/1EY7A.jpg?s=128&g=1", "display_name": "Kamil Pajak", "link": "https://stackoverflow.com/users/3536552/kamil-pajak"}, "is_accepted": false, "score": 0, "last_activity_date": 1432381758, "creation_date": 1432381758, "answer_id": 30412299, "question_id": 29678011, "link": "https://stackoverflow.com/questions/29678011/determine-linux-keyboard-events-device/30412299#30412299", "title": "Determine Linux keyboard events device", "body": "<p>I had this exact same problem. Here's my solution:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;stdio.h&gt;\n\nstatic const std::string COMMAND_GET_INPUT_DEVICE_EVENT_NUMBER =\n    \"grep -E 'Handlers|EV=' /proc/bus/input/devices |\"\n    \"grep -B1 'EV=120013' |\"\n    \"grep -Eo 'event[0-9]+' |\"\n    \"grep -Eo '[0-9]+' |\"\n    \"tr -d '\\n'\";\n\nstd::string executeCommand(const char *cmd) {\n  FILE *pipe = popen(cmd, \"r\");\n  char buffer[128];\n  std::string result = \"\";\n  while (!feof(pipe))\n    if (fgets(buffer, 128, pipe) != NULL)\n      result += buffer;\n  pclose(pipe);\n  return result;\n}\n\nstd::string getInputDevicePath() {\n  return \"/dev/input/event\" +\n         executeCommand(COMMAND_GET_INPUT_DEVICE_EVENT_NUMBER.c_str());\n}\n\nint main() {\n  std::cout &lt;&lt; getInputDevicePath() &lt;&lt; std::endl;\n  return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7135500, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7Bn2Q.jpg?s=128&g=1", "display_name": "Kiirk", "link": "https://stackoverflow.com/users/7135500/kiirk"}, "is_accepted": false, "score": 1, "last_activity_date": 1485254626, "creation_date": 1485254626, "answer_id": 41826108, "question_id": 29678011, "link": "https://stackoverflow.com/questions/29678011/determine-linux-keyboard-events-device/41826108#41826108", "title": "Determine Linux keyboard events device", "body": "<p>I prefer next solution because it parses devices file internally.<br>\nIf we check contents of /proc/bus/input/devices we can found something like this:</p>\n\n<pre><code># cat /proc/bus/input/devices\nI: Bus=0019 Vendor=0002 Product=0001 Version=0100\nN: Name=\"vmouse\"\nP: Phys=vmouse/input0\nS: Sysfs=/devices/virtual/input/input0\nU: Uniq=\nH: Handlers=mouse0 event0\nB: PROP=0\nB: EV=7\nB: KEY=70400 0 0 0 0 0 0 0 0\nB: REL=143\n\nI: Bus=0019 Vendor=0001 Product=0001 Version=0100\nN: Name=\"sunxi-ths\"\nP: Phys=sunxiths/input0\nS: Sysfs=/devices/virtual/input/input3\nU: Uniq=\nH: Handlers=event3\nB: PROP=0\nB: EV=9\nB: ABS=100 0\n\nI: Bus=0003 Vendor=1220 Product=0008 Version=0100\nN: Name=\"HID 1220:0008\"\nP: Phys=usb-sunxi-ohci-1/input0\nS: Sysfs=/devices/platform/sunxi-ohci.3/usb7/7-1/7-1:1.0/input/input6\nU: Uniq=\nH: Handlers=sysrq kbd event1\nB: PROP=0\nB: EV=120013\nB: KEY=10000 7 ff9f207a c14057ff febeffdf ffefffff ffffffff fffffffe\nB: MSC=10\nB: LED=1f\n\nI: Bus=0003 Vendor=1220 Product=0008 Version=0100\nN: Name=\"HID 1220:0008\"\nP: Phys=usb-sunxi-ohci-1/input1\nS: Sysfs=/devices/platform/sunxi-ohci.3/usb7/7-1/7-1:1.1/input/input7\nU: Uniq=\nH: Handlers=kbd mouse1 event2\nB: PROP=0\nB: EV=1f\nB: KEY=4837fff 72ff32d bf544446 0 0 1f0001 20f90 8b17c000 677bfa d941dfed 9ed680 4400 0 10000002\nB: REL=143\nB: ABS=1 0\nB: MSC=10\n</code></pre>\n\n<p>So the only thing we need is to find event device number in block where \"EV=120013\" string appeared:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;string&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\nusing namespace std;\n\nstring getInputDeviceName() {\n    int rd;\n    std::string devName;\n    const char* pdevsName = \"/proc/bus/input/devices\";\n\n    int devsFile = open(pdevsName, O_RDONLY);\n    if (devsFile == -1) {\n        printf(\"[ERR] Open input devices file: '%s' is FAILED\\n\", pdevsName);\n    }\n    else {\n        char devs[2048];\n\n        if ((rd = read(devsFile, devs, sizeof(devs) - 1)) &lt; 6) {\n            printf(\"[ERR] Wrong size was read from devs file\\n\");\n        }\n        else {\n            devs[rd] = 0;\n\n            char *pHandlers, *pEV = devs;\n            do {\n                pHandlers = strstr(pEV, \"Handlers=\");\n                pEV = strstr(pHandlers, \"EV=\");\n            }\n            while (pHandlers &amp;&amp; pEV &amp;&amp; 0 != strncmp(pEV + 3, \"120013\", 6));\n\n            if (pHandlers &amp;&amp; pEV) {\n                char* pevent = strstr(pHandlers, \"event\");\n                if (pevent) {\n                    devName = string(\"/dev/input/event\");\n                    devName.push_back(pevent[5]);\n                }\n                else {\n                    printf(\"[ERR] Abnormal keyboard event device\\n\");\n                }\n            }\n            else {\n                printf(\"[ERR] Keyboard event device not found\\n\");\n            }\n        }\n    }\n\n    return devName;\n}\n</code></pre>\n\n<p><strong>NOTE1</strong>: This code works on event devices with numbers less than 10.<br>\n<strong>NOTE2</strong>: Please check \"devs\" buffer size, on your system 2048 bytes may be not enough.</p>\n"}], "migrated_from": {"other_site": {"markdown_extensions": ["Prettify"], "launch_date": 1250553600, "open_beta_date": 1247529600, "site_state": "normal", "high_resolution_icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon@2.png", "twitter_account": "super_user", "favicon_url": "https://cdn.sstatic.net/Sites/superuser/Img/favicon.ico", "icon_url": "https://cdn.sstatic.net/Sites/superuser/Img/apple-touch-icon.png", "audience": "computer enthusiasts and power users", "site_url": "https://superuser.com", "api_site_parameter": "superuser", "logo_url": "https://cdn.sstatic.net/Sites/superuser/Img/logo.png", "name": "Super User", "site_type": "main_site"}, "on_date": 1429194987, "question_id": 902074}, "owner": {"reputation": 39, "user_id": 4793522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/367728aa19d6b9f299a5cd5f3d626366?s=128&d=identicon&r=PG&f=1", "display_name": "frank99", "link": "https://stackoverflow.com/users/4793522/frank99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3698, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1485254626, "creation_date": 1429131446, "last_edit_date": 1495542815, "question_id": 29678011, "link": "https://stackoverflow.com/questions/29678011/determine-linux-keyboard-events-device", "title": "Determine Linux keyboard events device", "body": "<p>This other question, <a href=\"https://stackoverflow.com/questions/20943322/accessing-keys-from-linux-input-device\">Accessing Keys from Linux Input Device</a></p>\n\n<p>provided working C code on how to recognize a modifier key press in the Linux text console when no other keys are being pressed.</p>\n\n<p>However, to apply the trick you have to know the specific file <code>/dev/input/event*</code> that logs keyboard events.</p>\n\n<p>How do I determine the name of that file?</p>\n"}, {"tags": ["c", "console", "refresh"], "comments": [{"owner": {"reputation": 299, "user_id": 3176050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a943a11189bc1c0959544934c09d62f8?s=128&d=identicon&r=PG&f=1", "display_name": "fsalazar_sch", "link": "https://stackoverflow.com/users/3176050/fsalazar-sch"}, "edited": false, "score": 0, "creation_date": 1429131602, "post_id": 29660665, "comment_id": 47461052, "body": "Update only the spaces which &#39;use&#39; the snake, and the void spaces."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4771221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P7TPp.jpg?s=128&g=1", "display_name": "Granpasso", "link": "https://stackoverflow.com/users/4771221/granpasso"}, "edited": false, "score": 0, "creation_date": 1429131546, "post_id": 29660742, "comment_id": 47461016, "body": "Which instruments I need to do that? Because I&#39;m new in C programming and I just know loops, vectors, and some other little things."}, {"owner": {"reputation": 96, "user_id": 1663112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f467d53ca6ba6944c76551d44a98eaed?s=128&d=identicon&r=PG", "display_name": "UrsoBranco", "link": "https://stackoverflow.com/users/1663112/ursobranco"}, "reply_to_user": {"reputation": 15, "user_id": 4771221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P7TPp.jpg?s=128&g=1", "display_name": "Granpasso", "link": "https://stackoverflow.com/users/4771221/granpasso"}, "edited": false, "score": 0, "creation_date": 1429132128, "post_id": 29660742, "comment_id": 47461361, "body": "Granpasso, you&#39;ll need a library to draw it for you. You can give a try to  ncurses <a href=\"http://en.wikipedia.org/wiki/Ncurses\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Ncurses</a> . Cheers"}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1429132687, "post_id": 29660742, "comment_id": 47461683, "body": "Perhaps, <code>gotoxy</code> from <code>conio.h</code> also helps for that case. If so, leave <code>ncurses</code> for future :-)"}], "tags": [], "owner": {"reputation": 96, "user_id": 1663112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f467d53ca6ba6944c76551d44a98eaed?s=128&d=identicon&r=PG", "display_name": "UrsoBranco", "link": "https://stackoverflow.com/users/1663112/ursobranco"}, "is_accepted": true, "score": 0, "last_activity_date": 1429131342, "creation_date": 1429131342, "answer_id": 29660742, "question_id": 29660665, "link": "https://stackoverflow.com/questions/29660665/refreshing-console-value-without-systemcls/29660742#29660742", "title": "Refreshing console value without system(&quot;cls&quot;);", "body": "<p>You can clear just the last position where the snake were. </p>\n\n<p>I would just clear the last char at the end of the snake. This way the refreshing problem would cease, you have only to control the size of the snake and position (you will need anyway to do that).</p>\n\n<p>Cheers,</p>\n\n<p>LEslie</p>\n"}], "owner": {"reputation": 15, "user_id": 4771221, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P7TPp.jpg?s=128&g=1", "display_name": "Granpasso", "link": "https://stackoverflow.com/users/4771221/granpasso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 29660742, "answer_count": 1, "score": 0, "last_activity_date": 1429131342, "creation_date": 1429131087, "question_id": 29660665, "link": "https://stackoverflow.com/questions/29660665/refreshing-console-value-without-systemcls", "title": "Refreshing console value without system(&quot;cls&quot;);", "body": "<p>I'm trying to write Snake in C, but at the moment I've just written a variable length and width matrix. Since I want that the game (so the map) is continously refreshing I tried to write the code this way, but the \"refreshing effect\" is not so good to see. What can I do?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;conio.h&gt;\n#include &lt;windows.h&gt;\n#include &lt;time.h&gt;\n\nint main()\n{\n    int larghezza = 0, altezza = 0, i = 0, j = 0, **griglia;\n\n    printf(\"Inserire la larghezza della mappa(max 79):\");\n    while(scanf(\"%d\", &amp;larghezza) == 1) /* Inserimento larghezza */\n    {\n        if(larghezza &gt;= 15 &amp;&amp; larghezza &lt;= 79)\n        {\n            break;\n        }\n        else\n        {\n            printf(\"Numero di larghezza non valido.\\n\");\n            continue;\n        }\n    }\n\n    printf(\"Inserire l'altezza della matrice:\");\n    while(scanf(\"%d\", &amp;altezza) == 1) /* Inserimento altezza */\n    {\n        if(altezza &gt;= 15 &amp;&amp; altezza &lt;= 79)\n        {\n            break;\n        }\n        else\n        {\n            printf(\"Numero di altezza non valido.\\n\");\n            continue;\n        }\n    }\n\n    griglia = malloc(altezza * sizeof(int*));  /* griglia si estende solo in larghezza */\n    for(i = 0; i &lt; altezza; i++)\n    {\n        griglia[i] = malloc(larghezza * sizeof(int)); /* poi ogni elemento \"i\" di griglia */\n    }                                               /*avr\u00e0 una lunghezza pari ad \"altezza\" */\n\n    for(i = 0; i &lt; altezza; i++) /* Inizializza la matrice griglia */\n    {\n        for(j = 0; j &lt; larghezza; j++)\n        {\n            griglia[i][j]= 254;\n        }\n    }\n\n    while(1) /* refresh infinito mappa */\n    {\n        for(i = 0; i &lt; altezza; i++)\n        {\n            for(j = 0; j &lt; larghezza; j++)\n            {\n                printf(\"%c\", griglia[i][j]);\n            } /* end for colonne */\n            printf(\"\\n\");\n        } /*end for righe */\n        Sleep(100);\n        system(\"cls\");\n    }/* end while di refresh */\n</code></pre>\n"}, {"tags": ["c", "memory", "byte"], "comments": [{"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 1, "creation_date": 1429131118, "post_id": 29660618, "comment_id": 47460741, "body": "<b>seg</b>ment <b>of</b>fset if I had to take a wild guess."}, {"owner": {"reputation": 1459, "user_id": 669567, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VOmJA.jpg?s=128&g=1", "display_name": "holgac", "link": "https://stackoverflow.com/users/669567/holgac"}, "edited": false, "score": 0, "creation_date": 1429131168, "post_id": 29660618, "comment_id": 47460777, "body": "please provide how the macro is used. it seems to be doing a selective bitshifting, but we cannot guess if you don&#39;t tell which architecture or how it&#39;s used."}, {"owner": {"reputation": 2196, "user_id": 1763310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GnLKQ.jpg?s=128&g=1", "display_name": "DNT", "link": "https://stackoverflow.com/users/1763310/dnt"}, "edited": false, "score": 0, "creation_date": 1429131177, "post_id": 29660618, "comment_id": 47460782, "body": "Reminds me of segment, offset, DOS days :)"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429131410, "post_id": 29660618, "comment_id": 47460924, "body": "What are the CPU and the SO? ... I think that is the macro to evalutate the memory segment of an address in a Intel CPU real mode environment!"}, {"owner": {"reputation": 96, "user_id": 1663112, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f467d53ca6ba6944c76551d44a98eaed?s=128&d=identicon&r=PG", "display_name": "UrsoBranco", "link": "https://stackoverflow.com/users/1663112/ursobranco"}, "edited": false, "score": 0, "creation_date": 1429131840, "post_id": 29660618, "comment_id": 47461192, "body": "just a <b>raw guess</b> ... in embedded environments usually you have to align manually the data you put in memory.  So the macro  probably converts the linear memory address to the segments the phisical memory has thus the shifts and selections. As I said, it&#39;s a guess"}], "answers": [{"tags": [], "owner": {"reputation": 4791, "user_id": 3899471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04f65ff7602231a1a1653a7debf32e7f?s=128&d=identicon&r=PG&f=1", "display_name": "kvorobiev", "link": "https://stackoverflow.com/users/3899471/kvorobiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1429131209, "creation_date": 1429131209, "answer_id": 29660695, "question_id": 29660618, "link": "https://stackoverflow.com/questions/29660618/what-does-segofs-mean/29660695#29660695", "title": "What does segofs mean?", "body": "<p>This macro split linear address into segment and offset components. More info see <a href=\"http://en.wikipedia.org/wiki/Memory_segmentation\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 164, "user_id": 3132878, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/940efbfbd961b3586fd638d9dfc1e70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mat&#39;arang&#233;&#199;a", "link": "https://stackoverflow.com/users/3132878/matarang%c3%a9%c3%87a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429131263, "creation_date": 1429130927, "last_edit_date": 1429131263, "question_id": 29660618, "link": "https://stackoverflow.com/questions/29660618/what-does-segofs-mean", "title": "What does segofs mean?", "body": "<p>I'm working on a C code in a embedded environnement and i would like to understand this : </p>\n\n<pre><code>#define linear2segofs(addr) (((((unsigned long) (addr)) &amp; x00FFFF00UL) &lt;&lt; 8) +\\\n                               (((unsigned long) (addr)) &amp; 0x000000FFUL))\n</code></pre>\n\n<p>When I try it mathematically and it seem to move up bytes to upper parts of 32bit value. </p>\n\n<p>I would like to understand why and what is a segofs.</p>\n"}, {"tags": ["c", "windows", "memory-management", "porting"], "comments": [{"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1429130640, "post_id": 29660492, "comment_id": 47460497, "body": "not directly, WINAPI has it&#39;s own functions that are included via <code>windows.h</code> that do the same things, but those functions are POSIX only and are not available on windows. So the question as asked cannot be answered because there is no equivalent header."}, {"owner": {"reputation": 2045, "user_id": 4117075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oiYeG.jpg?s=128&g=1", "display_name": "Mekap", "link": "https://stackoverflow.com/users/4117075/mekap"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1429130882, "post_id": 29660492, "comment_id": 47460619, "body": "@Mgetz while i agree that natively it doesnt, the win32 library i linked in my response should do the trick."}, {"owner": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "reply_to_user": {"reputation": 2045, "user_id": 4117075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oiYeG.jpg?s=128&g=1", "display_name": "Mekap", "link": "https://stackoverflow.com/users/4117075/mekap"}, "edited": false, "score": 2, "creation_date": 1429130975, "post_id": 29660492, "comment_id": 47460665, "body": "@Mekap or they could just do it the native way with <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366890(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>VirtualAllocEx</code></a> and cousins"}, {"owner": {"reputation": 2045, "user_id": 4117075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oiYeG.jpg?s=128&g=1", "display_name": "Mekap", "link": "https://stackoverflow.com/users/4117075/mekap"}, "reply_to_user": {"reputation": 4654, "user_id": 332733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BR7yE.jpg?s=128&g=1", "display_name": "Mgetz", "link": "https://stackoverflow.com/users/332733/mgetz"}, "edited": false, "score": 0, "creation_date": 1429131082, "post_id": 29660492, "comment_id": 47460725, "body": "@Mgetz yeah of course, editing my response to fit that."}], "answers": [{"comments": [{"owner": {"reputation": 572, "user_id": 1506928, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3918be50c0b45f5318baa30b54d9fcf7?s=128&d=identicon&r=PG", "display_name": "youjustreadthis", "link": "https://stackoverflow.com/users/1506928/youjustreadthis"}, "edited": false, "score": 0, "creation_date": 1429165360, "post_id": 29660560, "comment_id": 47472318, "body": "Thank you very much for the answer, however the compiler is having trouble with the mlockall function. Can this be replaced by the <code>VirtualAllocEx</code> function or does that just allocate memory (a bit like malloc above, which seems to be working)? (I know I didn&#39;t specify this in the original question, which I probably should have done)."}], "tags": [], "owner": {"reputation": 2045, "user_id": 4117075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oiYeG.jpg?s=128&g=1", "display_name": "Mekap", "link": "https://stackoverflow.com/users/4117075/mekap"}, "is_accepted": true, "score": 6, "last_activity_date": 1594124072, "last_edit_date": 1594124072, "creation_date": 1429130723, "answer_id": 29660560, "question_id": 29660492, "link": "https://stackoverflow.com/questions/29660492/windows-equivalent-for-sys-mman-h/29660560#29660560", "title": "Windows Equivalent for sys/mman.h", "body": "<p>You should look at the <a href=\"https://code.google.com/p/mman-win32/\" rel=\"nofollow noreferrer\">mman-win32 library</a>. But as @Mgetz pointed out, a more simple way is to look at the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366890%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>VirtualAllocEx</code></a> functions and try to adapt your code.</p>\n"}], "owner": {"reputation": 572, "user_id": 1506928, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3918be50c0b45f5318baa30b54d9fcf7?s=128&d=identicon&r=PG", "display_name": "youjustreadthis", "link": "https://stackoverflow.com/users/1506928/youjustreadthis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11934, "favorite_count": 0, "accepted_answer_id": 29660560, "answer_count": 1, "score": 3, "last_activity_date": 1594124072, "creation_date": 1429130474, "last_edit_date": 1429165019, "question_id": 29660492, "link": "https://stackoverflow.com/questions/29660492/windows-equivalent-for-sys-mman-h", "title": "Windows Equivalent for sys/mman.h", "body": "<p>I'm encountering issues when trying to compile my C code on Win64. More specifically, the compiler cannot find the <code>sys/mman.h</code> header, which I understand is found in Unix environments only. </p>\n\n<p>I already know this is deals with memory allocation.</p>\n\n<p>Is there an equivalent for Windows I can use in order to port the code (first time trying)?</p>\n\n<p>Code in that causes issues:</p>\n\n<pre><code>/* Allocate memory required by processes */\nbuf = (int*) malloc (sizeof(int));\nif (!buf)\n{\n    perror(\"Error\");\n    free (buf);\n    return -3;\n}\n\n/* Lock down pages mapped to processes */\nputs(\"Locking down processes.\");\nif(mlockall (MCL_CURRENT | MCL_FUTURE) &lt; 0)\n{\n    perror(\"mlockall\");\n    free (buf);\n    return -4;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "string", "loops", "character"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1429130231, "post_id": 29660393, "comment_id": 47460267, "body": "And what is the problem with your code, id doesn&#39;t find the <code>a</code>&#39;s? and you don&#39;t need the <code>&#39;\\0&#39;</code> it&#39;s implied."}, {"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1429130395, "post_id": 29660393, "comment_id": 47460363, "body": "stackoverflow != do my home work for me. Please post your attempt and describe any specifc problems you encountered and someone may be able to help you."}, {"owner": {"reputation": 4446, "user_id": 696485, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4de94e14f977802057b0109d079d95a1?s=128&d=identicon&r=PG", "display_name": "Iskar Jarak", "link": "https://stackoverflow.com/users/696485/iskar-jarak"}, "edited": false, "score": 0, "creation_date": 1429131043, "post_id": 29660393, "comment_id": 47460703, "body": "Alvaro, get rid of the explicit nulls in your string literals - string literals have implicit nulls and thus &quot;abc\\0&quot; is FIVE characters long."}, {"owner": {"reputation": 39, "user_id": 3964369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000122073265/picture?type=large", "display_name": "Alvaro SpS&#39;s", "link": "https://stackoverflow.com/users/3964369/alvaro-spss"}, "edited": false, "score": 0, "creation_date": 1429137680, "post_id": 29660393, "comment_id": 47463896, "body": "just to let you know, i didn&#39;t ask to do my homework, just solve something a I couldn&#39;t"}], "answers": [{"comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1429130909, "post_id": 29660532, "comment_id": 47460632, "body": "Why provide the answer at all? That just encourages these kinds of questions."}, {"owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "reply_to_user": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 0, "creation_date": 1429130975, "post_id": 29660532, "comment_id": 47460666, "body": "The problem is fairly elementary, so I guess it won&#39;t hurt that much, although in principle you&#39;re right."}], "tags": [], "owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "is_accepted": false, "score": 0, "last_activity_date": 1429130603, "creation_date": 1429130603, "answer_id": 29660532, "question_id": 29660393, "link": "https://stackoverflow.com/questions/29660393/iterate-through-a-string-thats-on-an-array-in-c/29660532#29660532", "title": "Iterate through a string that&#39;s on an array in C", "body": "<pre><code>char input = '\\0';\nscanf(\"%c\", &amp;input);\nint i, j;\nfor(i=0; i&lt;4; i++)\n{\n    int count = 0;\n    for(j=0;j&lt;10;j++)\n    {\n         if(s[i][j] == input) count++;\n    }\n    printf(\"%s : %d\", s[i], count);\n}\n</code></pre>\n\n<p>although please note, that simply copying and pasting will not teach you anything.</p>\n"}, {"tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": false, "score": 0, "last_activity_date": 1429132384, "last_edit_date": 1429132384, "creation_date": 1429131764, "answer_id": 29660852, "question_id": 29660393, "link": "https://stackoverflow.com/questions/29660393/iterate-through-a-string-thats-on-an-array-in-c/29660852#29660852", "title": "Iterate through a string that&#39;s on an array in C", "body": "<p>Here is a demonstrative program that shows how you can deal with different declarations of arrays</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main(void) \n{\n    char* s[4][10] = { { \"abc\", \"aab\", \"cbb\" } };\n\n    for ( int i = 0; i &lt; 4; i++ )\n    {\n        for ( int j = 0; j &lt; 10; j++ )\n        {\n            if ( s[i][j] )\n            {\n                size_t count = 0;\n                for ( char *p = s[i][j]; *p != '\\0'; ++p )\n                {\n                    if ( *p == 'a' ) ++count;\n                }\n\n                printf( \"\\\"%s\\\": %zu\\n\", s[i][j], count );\n            }\n        }\n    }\n\n    printf( \"\\n\" );\n\n    char* t[4] = { \"abc\", \"aab\", \"cbb\" };\n\n    for ( char **p = t; *p != NULL; ++p )\n    {\n        size_t count = 0;\n\n        for ( char *q = *p; *q != '\\0'; ++q )\n        {\n            if ( *q == 'a' ) ++count;\n        }\n\n        printf( \"\\\"%s\\\": %zu\\n\", *p, count );\n    }\n\n\n    printf( \"\\n\" );\n\n    char u[4][10] = { \"abc\", \"aab\", \"cbb\" };\n\n    for ( int i = 0; i &lt; 4; i++ )\n    {\n        if ( u[i][0] != '\\0' )\n        {\n            size_t count = 0;\n            for ( char *p = u[i]; *p != '\\0'; ++p )\n            {\n                if ( *p == 'a' ) ++count;\n            }\n\n            printf( \"\\\"%s\\\": %zu\\n\", u[i], count );\n        }\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>The program output is</p>\n\n<pre><code>\"abc\": 1\n\"aab\": 2\n\"cbb\": 0\n\n\"abc\": 1\n\"aab\": 2\n\"cbb\": 0\n\n\"abc\": 1\n\"aab\": 2\n\"cbb\": 0\n</code></pre>\n\n<p>It seems that you mean either the second variant of the array declaration or the third variant of the array declaration. The first variant looks strange.:)</p>\n\n<p>Take into account that string literals already contain terminating zero. So there is no sense to write, for example</p>\n\n<pre><code>\"abc\\0\"\n</code></pre>\n\n<p>It is enough to write simply</p>\n\n<pre><code>\"abc\"\n</code></pre>\n\n<p>The <code>sizeof( \"abc\" )</code> is equal to 4 due to the presence of the terminating zero.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4735903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870c3cd3096f304513e2573fa7e63091?s=128&d=identicon&r=PG", "display_name": "Loic", "link": "https://stackoverflow.com/users/4735903/loic"}, "is_accepted": false, "score": 0, "last_activity_date": 1429133114, "creation_date": 1429133114, "answer_id": 29661220, "question_id": 29660393, "link": "https://stackoverflow.com/questions/29660393/iterate-through-a-string-thats-on-an-array-in-c/29661220#29661220", "title": "Iterate through a string that&#39;s on an array in C", "body": "<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    char s[10][4] = { \"abc\", \"aab\", \"cbb\" };\n    size_t i;\n    for (i = 0; i != sizeof(s) / sizeof(s[0]); i++) {\n        fprintf(stdout, \"%zu: %s\\n\", i, s[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#include &lt;stddef.h&gt;\n#include &lt;stdio.h&gt;\n\nint main(int argc, char *argv[]) {\n    char *s[4] = { \"abc\", \"aab\", \"cbb\" };\n    size_t i;\n    for (i = 0; i != 3; i++) {\n        fprintf(stdout, \"%zu: %s\\n\", i, s[i]);\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Note that the original declaration</p>\n\n<pre><code>char* s[4][10] = { \"abc\\0\", \"aab\\0\", \"cbb\\0\" };\n</code></pre>\n\n<p>had several errors:</p>\n\n<ul>\n<li><code>char *</code> instead of <code>char</code></li>\n<li><code>[4][10]</code> instead of <code>[10][4]</code></li>\n<li><code>\"abc\\0\"</code> instead of <code>\"abc\"</code> (the trailing <code>'\\0'</code> is implicit).</li>\n</ul>\n"}], "owner": {"reputation": 39, "user_id": 3964369, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000122073265/picture?type=large", "display_name": "Alvaro SpS&#39;s", "link": "https://stackoverflow.com/users/3964369/alvaro-spss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 3, "score": -4, "last_activity_date": 1429133114, "creation_date": 1429130156, "last_edit_date": 1429130198, "question_id": 29660393, "link": "https://stackoverflow.com/questions/29660393/iterate-through-a-string-thats-on-an-array-in-c", "title": "Iterate through a string that&#39;s on an array in C", "body": "<p>I have a code like this:</p>\n\n<pre><code>char* s[4][10] = { \"abc\\0\", \"aab\\0\", \"cbb\\0\" };\n</code></pre>\n\n<p>a want to type a character, like..  'a', and iterate through the array of strings, check on each string if there's 'a' on it, and then count how many there's on it..</p>\n\n<p>In this case, what I wanted to get is <code>\"abc\" : 1</code>, <code>\"aab\" : 2</code>, <code>\"cbb\" : 0</code> ...\nhow can I do the loops to get this result?</p>\n"}, {"tags": ["c", "gcc"], "comments": [{"owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "edited": false, "score": 1, "creation_date": 1429129746, "post_id": 29660164, "comment_id": 47460006, "body": "Tell us exactly what you are seeing."}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "edited": false, "score": 1, "creation_date": 1429129749, "post_id": 29660164, "comment_id": 47460012, "body": "@OneArb Could you say what is the difference and what do you expect to get?"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1429130262, "post_id": 29660304, "comment_id": 47460285, "body": "works as expected, I got fooled as it worked fine till I made skip_line_char static"}, {"owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "reply_to_user": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "edited": false, "score": 0, "creation_date": 1429130372, "post_id": 29660304, "comment_id": 47460352, "body": "@OneArb <code>&#39;\\0&#39;</code> is a null character, not a zero character (i.e.<code>&#39;0&#39;</code>). C strings cannot contain null characters. This is the character that gets added automatically to the end of your string when you use string literals."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1429148834, "post_id": 29660304, "comment_id": 47467227, "body": "Detail: &quot;C strings cannot contain null characters.&quot;  Maybe better said as &quot;C strings always contain just one null character - the last one.&quot;"}], "tags": [], "owner": {"reputation": 673100, "user_id": 335858, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/4af3541c00d591e9a518b9c0b3b1190a?s=128&d=identicon&r=PG", "display_name": "Sergey Kalinichenko", "link": "https://stackoverflow.com/users/335858/sergey-kalinichenko"}, "is_accepted": false, "score": 3, "last_activity_date": 1429130445, "last_edit_date": 1429130445, "creation_date": 1429129902, "answer_id": 29660304, "question_id": 29660164, "link": "https://stackoverflow.com/questions/29660164/undefined-behaviour-mixing-static-and-dynamic-variables-within-the-same-expressi/29660304#29660304", "title": "Undefined behaviour mixing static and dynamic variables within the same expression", "body": "<p>The problem is that <code>strchr</code> expects null-terminated strings, but you are passing it a character array that does not have null termination.</p>\n\n<p>Adding <code>'\\0'</code> at the end will make both arrays behave the same way:</p>\n\n<pre><code>static char static_skip_line_char[]={'#','\\n','\\r','\\0'};\nchar skip_line_char[]={'#','\\n','\\r','\\0'};\n</code></pre>\n\n<p>or use string literal initialization, which adds null termination automatically:</p>\n\n<pre><code>static char static_skip_line_char[]=\"#\\n\\r\";\nchar skip_line_char[]=\"#\\n\\r\";\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1793, "user_id": 1507678, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NNC8T.jpg?s=128&g=1", "display_name": "noz", "link": "https://stackoverflow.com/users/1507678/noz"}, "is_accepted": true, "score": 1, "last_activity_date": 1429129975, "creation_date": 1429129975, "answer_id": 29660330, "question_id": 29660164, "link": "https://stackoverflow.com/questions/29660164/undefined-behaviour-mixing-static-and-dynamic-variables-within-the-same-expressi/29660330#29660330", "title": "Undefined behaviour mixing static and dynamic variables within the same expression", "body": "<p>You will get unpredictable results for this and possibly even a crash on some platforms.</p>\n\n<p>strchr operates on null terminated arrays of characters (C strings) - because you haven't put a null terminator character in static_skip_line_char or skip_line_char they are unterminated and will possibly contain junk on the end as far as strchr is concerned.</p>\n\n<p>For statics it is likely that the next memory element is zero which would happen to terminate it (because the static area is zero'ed by default).</p>\n\n<p>To fix it you would need the following:</p>\n\n<pre><code>static char static_skip_line_char[]={'#','\\n','\\r','\\0'};\nchar skip_line_char[]={'#','\\n','\\r','\\0'};\n</code></pre>\n\n<p>Or more simply:</p>\n\n<pre><code>static char *static_skip_line_char=\"#\\n\\r\";\nchar *skip_line_char=\"#\\n\\r\";\n</code></pre>\n"}], "owner": {"reputation": 427, "user_id": 3654625, "user_type": "registered", "accept_rate": 22, "profile_image": "https://i.stack.imgur.com/5VTlc.jpg?s=128&g=1", "display_name": "OneArb", "link": "https://stackoverflow.com/users/3654625/onearb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 29660330, "answer_count": 2, "score": 0, "last_activity_date": 1486699973, "creation_date": 1429129390, "last_edit_date": 1486699973, "question_id": 29660164, "link": "https://stackoverflow.com/questions/29660164/undefined-behaviour-mixing-static-and-dynamic-variables-within-the-same-expressi", "title": "Undefined behaviour mixing static and dynamic variables within the same expression", "body": "<p>The same expression evaluates differently when declaring a char array as static vs dynamic.</p>\n\n<p>Can anyone explain why ?</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n#define LINESIZE 12\n\n#define SKIP        !strchr(       skip_line_char ,line[0])\n#define SKIP_STATIC !strchr(static_skip_line_char ,line[0])\n#define TAB         !strchr(line ,'\\t')\n\nint main() {\n\n//static char line[LINESIZE]={'a','\\n','\\r'};\nchar line[LINESIZE]={'a','\\n','\\r'};\n\nstatic char static_skip_line_char[]={'#','\\n','\\r'};\nchar skip_line_char[]={'#','\\n','\\r'};\n\n    if (SKIP_STATIC &amp;&amp; TAB)\n        printf(\"\\nstatic\");\n\n    if (SKIP &amp;&amp; TAB) \n        printf(\"\\ndynamic\");\n\n    return 0;\n}\n</code></pre>\n\n<p>For line declared static the code returns \"static\"</p>\n\n<p>For line declared dynamic the code returns</p>\n\n<p>\"static\"\n\"dynamic\"</p>\n\n<p>The later being the correct answer as line[0] =='a'</p>\n"}, {"tags": ["c", "pointers", "struct", "bubble-sort"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1429129742, "post_id": 29660136, "comment_id": 47460004, "body": "try <code>cars *temp = (x+j+1);</code> change to <code>cars temp = x[j+1];</code>..<code>x[j] = temp;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1429129903, "post_id": 29660136, "comment_id": 47460079, "body": "also <code>if ( (x+i)-&gt;hp &gt; (x+j+1)-&gt;hp ) {</code> --&gt; <code>if ( (x+j)-&gt;hp &gt; (x+j+1)-&gt;hp ) {</code>"}, {"owner": {"reputation": 2157, "user_id": 3865653, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Fv3Fj.jpg?s=128&g=1", "display_name": "Deanie", "link": "https://stackoverflow.com/users/3865653/deanie"}, "edited": false, "score": 0, "creation_date": 1508541174, "post_id": 29660136, "comment_id": 80664545, "body": "There&#39;s never a need to type cast the return of malloc.  That&#39;s a c++ thing.  Just use <code>cars *pointer = malloc(12*sizeof(cars));</code>"}], "answers": [{"comments": [{"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 1, "creation_date": 1429131855, "post_id": 29660499, "comment_id": 47461204, "body": "You&#39;re not dereferencing <code>(x+j)</code>, and are assigning a pointer-to-struct to a a struct."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "reply_to_user": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1429132918, "post_id": 29660499, "comment_id": 47461805, "body": "... Today I&#39;m drunk ... :) Now all should be correct!"}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 2, "creation_date": 1429134291, "post_id": 29660499, "comment_id": 47462554, "body": "This is not the usual bubble sort algorithm which operates on &quot;pair[s] of adjacent items&quot;. It&#39;s more similar to selection sort with a lot of useless swaps."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "reply_to_user": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1429135987, "post_id": 29660499, "comment_id": 47463257, "body": "@undur_gongor, I executed a little test on the two sort methods (mine and DogBert)! The result is the same, but mine swaps less! ... :) I added the test in the code above because it doesn&#39;t fits inside a comment"}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 1, "creation_date": 1429136449, "post_id": 29660499, "comment_id": 47463456, "body": "Maybe. Still it&#39;s not bubble sort. If performance is important, both bubble sort and selection sort are out."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 1, "creation_date": 1429136695, "post_id": 29660499, "comment_id": 47463541, "body": "I use always qsort that is in the libraries!!! But mine is an optimization of bubble-sort!"}], "tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1429136222, "last_edit_date": 1429136222, "creation_date": 1429130487, "answer_id": 29660499, "question_id": 29660136, "link": "https://stackoverflow.com/questions/29660136/bubble-sort-of-structures-using-pointers-in-c/29660499#29660499", "title": "Bubble sort of structures using pointers in C", "body": "<pre><code>void bubbleSort(cars *x, int size)\n{\n        int i, j;\n        cars temp;\n\n        for (i=0;i&lt;size-1;i++) {\n            for (j = i+1; j &lt; size; j++) {\n                if ( (x+i)-&gt;hp &gt; (x+j)-&gt;hp ) {\n                    temp = x[j];\n                    x[j] = x[i];\n                    x[i] = temp;\n                }\n            }\n        }\n}\n</code></pre>\n\n<p>This is a reply to a comment under this code; it demonstrates that the sort that I suggest swaps less ... :) Here the code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\ntypedef struct {\n    int x;\n    int hp;\n} cars;\n\nint swaps;\n\nvoid bubbleSortB(cars *x, int size)\n{\n        int i, j;\n        cars temp;\n\n        for (i=0;i&lt;size-1;i++) {\n            for (j = i+1; j &lt; size; j++) {\n                if ( (x+i)-&gt;hp &gt; (x+j)-&gt;hp ) {\n                    temp = x[j];\n                    x[j] = x[i];\n                    x[i] = temp;\n                    swaps++;\n                }\n            }\n        }\n}\n\nvoid bubbleSortA(cars *x, int size)\n{\n    int i, j;\n    for (i = 0; i &lt; size-1; i++)\n    {\n        for (j = 0; j &lt; size-1-i; j++)\n        {\n            if ( x[j].hp &gt; x[j+1].hp )\n            {\n               cars temp = x[j+1];\n               x[j+1] = x[j];\n               x[j] = temp;\n               swaps++;\n            }\n        }\n    }\n}\n\nint main(void)\n{\n    int i;\n\n    cars x[10]={ {1,4},{1,8},{1,12},{1,6},{1,5},{1,4},{1,8},{1,12},{1,6},{1,5} };\n    cars y[10]={ {1,4},{1,8},{1,12},{1,6},{1,5},{1,4},{1,8},{1,12},{1,6},{1,5} };\n\n    swaps=0;\n    bubbleSortA(x,10);\n    for(i=0;i&lt;10;i++)\n        printf(\"%d \",x[i].hp);\n    printf(\"- swaps %d\\n\",swaps);\n\n    swaps=0;\n    bubbleSortB(y,10);  //My sort\n    for(i=0;i&lt;10;i++)\n        printf(\"%d \",y[i].hp);\n    printf(\"- swaps %d\\n\",swaps);\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429132751, "post_id": 29660511, "comment_id": 47461717, "body": "Now, after the correction you indicates me, also the mine is a correct solution, a little bit different!"}, {"owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "edited": false, "score": 0, "creation_date": 1429133145, "post_id": 29660511, "comment_id": 47461946, "body": "Your solution will be different, if you not just copy examples. And of course, there are infinite number of different solutions to the same problem\u044e Good luck!"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429133527, "post_id": 29660511, "comment_id": 47462156, "body": "@VolAnd, this may be considered standard coding! I don&#39;t think Dogbert it saying to be discovered nothing and if you refers to me see at the time of the reply and note that I wrote the reply before Dogbert, but with some errors that I&#39;ve corrected!"}], "tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": true, "score": 6, "last_activity_date": 1429131951, "last_edit_date": 1429131951, "creation_date": 1429130546, "answer_id": 29660511, "question_id": 29660136, "link": "https://stackoverflow.com/questions/29660136/bubble-sort-of-structures-using-pointers-in-c/29660511#29660511", "title": "Bubble sort of structures using pointers in C", "body": "<p>Consider the following solution for sorting function:</p>\n\n\n\n<pre><code>void bubbleSort(cars *x, int size) \n{\n    int i, j;\n    for (i = 0; i &lt; size-1; i++) \n    {\n        for (j = 0; j &lt; size-1-i; j++) \n        {\n            if ( x[j].hp &gt; x[j+1].hp ) \n            {\n               cars temp = x[j+1];\n               x[j+1] = x[j];\n               x[j] = temp;\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The problem was in the data swap part</p>\n"}, {"comments": [{"owner": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1429131795, "post_id": 29660807, "comment_id": 47461163, "body": "No no no. If the values are the same, you zero out the data. It&#39;s not a good trick to use. Also, it won&#39;t work like you think it will with structs. <a href=\"http://programmers.stackexchange.com/questions/182037/is-this-xor-value-swap-algorithm-still-in-use-or-useful\" title=\"is this xor value swap algorithm still in use or useful\">programmers.stackexchange.com/questions/182037/&hellip;</a>"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 1, "creation_date": 1429131866, "post_id": 29660807, "comment_id": 47461208, "body": "The value to swap is not an integer, but a structure! :)"}, {"owner": {"reputation": 1743, "user_id": 1884140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z8kyn.jpg?s=128&g=1", "display_name": "1.618", "link": "https://stackoverflow.com/users/1884140/1-618"}, "reply_to_user": {"reputation": 17102, "user_id": 1022889, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WZOSZ.jpg?s=128&g=1", "display_name": "Cloud", "link": "https://stackoverflow.com/users/1022889/cloud"}, "edited": false, "score": 0, "creation_date": 1429132419, "post_id": 29660807, "comment_id": 47461546, "body": "@Dogbert for sorting, why would the values be swapped if they were the same?  This seems like dogma, but I&#39;ll edit the answer anyway..."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429132557, "post_id": 29660807, "comment_id": 47461617, "body": "This solution runs only with integer types such as char, int, long, but not with STRUCTURES!!!"}, {"owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1429133439, "post_id": 29660807, "comment_id": 47462112, "body": "Why use <code>malloc</code> (which might fail) if you can just create the <code>TYPE</code> variable directly (without pointer indirection)?"}, {"owner": {"reputation": 1743, "user_id": 1884140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z8kyn.jpg?s=128&g=1", "display_name": "1.618", "link": "https://stackoverflow.com/users/1884140/1-618"}, "reply_to_user": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "edited": false, "score": 0, "creation_date": 1429133716, "post_id": 29660807, "comment_id": 47462264, "body": "@undur_gongor hmm... I guess that would be better, since there&#39;s just one temp variable.  I&#39;ll add in an alternate version of the function."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429133722, "post_id": 29660807, "comment_id": 47462267, "body": "You have changed the code! I&#39;m saying you that you can&#39;t make XOR between two structures!"}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429133876, "post_id": 29660807, "comment_id": 47462350, "body": "your new solution doesn&#39;t apport advantages and use an useless malloc, where the in-line swap is the better and fastest solution!"}, {"owner": {"reputation": 1743, "user_id": 1884140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z8kyn.jpg?s=128&g=1", "display_name": "1.618", "link": "https://stackoverflow.com/users/1884140/1-618"}, "edited": false, "score": 1, "creation_date": 1429134154, "post_id": 29660807, "comment_id": 47462490, "body": "Maybe so, but using a separate function makes it more readable!  That is just my personal preference, though!"}], "tags": [], "owner": {"reputation": 1743, "user_id": 1884140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/z8kyn.jpg?s=128&g=1", "display_name": "1.618", "link": "https://stackoverflow.com/users/1884140/1-618"}, "is_accepted": false, "score": -1, "last_activity_date": 1429133775, "last_edit_date": 1429133775, "creation_date": 1429131577, "answer_id": 29660807, "question_id": 29660136, "link": "https://stackoverflow.com/questions/29660136/bubble-sort-of-structures-using-pointers-in-c/29660807#29660807", "title": "Bubble sort of structures using pointers in C", "body": "<p>Use a swap function like this:</p>\n\n<pre><code>#define TYPE &lt;your type&gt;\nvoid swap(TYPE *a, TYPE *b){\n        TYPE *temp = (TYPE*)malloc(sizeof(TYPE));\n        *temp = *a;\n        *a = *b;\n        *b = *temp;\n        free(temp);\n}\n</code></pre>\n\n<p>Or this one, without malloc:</p>\n\n<pre><code>void swap(TYPE *a, TYPE *b){\n        TYPE temp;\n        temp = *a;\n        *a = *b;\n        *b = temp;\n}\n</code></pre>\n"}], "owner": {"reputation": 2602, "user_id": 3565829, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/88236592cc604cf1becc585717ca8c6b?s=128&d=identicon&r=PG&f=1", "display_name": "yerassyl", "link": "https://stackoverflow.com/users/3565829/yerassyl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6226, "favorite_count": 2, "accepted_answer_id": 29660511, "answer_count": 3, "score": 6, "last_activity_date": 1499165860, "creation_date": 1429129323, "last_edit_date": 1499165860, "question_id": 29660136, "link": "https://stackoverflow.com/questions/29660136/bubble-sort-of-structures-using-pointers-in-c", "title": "Bubble sort of structures using pointers in C", "body": "<p>I want to sort an array of structures using the bubble sort algorithm and pointers in C. \nI have a cars structure:</p>\n\n<pre><code>typedef struct{\n    char model[30];\n    int hp;\n    int price;\n}cars;\n</code></pre>\n\n<p>and I allocate memory for 12 items:</p>\n\n<pre><code>cars *pointer = (cars*)malloc(12*sizeof(cars));\n</code></pre>\n\n<p>and read data from file:</p>\n\n<pre><code>for (i = 0; i &lt;number ; i++) {\n    fscanf(file, \"%s %i %i\\n\", (pointer+i)-&gt;model, &amp;(pointer+i)-&gt;hp, &amp;(pointer+i)-&gt;price);\n}\n</code></pre>\n\n<p>I pass pointer <code>ptr</code> to <code>bubbleSort</code> function:</p>\n\n<pre><code>bubbleSort(pointer, number);\n</code></pre>\n\n<p>Here is my <code>bubbleSort</code> function:</p>\n\n<pre><code>void bubbleSort(cars *x, int size) {\n    int i, j;\n    for (i=0;i&lt;size-1;i++) {\n    int swapped = 0;\n    for (j = 0; j &lt; size - 1 - i; j++) {\n        if ( (x+i)-&gt;hp &gt; (x+j+1)-&gt;hp ) {\n            cars *temp = (x+j+1);\n            x[j+1] = x[j];\n            x[j] = *temp;\n            swapped = 1;\n        }\n    }\n        if (!swapped) {\n        //return;\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is that I don't know how to swap items using pointers.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1429128505, "post_id": 29659776, "comment_id": 47459274, "body": "Your code compiles correctly except for this <code>scanf(&quot;%.2lf&quot;, &amp;threshold);</code>, <code>scanf()</code> does not allow <code>&#39;.&#39;</code> in the format specifier, and specifying 2 will only read to characters, not what you think, you can&#39;t read a number with two decimals unless it&#39;s a string, and if it&#39;s a double that doesn&#39;t make much sense anyway. Also, your <code>main()</code> doesn&#39;t return anything, but nothing else is wrong with your code."}, {"owner": {"reputation": 297, "user_id": 3851607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e52876c2ac4e155286abb574154c008?s=128&d=identicon&r=PG&f=1", "display_name": "AJAY", "link": "https://stackoverflow.com/users/3851607/ajay"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429128685, "post_id": 29659776, "comment_id": 47459380, "body": "i changed <code>main()</code> return type from <code>int</code> to <code>void</code>. still the error persists."}, {"owner": {"reputation": 297, "user_id": 3851607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e52876c2ac4e155286abb574154c008?s=128&d=identicon&r=PG&f=1", "display_name": "AJAY", "link": "https://stackoverflow.com/users/3851607/ajay"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429128854, "post_id": 29659776, "comment_id": 47459464, "body": "i tried compiling this code on ideone online compiler and its compiling. but in tc its giving the declaration terminated incorrectly error?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 2, "creation_date": 1429129017, "post_id": 29659776, "comment_id": 47459574, "body": "why would you do that? it doesn&#39;t make any sense at all... <code>main()</code> has to return <code>int</code> you just had to make <code>main()</code> return a value, your compiler has to be broken, and you must post the exact error in the question otherwise there is no chance to help you."}, {"owner": {"reputation": 621, "user_id": 411339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2351e75c187c6fcb8dee93e62a9180a3?s=128&d=identicon&r=PG", "display_name": "Unavailable", "link": "https://stackoverflow.com/users/411339/unavailable"}, "edited": false, "score": 0, "creation_date": 1429129262, "post_id": 29659776, "comment_id": 47459718, "body": "Why don&#39;t you try to declare min function prototype first like for the others you did then implement it and compile again? Your code looks ok without doing this but maybe the compiler you are using now has a syntax issue about it. Give it a shot."}, {"owner": {"reputation": 297, "user_id": 3851607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e52876c2ac4e155286abb574154c008?s=128&d=identicon&r=PG&f=1", "display_name": "AJAY", "link": "https://stackoverflow.com/users/3851607/ajay"}, "edited": false, "score": 0, "creation_date": 1429129496, "post_id": 29659776, "comment_id": 47459846, "body": "okay. thanks for the help. I changed the name of min to min1. and replaced all min to min1. now its functioning properly. maybe an issue with library function."}, {"owner": {"reputation": 621, "user_id": 411339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2351e75c187c6fcb8dee93e62a9180a3?s=128&d=identicon&r=PG", "display_name": "Unavailable", "link": "https://stackoverflow.com/users/411339/unavailable"}, "edited": false, "score": 0, "creation_date": 1429130718, "post_id": 29659776, "comment_id": 47460538, "body": "Yes, it looks min function prototype had been defined before in library and you were getting that error because of this."}], "answers": [{"tags": [], "owner": {"reputation": 767708, "user_id": 14860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/vXG1F.png?s=128&g=1", "display_name": "paxdiablo", "link": "https://stackoverflow.com/users/14860/paxdiablo"}, "is_accepted": false, "score": 4, "last_activity_date": 1429166209, "creation_date": 1429166209, "answer_id": 29667044, "question_id": 29659776, "link": "https://stackoverflow.com/questions/29659776/declaration-terminated-incorrectly-in-c/29667044#29667044", "title": "declaration terminated incorrectly in c", "body": "<p>If you're compiling under Windows, you should be aware the <code>windef.h</code> (included by <code>windows.h</code>) defines <code>min</code> and <code>max</code> as macros. You can prevent this by defining <code>NOMINMAX</code> before including those files, such as with:</p>\n\n<pre><code>#define NOMINMAX\n</code></pre>\n\n<p>Or you can simply use a different function name other than <code>min</code>.</p>\n\n<p>If you're <em>not</em> on Windows, it may still be that <code>min</code> is being defined somewhere in which case you should get the preprocessor output to see where, such as with <code>gcc -E ...</code>.</p>\n"}], "owner": {"reputation": 297, "user_id": 3851607, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e52876c2ac4e155286abb574154c008?s=128&d=identicon&r=PG&f=1", "display_name": "AJAY", "link": "https://stackoverflow.com/users/3851607/ajay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1429166341, "creation_date": 1429128134, "last_edit_date": 1429166341, "question_id": 29659776, "link": "https://stackoverflow.com/questions/29659776/declaration-terminated-incorrectly-in-c", "title": "declaration terminated incorrectly in c", "body": "<p>I have written this code, but I am getting \"declaration terminated incorrectly\" error at line </p>\n\n<pre><code>int min(int a, int b){..}\n</code></pre>\n\n<p>The following is the code I have written</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;ctype.h&gt;\n#include &lt;math.h&gt;\n#include &lt;string.h&gt;\n\n\n#define SIZE 10\n#define WORD_SIZE 50\n#define LIST_SIZE 500\n\ntypedef struct node\n{\n    char word[WORD_SIZE];\n    int frequency[SIZE];\n}node;\nint no_of_words;\n\nint filewords[SIZE];\nint cluster[SIZE][SIZE];\n\nvoid process(FILE *, node[], int);\nvoid display(node[], int);\nvoid generate_sim_mat(node [], double [][SIZE], int);\nint build_cluster(double [][SIZE], int );\nvoid disp(int);\n\nint min(int a, int b)\n{\n    return a &lt; b ? a : b;\n}\n\nint main()\n{\n    node word_list[LIST_SIZE];\n    int num_files;\n    int i;\n    int cluster_count;\n    FILE *fp;\n    char filename[WORD_SIZE];\n    double sim_mat[SIZE][SIZE];\n\n    printf(\"Enter number of files:\");\n    scanf(\"%d\", &amp;num_files);\n\n    for(i = 0; i &lt; num_files; i++)\n    {\n        scanf(\"%s\", filename);\n\n        fp = fopen(filename, \"r\");\n        if(!fp)\n        {\n            printf(\"Could not open file:%s\\n\", filename);\n            continue;\n        }\n        printf(\"File %s opened, Now processing it\\n\", filename);\n\n        process(fp, word_list, i);\n        fclose(fp);\n    }\ndisplay(word_list, num_files);\ngenerate_sim_mat(word_list, sim_mat, num_files);\ncluster_count = build_cluster(sim_mat, num_files);\ndisp(cluster_count);\n}\n\nvoid disp(int cc)\n{\n    int i, j;\n    for(i = 0; i &lt; cc; i++)\n    {\n        printf(\"%d---\", i);\n        for(j = 1; j &lt;= cluster[i][0]; j++)\n            printf(\"%d \", cluster[i][j]);\n        printf(\"\\n\");\n    }\n}\n\nvoid display(node word_list[], int fnos)\n{\n    int i, j;\n    for(i = 0; i &lt; no_of_words; i++)\n    {\n        printf(\"%s\\t\", word_list[i].word);\n        for(j = 0; j &lt; fnos; j++)\n            printf(\"%d \", word_list[i].frequency[j]);\n        printf(\"\\n\");\n    }\n}\n\nvoid process(FILE *fp, node word_list[], int fno)\n{\n    char word[WORD_SIZE], ch;\n    int i, j, k, word_count = 0;\n    while((ch = getc(fp)) != EOF)\n    {\n        k = 0;\n        while(isalpha(ch))\n        {\n            word[k++] = tolower(ch);\n            ch = getc(fp);\n        }\n        if(k &gt; 0)\n        {\n            word_count++;\n            word[k] = '\\0';\n            for(i = 0; i &lt; no_of_words; i++)\n                if(strcmp(word_list[i].word, word) == 0)\n                {\n                    word_list[i].frequency[fno]++;\n                    break;\n                }\n            if(i == no_of_words)\n            {\n                strcpy(word_list[i].word, word);\n                for(j = 0; j &lt; SIZE; j++)\n                    word_list[i].frequency[j] = 0;\n                word_list[i].frequency[fno] = 1;\n                no_of_words++;\n            }\n        }\n    }\n    filewords[fno] = word_count;\n}\n\nvoid generate_sim_mat(node word_list[], double sim_mat[][SIZE], int fno)\n{\n    int i, j, k;\n    int sum;\n    for(i = 0; i &lt; fno; i++)\n    {\n        for(j = 0; j &lt; fno; j++)\n        {\n            sum = 0;\n            for(k = 0; k &lt; no_of_words; k++)\n                sum += min(word_list[k].frequency[i], word_list[k].frequency[j]);\n\n            sim_mat[i][j] = sum/(sqrt(filewords[i]) * sqrt(filewords[j]));            \n            printf(\"%.2lf \", sim_mat[i][j]);\n        }\n        printf(\"\\n\");\n    }\n}\n\nint build_cluster(double sim_mat[][SIZE], int fno)\n{\n    int cluster_count = 1;\n    double threshold, sum, res;\n    int i, j, k, l, flag;\n    printf(\"Enter threshold value:\");\n    scanf(\"%.2lf\", &amp;threshold);\n\n    cluster[0][0] = 1;\n    cluster[0][1] = 0;\n\n    for(i = 1; i &lt; fno; i++)\n    {\n        flag = 0;\n        for(j = 0; j &lt; cluster_count; j++)\n        {\n            sum = 0;\n            for(k = 1; k &lt;= cluster[j][0]; k++)\n                sum += sim_mat[cluster[j][k]][i];\n            res = sum / cluster[j][0];\n            if(res &gt;= threshold)\n            {\n                flag = 1;\n                l = ++cluster[j][0];\n                cluster[j][l] = i;\n            }\n        }\n        if(!flag)\n        {\n            cluster[j][0] = 1;\n            cluster[j][1] = i;\n            cluster_count++;\n        }\n    }\n    return cluster_count;\n}\n</code></pre>\n\n<p>I am not able to debug this problem. Can someone tell me where the error is?</p>\n"}, {"tags": ["c", "unicode", "lex"], "comments": [{"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128181, "post_id": 29659671, "comment_id": 47459085, "body": "I had this problem a long time ago.  Have no code for you - but try this: <a href=\"http://www.w3.org/2005/03/23-lex-U\" rel=\"nofollow noreferrer\">w3.org/2005/03/23-lex-U</a>"}, {"owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128365, "post_id": 29659671, "comment_id": 47459183, "body": "So will this help me out even if I&#39;m not using this Flex/Lex thing?"}, {"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128444, "post_id": 29659671, "comment_id": 47459243, "body": "I read it a while back and found it helpful.  I did not get that you were rewriting lex completely.  My bad."}, {"owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128632, "post_id": 29659671, "comment_id": 47459347, "body": "Re-writing Lex completely? Sorry I&#39;m kind of confused, do you mean writing a lexer by hand?"}, {"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128949, "post_id": 29659671, "comment_id": 47459524, "body": "It is me that is confused. If you completely wrote a functioning lexer, then I would guess you are trying to rewrite lex for flex or whatever.  Try getting the PCRE source code  - it supports UTF8 - so you can learn how Perl supports UTF8.  My assumption: you are using &lt;regex.h&gt; routines."}, {"owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429129046, "post_id": 29659671, "comment_id": 47459593, "body": "@jimmcnamara Ahh, I&#39;m afraid I&#39;m not using any regular expressions :("}, {"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429129735, "post_id": 29659671, "comment_id": 47459994, "body": "Then, whoa, writing a lexer is much harder.  For support for doing string operations on UTF text use the fontconfig library source is here:  <a href=\"http://www.freedesktop.org/software/fontconfig/release/\" rel=\"nofollow noreferrer\">freedesktop.org/software/fontconfig/release</a>"}, {"owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429130091, "post_id": 29659671, "comment_id": 47460182, "body": "Aww, that&#39;s no fun. I&#39;m looking around on GitHub, and found <a href=\"https://github.com/haipome/utf8\" rel=\"nofollow noreferrer\">this</a>. Looks a lot smaller and simpler to use, I could try and re-write something like this?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 1, "creation_date": 1429131105, "post_id": 29659671, "comment_id": 47460735, "body": "Although writing a lexer from scratch <i>for a specific language</i> is often harder than generating one via <code>lex</code> or a similar tool, it&#39;s not necessarily all that hard.  Certainly not approaching as hard as writing a lexer <i>generator</i> such as <code>lex</code> itself."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429131325, "post_id": 29659671, "comment_id": 47460874, "body": "As for which encodings you should support, that&#39;s a question of what you want to be able to parse.  If you already support ASCII, then extending your existing code to cover UTF-8 will probably not be too hard.  It would be worth considering handling other encodings by first converting to UTF-8 (perhaps on the fly) and then parsing the UTF-8."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429131468, "post_id": 29659671, "comment_id": 47460961, "body": "Note that questions requesting recommendations for third-party libraries are out of scope on SO.  Nevertheless, it might be worth your while to check out <a href=\"http://site.icu-project.org/\" rel=\"nofollow noreferrer\">ICU</a>."}, {"owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429132141, "post_id": 29659671, "comment_id": 47461365, "body": "@JohnBollinger Hmm, the lexer already lexes my entire language, and it works by consuming each character in a character stream and recognizing tokens (so you&#39;re typical lexer, just a huge state machine). Do you think that the Github repository I linked in the comment above is a useful resource. Not to use, but to attempt to re-write or adapt into my Lexer?"}], "answers": [{"tags": [], "owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "is_accepted": false, "score": 2, "last_activity_date": 1429953579, "creation_date": 1429953579, "answer_id": 29863314, "question_id": 29659671, "link": "https://stackoverflow.com/questions/29659671/how-do-i-lex-unicode-characters-in-c/29863314#29863314", "title": "How do I lex unicode characters in C?", "body": "<p>There are already version of lex (and other lexer tools that support UniCode) and they are tabulated on the  WikiPedia Page: <a href=\"http://en.wikipedia.org/wiki/Lexical_analysis#List_of_lexer_generators\" rel=\"nofollow\">List of Lexer Generators</a>. There is also a list of lexer tools on the <a href=\"http://en.wikipedia.org/wiki/Comparison_of_parser_generators\" rel=\"nofollow\">Wikipedia Parser Page</a>. In summary, the following tools handle UniCode:</p>\n\n<blockquote>\n  <ul>\n  <li><a href=\"http://en.wikipedia.org/wiki/JavaCC\" rel=\"nofollow\">JavaCC</a> - JavaCC generates lexical analyzers written in Java.</li>\n  <li><a href=\"http://en.wikipedia.org/wiki/JFLex\" rel=\"nofollow\">JFLex</a> - A lexical analyzer generator for Java.</li>\n  <li><a href=\"http://en.wikipedia.org/wiki/Quex\" rel=\"nofollow\">Quex</a> - A fast universal lexical analyzer generator for C and C++.</li>\n  <li><a href=\"https://github.com/fsprojects/FsLexYacc\" rel=\"nofollow\">FsLex</a> - A lexer generator for byte and Unicode character input for F#</li>\n  </ul>\n</blockquote>\n\n<p>And, of course, there are the techniques used by W3.org and cited by @jim mcnamara at <a href=\"http://www.w3.org/2005/03/23-lex-U\" rel=\"nofollow\">http://www.w3.org/2005/03/23-lex-U</a>.</p>\n\n<p>You say you have written your own lexer in <strong>C</strong>, but you have used the tag <code>lex</code> for the tool called <code>lex</code>; perhaps that was an oversight?</p>\n\n<p>In the comments you say you have not used regular expressions, but also want to learn. Learning something about the theory of language recognition is key to writing an efficient and working lexer. The symbols being recognised are classified as a <a href=\"http://en.wikipedia.org/wiki/Chomsky_hierarchy\" rel=\"nofollow\"><em>Chomsky Type 3 Language</em></a>, or a <a href=\"http://en.wikipedia.org/wiki/Regular_language\" rel=\"nofollow\"><em>Regular Language</em></a>, which can be described by <a href=\"http://en.wikipedia.org/wiki/Regular_expression\" rel=\"nofollow\"><em>Regular Expressions</em></a>. Regular Expressions can be implemented by coding that implements a <em>Finite State Automata</em> (or <a href=\"http://en.wikipedia.org/wiki/Finite-state_machine\" rel=\"nofollow\"><em>Finite State Machine</em></a>). <a href=\"http://en.wikipedia.org/wiki/Automata-based_programming\" rel=\"nofollow\">The standard implementation for a finite state machine is coded by a loop containing a switch</a>. Most experienced coders should know, and be able to recognise and exploit this form:</p>\n\n<pre><code>while ( not &lt;&lt;EOF&gt;&gt; ) {\n  switch ( input_symbol ) {\n    case ( state_symbol[0] ) :\n         ...\n    case ( state_symbol[1] ) :\n\n        ...\n    default:\n        ....\n   }\n}\n</code></pre>\n\n<p>If you had coded in this style, the same coding could simply work whether the symbols being handled were 8 bit or 16 bit, as the algorithmic coding pattern remains the same.</p>\n\n<p>Ad-Hoc coding of a lexical analyser without an understanding of the underlying theory and practice will eventually have its limits. I think you will find it beneficial to read a little more into this area.</p>\n"}], "owner": {"reputation": 1553, "user_id": 3839220, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/8062ce7db5476fc8d470bba1e7cc785d?s=128&d=identicon&r=PG&f=1", "display_name": "metro-man", "link": "https://stackoverflow.com/users/3839220/metro-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429953579, "creation_date": 1429127755, "question_id": 29659671, "link": "https://stackoverflow.com/questions/29659671/how-do-i-lex-unicode-characters-in-c", "title": "How do I lex unicode characters in C?", "body": "<p>I've written a Lexer in C, it currently lexes files in ASCII successfully, however I'm confused as to how I would lex unicode. What unicode would I need to lex, for instance should I support utf-8, utf-16, etc. What do languages like Rust or Go support?</p>\n\n<p>If so are there any libraries that can help me out, although I would prefer to try and do it myself so I can learn. Even then, a small library that I could read to learn from would be great.</p>\n"}, {"tags": ["c", "list", "stack", "converter"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429127305, "post_id": 29659493, "comment_id": 47458565, "body": "eh? why you need a <code>double</code> there?"}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429127345, "post_id": 29659493, "comment_id": 47458580, "body": "@SouravGhosh My stack/list has a double type and a pointer to the next element. Can&#39;t change this =\\"}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 3, "creation_date": 1429127428, "post_id": 29659493, "comment_id": 47458621, "body": "Use a stack of tagged unions instead of shoehorning a char in a double!"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 6, "creation_date": 1429127447, "post_id": 29659493, "comment_id": 47458628, "body": "<code>char c = &quot;+&quot;;</code> is illegal; you mean <code>char c = &#39;+&#39;;</code>. Assuming you fix that, <code>double d = c;</code> should set <code>d</code> to <code>43</code>, the ASCII code for the <code>&#39;+&#39;</code> character. You can&#39;t print a <code>double</code> value using <code>%c</code>; you&#39;ll get garbage at best."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429127454, "post_id": 29659493, "comment_id": 47458634, "body": "This is wrong <code>char c = &quot;+&quot;;</code>, what is being stored in the <code>double</code> is wrong, you mean <code>char c = &#39;+&#39;; printf(&quot;Plus: %c\\n&quot;, c);</code>?"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1429127517, "post_id": 29659493, "comment_id": 47458683, "body": "A typical stack-based calculator would not push the operators onto the stack. On reading an operator it would pop the operands from the stack, apply the operation, and push the result. Why do you want to push the operators onto a stack? Once you&#39;ve done that, how will you associated the operators with their operands?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1429127525, "post_id": 29659493, "comment_id": 47458688, "body": "not a duplicate but can get some idea <a href=\"http://stackoverflow.com/a/29235069/2173917\">here</a>"}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429127583, "post_id": 29659493, "comment_id": 47458728, "body": "@tux3 I&#39;ll try it now. Thank you guys. Got it !"}, {"owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "reply_to_user": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429127701, "post_id": 29659493, "comment_id": 47458811, "body": "@tux3 Could you give me some example, please ? First time working with <code>Union</code>"}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "reply_to_user": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1429127902, "post_id": 29659493, "comment_id": 47458930, "body": "@PlayHardGoPro Something like <code>struct stackme{int type; union{double value;char op;};};</code> Or just remove the union, it won&#39;t save much anyways. Or better yet, do what @KeithThompson said if you can."}], "answers": [{"tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": false, "score": 0, "last_activity_date": 1429129517, "last_edit_date": 1429129517, "creation_date": 1429128479, "answer_id": 29659893, "question_id": 29659493, "link": "https://stackoverflow.com/questions/29659493/converting-double-char/29659893#29659893", "title": "Converting double &lt; - &gt; char", "body": "<p>If <code>d</code> is of type <code>double</code> correct output for it is <code>printf(\"Plus: %lf\\n\", d);</code> or <code>printf(\"Plus: %lg\\n\", d);</code> or <code>printf(\"Plus: %le\\n\", d);</code>, but not <code>printf(\"Plus: %c\\n\", d);</code>, because <code>%c</code> means \"output of char data\".</p>\n\n<p>In C language <code>\"+\"</code> is not a character, it is a literal of type <code>char *</code> that represent string (formally it is a pointer).</p>\n\n<p>when you use <code>=</code> (assignment operator) for different data types, some data transformation take place (such as data type promotion), but these transformation are not always useful. So, in you example, as I understand, you want to store operations as characters <code>'+'</code>, <code>'-'</code>, <code>'*'</code>, etc., and data as <code>double</code> values. In that case, you do not need transformation <code>char</code> to <code>double</code> at all. The only thing you need is a designing data structure for storing data and operations together but in different datatypes. </p>\n\n<p>For example, as you wrote \"different stacks/lists\" can be used for data and operators... DIFFERENT!!!</p>\n"}], "owner": {"reputation": 2302, "user_id": 2054434, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/e8f5c753d781ce498b857ec9b7ce366f?s=128&d=identicon&r=PG&f=1", "display_name": "PlayHardGoPro", "link": "https://stackoverflow.com/users/2054434/playhardgopro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1429129517, "creation_date": 1429127251, "last_edit_date": 1429127408, "question_id": 29659493, "link": "https://stackoverflow.com/questions/29659493/converting-double-char", "title": "Converting double &lt; - &gt; char", "body": "<p>I need to create a calculator, for that I have to separte the <code>operands (numbers)</code> and the <code>operators (+Sum, *Mult, -Sub, ^Expo)</code> on different <em>stacks/lists</em> </p>\n\n<p>I need to save each of them on a  stack (wich is a <em>list</em>).<br>\nWhat I can't do is, how am I supposed to convert the character \"+\" into double then get it back from double to character ?  Or is there an easier way to do so ? I tried to print this:  </p>\n\n<pre><code>char c = \"+\";\ndouble d = c; //Now d = -23.00\nprintf(\"Plus: %c\\n\", d); //Prints an unknown character \"?\".  \n</code></pre>\n\n<p>How could I reach where I need ?</p>\n"}, {"tags": ["c++", "c", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429127210, "post_id": 29659458, "comment_id": 47458521, "body": "Normally worker threads produce data, which is then passed to the UI, which in turn displays that data."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429127997, "post_id": 29659458, "comment_id": 47458991, "body": "@David Heffernan So I guess they are just other threads. They are IOCP threads in fact."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1429128329, "post_id": 29659458, "comment_id": 47459157, "body": "It doesn&#39;t really matter. Try to avoid such direct coupling with the UI."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429132916, "post_id": 29659458, "comment_id": 47461803, "body": "@David Heffernan What do you mean by that? (I am new to GUI programming)."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 2, "creation_date": 1429133035, "post_id": 29659458, "comment_id": 47461886, "body": "Stop trying to get the worker thread to drive the UI thread. Have the worker thread update a non-visual data structure, and let the UI thread present it. Perhaps use message passing (not necessarily the Windows message queue) to pass data from worker. But the worker thread should not need to know anything about the UI. Keep the worker thread ignorant of the UI."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429133325, "post_id": 29659458, "comment_id": 47462050, "body": "@David Heffernan So when I receive some data from a socket, I place this data in some data structure, and then the UI thread gets this data and update the UI controls? But how will the UI thread knows that there are pending data?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429133450, "post_id": 29659458, "comment_id": 47462121, "body": "Various ways to do that. Posting a message via the message queue is one way. Setting an event another. Having the UI thread poll with a timer another. Kind of depends on your needs."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429133808, "post_id": 29659458, "comment_id": 47462312, "body": "@David Heffernan Also, if the worker thread needs to read data from a control, should I also have the UI thread place this data into some data structure, and then have the worker thread read it? And wouldn&#39;t this mean that I have to wait until the data is read? (because when displaying data to the UI controls I can just continue executing the rest of the code)"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429134046, "post_id": 29659458, "comment_id": 47462431, "body": "Have the worker ask for the data. Your goal is for the worker to know nothing about the UI."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429134251, "post_id": 29659458, "comment_id": 47462534, "body": "@David Heffernan I don&#39;t think that this approach is necessary for a small program such as mine. Is there a technical problem in having the worker thread access the UI controls directly?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429134654, "post_id": 29659458, "comment_id": 47462722, "body": "Decoupling like this is always better in my view. You disagree? Fine. That&#39;s your call."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429135317, "post_id": 29659458, "comment_id": 47463013, "body": "@David Heffernan I don&#39;t have any experience with this approach to disagree with you (this is the first time I heard of it). I just think that I don&#39;t need to implement it just because I have 5 places where I need to display something to the UI controls and 3 placed where I need to read something from the UI controls"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429180272, "post_id": 29659458, "comment_id": 47481786, "body": "How can you ask this question, outlining existing problems, and then turn around and say that you do not need a solution? David has provided the information you need, so go ahead and decouple the calculation kernel from your UI."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429182672, "post_id": 29659458, "comment_id": 47483453, "body": "@IInspectable Can you tell me why the approach of accessing the UI controls directly is wrong (in my case) so that I can follow the decoupling approach?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429182683, "post_id": 29659458, "comment_id": 47483463, "body": "In that case you may wish to <a href=\"http://stackoverflow.com/q/29012941/1889329\">read up on your approach</a>. At any rate, if you insist that you wish to shoot yourself in the foot, go right ahead. I&#39;m out."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429183580, "post_id": 29659458, "comment_id": 47484108, "body": "@IInspectable The accepted answer in that thread says that the UI manipulation code will ultimately be executed in the context of the UI thread. So I don&#39;t see a problem for this approach other the the ones I have mentioned in my question."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429183728, "post_id": 29659458, "comment_id": 47484226, "body": "The accepted answer says: <i>&quot;So only the owning thread should ever manipulate the HWND and its data in any way.&quot;</i>"}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429184041, "post_id": 29659458, "comment_id": 47484465, "body": "@IInspectable When I send a <code>WM_SETTEXT</code> message to change a Window title, this is not manipulating the <code>HWND</code>, correct? So does &quot;manipulate the HWND&quot; means something like destroying the Window?"}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429184940, "post_id": 29659458, "comment_id": 47485231, "body": "A <code>HWND</code> is an index into a kernel-controlled table of <code>WND</code> structures. The window title is part of the <code>WND</code> structure, as are parent and owner window, position, or the size. Any change to this structure is colloquially referred to as <i>manipulating the <code>HWND</code></i>. <code>WM_SETTEXT</code> works, due to a compatibility shim, that was implemented, because too many people like yourself insisted, that they knew what they were doing. If you absolutely must do the Wrong Thing, keep in mind that you are taking a dependency on a compatibility shim. Not entirely wise for new software."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429186006, "post_id": 29659458, "comment_id": 47486028, "body": "@IInspectable I have heard from many programmers contradictory statements about whether it is a bad idea to use <code>SendMessage()</code> from a worker thread or not. So I guess to be on the safe side, I will not use it. However, is there a problem in using <code>SendMessage()</code> to send a user-defined message?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429186575, "post_id": 29659458, "comment_id": 47486468, "body": "You are reasoning at the wrong level of abstraction. Calling <code>SendMessage</code> from a thread is not, per se, wrong. What is wrong is baking knowledge of the UI into your worker threads. As @IInspectable says, go ahead and do that if you want. My advice is that you don&#39;t do so."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1429238838, "post_id": 29659458, "comment_id": 47515718, "body": "So long as the UI thread does not exit the message loop until the worker thread has exited, you shouldn&#39;t have any issues with deadlocking.  However, if by &quot;terminate the worker thread automatically&quot; you mean using TerminateThread, that&#39;s extremely dangerous and could cause a deadlock."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429238971, "post_id": 29659458, "comment_id": 47515753, "body": "@DavidHeffernan: I think we may be confusing the OP at this point.  Your advice <a href=\"http://stackoverflow.com/a/29577983/886887\">in this answer</a> seems to contradict your advice in these comments?"}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1429250848, "post_id": 29659458, "comment_id": 47519551, "body": "@Harry Here we are talking more about threading design within an app. In the answer there I was saying that SendMessage could be used and would work. I wasn&#39;t necessarily blessing it as a design choice. I also talked about cross process use."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1429272361, "post_id": 29659458, "comment_id": 47533284, "body": "@Harry Johnston What I meant is that because I am using <code>SendMessage()</code> in the worker threads, then if when closing the program I try to send a message to the worker threads asking them to close, this could cause a deadlock if a a worker thread is blocking on a <code>SendMessage()</code>, so I figured that if I did not closed the worker threads and just closed the program then the worker threads will also be closed automatically. (bad thing to do I know but better than <code>TerminateThread()</code>!)."}, {"owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "reply_to_user": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1429272666, "post_id": 29659458, "comment_id": 47533507, "body": "@Harry Johnston Anyway, this does not matter anymore as I have come up with another solution: use <code>PostMessage()</code> instead of <code>SendMessage()</code> in the worker threads to send user-defined messages, and then wait on two events: one to be signaled when the user-defined message is processed, and the other to be signaled when closing the program (to break the &quot;<code>PostMessage()</code> block&quot; if any, and hence no deadlock will occur)."}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 0, "creation_date": 1429316899, "post_id": 29659458, "comment_id": 47558525, "body": "Yes, that should work."}], "owner": {"reputation": 521, "user_id": 4582812, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/7a1b31917b1c556fd426c990c21019b3?s=128&d=identicon&r=PG&f=1", "display_name": "user4582812", "link": "https://stackoverflow.com/users/4582812/user4582812"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 284, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1429127143, "creation_date": 1429127143, "question_id": 29659458, "link": "https://stackoverflow.com/questions/29659458/ui-thread-and-deadlock", "title": "UI thread and deadlock", "body": "<p>I have a UI thread, and one or more worker threads. I want the worker thread to write to the UI controls, and read from the UI controls. The way I decided to implement it is by using <code>SendMessage()</code>.</p>\n\n<p>The worker thread starts when the main thread starts, and terminates when the main thread terminates (this could cause a deadlock if I tried to send a message (and wait) to the worker thread asking it to terminate and the worker thread issued a <code>SendMessage()</code> at the same time, but closing my program will terminate the worker thread automatically).</p>\n\n<p>In the UI thread, I will not wait for the worker thread to terminate (or waiting for anything for that matter), so I believe that no deadlock will occur.</p>\n\n<p><strong>My question is: is there a situation that I am missing where a deadlock could happen?</strong></p>\n\n<p>Note that I don't mind with the other problems caused by using <code>SendMessage()</code> instead of <code>PostMessage()</code>, such as blocking the worker thread for some time instead of just posting a message to the UI thread message queue and continue executing its code.</p>\n\n<hr>\n\n<p>This is the reason why I am using the synchronous <code>SendMessage()</code> in the worker thread and not the asynchronous <code>PostMessage()</code>:</p>\n\n<p>Say I have the following pseudo-code:</p>\n\n<pre><code>/* Thread A */\n\n// Get content of hEdit into str\n// DeleteFile(str)\n</code></pre>\n\n<p>If I use <code>PostMessage()</code>, then I could reach <code>DeleteFile(str)</code> before the content of <code>hEdit</code> are placed into <code>str</code>.</p>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 9, "creation_date": 1429127078, "post_id": 29659406, "comment_id": 47458449, "body": "Suggestions: 1) don&#39;t cast the return value of <code>malloc()</code> 2) don&#39;t become a three-star programmer."}, {"owner": {"reputation": 1090, "user_id": 2843157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qorh2.jpg?s=128&g=1", "display_name": "John Odom", "link": "https://stackoverflow.com/users/2843157/john-odom"}, "edited": false, "score": 0, "creation_date": 1429127114, "post_id": 29659406, "comment_id": 47458462, "body": "Where is the <code>nowy</code> coming from in your <code>strlen()</code> function?"}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 4793507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4de2775087f6138e94a2955d00c817d?s=128&d=identicon&r=PG&f=1", "display_name": "rafal.sz", "link": "https://stackoverflow.com/users/4793507/rafal-sz"}, "edited": false, "score": 0, "creation_date": 1429132348, "post_id": 29660011, "comment_id": 47461501, "body": "Thanks for the explanation! Sorry, I forgot to say - the size is not the problem, I just increment it outside of that function (not the best way to do it, but I had no idea how to get rid of warnings when I was incrementing the size inside function). Also, there is my another fault - I did not change <i>nowy</i> to <i>new</i>. I&#39;ll edit that quickly, sorry for that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 72, "user_id": 4793507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4de2775087f6138e94a2955d00c817d?s=128&d=identicon&r=PG&f=1", "display_name": "rafal.sz", "link": "https://stackoverflow.com/users/4793507/rafal-sz"}, "edited": false, "score": 0, "creation_date": 1429132838, "post_id": 29660011, "comment_id": 47461760, "body": "On the contrary, <code>size</code> <i>is</i> one of the problems.  Your original code definitely at least writes outside the bounds of the <code>realloc()</code>ed array, and probably outside the bounds of the starting allocation.  Incrementing <code>size</code> outside the function has nothing to do with that."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 72, "user_id": 4793507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4de2775087f6138e94a2955d00c817d?s=128&d=identicon&r=PG&f=1", "display_name": "rafal.sz", "link": "https://stackoverflow.com/users/4793507/rafal-sz"}, "edited": false, "score": 0, "creation_date": 1429132970, "post_id": 29660011, "comment_id": 47461842, "body": "Moreover, just changing <code>nowy</code> to <code>new</code> still leaves you with a memory leak.  If you want to make a copy of the string <code>new</code> points to and assign that to an array element, then consider using <code>strdup()</code>.  In that case, remember that that memory will need to be freed later."}, {"owner": {"reputation": 58515, "user_id": 205930, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5Uk5W.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/205930/alex"}, "edited": false, "score": 0, "creation_date": 1429133070, "post_id": 29660011, "comment_id": 47461904, "body": "Side note, but what a great example of how a question should be answered."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 3, "last_activity_date": 1429134901, "last_edit_date": 1429134901, "creation_date": 1429128851, "answer_id": 29660011, "question_id": 29659406, "link": "https://stackoverflow.com/questions/29659406/modifying-pointer-array-in-c-function/29660011#29660011", "title": "Modifying pointer array in C function", "body": "<p>Consider your <code>addElem()</code> function:</p>\n\n<pre><code>void addElem(char ***tabs, int size, char *new) {\n    *tabs[size] = (char*)malloc(sizeof(char)*strlen(nowy));\n    *tabs[size] = new;\n    *tabs = (char **)realloc(*tabs, size * sizeof(char *));\n}\n</code></pre>\n\n<p>This function doesn't write the new element where you think it does.  The array subscripting operator (<code>[]</code>) has higher precedence than the indirection operator (<code>*</code>), so <code>*tabs[size]</code> means \"the thing pointed to by element <code>size</code> of array <code>tabs</code>\", <em>not</em> \"element <code>size</code> of the array pointed to by <code>tabs</code>\".</p>\n\n<p>Also, if <code>size</code> is the current size of the dynamic array -- as in the number of <code>char *</code> members <code>*tabs</code> has space to accommodate -- then <code>(*tabs)[size]</code> is beyond its capacity.  Even if it requested sufficient space to include that position, which it doesn't, the <code>realloc()</code> call would not in any way be guaranteed to expand the memory allocated for <code>*tabs</code> to include that space.  It is entirely free to put the new allocation somewhere else instead.  It may sometimes need to do so when the new size is larger than the old, but it is free to do so even when the new size is smaller.  At some point, uses of this function are likely to lose data in the reallocation.</p>\n\n<p>In addition, your function leaks memory.  It <code>malloc()</code>s space <em>almost</em> sufficient for the string pointed to by global variable <code>nowy</code>, then overwrites the only pointer to that space with function argument <code>new</code>.</p>\n\n<p>Furthermore, your function has no good way to signal failure.</p>\n\n<p>This would be a correct, safer, non-leaky implementation:</p>\n\n<pre><code>/*\n * Ensures that the dynamic array of char * pointed to by '*tabs' has\n * sufficient capacity for exactly 'size' + 1 elements, and stores the\n * value of 'el' at the last position.  Updates *tabs with a pointer to\n * the (possibly different) location of the enlarged array.  Returns the\n * location of the array, or NULL if memory allocation fails (in which\n * case '*tabs' is unchanged, and still a valid pointer to allocated memory).\n */\nchar **addElem(char ***tabs, size_t size, char *el) {\n    char **newtabs = realloc(*tabs, (size + 1) * sizeof(char *));\n\n    if (newtabs) {\n        *tabs = newtabs;\n        (*tabs)[size] = el;\n    }\n\n    return newtabs;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 1542701, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fetH0.jpg?s=128&g=1", "display_name": "ashish", "link": "https://stackoverflow.com/users/1542701/ashish"}, "is_accepted": false, "score": 0, "last_activity_date": 1429184340, "creation_date": 1429184340, "answer_id": 29673589, "question_id": 29659406, "link": "https://stackoverflow.com/questions/29659406/modifying-pointer-array-in-c-function/29673589#29673589", "title": "Modifying pointer array in C function", "body": "<p>A very simple program about triple pointer:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nvoid printElem(int ***tabs) {\n    printf(\"%d\\n\",***tabs);\n\n}\nint main()\n{\n     printf(\"Hello, World!\\n\");\n     int b = 7;\n     int *d;\n     int **t;\n     d = &amp;b;\n     t = &amp;d;\n     printElem(&amp;t);\n\n     return 0;\n}\n\n\noutput:\nsh-4.3# main                                                                                                                                                                                                  \nHello, World!                                                                                                                                                                                                 \n 7  \n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 4793507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4de2775087f6138e94a2955d00c817d?s=128&d=identicon&r=PG&f=1", "display_name": "rafal.sz", "link": "https://stackoverflow.com/users/4793507/rafal-sz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429184340, "creation_date": 1429126996, "last_edit_date": 1495542129, "question_id": 29659406, "link": "https://stackoverflow.com/questions/29659406/modifying-pointer-array-in-c-function", "title": "Modifying pointer array in C function", "body": "<p>I've got a problem when dealing with one- and two-dimensional dynamically allocated arrays in C. I have found similar questions, however none of them helped me so I'm asking a new one.</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/14143274/c-and-pointer-in-a-function-changes-does-not-saved\">C and pointer in a function - changes do not save</a></li>\n<li><a href=\"https://stackoverflow.com/questions/29443151/c-implementention-of-strcpy-does-not-change-variable-value\">C implementention of strcpy does not change variable value</a></li>\n<li><a href=\"https://stackoverflow.com/questions/13431108/changing-address-contained-by-pointer-using-function\">Changing address contained by pointer using function</a></li>\n</ul>\n\n<p>Here is my problem. With the function below I want to add a new element into a two dimensional char array. Size is not the problem, I increment somewhere outside.</p>\n\n<pre><code>void addElem(char ***tabs, int size, char *new) {\n    *tabs[size] = (char*)malloc(sizeof(char)*strlen(new));\n    *tabs[size] = new;\n    *tabs = (char **)realloc(*tabs, size * sizeof(char *));\n}\n</code></pre>\n\n<p>In the code the function is called this way:</p>\n\n<pre><code>int i;\nchar *tmp;\nchar **array = (char **)malloc(sizeof(char *));\n//some stuff, also initializing i and tmp\naddElem(&amp;array, i, tmp);\n</code></pre>\n\n<p>The problem is that the function even if allocates the data, it does not save any data there (for example, strcmp gives SIGSEGV using **array). When debugging similar functions (managing one-dim int arrays), I found out that they in fact work properly inside these functions, the data is just not saved after returning.</p>\n\n<p>I tried to show as small amount of code as possible, but if it helps <a href=\"https://github.com/rafalszulejko/generatorc/blob/master/generatorc/analizator.c\" rel=\"nofollow noreferrer\">here</a> is the full code (with addElem function renamed to dodajDoTablicySlow). Thanks.</p>\n"}, {"tags": ["c", "arrays", "pointers", "data-structures", "struct"], "answers": [{"tags": [], "owner": {"reputation": 11194, "user_id": 3003365, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dP9Od.jpg?s=128&g=1", "display_name": "kaylum", "link": "https://stackoverflow.com/users/3003365/kaylum"}, "is_accepted": false, "score": 1, "last_activity_date": 1429127889, "creation_date": 1429127889, "answer_id": 29659717, "question_id": 29659392, "link": "https://stackoverflow.com/questions/29659392/passing-a-pointer-to-an-array-to-another-function-c/29659717#29659717", "title": "Passing a pointer to an array to another function C", "body": "<p>You are mixing pointers and integers all over the place. That doesn't always cause problems but is bad practice at best. For your specific problem, the cause is likely to be this:</p>\n\n<pre><code>transmit(int* getdata){  //gets pointer value\n    int newdata = getdata;\n    int g = layer3(newdata); //puts pointer into new function\n}\n\nlayer3(int b){\n    int x = b;\n    int w = &amp;x;\n</code></pre>\n\n<p>You pass an int pointer to the layer3 call. But then you take it's address inside layer3. That's not what you want. Again, the mixing up of ints and pointers isn't the root cause here but does contribute to the confusion. Your code should be something like this:</p>\n\n<pre><code>transmit(int* getdata){  //gets pointer value\n    int g = layer3(getdata); //puts pointer into new function\n}\n\nlayer3(int *b){\n    int *w = b;\n</code></pre>\n\n<p>That is, don't change pointers to integers. Just pass the pointer directly around (specifically into layer3). The compiler warnings already hint this to your strongly. A good sign that you are on the right track is if you get rid of all those warnings.</p>\n\n<p>A few more tips:</p>\n\n<ol>\n<li>You don't have explicit return types declared for your functions. Always good practice to declare that explicitly.</li>\n<li>Format your code properly (consistent spacing, etc). Especially when posting on Stackoverflow but really even more so for yourself.</li>\n</ol>\n"}], "owner": {"reputation": 11, "user_id": 4793545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64d19bde2a5f0faecfd17326b92aa4f3?s=128&d=identicon&r=PG&f=1", "display_name": "Fawn Liebowitz", "link": "https://stackoverflow.com/users/4793545/fawn-liebowitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 467, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429130738, "creation_date": 1429126949, "last_edit_date": 1429130738, "question_id": 29659392, "link": "https://stackoverflow.com/questions/29659392/passing-a-pointer-to-an-array-to-another-function-c", "title": "Passing a pointer to an array to another function C", "body": "<p>I am attempting to take a input file up to 2048 bytes and place it in its own array in layer4. I am also attempting to place the size of the array in spot   [0] of the array for latter use. When layer4 finishes I am attempting to pass the pointer pointing to the array called <code>code</code> to <code>transmit</code> function where it will pass that value to <code>layer3</code> and place the array in a structure. Currently when I compare the address of my pointer in layer4 and layer3 to each other, they match. However when i check for values in the array in layer3, they do not match the values of the array in my input file. This code is to be part of a bigger project. The various warnings I receive are at the bottom under my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;   \n#include &lt;stdlib.h&gt;\n\n\nmain()\n{\nint *senddata;\nsenddata = layer4(); // get pointer address of input array\ntransmit(senddata); //put pointer value into transmit\n\n\n}\n\nint layer4(){\n    FILE *file = fopen(\"sendtext.txt\", \"r\"); //\n    char *code;\n    size_t n = 0;\n    int c;\n    if (file == NULL)\n        return NULL; //could not open file\n\n    code = malloc(2048); //allocate memory \n\n    while ((c = fgetc(file)) != EOF)\n    {\n    n++;       \n    code[n] = (char) c;\n    printf(\"%c\", code[n]);\n    }\n    code[n] = '\\0';\n    n = n-1;  // for some reason the byte size is +1 for what it should be\n    code[0] = n;  \n\n  printf(\"Check Pointer Address in layer 4: %p \\n\", code); //test to see pointer address\n  printf(\"Check to see value in pointer:%c \\n\", code[0]); //check to see if the byte size was placed in the array\n  printf(\"Byte size:%zd\\n\", n); /// see array size\n\n\nreturn code;\n}\n\ntransmit(int* getdata){  //gets pointer value\nint newdata = getdata;\nint g = layer3(newdata); //puts pointer into new function\n}\n\nlayer3(int b){\nint x = b;\nint w = &amp;x;\nchar *MSS;\nMSS = malloc(60); \n\n\nprintf(\"Check to see value in pointer:%c \\n\", w);\n\n\nprintf(\"Check Pointer Address in layer 3:%p \\n\", x); //test to see pointer address\n\nstruct l3hdr {  \n  char ver;\n  char src_ipaddr[16];\n  char dest_ipaddr[16];\n  char reserved[7];\n};\n\nstruct l3pdu {\n// put array here\nstruct l3hdr hdr3; \n\n\n};\n}\n</code></pre>\n\n<h2>Output</h2>\n\n<pre><code>Q sadfasd fsa asd fsadf sad f /// This is my input testfile\nCheck Pointer Address in layer 4: 0xa81250 \nCheck to see Byte size in array: \nCheck to see first input character in array:Q \nByte size:29\nCheck to see value in pointer:P \nCheck Pointer Address in layer 3:0xa81250   \n</code></pre>\n\n<h2>Warnings</h2>\n\n<pre><code>lab.c:20:9: warning: return makes integer from pointer without a cast [enabled by default]\n         return NULL; //could not open file\n         ^\nlab.c:37:2: warning: format \u2018%c\u2019 expects argument of type \u2018int\u2019, but argument 2 has type \u2018char *\u2019 [-Wformat=]\n  printf(\"Check to see value in pointer:%c \\n\", code);\n  ^\nlab.c:43:1: warning: return makes integer from pointer without a cast [enabled by default]\n return code;\n ^\n\n\nlab.c: In function \u2018transmit\u2019:\nlab.c:47:15: warning: initialization makes integer from pointer without a cast [enabled by default]\n int newdata = getdata;\n               ^\n\n\nlab.c: In function \u2018layer3\u2019:\n\n\n\nlab.c:64:9: warning: initialization makes integer from pointer without a cast [enabled by default]\n int w = &amp;x;\n         ^\n\n\nlab.c:72:1: warning: format \u2018%p\u2019 expects argument of type \u2018void *\u2019, but argument 2 has type \u2018int\u2019 [-Wformat=]\n printf(\"Check Pointer Address in layer 3:%p \\n\", x); //test to see pointer address\n ^\n</code></pre>\n"}, {"tags": ["c", "pointers", "data-structures"], "answers": [{"comments": [{"owner": {"reputation": 758, "user_id": 4384593, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R13Sg.jpg?s=128&g=1", "display_name": "Ivan Gandacov", "link": "https://stackoverflow.com/users/4384593/ivan-gandacov"}, "edited": false, "score": 0, "creation_date": 1429127181, "post_id": 29659395, "comment_id": 47458504, "body": "Do you mean by &quot;two instances of Set&quot; that I have to create an array of type Set ?"}, {"owner": {"reputation": 758, "user_id": 4384593, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R13Sg.jpg?s=128&g=1", "display_name": "Ivan Gandacov", "link": "https://stackoverflow.com/users/4384593/ivan-gandacov"}, "edited": false, "score": 0, "creation_date": 1429127510, "post_id": 29659395, "comment_id": 47458677, "body": "I&#39;ve added a comment in my program. It&#39;s in the second function, and starts with:&quot;It&#39;s interesting that when ...&quot;. Don&#39;t you know what can be the issue for this ? Thank you."}], "tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 1, "last_activity_date": 1429126958, "creation_date": 1429126958, "answer_id": 29659395, "question_id": 29659246, "link": "https://stackoverflow.com/questions/29659246/dealing-with-pointers-and-structures/29659395#29659395", "title": "Dealing with pointers and structures", "body": "<p>this seems wrong</p>\n\n<pre><code>struct Set\n{\n    unsigned int card;\n    double *p[2];\n};\n</code></pre>\n\n<p>you have a set with 2 lists of number. I think each set should have one list</p>\n\n<pre><code>struct Set\n{\n    unsigned int card;\n    double *p;\n};\n</code></pre>\n\n<p>things kind of go bad from there. You need to create 2 instances of Set and load data into each one. I would create a Load_Set function that takes a double list and returns a newly malloced Set</p>\n"}, {"comments": [{"owner": {"reputation": 758, "user_id": 4384593, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R13Sg.jpg?s=128&g=1", "display_name": "Ivan Gandacov", "link": "https://stackoverflow.com/users/4384593/ivan-gandacov"}, "edited": false, "score": 0, "creation_date": 1429129331, "post_id": 29659800, "comment_id": 47459756, "body": "Thank you very much. Your response was very useful. The problem with my program was indeed what you noticed: I worked with &quot;mult&quot;(that was declared as a single element type MULTIME), as if with an array of two elements. The moment I changed &quot;MULTIME <i>mult = (MULTIME</i>)malloc(sizeof(MULTIME))&quot; by MULTIME <i>mult = (MULTIME</i>)malloc(sizeof(MULTIME)*2) everything went fine. Thank you."}], "tags": [], "owner": {"reputation": 32386, "user_id": 4706785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdee2789e9bac57bfdd97abc4e533a4d?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/4706785/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1429128193, "creation_date": 1429128193, "answer_id": 29659800, "question_id": 29659246, "link": "https://stackoverflow.com/questions/29659246/dealing-with-pointers-and-structures/29659800#29659800", "title": "Dealing with pointers and structures", "body": "<p>There are a number of problems within <code>introduce_data()</code> I can see on a quick look.</p>\n\n<p>Firstly, converting the return value of <code>malloc()</code>, as in</p>\n\n<pre><code>MULTIME *mult = (MULTIME*)malloc(sizeof(MULTIME));\n</code></pre>\n\n<p>is unnecessary.   Remove the <code>(MULTIME *)</code> conversion and ensure that there is an <code>#include &lt;stdlib.h&gt;</code> at the top of your code.     Leaving out <code>#include &lt;stdlib.h&gt;</code> and using the conversion causes your code to have undefined behaviour.   (The only exception is if your C compiler is actually a C++ compiler - in that case you need BOTH the <code>#include &lt;stdlib.h&gt;</code> and the conversion.  Otherwise don't use the conversion.).</p>\n\n<p>Second, the <code>malloc()</code> in allocates memory for <code>mult</code> as a single <code>MULTIME</code>.   The loop then uses <code>mult</code> as if it is an array of two <code>MULTIME</code>.   That falls off the end of the (dynamically allocated array).    The behaviour is undefined.</p>\n\n<p>Third, you are getting the mapping between array syntax and pointer syntax wrong.   The statement</p>\n\n<pre><code>(mult+i)-&gt;p[i] = (double*)malloc(sizeof(double)*((mult+i)-&gt;card));\n</code></pre>\n\n<p>is functionally equivalent (with dropping the type conversion) to</p>\n\n<pre><code>mult[i].p[i] = malloc(sizeof(double)*(mult[i].card));\n</code></pre>\n\n<p>Similarly, the statement</p>\n\n<pre><code>scanf(\"%lf\", ((mult + i)-&gt;p[i]+j));\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>scanf(\"%lf\", mult[i].p[i]+j);\n</code></pre>\n\n<p>Both of these are probably not what you intend.</p>\n\n<p>The underlying concern is that you are not properly understanding how pointers work with arrays.   You'll need to read your textbook more closely.</p>\n"}, {"tags": [], "owner": {"reputation": 758, "user_id": 4384593, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R13Sg.jpg?s=128&g=1", "display_name": "Ivan Gandacov", "link": "https://stackoverflow.com/users/4384593/ivan-gandacov"}, "is_accepted": false, "score": 0, "last_activity_date": 1429129866, "creation_date": 1429129866, "answer_id": 29660287, "question_id": 29659246, "link": "https://stackoverflow.com/questions/29659246/dealing-with-pointers-and-structures/29660287#29660287", "title": "Dealing with pointers and structures", "body": "<p>I hope it will be useful for others encountering the same problem. </p>\n\n<p>Finally, thanks to Peter, I understood what was the problem. Peter noticed that I used the variable <strong><em>mult</em></strong> as an array of two elements of type <strong>MULTIME</strong>, while it was declared as a single-element variable. </p>\n\n<p>So, after changing this:</p>\n\n<pre><code>MULTIME *mult = (MULTIME*)malloc(sizeof(MULTIME));\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>MULTIME *mult = (MULTIME*)malloc(sizeof(MULTIME)*2);\n</code></pre>\n\n<p>I've finally got the right result.</p>\n"}], "owner": {"reputation": 758, "user_id": 4384593, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R13Sg.jpg?s=128&g=1", "display_name": "Ivan Gandacov", "link": "https://stackoverflow.com/users/4384593/ivan-gandacov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 29659800, "answer_count": 3, "score": 1, "last_activity_date": 1429129866, "creation_date": 1429126480, "last_edit_date": 1592644375, "question_id": 29659246, "link": "https://stackoverflow.com/questions/29659246/dealing-with-pointers-and-structures", "title": "Dealing with pointers and structures", "body": "<p>I have a huge problem that I've tried solving in many different ways but could not find the solution.</p>\n<p>What I must do is:</p>\n<ol>\n<li>create a function for introducing 2 sets</li>\n<li>another function for displaying these sets</li>\n</ol>\n<p>It is required to use a structure, which components will be:</p>\n<ol>\n<li><p>the number of elements for respective set;</p>\n</li>\n<li><p>a pointer(for storing the elements of these 2 sets);</p>\n<p>I do not know why, but when I execute the program (presented below),the second element of the first set isn't showing. Please, if you have time , can you help me find the problem. It's really frustrating when everything seems to be fine, and still the program isn't working. Thank you very much !!!</p>\n</li>\n</ol>\n<p>In <em><strong>header</strong></em> I have:</p>\n<pre><code>#ifndef L8_3H_H_\n#define L8_3H_H_\n\nstruct Set\n{\n    unsigned int card;\n    double *p[2];\n};\n\ntypedef struct Set MULTIME;\n\nMULTIME *introduce_data();\nvoid showSet(MULTIME *m, int j);\n\n#endif /* L8_3H_H_ */\n</code></pre>\n<p>In <em><strong>main</strong></em> I have:</p>\n<pre><code>    #include &quot;L8_3h.h&quot;\n    #include &lt;stdio.h&gt;\n\nint main( void )\n{\n    MULTIME *mult;\n\n\n    mult = introduce_data();\n\n    showSet(mult, 0);\n    showSet(mult, 1);\n\nreturn 0;\n}\n</code></pre>\n<p>My <em><strong>functions</strong></em> are:</p>\n<pre><code>#include &quot;L8_3h.h&quot;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n\nvoid showSet(MULTIME *m, int j)\n{\n    int i;\n\n\n\n    if ( j == 0 )\n    {\n        printf(&quot;\\nA = {&quot;);\n    }else\n    {\n        printf(&quot;\\nB = {&quot;);\n    }\n\n    for (i = 0; i &lt; (m + j)-&gt;card; ++i)\n    {\n        printf(&quot;%lf&quot;, *((m + j)-&gt;p[j]+i));\n\n        if (i != (m + j)-&gt;card - 1)\n        {\n            printf(&quot;, &quot;);\n        }\n    }\n\n    printf(&quot;}&quot;);\n}\n\n\nMULTIME *introduce_data()\n{\n    MULTIME *mult = (MULTIME*)malloc(sizeof(MULTIME));\n    int i, j;\n\n\n    for (i = 0; i &lt; 2; ++i)\n    {\n        \n\n        printf(&quot;\\nIntroduce the number of elements of set %d&quot;, i + 1);\n        scanf(&quot;%u&quot;, &amp;(mult + i)-&gt;card);\n\n        \n       (mult+i)-&gt;p[i] = (double*)malloc(sizeof(double)*((mult+i)-&gt;card));\n\n        \n        printf(&quot;\\nIntroduce the element of set %d\\n&quot;, i+1);\n        for (j = 0; j &lt; (mult + i)-&gt;card; ++j)\n        {\n            scanf(&quot;%lf&quot;, ((mult + i)-&gt;p[i]+j));\n //It's interesting that when I put a printf right after  introducing the \n//element everything is fine(I get the right element)\n        }\n    \n\n     }\n    \n\n    printf(&quot;\\nHeres the problem&quot;);\n    printf(&quot;\\nThis should not be zero: %lf&quot;, *((mult + 0)-&gt;p[0]+1));\n    \nreturn mult;\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429126154, "post_id": 29659099, "comment_id": 47457901, "body": "<code>output should be 1 but it is not 1</code>...so what is it?"}, {"owner": {"reputation": 2724, "user_id": 402443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c247e7e6e24f5665ecd79654bc7c5bed?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/402443/matt"}, "edited": false, "score": 0, "creation_date": 1429126354, "post_id": 29659099, "comment_id": 47458012, "body": "You may want to include more information, including the actual output you received."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1429126883, "post_id": 29659099, "comment_id": 47458357, "body": "type of <code>&amp;a</code> is <code>int (*)[6]</code>. it meant pointer to <code>int[6]</code>. so <code>&amp;a + 1</code> point to next(<code>a[6]</code>)  the last element(<code>6</code>:<code>a[5]</code>). then cast to <code>int *</code> then <code>-1</code> so point to last element <code>6</code>."}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429126536, "post_id": 29659196, "comment_id": 47458126, "body": "The downvoter seems to disagree, I would like to see your answer to see if mine is really wrong or bad."}, {"owner": {"reputation": 39, "user_id": 4793532, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DvmJfwm04cg/AAAAAAAAAAI/AAAAAAAAAIs/GByg4VNqHPY/photo.jpg?sz=128", "display_name": "dev_k2.0", "link": "https://stackoverflow.com/users/4793532/dev-k2-0"}, "edited": false, "score": 0, "creation_date": 1429126561, "post_id": 29659196, "comment_id": 47458153, "body": "i am having the confusion around the same thing.. can you please elucidate it little more"}, {"owner": {"reputation": 91305, "user_id": 19410, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/175f1d55c73ce5cb1d071dc4d0f1a333?s=128&d=identicon&r=PG", "display_name": "Alex Reynolds", "link": "https://stackoverflow.com/users/19410/alex-reynolds"}, "edited": false, "score": 0, "creation_date": 1429127008, "post_id": 29659196, "comment_id": 47458417, "body": "Not sure why this was voted down. Would be interested to see the downvoter comment on their reasoning."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1429127217, "post_id": 29659196, "comment_id": 47458523, "body": "More precisely, <code>&amp;a</code> has type <code>int(*)[6]</code> (now fixed, thanks). Also, <code>sizeof(int) != sizeof(int *)</code> -- <code>sizeof (int*)</code> is irrelevant. What&#39;s relevant is <code>sizeof (int[6])</code>."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": false, "score": 3, "last_activity_date": 1429127266, "last_edit_date": 1429127266, "creation_date": 1429126327, "answer_id": 29659196, "question_id": 29659099, "link": "https://stackoverflow.com/questions/29659099/program-output-of-a-c-program/29659196#29659196", "title": "program output of a c program", "body": "<p>It's because <code>&amp;a</code> has type <code>int(*)[6]</code> and hence <code>&amp;a + 1 != &amp;a[0] + 1</code> which is what you meant, given your expected output.</p>\n\n<p>If you print the addresses <code>&amp;a</code> and <code>&amp;a[0]</code>, they will be the same, however incrementing <code>&amp;a</code> is not the same as incrementing <code>&amp;a[0]</code> because <code>sizeof(int) != sizeof(int *)</code>, although that's not always true, your code should not assume it is, or depend on that.</p>\n\n<p>Also, it appears that your are using the cast because your compiler was complaining about the fact that <code>&amp;a</code> is of an incompatible pointer type, you should not need the cast if the pointers are of compatible types so</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int  a[] = {1, 2, 3, 4, 5, 6};\n    int *ptr = &amp;a[0] + 1;\n\n    printf(\"%d\\n\", *(ptr-1));\n\n    return 0;\n}\n</code></pre>\n\n<p>should compile just find, and the output will be <code>1</code> as you expected.</p>\n"}, {"tags": [], "owner": {"reputation": 591, "user_id": 4735903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/870c3cd3096f304513e2573fa7e63091?s=128&d=identicon&r=PG", "display_name": "Loic", "link": "https://stackoverflow.com/users/4735903/loic"}, "is_accepted": false, "score": 1, "last_activity_date": 1429130150, "creation_date": 1429130150, "answer_id": 29660389, "question_id": 29659099, "link": "https://stackoverflow.com/questions/29659099/program-output-of-a-c-program/29660389#29660389", "title": "program output of a c program", "body": "<p><code>a</code> and <code>&amp;a</code> are the same value,<br>\n<code>a</code> is of type <code>int [6]</code>,<br>\n<code>&amp;a</code> is of type <code>int (*)[6]</code>.</p>\n\n<p>It means that</p>\n\n<pre><code>    ptr\n == (int *)(          &amp;a + 1                )\n == (int *)( (char *) &amp;a + 1*sizeof(*&amp;a)    )\n == (int *)( (char *) &amp;a + 1*sizeof(a)      )\n == (int *)( (char *) &amp;a + 1*6*sizeof(int)  )\n == (int *)( (char *) a  + 1*6*sizeof(int)  )\n == (int *)( (char *) a  + 1*6*sizeof(*a)   )\n == (int *)(          a  + 6                )\n == &amp;a[6]\n</code></pre>\n\n<p>thus</p>\n\n<pre><code>*(ptr-1) == *(a+5) == a[5] == 6\n</code></pre>\n\n<p>the reason why \"6 \" is printed.</p>\n"}], "owner": {"reputation": 39, "user_id": 4793532, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-DvmJfwm04cg/AAAAAAAAAAI/AAAAAAAAAIs/GByg4VNqHPY/photo.jpg?sz=128", "display_name": "dev_k2.0", "link": "https://stackoverflow.com/users/4793532/dev-k2-0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429130150, "creation_date": 1429126074, "last_edit_date": 1429126183, "question_id": 29659099, "link": "https://stackoverflow.com/questions/29659099/program-output-of-a-c-program", "title": "program output of a c program", "body": "<p>please explain the output of the below mentioned program. I thought that output should be 1 but it is not 1</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int  a[] = {1, 2, 3, 4, 5, 6};\n    int *ptr = (int*)(&amp;a+1);\n\n    printf(\"%d \", *(ptr-1));\n    getchar(); \n\n    return 0;\n} \n</code></pre>\n"}, {"tags": ["c", "linux", "32bit-64bit"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 3, "creation_date": 1429125813, "post_id": 29658951, "comment_id": 47457659, "body": "<code>char x = (int) malloc(sizeof(whereisX));</code> makes no sense."}, {"owner": {"reputation": 59891, "user_id": 1207195, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Q3P4g.jpg?s=128&g=1", "display_name": "Adriano Repetti", "link": "https://stackoverflow.com/users/1207195/adriano-repetti"}, "edited": false, "score": 0, "creation_date": 1429125874, "post_id": 29658951, "comment_id": 47457705, "body": "Check 3d line of your function..."}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 1, "creation_date": 1429127181, "post_id": 29658951, "comment_id": 47458505, "body": "There are <b>at least</b> two errors: the nonsense <code>malloc</code> and the <code>printf(&quot;bW is %c and bH is %c\\n&quot;, bW, bH);</code>: if bW and bH are int, then you should use %d"}, {"owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "reply_to_user": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "edited": false, "score": 0, "creation_date": 1429128916, "post_id": 29658951, "comment_id": 47459496, "body": "I don&#39;t care about the printf because for two reasons I am not a seasoned programmer never will be -- I just tossed them in to get some out put to see what was happening with my code -- I just took this code added to it making the program give me more power to do to whatever I wanted to an image then then what the other person did. the printf are going away being removed. this is the only program I&#39;ve ever written in C and most likely the last one too @xanatos"}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "edited": false, "score": 0, "creation_date": 1429126978, "post_id": 29659147, "comment_id": 47458406, "body": "it was only giving me&quot;&quot; mhsetroot-v1.6.2.c: In function \u2018findX\u2019: mhsetroot-v1.6.2.c:728:11: warning: cast from pointer to integer of different size [-Wpointer-to-int-cast] &quot;&quot; that and it still worked BUT I MUST ADD: changing it to what you suggested fixed my problem --- THANKS!!!!!!   @WeatherVane"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "edited": false, "score": 0, "creation_date": 1429129580, "post_id": 29659147, "comment_id": 47459903, "body": "@uxserx-bw don&#39;t fix warnings by throwing casts at them; instead try to understand what the warning is trying to warn you about"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 5, "last_activity_date": 1429127112, "last_edit_date": 1429127112, "creation_date": 1429126217, "answer_id": 29659147, "question_id": 29658951, "link": "https://stackoverflow.com/questions/29658951/32bit-c-program-no-longer-converting-char-to-int-on-64-bit-os-linux/29659147#29659147", "title": "32bit C program no longer converting char to int on 64 bit OS Linux", "body": "<p>These lines which you use to assign memory to copy the passed string are nonsense.</p>\n\n<pre><code>char x = (int) malloc(sizeof(whereisX));    // does not give the string length\nchar str1[x];                               // does not allow for terminator\nint bW, bH;\nstrcpy(str1, whereisX);\n</code></pre>\n\n<p>Would be better as</p>\n\n<pre><code>char str1[1+strlen(whereisX)];\nstrcpy(str1, whereisX);\n</code></pre>\n\n<p>It's a wonder that your earlier version worked at all!</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Lets walk through it:</p>\n\n<pre><code>char x = (int) malloc(sizeof(whereisX));\n</code></pre>\n\n<p>The <code>malloc</code> allocates memory for a <code>char*</code> pointer - previously 4 bytes, now 8.</p>\n\n<p>The <code>(int)malloc</code> converts the address of the memory allocated to an integer.</p>\n\n<p>The <code>char x =</code> then stores the integer in 8 bits. This has nothing to do with the length of the string you will copy.</p>\n\n<p>Next <code>char str1[x];</code> assigns an array of a size totally unrelated to the length of string you will copy. Even if you <em>did</em> have the right length, it need to be one element longer to take the <code>nul</code> terminator. If it worked before, is pure luck that you ended up with a long enough array.</p>\n\n<p>But switching to a different compiler has shown up this bug.</p>\n\n<p>So rather than say I haven't answered your question, please correct your mistake and see if it fixes the problem. Maybe it will, maybe not: I haven't looked past line 3 to see if there are any other <strong>howlers</strong>.</p>\n"}, {"comments": [{"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429128007, "post_id": 29659646, "comment_id": 47458996, "body": "Great - wonderful last comment - programming by accident.  +1"}, {"owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429129104, "post_id": 29659646, "comment_id": 47459632, "body": "@jimmcnamara go back and look at his lecture about programming by luck example &quot;answer&quot; did for my function -- he needs to take his own advice"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429129512, "post_id": 29659646, "comment_id": 47459859, "body": "You repeated OP&#39;s mistake of <a href=\"http://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc\">casting malloc</a>.  OP&#39;s code can serve as a counter-example to those who pooh-pooh the idea that one of the disadvantages of casting malloc is that it can hide a useful compiler diagnostic."}, {"owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "edited": false, "score": 0, "creation_date": 1429129567, "post_id": 29659646, "comment_id": 47459895, "body": "@xanatos your code just screws up the function more then it already was -- looks to me you&#39;re not heading your own advice -- mods took out all the errors it cost me trying it your way that I added to your post -- showing how wrong you where"}, {"owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "edited": false, "score": 0, "creation_date": 1429129825, "post_id": 29659646, "comment_id": 47460041, "body": "@WeatherVane char str1[1+strlen(whereisX)];                           strcpy(str1, whereisX);  that fixed all my problems thanks ---"}], "tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": false, "score": 1, "last_activity_date": 1429128838, "last_edit_date": 1429128838, "creation_date": 1429127707, "answer_id": 29659646, "question_id": 29658951, "link": "https://stackoverflow.com/questions/29658951/32bit-c-program-no-longer-converting-char-to-int-on-64-bit-os-linux/29659646#29659646", "title": "32bit C program no longer converting char to int on 64 bit OS Linux", "body": "<p>The correct version of your code is:</p>\n\n<pre><code>int findX(char *whereisX, int *rW, int *rH)\n{\n    printf(\"entering findx dia is %s\\n\\n\", whereisX);\n    char *tok1, *tok2, *saveptr;\n\n    char *str1 = (char*)malloc(1 + strlen(whereisX));\n    int bW, bH;\n\n    strcpy(str1, whereisX);\n\n    tok1 = strtok_k(whereisX, \"x\", &amp;saveptr);\n    tok2 = strtok_k(NULL, \"x\", &amp;saveptr);\n\n    if (tok2 == NULL)\n    {\n        printf(\"found return 1\\n\");\n        free(str1);\n        return 1;\n    }\n    else\n    {\n        printf(\"returning 0\\n\");\n        tok1 = strtok_k(str1, \"x\", &amp;saveptr);\n        tok2 = strtok_k(NULL, \"x\", &amp;saveptr);\n\n        printf(\"tok1 is .. %s and tok2 is %s\\n\", tok1, tok2);\n\n        bW = atoi(tok1);\n        bH = atoi(tok2);\n\n        printf(\"bW is %d and bH is %d\\n\", bW, bH);\n        /* assigning the results to the output */\n        *rW = bW;\n        *rH = bH;\n\n        printf(\"rW is %d  rH is %d\\n\", *rW, *rH);\n        printf(\"tok1 is %s  tok2 is %s\\n\", tok1, tok2);\n\n        free(str1);\n        return 0;\n    }\n} //end findX\n</code></pre>\n\n<p>Note the differences: you were using <code>malloc</code> in the <strong>totally wrong</strong> way, you were using <code>printf</code> format identifiers in the totally wrong way, you weren't <code>free</code>ing the allocated string. </p>\n\n<p>I'll add that you are doing the <code>strtok_r</code> twice (once outside the <code>if</code> and once inside the <code>if</code>). The two will return the same data, because <code>str1</code> is a copy of <code>whereisX</code></p>\n\n<p>The code then can be simplified to:</p>\n\n<pre><code>int findX(char *whereisX, int *rW, int *rH)\n{\n    printf(\"entering findx dia is %s\\n\\n\", whereisX);\n    char *tok1, *tok2, *saveptr;\n\n    int bW, bH;\n\n    tok1 = strtok_k(whereisX, \"x\", &amp;saveptr);\n    tok2 = strtok_k(NULL, \"x\", &amp;saveptr);\n\n    if (tok2 == NULL)\n    {\n        printf(\"found return 1\\n\");\n        return 1;\n    }\n    else\n    {\n        printf(\"returning 0\\n\");\n\n        printf(\"tok1 is .. %s and tok2 is %s\\n\", tok1, tok2);\n\n        bW = atoi(tok1);\n        bH = atoi(tok2);\n        printf(\"bW is %d and bH is %d\\n\", bW, bH);\n        // printf(\"string -- bW is %s and bH is %s\\n\", bW,bH);\n        /* assigning the results to the output */\n        *rW = bW;\n        *rH = bH;\n        printf(\"rW is %d  rH is %d\\n\", *rW, *rH);\n        printf(\"tok1 is %s  tok2 is %s\\n\", tok1, tok2);\n        return 0;\n    }\n} //end findX\n</code></pre>\n\n<p><strong>The fact that random programs written in C sometimes run returning somethings that seems to be correct doesn't mean they are correct. It only means that you got lucky. This luck doesn't ever last.</strong></p>\n"}], "owner": {"reputation": 221, "user_id": 3026167, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/37ddfee2541c8140c7b7755b96c6e5d6?s=128&d=identicon&r=PG&f=1", "display_name": "uxserx-bw", "link": "https://stackoverflow.com/users/3026167/uxserx-bw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "accepted_answer_id": 29659147, "answer_count": 2, "score": 2, "last_activity_date": 1429128838, "creation_date": 1429125590, "question_id": 29658951, "link": "https://stackoverflow.com/questions/29658951/32bit-c-program-no-longer-converting-char-to-int-on-64-bit-os-linux", "title": "32bit C program no longer converting char to int on 64 bit OS Linux", "body": "<p>a simple question:</p>\n\n<p>this function worked perfectly on my 32 Bit Linux then I got a 64 Bit Linux and now it is no longer working. I've narrowed it down to this function in converting the data from Char to Int. it no longer does this. this is where I am stuck at right now. all this functions is doing is taking a format like this 100x100 then chopping out the x and keeping the two numbers on both sides then changing them into Int's. </p>\n\n<p>Using atoi is now returning junk now that I am running it on this 64bit Linux. what function call do I have to use that will make it work again only on both 32 and 64 bit Linux programs now? </p>\n\n<pre><code>int findX(char *whereisX, int *rW, int *rH)\n{\nprintf(\"entering findx dia is %s\\n\\n\", whereisX);\nchar *tok1, *tok2, *saveptr;\nchar x = (int) malloc(sizeof(whereisX));\n\nchar str1[x];\nint bW, bH;\n\nstrcpy(str1, whereisX);\n\ntok1 = strtok_r(whereisX, \"x\", &amp;saveptr);\ntok2 = strtok_r(NULL, \"x\", &amp;saveptr);\n\nif ( tok2 == NULL)\n{   printf(\"found return 1\\n\");\n    return 1;\n}\n else\n    { printf(\"returning 0\\n\");\n        tok1 = strtok_r(str1, \"x\", &amp;saveptr);\n        tok2 = strtok_r(NULL, \"x\", &amp;saveptr);\n\n        printf(\"tok1 is .. %s and tok2 is %s\\n\", tok1 , tok2);\n\n    // here is where I am converting it from Char to Int\n    // using atoi now gives me back junk \n\n     // bW = atoi(tok1);\n     //    bH = atoi(tok2);\n\n\n    bW = atoll(tok1);\n    bH = atoll(tok2);\n        printf(\"bW is %c and bH is %c\\n\", bW, bH);\n       // printf(\"string -- bW is %s and bH is %s\\n\", bW,bH);\n    /* assigning the results to the output */\n       *rW = bW;\n       *rH = bH;\n    printf(\"rW is %s  rH is %s\\n\", rW  , rH); \n       return 0;\n     }\n} //end findX\n</code></pre>\n\n<p>output is</p>\n\n<pre><code>tok1 is .. 200 and tok2 is 100\n// after converting from char to int using atoi\nbW is \ufffd and bH is d\nrW is \ufffd  rH is d\n</code></pre>\n"}, {"tags": ["c", "scanf"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 1, "creation_date": 1429124969, "post_id": 29658685, "comment_id": 47457104, "body": "Side note: Why is tre not named TagReadEvent (and get rid of the comment) ?"}, {"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 1, "creation_date": 1429125577, "post_id": 29658685, "comment_id": 47457487, "body": ".cpp extension would imply C++, but your code looks like C (and is tagged both)?"}, {"owner": {"reputation": 871, "user_id": 3680879, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c861be432fd7c112b26edb933f2a338a?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Jones", "link": "https://stackoverflow.com/users/3680879/mat-jones"}, "edited": false, "score": 0, "creation_date": 1429125749, "post_id": 29658685, "comment_id": 47457614, "body": "for some reason, my college professor insists that we use g++ for C code when g++ is normally for C++, I&#39;m not sure why..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2249683"}, "edited": false, "score": 0, "creation_date": 1429125792, "post_id": 29658685, "comment_id": 47457648, "body": "No LOL: Less typing while writing, but a huge readability and maintenance problem."}], "answers": [{"comments": [{"owner": {"reputation": 871, "user_id": 3680879, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c861be432fd7c112b26edb933f2a338a?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Jones", "link": "https://stackoverflow.com/users/3680879/mat-jones"}, "edited": false, "score": 1, "creation_date": 1429125367, "post_id": 29658742, "comment_id": 47457352, "body": "this actually fixed multiple problems, thank you!"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 871, "user_id": 3680879, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c861be432fd7c112b26edb933f2a338a?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Jones", "link": "https://stackoverflow.com/users/3680879/mat-jones"}, "edited": false, "score": 0, "creation_date": 1429126028, "post_id": 29658742, "comment_id": 47457815, "body": "@mjones.udri Welcome. Glad it helped."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 9, "last_activity_date": 1429125383, "last_edit_date": 1429125383, "creation_date": 1429124925, "answer_id": 29658742, "question_id": 29658685, "link": "https://stackoverflow.com/questions/29658685/c-skipping-one-command-of-a-function/29658742#29658742", "title": "C skipping one command of a function?", "body": "<p><strong>Point 1</strong> [Programmatic error]</p>\n\n<p>The problem here is the usage with <code>%c</code> format specifier. It <em>counts</em> the previously entered <code>\\n</code>, stored by pressing the <kbd>ENTER</kbd> key after previous input. What you want is</p>\n\n<pre><code>scanf(\" %c\", &amp;tag[i].owner);\n       ^\n       |\n    note the space\n</code></pre>\n\n<p>to skip any leading whitespace like character (including <code>\\n</code>) before the actual input.</p>\n\n<p><strong>Point 2</strong> [Logical Error]</p>\n\n<p>As per your code here, to <em>scan</em> a <em>string</em> input, you need to use <code>%s</code> format specifier.</p>\n\n<p>So, finally, your code should look like</p>\n\n<pre><code>   scanf(\"%s\", tag[i].owner);    // if tag[i].owner is char array\n</code></pre>\n\n<p>or</p>\n\n<pre><code>  scanf(\" %c\", &amp;tag[i].owner);    // if tag[i].owner is a char, just in case\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1551, "user_id": 4727360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/641b8a5386aa6c8c271b382292cf5b98?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4727360/ian"}, "is_accepted": false, "score": 0, "last_activity_date": 1429124942, "creation_date": 1429124942, "answer_id": 29658746, "question_id": 29658685, "link": "https://stackoverflow.com/questions/29658685/c-skipping-one-command-of-a-function/29658746#29658746", "title": "C skipping one command of a function?", "body": "<p>%c is the specifier for a character, you're trying to input a string, not a character.  <a href=\"http://www.cplusplus.com/reference/cstdio/scanf/\" rel=\"nofollow\">See scanf documentation</a>.  What you want to use is the %s specifier for a string.</p>\n"}], "owner": {"reputation": 871, "user_id": 3680879, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c861be432fd7c112b26edb933f2a338a?s=128&d=identicon&r=PG&f=1", "display_name": "Mat Jones", "link": "https://stackoverflow.com/users/3680879/mat-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 1, "closed_date": 1552558269, "accepted_answer_id": 29658742, "answer_count": 2, "score": 2, "last_activity_date": 1437698828, "creation_date": 1429124725, "last_edit_date": 1437698828, "question_id": 29658685, "link": "https://stackoverflow.com/questions/29658685/c-skipping-one-command-of-a-function", "closed_reason": "Duplicate", "title": "C skipping one command of a function?", "body": "<p>I am programming a simulation, and when the user chooses to create a new tag, the user is supposed to enter a tag ID, the tag's owner, and the object the tag represents. What the program is doing is just skipping over command that scans for the owner, and I'm not quite sure why. My codes are below (the functions are in iotlib.cpp):</p>\n\n<p>iotlib.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#define MAX 20\n\nstruct tagInfo\n{\n    char owner[MAX];\n    char object[MAX];\n    int id;\n};\nstruct tre //TRE = Tag Read Event\n{\n    int id;\n    char node[MAX];\n    int dx;\n};\nvoid initTag(struct tagInfo tag[], int numTags)\n{\n    for(int i=0; i&lt;numTags; i++)\n    {\n        printf(\"Enter the tag ID number: \");\n        scanf(\"%i\", &amp;tag[i].id);\n        printf(\"Enter owner of tag: \");\n        scanf(\"%c\", &amp;tag[i].owner);\n        printf(\"Enter the object the tag is attached to: \");\n        scanf(\"%c\", &amp;tag[i].object);\n    }\n}\n\nvoid generateTRE(struct tre event[], int numEvents)\n{\n    for(int i=0; i&lt;numEvents; i++)\n        {\n            printf(\"Enter tag ID: \");\n            scanf(\"%i\", &amp;event[i].id);\n            printf(\"Enter node: \");\n            scanf(\"%c\", &amp;event[i].node);\n            printf(\"Enter distance from node as an integer number of feet: \");\n            scanf(\"%c\", &amp;event[i].dx);\n        }\n}\n\nvoid triangulationSimulate(struct tre event1, struct tre event2, int numEvents)\n{\n    if(numEvents&gt;1 &amp;&amp; event1.id==event2.id)\n    {\n        printf(\"Node %c\", event1.node);\n        for(int i=0; i&lt;event1.dx; i++)\n        {\n            printf(\" \");\n        }\n\n        printf(\"Tag %i\", event1.id);\n\n        for(int i=0; i&lt;event2.dx; i++)\n        {\n            printf(\" \");\n        }\n\n        printf(\"Node %c\", event2.node);\n    }\n}\n\nvoid getTagInfo(struct tagInfo tag)\n{\n    printf(\"The tag with ID %i represents a/an %c belonging to %c\", tag.id, tag.object, tag.owner);\n}\n</code></pre>\n\n<p>main.cpp</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;math.h&gt;\n#include \"iotlib.cpp\"\n\nvoid execute();\n\nint main(void)\n{\n    execute();\n\n\n    return 0;\n}\n\nvoid execute()\n{\n    struct tagInfo tags[5];\n    struct tre events[5];\n    int choice, numTags, numEvents;\n    printf(\"!Simulation supports a maximum of 5 tags and 5 nodes!\\n\\n\");\n    printf(\"Choose a function by entering it's number:\\n1. Create tags\\n2. Generate Tag Read Events\\n3. Triangulate tag\\n4. Recall tag metadata\\n\\n\");\n    scanf(\"%i\", &amp;choice);\n    if(choice==1)\n    {\n        printf(\"Enter the number of tags to initialize (max of 5): \");\n        scanf(\"%i\", &amp;numTags);\n        if(numTags&lt;1 || numTags&gt;5)\n        {\n            printf(\"Invalid datum.\\n\");\n        }\n        else\n        {\n            initTag(tags, numTags);\n        }\n    }\n    else if(choice==2)\n    {\n        printf(\"Enter the number of TRE's to be generated (max of 5: \");\n        scanf(\"%i\", &amp;numEvents);\n        if(numEvents&lt;1 || numEvents&gt;5)\n        {\n            printf(\"Invalid datum.\\n\");\n        }\n        else\n        {\n            generateTRE(events, numEvents);\n        }\n    }\n    else if(choice==3)\n    {\n        int eventX, eventY;\n        printf(\"Enter two existing TRE numbers to use, separated by a space: \");\n        scanf(\"%i %i\", &amp;eventX, &amp;eventY);\n        triangulationSimulate(events[eventX], events[eventY], numEvents);\n    }\n    else if(choice==4)\n    {\n        int tagNum;\n        printf(\"Enter a tag number: \");\n        scanf(\"%i\", &amp;tagNum);\n        getTagInfo(tags[tagNum-1]);\n    }\n    else\n    {\n        printf(\"Invalid selection.\\n\");\n    }\n\n    execute();\n}\n</code></pre>\n"}, {"tags": ["c", "function", "pointers", "pass-by-value"], "comments": [{"owner": {"reputation": 26583, "user_id": 1441, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fb7f1cd450084fdb4bfc9376c7dba2a7?s=128&d=identicon&r=PG", "display_name": "crashmstr", "link": "https://stackoverflow.com/users/1441/crashmstr"}, "edited": false, "score": 0, "creation_date": 1429124598, "post_id": 29658614, "comment_id": 47456892, "body": "You need to pass the <i>address</i> of your <code>char *pSrc</code> so you can modify what <code>pSrc</code> points to (keep <code>char *pSrc</code>, pass it as <code>&amp;pSrc</code>, and have the function take a <code>char **</code>."}], "answers": [{"tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 12, "last_activity_date": 1429124558, "creation_date": 1429124558, "answer_id": 29658643, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function/29658643#29658643", "title": "Updating pointers in a function", "body": "<p>The pointer inside the function is a copy of the passed pointer.</p>\n\n<p>They both <strong>hold</strong> the same address but have different addresses, so changing the address held by one of them doesn't affect the other.</p>\n\n<p>If you want to increment the pointer inside the function pass it's address instead, like this</p>\n\n<pre><code>static void func(char **pSrc) {\n    int x;\n    for ( x = 0; x &lt; 10; x++ ) {\n        (*pSrc)++;\n    }    \n    printf(\"Pointer Within Function: %p\\n\", pSrc  );\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>func(&amp;pSrc);\n</code></pre>\n\n<p>Also, be careful not to modify the contents, because your pointer points to a string literal, and string literals cannot be modified.</p>\n"}, {"comments": [{"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429125566, "post_id": 29658644, "comment_id": 47457483, "body": "C also uses pass by reference, does it not?"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429125600, "post_id": 29658644, "comment_id": 47457506, "body": "@ryyker is it so? how, please? Atleast, i my knowledge, it does not."}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429125776, "post_id": 29658644, "comment_id": 47457628, "body": "The correct statement I believe would be <i>With the exception of arrays and functions, C always passes arguments by value</i> .  ( <b><i><a href=\"http://www.maths.cam.ac.uk/undergrad/catam/ccatsl/manual/node50.html\" rel=\"nofollow noreferrer\">from here</a></i></b> , for example )  I understand the point of your answer, and have no real problem with it, only this one point :)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429125894, "post_id": 29658644, "comment_id": 47457723, "body": "@ryyker I got your point, but I don&#39;t agree with your words. In case of arrays also, the <i>paramater</i> itself is passed by value only. Can you change the base address of an array (considering a double pointer) from inside a function? :-)"}, {"owner": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429126162, "post_id": 29658644, "comment_id": 47457907, "body": "By the same token, are you saying that if I pass a pointer to a struct that the values of the members of that struct are included?  They are not, but can be accessed via the <i>reference</i> to location of that struct.  Here is <b><i><a href=\"http://courses.washington.edu/css342/zander/css332/passby.html\" rel=\"nofollow noreferrer\">another reference</a></i></b> that goes into more detail."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 20255, "user_id": 645128, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/G0V8Q.jpg?s=128&g=1", "display_name": "ryyker", "link": "https://stackoverflow.com/users/645128/ryyker"}, "edited": false, "score": 0, "creation_date": 1429126384, "post_id": 29658644, "comment_id": 47458032, "body": "@ryyker absolutely not, please don&#39;t get me wrong. I&#39;m not a native English speaker, so my wordings may be confusing. What i try to tell is that the &quot;value at the address&quot; is passed by reference, but the &quot;value&quot; itself  (the structure pointer, or the double pointer in our case) is passed by value."}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": false, "score": 2, "last_activity_date": 1429125795, "last_edit_date": 1429125795, "creation_date": 1429124565, "answer_id": 29658644, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function/29658644#29658644", "title": "Updating pointers in a function", "body": "<p><code>C</code> uses <em>pass-by-value</em> for function parameter passing. The value of <code>pSrc</code> is just a <em>copy</em> of the <code>pSrc</code> present in <code>main()</code>, not the <em>same entity</em> as the <code>pSrc</code> from <code>main()</code>. That is why, any changes made to <code>pSrc</code> inside the function <code>func()</code>won't be reflected in <code>main()</code> (caller function). </p>\n\n<p>However, all the changes to <code>*pSrc</code> will sustain.</p>\n\n<p>Solution: To change the <code>pSrc</code> of <code>main()</code> from <code>func()</code>, you need to pass a pointer to <code>pSrc</code> (pointer to a pointer) from <code>main()</code> and adjust the data types accordingly. Also, in that case, please note, the <code>pSrc</code> should be modifiable (present in read-write memory). As it is currently written, the <code>pSrc</code> in <code>main()</code> is not modifiable.</p>\n"}, {"tags": [], "owner": {"reputation": 1602, "user_id": 1716310, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/24ff82e0962f79caedf7011c505ef136?s=128&d=identicon&r=PG", "display_name": "Btc Sources", "link": "https://stackoverflow.com/users/1716310/btc-sources"}, "is_accepted": false, "score": 2, "last_activity_date": 1429124660, "creation_date": 1429124660, "answer_id": 29658668, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function/29658668#29658668", "title": "Updating pointers in a function", "body": "<p>When you give a pointer to a function, you have a copy of the reference value that you originally had.</p>\n\n<p>Then, if you modify your pointer, <strong>you're modifying a copy</strong>.</p>\n\n<p>If you want to update the original one, you need to pass it with a double pointer <code>**</code> which will let you modify the original pointer, passing a \"reference to a reference\" (double pointer).</p>\n"}, {"tags": [], "owner": {"reputation": 7817, "user_id": 4789373, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh6.googleusercontent.com/-f_OQrxbHhFQ/AAAAAAAAAAI/AAAAAAAAABA/NY38t7ooQ5c/photo.jpg?sz=128", "display_name": "FalconUA", "link": "https://stackoverflow.com/users/4789373/falconua"}, "is_accepted": false, "score": 1, "last_activity_date": 1429124969, "creation_date": 1429124969, "answer_id": 29658754, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function/29658754#29658754", "title": "Updating pointers in a function", "body": "<p>C is passing parameters by value, so it makes a copy of pSrc inside your function, and all the changes you've made are applied to a copy of pSrc. If you want to change the value of pSrc, then you should pass a pointer to pSrc, like this:</p>\n\n<pre><code>static void func(char **pSrc){ // pointer to char*\n     int x;\n     for (x = 0; x &lt; 10; x++)\n         (*pSrc)++\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3265, "user_id": 2606938, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7gIUB.jpg?s=128&g=1", "display_name": "Prabhu", "link": "https://stackoverflow.com/users/2606938/prabhu"}, "is_accepted": false, "score": 1, "last_activity_date": 1429127437, "last_edit_date": 1429127437, "creation_date": 1429125730, "answer_id": 29658989, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function/29658989#29658989", "title": "Updating pointers in a function", "body": "<p>You call <code>func</code> by passing <code>pSrc</code>. You think you are passing the same variable - That is <code>func</code> will operate on the same memory location when it alters <code>pSrc</code>. This is false. </p>\n\n<p><code>func</code> gets a copy of <code>pSrc</code>. The stack frame built in calling <code>func</code> will have its own <code>pSrc</code>. What is modified is its version not the calling function's. </p>\n\n<p>To let <code>func</code> operate on the actual variable in main you got to pass address of <code>pSrc</code> - <code>&amp;pSrc</code>.</p>\n\n<p>Relevant concepts - Pass by Value and Pass by Reference.</p>\n"}], "owner": {"reputation": 103, "user_id": 4793489, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/861c918b1fec3652bbea873a9d10f29c?s=128&d=identicon&r=PG&f=1", "display_name": "asicman", "link": "https://stackoverflow.com/users/4793489/asicman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10157, "favorite_count": 1, "accepted_answer_id": 29658643, "answer_count": 5, "score": 9, "last_activity_date": 1429127437, "creation_date": 1429124439, "last_edit_date": 1429125293, "question_id": 29658614, "link": "https://stackoverflow.com/questions/29658614/updating-pointers-in-a-function", "title": "Updating pointers in a function", "body": "<p>I am passing a pointer a function that updates it. However when the function returns the pointer it returns to the value it had prior to the function call.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nstatic void func(char *pSrc) {\n    int x;\n    for ( x = 0; x &lt; 10; x++ ) {\n        *pSrc++;\n    }\n\n    printf(\"Pointer Within Function: %p\\n\", pSrc  );\n}\n\nint main(void) {\n\n    char *pSrc = \"Good morning Dr. Chandra. This is Hal. I am ready for my first lesson.\";\n\n    printf(\"Pointer Value Before Function: %p\\n\", pSrc  );\n\n    func(pSrc);\n\n    printf(\"Pointer Value After Function: %p\\n\", pSrc  );\n\n    return EXIT_SUCCESS;\n}\n</code></pre>\n\n<p>Here is the output</p>\n\n<pre><code>Pointer Value Before Function: 0x100403050\nPointer Within Function: 0x10040305a\nPointer Value After Function: 0x100403050\n</code></pre>\n\n<p>What I was expecting was the value after the function to match the one from within the function.</p>\n\n<p>I tried switching to <code>char **pSrc</code> but that did not have the desired affect.</p>\n\n<p>I am sure the answer is fairly simple, but I am a recovering hardware engineer and can't seem to figure it out :-)</p>\n"}, {"tags": ["c", "string"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 1, "creation_date": 1429123965, "post_id": 29658418, "comment_id": 47456495, "body": "Huh? Why don&#39;t you provide a simple example of what you&#39;re trying to do, along with the code you&#39;ve written, and an explanation of why that code isn&#39;t meeting your needs."}, {"owner": {"reputation": 4005, "user_id": 4200092, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/saOd8.png?s=128&g=1", "display_name": "GoBusto", "link": "https://stackoverflow.com/users/4200092/gobusto"}, "edited": false, "score": 2, "creation_date": 1429123975, "post_id": 29658418, "comment_id": 47456502, "body": "Hi, could you please <a href=\"http://stackoverflow.com/posts/29658418/edit\">edit your question</a> so that it <a href=\"http://stackoverflow.com/help/mcve\">includes the code</a> so that we can see what you&#39;re talking about?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1429124056, "post_id": 29658418, "comment_id": 47456561, "body": "You&#39;ll need to double up the \\ characters when declaring anything literal in a string, such as say <code>echo C:\\\\myfile.txt</code>, and the <code>%</code> characters too."}, {"owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "edited": false, "score": 0, "creation_date": 1429124303, "post_id": 29658418, "comment_id": 47456706, "body": "You can work with the string directly. Loop through each position of the character array and if you have a special character then just replace it with something else using a switch-case. You can replace it with a whitespace for example."}, {"owner": {"reputation": 3, "user_id": 4793448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b5762ac5307f05ea246407b4adb0b6?s=128&d=identicon&r=PG&f=1", "display_name": "MuchMemezMuchWow", "link": "https://stackoverflow.com/users/4793448/muchmemezmuchwow"}, "edited": false, "score": 0, "creation_date": 1429124362, "post_id": 29658418, "comment_id": 47456756, "body": "what about &quot; and &#39; and &amp; etc is there any documentation on how to cancel each character?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1429124886, "post_id": 29658418, "comment_id": 47457061, "body": "Is this previous answer any help as a reference? In the absence of any detailed requirement, it&#39;s &quot;whistling in the wind&quot;. <a href=\"http://stackoverflow.com/questions/29316718/how-to-run-and-modify-a-cmd-script-or-file-in-c/29316880#29316880\" title=\"how to run and modify a cmd script or file in c\">stackoverflow.com/questions/29316718/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2556, "user_id": 3488231, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/da4ac79b71c44d696f3567d4b53f6239?s=128&d=identicon&r=PG&f=1", "display_name": "user12205", "link": "https://stackoverflow.com/users/3488231/user12205"}, "reply_to_user": {"reputation": 3, "user_id": 4793448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b5762ac5307f05ea246407b4adb0b6?s=128&d=identicon&r=PG&f=1", "display_name": "MuchMemezMuchWow", "link": "https://stackoverflow.com/users/4793448/muchmemezmuchwow"}, "edited": false, "score": 2, "creation_date": 1429124539, "post_id": 29658473, "comment_id": 47456856, "body": "@MuchMemezMuchWow You don&#39;t have to do it manually - you can write another program to do it."}], "tags": [], "owner": {"reputation": 1551, "user_id": 4727360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/641b8a5386aa6c8c271b382292cf5b98?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4727360/ian"}, "is_accepted": true, "score": 1, "last_activity_date": 1429123971, "creation_date": 1429123971, "answer_id": 29658473, "question_id": 29658418, "link": "https://stackoverflow.com/questions/29658418/c-program-to-store-special-characters-in-strings/29658473#29658473", "title": "C program to store special characters in strings", "body": "<p>You have to escape special characters with a \\, you can escape backslash itself with another backslash (i.e. <code>\\\\</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "is_accepted": false, "score": 1, "last_activity_date": 1429125323, "last_edit_date": 1429125323, "creation_date": 1429124874, "answer_id": 29658728, "question_id": 29658418, "link": "https://stackoverflow.com/questions/29658418/c-program-to-store-special-characters-in-strings/29658728#29658728", "title": "C program to store special characters in strings", "body": "<p>As Ian previously mentioned, you can escape characters that aren't allowed in normal C strings with <code>\\</code>; for instance, newline becomes <code>\\n</code>, double-quote becomes <code>\\\"</code>, and backslash becomes <code>\\\\</code>.  </p>\n\n<p>If you're unable or unwilling to do this for whatever reason, then you may be out of luck if you're solution must be in C.  However, if you're willing to switch to C++, then you can use <a href=\"http://en.cppreference.com/w/cpp/language/string_literal\" rel=\"nofollow\">raw strings</a>:</p>\n\n<pre><code>const char* s1 = R\"foo(\nHello\nWorld\n)foo\";\n</code></pre>\n\n<p>This is equivalent to</p>\n\n<pre><code>const char* s2 = \"\\nHello\\nWorld\\n\";\n</code></pre>\n\n<p>A raw string must begin with <code>R\"</code> followed by an arbitrary delimiter (made of any source character but parentheses, backslash and spaces; can be empty; and at most 16 characters long), then <code>(</code>, and must end with <code>)</code> followed by the delimiter and <code>\"</code>.  The delimiter must be chosen such that the termination substring (<code>)</code>, delimiter, <code>\"</code>) does not appear within the string.</p>\n"}], "owner": {"reputation": 3, "user_id": 4793448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b5762ac5307f05ea246407b4adb0b6?s=128&d=identicon&r=PG&f=1", "display_name": "MuchMemezMuchWow", "link": "https://stackoverflow.com/users/4793448/muchmemezmuchwow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3630, "favorite_count": 0, "accepted_answer_id": 29658473, "answer_count": 2, "score": 0, "last_activity_date": 1429212900, "creation_date": 1429123759, "last_edit_date": 1429123816, "question_id": 29658418, "link": "https://stackoverflow.com/questions/29658418/c-program-to-store-special-characters-in-strings", "title": "C program to store special characters in strings", "body": "<p>Basically, I can't figure this out, I want my C program to store the entire plaintext of a batch program then insert in a file and then run. </p>\n\n<p>I finished my program, but holding the contents is my problem. How do I insert the code in a string and make it ignore ALL special characters like %s \\ etc?</p>\n"}, {"tags": ["c", "gcc", "ld"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 7, "creation_date": 1429123842, "post_id": 29658401, "comment_id": 47456417, "body": "Remove the <code>static</code> keyword from your prototype on <code>AcquireStandard()</code> in the header... it&#39;s no longer a static function."}, {"owner": {"reputation": 391, "user_id": 2196676, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MCHaA.jpg?s=128&g=1", "display_name": "Maxwell Bottiger", "link": "https://stackoverflow.com/users/2196676/maxwell-bottiger"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429124089, "post_id": 29658401, "comment_id": 47456581, "body": "That got it, thanks!"}, {"owner": {"reputation": 391, "user_id": 2196676, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MCHaA.jpg?s=128&g=1", "display_name": "Maxwell Bottiger", "link": "https://stackoverflow.com/users/2196676/maxwell-bottiger"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429124116, "post_id": 29658401, "comment_id": 47456598, "body": "If you post that as an answer, I&#39;ll mark it as correct."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429124208, "post_id": 29658401, "comment_id": 47456656, "body": "I appreciate the thought on that -- but I think the question should actually be closed/deleted as being just a typo and unlikely to help others in the future. (Others could certainly end up having a similar problem, but there&#39;s practically no chance of them stumbling across this question when trying to solve it.) I&#39;m glad you&#39;ve got past the issue though!"}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429124968, "post_id": 29658401, "comment_id": 47457102, "body": "@mah: I don&#39;t agree on that. Just because this is a rather rare problem, it&#39;s not said it might not help others. Actually, refactoring (which this is all about) is a pretty common (and desireable) task that others may thankful about any pointers if gone wrong."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429125381, "post_id": 29658401, "comment_id": 47457361, "body": "Well, I&#39;ll provide it as an answer then..."}], "answers": [{"tags": [], "owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "is_accepted": true, "score": 1, "last_activity_date": 1429125474, "creation_date": 1429125474, "answer_id": 29658914, "question_id": 29658401, "link": "https://stackoverflow.com/questions/29658401/gcc-returns-undefined-reference-when-breaking-up-a-c-program-into-multiple-files/29658914#29658914", "title": "gcc returns undefined reference when breaking up a C program into multiple files", "body": "<p>The problem here is that the <code>AcquireStandard()</code> function was originally prototyped to be <code>static</code>, meaning its visibility was constrained to the file it was implemented in. In this refactoring, the function's visibility is required to reach out to other sources -- but the header still has the <code>static</code> keyword on the function.</p>\n\n<p>Notice also the output of the <code>nm</code> command, specifically the differences between these two lines representing functions in the source:</p>\n\n<pre><code>00000000 t AcquireStandard\n00000489 T setFullFrame\n</code></pre>\n\n<p>The <code>T</code> indicates a function in the object's text that has global visibility, while the <code>t</code> tells you the visibility is local.</p>\n\n<p>Remove <code>static</code> on the prototype in <code>capture.h</code> and the problem will be solved.</p>\n"}], "owner": {"reputation": 391, "user_id": 2196676, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/MCHaA.jpg?s=128&g=1", "display_name": "Maxwell Bottiger", "link": "https://stackoverflow.com/users/2196676/maxwell-bottiger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 29658914, "answer_count": 1, "score": 1, "last_activity_date": 1429190194, "creation_date": 1429123709, "last_edit_date": 1429190194, "question_id": 29658401, "link": "https://stackoverflow.com/questions/29658401/gcc-returns-undefined-reference-when-breaking-up-a-c-program-into-multiple-files", "title": "gcc returns undefined reference when breaking up a C program into multiple files", "body": "<p>I've been provided a sample C file and I'd like to break it up into a pair of .c files and a .h file.  I'm having trouble getting the program to compile after splitting everything, but I think it's a simple solution.  My C is just rusty.</p>\n\n<p><strong>capture.h</strong></p>\n\n<pre><code>#ifndef __CAPTURE_H\n#define __CAPTURE_H\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;memory.h&gt;\n#include \"master.h\"\n#include \"pvcam.h\"\n\nstatic void AcquireStandard( int16 hCam, int16 num_frames, uns32 exp_time );\nvoid setROI( rgn_type* roi, uns16 s1, uns16 s2, uns16 sbin, uns16 p1, uns16 p2, uns16 pbin );\nvoid printROI( int16 roi_count, rgn_type* roi );\nvoid print_pv_error( );\nvoid setFullFrame( int16 hcam, rgn_type* roi );\n#endif\n</code></pre>\n\n<p><strong>capture.c</strong></p>\n\n<pre><code>#include \"capture.h\"\n\nvoid AcquireStandard( int16 hCam, int16 num_frames, uns32 exp_time ) {\n... Does lots of stuff ...\n}\n... Many other functions, etc...\n</code></pre>\n\n<p><strong>pixis.c</strong></p>\n\n<pre><code>    #include \"capture.h\"\n\n    int main(int argc, char **argv)\n    {\n        char cam_name[CAM_NAME_LEN];    /* camera name                    */\n        int16 hCam;                     /* camera handle                  */\n        int16 cam_selection;\n        int16 num_frames, circ_buff_size, buffer_type;\n        uns32 port, shtr_open_mode;\n        uns32 enum_param, exp_time;\n        int16 adc_index;\n        int16 gain;\n        uns16 exp_res_index;\n        char *s;\n        ..... snip .....\n        AcquireStandard( hCam, num_frames, exp_time );\n        pl_cam_close( hCam );\n    pl_pvcam_uninit();\n    return 0;\n}\n</code></pre>\n\n<p>I snipped out a lot of irrelevant stuff.  When I compile, I get the following error:</p>\n\n<pre><code>gcc -o pixis pixis.o capture.o -I/usr/local/pvcam/examples -lpvcam -ldl -lpthread -lraw1394\npixis.o: In function `main':\npixis.c:(.text+0x14a): undefined reference to `AcquireStandard'\ncollect2: ld returned 1 exit status\nmake: *** [pixis] Error 1\n</code></pre>\n\n<p>AcquireStandard is in the .o file, I checked it with nm:</p>\n\n<pre><code>    nm capture.o \n00000000 t AcquireStandard\n00000000 d _master_h_\n00000004 d _pvcam_h_\n         U fclose\n         U fopen\n         U free\n         U fwrite\n         U malloc\n         U pl_error_code\n         U pl_error_message\n         U pl_exp_check_status\n         U pl_exp_finish_seq\n         U pl_exp_init_seq\n         U pl_exp_setup_seq\n         U pl_exp_start_seq\n         U pl_exp_uninit_seq\n         U pl_get_param\n00000350 T printROI\n00000440 T print_pv_error\n         U printf\n         U puts\n00000489 T setFullFrame\n000002d4 T setROI\n</code></pre>\n\n<p>Now I'm stumped.  Did something change in gcc in the last few years or did I just forget some simple detail?</p>\n"}, {"tags": ["c++", "c", "matrix-multiplication", "blas"], "comments": [{"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1429125637, "post_id": 29658349, "comment_id": 47457527, "body": "That&#39;s a runtime error about values in <code>A</code>? What does <code>initM(A,B,C)</code> do? How does it know what size the arrays are?"}, {"owner": {"reputation": 645, "user_id": 4034274, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23ec632d96dcede141d4d110a49bcd01?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet S. Chauhan", "link": "https://stackoverflow.com/users/4034274/puneet-s-chauhan"}, "reply_to_user": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1429159240, "post_id": 29658349, "comment_id": 47469971, "body": "@WeatherVane  i have added the initM function body, size of array is substituted at preprocessing phase!"}], "answers": [{"comments": [{"owner": {"reputation": 645, "user_id": 4034274, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23ec632d96dcede141d4d110a49bcd01?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet S. Chauhan", "link": "https://stackoverflow.com/users/4034274/puneet-s-chauhan"}, "edited": false, "score": 1, "creation_date": 1429159857, "post_id": 29659878, "comment_id": 47470154, "body": "tried your suggestion ; now i am getting <b>On entry to SGEMM parameter number 13 had an illegal value</b>!"}], "tags": [], "owner": {"reputation": 3112, "user_id": 2707697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f9da9a865b63faae8438d2d57c1c71b9?s=128&d=identicon&r=PG&f=1", "display_name": "ztik", "link": "https://stackoverflow.com/users/2707697/ztik"}, "is_accepted": true, "score": 2, "last_activity_date": 1429167319, "last_edit_date": 1429167319, "creation_date": 1429128425, "answer_id": 29659878, "question_id": 29658349, "link": "https://stackoverflow.com/questions/29658349/on-entry-to-sgemm-parameter-number-8-had-an-illegal-value/29659878#29659878", "title": "On entry to SGEMM parameter number 8 had an illegal value", "body": "<p>The error message is produced by <code>sgemm</code> and not <code>cblas_sgemm</code>. The number 8 parameter of <code>sgemm</code> is :</p>\n\n<blockquote>\n  <p>SUBROUTINE SGEMM(TRANSA, TRANSB, M, N, K, ALPHA, A, <strong>LDA</strong>, B, LDB, BETA, C, LDC)</p>\n</blockquote>\n\n<p>The C function cblas_sgemm is just a wrapper calling the Fortran routine sgemm. Bascally it converts some arguments passed from <code>by value</code> to <code>by reference</code>. Also, the Fortran routine is missing \"RowMajor\" parameter.</p>\n\n<p>Since you are using \"RowMajor\" storage, you should use the number of columns as the leading dimension of the matrices.</p>\n\n<p>Even if I can not test it, I suggest:</p>\n\n<pre><code>cblas_sgemm(CblasRowMajor, CblasNoTrans,CblasNoTrans,A_R, B_C, A_C, 1.0, A, A_C, B, B_C, 0.0, C, B_C);\n</code></pre>\n\n<p>Also, you can refer to GSL <a href=\"https://www.gnu.org/software/gsl/manual/html_node/GSL-CBLAS-Examples.html\" rel=\"nofollow\">example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 293, "user_id": 2857475, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/92fae34f531d4a8b63ed4995001de268?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet S. Chauhan", "link": "https://stackoverflow.com/users/2857475/puneet-s-chauhan"}, "is_accepted": false, "score": 1, "last_activity_date": 1429162193, "last_edit_date": 1429162193, "creation_date": 1429161844, "answer_id": 29665967, "question_id": 29658349, "link": "https://stackoverflow.com/questions/29658349/on-entry-to-sgemm-parameter-number-8-had-an-illegal-value/29665967#29665967", "title": "On entry to SGEMM parameter number 8 had an illegal value", "body": "<p>Slight modification to ctheo's answer:</p>\n\n<pre><code>A[A_R][A_C] X B[B_R][B_C]=C[A_R][B_C] //if (A_C==B_R)\n</code></pre>\n\n<p>so, on setting the last parameter as <strong>LDC</strong>=B_C , the code works fine</p>\n\n<pre><code>cblas_sgemm(CblasRowMajor, CblasNoTrans,CblasNoTrans,A_R, B_C,A_C,1.0, A,A_C, B, B_C,0.0, C,   B_C  );\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 4034274, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/23ec632d96dcede141d4d110a49bcd01?s=128&d=identicon&r=PG&f=1", "display_name": "Puneet S. Chauhan", "link": "https://stackoverflow.com/users/4034274/puneet-s-chauhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6617, "favorite_count": 2, "accepted_answer_id": 29659878, "answer_count": 2, "score": 3, "last_activity_date": 1456656458, "creation_date": 1429123587, "last_edit_date": 1495540882, "question_id": 29658349, "link": "https://stackoverflow.com/questions/29658349/on-entry-to-sgemm-parameter-number-8-had-an-illegal-value", "title": "On entry to SGEMM parameter number 8 had an illegal value", "body": "<p>I am trying to explore cblas library ; so i tried 2d matrix multiplication using Level3 <strong>cblas_sgemm</strong> routine.</p>\n\n<pre><code>C=(alpha)* A * B + (beta) * C\n;; where aplha=1 &amp; beta=0\n</code></pre>\n\n\n\n<pre><code>#define TYPE float\n#define A_R 3\n#define A_C 2\n#define B_R 2\n#define B_C 3\n\n    int main()\n    {\n        TYPE *A=NULL,*B=NULL,*C=NULL;\n        if(A_C != B_R)\n                {\n                printf(\"\\nA(%d,%d) X B(%d,%d) not possible\\n\",A_R,A_C,B_R,B_C);\n                exit(1);\n                }\n\n        A=(TYPE*)malloc(A_R*A_C*sizeof(TYPE));\n        B=(TYPE*)malloc(B_R*B_C*sizeof(TYPE));\n        C=(TYPE*)malloc(A_R*B_C*sizeof(TYPE));\n        initM(A,B,C);//initializes matrix\n        cblas_sgemm(CblasRowMajor, CblasNoTrans,CblasNoTrans,A_R, B_C,A_C, 1.0, A,A_R, B, B_R,0.0, C, A_C);\n        //multiply(A,B,C);\n\n        printf(\"\\n%f\\n\",C[ (A_R*B_C)-1]);\n}\n</code></pre>\n\n<p>I compiled my program using static libraries :</p>\n\n<pre><code>gcc mxm_blas.c -L/CBLAS/lib/ -lcblas -L/BLAS/ -lblas -I/CBLAS/include/ -lgfortran\n</code></pre>\n\n<p>Now running the code, i get :</p>\n\n<blockquote>\n  <p><strong>On entry to SGEMM parameter number  8 had an illegal value</strong></p>\n</blockquote>\n\n<p>It seems to me that trouble is with the way of declaring array! Most of the examples  <a href=\"https://stackoverflow.com/questions/3747720/cblas-dgemm-works-only-if-beta-is-power-of-two\">i have seen</a> declare array as:</p>\n\n<pre><code>float A[100][100],b[100][100],C[100][100];\n</code></pre>\n\n<p>Is this the cause of the error or there is a programmatic error? Is malloc based matrix multiplication via the sgemm API not possible?</p>\n\n<p><strong>UPDATE:</strong> initM initializes the matrix :</p>\n\n<pre><code>void initM(TYPE* A,TYPE* B,TYPE* C)\n{\nlong int i,j;\n\nj=A_R*A_C;\nfor(i=0;i&lt;j;i++) A[i]=2;\n\nj=B_R*B_C;\nfor(i=0;i&lt;j;i++)  B[i]=3;\n\nj=A_R*B_C;\nfor(i=0;i&lt;j;i++)  C[i]=0;\n }\n</code></pre>\n"}, {"tags": ["c", "visual-studio-2013", "ide"], "comments": [{"owner": {"reputation": 811, "user_id": 4406558, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hRu3_v7-VLc/AAAAAAAAAAI/AAAAAAAAAAA/N5zpUylxl1g/photo.jpg?sz=128", "display_name": "Eric Hughes", "link": "https://stackoverflow.com/users/4406558/eric-hughes"}, "edited": false, "score": 0, "creation_date": 1429123658, "post_id": 29658290, "comment_id": 47456295, "body": "Can you add a new template, as you can do in VS 2010?  See <a href=\"http://stackoverflow.com/questions/3368798/add-c-file-to-visual-studio\" title=\"add c file to visual studio\">stackoverflow.com/questions/3368798/add-c-file-to-visual-stu&zwnj;&#8203;dio</a>"}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1429125053, "post_id": 29658290, "comment_id": 47457155, "body": "simply change the file name to have a &#39;.c&#39; extension rather than a &#39;.cpp&#39; extension"}, {"owner": {"reputation": 2544, "user_id": 2300614, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfb77e897bb239233e4a37bc0505bcb7?s=128&d=identicon&r=PG&f=1", "display_name": "dns", "link": "https://stackoverflow.com/users/2300614/dns"}, "edited": false, "score": 0, "creation_date": 1588956905, "post_id": 29658290, "comment_id": 109109415, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/3368798/add-c-file-to-visual-studio\">Add C file to Visual Studio</a>"}], "answers": [{"comments": [{"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 1, "creation_date": 1429123739, "post_id": 29658394, "comment_id": 47456337, "body": "Related blog post : <a href=\"http://herbsutter.com/2012/05/03/reader-qa-what-about-vc-and-c99/\" rel=\"nofollow noreferrer\">herbsutter.com/2012/05/03/reader-qa-what-about-vc-and-c99</a>"}], "tags": [], "owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "is_accepted": false, "score": 1, "last_activity_date": 1429123752, "last_edit_date": 1429123752, "creation_date": 1429123700, "answer_id": 29658394, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013/29658394#29658394", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>Short answer: you can't.</p>\n\n<p>Visual C++ is a C++ IDE backed by a C++ compiler.  It supports the common subset of C and C++ (because it is also valid C++), but does not directly support C.  It only partially supports C99.  So there is no way to add a file that will be compiled as C99 to a project.</p>\n"}, {"tags": [], "owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "is_accepted": false, "score": -1, "last_activity_date": 1429123749, "creation_date": 1429123749, "answer_id": 29658414, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013/29658414#29658414", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>You cannot use Visual Studio to create C programs. You can edit an existing simple C program by creating a new project, selecting Win32 console application, add in the existing files and modify it from there. But there is no from-scratch C support. See <a href=\"http://www.swarthmore.edu/NatSci/tali/E15/Visual_C.html\" rel=\"nofollow\">related</a> for more detail on how to do it.</p>\n"}, {"comments": [{"owner": {"reputation": 5459, "user_id": 3553031, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/b72880023e6290ffd3bf5623ae79bebc?s=128&d=identicon&r=PG&f=1", "display_name": "user3553031", "link": "https://stackoverflow.com/users/3553031/user3553031"}, "edited": false, "score": 0, "creation_date": 1429124973, "post_id": 29658640, "comment_id": 47457106, "body": "Renaming the file to <code>foo.c</code> doesn&#39;t really do anything; it still gets compiled as C++."}], "tags": [], "owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "is_accepted": false, "score": 1, "last_activity_date": 1429124543, "creation_date": 1429124543, "answer_id": 29658640, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013/29658640#29658640", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>this link: <a href=\"http://www.swarthmore.edu/NatSci/tali/E15/Visual_C.html\" rel=\"nofollow\">http://www.swarthmore.edu/NatSci/tali/E15/Visual_C.html</a>\nmay be helpful.</p>\n\n<p>Here is what that link says:</p>\n\n<p>Using Microsoft Visual Studio for Simple C Programs</p>\n\n<p>A free version of Microsoft Visual C++ Express is available in: <a href=\"http://msdn2.microsoft.com/en-us/express/aa700735.aspx\" rel=\"nofollow\">http://msdn2.microsoft.com/en-us/express/aa700735.aspx</a></p>\n\n<p>To edit your C program:</p>\n\n<pre><code>From the main menu select File -&gt; New -&gt; Project\nIn the New Project window:\nUnder Project types, select Win32 - Win32 Console Application\nName your project, and specify a location for your project directory\nClick 'OK', then 'next'\nIn the Application Wizard:\nSelect Console application\nSelect Empty project\nDeselect Precompiled header\nOnce the project has been created, in the window on the left hand side you should see three folders:\nHeader Files\nResource Files\nSource Files\nRight-click on Source Files and Select Add-&gt; New Item\nSelect Code, and give the file a name\nThe default here will be a file with a *.cpp extension (for a C++ file). After creating the file, save it as a *.c file.\n</code></pre>\n\n<p>To compile and run:</p>\n\n<pre><code>Press the green play button.\nBy default, you will be running in debug mode and it will run your code and bring up the command window.\nTo prevent the command window from closing as soon as the program finishes execution, add the following line to the end of your main function:\ngetchar();\nThis library function waits for any input key, and will therefore keep your console window open until a key is pressed.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1550, "user_id": 653991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e58e451dc104f5e48ad56e24f456e1b8?s=128&d=identicon&r=PG", "display_name": "Gerardo Hernandez", "link": "https://stackoverflow.com/users/653991/gerardo-hernandez"}, "is_accepted": true, "score": 0, "last_activity_date": 1442487953, "creation_date": 1442487953, "answer_id": 32628829, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013/32628829#32628829", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>After adding the file to the solution, right-click on it, and in \nC/C++->Advanced->Compile As, click on Compile as C Code (/TC)</p>\n\n<p>Renaming the file is not enough, you need to tell Visual Studio 2013 is a C file. Visual Studio 2013 does not support the C99 standard, but at least it will be using C ABI and you will restrict the compiler to accept C statements only.</p>\n\n<p>Visual Studio 2015 fully implements the C99 Standard Library, with the exception of any library features that depend on compiler features not yet supported by the Visual C++ compiler (for example, <code>&lt;tgmath.h&gt;</code> is not implemented).</p>\n\n<p><a href=\"https://i.stack.imgur.com/6W9QF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6W9QF.png\" alt=\"Visual Studio 2013 C/C++ Advanced options\"></a> </p>\n"}, {"tags": [], "owner": {"reputation": 2544, "user_id": 2300614, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cfb77e897bb239233e4a37bc0505bcb7?s=128&d=identicon&r=PG&f=1", "display_name": "dns", "link": "https://stackoverflow.com/users/2300614/dns"}, "is_accepted": false, "score": 0, "last_activity_date": 1588957190, "creation_date": 1588957190, "answer_id": 61684137, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013/61684137#61684137", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>You can create <strong>new item template</strong> (add <strong>C File</strong> plugin),</p>\n\n<p>You can download: <a href=\"https://bitbucket.org/SiraitX/various-c-library-miscellaneous-projects/downloads/Visual%20Studio%20-%20New%20Item%20Template.zip\" rel=\"nofollow noreferrer\">Visual Studio - New Item Template.zip</a></p>\n\n<p>Extract the ZIP file to:</p>\n\n<pre><code>C:\\Users\\USERNAME\\Documents\\Visual Studio 2013\\Templates\\ItemTemplates\\\n</code></pre>\n\n<p>or (for VS2012):</p>\n\n<pre><code>C:\\Users\\USERNAME\\Documents\\Visual Studio 2013\\Templates\\ItemTemplates\\Visual C++ Project\n</code></pre>\n\n<p>or if you want to put it under \"<strong>Code</strong>\" sub category:</p>\n\n<pre><code>C:\\Users\\USERNAME\\Documents\\Visual Studio 2013\\Templates\\ItemTemplates\\Visual C++ Project\\Code\n</code></pre>\n\n<p>Or you can read this <a href=\"http://tech.pro/tutorial/780/visual-studio-how-to-create-item-templates\" rel=\"nofollow noreferrer\">Tutorial</a> to create custom <strong>item template</strong> for Visual Studio.</p>\n\n<p><img src=\"https://i.stack.imgur.com/0Y0Cn.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 10264, "user_id": 1655700, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/xObp1.png?s=128&g=1", "display_name": "Tyler Durden", "link": "https://stackoverflow.com/users/1655700/tyler-durden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3062, "favorite_count": 0, "accepted_answer_id": 32628829, "answer_count": 5, "score": 4, "last_activity_date": 1588957190, "creation_date": 1429123406, "last_edit_date": 1592644375, "question_id": 29658290, "link": "https://stackoverflow.com/questions/29658290/how-do-i-add-a-new-c-file-in-visual-studio-2013", "title": "How do I add a new C file in Visual Studio 2013", "body": "<p>I am new to Visual Studio 2013, having used 2010 in the past. How do I add a C file? There only seems to be an option for C++. I do not use C++, only C, and I compile to ANSI C99. This is what the dialog box looks like when I pick &quot;Add New Item&quot;:</p>\n<p><img src=\"https://i.stack.imgur.com/MkTJH.png\" alt=\"Visual Studio Add New Item\" /></p>\n<p>As you can see it has choices to add a C++ file or a header file, but not a C file.</p>\n"}, {"tags": ["c", "unix", "semaphore", "ipcs"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429125212, "post_id": 29658201, "comment_id": 47457260, "body": "I believe the problem here is that your first thread calls <code>semop()</code> which will decrement the value to 1, and then wait for the value to become 0, however until that first thread returns from <code>semop()</code> the second one cannot enter it in order to decrement it again. You&#39;ll probably need to break your operations up into multiple semop() calls. I am not positive on this... I&#39;ve never used semop(), I&#39;m just reading the man page."}], "answers": [{"comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429126096, "post_id": 29658903, "comment_id": 47457862, "body": "While a valid comment, this doesn&#39;t answer the question being asked. I admit that his English is not necessarily very clear about what he&#39;s looking for (probably ESL). I believe the problem he&#39;s having is exactly what you&#39;ve confirmed is happening -- the infinite wait. It seems to me that he <code>fork()</code>s with the incorrect expectation of having the wait complete when both threads have decremented the semaphore value -- which I don&#39;t think is possible given his current approach."}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429126931, "post_id": 29658903, "comment_id": 47458379, "body": "@mah, fair enough.  I have updated my answer to explain the reason for the hang, it to suggest a way around it."}, {"owner": {"reputation": 41, "user_id": 4793353, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200267090996128/picture?type=large", "display_name": "Javi Gonz&#225;lez Garc&#237;a", "link": "https://stackoverflow.com/users/4793353/javi-gonz%c3%a1lez-garc%c3%ada"}, "edited": false, "score": 0, "creation_date": 1429127633, "post_id": 29658903, "comment_id": 47458760, "body": "Thanks! But moving the SETVAL before the fork doesn&#39;t solve the probleme of the infinite wait. What more I have to do?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429130049, "post_id": 29658903, "comment_id": 47460157, "body": "I told you already.  Each process must perform the decrement operation and the wait-for-zero operation with <i>separate</i> <code>semop()</code> calls."}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 1, "last_activity_date": 1429126903, "last_edit_date": 1429126903, "creation_date": 1429125439, "answer_id": 29658903, "question_id": 29658201, "link": "https://stackoverflow.com/questions/29658201/semaphores-unix-c-wait-for-zero/29658903#29658903", "title": "Semaphores unix c wait for zero", "body": "<p>Gcc complains to me about your code:</p>\n\n<blockquote>\n  <p>sem.c:37: warning: passing argument 2 of \u2018semop\u2019 from incompatible pointer type\n  /usr/include/sys/sem.h:59: note: expected \u2018struct sembuf *\u2019 but argument is of type \u2018struct sembuf (*)[2]\u2019</p>\n</blockquote>\n\n<p>This is the code it doesn't like:</p>\n\n<pre><code>    if(semop(sem,&amp;sops,2)&lt;0) printf(\"Error semop\\n\");\n</code></pre>\n\n<p>If I change it to</p>\n\n<pre><code>    if(semop(sem,sops,2)&lt;0) printf(\"Error semop\\n\");\n</code></pre>\n\n<p>then GCC does not complain, and the program hangs indefinitely on the <code>semop()</code> call, as I would expect.</p>\n\n<p>In particular, note that <code>semop()</code> applies all the specified operations as an atomic group, or not at all.  Your program could only proceed past the <code>semop()</code> call if the operations specified by the two processes were overlapped, such that the two decrements were performed first, then the two wait-for-zeroes.</p>\n\n<p>Your program works about as you may have expected if I move the <code>SETVAL</code> operation before the <code>fork()</code> call, and have each process perform two separate <code>semop()</code> calls, one to decrement the semaphore, and then one to wait for it to become zero.</p>\n"}], "owner": {"reputation": 41, "user_id": 4793353, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200267090996128/picture?type=large", "display_name": "Javi Gonz&#225;lez Garc&#237;a", "link": "https://stackoverflow.com/users/4793353/javi-gonz%c3%a1lez-garc%c3%ada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1515, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1429126903, "creation_date": 1429123143, "last_edit_date": 1429123389, "question_id": 29658201, "link": "https://stackoverflow.com/questions/29658201/semaphores-unix-c-wait-for-zero", "title": "Semaphores unix c wait for zero", "body": "<p>I am trying to understand how to do a wait for zero operation in unix. I have this code, but it stops waiting always with the same value as given.</p>\n\n<pre><code>int main(void){\n\n    int sem;\n    struct sembuf sops[2];\n\n\n    if((sem = semget(IPC_PRIVATE, 1,  IPC_CREAT | 0600))==-1){\n        perror(\"Error semget\");\n        return 100;\n    }\n\n    fork();\n    //printf(\"Empieza la accion\\n\");\n\n    if(semctl(sem,0,SETVAL,2)==-1){\n        printf(\"Error semctl\\n\");\n        exit(100);\n    }\n    printf(\"Value: %d\\n\",semctl(sem,0,GETVAL));\n    sops[0].sem_num=0;     \n    sops[0].sem_op=-1;     \n    sops[0].sem_flg=0;      \n\n    //WAIT(0)   \n    sops[1].sem_num=0;     \n    sops[1].sem_op=0;     \n    sops[1].sem_flg=0;\n    printf(\"Value: %d\\n\",semctl(sem,0,GETVAL));\n\n    if(semop(sem,&amp;sops,2)&lt;0) printf(\"Error semop\\n\");\n    printf(\"Value: %d\\n\",semctl(sem,0,GETVAL));\n    printf(\"End\\n\");\n\n}\n</code></pre>\n"}, {"tags": ["c", "arrays", "pointers"], "comments": [{"owner": {"reputation": 2346, "user_id": 2549281, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/XpMre.jpg?s=128&g=1", "display_name": "Dabo", "link": "https://stackoverflow.com/users/2549281/dabo"}, "edited": false, "score": 1, "creation_date": 1429123113, "post_id": 29658067, "comment_id": 47455976, "body": "array is not pointer, it decays to pointer at some circumstances, but not in case of <code>sizeof</code>... there a lot of similar questions here with perfect answers"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 2, "creation_date": 1429123944, "post_id": 29658067, "comment_id": 47456481, "body": "<code>%d</code> requires an argument of type <code>int</code>. To print a <code>size_t</code> value, such as the result of <code>sizeof</code>, use <code>%zu</code>."}, {"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 0, "creation_date": 1429131587, "post_id": 29658067, "comment_id": 47461039, "body": "The syntax <code>a[n]</code> is defined to be the same as the syntax <code>*(a+n)</code>. Neither syntax is shown in your code."}], "answers": [{"comments": [{"owner": {"reputation": 4168, "user_id": 3552561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7d0994b2ce09612027ca2b69e6bddd5?s=128&d=identicon&r=PG&f=1", "display_name": "qiubit", "link": "https://stackoverflow.com/users/3552561/qiubit"}, "edited": false, "score": 0, "creation_date": 1429123623, "post_id": 29658212, "comment_id": 47456272, "body": "A question about one of the sentences from this C standard snippet: <code>If the type of the operand is a variable length array type, the operand is evaluated</code>, what does it mean for a name of array to be &quot;evaluated&quot;?"}, {"owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "reply_to_user": {"reputation": 4168, "user_id": 3552561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7d0994b2ce09612027ca2b69e6bddd5?s=128&d=identicon&r=PG&f=1", "display_name": "qiubit", "link": "https://stackoverflow.com/users/3552561/qiubit"}, "edited": false, "score": 2, "creation_date": 1429123803, "post_id": 29658212, "comment_id": 47456395, "body": "@qiubit  The size of a VLA is determined at run time. VLA(s) have automatic storage duration and their sizes are determined each time the code block where they are defined gets the control. It is the meaning of the term &quot;Variable Length Array&quot;.:)"}], "tags": [], "owner": {"reputation": 219634, "user_id": 2877241, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/63d17ecdadc8917254be4fb70e86246b?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad from Moscow", "link": "https://stackoverflow.com/users/2877241/vlad-from-moscow"}, "is_accepted": true, "score": 5, "last_activity_date": 1429123324, "last_edit_date": 1429123324, "creation_date": 1429123167, "answer_id": 29658212, "question_id": 29658067, "link": "https://stackoverflow.com/questions/29658067/is-an-really-interchangeable-with-an-why-does-sizeof-return-two-differen/29658212#29658212", "title": "Is a[n] really interchangeable with *(a+n) - why does sizeof return two different answers?", "body": "<p>According to the C Standard (6.5.3.4 The sizeof and alignof operators)</p>\n\n<blockquote>\n  <p>2 <strong>The sizeof operator yields the size (in bytes) of its operand</strong>,\n  which may be an expression or the parenthesized name of a type. The\n  size is determined from the type of the operand. The result is an\n  integer. If the type of the operand is a variable length array type,\n  the operand is evaluated; otherwise, the operand is not evaluated and\n  the result is an integer constant.</p>\n</blockquote>\n\n<p>So object <code>a</code> defined as an array of 10 integers occupies a memory extent that has size of 40 bytes because each element of it in turn has size of 4 bytes (that is in your environment sizeof( int ) is equal to 4).</p>\n\n<pre><code>int a[10] = {0,1,2,3,4,5,6,7,8,9};\n</code></pre>\n\n<p>Object <code>p</code> is defined as a pointer and initialized by the address of the first element of the array <code>a</code></p>\n\n<pre><code>int *p = a;\n</code></pre>\n\n<p>In the environment where you compiled the program size of pointer is equal to 8 bytes.</p>\n\n<p>You can consider declaration</p>\n\n<pre><code>int *p = a;\n</code></pre>\n\n<p>also like</p>\n\n<pre><code>int *p = &amp;a[0];\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": false, "score": 3, "last_activity_date": 1429123889, "creation_date": 1429123889, "answer_id": 29658448, "question_id": 29658067, "link": "https://stackoverflow.com/questions/29658067/is-an-really-interchangeable-with-an-why-does-sizeof-return-two-differen/29658448#29658448", "title": "Is a[n] really interchangeable with *(a+n) - why does sizeof return two different answers?", "body": "<p>Yes, the <em>expression</em> <code>a[n]</code> is equivalent to <code>*(a+n)</code>. But that's not relevant to your code sample.</p>\n\n<p>You've defined <code>a</code> as an array object consisting of 10 <code>int</code> objects, and <code>p</code> as a pointer object of type <code>int*</code>. The equivalence you mention means, for example, that the expressions <code>a[5]</code> is equivalent to <code>*(a+5</code>; both are <code>int</code> expressions with the value <code>5</code>. But neither expression appears in your code.</p>\n\n<p>You've defined <code>a</code> and <code>p</code> as objects of different types, and there is no rule in C that says these objects are interchangable. <code>sizeof a</code> is equivalent to <code>10 * sizeof (int)</code>, and <code>sizeof p</code> is equivalent to <code>sizeof (int*)</code> (the size of a pointer to <code>int</code>).</p>\n\n<p>One special rule that your program does depend on is that an expression of array type is, in most contexts, implicitly converted to a pointer to the array's initial element. In:</p>\n\n<pre><code>int *p = a;\n</code></pre>\n\n<p><code>a</code> is an expression of array type. It's converted to the equivalent of <code>&amp;a[0]</code>, and that pointer value is used to initialize <code>p</code>. Thereafter, <code>a</code> and <code>p</code> are equivalent <em>in most contexts</em>; they both refer (one indirectly, one directly) to the address of the initial element of the array object <code>a</code>. But the operand of the <code>sizeof</code> operator is one of the contexts in which this conversions does not take place; <code>sizeof a</code> yields the size of the array object, not the size of a pointer.</p>\n\n<p>All this is explained very well in section 6 of the <a href=\"http://www.c-faq.com/\" rel=\"nofollow\">comp.lang.c FAQ</a>.</p>\n"}], "owner": {"reputation": 4168, "user_id": 3552561, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e7d0994b2ce09612027ca2b69e6bddd5?s=128&d=identicon&r=PG&f=1", "display_name": "qiubit", "link": "https://stackoverflow.com/users/3552561/qiubit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 29658212, "answer_count": 2, "score": 4, "last_activity_date": 1429123889, "creation_date": 1429122741, "question_id": 29658067, "link": "https://stackoverflow.com/questions/29658067/is-an-really-interchangeable-with-an-why-does-sizeof-return-two-differen", "title": "Is a[n] really interchangeable with *(a+n) - why does sizeof return two different answers?", "body": "<p>I'm having a problem understanding one thing in C. I've read in \"ANSI C\" that statements like <code>a[n]</code> where <code>a</code> is array are really equivalent to <code>*(a+n)</code>. So here's a small code snippet I've written to check that:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\nint main(void)\n{\n    int a[10] = {0,1,2,3,4,5,6,7,8,9};\n    int *p = a;\n    printf(\"sizeof a: %d\\n\", sizeof(a));\n    printf(\"sizeof p: %d\\n\", sizeof(p));\n    return 0;\n}\n</code></pre>\n\n<p>After executing the code the program outputs:</p>\n\n<pre><code>sizeof a: 40\nsizeof p: 8\n</code></pre>\n\n<p>I don't understand - what did I just do? How are <code>a</code> and <code>p</code> different objects? (Judging by the output of sizeof function)</p>\n"}, {"tags": ["c", "security", "buffer-overflow", "libc"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429123191, "post_id": 29658005, "comment_id": 47456020, "body": "Since this is merely an academic question and not something you&#39;re trying to do evil with, try adding <code>printf(&quot;system() is at %p\\n&quot;, system);</code> to your program."}, {"owner": {"reputation": 43, "user_id": 4276252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g8nEh.jpg?s=128&g=1", "display_name": "doctor_haifisch", "link": "https://stackoverflow.com/users/4276252/doctor-haifisch"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429123517, "post_id": 29658005, "comment_id": 47456222, "body": "Unfortunately, that only seems to work when stdlib is included, which I am unable to do in this case. And yes, just to be clear, this is for academic purposes :)"}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429123772, "post_id": 29658005, "comment_id": 47456363, "body": "Do you mean you&#39;re unable to <code>#include &lt;stdlib.h&gt;</code> for some reason? Inclusion of a header is not necessary to make the function available (it&#39;s just the best practice method of doing that). You could also provide the prototype manually, by adding <code>int system(const char *);</code> in this case. Neither will modify what the compiler produces for the linked executable."}, {"owner": {"reputation": 43, "user_id": 4276252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g8nEh.jpg?s=128&g=1", "display_name": "doctor_haifisch", "link": "https://stackoverflow.com/users/4276252/doctor-haifisch"}, "reply_to_user": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429124385, "post_id": 29658005, "comment_id": 47456767, "body": "I should say, I&#39;m trying to do this without including stdlib. Regardless, I couldn&#39;t print the address of <code>system</code> without stdlib included (or if system was forward-declared), unless I was doing something wrong."}], "owner": {"reputation": 43, "user_id": 4276252, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g8nEh.jpg?s=128&g=1", "display_name": "doctor_haifisch", "link": "https://stackoverflow.com/users/4276252/doctor-haifisch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 646, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1429122577, "creation_date": 1429122577, "question_id": 29658005, "link": "https://stackoverflow.com/questions/29658005/return-to-libc-function-address-probing", "title": "Return-To-Libc Function Address Probing", "body": "<p>I'm trying to implement a return-to-libc buffer overflow attack by finding the address of <code>system()</code> with gdb and returning to said address with <code>/bin/sh</code> passed as an argument to <code>system()</code> on the stack. The only problem is, I can't find the address in memory where <code>system()</code> lives, as running <code>print system</code> in gdb returns \"No symbol table is loaded. Use the \"file\" command.\", which isn't especially helpful, as loading libc.so into gdb doesn't do me any good. Is there a way I can find the addresses of functions in libc which I have not included via headers?</p>\n\n<p>For reference, the code I'm testing this with is below, DEP is enabled, and ASLR is disabled.</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nvoid foo(char *arg) {\n    char buf[100];\n    strcpy(buf, arg);\n}\n\nint main(int argc, char **argv) {\n    foo(argv[1]);\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "scope", "signals"], "answers": [{"tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 1, "last_activity_date": 1429122714, "creation_date": 1429122714, "answer_id": 29658057, "question_id": 29657868, "link": "https://stackoverflow.com/questions/29657868/can-you-set-local-variables-through-system-calls/29658057#29658057", "title": "Can you set local variables through system calls?", "body": "<p>In C, a function can not see/manipulate the value of a variable local to another function (ignoring the possibility of a visible pointer pointing to a local variable which is either static or in an active call frame).</p>\n"}, {"comments": [{"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1429122885, "post_id": 29658083, "comment_id": 47455844, "body": "I took his question to mean that both the SIGUSR2 handler and the local variable were at least in the same process.  This may have been a poor assumption."}, {"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "reply_to_user": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1429123014, "post_id": 29658083, "comment_id": 47455919, "body": "You may be right - in which case the OP is guilty of providing more information than is germane to the information needed while also not providing enough information about what s/he&#39;s trying to do ;)"}], "tags": [], "owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "is_accepted": false, "score": 0, "last_activity_date": 1429122786, "creation_date": 1429122786, "answer_id": 29658083, "question_id": 29657868, "link": "https://stackoverflow.com/questions/29657868/can-you-set-local-variables-through-system-calls/29658083#29658083", "title": "Can you set local variables through system calls?", "body": "<p>Your question's setup is not very clear, but to answer generically (and perhaps a bit pedantically), code does not change variables, code changes memory.</p>\n\n<p>That is... a variable is simply a convenient way to refer to a memory location. \"Changing a variable\" is really just changing the value at its position in memory. This is relevant because while it's very convenient to execute <code>x = 5;</code>, that's not the only way to change <code>x</code>. Any code that knows where <code>x</code> lives in memory, and has permission to write to that location, may therefore change <code>x</code>.</p>\n\n<p>In your specific case you're starting a second process. Initially this second process has a copy of the memory of the first one, letting it read the same data, but it's typical that any post-fork changes to memory are only visible in the process that made the change.</p>\n\n<p>Your wording suggests that you're not only calling <code>fork()</code>, but that you may also then be exec'ing to another program altogether... making even the copy of the parent's memory go away.</p>\n\n<p>In short, what you're trying to do is probably not possible without going through some rather ugly hacks, and it would definitely be worth finding a different solution (such as shared memory).</p>\n"}], "owner": {"reputation": 53, "user_id": 4730738, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/101c53fe5788667afe7410dfd72d42c6?s=128&d=identicon&r=PG&f=1", "display_name": "12343211234", "link": "https://stackoverflow.com/users/4730738/12343211234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429122786, "creation_date": 1429122095, "question_id": 29657868, "link": "https://stackoverflow.com/questions/29657868/can-you-set-local-variables-through-system-calls", "title": "Can you set local variables through system calls?", "body": "<p>I have one program that forks other programs. When the forked programs receive SIGUSR2, a variable in them is supposed to change. I'm not sure how to do that because that variable isn't in the scope of the function that SIGUSR2 calls. </p>\n"}, {"tags": ["c", "arrays"], "comments": [{"owner": {"reputation": 36985, "user_id": 749284, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9939c97c2ccc2f1f6b829e9afbc32e5b?s=128&d=identicon&r=PG", "display_name": "mah", "link": "https://stackoverflow.com/users/749284/mah"}, "edited": false, "score": 0, "creation_date": 1429122087, "post_id": 29657679, "comment_id": 47455354, "body": "Since <i>variable y is the size of array</i>: <code>int x[y]</code>, your sorting loops each go one value too large. A C array of size <i>y</i> is indexable between <code>0</code> and <code>y-1</code>. Just change the <code>&lt;=</code> to <code>&lt;</code> and you&#39;ll have them right."}, {"owner": {"reputation": 8876, "user_id": 1545171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TiAiM.jpg?s=128&g=1", "display_name": "DrKoch", "link": "https://stackoverflow.com/users/1545171/drkoch"}, "edited": false, "score": 2, "creation_date": 1429122299, "post_id": 29657679, "comment_id": 47455488, "body": "Cool piece of code if you are just a few days into C! Some remarks: never use y for integers, use i, j, k. (Everybody else does it like that, comes form FORTRAN, dont ask). use <code>for (i = 0; i &lt; y; i++)</code> for similar reasons."}], "answers": [{"comments": [{"owner": {"reputation": 1834, "user_id": 4948426, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a4c7c93127bab92a9a9d2fdf129aa811?s=128&d=identicon&r=PG&f=1", "display_name": "Jaskaranbir Singh", "link": "https://stackoverflow.com/users/4948426/jaskaranbir-singh"}, "edited": false, "score": 1, "creation_date": 1429121846, "post_id": 29657716, "comment_id": 47455209, "body": "Aah thanks, such a little mistake. Dont know why I didnt notice it lol, I must have read the upper loops a thousand times to check my logic, but final loop.... thanks a lot :D Once the time break of 10mins passes, i&#39;ll choose it as the answer (SO limits)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 5, "last_activity_date": 1429121580, "creation_date": 1429121580, "answer_id": 29657716, "question_id": 29657679, "link": "https://stackoverflow.com/questions/29657679/arrange-given-numbers-in-ascending-order/29657716#29657716", "title": "Arrange given numbers in ascending order", "body": "<p>You need to change</p>\n\n<pre><code> printf(\"%d\\n\", x[i]);\n</code></pre>\n\n<p>to</p>\n\n<pre><code>printf(\"%d\\n\", x[k]);\n</code></pre>\n\n<p>in the printing loop as you're using <code>k</code> as the loop counter variable.</p>\n"}, {"tags": [], "owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "is_accepted": false, "score": 0, "last_activity_date": 1429260599, "last_edit_date": 1429260599, "creation_date": 1429121732, "answer_id": 29657761, "question_id": 29657679, "link": "https://stackoverflow.com/questions/29657679/arrange-given-numbers-in-ascending-order/29657761#29657761", "title": "Arrange given numbers in ascending order", "body": "<p>In your last for loop, you are doing</p>\n\n<pre><code> printf(\"\\nNumbers arranged in ascending order:\\n\");\nfor (k = 0; k &lt; y; ++k) {\n    printf(\"%d\\n\", x[i]);\n}\n</code></pre>\n\n<p>but you print <code>x[i]</code>, but do not increment <code>i</code>. Remember, <code>i</code> and <code>k</code> are just array variables, not the actual VALUES in the array. Just change the <code>printf</code> to <code>printf(\"%d\\n\", x[k]);</code> and it should work fine.</p>\n"}], "owner": {"reputation": 1834, "user_id": 4948426, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a4c7c93127bab92a9a9d2fdf129aa811?s=128&d=identicon&r=PG&f=1", "display_name": "Jaskaranbir Singh", "link": "https://stackoverflow.com/users/4948426/jaskaranbir-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 608, "favorite_count": 0, "accepted_answer_id": 29657716, "answer_count": 2, "score": 5, "last_activity_date": 1497911969, "creation_date": 1429121471, "last_edit_date": 1497911969, "question_id": 29657679, "link": "https://stackoverflow.com/questions/29657679/arrange-given-numbers-in-ascending-order", "title": "Arrange given numbers in ascending order", "body": "<p>I've just started learning C, and today I was given a question in which one of the parts was to accept the array of numbers from user and arrange them in ascending order. The array size was also to be specified by user.\nI used the following code for this purpose-></p>\n\n<pre><code>   for (i = 0; i &lt;= y - 1; ++i) {\n        for (ii = i + 1; ii &lt;= y - 1; ++ii) {\n            if (x[i] &gt; x[ii]) {\n                temp = x[i];\n                x[i] = x[ii];\n                x[ii] = temp;\n            }\n        }\n    }\n    int k;\n    printf(\"\\nNumbers arranged in ascending order:\\n\");\n    for (k = 0; k &lt; y; ++k) {\n        printf(\"%d\\n\", x[i]);\n    }\n</code></pre>\n\n<p>Here, variable y is the size of array, x is name of array variable (So the variable defining goes like this-> <code>int x[y];</code>\nBut the problem is, it just prints out the final value of array. To elaborate problem:\nSuppose I entered 3 as my array size. Then program asks me for 3 numbers which I chose 34,45,22.\nNow after this whole code is executed, it displays x[3] (now x[3] doesn't even exist! Since x[2] is final value in array. So it gives me memory location of variable.)\nWhere am I going wrong?</p>\n"}, {"tags": ["c", "signals"], "answers": [{"tags": [], "owner": {"reputation": 13767, "user_id": 2413201, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rxfuw.jpg?s=128&g=1", "display_name": "Armali", "link": "https://stackoverflow.com/users/2413201/armali"}, "is_accepted": false, "score": 0, "last_activity_date": 1444117824, "creation_date": 1444117824, "answer_id": 32964500, "question_id": 29657624, "link": "https://stackoverflow.com/questions/29657624/signal-handler-and-waitpid-coexisting/32964500#32964500", "title": "Signal handler and waitpid coexisting", "body": "<blockquote>\n  <p>Problem:</p>\n  \n  <ul>\n  <li>Foreground processes also trig handler causing one of two waitpids to\n  error</li>\n  </ul>\n</blockquote>\n\n<p>This is not a problem - just leave the handler then.</p>\n\n<pre><code>void handler(int signum)\n{\n    pid_t pid;\n    while (pid = waitpid(-1, NULL, WNOHANG), pid &gt; 0)\n        fprintf(stderr, \"%d terminated\\n\", pid);\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3685312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef5d9ea39b38e33205d6478c69865782?s=128&d=identicon&r=PG&f=1", "display_name": "user3685312", "link": "https://stackoverflow.com/users/3685312/user3685312"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444117824, "creation_date": 1429121301, "question_id": 29657624, "link": "https://stackoverflow.com/questions/29657624/signal-handler-and-waitpid-coexisting", "title": "Signal handler and waitpid coexisting", "body": "<p>I'm coding a shell in C that should support background and foreground processes.</p>\n\n<p>Constraints:</p>\n\n<ul>\n<li>Background processes that terminate should be caught by signal handler</li>\n<li>No global variables can be used for communicating from signal handler</li>\n<li>No list of processes/pids allowed</li>\n</ul>\n\n<p>My solution:</p>\n\n<ul>\n<li>Waitpid until foreground process terminates</li>\n<li>For background processes, immediately return to prompt</li>\n<li>Handler catches SIGCHLD where waitpid is used to clear process table</li>\n</ul>\n\n<p>Problem:</p>\n\n<ul>\n<li>Foreground processes also trig handler causing one of two waitpids to error</li>\n<li>Can't solve by ignoring SIGCHLD while running foreground process, since background process might terminate during that time</li>\n<li>Can't find a way to make handler ignore specific pid (the foreground process started)</li>\n</ul>\n\n<p>Thanks!</p>\n"}, {"tags": ["c", "sockets", "client-server", "send", "recv"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429121802, "post_id": 29657612, "comment_id": 47455177, "body": "I think it&#39;s very hard to help you because of the complexity of your program, you need to use the best debugger that you can use to step through the code and check what&#39;s wrong, that&#39;s how I would solve this kind of problem, and I am pretty sure that it&#39;s everyone else&#39;s approach. Asking here should be for specific problems, yours is not IMHO."}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429133205, "post_id": 29657612, "comment_id": 47461979, "body": "@iharob Can you recommend a debugger?"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429133656, "post_id": 29657612, "comment_id": 47462234, "body": "It depends, what platform are you on?"}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429134378, "post_id": 29657612, "comment_id": 47462594, "body": "<code>C</code> in a <code>Mac</code> terminal. I&#39;m compiling with <code>gcc</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429134408, "post_id": 29657612, "comment_id": 47462607, "body": "With <b>gcc</b> use <b>gdb</b>"}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429134760, "post_id": 29657612, "comment_id": 47462771, "body": "@iharob BTW, did you not see anything grossly wrong with the code I posted"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429134818, "post_id": 29657612, "comment_id": 47462789, "body": "No, and I didn&#39;t look at it too much because it&#39;s hard to relate the problem to this code."}], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429121247, "creation_date": 1429121247, "question_id": 29657612, "link": "https://stackoverflow.com/questions/29657612/c-tcp-socket-recv-return-1-on-server-server-communication", "title": "C TCP Socket recv return -1 on Server-Server communication", "body": "<p>I am building a <code>client-server socket</code> simulation to emulate <code>DHCP</code>. I have a <code>client</code> that receives input from the user, then sends a request via <code>UDP</code> to <code>Server1</code>. If Server1 does not hold the requested information, it contacts <code>Server2</code> via <code>TCP</code>. If <code>Server2</code> does not hold the information, it contacts <code>Server3</code>. <code>Server3</code> then sends information to <code>Server2</code> then <code>Server1</code> then on to the <code>Client</code></p>\n\n<p>My code works for <code>Client --&gt; Server1 --&gt; Server2 --&gt; Server1 --&gt; Client</code>, but it fails when I try to add <code>Server3</code>.</p>\n\n<p><code>Server3</code> successfully receives the connection and data from <code>Server2</code>, and the <code>send</code> is successful I believe. However, the <code>recv</code> on server 2 returns <code>-1</code>.</p>\n\n<p>Here is my <code>Server3</code> send code:</p>\n\n<pre><code>while ((rqst = accept(svc,(struct sockaddr *) &amp;client_addr, &amp;alen)) &lt; 0) {\n    /* we may break out of accept if the system call */\n    /* was interrupted. In this case, loop back and */\n    /* try again */\n} \ninet_ntoa(client_addr.sin_addr), ntohs(client_addr.sin_port));\nrecvlen = recv(rqst, buf, BUFSIZE - 1, 0);\nif (send(rqst, \"Hello Server2!\\0\", BUFSIZE, 0) &lt; 0) { /* Not real message, but this works */\n          perror(\"sendto\");\n}\n</code></pre>\n\n<p>My <code>Server2 recv</code> code is here</p>\n\n<pre><code>int port = SERVICE_PORT3;      /* default: whatever is in port.h */\nchar *host = \"localhost\";      /* default: this host */\nif (!conn_and_send(host, port, buf, fd3)) {    /* connect fd3 is global int */\n  exit(1);   /* something went wrong */\n}\nelse {\n  char serv3_buf[BUFSIZE];\n  int serv3_recvlen = recv(fd3, serv3_buf, BUFSIZE - 1, 0);\n  printf(\"The recv length from serv3 is: %d\\n\", serv3_recvlen); /* prints -1*/\n}\n</code></pre>\n\n<p>This is my <code>conn_and_send</code> function</p>\n\n<pre><code>int conn_and_send(char *host, int port, char* request, int fd_sock)\n{\n  struct hostent *hp;   /* host information */\n  unsigned int alen;    /* address length when we get the port number */\n  struct sockaddr_in myaddr;    /* our address */\n  struct sockaddr_in servaddr;  /* server address */\n\n  printf(\"conn(host=\\\"%s\\\", port=\\\"%d\\\")\\n\", host, port);\n\n  if ((fd_sock = socket(AF_INET, SOCK_STREAM, 0)) &lt; 0) {\n    perror(\"cannot create socket\");\n    return 0;\n  }\n\n  memset((char *)&amp;myaddr, 0, sizeof(myaddr));\n  myaddr.sin_family = AF_INET;\n  myaddr.sin_addr.s_addr = htonl(INADDR_ANY);\n  myaddr.sin_port = htons(0);\n\n  if (bind(fd_sock, (struct sockaddr *)&amp;myaddr, sizeof(myaddr)) &lt; 0) {\n    perror(\"bind failed\");\n    return 0;\n  }\n\n  alen = sizeof(myaddr);\n  if (getsockname(fd_sock, (struct sockaddr *)&amp;myaddr, &amp;alen) &lt; 0) {\n    perror(\"getsockname failed\");\n    return 0;\n  }\n  printf(\"local port number = %d\\n\", ntohs(myaddr.sin_port));\n\n  memset((char*)&amp;servaddr, 0, sizeof(servaddr));\n  servaddr.sin_family = AF_INET;\n  servaddr.sin_port = htons(port);\n\n  hp = gethostbyname(host);\n  if (!hp) {\n    fprintf(stderr, \"could not obtain address of %s\\n\", host);\n    return 0;\n  }\n\n  memcpy((void *)&amp;servaddr.sin_addr, hp-&gt;h_addr_list[0], hp-&gt;h_length);\n\n  if (connect(fd_sock, (struct sockaddr *)&amp;servaddr, sizeof(servaddr)) &lt; 0) {\n    perror(\"connect failed\");\n    return 0;\n  }\n  printf(\"Getting ready to send: %s\\n\", request);\n  if (send(fd_sock, request, strlen(request), 0) &lt; 0) {\n    perror(\"sendto\");\n    exit(1);\n  }\n  return 1;\n}\n</code></pre>\n\n<p>Sorry to post so much code. I tried to include only relevant snippets.</p>\n\n<p>What am I doing wrong, and if you can see no problems besides my poor <code>C</code> coding, why does <code>C</code> hate me?! :P</p>\n"}, {"tags": ["c", "arrays", "matrix", "text-files"], "comments": [{"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 2, "creation_date": 1429119873, "post_id": 29657118, "comment_id": 47453922, "body": "Please search on SO for the answer before asking.  This question or something very similar has been asked, and answered, many times before.  Your trouble is <code>double value[10000][2];</code> and <code>fscanf( archivo, &quot;%lf %lf %lf&quot;, &amp;value[i][0],&amp;value[i][1],&amp;value[i][2]);</code> -- you accessing the array out of bounds and overwriting stuff."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 2, "creation_date": 1429120149, "post_id": 29657118, "comment_id": 47454094, "body": "<code>while (feof(archivo) == 0)</code> - please refer to SO question <a href=\"http://stackoverflow.com/questions/5431941/why-is-while-feof-file-always-wrong/5432004\" title=\"why is while feof file always wrong\">stackoverflow.com/questions/5431941/&hellip;</a> You should also check the return value from <code>fscanf()</code>, in this case <code>if(3 != fscanf(...))</code>"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1429120473, "post_id": 29657118, "comment_id": 47454314, "body": "Instead of <code>while (!feof(archivo))</code> which will be <code>true</code> once after the last line is read, you can do  <code>while (fscanf(...) == 3)</code> which not only ensures that the loop will perform the correct number of iterations, but also that the line contains well formated data. In fact <code>printf()</code> right after <code>fscanf()</code> potentially invokes undefined behavior."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429120908, "post_id": 29657118, "comment_id": 47454588, "body": "<code>feof()</code> only informs true if a read operation <i>previously</i> attempted to read past the end of the file. So it doesn&#39;t tell you there is no more to read - only if you already made a bad read - which as @iharob says, you can test just with the return value from <code>fscanf()</code>, and that way, you&#39;ll also trap a poorly formatted file."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429173968, "post_id": 29657118, "comment_id": 47477424, "body": "... and of course, if you wan to read a matrix of three columns, dimension it adequately, as <code>double matrix[1000][3]; &#47;* and not 2 *&#47;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3169, "user_id": 4114124, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/k73hh.jpg?s=128&g=1", "display_name": "Politank-Z", "link": "https://stackoverflow.com/users/4114124/politank-z"}, "is_accepted": true, "score": 6, "last_activity_date": 1429120116, "last_edit_date": 1429120116, "creation_date": 1429119897, "answer_id": 29657183, "question_id": 29657118, "link": "https://stackoverflow.com/questions/29657118/reading-a-matrix-from-a-text-file-in-c/29657183#29657183", "title": "Reading a matrix from a text file in c", "body": "<p>You declare <code>double value[10000][2];</code> but then access <code>value[i][2]</code>. An array declared with <code>[2]</code> contains 2 elements, indexed <code>0</code> and <code>1</code>. Accessing index '2' is overwriting other memory.</p>\n\n<p>Use</p>\n\n<pre><code>double value[10000][3];\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 4793145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/961f44e9ec20c0dcbaa8160b6b4bbb98?s=128&d=identicon&r=PG&f=1", "display_name": "Rebeca", "link": "https://stackoverflow.com/users/4793145/rebeca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8833, "favorite_count": 1, "accepted_answer_id": 29657183, "answer_count": 1, "score": 6, "last_activity_date": 1429120333, "creation_date": 1429119696, "last_edit_date": 1429120333, "question_id": 29657118, "link": "https://stackoverflow.com/questions/29657118/reading-a-matrix-from-a-text-file-in-c", "title": "Reading a matrix from a text file in c", "body": "<p>I\u00b4m trying to read a text file and store the data in a matrix. I print the results after read each line and seems it is working, but if I print the matrix at the end, I don't have the same results. I can't find what i'm doing wrong!</p>\n\n<pre><code>int main()\n{\n    int i,j;\n    double value[10000][2];\n    FILE *archivo;\n    archivo = fopen(\"pruebas.txt\",\"r\");\n    if (archivo == NULL)\n        exit(1);\n    i=0;\n    while (feof(archivo) == 0)\n    {\n        fscanf( archivo, \"%lf %lf %lf\", &amp;value[i][0],&amp;value[i][1],&amp;value[i][2]);\n        printf(\"%10.0f %f %f\\n\", value[i][0], value[i][1], value[i][2]);\n        i++;\n    }\n\n    printf(\"Your matrix:\\n\");\n    for(j = 0; j &lt; i; j++)\n        printf(\"%10.0f %10.3f %10.3f\\n\", value[j][0], value[j][1], value[j][2]);\n\n    fclose(archivo);\n    return 0;\n}\n</code></pre>\n\n<p>This is the output of the program:\n</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>1 2 3 \n4 5 6  \n7 8 9   \nYour matrix:  \n1 2 4  \n4 5 7  \n7 8 9  \n</code></pre>\n"}, {"tags": ["c"], "answers": [{"tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": true, "score": 3, "last_activity_date": 1429119946, "last_edit_date": 1429119946, "creation_date": 1429119675, "answer_id": 29657105, "question_id": 29656999, "link": "https://stackoverflow.com/questions/29656999/find-divisors-and-store-them-in-array/29657105#29657105", "title": "Find divisors and store them in array", "body": "<blockquote>\n  <p>I am getting junk values. What am I doing wrong?</p>\n</blockquote>\n\n<p>If <code>count2</code> is less than <code>count1</code>, <code>divisors2</code> does not have as many values and you end up accessing the array out of bounds.</p>\n\n<p>Print the two divisors separately.</p>\n\n<pre><code>for(i=0;i&lt;count1;i++)\n{\n    printf(\"%d\\n\",divisors1[i]);\n}\n\nfor(i=0;i&lt;count2;i++)\n{\n    printf(\"%d\\n\",divisors2[i]);\n}\n</code></pre>\n\n<p>Also, as was pointed out by @BLUEPIXY, you have an indexing error in <code>storeDivisiors</code>.</p>\n\n<p>Instead of </p>\n\n<pre><code>for(i=1,j=0;i&lt;=n,j&lt;count;i++,j++)\n{\n    if(n%i==0)\n    {\n        divisors[j]=i;\n    }\n}\n</code></pre>\n\n<p>use</p>\n\n<pre><code>for(i=1,j=0;i&lt;=n,j&lt;count;i++)\n{\n    if(n%i==0)\n    {\n        divisors[j++]=i;\n        //       ^^^^ increment j only when storing a divisor.\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8727, "user_id": 2999346, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dQ1wB.png?s=128&g=1", "display_name": "francis", "link": "https://stackoverflow.com/users/2999346/francis"}, "is_accepted": false, "score": 1, "last_activity_date": 1429120701, "last_edit_date": 1495540271, "creation_date": 1429119883, "answer_id": 29657178, "question_id": 29656999, "link": "https://stackoverflow.com/questions/29656999/find-divisors-and-store-them-in-array/29657178#29657178", "title": "Find divisors and store them in array", "body": "<p>The problem is in :</p>\n\n<pre><code>for(i=1,j=0;i&lt;=n,j&lt;count;i++,j++)\n{\n    if(n%i==0)\n    {\n        divisors[j]=i;\n    }\n}\n</code></pre>\n\n<p><code>j</code> is always equal to <code>i-1</code>. Consequently, most of items in array <code>divisor</code> will never be set.</p>\n\n<p>Try :</p>\n\n<pre><code>for(i=1,j=0;i&lt;=n,j&lt;count;i++)\n{\n    if(n%i==0)\n    {\n        divisors[j]=i;\n        j++;\n    }\n}\n</code></pre>\n\n<p>That way, <code>j</code> increases if, and only if, a divisor is found.</p>\n\n<p>The next step is to use dynamic memory allocation, to avoid computing the divisors twice and use a \"resizable\" array. The function <a href=\"http://www.cplusplus.com/reference/cstdlib/realloc/\" rel=\"nofollow noreferrer\"><code>realloc()</code></a> of stdlib may inspire you. To avoid reallocating the array each time a new divisor is found, a structure similar to a <a href=\"http://www.cplusplus.com/reference/vector/vector/\" rel=\"nofollow noreferrer\">vector</a> will be needed. See <a href=\"https://stackoverflow.com/questions/4694401/how-to-replicate-vector-in-c\">How to replicate vector in c?</a> or <a href=\"https://stackoverflow.com/questions/27992299/converting-c-implementation-of-vector-in-c\">Converting C++ implementation of vector in C</a></p>\n"}, {"comments": [{"owner": {"reputation": 601, "user_id": 4784091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6Cuop4Wb4uM/AAAAAAAAAAI/AAAAAAAAGyQ/fJac_E9eqIs/photo.jpg?sz=128", "display_name": "Atul Shanbhag", "link": "https://stackoverflow.com/users/4784091/atul-shanbhag"}, "edited": false, "score": 0, "creation_date": 1429120934, "post_id": 29657190, "comment_id": 47454610, "body": "Thank you. Understood my mistake"}], "tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1429119913, "creation_date": 1429119913, "answer_id": 29657190, "question_id": 29656999, "link": "https://stackoverflow.com/questions/29656999/find-divisors-and-store-them-in-array/29657190#29657190", "title": "Find divisors and store them in array", "body": "<p>The loop in your <code>storeDivisors()</code> function is wrong.  In it, variable <code>j</code> appears intended to represent the index in the <code>divisors</code> array where the next divisor should be stored, but in that case you should increment it only when you in fact store a divisor.  Instead, you increment it at every iteration.  You will end up with some <code>divisors[]</code> positions containing junk values, and not all divisors being stored.</p>\n\n<p>The loop should look like this:</p>\n\n<pre><code>int i,j;\nfor(i=1,j=0;i&lt;=n,j&lt;count;i++)\n{\n    if(n%i==0)\n    {\n        divisors[j++]=i;\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 601, "user_id": 4784091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6Cuop4Wb4uM/AAAAAAAAAAI/AAAAAAAAGyQ/fJac_E9eqIs/photo.jpg?sz=128", "display_name": "Atul Shanbhag", "link": "https://stackoverflow.com/users/4784091/atul-shanbhag"}, "is_accepted": false, "score": 0, "last_activity_date": 1435645396, "creation_date": 1435645396, "answer_id": 31131035, "question_id": 29656999, "link": "https://stackoverflow.com/questions/29656999/find-divisors-and-store-them-in-array/31131035#31131035", "title": "Find divisors and store them in array", "body": "<p>I am answering my own question here, I have gotten better since the past few days and intend to improve my above code. </p>\n\n<p>I have eliminated the need to make a function to find the number of divisors of <code>n</code> since that is immaterial in storing the divisors in an array. I have improved my <code>storeDivisors</code> function which not only stores all the divisors but if needed will also give the count of divisors. Here is the updated code --</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid storeDivisors(int n,int a[],int *x)\n{\n    int i;\n    for(i=1;i&lt;=n;i++)\n    {\n        if(n%i==0)\n            a[(*x)++]=i;\n    }\n}\n\nint main()\n{\n    int n = 100;\n    int a[100];\n    int x = 0;\n    int i;\n\n    storeDivisors(n,a,&amp;x);\n\n    for(i=0;i&lt;x;i++)\n        printf(\"%d\\n\",a[i]);\n    printf(\"number of divisors = %d\\n\",x);\n\n    return 0;\n}\n</code></pre>\n"}], "owner": {"reputation": 601, "user_id": 4784091, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6Cuop4Wb4uM/AAAAAAAAAAI/AAAAAAAAGyQ/fJac_E9eqIs/photo.jpg?sz=128", "display_name": "Atul Shanbhag", "link": "https://stackoverflow.com/users/4784091/atul-shanbhag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1654, "favorite_count": 0, "accepted_answer_id": 29657105, "answer_count": 4, "score": 3, "last_activity_date": 1435645396, "creation_date": 1429119313, "question_id": 29656999, "link": "https://stackoverflow.com/questions/29656999/find-divisors-and-store-them-in-array", "title": "Find divisors and store them in array", "body": "<p>I have written the following code which contans two functions</p>\n\n<p>1.To find the number of divisors of a number</p>\n\n<p>2.To store the divisors in an array.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint numOfDivisors(int n)\n{\n    int i, numOfDivisors=0;\n\n    for(i=1;i&lt;=n;i++)\n    {\n        if(n%i==0)\n        {\n            numOfDivisors++;\n        }\n    }\n    return numOfDivisors;\n}\n\nvoid storeDivisors(int count,int divisors[],int n)\n{\n    int i,j;\n    for(i=1,j=0;i&lt;=n,j&lt;count;i++,j++)\n    {\n        if(n%i==0)\n        {\n            divisors[j]=i;\n        }\n    }\n\n}\n\nint main()\n{\n    int n,m,a,i;\n\n    scanf(\"%d %d %d\",&amp;n,&amp;m,&amp;a);\n\n    int count1=numOfDivisors(n);\n    int count2=numOfDivisors(m);\n\n    /*printf(\"%d %d\",count1,count2);*/\n\n    int divisors1[count1],divisors2[count2];\n\n    storeDivisors(count1,divisors1,n);\n    storeDivisors(count2,divisors2,m);\n\n    for(i=0;i&lt;count1;i++)\n    {\n        printf(\"%d\\t%d\\n\",divisors1[i],divisors2[i]);\n    }\n\n    return 0;\n}\n</code></pre>\n\n<p>This is just part of a bigger code I need to make.</p>\n\n<p>I am getting junk values. What am I doing wrong?</p>\n"}, {"tags": ["c", "authentication", "login", "printf", "pam"], "comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429164270, "post_id": 29656865, "comment_id": 47471794, "body": "The problem is you are passing a <code>const</code> thing to some function whose parameter has not declared as <code>const</code>.  This is not an error, just a warning that you loose the <code>const</code>ness of the thing."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4793090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be9e018e5ee50dcb15e014525b048de4?s=128&d=identicon&r=PG&f=1", "display_name": "Igor-Potapov", "link": "https://stackoverflow.com/users/4793090/igor-potapov"}, "edited": false, "score": 0, "creation_date": 1429123228, "post_id": 29657523, "comment_id": 47456049, "body": "Thank You, compile is successfully complete, but PAM is not work :( In sys log I have message: show_signal_msg: 9 callbacks suppressed sshd[8868]: segfault at 0 ip 00007fb... sp 00007fb... error 4 in pam_test.so ..."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 33, "user_id": 4793090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be9e018e5ee50dcb15e014525b048de4?s=128&d=identicon&r=PG&f=1", "display_name": "Igor-Potapov", "link": "https://stackoverflow.com/users/4793090/igor-potapov"}, "edited": false, "score": 0, "creation_date": 1429126919, "post_id": 29657523, "comment_id": 47458374, "body": "@Igor-Potapov: I don&#39;t see anything obvious (aside from the fact that you never <code>free</code> any of the memory you <code>malloc</code>, but that won&#39;t cause a segfault, or at least not immediately), so I&#39;m afraid you&#39;ll need to do some debugging. Good luck."}, {"owner": {"reputation": 33, "user_id": 4793090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be9e018e5ee50dcb15e014525b048de4?s=128&d=identicon&r=PG&f=1", "display_name": "Igor-Potapov", "link": "https://stackoverflow.com/users/4793090/igor-potapov"}, "edited": false, "score": 0, "creation_date": 1429128697, "post_id": 29657523, "comment_id": 47459387, "body": "thank You again. it will be better snprintf((char*)msg[0].msg,60,&quot;Second Password:%d:%d:%d:%d:&quot;,x1,x2,x3,x4); it work fine !!!"}], "tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 0, "last_activity_date": 1429120970, "creation_date": 1429120970, "answer_id": 29657523, "question_id": 29656865, "link": "https://stackoverflow.com/questions/29656865/pam-module-error-passing-argument-1-of-snprintf-discards-const/29657523#29657523", "title": "PAM module error (passing argument 1 of \u2018snprintf\u2019 discards \u2018const\u2019)", "body": "<p>The problem here is that in <code>struct pam_message</code>, the <code>msg</code> field is declared as <code>const char*</code>; that is, a pointer to an immutable string. So you're not supposed to overwrite it with <code>snprintf</code>.</p>\n\n<p>A simple workaround is to write the string before inserting a pointer to it into <code>msg</code>:</p>\n\n<pre><code>char *s = malloc(100);\nsnprintf(s, 100, \"Second Password:%d:%d:%d:%d:\",x1,x2,x3,x4);\nmsg[0].msg = s;\n</code></pre>\n\n<p>Note: You should check the return value of snprintf. If the value returned is more than 100, then the string was truncated.</p>\n"}], "owner": {"reputation": 33, "user_id": 4793090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/be9e018e5ee50dcb15e014525b048de4?s=128&d=identicon&r=PG&f=1", "display_name": "Igor-Potapov", "link": "https://stackoverflow.com/users/4793090/igor-potapov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 29657523, "answer_count": 1, "score": 0, "last_activity_date": 1429120970, "creation_date": 1429118908, "last_edit_date": 1429119903, "question_id": 29656865, "link": "https://stackoverflow.com/questions/29656865/pam-module-error-passing-argument-1-of-snprintf-discards-const", "title": "PAM module error (passing argument 1 of \u2018snprintf\u2019 discards \u2018const\u2019)", "body": "<p>I have my PAM module:</p>\n\n<p>I try to compile it, using string:</p>\n\n<pre><code>gcc -fPIC -DPIC -shared -rdynamic -o pam_test.so pam_test.c\n</code></pre>\n\n<p>But I have errors:</p>\n\n<pre><code>pam_test.c: In function \u2018pam_sm_authenticate\u2019:\npam_test.c:74:9: warning: passing argument 1 of \u2018snprintf\u2019 discards \u2018const\u2019 qualifier from pointer target type [enabled by default]\n         snprintf(msg[0].msg,60,\"Second Password:%d:%d:%d:%d:\",x1,x2,x3,x4);\n         ^\nIn file included from pam_test.c:10:0:\n/usr/include/stdio.h:386:12: note: expected \u2018char * __restrict__\u2019 but argument is of type \u2018const char *\u2019\n extern int snprintf (char *__restrict __s, size_t __maxlen,\n</code></pre>\n\n<p>module code:</p>\n\n<pre><code>#include &lt;security/pam_modules.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdio.h&gt;\n\n\n#define PAM_SM_AUTH\n#define MAX_V 30\n\n\nPAM_EXTERN int pam_sm_authenticate(pam_handle_t * pamh, int flags, int argc, const char **argv)\n{\n        unsigned int ctrl;\n        int retval;\n        const char *name, *p;\n        char *right;\n        int x1,x2,x3,x4,y;\n\n        time_t mytime;\n        struct tm *mytm;\n\n        mytime=time(0);\n        mytm=localtime(&amp;mytime);\n\n\n        srandom(mytime);\n        x1=random()%MAX_V;\n        x2=random()%MAX_V;\n        x3=random()%MAX_V;\n        x4=random()%MAX_V;\n\n        retval = pam_get_user(pamh, &amp;name, \"login: \");\n\n        {\n            struct pam_conv *conv;\n            struct pam_message *pmsg[3],msg[3];\n            struct pam_response *response;\n\n\n        retval = pam_get_item( pamh, PAM_CONV, (const void **) &amp;conv ) ;\n\n        pmsg[0] = &amp;msg[0];\n        msg[0].msg_style = PAM_PROMPT_ECHO_OFF;\n        msg[0].msg=malloc(100);\n        snprintf(msg[0].msg,60,\"Second Password:%d:%d:%d:%d:\",x1,x2,x3,x4);\n\n        retval = conv-&gt;conv(1, ( const struct pam_message ** ) pmsg\n                            , &amp;response, conv-&gt;appdata_ptr);\n        y=2*x1*mytm-&gt;tm_mday+x3*mytm-&gt;tm_hour;\n        right=malloc(100);\n        snprintf(right,20,\"%d\",y);\n\n        if (!(strcmp(right,response-&gt;resp))){\n        return PAM_SUCCESS;\n        }else{\n        return PAM_AUTH_ERR;\n        }\n      }\n\n        return PAM_SUCCESS;\n\n}\n\nPAM_EXTERN int pam_sm_setcred(pam_handle_t * pamh, int flags\n                              ,int argc, const char **argv)\n{\n        unsigned int ctrl;\n        int retval;\n        retval = PAM_SUCCESS;\n}\n\n#ifdef PAM_STATIC\nstruct pam_module _pam_unix_auth_modstruct = {\n    \"pam_test\",\n    pam_sm_authenticate,\n    pam_sm_setcred,\n    NULL,\n    NULL,\n    NULL,\n    NULL,\n};\n#endif\n</code></pre>\n"}, {"tags": ["c++", "c", "opencl", "brute-force"], "comments": [{"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429120724, "post_id": 29656770, "comment_id": 47454473, "body": "Are you checking the return codes from the OpenCL API calls (i.e. the value of <code>err</code> after API call)?"}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "reply_to_user": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429123354, "post_id": 29656770, "comment_id": 47456124, "body": "@jprice i checked that, got some error feedback in creating kernel, and fixed that. Now the problems are inside that kernel.cl file.  by any chance, did you know how to define these variables correctly in openCL custom header file?  <code>__global __constant unsigned char cudaBrute[MAX_BRUTE_LENGTH]; __global __constant unsigned char cudaCharSet[95]; __global unsigned char correctPass[MAX_TOTAL];</code>"}, {"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429123760, "post_id": 29656770, "comment_id": 47456357, "body": "You need to pass your OpenCL buffers to the kernel as arguments, declared as (for example) <code>global uchar *data</code>."}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "reply_to_user": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429124738, "post_id": 29656770, "comment_id": 47456978, "body": "@jprice can you give more explanation or example, i don&#39;t understand at all, sorry."}, {"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429126992, "post_id": 29656770, "comment_id": 47458412, "body": "Passing a buffer to a kernel is just like passing a pointer as an argument to a regular C function. Declare it as a pointer with the <code>global</code> attribute, and then call <code>clSetKernelArg(kernel, index, sizeof(cl_mem), &amp;buffer)</code> to set the argument."}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "reply_to_user": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429131016, "post_id": 29656770, "comment_id": 47460691, "body": "@jprice thanks, solved that one before your answer.   now that i just use 2 files: kernel.cl and main.cpp, got some errors in kernel about <b>function in the kernel declared implicitly</b> and some variable in the kernel undefined , which they were there <b>already defined</b> in the main file."}, {"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429131469, "post_id": 29656770, "comment_id": 47460962, "body": "Any functions and variables that you use from a kernel need to be defined in the same source file (or a header file included by it). The OpenCL kernel will not be able to access functions and variables defined in the host program."}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "reply_to_user": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "edited": false, "score": 0, "creation_date": 1429135133, "post_id": 29656770, "comment_id": 47462918, "body": "@jprice wow thanks mate, the kernel is now working, or at least readable. I just updated this post, could you please take a brief look. thanks before."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "edited": false, "score": 0, "creation_date": 1429139408, "post_id": 29661800, "comment_id": 47464499, "body": "finally it makes sense for me about the passing buffer, thanks. But still, it doesn&#39;t solve those 2 problems, haven&#39;t found the causes... What is the equivalent of <code>dim3 dimGrid(64); dim3 dimBlock(128);</code> in openCL?"}, {"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "reply_to_user": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "edited": false, "score": 0, "creation_date": 1429141288, "post_id": 29661800, "comment_id": 47465144, "body": "@alfonsouchiha Local size = <code>128</code>, global size = <code>128*64</code>"}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "edited": false, "score": 0, "creation_date": 1429195608, "post_id": 29661800, "comment_id": 47493835, "body": "do i need to write every variable in the kernel in &#39;_global&#39; or &#39;_constant&#39;, e.g. <code>_kernel void crack( _global int numThreads, _global int digit, .....){...}</code> ?"}, {"owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "edited": false, "score": 0, "creation_date": 1429264913, "post_id": 29661800, "comment_id": 47528269, "body": "can i discuss this with you personally ? I don&#39;t want to make this post long without an actual answer. Thanks."}, {"owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "reply_to_user": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "edited": false, "score": 0, "creation_date": 1429266886, "post_id": 29661800, "comment_id": 47529621, "body": "OK: <a href=\"http://chat.stackoverflow.com/rooms/75491/bruteforce-in-opencl-port-from-cuda-isnt-working\">chat.stackoverflow.com/rooms/75491/&hellip;</a>"}], "tags": [], "owner": {"reputation": 9332, "user_id": 3100482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w3Q8i.jpg?s=128&g=1", "display_name": "jprice", "link": "https://stackoverflow.com/users/3100482/jprice"}, "is_accepted": true, "score": 2, "last_activity_date": 1429276437, "last_edit_date": 1429276437, "creation_date": 1429135738, "answer_id": 29661800, "question_id": 29656770, "link": "https://stackoverflow.com/questions/29656770/bruteforce-in-opencl-port-from-cuda-isnt-working/29661800#29661800", "title": "bruteforce in OpenCL (port from CUDA) isn&#39;t working", "body": "<p>Your kernel is reading and writing from constant arrays defined at program scope in your OpenCL kernel source code (<code>cudaBrute</code>, <code>cudaCharSet</code>, <code>correctPass</code>). These arrays are not initialised, and the host will never be able to get the output from the kernel. To transfer input data from the host to a kernel and to retrieve results from a kernel, you need to use kernel arguments, not program scope variables.</p>\n\n<p>Your kernel definition should look something like this:</p>\n\n<pre><code>__kernel void crack(unsigned int numThreads, unsigned int charSetLen,\n                    unsigned int bruteLength, unsigned int v1,\n                    unsigned int v2, unsigned int v3, unsigned int v4,\n                    __global uchar *cudaBrute, \n                    __global uchar *cudaCharSet,\n                    __global uchar *correctPass)\n{\n  ...\n  (do stuff with the arguments)\n  ...\n}\n</code></pre>\n\n<p>To set the arguments from your host code, you would do something like this:</p>\n\n<pre><code>// Set the arguments to our compute kernel\nerr  = clSetKernelArg(kernel, 0, sizeof(int), &amp;numThreads);\nerr  |= clSetKernelArg(kernel, 1, sizeof(int), &amp;charSetLen);\nerr  |= clSetKernelArg(kernel, 2, sizeof(int), &amp;digit);\nerr  |= clSetKernelArg(kernel, 3, sizeof(unsigned int), &amp;v1);\nerr  |= clSetKernelArg(kernel, 4, sizeof(unsigned int), &amp;v2);\nerr  |= clSetKernelArg(kernel, 5, sizeof(unsigned int), &amp;v3);\nerr  |= clSetKernelArg(kernel, 6, sizeof(unsigned int), &amp;v4);\nerr  |= clSetKernelArg(kernel, 7, sizeof(cl_mem), &amp;cudaBrute);\nerr  |= clSetKernelArg(kernel, 8, sizeof(cl_mem), &amp;cudaCharSet);\nerr  |= clSetKernelArg(kernel, 9, sizeof(cl_mem), &amp;correctPass);\n</code></pre>\n\n<p>Notice the second argument, which is the argument index in your kernel definition, and how for the last three arguments we are now passing in the buffer we created with <code>clCreateBuffer</code>.</p>\n\n<hr>\n\n<p>(EDIT: A couple more issues were found after further debugging)</p>\n\n<p>You are updating the value of <code>digit</code> on the host. In order to pass this updated value to the device for each kernel invocation, you need to re-set the kernel argument. You can do this simply by moving this line to just before your <code>clEnqueueNDRangeKernel</code> call:</p>\n\n<pre><code>err  |= clSetKernelArg(kernel, 2, sizeof(unsigned int), &amp;digit);\n</code></pre>\n\n<p>When you write data to the <code>cudaCharSet</code> buffer, you need to make sure you are writing the correct amount. Your code currently uses <code>bytes</code> (which is 14), but this should really be <code>charSetLen</code> (which is 65):</p>\n\n<pre><code>err = clEnqueueWriteBuffer(queue, cudaCharSet, CL_TRUE, 0,\n                           charSetLen, charSet, 0, NULL, NULL);\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 4337581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9CRJN.jpg?s=128&g=1", "display_name": "alfonsouchiha", "link": "https://stackoverflow.com/users/4337581/alfonsouchiha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1057, "favorite_count": 2, "accepted_answer_id": 29661800, "answer_count": 1, "score": 5, "last_activity_date": 1429276437, "creation_date": 1429118618, "last_edit_date": 1429266911, "question_id": 29656770, "link": "https://stackoverflow.com/questions/29656770/bruteforce-in-opencl-port-from-cuda-isnt-working", "title": "bruteforce in OpenCL (port from CUDA) isn&#39;t working", "body": "<p><em>*another update in code and questions*</em></p>\n\n<p>just started to learn openCL about 1 week or so, and i tried to port a CUDA program about bruteforcing a MD5 hash to get an actual string from it. I use 2 files: kernel.cl, and main.cpp.</p>\n\n<pre><code>//this is kernel.cl\n\n{...*defining some md5 variables*...}\n\nvoid IncrementBruteGPU(unsigned char* ourBrute, unsigned int charSetLen, unsigned int bruteLength, unsigned int incrementBy){\nint i = 0;\nwhile(incrementBy &gt; 0 &amp;&amp; i &lt; bruteLength)\n{\n    int add = incrementBy + ourBrute[i];\n    ourBrute[i] = add % charSetLen;\n    incrementBy = add / charSetLen;\n    i++;\n}}\n\nvoid md5_vfy(unsigned char* data, unsigned int length, unsigned int *a1, unsigned int *b1, unsigned int *c1, unsigned int *d1){\n{...*some md5 hashing function*...}}\n\n__kernel void crack(unsigned int numThreads, unsigned int charSetLen,\n                unsigned int bruteLength, unsigned int v1,\n                unsigned int v2, unsigned int v3, unsigned int v4,\n                __constant unsigned char *cudaBrute, \n                __constant unsigned char *cudaCharSet,\n                __global unsigned char *correctPass){\n//count index\nunsigned int idx = get_global_id(0);\nint totalLen = 0;\nint bruteStart = 0;\n\nunsigned char word[14];\nunsigned char ourBrute[14];\n\nint i = 0;\n\nfor(i = 0; i &lt; 14; i++)\n{\n    ourBrute[i] = cudaBrute[i];\n}\n\ni = 0;\nbruteStart = i;\ni+= bruteLength;\ntotalLen = i;\n\nIncrementBruteGPU(ourBrute, charSetLen, bruteLength, idx);\nint timer = 0;\nfor(timer = 0; timer &lt; 200; timer++)\n{\n    //substitute into string\n    for(i = 0; i &lt; bruteLength; i++)\n    {\n        word[i+bruteStart] = cudaCharSet[ourBrute[i]];\n    }\n\n    unsigned int c1 = 0, c2 = 0, c3 = 0, c4 = 0;\n    //find MD5 hash from word\n    md5_vfy(word,totalLen, &amp;c1, &amp;c2, &amp;c3, &amp;c4);\n\n    //compare hash with the input one\n    if(c1 == v1 &amp;&amp; c2 == v2 &amp;&amp; c3 == v3 &amp;&amp; c4 == v4)\n    {\n        //place the right string into first index of array\n        int j;\n        for(j= 0; j &lt; 14; j++)\n        {\n            correctPass[j] = word[j];\n        }\n        correctPass[totalLen] = 0;\n    }\n    IncrementBruteGPU(ourBrute, charSetLen, bruteLength, numThreads);\n}}\n</code></pre>\n\n<p>and this is the main:</p>\n\n<pre><code>//just the main, not the entire main.cpp\nint main( int argc, char** argv){\nint digit=1;\nint charSetLen = 0;\nchar hash[32];\nchar *strhash[32];\n\nprintf(\"Insert Hash: \");\nscanf(\"%s\", strhash);\nsystem(\"cls\");\n\nint numThreads = BLOCKS * THREADS_PER_BLOCK;\n\nunsigned char currentBrute[14];\nunsigned char cpuCorrectPass[14];\n\nZeroFill(currentBrute, 14);\nZeroFill(cpuCorrectPass, 14);\n\ncharSetLen = 65;\nunsigned char charSet[65];\nmemcpy(charSet, \" abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_\", charSetLen);\nmemcpy(hash, strhash, 32);\n\n//break hash into 4 processes of MD5\nunsigned int v1, v2, v3, v4;\nmd5_to_ints(hash,&amp;v1,&amp;v2,&amp;v3,&amp;v4);\n\n//openCL starts here\ncl_platform_id cpPlatform;        // OpenCL platform\ncl_device_id device_id;           // device ID\ncl_context context;               // context\ncl_command_queue queue;           // command queue\ncl_program program;               // program\ncl_kernel kernel;                 // kernel\n\ncl_int err;\ncl_mem correctPass;\ncl_mem cudaCharSet;\ncl_mem cudaBrute;\n\nsize_t globalSize, localSize;\nsize_t bytes = 14*sizeof(char);\n\n//5 work-groups\nlocalSize = 10;\nglobalSize = 50;\n\n // Bind to platform\nerr = clGetPlatformIDs(1, &amp;cpPlatform, NULL);\nif(err &lt; 0) {\n  perror(\"Couldn't identify a platform\");\n  exit(1);\n} \n\n// Get ID for the device\nerr = clGetDeviceIDs(cpPlatform, CL_DEVICE_TYPE_GPU, 1, &amp;device_id, NULL);\nif(err == CL_DEVICE_NOT_FOUND) {\n  err = clGetDeviceIDs(cpPlatform, CL_DEVICE_TYPE_CPU, 1, &amp;device_id, NULL);\n}\nif(err &lt; 0) {\n  perror(\"Couldn't access any devices\");\n  exit(1);   \n}\n\n// Create a context  \ncontext = clCreateContext(0, 1, &amp;device_id, NULL, NULL, &amp;err);\nif(err &lt; 0) {\n  perror(\"Couldn't create a context\");\n  exit(1);   \n}\n\n// Create a command queue \nqueue = clCreateCommandQueue(context, device_id, CL_QUEUE_PROFILING_ENABLE, &amp;err);\nif(err &lt; 0) {\n  perror(\"Couldn't create a command queue\");\n  exit(1);   \n}\n\n// Build the program executable \nprogram = build_program(context, device_id, PROGRAM_FILE);\n\n // Create the compute kernel in the program we wish to run\nkernel = clCreateKernel(program, KERNEL_FUNC, &amp;err);\nif(err &lt; 0) {\n  perror(\"Couldn't create a kernel\");\n  exit(1);\n}\n\n// Create the input and output arrays in device memory for our calculation\ncudaBrute = clCreateBuffer(context, CL_MEM_READ_ONLY, 14, NULL, NULL);\ncudaCharSet = clCreateBuffer(context, CL_MEM_READ_ONLY, 95, NULL, NULL);\ncorrectPass = clCreateBuffer(context, CL_MEM_READ_WRITE, 14, NULL, NULL);\n\n// Write our data set into the input array in device memory\nerr = clEnqueueWriteBuffer(queue, correctPass, CL_TRUE, 0,\n    bytes, cpuCorrectPass, 0, NULL, NULL);\nerr = clEnqueueWriteBuffer(queue, cudaCharSet, CL_TRUE, 0,\n    bytes, charSet, 0, NULL, NULL);\n\n// Set the arguments to our compute kernel\nerr  = clSetKernelArg(kernel, 0, sizeof(unsigned int), &amp;numThreads);\nerr  |= clSetKernelArg(kernel, 1, sizeof(unsigned int), &amp;charSetLen);\nerr  |= clSetKernelArg(kernel, 2, sizeof(unsigned int), &amp;digit);\nerr  |= clSetKernelArg(kernel, 3, sizeof(unsigned int), &amp;v1);\nerr  |= clSetKernelArg(kernel, 4, sizeof(unsigned int), &amp;v2);\nerr  |= clSetKernelArg(kernel, 5, sizeof(unsigned int), &amp;v3);\nerr  |= clSetKernelArg(kernel, 6, sizeof(unsigned int), &amp;v4);\nerr  |= clSetKernelArg(kernel, 7, sizeof(cl_mem), &amp;cudaBrute);\nerr  |= clSetKernelArg(kernel, 8, sizeof(cl_mem), &amp;cudaCharSet);\nerr  |= clSetKernelArg(kernel, 9, sizeof(cl_mem), &amp;correctPass);\n\nbool finished = false;\nint ct = 0;\nwhile(true){\ndo{\n    err = clEnqueueWriteBuffer(queue, cudaBrute, CL_TRUE, 0,\n        bytes, currentBrute, 0, NULL, NULL);\n\n// Execute the kernel over the entire range of the data set  \n    err = clEnqueueNDRangeKernel(queue, kernel, 1, NULL, &amp;globalSize, &amp;localSize,\n                                                          0, NULL, NULL);\n\n// Wait for the command queue to get serviced before reading back results\n    clFinish(queue);\n\n// Read the results from the device\n    clEnqueueReadBuffer(queue, correctPass, CL_TRUE, 0, bytes, cpuCorrectPass, 0, NULL, NULL );\n\n    if(cpuCorrectPass[0] != 0)\n    {       \n        printf(\"MD5 Cracked----&gt;\\t\");\n        int k = 0;\n        while(cpuCorrectPass[k] != 0)\n        {\n            printf(\"%c\", cpuCorrectPass[k]);\n            k++;\n        }\n        printf(\"\\n\\n\");\n        return 0;\n    }\n    finished = BruteIncrement(currentBrute, charSetLen, digit, numThreads * 200);\n    if(ct % OUTPUT_INTERVAL == 0)\n    {\n        printf(\"STATUS: \");\n        int k = 0;\n        for(k = 0; k &lt; digit; k++)\n            printf(\"%c\",charSet[currentBrute[k]]);\n        printf(\"\\n\");\n    }\n    ct++;\n} while(!finished);\n    digit=digit+1;\n}   \n// release OpenCL resources\nclReleaseMemObject(correctPass);\nclReleaseMemObject(cudaCharSet);\nclReleaseMemObject(cudaBrute);\nclReleaseProgram(program);\nclReleaseKernel(kernel);\nclReleaseCommandQueue(queue);\nclReleaseContext(context);\n\nreturn 0;}\n</code></pre>\n\n<p>the problem with this program is <strong>it never finds the right string</strong>. Seems like the idea of <strong>comparing brute-hashes and the input hash isn't working</strong>. I got the CUDA version works perfectly .</p>\n\n<p><strong>Please kindly tell me what makes this doesn't run correctly</strong>. I suspect either the kernel isn't working at all or my lack of understanding about read/write memory &amp; buffer in openCL or in general cause this.</p>\n\n<p>*if you want to see all the files, please ask me., because i think it will be too long if i post them here.\nthanks before and sorry for the bad formatting.</p>\n"}, {"tags": ["c", "pointers"], "comments": [{"owner": {"reputation": 21, "user_id": 4533296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57adcff9f74ed7014b9bc4c1af31d85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ghanmi", "link": "https://stackoverflow.com/users/4533296/ahmed-ghanmi"}, "edited": false, "score": 0, "creation_date": 1429117430, "post_id": 29656387, "comment_id": 47452434, "body": "char **outList;     *outList = strdup(cloudDevice);      printf(&quot;this is device XML message: %s&quot;,*outList);"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4533296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57adcff9f74ed7014b9bc4c1af31d85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ghanmi", "link": "https://stackoverflow.com/users/4533296/ahmed-ghanmi"}, "edited": false, "score": 0, "creation_date": 1429120162, "post_id": 29656467, "comment_id": 47454104, "body": "this a test for a function so i need to use char**"}], "tags": [], "owner": {"reputation": 287, "user_id": 4696892, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wxd6pVB7x8w/AAAAAAAAAAI/AAAAAAAAACM/9YlASP0sEt0/photo.jpg?sz=128", "display_name": "huxley", "link": "https://stackoverflow.com/users/4696892/huxley"}, "is_accepted": false, "score": 3, "last_activity_date": 1429118079, "last_edit_date": 1429118079, "creation_date": 1429117615, "answer_id": 29656467, "question_id": 29656387, "link": "https://stackoverflow.com/questions/29656387/error-outlist-is-used-uninitialized-in-this-function-werror-uninitialized/29656467#29656467", "title": "error: \u2018outList\u2019 is used uninitialized in this function [-Werror=uninitialized]", "body": "<p>It's complaining because you're using an uninitialized pointer, you reference <code>outList</code> before he pointes anywhere</p>\n\n<p>why do you use <code>char **</code> and not <code>char *</code> ?</p>\n\n<pre><code>char *outList;\n\noutList = strdup(cloudDevice);\nprintf(\"this is device XML message: %s\", outList);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 1, "creation_date": 1429176761, "post_id": 29669237, "comment_id": 47479265, "body": "No you&#39;re not. (1) In all logic you need <code>sizeof(char*)</code> (allocate some <code>char*</code>, return a pointer to them). (2) Why the <code>256</code> ? (3) On your second line, you need to assign to <code>*outList</code>. Your compiler should scream about that one."}], "tags": [], "owner": {"reputation": 21, "user_id": 4533296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57adcff9f74ed7014b9bc4c1af31d85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ghanmi", "link": "https://stackoverflow.com/users/4533296/ahmed-ghanmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1429174894, "last_edit_date": 1429174894, "creation_date": 1429172707, "answer_id": 29669237, "question_id": 29656387, "link": "https://stackoverflow.com/questions/29656387/error-outlist-is-used-uninitialized-in-this-function-werror-uninitialized/29669237#29669237", "title": "error: \u2018outList\u2019 is used uninitialized in this function [-Werror=uninitialized]", "body": "<p>I figured it out! I had to use <code>malloc</code>.</p>\n\n<pre><code>char **outList = malloc(sizeof (char **) * 256) ;  \noutList = strdup(cloudDevice);\nprintf(\"this is device XML message: %s\",*outList);\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4533296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57adcff9f74ed7014b9bc4c1af31d85?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed Ghanmi", "link": "https://stackoverflow.com/users/4533296/ahmed-ghanmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1429174894, "creation_date": 1429117362, "last_edit_date": 1429123577, "question_id": 29656387, "link": "https://stackoverflow.com/questions/29656387/error-outlist-is-used-uninitialized-in-this-function-werror-uninitialized", "title": "error: \u2018outList\u2019 is used uninitialized in this function [-Werror=uninitialized]", "body": "<p>I am writing a program for my intro to C class and keep getting some warnings when I try to compile with gcc.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>char **outList;\n*outList = strdup(cloudDevice);\nprintf(\"this is device XML message: %s\",*outList);\n</code></pre>\n\n<p>Any ideas why? Thank you</p>\n"}, {"tags": ["c", "char", "int", "unsigned-integer", "unsigned-char"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 1, "creation_date": 1429116191, "post_id": 29655966, "comment_id": 47451673, "body": "<a href=\"http://en.wikipedia.org/wiki/Two%27s_complement\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Two%27s_complement</a>"}, {"owner": {"reputation": 5331, "user_id": 3777428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJ6pq.png?s=128&g=1", "display_name": "eigenchris", "link": "https://stackoverflow.com/users/3777428/eigenchris"}, "edited": false, "score": 1, "creation_date": 1429116439, "post_id": 29655966, "comment_id": 47451817, "body": "To expand on the above comment, the scheme for encoding negative numbers in binary you are expecting is called <a href=\"http://en.wikipedia.org/wiki/Signed_number_representations#Signed_magnitude_representation\" rel=\"nofollow noreferrer\">sign and magnitude</a>, which simply uses the most-significant bit as a sign bit. This is pretty much never used in practice. Negative numbers are usually implemented with the two-complement representation."}, {"owner": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "reply_to_user": {"reputation": 5331, "user_id": 3777428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJ6pq.png?s=128&g=1", "display_name": "eigenchris", "link": "https://stackoverflow.com/users/3777428/eigenchris"}, "edited": false, "score": 0, "creation_date": 1429116893, "post_id": 29655966, "comment_id": 47452090, "body": "@eigenchris no it&#39;s not sign-magnitude but 2&#39;s complement. You can hardly find a 1&#39;s complement or sign-magnitude system today. Both -77 and 179&#39;s representation is 0xB3"}, {"owner": {"reputation": 5331, "user_id": 3777428, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sJ6pq.png?s=128&g=1", "display_name": "eigenchris", "link": "https://stackoverflow.com/users/3777428/eigenchris"}, "reply_to_user": {"reputation": 26723, "user_id": 995714, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/w1393.jpg?s=128&g=1", "display_name": "phuclv", "link": "https://stackoverflow.com/users/995714/phuclv"}, "edited": false, "score": 1, "creation_date": 1429117173, "post_id": 29655966, "comment_id": 47452269, "body": "@L\u01b0uV\u0129nhPh&#250;c perhaps I phrased my comment badly... I mean to say  sign-and-magnitude is what the OP was <i>expecting</i> based on their assumption that <code>10110011</code> is a representation of -51. Of course in truth <code>10110011</code> is -77 in the two&#39;s complement representation, which is the standard negative number representation today."}], "answers": [{"comments": [{"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1429116455, "post_id": 29656090, "comment_id": 47451831, "body": "It is undefined behaviour."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 4, "creation_date": 1429116482, "post_id": 29656090, "comment_id": 47451851, "body": "@MaximEgorushkin it&#39;s not, see integer conversion rules."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429116537, "post_id": 29656090, "comment_id": 47451882, "body": "@ouah It assigns a value greater than CHAR_MAX to a char. It is undefined behaviour."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429116656, "post_id": 29656090, "comment_id": 47451947, "body": "@ouah Quote the rule you refer to."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1429116767, "post_id": 29656090, "comment_id": 47452004, "body": "@MaximEgorushkin c11, 6.3.1.3p3"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1429117428, "post_id": 29656090, "comment_id": 47452431, "body": "@ouch Thanks for the pointer. Those rules say &quot;<i>When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged. Otherwise, if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more unsigned integer than the maximum value that can be represented in the new type until the value is in the range of the new conversion to type. <b>Otherwise, the new type is signed and the value cannot be represented in it.</b>&quot;</i>"}, {"owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1429117580, "post_id": 29656090, "comment_id": 47452537, "body": "@MaximEgorushkin I don&#39;t understand how <i>the value is converted by repeatedly adding or subtracting one more unsigned integer than the maximum value that can be represented in the new type until the value is in the range of the new conversion to type</i>. translates into 2&#39;s complement of the number being assigned. But that&#39;s a topic for another question."}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 0, "creation_date": 1429117679, "post_id": 29656090, "comment_id": 47452598, "body": "@RSahu That is truncation of higher-order bits, which is well defined for unsigned types, but not for signed."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "edited": false, "score": 1, "creation_date": 1429117747, "post_id": 29656090, "comment_id": 47452650, "body": "@MaximEgorushkin I think you didn&#39;t quote the paragraph correctly: <i>Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.</i> The important part is <b>the result is implementation-defined or an implementation-defined signal is raised.</b>"}, {"owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429123597, "post_id": 29656090, "comment_id": 47456260, "body": "@ouah Fair enough, I often confuse <i>implementation-defined</i> with <i>undefined</i>."}], "tags": [], "owner": {"reputation": 196207, "user_id": 434551, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/8Wzl8.png?s=128&g=1", "display_name": "R Sahu", "link": "https://stackoverflow.com/users/434551/r-sahu"}, "is_accepted": false, "score": 2, "last_activity_date": 1429116385, "creation_date": 1429116385, "answer_id": 29656090, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int/29656090#29656090", "title": "Converting unsigned char to signed int", "body": "<p>Looks like <code>char</code> is a signed type on your system. The valid range for a <code>char</code> would be [-128, 127]</p>\n\n<p>By using</p>\n\n<pre><code>char t = 179;\n</code></pre>\n\n<p>the compiler uses the 2's complement of 179 (which is most likely -77) and assigns that value to <code>t</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429116972, "post_id": 29656137, "comment_id": 47452138, "body": "We&#39;ll publish jointly. C++ will insist on 2s complement in the next standard: don&#39;t know about C"}], "tags": [], "owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "is_accepted": false, "score": 0, "last_activity_date": 1429116898, "last_edit_date": 1429116898, "creation_date": 1429116532, "answer_id": 29656137, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int/29656137#29656137", "title": "Converting unsigned char to signed int", "body": "<p>Char could be signed or unsigned: that's up to your compiler.</p>\n\n<p>If signed, it could be 2s or 1 complement.</p>\n\n<p>Furthermore, it could be larger than 8 bits, although sizeof char is defined to be 1.</p>\n\n<p>So it's inadvisable to rely on a specific representation.</p>\n"}, {"tags": [], "owner": {"reputation": 1715, "user_id": 3543752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd4b55278e916b23f5c2f5d8ea40c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Budlong", "link": "https://stackoverflow.com/users/3543752/brad-budlong"}, "is_accepted": false, "score": 1, "last_activity_date": 1429116552, "creation_date": 1429116552, "answer_id": 29656139, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int/29656139#29656139", "title": "Converting unsigned char to signed int", "body": "<p>To convert between a positive and a negative number in 2's complement you invert all the bits and then you add 1.</p>\n\n<p>10110011</p>\n\n<p>01001100  (invert all bits)</p>\n\n<p>01001101  (add one)</p>\n\n<p>That is 77 decimal</p>\n"}, {"comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429117943, "post_id": 29656236, "comment_id": 47452774, "body": "At first you said &quot;it is undefined behavior&quot; and now you say &quot;it is unspecified behavior&quot;, neither is correct as C has specific definitions for these wordings. The correct thing to say is <i>the result is implementation-defined or an implementation-defined signal is raised</i>."}], "tags": [], "owner": {"reputation": 119228, "user_id": 412080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/239e18525e4c29872d85b2b553b2e4d2?s=128&d=identicon&r=PG", "display_name": "Maxim Egorushkin", "link": "https://stackoverflow.com/users/412080/maxim-egorushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1429117531, "last_edit_date": 1429117531, "creation_date": 1429116847, "answer_id": 29656236, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int/29656236#29656236", "title": "Converting unsigned char to signed int", "body": "<p>Please note, that on many systems <code>char</code> is signed. Hence, when you assign 179 (which is of type <code>int</code>) to a <code>char</code> this value is outside of <code>char</code> range, hence it is unspecified behaviour.</p>\n\n<p>6.3.1.3 Signed and unsigned integers:</p>\n\n<blockquote>\n  <p>When a value with integer type is converted to another integer type other than _Bool, if the value can be represented by the new type, it is unchanged. Otherwise, if the new type is unsigned, the value is converted by repeatedly adding or subtracting one more unsigned integer than the maximum value that can be represented in the new type until the value is in the range of the new conversion to type. <strong>Otherwise, the new type is signed and the value cannot be represented in it; either the result is implementation-defined or an implementation-defined signal is raised.</strong></p>\n</blockquote>\n\n<p>If you change the type to <code>unsigned char</code> your program will perform correctly.</p>\n\n<p>Also note that <code>char</code>, <code>signed char</code> and <code>unsigned char</code> are 3 distinct types, unlike <code>int</code> and <code>signed int</code>. The signedness of <code>char</code> is implementation defined.</p>\n"}, {"tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": true, "score": 3, "last_activity_date": 1429117738, "last_edit_date": 1429117738, "creation_date": 1429117429, "answer_id": 29656416, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int/29656416#29656416", "title": "Converting unsigned char to signed int", "body": "<p>You claimed that the binary representation of <code>-77</code> is <code>11001101</code>, but the reversal is yours. The binary representation of <code>-77</code> is <code>10110011</code>.</p>\n\n<p>Binary <code>10110011</code> unsigned is decimal <code>179</code>.</p>\n\n<p>Binary <code>10110011</code> signed is decimal <code>-77</code>.</p>\n\n<p>You assigned the out-of-range value <code>179</code> to a <code>signed char</code>. It might theoretically be Undefined Behaviour, but apart from throwing an error, it would be a very poor compiler that placed anything but that 8-bit value in the <code>signed char</code>.</p>\n\n<p>But when printed, it's interpreted as a negative number because b7 is set.</p>\n"}], "owner": {"reputation": 257, "user_id": 1335518, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/f538a3962616b4e1a51e9cd8b935730d?s=128&d=identicon&r=PG", "display_name": "Gaurav Singh", "link": "https://stackoverflow.com/users/1335518/gaurav-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2675, "favorite_count": 0, "accepted_answer_id": 29656416, "answer_count": 5, "score": 1, "last_activity_date": 1429117738, "creation_date": 1429115946, "question_id": 29655966, "link": "https://stackoverflow.com/questions/29655966/converting-unsigned-char-to-signed-int", "title": "Converting unsigned char to signed int", "body": "<p>Consider the following program</p>\n\n<pre><code>void main(){\n  char t = 179;\n  printf(\"%d \",t);\n}\n</code></pre>\n\n<p>Output is -77.\nBut binary representation of 179 is</p>\n\n<pre><code>10110011\n</code></pre>\n\n<p>So, shouldn't output be -51, considering 1st bit is singed bit.\nBinary representation of -77 is</p>\n\n<pre><code>11001101\n</code></pre>\n\n<p>It seems bit order is reversed. What's going on? Please somebody advice.</p>\n"}, {"tags": ["c", "postgresql", "libpq"], "answers": [{"comments": [{"owner": {"reputation": 647, "user_id": 3849157, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dae8ab07743abfc9843c1a893317e85e?s=128&d=identicon&r=PG&f=1", "display_name": "Otheus", "link": "https://stackoverflow.com/users/3849157/otheus"}, "edited": false, "score": 0, "creation_date": 1432742024, "post_id": 29664323, "comment_id": 49053233, "body": "The <code>PQconsumeInput</code> works for me in Ruby (<code>conn.consume_input</code>) in a while-sleep loop. To handle things properly, I must catch an exception <code>PG::ConnectionBad</code>. I could probably &quot;manually&quot; test the socket FD, but this seems a little cleaner. Thank you very much for answering this (even though I didn&#39;t ask)"}, {"owner": {"reputation": 95639, "user_id": 385378, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b4ec98df44deb80b1576283152670358?s=128&d=identicon&r=PG", "display_name": "NikiC", "link": "https://stackoverflow.com/users/385378/nikic"}, "edited": false, "score": 0, "creation_date": 1576839763, "post_id": 29664323, "comment_id": 105034469, "body": "&quot;Note, though, that if there&#39;s no input to consume then this function will block waiting for a message from the server.&quot; This doesn&#39;t seem to match this code comment: <a href=\"https://github.com/postgres/postgres/blob/e75b1e33710249d1699850920c0390fb08ea5673/src/interfaces/libpq/fe-exec.c#L1720-L1725\" rel=\"nofollow noreferrer\">github.com/postgres/postgres/blob/&hellip;</a>"}, {"owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "reply_to_user": {"reputation": 95639, "user_id": 385378, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b4ec98df44deb80b1576283152670358?s=128&d=identicon&r=PG", "display_name": "NikiC", "link": "https://stackoverflow.com/users/385378/nikic"}, "edited": false, "score": 0, "creation_date": 1577953287, "post_id": 29664323, "comment_id": 105288336, "body": "@NikiC &quot;may block&quot; - try with an SSL socket"}], "tags": [], "owner": {"reputation": 257364, "user_id": 398670, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/85f50c23bb5e9dfb061af5032bfe8e65?s=128&d=identicon&r=PG", "display_name": "Craig Ringer", "link": "https://stackoverflow.com/users/398670/craig-ringer"}, "is_accepted": true, "score": 2, "last_activity_date": 1429151515, "last_edit_date": 1429151515, "creation_date": 1429151195, "answer_id": 29664323, "question_id": 29655721, "link": "https://stackoverflow.com/questions/29655721/postgres-libpq-how-to-tell-if-a-connection-has-been-terminated/29664323#29664323", "title": "Postgres libpq how to tell if a connection has been terminated", "body": "<p>To see if a connection appears to be alive via <code>libpq</code> you can send an empty query string:</p>\n\n<pre><code>res = PQexec(conn, \"\");\n</code></pre>\n\n<p>and test the result.</p>\n\n<p>At the PostgreSQL protocol level it can be done more efficiently with a simple <code>Sync</code> message, but <code>libpq</code> does not currently expose a way to send just a <code>Sync</code>.</p>\n\n<hr>\n\n<p>You shouldn't have to do that though. When the connection is closed by the server it sends a TCP RST to the client. This should inform the client that its socket has closed. While I haven't tested it, I suspect that calling <a href=\"http://www.postgresql.org/docs/current/static/libpq-async.html\" rel=\"nofollow\"><code>PQconsumeInput</code></a> will be sufficient to process any remaining data on the connection and notice that the socket has been closed. Note, though, that if there's no input to consume then this function will block waiting for a message from the server.</p>\n\n<hr>\n\n<p>BTW, while in this case it's reasonable(ish) to test the connection, in general that's a very bad design. You should never do this:</p>\n\n<ul>\n<li>Test connection</li>\n<li>Run query</li>\n<li>Assume success</li>\n</ul>\n\n<p>as there's a race between testing the connection and actually executing the query or queries. Not to mention the fact that queries can fail for other reasons.</p>\n\n<p>Your application should <em>always</em> be able to handle a transaction failing, and be able to retry it. You should have logic in place to abort and retry just the transaction on transient errors, or to reconnect if the connection its self is bad.</p>\n\n<p>PostgreSQL's <code>libpq</code> could make this a lot easier than it currently does for users. It should expose some functions to test the <code>SQLState</code> to see if it's possibly transient, for example, so apps can use a single call to retry on deadlock aborts, serialization failures, and so on. For now you have to do this yourself.</p>\n"}], "owner": {"reputation": 16043, "user_id": 127853, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ppot0.png?s=128&g=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/127853/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1847, "favorite_count": 0, "accepted_answer_id": 29664323, "answer_count": 1, "score": 2, "last_activity_date": 1429151515, "creation_date": 1429115187, "last_edit_date": 1429118280, "question_id": 29655721, "link": "https://stackoverflow.com/questions/29655721/postgres-libpq-how-to-tell-if-a-connection-has-been-terminated", "title": "Postgres libpq how to tell if a connection has been terminated", "body": "<p>Given the following <a href=\"http://www.postgresql.org/docs/9.1/static/libpq.html\" rel=\"nofollow\">libpq</a> code:</p>\n\n<pre><code>PGconn * internalConnection = PQconnectdb(\"my connection string\");\nif (PQstatus(internalConnection) != CONNECTION_OK)\n{\n   // return error on failure\n}\n\n// Kill all connections\nif(0 == PQsendQuery(internalConnection, \"SELECT pid, (SELECT pg_terminate_backend(pid)) as killed from pg_stat_activity\"))\n{\n   // return error on failure\n}\n</code></pre>\n\n<p>Which does the following:</p>\n\n<ol>\n<li>Makes a connection to a server.</li>\n<li>Executes a query, killing all of the connections (including this connection).</li>\n</ol>\n\n<p>How can I tell via the client side that the connection has been killed? If I run the following again:</p>\n\n<pre><code>PQstatus(internalConnection)\n</code></pre>\n\n<p>I still gets <code>CONNECTION_OK</code> as my result.</p>\n\n<p>Using the MySQL API I can check <code>mysql_ping</code> on a connection to see if a connection is still open, but on Postgres, there does not seem to be a similar method call (that I could find).</p>\n\n<p>Any suggestions as to how I can determine from the client side if a connection has been killed?</p>\n"}, {"tags": ["c", "language-lawyer", "undefined-behavior"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 4, "creation_date": 1429117476, "post_id": 29655664, "comment_id": 47452470, "body": "I think the replacement is if you want an assembler, use one. Grown-up C doesn&#39;t want to pretend to be one any more."}, {"owner": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 2, "creation_date": 1429117635, "post_id": 29655664, "comment_id": 47452574, "body": "Google for &quot;what every programmer should know about undefined behaviour&quot; and find Chris Lattner&#39;s blog post (Chris Lattner = LLVM lead and inventor of Swift)."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1429118118, "post_id": 29655664, "comment_id": 47452865, "body": "@WumpusQ.Wumbley: If C isn&#39;t supposed to be an upgrade of assembly-language, which would allow code to be ported between different platforms with varying ease depending upon similarities between them, what is it?  And why should programmers who need the functionality C and benefited from its improvements versus assembly language be expected to abandon those improvements?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 47569, "user_id": 3255455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5993e7ece129141878cd6419d39cc26e?s=128&d=identicon&r=PG&f=1", "display_name": "gnasher729", "link": "https://stackoverflow.com/users/3255455/gnasher729"}, "edited": false, "score": 0, "creation_date": 1429118477, "post_id": 29655664, "comment_id": 47453074, "body": "@gnasher729: I&#39;ve read that series, but I didn&#39;t notice any suggested replacements for the techniques that used to work perfectly well.  I also, incidentally, have yet to see examples where second-order inferences from Undefined Behavior allow any optimizations which could not be achieved just as well with a <code>__assume</code> directive [not <code>__assert</code>, since the historical purpose of assertions is to ask the compiler to validate things a programmer knows <i>should</i> be true, but which might conceivably not be].  Do you know of any?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1429118833, "post_id": 29655664, "comment_id": 47453277, "body": "@WumpusQ.Wumbley: Also, given that attempts to run with insufficient memory any program that uses four-deep subroutine nesting may (and on some systems, sometimes does) trigger Undefined Behavior, and the Standard does not require that a system with two gigs allow deeper nesting than one with 2K, a philosophy which says compilers and system libraries should not do anything which isn&#39;t required by the standard would suggest that compilers should eliminate any execution path which would compel five-deep nesting.  The <code>malloc</code> method should also be simplified so that if given..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1429119080, "post_id": 29655664, "comment_id": 47453424, "body": "...a value which is no greater than than <code>sizeof(long)</code>, it will check a flag and return a pointer to a static <code>long</code> variable (if the flag is clear) or null (if set, or if its operand was too large).  The <code>free</code> method should then set the flag if given a non-null argument.  Is there any way in which such optimizations would be forbidden by the standard?  If not, I would think they could save tons of code space."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2404501"}, "edited": false, "score": 2, "creation_date": 1429119815, "post_id": 29655664, "comment_id": 47453888, "body": "I can see you have a lot of rant built up and don&#39;t want to stop it before it&#39;s finished. But it will end with you learning to write <code>b&gt;=0&amp;&amp;b&lt;32?ui&lt;&lt;b:0</code> when that&#39;s what you mean, and accepting that the extra cycles spent on it don&#39;t really matter (since you have a lot more cycles now than you did on your 1990s platform), and that it really wasn&#39;t wise to expect portability between platforms to coexist with &quot;shift operators should always behave like the ones on the CPUs I like&quot;"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 2, "creation_date": 1429120401, "post_id": 29655664, "comment_id": 47454267, "body": "@WumpusQ.Wumbley: I write a lot of embedded systems code, where extra cycles like that often do matter, and where 1990s C would be much nicer than assembly.  If feeding a function into an old compiler would require 30K of code that works, feeding the same function into a new compiler would yield 20K of code that doesn&#39;t work, and feeding the new compiler a version that was modified to work with it would yield 31K of code that runs slower than the original, I fail to see the benefit of the new compiler.  Is the above scenario not realistic?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1429120776, "post_id": 29655664, "comment_id": 47454512, "body": "@WumpusQ.Wumbley: I agree that code should be written to be portable, but would suggest that the proper way to achieve that would not be to declare that <code>123 &lt;&lt; 33</code> is equivalent to <code>__assume(0);</code> nor even that it&#39;s equivalent to some particular value, but say that compilers which go beyond the realm of common broadly-defined non-hyper-modern behaviors must document the situations where they may do so (though they need not document their behaviors in such situations).  Is there anything useful implementations could do without such a constraint that they couldn&#39;t do with it?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 1, "creation_date": 1429121183, "post_id": 29655664, "comment_id": 47454758, "body": "@WumpusQ.Wumbley: I really would like to know: given a choice between a compiler which specifies that none the aforementioned examples will cause unconstrained UB, and one which specifies that all of them may produce unconstrained UB, in what cases would a reasonable person prefer the latter?"}, {"owner": {"reputation": 5273, "user_id": 1430833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a754beedb3a29fe1ddfc28e900e33f2?s=128&d=identicon&r=PG", "display_name": "sfstewman", "link": "https://stackoverflow.com/users/1430833/sfstewman"}, "edited": false, "score": 1, "creation_date": 1431008814, "post_id": 29655664, "comment_id": 48319151, "body": "@WumpusQ.Wumbley what happens when someone changes the type on <code>ui</code>, to either 16-bits or 64-bits?  Your proposed <code>b&gt;=0&amp;&amp;b&lt;32?ui&lt;&lt;b:0</code> is quite fragile, and littering the code with assumptions about type width make it a nightmare to port to systems where  <code>int</code> is no longer 32-bits.  This seems like less Grown-up C to me, and more arbitrary-and-capricious C."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5273, "user_id": 1430833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a754beedb3a29fe1ddfc28e900e33f2?s=128&d=identicon&r=PG", "display_name": "sfstewman", "link": "https://stackoverflow.com/users/1430833/sfstewman"}, "edited": false, "score": 1, "creation_date": 1431011516, "post_id": 29655664, "comment_id": 48321324, "body": "@sfstewman: I don&#39;t think that&#39;s nearly as bad as requiring <code>ui*=1u*ui;</code> for safe multiplication.  Personally, I think what C needs is a grown-up standard that would allow code to specify types with as much or as little detail as required, e.g. &quot;I need something that can hold values 0-255, but a larger container would be acceptable as well&quot; to &quot;I need a type that behaves as a 32-bit wrapping unsigned integer, stored in two consecutive <code>unsigned short</code>, low-word first, addressable on <code>short</code> boundaries&quot;; for the latter, syntax might be something like:"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 5273, "user_id": 1430833, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a754beedb3a29fe1ddfc28e900e33f2?s=128&d=identicon&r=PG", "display_name": "sfstewman", "link": "https://stackoverflow.com/users/1430833/sfstewman"}, "edited": false, "score": 0, "creation_date": 1431012020, "post_id": 29655664, "comment_id": 48321712, "body": "@sfstewman: <code>typedef struct { unsigned short dat[2]; default unsigned-wrap value : { dat[1]&gt;&gt;0:16, dat[0]&gt;&gt;0:16; } } DBLSHORT_INT32 };</code>; putting <code>default</code> before an integer-type struct member would allow the struct to be used as as an integer-type lvalue or rvalue [with the operation applied to that lvalue or rvalue] and a brace-delimited list of struct members and bit ranges would make the named item alias the indicated portions of those members, listed MSB first].  The latter syntax would also be a portable way of expressing bit fields [define whole words, then bit-field portions of them]"}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431543937, "post_id": 29655664, "comment_id": 48550347, "body": "I don&#39;t know what &quot;mainstream 1990&#39;s&quot; platforms you were using, but none of the ones I was using would have admitted many of the things you claim above as correct.  Especially #6.  And #5, and probably #2, #3, and #4 depended entirely on your CPU and compiler, and was just and accident waiting to happen.  Its true the C standard has been bent way out of shape by over-zealous compiler vendors focussing far too much on extreme optimization.  See <a href=\"http://blog.regehr.org/archives/1180\" rel=\"nofollow noreferrer\">blog.regehr.org/archives/1180</a> for a proposed alternative safer from abusive optimizers."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 1, "creation_date": 1431546548, "post_id": 29655664, "comment_id": 48551803, "body": "@GregA.Woods: Can you list some mainstream compilers from the 1990s which would have not have behaved as indicated?  I&#39;ll concede #2 was dodgy, and I may not have chosen the best examples of behaviors, but with regard to #5 there are many situations when e.g. designing a graphics decoder where it&#39;s acceptable for a corrupt input stream to produce an arbitrary decoded result, but not for it to corrupt anything else.  Code which includes enough checks to ensure fully-deterministic behavior in all cases would be slower than code which merely had to avoid corrupting anything other than..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1431546798, "post_id": 29655664, "comment_id": 48551933, "body": "...the already-meaningless output data.  Otherwise, I&#39;m curious what sorts of widely-used compilers would have had behavior which differed from any I&#39;ve mentioned other than #2?  I&#39;ve looked at the blog you mention and I think it nails down many things too rigidly.  I have no problem saying that following <code>i=INT_MAX; i++;</code> the compiler should be allowed to treat <code>i</code> as merely being &quot;any value numerically congruent to (INT_MAX+1) mod (UINT_MAX+1)&quot;, with every rvalue conversion being allowed to arbitrarily yield a different such value.  That would allow many useful loop optimizations..."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1431546982, "post_id": 29655664, "comment_id": 48552028, "body": "...but would still uphold laws of time and causality.  I have no problem with the idea that computations without normal side-effects may be performed early, and could thus trap early, provided that implementations are required to document, at minimum, a means by which a trap could be made to yield behavior equivalent to (for C) a <code>longjmp</code> call to an earlier-established <code>setjmp</code> or (for C++) a throw of an exception.  Annex L suggests a trap-and-resume semantics, but support for those could be expensive.  Anyway, I&#39;d be interested to know what compilers behave contrary to my above."}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431548393, "post_id": 29655664, "comment_id": 48552782, "body": "I can&#39;t make sense of what you wrote in #2.  I think there are typos."}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431548705, "post_id": 29655664, "comment_id": 48552928, "body": "For #5, I want to confirm that you don&#39;t actually mean &quot;trap representation&quot; (as that phrase is used in C99)"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431548877, "post_id": 29655664, "comment_id": 48553004, "body": "@GregA.Woods: Ignore #2 if you like, though if you&#39;re interested the hardware of the ARM specifies that performing any of its shift or rotate operations with a value N from 1 to 255 will yield the same result as performing a single-bit shift N times; some other processors have similar guarantees even though x86 does not.  In some cases, code using this behavior can save a branch (e.g. when decoding a 32-bit value that spans a word boundary, <code>(lowWord &lt;&lt; bitOfs) | (highWord &gt;&gt; (32-bitOfs))</code> may be faster than using special-case code when `bitOfs is zero)."}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431549051, "post_id": 29655664, "comment_id": 48553095, "body": "As for #6, any code abusing <code>realloc()</code> in that way deserves what it gets from a new libc and/or new compiler and/or new CPU architecture.  Don&#39;t ever keep pointers into an object that you might have to move!  Use <code>offsetof()</code> if you must, but usually you should use the pointer selection operator every time you reference a field in a structure!"}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431549518, "post_id": 29655664, "comment_id": 48553321, "body": "Also for #5 I&#39;m not sure what you&#39;re worried about corrupting, though when you mention graphics decoders I&#39;m guessing you&#39;re talking about dodgy code that might use such a computed value as an array index (or otherwise use it to do dodgy pointer computations).  Is that right?"}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1431549564, "post_id": 29655664, "comment_id": 48553340, "body": "With regard to #6, it would be possible to avoid using anything other than a single pointer to the start of the allocated region, and have code pass around offsets all the time, but if a few items within the data structure are accessed a lot more often than the data structure is moved, keeping the locations of those items as pointers could significantly speed up such access.  Even if one kept redundant copies of the offsets, and regenerated the pointers using only those copies, it would still be helpful to be able to avoid regenerating those pointers when <code>realloc</code> doesn&#39;t move anything."}, {"owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "edited": false, "score": 0, "creation_date": 1431549895, "post_id": 29655664, "comment_id": 48553508, "body": "I think you really should just write assembly code in these cases.  You&#39;re talking as if you&#39;re expecting C to be just some better assembler syntax and you&#39;re apparently writing C with deep knowledge about the underlying CPU you&#39;re targeting; but then you&#39;re complaining that Standard C might cause your dodgy code to go haywire when you port it to a new compiler, or even just turn up the optimizer.  If you want to write <i>Standard C</i> then you need to write <i>only</i> for the C abstract machine the standard is centred on."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1431551053, "post_id": 29655664, "comment_id": 48554117, "body": "The whole reason C was invented was to allow systems-level code which would formerly have required assembly language to instead express things in a slightly-higher-level language; I don&#39;t know of any other language invented in the intervening years which is better for that purpose.  I don&#39;t think there was any intention that code which knows that it&#39;s only going to be run on hardware whose natural means of pointer comparison would guarantee that <code>p&gt;=base &amp;&amp; b&lt;base+size</code> implies that <code>p</code> points within the object defined by <code>base+size</code> shouldn&#39;t make use of that guarantee."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1431551306, "post_id": 29655664, "comment_id": 48554263, "body": "Trying to design an efficient operating system like Unix on a system which can&#39;t determine such relationships among arbitrary pointers would be much more difficult than on a system which can. I fully appreciate that some hardware platforms may not allow arbitrary pointer comparisons; the fact that one can&#39;t use C to write an OS on such platforms should neither imply that C shouldn&#39;t be used on that platform for things it can do, nor that such pointer comparisons shouldn&#39;t be used in programs which would only be useful on platforms that support them."}, {"owner": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1452923555, "post_id": 29655664, "comment_id": 57390117, "body": "The Google search for &quot;What Every Programmer Should Know About Undefined Behavior&quot; doesn&#39;t work as well as &quot;What Every C Programmer Should Know About Undefined Behavior&quot;, which can lead you to <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know.html\" rel=\"nofollow noreferrer\">Part 1</a>, <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_14.html\" rel=\"nofollow noreferrer\">Part 2</a> and <a href=\"http://blog.llvm.org/2011/05/what-every-c-programmer-should-know_21.html\" rel=\"nofollow noreferrer\">Part 3</a>, from May 2011."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "reply_to_user": {"reputation": 663663, "user_id": 15168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WtEI9.png?s=128&g=1", "display_name": "Jonathan Leffler", "link": "https://stackoverflow.com/users/15168/jonathan-leffler"}, "edited": false, "score": 0, "creation_date": 1453057107, "post_id": 29655664, "comment_id": 57425352, "body": "@JonathanLeffler: I&#39;m well aware that some compilers use Undefined Behavior as a means of making inferences about what inputs a program will receive, but my question is how one can write programs that can achieve the kind of semantics and performance which were available from simpler compilers."}], "answers": [{"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1488574946, "post_id": 30224970, "comment_id": 72308908, "body": "The authors of the Standard will generally specify that an action invokes Undefined Behavior if the cost of guaranteeing the behavior on the implementation where that is most expensive might exceed the benefits of guaranteeing the behavior for the application fields where would be worth the least.  This is an invitation to implementers to exercise judgment with regard to the cost and benefit for <i>their</i> target platforms and execution fields.  It is not a judgment that the quality implementations for targets where the behavior can be guaranteed at trivial cost shouldn&#39;t guarantee it."}], "tags": [], "owner": {"reputation": 2241, "user_id": 816536, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oeXXN.jpg?s=128&g=1", "display_name": "Greg A. Woods", "link": "https://stackoverflow.com/users/816536/greg-a-woods"}, "is_accepted": false, "score": 3, "last_activity_date": 1431550344, "creation_date": 1431550344, "answer_id": 30224970, "question_id": 29655664, "link": "https://stackoverflow.com/questions/29655664/what-replacements-are-available-for-formerly-widely-supported-behaviors-not-defi/30224970#30224970", "title": "What replacements are available for formerly-widely-supported behaviors not defined by C standard", "body": "<p>Modern Standard C is specified in such a way that it can be guaranteed to be portable if <em>and only if</em> you write your code with no more expectations about the underlying hardware it will run on than are given by the C abstract machine the standard implicitly and explicitly describes.</p>\n\n<p>You can still write for a specific compiler that has specific behaviour at a given optimization level for a given target CPU and architecture, but then <em>do not</em> expect any other compiler (modern or otherwise, or even a minor revision of the one you wrote for) to go out of its way to try to intuit your expectations if your code violates conditions where the Standard says that it is unreasonable to expect any well defined implementation agnostic behaviour.</p>\n"}, {"comments": [{"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1453056973, "post_id": 34823773, "comment_id": 57425297, "body": "Unfortunately, there are many situations where a compiler won&#39;t be able to optimize out tests.  For example, on all ARM processors, something like <code>lsr r0,r0,r1</code> would behave as <code>ro&gt;&gt;=r1</code> for r1 in the range 0 to 31, r0=0` for all r1 values in the range 32 to 127, but on at least some it will yield non-zero values for some other r1 values.  Thus, an expression like <code>r1 &gt; 31 ? 0 : r0&gt;&gt;r1</code> won&#39;t generally be able to optimize out the comparison even if the <code>lsr r0,r0,r1</code> would have yielded satisfactory results in all cases."}, {"owner": {"reputation": 4294, "user_id": 2738262, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ead9263d3f0f0cc74f54d5d9fdbaa4cd?s=128&d=identicon&r=PG", "display_name": "Damian Yerrick", "link": "https://stackoverflow.com/users/2738262/damian-yerrick"}, "reply_to_user": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1488573702, "post_id": 34823773, "comment_id": 72308276, "body": "@supercat It can if you use <code>assert</code> or similar to tell the compiler there will be no values greater than 127."}, {"owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "edited": false, "score": 0, "creation_date": 1488574308, "post_id": 34823773, "comment_id": 72308599, "body": "C was designed to be a simple language which would enable a programmer who was familiar with a platform to use a simple and lightweight compiler to generate reasonably-efficient code for that platform.  There is something backward about the notion that a programmer wanting to generate something that behaves like a simple &quot;lsr&quot; instruction with x and y as operands should need to write out a huge complicated mess and hope that a compiler will be able to simplify it, rather than simply being able to write out x&gt;&gt;y and having the compiler generate a platform-specific shift."}], "tags": [], "owner": {"reputation": 4294, "user_id": 2738262, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ead9263d3f0f0cc74f54d5d9fdbaa4cd?s=128&d=identicon&r=PG", "display_name": "Damian Yerrick", "link": "https://stackoverflow.com/users/2738262/damian-yerrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1452921301, "creation_date": 1452921301, "answer_id": 34823773, "question_id": 29655664, "link": "https://stackoverflow.com/questions/29655664/what-replacements-are-available-for-formerly-widely-supported-behaviors-not-defi/34823773#34823773", "title": "What replacements are available for formerly-widely-supported behaviors not defined by C standard", "body": "<p>Two general principles apply to standard C and standard C++:</p>\n\n<ul>\n<li>Behavior with unsigned numbers is usually better defined than behavior with signed numbers.</li>\n<li>Treat optimization as the quality-of-implementation issue that it is. This means that if you're worried about micro-optimization of a particular inner loop, you should <strong>read the assembly output</strong> of your compiler (such as with <code>gcc -S</code>), and if you discover that it fails to optimize well-defined behavior to appropriate machine instructions, <strong>file a defect report</strong> with the publisher of your compiler. (This doesn't work, however, when the publisher of the only practical compiler targeting a particular platform isn't very interested in optimization, such as cc65 targeting MOS 6502.)</li>\n</ul>\n\n<p>From these principles, you can usually derive a well-defined way to achieve the same result, and then apply the <a href=\"https://en.wikipedia.org/wiki/Trust,_but_verify\" rel=\"nofollow\">trust-but-verify principle</a> to the quality of generated code. For example, make shifting functions with well-defined behavior, and let the optimizer remove any unneeded checks that the architecture itself guarantees.</p>\n\n<pre><code>// Performs 2 for unsigned numbers.  Also works for signed\n// numbers due to rule for casting between signed and unsigned\n// integer types.\ninline uint32_t lsl32(uint32_t ui, unsigned int b) {\n  if (b &gt;= 32) return 0;\n  return ui &lt;&lt; b;\n}\n\n// Performs 3 for unsigned numbers.\ninline uint32_t lsr32(uint32_t ui, unsigned int b) {\n  if (b &gt;= 32) return 0;\n  return ui &gt;&gt; b;\n}\n\n// Performs 3 for signed numbers.\ninline int32_t asr32(int32_t si, unsigned int b) {\n  if (si &gt;= 0) return lsr32(si, b);\n  if (b &gt;= 31) return -1;\n  return ~(~(uint32)si &gt;&gt; b);\n}\n</code></pre>\n\n<p>For 4 and 5, cast to unsigned, do the math, and cast back to signed. This produces non-trapping well-defined behavior.</p>\n"}], "owner": {"reputation": 69012, "user_id": 363751, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/135a97c4150691234931a93f3a27a52f?s=128&d=identicon&r=PG", "display_name": "supercat", "link": "https://stackoverflow.com/users/363751/supercat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 345, "favorite_count": 1, "answer_count": 2, "score": 14, "last_activity_date": 1452921301, "creation_date": 1429115027, "last_edit_date": 1429117429, "question_id": 29655664, "link": "https://stackoverflow.com/questions/29655664/what-replacements-are-available-for-formerly-widely-supported-behaviors-not-defi", "title": "What replacements are available for formerly-widely-supported behaviors not defined by C standard", "body": "<p>In the early days of C prior to standardization, implementations had a variety of ways of handling exceptional and semi-exceptional cases of various actions.  Some of them would trigger traps which could cause random code execution if not configured first.  Because the behavior of such traps was outside the scope of the C standard (and may in some cases be controlled by an operating system outside the control of the running program), and to avoid requiring that compilers not allow code which had been relying upon such traps to keep on doing so, the behavior of actions that could cause such traps was left entirely up to the discretion of the compiler/platform.</p>\n\n<p>By the end of the 1990s, although not required to do so by the C standard, every mainstream compiler had adopted common behaviors for many of these situations; using such behaviors would allow improvements with respect to code speed, size, and readability.</p>\n\n<p>Since the \"obvious\" ways of requesting the following operations are no longer supported, how should one go about replacing them in such a way as to not impede readability nor adversely affect code generation when using older compilers?  For purposes of descriptions, assume <code>int</code> is 32-bit, <code>ui</code> is a unsigned int, <code>si</code> is signed int, and <code>b</code> is unsigned char.</p>\n\n<ol>\n<li><p>Given <code>ui</code> and <code>b</code>, compute <code>ui &lt;&lt; b</code> for b==0..31, or a value which may arbitrarily behave as <code>ui &lt;&lt; (b &amp; 31)</code> or zero for values 32..255.  Note that if the left-hand operand is zero whenever the right-hand operand exceeds 31, both behaviors will be identical.</p></li>\n<li><p>For code that only needs to run on a processor that yields zero when right-shifting or left-shifting by an amount from 32 to 255, compute <code>ui &lt;&lt; b</code> for b==0..31 and 0 for b==32..255.  While a compiler might be able to optimize out conditional logic designed to skip the shift for values 32..255 (so code would simply perform the shift that will yield the correct behavior), I don't know any way to formulate such conditional logic that would guarantee the compiler won't generate needless code for it.</p></li>\n<li><p>As with 1 and 2, but for right shifts.</p></li>\n<li><p>Given <code>si</code> and <code>b</code> such that b0..30 and <code>si*(1&lt;&lt;b)</code> would not overflow, compute <code>si*(1&lt;&lt;b)</code>.  Note that use of the multiplication operator would grossly impair performance on many older compilers, but if the purpose of the shift is to scale a signed value, casting to unsigned in cases where the operand would remain negative throughout shifting feels wrong.</p></li>\n<li><p>Given various integer values, perform additions, subtractions, multiplications, and shifts, such fashion that if there are no overflows the results will be correct, and if there are overflows the code will either produce values whose upper bits behave in non-trapping and non-UB but otherwise indeterminate fashion or will trap in <em>recognizable</em> platform-defined fashion (and on platforms which don't support traps, would simply yield indeterminate value).</p></li>\n<li><p>Given a pointer to an allocated region and some pointers to things within it, use <code>realloc</code> to change the allocation size and adjust the aforementioned pointers to match, while avoiding extra work in cases where <code>realloc</code> returns the original block.  Not necessarily possible on all platforms, but 1990s mainstream platforms would all allow code to determine if <code>realloc</code> caused things to move, and determine the what the offset of a pointer into a dead object used to be by subtracting the former base address of that object (note that the adjustment would need to be done by computing the offset associated with each dead pointer, and then adding it the new pointer, rather than by trying to compute the \"difference\" between old and new pointers--something that would legitimately fail on many segmented architectures).</p></li>\n</ol>\n\n<p>Do \"hyper-modern\" compilers provide any good replacements for the above which would not degrade at least one of code size, speed, or readability, while offering no improvements in any of the others?  From what I can tell, not only could 99% of compilers throughout the 1990s do all of the above, but for each example one would have been able to write the code the same way on nearly all of them.  A few compilers might have tried to optimize left-shifts and right-shifts with an unguarded jump table, but that's the only case I can think of where a 1990s compiler for a 1990s platform would have any problem with the \"obvious\" way of coding any of the above.  If that hyper-modern compilers have ceased to support the classic forms, what do they offer as replacements?</p>\n"}, {"tags": ["c", "memory", "malloc", "free"], "comments": [{"owner": {"reputation": 58995, "user_id": 1322972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/puZFr.png?s=128&g=1", "display_name": "WhozCraig", "link": "https://stackoverflow.com/users/1322972/whozcraig"}, "edited": false, "score": 0, "creation_date": 1429114464, "post_id": 29655051, "comment_id": 47450664, "body": "If you <code>malloc</code>, eventually someone is going to need to <code>free</code>, be it you in another api or the caller. Related, if supported on your target platform(s), <a href=\"http://pubs.opengroup.org/stage7tc1/functions/getdelim.html\" rel=\"nofollow noreferrer\"><code>getline</code></a>, a library function added to POSIX.1-2008, would seem to <i>nearly</i> do what you&#39;re trying to implement. It still requires the caller to eventually <code>free</code> any returned allocations, but also provides reuse semantics, where your code does <i>not</i>. Depending on intended usage and target platform(s), it may be worth considering."}], "answers": [{"comments": [{"owner": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "edited": false, "score": 0, "creation_date": 1429115859, "post_id": 29655158, "comment_id": 47451476, "body": "He can&#39;t use local arrays, since when it returns and the function&#39;s stack frame gets destroyed, there will be no way of guaranteeing the array will be intact. The compiler will give you a warning: &quot;function returns address of local variable [-Wreturn-local-addr]&quot;. Other than that, good answer."}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "reply_to_user": {"reputation": 2762, "user_id": 1928852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/emKlb.png?s=128&g=1", "display_name": "Enzo Ferber", "link": "https://stackoverflow.com/users/1928852/enzo-ferber"}, "edited": false, "score": 1, "creation_date": 1429118397, "post_id": 29655158, "comment_id": 47453024, "body": "@EnzoFerber I meant pass the array to the function and fill it there, I know that you must not return a local array. I think I need to clarify that."}], "tags": [], "owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "is_accepted": true, "score": 22, "last_activity_date": 1429121462, "last_edit_date": 1429121462, "creation_date": 1429113583, "answer_id": 29655158, "question_id": 29655051, "link": "https://stackoverflow.com/questions/29655051/proper-way-to-free-memory-of-a-returned-variable/29655158#29655158", "title": "Proper Way to Free Memory of a Returned Variable", "body": "<p>It's quite simple, as long as you pass to <code>free()</code> the same pointer returned by <code>malloc()</code> it's fine.</p>\n\n<p>For example</p>\n\n<pre><code>char *readInput(size_t size)\n {\n    char *input;\n    int   chr;\n    input = malloc(size + 1);\n    if (input == NULL)\n        return NULL;\n    while ((i &lt; size) &amp;&amp; ((chr = getchar()) != '\\n') &amp;&amp; (chr != EOF))\n        input[i++] = chr;\n    input[size] = '\\0'; /* nul terminate the array, so it can be a string */\n    return input;\n }\n\n int main(void)\n  {\n     char *input;\n     input = readInput(100);\n     if (input == NULL)\n         return -1;\n     printf(\"input: %s\\n\", input);\n     /* now you can free it */\n     free(input);\n     return 0;\n  }\n</code></pre>\n\n<p>What you should never do is something like</p>\n\n<pre><code>free(input + n);\n</code></pre>\n\n<p>because <code>input + n</code> is not the pointer return by <code>malloc()</code>.</p>\n\n<p>But your code, has other issues you should take care of</p>\n\n<ol>\n<li><p>You are allocating space for <code>MAX_SIZE</code> <code>char</code>s so you should multiply by <code>sizeof(char)</code> which is <code>1</code>, instead of <code>sizeof(char *)</code> which would allocate <code>MAX_SIZE</code> pointers, and also you could make <code>MAX_SIZE</code> a function parameter instead, because if you are allocating a fixed buffer, you could define an array in <code>main()</code> with size <code>MAX_SIZE</code> like <code>char input[MAX_SIZE]</code>, and pass it to <code>readInput()</code> as a parameter, thus avoiding <code>malloc()</code> and <code>free()</code>.</p></li>\n<li><p>You are allocating that much space but you don't prevent overflow in your <code>while</code> loop, you should verify that <code>i &lt; MAX_SIZE</code>.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 97521, "user_id": 565635, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7b4b3e7c9ac68b7d2c93ad02d0b9c79d?s=128&d=identicon&r=PG", "display_name": "orlp", "link": "https://stackoverflow.com/users/565635/orlp"}, "is_accepted": false, "score": 5, "last_activity_date": 1429113597, "creation_date": 1429113597, "answer_id": 29655168, "question_id": 29655051, "link": "https://stackoverflow.com/questions/29655051/proper-way-to-free-memory-of-a-returned-variable/29655168#29655168", "title": "Proper Way to Free Memory of a Returned Variable", "body": "<p>You could write a function with return type <code>char*</code>, return <code>input</code>, and ask the user to call <code>free</code> once their done with the data.</p>\n\n<p>You could also ask the user to pass in a properly sized buffer themselves, together with a buffer size limit, and return how many characters were written to the buffer.</p>\n"}, {"tags": [], "owner": {"reputation": 32321, "user_id": 173397, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pqKT8.jpg?s=128&g=1", "display_name": "pm100", "link": "https://stackoverflow.com/users/173397/pm100"}, "is_accepted": false, "score": 2, "last_activity_date": 1429114894, "creation_date": 1429114894, "answer_id": 29655627, "question_id": 29655051, "link": "https://stackoverflow.com/questions/29655051/proper-way-to-free-memory-of-a-returned-variable/29655627#29655627", "title": "Proper Way to Free Memory of a Returned Variable", "body": "<p>This is a classic c case. A function mallocs memory for its result, the caller must free the returned value. You are now walking onto the thin ice of c memory leaks. 2 reasons</p>\n\n<p>First ; there is no way for you to communicate the free requirement in an enforceable way (ie the compiler or runtime can't help you - contrast with specifying what the argument types are ). You just have to document it somewhere and hope that the caller has read your docs</p>\n\n<p>Second: even if the caller knows to free the result he might make a mistake, some error path gets taken that doesnt free the memory. This doesnt cause an immediate error, things seem to work, but after running for 3 weeks your app crashes after running out of memory</p>\n\n<p>This is why so many 'modern' languages focus on this topic, c++ smart pointers, Java, C#, etc garbage collection,...</p>\n"}], "owner": {"reputation": 373, "user_id": 2666162, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/22e6353d6de8b8d8ce6789a6f34de1c9?s=128&d=identicon&r=PG", "display_name": "w m", "link": "https://stackoverflow.com/users/2666162/w-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21509, "favorite_count": 5, "accepted_answer_id": 29655158, "answer_count": 3, "score": 23, "last_activity_date": 1600541751, "creation_date": 1429113266, "question_id": 29655051, "link": "https://stackoverflow.com/questions/29655051/proper-way-to-free-memory-of-a-returned-variable", "title": "Proper Way to Free Memory of a Returned Variable", "body": "<p>I created a function designed to get user input. It requires that memory be allocated to the variable holding the user input; however, that variable is returned at the end of the function. What is the proper method to free the allocated memory/return the value of the variable?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>char *input = malloc(MAX_SIZE*sizeof(char*));\nint i = 0;\nchar c;\n\nwhile((c = getchar()) != '\\n' &amp;&amp; c != EOF) {\n    input[i++] = c;\n}\n\nreturn input;\n</code></pre>\n\n<p>Should I return the address of input and free it after it is used?</p>\n\n<p>Curious as to the most proper method to free the input variable.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 1, "creation_date": 1429112057, "post_id": 29654372, "comment_id": 47448790, "body": "Looking at your program without a rigorous inspection tells me that since you ignore the return value of <code>scanf()</code> you can&#39;t complain about wrong results."}, {"owner": {"reputation": 45, "user_id": 4789900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b543da7016ccb71986f53d828202c30?s=128&d=identicon&r=PG&f=1", "display_name": "UcfKnight", "link": "https://stackoverflow.com/users/4789900/ucfknight"}, "reply_to_user": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429112167, "post_id": 29654372, "comment_id": 47448878, "body": "how do i not ignore the return value? sorry, im struggling in my programming class right now"}, {"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429112260, "post_id": 29654372, "comment_id": 47448948, "body": "You need to check, specially when the specifier is <code>&quot;%d&quot;</code> -&gt; <code>if (scanf(&quot;%d&quot;, &amp;target) != 1) problem(); else ok();</code> But your problem, was the semicolon as @<a href=\"http://stackoverflow.com/a/29654555/1983495\">Ian</a> explained."}, {"owner": {"reputation": 5542, "user_id": 1076451, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/ZTP3Q.jpg?s=128&g=1", "display_name": "Chimera", "link": "https://stackoverflow.com/users/1076451/chimera"}, "edited": false, "score": 0, "creation_date": 1429112588, "post_id": 29654372, "comment_id": 47449183, "body": "Don&#39;t you need a hints field somewhere in  your struct? And what is the matches field for?"}, {"owner": {"reputation": 45, "user_id": 4789900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b543da7016ccb71986f53d828202c30?s=128&d=identicon&r=PG&f=1", "display_name": "UcfKnight", "link": "https://stackoverflow.com/users/4789900/ucfknight"}, "edited": false, "score": 0, "creation_date": 1429193417, "post_id": 29654372, "comment_id": 47492067, "body": "i think the matches field IS the hints field. As in, the starred out words are the words we&#39;re supposed to be watching with the original words we inputted"}], "answers": [{"comments": [{"owner": {"reputation": 50953, "user_id": 1983495, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/aMDiK.jpg?s=128&g=1", "display_name": "Iharob Al Asimi", "link": "https://stackoverflow.com/users/1983495/iharob-al-asimi"}, "edited": false, "score": 0, "creation_date": 1429112140, "post_id": 29654511, "comment_id": 47448856, "body": "That&#39;s is nothing less than <b>UNDEFINED BEHAVIOR</b>, <code>fflush()</code> is only defined for output streams, it might work with the <code>MSVC</code> compiler, but it&#39;s not specified by the standard, so I and many other would never, never do that."}], "tags": [], "owner": {"reputation": 214, "user_id": 3207189, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001177461496/picture?type=large", "display_name": "Defter", "link": "https://stackoverflow.com/users/3207189/defter"}, "is_accepted": false, "score": -1, "last_activity_date": 1429112141, "last_edit_date": 1429112141, "creation_date": 1429112053, "answer_id": 29654511, "question_id": 29654372, "link": "https://stackoverflow.com/questions/29654372/password-recovery-program/29654511#29654511", "title": "Password recovery program", "body": "<p>Just use <code>fflush(stdin);</code> before every <code>scanf()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4789900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b543da7016ccb71986f53d828202c30?s=128&d=identicon&r=PG&f=1", "display_name": "UcfKnight", "link": "https://stackoverflow.com/users/4789900/ucfknight"}, "edited": false, "score": 0, "creation_date": 1429112749, "post_id": 29654555, "comment_id": 47449331, "body": "Thank you, that was a dumb mistake on my part"}], "tags": [], "owner": {"reputation": 1551, "user_id": 4727360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/641b8a5386aa6c8c271b382292cf5b98?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4727360/ian"}, "is_accepted": false, "score": 1, "last_activity_date": 1429112144, "creation_date": 1429112144, "answer_id": 29654555, "question_id": 29654372, "link": "https://stackoverflow.com/questions/29654372/password-recovery-program/29654555#29654555", "title": "Password recovery program", "body": "<p>Remove the semicolon after your for loop conditions:</p>\n\n<pre><code>   for(i=0; i&lt;N; i++)\n   {\n        scanf(\"%s\", &amp;A[i].password);\n   }\n</code></pre>\n\n<p>that's a start anyway.</p>\n"}], "owner": {"reputation": 45, "user_id": 4789900, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4b543da7016ccb71986f53d828202c30?s=128&d=identicon&r=PG&f=1", "display_name": "UcfKnight", "link": "https://stackoverflow.com/users/4789900/ucfknight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1429112144, "creation_date": 1429111707, "question_id": 29654372, "link": "https://stackoverflow.com/questions/29654372/password-recovery-program", "title": "Password recovery program", "body": "<p>I'm supposed to use a function and structs to create a program that allows the user to input a list of passwords and a list of password hints and only one of them is the correct one. You're supposed to match your hints with the possible passwords that you have inputted and determine the correct password from there.  Here's a sample run:<br>\nInput:<br>\n3<br>\npassword<br>\nsecret11<br>\nqwertyui<br>\nOutput:<br>\n4<br>\n*******1<br>\ns*******<br>\n*e******<br>\n*******q<br>\nsecret11  </p>\n\n<p>Here is what i have so far: </p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\n\nstruct Option {\n    char password[50];\n    int matches;\n};\n// Checks to see if the given password matches the given pattern.\n// Returns false (0) if it does not, or true (1) if it does.\nint is_match(char password[], char pattern[]){\n\n\n\n\n\n}\nint main(){\n    int N,i;\n    printf(\"Enter the N value\\n\");\n    scanf(\"%d\", &amp;N);\n\n    struct Option A[100];\n    for(i=0; i&lt;N; i++);{\n        scanf(\"%s\", &amp;A[i].password);\n    }\n\n    int M;\n    scanf(\"%d\", &amp;M);\n\n    //struct Option A[100];\n    int j;\n    for(j=0; j&lt;M; j++);{\n        scanf(\"%s\", &amp;A[i].matches);\n    }\n\n\n\n\n    return 0;\n}\n</code></pre>\n\n<p>My program stops at the first scanf and only lets me input two of the passwords. I don't know how to debug at this step.</p>\n"}, {"tags": ["c", "assembly", "reverse-engineering", "nios"], "comments": [{"owner": {"reputation": 1551, "user_id": 4727360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/641b8a5386aa6c8c271b382292cf5b98?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4727360/ian"}, "edited": false, "score": 0, "creation_date": 1429113091, "post_id": 29654207, "comment_id": 47449642, "body": "You should ask a more specific question.  See <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>."}, {"owner": {"reputation": 45, "user_id": 4792592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ad55441c0cd8b50f0c2961d3768f43?s=128&d=identicon&r=PG&f=1", "display_name": "jack bloom", "link": "https://stackoverflow.com/users/4792592/jack-bloom"}, "reply_to_user": {"reputation": 1551, "user_id": 4727360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/641b8a5386aa6c8c271b382292cf5b98?s=128&d=identicon&r=PG&f=1", "display_name": "Ian", "link": "https://stackoverflow.com/users/4727360/ian"}, "edited": false, "score": 1, "creation_date": 1429113496, "post_id": 29654207, "comment_id": 47449944, "body": "why isn&#39;t it specific ? the code is in ASSEMBLY and I have to write it in C"}, {"owner": {"reputation": 1715, "user_id": 3543752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd4b55278e916b23f5c2f5d8ea40c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Budlong", "link": "https://stackoverflow.com/users/3543752/brad-budlong"}, "edited": false, "score": 0, "creation_date": 1429117602, "post_id": 29654207, "comment_id": 47452550, "body": "I assume that this is a function named &quot;mystery&quot;, but arguments to a function should be passed in r4-r7.  However that doesn&#39;t appear to be the case here.  What is the assumption on the value of r0?  It is the only register used before being written. Is this function supposed to have a return value?  The convention is to return the value in r2-r3.  Basically we need to understand the calling convention used here in order to translate to C."}, {"owner": {"reputation": 45, "user_id": 4792592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ad55441c0cd8b50f0c2961d3768f43?s=128&d=identicon&r=PG&f=1", "display_name": "jack bloom", "link": "https://stackoverflow.com/users/4792592/jack-bloom"}, "edited": false, "score": 0, "creation_date": 1429118394, "post_id": 29654207, "comment_id": 47453020, "body": "the register r0 containts zeros, and I don&#39;t have the calling code. and that&#39;s right the registers r4-r7 are used to pass the arguments and the register r2 is for the returning the values.  How about the first line ? does somebody know what it serves for ?"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4792592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ad55441c0cd8b50f0c2961d3768f43?s=128&d=identicon&r=PG&f=1", "display_name": "jack bloom", "link": "https://stackoverflow.com/users/4792592/jack-bloom"}, "edited": false, "score": 0, "creation_date": 1429122719, "post_id": 29657974, "comment_id": 47455742, "body": "ldw r14, (r5) = *r14 ?  is it because theres nothing beside the (r5) ? can you explain a little bit please ?"}, {"owner": {"reputation": 1715, "user_id": 3543752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd4b55278e916b23f5c2f5d8ea40c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Budlong", "link": "https://stackoverflow.com/users/3543752/brad-budlong"}, "reply_to_user": {"reputation": 45, "user_id": 4792592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ad55441c0cd8b50f0c2961d3768f43?s=128&d=identicon&r=PG&f=1", "display_name": "jack bloom", "link": "https://stackoverflow.com/users/4792592/jack-bloom"}, "edited": false, "score": 0, "creation_date": 1429122947, "post_id": 29657974, "comment_id": 47455890, "body": "ldw loads the value pointed to by r5 in r14.  The address in r5 is a byte address, but the item there is a word.  r5 was created by taking the array address and adding 4 times the offset which is r2.  That 4 times piece is there to create a word address instead of a byte address.  C does that for you automatically in the array operation.  So that all becomes &#39;r14 = array[r2]&#39;"}], "tags": [], "owner": {"reputation": 1715, "user_id": 3543752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fd4b55278e916b23f5c2f5d8ea40c3b?s=128&d=identicon&r=PG&f=1", "display_name": "Brad Budlong", "link": "https://stackoverflow.com/users/3543752/brad-budlong"}, "is_accepted": true, "score": 0, "last_activity_date": 1429122460, "creation_date": 1429122460, "answer_id": 29657974, "question_id": 29654207, "link": "https://stackoverflow.com/questions/29654207/nios-ii-assembly-code-to-c/29657974#29657974", "title": "Nios II assembly code to C", "body": "<p>I don't believe that <code>array .word ?</code> is correct syntax. I think it is just representing that there is an array of some size at the location array.  Here's the translation:</p>\n\n<pre><code>int *array[];\nvoid mystery () {\n    int r2;\n    int *r14;\n    for (r2 = 0; r2 &lt;= 32; r2++) {\n        r14 = array[r2];\n        r14[r2] = 0;\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4792592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2ad55441c0cd8b50f0c2961d3768f43?s=128&d=identicon&r=PG&f=1", "display_name": "jack bloom", "link": "https://stackoverflow.com/users/4792592/jack-bloom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "accepted_answer_id": 29657974, "answer_count": 1, "score": -1, "last_activity_date": 1429122460, "creation_date": 1429111273, "last_edit_date": 1429111509, "question_id": 29654207, "link": "https://stackoverflow.com/questions/29654207/nios-ii-assembly-code-to-c", "title": "Nios II assembly code to C", "body": "<p>I'm trying to write the code below in C but I have a real problem with doing that so if someone can help me out and explain to me in the same time I'd be grateful. </p>\n\n<pre><code>array .word ? \nmystery: \n  add r2,r0,r0\n  addi r7,r0,32\nloop: \n  movia r4, array\n  slli r3,r2,2\n  add r5,r3,r4\n  ldw r14, (r5)\n  add r15, r3, r14\n  stw r0, (r15) \n  addi r2, r2, 1\n  bge r7,r2,loop\n  ret \n</code></pre>\n"}, {"tags": ["c", "assembly", "masm"], "comments": [{"owner": {"reputation": 52685, "user_id": 980550, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/8emhY.jpg?s=128&g=1", "display_name": "lurker", "link": "https://stackoverflow.com/users/980550/lurker"}, "edited": false, "score": 0, "creation_date": 1429141804, "post_id": 29654183, "comment_id": 47465335, "body": "Did you try just adding it as you would normally in C, with <code>#include &lt;stdio.h&gt;</code> and then make sure you link including standard C library."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1429169956, "post_id": 29654183, "comment_id": 47475072, "body": "include <code>msvcrt.inc</code> and link against <code>msvcrt.lib</code>. Then you can use <code>crt_printf</code>."}], "answers": [{"comments": [{"owner": {"reputation": 934, "user_id": 3865116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/X8T4l.jpg?s=128&g=1", "display_name": "vedran", "link": "https://stackoverflow.com/users/3865116/vedran"}, "edited": false, "score": 0, "creation_date": 1429284137, "post_id": 29668361, "comment_id": 47542242, "body": "I don&#39;t fully understand your code, I&#39;m in high school and we learn this. Professor told me to find a way to call printf from the C function in C.c file. And I need to call that function in assembler, but function in C.c needs to printf..."}, {"owner": {"reputation": 13243, "user_id": 3512216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kg2sx.gif?s=128&g=1", "display_name": "rkhb", "link": "https://stackoverflow.com/users/3512216/rkhb"}, "reply_to_user": {"reputation": 934, "user_id": 3865116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/X8T4l.jpg?s=128&g=1", "display_name": "vedran", "link": "https://stackoverflow.com/users/3865116/vedran"}, "edited": false, "score": 0, "creation_date": 1429286103, "post_id": 29668361, "comment_id": 47543602, "body": "@vblazenka: Take a look at my upgraded answer. The point is to add a <code>PROTO C</code> directive to the assembly. The example is tested with Visual Studio Express 2010. If you use a different C-compiler, please tell it (the best is to describe the steps to make the executable)."}], "tags": [], "owner": {"reputation": 13243, "user_id": 3512216, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Kg2sx.gif?s=128&g=1", "display_name": "rkhb", "link": "https://stackoverflow.com/users/3512216/rkhb"}, "is_accepted": false, "score": 0, "last_activity_date": 1429286327, "last_edit_date": 1429286327, "creation_date": 1429170148, "answer_id": 29668361, "question_id": 29654183, "link": "https://stackoverflow.com/questions/29654183/how-to-call-printf-from-a-c-function-that-i-call-in-the-masm-assembler/29668361#29668361", "title": "How to call printf from a C function that I call in the MASM assembler?", "body": "<p>You need to link to an appropriate library (e.g. <code>msvcrt.lib</code>) and you need to know the exported names of the functions. To detect the names I use <a href=\"http://timtabor.com/dumpbinGUI/\" rel=\"nofollow\"><em>dumbinGUI</em></a>.</p>\n\n<p>The calling conventions of C-functions is called \"cdecl\". The arguments are pushed onto the stack and the stack have to be adjusted after the call. You can let MASM do that job by using <code>INVOKE</code>, if you declare the function as <code>PROTO C</code>.</p>\n\n<p>Example:</p>\n\n<p><strong>test.asm:</strong></p>\n\n<pre><code>.686\n.model FLAT\n\nINCLUDELIB msvcrt.lib\nprintf PROTO C, :VARARG\nexit PROTO C, :DWORD\n\n; Functions in C.c:\ngreater PROTO C :DWORD, :DWORD          ; Declaration of greater (int,int)\nhello PROTO C                           ; Declaration of hello (void)\n\n.data\nfmt db \"%s %u\", 10, 0                   ; '10': printf of msvcrt.dll doesn't accept \"\\n\"\nPorukaZaIspis db \"Message from ASM: \", 0\n\n.code\n_main PROC\n    invoke greater, 8, 3\n    call output                         ; \"Message from ASM ...\"\n    invoke hello                        ; \"Message from C ...\"\n    invoke exit, 0\n_main ENDP\n\noutput PROC                             ; ARG: EAX\n    invoke printf, OFFSET fmt, OFFSET PorukaZaIspis, eax\n    ret\noutput ENDP\n\nEND _main\n</code></pre>\n\n<p>Let's add an output function to the C file:</p>\n\n<p><strong>C.c:</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid hello ()\n{\n    puts (\"Message from C: hello\");\n}\n\nint greater(int a, int b)\n{\n    if ( a &gt; b)\n        return a;\n    else\n        return b;\n}\n</code></pre>\n\n<p>Play with following batch file:</p>\n\n<pre><code>@ECHO OFF\nSET VS_PATH=&lt;Full\\Path\\to\\Visual Studio\\e.g.\\C:\\Program Files\\Microsoft Visual Studio 10.0&gt;\n\nSET PATH=%VS_PATH%\\VC\\bin\nSET LIB=%VS_PATH%\\VC\\lib\nSET INCLUDE=%VS_PATH%\\VC\\include\n\nSET CALLER=test.asm\nSET CALLEE=C.c\nSET TARGET=test.exe\n\necho cl_first\ndel %TARGET%\ncall :cl_first %CALLER% %CALLEE% %TARGET%\nif exist %TARGET% %TARGET%\n\necho.\necho ml_first\ndel %TARGET%\ncall :ml_first %CALLER% %CALLEE% %TARGET%\nif exist %TARGET% %TARGET%\n\ngoto :eof\n\n:cl_first\ncl /nologo /c %2\nml /nologo /Fe%3 %1 %~n2.obj /link /nologo\ngoto :eof\n\n:ml_first\nml /nologo /c %1\ncl /nologo /Fe%3 %~n1.obj %~n2.c /link /nologo\ngoto :eof\n</code></pre>\n"}], "owner": {"reputation": 934, "user_id": 3865116, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/X8T4l.jpg?s=128&g=1", "display_name": "vedran", "link": "https://stackoverflow.com/users/3865116/vedran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4264, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1429286327, "creation_date": 1429111212, "last_edit_date": 1429111298, "question_id": 29654183, "link": "https://stackoverflow.com/questions/29654183/how-to-call-printf-from-a-c-function-that-i-call-in-the-masm-assembler", "title": "How to call printf from a C function that I call in the MASM assembler?", "body": "<p>I have a C file called C.c and for now in that file I have one function that compares two numbers and saves the greater number to the register eax.</p>\n\n<p>I need help with creating the second function that will call <code>printf</code> inside and print some text. How to add support for <code>printf</code> in C that I can call from MASM assembler?</p>\n\n<p>My masm file:</p>\n\n<pre><code>    TITLE MASM Template (main.asm)\n.386\n.model FLAT\n.stack 4096\n\nWriteString PROTO stdcall\nReadChar PROTO stdcall\nCrlf PROTO stdcall\nExitProcess PROTO stdcall:DWORD\ngreater PROTO C :DWORD, :DWORD\n\n\n.data\nPorukaZaIspis db \"Poruka za ispis\", 0\n\n.code\n_main PROC\n\npush 8\npush 3\ncall greater\n\n\ncall Crlf\nmov edx, OFFSET PorukaZaIspis\ncall WriteString\ncall ReadChar\nInvoke ExitProcess, 0\n_main ENDP\nEND _main\n\nEND\n</code></pre>\n\n<p>My C.c file:</p>\n\n<pre><code>int greater(int a, int b) {\nif ( a &gt; b)\nreturn a;\nelse \nreturn b;\n}\n</code></pre>\n"}, {"tags": ["c", "string"], "answers": [{"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": true, "score": 4, "last_activity_date": 1429110309, "last_edit_date": 1429110309, "creation_date": 1429109958, "answer_id": 29653730, "question_id": 29653612, "link": "https://stackoverflow.com/questions/29653612/cant-find-the-bug-in-the-program-to-print-the-input-lines-longer-than-80-charac/29653730#29653730", "title": "Can&#39;t find the bug in the program to print the input lines longer than 80 characters", "body": "<pre><code>    if(c=='\\n'){\n        k[i] = c;\n        ++i;\n  } \n</code></pre>\n\n<p>By incrementing <code>i</code> you have array out of bound access and your question itself leads to undefined behavior which is storing more than 80 characters in an array which can hold 80 characters.</p>\n\n<pre><code>char line[80];\n</code></pre>\n\n<p>Make array size more than 80 characters like</p>\n\n<pre><code>char line[200];\n</code></pre>\n\n<p>Then try to do what you are doing and add a check before writing to array <code>line</code> </p>\n\n<pre><code>if(i &gt; 200)\n{\n   printf(\"Array can't hold this character\\n\");\n   // break or return\n} \n</code></pre>\n\n<p>Your <code>lim</code> should be <code>200</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 820, "user_id": 4266707, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh4.googleusercontent.com/-fLyyGXepW68/AAAAAAAAAAI/AAAAAAAAABI/RjSsIhv1dvs/photo.jpg?sz=128", "display_name": "Javia1492", "link": "https://stackoverflow.com/users/4266707/javia1492"}, "is_accepted": false, "score": 2, "last_activity_date": 1429110020, "creation_date": 1429110020, "answer_id": 29653755, "question_id": 29653612, "link": "https://stackoverflow.com/questions/29653612/cant-find-the-bug-in-the-program-to-print-the-input-lines-longer-than-80-charac/29653755#29653755", "title": "Can&#39;t find the bug in the program to print the input lines longer than 80 characters", "body": "<p>You initialize your array to 80, but you're trying to print strings with more than 80 characters so you will always print blank because you will never have the scenario (nor can you store more than 80 chars). Change the initialization for <code>k[]</code> and <code>line[]</code> to something larger than 80, or use vectors for automatic re-sizing.</p>\n"}], "owner": {"reputation": 360, "user_id": 4393375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/4HnA9.png?s=128&g=1", "display_name": "jimo", "link": "https://stackoverflow.com/users/4393375/jimo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 29653730, "answer_count": 2, "score": 0, "last_activity_date": 1429176157, "creation_date": 1429109696, "last_edit_date": 1429176157, "question_id": 29653612, "link": "https://stackoverflow.com/questions/29653612/cant-find-the-bug-in-the-program-to-print-the-input-lines-longer-than-80-charac", "title": "Can&#39;t find the bug in the program to print the input lines longer than 80 characters", "body": "<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n#define PRINT 80\n\nint get_line(char k[], int lim);\n\nint main(){\n\n    int len;\n    char line[PRINT];\n\n    while((len = get_line(line, PRINT)) &gt; 0){\n        if(len &gt; PRINT){\n            printf(\"%s\", line);\n        }\n    }    \n}\n\n\nint get_line(char k[], int lim){\n\n    int i, c;\n\n    for (i =0; i &lt; lim-1 &amp;&amp; (c=getchar()) != EOF &amp;&amp; c!= '\\n'; ++i){\n        k[i] = c;\n    }\n\n    if(c == '\\n'){\n        k[i] = c;\n        ++i;\n     } \n\n    k[i] = '\\0';\n\n    return i;\n\n}\n</code></pre>\n\n<p>The above stated code is written to print all the input lines with length greater than 80 characters, but it is not printing anything. The code compiles without any errors. I can't figure out where I am going wrong.</p>\n"}, {"tags": ["c", "avr", "atmel"], "comments": [{"owner": {"reputation": 34717, "user_id": 192910, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/de26f9c446ae47545220ff9eff3e3ef7?s=128&d=identicon&r=PG", "display_name": "Mawg says reinstate Monica", "link": "https://stackoverflow.com/users/192910/mawg-says-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1429110251, "post_id": 29653577, "comment_id": 47447415, "body": "Why not email them &amp; ask?"}], "answers": [{"comments": [{"owner": {"reputation": 4890, "user_id": 1563123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fJprA.jpg?s=128&g=1", "display_name": "Engine", "link": "https://stackoverflow.com/users/1563123/engine"}, "edited": false, "score": 0, "creation_date": 1429110993, "post_id": 29653874, "comment_id": 47447960, "body": "thanks for your answer. do you mean the zip file here :<a href=\"http://www.atmel.com/tools/AVRSOFTWAREFRAMEWORK.aspx?tab=overview\" rel=\"nofollow noreferrer\">atmel.com/tools/AVRSOFTWAREFRAMEWORK.aspx?tab=overview</a>    ?"}], "tags": [], "owner": {"reputation": 12255, "user_id": 104863, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/E3kX6.jpg?s=128&g=1", "display_name": "Vicky", "link": "https://stackoverflow.com/users/104863/vicky"}, "is_accepted": true, "score": 1, "last_activity_date": 1429110340, "creation_date": 1429110340, "answer_id": 29653874, "question_id": 29653577, "link": "https://stackoverflow.com/questions/29653577/is-there-a-way-to-download-atmel-examples/29653874#29653874", "title": "Is there a way to download Atmel examples?", "body": "<p>Yes, via the download link at the side of the page you linked to ( <a href=\"http://asf.atmel.com/docs/latest/download.html\" rel=\"nofollow\">http://asf.atmel.com/docs/latest/download.html</a> ) and clicking on the \"Download\" link for the ASF source code (not the tools).</p>\n"}], "owner": {"reputation": 4890, "user_id": 1563123, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fJprA.jpg?s=128&g=1", "display_name": "Engine", "link": "https://stackoverflow.com/users/1563123/engine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 0, "accepted_answer_id": 29653874, "answer_count": 1, "score": 0, "last_activity_date": 1429110340, "creation_date": 1429109613, "question_id": 29653577, "link": "https://stackoverflow.com/questions/29653577/is-there-a-way-to-download-atmel-examples", "title": "Is there a way to download Atmel examples?", "body": "<p>I'm getting start with a new Atmel board , for that I found this documentation :</p>\n\n<p><a href=\"http://asf.atmel.com/docs/latest/xmega.drivers.usart.example.xmega_a3bu_xplained/html/index.html\" rel=\"nofollow\">http://asf.atmel.com/docs/latest/xmega.drivers.usart.example.xmega_a3bu_xplained/html/index.html</a>\nmy question is is there a way to download this project or sourc ? \nthanks </p>\n"}, {"tags": ["c", "struct"], "comments": [{"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1429111978, "post_id": 29653563, "comment_id": 47448713, "body": "Showing a sample of how code has an &quot;instance of <code>struct Message</code>&quot; would help.  Depending on  that code, various solutions exists."}, {"owner": {"reputation": 42229, "user_id": 1290731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd21d706444339285b779efb2e5f34e?s=128&d=identicon&r=PG", "display_name": "jthill", "link": "https://stackoverflow.com/users/1290731/jthill"}, "edited": false, "score": 0, "creation_date": 1429112961, "post_id": 29653563, "comment_id": 47449530, "body": "To do what you&#39;re asking, there has to be unused storage on both sides of the object -- so you can&#39;t do this on arrays of the original type, just one-offs.  If you ever find a situation where this is actually worth doing, assembly language is the right answer.  It&#39;s going to be <i>extremely</i> special-purpose."}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 1973207, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/557d7fa74d7ec23c6726f1c16986b032?s=128&d=identicon&r=PG", "display_name": "DuckQueen", "link": "https://stackoverflow.com/users/1973207/duckqueen"}, "edited": false, "score": 0, "creation_date": 1429111222, "post_id": 29653868, "comment_id": 47448146, "body": "The fact of Copying is what I hoped to escape..("}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1429110322, "creation_date": 1429110322, "answer_id": 29653868, "question_id": 29653563, "link": "https://stackoverflow.com/questions/29653563/having-type-a-with-n-fields-is-it-possible-to-merge-it-into-new-object-of-type-b/29653868#29653868", "title": "Having type A with N fields is it possible to merge it into new object of type B with N+x fields?", "body": "<p>Not sure what you mean by \"safely turn\", but I would expect the answer to be \"no\". The structures are different, of course the smaller one can't magically be expected to expand into memory it didn't previously use.</p>\n\n<p>There is no concept of \"overlapping types\" in C.</p>\n\n<p>You can of course declare <code>CoreMessage</code> in terms of <code>Message</code>, but it won't help for the reverse transform from the smaller to the larger type except by making the transfer of the shared information easier:</p>\n\n<pre><code>struct CoreMessage {\n  int messageId;\n  struct Message message;\n  char *senderId;\n  int senderIdLength;\n};\n</code></pre>\n\n<p>Now if we have:</p>\n\n<pre><code>struct Message a = { ... }; /* fully initialized */\nstruct CoreMessage b; /* we want to convert Message into this */\n</code></pre>\n\n<p>we can do:</p>\n\n<pre><code>b.messageId = 4711;\nb.message = a; /* Copy all Message data over. */\nb.senderId = \"foo\";\nb.senderIdLength = 3;\n</code></pre>\n\n<p>Nothing is automatic here though, you have to do it yourself.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 2510551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ae5c38a01aabde127c3d82b47aeb477?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/2510551/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1429111698, "creation_date": 1429111698, "answer_id": 29654370, "question_id": 29653563, "link": "https://stackoverflow.com/questions/29653563/having-type-a-with-n-fields-is-it-possible-to-merge-it-into-new-object-of-type-b/29654370#29654370", "title": "Having type A with N fields is it possible to merge it into new object of type B with N+x fields?", "body": "<p>I'm not sure exactly what you mean by \"turn into\".  I'm not sure how you can get casting to do this for you.  </p>\n\n<p>But, the C standard allows the compiler to put unused space between fields of a struct so, in general nothing would really work.  You could make \"CoreMessage\" contain a \"Message\" and produce your result with a single assignment.</p>\n"}, {"tags": [], "owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1429115632, "last_edit_date": 1429115632, "creation_date": 1429112588, "answer_id": 29654736, "question_id": 29653563, "link": "https://stackoverflow.com/questions/29653563/having-type-a-with-n-fields-is-it-possible-to-merge-it-into-new-object-of-type-b/29654736#29654736", "title": "Having type A with N fields is it possible to merge it into new object of type B with N+x fields?", "body": "<p>No, you cannot do what you ask.  You could come close, however, if you were willing to change the layout of <code>struct CoreMessage</code> like so:</p>\n\n<pre><code>struct CoreMessage {\n    struct Message message;\n\n    int messaageId;\n\n    char * senderId;\n    int senderIdLength;\n};\n</code></pre>\n\n<p>Note that <code>struct CoreMessage</code> then contains an actual <code>struct Message</code> as a member (as opposed to a pointer to one).  Then, given ...</p>\n\n<pre><code>struct CoreMessage cm;\nstruct CoreMessage *cmp = &amp;cm;\nstruct Message *mp = &amp;cm.message;\n</code></pre>\n\n<p>... you have <code>(void *) cmp == (void *) mp</code>, which can be useful for some of the kinds of things you might want to do.  This is also adjusts automatically to changes to <code>struct Message</code>.</p>\n\n<p>Alternatively, you can do something like this:</p>\n\n<pre><code>struct Message {\n    char * topic;\n    int topicLength;\n\n    void * data;\n    int dataLength;\n\n    maximum_alignment_requirement_t resv1;\n    char resv2[AS_MANY_BYTES_AS_ANY_MESSAGE_TYPE_MAY_NEED_INCLUDING_PADDING];\n};\n\nstruct CoreMessage {\n    char * topic;\n    int topicLength;\n\n    void * data;\n    int dataLength;\n\n    maximum_alignment_requirement_t resv1;\n\n    int messaageId;\n\n    char * senderId;\n    int senderIdLength;\n};\n\nstruct Message msg;\nstruct CoreMessage *cmp = (struct CoreMessage *) &amp;msg;\n</code></pre>\n\n<p>That has a high probability of working as you would hope (and some system interfaces work pretty much this way) but C does not <em>guarantee</em> that those corresponding elements will be laid out the same way in the two different <code>struct</code> types.</p>\n\n<p>Note, too, that it was no accident that I moved <code>CoreMessage.messageId</code> after the members corresponding to those of <code>struct Message</code>.  It is much harder to arrange for corresponding layout if you do not do this, and the pointer value equivalence of the first alternative depends on it.</p>\n"}, {"tags": [], "owner": {"reputation": 3805, "user_id": 247643, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/8e9927c1955a6b0497cf6c13d9a7b403?s=128&d=identicon&r=PG", "display_name": "doynax", "link": "https://stackoverflow.com/users/247643/doynax"}, "is_accepted": false, "score": 2, "last_activity_date": 1429113186, "last_edit_date": 1429113186, "creation_date": 1429112632, "answer_id": 29654755, "question_id": 29653563, "link": "https://stackoverflow.com/questions/29653563/having-type-a-with-n-fields-is-it-possible-to-merge-it-into-new-object-of-type-b/29654755#29654755", "title": "Having type A with N fields is it possible to merge it into new object of type B with N+x fields?", "body": "<p>You can fake this with anonymous structures/unions. Anonymous structures have admittedly only been standardized since <code>C11</code> but many popular compilers have supported them as an extension for ages.</p>\n\n<p>That is something along these, admittedly-less-than-pretty, lines:</p>\n\n<pre><code>struct Message  {\n    char * topic;\n    int topicLength;\n    void * data;\n    int dataLength;\n    char * senderId;\n    int senderIdLength;\n};\n\nstruct CoreMessage {\n    int messageId;\n    union {\n        struct Message;\n        struct Message message;\n    };\n};\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 1973207, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/557d7fa74d7ec23c6726f1c16986b032?s=128&d=identicon&r=PG", "display_name": "DuckQueen", "link": "https://stackoverflow.com/users/1973207/duckqueen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 29654736, "answer_count": 4, "score": 1, "last_activity_date": 1429115632, "creation_date": 1429109578, "question_id": 29653563, "link": "https://stackoverflow.com/questions/29653563/having-type-a-with-n-fields-is-it-possible-to-merge-it-into-new-object-of-type-b", "title": "Having type A with N fields is it possible to merge it into new object of type B with N+x fields?", "body": "<p>Say we have an instance of</p>\n\n<pre><code>struct Message {\n    char * topic;\n    int topicLength;\n\n    void * data;\n    int dataLength;\n};\n</code></pre>\n\n<p>and we want to recreate it as an object of other type</p>\n\n<pre><code>struct CoreMessage {\n    int messaageId;\n\n    char * topic;\n    int topicLength;\n\n    void * data;\n    int dataLength;\n\n    char * senderId;\n    int senderIdLength;\n};\n</code></pre>\n\n<p>Can we safly turn <code>Message A</code> into <code>CoreMessage B</code>? thing in C without copying contents, having types partly overlaping as shown here?</p>\n"}, {"tags": ["c#", "c"], "answers": [{"comments": [{"owner": {"reputation": 363, "user_id": 4792360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fe9c1c34a992290b43a7da9d6986aa?s=128&d=identicon&r=PG&f=1", "display_name": "mueldgog", "link": "https://stackoverflow.com/users/4792360/mueldgog"}, "edited": false, "score": 0, "creation_date": 1429109269, "post_id": 29653180, "comment_id": 47446604, "body": "Thanks for you answer. But I have two more questions.  1.) Using an object of A in C# works now like this? MyA mya; createA(&amp;mya); doCrazyStuff(mya); freeA(&amp;mya);  2.) Why do the parameter of createA() and freeA() differ?"}, {"owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "reply_to_user": {"reputation": 363, "user_id": 4792360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fe9c1c34a992290b43a7da9d6986aa?s=128&d=identicon&r=PG&f=1", "display_name": "mueldgog", "link": "https://stackoverflow.com/users/4792360/mueldgog"}, "edited": false, "score": 0, "creation_date": 1429109655, "post_id": 29653180, "comment_id": 47446921, "body": "@mueldgog No, you write <code>createA(out mya), doCrazyStuff(mya); freeA(ref mya)</code>. I&#39;ve used different <code>out</code> and <code>ref</code> because the <code>createA</code> initializes <code>mya</code> without reading it, while <code>freeA</code> seems to read <code>mya</code> and then modify it (probably setting it to <code>NULL</code>). You could use <code>ref</code> everywhere, but then you would have to initialize <code>mya</code> with <code>MyA mya = new MyA()</code> before calling <code>createA</code>"}], "tags": [], "owner": {"reputation": 102162, "user_id": 613130, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/40bd5f390cba274159501bb244bc29f4?s=128&d=identicon&r=PG", "display_name": "xanatos", "link": "https://stackoverflow.com/users/613130/xanatos"}, "is_accepted": true, "score": 2, "last_activity_date": 1429108598, "creation_date": 1429108598, "answer_id": 29653180, "question_id": 29653013, "link": "https://stackoverflow.com/questions/29653013/using-complex-c-struct-in-c/29653180#29653180", "title": "using (complex) c struct in c#", "body": "<p>What you are using is an \"opaque\" pointer... or an handle. Your C# program doesn't know what <code>A*</code> is and isn't interested in knowing it.</p>\n\n<p>You can directly use an <code>IntPtr</code> like this:</p>\n\n<pre><code>void createA(out IntPtr a);\nvoid freeA(ref IntPtr a);\nint doCrazyStuff(IntPtr a);\n</code></pre>\n\n<p>To be type-safe you could:</p>\n\n<pre><code>[StructLayout(LayoutKind.Sequential)]\npublic struct MyA\n{\n    public IntPtr Ptr;\n}\n\nvoid createA(out MyA a);\nvoid freeA(ref MyA a);\nint doCrazyStuff(MyA a);\n</code></pre>\n\n<p>it wouldn't change anything, but if you have multiple opaque references, then you wouldn't be able to mix them (if you have two sets of methods, one that uses <code>A*</code> and another that uses <code>B*</code>, with the first \"way\" you could mix the <code>IntPtr</code>, while with the second one you couldn't)</p>\n"}], "owner": {"reputation": 363, "user_id": 4792360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/57fe9c1c34a992290b43a7da9d6986aa?s=128&d=identicon&r=PG&f=1", "display_name": "mueldgog", "link": "https://stackoverflow.com/users/4792360/mueldgog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 29653180, "answer_count": 1, "score": 1, "last_activity_date": 1429109257, "creation_date": 1429108176, "last_edit_date": 1429108596, "question_id": 29653013, "link": "https://stackoverflow.com/questions/29653013/using-complex-c-struct-in-c", "title": "using (complex) c struct in c#", "body": "<p>I have some easy methods and a C <code>struct</code> which basically looks like this:</p>\n\n<pre><code>struct A\n{\n   B* b;\n   C* c;\n   int d;\n}\n\nvoid createA(A** a);\nvoid freeA(A** a);\nint doCrazyStuff(A* a);\n</code></pre>\n\n<p>In a way I do not care about the structs in the C# code. I only want to create a pointer of A and use this pointer in the C# code via the C methods.</p>\n\n<p>Does anyone have a minimal example for me?</p>\n"}, {"tags": ["c", "multithreading", "tcp", "timer"], "comments": [{"owner": {"reputation": 1055, "user_id": 3406936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2294a96c8fb728eca7525ea9de2e3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Shlomi Agiv", "link": "https://stackoverflow.com/users/3406936/shlomi-agiv"}, "edited": false, "score": 0, "creation_date": 1429110372, "post_id": 29652994, "comment_id": 47447495, "body": "what&#39;s the output? can you run it with a debugger and say where it crashed?"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4279321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f399f9c4fb91b7d8ce83f492ff595f?s=128&d=identicon&r=PG&f=1", "display_name": "landondonovan", "link": "https://stackoverflow.com/users/4279321/landondonovan"}, "edited": false, "score": 0, "creation_date": 1429109103, "post_id": 29653195, "comment_id": 47446494, "body": "I tried using semaphores but it didn&#39;t work neither. I will go ahead with mutexes. Thanks"}], "tags": [], "owner": {"reputation": 113209, "user_id": 1033896, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a75e2267a33cf64c2fc239b5556ec596?s=128&d=identicon&r=PG", "display_name": "hmjd", "link": "https://stackoverflow.com/users/1033896/hmjd"}, "is_accepted": true, "score": 0, "last_activity_date": 1429108655, "creation_date": 1429108655, "answer_id": 29653195, "question_id": 29652994, "link": "https://stackoverflow.com/questions/29652994/tcp-communication-issue-when-new-thread-is-triggered-by-timer/29653195#29653195", "title": "tcp communication issue when new thread is triggered by timer", "body": "<p>The problem is that the assignment:</p>\n\n<pre><code>f = 1;\n</code></pre>\n\n<p>is not visible to other threads, so the <code>main()</code> thread never sees the change. To correct, you will need to use a synchronization mechanism, such as a <a href=\"https://www.sourceware.org/pthreads-win32/manual/pthread_mutex_init.html\" rel=\"nofollow\"><code>pthread_mutex_t</code></a>, which must be acquired when reading or writing <code>f</code>, or <a href=\"http://en.cppreference.com/w/c/atomic\" rel=\"nofollow\"><code>atomic_int</code></a> if your compiler has C11 support.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4279321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f399f9c4fb91b7d8ce83f492ff595f?s=128&d=identicon&r=PG&f=1", "display_name": "landondonovan", "link": "https://stackoverflow.com/users/4279321/landondonovan"}, "edited": false, "score": 0, "creation_date": 1429189830, "post_id": 29655265, "comment_id": 47489053, "body": "Finally I have solved all the problems. I will try to clarify them. For the robot. You send some tcp commands and you have to sleep for a while, waiting until the robot reach the position you asked for. And then send the new tcp command for the new position. With timers, when it is triggered, could be that the robot is in waiting until reach the position, so if the time is triggered, when timerhandler finishes, the code executes the next line, without leaving the robot enough time to reach the position... and it breaks. This robot is the UR10."}, {"owner": {"reputation": 25, "user_id": 4279321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f399f9c4fb91b7d8ce83f492ff595f?s=128&d=identicon&r=PG&f=1", "display_name": "landondonovan", "link": "https://stackoverflow.com/users/4279321/landondonovan"}, "edited": false, "score": 0, "creation_date": 1429190207, "post_id": 29655265, "comment_id": 47489381, "body": "For the code I just presented above is exactly the same. The  instructions which request access to the memory, it can happen that the timer is triggered and jumps one of this important instructions. And then, in the next instructions it tries to read one of the memories was not requested before, making a segmentation fault."}], "tags": [], "owner": {"reputation": 25, "user_id": 4279321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f399f9c4fb91b7d8ce83f492ff595f?s=128&d=identicon&r=PG&f=1", "display_name": "landondonovan", "link": "https://stackoverflow.com/users/4279321/landondonovan"}, "is_accepted": false, "score": 0, "last_activity_date": 1429190249, "last_edit_date": 1429190249, "creation_date": 1429113874, "answer_id": 29655265, "question_id": 29652994, "link": "https://stackoverflow.com/questions/29652994/tcp-communication-issue-when-new-thread-is-triggered-by-timer/29655265#29655265", "title": "tcp communication issue when new thread is triggered by timer", "body": "<p><strong>SOLVED, explanation in the comments :)</strong></p>\n\n<p>The code has been solved just adding the mutexes as hmjd proposed. Thanks ;)</p>\n\n<p>I didn't have clear that it was a matter of mutex since in the other codes I am working with, there are not shared variables that can cause the code/communication breaks. I will present here my plc code, to show what I am working with. I removed extra tcp communication with the robot, I am just presenting here the continuous read of the PLC memories which works pretty stable all the time, but breaks (not always) when the simple timer is triggered. If changing the PLC for the robot which is just normal tcp communication sending move commands, still happens the same. </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include &lt;stdlib.h&gt;\r\n#include &lt;arpa/inet.h&gt;\r\n#include &lt;stdio.h&gt;\r\n#include &lt;string.h&gt;\r\n#include \"nodavesimple.h\"\r\n#include \"nodave.h\"\r\n#include \"openSocket.h\"\r\n#include \"plc_interface.h\"\r\n#include &lt;sys/types.h&gt;  // Primitive System Data Types\r\n#include &lt;errno.h&gt;      // Errors */\r\n#include &lt;sys/wait.h&gt;   // Wait for Process Termination\r\n#include \"plc_interface.h\"\r\n#include &lt;netinet/in.h&gt;\r\n#include &lt;time.h&gt;\r\n#include &lt;signal.h&gt;\r\n#include &lt;pthread.h&gt;\r\n#include &lt;semaphore.h&gt;\r\n#ifdef LINUX\r\n#include &lt;unistd.h&gt;\r\n#include &lt;sys/time.h&gt;\r\n#include &lt;fcntl.h&gt;\r\n#define UNIX_STYLE\r\n#endif\r\n\r\n#ifdef BCCWIN\r\n#include &lt;time.h&gt;\r\n    void usage(void);\r\n#define WIN_STYLE\r\n\r\n#endif\r\n\r\n\r\n#ifdef PLAY_WITH_KEEPALIVE\r\n#include &lt;sys/socket.h&gt;\r\n#endif\r\n\r\n\r\n\r\n\ttimer_t firstTimerID;\r\n    struct itimerspec it;\r\n    int t_block3=3;\r\n\tpthread_t thread_robot;\r\n\tpthread_attr_t thread_attr;\r\n\tint robot_detection=0;\r\n\r\n\r\n\r\n\r\n//THREAD FUNCTION ONCE THE REQUIRED BLOCK IS DETECTED\r\nvoid *detection_robot(){\r\n\tprintf(\"First\\n\");\r\n\tpthread_exit(0);\r\n\r\n}\r\n\r\n\r\n\r\n\r\n//TIMER INTERRUPTION\r\nstatic void timerHandler (int sig, siginfo_t * si, void *uc_) {\r\n\t\ttimer_t *tidp;\r\n\t\tint iret;\r\n\t\ttidp = si-&gt;si_value.sival_ptr;\r\n\r\n\t\t//Initializes the attributes for the thread\r\n\t\tpthread_attr_init(&amp;thread_attr);\r\n\t\tpthread_attr_setdetachstate(&amp;thread_attr,PTHREAD_CREATE_DETACHED);\r\n\r\n\t\t  if (*tidp == firstTimerID) {\r\n\t\t\tprintf (\"First timer\\n\");\r\n\r\n\t\t\t//New thread to detect the second detection sensor\r\n\t\t\tiret = pthread_create( &amp;thread_robot, &amp;thread_attr, detection_robot, NULL);\r\n\t\t\tif(iret)\r\n\t\t\t\t{\r\n\t\t\t\tfprintf(stderr,\"Error - pthread_create() return code: %d\\n\",iret);\r\n\t\t\t\texit(EXIT_FAILURE);\r\n\t\t\t\t}\r\n\t\t  }\r\n\r\n\r\n}\r\n\r\n\r\n//ARM THE TIMERS\r\nstatic int makeTimer (timer_t * timerID) {\r\n\t\t  struct sigevent te;\r\n\t\t  struct sigaction sa;\r\n\t\t  int sigNo = SIGRTMIN;\r\n\t\t  // Set up signal handler.\r\n\t\t  sa.sa_flags = SA_SIGINFO;\r\n\t\t  sa.sa_sigaction = timerHandler;       //Action when singal is triggered\r\n\t\t  sigemptyset (&amp;sa.sa_mask);\r\n\t\t  if (sigaction (sigNo, &amp;sa, NULL) == -1) {\r\n\t\t\tperror (\"sigaction\");\r\n\t\t\t\t}\r\n\t\t  // Set and enable alarm\r\n\t\t  te.sigev_notify = SIGEV_SIGNAL;       //Gnerate alarm upon expiration\r\n\t\t  te.sigev_signo = sigNo;       //SIGALRM\r\n\t\t  te.sigev_value.sival_ptr = timerID;   //Timer ID\r\n\t\t  //Create a per_process timer using the timer ID\r\n\t\t  timer_create (CLOCK_REALTIME, &amp;te, timerID);\r\n\t\treturn 0;\r\n}\r\n\r\n\r\n\r\n\r\n\r\nint main(int argc, char **argv) {\r\n    int adrPos, useProtocol, useSlot;\r\n    int res,barcode_number, r, t;\r\n    int c=0, a=0;\r\n    //Locate the robot in the initial position\r\n    //robot_init();\r\n\r\n\t//Initialize the timer\r\n\t  makeTimer(&amp;firstTimerID);\r\n\r\n\r\n#ifdef PLAY_WITH_KEEPALIVE\r\n    int opt;\r\n#endif\r\n\r\n    daveSetDebug(daveDebugPrintErrors);\r\n    adrPos=1;\r\n    useProtocol=daveProtoISOTCP;\r\n    useSlot=2;\r\n    daveInterface * di;\r\n    daveConnection * dc;\r\n    _daveOSserialType fds;\r\n    PDU p;\r\n    daveResultSet rs;\r\n\r\n    //If the input doesn't have enough parameters, printf the usage\r\n    if (argc&lt;2) {\r\n\t\tusage();\r\n\t\texit(-1);\r\n    }\r\n\r\n\r\n\r\n\t//If there is a problem in the communication it takes 20 seconds to stablish communication again\r\n    fds.rfd=openSocket(102, argv[adrPos]);\r\n\r\n#ifdef PLAY_WITH_KEEPALIVE\r\n    errno=0;\r\n    opt=1;\r\n    res=setsockopt(fds.rfd, SOL_SOCKET, SO_KEEPALIVE, &amp;opt, 4);\r\n    LOG3(\"setsockopt %s %d\\n\", strerror(errno),res);\r\n#endif\r\n    fds.wfd=fds.rfd;\r\n\r\n    if (fds.rfd&gt;0) {\r\n\tdi =daveNewInterface(fds,\"IF1\",0, useProtocol, daveSpeed187k);\r\n\tdaveSetTimeout(di,5000000);\r\n\tdc =daveNewConnection(di,2,0,useSlot);  // insert your rack and slot here\r\n\tif (0==daveConnectPLC(dc)) {\r\n\t    printf(\"Connected.\\n\");\r\n\r\n\t\t\t//START THE BELT\r\n\t        a=0;//a=1 to start the belt\r\n\t        printf(\"Start the belt \\n\");\r\n\t        res=daveWriteBits(dc,  daveDB, 111, 4, 1, &amp;a);\r\n\t        res=daveWriteBits(dc,  daveDB, 111, 3, 1, &amp;a);\r\n\t        printf(\"function result:%d=%s\\n\", res, daveStrerror(res));\r\n\r\n\t\t\t\t//Remove the memory flag of the detection sensor again\r\n\t\t\t\tres=daveWriteBits(dc,  daveFlags, 0, 504, 1, &amp;c);\r\n\t\t\t\tres=daveWriteBits(dc,  daveFlags, 0, 520, 1, &amp;c);\r\n\r\n\t\t\t\tusleep(2000000);\r\n\t\t\t\tprintf(\"Trying to read the sensor until block is detected\\n\");\r\n\t\t\t\t//SENSOR DETECTION\r\n\t\t\t\twhile(1){\r\n\r\n\t\t\t\t\t//Read request  --&gt; Stable until the timer is triggered\r\n\t\t\t\t\tdavePrepareReadRequest(dc,&amp;p);\r\n\t\t\t\t\tdaveAddVarToReadRequest(&amp;p, daveFlags, 0, 63, 1);\r\n\t\t\t\t\tdaveAddVarToReadRequest(&amp;p, daveFlags, 0, 65, 1);\r\n\t\t\t\t\tdaveAddVarToReadRequest(&amp;p, daveDB, 4, 103, 1);\r\n\t\t\t\t\tres=daveExecReadRequest(dc, &amp;p, &amp;rs);\r\n\t\t\t\t\tif (res==1){\tprintf(\"Error during the request\\n\");}\r\n\r\n\t\t\t\t\t//First result --&gt; detection sensor after the barcode\r\n\t\t\t\t\tres=daveUseResult(dc, &amp;rs, 0);\r\n\t\t\t\t\tif (res==1){\tprintf(\"Error reading the first result\\n\");}\r\n\t\t\t\t    t=daveGetU8(dc); //T = 1 if detection in the barcode place\r\n\t\t\t\t    //Second result --&gt; detection sensor before the robot position\r\n\t\t\t\t\tres=daveUseResult(dc, &amp;rs, 1);\r\n\t\t\t\t\tif (res==1){\tprintf(\"Error reading the detection sensor before the robot\\n\");}\r\n\t\t\t\t\tr=daveGetU8(dc); //R = 1 if detection in the robot place\r\n\t\t\t\t\t//Third result --&gt; read the number stored\r\n\t\t\t\t\tdaveUseResult(dc, &amp;rs, 2);\r\n\t\t\t\t\tbarcode_number=daveGetU8(dc);\r\n\t\t\t\t\t//Free the memory\r\n\t\t\t\t\tdaveFreeResults(&amp;rs);\r\n\r\n\t\t\t\t\tif (r==1){\r\n\t\t\t\t\t\t//Remove the memory flag referred to the second sensor\r\n\t\t\t\t\t\tres=daveWriteBits(dc,  daveFlags, 0, 520, 1, &amp;c);\r\n\t\t\t\t\t\tif (res==1){\tprintf(\"Error removing the flag of the second detector\\n\");}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t//Wen detection..\r\n\t\t\t\t\tif (t==1){\r\n\t\t\t\t\t\t\tt=0;\r\n\t\t\t\t\t\t\t//Remove the memory flag of the detection\r\n\t\t\t\t\t\t\tres=daveWriteBits(dc,  daveFlags, 0, 504, 1, &amp;c);\r\n\t\t\t\t\t\t\tif (res==1){\tprintf(\"Error removing the flag of the sensor closed to the robot\\n\");}\r\n\r\n\r\n\t\t\t\t\t\t\t//If number three is detected the belt will stop in 3 seconds respectively\r\n\t\t\t\t\t\t\tswitch(barcode_number){\r\n\r\n\t\t\t\t\t\t\tcase 3: printf(\"Block number three, timer will be triggered in 3 seconds\\n\");\r\n\t\t\t\t\t\t\t\t\t//Start the timer\r\n\t\t\t\t\t\t\t\t\tsetTimer (&amp;firstTimerID, t_block3);\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 2: printf(\"Block number two, belt won't stop\\n\");\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tcase 4: printf(\"Block number four, belt won't stop\\n\");\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\tdefault:printf(\"Wrong lecture\\n\");\r\n\r\n\t\t\t\t\t\t\t}}\r\n\r\n\r\n\t\t\t\t\tusleep(50000); //Rest until next sampling\r\n\t\t}\r\n\t//Close socket\r\n\tcloseSocket(fds.rfd);\r\n\tprintf(\"Finished.\\n\");\r\n\r\n\treturn 0;\r\n\t} else {//daveconnected\r\n\t    printf(\"Couldn't connect to PLC.\\n \\n\");\r\n\t    closeSocket(fds.rfd);\r\n\t    return -2;}\r\n\r\n    }//fds.rds &gt; 0\r\n     else {\r\n\tprintf(\"Couldn't open TCP port. \\nPlease make sure a CP is connected and the IP address is ok. \\n\");\r\n    \treturn -1;\r\n    }\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 25, "user_id": 4279321, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f7f399f9c4fb91b7d8ce83f492ff595f?s=128&d=identicon&r=PG&f=1", "display_name": "landondonovan", "link": "https://stackoverflow.com/users/4279321/landondonovan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 29653195, "answer_count": 2, "score": 0, "last_activity_date": 1429190249, "creation_date": 1429108131, "last_edit_date": 1429108308, "question_id": 29652994, "link": "https://stackoverflow.com/questions/29652994/tcp-communication-issue-when-new-thread-is-triggered-by-timer", "title": "tcp communication issue when new thread is triggered by timer", "body": "<p>This is part of huge code where I am communicating with a robot and a s7 plc, working both in parallel. The issue is that before I though the problem was part of the plc communication, but now I have reduced all my code to a client-server application which seems also to fail. \nThe code basically works in the next way; every 50ms the client sends a \"hello\" message to the server. When 20 messages are sent, a timer of 7 seconds is launched. When the timer is triggered a second thread is started, and this one changes the variable f=1 and it is finished. The main program in the meantime will be printing hello, but when this variable f changes to 1 it should print just \"aaaaa\", but it never happens. </p>\n\n<p>With the PLC, the problems was segmentation fault. My idea is that the TCP communication fails (why?) and the PLC block the access. I tried the same program before just moving a robot arm, and analyzing with wireshark, you can see how the TCP are being sent all the time, but again, the robot stops. \nAnd finally with this client application it can be see how they didn't work as expected neither.</p>\n\n<p>I hope any of you can help me.</p>\n\n<p>Thanks a lot;)</p>\n\n<p>CLIENT\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>#include &lt;stdlib.h&gt;\r\n#include &lt;arpa/inet.h&gt; \r\n#include &lt;stdio.h&gt;\r\n#include &lt;string.h&gt;\r\n#include &lt;sys/types.h&gt;  // Primitive System Data Types \r\n#include &lt;errno.h&gt;      // Errors */\r\n#include &lt;sys/wait.h&gt;   // Wait for Process Termination \r\n#include \"plc_interface.h\"\r\n#include &lt;netinet/in.h&gt;\r\n#include &lt;time.h&gt;\r\n#include &lt;signal.h&gt;\r\n#include &lt;pthread.h&gt;\r\n#include &lt;semaphore.h&gt;\r\n#include &lt;time.h&gt;\r\n#include &lt;unistd.h&gt;\r\n#include &lt;sys/time.h&gt;\r\n#include &lt;fcntl.h&gt;\r\n#include &lt;sys/socket.h&gt;\r\n\r\n\ttimer_t firstTimerID;\r\n\ttimer_t secondTimerID;\r\n    struct itimerspec it;\r\n    int t_block3=5;\r\n\tpthread_t thread_robot;\r\n\tpthread_attr_t thread_attr;\r\n\tint res, z;\r\n\tint f=0;\r\n    \r\n\r\n\r\n//THREAD FUNCTION ONCE THE REQUIRED BLOCK IS DETECTED\r\nvoid *detection_robot(){\r\n\tprintf(\"First\\n\");\r\n\t//f==1 to send the message aaaaaa\r\n\tf=1;\r\n\tpthread_exit(NULL);\r\n\r\n}\r\n\r\n\r\nint setTimer(timer_t * timerID, int time) {\r\n  struct itimerspec its;\r\n  //Interval for starting again\r\n  its.it_interval.tv_sec = 0;\r\n  its.it_interval.tv_nsec = 0;\r\n  //Timer time\r\n  its.it_value.tv_sec = time;\r\n  its.it_value.tv_nsec = 0;\r\n  //Arm/disarmer a per process time\r\n  timer_settime (*timerID, 0, &amp;its, NULL);\r\n\r\n  return 0;\r\n}\r\n\r\n//TIMER INTERRUPTION\r\nstatic void timerHandler (int sig, siginfo_t * si, void *uc_) {\r\n\t\ttimer_t *tidp;\r\n\t\tint iret;\r\n\t\ttidp = si-&gt;si_value.sival_ptr;\r\n\r\n\t\t//Initializes the attributes for the thread\r\n\t\tres= pthread_attr_init(&amp;thread_attr);\r\n\t\tres=pthread_attr_setdetachstate(&amp;thread_attr,PTHREAD_CREATE_DETACHED);\r\n\r\n\t\t  if (*tidp == firstTimerID) {\r\n\t\t\tprintf (\"First timer\\n\");\r\n\r\n\t\t\t//New thread to detect the second detection sensor\r\n\t\t\tiret = pthread_create( &amp;thread_robot, &amp;thread_attr, detection_robot, NULL);\r\n\t\t\tif(iret)\r\n\t\t\t\t{\r\n\t\t\t\tfprintf(stderr,\"Error - pthread_create() return code: %d\\n\",iret);\r\n\t\t\t\texit(EXIT_FAILURE);\r\n\t\t\t\t}\r\n\t\t  } else if (*tidp == secondTimerID) {\r\n\t\t\tprintf (\"Second timer\\n\");\r\n\t\t  }\r\n\r\n\t\t  z--;\r\n\r\n}\r\n\r\n\r\n//ARM THE TIMERS\r\nstatic int makeTimer (timer_t * timerID) {\r\n\t\t  struct sigevent te;\r\n\t\t  struct sigaction sa;\r\n\t\t  int sigNo = SIGRTMIN;\r\n\t\t  // Set up signal handler.\r\n\t\t  sa.sa_flags = SA_SIGINFO;\r\n\t\t  sa.sa_sigaction = timerHandler;       //Action when singal is triggered\r\n\t\t  sigemptyset (&amp;sa.sa_mask);\r\n\t\t  if (sigaction (sigNo, &amp;sa, NULL) == -1) {\r\n\t\t\tperror (\"sigaction\");\r\n\t\t\t\t}\r\n\t\t  // Set and enable alarm\r\n\t\t  te.sigev_notify = SIGEV_SIGNAL;       //Gnerate alarm upon expiration\r\n\t\t  te.sigev_signo = sigNo;       //SIGALRM\r\n\t\t  te.sigev_value.sival_ptr = timerID;   //Timer ID\r\n\t\t  //Create a per_process timer using the timer ID\r\n\t\t  timer_create (CLOCK_REALTIME, &amp;te, timerID);\r\n\t\treturn 0;\r\n}\r\n\r\n\r\nint main(int argc , char *argv[])\r\n{\r\n    int sock;\r\n    struct sockaddr_in server;\r\n    char message[6]={'h','e','l','l','o','\\0'};\r\n       char message2[6]={'a','a','a','a','a','\\0'};\r\n    char server_reply[2000];\r\n\t//Initialize the timers\r\n\t  makeTimer(&amp;firstTimerID);\r\n\t  makeTimer(&amp;secondTimerID);\r\n\r\n    //Create socket\r\n    sock = socket(AF_INET , SOCK_STREAM , 0);\r\n    if (sock == -1)\r\n    {\r\n        printf(\"Could not create socket\");\r\n    }\r\n    puts(\"Socket created\");\r\n     \r\n    server.sin_addr.s_addr = inet_addr(\"127.0.0.1\");\r\n    server.sin_family = AF_INET;\r\n    server.sin_port = htons( 8888 );\r\n \r\n    //Connect to remote server\r\n    if (connect(sock , (struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)\r\n    {\r\n        perror(\"connect failed. Error\");\r\n        return 1;\r\n    }\r\n    puts(\"Connected\\n\");\r\n    //keep communicating with server\r\n\tint i=0;\r\n\twhile(1){\r\n       //Send hello every 50ms\r\n        if( send(sock , message , 6 , 0) &lt; 0)\r\n        {\r\n            puts(\"Send failed\");\r\n            return 1;\r\n        }\r\n\t\t\ti++;\r\n\t\t\tif (i==20){\r\n\t\t\t\t\t\tsetTimer (&amp;firstTimerID, t_block3);\r\n\t\t\t\t\t\ti=0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t//f-&gt; 1, send aaaaaa when timer is triggered, but here is when it get stacked\r\n\t\t\tif (f==1) {\r\n\t\t\t\tf=0;\r\n\t\t\t\tif( send(sock , message2 , 6 , 0) &lt; 0)\r\n\t\t\t\t{\r\n\t\t\t\t\tputs(\"Send failed\");\r\n\t\t\t\t\treturn 1;\r\n\t\t\t\t}}\r\n\r\n\t\t\tusleep(500000); //500ms\r\n\t\t}\r\n\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>SERVER\n<div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code> \r\n#include&lt;stdio.h&gt;\r\n#include&lt;string.h&gt;    //strlen\r\n#include&lt;sys/socket.h&gt;\r\n#include&lt;arpa/inet.h&gt; //inet_addr\r\n#include&lt;unistd.h&gt;    //write\r\n \r\nint main(int argc , char *argv[])\r\n{\r\n    int socket_desc , client_sock , c , read_size;\r\n    struct sockaddr_in server , client;\r\n    char client_message[2000];\r\n     \r\n    //Create socket\r\n    socket_desc = socket(AF_INET , SOCK_STREAM , 0);\r\n    if (socket_desc == -1)\r\n    {\r\n        printf(\"Could not create socket\");\r\n    }\r\n    puts(\"Socket created\");\r\n     \r\n    //Prepare the sockaddr_in structure\r\n    server.sin_family = AF_INET;\r\n    server.sin_addr.s_addr = INADDR_ANY;\r\n    server.sin_port = htons( 8888 );\r\n     \r\n    //Bind\r\n    if( bind(socket_desc,(struct sockaddr *)&amp;server , sizeof(server)) &lt; 0)\r\n    {\r\n        //print the error message\r\n        perror(\"bind failed. Error\");\r\n        return 1;\r\n    }\r\n    puts(\"bind done\");\r\n     \r\n    //Listen\r\n    listen(socket_desc , 3);\r\n     \r\n    //Accept and incoming connection\r\n    puts(\"Waiting for incoming connections...\");\r\n    c = sizeof(struct sockaddr_in);\r\n     \r\n    //accept connection from an incoming client\r\n    client_sock = accept(socket_desc, (struct sockaddr *)&amp;client, (socklen_t*)&amp;c);\r\n    if (client_sock &lt; 0)\r\n    {\r\n        perror(\"accept failed\");\r\n        return 1;\r\n    }\r\n    puts(\"Connection accepted\");\r\n     \r\n     while(1){\r\n    //Receive a message from client\r\n    recv(client_sock , client_message , 2000 , 0);\r\n    printf(\"%s\\n\", client_message);\r\n     \r\n\t}\r\n\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["c", "fastcgi"], "answers": [{"comments": [{"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429682666, "post_id": 29725907, "comment_id": 47707122, "body": "so <code>FCGX_InitRequest(&amp;requestFcgx, 0, 0)</code> isn&#39;t the counter part to <code>FCGX_Finish_r (&amp;requestFcgx)</code>? So <code>FCGX_Finish_r (&amp;requestFcgx)</code> isn&#39;t cleaning anything up, that needs to be reinitialized?"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429683346, "post_id": 29725907, "comment_id": 47707442, "body": "It is Well to know, but sadly didn&#39;t fixed the problem. Is it important to know that the <code>while(1)</code> is run in multiple pthreads? I put the code in front of my <code>main()</code> as you had stated."}, {"owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429746358, "post_id": 29725907, "comment_id": 47749845, "body": "FCXG_Finish_r() releases resources allocated by FCGX_Accept_r() and should be called at end  of the While(1) loop or before the &quot;continue&quot; statement."}, {"owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429746485, "post_id": 29725907, "comment_id": 47749883, "body": "If your FCGI loop is in a thread then FCGX_InitRequest() should be in the thread function and not in the main() function. You can call FCGX_InitRequest() just before the while(1) loop."}, {"owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429746756, "post_id": 29725907, "comment_id": 47749960, "body": "I don&#39;t see you call FCGX_Init() which must be called in multi-threaded apps. I updated my answer this info about FCGX_Init(). Please check"}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429767294, "post_id": 29725907, "comment_id": 47756439, "body": "You don&#39;t see me calling ` FCGX_Init` in the snippet, as it is the snippet of the process, whilest I&#39;m calling  <code>FCGX_Init</code> already in the main. Or do I have to call <code>FCGX_Init</code> in each thread?"}, {"owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429870567, "post_id": 29725907, "comment_id": 47815477, "body": "You need to call FCGX_Init() in each fast cgi thread where you call FCGX_Accept_r()."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429872830, "post_id": 29725907, "comment_id": 47816879, "body": "Is there any relevance of the order in which I&#39;m calling <code>FCGX_InitRequest (&amp;requestFcgx, 0, 0);</code> and <code>FCGX_Init()</code> ? After my last change under respect to your comment I&#39;m now calling both inside of the thread before entering the <code>while(1)</code> and I&#39;m calling <code>FCGX_Init()</code> immediate followed by <code>FCGX_InitRequest (&amp;requestFcgx, 0, 0);</code> but there isn&#39;t any change in behaving yet."}, {"owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "reply_to_user": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429927361, "post_id": 29725907, "comment_id": 47846036, "body": "I found one example for you try - <a href=\"http://www.fastcgi.com/devkit/examples/threaded.c\" rel=\"nofollow noreferrer\">fastcgi.com/devkit/examples/threaded.c</a>"}], "tags": [], "owner": {"reputation": 544, "user_id": 2089089, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LlCfO.png?s=128&g=1", "display_name": "Harmeet", "link": "https://stackoverflow.com/users/2089089/harmeet"}, "is_accepted": false, "score": 1, "last_activity_date": 1429927531, "last_edit_date": 1429927531, "creation_date": 1429418873, "answer_id": 29725907, "question_id": 29652981, "link": "https://stackoverflow.com/questions/29652981/fcgx-accept-r-returns-success-without-valid-request/29725907#29725907", "title": "FCGX_Accept_r returns success without valid Request", "body": "<p>There are two issues -</p>\n\n<ol>\n<li><code>FCGX_InitRequest(&amp;requestFcgx, 0, 0)</code> needs to be called before entering the <code>while(1)</code> loop.</li>\n<li><p>SIGPIPE signal can also cause this behaviour. Try ignoring it. Add this block to the start of your <code>main()</code> function -</p>\n\n<pre><code>struct sigaction sa_ign;\nsa_ign.sa_handler = SIG_IGN;\nsa_ign.sa_flags = 0;\nsigemptyset(&amp;sa_ign.sa_mask);\nsigaction(SIGPIPE, &amp;sa_ign, NULL);\n</code></pre></li>\n</ol>\n\n<p>You mentioned that the app is multi-threaded. If so, you must also call <code>FCGX_Init()</code>. Below is information from <code>fcgiapp.h</code> header file -</p>\n\n<pre><code>/*\n *----------------------------------------------------------------------\n *\n * FCGX_Init --\n *\n *      Initialize the FCGX library.  Call in multi-threaded apps\n *      before calling FCGX_Accept_r().\n *\n *      Returns 0 upon success.\n *\n *----------------------------------------------------------------------\n */\nDLLAPI int FCGX_Init(void);\n</code></pre>\n\n<p>Check this simple multi-threaded FastCGI application -</p>\n\n<p><a href=\"http://www.fastcgi.com/devkit/examples/threaded.c\" rel=\"nofollow\">http://www.fastcgi.com/devkit/examples/threaded.c</a> </p>\n"}], "owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1298, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429927531, "creation_date": 1429108086, "question_id": 29652981, "link": "https://stackoverflow.com/questions/29652981/fcgx-accept-r-returns-success-without-valid-request", "title": "FCGX_Accept_r returns success without valid Request", "body": "<p>This is the related code, I shorted it as much as possible hopefully not excluding the error source.</p>\n\n<p>DebugLogMsg is a printf like log file writing tool which can be considered as not causing the error.</p>\n\n<pre><code>//Some init stuff and smthng\n    while (1)\n    {\n        memset (&amp;requestFcgx, 0, sizeof (requestFcgx));\n        iRet = FCGX_InitRequest (&amp;requestFcgx, 0, 0);\n        DebugLogMsg (\"FCGX_InitRequest() called!!\\r\\n\");\n\n        if (iRet != 0)\n        {\n            DebugLogMsg (\"FCGX_InitRequest failed, return val:%d!\\r\\n\", iRet);\n            return NULL;\n        }\n\n        iRet = FCGX_Accept_r (&amp;requestFcgx);\n\n        if (iRet != 0)\n        {\n            DebugLogMsg1 (\"FCGX_Accept_r failed!\\r\\n\");\n            continue;\n        }\n\n        char *foo = FCGX_GetParam(\"SOME_CUSTOM_VAL\", requestFcgx.envp);\n        DebugLogMsg (\"CustomParam:%s\\r\\n\", foo);\n\n        do\n        {\n            //processing the request...\n            if (ERROR == TRUE)\n            {\n                DebugLogMsg (\"FatalError!\\r\\n\");\n                return NULL;\n            }\n\n            DebugLogMsg (\"no errors occured!\");\n        }\n        while (0);\n\n        FCGX_Finish_r (&amp;requestFcgx);\n        DebugLogMsg (\"Cleanup.... DONE!\\r\\n\");\n    }\n</code></pre>\n\n<p>My problem is <code>iRet = FCGX_Accept_r (&amp;requestFcgx);</code> doesn't block every 2nd call, as it should. (at least I expect this function to it should be blocking)</p>\n\n<p>As soon a request is sent by the webserver the Function releases, runs through the loop without any errors getting logged, calls the Finish, loops to the start of the loop body and when calling  <code>iRet = FCGX_Accept_r (&amp;requestFcgx);</code> again, it returns instantly with <code>iRet == 0</code> but the <code>requestFcgx</code> structure seems to be invalid (what is to be expected as there was not even an aditional request initiated). The corresponding Log File contains for this process:</p>\n\n<pre><code>[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    FCGX_InitRequest() called!\n            ----------------------------------------\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    CustomParam:ExpectedStuff\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    no errors occured!\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    Cleanup.... DONE!\n\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    FCGX_InitRequest() called!\n            ----------------------------------------\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    CustomParam:(null)\n[Wed Apr 15 15:41:26 2015][Thread:0;0x802420040]    FatalError!\n\n//////////////////////////////\n////////Protocol closed///////\n//////////////////////////////\n</code></pre>\n\n<p>(Please someone edit the Logtext to be not formated as code, I don't know how to)</p>\n\n<p>The Fatal error occures as the Request doesn't provide information and get shut down. the point is, why <code>iRet = FCGX_Accept_r (&amp;requestFcgx);</code> returns with <code>0</code> when it obvisiously failed? And in how far I have to consider this behaving, if it is expected to do so.</p>\n"}, {"tags": ["c", "geometry", "real-time", "approximation", "curves"], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 2220850, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73dcfb513b35606b83a5a80d25bcafac?s=128&d=identicon&r=PG", "display_name": "rava", "link": "https://stackoverflow.com/users/2220850/rava"}, "edited": false, "score": 0, "creation_date": 1429111508, "post_id": 29653087, "comment_id": 47448366, "body": "ok I edited my example and added your numbers. They are correct.I&#39;ll have another look at the computation of the coefficients (currently they are pre-computed offline). So you&#39;re saying approximating around s=0 is good enough even for large thetas?  Note: currently my integrals are parameterized by a number t = k * s in which k depends on the sharpness. The angles just make my examples easier."}, {"owner": {"reputation": 183, "user_id": 2220850, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73dcfb513b35606b83a5a80d25bcafac?s=128&d=identicon&r=PG", "display_name": "rava", "link": "https://stackoverflow.com/users/2220850/rava"}, "edited": false, "score": 0, "creation_date": 1429112333, "post_id": 29653087, "comment_id": 47448998, "body": "okay, this is what I meant. at 0|0 the unit clothoid has zero heading and zero curvature (i.e. R=inf). Are you suggesting I should chose a different reference point for taylor evaluation? this would make precision really easy - and it would make math really hard as I have to know the exact solution for the Fresnel integral at that point, right?"}, {"owner": {"reputation": 183, "user_id": 2220850, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73dcfb513b35606b83a5a80d25bcafac?s=128&d=identicon&r=PG", "display_name": "rava", "link": "https://stackoverflow.com/users/2220850/rava"}, "edited": false, "score": 0, "creation_date": 1429198281, "post_id": 29653087, "comment_id": 47496067, "body": "okay I was able to get a precise Taylor approximation in Matlab. You were right. It&#39;s easily possible to do up to 50 terms. But doing iterative approximations of the coefficients didn&#39;t help. Either there is an error in the formulas I checked 5 times or the results are just way worse. Anyways, working with a table of coefficients works fine for me. No let&#39;s try to put that into C."}], "tags": [], "owner": {"reputation": 61384, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1429114875, "last_edit_date": 1495541663, "creation_date": 1429108362, "answer_id": 29653087, "question_id": 29652815, "link": "https://stackoverflow.com/questions/29652815/how-to-efficiently-evaluate-or-approximate-a-road-clothoid/29653087#29653087", "title": "How to efficiently evaluate or approximate a road Clothoid?", "body": "<p>about the 4 terms in Taylor series - you should be able to use much more. total theta of 2pi is certainly doable, with doubles. </p>\n\n<p>you're probably calculating each term in isolation, according to the full formula, calculating full factorial and power values. that is the reason for losing precision extremely fast. </p>\n\n<p>instead, calculate the terms progressively, the next one from the previous one. Find the formula for the <em>ratio</em> of the next term over the previous one in the series, and use it. </p>\n\n<p>For increased precision, do not calculate in <code>theta</code> by rather in the distance, <code>s</code> (to not lose the precision on scaling).</p>\n\n<p>your example is an extremely flat clothoid. if I made no mistake, it goes from <code>(25/22) pi =~ 204.545\u00b0</code> to <code>(36/22) pi =~ 294.545\u00b0</code> <sub>(why not include these details in your question?)</sub>. Nevertheless it should be OK. Even <code>2 pi = 360\u00b0</code>, the full circle (and twice that), should pose no problem.</p>\n\n<pre><code>given: r = 150 -&gt; 125,  90 degrees turn :\n\n  r s = A^2 = 150 s = 125 (s+x)  \n\n  =&gt;  1+(x/s) = 150/125 = 1 + 25/125       x/s = 1/5  \n\n  theta = s^2/2A^2 = s^2 / (300 s) = s / 300  ;   = (pi/2) * (25/11)  = 204.545\u00b0\n  theta2 = (s+x)^2/(300 s) = (6/5)^2 s / 300  ;   = (pi/2) * (36/11)  = 294.545\u00b0\n  theta2 - theta = ( 36/25 - 1 ) s / 300 == pi/2\n\n  =&gt;  s = 300 * (pi/2) * (25/11) = 1070.99749554    x = s/5 = 214.1994991\n\n      A^2 = 150 s = 150 * 300 * (pi/2) * (25/11) \n\n      a = sqrt (2 A^2) = 300 sqrt ( (pi/2) * (25/11) ) = 566.83264608\n</code></pre>\n\n<p>The reference point is at r = Infinity, where theta = 0. </p>\n\n<p>we have <a href=\"https://stackoverflow.com/a/12763981/849891\"><code>x = a INT[u=0..(s/a)] cos(u^2) d(u)</code></a> where <code>a = sqrt(2 r s)</code> and <code>theta = (s/a)^2</code>. write out the Taylor series for <code>cos</code>, and integrate it, term-by-term, to get your Taylor approximation for <code>x</code> as function of distance, <code>s</code>, along the curve, from the 0-point. that's all.</p>\n\n<p>next you have to decide with what density to calculate your points along the clothoid. you can find it from a desired tolerance value above the chord, for your minimal radius of 125. these points will thus define the approximation of the curve by line segments, drawn between the consecutive points. </p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 1626012, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/43c31b46dd7856dc6ea55c8a614adc33?s=128&d=identicon&r=PG", "display_name": "Ahmed", "link": "https://stackoverflow.com/users/1626012/ahmed"}, "is_accepted": false, "score": 0, "last_activity_date": 1529715746, "last_edit_date": 1529715746, "creation_date": 1529712278, "answer_id": 50996838, "question_id": 29652815, "link": "https://stackoverflow.com/questions/29652815/how-to-efficiently-evaluate-or-approximate-a-road-clothoid/50996838#50996838", "title": "How to efficiently evaluate or approximate a road Clothoid?", "body": "<p>I am doing my thesis in the same area right now.</p>\n\n<p>My approach is the following. </p>\n\n<ol>\n<li><p>at each point on your clothoid, calculate the following  (change in heading / distance traveled along your clothoid), by this formula you can calculate the curvature at each point by this simple equation.</p></li>\n<li><p>you are going to plot each curvature value, your x-axis will be the distance along the clothoid, the y axis will be the curvature. By plotting this and applying very easy  linear regression algorithm (search for Peuker algorithm implementation in your language of choice)</p></li>\n<li><p>you can easily identify where are the curve sections with value of zero (Line has no curvature), or linearly increasing or decreasing (Euler spiral CCW/CW), or constant value != 0 (arc has constant curvature across all points on it). </p></li>\n</ol>\n\n<p>I hope this will help you a little bit. </p>\n\n<p>You can find my code <a href=\"https://github.com/pythonCod/osm2od\" rel=\"nofollow noreferrer\">on github</a>. I implemented some algorithms for such problems like Peuker Algorithm. </p>\n"}], "owner": {"reputation": 183, "user_id": 2220850, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/73dcfb513b35606b83a5a80d25bcafac?s=128&d=identicon&r=PG", "display_name": "rava", "link": "https://stackoverflow.com/users/2220850/rava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1529715746, "creation_date": 1429107608, "last_edit_date": 1429111381, "question_id": 29652815, "link": "https://stackoverflow.com/questions/29652815/how-to-efficiently-evaluate-or-approximate-a-road-clothoid", "title": "How to efficiently evaluate or approximate a road Clothoid?", "body": "<p>I'm facing the problem of computing values of a clothoid in C in real-time.</p>\n\n<p>First I tried using the Matlab coder to obtain auto-generated C code for the quadgk-integrator for the Fresnel formulas. This essentially works great in my test scnearios. The only issue is that it runs incredibly slow (in Matlab as well as the auto-generated code).</p>\n\n<p>Another option was interpolating a data-table of the unit clothoid connecting the sample points via straight lines (linear interpolation). I gave up after I found out that for only small changes in curvature (tiny steps along the clothoid) the results were obviously degrading to lines. What a surprise...</p>\n\n<p>I know that circles may be plotted using a different formula but low changes in curvature are often encountered in real-world-scenarios and 30k sampling points in between the headings 0\u00b0 and 360\u00b0 didn't provide enough angular resolution for my problems.</p>\n\n<p>Then I tried a Taylor approximation around the R = inf point hoping that there would be significant curvatures everywhere I wanted them to be. I soon realized I couldn't use more than 4 terms (power of 15) as the polynom otherwise quickly becomes unstable (probably due to numerical inaccuracies in double precision fp-computation). Thus obviously accuracy quickly degrades for large t values. And by \"large t values\" I'm talking about every point on the clothoid that represents a curve of more than 90\u00b0 w.r.t. the zero curvature point.</p>\n\n<p>For instance when evaluating a road that goes from R=150m to R=125m while making a 90\u00b0 turn I'm way outside the region of valid approximation. Instead I'm in the range of 204.5\u00b0 - 294.5\u00b0 whereas my Taylor limit would be at around 90\u00b0 of the unit clothoid.</p>\n\n<p>I'm kinda done randomly trying out things now. I mean I could just try to spend time on the dozens of papers one finds on that topic. Or I could try to improve or combine some of the methods described above. Maybe there even exists an integrate function in Matlab that is compatible with the Coder and fast enough.</p>\n\n<p>This problem is so fundamental it feels to me I shouldn't have that much trouble solving it. any suggetions?</p>\n"}, {"tags": ["c", "eclipse", "hash", "hashlib"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429107074, "post_id": 29652560, "comment_id": 47444868, "body": "Where is mhash.h supposed to come from ?"}, {"owner": {"reputation": 1, "user_id": 4646851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SGG5_4q_Gyc/AAAAAAAAAAI/AAAAAAAAAHY/GhQ4CvH7ckg/photo.jpg?sz=128", "display_name": "zankal", "link": "https://stackoverflow.com/users/4646851/zankal"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429107226, "post_id": 29652560, "comment_id": 47444967, "body": "I dont know how to add it to my includes."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429107611, "post_id": 29652560, "comment_id": 47445288, "body": "What I&#39;m asking is how you come to know about mhash.h. What is it ? Have you installed something that should provide you with an mhash.h header file ? The next thing you need to figure out if this is something you have installed, is where you have installed it, and where the mhash.h header file is located."}, {"owner": {"reputation": 1, "user_id": 4646851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SGG5_4q_Gyc/AAAAAAAAAAI/AAAAAAAAAHY/GhQ4CvH7ckg/photo.jpg?sz=128", "display_name": "zankal", "link": "https://stackoverflow.com/users/4646851/zankal"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429107970, "post_id": 29652560, "comment_id": 47445605, "body": "I&#39;m asking it already. I havent installed  anything about mhash.h yet ? what should I do first ?"}, {"owner": {"reputation": 300, "user_id": 4757944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/020868dde3084b7226fad941088c9140?s=128&d=identicon&r=PG&f=1", "display_name": "that-ru551an-guy", "link": "https://stackoverflow.com/users/4757944/that-ru551an-guy"}, "edited": false, "score": 1, "creation_date": 1429112731, "post_id": 29652560, "comment_id": 47449320, "body": "After installing the mhash.h file <b>PROPERLY</b>, it shouldn&#39;t be an issue including it. If it is an issue, it is because you didn&#39;t install it properly. see <a href=\"http://stackoverflow.com/questions/11137033/what-is-the-right-way-to-install-header-files-from-some-package\" title=\"what is the right way to install header files from some package\">stackoverflow.com/questions/11137033/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4646851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SGG5_4q_Gyc/AAAAAAAAAAI/AAAAAAAAAHY/GhQ4CvH7ckg/photo.jpg?sz=128", "display_name": "zankal", "link": "https://stackoverflow.com/users/4646851/zankal"}, "edited": false, "score": 0, "creation_date": 1429109903, "post_id": 29653206, "comment_id": 47447140, "body": "Ok, I got it. Then, How can I merge it to my project on Eclipse"}], "tags": [], "owner": {"reputation": 1880, "user_id": 4281182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/teZv4.png?s=128&g=1", "display_name": "Sel&#231;uk Cihan", "link": "https://stackoverflow.com/users/4281182/sel%c3%a7uk-cihan"}, "is_accepted": false, "score": 0, "last_activity_date": 1429108671, "creation_date": 1429108671, "answer_id": 29653206, "question_id": 29652560, "link": "https://stackoverflow.com/questions/29652560/how-to-add-mhash-h-into-my-c-project/29653206#29653206", "title": "How to add &lt;mhash.h&gt; into my C project", "body": "<p>You need to install mhash first. Get it from <a href=\"http://sourceforge.net/projects/mhash\" rel=\"nofollow\">http://sourceforge.net/projects/mhash</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4646851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-SGG5_4q_Gyc/AAAAAAAAAAI/AAAAAAAAAHY/GhQ4CvH7ckg/photo.jpg?sz=128", "display_name": "zankal", "link": "https://stackoverflow.com/users/4646851/zankal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 828, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1429108671, "creation_date": 1429106974, "question_id": 29652560, "link": "https://stackoverflow.com/questions/29652560/how-to-add-mhash-h-into-my-c-project", "title": "How to add &lt;mhash.h&gt; into my C project", "body": "<p>I'm trying to run this code on Eclipse. But there is an error about the header <strong>mhash.h</strong></p>\n\n<h2>\"Error: No such a file or directory\"</h2>\n\n<p><strong>The code is this:</strong></p>\n\n<pre><code>#include &lt;mhash.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint main(void)\n{\n    int i;\n    MHASH td;\n    unsigned char buffer;\n    unsigned char *hash;\n    td = mhash_init(MHASH_MD5);\n    if (td == MHASH_FAILED) exit(1);\n    while (fread(&amp;buffer, 1, 1, stdin) == 1) {\n            mhash(td, &amp;buffer, 1);\n    }\n    hash = mhash_end(td);\n    printf(\"Hash:\");\n    for (i = 0; i &lt; mhash_get_block_size(MHASH_MD5); i++) {\n            printf(\"%.2x\", hash[i]);\n    }\n    printf(\"\\n\");\n    exit(0);\n}\n</code></pre>\n"}, {"tags": ["java", "c", "tcp"], "comments": [{"owner": {"reputation": 20303, "user_id": 2333222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6705fd44c36d033f0ceae77259913e74?s=128&d=identicon&r=PG", "display_name": "SubOptimal", "link": "https://stackoverflow.com/users/2333222/suboptimal"}, "edited": false, "score": 0, "creation_date": 1429108309, "post_id": 29652495, "comment_id": 47445872, "body": "Out of the box this is not possible with the Java API. You might need to use an 3rd party library (e.g. RockSaw, Jnetpcap, or similar)"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429165611, "post_id": 29652495, "comment_id": 47472457, "body": "Anyone know if you can execute C code from C? What?  You are <b>always</b> executing C code from C.  Have I missed something? Have you mispelled something?.  Please, edit."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3776427, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100004479099852/picture?type=large", "display_name": "thanos.ksk", "link": "https://stackoverflow.com/users/3776427/thanos-ksk"}, "edited": false, "score": 0, "creation_date": 1429111052, "post_id": 29653558, "comment_id": 47448010, "body": "i want o create a project which will do ddos attacks like tcp syn. The subject said to create 3 types of attack"}, {"owner": {"reputation": 116, "user_id": 2365280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67373ef8008ff7461cc2c5004aade18?s=128&d=identicon&r=PG", "display_name": "Zonk", "link": "https://stackoverflow.com/users/2365280/zonk"}, "reply_to_user": {"reputation": 57, "user_id": 3776427, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100004479099852/picture?type=large", "display_name": "thanos.ksk", "link": "https://stackoverflow.com/users/3776427/thanos-ksk"}, "edited": false, "score": 0, "creation_date": 1429113443, "post_id": 29653558, "comment_id": 47449913, "body": "Do you have to use Java? I would suggest python with scapy. Using Java is pretty much like buying a Hummer to drive around in the city - the wrong tool for the job."}, {"owner": {"reputation": 57, "user_id": 3776427, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100004479099852/picture?type=large", "display_name": "thanos.ksk", "link": "https://stackoverflow.com/users/3776427/thanos-ksk"}, "edited": false, "score": 0, "creation_date": 1429114070, "post_id": 29653558, "comment_id": 47450383, "body": "yes because i want to create afterall a android program to execute ddos attacks :P"}, {"owner": {"reputation": 116, "user_id": 2365280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67373ef8008ff7461cc2c5004aade18?s=128&d=identicon&r=PG", "display_name": "Zonk", "link": "https://stackoverflow.com/users/2365280/zonk"}, "reply_to_user": {"reputation": 57, "user_id": 3776427, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100004479099852/picture?type=large", "display_name": "thanos.ksk", "link": "https://stackoverflow.com/users/3776427/thanos-ksk"}, "edited": false, "score": 0, "creation_date": 1429114660, "post_id": 29653558, "comment_id": 47450790, "body": "Don&#39;t know if RockSaw runs on Android. I personally would either write it in C and use Android NDK (<a href=\"https://developer.android.com/tools/sdk/ndk/index.html\" rel=\"nofollow noreferrer\">developer.android.com/tools/sdk/ndk/index.html</a>) or create my own TCP/IP implementation to customize it for my needs."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429165825, "post_id": 29653558, "comment_id": 47472558, "body": "@Zonk, Sorry but I have been browsing the java.net package doc to search for a RawSocket class or something similar that allows you to get a raw socket.  Can you illustrate better your assert?"}, {"owner": {"reputation": 116, "user_id": 2365280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67373ef8008ff7461cc2c5004aade18?s=128&d=identicon&r=PG", "display_name": "Zonk", "link": "https://stackoverflow.com/users/2365280/zonk"}, "reply_to_user": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429184276, "post_id": 29653558, "comment_id": 47484644, "body": "@LuisColorado Client Socket: <code>Socket clSkt = new Socket(server, port);</code> Then create the data stream to write and read, process whatever you want to process and close your socket at the end. <a href=\"http://www.buyya.com/java/Chapter13.pdf\" rel=\"nofollow noreferrer\">Java Socket Programming</a> or <a href=\"http://www.tutorialspoint.com/java/java_networking.htm\" rel=\"nofollow noreferrer\">Java Networking</a>"}], "tags": [], "owner": {"reputation": 116, "user_id": 2365280, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f67373ef8008ff7461cc2c5004aade18?s=128&d=identicon&r=PG", "display_name": "Zonk", "link": "https://stackoverflow.com/users/2365280/zonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1429186923, "last_edit_date": 1429186923, "creation_date": 1429109563, "answer_id": 29653558, "question_id": 29652495, "link": "https://stackoverflow.com/questions/29652495/java-create-raw-packets-tcp-icmp/29653558#29653558", "title": "java create raw packets tcp/icmp", "body": "<p>I struggle bit to understand what exactly are you trying to do (explain it in C, what do you use there, libnet, raw sockets...)? In Java, you can create raw TCP/IP sockets with the <a href=\"https://docs.oracle.com/javase/7/docs/api/java/net/package-summary.html\" rel=\"nofollow\">java.net</a> package.</p>\n\n<p>Second, jnetpcap (and any other library you find with pcap) is used for network caputring. If you read jnetpcap, says that it's a Java library to access the C library libpcap.</p>\n\n<p>Last, the jnetpcap project also answers your question. Yes, you can run C code from within Java. Have a look at the <a href=\"http://en.wikipedia.org/wiki/Java_Native_Interface\" rel=\"nofollow\">Java Native Interface</a></p>\n\n<p>EDIT:\nSorry guys completely forgot that I used <a href=\"http://www.drdobbs.com/jpcap/199102239\" rel=\"nofollow\">jpcap</a> for this kind of things about six years ago (damn time flys by).</p>\n\n<pre><code>import jpcap.*;\nimport jpcap.packet.*;\n\nJpcapSender sender = JpcapSender.openDevice(NetworkInterface);\nPacket packet = new TCPPacket(); //construct your TCP\npacket.data = data; //what ever you want to send as payload\nEthernetPacket ether = new EthernetPacket();\nether.frametype = (short) /*whatever you need*/\npacket.datalink = ether;\nsender.sendPacket(packet);\n</code></pre>\n\n<p>The code above is a very rough shortcut of what I did past then. But there is plenty of tutorials and examples out there to get started!</p>\n"}], "owner": {"reputation": 57, "user_id": 3776427, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100004479099852/picture?type=large", "display_name": "thanos.ksk", "link": "https://stackoverflow.com/users/3776427/thanos-ksk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1155, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429186923, "creation_date": 1429106813, "question_id": 29652495, "link": "https://stackoverflow.com/questions/29652495/java-create-raw-packets-tcp-icmp", "title": "java create raw packets tcp/icmp", "body": "<p>i want to create raw packets in java like in c.</p>\n\n<pre><code>// Flags (8 bits)\n\n  // FIN flag (1 bit)\n  tcp_flags[0] = 0;\n\n  // SYN flag (1 bit): set to 1\n  tcp_flags[1] = 1;\n\n  // RST flag (1 bit)\n  tcp_flags[2] = 0;\n\n  // PSH flag (1 bit)\n  tcp_flags[3] = 0;\n\n  // ACK flag (1 bit)\n  tcp_flags[4] = 0;\n\n  // URG flag (1 bit)\n  tcp_flags[5] = 0;\n\n  // ECE flag (1 bit)\n  tcp_flags[6] = 0;\n\n  // CWR flag (1 bit)\n  tcp_flags[7] = 0;\n</code></pre>\n\n<p>this is a part from code in c and with it you can set the flags. I found some libraries like jnetpcap but as i can see there is not any function to manipulate them. \nAlso, anyone know if i can execute c code from c?</p>\n"}, {"tags": ["c", "linux", "compilation", "linker", "shared-libraries"], "comments": [{"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429109956, "post_id": 29652446, "comment_id": 47447188, "body": "<a href=\"https://lwn.net/Articles/631631/\" rel=\"nofollow noreferrer\">This LWN article</a> is the best reference I could find, and even it does not provide a clear answer to the question.  I <i>think</i>, however, that it implies that the entry point function can find <code>argc</code>, the <code>argv</code> array, and the <code>env</code> array on top (at the lowest addresses) of the stack when it starts."}, {"owner": {"reputation": 3042, "user_id": 789308, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c02ac9795923a7eca30c73e9bbbabf4e?s=128&d=identicon&r=PG", "display_name": "con-f-use", "link": "https://stackoverflow.com/users/789308/con-f-use"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429119282, "post_id": 29652446, "comment_id": 47453532, "body": "Thank you for digging that out. It is an intimidating article. Personally I&#39;m not keen on digging that deep into the technicalities and would very much like to see a working example instead. But if nobody comes up with something in the foreseeable future it is a good starting point."}], "answers": [{"tags": [], "owner": {"reputation": 12895, "user_id": 1881610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d33c1dcf29d614b9366ccc3e08ac793f?s=128&d=identicon&r=PG", "display_name": "Phillip", "link": "https://stackoverflow.com/users/1881610/phillip"}, "is_accepted": false, "score": 2, "last_activity_date": 1429358664, "last_edit_date": 1429358664, "creation_date": 1429358017, "answer_id": 29716964, "question_id": 29652446, "link": "https://stackoverflow.com/questions/29652446/how-to-change-interpreter-path-and-pass-command-line-arguments-to-an-executable/29716964#29716964", "title": "How to change interpreter path and pass command line arguments to an &quot;executable&quot; shared library on Linux?", "body": "<p>Add</p>\n\n<pre><code>int argc;\nchar **argv;\n\nasm(\"mov 8(%%rbp), %0\" : \"=&amp;r\" (argc));\nasm(\"mov %%rbp, %0\\n\"\n    \"add $16, %0\"      : \"=&amp;r\" (argv));\n</code></pre>\n\n<p>to the top of your <code>entry</code> function. On x86_64 platforms, this will give you access to the arguments.</p>\n\n<p>The <a href=\"https://lwn.net/Articles/631631/\" rel=\"nofollow\">LNW article</a> that John Bollinger linked to in the comments explains why this code works. It might interest you why this is not required when you write a normal C program, or rather, why it does not suffice do just give your <code>entry</code> function the two usual <code>int argc, char **argv</code> arguments: The entry point for a C program normally is <em>not</em> the <code>main</code> function, but instead an <a href=\"https://sourceware.org/git/?p=glibc.git;a=blob;f=sysdeps/x86_64/start.S;h=0d27a38e9c02835ce17d1c9287aa01be222e72eb;hb=HEAD#l58\" rel=\"nofollow\">assembler function</a> by glibc that does some preparations for you - among others fetch the arguments from the stack - and that eventually (via some intermediate functions) calls your <code>main</code> function.  Note that this also means that you might experience other problems, since you skip this initialization! For some history, <a href=\"http://en.wikipedia.org/wiki/X86_calling_conventions#x86-64_calling_conventions\" rel=\"nofollow\">the cdecl wikipedia page</a>, especially on the difference between x86 and x86_64, might be of further interest.</p>\n"}, {"comments": [{"owner": {"reputation": 2366, "user_id": 1262629, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYSQk.png?s=128&g=1", "display_name": "Laszlo Valko", "link": "https://stackoverflow.com/users/1262629/laszlo-valko"}, "edited": false, "score": 0, "creation_date": 1429367824, "post_id": 29717018, "comment_id": 47571858, "body": "And, frankly, the answer to both questions shows that this is a completely platform-dependent story. You <i>have to</i> manually code every supported platform into your program/Makefile/build script."}, {"owner": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1429374379, "post_id": 29717018, "comment_id": 47574265, "body": "SysV ABI is not applicable to the <code>entry</code> function, and the arguments will <i>not</i> be in registers. What&#39;s relevant here is how the <i>kernel</i> passes arguments to the process at startup (on the stack)."}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "reply_to_user": {"reputation": 162629, "user_id": 50617, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YFykQ.png?s=128&g=1", "display_name": "Employed Russian", "link": "https://stackoverflow.com/users/50617/employed-russian"}, "edited": false, "score": 0, "creation_date": 1429376800, "post_id": 29717018, "comment_id": 47575053, "body": "@EmployedRussian It&#39;s very relevant. <code>entry</code> expects arguments in registers. The kernel pushes them on the stack. That&#39;s the whole point of the ASM glue code. Are you saying that <code>entry</code> expects arguments on the stack? It clearly doesn&#39;t, you&#39;re welcome to try it out! Otherwise I&#39;m afraid I&#39;m not sure what you mean."}, {"owner": {"reputation": 34566, "user_id": 1475978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CUdQt.png?s=128&g=1", "display_name": "Nominal Animal", "link": "https://stackoverflow.com/users/1475978/nominal-animal"}, "edited": false, "score": 0, "creation_date": 1429462038, "post_id": 29717018, "comment_id": 47598727, "body": "@tux3: You could automate the interpreter name by compiling a dummy dynamically-linked executable, and using e.g. <code>LANG=C LC_ALL=C readelf -p .interp DYNAMIC-EXECUTABLE | sed -ne &#39;&#47;\\.so&#47; s|^[^&#47;]*\\(.*\\)$|static const char my_interp[] __attribute__((section(&quot;.interp&quot;))) = &quot;\\1&quot;;|p&#39; &gt; interp.h</code> to (re)generate a header file that only contains the interpreter path, and use the interpreter the dynamic executable used for the library, too. (<code>readelf</code> is part of binutils.) You should also save <code>interp-x86_64.h</code> etc. (and related Makefile handling) for those who do cross-compiling, though."}], "tags": [], "owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "is_accepted": true, "score": 4, "last_activity_date": 1429367930, "last_edit_date": 1495535045, "creation_date": 1429358332, "answer_id": 29717018, "question_id": 29652446, "link": "https://stackoverflow.com/questions/29652446/how-to-change-interpreter-path-and-pass-command-line-arguments-to-an-executable/29717018#29717018", "title": "How to change interpreter path and pass command line arguments to an &quot;executable&quot; shared library on Linux?", "body": "<blockquote>\n  <h2>How do I have to change the above program to pass command line arguments to a call of the .so-file?</h2>\n</blockquote>\n\n<p>When you run your shared library, <code>argc</code> and <code>argv</code> will be passed to your entry function on the stack.</p>\n\n<p>The problem is that the calling convention used when you compile your shared library on x86_64 linux is going to be that of the <a href=\"https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI\" rel=\"nofollow noreferrer\">System V AMD64 ABI</a>, which doesn't take arguments on the stack but in registers.</p>\n\n<p>You'll need some ASM glue code that fetches argument from the stack and puts them into the right registers.</p>\n\n<p>Here's a simple .asm file you can save as entry.asm and just link with:</p>\n\n<pre><code>global _entry\nextern entry, _GLOBAL_OFFSET_TABLE_\n\nsection .text\nBITS 64\n\n_entry:\n        mov rdi, [rsp]\n        mov rsi, rsp\n        add rsi, 8\n        call .getGOT\n.getGOT:\n        pop rbx\n        add rbx,_GLOBAL_OFFSET_TABLE_+$$-.getGOT wrt ..gotpc\n        jmp entry wrt ..plt\n</code></pre>\n\n<p>That code copies the arguments from the stack into the appropriate registers, and then calls your <code>entry</code> function in a position-independent way.</p>\n\n<p>You can then just write your <code>entry</code> as if it was a regular <code>main</code> function:</p>\n\n<pre><code>// Interpreter path is different on some systems\n//+definitely different for 32-Bit machines\n\nconst char my_interp[] __attribute__((section(\".interp\")))\n    = \"/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\";\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint entry(int argc, char* argv[]) {\n    printf(\"WooFoo! Got %d args!\\n\", argc);\n    exit (0);\n}\n</code></pre>\n\n<p>And this is how you would then compile your library:</p>\n\n<pre><code>nasm entry.asm -f elf64\ngcc -fPIC -o mini.so -shared -Wl,-e,_entry mini.c entry.o\n</code></pre>\n\n<p>The advantage is that you won't have inline asm statements mixed with your C code, instead your real entry point is cleanly abstracted away in a start file.</p>\n\n<blockquote>\n  <h2>It would also be nice to detect on compile time, wheter the target is a 32-Bit or 64-Bit binary to change the interpreter string accordingly.</h2>\n</blockquote>\n\n<p>Unfortunately, there's <a href=\"https://stackoverflow.com/questions/1505582/determining-32-vs-64-bit-in-c\">no completely clean, reliable way to do that</a>. The best you can do is rely on your preferred compiler having the right defines.</p>\n\n<p>Since you use GCC you can write your C code like this:</p>\n\n<pre><code>#if defined(__x86_64__)\n    const char my_interp[] __attribute__((section(\".interp\")))\n        = \"/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\";\n#elif defined(__i386__)\n    const char my_interp[] __attribute__((section(\".interp\")))\n        = \"/lib/ld-linux.so.2\";\n#else\n    #error Architecture or compiler not supported\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint entry(int argc, char* argv[]) {\n    printf(\"%d: WooFoo!\\n\", argc);\n    exit (0);\n}\n</code></pre>\n\n<p>And have two different start files.<br/>\nOne for 64bit:</p>\n\n<pre><code>global _entry\nextern entry, _GLOBAL_OFFSET_TABLE_\n\nsection .text\nBITS 64\n\n_entry:\n        mov rdi, [rsp]\n        mov rsi, rsp\n        add rsi, 8\n        call .getGOT\n.getGOT:\n        pop rbx\n        add rbx,_GLOBAL_OFFSET_TABLE_+$$-.getGOT wrt ..gotpc\n        jmp entry wrt ..plt\n</code></pre>\n\n<p>And one for 32bit:</p>\n\n<pre><code>global _entry\nextern entry, _GLOBAL_OFFSET_TABLE_\n\nsection .text\nBITS 32\n\n_entry:\n        mov edi, [esp]\n        mov esi, esp\n        add esi, 4\n        call .getGOT\n.getGOT:\n        pop ebx\n        add ebx,_GLOBAL_OFFSET_TABLE_+$$-.getGOT wrt ..gotpc\n        push edi\n        push esi\n        jmp entry wrt ..plt\n</code></pre>\n\n<p>Which means you now have two slightly different ways to compile your library for each target.</p>\n\n<p>For 64bit:</p>\n\n<pre><code>nasm entry.asm -f elf64\ngcc -fPIC -o mini.so -shared -Wl,-e,_entry mini.c entry.o -m64\n</code></pre>\n\n<p>And for 32bit:</p>\n\n<pre><code>nasm entry32.asm -f elf32\ngcc -fPIC -o mini.so -shared -Wl,-e,_entry mini.c entry32.o -m32\n</code></pre>\n\n<p>So to sum it up you now have two start files <code>entry.asm</code> and <code>entry32.asm</code>, a set of defines in your <code>mini.c</code> that picks the right interpreter automatically, and two slightly different ways of compiling your library depending on the target.</p>\n\n<p>So if we really want to go all the way, all that's left is to create a Makefile that detects the right target and builds your library accordingly.<br/>Let's do just that:</p>\n\n<pre><code>ARCH := $(shell getconf LONG_BIT)\n\nall: build_$(ARCH)\n\nbuild_32:\n        nasm entry32.asm -f elf32\n        gcc -fPIC -o mini.so -shared -Wl,-e,_entry mini.c entry32.o -m32\n\nbuild_64:\n        nasm entry.asm -f elf64\n        gcc -fPIC -o mini.so -shared -Wl,-e,_entry mini.c entry.o -m64\n</code></pre>\n\n<p>And we're done here. Just run <code>make</code> to build your library and let the magic happen.</p>\n"}], "owner": {"reputation": 3042, "user_id": 789308, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c02ac9795923a7eca30c73e9bbbabf4e?s=128&d=identicon&r=PG", "display_name": "con-f-use", "link": "https://stackoverflow.com/users/789308/con-f-use"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3612, "favorite_count": 2, "accepted_answer_id": 29717018, "answer_count": 2, "score": 8, "last_activity_date": 1429367930, "creation_date": 1429106688, "question_id": 29652446, "link": "https://stackoverflow.com/questions/29652446/how-to-change-interpreter-path-and-pass-command-line-arguments-to-an-executable", "title": "How to change interpreter path and pass command line arguments to an &quot;executable&quot; shared library on Linux?", "body": "<p>Here is a minimal example for an \"executable\" shared library (assumed file name: <code>mini.c</code>):</p>\n\n<pre><code>// Interpreter path is different on some systems\n//+definitely different for 32-Bit machines\n\nconst char my_interp[] __attribute__((section(\".interp\"))) \n    = \"/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\";\n\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\nint entry() {\n    printf(\"WooFoo!\\n\");\n    exit (0);\n}\n</code></pre>\n\n<p>If one compiles it with e.g.: <code>gcc -fPIC -o mini.so -shared -Wl,-e,entry mini.c</code>. \"Running\" the resulting <code>.so</code> will look like this:</p>\n\n<pre><code>confus@confusion:~$ ./mini.so\nWooFoo!\n</code></pre>\n\n<p>My question is now: <br>\n<strong>How  do I have to change the above program to pass command line arguments to a call of the <code>.so</code>-file?</strong> An example shell session after the change might e.g. look like this:</p>\n\n<pre><code>confus@confusion:~$ ./mini.so 2 bar\n1: WooFoo! bar!\n2: WooFoo! bar!\nconfus@confusion:~$ ./mini.so 3 bla\n1: WooFoo! bla!\n2: WooFoo! bla!\n3: WooFoo! bla!\n5: WooFoo! Bar!\n</code></pre>\n\n<p>It would also be nice to <strong>detect on compile time, wheter the target is a 32-Bit or 64-Bit binary</strong> to change the interpreter string accordingly.  Otherwise one gets a <em>\"Accessing a corrupted shared library\"</em> warning. Something like:</p>\n\n<pre><code>#ifdef SIXTY_FOUR_BIT\n    const char my_interp[] __attribute__((section(\".interp\"))) = \"/lib/x86_64-linux-gnu/ld-linux-x86-64.so.2\";\n#else\n    const char my_interp[] __attribute__((section(\".interp\"))) = \"/lib/ld-linux.so.2\";\n#endif\n</code></pre>\n\n<p>Or even better, to detect the appropriate path fully automatically to ensure it is right for the system the library is compiled on.</p>\n"}, {"tags": ["c", "memory", "struct", "compilation", "int"], "comments": [{"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "edited": false, "score": 0, "creation_date": 1429106998, "post_id": 29652386, "comment_id": 47444826, "body": "Since all the structure elements are <code>int</code> with regard to memory being allocated for both structures will be same.."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 4, "creation_date": 1429107508, "post_id": 29652386, "comment_id": 47445199, "body": "Note that it&#39;s easy to ask your compiler this question too: <code>printf(&quot;struct X1: %zu struct X2: %zu\\n&quot;, sizeof(struct X1), sizeof(struct X2));</code>"}, {"owner": {"reputation": 300, "user_id": 4757944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/020868dde3084b7226fad941088c9140?s=128&d=identicon&r=PG&f=1", "display_name": "that-ru551an-guy", "link": "https://stackoverflow.com/users/4757944/that-ru551an-guy"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1429107610, "post_id": 29652386, "comment_id": 47445287, "body": "@nos - yes but the compiler can&#39;t also explain why, or give a quick runthrough on struct padding. Not unless I code for it to... In which case I wouldn&#39;t need to ask now would I? mind... (<i>exploding sound</i>)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user395760"}, "edited": false, "score": 2, "creation_date": 1429106993, "post_id": 29652543, "comment_id": 47444820, "body": "Surely you mean 12 bytes?"}, {"owner": {"reputation": 300, "user_id": 4757944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/020868dde3084b7226fad941088c9140?s=128&d=identicon&r=PG&f=1", "display_name": "that-ru551an-guy", "link": "https://stackoverflow.com/users/4757944/that-ru551an-guy"}, "edited": false, "score": 0, "creation_date": 1429107105, "post_id": 29652543, "comment_id": 47444893, "body": "@haccks - I thought if you increment an int pointer it is 4 bytes?"}, {"owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "edited": false, "score": 2, "creation_date": 1429107471, "post_id": 29652543, "comment_id": 47445162, "body": "An <code>int</code> is of 4 bytes on your machine, 3 <code>int</code> will be of <code>3*4</code> = <code>12</code> bytes."}], "tags": [], "owner": {"reputation": 96743, "user_id": 2455888, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MQu4W.png?s=128&g=1", "display_name": "haccks", "link": "https://stackoverflow.com/users/2455888/haccks"}, "is_accepted": true, "score": 4, "last_activity_date": 1429107177, "last_edit_date": 1429107177, "creation_date": 1429106949, "answer_id": 29652543, "question_id": 29652386, "link": "https://stackoverflow.com/questions/29652386/would-the-two-following-examples-take-up-equal-memory-after-compiling/29652543#29652543", "title": "Would the two following examples take up equal memory after compiling?", "body": "<p>Rules for structure padding:  </p>\n\n<ul>\n<li><p>Padding is only inserted when a structure member is followed by a member with a larger alignment requirement or at the end of the structure.  </p></li>\n<li><p>The last member is padded with the number of bytes required so that the total size of the structure should be a multiple of the largest alignment of any structure member.    </p></li>\n</ul>\n\n<p>This suggests that both will take same memory space, 12-bytes each assuming size of <code>int</code> is <code>4</code> bytes. The reason is that there is no padding in either case. </p>\n"}, {"comments": [{"owner": {"reputation": 71857, "user_id": 47453, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412dc332ab3593c636e5a5202cf98870?s=128&d=identicon&r=PG", "display_name": "Bill Lynch", "link": "https://stackoverflow.com/users/47453/bill-lynch"}, "reply_to_user": {"reputation": 736, "user_id": 3695941, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/d09ea15b72ed247b054bc6b1df37ab44?s=128&d=identicon&r=PG&f=1", "display_name": "AndrewGrant", "link": "https://stackoverflow.com/users/3695941/andrewgrant"}, "edited": false, "score": 0, "creation_date": 1429107915, "post_id": 29652612, "comment_id": 47445539, "body": "@AndrewGrant: That&#39;s simply not true. The memory would be allocated and the values would have an <b>unspecified</b> value."}], "tags": [], "owner": {"reputation": 23197, "user_id": 29068, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/24ddcae119119f3ffd03320b3ff6bddf?s=128&d=identicon&r=PG", "display_name": "Timo Geusch", "link": "https://stackoverflow.com/users/29068/timo-geusch"}, "is_accepted": false, "score": 0, "last_activity_date": 1429107075, "creation_date": 1429107075, "answer_id": 29652612, "question_id": 29652386, "link": "https://stackoverflow.com/questions/29652386/would-the-two-following-examples-take-up-equal-memory-after-compiling/29652612#29652612", "title": "Would the two following examples take up equal memory after compiling?", "body": "<p>Both variants of struct X take up the same amount of memory, after all, they only contain three integers and the nested struct doesn't affect the memory layout of its member data when it comes to size.</p>\n\n<p>The struct in this case is only syntactic sugar to arrange its members in a specific order and doesn't introduce additional overhead.</p>\n\n<p>If there is no additional padding between the ints, both structs will consume 3 * sizeof(int) bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 1546999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d79ad7269df017b5782678cfc5178f?s=128&d=identicon&r=PG", "display_name": "aitorkun", "link": "https://stackoverflow.com/users/1546999/aitorkun"}, "is_accepted": false, "score": 2, "last_activity_date": 1429107195, "creation_date": 1429107195, "answer_id": 29652652, "question_id": 29652386, "link": "https://stackoverflow.com/questions/29652386/would-the-two-following-examples-take-up-equal-memory-after-compiling/29652652#29652652", "title": "Would the two following examples take up equal memory after compiling?", "body": "<p>My common sense says me that in both cases the program will allocate the same amount of memory (3 integers). </p>\n\n<p>In the end the C structs are not more than a way to help the developer to organize variables and make code more readable. Once compiled the program doesn't care about structs or code organization but about variables (memory) and operations (instructions).</p>\n"}], "owner": {"reputation": 300, "user_id": 4757944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/020868dde3084b7226fad941088c9140?s=128&d=identicon&r=PG&f=1", "display_name": "that-ru551an-guy", "link": "https://stackoverflow.com/users/4757944/that-ru551an-guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 29652543, "answer_count": 3, "score": 4, "last_activity_date": 1429108661, "creation_date": 1429106540, "question_id": 29652386, "link": "https://stackoverflow.com/questions/29652386/would-the-two-following-examples-take-up-equal-memory-after-compiling", "title": "Would the two following examples take up equal memory after compiling?", "body": "<p>Please help me with this concept:</p>\n\n<p>Which would take up more memory after compiling if both are declared and initialized?</p>\n\n<pre><code>struct V\n{\n    int a, b;\n};\n\nstruct X\n{\n    struct V v;\n    int N;\n};\n</code></pre>\n\n<p><strong>OR:</strong></p>\n\n<pre><code>struct X \n{\n    int a, b, c;\n};\n</code></pre>\n"}, {"tags": ["c", "language-lawyer", "c99", "undefined-behavior", "constant-expression"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1429107096, "post_id": 29652323, "comment_id": 47444879, "body": "Where does it say that the integer expression overflowing stops it from being a constant expression?"}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1429107289, "post_id": 29652323, "comment_id": 47445009, "body": "I assumed that since the cast to <code>int</code> instead of <code>long</code> might overflow (or lead to undefined behavior), the compilers rejected it as &quot;not a constant expression&quot;; therefore, I assumed that they should apply the same logic to the first case and reject it as well."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429109561, "post_id": 29652323, "comment_id": 47446838, "body": "Can you clarify whether you meant this at file scope or at block scope?"}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 0, "creation_date": 1429111288, "post_id": 29652323, "comment_id": 47448192, "body": "These variables were declared at file scope (as globals)."}, {"owner": {"reputation": 15485, "user_id": 3629249, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000228362830/picture?type=large", "display_name": "user3629249", "link": "https://stackoverflow.com/users/3629249/user3629249"}, "edited": false, "score": 0, "creation_date": 1429211797, "post_id": 29652323, "comment_id": 47504881, "body": "your assigning the &#39;address&#39; of the second byte of &#39;a&#39; into an array.  Seems like there would be some problems in placing an address into a long unsigned int array entry."}], "answers": [{"tags": [], "owner": {"reputation": 142904, "user_id": 1708801, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/01b9a608af886840fcf05fcfd9b5dc27?s=128&d=identicon&r=PG", "display_name": "Shafik Yaghmour", "link": "https://stackoverflow.com/users/1708801/shafik-yaghmour"}, "is_accepted": true, "score": 2, "last_activity_date": 1429798002, "last_edit_date": 1429798002, "creation_date": 1429107611, "answer_id": 29652817, "question_id": 29652323, "link": "https://stackoverflow.com/questions/29652323/initializer-with-constant-expression-having-possible-overflow-in-c99/29652817#29652817", "title": "Initializer with constant expression having possible overflow in C99", "body": "<p>From this clang developers thread on a similar issue: <a href=\"http://clang-developers.42468.n3.nabble.com/Function-pointer-is-compile-time-constant-when-cast-to-long-but-not-int-td4031904.html\" rel=\"nofollow\">Function pointer is compile-time constant when cast to long but not int?</a> the rationale is that the standard does not require the compiler to support this(<em>this scenario is not included in any of bullets in <code>6.6p7</code></em>) and although it is allowed to support this supporting truncated addresses would be burdensome:</p>\n\n<blockquote>\n  <p><strong>I assume that sizeof(int) &lt; sizeof(void(*)()) == sizeof(long) on\n  your target</strong>.  The problem is that the tool chain almost certainly\n  can't express a truncated address as a relocation.</p>\n  \n  <p>C only requires the implementation to support initializer values that\n  are either (1) constant binary data, (2) the address of some object, or\n  (3) or an offset added to the address of some object.  We're allowed,\n  but not required, to support more esoteric things like subtracting two\n  addresses or multiplying an address by a constant or, <strong>as in your\n  case, truncating the top bits of an address away.</strong>  That kind of\n  calculation would require support from the entire tool chain from\n  assembler to loader, including various file formats along the way.\n  That support generally doesn't exist.</p>\n</blockquote>\n\n<p>Your case, which is casting a pointer to a integer type does not fit any of the cases under <code>6.6</code> paragraph <code>7</code>:</p>\n\n<blockquote>\n  <p>More latitude is permitted for constant expressions in initializers.\n  Such a constant expression shall be, or evaluate to, one of the\n  following:</p>\n  \n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>anull pointer constant,</li>\n  <li>an address constant, or</li>\n  <li>an address constant for an object type plus or minus an integer constant expression.</li>\n  </ul>\n</blockquote>\n\n<p>but as mentioned in the post compiler are allowed to support other forms of constant expression:</p>\n\n<blockquote>\n  <p>An implementation may accept other forms of constant expressions.</p>\n</blockquote>\n\n<p>but neither <code>clang</code> nor <code>gcc</code> accept this.</p>\n"}, {"comments": [{"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 1, "creation_date": 1429110356, "post_id": 29652894, "comment_id": 47447480, "body": "<code>INT_MAX + INT_MAX</code> is not a constant expression. See 6.6/4 &quot;Each constant expression shall evaluate to a constant that is in the range of representable values for its type.&quot; I also take that clause to mean that constant expressions may not contain UB of any form."}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 0, "creation_date": 1429183963, "post_id": 29652894, "comment_id": 47484390, "body": "gcc only complains about the expression not being a constant in the second case (if I cast to <code>int</code> instead of <code>long</code>), not in the first case. I just compiled gcc from trunk (5.0.0) and it also rejects the second version. <a href=\"http://www.tutorialspoint.com/compile_c99_online.php\" rel=\"nofollow noreferrer\">This online C99 compiler</a>, which claims to use GCC 4.9.2, also produces the same error."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 0, "creation_date": 1429185014, "post_id": 29652894, "comment_id": 47485293, "body": "@anol No, it does not give that warning either. Which gives us the conclusion that the code you have posted is not the code you are using."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429185706, "post_id": 29652894, "comment_id": 47485836, "body": "@MattMcNabb In the case of integer overflow, I would rather think you get UB before the compiler even decides whether something is a constant expression or not. And since any binary combination of bits can be expressed as a two&#39;s complement number, then in practice the compiler will most likely produce some gibberish number upon encountering the overflow UB and then use that as the constant expression. I think you&#39;ll notice this on any compiler out there. For example, for the constant expression <code>INT_MAX + INT_MAX</code>, GCC gives you the value -2 and the size 4 bytes."}, {"owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 0, "creation_date": 1429189045, "post_id": 29652894, "comment_id": 47488441, "body": "@Lundin I pasted this code on the website: <code>int a; unsigned long b[] = {(unsigned int)&amp;a+1};</code>, hit Compile, and got both a warning and an error: <code>warning: cast from pointer to integer of different size [-Wpointer-to-int-cast]</code> and <code>error: initializer element is not constant</code>."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429217806, "post_id": 29652894, "comment_id": 47508605, "body": "@Lundin UB is a run-time property.  The compiler can refuse to translate a program if it is guaranteed to cause UB when run; however that&#39;s not necessarily true in this case (e.g. <code>void foo() { int x[] = { INT_MAX + INT_MAX }; }</code> and the program does not necessary call <code>foo()</code>). If no diagnostic is produced then it&#39;s a compiler bug since this is under the <i>Constraints</i> section."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 0, "creation_date": 1429251100, "post_id": 29652894, "comment_id": 47519683, "body": "@anol That code gives &quot;cast from pointer to integer...&quot; warning but nothing about initializer being not constant."}, {"owner": {"reputation": 8560, "user_id": 1633665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b603faf464ae55fcdd7dc2fb3b7ac063?s=128&d=identicon&r=PG", "display_name": "Virgile", "link": "https://stackoverflow.com/users/1633665/virgile"}, "reply_to_user": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "edited": false, "score": 1, "creation_date": 1429253476, "post_id": 29652894, "comment_id": 47520943, "body": "With the code put three comments above, and <code>gcc 4.9.1-16ubuntu6</code> (i.e. the one from Ubuntu 14.10 as of now), I get a warning and an error (as @anol) when compiling in 64-bit mode and nothing (as @lundin) in 32-bit mode (<code>gcc -m32 file.c</code>)."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 1, "last_activity_date": 1429108702, "last_edit_date": 1429108702, "creation_date": 1429107811, "answer_id": 29652894, "question_id": 29652323, "link": "https://stackoverflow.com/questions/29652323/initializer-with-constant-expression-having-possible-overflow-in-c99/29652894#29652894", "title": "Initializer with constant expression having possible overflow in C99", "body": "<p>First of all, your initializer is not necessarily a constant expression. If <code>a</code> has local scope, then it is assigned an address in run-time, when it gets pushed on the stack. C11 6.6/7 says that in order for a pointer to be a constant expression, it has to be an <em>address constant</em>, which is defined in 6.6/9 as:</p>\n\n<blockquote>\n  <p>An address constant is a null pointer, <strong>a pointer to an lvalue\n  designating an object of static storage duration</strong>, or a pointer to a\n  function designator; it shall be created explicitly using the unary &amp;\n  operator or an integer constant cast to pointer type, or implicitly by\n  the use of an expression of array or function type.</p>\n</blockquote>\n\n<p>(Emphasis mine)</p>\n\n<hr>\n\n<p>As for whether your code is standard C, yes it is. Pointer conversions to integers are allowed, although they may come with various forms of poorly specified behavior. Specified in 6.5/6:</p>\n\n<blockquote>\n  <p>Any pointer type may be converted to an integer type. Except as\n  previously specified, the result is implementation-defined. If the\n  result cannot be represented in the integer type, the behavior is\n  undefined. The result need not be in the range of values of any\n  integer type.</p>\n</blockquote>\n\n<p>To safely ensure that the pointer can fit into the integer, you need to use <code>uintptr_t</code>. But I don't think pointer to integer conversion was the reason you posted this question.</p>\n\n<hr>\n\n<p>Regarding whether an integer overflow would prevent it from being a compile time constant, I'm not sure where you got that idea from. I don't believe your reasoning is correct, for example <code>(INT_MAX + INT_MAX)</code> is a compile time constant and it is also guaranteed to overflow. (GCC gives you a warning.) In case it overflows, it will invoke undefined behavior.</p>\n\n<hr>\n\n<p>As for why you get errors about the expression not being a compile-time constant, I don't know. I can't reproduce it on gcc 4.9.1. I tried declaring <code>a</code> with both static and automatic storage duration but no difference.</p>\n\n<p>Sounds like you somehow accidentally compiled as C90, in which case gcc will tell you \"error: initializer element is not computable at load time\". Or maybe there was a compiler bug which has been fixed in my version of gcc.</p>\n"}, {"tags": [], "owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1429110306, "creation_date": 1429110306, "answer_id": 29653861, "question_id": 29652323, "link": "https://stackoverflow.com/questions/29652323/initializer-with-constant-expression-having-possible-overflow-in-c99/29653861#29653861", "title": "Initializer with constant expression having possible overflow in C99", "body": "<p>This code is not required to be accepted by a conforming implementation. You quoted the relevant passage in your question:</p>\n\n<blockquote>\n  <ol start=\"7\">\n  <li>More latitude is permitted for constant expressions in initializers. Such a constant expression shall be, or evaluate to, one of the following:\n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>a null pointer constant,</li>\n  <li>an address constant, or</li>\n  <li>an address constant for an object type plus or minus an integer constant expression.</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<p><code>(unsigned long)&amp;x</code> is none of those things. It's not an arithmetic constant because of C11 6.6/8:</p>\n\n<blockquote>\n  <p>Cast operators in an arithmetic constant expression shall only convert\n  arithmetic types to arithmetic types</p>\n</blockquote>\n\n<p>(pointer types are not arithmetic types, 6.2.5/18);  and it is not an address constant because all address constants are pointers (6.6/9).  Finally a pointer plus or minus an ICE is another pointer, so it is not that either.</p>\n\n<hr>\n\n<p>However 6.6/10 says that an implementation may accept other forms of constant expressions. I'm not sure whether this means the original code should be called ill-formed or not (ill-formed code requires a diagnostic). Clearly your compiler is accepting some other constant expressions here.</p>\n\n<hr>\n\n<p>The next issue is that casting from pointer to integer is implementation-defined. It may also be undefined if there is no integer representation corresponding to the particular pointer. (6.3.2.3/6)</p>\n\n<p>Finally, the <code>+ 1</code> on the end makes no difference. <code>unsigned long</code> arithmetic is well-defined on addition and subtraction, so it is OK if and only if <code>(unsigned long)&amp;x</code> is OK.</p>\n"}], "owner": {"reputation": 6600, "user_id": 1173674, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/364e5d67e6deec7330fdd25dc205e945?s=128&d=identicon&r=PG", "display_name": "anol", "link": "https://stackoverflow.com/users/1173674/anol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 1, "accepted_answer_id": 29652817, "answer_count": 3, "score": 6, "last_activity_date": 1429798002, "creation_date": 1429106391, "last_edit_date": 1429127157, "question_id": 29652323, "link": "https://stackoverflow.com/questions/29652323/initializer-with-constant-expression-having-possible-overflow-in-c99", "title": "Initializer with constant expression having possible overflow in C99", "body": "<p>Is this valid C99 code? If so, does it define an implementation-defined behavior?</p>\n\n<pre><code>int a;\nunsigned long b[] = {(unsigned long)&amp;a+1};\n</code></pre>\n\n<p>From my understanding of the C99 standard, from \u00a76.6 in the ISO C99 standard, this might be valid:</p>\n\n<blockquote>\n  <ol start=\"6\">\n  <li><p>An integer constant expression shall have integer type and shall only have operands that are integer constants (...) Cast operators in an integer constant expression shall only convert arithmetic types to integer types, except as part of an operand to the sizeof operator.</p></li>\n  <li><p>More latitude is permitted for constant expressions in initializers. Such a constant expression shall be, or evaluate to, one of the following:</p>\n  \n  <ul>\n  <li>an arithmetic constant expression,</li>\n  <li>(...)</li>\n  <li>an address constant for an object type plus or minus an integer constant expression.</li>\n  </ul></li>\n  </ol>\n</blockquote>\n\n<p>However, because there is the possibility of the addition overflowing, this might not be considered a constant expression and therefore not valid C99 code.</p>\n\n<p>Could someone please confirm if my reasoning is correct?</p>\n\n<p>Note that both GCC and Clang accept this code without warnings, even when using <code>-std=c99 -pedantic</code>. However, when casting to <code>unsigned int</code> instead of <code>unsigned long</code>, that is, using the following code:</p>\n\n<pre><code>int a;\nunsigned long b[] = {(unsigned int)&amp;a+1};\n</code></pre>\n\n<p>Then both compilers complain that the expression is not a compile-time constant.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4386, "user_id": 1282151, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/W1YtR.png?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/1282151/alex"}, "edited": false, "score": 0, "creation_date": 1429106553, "post_id": 29652207, "comment_id": 47444524, "body": "C doesn&#39;t fit such expectation."}, {"owner": {"reputation": 5764, "user_id": 2003898, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/j2hnV.jpg?s=128&g=1", "display_name": "dhein", "link": "https://stackoverflow.com/users/2003898/dhein"}, "edited": false, "score": 0, "creation_date": 1429108607, "post_id": 29652207, "comment_id": 47446121, "body": "Why every one knows what he is asking for? His code snippets are all made of valid syntax, but I really don&#39;t know what he wants to know, what he is expecting to happen, and what is wrong with his diea precisely."}, {"owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "edited": false, "score": 0, "creation_date": 1429119031, "post_id": 29652207, "comment_id": 47453386, "body": "Zaibis, it sounds like he&#39;s asking for something like javascript&#39;s ability to iterate through all the properties of an object as in <a href=\"http://stackoverflow.com/questions/684672/loop-through-javascript-object\" title=\"loop through javascript object\">stackoverflow.com/questions/684672/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 3, "last_activity_date": 1429106479, "creation_date": 1429106479, "answer_id": 29652363, "question_id": 29652207, "link": "https://stackoverflow.com/questions/29652207/can-you-access-members-of-a-structure-using-for-loop/29652363#29652363", "title": "Can you access Members of a Structure using for loop?", "body": "<p>No, there's no such support built into C.</p>\n\n<p>Realize that the actual code required to \"set\" a value varies greatly with the type of the value to be set and that variable names do not exist at runtime.</p>\n\n<p>It can be done by adding the necessary meta data yourself, but it's not going to be very easy and of course will require maintenance when/if the structure changes.</p>\n"}, {"tags": [], "owner": {"reputation": 4501, "user_id": 1053930, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/EyjC7.jpg?s=128&g=1", "display_name": "Shashwat Kumar", "link": "https://stackoverflow.com/users/1053930/shashwat-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1429106516, "creation_date": 1429106516, "answer_id": 29652378, "question_id": 29652207, "link": "https://stackoverflow.com/questions/29652207/can-you-access-members-of-a-structure-using-for-loop/29652378#29652378", "title": "Can you access Members of a Structure using for loop?", "body": "<p>This is not possible in C. After compilation, each variable is referenced by memory address only and no variable names are stored.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 4265061, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CAjJkaS9nTQ/AAAAAAAAAAI/AAAAAAAAAMQ/KUb6sQQs2Po/photo.jpg?sz=128", "display_name": "dinesh bethekar", "link": "https://stackoverflow.com/users/4265061/dinesh-bethekar"}, "is_accepted": false, "score": 0, "last_activity_date": 1429108138, "creation_date": 1429108138, "answer_id": 29652997, "question_id": 29652207, "link": "https://stackoverflow.com/questions/29652207/can-you-access-members-of-a-structure-using-for-loop/29652997#29652997", "title": "Can you access Members of a Structure using for loop?", "body": "<p>Hope this code answer to your question......if I understood your problem correctly</p>\n\n<pre><code>#include&lt;stdio.h&gt;\n#include&lt;string.h&gt;\ntypedef struct Vehicle\n{\n  int wheels;\n  char vname[20];\n  char color[10];  \n}Vehicles;\n\nint main(){\n    Vehicles v[2];\n    v[0].wheels = 4;\n    strcpy(v[0].vname, \"dsvdf\");\n    strcpy(v[0].color, \"bfdvsidvbi\");\n    v[1].wheels = 4;\n    strcpy(v[1].vname, \"dsvdf\");\n    strcpy(v[1].color, \"bfdvvfbdfsidvbi\"); \n    int i;\n    for ( i = 0; i &lt; 2; ++i){\n     printf(\"Vehicle No of Wheels : %d\\n\",v[i].wheels);\n     printf(\"Vehicle Name           : %s\\n\",v[i].vname) ;\n     printf(\"Vehicle Color          : %s\\n\",v[i].color)\n    }\n    return(0);\n }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32098, "user_id": 646887, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YJ0Ye.jpg?s=128&g=1", "display_name": "Klas Lindb&#228;ck", "link": "https://stackoverflow.com/users/646887/klas-lindb%c3%a4ck"}, "is_accepted": false, "score": 0, "last_activity_date": 1429108489, "creation_date": 1429108489, "answer_id": 29653144, "question_id": 29652207, "link": "https://stackoverflow.com/questions/29652207/can-you-access-members-of-a-structure-using-for-loop/29653144#29653144", "title": "Can you access Members of a Structure using for loop?", "body": "<p>You can do it by using function pointers. Since C is strongly typed, you would still have to handle fields of different type separately, though.</p>\n\n<p>Example:</p>\n\n<pre><code>/* setInt_type is a type for function pointers to a function that takes a struct data*, and an int as parameters and returns int */\ntypedef int (*)(struct data*, int) setInt_type; \n\n/* Setter function, need one for each int field */\nint setAccountIdNumber(struct data *account, int newValue) {\n    return account-&gt;idNumber = newValue;\n}\nint setAccountDateOfBirth(struct data *account, int newValue) {\n    return account-&gt;dateOfBirth = newValue;\n}\n\n/* Function that can operate on any int field */\nint setAccountIntField(struct data *account, int newValue, setInt_type setField) {\n    setField(account, newValue);\n}\n</code></pre>\n\n<p>Then you can create an array of function pointers:</p>\n\n<pre><code>const setInt_type INT_FIELDS[] = { setAccountIdNumber, setAccountDateOfBirth }\n</code></pre>\n\n<p>And finally use it all in a program:</p>\n\n<pre><code>int main() {\n    setAccountIntField(&amp;rec[3], 43, setAccountIdNumber); // Assigns 43 to rec[3].idNumber\n\n    setAccountIntField(&amp;rec[3], 43, setAccountDateOfBirth); // Assigns 43 to rec[3].dateOfBirth\n\n    // or, using INT_FIELDS:\n    setAccountIntField(&amp;rec[3], 43, INT_FIELDS[1]); // Assigns 43 to rec[3].dateOfBirth\n\n    return 0\n}\n</code></pre>\n\n<p>As you can see, it isn't quite as neat as one would like.</p>\n"}], "owner": {"reputation": 11, "user_id": 4792185, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MG2CVrebaiQ/AAAAAAAAAAI/AAAAAAAAATk/6_gVvPYLYpU/photo.jpg?sz=128", "display_name": "Lewis994", "link": "https://stackoverflow.com/users/4792185/lewis994"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 29652363, "answer_count": 4, "score": 0, "last_activity_date": 1429108489, "creation_date": 1429106104, "last_edit_date": 1429106481, "question_id": 29652207, "link": "https://stackoverflow.com/questions/29652207/can-you-access-members-of-a-structure-using-for-loop", "title": "Can you access Members of a Structure using for loop?", "body": "<p>Is there a way to access members of a struct using a for loop?\nMy program runs multiple commands for each member. The commands are identical except that the member is being changed each time.</p>\n\n<pre><code>struct data\n{\n    int recordID;\n    int idNumber;\n    char firstName[100];\n    char lastName[100];\n    int dateOfBirth;\n    char grade[2];\n};\n\n#define ACCOUNTS 100\nstruct data rec[ACCOUNTS];\n</code></pre>\n\n<p>I was hoping for something like </p>\n\n<pre><code>const char *FIELDID[][6] =\n{\n    {\"recordID\", \"idNumber\", \"firstName\", \"lastName\", \"dateOfBirth\", \"grade\"},\n{\"something else\", \"something else\", \"something else\", \"something else\", \"something else\", \"something else\"},\n{\"something else\", \"something else\", \"something else\", \"something else\", \"something else\", \"something else\"}\n};\n</code></pre>\n\n<p>and call</p>\n\n<pre><code>rec[count].FEILDID[0][0] = value;\n</code></pre>\n"}, {"tags": ["c", "android-ndk"], "comments": [{"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 0, "creation_date": 1429114135, "post_id": 29652111, "comment_id": 47450430, "body": "The cast is unnecessary; <code>y = x;</code> will do the same conversion implicitly. <code>%u</code> requires an argument of type <code>unsigned int</code> (assuming <code>print_log</code> behaves like <code>printf</code>). To print a <code>uint32_t</code> value, you can use <code>print_log(&quot;%lu&quot;, (unsigned long)x);</code>"}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4493926, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6749bf90141208d1956fe23607221884?s=128&d=identicon&r=PG&f=1", "display_name": "homelesser", "link": "https://stackoverflow.com/users/4493926/homelesser"}, "edited": false, "score": 0, "creation_date": 1429150361, "post_id": 29655339, "comment_id": 47467636, "body": "Thx for reply. In my program, I want to calculate the difference between two double numbers. The value should be positive, however, it becomes negative caused by another bug. So I wonder why the value is different between linux-gcc and NDK. And now, I think I should cast the value into int32_t first, then cast into uint32_t."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "reply_to_user": {"reputation": 45, "user_id": 4493926, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6749bf90141208d1956fe23607221884?s=128&d=identicon&r=PG&f=1", "display_name": "homelesser", "link": "https://stackoverflow.com/users/4493926/homelesser"}, "edited": false, "score": 0, "creation_date": 1429158667, "post_id": 29655339, "comment_id": 47469832, "body": "I suggest computing the difference as a <code>double</code> and then testing whether it&#39;s negative."}], "tags": [], "owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1429114063, "creation_date": 1429114063, "answer_id": 29655339, "question_id": 29652111, "link": "https://stackoverflow.com/questions/29652111/ndk-convert-a-negative-double-number-into-uint32-t-got-zero/29655339#29655339", "title": "NDK- convert a negative double number into uint32_t got zero", "body": "<p>The <code>double</code> value <code>-1.0</code> is outside the range of <code>uint32_t</code>.</p>\n\n<p>Converting a signed or unsigned integer value to an unsigned integer type has well-defined behavior. The result is wrapped to the range of the target type (reduced modulo MAX+1, where MAX is the maximum value of the target type).</p>\n\n<p>Converting an out-of-range floating-point value to an integer type has undefined behavior. It's not surprising that the result varies from one system to another. In principle, it could even crash your program.</p>\n\n<p>Once you decide what result you want given an input of <code>-1.0</code>, you can figure out how to generate that result without undefined behavior.</p>\n"}], "owner": {"reputation": 45, "user_id": 4493926, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6749bf90141208d1956fe23607221884?s=128&d=identicon&r=PG&f=1", "display_name": "homelesser", "link": "https://stackoverflow.com/users/4493926/homelesser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 29655339, "answer_count": 1, "score": 0, "last_activity_date": 1429114063, "creation_date": 1429105887, "question_id": 29652111, "link": "https://stackoverflow.com/questions/29652111/ndk-convert-a-negative-double-number-into-uint32-t-got-zero", "title": "NDK- convert a negative double number into uint32_t got zero", "body": "<p>Sample code is like this.</p>\n\n<pre><code>{\n    uint32_t x;\n    double y;\n    y = -1;            // any negative number;\n    x = (uint32_t)(y);\n    print_log(\"%u\", x);// here, x will be outputed, and it's 0;\n}\n</code></pre>\n\n<p>Why will x be 0?</p>\n\n<p>I run the same code in linux-gcc, the result is different.</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 4230, "user_id": 945873, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/d561be4c73996732e6639b5421abfb97?s=128&d=identicon&r=PG&f=1", "display_name": "itdoesntwork", "link": "https://stackoverflow.com/users/945873/itdoesntwork"}, "edited": false, "score": 0, "creation_date": 1429105747, "post_id": 29651966, "comment_id": 47443834, "body": "possible duplicate: <a href=\"http://stackoverflow.com/questions/16099271/including-files-in-header-vs-implementation-file-c\" title=\"including files in header vs implementation file c\">stackoverflow.com/questions/16099271/&hellip;</a>"}, {"owner": {"reputation": 22818, "user_id": 509868, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/83450238b4ee0eddbf54d7ce5a3a64e4?s=128&d=identicon&r=PG", "display_name": "anatolyg", "link": "https://stackoverflow.com/users/509868/anatolyg"}, "edited": false, "score": 0, "creation_date": 1429106911, "post_id": 29651966, "comment_id": 47444773, "body": "BTW the &quot;include guards&quot; <code>#ifndef _IO_H_</code>, <code>#define _IO_H_</code> and <code>#endif &#47;*_IO_H_*&#47;</code> are there specifically to make it possible to include header files into other header files. I guess your <code>stdint.h</code> file <a href=\"http://stackoverflow.com/q/8483955/509868\">contains such include guards too</a> - if no (extremely unlikely), it&#39;s dangerous to do <code>#include &lt;stdint.h&gt;</code> in your header file."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 2, "creation_date": 1429106985, "post_id": 29651966, "comment_id": 47444817, "body": "note : <code>_IO_H_</code> corresponds to the reserved name. So This is illegal."}], "answers": [{"comments": [{"owner": {"reputation": 39526, "user_id": 265804, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/156ef8708acdbf6a9ef76dad0d69609f?s=128&d=identicon&r=PG&f=1", "display_name": "Blagovest Buyukliev", "link": "https://stackoverflow.com/users/265804/blagovest-buyukliev"}, "edited": false, "score": 0, "creation_date": 1429106193, "post_id": 29652052, "comment_id": 47444207, "body": "In addition, avoid including any unnecessary header files in the following situation: when <code>file.h</code> is the public header for <code>file.c</code> and <code>file.c</code> uses, for example, some math, include <code>math.h</code> only in the source file and not in the header."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 7, "last_activity_date": 1429106327, "last_edit_date": 1429106327, "creation_date": 1429105748, "answer_id": 29652052, "question_id": 29651966, "link": "https://stackoverflow.com/questions/29651966/is-it-ok-to-include-files-into-a-header-file/29652052#29652052", "title": "Is it ok to include files into a header file", "body": "<p>Yes, it's very common.</p>\n\n<p>Some say it's a bad idea, but I don't agree since obviously the header you're writing <em>needs</em> <code>&lt;stdint.h&gt;</code> and it's quite rude (and very complicated for larger code) to require the user of the header to figure that out.</p>\n\n<p>That said, of course you should never include headers that you don't need, since that contributes to both confusion and build times, both of which are bad and should be minimized.</p>\n"}], "owner": {"reputation": 1753, "user_id": 4637326, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/1093075744051398/picture?type=large", "display_name": "Radoslaw Krasimirow", "link": "https://stackoverflow.com/users/4637326/radoslaw-krasimirow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 29652052, "answer_count": 1, "score": 3, "last_activity_date": 1429110339, "creation_date": 1429105556, "last_edit_date": 1429110339, "question_id": 29651966, "link": "https://stackoverflow.com/questions/29651966/is-it-ok-to-include-files-into-a-header-file", "title": "Is it ok to include files into a header file", "body": "<p>Is it a common practice to include header files into another header file like this:</p>\n\n<pre><code>#ifndef _IO_H_\n#define _IO_H_\n#include &lt;stdint.h&gt; //Is this OK?\ntypedef struct\n{\n   uint8_t PIN0 :1;\n   uint8_t PIN1 :1;\n   uint8_t PIN2 :1;\n   uint8_t PIN3 :1;\n   uint8_t PIN4 :1;\n   uint8_t PIN5 :1;\n   uint8_t PIN6 :1;\n   uint8_t PIN7 :1;\n}pin_map;\n#endif /*_IO_H_*/\n</code></pre>\n"}, {"tags": ["c", "openal", "oggvorbis"], "comments": [{"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 2, "creation_date": 1429107392, "post_id": 29651912, "comment_id": 47445097, "body": "Well, why not just try that command. As I understand nothings.org/stb_vorbis/samples/sample.c, it reads a file, &quot;converts it to short&quot; (?? I guess this means &quot;16 bit samples&quot;), and updates the <i>pointer to</i> with this memory. To know if that is enough to &quot; get something that I can actually send to a openal buffer&quot; depends on what OpenAL accepts."}], "answers": [{"comments": [{"owner": {"reputation": 369, "user_id": 4350553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88dd154c899cb178c1c7d8289cefc5e0?s=128&d=identicon&r=PG&f=1", "display_name": "twkmz", "link": "https://stackoverflow.com/users/4350553/twkmz"}, "edited": false, "score": 0, "creation_date": 1429148833, "post_id": 29656706, "comment_id": 47467225, "body": "I did try, but I&#39;m not sure that it gives me the data I need to send to openal. Anyway, I solved it by A) Actually playing around with openal. and B) Using sdl_mixer to load ogg files. I am using sdl to get the window running anyway, so sdl_mixer suits perfectly. I just wanted to avoid dependencies"}], "tags": [], "owner": {"reputation": 8652, "user_id": 2040863, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/IspsC.jpg?s=128&g=1", "display_name": "John Hascall", "link": "https://stackoverflow.com/users/2040863/john-hascall"}, "is_accepted": false, "score": 1, "last_activity_date": 1429118422, "creation_date": 1429118422, "answer_id": 29656706, "question_id": 29651912, "link": "https://stackoverflow.com/questions/29651912/how-to-load-ogg-file-in-c/29656706#29656706", "title": "How to load ogg file in c?", "body": "<p>Have you tried it?  What results/error did you get?  Perhaps something like this:</p>\n\n<pre><code>int channels;\nint sample_rate;\nshort * output;\nint rc = stb_vorbis_decode_filename(\"somefile.ogg\", &amp;channels, &amp;sample_rate, &amp;output);\nif (rc == -1) fprintf(stderr, \"oops\\n\");\n</code></pre>\n"}], "owner": {"reputation": 369, "user_id": 4350553, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/88dd154c899cb178c1c7d8289cefc5e0?s=128&d=identicon&r=PG&f=1", "display_name": "twkmz", "link": "https://stackoverflow.com/users/4350553/twkmz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1585, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429118422, "creation_date": 1429105434, "last_edit_date": 1592644375, "question_id": 29651912, "link": "https://stackoverflow.com/questions/29651912/how-to-load-ogg-file-in-c", "title": "How to load ogg file in c?", "body": "<p>I'm learning about audio with openal and trying to load ogg files into memory so I can play them with openal. I have been searching for a library to load ogg files and the best one I found was <a href=\"https://github.com/nothings/stb/blob/master/stb_vorbis.c\" rel=\"nofollow noreferrer\">this one</a>, it has no dependences. But the documentation is messy and I can't find a decent tutorial-example online.\nAll I want to know is how to load an ogg and get something that I can actually send to a openal buffer.</p>\n<p><strong>Q: If I have this call:</strong></p>\n<pre><code>stb_vorbis_decode_filename(const char *filename, int *channels, int *sample_rate, short **output);\n</code></pre>\n<p><strong>it should decode &quot;filename&quot; and store the data into &quot;output&quot;. So I can send it to openal right?</strong>\nIt's not lack of research, after hours of reading I can't really get how it works. If there's another library to load ogg files easily then please let me know.</p>\n<p>Thanks!</p>\n"}, {"tags": ["c", "sockets", "multiprocessing", "fork", "server"], "comments": [{"owner": {"reputation": 7673, "user_id": 3004881, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/lFgVw.jpg?s=128&g=1", "display_name": "Dan Getz", "link": "https://stackoverflow.com/users/3004881/dan-getz"}, "edited": false, "score": 0, "creation_date": 1429269570, "post_id": 29651858, "comment_id": 47531454, "body": "None of the code you posted appears to be able to print &quot;connection refused&quot;. It does appear to be able to print more specific error messages; are you seeing one of those? Or by &quot;say&quot; do you mean something other than &quot;print&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "is_accepted": true, "score": 0, "last_activity_date": 1429272850, "last_edit_date": 1429272850, "creation_date": 1429271931, "answer_id": 29698560, "question_id": 29651858, "link": "https://stackoverflow.com/questions/29651858/client-always-gets-connection-refused-when-connect-to-servers-new-port-socket/29698560#29698560", "title": "client always gets connection refused when connect to server&#39;s new port socket", "body": "<p>You shouldn't send the new port number until after the bind succeeds. And you don't need to use a randomized data port number at all. Just specify zero, do the <code>bind()</code>, call <code>getsockname()</code>, and see what port number the system allocated. Then send <em>that</em> to the client. </p>\n"}], "owner": {"reputation": 3, "user_id": 4672152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8de2e7c567ac470c4af6a64e675ea7e?s=128&d=identicon&r=PG&f=1", "display_name": "zack williams", "link": "https://stackoverflow.com/users/4672152/zack-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "accepted_answer_id": 29698560, "answer_count": 1, "score": 0, "last_activity_date": 1429272850, "creation_date": 1429105295, "last_edit_date": 1429265739, "question_id": 29651858, "link": "https://stackoverflow.com/questions/29651858/client-always-gets-connection-refused-when-connect-to-servers-new-port-socket", "title": "client always gets connection refused when connect to server&#39;s new port socket", "body": "<p>I'm designing a client/server system based on socket programming. Client first connects to a socket Sa with fixed port Pa on server, to get a new port number Pb for data transference. After getting Pb, close Sa and make a new socket Sb with Pb, but client always says 'connection refused'.</p>\n\n<p>All above is in a child process fork() after Sa accept(), so what's the problem?</p>\n\n<pre><code>while (1)\n{\n    struct sockaddr_in client_addr;\n    socklen_t length = sizeof(client_addr);\n\n    int new_server_socket = accept(server_socket,(struct sockaddr*)&amp;client_addr,&amp;length);\n    if ( new_server_socket &lt; 0)\n    {\n        printf(\"Server Accept Failed!\\n\");\n        break;\n    }\n\n    printf(\"get new connection!\\n\");\n\n    int child_process_pid = fork(); \n    if(child_process_pid == 0 )\n    {\n        close(server_socket); \n        int dataSock;\n        char buffer[BUFFER_SIZE];\n        bzero(buffer,BUFFER_SIZE);\n        length = recv(new_server_socket,buffer,BUFFER_SIZE,0);\n        if (length &lt; 0)\n        {\n            printf(\"Server Recieve Data Failed!/n\");\n            exit(1);\n        }\n\n        if(strcmp(buffer, \"Get New Port\\n\") == 0)\n        {\n            srand((unsigned)time(NULL));\n            dataSock = (rand() % 10000) + 20000;\n            //printf(\"num is %d\\n\", num);\n            char sockNum[6];\n            sprintf(sockNum, \"%d\", dataSock);\n            bzero(buffer, BUFFER_SIZE);\n            strcpy(buffer, \"The new port num is \");\n            strcat(buffer, sockNum); \n            strcat(buffer, \" \\n\");\n\n            struct sockaddr_in data_server_addr;\n            bzero(&amp;data_server_addr,sizeof(data_server_addr)); \n\n            data_server_addr.sin_family = AF_INET;\n            data_server_addr.sin_addr.s_addr = htons(INADDR_ANY);\n            data_server_addr.sin_port = htons(dataSock);\n\n            int data_server_socket = socket(AF_INET,SOCK_STREAM,0);\n            if( data_server_socket &lt; 0)\n            {\n                printf(\"Create Socket Failed!\");\n                exit(1);\n            }\n\n            if( bind(data_server_socket,(struct sockaddr*)&amp;data_server_addr,sizeof(data_server_addr)))\n            {\n                printf(\"Server Bind Port : %d Failed!\", dataSock); \n                exit(1);\n            }\n\n            if ( listen(data_server_socket, LENGTH_OF_LISTEN_QUEUE) )\n            {\n                printf(\"Server Listen Failed!\"); \n                exit(1);\n            }\n\n            send(new_server_socket,buffer,BUFFER_SIZE,0);\n            close(new_server_socket);   \n\n                while(1)\n                {\n                    struct sockaddr_in client_addr;\n                    socklen_t length = sizeof(client_addr);\n\n                    int new_data_server_socket = accept(data_server_socket,(struct sockaddr*)&amp;client_addr,&amp;length);\n\n                    if ( new_data_server_socket &lt; 0)\n                    {\n                        printf(\"Server Data Connection Accept Failed!\\n\");\n                        break;\n                    }\n\n                    printf(\"get new data connection!\\n\");\n</code></pre>\n"}, {"tags": ["c", "algorithm", "optimization", "reduction", "sat"], "comments": [{"owner": {"reputation": 64961, "user_id": 66686, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5c09f46f4edab31c43465b9f36638678?s=128&d=identicon&r=PG", "display_name": "Jens Schauder", "link": "https://stackoverflow.com/users/66686/jens-schauder"}, "edited": false, "score": 1, "creation_date": 1429109197, "post_id": 29651856, "comment_id": 47446552, "body": "Big +1 for putting so much offer in a question"}], "answers": [{"comments": [{"owner": {"reputation": 2451, "user_id": 3493433, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Rv0Vj.jpg?s=128&g=1", "display_name": "Valentin Montmirail", "link": "https://stackoverflow.com/users/3493433/valentin-montmirail"}, "edited": false, "score": 0, "creation_date": 1429109828, "post_id": 29653549, "comment_id": 47447063, "body": "Oups sorry, I indeed put the l != i and l != j in the code, but I didn&#39;t precise it on the equation.  for the constraint you said, It&#39;s indeed missing :/ but I don&#39;t know for now how to write it down ... :/   and thanks for the hint, I will try to put a target on what exactly is doing a mess in my constraints... :/"}, {"owner": {"reputation": 2451, "user_id": 3493433, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Rv0Vj.jpg?s=128&g=1", "display_name": "Valentin Montmirail", "link": "https://stackoverflow.com/users/3493433/valentin-montmirail"}, "edited": false, "score": 0, "creation_date": 1429111341, "post_id": 29653549, "comment_id": 47448235, "body": "after some test, I think the only missing part is the constraint that you are talking about in fact. because solution makes sense, it just forgetting some mandatory tasks."}], "tags": [], "owner": {"reputation": 64961, "user_id": 66686, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/5c09f46f4edab31c43465b9f36638678?s=128&d=identicon&r=PG", "display_name": "Jens Schauder", "link": "https://stackoverflow.com/users/66686/jens-schauder"}, "is_accepted": true, "score": 1, "last_activity_date": 1429109548, "creation_date": 1429109548, "answer_id": 29653549, "question_id": 29651856, "link": "https://stackoverflow.com/questions/29651856/flow-job-shop-to-boolean-satisfiability-polynomial-time-reduction-part-2/29653549#29653549", "title": "Flow/Job Shop to Boolean satisfiability [Polynomial-time reduction] part 2", "body": "<p>There is a bug in the first two equation you are giving: you are missing an l != j. Of course I have no idea if this bug is in your code as well.</p>\n\n<p>I think you are also missing a constraint that says: every job has to happen on every machine at least once (you only have the at most once part).</p>\n\n<p>On more hint for debugging this: try it with the simplest examples that are possible: 1 machine, 1 job; and work from there to 2 machines, 1 job and 1 machine 2 jobs. </p>\n\n<p>With 2 machines and three jobs, there is to much that can go wrong.</p>\n"}], "owner": {"reputation": 2451, "user_id": 3493433, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/Rv0Vj.jpg?s=128&g=1", "display_name": "Valentin Montmirail", "link": "https://stackoverflow.com/users/3493433/valentin-montmirail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 29653549, "answer_count": 1, "score": 1, "last_activity_date": 1429170333, "creation_date": 1429105291, "last_edit_date": 1495542611, "question_id": 29651856, "link": "https://stackoverflow.com/questions/29651856/flow-job-shop-to-boolean-satisfiability-polynomial-time-reduction-part-2", "title": "Flow/Job Shop to Boolean satisfiability [Polynomial-time reduction] part 2", "body": "<p>here is the continuity of my first question (<a href=\"https://stackoverflow.com/questions/29366185/flow-shop-to-boolean-satisfiability-polynomial-time-reduction\">Flow Shop to Boolean satisfiability [Polynomial-time reduction]</a>). </p>\n\n<p>Because something is wrong and I didn't success to know where exactly. I ask for the help of StackOverFlow's masters once again :)</p>\n\n<p>For the sum-up of what I have for now : </p>\n\n<ul>\n<li>I have input file who look like this : </li>\n</ul>\n\n<blockquote>\n<pre><code>3 2\n1 1 1\n1 1 1\n</code></pre>\n  \n  <p>Who represents : 3 jobs, 2 shops (machines), and the duration of each job on each shop (machine). And I want for theses problems, to find the optimum C_max value. </p>\n</blockquote>\n\n<p>So for example, it should give in output this result (sorry for paint.exe xD): </p>\n\n<p><img src=\"https://i.stack.imgur.com/zUl3K.png\" alt=\"C_max of the example\"></p>\n\n<p>So to read theses files, I create 2 structures : Resource and Problem who look like this :</p>\n\n<pre><code>typedef struct _resource {\n\n   unsigned int numShop;\n   unsigned int numJob;\n   unsigned int value;\n\n} Resource;\n\ntypedef struct _problem {\n\n   unsigned int nbShops;\n   unsigned int nbJobs;\n   Resource** resources;\n\n} Problem;\n</code></pre>\n\n<p>The reading is okay, and I have all the informations in the input files inside my structures.</p>\n\n<p>I want to transform this optimal problem (find the best solution) into a decision problem (is THIS a possible solution ?) and for this, my goal is to transform the JobShop/FlowShop problem into a SAT problem.</p>\n\n<ul>\n<li>My goal is as follow : I put the value of C_max as fixed, I create a SAT problem, and I will decrease the C_max until the SAT-solver says that the problem has no solution. The last-value with a solution will be the optimal value.</li>\n</ul>\n\n<p>Thanks to @Jens Schauder, I have the beginning of a solution. My booleans variables are like this: <code>s_1_2_3 with the meaning resource one gets used at machine 2 starting from time 3</code>.</p>\n\n<p>So if I have J jobs, M shops and I put my C_max to the value C, I will have for sure : <code>J * M * C</code> booleans variables.</p>\n\n<p><strong><em>Problem</em>: for now my SAT problem are wrong. The solution given is not okay.</strong></p>\n\n<p>Here are the constraints that I have for now : ( V means 'OR', the other : 'And')</p>\n\n<ul>\n<li><img src=\"https://i.stack.imgur.com/Y2FNM.gif\" alt=\"C1\"></li>\n</ul>\n\n<p>Which means that the job i can be on only 1 shop for a time k</p>\n\n<ul>\n<li><img src=\"https://i.stack.imgur.com/AyIHQ.gif\" alt=\"C2\"></li>\n</ul>\n\n<p>Which means that a shop j can handle only 1 job for a time k.</p>\n\n<ul>\n<li><img src=\"https://i.stack.imgur.com/oOg0x.gif\" alt=\"C3\"></li>\n</ul>\n\n<p>Which means that if the job has a duration more than 1, it has to be contineous. So if one variable is true, the other after until the end of duration of the task have to be true also.</p>\n\n<p>I'm not really sure if I'm right about the formulation of the problem, or/and if I forgot a constraint.</p>\n\n<p>For now, I mind also Job Shop (Flow Shop is basically the same where the jobs have to be in the same order on every shops)</p>\n\n<p>Sorry for the very big question, but for this kind of problem, it's better to have all the details to know what is it about.</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>I will add the source code of the 3 contraints above, maybe something is wrong inside and I don't see what... </p>\n\n<p>Constraint n\u00b01 : </p>\n\n<pre><code>/** the job i can be on only 1 shop for a time k */\nunsigned int writeConstraintOne(Problem* problem, unsigned int timeMax, FILE* file, char forReal) {\n\nunsigned int final = 0;\nunsigned int max = getNbVariables(problem,timeMax);\n\nfor(unsigned int i = 0; i &lt; problem-&gt;nbShops; i++) {\n\n  for(unsigned int l = 0; l &lt; problem-&gt;nbShops; l++) {\n\n    for(unsigned int j = 0; j &lt; problem-&gt;nbJobs; j++) {\n\n     for(unsigned int t = 0; t &lt; timeMax; t++) {\n\n      if(i == l) continue;\n\n      /** We get the S_i_j_t */\n      unsigned int A = getIdOfVariable(problem,i,j,t,timeMax);\n\n      /** We get the S_l_j_t */\n      unsigned int B = getIdOfVariable(problem,l,j,t,timeMax);\n\n      final++;\n\n      /* This fonction will or count the number of clauses, \n       * or write them inside the file. */\n      if(forReal == 1) {\n\n          /* It represents -A =&gt; B */\n          fprintf(file,\"-%d -%d 0\\n\",A,B);\n      }\n       }\n      }\n    }\n   }\n   return final;\n }\n</code></pre>\n\n<p>Constraint n\u00b02 : </p>\n\n<pre><code>/** shop j can handle only 1 job for a time k. */\nunsigned int writeConstraintTwo(Problem* problem, unsigned int timeMax, FILE* file, char forReal) {\n\nunsigned int final = 0;\nunsigned int max = getNbVariables(problem,timeMax);\n\nfor(unsigned int i = 0; i &lt; problem-&gt;nbShops; i++) {\n\n  for(unsigned int l = 0; l &lt; problem-&gt;nbJobs; l++) {\n\n    for(unsigned int j = 0; j &lt; problem-&gt;nbJobs; j++) {\n\n     for(unsigned int t = 0; t &lt; timeMax; t++) {\n\n      if(j == l) continue;\n\n      /** We get the S_i_j_t */\n      unsigned int A = getIdOfVariable(problem,i,j,t,timeMax);\n\n      /** We get the S_i_l_t */\n      unsigned int B = getIdOfVariable(problem,i,l,t,timeMax);\n\n      final++;\n\n      /* This fonction will or count the number of clauses, \n       * or write them inside the file. */\n      if(forReal == 1) {\n\n          /* It represents -A =&gt; B */\n          fprintf(file,\"-%d -%d 0\\n\",A,B);\n      }\n       }\n      }\n    }\n   }\n   return final;\n }\n</code></pre>\n\n<p>Constraint n\u00b03 : </p>\n\n<pre><code>/** if the job has a duration more than 1, it has to be contineous. \n *  So if one variable is true, the other after until the end of duration \n *  of the task have to be true also. */\nunsigned int writeConstraintThree(Problem* problem, unsigned int timeMax, FILE* file, char forReal) {\n\nunsigned int final = 0;\nunsigned int max = getNbVariables(problem,timeMax);\n\nfor(unsigned int i = 0; i &lt; problem-&gt;nbShops; i++) {\n\n    for(unsigned int j = 0; j &lt; problem-&gt;nbJobs; j++) {\n\n     for(unsigned int t = 0; t &lt; timeMax; t++) {\n\n     for(unsigned int k = 0; k &lt; problem-&gt;resource[i][j].value-1; k++) {\n\n      if(k == t) continue;\n\n      /** We get the S_i_j_t */\n      unsigned int A = getIdOfVariable(problem,i,j,t,timeMax);\n\n      /** We get the S_i_j_k */\n      unsigned int B = getIdOfVariable(problem,i,j,k,timeMax);\n\n      final+= 2;\n\n      /* This fonction will or count the number of clauses, \n       * or write them inside the file. */\n      if(forReal == 1) {\n\n          fprintf(file,\"-%d %d 0\\n\",B,A);\n          fprintf(file,\"-%d %d 0\\n\",A,B);\n      }\n       }\n      }\n    }\n   }\n   return final;\n }\n</code></pre>\n"}, {"tags": ["c", "pointers", "struct"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1429105351, "post_id": 29651803, "comment_id": 47443524, "body": "Without initialization the pointer will not actually point anywhere. You need to initialize the pointer to make it point somewhere valid, either to another structure or by dynamically allocating memory for the strcture"}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429105376, "post_id": 29651803, "comment_id": 47443550, "body": "You have to make the pointer point at allocated memory. Pointers are things that point at other memory locations, they aren&#39;t a &quot;special sort of handle&quot; or anything like that."}, {"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 1, "creation_date": 1429105381, "post_id": 29651803, "comment_id": 47443554, "body": "Why the downvote? The question might be obvious to some but it&#39;s well-posed with a good example."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1429105418, "post_id": 29651803, "comment_id": 47443585, "body": "@Bathsheba doesn&#39;t show any research effort ; any introductory C book will cover this"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106407, "post_id": 29651803, "comment_id": 47444400, "body": "It remains perfectly unclear 1) why you <i>must</i> use a pointer (I&#39;m guessing artificial teacher requirement) and 2) why you would want to use dynamic memory allocation in this case. Lots of people told you to do so but none explained why it would make sense to do so."}], "answers": [{"comments": [{"owner": {"reputation": 2697, "user_id": 2726028, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/dbe4582dd5ef7bc75782501be040acba?s=128&d=identicon&r=PG", "display_name": "Olayinka", "link": "https://stackoverflow.com/users/2726028/olayinka"}, "edited": false, "score": 1, "creation_date": 1429105351, "post_id": 29651841, "comment_id": 47443525, "body": "but then you have to free at the and"}, {"owner": {"reputation": 2697, "user_id": 2726028, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/dbe4582dd5ef7bc75782501be040acba?s=128&d=identicon&r=PG", "display_name": "Olayinka", "link": "https://stackoverflow.com/users/2726028/olayinka"}, "edited": false, "score": 1, "creation_date": 1429105652, "post_id": 29651841, "comment_id": 47443744, "body": "Someone who has enough basic C sense to free dynamic pointers wouldn&#39;t ask the question above."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1429105659, "post_id": 29651841, "comment_id": 47443752, "body": "Any particularly reason <i>why</i> you would use dynamic allocation in this case?"}, {"owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 2, "creation_date": 1429105835, "post_id": 29651841, "comment_id": 47443901, "body": "@Lundin Just by the first look it looks like OP wants to try out dynamic memory allocation for the structure. Since i see a pointer declared but not initialized I went ahead and suggested allocating memory for the pointer so that the rest of the code stays instact"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106064, "post_id": 29651841, "comment_id": 47444097, "body": "@Gopi Fair enough, even though pointer != dynamic allocation."}], "tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 3, "last_activity_date": 1429105356, "last_edit_date": 1429105356, "creation_date": 1429105266, "answer_id": 29651841, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer/29651841#29651841", "title": "How to initialize a struct using pointer?", "body": "<pre><code>Student *pStudent;\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>Student *pStudent = malloc(sizeof(Student));\n</code></pre>\n\n<p>Allocate memory for the pointer before writing data once done using it </p>\n\n<pre><code>free(pStudent);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429105666, "post_id": 29651869, "comment_id": 47443759, "body": "Any particularly reason <i>why</i> you would use dynamic allocation in this case?"}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429105807, "post_id": 29651869, "comment_id": 47443882, "body": "@Lundin , &quot;<i>How to solve it if I must use a pointer?</i>&quot; is mentioned in OP&#39;s  post. OP has already mentioned that he/she knows how to do it without a pointer."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106087, "post_id": 29651869, "comment_id": 47444120, "body": "Pointer != dynamic allocation."}, {"owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106642, "post_id": 29651869, "comment_id": 47444577, "body": "@Lundin , Fair enough. I&#39;ll take care to post both the ways to achieve this next time onwards."}], "tags": [], "owner": {"reputation": 19358, "user_id": 3049655, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/ZLzeP.jpg?s=128&g=1", "display_name": "Spikatrix", "link": "https://stackoverflow.com/users/3049655/spikatrix"}, "is_accepted": false, "score": 2, "last_activity_date": 1429105320, "creation_date": 1429105320, "answer_id": 29651869, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer/29651869#29651869", "title": "How to initialize a struct using pointer?", "body": "<pre><code>Student *pStudent;\n</code></pre>\n\n<p>creates a pointer of type <code>Student*</code>. This pointer is not initialized and points to some \"random\" location. Allocate memory for it using <code>malloc</code>(or <code>calloc</code>) from <code>stdlib.h</code>:</p>\n\n<pre><code>pStudent = malloc(sizeof(Student));\n</code></pre>\n\n<p>and then free it after its use using:</p>\n\n<pre><code>free(pStudent);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429105680, "post_id": 29651871, "comment_id": 47443776, "body": "Any particularly reason <i>why</i> you would use dynamic allocation in this case?"}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429105744, "post_id": 29651871, "comment_id": 47443831, "body": "I wouldn&#39;t. But OP asked specifically about dynamic allocation."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106113, "post_id": 29651871, "comment_id": 47444141, "body": "Pointer != dynamic allocation."}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429106196, "post_id": 29651871, "comment_id": 47444213, "body": "@Lundin I&#39;m having trouble believing that you&#39;re arguing in good faith. Let&#39;s agree to disagree and leave it at that."}, {"owner": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429106263, "post_id": 29651871, "comment_id": 47444281, "body": "OP did not ask about dynamic allocation"}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "reply_to_user": {"reputation": 129565, "user_id": 1505939, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/131c67ef492a8d8352c6cf642a52e20f?s=128&d=identicon&r=PG", "display_name": "M.M", "link": "https://stackoverflow.com/users/1505939/m-m"}, "edited": false, "score": 0, "creation_date": 1429106535, "post_id": 29651871, "comment_id": 47444511, "body": "@MattMcNabb I believe I get your point. Howether It seems reasonable to assume that if OP is practicing C and trying to initialize a struct through an unitialized pointer, he might actually be trying to practice dynamic allocation. At least, I think it makes more sense that practicing pointer usage by making them point to local automatic variables."}], "tags": [], "owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "is_accepted": false, "score": 1, "last_activity_date": 1429105325, "creation_date": 1429105325, "answer_id": 29651871, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer/29651871#29651871", "title": "How to initialize a struct using pointer?", "body": "<p>You need to allocate memory for your structure first.</p>\n\n<p>You can allocate memory with:</p>\n\n<pre><code>Student *pStudent = malloc(sizeof(Student));\n</code></pre>\n\n<p>And then you must release it at the end with</p>\n\n<pre><code>free(pStudent);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429105552, "post_id": 29651921, "comment_id": 47443679, "body": "<i>If the &quot;pStudent&quot; is not a pointer I can get it right. But if it is a pointer, I will always get a &quot;bad access&quot;</i> &lt;-- I think OP was asking specifically about dynamic allocations"}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429105558, "post_id": 29651921, "comment_id": 47443683, "body": "Ironically, while I wrote this, exactly 3 people posted answers recommending malloc, with no rationale whatsoever why..."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429105596, "post_id": 29651921, "comment_id": 47443712, "body": "@tux3 There is nothing in their post hinting about that, nor does it make any sense to use it in this case."}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429105678, "post_id": 29651921, "comment_id": 47443775, "body": "@Lunding the very last sentence of the question is &quot;How to solve it if I must use a pointer?&quot;. Otherwise I&#39;d completely agree."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "reply_to_user": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429105942, "post_id": 29651921, "comment_id": 47444001, "body": "@tux3 You aren&#39;t forced to use pointers. C allows you to allocate variables as you please. Now if the OP has some homework assignment with completely artificial requirements, that&#39;s too bad for them. I&#39;d rather post answers that applies to C programming in the real world. If you <i>must</i> use a pointer, then simply take my first example, then add <code>Student* pStudent = &amp;student;</code>. Success!"}, {"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 0, "creation_date": 1429106077, "post_id": 29651921, "comment_id": 47444110, "body": "I think everyone here knows about automatic variables, that&#39;s not the issue. OP is trying to learn C and asked a question about dynamic allocations."}], "tags": [], "owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "is_accepted": false, "score": 2, "last_activity_date": 1429106258, "last_edit_date": 1429106258, "creation_date": 1429105454, "answer_id": 29651921, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer/29651921#29651921", "title": "How to initialize a struct using pointer?", "body": "<p>You don't allocate any memory, you just allocate a pointer. You'll need to study pointers and how they work.</p>\n\n<p>Fix the code like this:</p>\n\n<pre><code>Student student;\nstrcpy(student.name,\"Kven\");\nstudent.score[0]=1;\nstudent.score[1]=2;\nstudent.score[2]=3;\nstudent.no=1;\n</code></pre>\n\n<p>Alternatively you could allocate memory dynamically. <em>But it doesn't make any sense in this case</em> (and yet I bet at least 3 people will post answers telling you to do that...). Plus you really need to study pointers before doing dynamic allocation.</p>\n\n<pre><code>Student *pStudent = calloc(1, sizeof(Student);\n\nif(pStudent == NULL)\n{\n  // error handling\n}\n\nstrcpy(pStudent-&gt;name,\"Kven\");\npStudent-&gt;score[0]=1;\npStudent-&gt;score[1]=2;\npStudent-&gt;score[2]=3;\npStudent-&gt;no=1;\n\n...\n\nfree(pStudent);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 6, "last_activity_date": 1429106029, "creation_date": 1429106029, "answer_id": 29652172, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer/29652172#29652172", "title": "How to initialize a struct using pointer?", "body": "<p>A variable of type pointer stores the address in memory of another variable (it points to another variable).</p>\n\n<p>Your variable <code>pStudent</code> is not initialized. It doesn't point to anything. In fact, it contains some garbage value that, most of the times, is the address of a memory area where the program is not allowed to write. This is why when you attempt to write there (the call to <code>strcpy()</code>) the operating system slaps your program over its \"hand\" and terminates it with the error message you mentioned.</p>\n\n<h3>How to correctly use pointers</h3>\n\n<p>One usage of pointers is to point to a certain variable that is statically allocated (defined in the program):</p>\n\n<pre><code>Student s, *pStudent = &amp;s;\n</code></pre>\n\n<p>This example declares the variable <code>s</code> of type <code>Student</code> and the variable <code>pStudent</code> that points to it. Notice it is initialized with <code>&amp;s</code> which is the address of <code>s</code>. Now, your code uses <code>pStudent</code> to initialize the fields of <code>s</code>.</p>\n\n<p>Another usage of pointers is to dynamically allocate memory during runtime:</p>\n\n<pre><code>Student *pStudent;\npStudent = malloc(sizeof(Student));\n</code></pre>\n\n<p>In this situation, <code>pStudent</code> is initialized with the address of a new variable of type <code>Student</code> that is created during runtime (it doesn't have a name) by calling <a href=\"http://en.cppreference.com/w/c/memory/malloc\"><code>malloc()</code></a>. <code>malloc()</code> allocates a block of memory (of the specified size) and return its address.</p>\n\n<p>When you don't need it, you have to free the memory allocated by <code>malloc()</code> (using <a href=\"http://en.cppreference.com/w/c/memory/free\"><code>free()</code></a>) for reuse:</p>\n\n<pre><code>free(pStudent);\n</code></pre>\n\n<p>After this call, the value of the variable <code>pStudent</code> doesn't change, it still points to the same address but it is invalid and using it produces undefined behaviour. You have to put the address of another <code>Student</code> structure in <code>pStudent</code> (using one of the two ways presented here) before using it again.</p>\n"}], "owner": {"reputation": 2447, "user_id": 3449534, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/43694e4190c359379f2f0e2028b217ee?s=128&d=identicon&r=PG&f=1", "display_name": "hidemyname", "link": "https://stackoverflow.com/users/3449534/hidemyname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3353, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1429106258, "creation_date": 1429105187, "question_id": 29651803, "link": "https://stackoverflow.com/questions/29651803/how-to-initialize-a-struct-using-pointer", "title": "How to initialize a struct using pointer?", "body": "<p>I am new to C, and I am facing this problem when practicing.<br>\nThe struct:</p>\n\n<pre><code> typedef struct {\n        char name[20];\n        int score[3];\n        int no;\n    } Student;\n</code></pre>\n\n<p>The initialize:<br></p>\n\n<pre><code>Student *pStudent;\nstrcpy(pStudent-&gt;name,\"Kven\");\npStudent-&gt;score[0]=1;\npStudent-&gt;score[1]=2;\npStudent-&gt;score[2]=3;\npStudent-&gt;no=1;\n</code></pre>\n\n<p>If the \"pStudent\" is not a pointer I can get it right. But if it is a pointer, I will always get a \"bad access\" error. How to solve it if I must use a pointer? Thank you.</p>\n"}, {"tags": ["c", "arrays", "loops"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1429104681, "post_id": 29651591, "comment_id": 47443002, "body": "For each number in array 1, check if it is also in array 2 and if yes then print &quot;x has been entered in both arrays&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 6034, "user_id": 4460500, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/7TTnO.jpg?s=128&g=1", "display_name": "VolAnd", "link": "https://stackoverflow.com/users/4460500/voland"}, "is_accepted": true, "score": 2, "last_activity_date": 1429105070, "last_edit_date": 1429105070, "creation_date": 1429104839, "answer_id": 29651689, "question_id": 29651591, "link": "https://stackoverflow.com/questions/29651591/print-numbers-that-are-in-both-arrays/29651689#29651689", "title": "print numbers that are in both arrays", "body": "<p>Change your final loop to:</p>\n\n<pre><code>for (i = 0; i&lt;SIZE; ++i)\n{\n    for(j = 0; j&lt;SIZE; ++j)\n    {\n        if(firstArray[i] == secondArray[j])\n            printf(\"%d has been entered in both array\\n\", firstArray[i]);\n\n    }\n}\n</code></pre>\n\n<p>Note: this code will repeat message (e.g. <code>4 has been entered in both array</code>) more than one time if 4 is present in at least one array more than 1 time.</p>\n"}, {"tags": [], "owner": {"reputation": 3785, "user_id": 4427938, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/M6mua.png?s=128&g=1", "display_name": "Ayushi Jha", "link": "https://stackoverflow.com/users/4427938/ayushi-jha"}, "is_accepted": false, "score": 1, "last_activity_date": 1429106302, "last_edit_date": 1429106302, "creation_date": 1429104925, "answer_id": 29651719, "question_id": 29651591, "link": "https://stackoverflow.com/questions/29651591/print-numbers-that-are-in-both-arrays/29651719#29651719", "title": "print numbers that are in both arrays", "body": "<pre><code>for (i = 0; i&lt;SIZE; ++i){\n   for(j = 0; j&lt;SIZE; ++j){\n     if(firstArray[i] == secondArray[j]){\n          printf(\"%d has been entered in both array\\n\", firstArray[i]);\n     }\n   }\n}\n</code></pre>\n\n<p>Here, in second loop you require, you need to change<code>j=i+1</code> to <code>j=0</code>, since you need to check for all values in both the arrays. Also, modify the <code>printf</code> statement to match your expected output.</p>\n\n<p>Ideone link: <a href=\"http://ideone.com/YthNkx\" rel=\"nofollow\">http://ideone.com/YthNkx</a></p>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 1546999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d79ad7269df017b5782678cfc5178f?s=128&d=identicon&r=PG", "display_name": "aitorkun", "link": "https://stackoverflow.com/users/1546999/aitorkun"}, "is_accepted": false, "score": 1, "last_activity_date": 1429104978, "creation_date": 1429104978, "answer_id": 29651730, "question_id": 29651591, "link": "https://stackoverflow.com/questions/29651591/print-numbers-that-are-in-both-arrays/29651730#29651730", "title": "print numbers that are in both arrays", "body": "<p>Try this for your last part:</p>\n\n<pre><code>for (i = 0; i&lt;SIZE; ++i){\n    for(j=0; j&lt;SIZE; ++j){\n        if(firstArray[i] == secondArray[j]){\n            printf(\"%d\", firstArray[i]);\n        }\n    }\n}\n</code></pre>\n\n<p>You have to compare every number in the first array with every number in the second array. Hope it helps!</p>\n"}], "owner": {"reputation": 5, "user_id": 4621395, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153197735401522/picture?type=large", "display_name": "Eldrin Manabat", "link": "https://stackoverflow.com/users/4621395/eldrin-manabat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 29651689, "answer_count": 3, "score": 0, "last_activity_date": 1429106302, "creation_date": 1429104522, "last_edit_date": 1429104837, "question_id": 29651591, "link": "https://stackoverflow.com/questions/29651591/print-numbers-that-are-in-both-arrays", "title": "print numbers that are in both arrays", "body": "<p>I am new to C programming. I am trying to figure out how to compare 2 arrays and print out which numbers are being repeated in both of them.\nThis is my code:</p>\n\n<pre><code>const int SIZE = 5;\nint firstArray[SIZE];\nint secondArray[SIZE];\nint i,j;\n\nfor(i=0; i&lt;SIZE; ++i) {\n    printf(\"enter a number: \");\n    scanf(\"%d\", &amp;firstArray[i]);\n}\n\nfor(i=0; i&lt;SIZE; ++i) {\n    printf(\"%d, \", firstArray[i]);\n}\nprintf(\"into array 1\\n\");\nfor(j=0; j&lt;SIZE; ++j) {\n    printf(\"enter a number: \");\n    scanf(\"%d\", &amp;secondArray[j]);\n}\n\nfor(j=0; j&lt;SIZE; ++j){\n    printf(\"%d, \", secondArray[j]);\n}\nprintf(\"into array 2\\n\");\n\nfor (i = 0; i&lt;SIZE; ++i){\n    for(j=i+1; j&lt;SIZE; ++j){\n        if(firstArray[i] == secondArray[j]){\n            printf(\"%d\", firstArray[i]);\n\n    }\n}\n</code></pre>\n\n<p>Example input:</p>\n\n<pre><code>array 1: 1, 2, 3, 4, 5\narray 2: 3, 4, 5, 6, 7\n</code></pre>\n\n<p>Expected output:</p>\n\n<pre><code>1, 2, 3, 4, 5 into array 1\n3, 4, 5, 6, 7 into array 2\n3 has been entered in both array\n4 has been entered in both array\n5 has been entered in both array\n</code></pre>\n\n<p>My code only lets me do the \"into array\" output. How do i achieve:</p>\n\n<pre><code>3 has been entered in both array\n4 has been entered in both array\n5 has been entered in both array\n</code></pre>\n"}, {"tags": ["c", "multithreading", "winapi"], "comments": [{"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 2, "creation_date": 1429104525, "post_id": 29651507, "comment_id": 47442864, "body": "When your main thread is about to terminate, set some flag to 1 and check that flag periodically in the worker thread, so the worker thread can terminate gracefully as soon as your flag is 1."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 1, "creation_date": 1429104673, "post_id": 29651507, "comment_id": 47442995, "body": "The worker thread needs to check a cancellation token at suitably frequent intervals"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4344762"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429107453, "post_id": 29651507, "comment_id": 47445148, "body": "@David Heffernan So if a worker thread expects a message to be sent to it, then it should not make operations that take a long time, or maybe break this lengthy operation into small steps that allows me to place the flag checking between them?"}], "answers": [{"comments": [{"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 0, "creation_date": 1429110388, "post_id": 29651851, "comment_id": 47447503, "body": "Synchronization is still needed to avoid race conditions. Polling for variable change isn&#39;t good design, as it will hog CPU. Or delayed polling will cause message to be processed late (that too with random timing)"}], "tags": [], "owner": {"reputation": 39, "user_id": 1546999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0d79ad7269df017b5782678cfc5178f?s=128&d=identicon&r=PG", "display_name": "aitorkun", "link": "https://stackoverflow.com/users/1546999/aitorkun"}, "is_accepted": false, "score": 0, "last_activity_date": 1429105286, "creation_date": 1429105286, "answer_id": 29651851, "question_id": 29651507, "link": "https://stackoverflow.com/questions/29651507/how-to-send-a-message-to-a-thread-that-is-doing-a-lengthy-operation/29651851#29651851", "title": "How to send a message to a thread that is doing a lengthy operation?", "body": "<p>An easy solution, but maybe not the best one is to use a global flag variable, initially with 0 value. </p>\n\n<p>When the main thread finishes set it to one. Your other thread should check for this variable in a loop.</p>\n\n<p>when the variable is 1 then the thread knows that the main thread has finished.</p>\n\n<p>Hope it helps!</p>\n"}, {"comments": [{"owner": {"reputation": 8876, "user_id": 1545171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TiAiM.jpg?s=128&g=1", "display_name": "DrKoch", "link": "https://stackoverflow.com/users/1545171/drkoch"}, "edited": false, "score": 0, "creation_date": 1429112848, "post_id": 29651951, "comment_id": 47449434, "body": "This is not a helpful answer."}, {"owner": {"reputation": 6090, "user_id": 4699340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4Ums.jpg?s=128&g=1", "display_name": "Andrew Komiagin", "link": "https://stackoverflow.com/users/4699340/andrew-komiagin"}, "edited": false, "score": 0, "creation_date": 1429116830, "post_id": 29651951, "comment_id": 47452048, "body": "Thanks for your feedback guys. I&#39;ve updated my answer to provide detailed explanation."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429178292, "post_id": 29651951, "comment_id": 47480378, "body": "Surely, you meant to write <code>volatile std::atomic&lt;bool&gt; g_bExit(false);</code>"}, {"owner": {"reputation": 6090, "user_id": 4699340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4Ums.jpg?s=128&g=1", "display_name": "Andrew Komiagin", "link": "https://stackoverflow.com/users/4699340/andrew-komiagin"}, "edited": false, "score": 0, "creation_date": 1429178388, "post_id": 29651951, "comment_id": 47480457, "body": "Yes, sure. Good catch"}], "tags": [], "owner": {"reputation": 6090, "user_id": 4699340, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U4Ums.jpg?s=128&g=1", "display_name": "Andrew Komiagin", "link": "https://stackoverflow.com/users/4699340/andrew-komiagin"}, "is_accepted": false, "score": 2, "last_activity_date": 1429178400, "last_edit_date": 1429178400, "creation_date": 1429105514, "answer_id": 29651951, "question_id": 29651507, "link": "https://stackoverflow.com/questions/29651507/how-to-send-a-message-to-a-thread-that-is-doing-a-lengthy-operation/29651951#29651951", "title": "How to send a message to a thread that is doing a lengthy operation?", "body": "<p>As a general principle, do not terminate threads.</p>\n\n<p>Your background worker thread can periodically check if the program wants to exit. You should use <code>std::atomic&lt;bool&gt;</code> to do that. Here is an example on how to use it.</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;thread&gt;\n#include &lt;atomic&gt;\n\nvolatile std::atomic&lt;bool&gt; g_bExit(false);\n\nvoid thread1()\n{\n   while( !g_bExit )\n   {\n      // do stuff here\n   }\n}\n\nint main()\n{\n      std::thread th1(thread1);\n\n      g_bExit = true;\n\n      th1.join() ; // wait for thread\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429107778, "post_id": 29652514, "comment_id": 47445421, "body": "What if the other thread doesn&#39;t want to run a message loop. It&#39;s quite rare for worker threads to do that."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429107870, "post_id": 29652514, "comment_id": 47445502, "body": "Messages posted with <code>PostThreadMessage</code> get lost, if the receiving thread happens to be in a modal message loop. No error messages, no exceptions, nothing. They silently get swallowed. See <a href=\"http://blogs.msdn.com/b/oldnewthing/archive/2009/09/30/9901065.aspx\" rel=\"nofollow noreferrer\">Why do messages posted by PostThreadMessage disappear?</a> for additional info."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 0, "creation_date": 1429108781, "post_id": 29652514, "comment_id": 47446244, "body": "I have never faced messages getting lost. And what modal-message-loop is? You meant a UI thread running? No, it will be a non-UI worker thread. BTW, yes there are better and newer approaches for &quot;producer-consumer&quot; pattern, and PTM is the most basic one to learn and use."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429113175, "post_id": 29652514, "comment_id": 47449698, "body": "Once you call a user32.dll function on a thread, that thread is turned into a fully fledged GUI thread, with message queues, input queues, etc. Your wish, that <i>&quot;this will be a non-UI worker thread&quot;</i> cannot be enforced statically or at runtime. It&#39;s a prayer, at best, and faith-based programming hasn&#39;t quite made it mainstream yet."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "edited": false, "score": 0, "creation_date": 1429114375, "post_id": 29652514, "comment_id": 47450605, "body": "There are pitfalls using PTM approach... but can you give reference to the fact that calling any user32.dll function makes it full-fledged UI thread. I strongly distrust this fact."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429136168, "post_id": 29652514, "comment_id": 47463336, "body": "@IInspectable I think you might be making too much of this. It&#39;s a worker thread. It simply is not going to show a modal dialog. Were it to do so, then missing thread messages is the very least of your worries."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429171208, "post_id": 29652514, "comment_id": 47475787, "body": "That&#39;s hardly important, Ajay. Once you call one of the message retrieval functions, your thread surely will have a message queue. In other words: It is a GUI thread. @David: This cannot be enforced. Of course you don&#39;t start out with a buggy implementation. Yet, when the feature request comes along to notify the user about finished calculations, someone will simply call <code>MessageBox</code>. Next you know, you have a bug report that occasionally the application deadlocks on shutdown."}, {"owner": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429171547, "post_id": 29652514, "comment_id": 47475971, "body": "@IInspectable I disagree. Your scenaro relies on the existence of a worse bug. You are cutting your hand off to spite your face. The real problem here is that using the message queue forces the thread to service the queue. Which it likely won&#39;t want to do, and will find to be very awkward. A cancellation token, e.g. an event or atomic bool is what&#39;s needed."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "reply_to_user": {"reputation": 570607, "user_id": 505088, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/3c0aac2191718ef0309dbc034d9b9961?s=128&d=identicon&r=PG", "display_name": "David Heffernan", "link": "https://stackoverflow.com/users/505088/david-heffernan"}, "edited": false, "score": 0, "creation_date": 1429174036, "post_id": 29652514, "comment_id": 47477463, "body": "@David: I was commenting on the proposed answer. While you raise valid points, why <code>PostThreadMessage</code> may be inappropriate, I outlined the conditions under which it flat out fails."}, {"owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "reply_to_user": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429198895, "post_id": 29652514, "comment_id": 47496506, "body": "@IInspectable, We had producer-consumer implementation on a banking/finance server, on top of PTM, and it never ever failed, no message got lost ever. We needed to implement our custom implementation (before C++11, new threading era) only after we found that after 10k posted (unprocessed) messages, message-queue wont take more. PTM is not a bad design. Calling user32.dll function doesn&#39;t create a message pump - only GetMessage call will do it."}, {"owner": {"reputation": 35031, "user_id": 1889329, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/57bec3f0b9c5879cdd9d9fa2e8629318?s=128&d=identicon&r=PG&f=1", "display_name": "IInspectable", "link": "https://stackoverflow.com/users/1889329/iinspectable"}, "edited": false, "score": 0, "creation_date": 1429200089, "post_id": 29652514, "comment_id": 47497416, "body": "@Ajay: Neither will create a message pump. Either one will create a message queue, if it doesn&#39;t exist already. The <i>&quot;it never failed&quot;</i> mantra is mostly moot. I pointed out the precise conditions under which messages posted to a thread are lost. You are arguing against logic. I&#39;m done."}], "tags": [], "owner": {"reputation": 16783, "user_id": 264325, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/q8UVK.jpg?s=128&g=1", "display_name": "Ajay", "link": "https://stackoverflow.com/users/264325/ajay"}, "is_accepted": false, "score": 0, "last_activity_date": 1429109004, "last_edit_date": 1429109004, "creation_date": 1429106886, "answer_id": 29652514, "question_id": 29651507, "link": "https://stackoverflow.com/questions/29651507/how-to-send-a-message-to-a-thread-that-is-doing-a-lengthy-operation/29652514#29652514", "title": "How to send a message to a thread that is doing a lengthy operation?", "body": "<p>Use <code>PostThreadMessage</code> function to post a message to another thread. Another thread must be having message pump (not necessarily a GUI-message-pump). Use <code>GetMessage</code> in target thread to retrieve the message. You need to craft a structure (better approach), and send the structure object. Your structure would contain actual message type (Start, Message, Stop etc - set of enum values for example).</p>\n\n<p>Or you may use new threading techniques of C++14 or use <code>unbounded_buffer</code> of VC++ concurrency runtime.  You need to explore and find appropriate solution for your problem. </p>\n\n<p>I didn't post any example, since this domain is quite large. You better search on the web for examples, references etc.</p>\n\n<p><strong>EDIT</strong>: I believe I have misunderstood the problem initially. Here is my solution: Use event synchronization object. In worker thread, wait for event through <code>WaitForSingeObject</code> (or <code>WaitForMultipleObjects</code>). From source thread call <code>SetEvent</code> on same synchronization object. Yes, there are new alternatives in C++ <code>std::thread</code> </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4344762"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1429178400, "creation_date": 1429104278, "last_edit_date": 1429106530, "question_id": 29651507, "link": "https://stackoverflow.com/questions/29651507/how-to-send-a-message-to-a-thread-that-is-doing-a-lengthy-operation", "title": "How to send a message to a thread that is doing a lengthy operation?", "body": "<p>I have a main thread, and a worker thread. When the main thread is about to terminate, I need to send a message to the worker thread so it can terminate itself cleanly (I have heard that <code>TerminateThread()</code> is a bad idea).</p>\n\n<p>The worker thread will be doing a lengthy operation (that will take more than 30 seconds), so is there a way to send it a message while doing this lengthy operation somehow. Or maybe the design of my program is wrong and a worker thread should not be doing such length operations?</p>\n"}, {"tags": ["c", "dev-c++"], "comments": [{"owner": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1429104596, "post_id": 29651497, "comment_id": 47442933, "body": "Are you targeting C, or C++ here? (The answer is language-dependent)."}, {"owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "reply_to_user": {"reputation": 219167, "user_id": 2380830, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/5qiYa.jpg?s=128&g=1", "display_name": "Bathsheba", "link": "https://stackoverflow.com/users/2380830/bathsheba"}, "edited": false, "score": 0, "creation_date": 1429104735, "post_id": 29651497, "comment_id": 47443041, "body": "@Bathsheba I use DevC++ and write both C and C++ programs in it and this happens regardless of the C/C++ program."}, {"owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "edited": false, "score": 0, "creation_date": 1429104901, "post_id": 29651497, "comment_id": 47443169, "body": "my question is totally different from the question that has been asked and  answered before.I am not asking the difference between void main() and int main() .I am asking what do just main() means to the compiler."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1429104919, "post_id": 29651497, "comment_id": 47443183, "body": "The C++ standard says <i>&quot;If control reaches the end of <code>main</code> without encountering a return statement, the effect is that of executing <code>return 0</code>;&quot;</i> so <i>&quot;when write <code>int main()</code>, the compiler asks me to return something&quot;</i> sounds odd if you&#39;re really using a C++ compiler."}, {"owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 1, "creation_date": 1429105019, "post_id": 29651497, "comment_id": 47443271, "body": "@Michael It does.This is what I am asking why compiler behaves differently for int main() and main()?"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "edited": false, "score": 0, "creation_date": 1429104628, "post_id": 29651555, "comment_id": 47442955, "body": "If int is implied then why it does not ask me to write a return statement?"}, {"owner": {"reputation": 56328, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "edited": false, "score": 0, "creation_date": 1429104794, "post_id": 29651555, "comment_id": 47443089, "body": "The omitted return type and variable type is assumed to be <code>int</code> since <a href=\"https://en.wikipedia.org/wiki/C_%28programming_language%29#K.26R_C\" rel=\"nofollow noreferrer\">K&amp;R</a>, back in the 70s."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429105079, "post_id": 29651555, "comment_id": 47443317, "body": "@fahreen in C, the return statement in <code>main</code> is never mandatory. If omitted, in C99, <code>return 0</code> is implied and in C89 an undefined termination status is returned. C++ is like C89 in that matter IIRC."}, {"owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "edited": false, "score": 0, "creation_date": 1429105366, "post_id": 29651555, "comment_id": 47443537, "body": "@ouah but when I write int main() then compiler asks me to write return statement.Compiler behaves differently for int main() and just main().Is this a problem with compiler?"}], "tags": [], "owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "is_accepted": false, "score": 3, "last_activity_date": 1429104421, "creation_date": 1429104421, "answer_id": 29651555, "question_id": 29651497, "link": "https://stackoverflow.com/questions/29651497/main-vs-int-main-in-devc/29651555#29651555", "title": "main() vs int main() in DevC++", "body": "<p>In C, it's a C89 feature made obsolete in C99 and later: if the return type is omitted, <code>int</code> is implied. In C++, it is a compiler extension not supported by the language but supported by some compilers.</p>\n"}], "owner": {"reputation": 91, "user_id": 4666535, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e27b6314d0026dad4ebe1dd6d43d955?s=128&d=identicon&r=PG&f=1", "display_name": "farheen", "link": "https://stackoverflow.com/users/4666535/farheen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1122, "favorite_count": 1, "closed_date": 1429104541, "answer_count": 1, "score": 0, "last_activity_date": 1429105797, "creation_date": 1429104257, "last_edit_date": 1429105797, "question_id": 29651497, "link": "https://stackoverflow.com/questions/29651497/main-vs-int-main-in-devc", "closed_reason": "Duplicate", "title": "main() vs int main() in DevC++", "body": "<p>I am using DevC++.</p>\n\n<ul>\n<li>when I write <code>void main()</code>, the compiler says main must return int.</li>\n<li>when I write <code>main()</code>, the compiler reports nothing.</li>\n<li>when  write <code>int main()</code>, the compiler asks me to return something.</li>\n</ul>\n\n<p>My question is what is main() without int and void?why does compiler behave differently for int main() and just main()?</p>\n"}, {"tags": ["c", "unix"], "comments": [{"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 4, "creation_date": 1429103929, "post_id": 29651298, "comment_id": 47442356, "body": "0) ex <code>#define NAME_SIZE 12];</code> --&gt; <code>#define NAME_SIZE 12</code> , remove <code>];</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1429104089, "post_id": 29651298, "comment_id": 47442502, "body": "1) <code>&quot;Usage: mywc -lwc [fileName]&quot;\\)n&quot;&quot;</code> --&gt; <code>&quot;Usage: mywc -lwc [fileName]\\n&quot;</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 1, "creation_date": 1429104194, "post_id": 29651298, "comment_id": 47442592, "body": "2) <code>main(argc, argv[]) char* argv[]; ({</code> --&gt; <code>int main(int argc, char *argv[]){</code>"}, {"owner": {"reputation": 4085, "user_id": 4185106, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/er5li.png?s=128&g=1", "display_name": "moffeltje", "link": "https://stackoverflow.com/users/4185106/moffeltje"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429104250, "post_id": 29651298, "comment_id": 47442632, "body": "@BLUEPIXY you&#39;re not posting an answer bc you think the question isn&#39;t ok?"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 3, "creation_date": 1429104323, "post_id": 29651298, "comment_id": 47442691, "body": "3) <code>processOptions(str);</code> , <code>str</code> ?? maybe <code>argv[1]</code>"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429104492, "post_id": 29651298, "comment_id": 47442830, "body": "4) <code>str[j] != NULL</code> --&gt; <code>str[j] != &#39;\\0&#39;</code>"}, {"owner": {"reputation": 1127, "user_id": 2682363, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2247a3b98b92e91df7bf1ba3e8edfd4?s=128&d=identicon&r=PG", "display_name": "Vivek Aditya", "link": "https://stackoverflow.com/users/2682363/vivek-aditya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429104517, "post_id": 29651298, "comment_id": 47442859, "body": "@BLUEPIXY probably ./mywc ----&gt;&quot; -c test.txt &quot;&lt;------- is str"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 1127, "user_id": 2682363, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2247a3b98b92e91df7bf1ba3e8edfd4?s=128&d=identicon&r=PG", "display_name": "Vivek Aditya", "link": "https://stackoverflow.com/users/2682363/vivek-aditya"}, "edited": false, "score": 0, "creation_date": 1429104854, "post_id": 29651298, "comment_id": 47443131, "body": "@ysaditya <code>processOptions</code> check option, not parse file name."}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429104910, "post_id": 29651298, "comment_id": 47443178, "body": "5) and has  more problem"}, {"owner": {"reputation": 1127, "user_id": 2682363, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2247a3b98b92e91df7bf1ba3e8edfd4?s=128&d=identicon&r=PG", "display_name": "Vivek Aditya", "link": "https://stackoverflow.com/users/2682363/vivek-aditya"}, "reply_to_user": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429104938, "post_id": 29651298, "comment_id": 47443194, "body": "@BLUEPIXY i showed the same thing  with arrows ( maybe not so clear )"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "reply_to_user": {"reputation": 1127, "user_id": 2682363, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f2247a3b98b92e91df7bf1ba3e8edfd4?s=128&d=identicon&r=PG", "display_name": "Vivek Aditya", "link": "https://stackoverflow.com/users/2682363/vivek-aditya"}, "edited": false, "score": 0, "creation_date": 1429105132, "post_id": 29651298, "comment_id": 47443350, "body": "@ysaditya <code>argv[2]</code> if  file name exists. see Usage."}], "answers": [{"tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 1, "last_activity_date": 1429104495, "last_edit_date": 1429104495, "creation_date": 1429104016, "answer_id": 29651406, "question_id": 29651298, "link": "https://stackoverflow.com/questions/29651298/few-errors-in-my-c-code/29651406#29651406", "title": "Few errors in my C code?", "body": "<p>These:</p>\n\n<pre><code>#define BUFFER_SIZE 4096];\n#define NAME_SIZE 12];\n#define MAX_LINES 100000];\n</code></pre>\n\n<p>will give parse errors when you use the symbols as if they were plain integers. Remove the trailing square bracket and semicolon from each.</p>\n\n<p>This:</p>\n\n<pre><code>fprintf(stderr, \"Usage: mywc -lwc [fileName]\"\\)n\"\");\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>fprintf(stderr, \"Usage: mywc -lwc [fileName]\\n\");\n</code></pre>\n\n<p>This:</p>\n\n<pre><code>main(argc, argv[])\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>main(int argc, char *argv[])\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 3443614, "user_type": "registered", "profile_image": "https://graph.facebook.com/1059026380/picture?type=large", "display_name": "jmartin450", "link": "https://stackoverflow.com/users/3443614/jmartin450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1429104495, "creation_date": 1429103701, "question_id": 29651298, "link": "https://stackoverflow.com/questions/29651298/few-errors-in-my-c-code", "title": "Few errors in my C code?", "body": "<p>I'm stuck on my C program and I have a few errors in it. I have very little experience with C, and I'm writing a program to simulate the wc command in Linux/Unix. I have tried a lot of things to try to get my code to work, but nothing has helped me so far. Here's my code with the errors in it:</p>\n\n<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n\n/* Enumerators */\nenum { FALSE, TRUE };\nenum { STDIN, STDOUT, STDERR };\n\n#define BUFFER_SIZE 4096];\n#define NAME_SIZE 12];\n#define MAX_LINES 100000];\n\n/* Globals */\nchar *fileName = NULL;\nchar tmpName [NAME_SIZE];\nint option = FALSE;\nint charOption = FALSE; // There is not a character option\nint wordOption = FALSE; // There is not a word option\nint lineOption = FALSE; // There is not a line option\nint standardInput = FALSE; \nint c = 0; // Character to be scanned\nint nl = 0; // Number of lines\nint nw = 0; // Number of words\nint nc = 0; // Number of characters\nint fileOffset = 0;\nint fd;\n\nparseCommandLine(int argc, char* argv[]) {\n    int i;\n\n    for (i = 1; i &lt; argc; i++) {\n        if (argv[i][0] == '-')\n           processOptions(argv[i]);\n        else if (fileName == NULL)\n           fileName = argv[i];\n        else\n           usageError();\n    }\n    standardInput = (fileName == NULL);\n}\n\nprocessOptions(char* str) {\n    int j;\n\n    for (j = 1; str[j] != NULL; j++) {\n    switch (str[j]) {\n        case 'c': /* Count number of characters in a file */\n          charOption = TRUE; /* Option has been supplied in command line */\n          while (getchar() != EOF) /* Scan characters until end of file */\n            nc++; /* Increment number of characters */\n          break;\n        case 'l': /* Count number of lines in a file */\n          charOption = TRUE; /* Option has been supplied in command line */\n          while ((c == getchar()) != 'Z') /* Scan chars until end of file */\n            if (c == '\\n')\n              nl++;\n          break;\n        case 'w': /* Count number of words in a file */\n          charOption = TRUE; /* Option has been supplied in command line */\n          int state = 0;\n          while ((c == getchar() != 'Z')) {\n            ++nc;\n            if (c == '\\n') /* New line */\n              nl++; /* Increment number of lines */\n            if (c == ' ' || c == '\\n' || c == '\\t') /* Word separators */\n              state = 0;\n            else if (state == 0) {\n              state = 1;\n              ++nw; /* Increment number of words */\n            }\n          } /* End while */\n          break;\n        default: \n          usageError(); /* An error occurred */\n          break;\n        }\n    }\n}\n\n/* Too many arguments supplied */\nusageError() {\n    fprintf(stderr, \"Usage: mywc -lwc [fileName]\"\\)n\"\");\n    exit(1);\n;}\n\n/* Main program */\nmain(argc, argv[])\nchar* argv[];\n({\n    int i; \n\n    processOptions(str); /* Read options from command line */\n\n    int flag[3] = {lineOption,wordOption,charOption}; /* Count options */\n    int stats[3] = {nl,nw,nc}; /* Number of lines, words, and chars in file */\n\n    if (!option) /* No options have been supplied; print number of lines, words, and characters in a file */\n       printf(\"%d %d %d %s\\n\",nl,nw,nc,fileName);\n    else { /* Options have been supplied, read them */\n       for (i = 0; i &lt; 3; i++) {\n          if (flag[i]) /* If a specific argument is supplied */\n            printf(\"%d \",stats[i]); /* Print number of lines, words, and/or chars, depending on the argument(s) supplied */\n       }\n    printf(\"%s\\n\",fileName); /* Print file name */\n    }\n    return 0; /* Exit program */\n}\n</code></pre>\n\n<p>Then when I go to compile my program, I get these errors/warnings:</p>\n\n<pre><code>mywc.c:19:24: error: expected identifier or \u2018(\u2019 before \u2018]\u2019 token\n char tmpName [NAME_SIZE]\n                        ^\nmywc.c:29:24: error: expected identifier or \u2018(\u2019 before \u2018]\u2019 token\n int lineStart[MAX_LINES]\n                        ^\nmywc.c: In function \u2018processOptions\u2019:\nmywc.c:50:24: warning: comparison between pointer and integer\n     for (j = 1; str[j] != NULL; j++) {\n                        ^\nmywc.c: In function \u2018usageError\u2019:\nmywc.c:86:5: error: stray \u2018\\\u2019 in program\n     fprintf(stderr, \"Usage: mywc -lwc [fileName]\"\\)n\"\");\n     ^\nmywc.c:86:52: error: expected \u2018;\u2019 before \u2018n\u2019\n     fprintf(stderr, \"Usage: mywc -lwc [fileName]\"\\)n\"\");\n                                                    ^\nmywc.c:86:55: error: expected statement before \u2018)\u2019 token\n     fprintf(stderr, \"Usage: mywc -lwc [fileName]\"\\)n\"\");\n                                                       ^\nmywc.c: At top level:\nmywc.c:90:16: error: expected \u2018)\u2019 before \u2018[\u2019 token\n main(argc, argv[])\n                ^\nmywc.c:92:2: error: expected identifier or \u2018(\u2019 before \u2018{\u2019 token\n ({\n  ^\n</code></pre>\n\n<p>As I said above, I tried a lot of things that SEEMED correct, but these gave me errors as well. I would appreciate any help I could get with these errors, as well as a few hints to help me get my program to run correctly.</p>\n\n<p>PS Assuming I have a test.txt file that looks like this:</p>\n\n<pre><code>Hello World!\n</code></pre>\n\n<p>Here's a sample output of what my program should look like:</p>\n\n<pre><code>./mywc -c test.txt\n12 /* Assuming that test.txt contains 8 characters */\n\n./mywc -l test.txt\n1\n\n./mywc test.txt\n1 2 12 test.txt /* 1 is number of lines, 2 is number of words, 12 is number of chars */\n</code></pre>\n"}, {"tags": ["c", ".a"], "answers": [{"tags": [], "owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "is_accepted": true, "score": 0, "last_activity_date": 1429106649, "creation_date": 1429106649, "answer_id": 29652426, "question_id": 29650864, "link": "https://stackoverflow.com/questions/29650864/link-sdl-in-archive-file/29652426#29652426", "title": "Link SDL in archive file", "body": "<p>You cannot link libraries to libraries. (Static) libraries (I conclude from the tag you choose we are talking about static libs) are just object file containers.</p>\n\n<p>What you can do (although it's not really practical if these libs come from external sources and you expect updates) is to extract all the object files from both libraries and stuff them into a new one linking against that in future:</p>\n\n<pre><code>ar x lib1.a\nar x lib2.a\nar rv new_lib.a *.o\nranlib new_lib.a\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4791935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 29652426, "answer_count": 1, "score": 0, "last_activity_date": 1432841436, "creation_date": 1429102612, "last_edit_date": 1432841436, "question_id": 29650864, "link": "https://stackoverflow.com/questions/29650864/link-sdl-in-archive-file", "title": "Link SDL in archive file", "body": "<p>I've got a projects, for an embedded STM32.</p>\n\n<p>I've got some code \"strategy\" used to determinate where the robot should be going. The strategy uses a \"pathfinding\" library.</p>\n\n<p>The latter can use SDL for debugging (and it's cool :) ). It uses a USE_SDL flag to include (or not) the sdl source files and compile with(out) the SDL gcc flags.</p>\n\n<p>For now I create a .a archive file, containing the pathfinding library, to be linked later with the strategy object files. It works fine without SDL.</p>\n\n<p>I want the strategy project to be COMPLETELY independent from SDL, even in the makefile.\nSo i'd like to \"link\" the SDL libraries INSIDE the .a file, and then link it with the strategy files.</p>\n\n<p>How can I link the SDL with the pathfinding library, without having to know it in the strategy files/makefile ?</p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["c", "macros"], "comments": [{"owner": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1429102159, "post_id": 29650633, "comment_id": 47441088, "body": "What compiler you use? GCC has a solution."}, {"owner": {"reputation": 3493, "user_id": 1511337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KB2az.jpg?s=128&g=1", "display_name": "Chan Kim", "link": "https://stackoverflow.com/users/1511337/chan-kim"}, "reply_to_user": {"reputation": 108835, "user_id": 15541, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/515ca9736a9a8ce65e58af764ccddf46?s=128&d=identicon&r=PG", "display_name": "leppie", "link": "https://stackoverflow.com/users/15541/leppie"}, "edited": false, "score": 0, "creation_date": 1429102244, "post_id": 29650633, "comment_id": 47441156, "body": "@leppie please tell me. (maybe I could see the original definition of SMSC_TRACE above :))"}, {"owner": {"reputation": 10088, "user_id": 21028, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/996a5828870fa84ad3a597f7935a9a5e?s=128&d=identicon&r=PG", "display_name": "csl", "link": "https://stackoverflow.com/users/21028/csl"}, "edited": false, "score": 0, "creation_date": 1429102587, "post_id": 29650633, "comment_id": 47441384, "body": "See <a href=\"http://stackoverflow.com/questions/11761703/overloading-macro-on-number-of-arguments\" title=\"overloading macro on number of arguments\">stackoverflow.com/questions/11761703/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27385, "user_id": 1382251, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/17622c39e8ead537a0944c767551b2fe?s=128&d=identicon&r=PG", "display_name": "barak manos", "link": "https://stackoverflow.com/users/1382251/barak-manos"}, "is_accepted": false, "score": 5, "last_activity_date": 1429104265, "last_edit_date": 1429104265, "creation_date": 1429102765, "answer_id": 29650925, "question_id": 29650633, "link": "https://stackoverflow.com/questions/29650633/how-to-substitute-function-using-macro-in-c/29650925#29650925", "title": "how to substitute function using macro in C", "body": "<p>You can do it with a <a href=\"https://gcc.gnu.org/onlinedocs/cpp/Variadic-Macros.html\" rel=\"nofollow\">variadic macro</a>, which takes a variable number of arguments:</p>\n\n<pre><code>#define SMSC_TRACE(a,b,...) printf(__VA_ARGS__)\n</code></pre>\n\n<p>If you want this macro to execute multiple statements, then you need a <code>do/while(0)</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>#define SMSC_TRACE(a,b,...) \\\ndo                          \\\n{                           \\\n    printf(\"%c\\n\",a);       \\\n    printf(\"%d\\n\",b);       \\\n    printf(__VA_ARGS__);    \\\n}                           \\\nwhile (0)\n</code></pre>\n"}], "owner": {"reputation": 3493, "user_id": 1511337, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/KB2az.jpg?s=128&g=1", "display_name": "Chan Kim", "link": "https://stackoverflow.com/users/1511337/chan-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429104265, "creation_date": 1429102038, "last_edit_date": 1429103580, "question_id": 29650633, "link": "https://stackoverflow.com/questions/29650633/how-to-substitute-function-using-macro-in-c", "title": "how to substitute function using macro in C", "body": "<p>Sometimes, in a C code I borrowed from a linux driver, I want to change some macros into a function that I can use in my environment.  But this previous macro can take 3 or 4 arguments.<br>\nFor example, if I want to substite  </p>\n\n<pre><code>SMSC_TRACE(pdata, probe, \"Driver Parameters:\");   // 3 arguments  \n</code></pre>\n\n<p>into  </p>\n\n<pre><code>printf(\"Driver Parameters:\");  \n</code></pre>\n\n<p>and substitute  </p>\n\n<pre><code>SMSC_TRACE(pdata, probe, \"LAN base: 0x%08lX\", (unsigned long)pdata-&gt;ioaddr); // 4 arguments  \n</code></pre>\n\n<p>into  </p>\n\n<pre><code>printf(\"LAN base: 0x%08lX\", (unsigned long)pdata-&gt;ioaddr);  \n</code></pre>\n\n<p>How do I do that? I tried</p>\n\n<pre><code>#define SMSC_TRACE((a), (b), (c)) printf((c))  \n#define SMSC_TRACE((a), (b), (c), (d)) printf((c), (d))  \n</code></pre>\n\n<p>but it doesn't seem to work. Only the last one seems to take effect.</p>\n\n<p>EDIT: this seems it maybe.</p>\n\n<pre><code>#define SMSC_TRACE(pdata, nlevel, fmt, args...) printf(fmt \"\\n\", ##args)\n</code></pre>\n"}, {"tags": ["c", "maze"], "comments": [{"owner": {"reputation": 3008, "user_id": 2209329, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e62709eac24c8a174c5f876e1cb63b39?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Szyd\u0142owski", "link": "https://stackoverflow.com/users/2209329/micha%c5%82-szyd%c5%82owski"}, "edited": false, "score": 3, "creation_date": 1429101784, "post_id": 29650500, "comment_id": 47440823, "body": "Any code you tried so far?"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1429101940, "post_id": 29650500, "comment_id": 47440925, "body": "There are two parts in your problem : first, adapt an algorithm to work with walls as cells instead of borders. Then implement it to represent each cell with a character. Anyway, your question as-is is not focused enough for SO, so please try implementing something and come back if you encounter a code-related problem."}, {"owner": {"reputation": 1362, "user_id": 4283840, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5271515568ac55bf2de7bd0ae0e423ac?s=128&d=identicon&r=PG", "display_name": "Christopher", "link": "https://stackoverflow.com/users/4283840/christopher"}, "edited": false, "score": 0, "creation_date": 1429101998, "post_id": 29650500, "comment_id": 47440977, "body": "Of course, I understand, I should always come with something to show, but I mostly wanted some advice and ideas. I&#39;ll come back later with some work. Thank you."}, {"owner": {"reputation": 40219, "user_id": 898348, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/13b3f2c44ba8449bd60764d07f4538dc?s=128&d=identicon&r=PG", "display_name": "Jabberwocky", "link": "https://stackoverflow.com/users/898348/jabberwocky"}, "edited": false, "score": 0, "creation_date": 1429102007, "post_id": 29650500, "comment_id": 47440982, "body": "<a href=\"http://www.mazeworks.com/mazegen/mazetut/\" rel=\"nofollow noreferrer\">First hit on google</a>"}, {"owner": {"reputation": 1362, "user_id": 4283840, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5271515568ac55bf2de7bd0ae0e423ac?s=128&d=identicon&r=PG", "display_name": "Christopher", "link": "https://stackoverflow.com/users/4283840/christopher"}, "edited": false, "score": 0, "creation_date": 1429102157, "post_id": 29650500, "comment_id": 47441086, "body": "I&#39;ve read this many times, but my problem comes from the way I have to display the maze (a file where walls are considered as one character)"}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1429102271, "post_id": 29650500, "comment_id": 47441174, "body": "@Aruixe You should first get up to the point where you have a 2D array in memory containing your walls and spaces. <i>Then</i> focus on translating this array into characters. Where are you at ?"}], "answers": [{"tags": [], "owner": {"reputation": 1045, "user_id": 2305161, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a4956f14412244c2942ff6746b81fc04?s=128&d=identicon&r=PG", "display_name": "Andy Newman", "link": "https://stackoverflow.com/users/2305161/andy-newman"}, "is_accepted": true, "score": 0, "last_activity_date": 1429101867, "creation_date": 1429101867, "answer_id": 29650587, "question_id": 29650500, "link": "https://stackoverflow.com/questions/29650500/generating-a-perfect-maze-in-c/29650587#29650587", "title": "Generating a perfect maze in C", "body": "<p>I think the algorithms you linked will work if you expand each cell into 4 cells, and use the top, left and top left as the walls if they exist.</p>\n\n<p>Walls below the cell will be handle as a wall above the cell below, if that makes sense?</p>\n"}], "owner": {"reputation": 1362, "user_id": 4283840, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5271515568ac55bf2de7bd0ae0e423ac?s=128&d=identicon&r=PG", "display_name": "Christopher", "link": "https://stackoverflow.com/users/4283840/christopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1598, "favorite_count": 0, "accepted_answer_id": 29650587, "answer_count": 1, "score": -5, "last_activity_date": 1429101867, "creation_date": 1429101647, "question_id": 29650500, "link": "https://stackoverflow.com/questions/29650500/generating-a-perfect-maze-in-c", "title": "Generating a perfect maze in C", "body": "<p>I want to be able to generate a perfect maze in a file (in C). The maze itself will be represented like such:</p>\n\n<pre><code>**XX**X*\nX**X****\nXX*X*XX*\nXX***XX*\n</code></pre>\n\n<p>Meaning that the X are walls and the '*' are empty spaces (where you can move).</p>\n\n<p>What I have done for now is: generate a block of 'X' and its size if chosen by the user at launch.</p>\n\n<p>Example : </p>\n\n<pre><code>./maze 10 5\n</code></pre>\n\n<p>Would generate :</p>\n\n<pre><code>XXXXXXXXXX\nXXXXXXXXXX\nXXXXXXXXXX\nXXXXXXXXXX\nXXXXXXXXXX\n</code></pre>\n\n<p>And all I have to do now is implement my algorithm.</p>\n\n<p>But sadly, from the many algorithms I have found to generate a perfect maze, most of them are drawn with walls being as you would imagine them, and not a character in a file, so I don't know how to implement it in this case.</p>\n\n<p>My main source being :</p>\n\n<p><a href=\"http://www.quora.com/What-are-the-algorithms-to-generate-a-random-maze\" rel=\"nofollow\">http://www.quora.com/What-are-the-algorithms-to-generate-a-random-maze</a></p>\n\n<p>Can you guys tell me how I could implement such thing with my particular case?</p>\n\n<p>Thanks in advance !</p>\n"}, {"tags": ["c", "tcp", "server"], "comments": [{"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429103525, "post_id": 29650347, "comment_id": 47442048, "body": "It is the entire socket opening and creation and staying open that the problem.  You do not show other code.  Something is closing the socket descriptor, or clobbering memory."}, {"owner": {"reputation": 625, "user_id": 2204260, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/705e2d56a625d26d8c43e5ee4fbcef03?s=128&d=identicon&r=PG", "display_name": "keont", "link": "https://stackoverflow.com/users/2204260/keont"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429106646, "post_id": 29650347, "comment_id": 47444579, "body": "I have limited experience, but can that affect two different runs? Shouldn&#39;t memory be allocated and variables not shared and so on? As for code, Idk it&#39;s pretty long, I try to not just dump everything for people to find in my spagueti code :S"}, {"owner": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 1, "creation_date": 1429109275, "post_id": 29650347, "comment_id": 47446610, "body": "I don&#39;t know.  Spaghetti code is a logical nightmare. Un-spaghetti-fy your code.   I would strip out everything, except beej&#39;s code.  Make certain that base code works multiple multiple times.  Then add one separate function.  Test lots. Good rule of thumb: one function does just one thing, correctly. And that one function is the only place your code can go to execute that one thing.  DRY: Don&#39;t Repeat Yourself.  Iterate through the project by adding just one function and testing.  By function I mean your declared functions.  Not something like printf - a library function."}, {"owner": {"reputation": 625, "user_id": 2204260, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/705e2d56a625d26d8c43e5ee4fbcef03?s=128&d=identicon&r=PG", "display_name": "keont", "link": "https://stackoverflow.com/users/2204260/keont"}, "reply_to_user": {"reputation": 14973, "user_id": 348312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5afc074aa3078afdbd1cd7485ac726e?s=128&d=identicon&r=PG&f=1", "display_name": "jim mcnamara", "link": "https://stackoverflow.com/users/348312/jim-mcnamara"}, "edited": false, "score": 0, "creation_date": 1429113465, "post_id": 29650347, "comment_id": 47449928, "body": "yeah. I started doing all that for this project. Then the code grew too much and it&#39;s the largest piece of C code I&#39;ve put together. And so right now I just try to make it work and printf everything and test for everything that comes to mind. The problem I face right now I do not know ho to meet deadlines and make functions. I create a few in the beggining then everything goes in the main. I do test in different files so there&#39;s that. Thanks though!"}], "owner": {"reputation": 625, "user_id": 2204260, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/705e2d56a625d26d8c43e5ee4fbcef03?s=128&d=identicon&r=PG", "display_name": "keont", "link": "https://stackoverflow.com/users/2204260/keont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1429101209, "creation_date": 1429101209, "last_edit_date": 1495539817, "question_id": 29650347, "link": "https://stackoverflow.com/questions/29650347/getpeername-invalid-argument-after-running-a-server-several-times", "title": "getpeername Invalid argument after running a server several times", "body": "<p>I've got this, taken from beej guide and slightly adapted:</p>\n\n<pre><code>socklen_t len;\n    struct sockaddr_storage addr;\n    char ipstr[INET6_ADDRSTRLEN];\n    char nombreSubscriptor[INET6_ADDRSTRLEN+sizeof(int)];\n    int port;\n\n    len = sizeof(addr);\n    if(getpeername(fdSocketDevuelto, (struct sockaddr*)&amp;addr, &amp;len)&lt;0){\n        perror(\"GETPEERNAME error\");\n        close(fdSocketDevuelto);\n        exit(1);\n    }\n if (addr.ss_family == AF_INET) {\n        struct sockaddr_in *s = (struct sockaddr_in *)&amp;addr;\n        port = ntohs(s-&gt;sin_port);\n        inet_ntop(AF_INET, &amp;s-&gt;sin_addr, ipstr, sizeof ipstr);\n    } else { // AF_INET6\n        struct sockaddr_in6 *s = (struct sockaddr_in6 *)&amp;addr;\n        port = ntohs(s-&gt;sin6_port);\n        inet_ntop(AF_INET6, &amp;s-&gt;sin6_addr, ipstr, sizeof ipstr);\n    }\n\n    printf(\"Peer IP address: %s\\n\", ipstr);\n    printf(\"Peer port      : %d\\n\", port);\n</code></pre>\n\n<p>So I run the client and server and send messages to the server, everything works fine, showing like this</p>\n\n<pre><code>Peer IP address: 127.0.0.1\nPeer port      : 42639\n</code></pre>\n\n<p>But if I close and open several times (sometimes it's in the first 1-2 times I try it, but this has happened less), at some point I'm getting this:</p>\n\n<pre><code> GETPEERNAME error: Invalid argument\n</code></pre>\n\n<p>And before I used the perror and exit(1) in the getpeername I was getting stuff similar to this (it changed slightly in the numbers):</p>\n\n<pre><code>Peer IP address: 2325:2ec7:c37f::\nPeer port      : 20423\n</code></pre>\n\n<p>I had already asked here <a href=\"https://stackoverflow.com/questions/29645118/recv-gives-bad-file-descriptor-only-sometimes-run-the-program-it-works-fine-so\">Recv gives Bad file descriptor only sometimes (run the program it works fine, sometimes it does not work)</a> but the question is flat out wrong since it's not the recv that has the failure, it's the getpeername function. And I decided to ask again with proper data this time, which I'm unsure if it's the right thing to do.</p>\n\n<p>The question is: why would this happen? Why sometimes it passes and Ip is fine and sometimes is not? It's two completly different runs of the code, I close and run again, and do not compile or do anything. When it gives me the failure, I wait some minutes (this also looks to be changing from time to time) and I can run again and it works just fine again.</p>\n"}, {"tags": ["c", "macos", "gcc", "compilation", "header"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1429100266, "post_id": 29649978, "comment_id": 47439731, "body": "<code>gcc -c encryption.h</code>----&gt; you don&#39;t compile header files."}, {"owner": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429100312, "post_id": 29649978, "comment_id": 47439761, "body": "Thank you @SouravGhosh. What would be the appropriate way of going about this?"}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1429100377, "post_id": 29649978, "comment_id": 47439813, "body": "Just don&#39;t compile the header file, and don&#39;t link with the precompiled header file, only the object files generated from the source files."}, {"owner": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "edited": false, "score": 0, "creation_date": 1429102303, "post_id": 29649978, "comment_id": 47441193, "body": "I don&#39;t know, evidently whatever happens to a compiled .h file with gcc...."}, {"owner": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429102405, "post_id": 29649978, "comment_id": 47441249, "body": "From what I looked up online they&#39;re precompiled header files used to optimize performance in some aspect. @JoachimPileborg"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "edited": false, "score": 0, "creation_date": 1429100427, "post_id": 29650038, "comment_id": 47439837, "body": "What&#39;s the point of the header file then? I am really familiar with Java, and I see the header file like an interface. Is there no point in having it if it&#39;s not going to be used then? I mean unless there are constants in the header file, then that&#39;s a different story, but my professor wants the skeleton code for my functions in that file. . ."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "edited": false, "score": 1, "creation_date": 1429100605, "post_id": 29650038, "comment_id": 47439965, "body": "@MiguelJ. Updated the answer. Hope that helps. :-)"}, {"owner": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 4, "creation_date": 1429100685, "post_id": 29650038, "comment_id": 47440025, "body": "The point of header files is, basically, so that every code file which <code>#include</code>s it knows how the functions declared there work. Also knows about <code>#defines</code> and types ..."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 97942, "user_id": 25324, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c812d568dcbf02b96796728be3cac626?s=128&d=identicon&r=PG", "display_name": "pmg", "link": "https://stackoverflow.com/users/25324/pmg"}, "edited": false, "score": 0, "creation_date": 1429100765, "post_id": 29650038, "comment_id": 47440080, "body": "@pmg Thank you for the addition sir. :-)"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 4, "last_activity_date": 1429100726, "last_edit_date": 1429100726, "creation_date": 1429100378, "answer_id": 29650038, "question_id": 29649978, "link": "https://stackoverflow.com/questions/29649978/in-c-how-do-i-compile-and-then-create-an-executable-file-with-a-header-and-two-c/29650038#29650038", "title": "In C how do I compile and then create an executable file with a header and two c files?", "body": "<p>Don't compile the header file. Header files are meant to be <em>included</em> to the source files (using <code>#include</code> directive, in <code>c</code>). Just compile the source files and link them together. Something like</p>\n\n<pre><code>gcc -c main.c\ngcc -c encryption.c\ngcc main.o encryption.o -o encrypt\n</code></pre>\n\n<p>or, for shorthand,</p>\n\n<pre><code>gcc main.c encryption.c -o encrypt\n</code></pre>\n\n<hr>\n\n<p><sup>Note: If you're bothered about the <em>presence</em> (or absence) of header files while compilation, check the pre-processed output of each source files using <code>gcc -E</code> option.</sup></p>\n"}], "owner": {"reputation": 327, "user_id": 4355763, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/c2d581652136dd916c5c4d424efb7f34?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel J.", "link": "https://stackoverflow.com/users/4355763/miguel-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 746, "favorite_count": 0, "accepted_answer_id": 29650038, "answer_count": 1, "score": 0, "last_activity_date": 1429101461, "creation_date": 1429100192, "last_edit_date": 1429101461, "question_id": 29649978, "link": "https://stackoverflow.com/questions/29649978/in-c-how-do-i-compile-and-then-create-an-executable-file-with-a-header-and-two-c", "title": "In C how do I compile and then create an executable file with a header and two c files?", "body": "<p>I have three C files in total. One is a header [<code>.h</code>] file, two are source [<code>.c</code>] files.</p>\n\n<p>The <code>.h</code> file is called <code>encryption.h</code> and the corresponding source file is <code>encryption.c</code>. The <code>encryption.c</code> has logic, but no <code>main()</code> function. My second c file is called <code>main.c</code>. There I have the <code>main()</code> function that calls methods from <code>encryption.c</code>.</p>\n\n<p>I am compiling these files within terminal on Mac OSx. I am confused on how to compile this, I have tried the following:</p>\n\n<pre><code>gcc -c main.c\ngcc -c encryption.c\ngcc -c encryption.h\ngcc main.o encryption.o encryption.g.gch -o encrypt\n</code></pre>\n\n<p>This doesn't seem to work though, it says I have a precompiled-header already. I tried finding the answer online, I know it has to be simple, but I haven't had much luck. What is the issue here?</p>\n"}, {"tags": ["c", "pointers", "fortran", "fortran77"], "comments": [{"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429100182, "post_id": 29649735, "comment_id": 47439671, "body": "it would probably help if you tell us what compilers you are using?"}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429100553, "post_id": 29649735, "comment_id": 47439932, "body": "I use ifort for the Fortran code and icc for the C code (version 13.1)"}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429102416, "post_id": 29649735, "comment_id": 47441256, "body": "what does &quot;does not give anything back&quot; mean? zero? value didn&#39;t change? Crash? As far as I can see, you do everything just right."}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429103585, "post_id": 29649735, "comment_id": 47442085, "body": "Int1 and int2 return 0 and char returns &lt;nul&gt; &lt;nul&gt;..."}, {"owner": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429106000, "post_id": 29649735, "comment_id": 47444043, "body": "Hmm. Could you show how you define the arrays on the C side and how you call sub1 and sub2?"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429110452, "post_id": 29649735, "comment_id": 47447548, "body": "The meaning of the symbol <code>int1</code> in the Fortran source of <i>both</i> subroutines is a function of the their Fortran source.  It has nothing to do with the declarations in your C header file.  Furthermore, if symbol <code>int1</code> represents one of <code>sub2()</code>&#39;s parameters in that suboutine&#39;s Fortran source, then its value is a function of how that subroutine is called, apparently by subroutine <code>sub1</code>.  You haven&#39;t given us any of the key information (Fortran code) we would need to answer the question."}, {"owner": {"reputation": 6498, "user_id": 1004168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c05e808436031bc45a7620adc236e3d?s=128&d=identicon&r=PG", "display_name": "agentp", "link": "https://stackoverflow.com/users/1004168/agentp"}, "edited": false, "score": 0, "creation_date": 1429132955, "post_id": 29649735, "comment_id": 47461826, "body": "if <code>sub2</code> is only called by <code>sub1</code> then it doesn&#39;t even need to appear in &quot;header.h&quot;"}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 6498, "user_id": 1004168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c05e808436031bc45a7620adc236e3d?s=128&d=identicon&r=PG", "display_name": "agentp", "link": "https://stackoverflow.com/users/1004168/agentp"}, "edited": false, "score": 0, "creation_date": 1429168602, "post_id": 29649735, "comment_id": 47474276, "body": "@agentp Indeed, but we do this to have a file storing all the functions. I find it very hepful not to have to open every function to know which argument they Need."}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 3107, "user_id": 3423234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49Nfn.gif?s=128&g=1", "display_name": "mfro", "link": "https://stackoverflow.com/users/3423234/mfro"}, "edited": false, "score": 0, "creation_date": 1429169598, "post_id": 29649735, "comment_id": 47474868, "body": "@mfro The array in C is created by calling a couple more Fortran function that will analyse and store data coming for a datafile"}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429169665, "post_id": 29649735, "comment_id": 47474907, "body": "@JohnBollinger The Fortran code is rather light, but it would look like this :  <code>if (char(4:5).eq.&#39;42&#39;) then</code> <code>int3 = 4</code> <code>elsif(char(4:4).eq.&#39;5&#39;) then</code>  <code>int3 = 7</code> <code>else</code> <code>int3 = 2</code> <code>endif</code>    (Regarless of the number of spaces I put behind, I somehow cannot insert a linebreak, sorry ....)"}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "edited": false, "score": 0, "creation_date": 1429170948, "post_id": 29649735, "comment_id": 47475636, "body": "I just stored the values of int1, int2 and char in others variables, and it seems to work. The code is a litte bit less clear but I&#39;ll take it for the time being. Thank you for your time !"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429189847, "post_id": 29649735, "comment_id": 47489068, "body": "@Extan, the additional code you presented in your comment has nothing to do with the problem you described, and certainly isn&#39;t what I asked about.  I&#39;m glad you have resolved your issue, though."}, {"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "reply_to_user": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429192651, "post_id": 29649735, "comment_id": 47491444, "body": "@JohnBollinger Well it has, this same code would give me in sub1() the correct values, whereas in sub2(), int3 will always be equal to 0 (Default value), meaning that char is not transmitted to sub2(), and gets &quot;stuck&quot; in sub1(). It is the same for int1 and int2"}, {"owner": {"reputation": 120941, "user_id": 2402272, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1182b1d5518a596d4e8cfe0567a65c4d?s=128&d=identicon&r=PG", "display_name": "John Bollinger", "link": "https://stackoverflow.com/users/2402272/john-bollinger"}, "edited": false, "score": 0, "creation_date": 1429192904, "post_id": 29649735, "comment_id": 47491663, "body": "@Extan, you&#39;re not getting it.  You haven&#39;t presented <i>anything</i> that gives me any reason to think that any variable in <code>sub2()</code> should have a value equal to that of a variable having the same name in <code>sub1()</code>, or that a variable in either scope should have a value related to a variable having the same name in your C source.  That doesn&#39;t mean there isn&#39;t such a correspondence in one case or the other, but you haven&#39;t given us a basis from which we could explain your observations."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "edited": false, "score": 0, "creation_date": 1449674387, "post_id": 29690973, "comment_id": 56111020, "body": "Hello Jeff ! sorry for the long delay. I cannot give you the whole code because there are to many files (around 700). It is an old code I work on, and it is just impossible for me to upgrade the langage itself. However I found the solution : the user was generating a selfmade piece of code that i was not aware of, and a lot of variables were in conflict. I found the solution just today, by pure &quot;luck&quot; ... (no worries, we found a way around, the issue itself has been solved a while ago)"}], "tags": [], "owner": {"reputation": 4652, "user_id": 2189128, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/P19VP.jpg?s=128&g=1", "display_name": "Jeff Hammond", "link": "https://stackoverflow.com/users/2189128/jeff-hammond"}, "is_accepted": false, "score": 1, "last_activity_date": 1429248082, "creation_date": 1429248082, "answer_id": 29690973, "question_id": 29649735, "link": "https://stackoverflow.com/questions/29649735/pass-a-c-pointer-inside-a-fortran77-subroutine/29690973#29690973", "title": "Pass a C pointer inside a Fortran77 subroutine", "body": "<p>Please post all of your code so that it can be tested.  I have no idea what type ITG is or what Fortran integer size you are compiling for.  It's effectively impossible to debug your issue without more code of the code.</p>\n\n<p>Passing character types between C and Fortran 77 is nontrivial.  Because Fortran does not use null-terminated strings, there is a hidden argument for the string length.  Your linker doesn't notice and it probably isn't the issue here, but it is worth noting.</p>\n\n<p>I strongly recommend you use Fortran 2003 and ISO_C_BINDING for C-Fortran interoperability.  It was designed for exactly this purpose and works incredibly well relative to the pile of non-portable voodoo required otherwise.</p>\n"}], "owner": {"reputation": 29, "user_id": 4791564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7172d3c6c17338d8f147c5617f680b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Extan", "link": "https://stackoverflow.com/users/4791564/extan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1429388650, "creation_date": 1429099482, "last_edit_date": 1429388650, "question_id": 29649735, "link": "https://stackoverflow.com/questions/29649735/pass-a-c-pointer-inside-a-fortran77-subroutine", "title": "Pass a C pointer inside a Fortran77 subroutine", "body": "<p>The software I am currently working on uses both languages, C and Fortran77. The .f subroutines does the mathematical part, while the C routines manages the general behavior of the software.</p>\n\n<p>My problem is the following. Let's say I have one C routine routine.c, and two Fortran subroutines sub1.f and sub2.f .</p>\n\n<p>routine.c calls sub1.f which than calls sub2.f :  </p>\n\n<pre><code> ... -&gt;  routine.c  -&gt;  sub1.f  -&gt;  sub2.f\n</code></pre>\n\n<p>My header file (Header.h) is define as follows</p>\n\n<pre><code>void routine(ITG *int1, ITG *int2, char *char)  \nvoid FORTRAN(sub1(ITG *int1, ITG *int2, char *char))  \nvoid FORTRAN(sub2(ITG *int1, ITG *int2, char *char))\n</code></pre>\n\n<p>(all the vairables are arrays)</p>\n\n<p>Now here is the thing : if I write in sub1.f</p>\n\n<pre><code>write(*,*) 'int1(1) =', int1(1)\n</code></pre>\n\n<p>I actually get the first value of the array (corresponding to int1(0) in C)\nBut the same command line in sub2.f does not give me anything back, and I don't understand why.</p>\n"}, {"tags": ["c", "linux", "networking", "udp", "broadcast"], "comments": [{"owner": {"reputation": 6760, "user_id": 1401962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4b8a7fe2bd33ed2532597f348d523fb?s=128&d=identicon&r=PG", "display_name": "tux3", "link": "https://stackoverflow.com/users/1401962/tux3"}, "edited": false, "score": 1, "creation_date": 1429099633, "post_id": 29649352, "comment_id": 47439347, "body": "I think you misunderstood how networks work. You can&#39;t send a message to yourself, have it wait there in the cable/air for X milliseconds, and then come back. Do you want some target box/router to echo the message back to you? Do you want some sort of delayed loopback interface?"}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429173070, "post_id": 29649352, "comment_id": 47476888, "body": "The broadcast/multicast packets are not actually sent.  They are always queued back in the interface&#39;s input queue, so you always get them <b>before</b> remote sites.  By the way, you cannot receive the packet at the EXACT same place, as they are in different places, and you have to account for transmission delay, bridging, routing, and several other things that can delay deliveries.  Why did you think 5ms is OK and not 0.5s?  Network bandwiths vary from bps to Gbps (even Tbps, now)."}, {"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 1, "creation_date": 1429173142, "post_id": 29649352, "comment_id": 47476925, "body": "Better explain what is your <b>real</b> problem, not what you have in your head to plan a solution."}, {"owner": {"reputation": 1937, "user_id": 977804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/825cdaf5bd57fc9e873c5d7c9e14e863?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/977804/daniel"}, "edited": false, "score": 0, "creation_date": 1429217305, "post_id": 29649352, "comment_id": 47508294, "body": "I want to start audio playback on multiple devices in perfect sync. My current solution makes sure all receivers have enough data buffered and I &quot;only&quot; need a start command to be received everywhere at the same time. More than 10ms results in an echo. NTP does not work for me because the clocks on the target devices are not precise enough (cheap hardware)."}], "answers": [{"comments": [{"owner": {"reputation": 7824, "user_id": 3899431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeEzu.jpg?s=128&g=1", "display_name": "Luis Colorado", "link": "https://stackoverflow.com/users/3899431/luis-colorado"}, "edited": false, "score": 0, "creation_date": 1429173428, "post_id": 29650423, "comment_id": 47477092, "body": "And in linux it&#39;s far more feasible to have clocks in synch using NTP and select the proper epoch to begin some process at the same time on several machines."}, {"owner": {"reputation": 1937, "user_id": 977804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/825cdaf5bd57fc9e873c5d7c9e14e863?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/977804/daniel"}, "edited": false, "score": 0, "creation_date": 1429217392, "post_id": 29650423, "comment_id": 47508358, "body": "NTP does not work in my case. The clocks on the target devices are not precise enough (old &amp; cheap hardware). I need to be in the &lt;10ms range..."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "reply_to_user": {"reputation": 1937, "user_id": 977804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/825cdaf5bd57fc9e873c5d7c9e14e863?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/977804/daniel"}, "edited": false, "score": 0, "creation_date": 1429246481, "post_id": 29650423, "comment_id": 47517782, "body": "@Daniel can you elaborate what you mean with &quot;not precise&quot;. Is the crystal frequenye wrong, is the frequency instable? 32768kHz crystals have usually a better precision than the high frequency crystals of PCs and microcontroller."}, {"owner": {"reputation": 1937, "user_id": 977804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/825cdaf5bd57fc9e873c5d7c9e14e863?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/977804/daniel"}, "edited": false, "score": 0, "creation_date": 1429597011, "post_id": 29650423, "comment_id": 47660222, "body": "@harper requesting the current time returns a very precise value, but it seems to be only updated every 10ms. Also, the clocks are relatively quickly going out of sync..."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "edited": false, "score": 0, "creation_date": 1430228216, "post_id": 29650423, "comment_id": 47963494, "body": "If you have a problem with a 10ms NTP update intervall, how often do you want to send the synchronization packets with UDP? Your crystal has to be sufficient to hold the phase for some milliseonds or ypu should consider using a different hardware."}, {"owner": {"reputation": 1804, "user_id": 616150, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79b2a278bb1777cd16d0d311e90fed59?s=128&d=identicon&r=PG", "display_name": "Viktor Dahl", "link": "https://stackoverflow.com/users/616150/viktor-dahl"}, "edited": false, "score": 0, "creation_date": 1430446826, "post_id": 29650423, "comment_id": 48081063, "body": "@harper I think he means that the resolution of his clocks is only 10ms."}, {"owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "reply_to_user": {"reputation": 1804, "user_id": 616150, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/79b2a278bb1777cd16d0d311e90fed59?s=128&d=identicon&r=PG", "display_name": "Viktor Dahl", "link": "https://stackoverflow.com/users/616150/viktor-dahl"}, "edited": false, "score": 0, "creation_date": 1430460656, "post_id": 29650423, "comment_id": 48084128, "body": "@ViktorDahl That doesn&#39;t match the requirement for a &lt;10ms accuracy."}], "tags": [], "owner": {"reputation": 12461, "user_id": 266487, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/585595b6a24df9b742ebc186788e9a8e?s=128&d=identicon&r=PG", "display_name": "harper", "link": "https://stackoverflow.com/users/266487/harper"}, "is_accepted": true, "score": 2, "last_activity_date": 1429246307, "last_edit_date": 1429246307, "creation_date": 1429101409, "answer_id": 29650423, "question_id": 29649352, "link": "https://stackoverflow.com/questions/29649352/force-udp-broadcast-via-the-network-disable-loopback/29650423#29650423", "title": "force UDP broadcast via the network (disable loopback)", "body": "<p>UDP are sent as IP-payload. The routing of IP packets is a domain of the IP stack. It decides how a packet is transferred to the destination. When you IP stack detects that the destination is the local host it will enqueue the packet in the receive queue and the packet will be available immediatly. If your adapters' send queues are filled that you will have a delay. So you can't make a synchronization with this concept.</p>\n\n<p>If you need a hard synchronization you should utilize NTP or SNTP tro synchronize the clocks and define a comment start time for your desired common operation.</p>\n\n<p><em>Edit</em>:\nThe (S)NTP protocol is designed to synchronize at millisecond Level. You will get a precision that you can't achieve with any Transmission of UDP packets due to the reason I described above.</p>\n"}], "owner": {"reputation": 1937, "user_id": 977804, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/825cdaf5bd57fc9e873c5d7c9e14e863?s=128&d=identicon&r=PG", "display_name": "Daniel", "link": "https://stackoverflow.com/users/977804/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 1, "accepted_answer_id": 29650423, "answer_count": 1, "score": 1, "last_activity_date": 1429246307, "creation_date": 1429098302, "question_id": 29649352, "link": "https://stackoverflow.com/questions/29649352/force-udp-broadcast-via-the-network-disable-loopback", "title": "force UDP broadcast via the network (disable loopback)", "body": "<p>I want to send a UDP broadcast datagram to multiple devices on the network, including the sender device itself. The goal is to have all devices receive the data at the EXACT same time (well, +/- 5ms is OK).</p>\n\n<p>The problem is that the network interface on the sending device is looping the data back, so it is received immediately (in contrast to the other devices where network latency comes into play - quite a bit for Wifi for instance)</p>\n\n<p>Any idea how I can disable my network interface to loop the data back directly? </p>\n\n<p>Another idea I had: Is it possible to create a virtual network interface to send the broadcast packet and listen on another interface which only receives it via the network?</p>\n\n<p>I am trying to do that in C on a Linux machine. Any help would be greatly appreciated!</p>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1429103266, "post_id": 29649234, "comment_id": 47441859, "body": "Compiling with warnings enabled would have caught this problem immediately:  <code>gcc -Wall -W -Werror</code> is your friend."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429106082, "post_id": 29649234, "comment_id": 47444114, "body": "Try to insert the code &quot; c=1;  &quot; before the code &quot; for(b=2;b&lt;=a/2;b++); &quot;!"}], "answers": [{"comments": [{"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429106220, "post_id": 29649365, "comment_id": 47444239, "body": "The problem is not the break! The break is what she wants, the problem is the uninitialized variable c!"}, {"owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "reply_to_user": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 1, "creation_date": 1429106424, "post_id": 29649365, "comment_id": 47444414, "body": "@SergioFormiggini I never said the problem was the break..."}, {"owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "edited": false, "score": 0, "creation_date": 1429106700, "post_id": 29649365, "comment_id": 47444611, "body": "Excuse me, I understood in a wrong way your reply!! :)"}], "tags": [], "owner": {"reputation": 245138, "user_id": 2069064, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/e4V2X.jpg?s=128&g=1", "display_name": "Barry", "link": "https://stackoverflow.com/users/2069064/barry"}, "is_accepted": false, "score": 4, "last_activity_date": 1429098358, "creation_date": 1429098358, "answer_id": 29649365, "question_id": 29649234, "link": "https://stackoverflow.com/questions/29649234/how-to-check-prime-number-using-user-defined-function/29649365#29649365", "title": "How to check prime number using user-defined function?", "body": "<p><strong>Hint</strong>: In your inner loop, you have your failure case:</p>\n\n<pre><code>if(a%b==0)\n{\n    c=0;\n    break;\n}\n</code></pre>\n\n<p>And then you check for a success case:</p>\n\n<pre><code>if(c==1)\n{\n    sum+=a;\n    n++;\n}\n</code></pre>\n\n<p>But when does <code>c</code> become <code>1</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": -1, "last_activity_date": 1430978258, "last_edit_date": 1430978258, "creation_date": 1429105599, "answer_id": 29651989, "question_id": 29649234, "link": "https://stackoverflow.com/questions/29649234/how-to-check-prime-number-using-user-defined-function/29651989#29651989", "title": "How to check prime number using user-defined function?", "body": "<p>I have written this code that is based on the fact that prime numbers are always represented by one of the functions p=k*6-1 or p=k*6+1, but not all the results of these two functions are prime. This code also has the capability to use a table of primes. (To use the table you have to compile this code with the option -DUSE_A_TABLE and you have to write the code to initialize it).</p>\n\n<p>I think you can use easily the function isPrime, The isPrime function will result faster if you activate the primes table.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;math.h&gt;\n\n#ifdef USE_A_TABLE\nuint64_t *primi=NULL;\nuint64_t inTable=0;\n#endif\n\nint isPrime(uint64_t n);\n\nint isPrime(uint64_t n)\n{\n    uint64_t m,k,i;\n\n    if (!n)\n        return 0;\n\n    if (n&lt;4 || n==5)\n        return 1;\n\n    if (!(n&amp;1))\n        return 0;\n\n    if (!(n%3))\n        return 0;\n\n    k=(n-1)/6;m=(n+1)/6;\n    if (k*6+1 != n &amp;&amp; m*6-1 != n)\n        return 0;\n\n    m=sqrt(n)+1;\n#ifdef USE_A_TABLE\n    k=5;\n    for (i=3;i&lt;inTable &amp;&amp; primi[i]&lt;=m;i++) {\n        k=primi[i];\n        if (!(n%k))\n            return 0;\n    }\n    k+=2;\n\n    k=(k-1)/6;\n#else\n    k=1;\n#endif\n\n    m=(m+1)/6;\n    for (i=k; i&lt;=m; i++) {\n        if ( !(n%(6*i-1)) || !(n%(6*i+1)) )\n            return 0;\n    }\n\n    return 1;\n}\n\nint main(void)\n{\n    uint64_t from=1;\n    uint64_t to=10000;\n    uint64_t n;\n\n    for(n=from;n&lt;=to;n++) {\n        if (isPrime(n))\n            printf(\"%5lu\",n);\n    }\n    puts(\"\");\n\n    from=400000000;\n    to=400002000;\n\n    for(n=from;n&lt;=to;n++) {\n        if (isPrime(n))\n            printf(\"%10lu\",n);\n    }\n    puts(\"\");\n\n    return 0;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1800, "user_id": 4769313, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/gFISt.png?s=128&g=1", "display_name": "Sir Jo Black", "link": "https://stackoverflow.com/users/4769313/sir-jo-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1429110505, "last_edit_date": 1429110505, "creation_date": 1429108589, "answer_id": 29653176, "question_id": 29649234, "link": "https://stackoverflow.com/questions/29649234/how-to-check-prime-number-using-user-defined-function/29653176#29653176", "title": "How to check prime number using user-defined function?", "body": "<p>I suggest the following code to have a little bit of speed. </p>\n\n<pre><code>if ( !(a&amp;1) &amp;&amp; a!=2) { // !(a&amp;1) is true if a is an even number!\n    c=0;\n} else {\n   c=1; //This is the initialization that lacks in your code!\n   for(b=3;b&lt;=a/2;b+=2) \n   {\n        if(a%b==0)\n        {\n          c=0;\n         break;\n        }\n   }\n}\n</code></pre>\n\n<p>This code doesn't consider 1 is a prime number as in your code! </p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 4683468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5bb73dbc0062d0c75ef24c430ebb12e?s=128&d=identicon&r=PG&f=1", "display_name": "kk ll", "link": "https://stackoverflow.com/users/4683468/kk-ll"}, "is_accepted": false, "score": 0, "last_activity_date": 1429116397, "creation_date": 1429116397, "answer_id": 29656094, "question_id": 29649234, "link": "https://stackoverflow.com/questions/29649234/how-to-check-prime-number-using-user-defined-function/29656094#29656094", "title": "How to check prime number using user-defined function?", "body": "<pre><code> //Here is a sample:\n\n\n main()\n {\nint a, b, c=1, n=0, start, end, sum=0;\n\nprintf(\"Range Start From: \");\n\nscanf(\"%d\", &amp;start);\nprintf(\"End of Range: \");\nscanf(\"%d\", &amp;end);\nfor(a=start;a&lt;=end;a++)\n {\n    for(b=2;b&lt;=a/2;b++)\n    {\n        if(a%b==0)\n    {\n     c=0;\n    break;\n    }\n   if(c==1) printf(\"%d  \", a);\n   c=1;\n  }\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4781614, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-JyQ9YJg6hb0/AAAAAAAAAAI/AAAAAAAAAB0/19kNvKYMP-0/photo.jpg?sz=128", "display_name": "Mahmuda Keya", "link": "https://stackoverflow.com/users/4781614/mahmuda-keya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "closed_date": 1429258398, "answer_count": 4, "score": -6, "last_activity_date": 1430978258, "creation_date": 1429097960, "last_edit_date": 1429257403, "question_id": 29649234, "link": "https://stackoverflow.com/questions/29649234/how-to-check-prime-number-using-user-defined-function", "closed_reason": "Needs details or clarity", "title": "How to check prime number using user-defined function?", "body": "<p>I know what a prime number is. But I am unable to solve the logic using C. I tried as below:</p>\n\n<pre><code>main()\n{\n    int a, b, c, n=0, start, end, sum=0;\n    printf(\"Range Start From: \");\n    scanf(\"%d\", &amp;start);\n    printf(\"End of Range: \");\n    scanf(\"%d\", &amp;end);\n\n    for(a=start;a&lt;=end;a++)\n    {\n        for(b=2;b&lt;=a/2;b++)\n        {\n            if(a%b==0)\n            {\n                c=0;\n                break;\n            }\n        }\n        if(c==1)\n        {\n            sum+=a;\n            n++;\n        }\n    }\n    printf(\"The Sum of Primes is: %d\\nTotal primes: %d\", sum, n);\n    getch();\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["c", "linux", "shared-libraries", "elf", "symbol-table"], "comments": [{"owner": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 1, "creation_date": 1429100209, "post_id": 29648919, "comment_id": 47439688, "body": "Why the hacks? Why not code that explicitly? For example global variable with the pointer to the function, and all libraries should call the function. Otherwise, check <i>weak symbols</i>, <code>LD_PRELOAD</code> and <code>elf plt&#47;got</code>."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "reply_to_user": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429104587, "post_id": 29648919, "comment_id": 47442922, "body": "There was a very solid reason to go for the hack. I&#39;m coding this module that has to redirect Unity&#39;s game&#39;s calls for the FMOD audio engine. So I have to intercept the very first call of FMOD_System_Create so that I can get the FMOD_SYSTEM handle. Why need that handle? So that I can attach my callback to get the audio."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "reply_to_user": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429104649, "post_id": 29648919, "comment_id": 47442976, "body": "By the way, couple of companies already have NDK (C)  solution to grab audio from unity games."}, {"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 0, "creation_date": 1429104651, "post_id": 29648919, "comment_id": 47442978, "body": "What about <code>LD_PRELOAD</code>?"}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429104695, "post_id": 29648919, "comment_id": 47443012, "body": "Sorry, could you elaborate a bit? I&#39;m not an ELF expert. Edit: I guess you are referring to the early loading of library? Well, that&#39;s not an issue here. I can verify through dlsym that the required function does exist and I did make call to it. But the problem is that, I want to intercept the Unity&#39;s call to that function."}, {"owner": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 1, "creation_date": 1429104793, "post_id": 29648919, "comment_id": 47443085, "body": "Check <a href=\"http://stackoverflow.com/questions/14690010/bash-trick-program-into-thinking-stdout-is-an-interactive-terminal/14694983#14694983\">this answer</a> which I gave a sometime ago. Is this what you basically want to do?"}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429105088, "post_id": 29648919, "comment_id": 47443326, "body": "My goal is to provide my own .so file that can be added into unity. When unity game&#39;s android project is generated, the game developer just runs it then my .so method is called to do the hook. The hook is working for import functions. The only problem is with export functions. FMOD audio engine&#39;s functions are export functions that are listed along with the import functions."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "reply_to_user": {"reputation": 132964, "user_id": 171318, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ePRKy.jpg?s=128&g=1", "display_name": "hek2mgl", "link": "https://stackoverflow.com/users/171318/hek2mgl"}, "edited": false, "score": 0, "creation_date": 1429105362, "post_id": 29648919, "comment_id": 47443531, "body": "@hek2mgl The answer you referred has the import function example. An export function is that which was not part of Unity but it included them from FMOD. +1 for your reference though. :)"}, {"owner": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429305064, "post_id": 29648919, "comment_id": 47554468, "body": "@Usman.3D, so have you tried the <code>LD_PRELOAD</code>? From inside your version of the <code>FMOD_System_Create</code> you need to call the original function. The original can be found using the <code>dlsym( RTLD_NEXT )</code>. Otherwise, I would advise you to create a minimalistic example and post new question. You question is too broad, since you lack the basic knowledge how the dynamic libraries work."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "reply_to_user": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429399863, "post_id": 29648919, "comment_id": 47582374, "body": "@Dummy00001, I know about dlsym and I know about Linked Libraries to some extent. dlsym gives me the address of function ONLY so that I can call the original function. I don&#39;t want that only. I want that function to be replaced by my hook_func (and save the orginal_func). So when the app invokes the original_func it actually comes to hook_func instead of original_func. From my hook_func I do stuff and then call the original_func that I had saved at the time of hooking. Why do I need that? Because when Unity invokes FMOD_System_Create then I want obtain the object FMOD System created."}, {"owner": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429444428, "post_id": 29648919, "comment_id": 47592479, "body": "@Usman.3D, Orignal question stands: have you tried the <code>LD_PRELOAD</code>? And the &quot;I don&#39;t want that only.&quot; - nobody said that it is the <i>only</i> thing you can do. Otherwise, the <code>LD_PRELOAD</code> would have been completely useless. You need to actually try it, experiment with it, and, if it doesn&#39;t work, come back asking why it doesn&#39;t work/how to make it work/alternatives."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "reply_to_user": {"reputation": 14928, "user_id": 360695, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d2c44123afa326f8088914089161248e?s=128&d=identicon&r=PG", "display_name": "Dummy00001", "link": "https://stackoverflow.com/users/360695/dummy00001"}, "edited": false, "score": 0, "creation_date": 1429500924, "post_id": 29648919, "comment_id": 47610923, "body": "@Dummy00001 My understanding about LD_PRELOAD is that my library will get loaded first. How will that help achieve my goal?  Also, please enlighten me how to find out the address of a symbol in dynamic symbol table in the loaded porgram. Is the dynamic symbol table of loaded app will be editable memory? Or is it possible to make it editable somehow?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "edited": false, "score": 1, "creation_date": 1429508184, "post_id": 29648919, "comment_id": 47613033, "body": "@Usman.3D: please edit your question, instead of commenting it, to improve it."}], "answers": [{"comments": [{"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429507504, "post_id": 29739594, "comment_id": 47612778, "body": "Now that was valuable response. +1 for that.   I know about mprotect, but I  didnt&#39; know dladdr existed. So far I had only found exported function&#39;s starting address by reading the st_value for the exported function (that&#39;s what dlsym also does, i.e. it gives address of the procedure). I will try dladdr along with mprotect."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429507988, "post_id": 29739594, "comment_id": 47612951, "body": "About hacking the dynamic linker: I think it will be too complicated and I&#39;m not sure even if I have any control over that at android(?) I&#39;m building my hooking module itself as a .so file that will be used by the game&#39;s app. I want to note here that I had successfully hooked for the OpenGL import functions only because their symbol entry has GOT entry address  and not procedure&#39;s address itself."}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429508240, "post_id": 29739594, "comment_id": 47613054, "body": "What is Unity? If it is a proprietary game, are you so &quot;addict&quot; to it to spend a week or two of your time for such hacks? I&#39;m surprised! BTW, check that what you want to do is legal in your juridiction!"}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429510604, "post_id": 29739594, "comment_id": 47614072, "body": "Unity3D is a game engine where you setup your game assets and scripts and it generates the game app or project for virtually any gaming platform. I&#39;m not addicted to do any illegal hack but I want to build a solution that can work for any Unity game WITH the consent of the game developer. Actually there are two such solutions in the market who are doing some hacks to capture screen+audio; namely: Everyplay and Kamcord. I just want to build a similar solution."}, {"owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "edited": false, "score": 0, "creation_date": 1429606950, "post_id": 29739594, "comment_id": 47665961, "body": "Update2 added to my question"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": false, "score": 7, "last_activity_date": 1429612081, "last_edit_date": 1429612081, "creation_date": 1429505883, "answer_id": 29739594, "question_id": 29648919, "link": "https://stackoverflow.com/questions/29648919/hook-and-replace-export-function-in-the-loaded-elf-so-shared-library/29739594#29739594", "title": "Hook and Replace Export Function in the Loaded ELF ( .so shared library )", "body": "<p>You should read in details Drepper's paper: <a href=\"http://www.akkadia.org/drepper/dsohowto.pdf\" rel=\"noreferrer\">how to write shared libraries</a> - notably to understand why using <code>LD_PRELOAD</code>is not enough. You may want to study the source code of the dynamic linker (<code>ld-linux.so</code>) inside your <code>libc</code>. You might try to change with <a href=\"http://man7.org/linux/man-pages/man2/mprotect.2.html\" rel=\"noreferrer\">mprotect(2)</a> and/or <a href=\"http://man7.org/linux/man-pages/man2/mmap.2.html\" rel=\"noreferrer\">mmap(2)</a> and/or <a href=\"http://man7.org/linux/man-pages/man2/mremap.2.html\" rel=\"noreferrer\">mremap(2)</a> the relevant pages. You can query the memory mapping thru <a href=\"http://man7.org/linux/man-pages/man5/proc.5.html\" rel=\"noreferrer\">proc(5)</a> using <code>/proc/self/maps</code> &amp; <code>/proc/self/smaps</code>. Then you could, in an <em>architecture-specific way</em>, replace the starting bytes (perhaps using <a href=\"https://github.com/kobalicek/asmjit\" rel=\"noreferrer\">asmjit</a> or GNU <a href=\"http://www.gnu.org/software/lightning/\" rel=\"noreferrer\">lightning</a>) of the code of <code>original_func</code> by a jump to your <code>hook_func</code> function (which you might need to change its epilogue, to put the overwritten instructions -originally at <code>original_func</code>- there...) </p>\n\n<p>Things might be slightly easier if <code>original_func</code> is well known and always the same. You could then study its source and assembler code, and write the patching function and your <code>hook_func</code> only for it.</p>\n\n<p>Perhaps using <a href=\"http://man7.org/linux/man-pages/man3/dladdr.3.html\" rel=\"noreferrer\">dladdr(3)</a> might be helpful too (but probably not).</p>\n\n<p>Alternatively, hack your dynamic linker to change it for your needs. You might study the source code of <a href=\"http://musl-libc.org/\" rel=\"noreferrer\">musl-libc</a></p>\n\n<p>Notice that you probably need to <em>overwrite the machine code</em> at the address of <code>original_func</code>  (as given by <code>dlsym</code> on <code>\"original_func\"</code>). Alternatively, you'll need to <a href=\"http://en.wikipedia.org/wiki/Relocation_%28computing%29\" rel=\"noreferrer\">relocate</a> every occurrence of calls to that function in all the already loaded shared objects (I believe it is harder; if you insist see <a href=\"http://man7.org/linux/man-pages/man3/dl_iterate_phdr.3.html\" rel=\"noreferrer\">dl_iterate_phdr(3)</a>).</p>\n\n<p>If you want a generic solution (for an arbitrary <code>original_func</code>) you'll need to implement some binary code analyzer (or disassembler) to patch that function. If you just want to hack a particular <code>original_func</code> you should disassemble it, and patch its machine code, and have your <code>hook_func</code> do the part of <code>original_func</code> that you have overwritten.</p>\n\n<p>Such horrible and time consuming hacks (you'll need weeks to make it work) make me prefer using <a href=\"http://en.wikipedia.org/wiki/Free_software\" rel=\"noreferrer\">free software</a> (since then, it is much simpler to patch the source of the shared library and recompile it).</p>\n\n<p>Of course, all this isn't easy. You need to understand in details what <a href=\"http://en.wikipedia.org/wiki/Executable_and_Linkable_Format\" rel=\"noreferrer\">ELF</a> shared objects are, see also <a href=\"http://man7.org/linux/man-pages/man5/elf.5.html\" rel=\"noreferrer\">elf(5)</a> and read <a href=\"http://www.iecc.com/linker/\" rel=\"noreferrer\">Levine's book: <em>Linkers and Loaders</em></a></p>\n\n<hr>\n\n<p>NB: Beware, if you are hacking against a proprietary library (e.g. <a href=\"http://unity3d.com/\" rel=\"noreferrer\">unity3d</a>), what you are trying to achieve might be illegal. Ask a lawyer. Technically, you are violating most abstractions provided by shared libraries. If possible, ask the author of the shared library to give help and perhaps implement some plugin machinery in it.</p>\n"}], "owner": {"reputation": 1753, "user_id": 707773, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/58533ebd4e8a8bc80bf4d60cca293a80?s=128&d=identicon&r=PG", "display_name": "Usman.3D", "link": "https://stackoverflow.com/users/707773/usman-3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3252, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1429612081, "creation_date": 1429097022, "last_edit_date": 1429606760, "question_id": 29648919, "link": "https://stackoverflow.com/questions/29648919/hook-and-replace-export-function-in-the-loaded-elf-so-shared-library", "title": "Hook and Replace Export Function in the Loaded ELF ( .so shared library )", "body": "<p>I'm writing some C code to hook some function of .so ELF (shared-library) loaded into memory.</p>\n\n<p>My C code should be able to re-direct an export function of another .so library that was loaded into the app/program's memory. </p>\n\n<p>Here's a bit of elaboration:</p>\n\n<p><img src=\"https://i.stack.imgur.com/egjkM.png\" alt=\"enter image description here\"></p>\n\n<p>Android app will have multiple .so files loaded. My C code has to look through export function that belongs to another shared .so library (called target.so in this case)</p>\n\n<p>This is not a regular dlsym approach because I don't just want address of a function but I want to replace it with my own fuction; in that: when another library makes the call to its own function then instead my hook_func gets called, and then from my hook_func I should call the original_func. </p>\n\n<p>For import functions this can work. But for export functions I'm not sure how to do it.\nImport functions have the entries in the symbol table that have corresponding entry in relocation table that eventually gives the address of entry in global offset table (GOT).\nBut for the export functions, the symbol's st_value element itself has address of the procedure and not GOT address (correct me if I'm wrong).</p>\n\n<p>How do I perform the hooking for the <strong>export</strong> function?</p>\n\n<p>Theoretically speaking, I should get the memory location of the <code>st_value</code> element of dynamic symbol table entry ( <code>Elf32_Sym</code> ) of export function. If I get that location then I should be able to replace the value in that location with my hook_func's address. However, I'm not able to write into this location so far. I have to assume the dynamic symbol table's memory is read-only. If that is true then what is the workaround in that case?</p>\n\n<p>Thanks a lot for reading and helping me out. </p>\n\n<p><strong>Update:</strong> LD_PRELOAD can only replace the original functions with my own, but then I'm not sure if there any way to call the originals. \nIn my case for example:</p>\n\n<p>App initializes the audio engine by calling <code>Audio_System_Create</code> and passes a reference of <code>AUDIO_SYSTEM</code> object to <code>Audio_System_Create(AUDIO_SYSTEM **);</code>\nAUDIO API allocates this struct/object and function returns.\nNow if only I could access that <code>AUDIO_SYSTEM</code> object, I would easily attach a callback to this object and start receiving audio data. \nHence, my ultimate goal is to get the reference to <code>AUIOD_SYSTEM</code> object; and in my understanding, I can only get that if I intercept the call where that object is first getting allocated through <code>Audio_System_Create(AUIOD_SYSTEM **)</code>.\nCurrently there is no straight way to grab the output audio at android. (all examples talk about recording audio that comes from microphone only)</p>\n\n<p><strong>Update2:</strong>\nAs advised by Basile in his answer, I made use of dladdr() but strangely enough it gives me the same address as I pass to it.</p>\n\n<pre><code>void *pFunc=procedure_addr;  //procedure address calculated from the st_value of symbol from symbol table in ELF file (not from loaded file)\n\n        int  nRet;\n\n            // Lookup the name of the function given the function pointer\n            if ((nRet = dladdr(pFunc, &amp;DlInfo)) != 0)\n            {\n                LOGE(\"Symbol Name is: %s\", DlInfo.dli_sname);\n                if(DlInfo.dli_saddr==NULL)\n                    LOGE(\"Symbol Address is: NULL\");\n                else\n                    LOGE(\"Symbol Address is: 0x%x\", DlInfo.dli_saddr);\n            }\n            else\n                LOGE(\"dladdr failed\");\n</code></pre>\n\n<p>Here's the result I get:</p>\n\n<p>entry_addr           =0x75a28cfc</p>\n\n<p>entry_addr_through_dlysm           =0x75a28cfc</p>\n\n<p>Symbol Name is: AUDIO_System_Create</p>\n\n<p>Symbol Address is: 0x75a28cfc</p>\n\n<p>Here address obtained through dlysm or calculated through ELF file is the address of procedure; while I need the location where this address itself is; so that I can replace this address with my <code>hook_func</code> address. <code>dladdr()</code> didn't do what I thought it will do.</p>\n"}, {"tags": ["c", "string", "function", "pointers", "return"], "comments": [{"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 1, "creation_date": 1429096693, "post_id": 29648766, "comment_id": 47437400, "body": "there is no valid element called <code>result[20]</code>. Hint: <code>0</code> based index."}, {"owner": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 1, "creation_date": 1429097854, "post_id": 29648766, "comment_id": 47438092, "body": "You might need to sanity-check the parameters and ensure that start+count doesn&#39;t go out of bounds of the source string. And the loop should be de-obfuscated into this: <code>for(i = 0; i&lt;count; i++) result[i] = source[i+start];</code>"}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "reply_to_user": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429100345, "post_id": 29648766, "comment_id": 47439789, "body": "@Sourav Ghosh I initialized the string with 20 places in memory and put a null in it, because someone told me here a while ago, that  i should always filling null terminators in them when i initialize them (regardless of size) since that&#39;s good programming practice."}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "reply_to_user": {"reputation": 153119, "user_id": 584518, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Lundin", "link": "https://stackoverflow.com/users/584518/lundin"}, "edited": false, "score": 0, "creation_date": 1429100557, "post_id": 29648766, "comment_id": 47439937, "body": "@Lundin yes you&#39;re right, that would make things easier."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "edited": false, "score": 0, "creation_date": 1429100576, "post_id": 29648766, "comment_id": 47439950, "body": "@RestlessC0bra Please see my answer. I&#39;m taking about the 21st element, which does not exist. :-)"}], "answers": [{"tags": [], "owner": {"reputation": 19499, "user_id": 3883560, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/ndXdL.jpg?s=128&g=1", "display_name": "Gopi", "link": "https://stackoverflow.com/users/3883560/gopi"}, "is_accepted": false, "score": 1, "last_activity_date": 1429097392, "last_edit_date": 1429097392, "creation_date": 1429096861, "answer_id": 29648861, "question_id": 29648766, "link": "https://stackoverflow.com/questions/29648766/simple-c-program-string-returning-from-function-causes-error/29648861#29648861", "title": "Simple C program. String returning from function causes Error", "body": "<pre><code>printf(\"From \\\"%s\\\" this part is being excluded-&gt; \\\"%s\\\"\\n\", text1, subString( text1, 4, 3, result ) );\n</code></pre>\n\n<p>Make a note that <code>subString()</code> returns a character not a <code>char*</code> and you are using <code>%s</code> to print a character which will lead to undefined behavior.</p>\n\n<p>Your array is being modified in the function <code>subString()</code> and in the first case you print the array result by returning <code>result[count + 1]</code> and also there is a undefined behavior with</p>\n\n<pre><code>result[20] = subString( text1, 4, 3, result );\n</code></pre>\n\n<blockquote>\n  <p>Array out of bound access</p>\n</blockquote>\n\n<p>You need to modify your code like</p>\n\n<pre><code>char *subString (const char source[], int start, int count, char result[]){ //result will be number of characters (count) + 1 (because of null)\nint i, j, end = start + count;\n\n// the part excluded must start from i = start and \"count\" number of characters must be derived and then put on result\nfor( i = start, j = 0; i &lt; end; ++i, ++j)\n    result[j] = source[i];\n\nresult[j] = '\\0';\n\nreturn result;\n}\n\nint main()\n{\n  // Keep your array here\n  char *p = subString( text1, 4, 3, result );\n  printf(\"%s\\n\",p);\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>void subString (const char source[], int start, int count, char result[]){ //result will be number of characters (count) + 1 (because of null)\n    int i, j, end = start + count;\n\n    // the part excluded must start from i = start and \"count\" number of characters must be derived and then put on result\n    for( i = start, j = 0; i &lt; end; ++i, ++j)\n        result[j] = source[i];\n\n    result[j] = '\\0';\n\n    }\n</code></pre>\n\n<p>In <code>main()</code></p>\n\n<pre><code>printf(\"%s\\n\",result);\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1429100870, "post_id": 29648871, "comment_id": 47440151, "body": "..ah i see (about point 2). Yes i know these. Yes i didn&#39;t mean to put it on 21st element. I thought that this was the right way to type the array and store inside the string i want. I&#39;m still looking into this. I haven&#39;t understood completely. And yes, point 1 very true, didn&#39;t realize that. But still i want to figure out how to return string from function (and not pointer). Still looking.."}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 1, "creation_date": 1429100950, "post_id": 29648871, "comment_id": 47440217, "body": "@RestlessC0bra yeah Please look carefully. Double check the data types, return values and format specifiers always. :-)"}, {"owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "reply_to_user": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 1, "creation_date": 1429100999, "post_id": 29648871, "comment_id": 47440254, "body": "@RestlessC0bra what do you mean by <code>eturn string from function (and not pointer).</code>? what is the <i>represenation</i> of a <i>string</i>? You locate and use a <i>string</i> by the <i>base address</i> which is a pointer itself. Then?"}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1429101187, "post_id": 29648871, "comment_id": 47440416, "body": "Yes, yes but i&#39;m talking about using string terminology (strictly a string) and not use pointers. I know that in essence a string is a pointer. Since this exercise was in the book before pointers were presented, it&#39;s asking me to do it without using pointers."}, {"owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "edited": false, "score": 0, "creation_date": 1429101470, "post_id": 29648871, "comment_id": 47440605, "body": "Yes, i did it. Works perfectly. I understand. Thank you all!"}], "tags": [], "owner": {"reputation": 127623, "user_id": 2173917, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/4dwoM.jpg?s=128&g=1", "display_name": "Sourav Ghosh", "link": "https://stackoverflow.com/users/2173917/sourav-ghosh"}, "is_accepted": true, "score": 2, "last_activity_date": 1429097207, "last_edit_date": 1429097207, "creation_date": 1429096886, "answer_id": 29648871, "question_id": 29648766, "link": "https://stackoverflow.com/questions/29648766/simple-c-program-string-returning-from-function-causes-error/29648871#29648871", "title": "Simple C program. String returning from function causes Error", "body": "<p><strong>Point 1 :</strong> </p>\n\n<p>In First case, you are using the <code>result</code> value which got modified through being passed as argument to <code>subString()</code>. You're <strong>not using the return value</strong> of <code>subString ()</code> fucntion.</p>\n\n<p>OTOH, in second approach, you're <strong>trying to use the rerturn value</strong> of the <code>subString ()</code> function, that too using wrong format specifier. You can learn more about the correct format specifiers in the <a href=\"http://linux.die.net/man/3/printf\" rel=\"nofollow\">man page of <code>printf()</code></a></p>\n\n<p><strong>Point 2</strong></p>\n\n<p>Array index in <code>C</code> starts from <code>0</code>. So, there is no valid element called <code>result[20]</code>. Thus,</p>\n\n<pre><code>result[20] = subString( text1, 4, 3, result );\n</code></pre>\n\n<p>cause off-by-one error which in turn invokes <a href=\"https://en.wikipedia.org/wiki/Undefined_behavior\" rel=\"nofollow\">undefined behaviour</a>.</p>\n"}], "owner": {"reputation": 3295, "user_id": 4743275, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/7f8p3.jpg?s=128&g=1", "display_name": "KeyC0de", "link": "https://stackoverflow.com/users/4743275/keyc0de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 570, "favorite_count": 0, "accepted_answer_id": 29648871, "answer_count": 2, "score": 2, "last_activity_date": 1429101340, "creation_date": 1429096577, "last_edit_date": 1429101340, "question_id": 29648766, "link": "https://stackoverflow.com/questions/29648766/simple-c-program-string-returning-from-function-causes-error", "title": "Simple C program. String returning from function causes Error", "body": "<p>The following is the exercise 10.4 of the book Programming in C, by Stephen Kochan. It says that I should create a function, that derives a part from an input string and returns that part back to <code>main()</code> (as a string, not a pointer) and displays it.\nMy code is below.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nchar subString (const char source[], int start, int count, char result[count + 1] ){ //result will be number of characters (count) + 1 (because of null)\nint i, j, end = start + count;\n\n// the part excluded must start from i = start and \"count\" number of characters must be derived and then put on result\nfor( i = start, j = 0; i &lt; end; ++i, ++j)\n    result[j] = source[i];\n\nresult[j] = '\\0';\n\nreturn result[count + 1];\n}\n\nint main (void){\nchar result[20] = {0};\n\nconst char text1[] = \"character\";\n\nresult[20] = subString( text1, 4, 3, result );\nprintf(\"From \\\"%s\\\" this part is being excluded-&gt; \\\"%s\\\"\\n\", text1, result);\n\nreturn 0;\n}\n</code></pre>\n\n<p>And the output is</p>\n\n<pre><code>From \"character\" this part is being excluded-&gt; \"act\"\n\nProcess returned 0 (0x0)   execution time : 0.332 s\nPress any key to continue.\n</code></pre>\n\n<p>Notice that the code above runs perfectly well - no warnings.</p>\n\n<p>What i can't understand is when i replace the two lines below</p>\n\n<pre><code>result[20] = subString( text1, 4, 3, result );\nprintf(\"From \\\"%s\\\" this part is being excluded-&gt; \\\"%s\\\"\\n\", text1, result);\n</code></pre>\n\n<p>with this line</p>\n\n<pre><code>printf(\"From \\\"%s\\\" this part is being excluded-&gt; \\\"%s\\\"\\n\", text1, subString( text1, 4, 3, result ) );\n</code></pre>\n\n<p>i get the output:</p>\n\n<pre><code>From \"character\" this part is being excluded-&gt; \"(null)\"\n\nProcess returned 0 (0x0)   execution time : 0.332 s\nPress any key to continue.\n</code></pre>\n\n<p>Why is that? How can i make it work using that one line instead? \nAlso, I'm a little confused with functions returning strings/arrays. They tend to lead me on errors, so if someone could provide me a couple of suggestions, that i should always keep in mind when working with them, that would help me very much. Thank you in advance.</p>\n"}, {"tags": ["c", "file", "fgets"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 3, "creation_date": 1429096709, "post_id": 29648728, "comment_id": 47437414, "body": "When you use <code>sizeof</code> on a pointer (like the one returned by <code>fgets</code>)  you get the size of <i>the pointer</i> and not what it points to. if you want to get the length of a string, use <code>strlen</code>."}, {"owner": {"reputation": 1, "user_id": 4623788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c5fbe37aa8582ae4073cf60d155978?s=128&d=identicon&r=PG&f=1", "display_name": "Tymoteusz Pinior", "link": "https://stackoverflow.com/users/4623788/tymoteusz-pinior"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429097302, "post_id": 29648728, "comment_id": 47437734, "body": "Yep. That&#39;s true. But when I will use strlen, I will still need to use static variable: &quot;line&quot;. I want to czyt has in contents &quot;One two three four five&quot; + memory location for 25 chars."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1429097408, "post_id": 29648728, "comment_id": 47437806, "body": "By the way, have you thought about what would happen if the <code>fgets</code> call fails? Allocating zero bytes may still work, and you simply have no idea that the input operation failed."}, {"owner": {"reputation": 1, "user_id": 4623788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c5fbe37aa8582ae4073cf60d155978?s=128&d=identicon&r=PG&f=1", "display_name": "Tymoteusz Pinior", "link": "https://stackoverflow.com/users/4623788/tymoteusz-pinior"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429097528, "post_id": 29648728, "comment_id": 47437878, "body": "I wonder just how to do it. I need to write program with will sort alphabetically all the lines and when I will get file &quot;First line: Ccccc Bbbbb Second line: Aaaaa&quot; Then output should look like that: &quot;First line: Aaaaa Second line:  Bbbbb Cccccc&quot;"}, {"owner": {"reputation": 300, "user_id": 4757944, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/020868dde3084b7226fad941088c9140?s=128&d=identicon&r=PG&f=1", "display_name": "that-ru551an-guy", "link": "https://stackoverflow.com/users/4757944/that-ru551an-guy"}, "edited": false, "score": 0, "creation_date": 1429098253, "post_id": 29648728, "comment_id": 47438382, "body": "@TymoteuszPinior - Use Joachim Pileborg&#39;s advice, but use it with your pointer, not the line variable"}, {"owner": {"reputation": 38136, "user_id": 971127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6289285bbe25ce36ef68fe4932256350?s=128&d=identicon&r=PG&f=1", "display_name": "BLUEPIXY", "link": "https://stackoverflow.com/users/971127/bluepixy"}, "edited": false, "score": 0, "creation_date": 1429098406, "post_id": 29648728, "comment_id": 47438482, "body": "@TymoteuszPinior <code>&#39; &#39;</code> &lt; <code>&#39;A&#39;</code>"}, {"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1429102769, "post_id": 29648728, "comment_id": 47441498, "body": "You can&#39;t print a string with <code>%c</code> in <code>printf()</code>. It should be <code>%s</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1326, "user_id": 2053269, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/tAccL.jpg?s=128&g=1", "display_name": "Anshul", "link": "https://stackoverflow.com/users/2053269/anshul"}, "is_accepted": false, "score": -1, "last_activity_date": 1429099316, "last_edit_date": 1429099316, "creation_date": 1429098682, "answer_id": 29649481, "question_id": 29648728, "link": "https://stackoverflow.com/questions/29648728/copying-from-file-to-pointer/29649481#29649481", "title": "copying from file to pointer", "body": "<blockquote>\n  <p>The most ideal way to sort the lines of file would be to\n  use a dictionary tree. Create a dictionary tree with individual lines\n  and then perform a depth-first traversal.</p>\n</blockquote>\n\n<p>Here is a simple program that would do a dynamic buffer allocation based on line length( assuming the length of line is not more than 500)</p>\n\n<pre><code>int main(int argc, char const *argv[])\n{\n        char string[500];\n        char *str;\n\n        FILE *in_file = fopen(\"abc.txt\", \"r\");\n        if (in_file == NULL)\n        {\n                printf(\"Error file missing\\n\");\n                exit(-1);\n        }\n        while ( fgets(string, 500, in_file) != NULL)\n        {\n                str = (char *)  malloc ( sizeof(char) * strlen(string));\n                strcpy(str, string);\n                printf(\"%s\", str);\n        }\n        fclose(in_file);\n        return 0;\n}\n</code></pre>\n\n<p>In case if you want to sort them, you can either use a linked list to store these data or can use an array of pointers (which would hold the pointer address of all the malloc-ed lines) and then sort by manipulating the pointers</p>\n"}, {"tags": [], "owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1429100754, "creation_date": 1429100754, "answer_id": 29650176, "question_id": 29648728, "link": "https://stackoverflow.com/questions/29648728/copying-from-file-to-pointer/29650176#29650176", "title": "copying from file to pointer", "body": "<p>If your concern is to solve this without a buffer: It's somewhat unusual. But on a POSIX-like system you could use <code>stat()</code> (cf. <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/functions/stat.html\" rel=\"nofollow\">http://pubs.opengroup.org/onlinepubs/009695399/functions/stat.html</a>).</p>\n\n<p>Less efficient is to use Posix' <code>lseek()</code>: <code>open</code> the file, seek to the end with <code>int fileLength = lseek(fd, 0, SEEK_END);</code> and allocate <code>fileLength</code> bytes.</p>\n\n<p>Whatever function you use, it will tell you the size of the file without reading anything so that you can then allocate a buffer of exactly the required size. Don't forget to rewind the file with <code>lseek(fd, 0, SEEK_SET)</code> before you read from it, or close it and open again with <code>fopen()</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 4623788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c5fbe37aa8582ae4073cf60d155978?s=128&d=identicon&r=PG&f=1", "display_name": "Tymoteusz Pinior", "link": "https://stackoverflow.com/users/4623788/tymoteusz-pinior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1429100754, "creation_date": 1429096466, "last_edit_date": 1429097433, "question_id": 29648728, "link": "https://stackoverflow.com/questions/29648728/copying-from-file-to-pointer", "title": "copying from file to pointer", "body": "<p>I'm writting a passing program and I have a little problem.\nI want to dynamically allocate memory location with the size of the sentence which is readed from a file. Also this pointer should have this text in contents</p>\n\n<p>When file will have sentence:</p>\n\n<blockquote>\n  <p>\"One two three four five\"</p>\n</blockquote>\n\n<p>Then I want <code>char*</code> example with allocated memory location for 25 chars.\nAnd when I would like to print this text on console I want do it by</p>\n\n<pre><code>printf(\"%c\", example);\n</code></pre>\n\n<p>Console should look like that:</p>\n\n<blockquote>\n  <p>One two three four five</p>\n</blockquote>\n\n<p>I'm doing it like that:</p>\n\n<pre><code>char* czyt = (char*)malloc(sizeof(fgets( line/*static variable*/,\n                                         500 /*MAX LINE LENGHT*/,\n                                         wejscie /*FILE*/ )));\n</code></pre>\n\n<p>But in this case <code>czyt</code> doesn't have this sentence and I need to use static variable.</p>\n"}, {"tags": ["c", "algorithm", "math", "floating-point", "floating-point-conversion"], "comments": [{"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429096939, "post_id": 29648621, "comment_id": 47437540, "body": "Can&#39;t you just look if an appropriate amount of the last bits of the 8byte double are zero? Also check the exponent. The range of smaller formats is smaller."}, {"owner": {"reputation": 29078, "user_id": 227536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXKGl.png?s=128&g=1", "display_name": "Regexident", "link": "https://stackoverflow.com/users/227536/regexident"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429098818, "post_id": 29648621, "comment_id": 47438776, "body": "That would not work\u2014I think\u2014as &quot;0.328125&quot; can be losslessly cast to <code>float8_t</code> (<code>0 001 0101</code>) leaving no trailing zeros. The range issue is covered by my &quot;need not be covered&quot; rule. ;)"}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429099338, "post_id": 29648621, "comment_id": 47439144, "body": "And in longer formats the mantissa of <code>21&#47;64=(1.0101)_2*2^(-2)</code> continues with zeros. Which is exactly the condition required to compress it into the shorter format."}, {"owner": {"reputation": 29078, "user_id": 227536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXKGl.png?s=128&g=1", "display_name": "Regexident", "link": "https://stackoverflow.com/users/227536/regexident"}, "reply_to_user": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429099461, "post_id": 29648621, "comment_id": 47439225, "body": "Ah, I misread your comment. Thought you were specifically talking about the trailing bits in 8bit representation. Makes sense now (and kind of resembles DrKoch&#39;s answer, doesn&#39;t it?)."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429099599, "post_id": 29648621, "comment_id": 47439321, "body": "Yes, that&#39;s why I do not add my own answer. However, this method only applies to truly lossless compression. If some limited error is allowed, then more effort is required."}], "answers": [{"comments": [{"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1429098670, "post_id": 29649337, "comment_id": 47438654, "body": "\u201cDowncasting is equivalent to setting the least significant bits of the mantissa to zero\u201d is not quite true, because the conversion from double to float <b>rounds</b> to the nearest float on most compilation platforms. What you have described is what would happen if conversion <b>truncated</b>."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1429098805, "post_id": 29649337, "comment_id": 47438764, "body": "For instance the error when rounding the double <code>0x1.000001fffffffp0</code> to <code>float</code> is millions times less than your method would lead one to believe, as the aforementioned <code>double</code> is simply converted to <code>0x1.000002p0f</code>."}, {"owner": {"reputation": 29078, "user_id": 227536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXKGl.png?s=128&g=1", "display_name": "Regexident", "link": "https://stackoverflow.com/users/227536/regexident"}, "edited": false, "score": 0, "creation_date": 1429098977, "post_id": 29649337, "comment_id": 47438886, "body": "Good point, my <code>var_float</code> type does indeed round ties to even. Should have mentioned that specifically I guess. Will update my question."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1429099033, "post_id": 29649337, "comment_id": 47438934, "body": "But if the last bits are truly zero, then downcasting is just truncation. And if they are not zero, then downcasting gives a different number, irregardless of the rounding rule."}], "tags": [], "owner": {"reputation": 8876, "user_id": 1545171, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/TiAiM.jpg?s=128&g=1", "display_name": "DrKoch", "link": "https://stackoverflow.com/users/1545171/drkoch"}, "is_accepted": false, "score": 2, "last_activity_date": 1429099303, "last_edit_date": 1429099303, "creation_date": 1429098253, "answer_id": 29649337, "question_id": 29648621, "link": "https://stackoverflow.com/questions/29648621/accurately-predicting-rounding-error-of-cast-between-arbitrary-floating-point-fo/29649337#29649337", "title": "Accurately predicting rounding error of cast between arbitrary floating-point formats", "body": "<p>Downcasting is equivalent to setting the least significant bits of the mantissa to zero.</p>\n\n<p>So, for a given floating point number, just extract the least significant bits of the mantissa (width depending on the downcast-type) and scale with current exponent. This should (very precisely) be the \"rounding error\" which will occur in downcasting.\n<HR>\n<strong>Edit</strong></p>\n\n<p>As mentioned in the comments thhe above is only true for 50% of all cases. (When downcasting leads to <em>rounding down</em>). In cases where downcasting leads to rounding up a slightly modified approach will help: </p>\n\n<p>(extreme/corner cases: example: five digits of mantissa in downcasted type)</p>\n\n<pre><code>Rounding down: 0x1.00007fff -&gt; 0x1.0000 \n               -&gt; Err == 0x0.00007fff\n\nRounding up:   0x1.00008000 -&gt; 0x1.0001 -&gt; Err == 0x1.00010000 - 0x1.00008000\n               -&gt; Err == 0x0.00008000\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29078, "user_id": 227536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXKGl.png?s=128&g=1", "display_name": "Regexident", "link": "https://stackoverflow.com/users/227536/regexident"}, "edited": false, "score": 0, "creation_date": 1429107458, "post_id": 29650522, "comment_id": 47445152, "body": "Wow, that&#39;s it! Changing your function&#39;s last line to <code>return fabs(z);</code> makes it return the exact error. Holy crap. This was the kind of magic I was hoping for."}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 1, "creation_date": 1429107779, "post_id": 29650522, "comment_id": 47445422, "body": "This page has two references and the earlier one is by Veltkamp (1968): <a href=\"http://proval.lri.fr/gallery/Dekker.en.html\" rel=\"nofollow noreferrer\">proval.lri.fr/gallery/Dekker.en.html</a>"}, {"owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "reply_to_user": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1429109352, "post_id": 29650522, "comment_id": 47446672, "body": "@PascalCuoq: Do you have an electronic copy of that Veltkamp paper, or know where to find one?"}, {"owner": {"reputation": 75299, "user_id": 139746, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/BhJLC.png?s=128&g=1", "display_name": "Pascal Cuoq", "link": "https://stackoverflow.com/users/139746/pascal-cuoq"}, "edited": false, "score": 0, "creation_date": 1429109540, "post_id": 29650522, "comment_id": 47446822, "body": "@tmyklebu I will ask the author of the webpage when I see her."}], "tags": [], "owner": {"reputation": 13141, "user_id": 1834147, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a0991b9f14a94a126187ac3aa342d3d2?s=128&d=identicon&r=PG", "display_name": "tmyklebu", "link": "https://stackoverflow.com/users/1834147/tmyklebu"}, "is_accepted": true, "score": 4, "last_activity_date": 1429101721, "creation_date": 1429101721, "answer_id": 29650522, "question_id": 29648621, "link": "https://stackoverflow.com/questions/29648621/accurately-predicting-rounding-error-of-cast-between-arbitrary-floating-point-fo/29650522#29650522", "title": "Accurately predicting rounding error of cast between arbitrary floating-point formats", "body": "<p>Something like the following may work:</p>\n\n<pre><code>double isbad(double x, double releps) {\n  double y = x * (1 + 0x1.0p29);\n  double z = y-x-y+x;\n  return !(fabs(z/x) &lt; releps);\n}\n</code></pre>\n\n<p>This uses a trick (due to Dekker, I believe) for splitting a floating-point number into a \"big half\" and a \"little half\" that sum exactly to the original number.  I want the \"big half\" to have 23 bits and the \"little half\" to have the rest, so I split using the constant 1 + 2^(52-23).</p>\n\n<p>Caveats:  You need to handle the more limited exponent range by checking against upper and lower bounds.  Subnormals (especially the case where the result is subnormal in the little type but not the big type) need different special handling.  I wrote <code>!(fabs(z/x) &lt; releps)</code> instead of <code>fabs(z/x &lt;= releps</code> because I want NaNs to qualify as \"bad.\"  <code>releps</code> is a bad name for that variable, since the threshold is actually half an ulp larger than the number you specify when using round-to-nearest.</p>\n"}], "owner": {"reputation": 29078, "user_id": 227536, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/dXKGl.png?s=128&g=1", "display_name": "Regexident", "link": "https://stackoverflow.com/users/227536/regexident"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "accepted_answer_id": 29650522, "answer_count": 2, "score": 4, "last_activity_date": 1429101721, "creation_date": 1429096147, "last_edit_date": 1429099340, "question_id": 29648621, "link": "https://stackoverflow.com/questions/29648621/accurately-predicting-rounding-error-of-cast-between-arbitrary-floating-point-fo", "title": "Accurately predicting rounding error of cast between arbitrary floating-point formats", "body": "<p>Let\u2019s assume you have a <code>float64_t</code> number with an arbitrary value and you want to find out if said number can safely be down-cast to a <code>float32_t</code> with the restriction that the resulting rounding error must not exceed a given epsilon.</p>\n\n<p>A possible implementation could look like this:</p>\n\n<pre><code>float64_t before = 1.234567890123456789;\nfloat64_t epsilon = 0.000000001;\nfloat32_t mid = (float32_t)before;  // 1.2345678806304931640625\ndouble after = (float64_t)mid; // 1.2345678806304931640625\ndouble error = fabs(before - after); // 0.000000009492963526369635474111\nbool success = error &lt;= epsilon; // false\n</code></pre>\n\n<hr>\n\n<p>To make things more interesting though, let\u2019s assume you\u2019re not supposed to perform any actual type casting of the value at hand between those two types (as seen above).</p>\n\n<p>And just to take it up a notch: Let\u2019s assume you\u2019re <strong>not</strong> casting down to <code>float32_t</code>, but a <strong>floating-point type</strong> of <strong>arbitrary precision</strong> (8bit, 16bit, 32bit, or maybe even 24bit) specified by its bit count and exponent length (and following the conventions of IEEE 754 such as rounding ties to even).</p>\n\n<p>So what I\u2019m looking for is a generic algorithm more akin to this:</p>\n\n<pre><code>float64_t value = 1.234567890123456789;\nfloat64_t epsilon = 0.000000001;\nint bits = 16;\nint exponent = 5;\nbool success = here_be_dragons(value, epsilon, bits, exponent); // false\n</code></pre>\n\n<p>To give an example down-casting the 64bit number <code>1.234567890123456789</code> to a lower precision results in the following rounding errors:</p>\n\n<pre><code> 8bit: 0.015432109876543309567864525889\n16bit: 0.000192890123456690432135474111\n24bit: 0.000005474134355809567864525889\n32bit: 0.000000009492963526369635474111\n40bit: 0.000000000179737780214850317861\n48bit: 0.000000000001476818667356383230\n56bit: 0.000000000000001110223024625157\n</code></pre>\n\n<hr>\n\n<p>What\u2019s known:</p>\n\n<ol>\n<li>The <strong>specifications</strong> for both precision types in question (one of lower precision than the other):\n<ul>\n<li><strong>total length</strong> (in bits) (would be 32 for float, e.g.)</li>\n<li><strong>exponent length</strong> (in bits) (would be 8 for float, e.g.)</li>\n</ul></li>\n<li>The <code>min</code> and <code>max</code> values of each type (as those can be derived from the above).</li>\n<li>The number of positive normal values (excluding zero) (<code>((2^exponent) - 2) * (2^mantissa)</code>)</li>\n<li>The exponent\u2019s <code>bias</code> (<code>(2^(exponent - 1)) - 1</code>)</li>\n<li>The actual <code>value</code> (provided in the the given higher precision type).</li>\n<li>The error threshold <code>epsilon</code> allowed for the down-cast to fall within in order to be <strong>considered successful</strong> (also provided in the the given higher precision type).</li>\n</ol>\n\n<p>(An approximation of the expected error might be enough, depending on its accuracy and deviation factors. Exact calculations preferred though, obviously.)</p>\n\n<p>Cases that <strong>need not be covered</strong> (as they are trivially solvable in isolation):</p>\n\n<ul>\n<li>If the input value is of any <strong>non-normal value</strong> (subnormal, infinity, nan, zero, \u2026), then the answer shall hereby be defined to be <code>true</code>.</li>\n<li>If the input value falls <strong>outside the known boundaries</strong> (+- the given epsilon) of a given type of lower precision, then the answer shall hereby be defined to be <code>false</code>.</li>\n</ul>\n\n<hr>\n\n<p>What I\u2019ve thought up so far:</p>\n\n<p>We know the count of positive normal values (excluding zero) in a given floating-point type and we know that the <strong>negative</strong> value space is <strong>symmetric</strong> to the <strong>positive</strong> one.</p>\n\n<p>We also know that the distribution of discrete values within the value range (away from zero) follows an <strong>exponential function</strong> and its relative epsilon a <strong>related step function</strong>:</p>\n\n<p>It should be possible to calculate which <code>nth</code> <strong>discrete normal value</strong> a given <strong>real value</strong> within the normal value range of a given floating-point type <strong>would fall onto</strong> (via some kind of logarithmic projection, or something?), shouldn\u2019t it? Given this <code>n</code> one should then be able to <strong>calculate the epsilon</strong> of the corresponding value from its <strong>step function</strong> and compare it against the specified max-error, no?</p>\n\n<p>I have the feeling that this might actually be enough to calculate (or at least accurately estimate) the expected casting error. I just have no idea how to put these things together.</p>\n\n<p>How would you approach this? (Bonus points for actual code :P)</p>\n\n<p><sub>Ps: To give a bit more context: I\u2019m working on a <code>var_float</code> implementation and in order to figure out the smallest losslessly (or lossy within a given epsilon) convertible representation for a given value I\u2019m currently performing a binary search utilizing aforementioned naive round-trip logic to find the right size. It works, but it\u2019s lacking in the efficiency and coolness department. Even though it by no means is a performance bottleneck (yada yada premature optimization yada yada), I'm curious as to whether one can find a more math-grounded and elegant solution. ;)</sub></p>\n"}, {"tags": ["c", "algorithm", "math", "cryptography", "arduino"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 5, "creation_date": 1429095746, "post_id": 29648411, "comment_id": 47436818, "body": "When you say &quot;not working&quot; what do you mean by that? Do you get unexpected results? If so, what is your actual and expected results?"}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "edited": false, "score": 0, "creation_date": 1429106056, "post_id": 29648411, "comment_id": 47444089, "body": "It <b>does</b> work when <code>e==1</code>. For your info I posted the code below."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429121116, "post_id": 29652157, "comment_id": 47454719, "body": "I guess this is a better question for an arduino forum: i think the problem is with integer overflow or the fact that arduino int is 2 bytes."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429121377, "post_id": 29652157, "comment_id": 47454893, "body": "@Haskelier or the implementation of <code>pow()</code>?"}, {"owner": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429127769, "post_id": 29652157, "comment_id": 47458857, "body": "I don&#39;t really know. I think its a problem with rand(): when e = 0 it always works, when e = 1 it always works, but when e = rand(0, 2) it only works about half the time."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429127932, "post_id": 29652157, "comment_id": 47458947, "body": "That&#39;s not what you originally said. I just tried it with <code>e=2</code> always, it worked every time."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429128295, "post_id": 29652157, "comment_id": 47459141, "body": "The Linux <code>e=random(min,max)</code> returns <code>min &lt;= e &lt; max</code>, so I still don&#39;t know where your problem is. <code>e</code> won&#39;t be <code>2</code>."}, {"owner": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429133391, "post_id": 29652157, "comment_id": 47462094, "body": "im using the arduino rand(), which is inclusive in the beginning, exclusive at the end."}, {"owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "reply_to_user": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "edited": false, "score": 0, "creation_date": 1429139398, "post_id": 29652157, "comment_id": 47464494, "body": "@Haskelier, isn&#39;t that what I put in the last comment?"}], "tags": [], "owner": {"reputation": 31114, "user_id": 4142924, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KmZTf.png?s=128&g=1", "display_name": "Weather Vane", "link": "https://stackoverflow.com/users/4142924/weather-vane"}, "is_accepted": false, "score": 1, "last_activity_date": 1429105988, "creation_date": 1429105988, "answer_id": 29652157, "question_id": 29648411, "link": "https://stackoverflow.com/questions/29648411/feige-fiat-shamir-scheme-not-working/29652157#29652157", "title": "Feige Fiat Shamir Scheme not working", "body": "<p>It <strong>does</strong> work when <code>e==1</code>. When <code>e==0</code> the computation is trivial, since <code>s</code> and <code>v</code> fall out due to power of 0 always being 1. This is the code copied and altered only enough to get it to compile.</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;math.h&gt;\n\nint random (int low, int high) {\n    return low + rand() % (high - low);\n}\n\nint getGCD(int a, int b) {\n    int c;\n    while (a != 0)\n    {\n        c = a;\n        a = b % a;\n        b = c;\n    }\n    return b;\n}\n\nint getCoprime(int n) {\n    int coprime;\n    do\n    {\n        coprime = random(1, n);\n    } \n    while (getGCD(n, coprime) != 1);\n    return coprime;\n}\n\nint main(void) {\n        int e, x, y, r, n, s, v, test, ysqmodn;\n\n        srand((unsigned)time(NULL));\n        n = 7 * 3;\n        s = getCoprime(n);\n        v = (s * s) % n;\n\n        e = random(0, 2);\n        r = random(1, n);\n\n        printf(\"n=%d, s=%d, e=%d, r=%d\\n\", n,s,e,r);\n\n        y = (r * (int)pow(s, e)) % n;\n        x = (r * r) % n;\n\n        ysqmodn = y * y % n;\n        test = (x * (int)pow(v, e)) % n;\n\n        if(ysqmodn == test)\n            printf(\"The current ICC matches. \\n\");\n        else\n            printf(\"%d\\n\", e);\n\n        return 0;\n    }\n</code></pre>\n\n<p>Sample results:</p>\n\n<pre><code>n=21, s=2, e=1, r=2\nThe current ICC matches.\n\nn=21, s=11, e=0, r=12\nThe current ICC matches.\n\nn=21, s=8, e=1, r=14\nThe current ICC matches.\n\nn=21, s=17, e=1, r=13\nThe current ICC matches.\n\nn=21, s=1, e=0, r=9\nThe current ICC matches.\n\nn=21, s=4, e=0, r=13\nThe current ICC matches.\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3787984, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/70616c8c809345ad107501b0eb84a1b5?s=128&d=identicon&r=PG&f=1", "display_name": "Haskelier", "link": "https://stackoverflow.com/users/3787984/haskelier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1429105988, "creation_date": 1429095480, "last_edit_date": 1429099782, "question_id": 29648411, "link": "https://stackoverflow.com/questions/29648411/feige-fiat-shamir-scheme-not-working", "title": "Feige Fiat Shamir Scheme not working", "body": "<p>I'm trying to implement the <em>Feige Fiat Shamir Identification Scheme</em> in C (Arduino) and it works, but only when <code>e = 0</code>. When <code>e = 1</code> it doesn't work. </p>\n\n<p><strong>How can I make it work?</strong></p>\n\n<pre><code>#include &lt;Wire.h&gt;\n\nint getGCD(int a, int b)\n{\n   int c;\n   while (a != 0)\n   {\n      c = a;\n      a = b % a;\n      b = c;\n   }\n   return b;\n}\n\nint getCoprime(int n)\n{\n   int coprime;\n   do\n   {\n      coprime = random(1, n);\n   } \n   while (getGCD(n, coprime) != 1);\n   return coprime;\n}\n\n\n//Preparation\nint n = 7 * 3;\nint s = getCoprime(n);\nint v = (s * s) % n;\n\nvoid loop ()\n{\n  e = random(0, 2);\n  r = random(1, n);\n  int y = (r * (int)pow(s, e)) % n;\n  int x = (r * r) % n;\n\n  int ysqmodn = y * y % n;\n  int test = (x * (int)pow(v, e)) % n;\n\n  if(ysqmodn == test)\n  {\n    Serial.print(\"The current ICC matches. \\n\");\n  }  \n  else\n  {  \n    Serial.print(String(e));\n    Serial.print(\"\\n\");\n  }\n  delay(500);\n}\n</code></pre>\n"}, {"tags": ["c"], "comments": [{"owner": {"reputation": 42285, "user_id": 2057919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ec600dcd84770c5d835cd4c943514088?s=128&d=identicon&r=PG&f=1", "display_name": "elixenide", "link": "https://stackoverflow.com/users/2057919/elixenide"}, "edited": false, "score": 4, "creation_date": 1429095019, "post_id": 29648203, "comment_id": 47436368, "body": "(1) Please format your code with proper indentations. This is really hard to read. (2) That is a lot of code. Please edit your post and provide <a href=\"http://stackoverflow.com/help/mcve\">a Minimal, Complete, and Verifiable example.</a>"}, {"owner": {"reputation": 43245, "user_id": 699305, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/db6ce45b5ec86e1b00d922fc5cee315f?s=128&d=identicon&r=PG", "display_name": "alexis", "link": "https://stackoverflow.com/users/699305/alexis"}, "edited": false, "score": 1, "creation_date": 1429095045, "post_id": 29648203, "comment_id": 47436381, "body": "Welcome to stackoverflow. This is WAY too much code for getting a useful answer, and you&#39;re not even giving a runnable program in one place. But I noticed that <code>creatfile</code> will empty the contents of the file, if it exists. Is that intentional?"}, {"owner": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 2, "creation_date": 1429095238, "post_id": 29648203, "comment_id": 47436517, "body": "In <code>creatfile</code> you forgot to close your file after you finished writing to it."}, {"owner": {"reputation": 35, "user_id": 4702921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zt7oo.png?s=128&g=1", "display_name": "Moutasem", "link": "https://stackoverflow.com/users/4702921/moutasem"}, "reply_to_user": {"reputation": 43245, "user_id": 699305, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/db6ce45b5ec86e1b00d922fc5cee315f?s=128&d=identicon&r=PG", "display_name": "alexis", "link": "https://stackoverflow.com/users/699305/alexis"}, "edited": false, "score": 0, "creation_date": 1429095470, "post_id": 29648203, "comment_id": 47436643, "body": "@alexis in the main() function the user i asked between creating the file or continue if it&#39;s already created so the file will be created by the user&#39;s demand only , but if you chose to open the file as &quot;wb&quot; all the info will be lost the problem is i&#39;m running the program , i&#39;m choosing to create the file at the first run and enter some records , at the second run i choose not to create a new file because it&#39;s already created , instead i want to continue to read the records , but it&#39;s lost even if i don&#39;t create the file again !"}, {"owner": {"reputation": 35, "user_id": 4702921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zt7oo.png?s=128&g=1", "display_name": "Moutasem", "link": "https://stackoverflow.com/users/4702921/moutasem"}, "reply_to_user": {"reputation": 195333, "user_id": 253056, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1977cbe0ac5ffec4f6ee5ee24363988a?s=128&d=identicon&r=PG", "display_name": "Paul R", "link": "https://stackoverflow.com/users/253056/paul-r"}, "edited": false, "score": 1, "creation_date": 1429095639, "post_id": 29648203, "comment_id": 47436758, "body": "you&#39;re genius @PaulR the problem solved thanks a loooooot i read the code like 100 times i couldn&#39;t notice that ."}], "answers": [{"tags": [], "owner": {"reputation": 23469, "user_id": 775964, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/glHLl.jpg?s=128&g=1", "display_name": "Jeegar Patel", "link": "https://stackoverflow.com/users/775964/jeegar-patel"}, "is_accepted": true, "score": 0, "last_activity_date": 1429098390, "creation_date": 1429098390, "answer_id": 29649383, "question_id": 29648203, "link": "https://stackoverflow.com/questions/29648203/losing-my-files-data-after-closing-the-file/29649383#29649383", "title": "Losing my file&#39;s data after closing the file", "body": "<p>In such cases first things i do is...</p>\n\n<blockquote>\n  <p>Make sure for every fopen() call there is one fclose() call.</p>\n</blockquote>\n\n<p>So here in createfile() you fopen in write mode file and do not close that file.. open that file again with rb+ mode so that is causing problem.</p>\n\n<p>You should close file in createfile() after writing that so your code will be like</p>\n\n<pre><code>void creatfile()\n{\nFILE *fp;\nogr_t bos_ogr = { 0, 0, 0, 0, 0.0, \"\", \"\" };\nif ((fp = fopen(\"kayit.dat\", \"wb\")) == NULL)\n{\n    printf(\"File was not opened\");\n}\nelse\n{   //to create a file and initialize it with an empty 100 student record .\n    for (int i = 0; i &lt; 100; i++)\n    {\n        fwrite(&amp;bos_ogr, sizeof(ogr_t), 1, fp);\n    }//end for\n\n    //Lets close the file         \n    fclose(fp);\n}\nsystem(\"cls\");\n}\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 4702921, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/zt7oo.png?s=128&g=1", "display_name": "Moutasem", "link": "https://stackoverflow.com/users/4702921/moutasem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 29649383, "answer_count": 1, "score": 0, "last_activity_date": 1429098390, "creation_date": 1429094832, "question_id": 29648203, "link": "https://stackoverflow.com/questions/29648203/losing-my-files-data-after-closing-the-file", "title": "Losing my file&#39;s data after closing the file", "body": "<p>I'm trying to make a file that holds records for the students in a school, every thing is going fine apart from one, that is the data is being lost after i close the program .\nwhat's the problem ?</p>\n\n<p>program starts here :</p>\n\n<pre><code>    #include \"stdafx.h\"\n    #include &lt;stdio.h&gt;\n    #include &lt;conio.h&gt;\n    #include &lt;iostream&gt;\n    #include &lt;string.h&gt;\n\n    using namespace std;\n</code></pre>\n\n<p>This is the struct that will be used to process the records .</p>\n\n<pre><code>    /*a struct ogrenci and name it ogr_t with typedef*/\n    typedef struct ogrenci\n    {\n    int kyt_no, ogrno, vize, final;\n    float ort;\n    char ad[10];\n    char soyad[10];\n    }ogr_t;\n    /*End struct*/\n\n    void creatfile();//To create the file \"Kayit.dat\" if it was not created .\n</code></pre>\n\n<p>functions prototypes and main()</p>\n\n<pre><code>    int menu();\n    void addrecord(FILE *ptr); \n    void updaterecord(FILE *ptr);\n    void deleterecord(FILE *ptr);\n    void listrecords(FILE *ptr);\n    void searchrecord(FILE *ptr);\n    double findavg(FILE *ptr);\n\n    int _tmain(int argc, _TCHAR* argv[])\n    {\n    FILE *fp;\n    int request;\n    int choice;\n    printf(\"1- Creat the File \\\"Kayit.dat\\\" if it was not created .\\n\\n\"\n           \"#NOTE: this choice will clear the data saved if the file was created earlier .\\n\\n\"\n           \"2- To continue if the file is already created .\\n\");\n    scanf(\"%d\", &amp;choice);\n    switch (choice)\n    {\n    case 1:creatfile();\n    case 2:\n        system(\"cls\");\n        if ((fp = fopen(\"kayit.dat\", \"rb+\")) == NULL)\n        {\n            printf(\"File was not opened.\");\n        }\n        else\n        {\n            while ((request = menu()) != 6)\n            {\n                switch (request)\n                {\n                case 1:addrecord(fp); break;\n                case 2:updaterecord(fp); break;\n                case 3:deleterecord(fp); break;\n                case 4:listrecords(fp); break;\n                case 5:searchrecord(fp); break;\n                default:printf(\"undefined\\n\");break;\n                }\n            }\n            fclose(fp);\n        }break;\n    default:printf(\"Undefined\\n\");break;\n    }\n    return 0;\n    }\n</code></pre>\n\n<p>after asking the user in    main() this function creats the file kayit.dat</p>\n\n<pre><code>    void creatfile()\n    {\n    FILE *fp;\n    ogr_t bos_ogr = { 0, 0, 0, 0, 0.0, \"\", \"\" };\n    if ((fp = fopen(\"kayit.dat\", \"wb\")) == NULL)\n    {\n        printf(\"File was not opened\");\n    }\n    else\n    {   //to create a file and initialize it with an empty 100 student record .\n        for (int i = 0; i &lt; 100; i++)\n        {\n            fwrite(&amp;bos_ogr, sizeof(ogr_t), 1, fp);\n        }//end for\n    }\n    system(\"cls\");\n    }\n</code></pre>\n\n<p>This is the menu that the user will be represented with in main() .</p>\n\n<pre><code>    int menu(void)\n    {\n    int x;\n    printf(\"What do you want to do :\\n\\n\"\n        \"1= Add record .\\n\"\n        \"2= Update record .\\n\"\n        \"3= Delete Record .\\n\"\n        \"4= list all the records .\\n\"\n        \"5= Search for a specific record .\\n\"\n        \"6= Quit .\\n\");\n    scanf(\"%d\", &amp;x);\n    system(\"cls\");\n    return x;\n    }\n</code></pre>\n\n<p>This function adds a new record using random access .</p>\n\n<pre><code>    void addrecord(FILE *ptr)\n    {\n    ogr_t record = { 0, 0, 0, 0, 0.0, \"\", \"\" };\n    int accnum;\n    char c;\n    /*Enter a record number and search if is was already input*/\n    printf(\" Enter a record number for the new student &lt; 1 - 100 &gt; .\");\n    scanf(\"%d\", &amp;accnum);\n    fseek(ptr, (accnum - 1)*sizeof(ogr_t), SEEK_SET);\n    fread(&amp;record, sizeof(ogr_t), 1, ptr);\n    if (record.kyt_no!=0)\n    {\n        printf(\"this record is already full .\\n\");\n        printf(\"press and key to continue...\\n\");\n        if (c = _getche())\n        {\n            system(\"cls\");\n        }\n    }\n    else\n    {\n        printf(\"%-13s%-13s%-13s%-13s%-13s\\n\", \"Name\", \"SureName\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n        fscanf(stdin, \"%s%s%d%d%d\", record.ad, record.soyad, &amp;record.ogrno, &amp;record.vize, &amp;record.final);\n        record.kyt_no = accnum;\n        fseek(ptr, (record.kyt_no - 1)*sizeof(ogr_t), SEEK_SET);\n        fwrite(&amp;record, sizeof(ogr_t), 1, ptr);\n    }\n    system(\"cls\");\n    }\n</code></pre>\n\n<p>Update the record chosen by the user.</p>\n\n<pre><code>    void updaterecord(FILE *ptr)\n    {\n    ogr_t record1 = { 0, 0, 0, 0, 0.0, \"\", \"\" };\n    int accnum;\n    char c;\n    printf(\" Enter the student's record number that you want to update  &lt; 1 - 100 &gt; .\");\n    scanf(\"%d\", &amp;accnum);\n    fseek(ptr, (accnum - 1)*sizeof(ogr_t), SEEK_SET);\n    fread(&amp;record1, sizeof(ogr_t), 1, ptr);\n    if (record1.kyt_no == 0)\n    {\n        printf(\"This record is empty\\n\");\n        printf(\"press and key to continue...\\n\");\n        if (c= _getche())\n        {\n            system(\"cls\");\n        }\n    }\n    else\n    {\n        printf(\"Enter the new informations\\n\");\n        printf(\"%-13s%-13s%-13s%-13s%-13s\\n\", \"Name\", \"SureName\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n        fscanf(stdin, \"%s%s%d%d%d\", record1.ad, record1.soyad, &amp;record1.ogrno, &amp;record1.vize, &amp;record1.final);\n        record1.kyt_no = accnum;\n        fseek(ptr, (record1.kyt_no - 1)*sizeof(ogr_t), SEEK_SET);\n        fwrite(&amp;record1, sizeof(ogr_t), 1, ptr);\n        system(\"cls\");\n    }\n\n    }\n</code></pre>\n\n<p>Delete  a record chosen by the user after checking that's empty or not .</p>\n\n<pre><code>    void deleterecord(FILE *ptr)\n    {\n    ogr_t bos_ogr = { 0, 0, 0, 0, 0.0, \"\", \"\" };\n    ogr_t record2;\n    int accnum;\n    char c;\n        printf(\"Enter the record for the student that you want delete &lt; 1 - 100 &gt;\\n\");\n        fscanf(stdin, \"%d\", &amp;accnum);\n        fseek(ptr, (accnum - 1)*sizeof(ogr_t), SEEK_SET);\n        fread(&amp;record2, sizeof(ogr_t), 1, ptr);\n        if (record2.kyt_no == 0)\n        {\n            printf(\"The record is already empty .\\n\");\n            printf(\"press and key to continue...\\n\");\n            if (c = _getche())\n            {\n                system(\"cls\");\n            }\n        }\n        else\n        {\n            fseek(ptr, (accnum - 1)*sizeof(ogr_t), SEEK_SET);\n            fwrite(&amp;bos_ogr, sizeof(ogr_t), 1, ptr);\n            system(\"cls\");\n        }\n    }\n</code></pre>\n\n<p>List all the records in the file .</p>\n\n<pre><code>void listrecords(FILE *ptr)\n{\n    ogr_t record_prnt;\n    char c;\n    printf(\"%-13s%-13s%-13s%-13s%-13s%-13s\\n\", \"RecordNo\", \"Name\", \"Surname\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n    rewind(ptr);\n    fread(&amp;record_prnt, sizeof(ogr_t), 1, ptr);\n    while (!feof(ptr))\n    {\n        if (record_prnt.kyt_no == 0)\n        {\n            record_prnt = { 0, 0, 0, 0, 0.0, \"\", \"\" };\n        }\n        else\n        {\n            printf(\"%-13d%-13s%-13s%-13d%-13d%-13d\\n\",\n                record_prnt.kyt_no, record_prnt.ad,\n                record_prnt.soyad, record_prnt.ogrno,\n                record_prnt.vize, record_prnt.final);\n        }\n        fread(&amp;record_prnt, sizeof(ogr_t), 1, ptr);\n    }\n    printf(\"press any key to contiue ...\\n\");\n    if (c = _getche())\n    {\n        system(\"cls\");\n    }\n}\n</code></pre>\n\n<p>Search for a specific record by criteria chosen by the user.</p>\n\n<pre><code>void searchrecord(FILE *ptr)\n{\n    int request;\n    int recnum;\n    char name[20];\n    ogr_t ogr;\n    int mark;\n    printf(\"Enter by what criteria do you want to search .\\n\\n\"\n        \"1- By record num.\\n\"\n        \"2- By Name.\\n\"\n        \"3- By Grade.\\n\");\n    scanf(\"%d\", &amp;request);\n    system(\"cls\");\n    switch (request)\n    {\n    case 1:\n        printf(\"Enter the record number .\");\n        scanf(\"%d\", &amp;recnum);\n        fseek(ptr, (recnum - 1)*sizeof(ogr_t), SEEK_SET);\n        fread(&amp;ogr, sizeof(ogr_t), 1, ptr);\n        printf(\"%-13s%-13s%-13s%-13s%-13s%-13s\\n\", \"RecordNumber\", \"Name\", \"Surename\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n        printf(\"%-13d%-13s%-13s%-13d%-13d%-13d\\n\", ogr.kyt_no, ogr.ad, ogr.soyad, ogr.ogrno, ogr.vize, ogr.final);\n        break;\n    case 2:\n        printf(\"Enter the name of the student .\\n \");\n        scanf(\"%s\",name);\n        rewind(ptr);\n        fread(&amp;ogr, sizeof(ogr_t), 1, ptr);\n        while (!feof(ptr))\n        {\n            if (strcmp(name, ogr.ad) == 0)\n            {\n                printf(\"%-13s%-13s%-13s%-13s%-13s%-13s\\n\", \"RecordNumber\", \"Name\", \"Surename\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n                printf(\"%-13d%-13s%-13s%-13d%-13d%-13d\\n\", ogr.kyt_no, ogr.ad, ogr.soyad, ogr.ogrno, ogr.vize, ogr.final);\n            }\n            fread(&amp;ogr, sizeof(ogr_t), 1, ptr);\n        }\n        break;\n    case 3:\n        printf(\"Enter the Mark the you want to search for.\\n \");\n        scanf(\"%d\",&amp;mark);\n        printf(\"The student that had higher than the mark that you've enterd are \\n\\n\");\n        rewind(ptr);\n        fread(&amp;ogr, sizeof(ogr_t), 1, ptr);\n        while (!feof(ptr))\n        {\n            if (ogr.kyt_no!=0)\n            {\n                ogr.ort = ((ogr.final) + (ogr.vize)) / 2;\n                if ((ogr.ort)&gt;=mark)//print the records that have a higher averager than the mark.\n                {\n                    printf(\"%-13s%-13s%-13s%-13s%-13s%-13s\\n\", \"RecordNumber\", \"Name\", \"Surename\", \"StudentNum\", \"MidtermNote\", \"FinalNote\");\n                    printf(\"%-13d%-13s%-13s%-13d%-13d%-13d\\n\", ogr.kyt_no, ogr.ad, ogr.soyad, ogr.ogrno, ogr.vize, ogr.final);\n                }\n            }\n            fread(&amp;ogr, sizeof(ogr_t), 1, ptr);\n        }\n        break;\n    default:printf(\"Undefined choice.\\n\");\n        break;\n    }\n}\n</code></pre>\n\n<p>End of the program . </p>\n"}, {"tags": ["c", "function"], "comments": [{"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 3, "creation_date": 1429093940, "post_id": 29647857, "comment_id": 47435667, "body": "You cannot declare a variable in an <code>if</code> controlling expression."}, {"owner": {"reputation": 86959, "user_id": 1735406, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/IF9uS.png?s=128&g=1", "display_name": "Maroun", "link": "https://stackoverflow.com/users/1735406/maroun"}, "edited": false, "score": 0, "creation_date": 1429093948, "post_id": 29647857, "comment_id": 47435672, "body": "Declare <code>r</code> outside the <code>if</code>."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 1, "creation_date": 1429094077, "post_id": 29647857, "comment_id": 47435762, "body": "Check your basic C syntax. <code>!-1</code> is always <code>0</code> and is valid, but I doubt that&#39;s what you intended to check for."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1429094271, "post_id": 29647857, "comment_id": 47435900, "body": "Please do not add [Solved] into your question. There is a procedure when you get an answer: <a href=\"http://stackoverflow.com/help/someone-answers\">What should I do when someone answers my question?</a>."}, {"owner": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1429095186, "post_id": 29647857, "comment_id": 47436475, "body": "@Quentin show me a valid declaration in an <code>if</code> controlling expression and I show you you are wrong."}, {"owner": {"reputation": 12180, "user_id": 3150802, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ulVTa.png?s=128&g=1", "display_name": "Peter - Reinstate Monica", "link": "https://stackoverflow.com/users/3150802/peter-reinstate-monica"}, "reply_to_user": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "edited": false, "score": 0, "creation_date": 1429095683, "post_id": 29647857, "comment_id": 47436785, "body": "@Quentin This may be a subtle difference between C and C++. I believe the (informal) C grammar does not allow for declarations, but the C++ one appears to (cf. Mike&#39;s answer in <a href=\"http://stackoverflow.com/questions/7836867/c-variable-declaration-in-if-expression\" title=\"c variable declaration in if expression\">stackoverflow.com/questions/7836867/&hellip;</a>)."}, {"owner": {"reputation": 381, "user_id": 4689414, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eb557bb7fb58c0208b827b9bd4a4c36c?s=128&d=identicon&r=PG&f=1", "display_name": "vvvsg", "link": "https://stackoverflow.com/users/4689414/vvvsg"}, "edited": false, "score": 0, "creation_date": 1429095873, "post_id": 29647857, "comment_id": 47436886, "body": "I&#39;m writing C code in Visual C++ so i can declare variables in an if statement."}, {"owner": {"reputation": 58398, "user_id": 3233393, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c4c576e0ebcdf0efd653269a5b020347?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/3233393/quentin"}, "reply_to_user": {"reputation": 133646, "user_id": 1119701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d4bef9fe12d776629b204d4e650c2e0?s=128&d=identicon&r=PG", "display_name": "ouah", "link": "https://stackoverflow.com/users/1119701/ouah"}, "edited": false, "score": 0, "creation_date": 1429098260, "post_id": 29647857, "comment_id": 47438383, "body": "@ouah My bad ! I did mix up with C++. Looks like I&#39;m not the only one :)"}, {"owner": {"reputation": 743, "user_id": 2950911, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0c4ed867715a870b7917df860c84e28f?s=128&d=identicon&r=PG&f=1", "display_name": "user2950911", "link": "https://stackoverflow.com/users/2950911/user2950911"}, "edited": false, "score": 0, "creation_date": 1429102567, "post_id": 29647857, "comment_id": 47441374, "body": "Not sure what you are intending to do, but i believe the != operator has a higher precedence than the = operator, so &#39;return value&#39; != -1 will evaluate to true or false and t hen be assigned to &#39;int r&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 5277, "user_id": 4745527, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/mVYxV.png?s=128&g=1", "display_name": "Aracthor", "link": "https://stackoverflow.com/users/4745527/aracthor"}, "is_accepted": true, "score": 4, "last_activity_date": 1429094080, "creation_date": 1429094080, "answer_id": 29647942, "question_id": 29647857, "link": "https://stackoverflow.com/questions/29647857/cant-check-return-value-of-a-function-in-c/29647942#29647942", "title": "Can&#39;t check return value of a function in C", "body": "<p>You need to declare your variables before your code.</p>\n\n<p>And the syntax for the opposite of <code>==</code> is <code>!=</code> and not <code>=!</code> by the way.</p>\n\n<pre><code>int r;\n\nif ((r = input(num_first, num_second, fixPTR)) != -1)\n{\n// do smth\n}\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 4689414, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/eb557bb7fb58c0208b827b9bd4a4c36c?s=128&d=identicon&r=PG&f=1", "display_name": "vvvsg", "link": "https://stackoverflow.com/users/4689414/vvvsg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2138, "favorite_count": 1, "accepted_answer_id": 29647942, "answer_count": 1, "score": -1, "last_activity_date": 1429094206, "creation_date": 1429093849, "last_edit_date": 1429094206, "question_id": 29647857, "link": "https://stackoverflow.com/questions/29647857/cant-check-return-value-of-a-function-in-c", "title": "Can&#39;t check return value of a function in C", "body": "<p>So I'm trying to check my functions return value in an if statement so that i can check wheter it's working fine or not.</p>\n\n<p>I have:</p>\n\n<pre><code>    if (int r = (input(num_first, num_second, fixPTR)) =! -1)\n    {\n// do smth\n    }\n</code></pre>\n\n<p>but Visual Studio says : expression must be a modifiable lvalue</p>\n\n<p>how do i fix it??</p>\n"}, {"tags": ["c", "linux", "embedded"], "comments": [{"owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1429092894, "post_id": 29647457, "comment_id": 47435006, "body": "Unrelated, but there&#39;s no need to <code>lseek()</code> in a file that you&#39;ve just opened, it&#39;s going to be positioned at the beginning."}, {"owner": {"reputation": 1737, "user_id": 1309431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mxtYD.jpg?s=128&g=1", "display_name": "lppier", "link": "https://stackoverflow.com/users/1309431/lppier"}, "reply_to_user": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "edited": false, "score": 0, "creation_date": 1429096489, "post_id": 29647457, "comment_id": 47437272, "body": "Roger, thanks I&#39;ll give it a try."}], "answers": [{"comments": [{"owner": {"reputation": 1737, "user_id": 1309431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mxtYD.jpg?s=128&g=1", "display_name": "lppier", "link": "https://stackoverflow.com/users/1309431/lppier"}, "edited": false, "score": 0, "creation_date": 1429094585, "post_id": 29647580, "comment_id": 47436095, "body": "Doh! Thanks... I am embarrased."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": true, "score": 1, "last_activity_date": 1429095218, "last_edit_date": 1429095218, "creation_date": 1429092951, "answer_id": 29647580, "question_id": 29647457, "link": "https://stackoverflow.com/questions/29647457/hanging-polling-gpio/29647580#29647580", "title": "Hanging polling GPIO", "body": "<p>You have</p>\n\n<pre><code>close(fd);\n</code></pre>\n\n<p><em>outside</em> the loop that does the <code>open()</code>. I think you're leaking file descriptors like crazy, which eventually leads to <code>open()</code> failing, which you're not detecting. Always error-check your I/O.</p>\n\n<p>Perhaps the <code>lseek()</code> implies that you wanted to do the <code>open()</code> <em>once</em> before the loop.</p>\n"}], "owner": {"reputation": 1737, "user_id": 1309431, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/mxtYD.jpg?s=128&g=1", "display_name": "lppier", "link": "https://stackoverflow.com/users/1309431/lppier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 29647580, "answer_count": 1, "score": 0, "last_activity_date": 1429095218, "creation_date": 1429092596, "question_id": 29647457, "link": "https://stackoverflow.com/questions/29647457/hanging-polling-gpio", "title": "Hanging polling GPIO", "body": "<p>I have implemented this function to poll a GPIO switch, and to light up an LED when recording is in progress. The switch is used to start recording. The LED is turned off when recording ends. \nI've found that the code works for short periods of time in between activating the switch. However, if I leave the program running for long periods of time.. the switch starts to lose functionality. As in, I cannot start/stop recording anymore when I flip the switch. </p>\n\n<p>So say I start recording, then wait for a long period of time, maybe 1/2 hour. When I switch to \"Off\", it doesn't register. \nHowever, if I do a cat ../gpio57/value, it gives me 0. (1 is recording) </p>\n\n<p>What could be the problem here? </p>\n\n<pre><code>void* pollGPIOSwitch(void* arg) {\n\n   //pthread_detach(pthread_self()); \n   Vn200* vn200 = (Vn200*)arg;\n   int fd, LEDFd;\n   char buf[100];\n   char LEDbuf[100];\n   char value; \n   int videoRecError;\n   bool videoRecOn = false;\n\n   sprintf(buf, \"/sys/class/gpio/gpio57/value\");\n   //printf(buf);\n\n   while (KEEP_GOING) {\n       fd = open(buf,O_RDONLY);\n       lseek(fd,0,SEEK_SET); // -- move to beginning of file\n       read(fd,&amp;value,1);\n       if (value=='0') {\n           printf(\"Switch is OFF\\n\");\n           if (videoRecOn) { // -- recording on, switch off, end recording\n               stopAllRecordings();\n               videoRecOn = false;\n               TriggerGPSINSThreadExit = 0; // -- reset variables\n               printf(\"Reset GPSINS Thread variables.\\n\");\n               // -- Set LED to off\n               sprintf(LEDbuf, \"/sys/class/gpio/gpio56/value\");\n               //printf(LEDbuf);\n               LEDFd = open(LEDbuf, O_WRONLY);\n               write(LEDFd,\"0\",2);\n\n           }\n       }\n       else if (!videoRecOn) { // -- recording off, switch on, start recording\n           printf(\"Switch is ON\\n\"); \n           if (pthread_create(&amp;GPSINSLoggingThread, NULL, runGPSINS,(void*) vn200) != 0) {\n                printf(\"Error: Fail to create runGPSINS thread\\n\");\n            }\n\n            videoRecError = startVideoRecording();\n            if (videoRecError == -1)\n                pthread_exit(&amp;videoRecError);\n            videoRecOn = true; \n             // -- Set LED to on\n             sprintf(LEDbuf, \"/sys/class/gpio/gpio56/value\");\n             //printf(LEDbuf);\n             LEDFd = open(LEDbuf, O_WRONLY);\n             write(LEDFd,\"1\",2);\n\n       }\n       //fflush(stdout);\n       usleep(500000);\n   }\n   close(fd);\n   close(LEDFd);\n\n\n   printf(\"Exited Polling!\");\n}\n</code></pre>\n"}, {"tags": ["java", "c"], "comments": [{"owner": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1429092826, "post_id": 29647454, "comment_id": 47434963, "body": "What commands are you running? What do you see, what do you expect to see?"}, {"owner": {"reputation": 4903, "user_id": 2695344, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7079388c9f9c3a89fbf6e09881c48766?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Kersten", "link": "https://stackoverflow.com/users/2695344/martin-kersten"}, "reply_to_user": {"reputation": 120590, "user_id": 3788176, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/9c18d321d8948803c05643d87b003dc2?s=128&d=identicon&r=PG&f=1", "display_name": "Andy Turner", "link": "https://stackoverflow.com/users/3788176/andy-turner"}, "edited": false, "score": 0, "creation_date": 1429095166, "post_id": 29647454, "comment_id": 47436460, "body": "I did something wrong I tried it twice and it failed. Now i tried it with another class and it works. Do not know why but it seams that it can not work properly with certain annotations that are placed else where (the other class has a @Test annotation. It was not finding it but the error complained about the outer class."}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1429100930, "post_id": 29647454, "comment_id": 47440207, "body": "<code>static inner</code> is a contradiction in terms. You mean <code>static nested</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4903, "user_id": 2695344, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7079388c9f9c3a89fbf6e09881c48766?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Kersten", "link": "https://stackoverflow.com/users/2695344/martin-kersten"}, "is_accepted": false, "score": 0, "last_activity_date": 1429095222, "creation_date": 1429095222, "answer_id": 29648323, "question_id": 29647454, "link": "https://stackoverflow.com/questions/29647454/creating-stub-file-for-static-nested-class/29648323#29648323", "title": "Creating stub file for static nested class", "body": "<p>The problem was related to an @Test annotation but javah did complained about the outer class (where this notation was applied to a method) as being unable to find the outer class.</p>\n"}], "owner": {"reputation": 4903, "user_id": 2695344, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/7079388c9f9c3a89fbf6e09881c48766?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Kersten", "link": "https://stackoverflow.com/users/2695344/martin-kersten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1429144802, "creation_date": 1429092587, "last_edit_date": 1429144802, "question_id": 29647454, "link": "https://stackoverflow.com/questions/29647454/creating-stub-file-for-static-nested-class", "title": "Creating stub file for static nested class", "body": "<p>I have problems using <code>javah</code> to create c-stubs (h-file) for static nested classes in Java. </p>\n\n<p>Can someone verify that this is not working since <code>javah</code> does not find the outer class? </p>\n\n<p>Also I would like to know why it should be impossible to create a stub file for an (static) nested class.</p>\n"}, {"tags": ["c++", "c"], "comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 4, "creation_date": 1429092294, "post_id": 29647276, "comment_id": 47434613, "body": "This is not &quot;linking&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 11342, "user_id": 1144157, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d05077a347e63679d43bfbdaf5e7b9ab?s=128&d=identicon&r=PG", "display_name": "Steephen", "link": "https://stackoverflow.com/users/1144157/steephen"}, "is_accepted": false, "score": 1, "last_activity_date": 1429092557, "last_edit_date": 1429092557, "creation_date": 1429092233, "answer_id": 29647307, "question_id": 29647276, "link": "https://stackoverflow.com/questions/29647276/ordering-in-include-directive/29647307#29647307", "title": "Ordering in #include directive", "body": "<p><code>#include \"file\"</code> will search in current directory before searching in include path. There is no mechanism  to specify the order of linking of object files.</p>\n"}, {"comments": [{"owner": {"reputation": 357695, "user_id": 560648, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/pBDFJ.jpg?s=128&g=1", "display_name": "Lightness Races in Orbit", "link": "https://stackoverflow.com/users/560648/lightness-races-in-orbit"}, "edited": false, "score": 0, "creation_date": 1429092375, "post_id": 29647339, "comment_id": 47434663, "body": "I think it&#39;s clear he simply misused the term. The question isn&#39;t actually about linking."}, {"owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "edited": false, "score": 0, "creation_date": 1429092415, "post_id": 29647339, "comment_id": 47434689, "body": "I doubt that this is a common misconception."}], "tags": [], "owner": {"reputation": 362958, "user_id": 28169, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/ec9385dc533f1a6a93769077f852503e?s=128&d=identicon&r=PG", "display_name": "unwind", "link": "https://stackoverflow.com/users/28169/unwind"}, "is_accepted": false, "score": 2, "last_activity_date": 1429092402, "last_edit_date": 1429092402, "creation_date": 1429092329, "answer_id": 29647339, "question_id": 29647276, "link": "https://stackoverflow.com/questions/29647276/ordering-in-include-directive/29647339#29647339", "title": "Ordering in #include directive", "body": "<p>Preprocessor includes have nothing to do with linking. This is a common misconception.</p>\n\n<p>There is no assumption anywhere that one include corresponds to something being linked. Notice that the standard library has lots of headers, but generally only consists of a single library when the linking happens.</p>\n\n<p>With e.g. gcc (and most other compilers) you can compile a C file first, then compile a bunch of other C files, then finally do the linking of all the object files with any required external libraries. When you do the linking, you're operating on <em>already-compiled</em> files (object files and libraries); these files know nothing about the order in which the preprocessor directives appeared in the original source, that is long gone.</p>\n"}, {"tags": [], "owner": {"reputation": 11326, "user_id": 2328763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/849491de0be9b3cdf39c96b4c6b32e2b?s=128&d=identicon&r=PG", "display_name": "Alper", "link": "https://stackoverflow.com/users/2328763/alper"}, "is_accepted": false, "score": 1, "last_activity_date": 1429092340, "creation_date": 1429092340, "answer_id": 29647344, "question_id": 29647276, "link": "https://stackoverflow.com/questions/29647276/ordering-in-include-directive/29647344#29647344", "title": "Ordering in #include directive", "body": "<p><code>#include file</code> directive tells the preprocessor to treat the contents of a specified <code>file</code> as if it appears in the source program at the point where the directive appears.</p>\n\n<p>It is not related to linking.</p>\n"}], "owner": {"reputation": 81, "user_id": 4659164, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/soWcL.jpg?s=128&g=1", "display_name": "anubhav", "link": "https://stackoverflow.com/users/4659164/anubhav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "closed_date": 1429092336, "answer_count": 3, "score": 0, "last_activity_date": 1429092557, "creation_date": 1429092152, "last_edit_date": 1429092261, "question_id": 29647276, "link": "https://stackoverflow.com/questions/29647276/ordering-in-include-directive", "closed_reason": "Duplicate", "title": "Ordering in #include directive", "body": "<p>I understand the difference between</p>\n\n<pre><code>#include \"xyz\"\n</code></pre>\n\n<p>and</p>\n\n<pre><code>#include &lt;xyz&gt;\n</code></pre>\n\n<p>in terms of what location is searched in each case.</p>\n\n<p>I would like to know whether there is an ordering according to which searching and linking is done. Are files using</p>\n\n<pre><code>#include \"xyz\" //as this is done in current working directory\n</code></pre>\n\n<p>linked before linking of files using</p>\n\n<pre><code>#include &lt;xyz&gt;\n</code></pre>\n"}, {"tags": ["c", "include", "environment-variables", "c-preprocessor"], "comments": [{"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 1, "creation_date": 1429092315, "post_id": 29647243, "comment_id": 47434624, "body": "The preprocessor is a compile-time only thing, it can&#39;t do anything at runtime. It&#39;s also a separate language from C, and so have no knowledge of C variables."}, {"owner": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429092559, "post_id": 29647243, "comment_id": 47434793, "body": "However, you fix it by defining macros on the command line, like e.g. <code>gcc DMY_INCLUDE=&quot;$MY_ENV_VAR&quot; my_source.c</code>"}, {"owner": {"reputation": 157, "user_id": 1028361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e4136c5422c2e5ec2367ecc5c4478083?s=128&d=identicon&r=PG", "display_name": "dbrembilla", "link": "https://stackoverflow.com/users/1028361/dbrembilla"}, "reply_to_user": {"reputation": 361156, "user_id": 440558, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/9ZYta.jpg?s=128&g=1", "display_name": "Some programmer dude", "link": "https://stackoverflow.com/users/440558/some-programmer-dude"}, "edited": false, "score": 0, "creation_date": 1429094124, "post_id": 29647243, "comment_id": 47435792, "body": "Thanks for the reply ! i&#39;ll try"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 1028361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e4136c5422c2e5ec2367ecc5c4478083?s=128&d=identicon&r=PG", "display_name": "dbrembilla", "link": "https://stackoverflow.com/users/1028361/dbrembilla"}, "edited": false, "score": 0, "creation_date": 1429094043, "post_id": 29647595, "comment_id": 47435737, "body": "Thanks for the explanation ! I will  try yours suggestion"}], "tags": [], "owner": {"reputation": 15519, "user_id": 15472, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9b4128da626e5b0049cd4fb88033e3b3?s=128&d=identicon&r=PG", "display_name": "tucuxi", "link": "https://stackoverflow.com/users/15472/tucuxi"}, "is_accepted": true, "score": 2, "last_activity_date": 1429093377, "last_edit_date": 1429093377, "creation_date": 1429092983, "answer_id": 29647595, "question_id": 29647243, "link": "https://stackoverflow.com/questions/29647243/generate-include-macro-from-environment-variable/29647595#29647595", "title": "Generate #include macro from environment variable", "body": "<p>As Joachim writes, in GCC you can use the <a href=\"https://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_2.html#SEC11\" rel=\"nofollow\"><code>-D</code> flag</a> to <code>#define</code> things from the command-line:</p>\n\n<pre><code>gcc -DTEST source.c\n\n// in source.c\n#include &lt;stdio.h&gt;\nint main() {\n  #ifdef TEST\n  printf(\"TEST macro is #defined!\\n\"); // only runs if -DTEST\n  #endif\n  return 0;\n}\n</code></pre>\n\n<p>You can easily plug in environment variables (at compile-time) via this\nmechanism:</p>\n\n<pre><code>gcc \"-DTEST=$MY_ENV_VAR\" source.c\n</code></pre>\n\n<p>If you need to use the run-time value of the environment variable, then the macro preprocessor (<code>#define</code>, <code>#ifdef</code>, ...) can't help you. Use <code>getenv()</code> instead, and forget about macros.</p>\n\n<p>More to the point:</p>\n\n<pre><code>#include TEST\nint main() {\n    printf(\"Hello world!\\n\");\n    return 0;\n}\n</code></pre>\n\n<p>Will work fine <em>only</em> if compiled with <code>\"-DTEST=&lt;stdio.h&gt;\"</code> (note the quotes).</p>\n"}], "owner": {"reputation": 157, "user_id": 1028361, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/e4136c5422c2e5ec2367ecc5c4478083?s=128&d=identicon&r=PG", "display_name": "dbrembilla", "link": "https://stackoverflow.com/users/1028361/dbrembilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 29647595, "answer_count": 1, "score": 1, "last_activity_date": 1429102083, "creation_date": 1429092063, "last_edit_date": 1429102083, "question_id": 29647243, "link": "https://stackoverflow.com/questions/29647243/generate-include-macro-from-environment-variable", "title": "Generate #include macro from environment variable", "body": "<p>as you say, it works.</p>\n\n<p>But can I build -in some way- the string for the include directive ?\nSomething like</p>\n\n<p>in .login</p>\n\n<pre><code>setenv REPO \"/tmp\"\n</code></pre>\n\n<p>compile</p>\n\n<pre><code># gcc -D\"REPO=${REPO}\" source.c\n</code></pre>\n\n<p>in source.c</p>\n\n<pre><code>#ifdef REPO\n    #include ${REPO}/my_dir/my_file.h \n#endif\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["c", "audio", "core-audio", "pitch-tracking"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 4450554, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/100004269724711/picture?type=large", "display_name": "Ulrich Vormbrock", "link": "https://stackoverflow.com/users/4450554/ulrich-vormbrock"}, "edited": false, "score": 0, "creation_date": 1429222593, "post_id": 29662722, "comment_id": 47510922, "body": "Thank you, psybersonic - I&#39;ve tried out your proposals and there are slight improvements concerning frequency stability. The paper &quot;Pitch in Praat&quot; helped me a lot in order to get a better understanding about pitch- or speech detection. Thank you so much!"}, {"owner": {"reputation": 29, "user_id": 1755853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444f1d3ab5f1e207964cb6039759eac2?s=128&d=identicon&r=PG", "display_name": "psybersonic", "link": "https://stackoverflow.com/users/1755853/psybersonic"}, "reply_to_user": {"reputation": 349, "user_id": 4450554, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/100004269724711/picture?type=large", "display_name": "Ulrich Vormbrock", "link": "https://stackoverflow.com/users/4450554/ulrich-vormbrock"}, "edited": false, "score": 0, "creation_date": 1429259431, "post_id": 29662722, "comment_id": 47524560, "body": "Glad to help Ulrich. Digital Audio is not easy. If you use any of Kevin Murphy&#39;s code there is a memory leak in the audio controller. Need to add free(THIS-&gt;bufferList.mBuffers[0].mData); at the end of the recording callback. (if my memory is correct)."}], "tags": [], "owner": {"reputation": 29, "user_id": 1755853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/444f1d3ab5f1e207964cb6039759eac2?s=128&d=identicon&r=PG", "display_name": "psybersonic", "link": "https://stackoverflow.com/users/1755853/psybersonic"}, "is_accepted": false, "score": 1, "last_activity_date": 1429141635, "last_edit_date": 1429141635, "creation_date": 1429140360, "answer_id": 29662722, "question_id": 29646661, "link": "https://stackoverflow.com/questions/29646661/yin-frequency-detection-and-overtones-guitar-strings/29662722#29662722", "title": "YIN-Frequency-Detection and overtones (guitar strings)", "body": "<p>I used autocorrelation for my free chromatic app iTransposer and incorporated a Hanning window so this may help you. I wasn't looking for accuracy initially as I wanted to display the note on a stave not a meter. However a friend of mine tested it to 0.1 Hz with a signal generator at his work and had issues over 383 Hz with simple signals such as Sine waves.I've tried it with various brass instruments, guitar and Garageband instruments seems to be OK for tuning.\nBasically I implemented this <a href=\"http://www.ucl.ac.uk/~ucjt465/tutorials/praatpitch.html\" rel=\"nofollow\">http://www.ucl.ac.uk/~ucjt465/tutorials/praatpitch.html</a>\nusing VDSP and updated a sample project supplied by Kevin P Murphy <a href=\"https://github.com/kevmdev/PitchDetectorExample\" rel=\"nofollow\">https://github.com/kevmdev/PitchDetectorExample</a></p>\n"}], "owner": {"reputation": 349, "user_id": 4450554, "user_type": "registered", "accept_rate": 11, "profile_image": "https://graph.facebook.com/100004269724711/picture?type=large", "display_name": "Ulrich Vormbrock", "link": "https://stackoverflow.com/users/4450554/ulrich-vormbrock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1429141635, "creation_date": 1429090454, "question_id": 29646661, "link": "https://stackoverflow.com/questions/29646661/yin-frequency-detection-and-overtones-guitar-strings", "title": "YIN-Frequency-Detection and overtones (guitar strings)", "body": "<p>I'm developing an IOS app for frequency detection, and I'm using the YIN algorithm, which is very precise: witch Audacity, I've generated rectangular waves of different frequencies - and my algorithm has a precision of about 0.1 % - for example generating a tone of 82,4 Hz (E string), I really get 82,4 Hz and nothing else.</p>\n\n<p>Anyhow, when I strum a guitar string, I often get overtones which sometimes can be stronger (with a higher amplitude) than the fundamental tone (F0). Consequently, my display starts \"dancing\" and toggling - sometimes, it even occurs that (when the tone dies out) my algorithm stops at the overtone's frequency (for example A instead of E) - so the user has to strum the string again in oder to see if his desired tone (frequency) is present.</p>\n\n<p>I know that this phenomena has nothing to do with my algorithm, because it's merely a \"hardware\" problem (I mean the guitar which simply produces overtones).</p>\n\n<p>I've tried in vain to smooth the results (of the frequency detection) or to \"snap\" to a fixed frequency as soon as a crucial frequency (for example 82.4 Hz for E string +/- tolerance) has been detected. Anyhow, it often occurrs that my algorithm snaps into an erroneous frequency, as well.</p>\n\n<p>I'm asking myself how cheap guitar tuners (for 10$ in guitar stores) are working, as their frequency detections are reliable and stable, as well.</p>\n\n<p>I don't want to change the algorithm, but two possible solutions come into my mind:</p>\n\n<ol>\n<li>Preprocessing of the signal (maybe Hanning window, lowpass or bandpass filtering) and/or</li>\n<li>Postprocessing of the signal (some kind of frequency smoothing).</li>\n</ol>\n\n<p>Has someone an idea how to overcome the \"choppy\" results?</p>\n"}]